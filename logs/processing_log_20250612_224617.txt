================================================================================
â•‘                            FINAL VERSION PROCESSOR                             â•‘
================================================================================
[22:46:17] â„¹ï¸  CSV Data Extraction & API Push Tool
[22:46:17] â„¹ï¸  
[22:46:17] â„¹ï¸  Features:
[22:46:17] â„¹ï¸  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[22:46:17] â„¹ï¸  - AI-powered patient and order data extraction
[22:46:17] â„¹ï¸  - Enhanced error handling and logging
[22:46:17] â„¹ï¸  - Full API integration (patient creation + order pushing)
[22:46:17] â„¹ï¸  - CSV output with comprehensive patient data
[22:46:17] â„¹ï¸  - Detailed API tracking with remarks for every document
[22:46:17] â„¹ï¸  - Complete audit trail of all processing attempts
[22:46:17] â„¹ï¸  
[22:46:17] â„¹ï¸  Starting CSV processing with API integration: prima.csv
[22:46:17] âœ… Created output CSV file: csv_outputs/extracted_patients_20250612_224617.csv
[22:46:17] âœ… Created API details CSV file: api_outputs/api_push_details_20250612_224617.csv
================================================================================
â•‘                        Processing Document ID: 9334583                         â•‘
================================================================================
[22:46:17] â„¹ï¸  Agency: Brookdale Home Health Rhode Island(Nurse on call)
[22:46:17] â„¹ï¸  Date: 
[22:46:17] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[22:46:20] [DOC: 9334583] âœ… Text extracted using pdfplumber (9691 chars)
[22:46:20] âœ…    âœ… Text extracted using pdfplumber (9655 chars)
[22:46:20] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[22:46:25] â„¹ï¸  AI extracted raw sex value: 'F'
[22:46:25] â„¹ï¸  AI extracted service line: 'Physical Therapy'
[22:46:25] â„¹ï¸  AI extracted payer source: 'Medicare'
[22:46:25] â„¹ï¸  AI extracted diagnoses:
[22:46:25] â„¹ï¸    - Diagnosis 1: 'G30.9'
[22:46:25] â„¹ï¸    - Diagnosis 2: 'F02.83'
[22:46:25] â„¹ï¸    - Diagnosis 3: 'F32.A'
[22:46:25] â„¹ï¸    - Diagnosis 4: 'I10'
[22:46:25] â„¹ï¸    - Diagnosis 5: ''
[22:46:25] â„¹ï¸    - Diagnosis 6: ''
[22:46:25] â„¹ï¸  Final extracted MRN: 'RLN00427863201'
[22:46:25] â„¹ï¸  Final extracted Sex: 'FEMALE'
[22:46:25] â„¹ï¸  Final extracted Service Line: 'Physical Therapy'
[22:46:25] â„¹ï¸  Final extracted Payer Source: 'Medicare'
[22:46:25] âœ… Patient data extraction completed successfully
[22:46:25] âœ…    âœ… Patient data extracted successfully
[22:46:25] ğŸ“Š Patient Response
     â””â”€ patientFName: BARBARA
     â””â”€ patientLName: BRADSHAW
     â””â”€ dob: 12/09/1942
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: RLN00427863201
     â””â”€ billingProvider: NURSE ON CALL - LINCOLN
     â””â”€ npi: 417059
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: NURSE ON CALL - LINCOLN
     â””â”€ address: 1215 MAIN ROAD
     â””â”€ city: TIVERTON
     â””â”€ state: RI
     â””â”€ zip: 02878
     â””â”€ email: 
     â””â”€ phoneNumber: (401) 726-7744
     â””â”€ serviceLine: Physical Therapy
     â””â”€ payorSource: Medicare
     â””â”€ episodeDiagnoses: [{'startOfCare': '06/01/2025', 'startOfEpisode': '06/01/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.83', 'thirdDiagnosis': 'F32.A', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:46:25] âœ…    âœ… Patient identified: BARBARA BRADSHAW
[22:46:25] âœ…    âœ… Patient name validation passed
[22:46:25] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[22:46:25] [DOC: 9334583] â„¹ï¸  DOB normalized: 12/09/1942
[22:46:25] [DOC: 9334583] â„¹ï¸  Episode startOfCare normalized: 06/01/2025
[22:46:25] [DOC: 9334583] â„¹ï¸  Episode startOfEpisode normalized: 06/01/2025
[22:46:25] [DOC: 9334583] â„¹ï¸  Episode endOfEpisode normalized: 07/30/2025
[22:46:25] [DOC: 9334583] âœ… Patient date processing completed successfully
[22:46:25] âœ…    âœ… Date processing completed
[22:46:25] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: BARBARA
     â””â”€ patientLName: BRADSHAW
     â””â”€ dob: 12/09/1942
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: RLN00427863201
     â””â”€ billingProvider: NURSE ON CALL - LINCOLN
     â””â”€ npi: 417059
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: NURSE ON CALL - LINCOLN
     â””â”€ address: 1215 MAIN ROAD
     â””â”€ city: TIVERTON
     â””â”€ state: RI
     â””â”€ zip: 02878
     â””â”€ email: 
     â””â”€ phoneNumber: (401) 726-7744
     â””â”€ serviceLine: Physical Therapy
     â””â”€ payorSource: Medicare
     â””â”€ episodeDiagnoses: [{'startOfCare': '06/01/2025', 'startOfEpisode': '06/01/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.83', 'thirdDiagnosis': 'F32.A', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:46:25] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[22:46:28] â„¹ï¸  Order extraction - MRN: 'RLN00427863201'
[22:46:28] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[22:46:28] â„¹ï¸  Order extraction - Service Line: 'PT'
[22:46:28] â„¹ï¸  Order extraction - Payer Source: 'Medicare'
[22:46:28] âœ… Order data extraction completed successfully
[22:46:28] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[22:46:28] â„¹ï¸  Using MRN from patient data: 'RLN00427863201' over 'RLN00427863201'
[22:46:28] â„¹ï¸  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[22:46:28] â„¹ï¸  Payer source consistent in both sources: 'Medicare'
[22:46:28] âœ… Patient name cross-validation successful
[22:46:28] âœ…    âœ… Data merged successfully
[22:46:29] âœ…    âœ… Order data extracted and validated
[22:46:29] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[22:46:33] [DOC: 9334583] â„¹ï¸  Patient not found in cache or API: BARBARA BRADSHAW
[22:46:33] [DOC: 9334583] â„¹ï¸  Patient not found, creating new patient via API...
[22:46:33] [DOC: 9334583] â„¹ï¸  Creating patient via API: BARBARA BRADSHAW
[22:46:34] [DOC: 9334583] âŒ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:46:34] âŒ    âŒ Failed to create patient
[22:46:34] [DOC: 9334583] â„¹ï¸  API push details saved for document 9334583
================================================================================
â•‘                               PROCESSING SUMMARY                               â•‘
================================================================================
[22:46:34] â„¹ï¸  Total Processed: 1
[22:46:34] â„¹ï¸  CSV Success: 0
[22:46:34] â„¹ï¸  CSV Errors: 0
[22:46:34] â„¹ï¸  API Success: 0
[22:46:34] â„¹ï¸  API Errors: 1
[22:46:34] â„¹ï¸  CSV Success Rate: 0.0%
[22:46:34] â„¹ï¸  API Success Rate: 0.0%
[22:46:34] â„¹ï¸  Output CSV File: csv_outputs/extracted_patients_20250612_224617.csv
[22:46:34] â„¹ï¸  API Details File: api_outputs/api_push_details_20250612_224617.csv
================================================================================
â•‘          ============================================================          â•‘
================================================================================
