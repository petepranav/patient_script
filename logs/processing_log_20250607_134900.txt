================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[13:49:00] ℹ️  CSV Data Extraction & API Push Tool
[13:49:00] ℹ️  
[13:49:00] ℹ️  Features:
[13:49:00] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[13:49:00] ℹ️  - AI-powered patient and order data extraction
[13:49:00] ℹ️  - Enhanced error handling and logging
[13:49:00] ℹ️  - Full API integration (patient creation + order pushing)
[13:49:00] ℹ️  - CSV output with comprehensive patient data
[13:49:00] ℹ️  - Detailed API tracking with remarks for every document
[13:49:00] ℹ️  - Complete audit trail of all processing attempts
[13:49:00] ℹ️  
[13:49:00] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[13:49:00] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_134900.csv
[13:49:00] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_134900.csv
================================================================================
║                        Processing Document ID: 9310884                         ║
================================================================================
[13:49:00] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[13:49:00] ℹ️  Date: 05/26/2025
[13:49:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:49:02] [DOC: 9310884] ✅ Text extracted using pdfplumber (1409 chars)
[13:49:02] ✅    ✅ Text extracted using pdfplumber (1397 chars)
[13:49:02] 🔄 
🔄 Step 2: Extracting patient data...
[13:49:05] ℹ️  AI extracted raw sex value: ''
[13:49:05] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:49:05] ℹ️  AI extracted payer source: 'Medicare'
[13:49:05] ℹ️  AI extracted diagnoses:
[13:49:05] ℹ️    - Diagnosis 1: 'None'
[13:49:05] ℹ️    - Diagnosis 2: 'None'
[13:49:05] ℹ️    - Diagnosis 3: 'None'
[13:49:05] ℹ️    - Diagnosis 4: 'None'
[13:49:05] ℹ️    - Diagnosis 5: 'None'
[13:49:05] ℹ️    - Diagnosis 6: 'None'
[13:49:05] ℹ️  Final extracted MRN: '28700154820301'
[13:49:05] ℹ️  Final extracted Sex: ''
[13:49:05] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:49:05] ℹ️  Final extracted Payer Source: 'Medicare'
[13:49:05] ✅ Patient data extraction completed successfully
[13:49:05] ✅    ✅ Patient data extracted successfully
[13:49:05] 📊 Patient Response
     └─ patientFName: BERNICE
     └─ patientLName: LAWSON
     └─ dob: 03/16/1942
     └─ patientSex: 
     └─ medicalRecordNo: 28700154820301
     └─ billingProvider: ROBERT CALDAS, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 7 CHRISTIAN ST
     └─ city: FAIRHAVEN
     └─ state: MA
     └─ zip: 02719-1257
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:49:05] ✅    ✅ Patient identified: BERNICE LAWSON
[13:49:05] ✅    ✅ Patient name validation passed
[13:49:05] 🔄 
🔄 Step 3: Processing patient dates...
[13:49:05] [DOC: 9310884] ℹ️  DOB normalized: 03/16/1942
[13:49:05] [DOC: 9310884] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[13:49:05] [DOC: 9310884] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[13:49:05] [DOC: 9310884] ✅ Patient date processing completed successfully
[13:49:05] ✅    ✅ Date processing completed
[13:49:05] 📊 Processed Patient Data
     └─ patientFName: BERNICE
     └─ patientLName: LAWSON
     └─ dob: 03/16/1942
     └─ patientSex: 
     └─ medicalRecordNo: 28700154820301
     └─ billingProvider: ROBERT CALDAS, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 7 CHRISTIAN ST
     └─ city: FAIRHAVEN
     └─ state: MA
     └─ zip: 02719-1257
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025'}]
[13:49:05] 🔄 
🔄 Step 4: Extracting order data...
[13:49:07] ℹ️  Order extraction - MRN: '28700154820301'
[13:49:07] ℹ️  Order extraction - Sex: ''
[13:49:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:49:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:49:07] ✅ Order data extraction completed successfully
[13:49:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:49:07] ℹ️  Using MRN from patient data: '28700154820301' over '28700154820301'
[13:49:07] ⚠️  Could not determine sex using any available method
[13:49:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:49:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:49:07] ✅ Patient name cross-validation successful
[13:49:07] ✅    ✅ Data merged successfully
[13:49:09] ✅    ✅ Order data extracted and validated
[13:49:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:49:09] [DOC: 9310884] ✅ Patient found in local cache: BERNICE LAWSON, ID: d5754150-ca23-4c39-9506-3db815875026
[13:49:09] ✅    ✅ Existing patient found with ID: d5754150-ca23-4c39-9506-3db815875026
[13:49:09] 🔄 
🔄 Step 6: Pushing order to API...
[13:49:09] [DOC: 9310884] ℹ️  Pushing order via API for patient ID: d5754150-ca23-4c39-9506-3db815875026
[13:49:10] [DOC: 9310884] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16505"}
[13:49:10] ❌    ❌ Failed to push order
[13:49:10] 🔄 
🔄 Step 7: Writing to CSV...
[13:49:10] [DOC: 9310884] ℹ️  Calculated age: 83 from DOB: 03/16/1942
[13:49:10] [DOC: 9310884] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:49:10] [DOC: 9310884] ℹ️  Payer Source extracted: 'Medicare'
[13:49:10] [DOC: 9310884] ℹ️  Diagnosis codes being written:
[13:49:10] [DOC: 9310884] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:49:10] [DOC: 9310884] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:49:10] [DOC: 9310884] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:49:10] [DOC: 9310884] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:49:10] [DOC: 9310884] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:49:10] [DOC: 9310884] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:49:10] [DOC: 9310884] ✅ Patient data written to CSV: BERNICE LAWSON | Sex:  | Age: 83 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 28700154820301
[13:49:10] ✅    ✅ Document 9310884 processed and saved successfully
[13:49:10] 🔄 
🔄 Step 8: Saving API details...
[13:49:10] [DOC: 9310884] ℹ️  API push details saved for document 9310884
[13:49:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9310875                         ║
================================================================================
[13:49:10] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[13:49:10] ℹ️  Date: 05/26/2025
[13:49:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:49:12] [DOC: 9310875] ✅ Text extracted using pdfplumber (1284 chars)
[13:49:12] ✅    ✅ Text extracted using pdfplumber (1272 chars)
[13:49:12] 🔄 
🔄 Step 2: Extracting patient data...
[13:49:15] ℹ️  AI extracted raw sex value: ''
[13:49:15] ℹ️  AI extracted service line: 'PT'
[13:49:15] ℹ️  AI extracted payer source: 'Medicare'
[13:49:15] ℹ️  AI extracted diagnoses:
[13:49:15] ℹ️    - Diagnosis 1: 'None'
[13:49:15] ℹ️    - Diagnosis 2: 'None'
[13:49:15] ℹ️    - Diagnosis 3: 'None'
[13:49:15] ℹ️    - Diagnosis 4: 'None'
[13:49:15] ℹ️    - Diagnosis 5: 'None'
[13:49:15] ℹ️    - Diagnosis 6: 'None'
[13:49:15] ℹ️  Final extracted MRN: '28700212160801'
[13:49:15] ℹ️  Final extracted Sex: ''
[13:49:15] ℹ️  Final extracted Service Line: 'PT'
[13:49:15] ℹ️  Final extracted Payer Source: 'Medicare'
[13:49:15] ✅ Patient data extraction completed successfully
[13:49:15] ✅    ✅ Patient data extracted successfully
[13:49:15] 📊 Patient Response
     └─ patientFName: ISIDRO
     └─ patientLName: FONSECA
     └─ dob: 08/04/1948
     └─ patientSex: 
     └─ medicalRecordNo: 28700212160801
     └─ billingProvider: ROBERT CALDAS, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 3 FIELDSTONE FARM DRIVE
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/07/2025', 'endOfEpisode': '04/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:49:15] ✅    ✅ Patient identified: ISIDRO FONSECA
[13:49:15] ✅    ✅ Patient name validation passed
[13:49:15] 🔄 
🔄 Step 3: Processing patient dates...
[13:49:15] [DOC: 9310875] ℹ️  DOB normalized: 08/04/1948
[13:49:15] [DOC: 9310875] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[13:49:15] [DOC: 9310875] ℹ️  Episode endOfEpisode normalized: 04/10/2025
[13:49:15] [DOC: 9310875] ✅ Patient date processing completed successfully
[13:49:15] ✅    ✅ Date processing completed
[13:49:15] 📊 Processed Patient Data
     └─ patientFName: ISIDRO
     └─ patientLName: FONSECA
     └─ dob: 08/04/1948
     └─ patientSex: 
     └─ medicalRecordNo: 28700212160801
     └─ billingProvider: ROBERT CALDAS, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 3 FIELDSTONE FARM DRIVE
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '04/10/2025'}]
[13:49:15] 🔄 
🔄 Step 4: Extracting order data...
[13:49:17] ℹ️  Order extraction - MRN: '28700212160801'
[13:49:17] ℹ️  Order extraction - Sex: ''
[13:49:17] ℹ️  Order extraction - Service Line: 'PT'
[13:49:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:49:17] ✅ Order data extraction completed successfully
[13:49:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:49:17] ℹ️  Using MRN from patient data: '28700212160801' over '28700212160801'
[13:49:17] ⚠️  Could not determine sex using any available method
[13:49:17] ℹ️  Service line consistent in both sources: 'PT'
[13:49:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:49:17] ✅ Patient name cross-validation successful
[13:49:17] ✅    ✅ Data merged successfully
[13:49:18] ✅    ✅ Order data extracted and validated
[13:49:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:49:33] [DOC: 9310875] ℹ️  Patient not found in cache or API: ISIDRO FONSECA
[13:49:33] [DOC: 9310875] ℹ️  Patient not found, creating new patient via API...
[13:49:33] [DOC: 9310875] ℹ️  Creating patient via API: ISIDRO FONSECA
[13:49:34] [DOC: 9310875] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:49:34] ❌    ❌ Failed to create patient
[13:49:34] [DOC: 9310875] ℹ️  API push details saved for document 9310875
================================================================================
║                        Processing Document ID: 9310880                         ║
================================================================================
[13:49:34] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[13:49:34] ℹ️  Date: 05/26/2025
[13:49:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:49:36] [DOC: 9310880] ✅ Text extracted using pdfplumber (1443 chars)
[13:49:36] ✅    ✅ Text extracted using pdfplumber (1431 chars)
[13:49:36] 🔄 
🔄 Step 2: Extracting patient data...
[13:49:39] ℹ️  AI extracted raw sex value: ''
[13:49:39] ℹ️  AI extracted service line: 'Nursing'
[13:49:39] ℹ️  AI extracted payer source: 'Medicare'
[13:49:39] ℹ️  AI extracted diagnoses:
[13:49:39] ℹ️    - Diagnosis 1: ''
[13:49:39] ℹ️    - Diagnosis 2: ''
[13:49:39] ℹ️    - Diagnosis 3: ''
[13:49:39] ℹ️    - Diagnosis 4: ''
[13:49:39] ℹ️    - Diagnosis 5: ''
[13:49:39] ℹ️    - Diagnosis 6: ''
[13:49:39] ℹ️  Final extracted MRN: '28700211636801'
[13:49:39] ℹ️  Final extracted Sex: ''
[13:49:39] ℹ️  Final extracted Service Line: 'Nursing'
[13:49:39] ℹ️  Final extracted Payer Source: 'Medicare'
[13:49:39] ✅ Patient data extraction completed successfully
[13:49:39] ✅    ✅ Patient data extracted successfully
[13:49:39] 📊 Patient Response
     └─ patientFName: WILLIAM
     └─ patientLName: GROVELL
     └─ dob: 03/26/1949
     └─ patientSex: 
     └─ medicalRecordNo: 28700211636801
     └─ billingProvider: SACHIN MASKEY, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:49:39] ✅    ✅ Patient identified: WILLIAM GROVELL
[13:49:39] ✅    ✅ Patient name validation passed
[13:49:39] 🔄 
🔄 Step 3: Processing patient dates...
[13:49:39] [DOC: 9310880] ℹ️  DOB normalized: 03/26/1949
[13:49:39] [DOC: 9310880] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[13:49:39] [DOC: 9310880] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[13:49:39] [DOC: 9310880] ✅ Patient date processing completed successfully
[13:49:39] ✅    ✅ Date processing completed
[13:49:39] 📊 Processed Patient Data
     └─ patientFName: WILLIAM
     └─ patientLName: GROVELL
     └─ dob: 03/26/1949
     └─ patientSex: 
     └─ medicalRecordNo: 28700211636801
     └─ billingProvider: SACHIN MASKEY, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:49:39] 🔄 
🔄 Step 4: Extracting order data...
[13:49:41] ℹ️  Order extraction - MRN: '28700211636801'
[13:49:41] ℹ️  Order extraction - Sex: ''
[13:49:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:49:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:49:41] ✅ Order data extraction completed successfully
[13:49:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:49:41] ℹ️  Using MRN from patient data: '28700211636801' over '28700211636801'
[13:49:41] ℹ️  Inferred sex as MALE from name: WILLIAM
[13:49:41] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[13:49:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:49:41] ✅ Patient name cross-validation successful
[13:49:41] ✅    ✅ Data merged successfully
[13:49:42] ✅    ✅ Order data extracted and validated
[13:49:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:03] [DOC: 9310880] ℹ️  Patient not found in cache or API: WILLIAM GROVELL
[13:50:03] [DOC: 9310880] ℹ️  Patient not found, creating new patient via API...
[13:50:03] [DOC: 9310880] ℹ️  Creating patient via API: WILLIAM GROVELL
[13:50:04] [DOC: 9310880] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:50:04] ❌    ❌ Failed to create patient
[13:50:04] [DOC: 9310880] ℹ️  API push details saved for document 9310880
================================================================================
║                        Processing Document ID: 9309925                         ║
================================================================================
[13:50:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:50:04] ℹ️  Date: 05/23/2025
[13:50:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:07] [DOC: 9309925] ✅ Text extracted using pdfplumber (1687 chars)
[13:50:07] ✅    ✅ Text extracted using pdfplumber (1675 chars)
[13:50:07] 🔄 
🔄 Step 2: Extracting patient data...
[13:50:10] ℹ️  AI extracted raw sex value: ''
[13:50:10] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:50:10] ℹ️  AI extracted payer source: ''
[13:50:10] ℹ️  AI extracted diagnoses:
[13:50:10] ℹ️    - Diagnosis 1: 'I11.0'
[13:50:10] ℹ️    - Diagnosis 2: 'I50.33'
[13:50:10] ℹ️    - Diagnosis 3: 'J18.9'
[13:50:10] ℹ️    - Diagnosis 4: ''
[13:50:10] ℹ️    - Diagnosis 5: ''
[13:50:10] ℹ️    - Diagnosis 6: ''
[13:50:10] ℹ️  Final extracted MRN: 'MA221012094404'
[13:50:10] ℹ️  Final extracted Sex: ''
[13:50:10] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:50:10] ℹ️  Final extracted Payer Source: ''
[13:50:10] ✅ Patient data extraction completed successfully
[13:50:10] ✅    ✅ Patient data extracted successfully
[13:50:10] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:10] ✅    ✅ Patient identified: Maria Ferreira
[13:50:10] ✅    ✅ Patient name validation passed
[13:50:10] 🔄 
🔄 Step 3: Processing patient dates...
[13:50:10] [DOC: 9309925] ℹ️  DOB normalized: 09/29/1944
[13:50:10] [DOC: 9309925] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[13:50:10] [DOC: 9309925] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[13:50:10] [DOC: 9309925] ✅ Patient date processing completed successfully
[13:50:10] ✅    ✅ Date processing completed
[13:50:10] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:10] 🔄 
🔄 Step 4: Extracting order data...
[13:50:12] ℹ️  Order extraction - MRN: 'MA221012094404'
[13:50:12] ℹ️  Order extraction - Sex: ''
[13:50:12] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[13:50:12] ℹ️  Order extraction - Payer Source: ''
[13:50:12] ✅ Order data extraction completed successfully
[13:50:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:12] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[13:50:12] ℹ️  Inferred sex as FEMALE from name: Maria
[13:50:12] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[13:50:12] ✅ Patient name cross-validation successful
[13:50:12] ✅    ✅ Data merged successfully
[13:50:14] ✅    ✅ Order data extracted and validated
[13:50:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:24] [DOC: 9309925] ✅ Patient exists in API: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[13:50:24] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[13:50:24] 🔄 
🔄 Step 6: Pushing order to API...
[13:50:24] [DOC: 9309925] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[13:50:25] [DOC: 9309925] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18947"}
[13:50:25] ❌    ❌ Failed to push order
[13:50:25] 🔄 
🔄 Step 7: Writing to CSV...
[13:50:25] [DOC: 9309925] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[13:50:25] [DOC: 9309925] ℹ️  Service Line extracted: 'Occupational Therapy'
[13:50:25] [DOC: 9309925] ℹ️  Payer Source extracted: ''
[13:50:25] [DOC: 9309925] ℹ️  Diagnosis codes being written:
[13:50:25] [DOC: 9309925] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[13:50:25] [DOC: 9309925] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[13:50:25] [DOC: 9309925] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[13:50:25] [DOC: 9309925] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:50:25] [DOC: 9309925] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:50:25] [DOC: 9309925] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:50:25] [DOC: 9309925] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[13:50:25] ✅    ✅ Document 9309925 processed and saved successfully
[13:50:25] 🔄 
🔄 Step 8: Saving API details...
[13:50:25] [DOC: 9309925] ℹ️  API push details saved for document 9309925
[13:50:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309922                         ║
================================================================================
[13:50:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:50:25] ℹ️  Date: 05/23/2025
[13:50:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:29] [DOC: 9309922] ✅ Text extracted using pdfplumber (23642 chars)
[13:50:29] ✅    ✅ Text extracted using pdfplumber (23642 chars)
[13:50:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:50:32] ℹ️  AI extracted raw sex value: 'F'
[13:50:32] ℹ️  AI extracted service line: 'PT'
[13:50:32] ℹ️  AI extracted payer source: ''
[13:50:32] ℹ️  AI extracted diagnoses:
[13:50:32] ℹ️    - Diagnosis 1: 'I50.1'
[13:50:32] ℹ️    - Diagnosis 2: 'J18.9'
[13:50:32] ℹ️    - Diagnosis 3: ''
[13:50:32] ℹ️    - Diagnosis 4: ''
[13:50:32] ℹ️    - Diagnosis 5: ''
[13:50:32] ℹ️    - Diagnosis 6: ''
[13:50:32] ℹ️  Final extracted MRN: 'MA221012094404'
[13:50:32] ℹ️  Final extracted Sex: 'FEMALE'
[13:50:32] ℹ️  Final extracted Service Line: 'PT'
[13:50:32] ℹ️  Final extracted Payer Source: ''
[13:50:32] ✅ Patient data extraction completed successfully
[13:50:32] ✅    ✅ Patient data extracted successfully
[13:50:32] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'I50.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:32] ✅    ✅ Patient identified: Maria Ferreira
[13:50:32] ✅    ✅ Patient name validation passed
[13:50:32] 🔄 
🔄 Step 3: Processing patient dates...
[13:50:32] [DOC: 9309922] ℹ️  DOB normalized: 09/29/1944
[13:50:32] [DOC: 9309922] ✅ Patient date processing completed successfully
[13:50:32] ✅    ✅ Date processing completed
[13:50:32] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'I50.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:32] 🔄 
🔄 Step 4: Extracting order data...
[13:50:36] ℹ️  Order extraction - MRN: 'MA221012094404'
[13:50:36] ℹ️  Order extraction - Sex: 'FEMALE'
[13:50:36] ℹ️  Order extraction - Service Line: 'PT'
[13:50:36] ℹ️  Order extraction - Payer Source: ''
[13:50:36] ✅ Order data extraction completed successfully
[13:50:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:36] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[13:50:36] ℹ️  Service line consistent in both sources: 'PT'
[13:50:36] ✅ Patient name cross-validation successful
[13:50:36] ✅    ✅ Data merged successfully
[13:50:37] ✅    ✅ Order data extracted and validated
[13:50:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:37] [DOC: 9309922] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[13:50:37] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[13:50:37] 🔄 
🔄 Step 6: Pushing order to API...
[13:50:37] [DOC: 9309922] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[13:50:38] [DOC: 9309922] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:50:38] ❌    ❌ Failed to push order
[13:50:38] 🔄 
🔄 Step 7: Writing to CSV...
[13:50:38] [DOC: 9309922] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[13:50:38] [DOC: 9309922] ℹ️  Service Line extracted: 'PT'
[13:50:38] [DOC: 9309922] ℹ️  Payer Source extracted: ''
[13:50:38] [DOC: 9309922] ℹ️  Diagnosis codes being written:
[13:50:38] [DOC: 9309922] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.1'
[13:50:38] [DOC: 9309922] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[13:50:38] [DOC: 9309922] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:50:38] [DOC: 9309922] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:50:38] [DOC: 9309922] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:50:38] [DOC: 9309922] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:50:38] [DOC: 9309922] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA221012094404
[13:50:38] ✅    ✅ Document 9309922 processed and saved successfully
[13:50:38] 🔄 
🔄 Step 8: Saving API details...
[13:50:38] [DOC: 9309922] ℹ️  API push details saved for document 9309922
[13:50:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309849                         ║
================================================================================
[13:50:38] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:50:38] ℹ️  Date: 05/23/2025
[13:50:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:41] [DOC: 9309849] ✅ Text extracted using pdfplumber (7447 chars)
[13:50:41] ✅    ✅ Text extracted using pdfplumber (7447 chars)
[13:50:41] 🔄 
🔄 Step 2: Extracting patient data...
[13:50:44] ℹ️  AI extracted raw sex value: 'M'
[13:50:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:50:44] ℹ️  AI extracted payer source: ''
[13:50:44] ℹ️  AI extracted diagnoses:
[13:50:44] ℹ️    - Diagnosis 1: 'F25.0'
[13:50:44] ℹ️    - Diagnosis 2: 'E11.22'
[13:50:44] ℹ️    - Diagnosis 3: 'I13.10'
[13:50:44] ℹ️    - Diagnosis 4: 'N18.31'
[13:50:44] ℹ️    - Diagnosis 5: 'F41.0'
[13:50:44] ℹ️    - Diagnosis 6: 'F41.9'
[13:50:44] ℹ️  Final extracted MRN: '879'
[13:50:44] ℹ️  Final extracted Sex: 'MALE'
[13:50:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:50:44] ℹ️  Final extracted Payer Source: ''
[13:50:44] ✅ Patient data extraction completed successfully
[13:50:44] ✅    ✅ Patient data extracted successfully
[13:50:44] 📊 Patient Response
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '05/24/2025', 'endOfEpisode': '07/22/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[13:50:44] ✅    ✅ Patient identified: Sean McCarthy
[13:50:44] ✅    ✅ Patient name validation passed
[13:50:44] 🔄 
🔄 Step 3: Processing patient dates...
[13:50:44] [DOC: 9309849] ℹ️  DOB normalized: 09/16/1969
[13:50:44] [DOC: 9309849] ℹ️  Episode startOfCare normalized: 03/30/2024
[13:50:44] [DOC: 9309849] ℹ️  Episode startOfEpisode normalized: 05/24/2025
[13:50:44] [DOC: 9309849] ℹ️  Episode endOfEpisode normalized: 07/22/2025
[13:50:44] [DOC: 9309849] ✅ Patient date processing completed successfully
[13:50:44] ✅    ✅ Date processing completed
[13:50:44] 📊 Processed Patient Data
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '05/24/2025', 'endOfEpisode': '07/22/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[13:50:44] 🔄 
🔄 Step 4: Extracting order data...
[13:50:47] ℹ️  Order extraction - MRN: '879'
[13:50:47] ℹ️  Order extraction - Sex: 'MALE'
[13:50:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:50:47] ℹ️  Order extraction - Payer Source: ''
[13:50:47] ✅ Order data extraction completed successfully
[13:50:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:47] ℹ️  Using MRN from patient data: '879' over '879'
[13:50:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:50:47] ✅ Patient name cross-validation successful
[13:50:47] ✅    ✅ Data merged successfully
[13:50:48] ✅    ✅ Order data extracted and validated
[13:50:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:55] [DOC: 9309849] ✅ Patient exists in API: Sean McCarthy, ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[13:50:55] ✅    ✅ Existing patient found with ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[13:50:55] 🔄 
🔄 Step 6: Pushing order to API...
[13:50:55] [DOC: 9309849] ℹ️  Pushing order via API for patient ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[13:50:56] [DOC: 9309849] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[13:50:56] ❌    ❌ Failed to push order
[13:50:56] 🔄 
🔄 Step 7: Writing to CSV...
[13:50:56] [DOC: 9309849] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[13:50:56] [DOC: 9309849] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:50:56] [DOC: 9309849] ℹ️  Payer Source extracted: ''
[13:50:56] [DOC: 9309849] ℹ️  Diagnosis codes being written:
[13:50:56] [DOC: 9309849] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[13:50:56] [DOC: 9309849] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[13:50:56] [DOC: 9309849] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.10'
[13:50:56] [DOC: 9309849] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[13:50:56] [DOC: 9309849] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.0'
[13:50:56] [DOC: 9309849] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[13:50:56] [DOC: 9309849] ✅ Patient data written to CSV: Sean McCarthy | Sex: MALE | Age: 55 | Service: Skilled Nursing | Payer:  | MRN: 879
[13:50:56] ✅    ✅ Document 9309849 processed and saved successfully
[13:50:56] 🔄 
🔄 Step 8: Saving API details...
[13:50:56] [DOC: 9309849] ℹ️  API push details saved for document 9309849
[13:50:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309760                         ║
================================================================================
[13:50:56] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:50:56] ℹ️  Date: 05/23/2025
[13:50:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:58] [DOC: 9309760] ✅ Text extracted using pdfplumber (12203 chars)
[13:50:58] ✅    ✅ Text extracted using pdfplumber (12203 chars)
[13:50:58] 🔄 
🔄 Step 2: Extracting patient data...
[13:51:01] ℹ️  AI extracted raw sex value: 'M'
[13:51:01] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[13:51:01] ℹ️  AI extracted payer source: ''
[13:51:01] ℹ️  AI extracted diagnoses:
[13:51:01] ℹ️    - Diagnosis 1: 'I70.211'
[13:51:01] ℹ️    - Diagnosis 2: 'I25.10'
[13:51:01] ℹ️    - Diagnosis 3: 'J81.0'
[13:51:01] ℹ️    - Diagnosis 4: 'F32.9'
[13:51:01] ℹ️    - Diagnosis 5: 'I10'
[13:51:01] ℹ️    - Diagnosis 6: 'E78.5'
[13:51:01] ℹ️  Final extracted MRN: '648005'
[13:51:01] ℹ️  Final extracted Sex: 'MALE'
[13:51:01] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[13:51:01] ℹ️  Final extracted Payer Source: ''
[13:51:01] ✅ Patient data extraction completed successfully
[13:51:01] ✅    ✅ Patient data extracted successfully
[13:51:01] 📊 Patient Response
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 100018430916
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '07/22/2025', 'firstDiagnosis': 'I70.211', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'J81.0', 'fourthDiagnosis': 'F32.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[13:51:01] ✅    ✅ Patient identified: Pedro Sousa
[13:51:01] ✅    ✅ Patient name validation passed
[13:51:01] 🔄 
🔄 Step 3: Processing patient dates...
[13:51:01] [DOC: 9309760] ℹ️  DOB normalized: 03/29/1964
[13:51:01] [DOC: 9309760] ℹ️  Episode startOfCare normalized: 03/25/2025
[13:51:01] [DOC: 9309760] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[13:51:01] [DOC: 9309760] ℹ️  Episode endOfEpisode normalized: 07/22/2025
[13:51:01] [DOC: 9309760] ✅ Patient date processing completed successfully
[13:51:01] ✅    ✅ Date processing completed
[13:51:01] 📊 Processed Patient Data
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 100018430916
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '07/22/2025', 'firstDiagnosis': 'I70.211', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'J81.0', 'fourthDiagnosis': 'F32.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[13:51:01] 🔄 
🔄 Step 4: Extracting order data...
[13:51:04] ℹ️  Order extraction - MRN: '648005'
[13:51:04] ℹ️  Order extraction - Sex: 'MALE'
[13:51:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:51:04] ℹ️  Order extraction - Payer Source: ''
[13:51:04] ✅ Order data extraction completed successfully
[13:51:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:51:04] ℹ️  Using MRN from patient data: '648005' over '648005'
[13:51:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[13:51:04] ✅ Patient name cross-validation successful
[13:51:04] ✅    ✅ Data merged successfully
[13:51:05] ✅    ✅ Order data extracted and validated
[13:51:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:51:12] [DOC: 9309760] ✅ Patient exists in API: Pedro Sousa, ID: 2dc51ce5-9447-429a-994f-bc659210b701
[13:51:12] ✅    ✅ Existing patient found with ID: 2dc51ce5-9447-429a-994f-bc659210b701
[13:51:12] 🔄 
🔄 Step 6: Pushing order to API...
[13:51:12] [DOC: 9309760] ℹ️  Pushing order via API for patient ID: 2dc51ce5-9447-429a-994f-bc659210b701
[13:51:13] [DOC: 9309760] ❌ Order push failed with status 201: {"id":"0227cbaa-ed33-4d43-a686-2232965a4466","orderWAVId":"ORD19945","orderNo":"648005","orderDate":"05/22/2025","startOfCare":"03/25/2025","episodeStartDate":"03/25/2025","episodeEndDate":"07/22/2025","documentID":"9309760","mrn":"648005","patientName":"Sousa, Pedro","sentToPhysicianDate":"05/23/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"2dc51ce5-9447-429a-994f-bc659210b701","companyId":"0f46ebbe-720c-4abb-8809-892864387620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:51:13] ❌    ❌ Failed to push order
[13:51:13] 🔄 
🔄 Step 7: Writing to CSV...
[13:51:13] [DOC: 9309760] ℹ️  Calculated age: 61 from DOB: 03/29/1964
[13:51:13] [DOC: 9309760] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[13:51:13] [DOC: 9309760] ℹ️  Payer Source extracted: ''
[13:51:13] [DOC: 9309760] ℹ️  Diagnosis codes being written:
[13:51:13] [DOC: 9309760] ℹ️    - Latest_Episode_Firstdiagnosis: 'I70.211'
[13:51:13] [DOC: 9309760] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[13:51:13] [DOC: 9309760] ℹ️    - Latest_Episode_Thirddiagnosis: 'J81.0'
[13:51:13] [DOC: 9309760] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F32.9'
[13:51:13] [DOC: 9309760] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[13:51:13] [DOC: 9309760] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[13:51:13] [DOC: 9309760] ✅ Patient data written to CSV: Pedro Sousa | Sex: MALE | Age: 61 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 648005
[13:51:13] ✅    ✅ Document 9309760 processed and saved successfully
[13:51:13] 🔄 
🔄 Step 8: Saving API details...
[13:51:13] [DOC: 9309760] ℹ️  API push details saved for document 9309760
[13:51:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309477                         ║
================================================================================
[13:51:13] ℹ️  Agency: Compassionate Care Hospice-Taunton
[13:51:13] ℹ️  Date: 05/23/2025
[13:51:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:51:15] [DOC: 9309477] ✅ Text extracted using pdfplumber (1636 chars)
[13:51:15] ✅    ✅ Text extracted using pdfplumber (1624 chars)
[13:51:15] 🔄 
🔄 Step 2: Extracting patient data...
[13:51:18] ℹ️  AI extracted raw sex value: ''
[13:51:18] ℹ️  AI extracted service line: 'Hospice'
[13:51:18] ℹ️  AI extracted payer source: 'Medicare'
[13:51:18] ℹ️  AI extracted diagnoses:
[13:51:18] ℹ️    - Diagnosis 1: 'None'
[13:51:18] ℹ️    - Diagnosis 2: 'None'
[13:51:18] ℹ️    - Diagnosis 3: 'None'
[13:51:18] ℹ️    - Diagnosis 4: 'None'
[13:51:18] ℹ️    - Diagnosis 5: 'None'
[13:51:18] ℹ️    - Diagnosis 6: 'None'
[13:51:18] ℹ️  Final extracted MRN: 'B3700288839202'
[13:51:18] ℹ️  Final extracted Sex: ''
[13:51:18] ℹ️  Final extracted Service Line: 'Hospice'
[13:51:18] ℹ️  Final extracted Payer Source: 'Medicare'
[13:51:18] ✅ Patient data extraction completed successfully
[13:51:18] ✅    ✅ Patient data extracted successfully
[13:51:18] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Nunes
     └─ dob: 02/02/1950
     └─ patientSex: 
     └─ medicalRecordNo: B3700288839202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:51:18] ✅    ✅ Patient identified: John Nunes
[13:51:18] ✅    ✅ Patient name validation passed
[13:51:18] 🔄 
🔄 Step 3: Processing patient dates...
[13:51:18] [DOC: 9309477] ℹ️  DOB normalized: 02/02/1950
[13:51:18] [DOC: 9309477] ✅ Patient date processing completed successfully
[13:51:18] ✅    ✅ Date processing completed
[13:51:18] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Nunes
     └─ dob: 02/02/1950
     └─ patientSex: 
     └─ medicalRecordNo: B3700288839202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:51:18] 🔄 
🔄 Step 4: Extracting order data...
[13:51:21] ℹ️  Order extraction - MRN: 'B3700288839202'
[13:51:21] ℹ️  Order extraction - Sex: ''
[13:51:21] ℹ️  Order extraction - Service Line: 'Hospice'
[13:51:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:51:21] ✅ Order data extraction completed successfully
[13:51:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:51:21] ℹ️  Using MRN from patient data: 'B3700288839202' over 'B3700288839202'
[13:51:21] ℹ️  Inferred sex as MALE from name: John
[13:51:21] ℹ️  Service line consistent in both sources: 'Hospice'
[13:51:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:51:21] ✅ Patient name cross-validation successful
[13:51:21] ✅    ✅ Data merged successfully
[13:51:22] ✅    ✅ Order data extracted and validated
[13:51:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:51:28] [DOC: 9309477] ✅ Patient exists in API: John Nunes, ID: f45b0f86-749a-4e1a-8d60-5b8a14059d95
[13:51:28] ✅    ✅ Existing patient found with ID: f45b0f86-749a-4e1a-8d60-5b8a14059d95
[13:51:28] 🔄 
🔄 Step 6: Pushing order to API...
[13:51:28] [DOC: 9309477] ℹ️  Pushing order via API for patient ID: f45b0f86-749a-4e1a-8d60-5b8a14059d95
[13:51:29] [DOC: 9309477] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18951"}
[13:51:29] ❌    ❌ Failed to push order
[13:51:29] 🔄 
🔄 Step 7: Writing to CSV...
[13:51:29] [DOC: 9309477] ℹ️  Calculated age: 75 from DOB: 02/02/1950
[13:51:29] [DOC: 9309477] ℹ️  Service Line extracted: 'Hospice'
[13:51:29] [DOC: 9309477] ℹ️  Payer Source extracted: 'Medicare'
[13:51:29] [DOC: 9309477] ℹ️  Diagnosis codes being written:
[13:51:29] [DOC: 9309477] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:51:29] [DOC: 9309477] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:51:29] [DOC: 9309477] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:51:29] [DOC: 9309477] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:51:29] [DOC: 9309477] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:51:29] [DOC: 9309477] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:51:29] [DOC: 9309477] ✅ Patient data written to CSV: John Nunes | Sex: MALE | Age: 75 | Service: Hospice | Payer: Medicare | MRN: B3700288839202
[13:51:29] ✅    ✅ Document 9309477 processed and saved successfully
[13:51:29] 🔄 
🔄 Step 8: Saving API details...
[13:51:29] [DOC: 9309477] ℹ️  API push details saved for document 9309477
[13:51:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309432                         ║
================================================================================
[13:51:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:51:29] ℹ️  Date: 05/23/2025
[13:51:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:51:32] [DOC: 9309432] ✅ Text extracted using pdfplumber (3983 chars)
[13:51:32] ✅    ✅ Text extracted using pdfplumber (3983 chars)
[13:51:32] 🔄 
🔄 Step 2: Extracting patient data...
[13:51:35] ℹ️  AI extracted raw sex value: 'F'
[13:51:35] ℹ️  AI extracted service line: 'PT, OT'
[13:51:35] ℹ️  AI extracted payer source: ''
[13:51:35] ℹ️  AI extracted diagnoses:
[13:51:35] ℹ️    - Diagnosis 1: 'M16.11'
[13:51:35] ℹ️    - Diagnosis 2: 'M85.851'
[13:51:35] ℹ️    - Diagnosis 3: 'E11.9'
[13:51:35] ℹ️    - Diagnosis 4: ''
[13:51:35] ℹ️    - Diagnosis 5: ''
[13:51:35] ℹ️    - Diagnosis 6: ''
[13:51:35] ℹ️  Final extracted MRN: 'MA240802044803'
[13:51:35] ℹ️  Final extracted Sex: 'FEMALE'
[13:51:35] ℹ️  Final extracted Service Line: 'PT, OT'
[13:51:35] ℹ️  Final extracted Payer Source: ''
[13:51:35] ✅ Patient data extraction completed successfully
[13:51:35] ✅    ✅ Patient data extracted successfully
[13:51:35] 📊 Patient Response
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:51:35] ✅    ✅ Patient identified: Sheena Fonseca
[13:51:35] ✅    ✅ Patient name validation passed
[13:51:35] 🔄 
🔄 Step 3: Processing patient dates...
[13:51:35] [DOC: 9309432] ℹ️  DOB normalized: 04/23/1948
[13:51:35] [DOC: 9309432] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[13:51:35] [DOC: 9309432] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[13:51:35] [DOC: 9309432] ✅ Patient date processing completed successfully
[13:51:35] ✅    ✅ Date processing completed
[13:51:35] 📊 Processed Patient Data
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:51:35] 🔄 
🔄 Step 4: Extracting order data...
[13:51:37] ℹ️  Order extraction - MRN: 'MA240802044803'
[13:51:37] ℹ️  Order extraction - Sex: 'FEMALE'
[13:51:37] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:51:37] ℹ️  Order extraction - Payer Source: ''
[13:51:37] ✅ Order data extraction completed successfully
[13:51:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:51:37] ℹ️  Using MRN from patient data: 'MA240802044803' over 'MA240802044803'
[13:51:37] ℹ️  Service line consistent in both sources: 'PT, OT'
[13:51:37] ✅ Patient name cross-validation successful
[13:51:37] ✅    ✅ Data merged successfully
[13:51:39] ✅    ✅ Order data extracted and validated
[13:51:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:51:44] [DOC: 9309432] ℹ️  Patient not found in cache or API: Sheena Fonseca
[13:51:44] [DOC: 9309432] ℹ️  Patient not found, creating new patient via API...
[13:51:44] [DOC: 9309432] ℹ️  Creating patient via API: Sheena Fonseca
[13:51:45] [DOC: 9309432] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:51:45] ❌    ❌ Failed to create patient
[13:51:45] [DOC: 9309432] ℹ️  API push details saved for document 9309432
================================================================================
║                        Processing Document ID: 9309431                         ║
================================================================================
[13:51:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:51:45] ℹ️  Date: 05/23/2025
[13:51:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:51:48] [DOC: 9309431] ✅ Text extracted using pdfplumber (13710 chars)
[13:51:48] ✅    ✅ Text extracted using pdfplumber (13710 chars)
[13:51:48] 🔄 
🔄 Step 2: Extracting patient data...
[13:51:51] ℹ️  AI extracted raw sex value: 'F'
[13:51:51] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[13:51:51] ℹ️  AI extracted payer source: 'Medicare'
[13:51:51] ℹ️  AI extracted diagnoses:
[13:51:51] ℹ️    - Diagnosis 1: 'M16.11'
[13:51:51] ℹ️    - Diagnosis 2: 'M85.851'
[13:51:51] ℹ️    - Diagnosis 3: 'E11.9'
[13:51:51] ℹ️    - Diagnosis 4: 'J45.909'
[13:51:51] ℹ️    - Diagnosis 5: 'I10'
[13:51:51] ℹ️    - Diagnosis 6: 'G43.909'
[13:51:51] ℹ️  Final extracted MRN: 'MA240802044803'
[13:51:51] ℹ️  Final extracted Sex: 'FEMALE'
[13:51:51] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[13:51:51] ℹ️  Final extracted Payer Source: 'Medicare'
[13:51:51] ✅ Patient data extraction completed successfully
[13:51:51] ✅    ✅ Patient data extracted successfully
[13:51:51] 📊 Patient Response
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 304 Crossroads Dr
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (774) 929-0930
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/27/2025', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G43.909'}]
[13:51:51] ✅    ✅ Patient identified: Sheena Fonseca
[13:51:51] ✅    ✅ Patient name validation passed
[13:51:51] 🔄 
🔄 Step 3: Processing patient dates...
[13:51:51] [DOC: 9309431] ℹ️  DOB normalized: 04/23/1948
[13:51:51] [DOC: 9309431] ℹ️  Episode startOfCare normalized: 01/27/2025
[13:51:51] [DOC: 9309431] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[13:51:51] [DOC: 9309431] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[13:51:51] [DOC: 9309431] ✅ Patient date processing completed successfully
[13:51:51] ✅    ✅ Date processing completed
[13:51:51] 📊 Processed Patient Data
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 304 Crossroads Dr
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (774) 929-0930
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/27/2025', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G43.909'}]
[13:51:51] 🔄 
🔄 Step 4: Extracting order data...
[13:51:54] ℹ️  Order extraction - MRN: 'MA240802044803'
[13:51:54] ℹ️  Order extraction - Sex: 'FEMALE'
[13:51:54] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:51:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:51:54] ✅ Order data extraction completed successfully
[13:51:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:51:54] ℹ️  Using MRN from patient data: 'MA240802044803' over 'MA240802044803'
[13:51:54] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[13:51:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:51:54] ✅ Patient name cross-validation successful
[13:51:54] ✅    ✅ Data merged successfully
[13:51:55] ✅    ✅ Order data extracted and validated
[13:51:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:02] [DOC: 9309431] ℹ️  Patient not found in cache or API: Sheena Fonseca
[13:52:02] [DOC: 9309431] ℹ️  Patient not found, creating new patient via API...
[13:52:02] [DOC: 9309431] ℹ️  Creating patient via API: Sheena Fonseca
[13:52:03] [DOC: 9309431] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:52:03] ❌    ❌ Failed to create patient
[13:52:03] [DOC: 9309431] ℹ️  API push details saved for document 9309431
================================================================================
║                        Processing Document ID: 9309429                         ║
================================================================================
[13:52:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:52:03] ℹ️  Date: 05/23/2025
[13:52:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:05] [DOC: 9309429] ✅ Text extracted using pdfplumber (1164 chars)
[13:52:05] ✅    ✅ Text extracted using pdfplumber (1164 chars)
[13:52:05] 🔄 
🔄 Step 2: Extracting patient data...
[13:52:08] ℹ️  AI extracted raw sex value: ''
[13:52:08] ℹ️  AI extracted service line: 'Physical Therapy'
[13:52:08] ℹ️  AI extracted payer source: ''
[13:52:08] ℹ️  AI extracted diagnoses:
[13:52:08] ℹ️    - Diagnosis 1: 'N30.00'
[13:52:08] ℹ️    - Diagnosis 2: 'E11.9'
[13:52:08] ℹ️    - Diagnosis 3: 'F41.1'
[13:52:08] ℹ️    - Diagnosis 4: ''
[13:52:08] ℹ️    - Diagnosis 5: ''
[13:52:08] ℹ️    - Diagnosis 6: ''
[13:52:08] ℹ️  Final extracted MRN: '101002392'
[13:52:08] ℹ️  Final extracted Sex: ''
[13:52:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:52:08] ℹ️  Final extracted Payer Source: ''
[13:52:08] ✅ Patient data extraction completed successfully
[13:52:08] ✅    ✅ Patient data extracted successfully
[13:52:08] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:52:08] ✅    ✅ Patient identified: Virginia Brunton
[13:52:08] ✅    ✅ Patient name validation passed
[13:52:08] 🔄 
🔄 Step 3: Processing patient dates...
[13:52:08] [DOC: 9309429] ℹ️  DOB normalized: 06/05/1940
[13:52:08] [DOC: 9309429] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[13:52:08] [DOC: 9309429] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[13:52:08] [DOC: 9309429] ✅ Patient date processing completed successfully
[13:52:08] ✅    ✅ Date processing completed
[13:52:08] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:52:08] 🔄 
🔄 Step 4: Extracting order data...
[13:52:10] ℹ️  Order extraction - MRN: '101002392'
[13:52:10] ℹ️  Order extraction - Sex: ''
[13:52:10] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:52:10] ℹ️  Order extraction - Payer Source: ''
[13:52:10] ✅ Order data extraction completed successfully
[13:52:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:52:10] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[13:52:10] ℹ️  Inferred sex as FEMALE from name: Virginia
[13:52:10] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:52:10] ✅ Patient name cross-validation successful
[13:52:10] ✅    ✅ Data merged successfully
[13:52:12] ✅    ✅ Order data extracted and validated
[13:52:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:39] [DOC: 9309429] ✅ Patient exists in API: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:52:39] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:52:39] 🔄 
🔄 Step 6: Pushing order to API...
[13:52:39] [DOC: 9309429] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:52:40] [DOC: 9309429] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13405"}
[13:52:40] ❌    ❌ Failed to push order
[13:52:40] 🔄 
🔄 Step 7: Writing to CSV...
[13:52:40] [DOC: 9309429] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[13:52:40] [DOC: 9309429] ℹ️  Service Line extracted: 'Physical Therapy'
[13:52:40] [DOC: 9309429] ℹ️  Payer Source extracted: ''
[13:52:40] [DOC: 9309429] ℹ️  Diagnosis codes being written:
[13:52:40] [DOC: 9309429] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[13:52:40] [DOC: 9309429] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[13:52:40] [DOC: 9309429] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[13:52:40] [DOC: 9309429] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:52:40] [DOC: 9309429] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:52:40] [DOC: 9309429] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:52:40] [DOC: 9309429] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Physical Therapy | Payer:  | MRN: 101002392
[13:52:40] ✅    ✅ Document 9309429 processed and saved successfully
[13:52:40] 🔄 
🔄 Step 8: Saving API details...
[13:52:40] [DOC: 9309429] ℹ️  API push details saved for document 9309429
[13:52:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309428                         ║
================================================================================
[13:52:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:52:40] ℹ️  Date: 05/23/2025
[13:52:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:44] [DOC: 9309428] ✅ Text extracted using pdfplumber (1446 chars)
[13:52:44] ✅    ✅ Text extracted using pdfplumber (1446 chars)
[13:52:44] 🔄 
🔄 Step 2: Extracting patient data...
[13:52:47] ℹ️  AI extracted raw sex value: ''
[13:52:47] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:52:47] ℹ️  AI extracted payer source: ''
[13:52:47] ℹ️  AI extracted diagnoses:
[13:52:47] ℹ️    - Diagnosis 1: 'N30.00'
[13:52:47] ℹ️    - Diagnosis 2: 'E11.9'
[13:52:47] ℹ️    - Diagnosis 3: 'F41.1'
[13:52:47] ℹ️    - Diagnosis 4: 'None'
[13:52:47] ℹ️    - Diagnosis 5: 'None'
[13:52:47] ℹ️    - Diagnosis 6: 'None'
[13:52:47] ℹ️  Final extracted MRN: '101002392'
[13:52:47] ℹ️  Final extracted Sex: ''
[13:52:47] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:52:47] ℹ️  Final extracted Payer Source: ''
[13:52:47] ✅ Patient data extraction completed successfully
[13:52:47] ✅    ✅ Patient data extracted successfully
[13:52:47] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:52:47] ✅    ✅ Patient identified: Virginia Brunton
[13:52:47] ✅    ✅ Patient name validation passed
[13:52:47] 🔄 
🔄 Step 3: Processing patient dates...
[13:52:47] [DOC: 9309428] ℹ️  DOB normalized: 06/05/1940
[13:52:47] [DOC: 9309428] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[13:52:47] [DOC: 9309428] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[13:52:47] [DOC: 9309428] ✅ Patient date processing completed successfully
[13:52:47] ✅    ✅ Date processing completed
[13:52:47] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[13:52:47] 🔄 
🔄 Step 4: Extracting order data...
[13:52:50] ℹ️  Order extraction - MRN: '101002392'
[13:52:50] ℹ️  Order extraction - Sex: ''
[13:52:50] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[13:52:50] ℹ️  Order extraction - Payer Source: ''
[13:52:50] ✅ Order data extraction completed successfully
[13:52:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:52:50] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[13:52:50] ℹ️  Inferred sex as FEMALE from name: Virginia
[13:52:50] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[13:52:50] ✅ Patient name cross-validation successful
[13:52:50] ✅    ✅ Data merged successfully
[13:52:52] ✅    ✅ Order data extracted and validated
[13:52:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:52] [DOC: 9309428] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:52:52] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:52:52] 🔄 
🔄 Step 6: Pushing order to API...
[13:52:52] [DOC: 9309428] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:52:53] [DOC: 9309428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13406"}
[13:52:53] ❌    ❌ Failed to push order
[13:52:53] 🔄 
🔄 Step 7: Writing to CSV...
[13:52:53] [DOC: 9309428] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[13:52:53] [DOC: 9309428] ℹ️  Service Line extracted: 'Occupational Therapy'
[13:52:53] [DOC: 9309428] ℹ️  Payer Source extracted: ''
[13:52:53] [DOC: 9309428] ℹ️  Diagnosis codes being written:
[13:52:53] [DOC: 9309428] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[13:52:53] [DOC: 9309428] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[13:52:53] [DOC: 9309428] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[13:52:53] [DOC: 9309428] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:52:53] [DOC: 9309428] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:52:53] [DOC: 9309428] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:52:53] [DOC: 9309428] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Occupational Therapy | Payer:  | MRN: 101002392
[13:52:53] ✅    ✅ Document 9309428 processed and saved successfully
[13:52:53] 🔄 
🔄 Step 8: Saving API details...
[13:52:53] [DOC: 9309428] ℹ️  API push details saved for document 9309428
[13:52:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309425                         ║
================================================================================
[13:52:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:52:53] ℹ️  Date: 05/23/2025
[13:52:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:56] [DOC: 9309425] ✅ Text extracted using pdfplumber (11322 chars)
[13:52:56] ✅    ✅ Text extracted using pdfplumber (11322 chars)
[13:52:56] 🔄 
🔄 Step 2: Extracting patient data...
[13:52:59] ℹ️  AI extracted raw sex value: 'F'
[13:52:59] ℹ️  AI extracted service line: 'OT'
[13:52:59] ℹ️  AI extracted payer source: 'None'
[13:52:59] ℹ️  AI extracted diagnoses:
[13:52:59] ℹ️    - Diagnosis 1: 'None'
[13:52:59] ℹ️    - Diagnosis 2: 'None'
[13:52:59] ℹ️    - Diagnosis 3: 'None'
[13:52:59] ℹ️    - Diagnosis 4: 'None'
[13:52:59] ℹ️    - Diagnosis 5: 'None'
[13:52:59] ℹ️    - Diagnosis 6: 'None'
[13:52:59] ℹ️  Final extracted MRN: '101002392'
[13:52:59] ℹ️  Final extracted Sex: 'FEMALE'
[13:52:59] ℹ️  Final extracted Service Line: 'OT'
[13:52:59] ℹ️  Final extracted Payer Source: ''
[13:52:59] ✅ Patient data extraction completed successfully
[13:52:59] ✅    ✅ Patient data extracted successfully
[13:52:59] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:52:59] ✅    ✅ Patient identified: Virginia Brunton
[13:52:59] ✅    ✅ Patient name validation passed
[13:52:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:52:59] [DOC: 9309425] ℹ️  DOB normalized: 06/05/1940
[13:52:59] [DOC: 9309425] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[13:52:59] [DOC: 9309425] ✅ Patient date processing completed successfully
[13:52:59] ✅    ✅ Date processing completed
[13:52:59] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025'}]
[13:52:59] 🔄 
🔄 Step 4: Extracting order data...
[13:53:02] ℹ️  Order extraction - MRN: '101002392'
[13:53:02] ℹ️  Order extraction - Sex: 'FEMALE'
[13:53:02] ℹ️  Order extraction - Service Line: 'OT'
[13:53:02] ℹ️  Order extraction - Payer Source: ''
[13:53:02] ✅ Order data extraction completed successfully
[13:53:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:02] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[13:53:02] ℹ️  Service line consistent in both sources: 'OT'
[13:53:02] ✅ Patient name cross-validation successful
[13:53:02] ✅    ✅ Data merged successfully
[13:53:03] ✅    ✅ Order data extracted and validated
[13:53:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:53:03] [DOC: 9309425] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:53:03] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:53:03] 🔄 
🔄 Step 6: Pushing order to API...
[13:53:03] [DOC: 9309425] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[13:53:05] [DOC: 9309425] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:53:05] ❌    ❌ Failed to push order
[13:53:05] 🔄 
🔄 Step 7: Writing to CSV...
[13:53:05] [DOC: 9309425] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[13:53:05] [DOC: 9309425] ℹ️  Service Line extracted: 'OT'
[13:53:05] [DOC: 9309425] ℹ️  Payer Source extracted: ''
[13:53:05] [DOC: 9309425] ℹ️  Diagnosis codes being written:
[13:53:05] [DOC: 9309425] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:53:05] [DOC: 9309425] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:53:05] [DOC: 9309425] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:53:05] [DOC: 9309425] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:53:05] [DOC: 9309425] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:53:05] [DOC: 9309425] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:53:05] [DOC: 9309425] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: OT | Payer:  | MRN: 101002392
[13:53:05] ✅    ✅ Document 9309425 processed and saved successfully
[13:53:05] 🔄 
🔄 Step 8: Saving API details...
[13:53:05] [DOC: 9309425] ℹ️  API push details saved for document 9309425
[13:53:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309234                         ║
================================================================================
[13:53:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:53:05] ℹ️  Date: 05/23/2025
[13:53:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:53:06] [DOC: 9309234] ✅ Text extracted using pdfplumber (1177 chars)
[13:53:06] ✅    ✅ Text extracted using pdfplumber (1177 chars)
[13:53:06] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:09] ℹ️  AI extracted raw sex value: 'F'
[13:53:09] ℹ️  AI extracted service line: 'SLP'
[13:53:09] ℹ️  AI extracted payer source: ''
[13:53:09] ℹ️  AI extracted diagnoses:
[13:53:09] ℹ️    - Diagnosis 1: 'None'
[13:53:09] ℹ️    - Diagnosis 2: 'None'
[13:53:09] ℹ️    - Diagnosis 3: 'None'
[13:53:09] ℹ️    - Diagnosis 4: 'None'
[13:53:09] ℹ️    - Diagnosis 5: 'None'
[13:53:09] ℹ️    - Diagnosis 6: 'None'
[13:53:09] ℹ️  Final extracted MRN: '3032516'
[13:53:09] ℹ️  Final extracted Sex: 'FEMALE'
[13:53:09] ℹ️  Final extracted Service Line: 'SLP'
[13:53:09] ℹ️  Final extracted Payer Source: ''
[13:53:09] ✅ Patient data extraction completed successfully
[13:53:09] ✅    ✅ Patient data extracted successfully
[13:53:09] 📊 Patient Response
     └─ patientFName: Justina
     └─ patientLName: Teixeira
     └─ dob: 05/03/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3032516
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/22/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:53:09] ✅    ✅ Patient identified: Justina Teixeira
[13:53:09] ✅    ✅ Patient name validation passed
[13:53:09] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:09] [DOC: 9309234] ℹ️  DOB normalized: 05/03/1930
[13:53:09] [DOC: 9309234] ℹ️  Episode startOfEpisode normalized: 05/22/2025
[13:53:09] [DOC: 9309234] ✅ Patient date processing completed successfully
[13:53:09] ✅    ✅ Date processing completed
[13:53:09] 📊 Processed Patient Data
     └─ patientFName: Justina
     └─ patientLName: Teixeira
     └─ dob: 05/03/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3032516
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/22/2025'}]
[13:53:09] 🔄 
🔄 Step 4: Extracting order data...
[13:53:11] ℹ️  Order extraction - MRN: '3032516'
[13:53:11] ℹ️  Order extraction - Sex: 'FEMALE'
[13:53:11] ℹ️  Order extraction - Service Line: 'SLP'
[13:53:11] ℹ️  Order extraction - Payer Source: ''
[13:53:11] ✅ Order data extraction completed successfully
[13:53:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:11] ℹ️  Using MRN from patient data: '3032516' over '3032516'
[13:53:11] ℹ️  Service line consistent in both sources: 'SLP'
[13:53:11] ✅ Patient name cross-validation successful
[13:53:11] ✅    ✅ Data merged successfully
[13:53:12] ✅    ✅ Order data extracted and validated
[13:53:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:53:50] [DOC: 9309234] ℹ️  Patient not found in cache or API: Justina Teixeira
[13:53:50] [DOC: 9309234] ℹ️  Patient not found, creating new patient via API...
[13:53:50] [DOC: 9309234] ℹ️  Creating patient via API: Justina Teixeira
[13:53:51] [DOC: 9309234] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:53:51] ❌    ❌ Failed to create patient
[13:53:51] [DOC: 9309234] ℹ️  API push details saved for document 9309234
================================================================================
║                        Processing Document ID: 9309229                         ║
================================================================================
[13:53:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:53:51] ℹ️  Date: 05/23/2025
[13:53:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:53:55] [DOC: 9309229] ✅ Text extracted using pdfplumber (21090 chars)
[13:53:55] ✅    ✅ Text extracted using pdfplumber (21090 chars)
[13:53:55] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:59] ℹ️  AI extracted raw sex value: 'F'
[13:53:59] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[13:53:59] ℹ️  AI extracted payer source: ''
[13:53:59] ℹ️  AI extracted diagnoses:
[13:53:59] ℹ️    - Diagnosis 1: 'J15.9'
[13:53:59] ℹ️    - Diagnosis 2: 'J90'
[13:53:59] ℹ️    - Diagnosis 3: 'F03.90'
[13:53:59] ℹ️    - Diagnosis 4: 'I10'
[13:53:59] ℹ️    - Diagnosis 5: 'E03.9'
[13:53:59] ℹ️    - Diagnosis 6: ''
[13:53:59] ℹ️  Final extracted MRN: '3032516'
[13:53:59] ℹ️  Final extracted Sex: 'FEMALE'
[13:53:59] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[13:53:59] ℹ️  Final extracted Payer Source: ''
[13:53:59] ✅ Patient data extraction completed successfully
[13:53:59] ✅    ✅ Patient data extracted successfully
[13:53:59] 📊 Patient Response
     └─ patientFName: Justina
     └─ patientLName: Teixeira
     └─ dob: 05/03/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3032516
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'J15.9', 'secondDiagnosis': 'J90', 'thirdDiagnosis': 'F03.90', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': ''}]
[13:53:59] ✅    ✅ Patient identified: Justina Teixeira
[13:53:59] ✅    ✅ Patient name validation passed
[13:53:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:59] [DOC: 9309229] ℹ️  DOB normalized: 05/03/1930
[13:53:59] [DOC: 9309229] ℹ️  Episode startOfCare normalized: 05/02/2025
[13:53:59] [DOC: 9309229] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:53:59] [DOC: 9309229] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:53:59] [DOC: 9309229] ✅ Patient date processing completed successfully
[13:53:59] ✅    ✅ Date processing completed
[13:53:59] 📊 Processed Patient Data
     └─ patientFName: Justina
     └─ patientLName: Teixeira
     └─ dob: 05/03/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3032516
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'J15.9', 'secondDiagnosis': 'J90', 'thirdDiagnosis': 'F03.90', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': ''}]
[13:53:59] 🔄 
🔄 Step 4: Extracting order data...
[13:54:02] ℹ️  Order extraction - MRN: '3032516'
[13:54:02] ℹ️  Order extraction - Sex: 'FEMALE'
[13:54:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[13:54:02] ℹ️  Order extraction - Payer Source: ''
[13:54:02] ✅ Order data extraction completed successfully
[13:54:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:54:02] ℹ️  Using MRN from patient data: '3032516' over '3032516'
[13:54:02] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology' = 'Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[13:54:02] ✅ Patient name cross-validation successful
[13:54:02] ✅    ✅ Data merged successfully
[13:54:04] ✅    ✅ Order data extracted and validated
[13:54:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:54:21] [DOC: 9309229] ℹ️  Patient not found in cache or API: Justina Teixeira
[13:54:21] [DOC: 9309229] ℹ️  Patient not found, creating new patient via API...
[13:54:21] [DOC: 9309229] ℹ️  Creating patient via API: Justina Teixeira
[13:54:22] [DOC: 9309229] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:54:22] ❌    ❌ Failed to create patient
[13:54:22] [DOC: 9309229] ℹ️  API push details saved for document 9309229
================================================================================
║                        Processing Document ID: 9309226                         ║
================================================================================
[13:54:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:54:22] ℹ️  Date: 05/23/2025
[13:54:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:54:26] [DOC: 9309226] ✅ Text extracted using pdfplumber (1278 chars)
[13:54:26] ✅    ✅ Text extracted using pdfplumber (1278 chars)
[13:54:26] 🔄 
🔄 Step 2: Extracting patient data...
[13:54:28] ℹ️  AI extracted raw sex value: 'F'
[13:54:28] ℹ️  AI extracted service line: 'Nursing'
[13:54:28] ℹ️  AI extracted payer source: ''
[13:54:28] ℹ️  AI extracted diagnoses:
[13:54:28] ℹ️    - Diagnosis 1: 'None'
[13:54:28] ℹ️    - Diagnosis 2: 'None'
[13:54:28] ℹ️    - Diagnosis 3: 'None'
[13:54:28] ℹ️    - Diagnosis 4: 'None'
[13:54:28] ℹ️    - Diagnosis 5: 'None'
[13:54:28] ℹ️    - Diagnosis 6: 'None'
[13:54:28] ℹ️  Final extracted MRN: '2936720'
[13:54:28] ℹ️  Final extracted Sex: 'FEMALE'
[13:54:28] ℹ️  Final extracted Service Line: 'Nursing'
[13:54:28] ℹ️  Final extracted Payer Source: ''
[13:54:28] ✅ Patient data extraction completed successfully
[13:54:28] ✅    ✅ Patient data extracted successfully
[13:54:28] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:54:28] ✅    ✅ Patient identified: Stella Saint
[13:54:28] ✅    ✅ Patient name validation passed
[13:54:28] 🔄 
🔄 Step 3: Processing patient dates...
[13:54:28] [DOC: 9309226] ℹ️  DOB normalized: 07/02/1928
[13:54:28] [DOC: 9309226] ✅ Patient date processing completed successfully
[13:54:28] ✅    ✅ Date processing completed
[13:54:28] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:54:28] 🔄 
🔄 Step 4: Extracting order data...
[13:54:31] ℹ️  Order extraction - MRN: '2936720'
[13:54:31] ℹ️  Order extraction - Sex: 'FEMALE'
[13:54:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:54:31] ℹ️  Order extraction - Payer Source: ''
[13:54:31] ✅ Order data extraction completed successfully
[13:54:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:54:31] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[13:54:31] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[13:54:31] ✅ Patient name cross-validation successful
[13:54:31] ✅    ✅ Data merged successfully
[13:54:32] ✅    ✅ Order data extracted and validated
[13:54:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:54:32] [DOC: 9309226] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[13:54:32] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[13:54:32] 🔄 
🔄 Step 6: Pushing order to API...
[13:54:32] [DOC: 9309226] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[13:54:33] [DOC: 9309226] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18957"}
[13:54:33] ❌    ❌ Failed to push order
[13:54:33] 🔄 
🔄 Step 7: Writing to CSV...
[13:54:33] [DOC: 9309226] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[13:54:33] [DOC: 9309226] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[13:54:33] [DOC: 9309226] ℹ️  Payer Source extracted: ''
[13:54:33] [DOC: 9309226] ℹ️  Diagnosis codes being written:
[13:54:33] [DOC: 9309226] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:54:33] [DOC: 9309226] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:54:33] [DOC: 9309226] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:54:33] [DOC: 9309226] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:54:33] [DOC: 9309226] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:54:33] [DOC: 9309226] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:54:33] [DOC: 9309226] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2936720
[13:54:33] ✅    ✅ Document 9309226 processed and saved successfully
[13:54:33] 🔄 
🔄 Step 8: Saving API details...
[13:54:33] [DOC: 9309226] ℹ️  API push details saved for document 9309226
[13:54:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9308962                         ║
================================================================================
[13:54:33] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:54:33] ℹ️  Date: 05/23/2025
[13:54:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:54:35] [DOC: 9308962] ✅ Text extracted using pdfplumber (5005 chars)
[13:54:35] ✅    ✅ Text extracted using pdfplumber (5005 chars)
[13:54:35] 🔄 
🔄 Step 2: Extracting patient data...
[13:54:37] ℹ️  AI extracted raw sex value: 'None'
[13:54:37] ℹ️  AI extracted service line: 'None'
[13:54:37] ℹ️  AI extracted payer source: 'None'
[13:54:37] ℹ️  AI extracted diagnoses:
[13:54:37] ℹ️    - Diagnosis 1: ''
[13:54:37] ℹ️    - Diagnosis 2: ''
[13:54:37] ℹ️    - Diagnosis 3: ''
[13:54:37] ℹ️    - Diagnosis 4: ''
[13:54:37] ℹ️    - Diagnosis 5: ''
[13:54:37] ℹ️    - Diagnosis 6: ''
[13:54:37] ℹ️  Final extracted MRN: ''
[13:54:37] ℹ️  Final extracted Sex: ''
[13:54:37] ℹ️  Final extracted Service Line: ''
[13:54:37] ℹ️  Final extracted Payer Source: ''
[13:54:37] ✅ Patient data extraction completed successfully
[13:54:37] ✅    ✅ Patient data extracted successfully
[13:54:37] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[13:54:37] ⚠️     ❌ Insufficient patient data extracted
[13:54:37] [DOC: 9308962] ℹ️  API push details saved for document 9308962
================================================================================
║                        Processing Document ID: 9308952                         ║
================================================================================
[13:54:37] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:54:37] ℹ️  Date: 05/23/2025
[13:54:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:54:39] [DOC: 9308952] ✅ Text extracted using pdfplumber (1394 chars)
[13:54:39] ✅    ✅ Text extracted using pdfplumber (1394 chars)
[13:54:39] 🔄 
🔄 Step 2: Extracting patient data...
[13:54:42] ℹ️  AI extracted raw sex value: ''
[13:54:42] ℹ️  AI extracted service line: 'Home healthcare services'
[13:54:42] ℹ️  AI extracted payer source: ''
[13:54:42] ℹ️  AI extracted diagnoses:
[13:54:42] ℹ️    - Diagnosis 1: ''
[13:54:42] ℹ️    - Diagnosis 2: ''
[13:54:42] ℹ️    - Diagnosis 3: ''
[13:54:42] ℹ️    - Diagnosis 4: ''
[13:54:42] ℹ️    - Diagnosis 5: ''
[13:54:42] ℹ️    - Diagnosis 6: ''
[13:54:42] ℹ️  Final extracted MRN: ''
[13:54:42] ℹ️  Final extracted Sex: ''
[13:54:42] ℹ️  Final extracted Service Line: 'Home healthcare services'
[13:54:42] ℹ️  Final extracted Payer Source: ''
[13:54:42] ✅ Patient data extraction completed successfully
[13:54:42] ✅    ✅ Patient data extracted successfully
[13:54:42] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing Services
     └─ address: 125 High Street, Suite 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: jmartinez@vrnshh.com
     └─ phoneNumber: (774) 581-9986
     └─ serviceLine: Home healthcare services
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:54:42] ⚠️     ❌ Insufficient patient data extracted
[13:54:42] [DOC: 9308952] ℹ️  API push details saved for document 9308952
================================================================================
║                        Processing Document ID: 9308645                         ║
================================================================================
[13:54:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:54:42] ℹ️  Date: 05/23/2025
[13:54:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:54:43] [DOC: 9308645] ✅ Text extracted using pdfplumber (1116 chars)
[13:54:43] ✅    ✅ Text extracted using pdfplumber (1116 chars)
[13:54:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:54:46] ℹ️  AI extracted raw sex value: 'M'
[13:54:46] ℹ️  AI extracted service line: 'Physical Therapy'
[13:54:46] ℹ️  AI extracted payer source: ''
[13:54:46] ℹ️  AI extracted diagnoses:
[13:54:46] ℹ️    - Diagnosis 1: ''
[13:54:46] ℹ️    - Diagnosis 2: ''
[13:54:46] ℹ️    - Diagnosis 3: ''
[13:54:46] ℹ️    - Diagnosis 4: ''
[13:54:46] ℹ️    - Diagnosis 5: ''
[13:54:46] ℹ️    - Diagnosis 6: ''
[13:54:46] ℹ️  Final extracted MRN: '3022688'
[13:54:46] ℹ️  Final extracted Sex: 'MALE'
[13:54:46] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:54:46] ℹ️  Final extracted Payer Source: ''
[13:54:46] ✅ Patient data extraction completed successfully
[13:54:46] ✅    ✅ Patient data extracted successfully
[13:54:46] 📊 Patient Response
     └─ patientFName: Robert J
     └─ patientLName: Sylvia
     └─ dob: 08/20/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 3022688
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:54:46] ✅    ✅ Patient identified: Robert J Sylvia
[13:54:46] ✅    ✅ Patient name validation passed
[13:54:46] 🔄 
🔄 Step 3: Processing patient dates...
[13:54:46] [DOC: 9308645] ℹ️  DOB normalized: 08/20/1945
[13:54:46] [DOC: 9308645] ✅ Patient date processing completed successfully
[13:54:46] ✅    ✅ Date processing completed
[13:54:46] 📊 Processed Patient Data
     └─ patientFName: Robert J
     └─ patientLName: Sylvia
     └─ dob: 08/20/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 3022688
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:54:46] 🔄 
🔄 Step 4: Extracting order data...
[13:54:48] ℹ️  Order extraction - MRN: '3022688'
[13:54:48] ℹ️  Order extraction - Sex: 'MALE'
[13:54:48] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:54:48] ℹ️  Order extraction - Payer Source: ''
[13:54:48] ✅ Order data extraction completed successfully
[13:54:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:54:48] ℹ️  Using MRN from patient data: '3022688' over '3022688'
[13:54:48] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:54:48] ✅ Patient name cross-validation successful
[13:54:48] ✅    ✅ Data merged successfully
[13:54:49] ✅    ✅ Order data extracted and validated
[13:54:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:12] [DOC: 9308645] ℹ️  Patient not found in cache or API: Robert J Sylvia
[13:55:12] [DOC: 9308645] ℹ️  Patient not found, creating new patient via API...
[13:55:12] [DOC: 9308645] ℹ️  Creating patient via API: Robert J Sylvia
[13:55:14] [DOC: 9308645] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:55:14] ❌    ❌ Failed to create patient
[13:55:14] [DOC: 9308645] ℹ️  API push details saved for document 9308645
================================================================================
║                        Processing Document ID: 9308632                         ║
================================================================================
[13:55:14] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:55:14] ℹ️  Date: 05/23/2025
[13:55:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:15] [DOC: 9308632] ✅ Text extracted using pdfplumber (1095 chars)
[13:55:15] ✅    ✅ Text extracted using pdfplumber (1095 chars)
[13:55:15] 🔄 
🔄 Step 2: Extracting patient data...
[13:55:18] ℹ️  AI extracted raw sex value: 'F'
[13:55:18] ℹ️  AI extracted service line: 'Physical Therapy'
[13:55:18] ℹ️  AI extracted payer source: ''
[13:55:18] ℹ️  AI extracted diagnoses:
[13:55:18] ℹ️    - Diagnosis 1: ''
[13:55:18] ℹ️    - Diagnosis 2: ''
[13:55:18] ℹ️    - Diagnosis 3: ''
[13:55:18] ℹ️    - Diagnosis 4: ''
[13:55:18] ℹ️    - Diagnosis 5: ''
[13:55:18] ℹ️    - Diagnosis 6: ''
[13:55:18] ℹ️  Final extracted MRN: '2240353'
[13:55:18] ℹ️  Final extracted Sex: 'FEMALE'
[13:55:18] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:55:18] ℹ️  Final extracted Payer Source: ''
[13:55:18] ✅ Patient data extraction completed successfully
[13:55:18] ✅    ✅ Patient data extracted successfully
[13:55:18] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:18] ✅    ✅ Patient identified: Eileen Bettencourt
[13:55:18] ✅    ✅ Patient name validation passed
[13:55:18] 🔄 
🔄 Step 3: Processing patient dates...
[13:55:18] [DOC: 9308632] ℹ️  DOB normalized: 04/20/1945
[13:55:18] [DOC: 9308632] ✅ Patient date processing completed successfully
[13:55:18] ✅    ✅ Date processing completed
[13:55:18] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:18] 🔄 
🔄 Step 4: Extracting order data...
[13:55:20] ℹ️  Order extraction - MRN: '2240353'
[13:55:20] ℹ️  Order extraction - Sex: 'FEMALE'
[13:55:20] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:55:20] ℹ️  Order extraction - Payer Source: ''
[13:55:20] ✅ Order data extraction completed successfully
[13:55:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:55:20] ℹ️  Using MRN from patient data: '2240353' over '2240353'
[13:55:20] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:55:20] ✅ Patient name cross-validation successful
[13:55:20] ✅    ✅ Data merged successfully
[13:55:21] ✅    ✅ Order data extracted and validated
[13:55:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:21] [DOC: 9308632] ✅ Patient found in local cache: Eileen Bettencourt, ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[13:55:21] ✅    ✅ Existing patient found with ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[13:55:21] 🔄 
🔄 Step 6: Pushing order to API...
[13:55:21] [DOC: 9308632] ℹ️  Pushing order via API for patient ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[13:55:22] [DOC: 9308632] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18961"}
[13:55:22] ❌    ❌ Failed to push order
[13:55:22] 🔄 
🔄 Step 7: Writing to CSV...
[13:55:22] [DOC: 9308632] ℹ️  Calculated age: 80 from DOB: 04/20/1945
[13:55:22] [DOC: 9308632] ℹ️  Service Line extracted: 'Physical Therapy'
[13:55:22] [DOC: 9308632] ℹ️  Payer Source extracted: ''
[13:55:22] [DOC: 9308632] ℹ️  Diagnosis codes being written:
[13:55:22] [DOC: 9308632] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:55:22] [DOC: 9308632] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:55:22] [DOC: 9308632] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:55:22] [DOC: 9308632] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:55:22] [DOC: 9308632] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:55:22] [DOC: 9308632] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:55:22] [DOC: 9308632] ✅ Patient data written to CSV: Eileen Bettencourt | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: 2240353
[13:55:22] ✅    ✅ Document 9308632 processed and saved successfully
[13:55:22] 🔄 
🔄 Step 8: Saving API details...
[13:55:22] [DOC: 9308632] ℹ️  API push details saved for document 9308632
[13:55:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307441                         ║
================================================================================
[13:55:22] ℹ️  Agency: Dartmouth HH
[13:55:22] ℹ️  Date: 05/22/2025
[13:55:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:24] [DOC: 9307441] ✅ Text extracted using pdfplumber (1542 chars)
[13:55:24] ✅    ✅ Text extracted using pdfplumber (1542 chars)
[13:55:24] 🔄 
🔄 Step 2: Extracting patient data...
[13:55:27] ℹ️  AI extracted raw sex value: 'F'
[13:55:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:55:27] ℹ️  AI extracted payer source: 'Medicare'
[13:55:27] ℹ️  AI extracted diagnoses:
[13:55:27] ℹ️    - Diagnosis 1: ''
[13:55:27] ℹ️    - Diagnosis 2: ''
[13:55:27] ℹ️    - Diagnosis 3: ''
[13:55:27] ℹ️    - Diagnosis 4: ''
[13:55:27] ℹ️    - Diagnosis 5: ''
[13:55:27] ℹ️    - Diagnosis 6: ''
[13:55:27] ℹ️  Final extracted MRN: '6448011'
[13:55:27] ℹ️  Final extracted Sex: 'FEMALE'
[13:55:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:55:27] ℹ️  Final extracted Payer Source: 'Medicare'
[13:55:27] ✅ Patient data extraction completed successfully
[13:55:27] ✅    ✅ Patient data extracted successfully
[13:55:27] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:27] ✅    ✅ Patient identified: Kim Teixeira
[13:55:27] ✅    ✅ Patient name validation passed
[13:55:27] 🔄 
🔄 Step 3: Processing patient dates...
[13:55:27] [DOC: 9307441] ℹ️  DOB normalized: 02/28/1964
[13:55:27] [DOC: 9307441] ℹ️  Episode startOfCare normalized: 01/18/2025
[13:55:27] [DOC: 9307441] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[13:55:27] [DOC: 9307441] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[13:55:27] [DOC: 9307441] ✅ Patient date processing completed successfully
[13:55:27] ✅    ✅ Date processing completed
[13:55:27] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:27] 🔄 
🔄 Step 4: Extracting order data...
[13:55:30] ℹ️  Order extraction - MRN: ''
[13:55:30] ℹ️  Order extraction - Sex: 'FEMALE'
[13:55:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:55:30] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:55:30] ✅ Order data extraction completed successfully
[13:55:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:55:30] ℹ️  Using MRN from patient data: '6448011'
[13:55:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:55:30] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:55:30] ✅ Patient name cross-validation successful
[13:55:30] ✅    ✅ Data merged successfully
[13:55:31] ✅    ✅ Order data extracted and validated
[13:55:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:31] [DOC: 9307441] ✅ Patient found in local cache: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[13:55:31] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[13:55:31] 🔄 
🔄 Step 6: Pushing order to API...
[13:55:31] [DOC: 9307441] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[13:55:32] [DOC: 9307441] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14243"}
[13:55:32] ❌    ❌ Failed to push order
[13:55:32] 🔄 
🔄 Step 7: Writing to CSV...
[13:55:32] [DOC: 9307441] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[13:55:32] [DOC: 9307441] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:55:32] [DOC: 9307441] ℹ️  Payer Source extracted: 'Medicare'
[13:55:32] [DOC: 9307441] ℹ️  Diagnosis codes being written:
[13:55:32] [DOC: 9307441] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:55:32] [DOC: 9307441] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:55:32] [DOC: 9307441] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:55:32] [DOC: 9307441] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:55:32] [DOC: 9307441] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:55:32] [DOC: 9307441] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:55:32] [DOC: 9307441] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: Skilled Nursing | Payer: Medicare | MRN: 6448011
[13:55:32] ✅    ✅ Document 9307441 processed and saved successfully
[13:55:32] 🔄 
🔄 Step 8: Saving API details...
[13:55:32] [DOC: 9307441] ℹ️  API push details saved for document 9307441
[13:55:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307440                         ║
================================================================================
[13:55:32] ℹ️  Agency: Dartmouth HH
[13:55:32] ℹ️  Date: 05/22/2025
[13:55:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:39] [DOC: 9307440] ✅ Text extracted using pdfplumber (4840 chars)
[13:55:39] ✅    ✅ Text extracted using pdfplumber (4840 chars)
[13:55:39] 🔄 
🔄 Step 2: Extracting patient data...
[13:55:42] ℹ️  AI extracted raw sex value: 'F'
[13:55:42] ℹ️  AI extracted service line: 'PT'
[13:55:42] ℹ️  AI extracted payer source: 'Medicare'
[13:55:42] ℹ️  AI extracted diagnoses:
[13:55:42] ℹ️    - Diagnosis 1: ''
[13:55:42] ℹ️    - Diagnosis 2: ''
[13:55:42] ℹ️    - Diagnosis 3: ''
[13:55:42] ℹ️    - Diagnosis 4: ''
[13:55:42] ℹ️    - Diagnosis 5: ''
[13:55:42] ℹ️    - Diagnosis 6: ''
[13:55:42] ℹ️  Final extracted MRN: '382011'
[13:55:42] ℹ️  Final extracted Sex: 'FEMALE'
[13:55:42] ℹ️  Final extracted Service Line: 'PT'
[13:55:42] ℹ️  Final extracted Payer Source: 'Medicare'
[13:55:42] ✅ Patient data extraction completed successfully
[13:55:42] ✅    ✅ Patient data extracted successfully
[13:55:42] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Saint Aubin
     └─ dob: 08/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 382011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:42] ✅    ✅ Patient identified: Marilyn Saint Aubin
[13:55:42] ✅    ✅ Patient name validation passed
[13:55:42] 🔄 
🔄 Step 3: Processing patient dates...
[13:55:42] [DOC: 9307440] ℹ️  DOB normalized: 08/11/1940
[13:55:42] [DOC: 9307440] ℹ️  Episode startOfCare normalized: 03/19/2025
[13:55:42] [DOC: 9307440] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[13:55:42] [DOC: 9307440] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[13:55:42] [DOC: 9307440] ✅ Patient date processing completed successfully
[13:55:42] ✅    ✅ Date processing completed
[13:55:42] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Saint Aubin
     └─ dob: 08/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 382011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:42] 🔄 
🔄 Step 4: Extracting order data...
[13:55:44] ℹ️  Order extraction - MRN: ''
[13:55:44] ℹ️  Order extraction - Sex: 'FEMALE'
[13:55:44] ℹ️  Order extraction - Service Line: 'PT'
[13:55:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:55:44] ✅ Order data extraction completed successfully
[13:55:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:55:44] ℹ️  Using MRN from patient data: '382011'
[13:55:44] ℹ️  Service line consistent in both sources: 'PT'
[13:55:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:55:44] ✅ Patient name cross-validation successful
[13:55:44] ✅    ✅ Data merged successfully
[13:55:45] ✅    ✅ Order data extracted and validated
[13:55:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:58] [DOC: 9307440] ℹ️  Patient not found in cache or API: Marilyn Saint Aubin
[13:55:58] [DOC: 9307440] ℹ️  Patient not found, creating new patient via API...
[13:55:58] [DOC: 9307440] ℹ️  Creating patient via API: Marilyn Saint Aubin
[13:56:00] [DOC: 9307440] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:56:00] ❌    ❌ Failed to create patient
[13:56:00] [DOC: 9307440] ℹ️  API push details saved for document 9307440
================================================================================
║                        Processing Document ID: 9307426                         ║
================================================================================
[13:56:00] ℹ️  Agency: Dartmouth HH
[13:56:00] ℹ️  Date: 05/22/2025
[13:56:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:01] [DOC: 9307426] ✅ Text extracted using pdfplumber (1022 chars)
[13:56:01] ✅    ✅ Text extracted using pdfplumber (1022 chars)
[13:56:01] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:04] ℹ️  AI extracted raw sex value: 'F'
[13:56:04] ℹ️  AI extracted service line: 'HHA'
[13:56:04] ℹ️  AI extracted payer source: 'Medicare'
[13:56:04] ℹ️  AI extracted diagnoses:
[13:56:04] ℹ️    - Diagnosis 1: ''
[13:56:04] ℹ️    - Diagnosis 2: ''
[13:56:04] ℹ️    - Diagnosis 3: ''
[13:56:04] ℹ️    - Diagnosis 4: ''
[13:56:04] ℹ️    - Diagnosis 5: ''
[13:56:04] ℹ️    - Diagnosis 6: ''
[13:56:04] ℹ️  Final extracted MRN: '323014'
[13:56:04] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:04] ℹ️  Final extracted Service Line: 'HHA'
[13:56:04] ℹ️  Final extracted Payer Source: 'Medicare'
[13:56:04] ✅ Patient data extraction completed successfully
[13:56:04] ✅    ✅ Patient data extracted successfully
[13:56:04] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:04] ✅    ✅ Patient identified: Sandra Plissey
[13:56:04] ✅    ✅ Patient name validation passed
[13:56:04] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:04] [DOC: 9307426] ℹ️  DOB normalized: 11/19/1943
[13:56:04] [DOC: 9307426] ℹ️  Episode startOfCare normalized: 10/07/2024
[13:56:04] [DOC: 9307426] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[13:56:04] [DOC: 9307426] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[13:56:04] [DOC: 9307426] ✅ Patient date processing completed successfully
[13:56:04] ✅    ✅ Date processing completed
[13:56:04] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:04] 🔄 
🔄 Step 4: Extracting order data...
[13:56:07] ℹ️  Order extraction - MRN: ''
[13:56:07] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:07] ℹ️  Order extraction - Service Line: ''
[13:56:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:56:07] ✅ Order data extraction completed successfully
[13:56:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:07] ℹ️  Using MRN from patient data: '323014'
[13:56:07] ℹ️  Using service line from patient data: 'HHA'
[13:56:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:56:07] ✅ Patient name cross-validation successful
[13:56:07] ✅    ✅ Data merged successfully
[13:56:08] ✅    ✅ Order data extracted and validated
[13:56:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:14] [DOC: 9307426] ✅ Patient exists in API: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[13:56:14] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[13:56:14] 🔄 
🔄 Step 6: Pushing order to API...
[13:56:14] [DOC: 9307426] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[13:56:15] [DOC: 9307426] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13081"}
[13:56:15] ❌    ❌ Failed to push order
[13:56:15] 🔄 
🔄 Step 7: Writing to CSV...
[13:56:15] [DOC: 9307426] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[13:56:15] [DOC: 9307426] ℹ️  Service Line extracted: 'HHA'
[13:56:15] [DOC: 9307426] ℹ️  Payer Source extracted: 'Medicare'
[13:56:15] [DOC: 9307426] ℹ️  Diagnosis codes being written:
[13:56:15] [DOC: 9307426] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:56:15] [DOC: 9307426] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:56:15] [DOC: 9307426] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:56:15] [DOC: 9307426] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:56:15] [DOC: 9307426] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:56:15] [DOC: 9307426] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:56:15] [DOC: 9307426] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: HHA | Payer: Medicare | MRN: 323014
[13:56:15] ✅    ✅ Document 9307426 processed and saved successfully
[13:56:15] 🔄 
🔄 Step 8: Saving API details...
[13:56:15] [DOC: 9307426] ℹ️  API push details saved for document 9307426
[13:56:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307422                         ║
================================================================================
[13:56:15] ℹ️  Agency: Dartmouth HH
[13:56:15] ℹ️  Date: 05/22/2025
[13:56:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:17] [DOC: 9307422] ✅ Text extracted using pdfplumber (9561 chars)
[13:56:17] ✅    ✅ Text extracted using pdfplumber (9561 chars)
[13:56:17] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:20] ℹ️  AI extracted raw sex value: 'F'
[13:56:20] ℹ️  AI extracted service line: 'OT'
[13:56:20] ℹ️  AI extracted payer source: 'Medicare'
[13:56:20] ℹ️  AI extracted diagnoses:
[13:56:20] ℹ️    - Diagnosis 1: ''
[13:56:20] ℹ️    - Diagnosis 2: ''
[13:56:20] ℹ️    - Diagnosis 3: ''
[13:56:20] ℹ️    - Diagnosis 4: ''
[13:56:20] ℹ️    - Diagnosis 5: ''
[13:56:20] ℹ️    - Diagnosis 6: ''
[13:56:20] ℹ️  Final extracted MRN: '3134011'
[13:56:20] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:20] ℹ️  Final extracted Service Line: 'OT'
[13:56:20] ℹ️  Final extracted Payer Source: 'Medicare'
[13:56:20] ✅ Patient data extraction completed successfully
[13:56:20] ✅    ✅ Patient data extracted successfully
[13:56:20] 📊 Patient Response
     └─ patientFName: Florence
     └─ patientLName: Dugal
     └─ dob: 06/25/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3134011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:20] ✅    ✅ Patient identified: Florence Dugal
[13:56:20] ✅    ✅ Patient name validation passed
[13:56:20] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:20] [DOC: 9307422] ℹ️  DOB normalized: 06/25/1930
[13:56:20] [DOC: 9307422] ℹ️  Episode startOfCare normalized: 05/07/2025
[13:56:20] [DOC: 9307422] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:56:20] [DOC: 9307422] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:56:20] [DOC: 9307422] ✅ Patient date processing completed successfully
[13:56:20] ✅    ✅ Date processing completed
[13:56:20] 📊 Processed Patient Data
     └─ patientFName: Florence
     └─ patientLName: Dugal
     └─ dob: 06/25/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3134011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:20] 🔄 
🔄 Step 4: Extracting order data...
[13:56:23] ℹ️  Order extraction - MRN: ''
[13:56:23] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:23] ℹ️  Order extraction - Service Line: 'OT'
[13:56:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:56:23] ✅ Order data extraction completed successfully
[13:56:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:23] ℹ️  Using MRN from patient data: '3134011'
[13:56:23] ℹ️  Service line consistent in both sources: 'OT'
[13:56:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:56:23] ✅ Patient name cross-validation successful
[13:56:23] ✅    ✅ Data merged successfully
[13:56:24] ✅    ✅ Order data extracted and validated
[13:56:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:40] [DOC: 9307422] ✅ Patient exists in API: Florence Dugal, ID: 66fbf2e7-4547-48c7-90af-626ad2b8f076
[13:56:40] ✅    ✅ Existing patient found with ID: 66fbf2e7-4547-48c7-90af-626ad2b8f076
[13:56:40] 🔄 
🔄 Step 6: Pushing order to API...
[13:56:40] [DOC: 9307422] ℹ️  Pushing order via API for patient ID: 66fbf2e7-4547-48c7-90af-626ad2b8f076
[13:56:41] [DOC: 9307422] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:56:41] ❌    ❌ Failed to push order
[13:56:41] 🔄 
🔄 Step 7: Writing to CSV...
[13:56:41] [DOC: 9307422] ℹ️  Calculated age: 94 from DOB: 06/25/1930
[13:56:41] [DOC: 9307422] ℹ️  Service Line extracted: 'OT'
[13:56:41] [DOC: 9307422] ℹ️  Payer Source extracted: 'Medicare'
[13:56:41] [DOC: 9307422] ℹ️  Diagnosis codes being written:
[13:56:41] [DOC: 9307422] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:56:41] [DOC: 9307422] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:56:41] [DOC: 9307422] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:56:41] [DOC: 9307422] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:56:41] [DOC: 9307422] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:56:41] [DOC: 9307422] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:56:41] [DOC: 9307422] ✅ Patient data written to CSV: Florence Dugal | Sex: FEMALE | Age: 94 | Service: OT | Payer: Medicare | MRN: 3134011
[13:56:41] ✅    ✅ Document 9307422 processed and saved successfully
[13:56:41] 🔄 
🔄 Step 8: Saving API details...
[13:56:41] [DOC: 9307422] ℹ️  API push details saved for document 9307422
[13:56:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307420                         ║
================================================================================
[13:56:41] ℹ️  Agency: Dartmouth HH
[13:56:41] ℹ️  Date: 05/22/2025
[13:56:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:43] [DOC: 9307420] ✅ Text extracted using pdfplumber (4476 chars)
[13:56:43] ✅    ✅ Text extracted using pdfplumber (4476 chars)
[13:56:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:45] ℹ️  AI extracted raw sex value: 'F'
[13:56:45] ℹ️  AI extracted service line: 'OT'
[13:56:45] ℹ️  AI extracted payer source: 'Medicare'
[13:56:45] ℹ️  AI extracted diagnoses:
[13:56:45] ℹ️    - Diagnosis 1: ''
[13:56:45] ℹ️    - Diagnosis 2: ''
[13:56:45] ℹ️    - Diagnosis 3: ''
[13:56:45] ℹ️    - Diagnosis 4: ''
[13:56:45] ℹ️    - Diagnosis 5: ''
[13:56:45] ℹ️    - Diagnosis 6: ''
[13:56:45] ℹ️  Final extracted MRN: '2498015'
[13:56:45] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:45] ℹ️  Final extracted Service Line: 'OT'
[13:56:45] ℹ️  Final extracted Payer Source: 'Medicare'
[13:56:45] ✅ Patient data extraction completed successfully
[13:56:45] ✅    ✅ Patient data extracted successfully
[13:56:45] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Kurtz
     └─ dob: 06/13/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2498015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/23/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:45] ✅    ✅ Patient identified: Nancy Kurtz
[13:56:45] ✅    ✅ Patient name validation passed
[13:56:45] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:45] [DOC: 9307420] ℹ️  DOB normalized: 06/13/1940
[13:56:45] [DOC: 9307420] ℹ️  Episode startOfCare normalized: 04/23/2025
[13:56:45] [DOC: 9307420] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[13:56:45] [DOC: 9307420] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:56:45] [DOC: 9307420] ✅ Patient date processing completed successfully
[13:56:45] ✅    ✅ Date processing completed
[13:56:45] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Kurtz
     └─ dob: 06/13/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2498015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/23/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:45] 🔄 
🔄 Step 4: Extracting order data...
[13:56:48] ℹ️  Order extraction - MRN: ''
[13:56:48] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:48] ℹ️  Order extraction - Service Line: 'OT'
[13:56:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:56:48] ✅ Order data extraction completed successfully
[13:56:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:48] ℹ️  Using MRN from patient data: '2498015'
[13:56:48] ℹ️  Service line consistent in both sources: 'OT'
[13:56:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:56:48] ✅ Patient name cross-validation successful
[13:56:48] ✅    ✅ Data merged successfully
[13:56:49] ✅    ✅ Order data extracted and validated
[13:56:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:57:01] [DOC: 9307420] ℹ️  Patient not found in cache or API: Nancy Kurtz
[13:57:01] [DOC: 9307420] ℹ️  Patient not found, creating new patient via API...
[13:57:01] [DOC: 9307420] ℹ️  Creating patient via API: Nancy Kurtz
[13:57:02] [DOC: 9307420] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:57:02] ❌    ❌ Failed to create patient
[13:57:02] [DOC: 9307420] ℹ️  API push details saved for document 9307420
================================================================================
║                        Processing Document ID: 9307418                         ║
================================================================================
[13:57:02] ℹ️  Agency: Dartmouth HH
[13:57:02] ℹ️  Date: 05/22/2025
[13:57:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:04] [DOC: 9307418] ✅ Text extracted using pdfplumber (1006 chars)
[13:57:04] ✅    ✅ Text extracted using pdfplumber (1006 chars)
[13:57:04] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:07] ℹ️  AI extracted raw sex value: 'F'
[13:57:07] ℹ️  AI extracted service line: 'Physical Therapy'
[13:57:07] ℹ️  AI extracted payer source: 'Wellpoint'
[13:57:07] ℹ️  AI extracted diagnoses:
[13:57:07] ℹ️    - Diagnosis 1: 'None'
[13:57:07] ℹ️    - Diagnosis 2: 'None'
[13:57:07] ℹ️    - Diagnosis 3: 'None'
[13:57:07] ℹ️    - Diagnosis 4: 'None'
[13:57:07] ℹ️    - Diagnosis 5: 'None'
[13:57:07] ℹ️    - Diagnosis 6: 'None'
[13:57:07] ℹ️  Final extracted MRN: '3140011'
[13:57:07] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:07] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:57:07] ℹ️  Final extracted Payer Source: 'Wellpoint'
[13:57:07] ✅ Patient data extraction completed successfully
[13:57:07] ✅    ✅ Patient data extracted successfully
[13:57:07] 📊 Patient Response
     └─ patientFName: Tania
     └─ patientLName: Nicolet
     └─ dob: 11/01/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3140011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Wellpoint
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:57:07] ✅    ✅ Patient identified: Tania Nicolet
[13:57:07] ✅    ✅ Patient name validation passed
[13:57:07] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:07] [DOC: 9307418] ℹ️  DOB normalized: 11/01/1929
[13:57:07] [DOC: 9307418] ℹ️  Episode startOfCare normalized: 04/15/2025
[13:57:07] [DOC: 9307418] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[13:57:07] [DOC: 9307418] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[13:57:07] [DOC: 9307418] ✅ Patient date processing completed successfully
[13:57:07] ✅    ✅ Date processing completed
[13:57:07] 📊 Processed Patient Data
     └─ patientFName: Tania
     └─ patientLName: Nicolet
     └─ dob: 11/01/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3140011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Wellpoint
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025'}]
[13:57:07] 🔄 
🔄 Step 4: Extracting order data...
[13:57:09] ℹ️  Order extraction - MRN: ''
[13:57:09] ℹ️  Order extraction - Sex: 'FEMALE'
[13:57:09] ℹ️  Order extraction - Service Line: 'PT'
[13:57:09] ℹ️  Order extraction - Payer Source: 'Wellpoint'
[13:57:09] ✅ Order data extraction completed successfully
[13:57:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:09] ℹ️  Using MRN from patient data: '3140011'
[13:57:09] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[13:57:09] ℹ️  Payer source consistent in both sources: 'Wellpoint'
[13:57:09] ✅ Patient name cross-validation successful
[13:57:09] ✅    ✅ Data merged successfully
[13:57:11] ✅    ✅ Order data extracted and validated
[13:57:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:57:16] [DOC: 9307418] ✅ Patient exists in API: Tania Nicolet, ID: f2093759-4696-49f4-a31d-9a5ae07439d0
[13:57:16] ✅    ✅ Existing patient found with ID: f2093759-4696-49f4-a31d-9a5ae07439d0
[13:57:16] 🔄 
🔄 Step 6: Pushing order to API...
[13:57:16] [DOC: 9307418] ℹ️  Pushing order via API for patient ID: f2093759-4696-49f4-a31d-9a5ae07439d0
[13:57:18] [DOC: 9307418] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:57:18] ❌    ❌ Failed to push order
[13:57:18] 🔄 
🔄 Step 7: Writing to CSV...
[13:57:18] [DOC: 9307418] ℹ️  Calculated age: 95 from DOB: 11/01/1929
[13:57:18] [DOC: 9307418] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[13:57:18] [DOC: 9307418] ℹ️  Payer Source extracted: 'Wellpoint'
[13:57:18] [DOC: 9307418] ℹ️  Diagnosis codes being written:
[13:57:18] [DOC: 9307418] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:57:18] [DOC: 9307418] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:57:18] [DOC: 9307418] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:57:18] [DOC: 9307418] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:57:18] [DOC: 9307418] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:57:18] [DOC: 9307418] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:57:18] [DOC: 9307418] ✅ Patient data written to CSV: Tania Nicolet | Sex: FEMALE | Age: 95 | Service: PT, Physical Therapy | Payer: Wellpoint | MRN: 3140011
[13:57:18] ✅    ✅ Document 9307418 processed and saved successfully
[13:57:18] 🔄 
🔄 Step 8: Saving API details...
[13:57:18] [DOC: 9307418] ℹ️  API push details saved for document 9307418
[13:57:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307286                         ║
================================================================================
[13:57:18] ℹ️  Agency: Dartmouth HH
[13:57:18] ℹ️  Date: 05/22/2025
[13:57:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:20] [DOC: 9307286] ✅ Text extracted using pdfplumber (1164 chars)
[13:57:20] ✅    ✅ Text extracted using pdfplumber (1164 chars)
[13:57:20] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:23] ℹ️  AI extracted raw sex value: 'F'
[13:57:23] ℹ️  AI extracted service line: 'RN'
[13:57:23] ℹ️  AI extracted payer source: 'Medicare'
[13:57:23] ℹ️  AI extracted diagnoses:
[13:57:23] ℹ️    - Diagnosis 1: 'None'
[13:57:23] ℹ️    - Diagnosis 2: 'None'
[13:57:23] ℹ️    - Diagnosis 3: 'None'
[13:57:23] ℹ️    - Diagnosis 4: 'None'
[13:57:23] ℹ️    - Diagnosis 5: 'None'
[13:57:23] ℹ️    - Diagnosis 6: 'None'
[13:57:23] ℹ️  Final extracted MRN: '1252008'
[13:57:23] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:23] ℹ️  Final extracted Service Line: 'RN'
[13:57:23] ℹ️  Final extracted Payer Source: 'Medicare'
[13:57:23] ✅ Patient data extraction completed successfully
[13:57:23] ✅    ✅ Patient data extracted successfully
[13:57:23] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Sykes
     └─ dob: 09/19/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1252008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:57:23] ✅    ✅ Patient identified: Linda Sykes
[13:57:23] ✅    ✅ Patient name validation passed
[13:57:23] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:23] [DOC: 9307286] ℹ️  DOB normalized: 09/19/1947
[13:57:23] [DOC: 9307286] ℹ️  Episode startOfCare normalized: 04/13/2025
[13:57:23] [DOC: 9307286] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[13:57:23] [DOC: 9307286] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[13:57:23] [DOC: 9307286] ✅ Patient date processing completed successfully
[13:57:23] ✅    ✅ Date processing completed
[13:57:23] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Sykes
     └─ dob: 09/19/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1252008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025'}]
[13:57:23] 🔄 
🔄 Step 4: Extracting order data...
[13:57:25] ℹ️  Order extraction - MRN: ''
[13:57:25] ℹ️  Order extraction - Sex: 'FEMALE'
[13:57:25] ℹ️  Order extraction - Service Line: 'HHA'
[13:57:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:57:25] ✅ Order data extraction completed successfully
[13:57:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:25] ℹ️  Using MRN from patient data: '1252008'
[13:57:25] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[13:57:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:57:25] ✅ Patient name cross-validation successful
[13:57:25] ✅    ✅ Data merged successfully
[13:57:27] ✅    ✅ Order data extracted and validated
[13:57:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:57:27] [DOC: 9307286] ✅ Patient found in local cache: Linda Sykes, ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[13:57:27] ✅    ✅ Existing patient found with ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[13:57:27] 🔄 
🔄 Step 6: Pushing order to API...
[13:57:27] [DOC: 9307286] ℹ️  Pushing order via API for patient ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[13:57:28] [DOC: 9307286] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14469"}
[13:57:28] ❌    ❌ Failed to push order
[13:57:28] 🔄 
🔄 Step 7: Writing to CSV...
[13:57:28] [DOC: 9307286] ℹ️  Calculated age: 77 from DOB: 09/19/1947
[13:57:28] [DOC: 9307286] ℹ️  Service Line extracted: 'HHA, RN'
[13:57:28] [DOC: 9307286] ℹ️  Payer Source extracted: 'Medicare'
[13:57:28] [DOC: 9307286] ℹ️  Diagnosis codes being written:
[13:57:28] [DOC: 9307286] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:57:28] [DOC: 9307286] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:57:28] [DOC: 9307286] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:57:28] [DOC: 9307286] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:57:28] [DOC: 9307286] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:57:28] [DOC: 9307286] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:57:28] [DOC: 9307286] ✅ Patient data written to CSV: Linda Sykes | Sex: FEMALE | Age: 77 | Service: HHA, RN | Payer: Medicare | MRN: 1252008
[13:57:28] ✅    ✅ Document 9307286 processed and saved successfully
[13:57:28] 🔄 
🔄 Step 8: Saving API details...
[13:57:28] [DOC: 9307286] ℹ️  API push details saved for document 9307286
[13:57:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307285                         ║
================================================================================
[13:57:28] ℹ️  Agency: Dartmouth HH
[13:57:28] ℹ️  Date: 05/22/2025
[13:57:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:32] [DOC: 9307285] ✅ Text extracted using pdfplumber (20505 chars)
[13:57:32] ✅    ✅ Text extracted using pdfplumber (20493 chars)
[13:57:32] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:35] ℹ️  AI extracted raw sex value: 'M'
[13:57:35] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:57:35] ℹ️  AI extracted payer source: ''
[13:57:35] ℹ️  AI extracted diagnoses:
[13:57:35] ℹ️    - Diagnosis 1: 'S72.142D'
[13:57:35] ℹ️    - Diagnosis 2: 'D47.1'
[13:57:35] ℹ️    - Diagnosis 3: 'E87.1'
[13:57:35] ℹ️    - Diagnosis 4: 'I48.0'
[13:57:35] ℹ️    - Diagnosis 5: 'I10'
[13:57:35] ℹ️    - Diagnosis 6: 'S51.811D'
[13:57:35] ℹ️  Final extracted MRN: '864008'
[13:57:35] ℹ️  Final extracted Sex: 'MALE'
[13:57:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:57:35] ℹ️  Final extracted Payer Source: ''
[13:57:35] ✅ Patient data extraction completed successfully
[13:57:35] ✅    ✅ Patient data extracted successfully
[13:57:35] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/18/2025', 'endOfEpisode': '07/15/2025', 'firstDiagnosis': 'S72.142D', 'secondDiagnosis': 'D47.1', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'S51.811D'}]
[13:57:35] ✅    ✅ Patient identified: Robert Lawton
[13:57:35] ✅    ✅ Patient name validation passed
[13:57:35] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:35] [DOC: 9307285] ℹ️  DOB normalized: 06/15/1943
[13:57:35] [DOC: 9307285] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[13:57:35] [DOC: 9307285] ℹ️  Episode endOfEpisode normalized: 07/15/2025
[13:57:35] [DOC: 9307285] ✅ Patient date processing completed successfully
[13:57:35] ✅    ✅ Date processing completed
[13:57:35] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '07/15/2025', 'firstDiagnosis': 'S72.142D', 'secondDiagnosis': 'D47.1', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'S51.811D'}]
[13:57:35] 🔄 
🔄 Step 4: Extracting order data...
[13:57:38] ℹ️  Order extraction - MRN: '864008'
[13:57:38] ℹ️  Order extraction - Sex: 'MALE'
[13:57:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing,PT,OT'
[13:57:38] ℹ️  Order extraction - Payer Source: ''
[13:57:38] ✅ Order data extraction completed successfully
[13:57:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:38] ℹ️  Using MRN from patient data: '864008' over '864008'
[13:57:38] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,PT,OT' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:57:38] ✅ Patient name cross-validation successful
[13:57:38] ✅    ✅ Data merged successfully
[13:57:39] ✅    ✅ Order data extracted and validated
[13:57:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:58:01] [DOC: 9307285] ℹ️  Patient not found in cache or API: Robert Lawton
[13:58:01] [DOC: 9307285] ℹ️  Patient not found, creating new patient via API...
[13:58:01] [DOC: 9307285] ℹ️  Creating patient via API: Robert Lawton
[13:58:02] [DOC: 9307285] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:58:02] ❌    ❌ Failed to create patient
[13:58:02] [DOC: 9307285] ℹ️  API push details saved for document 9307285
================================================================================
║                        Processing Document ID: 9307280                         ║
================================================================================
[13:58:02] ℹ️  Agency: Dartmouth HH
[13:58:02] ℹ️  Date: 05/22/2025
[13:58:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:58:05] [DOC: 9307280] ✅ Text extracted using pdfplumber (1035 chars)
[13:58:05] ✅    ✅ Text extracted using pdfplumber (1035 chars)
[13:58:05] 🔄 
🔄 Step 2: Extracting patient data...
[13:58:08] ℹ️  AI extracted raw sex value: 'M'
[13:58:08] ℹ️  AI extracted service line: 'HHA'
[13:58:08] ℹ️  AI extracted payer source: 'Fallon Health'
[13:58:08] ℹ️  AI extracted diagnoses:
[13:58:08] ℹ️    - Diagnosis 1: ''
[13:58:08] ℹ️    - Diagnosis 2: ''
[13:58:08] ℹ️    - Diagnosis 3: ''
[13:58:08] ℹ️    - Diagnosis 4: ''
[13:58:08] ℹ️    - Diagnosis 5: ''
[13:58:08] ℹ️    - Diagnosis 6: ''
[13:58:08] ℹ️  Final extracted MRN: '4212011'
[13:58:08] ℹ️  Final extracted Sex: 'MALE'
[13:58:08] ℹ️  Final extracted Service Line: 'HHA'
[13:58:08] ℹ️  Final extracted Payer Source: 'Fallon Health'
[13:58:08] ✅ Patient data extraction completed successfully
[13:58:08] ✅    ✅ Patient data extracted successfully
[13:58:08] 📊 Patient Response
     └─ patientFName: Joaquim
     └─ patientLName: Laranjeira
     └─ dob: 03/06/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 4212011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:58:08] ✅    ✅ Patient identified: Joaquim Laranjeira
[13:58:08] ✅    ✅ Patient name validation passed
[13:58:08] 🔄 
🔄 Step 3: Processing patient dates...
[13:58:08] [DOC: 9307280] ℹ️  DOB normalized: 03/06/1952
[13:58:08] [DOC: 9307280] ℹ️  Episode startOfCare normalized: 04/18/2025
[13:58:08] [DOC: 9307280] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[13:58:08] [DOC: 9307280] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[13:58:08] [DOC: 9307280] ✅ Patient date processing completed successfully
[13:58:08] ✅    ✅ Date processing completed
[13:58:08] 📊 Processed Patient Data
     └─ patientFName: Joaquim
     └─ patientLName: Laranjeira
     └─ dob: 03/06/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 4212011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:58:08] 🔄 
🔄 Step 4: Extracting order data...
[13:58:10] ℹ️  Order extraction - MRN: ''
[13:58:10] ℹ️  Order extraction - Sex: 'MALE'
[13:58:10] ℹ️  Order extraction - Service Line: 'RN'
[13:58:10] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[13:58:10] ✅ Order data extraction completed successfully
[13:58:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:58:10] ℹ️  Using MRN from patient data: '4212011'
[13:58:10] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[13:58:10] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[13:58:10] ✅ Patient name cross-validation successful
[13:58:10] ✅    ✅ Data merged successfully
[13:58:13] ✅    ✅ Order data extracted and validated
[13:58:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:58:47] [DOC: 9307280] ℹ️  Patient not found in cache or API: Joaquim Laranjeira
[13:58:47] [DOC: 9307280] ℹ️  Patient not found, creating new patient via API...
[13:58:47] [DOC: 9307280] ℹ️  Creating patient via API: Joaquim Laranjeira
[13:58:48] [DOC: 9307280] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:58:48] ❌    ❌ Failed to create patient
[13:58:48] [DOC: 9307280] ℹ️  API push details saved for document 9307280
================================================================================
║                        Processing Document ID: 9307279                         ║
================================================================================
[13:58:48] ℹ️  Agency: Dartmouth HH
[13:58:48] ℹ️  Date: 05/22/2025
[13:58:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:58:51] [DOC: 9307279] ✅ Text extracted using pdfplumber (2244 chars)
[13:58:51] ✅    ✅ Text extracted using pdfplumber (2244 chars)
[13:58:51] 🔄 
🔄 Step 2: Extracting patient data...
[13:58:53] ℹ️  AI extracted raw sex value: 'M'
[13:58:53] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:58:53] ℹ️  AI extracted payer source: 'Medicare'
[13:58:53] ℹ️  AI extracted diagnoses:
[13:58:53] ℹ️    - Diagnosis 1: ''
[13:58:53] ℹ️    - Diagnosis 2: ''
[13:58:53] ℹ️    - Diagnosis 3: ''
[13:58:53] ℹ️    - Diagnosis 4: ''
[13:58:53] ℹ️    - Diagnosis 5: ''
[13:58:53] ℹ️    - Diagnosis 6: ''
[13:58:53] ℹ️  Final extracted MRN: '1396009'
[13:58:53] ℹ️  Final extracted Sex: 'MALE'
[13:58:53] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:58:53] ℹ️  Final extracted Payer Source: 'Medicare'
[13:58:53] ✅ Patient data extraction completed successfully
[13:58:53] ✅    ✅ Patient data extracted successfully
[13:58:53] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:58:53] ✅    ✅ Patient identified: Elias Ramos
[13:58:53] ✅    ✅ Patient name validation passed
[13:58:53] 🔄 
🔄 Step 3: Processing patient dates...
[13:58:53] [DOC: 9307279] ℹ️  DOB normalized: 08/28/1938
[13:58:53] [DOC: 9307279] ℹ️  Episode startOfCare normalized: 12/31/2024
[13:58:53] [DOC: 9307279] ℹ️  Episode startOfEpisode normalized: 04/30/2025
[13:58:53] [DOC: 9307279] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[13:58:53] [DOC: 9307279] ✅ Patient date processing completed successfully
[13:58:53] ✅    ✅ Date processing completed
[13:58:53] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:58:53] 🔄 
🔄 Step 4: Extracting order data...
[13:58:56] ℹ️  Order extraction - MRN: ''
[13:58:56] ℹ️  Order extraction - Sex: 'MALE'
[13:58:56] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[13:58:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:58:56] ✅ Order data extraction completed successfully
[13:58:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:58:56] ℹ️  Using MRN from patient data: '1396009'
[13:58:56] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[13:58:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:58:56] ✅ Patient name cross-validation successful
[13:58:56] ✅    ✅ Data merged successfully
[13:58:57] ✅    ✅ Order data extracted and validated
[13:58:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:59:27] [DOC: 9307279] ✅ Patient exists in API: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[13:59:27] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[13:59:27] 🔄 
🔄 Step 6: Pushing order to API...
[13:59:27] [DOC: 9307279] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[13:59:29] [DOC: 9307279] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13134"}
[13:59:29] ❌    ❌ Failed to push order
[13:59:29] 🔄 
🔄 Step 7: Writing to CSV...
[13:59:29] [DOC: 9307279] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[13:59:29] [DOC: 9307279] ℹ️  Service Line extracted: 'Occupational Therapy'
[13:59:29] [DOC: 9307279] ℹ️  Payer Source extracted: 'Medicare'
[13:59:29] [DOC: 9307279] ℹ️  Diagnosis codes being written:
[13:59:29] [DOC: 9307279] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:59:29] [DOC: 9307279] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:59:29] [DOC: 9307279] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:59:29] [DOC: 9307279] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:59:29] [DOC: 9307279] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:59:29] [DOC: 9307279] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:59:29] [DOC: 9307279] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: Occupational Therapy | Payer: Medicare | MRN: 1396009
[13:59:29] ✅    ✅ Document 9307279 processed and saved successfully
[13:59:29] 🔄 
🔄 Step 8: Saving API details...
[13:59:29] [DOC: 9307279] ℹ️  API push details saved for document 9307279
[13:59:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307276                         ║
================================================================================
[13:59:29] ℹ️  Agency: Dartmouth HH
[13:59:29] ℹ️  Date: 05/22/2025
[13:59:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:59:31] [DOC: 9307276] ✅ Text extracted using pdfplumber (1266 chars)
[13:59:31] ✅    ✅ Text extracted using pdfplumber (1266 chars)
[13:59:31] 🔄 
🔄 Step 2: Extracting patient data...
[13:59:34] ℹ️  AI extracted raw sex value: 'M'
[13:59:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:59:34] ℹ️  AI extracted payer source: 'United Health Care'
[13:59:34] ℹ️  AI extracted diagnoses:
[13:59:34] ℹ️    - Diagnosis 1: 'None'
[13:59:34] ℹ️    - Diagnosis 2: 'None'
[13:59:34] ℹ️    - Diagnosis 3: 'None'
[13:59:34] ℹ️    - Diagnosis 4: 'None'
[13:59:34] ℹ️    - Diagnosis 5: 'None'
[13:59:34] ℹ️    - Diagnosis 6: 'None'
[13:59:34] ℹ️  Final extracted MRN: '7046009'
[13:59:34] ℹ️  Final extracted Sex: 'MALE'
[13:59:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:59:34] ℹ️  Final extracted Payer Source: 'United Health Care'
[13:59:34] ✅ Patient data extraction completed successfully
[13:59:34] ✅    ✅ Patient data extracted successfully
[13:59:34] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:59:34] ✅    ✅ Patient identified: Julio Demelo
[13:59:34] ✅    ✅ Patient name validation passed
[13:59:34] 🔄 
🔄 Step 3: Processing patient dates...
[13:59:34] [DOC: 9307276] ℹ️  DOB normalized: 02/23/1950
[13:59:34] [DOC: 9307276] ℹ️  Episode startOfCare normalized: 10/31/2024
[13:59:34] [DOC: 9307276] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[13:59:34] [DOC: 9307276] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[13:59:34] [DOC: 9307276] ✅ Patient date processing completed successfully
[13:59:34] ✅    ✅ Date processing completed
[13:59:34] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025'}]
[13:59:34] 🔄 
🔄 Step 4: Extracting order data...
[13:59:36] ℹ️  Order extraction - MRN: ''
[13:59:36] ℹ️  Order extraction - Sex: 'MALE'
[13:59:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:59:36] ℹ️  Order extraction - Payer Source: 'United Health Care'
[13:59:36] ✅ Order data extraction completed successfully
[13:59:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:59:36] ℹ️  Using MRN from patient data: '7046009'
[13:59:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:59:36] ℹ️  Payer source consistent in both sources: 'United Health Care'
[13:59:36] ✅ Patient name cross-validation successful
[13:59:36] ✅    ✅ Data merged successfully
[13:59:38] ✅    ✅ Order data extracted and validated
[13:59:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:59:53] [DOC: 9307276] ℹ️  Patient not found in cache or API: Julio Demelo
[13:59:53] [DOC: 9307276] ℹ️  Patient not found, creating new patient via API...
[13:59:53] [DOC: 9307276] ℹ️  Creating patient via API: Julio Demelo
[13:59:54] [DOC: 9307276] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:59:54] ❌    ❌ Failed to create patient
[13:59:54] [DOC: 9307276] ℹ️  API push details saved for document 9307276
================================================================================
║                        Processing Document ID: 9307274                         ║
================================================================================
[13:59:54] ℹ️  Agency: Dartmouth HH
[13:59:54] ℹ️  Date: 05/22/2025
[13:59:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:59:56] [DOC: 9307274] ✅ Text extracted using pdfplumber (3663 chars)
[13:59:56] ✅    ✅ Text extracted using pdfplumber (3663 chars)
[13:59:56] 🔄 
🔄 Step 2: Extracting patient data...
[13:59:59] ℹ️  AI extracted raw sex value: 'F'
[13:59:59] ℹ️  AI extracted service line: 'Skilled OT'
[13:59:59] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[13:59:59] ℹ️  AI extracted diagnoses:
[13:59:59] ℹ️    - Diagnosis 1: 'None'
[13:59:59] ℹ️    - Diagnosis 2: 'None'
[13:59:59] ℹ️    - Diagnosis 3: 'None'
[13:59:59] ℹ️    - Diagnosis 4: 'None'
[13:59:59] ℹ️    - Diagnosis 5: 'None'
[13:59:59] ℹ️    - Diagnosis 6: 'None'
[13:59:59] ℹ️  Final extracted MRN: '6073015'
[13:59:59] ℹ️  Final extracted Sex: 'FEMALE'
[13:59:59] ℹ️  Final extracted Service Line: 'Skilled OT'
[13:59:59] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[13:59:59] ✅ Patient data extraction completed successfully
[13:59:59] ✅    ✅ Patient data extracted successfully
[13:59:59] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:59:59] ✅    ✅ Patient identified: Marilyn Valle
[13:59:59] ✅    ✅ Patient name validation passed
[13:59:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:59:59] [DOC: 9307274] ℹ️  DOB normalized: 12/24/1947
[13:59:59] [DOC: 9307274] ℹ️  Episode startOfCare normalized: 02/22/2025
[13:59:59] [DOC: 9307274] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[13:59:59] [DOC: 9307274] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:59:59] [DOC: 9307274] ✅ Patient date processing completed successfully
[13:59:59] ✅    ✅ Date processing completed
[13:59:59] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025'}]
[13:59:59] 🔄 
🔄 Step 4: Extracting order data...
[14:00:01] ℹ️  Order extraction - MRN: '6073015'
[14:00:01] ℹ️  Order extraction - Sex: 'FEMALE'
[14:00:01] ℹ️  Order extraction - Service Line: 'OT'
[14:00:01] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[14:00:01] ✅ Order data extraction completed successfully
[14:00:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:01] ℹ️  Using MRN from patient data: '6073015' over '6073015'
[14:00:01] ℹ️  Combined service lines: Patient='Skilled OT' + Order='OT' = 'OT, Skilled OT'
[14:00:01] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[14:00:01] ✅ Patient name cross-validation successful
[14:00:01] ✅    ✅ Data merged successfully
[14:00:03] ✅    ✅ Order data extracted and validated
[14:00:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:00:03] [DOC: 9307274] ✅ Patient found in local cache: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[14:00:03] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[14:00:03] 🔄 
🔄 Step 6: Pushing order to API...
[14:00:03] [DOC: 9307274] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[14:00:06] [DOC: 9307274] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:00:06] ❌    ❌ Failed to push order
[14:00:06] 🔄 
🔄 Step 7: Writing to CSV...
[14:00:06] [DOC: 9307274] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[14:00:06] [DOC: 9307274] ℹ️  Service Line extracted: 'OT, Skilled OT'
[14:00:06] [DOC: 9307274] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[14:00:06] [DOC: 9307274] ℹ️  Diagnosis codes being written:
[14:00:06] [DOC: 9307274] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:00:06] [DOC: 9307274] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:00:06] [DOC: 9307274] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:00:06] [DOC: 9307274] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:00:06] [DOC: 9307274] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:00:06] [DOC: 9307274] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:00:06] [DOC: 9307274] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT, Skilled OT | Payer: Aetna- Mcare | MRN: 6073015
[14:00:06] ✅    ✅ Document 9307274 processed and saved successfully
[14:00:06] 🔄 
🔄 Step 8: Saving API details...
[14:00:06] [DOC: 9307274] ℹ️  API push details saved for document 9307274
[14:00:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307252                         ║
================================================================================
[14:00:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:00:06] ℹ️  Date: 05/22/2025
[14:00:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:00:11] [DOC: 9307252] ✅ Text extracted using pdfplumber (12123 chars)
[14:00:11] ✅    ✅ Text extracted using pdfplumber (12123 chars)
[14:00:11] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:14] ℹ️  AI extracted raw sex value: 'F'
[14:00:14] ℹ️  AI extracted service line: 'OT'
[14:00:14] ℹ️  AI extracted payer source: ''
[14:00:14] ℹ️  AI extracted diagnoses:
[14:00:14] ℹ️    - Diagnosis 1: ''
[14:00:14] ℹ️    - Diagnosis 2: ''
[14:00:14] ℹ️    - Diagnosis 3: ''
[14:00:14] ℹ️    - Diagnosis 4: ''
[14:00:14] ℹ️    - Diagnosis 5: ''
[14:00:14] ℹ️    - Diagnosis 6: ''
[14:00:14] ℹ️  Final extracted MRN: 'MA210121015502'
[14:00:14] ℹ️  Final extracted Sex: 'FEMALE'
[14:00:14] ℹ️  Final extracted Service Line: 'OT'
[14:00:14] ℹ️  Final extracted Payer Source: ''
[14:00:14] ✅ Patient data extraction completed successfully
[14:00:14] ✅    ✅ Patient data extracted successfully
[14:00:14] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Clinician, Agency
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:14] ✅    ✅ Patient identified: Louise Rivard
[14:00:14] ✅    ✅ Patient name validation passed
[14:00:14] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:14] [DOC: 9307252] ℹ️  DOB normalized: 01/26/1955
[14:00:14] [DOC: 9307252] ℹ️  Episode startOfEpisode normalized: 05/09/2025
[14:00:14] [DOC: 9307252] ✅ Patient date processing completed successfully
[14:00:14] ✅    ✅ Date processing completed
[14:00:14] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Clinician, Agency
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:14] 🔄 
🔄 Step 4: Extracting order data...
[14:00:16] ℹ️  Order extraction - MRN: 'MA210121015502'
[14:00:16] ℹ️  Order extraction - Sex: 'FEMALE'
[14:00:16] ℹ️  Order extraction - Service Line: 'OT'
[14:00:16] ℹ️  Order extraction - Payer Source: ''
[14:00:16] ✅ Order data extraction completed successfully
[14:00:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:16] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[14:00:16] ℹ️  Service line consistent in both sources: 'OT'
[14:00:16] ✅ Patient name cross-validation successful
[14:00:16] ✅    ✅ Data merged successfully
[14:00:18] ✅    ✅ Order data extracted and validated
[14:00:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:00:24] [DOC: 9307252] ✅ Patient exists in API: Louise Rivard, ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[14:00:24] ✅    ✅ Existing patient found with ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[14:00:24] 🔄 
🔄 Step 6: Pushing order to API...
[14:00:24] [DOC: 9307252] ℹ️  Pushing order via API for patient ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[14:00:25] [DOC: 9307252] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:00:25] ❌    ❌ Failed to push order
[14:00:25] 🔄 
🔄 Step 7: Writing to CSV...
[14:00:25] [DOC: 9307252] ℹ️  Calculated age: 70 from DOB: 01/26/1955
[14:00:25] [DOC: 9307252] ℹ️  Service Line extracted: 'OT'
[14:00:25] [DOC: 9307252] ℹ️  Payer Source extracted: ''
[14:00:25] [DOC: 9307252] ℹ️  Diagnosis codes being written:
[14:00:25] [DOC: 9307252] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:00:25] [DOC: 9307252] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:00:25] [DOC: 9307252] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:00:25] [DOC: 9307252] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:00:25] [DOC: 9307252] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:00:25] [DOC: 9307252] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:00:25] [DOC: 9307252] ✅ Patient data written to CSV: Louise Rivard | Sex: FEMALE | Age: 70 | Service: OT | Payer:  | MRN: MA210121015502
[14:00:25] ✅    ✅ Document 9307252 processed and saved successfully
[14:00:25] 🔄 
🔄 Step 8: Saving API details...
[14:00:25] [DOC: 9307252] ℹ️  API push details saved for document 9307252
[14:00:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307244                         ║
================================================================================
[14:00:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:00:25] ℹ️  Date: 05/22/2025
[14:00:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:00:27] [DOC: 9307244] ✅ Text extracted using pdfplumber (1118 chars)
[14:00:27] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[14:00:27] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:30] ℹ️  AI extracted raw sex value: ''
[14:00:30] ℹ️  AI extracted service line: 'LPN'
[14:00:30] ℹ️  AI extracted payer source: ''
[14:00:30] ℹ️  AI extracted diagnoses:
[14:00:30] ℹ️    - Diagnosis 1: 'I95.1'
[14:00:30] ℹ️    - Diagnosis 2: 'E86.0'
[14:00:30] ℹ️    - Diagnosis 3: 'G30.1'
[14:00:30] ℹ️    - Diagnosis 4: ''
[14:00:30] ℹ️    - Diagnosis 5: ''
[14:00:30] ℹ️    - Diagnosis 6: ''
[14:00:30] ℹ️  Final extracted MRN: 'MA231101014802'
[14:00:30] ℹ️  Final extracted Sex: ''
[14:00:30] ℹ️  Final extracted Service Line: 'LPN'
[14:00:30] ℹ️  Final extracted Payer Source: ''
[14:00:30] ✅ Patient data extraction completed successfully
[14:00:30] ✅    ✅ Patient data extracted successfully
[14:00:30] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:30] ✅    ✅ Patient identified: Eduardo Medeiros
[14:00:30] ✅    ✅ Patient name validation passed
[14:00:30] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:30] [DOC: 9307244] ℹ️  DOB normalized: 01/08/1948
[14:00:30] [DOC: 9307244] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:00:30] [DOC: 9307244] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:00:30] [DOC: 9307244] ✅ Patient date processing completed successfully
[14:00:30] ✅    ✅ Date processing completed
[14:00:30] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:30] 🔄 
🔄 Step 4: Extracting order data...
[14:00:32] ℹ️  Order extraction - MRN: 'MA231101014802'
[14:00:32] ℹ️  Order extraction - Sex: ''
[14:00:32] ℹ️  Order extraction - Service Line: 'LPN'
[14:00:32] ℹ️  Order extraction - Payer Source: ''
[14:00:32] ✅ Order data extraction completed successfully
[14:00:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:32] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[14:00:32] ⚠️  Could not determine sex using any available method
[14:00:32] ℹ️  Service line consistent in both sources: 'LPN'
[14:00:32] ✅ Patient name cross-validation successful
[14:00:32] ✅    ✅ Data merged successfully
[14:00:33] ✅    ✅ Order data extracted and validated
[14:00:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:00:40] [DOC: 9307244] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[14:00:40] [DOC: 9307244] ℹ️  Patient not found, creating new patient via API...
[14:00:40] [DOC: 9307244] ℹ️  Creating patient via API: Eduardo Medeiros
[14:00:41] [DOC: 9307244] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:00:41] ❌    ❌ Failed to create patient
[14:00:41] [DOC: 9307244] ℹ️  API push details saved for document 9307244
================================================================================
║                        Processing Document ID: 9307232                         ║
================================================================================
[14:00:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:00:41] ℹ️  Date: 05/22/2025
[14:00:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:00:43] [DOC: 9307232] ✅ Text extracted using pdfplumber (1099 chars)
[14:00:43] ✅    ✅ Text extracted using pdfplumber (1099 chars)
[14:00:43] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:45] ℹ️  AI extracted raw sex value: 'F'
[14:00:45] ℹ️  AI extracted service line: 'Nursing'
[14:00:45] ℹ️  AI extracted payer source: ''
[14:00:45] ℹ️  AI extracted diagnoses:
[14:00:45] ℹ️    - Diagnosis 1: 'None'
[14:00:45] ℹ️    - Diagnosis 2: 'None'
[14:00:45] ℹ️    - Diagnosis 3: 'None'
[14:00:45] ℹ️    - Diagnosis 4: 'None'
[14:00:45] ℹ️    - Diagnosis 5: 'None'
[14:00:45] ℹ️    - Diagnosis 6: 'None'
[14:00:45] ℹ️  Final extracted MRN: '2936720'
[14:00:45] ℹ️  Final extracted Sex: 'FEMALE'
[14:00:45] ℹ️  Final extracted Service Line: 'Nursing'
[14:00:45] ℹ️  Final extracted Payer Source: ''
[14:00:45] ✅ Patient data extraction completed successfully
[14:00:45] ✅    ✅ Patient data extracted successfully
[14:00:45] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:00:45] ✅    ✅ Patient identified: Stella Saint
[14:00:45] ✅    ✅ Patient name validation passed
[14:00:45] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:45] [DOC: 9307232] ℹ️  DOB normalized: 07/02/1928
[14:00:45] [DOC: 9307232] ✅ Patient date processing completed successfully
[14:00:45] ✅    ✅ Date processing completed
[14:00:45] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:00:45] 🔄 
🔄 Step 4: Extracting order data...
[14:00:48] ℹ️  Order extraction - MRN: '2936720'
[14:00:48] ℹ️  Order extraction - Sex: 'FEMALE'
[14:00:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:00:48] ℹ️  Order extraction - Payer Source: ''
[14:00:48] ✅ Order data extraction completed successfully
[14:00:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:48] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[14:00:48] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[14:00:48] ✅ Patient name cross-validation successful
[14:00:48] ✅    ✅ Data merged successfully
[14:00:49] ✅    ✅ Order data extracted and validated
[14:00:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:00:49] [DOC: 9307232] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[14:00:49] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[14:00:49] 🔄 
🔄 Step 6: Pushing order to API...
[14:00:49] [DOC: 9307232] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[14:00:50] [DOC: 9307232] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19017"}
[14:00:50] ❌    ❌ Failed to push order
[14:00:50] 🔄 
🔄 Step 7: Writing to CSV...
[14:00:50] [DOC: 9307232] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[14:00:50] [DOC: 9307232] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[14:00:50] [DOC: 9307232] ℹ️  Payer Source extracted: ''
[14:00:50] [DOC: 9307232] ℹ️  Diagnosis codes being written:
[14:00:50] [DOC: 9307232] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:00:50] [DOC: 9307232] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:00:50] [DOC: 9307232] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:00:50] [DOC: 9307232] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:00:50] [DOC: 9307232] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:00:50] [DOC: 9307232] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:00:50] [DOC: 9307232] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2936720
[14:00:50] ✅    ✅ Document 9307232 processed and saved successfully
[14:00:50] 🔄 
🔄 Step 8: Saving API details...
[14:00:50] [DOC: 9307232] ℹ️  API push details saved for document 9307232
[14:00:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307231                         ║
================================================================================
[14:00:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:00:50] ℹ️  Date: 05/22/2025
[14:00:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:00:54] [DOC: 9307231] ✅ Text extracted using pdfplumber (19277 chars)
[14:00:54] ✅    ✅ Text extracted using pdfplumber (19277 chars)
[14:00:54] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:57] ℹ️  AI extracted raw sex value: 'F'
[14:00:57] ℹ️  AI extracted service line: 'PT'
[14:00:57] ℹ️  AI extracted payer source: ''
[14:00:57] ℹ️  AI extracted diagnoses:
[14:00:57] ℹ️    - Diagnosis 1: 'M47.816'
[14:00:57] ℹ️    - Diagnosis 2: 'R26.2'
[14:00:57] ℹ️    - Diagnosis 3: ''
[14:00:57] ℹ️    - Diagnosis 4: ''
[14:00:57] ℹ️    - Diagnosis 5: ''
[14:00:57] ℹ️    - Diagnosis 6: ''
[14:00:57] ℹ️  Final extracted MRN: 'MA241216044603'
[14:00:57] ℹ️  Final extracted Sex: 'FEMALE'
[14:00:57] ℹ️  Final extracted Service Line: 'PT'
[14:00:57] ℹ️  Final extracted Payer Source: ''
[14:00:57] ✅ Patient data extraction completed successfully
[14:00:57] ✅    ✅ Patient data extracted successfully
[14:00:57] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'R26.2', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:57] ✅    ✅ Patient identified: Leonor Gomes
[14:00:57] ✅    ✅ Patient name validation passed
[14:00:57] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:57] [DOC: 9307231] ℹ️  DOB normalized: 04/15/1946
[14:00:57] [DOC: 9307231] ✅ Patient date processing completed successfully
[14:00:57] ✅    ✅ Date processing completed
[14:00:57] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'R26.2', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:57] 🔄 
🔄 Step 4: Extracting order data...
[14:01:00] ℹ️  Order extraction - MRN: 'MA241216044603'
[14:01:00] ℹ️  Order extraction - Sex: 'FEMALE'
[14:01:00] ℹ️  Order extraction - Service Line: 'PT'
[14:01:00] ℹ️  Order extraction - Payer Source: ''
[14:01:00] ✅ Order data extraction completed successfully
[14:01:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:01:00] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[14:01:00] ℹ️  Service line consistent in both sources: 'PT'
[14:01:00] ✅ Patient name cross-validation successful
[14:01:00] ✅    ✅ Data merged successfully
[14:01:01] ✅    ✅ Order data extracted and validated
[14:01:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:01:10] [DOC: 9307231] ✅ Patient exists in API: Leonor Gomes, ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[14:01:10] ✅    ✅ Existing patient found with ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[14:01:10] 🔄 
🔄 Step 6: Pushing order to API...
[14:01:10] [DOC: 9307231] ℹ️  Pushing order via API for patient ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[14:01:11] [DOC: 9307231] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:01:11] ❌    ❌ Failed to push order
[14:01:11] 🔄 
🔄 Step 7: Writing to CSV...
[14:01:11] [DOC: 9307231] ℹ️  Calculated age: 79 from DOB: 04/15/1946
[14:01:11] [DOC: 9307231] ℹ️  Service Line extracted: 'PT'
[14:01:11] [DOC: 9307231] ℹ️  Payer Source extracted: ''
[14:01:11] [DOC: 9307231] ℹ️  Diagnosis codes being written:
[14:01:11] [DOC: 9307231] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.816'
[14:01:11] [DOC: 9307231] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.2'
[14:01:11] [DOC: 9307231] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:01:11] [DOC: 9307231] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:01:11] [DOC: 9307231] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:01:11] [DOC: 9307231] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:01:11] [DOC: 9307231] ✅ Patient data written to CSV: Leonor Gomes | Sex: FEMALE | Age: 79 | Service: PT | Payer:  | MRN: MA241216044603
[14:01:11] ✅    ✅ Document 9307231 processed and saved successfully
[14:01:11] 🔄 
🔄 Step 8: Saving API details...
[14:01:11] [DOC: 9307231] ℹ️  API push details saved for document 9307231
[14:01:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307216                         ║
================================================================================
[14:01:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:01:11] ℹ️  Date: 05/22/2025
[14:01:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:01:14] [DOC: 9307216] ✅ Text extracted using pdfplumber (20004 chars)
[14:01:14] ✅    ✅ Text extracted using pdfplumber (20004 chars)
[14:01:14] 🔄 
🔄 Step 2: Extracting patient data...
[14:01:18] ℹ️  AI extracted raw sex value: 'F'
[14:01:18] ℹ️  AI extracted service line: 'PT'
[14:01:18] ℹ️  AI extracted payer source: 'None'
[14:01:18] ℹ️  AI extracted diagnoses:
[14:01:18] ℹ️    - Diagnosis 1: 'None'
[14:01:18] ℹ️    - Diagnosis 2: 'None'
[14:01:18] ℹ️    - Diagnosis 3: 'None'
[14:01:18] ℹ️    - Diagnosis 4: 'None'
[14:01:18] ℹ️    - Diagnosis 5: 'None'
[14:01:18] ℹ️    - Diagnosis 6: 'None'
[14:01:18] ℹ️  Final extracted MRN: 'MA210617063801'
[14:01:18] ℹ️  Final extracted Sex: 'FEMALE'
[14:01:18] ℹ️  Final extracted Service Line: 'PT'
[14:01:18] ℹ️  Final extracted Payer Source: ''
[14:01:18] ✅ Patient data extraction completed successfully
[14:01:18] ✅    ✅ Patient data extracted successfully
[14:01:18] 📊 Patient Response
     └─ patientFName: Jeanne
     └─ patientLName: Borges
     └─ dob: 06/28/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210617063801
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:01:18] ✅    ✅ Patient identified: Jeanne Borges
[14:01:18] ✅    ✅ Patient name validation passed
[14:01:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:01:18] [DOC: 9307216] ℹ️  DOB normalized: 06/28/1938
[14:01:18] [DOC: 9307216] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[14:01:18] [DOC: 9307216] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[14:01:18] [DOC: 9307216] ✅ Patient date processing completed successfully
[14:01:18] ✅    ✅ Date processing completed
[14:01:18] 📊 Processed Patient Data
     └─ patientFName: Jeanne
     └─ patientLName: Borges
     └─ dob: 06/28/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210617063801
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/06/2025'}]
[14:01:18] 🔄 
🔄 Step 4: Extracting order data...
[14:01:20] ℹ️  Order extraction - MRN: 'MA210617063801'
[14:01:20] ℹ️  Order extraction - Sex: 'FEMALE'
[14:01:20] ℹ️  Order extraction - Service Line: 'PT'
[14:01:20] ℹ️  Order extraction - Payer Source: ''
[14:01:20] ✅ Order data extraction completed successfully
[14:01:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:01:20] ℹ️  Using MRN from patient data: 'MA210617063801' over 'MA210617063801'
[14:01:20] ℹ️  Service line consistent in both sources: 'PT'
[14:01:20] ✅ Patient name cross-validation successful
[14:01:20] ✅    ✅ Data merged successfully
[14:01:22] ✅    ✅ Order data extracted and validated
[14:01:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:01:22] [DOC: 9307216] ✅ Patient found in local cache: Jeanne Borges, ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[14:01:22] ✅    ✅ Existing patient found with ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[14:01:22] 🔄 
🔄 Step 6: Pushing order to API...
[14:01:22] [DOC: 9307216] ℹ️  Pushing order via API for patient ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[14:01:23] [DOC: 9307216] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:01:23] ❌    ❌ Failed to push order
[14:01:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:01:23] [DOC: 9307216] ℹ️  Calculated age: 86 from DOB: 06/28/1938
[14:01:23] [DOC: 9307216] ℹ️  Service Line extracted: 'PT'
[14:01:23] [DOC: 9307216] ℹ️  Payer Source extracted: ''
[14:01:23] [DOC: 9307216] ℹ️  Diagnosis codes being written:
[14:01:23] [DOC: 9307216] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:01:23] [DOC: 9307216] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:01:23] [DOC: 9307216] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:01:23] [DOC: 9307216] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:01:23] [DOC: 9307216] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:01:23] [DOC: 9307216] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:01:23] [DOC: 9307216] ✅ Patient data written to CSV: Jeanne Borges | Sex: FEMALE | Age: 86 | Service: PT | Payer:  | MRN: MA210617063801
[14:01:23] ✅    ✅ Document 9307216 processed and saved successfully
[14:01:23] 🔄 
🔄 Step 8: Saving API details...
[14:01:23] [DOC: 9307216] ℹ️  API push details saved for document 9307216
[14:01:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307182                         ║
================================================================================
[14:01:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:01:23] ℹ️  Date: 05/22/2025
[14:01:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:01:28] [DOC: 9307182] ✅ Text extracted using pdfplumber (19717 chars)
[14:01:28] ✅    ✅ Text extracted using pdfplumber (19707 chars)
[14:01:28] 🔄 
🔄 Step 2: Extracting patient data...
[14:01:32] ℹ️  AI extracted raw sex value: 'F'
[14:01:32] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Speech Language Pathology, Occupational Therapy'
[14:01:32] ℹ️  AI extracted payer source: ''
[14:01:32] ℹ️  AI extracted diagnoses:
[14:01:32] ℹ️    - Diagnosis 1: 'I69.351'
[14:01:32] ℹ️    - Diagnosis 2: 'I10'
[14:01:32] ℹ️    - Diagnosis 3: 'E03.9'
[14:01:32] ℹ️    - Diagnosis 4: 'Z96.641'
[14:01:32] ℹ️    - Diagnosis 5: 'Z86.73'
[14:01:32] ℹ️    - Diagnosis 6: 'Z79.02'
[14:01:32] ℹ️  Final extracted MRN: '2526121'
[14:01:32] ℹ️  Final extracted Sex: 'FEMALE'
[14:01:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Speech Language Pathology, Occupational Therapy'
[14:01:32] ℹ️  Final extracted Payer Source: ''
[14:01:32] ✅ Patient data extraction completed successfully
[14:01:32] ✅    ✅ Patient data extracted successfully
[14:01:32] 📊 Patient Response
     └─ patientFName: Susan
     └─ patientLName: Gonsalves
     └─ dob: 02/03/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2526121
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 30 Nye Ave
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743-2750
     └─ email: 
     └─ phoneNumber: 508-998-8667
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Language Pathology, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/05/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'Z96.641', 'fifthDiagnosis': 'Z86.73', 'sixthDiagnosis': 'Z79.02'}]
[14:01:32] ✅    ✅ Patient identified: Susan Gonsalves
[14:01:32] ✅    ✅ Patient name validation passed
[14:01:32] 🔄 
🔄 Step 3: Processing patient dates...
[14:01:32] [DOC: 9307182] ℹ️  DOB normalized: 02/03/1949
[14:01:32] [DOC: 9307182] ℹ️  Episode startOfCare normalized: 05/05/2025
[14:01:32] [DOC: 9307182] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:01:32] [DOC: 9307182] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:01:32] [DOC: 9307182] ✅ Patient date processing completed successfully
[14:01:32] ✅    ✅ Date processing completed
[14:01:32] 📊 Processed Patient Data
     └─ patientFName: Susan
     └─ patientLName: Gonsalves
     └─ dob: 02/03/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2526121
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 30 Nye Ave
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743-2750
     └─ email: 
     └─ phoneNumber: 508-998-8667
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Language Pathology, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/05/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'Z96.641', 'fifthDiagnosis': 'Z86.73', 'sixthDiagnosis': 'Z79.02'}]
[14:01:32] 🔄 
🔄 Step 4: Extracting order data...
[14:01:35] ℹ️  Order extraction - MRN: '2526121'
[14:01:35] ℹ️  Order extraction - Sex: 'FEMALE'
[14:01:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Speech Language Pathology'
[14:01:35] ℹ️  Order extraction - Payer Source: ''
[14:01:35] ✅ Order data extraction completed successfully
[14:01:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:01:35] ℹ️  Using MRN from patient data: '2526121' over '2526121'
[14:01:35] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Speech Language Pathology, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Speech Language Pathology' = 'Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[14:01:35] ✅ Patient name cross-validation successful
[14:01:35] ✅    ✅ Data merged successfully
[14:01:36] ✅    ✅ Order data extracted and validated
[14:01:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:02:12] [DOC: 9307182] ℹ️  Patient not found in cache or API: Susan Gonsalves
[14:02:12] [DOC: 9307182] ℹ️  Patient not found, creating new patient via API...
[14:02:12] [DOC: 9307182] ℹ️  Creating patient via API: Susan Gonsalves
[14:02:13] [DOC: 9307182] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:02:13] ❌    ❌ Failed to create patient
[14:02:13] [DOC: 9307182] ℹ️  API push details saved for document 9307182
================================================================================
║                        Processing Document ID: 9307167                         ║
================================================================================
[14:02:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:02:13] ℹ️  Date: 05/22/2025
[14:02:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:15] [DOC: 9307167] ✅ Text extracted using pdfplumber (1427 chars)
[14:02:15] ✅    ✅ Text extracted using pdfplumber (1427 chars)
[14:02:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:18] ℹ️  AI extracted raw sex value: 'F'
[14:02:18] ℹ️  AI extracted service line: 'Physical Therapy'
[14:02:18] ℹ️  AI extracted payer source: ''
[14:02:18] ℹ️  AI extracted diagnoses:
[14:02:18] ℹ️    - Diagnosis 1: 'None'
[14:02:18] ℹ️    - Diagnosis 2: 'None'
[14:02:18] ℹ️    - Diagnosis 3: 'None'
[14:02:18] ℹ️    - Diagnosis 4: 'None'
[14:02:18] ℹ️    - Diagnosis 5: 'None'
[14:02:18] ℹ️    - Diagnosis 6: 'None'
[14:02:18] ℹ️  Final extracted MRN: '2391867'
[14:02:18] ℹ️  Final extracted Sex: 'FEMALE'
[14:02:18] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:02:18] ℹ️  Final extracted Payer Source: ''
[14:02:18] ✅ Patient data extraction completed successfully
[14:02:18] ✅    ✅ Patient data extracted successfully
[14:02:18] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Dawson
     └─ dob: 05/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2391867
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:02:18] ✅    ✅ Patient identified: Pearl Dawson
[14:02:18] ✅    ✅ Patient name validation passed
[14:02:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:18] [DOC: 9307167] ℹ️  DOB normalized: 05/01/1931
[14:02:18] [DOC: 9307167] ✅ Patient date processing completed successfully
[14:02:18] ✅    ✅ Date processing completed
[14:02:18] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Dawson
     └─ dob: 05/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2391867
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:02:18] 🔄 
🔄 Step 4: Extracting order data...
[14:02:20] ℹ️  Order extraction - MRN: '2391867'
[14:02:20] ℹ️  Order extraction - Sex: 'FEMALE'
[14:02:20] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:02:20] ℹ️  Order extraction - Payer Source: ''
[14:02:20] ✅ Order data extraction completed successfully
[14:02:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:02:20] ℹ️  Using MRN from patient data: '2391867' over '2391867'
[14:02:20] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:02:20] ✅ Patient name cross-validation successful
[14:02:20] ✅    ✅ Data merged successfully
[14:02:22] ✅    ✅ Order data extracted and validated
[14:02:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:02:27] [DOC: 9307167] ℹ️  Patient not found in cache or API: Pearl Dawson
[14:02:27] [DOC: 9307167] ℹ️  Patient not found, creating new patient via API...
[14:02:27] [DOC: 9307167] ℹ️  Creating patient via API: Pearl Dawson
[14:02:28] [DOC: 9307167] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:02:28] ❌    ❌ Failed to create patient
[14:02:28] [DOC: 9307167] ℹ️  API push details saved for document 9307167
================================================================================
║                        Processing Document ID: 9307161                         ║
================================================================================
[14:02:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:02:28] ℹ️  Date: 05/22/2025
[14:02:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:30] [DOC: 9307161] ✅ Text extracted using pdfplumber (1042 chars)
[14:02:30] ✅    ✅ Text extracted using pdfplumber (1042 chars)
[14:02:30] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:32] ℹ️  AI extracted raw sex value: 'F'
[14:02:32] ℹ️  AI extracted service line: 'Physical Therapy'
[14:02:32] ℹ️  AI extracted payer source: ''
[14:02:32] ℹ️  AI extracted diagnoses:
[14:02:32] ℹ️    - Diagnosis 1: ''
[14:02:32] ℹ️    - Diagnosis 2: ''
[14:02:32] ℹ️    - Diagnosis 3: ''
[14:02:32] ℹ️    - Diagnosis 4: ''
[14:02:32] ℹ️    - Diagnosis 5: ''
[14:02:32] ℹ️    - Diagnosis 6: ''
[14:02:32] ℹ️  Final extracted MRN: '2095187'
[14:02:32] ℹ️  Final extracted Sex: 'FEMALE'
[14:02:32] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:02:32] ℹ️  Final extracted Payer Source: ''
[14:02:32] ✅ Patient data extraction completed successfully
[14:02:32] ✅    ✅ Patient data extracted successfully
[14:02:32] 📊 Patient Response
     └─ patientFName: Robyn
     └─ patientLName: Correira
     └─ dob: 04/11/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2095187
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:02:32] ✅    ✅ Patient identified: Robyn Correira
[14:02:32] ✅    ✅ Patient name validation passed
[14:02:32] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:32] [DOC: 9307161] ℹ️  DOB normalized: 04/11/1958
[14:02:32] [DOC: 9307161] ✅ Patient date processing completed successfully
[14:02:32] ✅    ✅ Date processing completed
[14:02:32] 📊 Processed Patient Data
     └─ patientFName: Robyn
     └─ patientLName: Correira
     └─ dob: 04/11/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2095187
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:02:32] 🔄 
🔄 Step 4: Extracting order data...
[14:02:34] ℹ️  Order extraction - MRN: '2095187'
[14:02:34] ℹ️  Order extraction - Sex: 'FEMALE'
[14:02:34] ℹ️  Order extraction - Service Line: ''
[14:02:34] ℹ️  Order extraction - Payer Source: ''
[14:02:34] ✅ Order data extraction completed successfully
[14:02:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:02:34] ℹ️  Using MRN from patient data: '2095187' over '2095187'
[14:02:34] ℹ️  Using service line from patient data: 'Physical Therapy'
[14:02:34] ✅ Patient name cross-validation successful
[14:02:34] ✅    ✅ Data merged successfully
[14:02:36] ⚠️     ❌ Skipping - missing episode start date
[14:02:36] [DOC: 9307161] ℹ️  API push details saved for document 9307161
================================================================================
║                        Processing Document ID: 9307045                         ║
================================================================================
[14:02:36] ℹ️  Agency: Nizhoni Health Systems-Somerville
[14:02:36] ℹ️  Date: 05/22/2025
[14:02:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:39] [DOC: 9307045] ✅ Text extracted using pdfplumber (11929 chars)
[14:02:39] ✅    ✅ Text extracted using pdfplumber (11929 chars)
[14:02:39] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:42] ℹ️  AI extracted raw sex value: 'M'
[14:02:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:02:42] ℹ️  AI extracted payer source: 'None'
[14:02:42] ℹ️  AI extracted diagnoses:
[14:02:42] ℹ️    - Diagnosis 1: 'F31.9'
[14:02:42] ℹ️    - Diagnosis 2: 'F25.0'
[14:02:42] ℹ️    - Diagnosis 3: 'E11.9'
[14:02:42] ℹ️    - Diagnosis 4: 'I10'
[14:02:42] ℹ️    - Diagnosis 5: 'H40.9'
[14:02:42] ℹ️    - Diagnosis 6: 'M13.80'
[14:02:42] ℹ️  Final extracted MRN: '47012'
[14:02:42] ℹ️  Final extracted Sex: 'MALE'
[14:02:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:02:42] ℹ️  Final extracted Payer Source: ''
[14:02:42] ✅ Patient data extraction completed successfully
[14:02:42] ✅    ✅ Patient data extracted successfully
[14:02:42] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Furtado
     └─ dob: 12/17/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 47012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/14/2023', 'startOfEpisode': '07/14/2023', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F25.0', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'H40.9', 'sixthDiagnosis': 'M13.80'}]
[14:02:42] ✅    ✅ Patient identified: Frank Furtado
[14:02:42] ✅    ✅ Patient name validation passed
[14:02:42] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:42] [DOC: 9307045] ℹ️  DOB normalized: 12/17/1969
[14:02:42] [DOC: 9307045] ℹ️  Episode startOfCare normalized: 07/14/2023
[14:02:42] [DOC: 9307045] ℹ️  Episode startOfEpisode normalized: 07/14/2023
[14:02:42] [DOC: 9307045] ℹ️  Episode endOfEpisode normalized: 07/02/2025
[14:02:42] [DOC: 9307045] ✅ Patient date processing completed successfully
[14:02:42] ✅    ✅ Date processing completed
[14:02:42] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Furtado
     └─ dob: 12/17/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 47012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/14/2023', 'startOfEpisode': '07/14/2023', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F25.0', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'H40.9', 'sixthDiagnosis': 'M13.80'}]
[14:02:42] 🔄 
🔄 Step 4: Extracting order data...
[14:02:45] ℹ️  Order extraction - MRN: '47012'
[14:02:45] ℹ️  Order extraction - Sex: 'MALE'
[14:02:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:02:45] ℹ️  Order extraction - Payer Source: ''
[14:02:45] ✅ Order data extraction completed successfully
[14:02:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:02:45] ℹ️  Using MRN from patient data: '47012' over '47012'
[14:02:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:02:45] ✅ Patient name cross-validation successful
[14:02:45] ✅    ✅ Data merged successfully
[14:02:46] ✅    ✅ Order data extracted and validated
[14:02:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:02:59] [DOC: 9307045] ℹ️  Patient not found in cache or API: Frank Furtado
[14:02:59] [DOC: 9307045] ℹ️  Patient not found, creating new patient via API...
[14:02:59] [DOC: 9307045] ℹ️  Creating patient via API: Frank Furtado
[14:03:00] [DOC: 9307045] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:03:00] ❌    ❌ Failed to create patient
[14:03:00] [DOC: 9307045] ℹ️  API push details saved for document 9307045
================================================================================
║                        Processing Document ID: 9307033                         ║
================================================================================
[14:03:00] ℹ️  Agency: Nizhoni Health-Stoughton
[14:03:00] ℹ️  Date: 05/22/2025
[14:03:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:03:09] [DOC: 9307033] ✅ Text extracted using pdfplumber (13792 chars)
[14:03:09] ✅    ✅ Text extracted using pdfplumber (13792 chars)
[14:03:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:03:12] ℹ️  AI extracted raw sex value: 'F'
[14:03:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:03:12] ℹ️  AI extracted payer source: 'None'
[14:03:12] ℹ️  AI extracted diagnoses:
[14:03:12] ℹ️    - Diagnosis 1: 'F25.0'
[14:03:12] ℹ️    - Diagnosis 2: 'E11.9'
[14:03:12] ℹ️    - Diagnosis 3: 'I10'
[14:03:12] ℹ️    - Diagnosis 4: 'J45.909'
[14:03:12] ℹ️    - Diagnosis 5: 'E78.5'
[14:03:12] ℹ️    - Diagnosis 6: 'K21.9'
[14:03:12] ℹ️  Final extracted MRN: '2009012'
[14:03:12] ℹ️  Final extracted Sex: 'FEMALE'
[14:03:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:03:12] ℹ️  Final extracted Payer Source: ''
[14:03:12] ✅ Patient data extraction completed successfully
[14:03:12] ✅    ✅ Patient data extracted successfully
[14:03:12] 📊 Patient Response
     └─ patientFName: Michelle
     └─ patientLName: Waddington
     └─ dob: 10/15/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2009012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/28/2020', 'startOfEpisode': '07/28/2020', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[14:03:12] ✅    ✅ Patient identified: Michelle Waddington
[14:03:12] ✅    ✅ Patient name validation passed
[14:03:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:03:12] [DOC: 9307033] ℹ️  DOB normalized: 10/15/1963
[14:03:12] [DOC: 9307033] ℹ️  Episode startOfCare normalized: 07/28/2020
[14:03:12] [DOC: 9307033] ℹ️  Episode startOfEpisode normalized: 07/28/2020
[14:03:12] [DOC: 9307033] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[14:03:12] [DOC: 9307033] ✅ Patient date processing completed successfully
[14:03:12] ✅    ✅ Date processing completed
[14:03:12] 📊 Processed Patient Data
     └─ patientFName: Michelle
     └─ patientLName: Waddington
     └─ dob: 10/15/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2009012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/28/2020', 'startOfEpisode': '07/28/2020', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[14:03:12] 🔄 
🔄 Step 4: Extracting order data...
[14:03:15] ℹ️  Order extraction - MRN: '2009012'
[14:03:15] ℹ️  Order extraction - Sex: 'FEMALE'
[14:03:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:03:15] ℹ️  Order extraction - Payer Source: ''
[14:03:15] ✅ Order data extraction completed successfully
[14:03:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:15] ℹ️  Using MRN from patient data: '2009012' over '2009012'
[14:03:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:03:15] ✅ Patient name cross-validation successful
[14:03:15] ✅    ✅ Data merged successfully
[14:03:16] ✅    ✅ Order data extracted and validated
[14:03:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:03:22] [DOC: 9307033] ℹ️  Patient not found in cache or API: Michelle Waddington
[14:03:22] [DOC: 9307033] ℹ️  Patient not found, creating new patient via API...
[14:03:22] [DOC: 9307033] ℹ️  Creating patient via API: Michelle Waddington
[14:03:23] [DOC: 9307033] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:03:23] ❌    ❌ Failed to create patient
[14:03:23] [DOC: 9307033] ℹ️  API push details saved for document 9307033
================================================================================
║                        Processing Document ID: 9307024                         ║
================================================================================
[14:03:23] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:03:23] ℹ️  Date: 05/22/2025
[14:03:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:03:25] [DOC: 9307024] ✅ Text extracted using pdfplumber (1132 chars)
[14:03:25] ✅    ✅ Text extracted using pdfplumber (1132 chars)
[14:03:25] 🔄 
🔄 Step 2: Extracting patient data...
[14:03:27] ℹ️  AI extracted raw sex value: 'M'
[14:03:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:03:27] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:03:27] ℹ️  AI extracted diagnoses:
[14:03:27] ℹ️    - Diagnosis 1: 'None'
[14:03:27] ℹ️    - Diagnosis 2: 'None'
[14:03:27] ℹ️    - Diagnosis 3: 'None'
[14:03:27] ℹ️    - Diagnosis 4: 'None'
[14:03:27] ℹ️    - Diagnosis 5: 'None'
[14:03:27] ℹ️    - Diagnosis 6: 'None'
[14:03:27] ℹ️  Final extracted MRN: '648005'
[14:03:27] ℹ️  Final extracted Sex: 'MALE'
[14:03:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:03:27] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:03:27] ✅ Patient data extraction completed successfully
[14:03:27] ✅    ✅ Patient data extracted successfully
[14:03:27] 📊 Patient Response
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: None
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:03:27] ✅    ✅ Patient identified: Pedro Sousa
[14:03:27] ✅    ✅ Patient name validation passed
[14:03:27] 🔄 
🔄 Step 3: Processing patient dates...
[14:03:27] [DOC: 9307024] ℹ️  DOB normalized: 03/29/1964
[14:03:27] [DOC: 9307024] ℹ️  Episode startOfCare normalized: 03/25/2025
[14:03:27] [DOC: 9307024] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:03:27] [DOC: 9307024] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:03:27] [DOC: 9307024] ✅ Patient date processing completed successfully
[14:03:27] ✅    ✅ Date processing completed
[14:03:27] 📊 Processed Patient Data
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025'}]
[14:03:27] 🔄 
🔄 Step 4: Extracting order data...
[14:03:30] ℹ️  Order extraction - MRN: '648005'
[14:03:30] ℹ️  Order extraction - Sex: 'MALE'
[14:03:30] ℹ️  Order extraction - Service Line: 'Skilled Observation & Assessment of Incision Line'
[14:03:30] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:03:30] ✅ Order data extraction completed successfully
[14:03:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:30] ℹ️  Using MRN from patient data: '648005' over '648005'
[14:03:30] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Observation & Assessment of Incision Line' = 'Skilled Nursing, Skilled Observation & Assessment of Incision Line'
[14:03:30] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:03:30] ✅ Patient name cross-validation successful
[14:03:30] ✅    ✅ Data merged successfully
[14:03:31] ✅    ✅ Order data extracted and validated
[14:03:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:03:31] [DOC: 9307024] ✅ Patient found in local cache: Pedro Sousa, ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:03:31] ✅    ✅ Existing patient found with ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:03:31] 🔄 
🔄 Step 6: Pushing order to API...
[14:03:31] [DOC: 9307024] ℹ️  Pushing order via API for patient ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:03:33] [DOC: 9307024] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:03:33] ❌    ❌ Failed to push order
[14:03:33] 🔄 
🔄 Step 7: Writing to CSV...
[14:03:33] [DOC: 9307024] ℹ️  Calculated age: 61 from DOB: 03/29/1964
[14:03:33] [DOC: 9307024] ℹ️  Service Line extracted: 'Skilled Nursing, Skilled Observation & Assessment of Incision Line'
[14:03:33] [DOC: 9307024] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:03:33] [DOC: 9307024] ℹ️  Diagnosis codes being written:
[14:03:33] [DOC: 9307024] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:03:33] [DOC: 9307024] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:03:33] [DOC: 9307024] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:03:33] [DOC: 9307024] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:03:33] [DOC: 9307024] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:03:33] [DOC: 9307024] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:03:33] [DOC: 9307024] ✅ Patient data written to CSV: Pedro Sousa | Sex: MALE | Age: 61 | Service: Skilled Nursing, Skilled Observation & Assessment of Incision Line | Payer: Medicaid/MA | MRN: 648005
[14:03:33] ✅    ✅ Document 9307024 processed and saved successfully
[14:03:33] 🔄 
🔄 Step 8: Saving API details...
[14:03:33] [DOC: 9307024] ℹ️  API push details saved for document 9307024
[14:03:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307010                         ║
================================================================================
[14:03:33] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:03:33] ℹ️  Date: 05/22/2025
[14:03:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:03:35] [DOC: 9307010] ✅ Text extracted using pdfplumber (1739 chars)
[14:03:35] ✅    ✅ Text extracted using pdfplumber (1739 chars)
[14:03:35] 🔄 
🔄 Step 2: Extracting patient data...
[14:03:38] ℹ️  AI extracted raw sex value: 'M'
[14:03:38] ℹ️  AI extracted service line: 'RN, LPN'
[14:03:38] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:03:38] ℹ️  AI extracted diagnoses:
[14:03:38] ℹ️    - Diagnosis 1: 'None'
[14:03:38] ℹ️    - Diagnosis 2: 'None'
[14:03:38] ℹ️    - Diagnosis 3: 'None'
[14:03:38] ℹ️    - Diagnosis 4: 'None'
[14:03:38] ℹ️    - Diagnosis 5: 'None'
[14:03:38] ℹ️    - Diagnosis 6: 'None'
[14:03:38] ℹ️  Final extracted MRN: '343005'
[14:03:38] ℹ️  Final extracted Sex: 'MALE'
[14:03:38] ℹ️  Final extracted Service Line: 'RN, LPN'
[14:03:38] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:03:38] ✅ Patient data extraction completed successfully
[14:03:38] ✅    ✅ Patient data extracted successfully
[14:03:38] 📊 Patient Response
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': None, 'endOfEpisode': '07/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:03:38] ✅    ✅ Patient identified: Kevin Livramento
[14:03:38] ✅    ✅ Patient name validation passed
[14:03:38] 🔄 
🔄 Step 3: Processing patient dates...
[14:03:38] [DOC: 9307010] ℹ️  DOB normalized: 08/25/1966
[14:03:38] [DOC: 9307010] ℹ️  Episode startOfCare normalized: 09/27/2022
[14:03:38] [DOC: 9307010] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[14:03:38] [DOC: 9307010] ✅ Patient date processing completed successfully
[14:03:38] ✅    ✅ Date processing completed
[14:03:38] 📊 Processed Patient Data
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'endOfEpisode': '07/12/2025'}]
[14:03:38] 🔄 
🔄 Step 4: Extracting order data...
[14:03:40] ℹ️  Order extraction - MRN: '343005'
[14:03:40] ℹ️  Order extraction - Sex: 'MALE'
[14:03:40] ℹ️  Order extraction - Service Line: 'RN, LPN'
[14:03:40] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:03:40] ✅ Order data extraction completed successfully
[14:03:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:40] ℹ️  Using MRN from patient data: '343005' over '343005'
[14:03:40] ℹ️  Service line consistent in both sources: 'RN, LPN'
[14:03:40] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:03:40] ✅ Patient name cross-validation successful
[14:03:40] ✅    ✅ Data merged successfully
[14:03:42] ✅    ✅ Order data extracted and validated
[14:03:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:03:48] [DOC: 9307010] ✅ Patient exists in API: Kevin Livramento, ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[14:03:48] ✅    ✅ Existing patient found with ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[14:03:48] 🔄 
🔄 Step 6: Pushing order to API...
[14:03:48] [DOC: 9307010] ℹ️  Pushing order via API for patient ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[14:03:49] [DOC: 9307010] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:03:49] ❌    ❌ Failed to push order
[14:03:49] 🔄 
🔄 Step 7: Writing to CSV...
[14:03:49] [DOC: 9307010] ℹ️  Calculated age: 58 from DOB: 08/25/1966
[14:03:49] [DOC: 9307010] ℹ️  Service Line extracted: 'RN, LPN'
[14:03:49] [DOC: 9307010] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:03:49] [DOC: 9307010] ℹ️  Diagnosis codes being written:
[14:03:49] [DOC: 9307010] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:03:49] [DOC: 9307010] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:03:49] [DOC: 9307010] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:03:49] [DOC: 9307010] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:03:49] [DOC: 9307010] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:03:49] [DOC: 9307010] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:03:49] [DOC: 9307010] ✅ Patient data written to CSV: Kevin Livramento | Sex: MALE | Age: 58 | Service: RN, LPN | Payer: Medicaid/MA | MRN: 343005
[14:03:49] ✅    ✅ Document 9307010 processed and saved successfully
[14:03:49] 🔄 
🔄 Step 8: Saving API details...
[14:03:49] [DOC: 9307010] ℹ️  API push details saved for document 9307010
[14:03:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9306803                         ║
================================================================================
[14:03:49] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:03:49] ℹ️  Date: 05/22/2025
[14:03:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:03:51] [DOC: 9306803] ✅ Text extracted using pdfplumber (1643 chars)
[14:03:51] ✅    ✅ Text extracted using pdfplumber (1643 chars)
[14:03:51] 🔄 
🔄 Step 2: Extracting patient data...
[14:03:54] ℹ️  AI extracted raw sex value: 'M'
[14:03:54] ℹ️  AI extracted service line: 'HHA'
[14:03:54] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:03:54] ℹ️  AI extracted diagnoses:
[14:03:54] ℹ️    - Diagnosis 1: ''
[14:03:54] ℹ️    - Diagnosis 2: ''
[14:03:54] ℹ️    - Diagnosis 3: ''
[14:03:54] ℹ️    - Diagnosis 4: ''
[14:03:54] ℹ️    - Diagnosis 5: ''
[14:03:54] ℹ️    - Diagnosis 6: ''
[14:03:54] ℹ️  Final extracted MRN: '457'
[14:03:54] ℹ️  Final extracted Sex: 'MALE'
[14:03:54] ℹ️  Final extracted Service Line: 'HHA'
[14:03:54] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:03:54] ✅ Patient data extraction completed successfully
[14:03:54] ✅    ✅ Patient data extracted successfully
[14:03:54] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1982632006
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:03:54] ✅    ✅ Patient identified: Manuel Varela
[14:03:54] ✅    ✅ Patient name validation passed
[14:03:54] 🔄 
🔄 Step 3: Processing patient dates...
[14:03:54] [DOC: 9306803] ℹ️  DOB normalized: 02/08/1969
[14:03:54] [DOC: 9306803] ℹ️  Episode startOfCare normalized: 11/07/2024
[14:03:54] [DOC: 9306803] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:03:54] [DOC: 9306803] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:03:54] [DOC: 9306803] ✅ Patient date processing completed successfully
[14:03:54] ✅    ✅ Date processing completed
[14:03:54] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1982632006
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:03:54] 🔄 
🔄 Step 4: Extracting order data...
[14:03:57] ℹ️  Order extraction - MRN: '457'
[14:03:57] ℹ️  Order extraction - Sex: 'MALE'
[14:03:57] ℹ️  Order extraction - Service Line: 'HHA'
[14:03:57] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:03:57] ✅ Order data extraction completed successfully
[14:03:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:57] ℹ️  Using MRN from patient data: '457' over '457'
[14:03:57] ℹ️  Service line consistent in both sources: 'HHA'
[14:03:57] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:03:57] ✅ Patient name cross-validation successful
[14:03:57] ✅    ✅ Data merged successfully
[14:04:00] ✅    ✅ Order data extracted and validated
[14:04:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:04:00] [DOC: 9306803] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[14:04:00] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[14:04:00] 🔄 
🔄 Step 6: Pushing order to API...
[14:04:00] [DOC: 9306803] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[14:04:01] [DOC: 9306803] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:04:01] ❌    ❌ Failed to push order
[14:04:01] 🔄 
🔄 Step 7: Writing to CSV...
[14:04:01] [DOC: 9306803] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[14:04:01] [DOC: 9306803] ℹ️  Service Line extracted: 'HHA'
[14:04:01] [DOC: 9306803] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:04:01] [DOC: 9306803] ℹ️  Diagnosis codes being written:
[14:04:01] [DOC: 9306803] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:04:01] [DOC: 9306803] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:04:01] [DOC: 9306803] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:04:01] [DOC: 9306803] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:04:01] [DOC: 9306803] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:04:01] [DOC: 9306803] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:04:01] [DOC: 9306803] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: HHA | Payer: Medicaid/MA | MRN: 457
[14:04:01] ✅    ✅ Document 9306803 processed and saved successfully
[14:04:01] 🔄 
🔄 Step 8: Saving API details...
[14:04:01] [DOC: 9306803] ℹ️  API push details saved for document 9306803
[14:04:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9306355                         ║
================================================================================
[14:04:01] ℹ️  Agency: Dartmouth HH
[14:04:01] ℹ️  Date: 05/22/2025
[14:04:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:04:03] [DOC: 9306355] ✅ Text extracted using pdfplumber (1856 chars)
[14:04:03] ✅    ✅ Text extracted using pdfplumber (1856 chars)
[14:04:03] 🔄 
🔄 Step 2: Extracting patient data...
[14:04:06] ℹ️  AI extracted raw sex value: 'M'
[14:04:06] ℹ️  AI extracted service line: 'Skilled Nursing, OT, PT'
[14:04:06] ℹ️  AI extracted payer source: 'Medicare'
[14:04:06] ℹ️  AI extracted diagnoses:
[14:04:06] ℹ️    - Diagnosis 1: ''
[14:04:06] ℹ️    - Diagnosis 2: ''
[14:04:06] ℹ️    - Diagnosis 3: ''
[14:04:06] ℹ️    - Diagnosis 4: ''
[14:04:06] ℹ️    - Diagnosis 5: ''
[14:04:06] ℹ️    - Diagnosis 6: ''
[14:04:06] ℹ️  Final extracted MRN: '864008'
[14:04:06] ℹ️  Final extracted Sex: 'MALE'
[14:04:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT, PT'
[14:04:06] ℹ️  Final extracted Payer Source: 'Medicare'
[14:04:06] ✅ Patient data extraction completed successfully
[14:04:06] ✅    ✅ Patient data extracted successfully
[14:04:06] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:06] ✅    ✅ Patient identified: Robert Lawton
[14:04:06] ✅    ✅ Patient name validation passed
[14:04:06] 🔄 
🔄 Step 3: Processing patient dates...
[14:04:06] [DOC: 9306355] ℹ️  DOB normalized: 06/15/1943
[14:04:06] [DOC: 9306355] ℹ️  Episode startOfCare normalized: 03/18/2025
[14:04:06] [DOC: 9306355] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[14:04:06] [DOC: 9306355] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[14:04:06] [DOC: 9306355] ✅ Patient date processing completed successfully
[14:04:06] ✅    ✅ Date processing completed
[14:04:06] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:06] 🔄 
🔄 Step 4: Extracting order data...
[14:04:09] ℹ️  Order extraction - MRN: ''
[14:04:09] ℹ️  Order extraction - Sex: 'MALE'
[14:04:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing, OT, PT'
[14:04:09] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:04:09] ✅ Order data extraction completed successfully
[14:04:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:04:09] ℹ️  Using MRN from patient data: '864008'
[14:04:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing, OT, PT'
[14:04:09] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:04:09] ✅ Patient name cross-validation successful
[14:04:09] ✅    ✅ Data merged successfully
[14:04:10] ✅    ✅ Order data extracted and validated
[14:04:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:04:22] [DOC: 9306355] ℹ️  Patient not found in cache or API: Robert Lawton
[14:04:22] [DOC: 9306355] ℹ️  Patient not found, creating new patient via API...
[14:04:22] [DOC: 9306355] ℹ️  Creating patient via API: Robert Lawton
[14:04:23] [DOC: 9306355] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:04:23] ❌    ❌ Failed to create patient
[14:04:23] [DOC: 9306355] ℹ️  API push details saved for document 9306355
================================================================================
║                        Processing Document ID: 9308077                         ║
================================================================================
[14:04:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:04:23] ℹ️  Date: 05/22/2025
[14:04:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:04:25] [DOC: 9308077] ✅ Text extracted using pdfplumber (1438 chars)
[14:04:25] ✅    ✅ Text extracted using pdfplumber (1438 chars)
[14:04:25] 🔄 
🔄 Step 2: Extracting patient data...
[14:04:28] ℹ️  AI extracted raw sex value: ''
[14:04:28] ℹ️  AI extracted service line: 'Physical Therapy'
[14:04:28] ℹ️  AI extracted payer source: ''
[14:04:28] ℹ️  AI extracted diagnoses:
[14:04:28] ℹ️    - Diagnosis 1: 'J44.1'
[14:04:28] ℹ️    - Diagnosis 2: 'I10'
[14:04:28] ℹ️    - Diagnosis 3: 'E11.65'
[14:04:28] ℹ️    - Diagnosis 4: ''
[14:04:28] ℹ️    - Diagnosis 5: ''
[14:04:28] ℹ️    - Diagnosis 6: ''
[14:04:28] ℹ️  Final extracted MRN: '100990744'
[14:04:28] ℹ️  Final extracted Sex: ''
[14:04:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:04:28] ℹ️  Final extracted Payer Source: ''
[14:04:28] ✅ Patient data extraction completed successfully
[14:04:28] ✅    ✅ Patient data extracted successfully
[14:04:28] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:28] ✅    ✅ Patient identified: Barbara Grace
[14:04:28] ✅    ✅ Patient name validation passed
[14:04:28] 🔄 
🔄 Step 3: Processing patient dates...
[14:04:28] [DOC: 9308077] ℹ️  DOB normalized: 10/21/1948
[14:04:28] [DOC: 9308077] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[14:04:28] [DOC: 9308077] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[14:04:28] [DOC: 9308077] ✅ Patient date processing completed successfully
[14:04:28] ✅    ✅ Date processing completed
[14:04:28] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:28] 🔄 
🔄 Step 4: Extracting order data...
[14:04:31] ℹ️  Order extraction - MRN: '100990744'
[14:04:31] ℹ️  Order extraction - Sex: ''
[14:04:31] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:04:31] ℹ️  Order extraction - Payer Source: ''
[14:04:31] ✅ Order data extraction completed successfully
[14:04:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:04:31] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[14:04:31] ℹ️  Inferred sex as FEMALE from name: Barbara
[14:04:31] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:04:31] ✅ Patient name cross-validation successful
[14:04:31] ✅    ✅ Data merged successfully
[14:04:32] ✅    ✅ Order data extracted and validated
[14:04:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:04:32] [DOC: 9308077] ✅ Patient found in local cache: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[14:04:32] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[14:04:32] 🔄 
🔄 Step 6: Pushing order to API...
[14:04:32] [DOC: 9308077] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[14:04:34] [DOC: 9308077] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19029"}
[14:04:34] ❌    ❌ Failed to push order
[14:04:34] 🔄 
🔄 Step 7: Writing to CSV...
[14:04:34] [DOC: 9308077] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[14:04:34] [DOC: 9308077] ℹ️  Service Line extracted: 'Physical Therapy'
[14:04:34] [DOC: 9308077] ℹ️  Payer Source extracted: ''
[14:04:34] [DOC: 9308077] ℹ️  Diagnosis codes being written:
[14:04:34] [DOC: 9308077] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[14:04:34] [DOC: 9308077] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[14:04:34] [DOC: 9308077] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[14:04:34] [DOC: 9308077] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:04:34] [DOC: 9308077] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:04:34] [DOC: 9308077] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:04:34] [DOC: 9308077] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: Physical Therapy | Payer:  | MRN: 100990744
[14:04:34] ✅    ✅ Document 9308077 processed and saved successfully
[14:04:34] 🔄 
🔄 Step 8: Saving API details...
[14:04:34] [DOC: 9308077] ℹ️  API push details saved for document 9308077
[14:04:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307291                         ║
================================================================================
[14:04:34] ℹ️  Agency: Dartmouth HH
[14:04:34] ℹ️  Date: 05/22/2025
[14:04:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:04:36] [DOC: 9307291] ✅ Text extracted using pdfplumber (3826 chars)
[14:04:36] ✅    ✅ Text extracted using pdfplumber (3826 chars)
[14:04:36] 🔄 
🔄 Step 2: Extracting patient data...
[14:04:39] ℹ️  AI extracted raw sex value: 'M'
[14:04:39] ℹ️  AI extracted service line: 'OT'
[14:04:39] ℹ️  AI extracted payer source: 'United Health Care'
[14:04:39] ℹ️  AI extracted diagnoses:
[14:04:39] ℹ️    - Diagnosis 1: ''
[14:04:39] ℹ️    - Diagnosis 2: ''
[14:04:39] ℹ️    - Diagnosis 3: ''
[14:04:39] ℹ️    - Diagnosis 4: ''
[14:04:39] ℹ️    - Diagnosis 5: ''
[14:04:39] ℹ️    - Diagnosis 6: ''
[14:04:39] ℹ️  Final extracted MRN: '926015'
[14:04:39] ℹ️  Final extracted Sex: 'MALE'
[14:04:39] ℹ️  Final extracted Service Line: 'OT'
[14:04:39] ℹ️  Final extracted Payer Source: 'United Health Care'
[14:04:39] ✅ Patient data extraction completed successfully
[14:04:39] ✅    ✅ Patient data extracted successfully
[14:04:39] 📊 Patient Response
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:39] ✅    ✅ Patient identified: Clinton Sowle
[14:04:39] ✅    ✅ Patient name validation passed
[14:04:39] 🔄 
🔄 Step 3: Processing patient dates...
[14:04:39] [DOC: 9307291] ℹ️  DOB normalized: 12/01/1943
[14:04:39] [DOC: 9307291] ℹ️  Episode startOfCare normalized: 04/28/2025
[14:04:39] [DOC: 9307291] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[14:04:39] [DOC: 9307291] ℹ️  Episode endOfEpisode normalized: 06/26/2025
[14:04:39] [DOC: 9307291] ✅ Patient date processing completed successfully
[14:04:39] ✅    ✅ Date processing completed
[14:04:39] 📊 Processed Patient Data
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:39] 🔄 
🔄 Step 4: Extracting order data...
[14:04:41] ℹ️  Order extraction - MRN: '926015'
[14:04:41] ℹ️  Order extraction - Sex: 'MALE'
[14:04:41] ℹ️  Order extraction - Service Line: 'OT'
[14:04:41] ℹ️  Order extraction - Payer Source: 'United Health Care'
[14:04:41] ✅ Order data extraction completed successfully
[14:04:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:04:41] ℹ️  Using MRN from patient data: '926015' over '926015'
[14:04:41] ℹ️  Service line consistent in both sources: 'OT'
[14:04:41] ℹ️  Payer source consistent in both sources: 'United Health Care'
[14:04:41] ✅ Patient name cross-validation successful
[14:04:41] ✅    ✅ Data merged successfully
[14:04:42] ✅    ✅ Order data extracted and validated
[14:04:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:05:08] [DOC: 9307291] ✅ Patient exists in API: Clinton Sowle, ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[14:05:08] ✅    ✅ Existing patient found with ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[14:05:08] 🔄 
🔄 Step 6: Pushing order to API...
[14:05:08] [DOC: 9307291] ℹ️  Pushing order via API for patient ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[14:05:10] [DOC: 9307291] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:05:10] ❌    ❌ Failed to push order
[14:05:10] 🔄 
🔄 Step 7: Writing to CSV...
[14:05:10] [DOC: 9307291] ℹ️  Calculated age: 81 from DOB: 12/01/1943
[14:05:10] [DOC: 9307291] ℹ️  Service Line extracted: 'OT'
[14:05:10] [DOC: 9307291] ℹ️  Payer Source extracted: 'United Health Care'
[14:05:10] [DOC: 9307291] ℹ️  Diagnosis codes being written:
[14:05:10] [DOC: 9307291] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:05:10] [DOC: 9307291] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:05:10] [DOC: 9307291] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:05:10] [DOC: 9307291] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:05:10] [DOC: 9307291] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:05:10] [DOC: 9307291] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:05:10] [DOC: 9307291] ✅ Patient data written to CSV: Clinton Sowle | Sex: MALE | Age: 81 | Service: OT | Payer: United Health Care | MRN: 926015
[14:05:10] ✅    ✅ Document 9307291 processed and saved successfully
[14:05:10] 🔄 
🔄 Step 8: Saving API details...
[14:05:10] [DOC: 9307291] ℹ️  API push details saved for document 9307291
[14:05:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305970                         ║
================================================================================
[14:05:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:05:10] ℹ️  Date: 05/21/2025
[14:05:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:05:12] [DOC: 9305970] ✅ Text extracted using pdfplumber (1389 chars)
[14:05:12] ✅    ✅ Text extracted using pdfplumber (1389 chars)
[14:05:12] 🔄 
🔄 Step 2: Extracting patient data...
[14:05:15] ℹ️  AI extracted raw sex value: ''
[14:05:15] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:05:15] ℹ️  AI extracted payer source: ''
[14:05:15] ℹ️  AI extracted diagnoses:
[14:05:15] ℹ️    - Diagnosis 1: 'E11.65'
[14:05:15] ℹ️    - Diagnosis 2: 'I25.10'
[14:05:15] ℹ️    - Diagnosis 3: 'I12.9'
[14:05:15] ℹ️    - Diagnosis 4: 'None'
[14:05:15] ℹ️    - Diagnosis 5: 'None'
[14:05:15] ℹ️    - Diagnosis 6: 'None'
[14:05:15] ℹ️  Final extracted MRN: 'MA220126074307'
[14:05:15] ℹ️  Final extracted Sex: ''
[14:05:15] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:05:15] ℹ️  Final extracted Payer Source: ''
[14:05:15] ✅ Patient data extraction completed successfully
[14:05:15] ✅    ✅ Patient data extracted successfully
[14:05:15] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 1487641502
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:05:15] ✅    ✅ Patient identified: Manuel Furtado
[14:05:15] ✅    ✅ Patient name validation passed
[14:05:15] 🔄 
🔄 Step 3: Processing patient dates...
[14:05:15] [DOC: 9305970] ℹ️  DOB normalized: 07/13/1943
[14:05:15] [DOC: 9305970] ℹ️  Episode startOfEpisode normalized: 05/15/2025
[14:05:15] [DOC: 9305970] ℹ️  Episode endOfEpisode normalized: 07/13/2025
[14:05:15] [DOC: 9305970] ✅ Patient date processing completed successfully
[14:05:15] ✅    ✅ Date processing completed
[14:05:15] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 1487641502
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I12.9'}]
[14:05:15] 🔄 
🔄 Step 4: Extracting order data...
[14:05:17] ℹ️  Order extraction - MRN: 'MA220126074307'
[14:05:17] ℹ️  Order extraction - Sex: ''
[14:05:17] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:05:17] ℹ️  Order extraction - Payer Source: ''
[14:05:17] ✅ Order data extraction completed successfully
[14:05:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:05:17] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[14:05:17] ⚠️  Could not determine sex using any available method
[14:05:17] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:05:17] ✅ Patient name cross-validation successful
[14:05:17] ✅    ✅ Data merged successfully
[14:05:18] ✅    ✅ Order data extracted and validated
[14:05:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:05:18] [DOC: 9305970] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[14:05:18] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[14:05:18] 🔄 
🔄 Step 6: Pushing order to API...
[14:05:18] [DOC: 9305970] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[14:05:19] [DOC: 9305970] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19031"}
[14:05:19] ❌    ❌ Failed to push order
[14:05:19] 🔄 
🔄 Step 7: Writing to CSV...
[14:05:19] [DOC: 9305970] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[14:05:19] [DOC: 9305970] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:05:19] [DOC: 9305970] ℹ️  Payer Source extracted: ''
[14:05:19] [DOC: 9305970] ℹ️  Diagnosis codes being written:
[14:05:19] [DOC: 9305970] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[14:05:19] [DOC: 9305970] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[14:05:19] [DOC: 9305970] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[14:05:19] [DOC: 9305970] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:05:19] [DOC: 9305970] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:05:19] [DOC: 9305970] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:05:19] [DOC: 9305970] ✅ Patient data written to CSV: Manuel Furtado | Sex:  | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: MA220126074307
[14:05:19] ✅    ✅ Document 9305970 processed and saved successfully
[14:05:19] 🔄 
🔄 Step 8: Saving API details...
[14:05:19] [DOC: 9305970] ℹ️  API push details saved for document 9305970
[14:05:19] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[14:05:19] ℹ️  Total Processed: 49
[14:05:19] ℹ️  CSV Success: 28
[14:05:19] ℹ️  CSV Errors: 3
[14:05:19] ℹ️  API Success: 0
[14:05:19] ℹ️  API Errors: 46
[14:05:19] ℹ️  CSV Success Rate: 57.1%
[14:05:19] ℹ️  API Success Rate: 0.0%
[14:05:19] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_134900.csv
[14:05:19] ℹ️  API Details File: api_outputs/api_push_details_20250607_134900.csv
================================================================================
║          ============================================================          ║
================================================================================
