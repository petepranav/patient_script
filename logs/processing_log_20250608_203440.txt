================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[20:34:40] ℹ️  CSV Data Extraction & API Push Tool
[20:34:40] ℹ️  
[20:34:40] ℹ️  Features:
[20:34:40] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[20:34:40] ℹ️  - AI-powered patient and order data extraction
[20:34:40] ℹ️  - Enhanced error handling and logging
[20:34:40] ℹ️  - Full API integration (patient creation + order pushing)
[20:34:40] ℹ️  - CSV output with comprehensive patient data
[20:34:40] ℹ️  - Detailed API tracking with remarks for every document
[20:34:40] ℹ️  - Complete audit trail of all processing attempts
[20:34:40] ℹ️  
[20:34:40] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[20:34:40] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_203440.csv
[20:34:40] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_203440.csv
================================================================================
║                        Processing Document ID: 9208950                         ║
================================================================================
[20:34:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[20:34:40] ℹ️  Date: 03/28/2025
[20:34:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:34:44] [DOC: 9208950] ✅ Text extracted using pdfplumber (12555 chars)
[20:34:44] ✅    ✅ Text extracted using pdfplumber (12555 chars)
[20:34:44] 🔄 
🔄 Step 2: Extracting patient data...
[20:34:48] ℹ️  AI extracted raw sex value: 'M'
[20:34:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:34:48] ℹ️  AI extracted payer source: 'SWH'
[20:34:48] ℹ️  AI extracted diagnoses:
[20:34:48] ℹ️    - Diagnosis 1: 'I48.92'
[20:34:48] ℹ️    - Diagnosis 2: 'A08.4'
[20:34:48] ℹ️    - Diagnosis 3: 'J18.9'
[20:34:48] ℹ️    - Diagnosis 4: 'G20.A1'
[20:34:48] ℹ️    - Diagnosis 5: 'I48.0'
[20:34:48] ℹ️    - Diagnosis 6: 'E11.22'
[20:34:48] ℹ️  Final extracted MRN: 'MA220722094502'
[20:34:48] ℹ️  Final extracted Sex: 'MALE'
[20:34:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:34:48] ℹ️  Final extracted Payer Source: 'SWH'
[20:34:48] ✅ Patient data extraction completed successfully
[20:34:48] ✅    ✅ Patient data extracted successfully
[20:34:48] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: WILL, CHRISTINE MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 293 S 2nd St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 717-7943
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '07/27/2022', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'G20.A1', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'E11.22'}]
[20:34:48] ✅    ✅ Patient identified: Robert McHale
[20:34:48] ✅    ✅ Patient name validation passed
[20:34:48] 🔄 
🔄 Step 3: Processing patient dates...
[20:34:48] [DOC: 9208950] ℹ️  DOB normalized: 09/12/1945
[20:34:48] [DOC: 9208950] ℹ️  Episode startOfCare normalized: 07/27/2022
[20:34:48] [DOC: 9208950] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[20:34:48] [DOC: 9208950] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[20:34:48] [DOC: 9208950] ✅ Patient date processing completed successfully
[20:34:48] ✅    ✅ Date processing completed
[20:34:48] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: WILL, CHRISTINE MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 293 S 2nd St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 717-7943
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '07/27/2022', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'G20.A1', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'E11.22'}]
[20:34:48] 🔄 
🔄 Step 4: Extracting order data...
[20:34:50] ℹ️  Order extraction - MRN: 'MA220722094502'
[20:34:50] ℹ️  Order extraction - Sex: 'MALE'
[20:34:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:34:50] ℹ️  Order extraction - Payer Source: 'SWH'
[20:34:50] ✅ Order data extraction completed successfully
[20:34:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:34:50] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[20:34:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:34:50] ℹ️  Payer source consistent in both sources: 'SWH'
[20:34:50] ✅ Patient name cross-validation successful
[20:34:50] ✅    ✅ Data merged successfully
[20:34:52] ✅    ✅ Order data extracted and validated
[20:34:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:35:09] [DOC: 9208950] ℹ️  Patient not found in cache or API: Robert McHale
[20:35:09] [DOC: 9208950] ℹ️  Patient not found, creating new patient via API...
[20:35:09] [DOC: 9208950] ℹ️  Creating patient via API: Robert McHale
[20:35:10] [DOC: 9208950] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:35:10] ❌    ❌ Failed to create patient
[20:35:10] [DOC: 9208950] ℹ️  API push details saved for document 9208950
================================================================================
║                        Processing Document ID: 9208947                         ║
================================================================================
[20:35:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[20:35:10] ℹ️  Date: 03/28/2025
[20:35:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:35:15] [DOC: 9208947] ✅ Text extracted using pdfplumber (19911 chars)
[20:35:15] ✅    ✅ Text extracted using pdfplumber (19911 chars)
[20:35:15] 🔄 
🔄 Step 2: Extracting patient data...
[20:35:18] ℹ️  AI extracted raw sex value: 'M'
[20:35:18] ℹ️  AI extracted service line: 'PT'
[20:35:18] ℹ️  AI extracted payer source: ''
[20:35:18] ℹ️  AI extracted diagnoses:
[20:35:18] ℹ️    - Diagnosis 1: 'Atrial flutter with RVR'
[20:35:18] ℹ️    - Diagnosis 2: 'BLE weakness'
[20:35:18] ℹ️    - Diagnosis 3: 'Parkinsons disease'
[20:35:18] ℹ️    - Diagnosis 4: 'obesity'
[20:35:18] ℹ️    - Diagnosis 5: 'OSA'
[20:35:18] ℹ️    - Diagnosis 6: 'DOE'
[20:35:18] ℹ️  Final extracted MRN: 'MA220722094502'
[20:35:18] ℹ️  Final extracted Sex: 'MALE'
[20:35:18] ℹ️  Final extracted Service Line: 'PT'
[20:35:18] ℹ️  Final extracted Payer Source: ''
[20:35:18] ✅ Patient data extraction completed successfully
[20:35:18] ✅    ✅ Patient data extracted successfully
[20:35:18] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Atrial flutter with RVR', 'secondDiagnosis': 'BLE weakness', 'thirdDiagnosis': 'Parkinsons disease', 'fourthDiagnosis': 'obesity', 'fifthDiagnosis': 'OSA', 'sixthDiagnosis': 'DOE'}]
[20:35:18] ✅    ✅ Patient identified: Robert McHale
[20:35:18] ✅    ✅ Patient name validation passed
[20:35:18] 🔄 
🔄 Step 3: Processing patient dates...
[20:35:18] [DOC: 9208947] ℹ️  DOB normalized: 09/12/1945
[20:35:18] [DOC: 9208947] ℹ️  Episode startOfEpisode normalized: 01/03/2025
[20:35:18] [DOC: 9208947] ✅ Patient date processing completed successfully
[20:35:18] ✅    ✅ Date processing completed
[20:35:18] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Atrial flutter with RVR', 'secondDiagnosis': 'BLE weakness', 'thirdDiagnosis': 'Parkinsons disease', 'fourthDiagnosis': 'obesity', 'fifthDiagnosis': 'OSA', 'sixthDiagnosis': 'DOE'}]
[20:35:18] 🔄 
🔄 Step 4: Extracting order data...
[20:35:22] ℹ️  Order extraction - MRN: 'MA220722094502'
[20:35:22] ℹ️  Order extraction - Sex: 'MALE'
[20:35:22] ℹ️  Order extraction - Service Line: 'PT'
[20:35:22] ℹ️  Order extraction - Payer Source: ''
[20:35:22] ✅ Order data extraction completed successfully
[20:35:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:35:22] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[20:35:22] ℹ️  Service line consistent in both sources: 'PT'
[20:35:22] ✅ Patient name cross-validation successful
[20:35:22] ✅    ✅ Data merged successfully
[20:35:23] ✅    ✅ Order data extracted and validated
[20:35:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:35:40] [DOC: 9208947] ℹ️  Patient not found in cache or API: Robert McHale
[20:35:40] [DOC: 9208947] ℹ️  Patient not found, creating new patient via API...
[20:35:40] [DOC: 9208947] ℹ️  Creating patient via API: Robert McHale
[20:35:42] [DOC: 9208947] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:35:42] ❌    ❌ Failed to create patient
[20:35:42] [DOC: 9208947] ℹ️  API push details saved for document 9208947
================================================================================
║                        Processing Document ID: 9208563                         ║
================================================================================
[20:35:42] ℹ️  Agency: Dartmouth HH
[20:35:42] ℹ️  Date: 03/28/2025
[20:35:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:35:44] [DOC: 9208563] ✅ Text extracted using pdfplumber (1321 chars)
[20:35:44] ✅    ✅ Text extracted using pdfplumber (1321 chars)
[20:35:44] 🔄 
🔄 Step 2: Extracting patient data...
[20:35:46] ℹ️  AI extracted raw sex value: 'F'
[20:35:46] ℹ️  AI extracted service line: 'RN, LPN'
[20:35:46] ℹ️  AI extracted payer source: 'Fallon Health'
[20:35:46] ℹ️  AI extracted diagnoses:
[20:35:46] ℹ️    - Diagnosis 1: ''
[20:35:46] ℹ️    - Diagnosis 2: ''
[20:35:46] ℹ️    - Diagnosis 3: ''
[20:35:46] ℹ️    - Diagnosis 4: ''
[20:35:46] ℹ️    - Diagnosis 5: ''
[20:35:46] ℹ️    - Diagnosis 6: ''
[20:35:46] ℹ️  Final extracted MRN: '4034011'
[20:35:46] ℹ️  Final extracted Sex: 'FEMALE'
[20:35:46] ℹ️  Final extracted Service Line: 'RN, LPN'
[20:35:46] ℹ️  Final extracted Payer Source: 'Fallon Health'
[20:35:46] ✅ Patient data extraction completed successfully
[20:35:46] ✅    ✅ Patient data extracted successfully
[20:35:46] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:35:46] ✅    ✅ Patient identified: Joan Swift
[20:35:46] ✅    ✅ Patient name validation passed
[20:35:46] 🔄 
🔄 Step 3: Processing patient dates...
[20:35:46] [DOC: 9208563] ℹ️  DOB normalized: 05/05/1943
[20:35:46] [DOC: 9208563] ℹ️  Episode startOfCare normalized: 01/08/2025
[20:35:46] [DOC: 9208563] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[20:35:46] [DOC: 9208563] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[20:35:46] [DOC: 9208563] ✅ Patient date processing completed successfully
[20:35:46] ✅    ✅ Date processing completed
[20:35:46] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:35:46] 🔄 
🔄 Step 4: Extracting order data...
[20:35:49] ℹ️  Order extraction - MRN: ''
[20:35:49] ℹ️  Order extraction - Sex: 'FEMALE'
[20:35:49] ℹ️  Order extraction - Service Line: 'RN, LPN'
[20:35:49] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[20:35:49] ✅ Order data extraction completed successfully
[20:35:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:35:49] ℹ️  Using MRN from patient data: '4034011'
[20:35:49] ℹ️  Service line consistent in both sources: 'RN, LPN'
[20:35:49] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[20:35:49] ✅ Patient name cross-validation successful
[20:35:49] ✅    ✅ Data merged successfully
[20:35:51] ✅    ✅ Order data extracted and validated
[20:35:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:35:51] [DOC: 9208563] ✅ Patient found in local cache: Joan Swift, ID: e83d8c65-60ef-4130-a086-35a05793cc68
[20:35:51] ✅    ✅ Existing patient found with ID: e83d8c65-60ef-4130-a086-35a05793cc68
[20:35:51] 🔄 
🔄 Step 6: Pushing order to API...
[20:35:51] [DOC: 9208563] ℹ️  Pushing order via API for patient ID: e83d8c65-60ef-4130-a086-35a05793cc68
[20:35:52] [DOC: 9208563] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14468"}
[20:35:52] ❌    ❌ Failed to push order
[20:35:52] 🔄 
🔄 Step 7: Writing to CSV...
[20:35:52] [DOC: 9208563] ℹ️  Calculated age: 82 from DOB: 05/05/1943
[20:35:52] [DOC: 9208563] ℹ️  Service Line extracted: 'RN, LPN'
[20:35:52] [DOC: 9208563] ℹ️  Payer Source extracted: 'Fallon Health'
[20:35:52] [DOC: 9208563] ℹ️  Diagnosis codes being written:
[20:35:52] [DOC: 9208563] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:35:52] [DOC: 9208563] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:35:52] [DOC: 9208563] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:35:52] [DOC: 9208563] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:35:52] [DOC: 9208563] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:35:52] [DOC: 9208563] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:35:52] [DOC: 9208563] ✅ Patient data written to CSV: Joan Swift | Sex: FEMALE | Age: 82 | Service: RN, LPN | Payer: Fallon Health | MRN: 4034011
[20:35:52] ✅    ✅ Document 9208563 processed and saved successfully
[20:35:52] 🔄 
🔄 Step 8: Saving API details...
[20:35:52] [DOC: 9208563] ℹ️  API push details saved for document 9208563
[20:35:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208415                         ║
================================================================================
[20:35:52] ℹ️  Agency: Dartmouth HH
[20:35:52] ℹ️  Date: 03/28/2025
[20:35:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:35:54] [DOC: 9208415] ✅ Text extracted using pdfplumber (1060 chars)
[20:35:54] ✅    ✅ Text extracted using pdfplumber (1060 chars)
[20:35:54] 🔄 
🔄 Step 2: Extracting patient data...
[20:35:57] ℹ️  AI extracted raw sex value: 'M'
[20:35:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:35:57] ℹ️  AI extracted payer source: 'Medicare'
[20:35:57] ℹ️  AI extracted diagnoses:
[20:35:57] ℹ️    - Diagnosis 1: ''
[20:35:57] ℹ️    - Diagnosis 2: ''
[20:35:57] ℹ️    - Diagnosis 3: ''
[20:35:57] ℹ️    - Diagnosis 4: ''
[20:35:57] ℹ️    - Diagnosis 5: ''
[20:35:57] ℹ️    - Diagnosis 6: ''
[20:35:57] ℹ️  Final extracted MRN: '2731011'
[20:35:57] ℹ️  Final extracted Sex: 'MALE'
[20:35:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:35:57] ℹ️  Final extracted Payer Source: 'Medicare'
[20:35:57] ✅ Patient data extraction completed successfully
[20:35:57] ✅    ✅ Patient data extracted successfully
[20:35:57] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 3266 Acushnet Ave Apt 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:35:57] ✅    ✅ Patient identified: Paul Penha
[20:35:57] ✅    ✅ Patient name validation passed
[20:35:57] 🔄 
🔄 Step 3: Processing patient dates...
[20:35:57] [DOC: 9208415] ℹ️  DOB normalized: 07/08/1934
[20:35:57] [DOC: 9208415] ℹ️  Episode startOfCare normalized: 02/02/2025
[20:35:57] [DOC: 9208415] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[20:35:57] [DOC: 9208415] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[20:35:57] [DOC: 9208415] ✅ Patient date processing completed successfully
[20:35:57] ✅    ✅ Date processing completed
[20:35:57] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 3266 Acushnet Ave Apt 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:35:57] 🔄 
🔄 Step 4: Extracting order data...
[20:35:59] ℹ️  Order extraction - MRN: ''
[20:35:59] ℹ️  Order extraction - Sex: 'MALE'
[20:35:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:35:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:35:59] ✅ Order data extraction completed successfully
[20:35:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:35:59] ℹ️  Using MRN from patient data: '2731011'
[20:35:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:35:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:35:59] ✅ Patient name cross-validation successful
[20:35:59] ✅    ✅ Data merged successfully
[20:36:04] ✅    ✅ Order data extracted and validated
[20:36:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:36:04] [DOC: 9208415] ✅ Patient found in local cache: Paul Penha, ID: acd1fced-75ff-43a8-8304-4681296c9d26
[20:36:04] ✅    ✅ Existing patient found with ID: acd1fced-75ff-43a8-8304-4681296c9d26
[20:36:04] 🔄 
🔄 Step 6: Pushing order to API...
[20:36:04] [DOC: 9208415] ℹ️  Pushing order via API for patient ID: acd1fced-75ff-43a8-8304-4681296c9d26
[20:36:05] [DOC: 9208415] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:36:05] ❌    ❌ Failed to push order
[20:36:05] 🔄 
🔄 Step 7: Writing to CSV...
[20:36:05] [DOC: 9208415] ℹ️  Calculated age: 90 from DOB: 07/08/1934
[20:36:05] [DOC: 9208415] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:36:05] [DOC: 9208415] ℹ️  Payer Source extracted: 'Medicare'
[20:36:05] [DOC: 9208415] ℹ️  Diagnosis codes being written:
[20:36:05] [DOC: 9208415] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:36:05] [DOC: 9208415] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:36:05] [DOC: 9208415] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:36:05] [DOC: 9208415] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:36:05] [DOC: 9208415] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:36:05] [DOC: 9208415] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:36:05] [DOC: 9208415] ✅ Patient data written to CSV: Paul Penha | Sex: MALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: 2731011
[20:36:05] ✅    ✅ Document 9208415 processed and saved successfully
[20:36:05] 🔄 
🔄 Step 8: Saving API details...
[20:36:05] [DOC: 9208415] ℹ️  API push details saved for document 9208415
[20:36:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208412                         ║
================================================================================
[20:36:05] ℹ️  Agency: Dartmouth HH
[20:36:05] ℹ️  Date: 03/28/2025
[20:36:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:36:07] [DOC: 9208412] ✅ Text extracted using pdfplumber (3592 chars)
[20:36:07] ✅    ✅ Text extracted using pdfplumber (3592 chars)
[20:36:07] 🔄 
🔄 Step 2: Extracting patient data...
[20:36:10] ℹ️  AI extracted raw sex value: 'F'
[20:36:10] ℹ️  AI extracted service line: 'Physical Therapy'
[20:36:10] ℹ️  AI extracted payer source: 'Medicare'
[20:36:10] ℹ️  AI extracted diagnoses:
[20:36:10] ℹ️    - Diagnosis 1: 'None'
[20:36:10] ℹ️    - Diagnosis 2: 'None'
[20:36:10] ℹ️    - Diagnosis 3: 'None'
[20:36:10] ℹ️    - Diagnosis 4: 'None'
[20:36:10] ℹ️    - Diagnosis 5: 'None'
[20:36:10] ℹ️    - Diagnosis 6: 'None'
[20:36:10] ℹ️  Final extracted MRN: '4651015'
[20:36:10] ℹ️  Final extracted Sex: 'FEMALE'
[20:36:10] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:36:10] ℹ️  Final extracted Payer Source: 'Medicare'
[20:36:10] ✅ Patient data extraction completed successfully
[20:36:10] ✅    ✅ Patient data extracted successfully
[20:36:10] 📊 Patient Response
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:36:10] ✅    ✅ Patient identified: Lisa Pavao
[20:36:10] ✅    ✅ Patient name validation passed
[20:36:10] 🔄 
🔄 Step 3: Processing patient dates...
[20:36:10] [DOC: 9208412] ℹ️  DOB normalized: 06/09/1966
[20:36:10] [DOC: 9208412] ℹ️  Episode startOfCare normalized: 01/06/2025
[20:36:10] [DOC: 9208412] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[20:36:10] [DOC: 9208412] ℹ️  Episode endOfEpisode normalized: 03/06/2025
[20:36:10] [DOC: 9208412] ✅ Patient date processing completed successfully
[20:36:10] ✅    ✅ Date processing completed
[20:36:10] 📊 Processed Patient Data
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025'}]
[20:36:10] 🔄 
🔄 Step 4: Extracting order data...
[20:36:12] ℹ️  Order extraction - MRN: ''
[20:36:12] ℹ️  Order extraction - Sex: 'FEMALE'
[20:36:12] ℹ️  Order extraction - Service Line: 'PT, HHA'
[20:36:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:36:12] ✅ Order data extraction completed successfully
[20:36:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:36:12] ℹ️  Using MRN from patient data: '4651015'
[20:36:12] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT, HHA' = 'HHA, PT, Physical Therapy'
[20:36:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:36:12] ✅ Patient name cross-validation successful
[20:36:12] ✅    ✅ Data merged successfully
[20:36:14] ✅    ✅ Order data extracted and validated
[20:36:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:36:14] [DOC: 9208412] ✅ Patient found in local cache: Lisa Pavao, ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[20:36:14] ✅    ✅ Existing patient found with ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[20:36:14] 🔄 
🔄 Step 6: Pushing order to API...
[20:36:14] [DOC: 9208412] ℹ️  Pushing order via API for patient ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[20:36:15] [DOC: 9208412] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:36:15] ❌    ❌ Failed to push order
[20:36:15] 🔄 
🔄 Step 7: Writing to CSV...
[20:36:15] [DOC: 9208412] ℹ️  Calculated age: 58 from DOB: 06/09/1966
[20:36:15] [DOC: 9208412] ℹ️  Service Line extracted: 'HHA, PT, Physical Therapy'
[20:36:15] [DOC: 9208412] ℹ️  Payer Source extracted: 'Medicare'
[20:36:15] [DOC: 9208412] ℹ️  Diagnosis codes being written:
[20:36:15] [DOC: 9208412] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:36:15] [DOC: 9208412] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:36:15] [DOC: 9208412] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:36:15] [DOC: 9208412] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:36:15] [DOC: 9208412] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:36:15] [DOC: 9208412] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:36:15] [DOC: 9208412] ✅ Patient data written to CSV: Lisa Pavao | Sex: FEMALE | Age: 58 | Service: HHA, PT, Physical Therapy | Payer: Medicare | MRN: 4651015
[20:36:15] ✅    ✅ Document 9208412 processed and saved successfully
[20:36:15] 🔄 
🔄 Step 8: Saving API details...
[20:36:15] [DOC: 9208412] ℹ️  API push details saved for document 9208412
[20:36:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208396                         ║
================================================================================
[20:36:15] ℹ️  Agency: Dartmouth HH
[20:36:15] ℹ️  Date: 03/28/2025
[20:36:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:36:18] [DOC: 9208396] ✅ Text extracted using pdfplumber (6298 chars)
[20:36:18] ✅    ✅ Text extracted using pdfplumber (6298 chars)
[20:36:18] 🔄 
🔄 Step 2: Extracting patient data...
[20:36:21] ℹ️  AI extracted raw sex value: 'F'
[20:36:21] ℹ️  AI extracted service line: 'PT, OT'
[20:36:21] ℹ️  AI extracted payer source: 'Medicare'
[20:36:21] ℹ️  AI extracted diagnoses:
[20:36:21] ℹ️    - Diagnosis 1: 'COPD'
[20:36:21] ℹ️    - Diagnosis 2: 'hypertension'
[20:36:21] ℹ️    - Diagnosis 3: ''
[20:36:21] ℹ️    - Diagnosis 4: ''
[20:36:21] ℹ️    - Diagnosis 5: ''
[20:36:21] ℹ️    - Diagnosis 6: ''
[20:36:21] ℹ️  Final extracted MRN: '5240015'
[20:36:21] ℹ️  Final extracted Sex: 'FEMALE'
[20:36:21] ℹ️  Final extracted Service Line: 'PT, OT'
[20:36:21] ℹ️  Final extracted Payer Source: 'Medicare'
[20:36:21] ✅ Patient data extraction completed successfully
[20:36:21] ✅    ✅ Patient data extracted successfully
[20:36:21] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'hypertension', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:36:21] ✅    ✅ Patient identified: Donna Cabral
[20:36:21] ✅    ✅ Patient name validation passed
[20:36:21] 🔄 
🔄 Step 3: Processing patient dates...
[20:36:21] [DOC: 9208396] ℹ️  DOB normalized: 10/03/1947
[20:36:21] [DOC: 9208396] ℹ️  Episode startOfCare normalized: 09/18/2024
[20:36:21] [DOC: 9208396] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[20:36:21] [DOC: 9208396] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[20:36:21] [DOC: 9208396] ✅ Patient date processing completed successfully
[20:36:21] ✅    ✅ Date processing completed
[20:36:21] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'hypertension', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:36:21] 🔄 
🔄 Step 4: Extracting order data...
[20:36:24] ℹ️  Order extraction - MRN: '5240015'
[20:36:24] ℹ️  Order extraction - Sex: 'FEMALE'
[20:36:24] ℹ️  Order extraction - Service Line: 'PT, OT'
[20:36:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:36:24] ✅ Order data extraction completed successfully
[20:36:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:36:24] ℹ️  Using MRN from patient data: '5240015' over '5240015'
[20:36:24] ℹ️  Service line consistent in both sources: 'PT, OT'
[20:36:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:36:24] ✅ Patient name cross-validation successful
[20:36:24] ✅    ✅ Data merged successfully
[20:36:25] ✅    ✅ Order data extracted and validated
[20:36:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:36:25] [DOC: 9208396] ✅ Patient found in local cache: Donna Cabral, ID: 79190189-814f-4114-a438-904080ae2281
[20:36:25] ✅    ✅ Existing patient found with ID: 79190189-814f-4114-a438-904080ae2281
[20:36:25] 🔄 
🔄 Step 6: Pushing order to API...
[20:36:25] [DOC: 9208396] ℹ️  Pushing order via API for patient ID: 79190189-814f-4114-a438-904080ae2281
[20:36:26] [DOC: 9208396] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:36:26] ❌    ❌ Failed to push order
[20:36:26] 🔄 
🔄 Step 7: Writing to CSV...
[20:36:26] [DOC: 9208396] ℹ️  Calculated age: 77 from DOB: 10/03/1947
[20:36:26] [DOC: 9208396] ℹ️  Service Line extracted: 'PT, OT'
[20:36:26] [DOC: 9208396] ℹ️  Payer Source extracted: 'Medicare'
[20:36:26] [DOC: 9208396] ℹ️  Diagnosis codes being written:
[20:36:26] [DOC: 9208396] ℹ️    - Latest_Episode_Firstdiagnosis: 'COPD'
[20:36:26] [DOC: 9208396] ℹ️    - Latest_Episode_Seconddiagnosis: 'hypertension'
[20:36:26] [DOC: 9208396] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:36:26] [DOC: 9208396] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:36:26] [DOC: 9208396] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:36:26] [DOC: 9208396] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:36:26] [DOC: 9208396] ✅ Patient data written to CSV: Donna Cabral | Sex: FEMALE | Age: 77 | Service: PT, OT | Payer: Medicare | MRN: 5240015
[20:36:26] ✅    ✅ Document 9208396 processed and saved successfully
[20:36:26] 🔄 
🔄 Step 8: Saving API details...
[20:36:26] [DOC: 9208396] ℹ️  API push details saved for document 9208396
[20:36:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208392                         ║
================================================================================
[20:36:26] ℹ️  Agency: Dartmouth HH
[20:36:26] ℹ️  Date: 03/28/2025
[20:36:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:36:29] [DOC: 9208392] ✅ Text extracted using pdfplumber (1545 chars)
[20:36:29] ✅    ✅ Text extracted using pdfplumber (1545 chars)
[20:36:29] 🔄 
🔄 Step 2: Extracting patient data...
[20:36:32] ℹ️  AI extracted raw sex value: 'M'
[20:36:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:36:32] ℹ️  AI extracted payer source: 'Medicare'
[20:36:32] ℹ️  AI extracted diagnoses:
[20:36:32] ℹ️    - Diagnosis 1: ''
[20:36:32] ℹ️    - Diagnosis 2: ''
[20:36:32] ℹ️    - Diagnosis 3: ''
[20:36:32] ℹ️    - Diagnosis 4: ''
[20:36:32] ℹ️    - Diagnosis 5: ''
[20:36:32] ℹ️    - Diagnosis 6: ''
[20:36:32] ℹ️  Final extracted MRN: '842002'
[20:36:32] ℹ️  Final extracted Sex: 'MALE'
[20:36:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:36:32] ℹ️  Final extracted Payer Source: 'Medicare'
[20:36:32] ✅ Patient data extraction completed successfully
[20:36:32] ✅    ✅ Patient data extracted successfully
[20:36:32] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:36:32] ✅    ✅ Patient identified: Johannes Bjornson
[20:36:32] ✅    ✅ Patient name validation passed
[20:36:32] 🔄 
🔄 Step 3: Processing patient dates...
[20:36:32] [DOC: 9208392] ℹ️  DOB normalized: 02/09/1942
[20:36:32] [DOC: 9208392] ℹ️  Episode startOfCare normalized: 10/10/2024
[20:36:32] [DOC: 9208392] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[20:36:32] [DOC: 9208392] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[20:36:32] [DOC: 9208392] ✅ Patient date processing completed successfully
[20:36:32] ✅    ✅ Date processing completed
[20:36:32] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:36:32] 🔄 
🔄 Step 4: Extracting order data...
[20:36:34] ℹ️  Order extraction - MRN: ''
[20:36:34] ℹ️  Order extraction - Sex: 'MALE'
[20:36:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:36:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:36:34] ✅ Order data extraction completed successfully
[20:36:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:36:34] ℹ️  Using MRN from patient data: '842002'
[20:36:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:36:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:36:34] ✅ Patient name cross-validation successful
[20:36:34] ✅    ✅ Data merged successfully
[20:36:35] ✅    ✅ Order data extracted and validated
[20:36:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:36:35] [DOC: 9208392] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[20:36:35] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[20:36:35] 🔄 
🔄 Step 6: Pushing order to API...
[20:36:35] [DOC: 9208392] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[20:36:37] [DOC: 9208392] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[20:36:37] ❌    ❌ Failed to push order
[20:36:37] 🔄 
🔄 Step 7: Writing to CSV...
[20:36:37] [DOC: 9208392] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[20:36:37] [DOC: 9208392] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:36:37] [DOC: 9208392] ℹ️  Payer Source extracted: 'Medicare'
[20:36:37] [DOC: 9208392] ℹ️  Diagnosis codes being written:
[20:36:37] [DOC: 9208392] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:36:37] [DOC: 9208392] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:36:37] [DOC: 9208392] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:36:37] [DOC: 9208392] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:36:37] [DOC: 9208392] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:36:37] [DOC: 9208392] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:36:37] [DOC: 9208392] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 842002
[20:36:37] ✅    ✅ Document 9208392 processed and saved successfully
[20:36:37] 🔄 
🔄 Step 8: Saving API details...
[20:36:37] [DOC: 9208392] ℹ️  API push details saved for document 9208392
[20:36:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208364                         ║
================================================================================
[20:36:37] ℹ️  Agency: Dartmouth HH
[20:36:37] ℹ️  Date: 03/28/2025
[20:36:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:36:39] [DOC: 9208364] ✅ Text extracted using pdfplumber (1467 chars)
[20:36:39] ✅    ✅ Text extracted using pdfplumber (1467 chars)
[20:36:39] 🔄 
🔄 Step 2: Extracting patient data...
[20:36:42] ℹ️  AI extracted raw sex value: 'F'
[20:36:42] ℹ️  AI extracted service line: 'Home Health'
[20:36:42] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[20:36:42] ℹ️  AI extracted diagnoses:
[20:36:42] ℹ️    - Diagnosis 1: ''
[20:36:42] ℹ️    - Diagnosis 2: ''
[20:36:42] ℹ️    - Diagnosis 3: ''
[20:36:42] ℹ️    - Diagnosis 4: ''
[20:36:42] ℹ️    - Diagnosis 5: ''
[20:36:42] ℹ️    - Diagnosis 6: ''
[20:36:42] ℹ️  Final extracted MRN: '6066015'
[20:36:42] ℹ️  Final extracted Sex: 'FEMALE'
[20:36:42] ℹ️  Final extracted Service Line: 'Home Health'
[20:36:42] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[20:36:42] ✅ Patient data extraction completed successfully
[20:36:42] ✅    ✅ Patient data extracted successfully
[20:36:42] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Home Health
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:36:42] ✅    ✅ Patient identified: Lois Fernandes
[20:36:42] ✅    ✅ Patient name validation passed
[20:36:42] 🔄 
🔄 Step 3: Processing patient dates...
[20:36:42] [DOC: 9208364] ℹ️  DOB normalized: 05/15/1941
[20:36:42] [DOC: 9208364] ℹ️  Episode startOfCare normalized: 02/22/2025
[20:36:42] [DOC: 9208364] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[20:36:42] [DOC: 9208364] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[20:36:42] [DOC: 9208364] ✅ Patient date processing completed successfully
[20:36:42] ✅    ✅ Date processing completed
[20:36:42] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Home Health
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:36:42] 🔄 
🔄 Step 4: Extracting order data...
[20:36:44] ℹ️  Order extraction - MRN: ''
[20:36:44] ℹ️  Order extraction - Sex: 'FEMALE'
[20:36:44] ℹ️  Order extraction - Service Line: 'RN'
[20:36:44] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[20:36:44] ✅ Order data extraction completed successfully
[20:36:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:36:44] ℹ️  Using MRN from patient data: '6066015'
[20:36:44] ℹ️  Combined service lines: Patient='Home Health' + Order='RN' = 'Home Health, RN'
[20:36:44] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[20:36:44] ✅ Patient name cross-validation successful
[20:36:44] ✅    ✅ Data merged successfully
[20:36:46] ✅    ✅ Order data extracted and validated
[20:36:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:36:46] [DOC: 9208364] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[20:36:46] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[20:36:46] 🔄 
🔄 Step 6: Pushing order to API...
[20:36:46] [DOC: 9208364] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[20:36:47] [DOC: 9208364] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13961"}
[20:36:47] ❌    ❌ Failed to push order
[20:36:47] 🔄 
🔄 Step 7: Writing to CSV...
[20:36:47] [DOC: 9208364] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[20:36:47] [DOC: 9208364] ℹ️  Service Line extracted: 'Home Health, RN'
[20:36:47] [DOC: 9208364] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[20:36:47] [DOC: 9208364] ℹ️  Diagnosis codes being written:
[20:36:47] [DOC: 9208364] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:36:47] [DOC: 9208364] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:36:47] [DOC: 9208364] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:36:47] [DOC: 9208364] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:36:47] [DOC: 9208364] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:36:47] [DOC: 9208364] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:36:47] [DOC: 9208364] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: Home Health, RN | Payer: Blue Cross Medicare Adv | MRN: 6066015
[20:36:47] ✅    ✅ Document 9208364 processed and saved successfully
[20:36:47] 🔄 
🔄 Step 8: Saving API details...
[20:36:47] [DOC: 9208364] ℹ️  API push details saved for document 9208364
[20:36:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208363                         ║
================================================================================
[20:36:47] ℹ️  Agency: Dartmouth HH
[20:36:47] ℹ️  Date: 03/28/2025
[20:36:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:36:56] [DOC: 9208363] ✅ Text extracted using pdfplumber (17459 chars)
[20:36:56] ✅    ✅ Text extracted using pdfplumber (17447 chars)
[20:36:56] 🔄 
🔄 Step 2: Extracting patient data...
[20:36:59] ℹ️  AI extracted raw sex value: 'F'
[20:36:59] ℹ️  AI extracted service line: 'PT'
[20:36:59] ℹ️  AI extracted payer source: ''
[20:36:59] ℹ️  AI extracted diagnoses:
[20:36:59] ℹ️    - Diagnosis 1: 'N39.0'
[20:36:59] ℹ️    - Diagnosis 2: 'B96.20'
[20:36:59] ℹ️    - Diagnosis 3: 'R29.6'
[20:36:59] ℹ️    - Diagnosis 4: 'M17.12'
[20:36:59] ℹ️    - Diagnosis 5: 'E11.43'
[20:36:59] ℹ️    - Diagnosis 6: 'K31.84'
[20:36:59] ℹ️  Final extracted MRN: '3649009'
[20:36:59] ℹ️  Final extracted Sex: 'FEMALE'
[20:36:59] ℹ️  Final extracted Service Line: 'PT'
[20:36:59] ℹ️  Final extracted Payer Source: ''
[20:36:59] ✅ Patient data extraction completed successfully
[20:36:59] ✅    ✅ Patient data extracted successfully
[20:36:59] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'M17.12', 'fifthDiagnosis': 'E11.43', 'sixthDiagnosis': 'K31.84'}]
[20:36:59] ✅    ✅ Patient identified: Dorothy Fernandes
[20:36:59] ✅    ✅ Patient name validation passed
[20:36:59] 🔄 
🔄 Step 3: Processing patient dates...
[20:36:59] [DOC: 9208363] ℹ️  DOB normalized: 10/01/1937
[20:36:59] [DOC: 9208363] ℹ️  Episode startOfCare normalized: 03/22/2025
[20:36:59] [DOC: 9208363] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[20:36:59] [DOC: 9208363] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[20:36:59] [DOC: 9208363] ✅ Patient date processing completed successfully
[20:36:59] ✅    ✅ Date processing completed
[20:36:59] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'M17.12', 'fifthDiagnosis': 'E11.43', 'sixthDiagnosis': 'K31.84'}]
[20:36:59] 🔄 
🔄 Step 4: Extracting order data...
[20:37:02] ℹ️  Order extraction - MRN: '3649009'
[20:37:02] ℹ️  Order extraction - Sex: 'FEMALE'
[20:37:02] ℹ️  Order extraction - Service Line: 'PT'
[20:37:02] ℹ️  Order extraction - Payer Source: ''
[20:37:02] ✅ Order data extraction completed successfully
[20:37:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:37:02] ℹ️  Using MRN from patient data: '3649009' over '3649009'
[20:37:02] ℹ️  Service line consistent in both sources: 'PT'
[20:37:02] ✅ Patient name cross-validation successful
[20:37:02] ✅    ✅ Data merged successfully
[20:37:03] ✅    ✅ Order data extracted and validated
[20:37:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:37:03] [DOC: 9208363] ✅ Patient found in local cache: Dorothy Fernandes, ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[20:37:03] ✅    ✅ Existing patient found with ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[20:37:03] 🔄 
🔄 Step 6: Pushing order to API...
[20:37:03] [DOC: 9208363] ℹ️  Pushing order via API for patient ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[20:37:04] [DOC: 9208363] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:37:04] ❌    ❌ Failed to push order
[20:37:04] 🔄 
🔄 Step 7: Writing to CSV...
[20:37:04] [DOC: 9208363] ℹ️  Calculated age: 87 from DOB: 10/01/1937
[20:37:04] [DOC: 9208363] ℹ️  Service Line extracted: 'PT'
[20:37:04] [DOC: 9208363] ℹ️  Payer Source extracted: ''
[20:37:04] [DOC: 9208363] ℹ️  Diagnosis codes being written:
[20:37:04] [DOC: 9208363] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[20:37:04] [DOC: 9208363] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.20'
[20:37:04] [DOC: 9208363] ℹ️    - Latest_Episode_Thirddiagnosis: 'R29.6'
[20:37:04] [DOC: 9208363] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M17.12'
[20:37:04] [DOC: 9208363] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.43'
[20:37:04] [DOC: 9208363] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K31.84'
[20:37:04] [DOC: 9208363] ✅ Patient data written to CSV: Dorothy Fernandes | Sex: FEMALE | Age: 87 | Service: PT | Payer:  | MRN: 3649009
[20:37:04] ✅    ✅ Document 9208363 processed and saved successfully
[20:37:04] 🔄 
🔄 Step 8: Saving API details...
[20:37:04] [DOC: 9208363] ℹ️  API push details saved for document 9208363
[20:37:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208358                         ║
================================================================================
[20:37:04] ℹ️  Agency: Dartmouth HH
[20:37:04] ℹ️  Date: 03/28/2025
[20:37:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:37:07] [DOC: 9208358] ✅ Text extracted using pdfplumber (1555 chars)
[20:37:07] ✅    ✅ Text extracted using pdfplumber (1555 chars)
[20:37:07] 🔄 
🔄 Step 2: Extracting patient data...
[20:37:12] ℹ️  AI extracted raw sex value: 'F'
[20:37:12] ℹ️  AI extracted service line: 'HHA'
[20:37:12] ℹ️  AI extracted payer source: 'Medicare'
[20:37:12] ℹ️  AI extracted diagnoses:
[20:37:12] ℹ️    - Diagnosis 1: 'None'
[20:37:12] ℹ️    - Diagnosis 2: 'None'
[20:37:12] ℹ️    - Diagnosis 3: 'None'
[20:37:12] ℹ️    - Diagnosis 4: 'None'
[20:37:12] ℹ️    - Diagnosis 5: 'None'
[20:37:12] ℹ️    - Diagnosis 6: 'None'
[20:37:12] ℹ️  Final extracted MRN: '4799015'
[20:37:12] ℹ️  Final extracted Sex: 'FEMALE'
[20:37:12] ℹ️  Final extracted Service Line: 'HHA'
[20:37:12] ℹ️  Final extracted Payer Source: 'Medicare'
[20:37:12] ✅ Patient data extraction completed successfully
[20:37:12] ✅    ✅ Patient data extracted successfully
[20:37:12] 📊 Patient Response
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:37:12] ✅    ✅ Patient identified: Agatina Manna
[20:37:12] ✅    ✅ Patient name validation passed
[20:37:12] 🔄 
🔄 Step 3: Processing patient dates...
[20:37:12] [DOC: 9208358] ℹ️  DOB normalized: 03/10/1937
[20:37:12] [DOC: 9208358] ℹ️  Episode startOfCare normalized: 11/17/2024
[20:37:12] [DOC: 9208358] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[20:37:12] [DOC: 9208358] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[20:37:12] [DOC: 9208358] ✅ Patient date processing completed successfully
[20:37:12] ✅    ✅ Date processing completed
[20:37:12] 📊 Processed Patient Data
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025'}]
[20:37:12] 🔄 
🔄 Step 4: Extracting order data...
[20:37:14] ℹ️  Order extraction - MRN: '4799015'
[20:37:14] ℹ️  Order extraction - Sex: 'FEMALE'
[20:37:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:37:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:37:14] ✅ Order data extraction completed successfully
[20:37:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:37:14] ℹ️  Using MRN from patient data: '4799015' over '4799015'
[20:37:14] ℹ️  Combined service lines: Patient='HHA' + Order='Skilled Nursing' = 'HHA, Skilled Nursing'
[20:37:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:37:14] ✅ Patient name cross-validation successful
[20:37:14] ✅    ✅ Data merged successfully
[20:37:15] ✅    ✅ Order data extracted and validated
[20:37:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:37:15] [DOC: 9208358] ✅ Patient found in local cache: Agatina Manna, ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[20:37:15] ✅    ✅ Existing patient found with ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[20:37:15] 🔄 
🔄 Step 6: Pushing order to API...
[20:37:15] [DOC: 9208358] ℹ️  Pushing order via API for patient ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[20:37:17] [DOC: 9208358] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:37:17] ❌    ❌ Failed to push order
[20:37:17] 🔄 
🔄 Step 7: Writing to CSV...
[20:37:17] [DOC: 9208358] ℹ️  Calculated age: 88 from DOB: 03/10/1937
[20:37:17] [DOC: 9208358] ℹ️  Service Line extracted: 'HHA, Skilled Nursing'
[20:37:17] [DOC: 9208358] ℹ️  Payer Source extracted: 'Medicare'
[20:37:17] [DOC: 9208358] ℹ️  Diagnosis codes being written:
[20:37:17] [DOC: 9208358] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:37:17] [DOC: 9208358] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:37:17] [DOC: 9208358] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:37:17] [DOC: 9208358] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:37:17] [DOC: 9208358] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:37:17] [DOC: 9208358] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:37:17] [DOC: 9208358] ✅ Patient data written to CSV: Agatina Manna | Sex: FEMALE | Age: 88 | Service: HHA, Skilled Nursing | Payer: Medicare | MRN: 4799015
[20:37:17] ✅    ✅ Document 9208358 processed and saved successfully
[20:37:17] 🔄 
🔄 Step 8: Saving API details...
[20:37:17] [DOC: 9208358] ℹ️  API push details saved for document 9208358
[20:37:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208357                         ║
================================================================================
[20:37:17] ℹ️  Agency: Dartmouth HH
[20:37:17] ℹ️  Date: 03/28/2025
[20:37:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:37:19] [DOC: 9208357] ✅ Text extracted using pdfplumber (2372 chars)
[20:37:19] ✅    ✅ Text extracted using pdfplumber (2372 chars)
[20:37:19] 🔄 
🔄 Step 2: Extracting patient data...
[20:37:22] ℹ️  AI extracted raw sex value: 'M'
[20:37:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:37:22] ℹ️  AI extracted payer source: 'Medicare'
[20:37:22] ℹ️  AI extracted diagnoses:
[20:37:22] ℹ️    - Diagnosis 1: ''
[20:37:22] ℹ️    - Diagnosis 2: ''
[20:37:22] ℹ️    - Diagnosis 3: ''
[20:37:22] ℹ️    - Diagnosis 4: ''
[20:37:22] ℹ️    - Diagnosis 5: ''
[20:37:22] ℹ️    - Diagnosis 6: ''
[20:37:22] ℹ️  Final extracted MRN: '1452015'
[20:37:22] ℹ️  Final extracted Sex: 'MALE'
[20:37:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:37:22] ℹ️  Final extracted Payer Source: 'Medicare'
[20:37:22] ✅ Patient data extraction completed successfully
[20:37:22] ✅    ✅ Patient data extracted successfully
[20:37:22] 📊 Patient Response
     └─ patientFName: Normand
     └─ patientLName: Paquette
     └─ dob: 08/20/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1452015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:37:22] ✅    ✅ Patient identified: Normand Paquette
[20:37:22] ✅    ✅ Patient name validation passed
[20:37:22] 🔄 
🔄 Step 3: Processing patient dates...
[20:37:22] [DOC: 9208357] ℹ️  DOB normalized: 08/20/1935
[20:37:22] [DOC: 9208357] ℹ️  Episode startOfCare normalized: 02/16/2025
[20:37:22] [DOC: 9208357] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[20:37:22] [DOC: 9208357] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[20:37:22] [DOC: 9208357] ✅ Patient date processing completed successfully
[20:37:22] ✅    ✅ Date processing completed
[20:37:22] 📊 Processed Patient Data
     └─ patientFName: Normand
     └─ patientLName: Paquette
     └─ dob: 08/20/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1452015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:37:22] 🔄 
🔄 Step 4: Extracting order data...
[20:37:24] ℹ️  Order extraction - MRN: '1452015'
[20:37:24] ℹ️  Order extraction - Sex: 'MALE'
[20:37:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[20:37:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:37:24] ✅ Order data extraction completed successfully
[20:37:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:37:24] ℹ️  Using MRN from patient data: '1452015' over '1452015'
[20:37:24] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT' = 'PT, Skilled Nursing'
[20:37:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:37:24] ✅ Patient name cross-validation successful
[20:37:24] ✅    ✅ Data merged successfully
[20:37:25] ✅    ✅ Order data extracted and validated
[20:37:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:37:25] [DOC: 9208357] ✅ Patient found in local cache: Normand Paquette, ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[20:37:25] ✅    ✅ Existing patient found with ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[20:37:25] 🔄 
🔄 Step 6: Pushing order to API...
[20:37:25] [DOC: 9208357] ℹ️  Pushing order via API for patient ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[20:37:26] [DOC: 9208357] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:37:26] ❌    ❌ Failed to push order
[20:37:26] 🔄 
🔄 Step 7: Writing to CSV...
[20:37:26] [DOC: 9208357] ℹ️  Calculated age: 89 from DOB: 08/20/1935
[20:37:26] [DOC: 9208357] ℹ️  Service Line extracted: 'PT, Skilled Nursing'
[20:37:26] [DOC: 9208357] ℹ️  Payer Source extracted: 'Medicare'
[20:37:26] [DOC: 9208357] ℹ️  Diagnosis codes being written:
[20:37:26] [DOC: 9208357] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:37:26] [DOC: 9208357] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:37:26] [DOC: 9208357] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:37:26] [DOC: 9208357] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:37:26] [DOC: 9208357] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:37:26] [DOC: 9208357] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:37:26] [DOC: 9208357] ✅ Patient data written to CSV: Normand Paquette | Sex: MALE | Age: 89 | Service: PT, Skilled Nursing | Payer: Medicare | MRN: 1452015
[20:37:26] ✅    ✅ Document 9208357 processed and saved successfully
[20:37:26] 🔄 
🔄 Step 8: Saving API details...
[20:37:26] [DOC: 9208357] ℹ️  API push details saved for document 9208357
[20:37:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208356                         ║
================================================================================
[20:37:26] ℹ️  Agency: Dartmouth HH
[20:37:26] ℹ️  Date: 03/28/2025
[20:37:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:37:29] [DOC: 9208356] ✅ Text extracted using pdfplumber (1419 chars)
[20:37:29] ✅    ✅ Text extracted using pdfplumber (1419 chars)
[20:37:29] 🔄 
🔄 Step 2: Extracting patient data...
[20:37:32] ℹ️  AI extracted raw sex value: 'F'
[20:37:32] ℹ️  AI extracted service line: 'PT'
[20:37:32] ℹ️  AI extracted payer source: 'Medicare'
[20:37:32] ℹ️  AI extracted diagnoses:
[20:37:32] ℹ️    - Diagnosis 1: 'None'
[20:37:32] ℹ️    - Diagnosis 2: 'None'
[20:37:32] ℹ️    - Diagnosis 3: 'None'
[20:37:32] ℹ️    - Diagnosis 4: 'None'
[20:37:32] ℹ️    - Diagnosis 5: 'None'
[20:37:32] ℹ️    - Diagnosis 6: 'None'
[20:37:32] ℹ️  Final extracted MRN: '6480009'
[20:37:32] ℹ️  Final extracted Sex: 'FEMALE'
[20:37:32] ℹ️  Final extracted Service Line: 'PT'
[20:37:32] ℹ️  Final extracted Payer Source: 'Medicare'
[20:37:32] ✅ Patient data extraction completed successfully
[20:37:32] ✅    ✅ Patient data extracted successfully
[20:37:32] 📊 Patient Response
     └─ patientFName: Maureen
     └─ patientLName: Glowacki
     └─ dob: 04/15/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6480009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:37:32] ✅    ✅ Patient identified: Maureen Glowacki
[20:37:32] ✅    ✅ Patient name validation passed
[20:37:32] 🔄 
🔄 Step 3: Processing patient dates...
[20:37:32] [DOC: 9208356] ℹ️  DOB normalized: 04/15/1932
[20:37:32] [DOC: 9208356] ℹ️  Episode startOfCare normalized: 02/28/2025
[20:37:32] [DOC: 9208356] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[20:37:32] [DOC: 9208356] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[20:37:32] [DOC: 9208356] ✅ Patient date processing completed successfully
[20:37:32] ✅    ✅ Date processing completed
[20:37:32] 📊 Processed Patient Data
     └─ patientFName: Maureen
     └─ patientLName: Glowacki
     └─ dob: 04/15/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6480009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025'}]
[20:37:32] 🔄 
🔄 Step 4: Extracting order data...
[20:37:34] ℹ️  Order extraction - MRN: ''
[20:37:34] ℹ️  Order extraction - Sex: 'FEMALE'
[20:37:34] ℹ️  Order extraction - Service Line: 'PT'
[20:37:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:37:34] ✅ Order data extraction completed successfully
[20:37:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:37:34] ℹ️  Using MRN from patient data: '6480009'
[20:37:34] ℹ️  Service line consistent in both sources: 'PT'
[20:37:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:37:34] ✅ Patient name cross-validation successful
[20:37:34] ✅    ✅ Data merged successfully
[20:37:35] ✅    ✅ Order data extracted and validated
[20:37:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:37:35] [DOC: 9208356] ✅ Patient found in local cache: Maureen Glowacki, ID: 6a3d5b05-0772-47d6-969c-fbe2ca57a98f
[20:37:35] ✅    ✅ Existing patient found with ID: 6a3d5b05-0772-47d6-969c-fbe2ca57a98f
[20:37:35] 🔄 
🔄 Step 6: Pushing order to API...
[20:37:35] [DOC: 9208356] ℹ️  Pushing order via API for patient ID: 6a3d5b05-0772-47d6-969c-fbe2ca57a98f
[20:37:37] [DOC: 9208356] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13785"}
[20:37:37] ❌    ❌ Failed to push order
[20:37:37] 🔄 
🔄 Step 7: Writing to CSV...
[20:37:37] [DOC: 9208356] ℹ️  Calculated age: 93 from DOB: 04/15/1932
[20:37:37] [DOC: 9208356] ℹ️  Service Line extracted: 'PT'
[20:37:37] [DOC: 9208356] ℹ️  Payer Source extracted: 'Medicare'
[20:37:37] [DOC: 9208356] ℹ️  Diagnosis codes being written:
[20:37:37] [DOC: 9208356] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:37:37] [DOC: 9208356] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:37:37] [DOC: 9208356] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:37:37] [DOC: 9208356] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:37:37] [DOC: 9208356] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:37:37] [DOC: 9208356] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:37:37] [DOC: 9208356] ✅ Patient data written to CSV: Maureen Glowacki | Sex: FEMALE | Age: 93 | Service: PT | Payer: Medicare | MRN: 6480009
[20:37:37] ✅    ✅ Document 9208356 processed and saved successfully
[20:37:37] 🔄 
🔄 Step 8: Saving API details...
[20:37:37] [DOC: 9208356] ℹ️  API push details saved for document 9208356
[20:37:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208352                         ║
================================================================================
[20:37:37] ℹ️  Agency: Dartmouth HH
[20:37:37] ℹ️  Date: 03/28/2025
[20:37:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:37:39] [DOC: 9208352] ✅ Text extracted using pdfplumber (1166 chars)
[20:37:39] ✅    ✅ Text extracted using pdfplumber (1166 chars)
[20:37:39] 🔄 
🔄 Step 2: Extracting patient data...
[20:37:41] ℹ️  AI extracted raw sex value: 'F'
[20:37:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:37:41] ℹ️  AI extracted payer source: 'Fallon Navicare'
[20:37:41] ℹ️  AI extracted diagnoses:
[20:37:41] ℹ️    - Diagnosis 1: ''
[20:37:41] ℹ️    - Diagnosis 2: ''
[20:37:41] ℹ️    - Diagnosis 3: ''
[20:37:41] ℹ️    - Diagnosis 4: ''
[20:37:41] ℹ️    - Diagnosis 5: ''
[20:37:41] ℹ️    - Diagnosis 6: ''
[20:37:41] ℹ️  Final extracted MRN: '6149015'
[20:37:41] ℹ️  Final extracted Sex: 'FEMALE'
[20:37:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:37:41] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[20:37:41] ✅ Patient data extraction completed successfully
[20:37:41] ✅    ✅ Patient data extracted successfully
[20:37:41] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 114 Riverside Ave Apt 160
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:37:41] ✅    ✅ Patient identified: Margaret Rapoza
[20:37:41] ✅    ✅ Patient name validation passed
[20:37:41] 🔄 
🔄 Step 3: Processing patient dates...
[20:37:41] [DOC: 9208352] ℹ️  DOB normalized: 05/05/1936
[20:37:41] [DOC: 9208352] ℹ️  Episode startOfCare normalized: 03/06/2025
[20:37:41] [DOC: 9208352] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[20:37:41] [DOC: 9208352] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[20:37:41] [DOC: 9208352] ✅ Patient date processing completed successfully
[20:37:41] ✅    ✅ Date processing completed
[20:37:41] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 114 Riverside Ave Apt 160
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:37:41] 🔄 
🔄 Step 4: Extracting order data...
[20:37:44] ℹ️  Order extraction - MRN: ''
[20:37:44] ℹ️  Order extraction - Sex: 'FEMALE'
[20:37:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:37:44] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[20:37:44] ✅ Order data extraction completed successfully
[20:37:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:37:44] ℹ️  Using MRN from patient data: '6149015'
[20:37:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:37:44] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[20:37:44] ✅ Patient name cross-validation successful
[20:37:44] ✅    ✅ Data merged successfully
[20:37:45] ✅    ✅ Order data extracted and validated
[20:37:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:37:45] [DOC: 9208352] ✅ Patient found in local cache: Margaret Rapoza, ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[20:37:45] ✅    ✅ Existing patient found with ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[20:37:45] 🔄 
🔄 Step 6: Pushing order to API...
[20:37:45] [DOC: 9208352] ℹ️  Pushing order via API for patient ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[20:37:47] [DOC: 9208352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:37:47] ❌    ❌ Failed to push order
[20:37:47] 🔄 
🔄 Step 7: Writing to CSV...
[20:37:47] [DOC: 9208352] ℹ️  Calculated age: 89 from DOB: 05/05/1936
[20:37:47] [DOC: 9208352] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:37:47] [DOC: 9208352] ℹ️  Payer Source extracted: 'Fallon Navicare'
[20:37:47] [DOC: 9208352] ℹ️  Diagnosis codes being written:
[20:37:47] [DOC: 9208352] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:37:47] [DOC: 9208352] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:37:47] [DOC: 9208352] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:37:47] [DOC: 9208352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:37:47] [DOC: 9208352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:37:47] [DOC: 9208352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:37:47] [DOC: 9208352] ✅ Patient data written to CSV: Margaret Rapoza | Sex: FEMALE | Age: 89 | Service: Skilled Nursing | Payer: Fallon Navicare | MRN: 6149015
[20:37:47] ✅    ✅ Document 9208352 processed and saved successfully
[20:37:47] 🔄 
🔄 Step 8: Saving API details...
[20:37:47] [DOC: 9208352] ℹ️  API push details saved for document 9208352
[20:37:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208351                         ║
================================================================================
[20:37:47] ℹ️  Agency: Dartmouth HH
[20:37:47] ℹ️  Date: 03/28/2025
[20:37:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:37:49] [DOC: 9208351] ✅ Text extracted using pdfplumber (1819 chars)
[20:37:49] ✅    ✅ Text extracted using pdfplumber (1819 chars)
[20:37:49] 🔄 
🔄 Step 2: Extracting patient data...
[20:37:52] ℹ️  AI extracted raw sex value: 'F'
[20:37:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:37:52] ℹ️  AI extracted payer source: 'Medicare'
[20:37:52] ℹ️  AI extracted diagnoses:
[20:37:52] ℹ️    - Diagnosis 1: ''
[20:37:52] ℹ️    - Diagnosis 2: ''
[20:37:52] ℹ️    - Diagnosis 3: ''
[20:37:52] ℹ️    - Diagnosis 4: ''
[20:37:52] ℹ️    - Diagnosis 5: ''
[20:37:52] ℹ️    - Diagnosis 6: ''
[20:37:52] ℹ️  Final extracted MRN: '6117015'
[20:37:52] ℹ️  Final extracted Sex: 'FEMALE'
[20:37:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:37:52] ℹ️  Final extracted Payer Source: 'Medicare'
[20:37:52] ✅ Patient data extraction completed successfully
[20:37:52] ✅    ✅ Patient data extracted successfully
[20:37:52] 📊 Patient Response
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:37:52] ✅    ✅ Patient identified: Janet Cabral
[20:37:52] ✅    ✅ Patient name validation passed
[20:37:52] 🔄 
🔄 Step 3: Processing patient dates...
[20:37:52] [DOC: 9208351] ℹ️  DOB normalized: 07/26/1952
[20:37:52] [DOC: 9208351] ℹ️  Episode startOfCare normalized: 02/28/2025
[20:37:52] [DOC: 9208351] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[20:37:52] [DOC: 9208351] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[20:37:52] [DOC: 9208351] ✅ Patient date processing completed successfully
[20:37:52] ✅    ✅ Date processing completed
[20:37:52] 📊 Processed Patient Data
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:37:52] 🔄 
🔄 Step 4: Extracting order data...
[20:37:54] ℹ️  Order extraction - MRN: ''
[20:37:54] ℹ️  Order extraction - Sex: 'FEMALE'
[20:37:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:37:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:37:54] ✅ Order data extraction completed successfully
[20:37:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:37:54] ℹ️  Using MRN from patient data: '6117015'
[20:37:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:37:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:37:54] ✅ Patient name cross-validation successful
[20:37:54] ✅    ✅ Data merged successfully
[20:37:55] ✅    ✅ Order data extracted and validated
[20:37:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:37:55] [DOC: 9208351] ✅ Patient found in local cache: Janet Cabral, ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[20:37:55] ✅    ✅ Existing patient found with ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[20:37:55] 🔄 
🔄 Step 6: Pushing order to API...
[20:37:55] [DOC: 9208351] ℹ️  Pushing order via API for patient ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[20:37:57] [DOC: 9208351] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13425"}
[20:37:57] ❌    ❌ Failed to push order
[20:37:57] 🔄 
🔄 Step 7: Writing to CSV...
[20:37:57] [DOC: 9208351] ℹ️  Calculated age: 72 from DOB: 07/26/1952
[20:37:57] [DOC: 9208351] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:37:57] [DOC: 9208351] ℹ️  Payer Source extracted: 'Medicare'
[20:37:57] [DOC: 9208351] ℹ️  Diagnosis codes being written:
[20:37:57] [DOC: 9208351] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:37:57] [DOC: 9208351] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:37:57] [DOC: 9208351] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:37:57] [DOC: 9208351] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:37:57] [DOC: 9208351] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:37:57] [DOC: 9208351] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:37:57] [DOC: 9208351] ✅ Patient data written to CSV: Janet Cabral | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicare | MRN: 6117015
[20:37:57] ✅    ✅ Document 9208351 processed and saved successfully
[20:37:57] 🔄 
🔄 Step 8: Saving API details...
[20:37:57] [DOC: 9208351] ℹ️  API push details saved for document 9208351
[20:37:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208349                         ║
================================================================================
[20:37:57] ℹ️  Agency: Dartmouth HH
[20:37:57] ℹ️  Date: 03/28/2025
[20:37:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:37:59] [DOC: 9208349] ✅ Text extracted using pdfplumber (1395 chars)
[20:37:59] ✅    ✅ Text extracted using pdfplumber (1395 chars)
[20:37:59] 🔄 
🔄 Step 2: Extracting patient data...
[20:38:02] ℹ️  AI extracted raw sex value: 'F'
[20:38:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:38:02] ℹ️  AI extracted payer source: 'Medicare'
[20:38:02] ℹ️  AI extracted diagnoses:
[20:38:02] ℹ️    - Diagnosis 1: ''
[20:38:02] ℹ️    - Diagnosis 2: ''
[20:38:02] ℹ️    - Diagnosis 3: ''
[20:38:02] ℹ️    - Diagnosis 4: ''
[20:38:02] ℹ️    - Diagnosis 5: ''
[20:38:02] ℹ️    - Diagnosis 6: ''
[20:38:02] ℹ️  Final extracted MRN: '5496011'
[20:38:02] ℹ️  Final extracted Sex: 'FEMALE'
[20:38:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:38:02] ℹ️  Final extracted Payer Source: 'Medicare'
[20:38:02] ✅ Patient data extraction completed successfully
[20:38:02] ✅    ✅ Patient data extracted successfully
[20:38:02] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:02] ✅    ✅ Patient identified: Donna Leclair
[20:38:02] ✅    ✅ Patient name validation passed
[20:38:02] 🔄 
🔄 Step 3: Processing patient dates...
[20:38:02] [DOC: 9208349] ℹ️  DOB normalized: 08/17/1950
[20:38:02] [DOC: 9208349] ℹ️  Episode startOfCare normalized: 03/08/2025
[20:38:02] [DOC: 9208349] ℹ️  Episode startOfEpisode normalized: 03/08/2025
[20:38:02] [DOC: 9208349] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[20:38:02] [DOC: 9208349] ✅ Patient date processing completed successfully
[20:38:02] ✅    ✅ Date processing completed
[20:38:02] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:02] 🔄 
🔄 Step 4: Extracting order data...
[20:38:05] ℹ️  Order extraction - MRN: ''
[20:38:05] ℹ️  Order extraction - Sex: 'FEMALE'
[20:38:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:38:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:38:05] ✅ Order data extraction completed successfully
[20:38:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:38:05] ℹ️  Using MRN from patient data: '5496011'
[20:38:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:38:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:38:05] ✅ Patient name cross-validation successful
[20:38:05] ✅    ✅ Data merged successfully
[20:38:06] ✅    ✅ Order data extracted and validated
[20:38:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:38:06] [DOC: 9208349] ✅ Patient found in local cache: Donna Leclair, ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[20:38:06] ✅    ✅ Existing patient found with ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[20:38:06] 🔄 
🔄 Step 6: Pushing order to API...
[20:38:06] [DOC: 9208349] ℹ️  Pushing order via API for patient ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[20:38:07] [DOC: 9208349] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:38:07] ❌    ❌ Failed to push order
[20:38:07] 🔄 
🔄 Step 7: Writing to CSV...
[20:38:07] [DOC: 9208349] ℹ️  Calculated age: 74 from DOB: 08/17/1950
[20:38:07] [DOC: 9208349] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:38:07] [DOC: 9208349] ℹ️  Payer Source extracted: 'Medicare'
[20:38:07] [DOC: 9208349] ℹ️  Diagnosis codes being written:
[20:38:07] [DOC: 9208349] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:38:07] [DOC: 9208349] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:38:07] [DOC: 9208349] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:38:07] [DOC: 9208349] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:38:07] [DOC: 9208349] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:38:07] [DOC: 9208349] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:38:07] [DOC: 9208349] ✅ Patient data written to CSV: Donna Leclair | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 5496011
[20:38:07] ✅    ✅ Document 9208349 processed and saved successfully
[20:38:07] 🔄 
🔄 Step 8: Saving API details...
[20:38:07] [DOC: 9208349] ℹ️  API push details saved for document 9208349
[20:38:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208348                         ║
================================================================================
[20:38:07] ℹ️  Agency: Dartmouth HH
[20:38:07] ℹ️  Date: 03/28/2025
[20:38:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:38:11] [DOC: 9208348] ✅ Text extracted using pdfplumber (1253 chars)
[20:38:11] ✅    ✅ Text extracted using pdfplumber (1253 chars)
[20:38:11] 🔄 
🔄 Step 2: Extracting patient data...
[20:38:14] ℹ️  AI extracted raw sex value: 'M'
[20:38:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:38:14] ℹ️  AI extracted payer source: 'Medicare'
[20:38:14] ℹ️  AI extracted diagnoses:
[20:38:14] ℹ️    - Diagnosis 1: ''
[20:38:14] ℹ️    - Diagnosis 2: ''
[20:38:14] ℹ️    - Diagnosis 3: ''
[20:38:14] ℹ️    - Diagnosis 4: ''
[20:38:14] ℹ️    - Diagnosis 5: ''
[20:38:14] ℹ️    - Diagnosis 6: ''
[20:38:14] ℹ️  Final extracted MRN: '6140015'
[20:38:14] ℹ️  Final extracted Sex: 'MALE'
[20:38:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:38:14] ℹ️  Final extracted Payer Source: 'Medicare'
[20:38:14] ✅ Patient data extraction completed successfully
[20:38:14] ✅    ✅ Patient data extracted successfully
[20:38:14] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:14] ✅    ✅ Patient identified: Ernest Barboza
[20:38:14] ✅    ✅ Patient name validation passed
[20:38:14] 🔄 
🔄 Step 3: Processing patient dates...
[20:38:14] [DOC: 9208348] ℹ️  DOB normalized: 02/22/1937
[20:38:14] [DOC: 9208348] ℹ️  Episode startOfCare normalized: 03/06/2025
[20:38:14] [DOC: 9208348] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[20:38:14] [DOC: 9208348] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[20:38:14] [DOC: 9208348] ✅ Patient date processing completed successfully
[20:38:14] ✅    ✅ Date processing completed
[20:38:14] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:14] 🔄 
🔄 Step 4: Extracting order data...
[20:38:16] ℹ️  Order extraction - MRN: '6140015'
[20:38:16] ℹ️  Order extraction - Sex: 'MALE'
[20:38:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:38:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:38:16] ✅ Order data extraction completed successfully
[20:38:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:38:16] ℹ️  Using MRN from patient data: '6140015' over '6140015'
[20:38:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:38:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:38:16] ✅ Patient name cross-validation successful
[20:38:16] ✅    ✅ Data merged successfully
[20:38:17] ✅    ✅ Order data extracted and validated
[20:38:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:38:17] [DOC: 9208348] ✅ Patient found in local cache: Ernest Barboza, ID: adb22793-6127-48ac-9c27-184ca9af82cc
[20:38:17] ✅    ✅ Existing patient found with ID: adb22793-6127-48ac-9c27-184ca9af82cc
[20:38:17] 🔄 
🔄 Step 6: Pushing order to API...
[20:38:17] [DOC: 9208348] ℹ️  Pushing order via API for patient ID: adb22793-6127-48ac-9c27-184ca9af82cc
[20:38:19] [DOC: 9208348] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:38:19] ❌    ❌ Failed to push order
[20:38:19] 🔄 
🔄 Step 7: Writing to CSV...
[20:38:19] [DOC: 9208348] ℹ️  Calculated age: 88 from DOB: 02/22/1937
[20:38:19] [DOC: 9208348] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:38:19] [DOC: 9208348] ℹ️  Payer Source extracted: 'Medicare'
[20:38:19] [DOC: 9208348] ℹ️  Diagnosis codes being written:
[20:38:19] [DOC: 9208348] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:38:19] [DOC: 9208348] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:38:19] [DOC: 9208348] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:38:19] [DOC: 9208348] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:38:19] [DOC: 9208348] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:38:19] [DOC: 9208348] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:38:19] [DOC: 9208348] ✅ Patient data written to CSV: Ernest Barboza | Sex: MALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6140015
[20:38:19] ✅    ✅ Document 9208348 processed and saved successfully
[20:38:19] 🔄 
🔄 Step 8: Saving API details...
[20:38:19] [DOC: 9208348] ℹ️  API push details saved for document 9208348
[20:38:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208344                         ║
================================================================================
[20:38:19] ℹ️  Agency: Nizhoni Health-Fall River
[20:38:19] ℹ️  Date: 03/28/2025
[20:38:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:38:35] [DOC: 9208344] ✅ Text extracted using pdfplumber (1067 chars)
[20:38:35] ✅    ✅ Text extracted using pdfplumber (1067 chars)
[20:38:35] 🔄 
🔄 Step 2: Extracting patient data...
[20:38:38] ℹ️  AI extracted raw sex value: 'M'
[20:38:38] ℹ️  AI extracted service line: 'HHA'
[20:38:38] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance One Care'
[20:38:38] ℹ️  AI extracted diagnoses:
[20:38:38] ℹ️    - Diagnosis 1: ''
[20:38:38] ℹ️    - Diagnosis 2: ''
[20:38:38] ℹ️    - Diagnosis 3: ''
[20:38:38] ℹ️    - Diagnosis 4: ''
[20:38:38] ℹ️    - Diagnosis 5: ''
[20:38:38] ℹ️    - Diagnosis 6: ''
[20:38:38] ℹ️  Final extracted MRN: '2748020'
[20:38:38] ℹ️  Final extracted Sex: 'MALE'
[20:38:38] ℹ️  Final extracted Service Line: 'HHA'
[20:38:38] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance One Care'
[20:38:38] ✅ Patient data extraction completed successfully
[20:38:38] ✅    ✅ Patient data extracted successfully
[20:38:38] 📊 Patient Response
     └─ patientFName: Anthony
     └─ patientLName: Lawson
     └─ dob: 12/07/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2748020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 514 Union Street 3rd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2022', 'startOfEpisode': '02/05/2025', 'endOfEpisode': '04/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:38] ✅    ✅ Patient identified: Anthony Lawson
[20:38:38] ✅    ✅ Patient name validation passed
[20:38:38] 🔄 
🔄 Step 3: Processing patient dates...
[20:38:38] [DOC: 9208344] ℹ️  DOB normalized: 12/07/1960
[20:38:38] [DOC: 9208344] ℹ️  Episode startOfCare normalized: 10/19/2022
[20:38:38] [DOC: 9208344] ℹ️  Episode startOfEpisode normalized: 02/05/2025
[20:38:38] [DOC: 9208344] ℹ️  Episode endOfEpisode normalized: 04/05/2025
[20:38:38] [DOC: 9208344] ✅ Patient date processing completed successfully
[20:38:38] ✅    ✅ Date processing completed
[20:38:38] 📊 Processed Patient Data
     └─ patientFName: Anthony
     └─ patientLName: Lawson
     └─ dob: 12/07/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2748020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 514 Union Street 3rd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2022', 'startOfEpisode': '02/05/2025', 'endOfEpisode': '04/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:38] 🔄 
🔄 Step 4: Extracting order data...
[20:38:40] ℹ️  Order extraction - MRN: '2748020'
[20:38:40] ℹ️  Order extraction - Sex: 'MALE'
[20:38:40] ℹ️  Order extraction - Service Line: ''
[20:38:40] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance One Care'
[20:38:40] ✅ Order data extraction completed successfully
[20:38:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:38:40] ℹ️  Using MRN from patient data: '2748020' over '2748020'
[20:38:40] ℹ️  Using service line from patient data: 'HHA'
[20:38:40] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance One Care'
[20:38:40] ✅ Patient name cross-validation successful
[20:38:40] ✅    ✅ Data merged successfully
[20:38:42] ✅    ✅ Order data extracted and validated
[20:38:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:38:42] [DOC: 9208344] ✅ Patient found in local cache: Anthony Lawson, ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[20:38:42] ✅    ✅ Existing patient found with ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[20:38:42] 🔄 
🔄 Step 6: Pushing order to API...
[20:38:42] [DOC: 9208344] ℹ️  Pushing order via API for patient ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[20:38:43] [DOC: 9208344] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:38:43] ❌    ❌ Failed to push order
[20:38:43] 🔄 
🔄 Step 7: Writing to CSV...
[20:38:43] [DOC: 9208344] ℹ️  Calculated age: 64 from DOB: 12/07/1960
[20:38:43] [DOC: 9208344] ℹ️  Service Line extracted: 'HHA'
[20:38:43] [DOC: 9208344] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance One Care'
[20:38:43] [DOC: 9208344] ℹ️  Diagnosis codes being written:
[20:38:43] [DOC: 9208344] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:38:43] [DOC: 9208344] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:38:43] [DOC: 9208344] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:38:43] [DOC: 9208344] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:38:43] [DOC: 9208344] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:38:43] [DOC: 9208344] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:38:43] [DOC: 9208344] ✅ Patient data written to CSV: Anthony Lawson | Sex: MALE | Age: 64 | Service: HHA | Payer: Commonwealth Care Alliance One Care | MRN: 2748020
[20:38:43] ✅    ✅ Document 9208344 processed and saved successfully
[20:38:43] 🔄 
🔄 Step 8: Saving API details...
[20:38:43] [DOC: 9208344] ℹ️  API push details saved for document 9208344
[20:38:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208342                         ║
================================================================================
[20:38:43] ℹ️  Agency: Dartmouth HH
[20:38:43] ℹ️  Date: 03/28/2025
[20:38:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:38:45] [DOC: 9208342] ✅ Text extracted using pdfplumber (2625 chars)
[20:38:45] ✅    ✅ Text extracted using pdfplumber (2625 chars)
[20:38:45] 🔄 
🔄 Step 2: Extracting patient data...
[20:38:48] ℹ️  AI extracted raw sex value: 'F'
[20:38:48] ℹ️  AI extracted service line: 'PT'
[20:38:48] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[20:38:48] ℹ️  AI extracted diagnoses:
[20:38:48] ℹ️    - Diagnosis 1: ''
[20:38:48] ℹ️    - Diagnosis 2: ''
[20:38:48] ℹ️    - Diagnosis 3: ''
[20:38:48] ℹ️    - Diagnosis 4: ''
[20:38:48] ℹ️    - Diagnosis 5: ''
[20:38:48] ℹ️    - Diagnosis 6: ''
[20:38:48] ℹ️  Final extracted MRN: '4398011'
[20:38:48] ℹ️  Final extracted Sex: 'FEMALE'
[20:38:48] ℹ️  Final extracted Service Line: 'PT'
[20:38:48] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[20:38:48] ✅ Patient data extraction completed successfully
[20:38:48] ✅    ✅ Patient data extracted successfully
[20:38:48] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:48] ✅    ✅ Patient identified: Elaine Dos Santos
[20:38:48] ✅    ✅ Patient name validation passed
[20:38:48] 🔄 
🔄 Step 3: Processing patient dates...
[20:38:48] [DOC: 9208342] ℹ️  DOB normalized: 06/30/1950
[20:38:48] [DOC: 9208342] ℹ️  Episode startOfCare normalized: 12/15/2024
[20:38:48] [DOC: 9208342] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[20:38:48] [DOC: 9208342] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[20:38:48] [DOC: 9208342] ✅ Patient date processing completed successfully
[20:38:48] ✅    ✅ Date processing completed
[20:38:48] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:48] 🔄 
🔄 Step 4: Extracting order data...
[20:38:50] ℹ️  Order extraction - MRN: '4398011'
[20:38:50] ℹ️  Order extraction - Sex: 'FEMALE'
[20:38:50] ℹ️  Order extraction - Service Line: 'PT'
[20:38:50] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[20:38:50] ✅ Order data extraction completed successfully
[20:38:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:38:50] ℹ️  Using MRN from patient data: '4398011' over '4398011'
[20:38:50] ℹ️  Service line consistent in both sources: 'PT'
[20:38:50] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[20:38:50] ✅ Patient name cross-validation successful
[20:38:50] ✅    ✅ Data merged successfully
[20:38:51] ✅    ✅ Order data extracted and validated
[20:38:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:38:51] [DOC: 9208342] ✅ Patient found in local cache: Elaine Dos Santos, ID: b67987f0-df4a-470f-8698-52193755e58e
[20:38:51] ✅    ✅ Existing patient found with ID: b67987f0-df4a-470f-8698-52193755e58e
[20:38:51] 🔄 
🔄 Step 6: Pushing order to API...
[20:38:51] [DOC: 9208342] ℹ️  Pushing order via API for patient ID: b67987f0-df4a-470f-8698-52193755e58e
[20:38:53] [DOC: 9208342] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:38:53] ❌    ❌ Failed to push order
[20:38:53] 🔄 
🔄 Step 7: Writing to CSV...
[20:38:53] [DOC: 9208342] ℹ️  Calculated age: 74 from DOB: 06/30/1950
[20:38:53] [DOC: 9208342] ℹ️  Service Line extracted: 'PT'
[20:38:53] [DOC: 9208342] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[20:38:53] [DOC: 9208342] ℹ️  Diagnosis codes being written:
[20:38:53] [DOC: 9208342] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:38:53] [DOC: 9208342] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:38:53] [DOC: 9208342] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:38:53] [DOC: 9208342] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:38:53] [DOC: 9208342] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:38:53] [DOC: 9208342] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:38:53] [DOC: 9208342] ✅ Patient data written to CSV: Elaine Dos Santos | Sex: FEMALE | Age: 74 | Service: PT | Payer: Blue Cross Medicare Adv | MRN: 4398011
[20:38:53] ✅    ✅ Document 9208342 processed and saved successfully
[20:38:53] 🔄 
🔄 Step 8: Saving API details...
[20:38:53] [DOC: 9208342] ℹ️  API push details saved for document 9208342
[20:38:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208340                         ║
================================================================================
[20:38:53] ℹ️  Agency: Dartmouth HH
[20:38:53] ℹ️  Date: 03/28/2025
[20:38:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:38:56] [DOC: 9208340] ✅ Text extracted using pdfplumber (3760 chars)
[20:38:56] ✅    ✅ Text extracted using pdfplumber (3760 chars)
[20:38:56] 🔄 
🔄 Step 2: Extracting patient data...
[20:38:58] ℹ️  AI extracted raw sex value: 'M'
[20:38:58] ℹ️  AI extracted service line: 'PT'
[20:38:58] ℹ️  AI extracted payer source: 'Medicare'
[20:38:58] ℹ️  AI extracted diagnoses:
[20:38:58] ℹ️    - Diagnosis 1: ''
[20:38:58] ℹ️    - Diagnosis 2: ''
[20:38:58] ℹ️    - Diagnosis 3: ''
[20:38:58] ℹ️    - Diagnosis 4: ''
[20:38:58] ℹ️    - Diagnosis 5: ''
[20:38:58] ℹ️    - Diagnosis 6: ''
[20:38:58] ℹ️  Final extracted MRN: '5824015'
[20:38:58] ℹ️  Final extracted Sex: 'MALE'
[20:38:58] ℹ️  Final extracted Service Line: 'PT'
[20:38:58] ℹ️  Final extracted Payer Source: 'Medicare'
[20:38:58] ✅ Patient data extraction completed successfully
[20:38:58] ✅    ✅ Patient data extracted successfully
[20:38:58] 📊 Patient Response
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 5824015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:58] ✅    ✅ Patient identified: Wayne Dubreuil
[20:38:58] ✅    ✅ Patient name validation passed
[20:38:58] 🔄 
🔄 Step 3: Processing patient dates...
[20:38:58] [DOC: 9208340] ℹ️  DOB normalized: 08/14/1953
[20:38:58] [DOC: 9208340] ℹ️  Episode startOfCare normalized: 01/16/2025
[20:38:58] [DOC: 9208340] ℹ️  Episode startOfEpisode normalized: 01/16/2025
[20:38:58] [DOC: 9208340] ℹ️  Episode endOfEpisode normalized: 03/16/2025
[20:38:58] [DOC: 9208340] ✅ Patient date processing completed successfully
[20:38:58] ✅    ✅ Date processing completed
[20:38:58] 📊 Processed Patient Data
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 5824015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:38:58] 🔄 
🔄 Step 4: Extracting order data...
[20:39:01] ℹ️  Order extraction - MRN: ''
[20:39:01] ℹ️  Order extraction - Sex: 'MALE'
[20:39:01] ℹ️  Order extraction - Service Line: 'PT'
[20:39:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:39:01] ✅ Order data extraction completed successfully
[20:39:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:39:01] ℹ️  Using MRN from patient data: '5824015'
[20:39:01] ℹ️  Service line consistent in both sources: 'PT'
[20:39:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:39:01] ✅ Patient name cross-validation successful
[20:39:01] ✅    ✅ Data merged successfully
[20:39:02] ✅    ✅ Order data extracted and validated
[20:39:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:39:02] [DOC: 9208340] ✅ Patient found in local cache: Wayne Dubreuil, ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[20:39:02] ✅    ✅ Existing patient found with ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[20:39:02] 🔄 
🔄 Step 6: Pushing order to API...
[20:39:02] [DOC: 9208340] ℹ️  Pushing order via API for patient ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[20:39:03] [DOC: 9208340] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:39:03] ❌    ❌ Failed to push order
[20:39:03] 🔄 
🔄 Step 7: Writing to CSV...
[20:39:03] [DOC: 9208340] ℹ️  Calculated age: 71 from DOB: 08/14/1953
[20:39:03] [DOC: 9208340] ℹ️  Service Line extracted: 'PT'
[20:39:03] [DOC: 9208340] ℹ️  Payer Source extracted: 'Medicare'
[20:39:03] [DOC: 9208340] ℹ️  Diagnosis codes being written:
[20:39:03] [DOC: 9208340] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:39:03] [DOC: 9208340] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:39:03] [DOC: 9208340] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:39:03] [DOC: 9208340] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:39:03] [DOC: 9208340] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:39:03] [DOC: 9208340] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:39:03] [DOC: 9208340] ✅ Patient data written to CSV: Wayne Dubreuil | Sex: MALE | Age: 71 | Service: PT | Payer: Medicare | MRN: 5824015
[20:39:03] ✅    ✅ Document 9208340 processed and saved successfully
[20:39:03] 🔄 
🔄 Step 8: Saving API details...
[20:39:03] [DOC: 9208340] ℹ️  API push details saved for document 9208340
[20:39:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208338                         ║
================================================================================
[20:39:03] ℹ️  Agency: Dartmouth HH
[20:39:03] ℹ️  Date: 03/28/2025
[20:39:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:39:05] [DOC: 9208338] ✅ Text extracted using pdfplumber (1161 chars)
[20:39:05] ✅    ✅ Text extracted using pdfplumber (1161 chars)
[20:39:05] 🔄 
🔄 Step 2: Extracting patient data...
[20:39:08] ℹ️  AI extracted raw sex value: 'M'
[20:39:08] ℹ️  AI extracted service line: 'RN'
[20:39:08] ℹ️  AI extracted payer source: 'United Health Care'
[20:39:08] ℹ️  AI extracted diagnoses:
[20:39:08] ℹ️    - Diagnosis 1: ''
[20:39:08] ℹ️    - Diagnosis 2: ''
[20:39:08] ℹ️    - Diagnosis 3: ''
[20:39:08] ℹ️    - Diagnosis 4: ''
[20:39:08] ℹ️    - Diagnosis 5: ''
[20:39:08] ℹ️    - Diagnosis 6: ''
[20:39:08] ℹ️  Final extracted MRN: '926015'
[20:39:08] ℹ️  Final extracted Sex: 'MALE'
[20:39:08] ℹ️  Final extracted Service Line: 'RN'
[20:39:08] ℹ️  Final extracted Payer Source: 'United Health Care'
[20:39:08] ✅ Patient data extraction completed successfully
[20:39:08] ✅    ✅ Patient data extracted successfully
[20:39:08] 📊 Patient Response
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 88 Highland St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:39:08] ✅    ✅ Patient identified: Clinton Sowle
[20:39:08] ✅    ✅ Patient name validation passed
[20:39:08] 🔄 
🔄 Step 3: Processing patient dates...
[20:39:08] [DOC: 9208338] ℹ️  DOB normalized: 12/01/1943
[20:39:08] [DOC: 9208338] ℹ️  Episode startOfCare normalized: 02/14/2025
[20:39:08] [DOC: 9208338] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[20:39:08] [DOC: 9208338] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[20:39:08] [DOC: 9208338] ✅ Patient date processing completed successfully
[20:39:08] ✅    ✅ Date processing completed
[20:39:08] 📊 Processed Patient Data
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 88 Highland St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:39:08] 🔄 
🔄 Step 4: Extracting order data...
[20:39:10] ℹ️  Order extraction - MRN: ''
[20:39:10] ℹ️  Order extraction - Sex: 'MALE'
[20:39:10] ℹ️  Order extraction - Service Line: 'RN'
[20:39:10] ℹ️  Order extraction - Payer Source: 'United Health Care'
[20:39:10] ✅ Order data extraction completed successfully
[20:39:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:39:10] ℹ️  Using MRN from patient data: '926015'
[20:39:10] ℹ️  Service line consistent in both sources: 'RN'
[20:39:10] ℹ️  Payer source consistent in both sources: 'United Health Care'
[20:39:10] ✅ Patient name cross-validation successful
[20:39:10] ✅    ✅ Data merged successfully
[20:39:12] ✅    ✅ Order data extracted and validated
[20:39:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:39:12] [DOC: 9208338] ✅ Patient found in local cache: Clinton Sowle, ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[20:39:12] ✅    ✅ Existing patient found with ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[20:39:12] 🔄 
🔄 Step 6: Pushing order to API...
[20:39:12] [DOC: 9208338] ℹ️  Pushing order via API for patient ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[20:39:13] [DOC: 9208338] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14216"}
[20:39:13] ❌    ❌ Failed to push order
[20:39:13] 🔄 
🔄 Step 7: Writing to CSV...
[20:39:13] [DOC: 9208338] ℹ️  Calculated age: 81 from DOB: 12/01/1943
[20:39:13] [DOC: 9208338] ℹ️  Service Line extracted: 'RN'
[20:39:13] [DOC: 9208338] ℹ️  Payer Source extracted: 'United Health Care'
[20:39:13] [DOC: 9208338] ℹ️  Diagnosis codes being written:
[20:39:13] [DOC: 9208338] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:39:13] [DOC: 9208338] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:39:13] [DOC: 9208338] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:39:13] [DOC: 9208338] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:39:13] [DOC: 9208338] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:39:13] [DOC: 9208338] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:39:13] [DOC: 9208338] ✅ Patient data written to CSV: Clinton Sowle | Sex: MALE | Age: 81 | Service: RN | Payer: United Health Care | MRN: 926015
[20:39:13] ✅    ✅ Document 9208338 processed and saved successfully
[20:39:13] 🔄 
🔄 Step 8: Saving API details...
[20:39:13] [DOC: 9208338] ℹ️  API push details saved for document 9208338
[20:39:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208333                         ║
================================================================================
[20:39:13] ℹ️  Agency: Dartmouth HH
[20:39:13] ℹ️  Date: 03/28/2025
[20:39:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:39:15] [DOC: 9208333] ✅ Text extracted using pdfplumber (2425 chars)
[20:39:15] ✅    ✅ Text extracted using pdfplumber (2425 chars)
[20:39:15] 🔄 
🔄 Step 2: Extracting patient data...
[20:39:18] ℹ️  AI extracted raw sex value: 'F'
[20:39:18] ℹ️  AI extracted service line: 'Physical Therapy'
[20:39:18] ℹ️  AI extracted payer source: 'Medicare'
[20:39:18] ℹ️  AI extracted diagnoses:
[20:39:18] ℹ️    - Diagnosis 1: 'None'
[20:39:18] ℹ️    - Diagnosis 2: 'None'
[20:39:18] ℹ️    - Diagnosis 3: 'None'
[20:39:18] ℹ️    - Diagnosis 4: 'None'
[20:39:18] ℹ️    - Diagnosis 5: 'None'
[20:39:18] ℹ️    - Diagnosis 6: 'None'
[20:39:18] ℹ️  Final extracted MRN: '7141009'
[20:39:18] ℹ️  Final extracted Sex: 'FEMALE'
[20:39:18] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:39:18] ℹ️  Final extracted Payer Source: 'Medicare'
[20:39:18] ✅ Patient data extraction completed successfully
[20:39:18] ✅    ✅ Patient data extracted successfully
[20:39:18] 📊 Patient Response
     └─ patientFName: Alice
     └─ patientLName: Almeida
     └─ dob: 04/04/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7141009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:39:18] ✅    ✅ Patient identified: Alice Almeida
[20:39:18] ✅    ✅ Patient name validation passed
[20:39:18] 🔄 
🔄 Step 3: Processing patient dates...
[20:39:18] [DOC: 9208333] ℹ️  DOB normalized: 04/04/1944
[20:39:18] [DOC: 9208333] ℹ️  Episode startOfCare normalized: 02/01/2025
[20:39:18] [DOC: 9208333] ℹ️  Episode startOfEpisode normalized: 02/01/2025
[20:39:18] [DOC: 9208333] ℹ️  Episode endOfEpisode normalized: 04/01/2025
[20:39:18] [DOC: 9208333] ✅ Patient date processing completed successfully
[20:39:18] ✅    ✅ Date processing completed
[20:39:18] 📊 Processed Patient Data
     └─ patientFName: Alice
     └─ patientLName: Almeida
     └─ dob: 04/04/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7141009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025'}]
[20:39:18] 🔄 
🔄 Step 4: Extracting order data...
[20:39:20] ℹ️  Order extraction - MRN: '7141009'
[20:39:20] ℹ️  Order extraction - Sex: 'FEMALE'
[20:39:20] ℹ️  Order extraction - Service Line: 'PT'
[20:39:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:39:20] ✅ Order data extraction completed successfully
[20:39:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:39:20] ℹ️  Using MRN from patient data: '7141009' over '7141009'
[20:39:20] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[20:39:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:39:20] ✅ Patient name cross-validation successful
[20:39:20] ✅    ✅ Data merged successfully
[20:39:22] ✅    ✅ Order data extracted and validated
[20:39:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:39:22] [DOC: 9208333] ✅ Patient found in local cache: Alice Almeida, ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[20:39:22] ✅    ✅ Existing patient found with ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[20:39:22] 🔄 
🔄 Step 6: Pushing order to API...
[20:39:22] [DOC: 9208333] ℹ️  Pushing order via API for patient ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[20:39:23] [DOC: 9208333] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:39:23] ❌    ❌ Failed to push order
[20:39:23] 🔄 
🔄 Step 7: Writing to CSV...
[20:39:23] [DOC: 9208333] ℹ️  Calculated age: 81 from DOB: 04/04/1944
[20:39:23] [DOC: 9208333] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[20:39:23] [DOC: 9208333] ℹ️  Payer Source extracted: 'Medicare'
[20:39:23] [DOC: 9208333] ℹ️  Diagnosis codes being written:
[20:39:23] [DOC: 9208333] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:39:23] [DOC: 9208333] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:39:23] [DOC: 9208333] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:39:23] [DOC: 9208333] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:39:23] [DOC: 9208333] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:39:23] [DOC: 9208333] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:39:23] [DOC: 9208333] ✅ Patient data written to CSV: Alice Almeida | Sex: FEMALE | Age: 81 | Service: PT, Physical Therapy | Payer: Medicare | MRN: 7141009
[20:39:23] ✅    ✅ Document 9208333 processed and saved successfully
[20:39:23] 🔄 
🔄 Step 8: Saving API details...
[20:39:23] [DOC: 9208333] ℹ️  API push details saved for document 9208333
[20:39:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208331                         ║
================================================================================
[20:39:23] ℹ️  Agency: Dartmouth HH
[20:39:23] ℹ️  Date: 03/28/2025
[20:39:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:39:27] [DOC: 9208331] ✅ Text extracted using pdfplumber (3159 chars)
[20:39:27] ✅    ✅ Text extracted using pdfplumber (3159 chars)
[20:39:27] 🔄 
🔄 Step 2: Extracting patient data...
[20:39:30] ℹ️  AI extracted raw sex value: 'F'
[20:39:30] ℹ️  AI extracted service line: 'PT'
[20:39:30] ℹ️  AI extracted payer source: 'Medicare'
[20:39:30] ℹ️  AI extracted diagnoses:
[20:39:30] ℹ️    - Diagnosis 1: 'None'
[20:39:30] ℹ️    - Diagnosis 2: 'None'
[20:39:30] ℹ️    - Diagnosis 3: 'None'
[20:39:30] ℹ️    - Diagnosis 4: 'None'
[20:39:30] ℹ️    - Diagnosis 5: 'None'
[20:39:30] ℹ️    - Diagnosis 6: 'None'
[20:39:30] ℹ️  Final extracted MRN: '6041015'
[20:39:30] ℹ️  Final extracted Sex: 'FEMALE'
[20:39:30] ℹ️  Final extracted Service Line: 'PT'
[20:39:30] ℹ️  Final extracted Payer Source: 'Medicare'
[20:39:30] ✅ Patient data extraction completed successfully
[20:39:30] ✅    ✅ Patient data extracted successfully
[20:39:30] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Aniceto
     └─ dob: 12/04/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6041015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 284 Earle Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:39:30] ✅    ✅ Patient identified: Maria Aniceto
[20:39:30] ✅    ✅ Patient name validation passed
[20:39:30] 🔄 
🔄 Step 3: Processing patient dates...
[20:39:30] [DOC: 9208331] ℹ️  DOB normalized: 12/04/1950
[20:39:30] [DOC: 9208331] ℹ️  Episode startOfCare normalized: 02/25/2025
[20:39:30] [DOC: 9208331] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[20:39:30] [DOC: 9208331] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[20:39:30] [DOC: 9208331] ✅ Patient date processing completed successfully
[20:39:30] ✅    ✅ Date processing completed
[20:39:30] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Aniceto
     └─ dob: 12/04/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6041015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 284 Earle Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025'}]
[20:39:30] 🔄 
🔄 Step 4: Extracting order data...
[20:39:32] ℹ️  Order extraction - MRN: ''
[20:39:32] ℹ️  Order extraction - Sex: 'FEMALE'
[20:39:32] ℹ️  Order extraction - Service Line: 'PT'
[20:39:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:39:32] ✅ Order data extraction completed successfully
[20:39:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:39:32] ℹ️  Using MRN from patient data: '6041015'
[20:39:32] ℹ️  Service line consistent in both sources: 'PT'
[20:39:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:39:32] ✅ Patient name cross-validation successful
[20:39:32] ✅    ✅ Data merged successfully
[20:39:34] ✅    ✅ Order data extracted and validated
[20:39:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:39:34] [DOC: 9208331] ✅ Patient found in local cache: Maria Aniceto, ID: 5df536a2-7c61-4803-85e5-bede11671c97
[20:39:34] ✅    ✅ Existing patient found with ID: 5df536a2-7c61-4803-85e5-bede11671c97
[20:39:34] 🔄 
🔄 Step 6: Pushing order to API...
[20:39:34] [DOC: 9208331] ℹ️  Pushing order via API for patient ID: 5df536a2-7c61-4803-85e5-bede11671c97
[20:39:35] [DOC: 9208331] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:39:35] ❌    ❌ Failed to push order
[20:39:35] 🔄 
🔄 Step 7: Writing to CSV...
[20:39:35] [DOC: 9208331] ℹ️  Calculated age: 74 from DOB: 12/04/1950
[20:39:35] [DOC: 9208331] ℹ️  Service Line extracted: 'PT'
[20:39:35] [DOC: 9208331] ℹ️  Payer Source extracted: 'Medicare'
[20:39:35] [DOC: 9208331] ℹ️  Diagnosis codes being written:
[20:39:35] [DOC: 9208331] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:39:35] [DOC: 9208331] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:39:35] [DOC: 9208331] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:39:35] [DOC: 9208331] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:39:35] [DOC: 9208331] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:39:35] [DOC: 9208331] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:39:35] [DOC: 9208331] ✅ Patient data written to CSV: Maria Aniceto | Sex: FEMALE | Age: 74 | Service: PT | Payer: Medicare | MRN: 6041015
[20:39:35] ✅    ✅ Document 9208331 processed and saved successfully
[20:39:35] 🔄 
🔄 Step 8: Saving API details...
[20:39:35] [DOC: 9208331] ℹ️  API push details saved for document 9208331
[20:39:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208328                         ║
================================================================================
[20:39:35] ℹ️  Agency: Dartmouth HH
[20:39:35] ℹ️  Date: 03/28/2025
[20:39:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:39:37] [DOC: 9208328] ✅ Text extracted using pdfplumber (1137 chars)
[20:39:37] ✅    ✅ Text extracted using pdfplumber (1137 chars)
[20:39:37] 🔄 
🔄 Step 2: Extracting patient data...
[20:39:40] ℹ️  AI extracted raw sex value: 'F'
[20:39:40] ℹ️  AI extracted service line: 'OT'
[20:39:40] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[20:39:40] ℹ️  AI extracted diagnoses:
[20:39:40] ℹ️    - Diagnosis 1: ''
[20:39:40] ℹ️    - Diagnosis 2: ''
[20:39:40] ℹ️    - Diagnosis 3: ''
[20:39:40] ℹ️    - Diagnosis 4: ''
[20:39:40] ℹ️    - Diagnosis 5: ''
[20:39:40] ℹ️    - Diagnosis 6: ''
[20:39:40] ℹ️  Final extracted MRN: '6073015'
[20:39:40] ℹ️  Final extracted Sex: 'FEMALE'
[20:39:40] ℹ️  Final extracted Service Line: 'OT'
[20:39:40] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[20:39:40] ✅ Patient data extraction completed successfully
[20:39:40] ✅    ✅ Patient data extracted successfully
[20:39:40] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:39:40] ✅    ✅ Patient identified: Marilyn Valle
[20:39:40] ✅    ✅ Patient name validation passed
[20:39:40] 🔄 
🔄 Step 3: Processing patient dates...
[20:39:40] [DOC: 9208328] ℹ️  DOB normalized: 12/24/1947
[20:39:40] [DOC: 9208328] ℹ️  Episode startOfCare normalized: 02/22/2025
[20:39:40] [DOC: 9208328] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[20:39:40] [DOC: 9208328] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[20:39:40] [DOC: 9208328] ✅ Patient date processing completed successfully
[20:39:40] ✅    ✅ Date processing completed
[20:39:40] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:39:40] 🔄 
🔄 Step 4: Extracting order data...
[20:39:42] ℹ️  Order extraction - MRN: ''
[20:39:42] ℹ️  Order extraction - Sex: 'FEMALE'
[20:39:42] ℹ️  Order extraction - Service Line: 'OT'
[20:39:42] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[20:39:42] ✅ Order data extraction completed successfully
[20:39:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:39:42] ℹ️  Using MRN from patient data: '6073015'
[20:39:42] ℹ️  Service line consistent in both sources: 'OT'
[20:39:42] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[20:39:42] ✅ Patient name cross-validation successful
[20:39:42] ✅    ✅ Data merged successfully
[20:39:44] ✅    ✅ Order data extracted and validated
[20:39:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:39:44] [DOC: 9208328] ✅ Patient found in local cache: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[20:39:44] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[20:39:44] 🔄 
🔄 Step 6: Pushing order to API...
[20:39:44] [DOC: 9208328] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[20:39:46] [DOC: 9208328] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:39:46] ❌    ❌ Failed to push order
[20:39:46] 🔄 
🔄 Step 7: Writing to CSV...
[20:39:46] [DOC: 9208328] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[20:39:46] [DOC: 9208328] ℹ️  Service Line extracted: 'OT'
[20:39:46] [DOC: 9208328] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[20:39:46] [DOC: 9208328] ℹ️  Diagnosis codes being written:
[20:39:46] [DOC: 9208328] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:39:46] [DOC: 9208328] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:39:46] [DOC: 9208328] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:39:46] [DOC: 9208328] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:39:46] [DOC: 9208328] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:39:46] [DOC: 9208328] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:39:46] [DOC: 9208328] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT | Payer: Aetna- Mcare | MRN: 6073015
[20:39:46] ✅    ✅ Document 9208328 processed and saved successfully
[20:39:46] 🔄 
🔄 Step 8: Saving API details...
[20:39:46] [DOC: 9208328] ℹ️  API push details saved for document 9208328
[20:39:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208314                         ║
================================================================================
[20:39:46] ℹ️  Agency: Dartmouth HH
[20:39:46] ℹ️  Date: 03/28/2025
[20:39:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:39:49] [DOC: 9208314] ✅ Text extracted using pdfplumber (2118 chars)
[20:39:49] ✅    ✅ Text extracted using pdfplumber (2118 chars)
[20:39:49] 🔄 
🔄 Step 2: Extracting patient data...
[20:39:52] ℹ️  AI extracted raw sex value: 'F'
[20:39:52] ℹ️  AI extracted service line: 'Skilled Nursing, OT'
[20:39:52] ℹ️  AI extracted payer source: 'Medicare'
[20:39:52] ℹ️  AI extracted diagnoses:
[20:39:52] ℹ️    - Diagnosis 1: ''
[20:39:52] ℹ️    - Diagnosis 2: ''
[20:39:52] ℹ️    - Diagnosis 3: ''
[20:39:52] ℹ️    - Diagnosis 4: ''
[20:39:52] ℹ️    - Diagnosis 5: ''
[20:39:52] ℹ️    - Diagnosis 6: ''
[20:39:52] ℹ️  Final extracted MRN: '6190015'
[20:39:52] ℹ️  Final extracted Sex: 'FEMALE'
[20:39:52] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT'
[20:39:52] ℹ️  Final extracted Payer Source: 'Medicare'
[20:39:52] ✅ Patient data extraction completed successfully
[20:39:52] ✅    ✅ Patient data extracted successfully
[20:39:52] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:39:52] ✅    ✅ Patient identified: John Ostapow
[20:39:52] ✅    ✅ Patient name validation passed
[20:39:52] 🔄 
🔄 Step 3: Processing patient dates...
[20:39:52] [DOC: 9208314] ℹ️  DOB normalized: 11/23/1935
[20:39:52] [DOC: 9208314] ℹ️  Episode startOfCare normalized: 03/12/2025
[20:39:52] [DOC: 9208314] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[20:39:52] [DOC: 9208314] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[20:39:52] [DOC: 9208314] ✅ Patient date processing completed successfully
[20:39:52] ✅    ✅ Date processing completed
[20:39:52] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:39:52] 🔄 
🔄 Step 4: Extracting order data...
[20:39:55] ℹ️  Order extraction - MRN: ''
[20:39:55] ℹ️  Order extraction - Sex: 'FEMALE'
[20:39:55] ℹ️  Order extraction - Service Line: 'OT,SN'
[20:39:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:39:55] ✅ Order data extraction completed successfully
[20:39:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:39:55] ℹ️  Using MRN from patient data: '6190015'
[20:39:55] ℹ️  Combined service lines: Patient='Skilled Nursing, OT' + Order='OT,SN' = 'OT, SN, Skilled Nursing'
[20:39:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:39:55] ✅ Patient name cross-validation successful
[20:39:55] ✅    ✅ Data merged successfully
[20:39:56] ✅    ✅ Order data extracted and validated
[20:39:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:39:56] [DOC: 9208314] ✅ Patient found in local cache: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[20:39:56] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[20:39:56] 🔄 
🔄 Step 6: Pushing order to API...
[20:39:56] [DOC: 9208314] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[20:39:58] [DOC: 9208314] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:39:58] ❌    ❌ Failed to push order
[20:39:58] 🔄 
🔄 Step 7: Writing to CSV...
[20:39:58] [DOC: 9208314] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[20:39:58] [DOC: 9208314] ℹ️  Service Line extracted: 'OT, SN, Skilled Nursing'
[20:39:58] [DOC: 9208314] ℹ️  Payer Source extracted: 'Medicare'
[20:39:58] [DOC: 9208314] ℹ️  Diagnosis codes being written:
[20:39:58] [DOC: 9208314] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:39:58] [DOC: 9208314] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:39:58] [DOC: 9208314] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:39:58] [DOC: 9208314] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:39:58] [DOC: 9208314] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:39:58] [DOC: 9208314] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:39:58] [DOC: 9208314] ✅ Patient data written to CSV: John Ostapow | Sex: FEMALE | Age: 89 | Service: OT, SN, Skilled Nursing | Payer: Medicare | MRN: 6190015
[20:39:58] ✅    ✅ Document 9208314 processed and saved successfully
[20:39:58] 🔄 
🔄 Step 8: Saving API details...
[20:39:58] [DOC: 9208314] ℹ️  API push details saved for document 9208314
[20:39:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208313                         ║
================================================================================
[20:39:58] ℹ️  Agency: Dartmouth HH
[20:39:58] ℹ️  Date: 03/28/2025
[20:39:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:40:01] [DOC: 9208313] ✅ Text extracted using pdfplumber (12536 chars)
[20:40:01] ✅    ✅ Text extracted using pdfplumber (12536 chars)
[20:40:01] 🔄 
🔄 Step 2: Extracting patient data...
[20:40:05] ℹ️  AI extracted raw sex value: 'M'
[20:40:05] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing, Home Health Aide'
[20:40:05] ℹ️  AI extracted payer source: 'Medicare'
[20:40:05] ℹ️  AI extracted diagnoses:
[20:40:05] ℹ️    - Diagnosis 1: 'A04.72'
[20:40:05] ℹ️    - Diagnosis 2: 'E86.0'
[20:40:05] ℹ️    - Diagnosis 3: 'G20.A1'
[20:40:05] ℹ️    - Diagnosis 4: 'L89.153'
[20:40:05] ℹ️    - Diagnosis 5: 'I95.9'
[20:40:05] ℹ️    - Diagnosis 6: 'L89.613'
[20:40:05] ℹ️  Final extracted MRN: '1396009'
[20:40:05] ℹ️  Final extracted Sex: 'MALE'
[20:40:05] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing, Home Health Aide'
[20:40:05] ℹ️  Final extracted Payer Source: 'Medicare'
[20:40:05] ✅ Patient data extraction completed successfully
[20:40:05] ✅    ✅ Patient data extracted successfully
[20:40:05] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing, Home Health Aide
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G20.A1', 'fourthDiagnosis': 'L89.153', 'fifthDiagnosis': 'I95.9', 'sixthDiagnosis': 'L89.613'}]
[20:40:05] ✅    ✅ Patient identified: Elias Ramos
[20:40:05] ✅    ✅ Patient name validation passed
[20:40:05] 🔄 
🔄 Step 3: Processing patient dates...
[20:40:05] [DOC: 9208313] ℹ️  DOB normalized: 08/28/1938
[20:40:05] [DOC: 9208313] ℹ️  Episode startOfCare normalized: 03/01/2025
[20:40:05] [DOC: 9208313] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[20:40:05] [DOC: 9208313] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[20:40:05] [DOC: 9208313] ✅ Patient date processing completed successfully
[20:40:05] ✅    ✅ Date processing completed
[20:40:05] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing, Home Health Aide
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G20.A1', 'fourthDiagnosis': 'L89.153', 'fifthDiagnosis': 'I95.9', 'sixthDiagnosis': 'L89.613'}]
[20:40:05] 🔄 
🔄 Step 4: Extracting order data...
[20:40:07] ℹ️  Order extraction - MRN: ''
[20:40:07] ℹ️  Order extraction - Sex: 'MALE'
[20:40:07] ℹ️  Order extraction - Service Line: 'PT, RN, HHA, SN'
[20:40:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:40:07] ✅ Order data extraction completed successfully
[20:40:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:40:07] ℹ️  Using MRN from patient data: '1396009'
[20:40:07] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing, Home Health Aide' + Order='PT, RN, HHA, SN' = 'HHA, Home Health Aide, PT, Physical Therapy, RN, SN, Skilled Nursing'
[20:40:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:40:07] ✅ Patient name cross-validation successful
[20:40:07] ✅    ✅ Data merged successfully
[20:40:09] ✅    ✅ Order data extracted and validated
[20:40:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:40:09] [DOC: 9208313] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[20:40:09] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[20:40:09] 🔄 
🔄 Step 6: Pushing order to API...
[20:40:09] [DOC: 9208313] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[20:40:10] [DOC: 9208313] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:40:10] ❌    ❌ Failed to push order
[20:40:10] 🔄 
🔄 Step 7: Writing to CSV...
[20:40:10] [DOC: 9208313] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[20:40:10] [DOC: 9208313] ℹ️  Service Line extracted: 'HHA, Home Health Aide, PT, Physical Therapy, RN, SN, Skilled Nursing'
[20:40:10] [DOC: 9208313] ℹ️  Payer Source extracted: 'Medicare'
[20:40:10] [DOC: 9208313] ℹ️  Diagnosis codes being written:
[20:40:10] [DOC: 9208313] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[20:40:10] [DOC: 9208313] ℹ️    - Latest_Episode_Seconddiagnosis: 'E86.0'
[20:40:10] [DOC: 9208313] ℹ️    - Latest_Episode_Thirddiagnosis: 'G20.A1'
[20:40:10] [DOC: 9208313] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L89.153'
[20:40:10] [DOC: 9208313] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I95.9'
[20:40:10] [DOC: 9208313] ℹ️    - Latest_Episode_Sixthdiagnosis: 'L89.613'
[20:40:10] [DOC: 9208313] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: HHA, Home Health Aide, PT, Physical Therapy, RN, SN, Skilled Nursing | Payer: Medicare | MRN: 1396009
[20:40:10] ✅    ✅ Document 9208313 processed and saved successfully
[20:40:10] 🔄 
🔄 Step 8: Saving API details...
[20:40:10] [DOC: 9208313] ℹ️  API push details saved for document 9208313
[20:40:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208311                         ║
================================================================================
[20:40:10] ℹ️  Agency: Dartmouth HH
[20:40:10] ℹ️  Date: 03/28/2025
[20:40:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:40:18] [DOC: 9208311] ✅ Text extracted using pdfplumber (19223 chars)
[20:40:18] ✅    ✅ Text extracted using pdfplumber (19211 chars)
[20:40:18] 🔄 
🔄 Step 2: Extracting patient data...
[20:40:21] ℹ️  AI extracted raw sex value: 'M'
[20:40:21] ℹ️  AI extracted service line: 'Skilled Nursing, OT'
[20:40:21] ℹ️  AI extracted payer source: 'None'
[20:40:21] ℹ️  AI extracted diagnoses:
[20:40:21] ℹ️    - Diagnosis 1: 'Z47.1'
[20:40:21] ℹ️    - Diagnosis 2: 'Z96.611'
[20:40:21] ℹ️    - Diagnosis 3: 'G89.4'
[20:40:21] ℹ️    - Diagnosis 4: 'M54.50'
[20:40:21] ℹ️    - Diagnosis 5: 'C61'
[20:40:21] ℹ️    - Diagnosis 6: 'N40.1'
[20:40:21] ℹ️  Final extracted MRN: '6047015'
[20:40:21] ℹ️  Final extracted Sex: 'MALE'
[20:40:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT'
[20:40:21] ℹ️  Final extracted Payer Source: ''
[20:40:21] ✅ Patient data extraction completed successfully
[20:40:21] ✅    ✅ Patient data extracted successfully
[20:40:21] 📊 Patient Response
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'C61', 'sixthDiagnosis': 'N40.1'}]
[20:40:21] ✅    ✅ Patient identified: Keith Boling
[20:40:21] ✅    ✅ Patient name validation passed
[20:40:21] 🔄 
🔄 Step 3: Processing patient dates...
[20:40:21] [DOC: 9208311] ℹ️  DOB normalized: 04/09/1950
[20:40:21] [DOC: 9208311] ℹ️  Episode startOfCare normalized: 03/14/2025
[20:40:21] [DOC: 9208311] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[20:40:21] [DOC: 9208311] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[20:40:21] [DOC: 9208311] ✅ Patient date processing completed successfully
[20:40:21] ✅    ✅ Date processing completed
[20:40:21] 📊 Processed Patient Data
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'C61', 'sixthDiagnosis': 'N40.1'}]
[20:40:21] 🔄 
🔄 Step 4: Extracting order data...
[20:40:24] ℹ️  Order extraction - MRN: '6047015'
[20:40:24] ℹ️  Order extraction - Sex: 'MALE'
[20:40:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing,OT'
[20:40:24] ℹ️  Order extraction - Payer Source: ''
[20:40:24] ✅ Order data extraction completed successfully
[20:40:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:40:24] ℹ️  Using MRN from patient data: '6047015' over '6047015'
[20:40:24] ℹ️  Combined service lines: Patient='Skilled Nursing, OT' + Order='Skilled Nursing,OT' = 'OT, Skilled Nursing'
[20:40:24] ✅ Patient name cross-validation successful
[20:40:24] ✅    ✅ Data merged successfully
[20:40:25] ✅    ✅ Order data extracted and validated
[20:40:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:40:25] [DOC: 9208311] ✅ Patient found in local cache: Keith Boling, ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[20:40:25] ✅    ✅ Existing patient found with ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[20:40:25] 🔄 
🔄 Step 6: Pushing order to API...
[20:40:25] [DOC: 9208311] ℹ️  Pushing order via API for patient ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[20:40:26] [DOC: 9208311] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:40:26] ❌    ❌ Failed to push order
[20:40:26] 🔄 
🔄 Step 7: Writing to CSV...
[20:40:26] [DOC: 9208311] ℹ️  Calculated age: 75 from DOB: 04/09/1950
[20:40:26] [DOC: 9208311] ℹ️  Service Line extracted: 'OT, Skilled Nursing'
[20:40:26] [DOC: 9208311] ℹ️  Payer Source extracted: ''
[20:40:26] [DOC: 9208311] ℹ️  Diagnosis codes being written:
[20:40:26] [DOC: 9208311] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[20:40:26] [DOC: 9208311] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.611'
[20:40:26] [DOC: 9208311] ℹ️    - Latest_Episode_Thirddiagnosis: 'G89.4'
[20:40:26] [DOC: 9208311] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.50'
[20:40:26] [DOC: 9208311] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C61'
[20:40:26] [DOC: 9208311] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[20:40:26] [DOC: 9208311] ✅ Patient data written to CSV: Keith Boling | Sex: MALE | Age: 75 | Service: OT, Skilled Nursing | Payer:  | MRN: 6047015
[20:40:26] ✅    ✅ Document 9208311 processed and saved successfully
[20:40:26] 🔄 
🔄 Step 8: Saving API details...
[20:40:26] [DOC: 9208311] ℹ️  API push details saved for document 9208311
[20:40:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208308                         ║
================================================================================
[20:40:26] ℹ️  Agency: Dartmouth HH
[20:40:26] ℹ️  Date: 03/28/2025
[20:40:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:40:29] [DOC: 9208308] ✅ Text extracted using pdfplumber (7102 chars)
[20:40:29] ✅    ✅ Text extracted using pdfplumber (7102 chars)
[20:40:29] 🔄 
🔄 Step 2: Extracting patient data...
[20:40:32] ℹ️  AI extracted raw sex value: 'F'
[20:40:32] ℹ️  AI extracted service line: 'OT'
[20:40:32] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[20:40:32] ℹ️  AI extracted diagnoses:
[20:40:32] ℹ️    - Diagnosis 1: 'None'
[20:40:32] ℹ️    - Diagnosis 2: 'None'
[20:40:32] ℹ️    - Diagnosis 3: 'None'
[20:40:32] ℹ️    - Diagnosis 4: 'None'
[20:40:32] ℹ️    - Diagnosis 5: 'None'
[20:40:32] ℹ️    - Diagnosis 6: 'None'
[20:40:32] ℹ️  Final extracted MRN: '5843015'
[20:40:32] ℹ️  Final extracted Sex: 'FEMALE'
[20:40:32] ℹ️  Final extracted Service Line: 'OT'
[20:40:32] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[20:40:32] ✅ Patient data extraction completed successfully
[20:40:32] ✅    ✅ Patient data extracted successfully
[20:40:32] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '03/15/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:40:32] ✅    ✅ Patient identified: Joanne Medeiros
[20:40:32] ✅    ✅ Patient name validation passed
[20:40:32] 🔄 
🔄 Step 3: Processing patient dates...
[20:40:32] [DOC: 9208308] ℹ️  DOB normalized: 12/09/1952
[20:40:32] [DOC: 9208308] ℹ️  Episode startOfCare normalized: 01/15/2025
[20:40:32] [DOC: 9208308] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[20:40:32] [DOC: 9208308] ℹ️  Episode endOfEpisode normalized: 03/15/2025
[20:40:32] [DOC: 9208308] ✅ Patient date processing completed successfully
[20:40:32] ✅    ✅ Date processing completed
[20:40:32] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '03/15/2025'}]
[20:40:32] 🔄 
🔄 Step 4: Extracting order data...
[20:40:35] ℹ️  Order extraction - MRN: '5843015'
[20:40:35] ℹ️  Order extraction - Sex: 'FEMALE'
[20:40:35] ℹ️  Order extraction - Service Line: 'OT'
[20:40:35] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[20:40:35] ✅ Order data extraction completed successfully
[20:40:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:40:35] ℹ️  Using MRN from patient data: '5843015' over '5843015'
[20:40:35] ℹ️  Service line consistent in both sources: 'OT'
[20:40:35] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[20:40:35] ✅ Patient name cross-validation successful
[20:40:35] ✅    ✅ Data merged successfully
[20:40:36] ✅    ✅ Order data extracted and validated
[20:40:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:41:11] [DOC: 9208308] ℹ️  Patient not found in cache or API: Joanne Medeiros
[20:41:11] [DOC: 9208308] ℹ️  Patient not found, creating new patient via API...
[20:41:11] [DOC: 9208308] ℹ️  Creating patient via API: Joanne Medeiros
[20:41:13] [DOC: 9208308] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:41:13] ❌    ❌ Failed to create patient
[20:41:13] [DOC: 9208308] ℹ️  API push details saved for document 9208308
================================================================================
║                        Processing Document ID: 9208306                         ║
================================================================================
[20:41:13] ℹ️  Agency: Dartmouth HH
[20:41:13] ℹ️  Date: 03/28/2025
[20:41:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:41:16] [DOC: 9208306] ✅ Text extracted using pdfplumber (8159 chars)
[20:41:16] ✅    ✅ Text extracted using pdfplumber (8147 chars)
[20:41:16] 🔄 
🔄 Step 2: Extracting patient data...
[20:41:19] ℹ️  AI extracted raw sex value: 'M'
[20:41:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:41:19] ℹ️  AI extracted payer source: ''
[20:41:19] ℹ️  AI extracted diagnoses:
[20:41:19] ℹ️    - Diagnosis 1: 'I11.0'
[20:41:19] ℹ️    - Diagnosis 2: 'I50.9'
[20:41:19] ℹ️    - Diagnosis 3: 'M47.896'
[20:41:19] ℹ️    - Diagnosis 4: 'I48.91'
[20:41:19] ℹ️    - Diagnosis 5: 'K21.9'
[20:41:19] ℹ️    - Diagnosis 6: 'E78.5'
[20:41:19] ℹ️  Final extracted MRN: '227027'
[20:41:19] ℹ️  Final extracted Sex: 'MALE'
[20:41:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:41:19] ℹ️  Final extracted Payer Source: ''
[20:41:19] ✅ Patient data extraction completed successfully
[20:41:19] ✅    ✅ Patient data extracted successfully
[20:41:19] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'M47.896', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'E78.5'}]
[20:41:19] ✅    ✅ Patient identified: John Ostapow
[20:41:19] ✅    ✅ Patient name validation passed
[20:41:19] 🔄 
🔄 Step 3: Processing patient dates...
[20:41:19] [DOC: 9208306] ℹ️  DOB normalized: 11/23/1935
[20:41:19] [DOC: 9208306] ℹ️  Episode startOfCare normalized: 03/12/2025
[20:41:19] [DOC: 9208306] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[20:41:19] [DOC: 9208306] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[20:41:19] [DOC: 9208306] ✅ Patient date processing completed successfully
[20:41:19] ✅    ✅ Date processing completed
[20:41:19] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'M47.896', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'E78.5'}]
[20:41:19] 🔄 
🔄 Step 4: Extracting order data...
[20:41:21] ℹ️  Order extraction - MRN: '6190015'
[20:41:21] ℹ️  Order extraction - Sex: 'MALE'
[20:41:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:41:21] ℹ️  Order extraction - Payer Source: ''
[20:41:21] ✅ Order data extraction completed successfully
[20:41:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:41:21] ℹ️  Using longer MRN from order data: '6190015' over '227027'
[20:41:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:41:21] ✅ Patient name cross-validation successful
[20:41:21] ✅    ✅ Data merged successfully
[20:41:23] ✅    ✅ Order data extracted and validated
[20:41:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:41:23] [DOC: 9208306] ✅ Patient found in local cache: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[20:41:23] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[20:41:23] 🔄 
🔄 Step 6: Pushing order to API...
[20:41:23] [DOC: 9208306] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[20:41:24] [DOC: 9208306] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:41:24] ❌    ❌ Failed to push order
[20:41:24] 🔄 
🔄 Step 7: Writing to CSV...
[20:41:24] [DOC: 9208306] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[20:41:24] [DOC: 9208306] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:41:24] [DOC: 9208306] ℹ️  Payer Source extracted: ''
[20:41:24] [DOC: 9208306] ℹ️  Diagnosis codes being written:
[20:41:24] [DOC: 9208306] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[20:41:24] [DOC: 9208306] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[20:41:24] [DOC: 9208306] ℹ️    - Latest_Episode_Thirddiagnosis: 'M47.896'
[20:41:24] [DOC: 9208306] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.91'
[20:41:24] [DOC: 9208306] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K21.9'
[20:41:24] [DOC: 9208306] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[20:41:24] [DOC: 9208306] ✅ Patient data written to CSV: John Ostapow | Sex: MALE | Age: 89 | Service: Skilled Nursing | Payer:  | MRN: 6190015
[20:41:24] ✅    ✅ Document 9208306 processed and saved successfully
[20:41:24] 🔄 
🔄 Step 8: Saving API details...
[20:41:24] [DOC: 9208306] ℹ️  API push details saved for document 9208306
[20:41:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208299                         ║
================================================================================
[20:41:24] ℹ️  Agency: Fairhaven HH&H
[20:41:24] ℹ️  Date: 03/28/2025
[20:41:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:41:27] [DOC: 9208299] ✅ Text extracted using pdfplumber (1488 chars)
[20:41:27] ✅    ✅ Text extracted using pdfplumber (1488 chars)
[20:41:27] 🔄 
🔄 Step 2: Extracting patient data...
[20:41:29] ℹ️  AI extracted raw sex value: 'F'
[20:41:29] ℹ️  AI extracted service line: 'HHA'
[20:41:29] ℹ️  AI extracted payer source: 'Medicare'
[20:41:29] ℹ️  AI extracted diagnoses:
[20:41:29] ℹ️    - Diagnosis 1: 'None'
[20:41:29] ℹ️    - Diagnosis 2: 'None'
[20:41:29] ℹ️    - Diagnosis 3: 'None'
[20:41:29] ℹ️    - Diagnosis 4: 'None'
[20:41:29] ℹ️    - Diagnosis 5: 'None'
[20:41:29] ℹ️    - Diagnosis 6: 'None'
[20:41:29] ℹ️  Final extracted MRN: '3122001'
[20:41:29] ℹ️  Final extracted Sex: 'FEMALE'
[20:41:29] ℹ️  Final extracted Service Line: 'HHA'
[20:41:29] ℹ️  Final extracted Payer Source: 'Medicare'
[20:41:29] ✅ Patient data extraction completed successfully
[20:41:29] ✅    ✅ Patient data extracted successfully
[20:41:29] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Luckraft
     └─ dob: 01/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3122001
     └─ billingProvider: ACO Health Solutions
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:41:29] ✅    ✅ Patient identified: Louise Luckraft
[20:41:29] ✅    ✅ Patient name validation passed
[20:41:29] 🔄 
🔄 Step 3: Processing patient dates...
[20:41:29] [DOC: 9208299] ℹ️  DOB normalized: 01/15/1935
[20:41:29] [DOC: 9208299] ℹ️  Episode startOfCare normalized: 01/09/2025
[20:41:29] [DOC: 9208299] ℹ️  Episode startOfEpisode normalized: 01/09/2025
[20:41:29] [DOC: 9208299] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[20:41:29] [DOC: 9208299] ✅ Patient date processing completed successfully
[20:41:29] ✅    ✅ Date processing completed
[20:41:29] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Luckraft
     └─ dob: 01/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3122001
     └─ billingProvider: ACO Health Solutions
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '04/08/2025'}]
[20:41:29] 🔄 
🔄 Step 4: Extracting order data...
[20:41:32] ℹ️  Order extraction - MRN: ''
[20:41:32] ℹ️  Order extraction - Sex: 'FEMALE'
[20:41:32] ℹ️  Order extraction - Service Line: ''
[20:41:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:41:32] ✅ Order data extraction completed successfully
[20:41:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:41:32] ℹ️  Using MRN from patient data: '3122001'
[20:41:32] ℹ️  Using service line from patient data: 'HHA'
[20:41:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:41:32] ✅ Patient name cross-validation successful
[20:41:32] ✅    ✅ Data merged successfully
[20:41:33] ✅    ✅ Order data extracted and validated
[20:41:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:41:33] [DOC: 9208299] ✅ Patient found in local cache: Louise Luckraft, ID: e9d728ed-4871-45e2-9dee-a509a1e1f38e
[20:41:33] ✅    ✅ Existing patient found with ID: e9d728ed-4871-45e2-9dee-a509a1e1f38e
[20:41:33] 🔄 
🔄 Step 6: Pushing order to API...
[20:41:33] [DOC: 9208299] ℹ️  Pushing order via API for patient ID: e9d728ed-4871-45e2-9dee-a509a1e1f38e
[20:41:34] [DOC: 9208299] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:41:34] ❌    ❌ Failed to push order
[20:41:34] 🔄 
🔄 Step 7: Writing to CSV...
[20:41:34] [DOC: 9208299] ℹ️  Calculated age: 90 from DOB: 01/15/1935
[20:41:34] [DOC: 9208299] ℹ️  Service Line extracted: 'HHA'
[20:41:34] [DOC: 9208299] ℹ️  Payer Source extracted: 'Medicare'
[20:41:34] [DOC: 9208299] ℹ️  Diagnosis codes being written:
[20:41:34] [DOC: 9208299] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:41:34] [DOC: 9208299] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:41:34] [DOC: 9208299] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:41:34] [DOC: 9208299] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:41:34] [DOC: 9208299] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:41:34] [DOC: 9208299] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:41:34] [DOC: 9208299] ✅ Patient data written to CSV: Louise Luckraft | Sex: FEMALE | Age: 90 | Service: HHA | Payer: Medicare | MRN: 3122001
[20:41:34] ✅    ✅ Document 9208299 processed and saved successfully
[20:41:34] 🔄 
🔄 Step 8: Saving API details...
[20:41:34] [DOC: 9208299] ℹ️  API push details saved for document 9208299
[20:41:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208298                         ║
================================================================================
[20:41:34] ℹ️  Agency: Fairhaven HH&H
[20:41:34] ℹ️  Date: 03/28/2025
[20:41:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:41:37] [DOC: 9208298] ✅ Text extracted using pdfplumber (3027 chars)
[20:41:37] ✅    ✅ Text extracted using pdfplumber (3027 chars)
[20:41:37] 🔄 
🔄 Step 2: Extracting patient data...
[20:41:40] ℹ️  AI extracted raw sex value: 'F'
[20:41:40] ℹ️  AI extracted service line: 'HHA'
[20:41:40] ℹ️  AI extracted payer source: 'Medicare'
[20:41:40] ℹ️  AI extracted diagnoses:
[20:41:40] ℹ️    - Diagnosis 1: 'CHF'
[20:41:40] ℹ️    - Diagnosis 2: 'arthritis'
[20:41:40] ℹ️    - Diagnosis 3: 'breast Ca w/ mastectomy'
[20:41:40] ℹ️    - Diagnosis 4: 'osteoporosis'
[20:41:40] ℹ️    - Diagnosis 5: 'anemia'
[20:41:40] ℹ️    - Diagnosis 6: 'a-fib'
[20:41:40] ℹ️  Final extracted MRN: '3156011'
[20:41:40] ℹ️  Final extracted Sex: 'FEMALE'
[20:41:40] ℹ️  Final extracted Service Line: 'HHA'
[20:41:40] ℹ️  Final extracted Payer Source: 'Medicare'
[20:41:40] ✅ Patient data extraction completed successfully
[20:41:40] ✅    ✅ Patient data extracted successfully
[20:41:40] 📊 Patient Response
     └─ patientFName: Rose
     └─ patientLName: Gouveia
     └─ dob: 03/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3156011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'arthritis', 'thirdDiagnosis': 'breast Ca w/ mastectomy', 'fourthDiagnosis': 'osteoporosis', 'fifthDiagnosis': 'anemia', 'sixthDiagnosis': 'a-fib'}]
[20:41:40] ✅    ✅ Patient identified: Rose Gouveia
[20:41:40] ✅    ✅ Patient name validation passed
[20:41:40] 🔄 
🔄 Step 3: Processing patient dates...
[20:41:40] [DOC: 9208298] ℹ️  DOB normalized: 03/06/1931
[20:41:40] [DOC: 9208298] ℹ️  Episode startOfCare normalized: 05/28/2024
[20:41:40] [DOC: 9208298] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[20:41:40] [DOC: 9208298] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[20:41:40] [DOC: 9208298] ✅ Patient date processing completed successfully
[20:41:40] ✅    ✅ Date processing completed
[20:41:40] 📊 Processed Patient Data
     └─ patientFName: Rose
     └─ patientLName: Gouveia
     └─ dob: 03/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3156011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'arthritis', 'thirdDiagnosis': 'breast Ca w/ mastectomy', 'fourthDiagnosis': 'osteoporosis', 'fifthDiagnosis': 'anemia', 'sixthDiagnosis': 'a-fib'}]
[20:41:40] 🔄 
🔄 Step 4: Extracting order data...
[20:41:42] ℹ️  Order extraction - MRN: ''
[20:41:42] ℹ️  Order extraction - Sex: 'FEMALE'
[20:41:42] ℹ️  Order extraction - Service Line: 'RN'
[20:41:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:41:42] ✅ Order data extraction completed successfully
[20:41:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:41:42] ℹ️  Using MRN from patient data: '3156011'
[20:41:42] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[20:41:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:41:42] ✅ Patient name cross-validation successful
[20:41:42] ✅    ✅ Data merged successfully
[20:41:44] ✅    ✅ Order data extracted and validated
[20:41:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:41:44] [DOC: 9208298] ✅ Patient found in local cache: Rose Gouveia, ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[20:41:44] ✅    ✅ Existing patient found with ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[20:41:44] 🔄 
🔄 Step 6: Pushing order to API...
[20:41:44] [DOC: 9208298] ℹ️  Pushing order via API for patient ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[20:41:45] [DOC: 9208298] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:41:45] ❌    ❌ Failed to push order
[20:41:45] 🔄 
🔄 Step 7: Writing to CSV...
[20:41:45] [DOC: 9208298] ℹ️  Calculated age: 94 from DOB: 03/06/1931
[20:41:45] [DOC: 9208298] ℹ️  Service Line extracted: 'HHA, RN'
[20:41:45] [DOC: 9208298] ℹ️  Payer Source extracted: 'Medicare'
[20:41:45] [DOC: 9208298] ℹ️  Diagnosis codes being written:
[20:41:45] [DOC: 9208298] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[20:41:45] [DOC: 9208298] ℹ️    - Latest_Episode_Seconddiagnosis: 'arthritis'
[20:41:45] [DOC: 9208298] ℹ️    - Latest_Episode_Thirddiagnosis: 'breast Ca w/ mastectomy'
[20:41:45] [DOC: 9208298] ℹ️    - Latest_Episode_Fourthdiagnosis: 'osteoporosis'
[20:41:45] [DOC: 9208298] ℹ️    - Latest_Episode_Fifthdiagnosis: 'anemia'
[20:41:45] [DOC: 9208298] ℹ️    - Latest_Episode_Sixthdiagnosis: 'a-fib'
[20:41:45] [DOC: 9208298] ✅ Patient data written to CSV: Rose Gouveia | Sex: FEMALE | Age: 94 | Service: HHA, RN | Payer: Medicare | MRN: 3156011
[20:41:45] ✅    ✅ Document 9208298 processed and saved successfully
[20:41:45] 🔄 
🔄 Step 8: Saving API details...
[20:41:45] [DOC: 9208298] ℹ️  API push details saved for document 9208298
[20:41:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208296                         ║
================================================================================
[20:41:45] ℹ️  Agency: Fairhaven HH&H
[20:41:45] ℹ️  Date: 03/28/2025
[20:41:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:41:47] [DOC: 9208296] ✅ Text extracted using pdfplumber (1073 chars)
[20:41:47] ✅    ✅ Text extracted using pdfplumber (1073 chars)
[20:41:47] 🔄 
🔄 Step 2: Extracting patient data...
[20:41:50] ℹ️  AI extracted raw sex value: 'M'
[20:41:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:41:50] ℹ️  AI extracted payer source: 'Medicare'
[20:41:50] ℹ️  AI extracted diagnoses:
[20:41:50] ℹ️    - Diagnosis 1: ''
[20:41:50] ℹ️    - Diagnosis 2: ''
[20:41:50] ℹ️    - Diagnosis 3: ''
[20:41:50] ℹ️    - Diagnosis 4: ''
[20:41:50] ℹ️    - Diagnosis 5: ''
[20:41:50] ℹ️    - Diagnosis 6: ''
[20:41:50] ℹ️  Final extracted MRN: '2486002'
[20:41:50] ℹ️  Final extracted Sex: 'MALE'
[20:41:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:41:50] ℹ️  Final extracted Payer Source: 'Medicare'
[20:41:50] ✅ Patient data extraction completed successfully
[20:41:50] ✅    ✅ Patient data extracted successfully
[20:41:50] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Andrade
     └─ dob: 06/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2486002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:41:50] ✅    ✅ Patient identified: Robert Andrade
[20:41:50] ✅    ✅ Patient name validation passed
[20:41:50] 🔄 
🔄 Step 3: Processing patient dates...
[20:41:50] [DOC: 9208296] ℹ️  DOB normalized: 06/25/1943
[20:41:50] [DOC: 9208296] ℹ️  Episode startOfCare normalized: 12/19/2024
[20:41:50] [DOC: 9208296] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[20:41:50] [DOC: 9208296] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[20:41:50] [DOC: 9208296] ✅ Patient date processing completed successfully
[20:41:50] ✅    ✅ Date processing completed
[20:41:50] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Andrade
     └─ dob: 06/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2486002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:41:50] 🔄 
🔄 Step 4: Extracting order data...
[20:41:53] ℹ️  Order extraction - MRN: ''
[20:41:53] ℹ️  Order extraction - Sex: 'MALE'
[20:41:53] ℹ️  Order extraction - Service Line: 'RN'
[20:41:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:41:53] ✅ Order data extraction completed successfully
[20:41:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:41:53] ℹ️  Using MRN from patient data: '2486002'
[20:41:53] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[20:41:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:41:53] ✅ Patient name cross-validation successful
[20:41:53] ✅    ✅ Data merged successfully
[20:41:54] ✅    ✅ Order data extracted and validated
[20:41:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:41:54] [DOC: 9208296] ✅ Patient found in local cache: Robert Andrade, ID: e367e440-5660-423f-9c06-de94c71235ec
[20:41:54] ✅    ✅ Existing patient found with ID: e367e440-5660-423f-9c06-de94c71235ec
[20:41:54] 🔄 
🔄 Step 6: Pushing order to API...
[20:41:54] [DOC: 9208296] ℹ️  Pushing order via API for patient ID: e367e440-5660-423f-9c06-de94c71235ec
[20:41:55] [DOC: 9208296] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:41:55] ❌    ❌ Failed to push order
[20:41:55] 🔄 
🔄 Step 7: Writing to CSV...
[20:41:55] [DOC: 9208296] ℹ️  Calculated age: 81 from DOB: 06/25/1943
[20:41:55] [DOC: 9208296] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[20:41:55] [DOC: 9208296] ℹ️  Payer Source extracted: 'Medicare'
[20:41:55] [DOC: 9208296] ℹ️  Diagnosis codes being written:
[20:41:55] [DOC: 9208296] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:41:55] [DOC: 9208296] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:41:55] [DOC: 9208296] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:41:55] [DOC: 9208296] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:41:55] [DOC: 9208296] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:41:55] [DOC: 9208296] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:41:55] [DOC: 9208296] ✅ Patient data written to CSV: Robert Andrade | Sex: MALE | Age: 81 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 2486002
[20:41:55] ✅    ✅ Document 9208296 processed and saved successfully
[20:41:55] 🔄 
🔄 Step 8: Saving API details...
[20:41:55] [DOC: 9208296] ℹ️  API push details saved for document 9208296
[20:41:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208268                         ║
================================================================================
[20:41:55] ℹ️  Agency: Fairhaven HH&H
[20:41:55] ℹ️  Date: 03/28/2025
[20:41:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:41:58] [DOC: 9208268] ✅ Text extracted using pdfplumber (5799 chars)
[20:41:58] ✅    ✅ Text extracted using pdfplumber (5799 chars)
[20:41:58] 🔄 
🔄 Step 2: Extracting patient data...
[20:42:01] ℹ️  AI extracted raw sex value: 'F'
[20:42:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:42:01] ℹ️  AI extracted payer source: 'Medicare'
[20:42:01] ℹ️  AI extracted diagnoses:
[20:42:01] ℹ️    - Diagnosis 1: 'None'
[20:42:01] ℹ️    - Diagnosis 2: 'None'
[20:42:01] ℹ️    - Diagnosis 3: 'None'
[20:42:01] ℹ️    - Diagnosis 4: 'None'
[20:42:01] ℹ️    - Diagnosis 5: 'None'
[20:42:01] ℹ️    - Diagnosis 6: 'None'
[20:42:01] ℹ️  Final extracted MRN: '5350011'
[20:42:01] ℹ️  Final extracted Sex: 'FEMALE'
[20:42:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:42:01] ℹ️  Final extracted Payer Source: 'Medicare'
[20:42:01] ✅ Patient data extraction completed successfully
[20:42:01] ✅    ✅ Patient data extracted successfully
[20:42:01] 📊 Patient Response
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:42:01] ✅    ✅ Patient identified: Rosemary Crompton
[20:42:01] ✅    ✅ Patient name validation passed
[20:42:01] 🔄 
🔄 Step 3: Processing patient dates...
[20:42:01] [DOC: 9208268] ℹ️  DOB normalized: 08/17/1944
[20:42:01] [DOC: 9208268] ℹ️  Episode startOfCare normalized: 12/02/2023
[20:42:01] [DOC: 9208268] ℹ️  Episode startOfEpisode normalized: 01/25/2025
[20:42:01] [DOC: 9208268] ℹ️  Episode endOfEpisode normalized: 03/25/2025
[20:42:01] [DOC: 9208268] ✅ Patient date processing completed successfully
[20:42:01] ✅    ✅ Date processing completed
[20:42:01] 📊 Processed Patient Data
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025'}]
[20:42:01] 🔄 
🔄 Step 4: Extracting order data...
[20:42:04] ℹ️  Order extraction - MRN: ''
[20:42:04] ℹ️  Order extraction - Sex: 'FEMALE'
[20:42:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:42:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:42:04] ✅ Order data extraction completed successfully
[20:42:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:42:04] ℹ️  Using MRN from patient data: '5350011'
[20:42:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:42:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:42:04] ✅ Patient name cross-validation successful
[20:42:04] ✅    ✅ Data merged successfully
[20:42:05] ✅    ✅ Order data extracted and validated
[20:42:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:42:05] [DOC: 9208268] ✅ Patient found in local cache: Rosemary Crompton, ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[20:42:05] ✅    ✅ Existing patient found with ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[20:42:05] 🔄 
🔄 Step 6: Pushing order to API...
[20:42:05] [DOC: 9208268] ℹ️  Pushing order via API for patient ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[20:42:06] [DOC: 9208268] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:42:06] ❌    ❌ Failed to push order
[20:42:06] 🔄 
🔄 Step 7: Writing to CSV...
[20:42:06] [DOC: 9208268] ℹ️  Calculated age: 80 from DOB: 08/17/1944
[20:42:06] [DOC: 9208268] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:42:06] [DOC: 9208268] ℹ️  Payer Source extracted: 'Medicare'
[20:42:06] [DOC: 9208268] ℹ️  Diagnosis codes being written:
[20:42:06] [DOC: 9208268] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:42:06] [DOC: 9208268] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:42:06] [DOC: 9208268] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:42:06] [DOC: 9208268] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:42:06] [DOC: 9208268] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:42:06] [DOC: 9208268] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:42:06] [DOC: 9208268] ✅ Patient data written to CSV: Rosemary Crompton | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 5350011
[20:42:06] ✅    ✅ Document 9208268 processed and saved successfully
[20:42:06] 🔄 
🔄 Step 8: Saving API details...
[20:42:06] [DOC: 9208268] ℹ️  API push details saved for document 9208268
[20:42:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208266                         ║
================================================================================
[20:42:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:42:06] ℹ️  Date: 03/28/2025
[20:42:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:42:08] [DOC: 9208266] ✅ Text extracted using pdfplumber (1006 chars)
[20:42:08] ✅    ✅ Text extracted using pdfplumber (1006 chars)
[20:42:08] 🔄 
🔄 Step 2: Extracting patient data...
[20:42:11] ℹ️  AI extracted raw sex value: 'F'
[20:42:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:42:11] ℹ️  AI extracted payer source: ''
[20:42:11] ℹ️  AI extracted diagnoses:
[20:42:11] ℹ️    - Diagnosis 1: ''
[20:42:11] ℹ️    - Diagnosis 2: ''
[20:42:11] ℹ️    - Diagnosis 3: ''
[20:42:11] ℹ️    - Diagnosis 4: ''
[20:42:11] ℹ️    - Diagnosis 5: ''
[20:42:11] ℹ️    - Diagnosis 6: ''
[20:42:11] ℹ️  Final extracted MRN: '2121459'
[20:42:11] ℹ️  Final extracted Sex: 'FEMALE'
[20:42:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:42:11] ℹ️  Final extracted Payer Source: ''
[20:42:11] ✅ Patient data extraction completed successfully
[20:42:11] ✅    ✅ Patient data extracted successfully
[20:42:11] 📊 Patient Response
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:42:11] ✅    ✅ Patient identified: Anita Rodrigues
[20:42:11] ✅    ✅ Patient name validation passed
[20:42:11] 🔄 
🔄 Step 3: Processing patient dates...
[20:42:11] [DOC: 9208266] ℹ️  DOB normalized: 09/12/1942
[20:42:11] [DOC: 9208266] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[20:42:11] [DOC: 9208266] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[20:42:11] [DOC: 9208266] ✅ Patient date processing completed successfully
[20:42:11] ✅    ✅ Date processing completed
[20:42:11] 📊 Processed Patient Data
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:42:11] 🔄 
🔄 Step 4: Extracting order data...
[20:42:13] ℹ️  Order extraction - MRN: '2121459'
[20:42:13] ℹ️  Order extraction - Sex: 'FEMALE'
[20:42:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:42:13] ℹ️  Order extraction - Payer Source: ''
[20:42:13] ✅ Order data extraction completed successfully
[20:42:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:42:13] ℹ️  Using MRN from patient data: '2121459' over '2121459'
[20:42:13] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:42:13] ✅ Patient name cross-validation successful
[20:42:13] ✅    ✅ Data merged successfully
[20:42:14] ✅    ✅ Order data extracted and validated
[20:42:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:42:39] [DOC: 9208266] ℹ️  Patient not found in cache or API: Anita Rodrigues
[20:42:39] [DOC: 9208266] ℹ️  Patient not found, creating new patient via API...
[20:42:39] [DOC: 9208266] ℹ️  Creating patient via API: Anita Rodrigues
[20:42:41] [DOC: 9208266] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:42:41] ❌    ❌ Failed to create patient
[20:42:41] [DOC: 9208266] ℹ️  API push details saved for document 9208266
================================================================================
║                        Processing Document ID: 9208263                         ║
================================================================================
[20:42:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:42:41] ℹ️  Date: 03/28/2025
[20:42:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:42:43] [DOC: 9208263] ✅ Text extracted using pdfplumber (1342 chars)
[20:42:43] ✅    ✅ Text extracted using pdfplumber (1342 chars)
[20:42:43] 🔄 
🔄 Step 2: Extracting patient data...
[20:42:45] ℹ️  AI extracted raw sex value: 'M'
[20:42:45] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[20:42:45] ℹ️  AI extracted payer source: ''
[20:42:45] ℹ️  AI extracted diagnoses:
[20:42:45] ℹ️    - Diagnosis 1: 'None'
[20:42:45] ℹ️    - Diagnosis 2: 'None'
[20:42:45] ℹ️    - Diagnosis 3: 'None'
[20:42:45] ℹ️    - Diagnosis 4: 'None'
[20:42:45] ℹ️    - Diagnosis 5: 'None'
[20:42:45] ℹ️    - Diagnosis 6: 'None'
[20:42:45] ℹ️  Final extracted MRN: '2060640'
[20:42:45] ℹ️  Final extracted Sex: 'MALE'
[20:42:45] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[20:42:45] ℹ️  Final extracted Payer Source: ''
[20:42:45] ✅ Patient data extraction completed successfully
[20:42:45] ✅    ✅ Patient data extracted successfully
[20:42:45] 📊 Patient Response
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:42:45] ✅    ✅ Patient identified: Elisio Pimental
[20:42:45] ✅    ✅ Patient name validation passed
[20:42:45] 🔄 
🔄 Step 3: Processing patient dates...
[20:42:45] [DOC: 9208263] ℹ️  DOB normalized: 05/17/1944
[20:42:45] [DOC: 9208263] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[20:42:45] [DOC: 9208263] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[20:42:45] [DOC: 9208263] ✅ Patient date processing completed successfully
[20:42:45] ✅    ✅ Date processing completed
[20:42:45] 📊 Processed Patient Data
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025'}]
[20:42:45] 🔄 
🔄 Step 4: Extracting order data...
[20:42:48] ℹ️  Order extraction - MRN: '2060640'
[20:42:48] ℹ️  Order extraction - Sex: 'MALE'
[20:42:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[20:42:48] ℹ️  Order extraction - Payer Source: ''
[20:42:48] ✅ Order data extraction completed successfully
[20:42:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:42:48] ℹ️  Using MRN from patient data: '2060640' over '2060640'
[20:42:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[20:42:48] ✅ Patient name cross-validation successful
[20:42:48] ✅    ✅ Data merged successfully
[20:42:49] ✅    ✅ Order data extracted and validated
[20:42:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:42:49] [DOC: 9208263] ✅ Patient found in local cache: Elisio Pimental, ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[20:42:49] ✅    ✅ Existing patient found with ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[20:42:49] 🔄 
🔄 Step 6: Pushing order to API...
[20:42:49] [DOC: 9208263] ℹ️  Pushing order via API for patient ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[20:42:51] [DOC: 9208263] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20073"}
[20:42:51] ❌    ❌ Failed to push order
[20:42:51] 🔄 
🔄 Step 7: Writing to CSV...
[20:42:51] [DOC: 9208263] ℹ️  Calculated age: 81 from DOB: 05/17/1944
[20:42:51] [DOC: 9208263] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[20:42:51] [DOC: 9208263] ℹ️  Payer Source extracted: ''
[20:42:51] [DOC: 9208263] ℹ️  Diagnosis codes being written:
[20:42:51] [DOC: 9208263] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:42:51] [DOC: 9208263] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:42:51] [DOC: 9208263] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:42:51] [DOC: 9208263] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:42:51] [DOC: 9208263] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:42:51] [DOC: 9208263] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:42:51] [DOC: 9208263] ✅ Patient data written to CSV: Elisio Pimental | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2060640
[20:42:51] ✅    ✅ Document 9208263 processed and saved successfully
[20:42:51] 🔄 
🔄 Step 8: Saving API details...
[20:42:51] [DOC: 9208263] ℹ️  API push details saved for document 9208263
[20:42:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208257                         ║
================================================================================
[20:42:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:42:51] ℹ️  Date: 03/28/2025
[20:42:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:42:52] [DOC: 9208257] ✅ Text extracted using pdfplumber (956 chars)
[20:42:52] ✅    ✅ Text extracted using pdfplumber (956 chars)
[20:42:52] 🔄 
🔄 Step 2: Extracting patient data...
[20:42:55] ℹ️  AI extracted raw sex value: 'M'
[20:42:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:42:55] ℹ️  AI extracted payer source: ''
[20:42:55] ℹ️  AI extracted diagnoses:
[20:42:55] ℹ️    - Diagnosis 1: ''
[20:42:55] ℹ️    - Diagnosis 2: ''
[20:42:55] ℹ️    - Diagnosis 3: ''
[20:42:55] ℹ️    - Diagnosis 4: ''
[20:42:55] ℹ️    - Diagnosis 5: ''
[20:42:55] ℹ️    - Diagnosis 6: ''
[20:42:55] ℹ️  Final extracted MRN: '2773750'
[20:42:55] ℹ️  Final extracted Sex: 'MALE'
[20:42:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:42:55] ℹ️  Final extracted Payer Source: ''
[20:42:55] ✅ Patient data extraction completed successfully
[20:42:55] ✅    ✅ Patient data extracted successfully
[20:42:55] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:42:55] ✅    ✅ Patient identified: Luis Mota
[20:42:55] ✅    ✅ Patient name validation passed
[20:42:55] 🔄 
🔄 Step 3: Processing patient dates...
[20:42:55] [DOC: 9208257] ℹ️  DOB normalized: 12/02/1942
[20:42:55] [DOC: 9208257] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[20:42:55] [DOC: 9208257] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[20:42:55] [DOC: 9208257] ✅ Patient date processing completed successfully
[20:42:55] ✅    ✅ Date processing completed
[20:42:55] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:42:55] 🔄 
🔄 Step 4: Extracting order data...
[20:42:57] ℹ️  Order extraction - MRN: '2773750'
[20:42:57] ℹ️  Order extraction - Sex: 'MALE'
[20:42:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:42:57] ℹ️  Order extraction - Payer Source: ''
[20:42:57] ✅ Order data extraction completed successfully
[20:42:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:42:57] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[20:42:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:42:57] ✅ Patient name cross-validation successful
[20:42:57] ✅    ✅ Data merged successfully
[20:42:58] ✅    ✅ Order data extracted and validated
[20:42:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:43:33] [DOC: 9208257] ℹ️  Patient not found in cache or API: Luis Mota
[20:43:33] [DOC: 9208257] ℹ️  Patient not found, creating new patient via API...
[20:43:33] [DOC: 9208257] ℹ️  Creating patient via API: Luis Mota
[20:43:34] [DOC: 9208257] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:43:34] ❌    ❌ Failed to create patient
[20:43:34] [DOC: 9208257] ℹ️  API push details saved for document 9208257
================================================================================
║                        Processing Document ID: 9208255                         ║
================================================================================
[20:43:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:43:34] ℹ️  Date: 03/28/2025
[20:43:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:43:36] [DOC: 9208255] ✅ Text extracted using pdfplumber (1288 chars)
[20:43:36] ✅    ✅ Text extracted using pdfplumber (1288 chars)
[20:43:36] 🔄 
🔄 Step 2: Extracting patient data...
[20:43:38] ℹ️  AI extracted raw sex value: 'F'
[20:43:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:43:38] ℹ️  AI extracted payer source: ''
[20:43:38] ℹ️  AI extracted diagnoses:
[20:43:38] ℹ️    - Diagnosis 1: ''
[20:43:38] ℹ️    - Diagnosis 2: ''
[20:43:38] ℹ️    - Diagnosis 3: ''
[20:43:38] ℹ️    - Diagnosis 4: ''
[20:43:38] ℹ️    - Diagnosis 5: ''
[20:43:38] ℹ️    - Diagnosis 6: ''
[20:43:38] ℹ️  Final extracted MRN: '2772565'
[20:43:38] ℹ️  Final extracted Sex: 'FEMALE'
[20:43:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:43:38] ℹ️  Final extracted Payer Source: ''
[20:43:38] ✅ Patient data extraction completed successfully
[20:43:38] ✅    ✅ Patient data extracted successfully
[20:43:38] 📊 Patient Response
     └─ patientFName: Annette
     └─ patientLName: Morton
     └─ dob: 12/08/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2772565
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:43:38] ✅    ✅ Patient identified: Annette Morton
[20:43:38] ✅    ✅ Patient name validation passed
[20:43:38] 🔄 
🔄 Step 3: Processing patient dates...
[20:43:38] [DOC: 9208255] ℹ️  DOB normalized: 12/08/1947
[20:43:38] [DOC: 9208255] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[20:43:38] [DOC: 9208255] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[20:43:38] [DOC: 9208255] ✅ Patient date processing completed successfully
[20:43:38] ✅    ✅ Date processing completed
[20:43:38] 📊 Processed Patient Data
     └─ patientFName: Annette
     └─ patientLName: Morton
     └─ dob: 12/08/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2772565
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:43:38] 🔄 
🔄 Step 4: Extracting order data...
[20:43:40] ℹ️  Order extraction - MRN: '2772565'
[20:43:40] ℹ️  Order extraction - Sex: 'FEMALE'
[20:43:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:43:40] ℹ️  Order extraction - Payer Source: ''
[20:43:40] ✅ Order data extraction completed successfully
[20:43:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:43:40] ℹ️  Using MRN from patient data: '2772565' over '2772565'
[20:43:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:43:40] ✅ Patient name cross-validation successful
[20:43:40] ✅    ✅ Data merged successfully
[20:43:42] ✅    ✅ Order data extracted and validated
[20:43:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:44:07] [DOC: 9208255] ℹ️  Patient not found in cache or API: Annette Morton
[20:44:07] [DOC: 9208255] ℹ️  Patient not found, creating new patient via API...
[20:44:07] [DOC: 9208255] ℹ️  Creating patient via API: Annette Morton
[20:44:08] [DOC: 9208255] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:44:08] ❌    ❌ Failed to create patient
[20:44:08] [DOC: 9208255] ℹ️  API push details saved for document 9208255
================================================================================
║                        Processing Document ID: 9208254                         ║
================================================================================
[20:44:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:44:08] ℹ️  Date: 03/28/2025
[20:44:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:44:10] [DOC: 9208254] ✅ Text extracted using pdfplumber (1058 chars)
[20:44:10] ✅    ✅ Text extracted using pdfplumber (1058 chars)
[20:44:10] 🔄 
🔄 Step 2: Extracting patient data...
[20:44:13] ℹ️  AI extracted raw sex value: 'M'
[20:44:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:44:13] ℹ️  AI extracted payer source: ''
[20:44:13] ℹ️  AI extracted diagnoses:
[20:44:13] ℹ️    - Diagnosis 1: ''
[20:44:13] ℹ️    - Diagnosis 2: ''
[20:44:13] ℹ️    - Diagnosis 3: ''
[20:44:13] ℹ️    - Diagnosis 4: ''
[20:44:13] ℹ️    - Diagnosis 5: ''
[20:44:13] ℹ️    - Diagnosis 6: ''
[20:44:13] ℹ️  Final extracted MRN: '2714441'
[20:44:13] ℹ️  Final extracted Sex: 'MALE'
[20:44:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:44:13] ℹ️  Final extracted Payer Source: ''
[20:44:13] ✅ Patient data extraction completed successfully
[20:44:13] ✅    ✅ Patient data extracted successfully
[20:44:13] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: McCarthy
     └─ dob: 02/04/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2714441
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:44:13] ✅    ✅ Patient identified: Dennis McCarthy
[20:44:13] ✅    ✅ Patient name validation passed
[20:44:13] 🔄 
🔄 Step 3: Processing patient dates...
[20:44:13] [DOC: 9208254] ℹ️  DOB normalized: 02/04/1943
[20:44:13] [DOC: 9208254] ✅ Patient date processing completed successfully
[20:44:13] ✅    ✅ Date processing completed
[20:44:13] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: McCarthy
     └─ dob: 02/04/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2714441
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:44:13] 🔄 
🔄 Step 4: Extracting order data...
[20:44:15] ℹ️  Order extraction - MRN: '2714441'
[20:44:15] ℹ️  Order extraction - Sex: 'MALE'
[20:44:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:44:15] ℹ️  Order extraction - Payer Source: ''
[20:44:15] ✅ Order data extraction completed successfully
[20:44:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:44:15] ℹ️  Using MRN from patient data: '2714441' over '2714441'
[20:44:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:44:15] ✅ Patient name cross-validation successful
[20:44:15] ✅    ✅ Data merged successfully
[20:44:17] ✅    ✅ Order data extracted and validated
[20:44:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:44:52] [DOC: 9208254] ℹ️  Patient not found in cache or API: Dennis McCarthy
[20:44:52] [DOC: 9208254] ℹ️  Patient not found, creating new patient via API...
[20:44:52] [DOC: 9208254] ℹ️  Creating patient via API: Dennis McCarthy
[20:44:54] [DOC: 9208254] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:44:54] ❌    ❌ Failed to create patient
[20:44:54] [DOC: 9208254] ℹ️  API push details saved for document 9208254
================================================================================
║                        Processing Document ID: 9208251                         ║
================================================================================
[20:44:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:44:54] ℹ️  Date: 03/28/2025
[20:44:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:44:55] [DOC: 9208251] ✅ Text extracted using pdfplumber (955 chars)
[20:44:55] ✅    ✅ Text extracted using pdfplumber (955 chars)
[20:44:55] 🔄 
🔄 Step 2: Extracting patient data...
[20:44:57] ℹ️  AI extracted raw sex value: 'M'
[20:44:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:44:57] ℹ️  AI extracted payer source: ''
[20:44:57] ℹ️  AI extracted diagnoses:
[20:44:57] ℹ️    - Diagnosis 1: ''
[20:44:57] ℹ️    - Diagnosis 2: ''
[20:44:57] ℹ️    - Diagnosis 3: ''
[20:44:57] ℹ️    - Diagnosis 4: ''
[20:44:57] ℹ️    - Diagnosis 5: ''
[20:44:57] ℹ️    - Diagnosis 6: ''
[20:44:57] ℹ️  Final extracted MRN: '2063794'
[20:44:57] ℹ️  Final extracted Sex: 'MALE'
[20:44:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:44:57] ℹ️  Final extracted Payer Source: ''
[20:44:57] ✅ Patient data extraction completed successfully
[20:44:57] ✅    ✅ Patient data extracted successfully
[20:44:57] 📊 Patient Response
     └─ patientFName: Adriano
     └─ patientLName: Lima
     └─ dob: 07/27/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063794
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:44:57] ✅    ✅ Patient identified: Adriano Lima
[20:44:57] ✅    ✅ Patient name validation passed
[20:44:57] 🔄 
🔄 Step 3: Processing patient dates...
[20:44:57] [DOC: 9208251] ℹ️  DOB normalized: 07/27/1956
[20:44:57] [DOC: 9208251] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[20:44:57] [DOC: 9208251] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[20:44:57] [DOC: 9208251] ✅ Patient date processing completed successfully
[20:44:57] ✅    ✅ Date processing completed
[20:44:57] 📊 Processed Patient Data
     └─ patientFName: Adriano
     └─ patientLName: Lima
     └─ dob: 07/27/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063794
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:44:57] 🔄 
🔄 Step 4: Extracting order data...
[20:45:00] ℹ️  Order extraction - MRN: '2063794'
[20:45:00] ℹ️  Order extraction - Sex: 'MALE'
[20:45:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:45:00] ℹ️  Order extraction - Payer Source: ''
[20:45:00] ✅ Order data extraction completed successfully
[20:45:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:45:00] ℹ️  Using MRN from patient data: '2063794' over '2063794'
[20:45:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:45:00] ✅ Patient name cross-validation successful
[20:45:00] ✅    ✅ Data merged successfully
[20:45:01] ✅    ✅ Order data extracted and validated
[20:45:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:45:01] [DOC: 9208251] ✅ Patient found in local cache: Adriano Lima, ID: bc228bea-5a75-435d-ba11-54637f839b99
[20:45:01] ✅    ✅ Existing patient found with ID: bc228bea-5a75-435d-ba11-54637f839b99
[20:45:01] 🔄 
🔄 Step 6: Pushing order to API...
[20:45:01] [DOC: 9208251] ℹ️  Pushing order via API for patient ID: bc228bea-5a75-435d-ba11-54637f839b99
[20:45:03] [DOC: 9208251] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13188"}
[20:45:03] ❌    ❌ Failed to push order
[20:45:03] 🔄 
🔄 Step 7: Writing to CSV...
[20:45:03] [DOC: 9208251] ℹ️  Calculated age: 68 from DOB: 07/27/1956
[20:45:03] [DOC: 9208251] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:45:03] [DOC: 9208251] ℹ️  Payer Source extracted: ''
[20:45:03] [DOC: 9208251] ℹ️  Diagnosis codes being written:
[20:45:03] [DOC: 9208251] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:45:03] [DOC: 9208251] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:45:03] [DOC: 9208251] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:45:03] [DOC: 9208251] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:45:03] [DOC: 9208251] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:45:03] [DOC: 9208251] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:45:03] [DOC: 9208251] ✅ Patient data written to CSV: Adriano Lima | Sex: MALE | Age: 68 | Service: Skilled Nursing | Payer:  | MRN: 2063794
[20:45:03] ✅    ✅ Document 9208251 processed and saved successfully
[20:45:03] 🔄 
🔄 Step 8: Saving API details...
[20:45:03] [DOC: 9208251] ℹ️  API push details saved for document 9208251
[20:45:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208250                         ║
================================================================================
[20:45:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:45:03] ℹ️  Date: 03/28/2025
[20:45:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:45:04] [DOC: 9208250] ✅ Text extracted using pdfplumber (1065 chars)
[20:45:04] ✅    ✅ Text extracted using pdfplumber (1065 chars)
[20:45:04] 🔄 
🔄 Step 2: Extracting patient data...
[20:45:07] ℹ️  AI extracted raw sex value: 'M'
[20:45:07] ℹ️  AI extracted service line: 'Physical Therapy'
[20:45:07] ℹ️  AI extracted payer source: ''
[20:45:07] ℹ️  AI extracted diagnoses:
[20:45:07] ℹ️    - Diagnosis 1: 'None'
[20:45:07] ℹ️    - Diagnosis 2: 'None'
[20:45:07] ℹ️    - Diagnosis 3: 'None'
[20:45:07] ℹ️    - Diagnosis 4: 'None'
[20:45:07] ℹ️    - Diagnosis 5: 'None'
[20:45:07] ℹ️    - Diagnosis 6: 'None'
[20:45:07] ℹ️  Final extracted MRN: '2648815'
[20:45:07] ℹ️  Final extracted Sex: 'MALE'
[20:45:07] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:45:07] ℹ️  Final extracted Payer Source: ''
[20:45:07] ✅ Patient data extraction completed successfully
[20:45:07] ✅    ✅ Patient data extracted successfully
[20:45:07] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:45:07] ✅    ✅ Patient identified: Robert Ledoux
[20:45:07] ✅    ✅ Patient name validation passed
[20:45:07] 🔄 
🔄 Step 3: Processing patient dates...
[20:45:07] [DOC: 9208250] ℹ️  DOB normalized: 04/07/1968
[20:45:07] [DOC: 9208250] ✅ Patient date processing completed successfully
[20:45:07] ✅    ✅ Date processing completed
[20:45:07] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[20:45:07] 🔄 
🔄 Step 4: Extracting order data...
[20:45:09] ℹ️  Order extraction - MRN: '2648815'
[20:45:09] ℹ️  Order extraction - Sex: 'MALE'
[20:45:09] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:45:09] ℹ️  Order extraction - Payer Source: ''
[20:45:09] ✅ Order data extraction completed successfully
[20:45:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:45:09] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[20:45:09] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:45:09] ✅ Patient name cross-validation successful
[20:45:09] ✅    ✅ Data merged successfully
[20:45:10] ✅    ✅ Order data extracted and validated
[20:45:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:45:15] [DOC: 9208250] ℹ️  Patient not found in cache or API: Robert Ledoux
[20:45:15] [DOC: 9208250] ℹ️  Patient not found, creating new patient via API...
[20:45:15] [DOC: 9208250] ℹ️  Creating patient via API: Robert Ledoux
[20:45:16] [DOC: 9208250] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:45:16] ❌    ❌ Failed to create patient
[20:45:16] [DOC: 9208250] ℹ️  API push details saved for document 9208250
================================================================================
║                        Processing Document ID: 9208247                         ║
================================================================================
[20:45:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:45:16] ℹ️  Date: 03/28/2025
[20:45:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:45:18] [DOC: 9208247] ✅ Text extracted using pdfplumber (1058 chars)
[20:45:18] ✅    ✅ Text extracted using pdfplumber (1058 chars)
[20:45:18] 🔄 
🔄 Step 2: Extracting patient data...
[20:45:20] ℹ️  AI extracted raw sex value: 'F'
[20:45:20] ℹ️  AI extracted service line: 'Occupational Therapy'
[20:45:20] ℹ️  AI extracted payer source: ''
[20:45:20] ℹ️  AI extracted diagnoses:
[20:45:20] ℹ️    - Diagnosis 1: ''
[20:45:20] ℹ️    - Diagnosis 2: ''
[20:45:20] ℹ️    - Diagnosis 3: ''
[20:45:20] ℹ️    - Diagnosis 4: ''
[20:45:20] ℹ️    - Diagnosis 5: ''
[20:45:20] ℹ️    - Diagnosis 6: ''
[20:45:20] ℹ️  Final extracted MRN: '2647449'
[20:45:20] ℹ️  Final extracted Sex: 'FEMALE'
[20:45:20] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[20:45:20] ℹ️  Final extracted Payer Source: ''
[20:45:20] ✅ Patient data extraction completed successfully
[20:45:20] ✅    ✅ Patient data extracted successfully
[20:45:20] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Leblanc
     └─ dob: 07/13/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2647449
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:45:20] ✅    ✅ Patient identified: Mary Leblanc
[20:45:20] ✅    ✅ Patient name validation passed
[20:45:20] 🔄 
🔄 Step 3: Processing patient dates...
[20:45:20] [DOC: 9208247] ℹ️  DOB normalized: 07/13/1935
[20:45:20] [DOC: 9208247] ✅ Patient date processing completed successfully
[20:45:20] ✅    ✅ Date processing completed
[20:45:20] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Leblanc
     └─ dob: 07/13/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2647449
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:45:20] 🔄 
🔄 Step 4: Extracting order data...
[20:45:22] ℹ️  Order extraction - MRN: '2647449'
[20:45:22] ℹ️  Order extraction - Sex: 'FEMALE'
[20:45:22] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[20:45:22] ℹ️  Order extraction - Payer Source: ''
[20:45:22] ✅ Order data extraction completed successfully
[20:45:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:45:22] ℹ️  Using MRN from patient data: '2647449' over '2647449'
[20:45:22] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[20:45:22] ✅ Patient name cross-validation successful
[20:45:22] ✅    ✅ Data merged successfully
[20:45:24] ✅    ✅ Order data extracted and validated
[20:45:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:45:24] [DOC: 9208247] ✅ Patient found in local cache: Mary Leblanc, ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[20:45:24] ✅    ✅ Existing patient found with ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[20:45:24] 🔄 
🔄 Step 6: Pushing order to API...
[20:45:24] [DOC: 9208247] ℹ️  Pushing order via API for patient ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[20:45:25] [DOC: 9208247] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20074"}
[20:45:25] ❌    ❌ Failed to push order
[20:45:25] 🔄 
🔄 Step 7: Writing to CSV...
[20:45:25] [DOC: 9208247] ℹ️  Calculated age: 89 from DOB: 07/13/1935
[20:45:25] [DOC: 9208247] ℹ️  Service Line extracted: 'Occupational Therapy'
[20:45:25] [DOC: 9208247] ℹ️  Payer Source extracted: ''
[20:45:25] [DOC: 9208247] ℹ️  Diagnosis codes being written:
[20:45:25] [DOC: 9208247] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:45:25] [DOC: 9208247] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:45:25] [DOC: 9208247] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:45:25] [DOC: 9208247] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:45:25] [DOC: 9208247] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:45:25] [DOC: 9208247] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:45:25] [DOC: 9208247] ✅ Patient data written to CSV: Mary Leblanc | Sex: FEMALE | Age: 89 | Service: Occupational Therapy | Payer:  | MRN: 2647449
[20:45:25] ✅    ✅ Document 9208247 processed and saved successfully
[20:45:25] 🔄 
🔄 Step 8: Saving API details...
[20:45:25] [DOC: 9208247] ℹ️  API push details saved for document 9208247
[20:45:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208246                         ║
================================================================================
[20:45:25] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:45:25] ℹ️  Date: 03/28/2025
[20:45:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:45:27] [DOC: 9208246] ✅ Text extracted using pdfplumber (1118 chars)
[20:45:27] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[20:45:27] 🔄 
🔄 Step 2: Extracting patient data...
[20:45:29] ℹ️  AI extracted raw sex value: 'F'
[20:45:29] ℹ️  AI extracted service line: 'Physical Therapy'
[20:45:29] ℹ️  AI extracted payer source: ''
[20:45:29] ℹ️  AI extracted diagnoses:
[20:45:29] ℹ️    - Diagnosis 1: 'None'
[20:45:29] ℹ️    - Diagnosis 2: 'None'
[20:45:29] ℹ️    - Diagnosis 3: 'None'
[20:45:29] ℹ️    - Diagnosis 4: 'None'
[20:45:29] ℹ️    - Diagnosis 5: 'None'
[20:45:29] ℹ️    - Diagnosis 6: 'None'
[20:45:29] ℹ️  Final extracted MRN: '2645822'
[20:45:29] ℹ️  Final extracted Sex: 'FEMALE'
[20:45:29] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:45:29] ℹ️  Final extracted Payer Source: ''
[20:45:29] ✅ Patient data extraction completed successfully
[20:45:29] ✅    ✅ Patient data extracted successfully
[20:45:29] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Leal
     └─ dob: 06/30/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2645822
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:45:29] ✅    ✅ Patient identified: Maria Leal
[20:45:29] ✅    ✅ Patient name validation passed
[20:45:29] 🔄 
🔄 Step 3: Processing patient dates...
[20:45:29] [DOC: 9208246] ℹ️  DOB normalized: 06/30/1940
[20:45:29] [DOC: 9208246] ✅ Patient date processing completed successfully
[20:45:29] ✅    ✅ Date processing completed
[20:45:29] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Leal
     └─ dob: 06/30/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2645822
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[20:45:29] 🔄 
🔄 Step 4: Extracting order data...
[20:45:31] ℹ️  Order extraction - MRN: '2645822'
[20:45:31] ℹ️  Order extraction - Sex: 'FEMALE'
[20:45:31] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:45:31] ℹ️  Order extraction - Payer Source: ''
[20:45:31] ✅ Order data extraction completed successfully
[20:45:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:45:31] ℹ️  Using MRN from patient data: '2645822' over '2645822'
[20:45:31] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:45:31] ✅ Patient name cross-validation successful
[20:45:31] ✅    ✅ Data merged successfully
[20:45:33] ✅    ✅ Order data extracted and validated
[20:45:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:45:33] [DOC: 9208246] ✅ Patient found in local cache: Maria Leal, ID: 49f21bef-9493-4e6d-8fed-0ae67ee17b5d
[20:45:33] ✅    ✅ Existing patient found with ID: 49f21bef-9493-4e6d-8fed-0ae67ee17b5d
[20:45:33] 🔄 
🔄 Step 6: Pushing order to API...
[20:45:33] [DOC: 9208246] ℹ️  Pushing order via API for patient ID: 49f21bef-9493-4e6d-8fed-0ae67ee17b5d
[20:45:34] [DOC: 9208246] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13662"}
[20:45:34] ❌    ❌ Failed to push order
[20:45:34] 🔄 
🔄 Step 7: Writing to CSV...
[20:45:34] [DOC: 9208246] ℹ️  Calculated age: 84 from DOB: 06/30/1940
[20:45:34] [DOC: 9208246] ℹ️  Service Line extracted: 'Physical Therapy'
[20:45:34] [DOC: 9208246] ℹ️  Payer Source extracted: ''
[20:45:34] [DOC: 9208246] ℹ️  Diagnosis codes being written:
[20:45:34] [DOC: 9208246] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:45:34] [DOC: 9208246] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:45:34] [DOC: 9208246] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:45:34] [DOC: 9208246] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:45:34] [DOC: 9208246] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:45:34] [DOC: 9208246] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:45:34] [DOC: 9208246] ✅ Patient data written to CSV: Maria Leal | Sex: FEMALE | Age: 84 | Service: Physical Therapy | Payer:  | MRN: 2645822
[20:45:34] ✅    ✅ Document 9208246 processed and saved successfully
[20:45:34] 🔄 
🔄 Step 8: Saving API details...
[20:45:34] [DOC: 9208246] ℹ️  API push details saved for document 9208246
[20:45:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208245                         ║
================================================================================
[20:45:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:45:34] ℹ️  Date: 03/28/2025
[20:45:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:45:35] [DOC: 9208245] ✅ Text extracted using pdfplumber (853 chars)
[20:45:35] ✅    ✅ Text extracted using pdfplumber (853 chars)
[20:45:35] 🔄 
🔄 Step 2: Extracting patient data...
[20:45:38] ℹ️  AI extracted raw sex value: 'F'
[20:45:38] ℹ️  AI extracted service line: 'Physical Therapy'
[20:45:38] ℹ️  AI extracted payer source: ''
[20:45:38] ℹ️  AI extracted diagnoses:
[20:45:38] ℹ️    - Diagnosis 1: ''
[20:45:38] ℹ️    - Diagnosis 2: ''
[20:45:38] ℹ️    - Diagnosis 3: ''
[20:45:38] ℹ️    - Diagnosis 4: ''
[20:45:38] ℹ️    - Diagnosis 5: ''
[20:45:38] ℹ️    - Diagnosis 6: ''
[20:45:38] ℹ️  Final extracted MRN: '2638113'
[20:45:38] ℹ️  Final extracted Sex: 'FEMALE'
[20:45:38] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:45:38] ℹ️  Final extracted Payer Source: ''
[20:45:38] ✅ Patient data extraction completed successfully
[20:45:38] ✅    ✅ Patient data extracted successfully
[20:45:38] 📊 Patient Response
     └─ patientFName: Gail
     └─ patientLName: Lapalme
     └─ dob: 11/18/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2638113
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:45:38] ✅    ✅ Patient identified: Gail Lapalme
[20:45:38] ✅    ✅ Patient name validation passed
[20:45:38] 🔄 
🔄 Step 3: Processing patient dates...
[20:45:38] [DOC: 9208245] ℹ️  DOB normalized: 11/18/1949
[20:45:38] [DOC: 9208245] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[20:45:38] [DOC: 9208245] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[20:45:38] [DOC: 9208245] ✅ Patient date processing completed successfully
[20:45:38] ✅    ✅ Date processing completed
[20:45:38] 📊 Processed Patient Data
     └─ patientFName: Gail
     └─ patientLName: Lapalme
     └─ dob: 11/18/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2638113
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:45:38] 🔄 
🔄 Step 4: Extracting order data...
[20:45:40] ℹ️  Order extraction - MRN: '2638113'
[20:45:40] ℹ️  Order extraction - Sex: 'FEMALE'
[20:45:40] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:45:40] ℹ️  Order extraction - Payer Source: ''
[20:45:40] ✅ Order data extraction completed successfully
[20:45:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:45:40] ℹ️  Using MRN from patient data: '2638113' over '2638113'
[20:45:40] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:45:40] ✅ Patient name cross-validation successful
[20:45:40] ✅    ✅ Data merged successfully
[20:45:42] ✅    ✅ Order data extracted and validated
[20:45:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:45:42] [DOC: 9208245] ✅ Patient found in local cache: Gail Lapalme, ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[20:45:42] ✅    ✅ Existing patient found with ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[20:45:42] 🔄 
🔄 Step 6: Pushing order to API...
[20:45:42] [DOC: 9208245] ℹ️  Pushing order via API for patient ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[20:45:43] [DOC: 9208245] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13293"}
[20:45:43] ❌    ❌ Failed to push order
[20:45:43] 🔄 
🔄 Step 7: Writing to CSV...
[20:45:43] [DOC: 9208245] ℹ️  Calculated age: 75 from DOB: 11/18/1949
[20:45:43] [DOC: 9208245] ℹ️  Service Line extracted: 'Physical Therapy'
[20:45:43] [DOC: 9208245] ℹ️  Payer Source extracted: ''
[20:45:43] [DOC: 9208245] ℹ️  Diagnosis codes being written:
[20:45:43] [DOC: 9208245] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:45:43] [DOC: 9208245] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:45:43] [DOC: 9208245] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:45:43] [DOC: 9208245] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:45:43] [DOC: 9208245] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:45:43] [DOC: 9208245] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:45:43] [DOC: 9208245] ✅ Patient data written to CSV: Gail Lapalme | Sex: FEMALE | Age: 75 | Service: Physical Therapy | Payer:  | MRN: 2638113
[20:45:43] ✅    ✅ Document 9208245 processed and saved successfully
[20:45:43] 🔄 
🔄 Step 8: Saving API details...
[20:45:43] [DOC: 9208245] ℹ️  API push details saved for document 9208245
[20:45:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208243                         ║
================================================================================
[20:45:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:45:43] ℹ️  Date: 03/28/2025
[20:45:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:45:44] [DOC: 9208243] ✅ Text extracted using pdfplumber (1029 chars)
[20:45:44] ✅    ✅ Text extracted using pdfplumber (1029 chars)
[20:45:44] 🔄 
🔄 Step 2: Extracting patient data...
[20:45:48] ℹ️  AI extracted raw sex value: 'F'
[20:45:48] ℹ️  AI extracted service line: 'Physical Therapy'
[20:45:48] ℹ️  AI extracted payer source: ''
[20:45:48] ℹ️  AI extracted diagnoses:
[20:45:48] ℹ️    - Diagnosis 1: ''
[20:45:48] ℹ️    - Diagnosis 2: ''
[20:45:48] ℹ️    - Diagnosis 3: ''
[20:45:48] ℹ️    - Diagnosis 4: ''
[20:45:48] ℹ️    - Diagnosis 5: ''
[20:45:48] ℹ️    - Diagnosis 6: ''
[20:45:48] ℹ️  Final extracted MRN: '2611003'
[20:45:48] ℹ️  Final extracted Sex: 'FEMALE'
[20:45:48] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:45:48] ℹ️  Final extracted Payer Source: ''
[20:45:48] ✅ Patient data extraction completed successfully
[20:45:48] ✅    ✅ Patient data extracted successfully
[20:45:48] 📊 Patient Response
     └─ patientFName: Johnnie-Ann
     └─ patientLName: Keighley
     └─ dob: 04/04/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2611003
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:45:48] ✅    ✅ Patient identified: Johnnie-Ann Keighley
[20:45:48] ✅    ✅ Patient name validation passed
[20:45:48] 🔄 
🔄 Step 3: Processing patient dates...
[20:45:48] [DOC: 9208243] ℹ️  DOB normalized: 04/04/1945
[20:45:48] [DOC: 9208243] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[20:45:48] [DOC: 9208243] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[20:45:48] [DOC: 9208243] ✅ Patient date processing completed successfully
[20:45:48] ✅    ✅ Date processing completed
[20:45:48] 📊 Processed Patient Data
     └─ patientFName: Johnnie-Ann
     └─ patientLName: Keighley
     └─ dob: 04/04/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2611003
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:45:48] 🔄 
🔄 Step 4: Extracting order data...
[20:45:50] ℹ️  Order extraction - MRN: '2611003'
[20:45:50] ℹ️  Order extraction - Sex: 'FEMALE'
[20:45:50] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:45:50] ℹ️  Order extraction - Payer Source: ''
[20:45:50] ✅ Order data extraction completed successfully
[20:45:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:45:50] ℹ️  Using MRN from patient data: '2611003' over '2611003'
[20:45:50] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:45:50] ✅ Patient name cross-validation successful
[20:45:50] ✅    ✅ Data merged successfully
[20:45:52] ✅    ✅ Order data extracted and validated
[20:45:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:45:52] [DOC: 9208243] ✅ Patient found in local cache: Johnnie-Ann Keighley, ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[20:45:52] ✅    ✅ Existing patient found with ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[20:45:52] 🔄 
🔄 Step 6: Pushing order to API...
[20:45:52] [DOC: 9208243] ℹ️  Pushing order via API for patient ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[20:45:53] [DOC: 9208243] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13099"}
[20:45:53] ❌    ❌ Failed to push order
[20:45:53] 🔄 
🔄 Step 7: Writing to CSV...
[20:45:53] [DOC: 9208243] ℹ️  Calculated age: 80 from DOB: 04/04/1945
[20:45:53] [DOC: 9208243] ℹ️  Service Line extracted: 'Physical Therapy'
[20:45:53] [DOC: 9208243] ℹ️  Payer Source extracted: ''
[20:45:53] [DOC: 9208243] ℹ️  Diagnosis codes being written:
[20:45:53] [DOC: 9208243] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:45:53] [DOC: 9208243] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:45:53] [DOC: 9208243] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:45:53] [DOC: 9208243] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:45:53] [DOC: 9208243] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:45:53] [DOC: 9208243] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:45:53] [DOC: 9208243] ✅ Patient data written to CSV: Johnnie-Ann Keighley | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: 2611003
[20:45:53] ✅    ✅ Document 9208243 processed and saved successfully
[20:45:53] 🔄 
🔄 Step 8: Saving API details...
[20:45:53] [DOC: 9208243] ℹ️  API push details saved for document 9208243
[20:45:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208241                         ║
================================================================================
[20:45:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:45:53] ℹ️  Date: 03/28/2025
[20:45:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:45:55] [DOC: 9208241] ✅ Text extracted using pdfplumber (2319 chars)
[20:45:55] ✅    ✅ Text extracted using pdfplumber (2319 chars)
[20:45:55] 🔄 
🔄 Step 2: Extracting patient data...
[20:45:58] ℹ️  AI extracted raw sex value: 'M'
[20:45:58] ℹ️  AI extracted service line: 'Skilled Nursing,Medical Social Work'
[20:45:58] ℹ️  AI extracted payer source: ''
[20:45:58] ℹ️  AI extracted diagnoses:
[20:45:58] ℹ️    - Diagnosis 1: 'None'
[20:45:58] ℹ️    - Diagnosis 2: 'None'
[20:45:58] ℹ️    - Diagnosis 3: 'None'
[20:45:58] ℹ️    - Diagnosis 4: 'None'
[20:45:58] ℹ️    - Diagnosis 5: 'None'
[20:45:58] ℹ️    - Diagnosis 6: 'None'
[20:45:58] ℹ️  Final extracted MRN: '2136200'
[20:45:58] ℹ️  Final extracted Sex: 'MALE'
[20:45:58] ℹ️  Final extracted Service Line: 'Skilled Nursing,Medical Social Work'
[20:45:58] ℹ️  Final extracted Payer Source: ''
[20:45:58] ✅ Patient data extraction completed successfully
[20:45:58] ✅    ✅ Patient data extracted successfully
[20:45:58] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:45:58] ✅    ✅ Patient identified: Jacob Amadeu
[20:45:58] ✅    ✅ Patient name validation passed
[20:45:58] 🔄 
🔄 Step 3: Processing patient dates...
[20:45:58] [DOC: 9208241] ℹ️  DOB normalized: 04/03/1941
[20:45:58] [DOC: 9208241] ✅ Patient date processing completed successfully
[20:45:58] ✅    ✅ Date processing completed
[20:45:58] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[20:45:58] 🔄 
🔄 Step 4: Extracting order data...
[20:46:00] ℹ️  Order extraction - MRN: '2136200'
[20:46:00] ℹ️  Order extraction - Sex: 'MALE'
[20:46:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Medical Social Work'
[20:46:00] ℹ️  Order extraction - Payer Source: ''
[20:46:00] ✅ Order data extraction completed successfully
[20:46:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:46:00] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[20:46:00] ℹ️  Combined service lines: Patient='Skilled Nursing,Medical Social Work' + Order='Skilled Nursing, Medical Social Work' = 'Medical Social Work, Skilled Nursing'
[20:46:00] ✅ Patient name cross-validation successful
[20:46:00] ✅    ✅ Data merged successfully
[20:46:02] ✅    ✅ Order data extracted and validated
[20:46:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:46:35] [DOC: 9208241] ℹ️  Patient not found in cache or API: Jacob Amadeu
[20:46:35] [DOC: 9208241] ℹ️  Patient not found, creating new patient via API...
[20:46:35] [DOC: 9208241] ℹ️  Creating patient via API: Jacob Amadeu
[20:46:37] [DOC: 9208241] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:46:37] ❌    ❌ Failed to create patient
[20:46:37] [DOC: 9208241] ℹ️  API push details saved for document 9208241
================================================================================
║                        Processing Document ID: 9208240                         ║
================================================================================
[20:46:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:46:37] ℹ️  Date: 03/28/2025
[20:46:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:46:38] [DOC: 9208240] ✅ Text extracted using pdfplumber (1233 chars)
[20:46:38] ✅    ✅ Text extracted using pdfplumber (1233 chars)
[20:46:38] 🔄 
🔄 Step 2: Extracting patient data...
[20:46:41] ℹ️  AI extracted raw sex value: 'M'
[20:46:41] ℹ️  AI extracted service line: 'Home Health Aide, Skilled Nursing'
[20:46:41] ℹ️  AI extracted payer source: ''
[20:46:41] ℹ️  AI extracted diagnoses:
[20:46:41] ℹ️    - Diagnosis 1: ''
[20:46:41] ℹ️    - Diagnosis 2: ''
[20:46:41] ℹ️    - Diagnosis 3: ''
[20:46:41] ℹ️    - Diagnosis 4: ''
[20:46:41] ℹ️    - Diagnosis 5: ''
[20:46:41] ℹ️    - Diagnosis 6: ''
[20:46:41] ℹ️  Final extracted MRN: '2113948'
[20:46:41] ℹ️  Final extracted Sex: 'MALE'
[20:46:41] ℹ️  Final extracted Service Line: 'Home Health Aide, Skilled Nursing'
[20:46:41] ℹ️  Final extracted Payer Source: ''
[20:46:41] ✅ Patient data extraction completed successfully
[20:46:41] ✅    ✅ Patient data extracted successfully
[20:46:41] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:46:41] ✅    ✅ Patient identified: Jay Greenspan
[20:46:41] ✅    ✅ Patient name validation passed
[20:46:41] 🔄 
🔄 Step 3: Processing patient dates...
[20:46:41] [DOC: 9208240] ℹ️  DOB normalized: 03/11/1942
[20:46:41] [DOC: 9208240] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[20:46:41] [DOC: 9208240] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[20:46:41] [DOC: 9208240] ✅ Patient date processing completed successfully
[20:46:41] ✅    ✅ Date processing completed
[20:46:41] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:46:41] 🔄 
🔄 Step 4: Extracting order data...
[20:46:44] ℹ️  Order extraction - MRN: '2113948'
[20:46:44] ℹ️  Order extraction - Sex: 'MALE'
[20:46:44] ℹ️  Order extraction - Service Line: 'Home Health Aide, Skilled Nursing'
[20:46:44] ℹ️  Order extraction - Payer Source: ''
[20:46:44] ✅ Order data extraction completed successfully
[20:46:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:46:44] ℹ️  Using MRN from patient data: '2113948' over '2113948'
[20:46:44] ℹ️  Service line consistent in both sources: 'Home Health Aide, Skilled Nursing'
[20:46:44] ✅ Patient name cross-validation successful
[20:46:44] ✅    ✅ Data merged successfully
[20:46:45] ✅    ✅ Order data extracted and validated
[20:46:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:46:45] [DOC: 9208240] ✅ Patient found in local cache: Jay Greenspan, ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[20:46:45] ✅    ✅ Existing patient found with ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[20:46:45] 🔄 
🔄 Step 6: Pushing order to API...
[20:46:45] [DOC: 9208240] ℹ️  Pushing order via API for patient ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[20:46:46] [DOC: 9208240] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13053"}
[20:46:46] ❌    ❌ Failed to push order
[20:46:46] 🔄 
🔄 Step 7: Writing to CSV...
[20:46:46] [DOC: 9208240] ℹ️  Calculated age: 83 from DOB: 03/11/1942
[20:46:46] [DOC: 9208240] ℹ️  Service Line extracted: 'Home Health Aide, Skilled Nursing'
[20:46:46] [DOC: 9208240] ℹ️  Payer Source extracted: ''
[20:46:46] [DOC: 9208240] ℹ️  Diagnosis codes being written:
[20:46:46] [DOC: 9208240] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:46:46] [DOC: 9208240] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:46:46] [DOC: 9208240] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:46:46] [DOC: 9208240] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:46:46] [DOC: 9208240] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:46:46] [DOC: 9208240] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:46:46] [DOC: 9208240] ✅ Patient data written to CSV: Jay Greenspan | Sex: MALE | Age: 83 | Service: Home Health Aide, Skilled Nursing | Payer:  | MRN: 2113948
[20:46:46] ✅    ✅ Document 9208240 processed and saved successfully
[20:46:46] 🔄 
🔄 Step 8: Saving API details...
[20:46:46] [DOC: 9208240] ℹ️  API push details saved for document 9208240
[20:46:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208239                         ║
================================================================================
[20:46:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:46:46] ℹ️  Date: 03/28/2025
[20:46:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:46:48] [DOC: 9208239] ✅ Text extracted using pdfplumber (1053 chars)
[20:46:48] ✅    ✅ Text extracted using pdfplumber (1053 chars)
[20:46:48] 🔄 
🔄 Step 2: Extracting patient data...
[20:46:50] ℹ️  AI extracted raw sex value: 'M'
[20:46:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:46:50] ℹ️  AI extracted payer source: ''
[20:46:50] ℹ️  AI extracted diagnoses:
[20:46:50] ℹ️    - Diagnosis 1: ''
[20:46:50] ℹ️    - Diagnosis 2: ''
[20:46:50] ℹ️    - Diagnosis 3: ''
[20:46:50] ℹ️    - Diagnosis 4: ''
[20:46:50] ℹ️    - Diagnosis 5: ''
[20:46:50] ℹ️    - Diagnosis 6: ''
[20:46:50] ℹ️  Final extracted MRN: '2149660'
[20:46:50] ℹ️  Final extracted Sex: 'MALE'
[20:46:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:46:50] ℹ️  Final extracted Payer Source: ''
[20:46:50] ✅ Patient data extraction completed successfully
[20:46:50] ✅    ✅ Patient data extracted successfully
[20:46:50] 📊 Patient Response
     └─ patientFName: Scott
     └─ patientLName: Fonseca
     └─ dob: 12/30/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 2149660
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:46:50] ✅    ✅ Patient identified: Scott Fonseca
[20:46:50] ✅    ✅ Patient name validation passed
[20:46:50] 🔄 
🔄 Step 3: Processing patient dates...
[20:46:50] [DOC: 9208239] ℹ️  DOB normalized: 12/30/1980
[20:46:50] [DOC: 9208239] ✅ Patient date processing completed successfully
[20:46:50] ✅    ✅ Date processing completed
[20:46:50] 📊 Processed Patient Data
     └─ patientFName: Scott
     └─ patientLName: Fonseca
     └─ dob: 12/30/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 2149660
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:46:50] 🔄 
🔄 Step 4: Extracting order data...
[20:46:52] ℹ️  Order extraction - MRN: '2149660'
[20:46:52] ℹ️  Order extraction - Sex: 'MALE'
[20:46:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:46:52] ℹ️  Order extraction - Payer Source: ''
[20:46:52] ✅ Order data extraction completed successfully
[20:46:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:46:52] ℹ️  Using MRN from patient data: '2149660' over '2149660'
[20:46:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:46:52] ✅ Patient name cross-validation successful
[20:46:52] ✅    ✅ Data merged successfully
[20:46:54] ✅    ✅ Order data extracted and validated
[20:46:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:46:54] [DOC: 9208239] ✅ Patient found in local cache: Scott Fonseca, ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[20:46:54] ✅    ✅ Existing patient found with ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[20:46:54] 🔄 
🔄 Step 6: Pushing order to API...
[20:46:54] [DOC: 9208239] ℹ️  Pushing order via API for patient ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[20:46:55] [DOC: 9208239] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20075"}
[20:46:55] ❌    ❌ Failed to push order
[20:46:55] 🔄 
🔄 Step 7: Writing to CSV...
[20:46:55] [DOC: 9208239] ℹ️  Calculated age: 44 from DOB: 12/30/1980
[20:46:55] [DOC: 9208239] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:46:55] [DOC: 9208239] ℹ️  Payer Source extracted: ''
[20:46:55] [DOC: 9208239] ℹ️  Diagnosis codes being written:
[20:46:55] [DOC: 9208239] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:46:55] [DOC: 9208239] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:46:55] [DOC: 9208239] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:46:55] [DOC: 9208239] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:46:55] [DOC: 9208239] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:46:55] [DOC: 9208239] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:46:55] [DOC: 9208239] ✅ Patient data written to CSV: Scott Fonseca | Sex: MALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 2149660
[20:46:55] ✅    ✅ Document 9208239 processed and saved successfully
[20:46:55] 🔄 
🔄 Step 8: Saving API details...
[20:46:55] [DOC: 9208239] ℹ️  API push details saved for document 9208239
[20:46:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208236                         ║
================================================================================
[20:46:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:46:55] ℹ️  Date: 03/28/2025
[20:46:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:46:57] [DOC: 9208236] ✅ Text extracted using pdfplumber (1066 chars)
[20:46:57] ✅    ✅ Text extracted using pdfplumber (1066 chars)
[20:46:57] 🔄 
🔄 Step 2: Extracting patient data...
[20:47:00] ℹ️  AI extracted raw sex value: 'F'
[20:47:00] ℹ️  AI extracted service line: 'Physical Therapy'
[20:47:00] ℹ️  AI extracted payer source: ''
[20:47:00] ℹ️  AI extracted diagnoses:
[20:47:00] ℹ️    - Diagnosis 1: ''
[20:47:00] ℹ️    - Diagnosis 2: ''
[20:47:00] ℹ️    - Diagnosis 3: ''
[20:47:00] ℹ️    - Diagnosis 4: ''
[20:47:00] ℹ️    - Diagnosis 5: ''
[20:47:00] ℹ️    - Diagnosis 6: ''
[20:47:00] ℹ️  Final extracted MRN: '2450273'
[20:47:00] ℹ️  Final extracted Sex: 'FEMALE'
[20:47:00] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:47:00] ℹ️  Final extracted Payer Source: ''
[20:47:00] ✅ Patient data extraction completed successfully
[20:47:00] ✅    ✅ Patient data extracted successfully
[20:47:00] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:47:00] ✅    ✅ Patient identified: Maria Estacio
[20:47:00] ✅    ✅ Patient name validation passed
[20:47:00] 🔄 
🔄 Step 3: Processing patient dates...
[20:47:00] [DOC: 9208236] ℹ️  DOB normalized: 12/14/1935
[20:47:00] [DOC: 9208236] ✅ Patient date processing completed successfully
[20:47:00] ✅    ✅ Date processing completed
[20:47:00] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:47:00] 🔄 
🔄 Step 4: Extracting order data...
[20:47:02] ℹ️  Order extraction - MRN: '2450273'
[20:47:02] ℹ️  Order extraction - Sex: 'FEMALE'
[20:47:02] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:47:02] ℹ️  Order extraction - Payer Source: ''
[20:47:02] ✅ Order data extraction completed successfully
[20:47:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:47:02] ℹ️  Using MRN from patient data: '2450273' over '2450273'
[20:47:02] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:47:02] ✅ Patient name cross-validation successful
[20:47:02] ✅    ✅ Data merged successfully
[20:47:03] ✅    ✅ Order data extracted and validated
[20:47:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:47:27] [DOC: 9208236] ℹ️  Patient not found in cache or API: Maria Estacio
[20:47:27] [DOC: 9208236] ℹ️  Patient not found, creating new patient via API...
[20:47:27] [DOC: 9208236] ℹ️  Creating patient via API: Maria Estacio
[20:47:29] [DOC: 9208236] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:47:29] ❌    ❌ Failed to create patient
[20:47:29] [DOC: 9208236] ℹ️  API push details saved for document 9208236
================================================================================
║                        Processing Document ID: 9208227                         ║
================================================================================
[20:47:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:47:29] ℹ️  Date: 03/28/2025
[20:47:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:47:31] [DOC: 9208227] ✅ Text extracted using pdfplumber (1118 chars)
[20:47:31] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[20:47:31] 🔄 
🔄 Step 2: Extracting patient data...
[20:47:33] ℹ️  AI extracted raw sex value: 'F'
[20:47:33] ℹ️  AI extracted service line: 'Medical Social Work'
[20:47:33] ℹ️  AI extracted payer source: ''
[20:47:33] ℹ️  AI extracted diagnoses:
[20:47:33] ℹ️    - Diagnosis 1: ''
[20:47:33] ℹ️    - Diagnosis 2: ''
[20:47:33] ℹ️    - Diagnosis 3: ''
[20:47:33] ℹ️    - Diagnosis 4: ''
[20:47:33] ℹ️    - Diagnosis 5: ''
[20:47:33] ℹ️    - Diagnosis 6: ''
[20:47:33] ℹ️  Final extracted MRN: '2409497'
[20:47:33] ℹ️  Final extracted Sex: 'FEMALE'
[20:47:33] ℹ️  Final extracted Service Line: 'Medical Social Work'
[20:47:33] ℹ️  Final extracted Payer Source: ''
[20:47:33] ✅ Patient data extraction completed successfully
[20:47:33] ✅    ✅ Patient data extracted successfully
[20:47:33] 📊 Patient Response
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:47:33] ✅    ✅ Patient identified: Juliet Desnoyers
[20:47:33] ✅    ✅ Patient name validation passed
[20:47:33] 🔄 
🔄 Step 3: Processing patient dates...
[20:47:33] [DOC: 9208227] ℹ️  DOB normalized: 11/13/1938
[20:47:33] [DOC: 9208227] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[20:47:33] [DOC: 9208227] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[20:47:33] [DOC: 9208227] ✅ Patient date processing completed successfully
[20:47:33] ✅    ✅ Date processing completed
[20:47:33] 📊 Processed Patient Data
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:47:33] 🔄 
🔄 Step 4: Extracting order data...
[20:47:36] ℹ️  Order extraction - MRN: '2409497'
[20:47:36] ℹ️  Order extraction - Sex: 'FEMALE'
[20:47:36] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[20:47:36] ℹ️  Order extraction - Payer Source: ''
[20:47:36] ✅ Order data extraction completed successfully
[20:47:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:47:36] ℹ️  Using MRN from patient data: '2409497' over '2409497'
[20:47:36] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[20:47:36] ✅ Patient name cross-validation successful
[20:47:36] ✅    ✅ Data merged successfully
[20:47:37] ✅    ✅ Order data extracted and validated
[20:47:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:48:01] [DOC: 9208227] ℹ️  Patient not found in cache or API: Juliet Desnoyers
[20:48:01] [DOC: 9208227] ℹ️  Patient not found, creating new patient via API...
[20:48:01] [DOC: 9208227] ℹ️  Creating patient via API: Juliet Desnoyers
[20:48:03] [DOC: 9208227] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:48:03] ❌    ❌ Failed to create patient
[20:48:03] [DOC: 9208227] ℹ️  API push details saved for document 9208227
================================================================================
║                        Processing Document ID: 9208202                         ║
================================================================================
[20:48:03] ℹ️  Agency: Visiting Rehab & Nursing Services
[20:48:03] ℹ️  Date: 03/28/2025
[20:48:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:48:05] [DOC: 9208202] ✅ Text extracted using pdfplumber (5499 chars)
[20:48:05] ✅    ✅ Text extracted using pdfplumber (5499 chars)
[20:48:05] 🔄 
🔄 Step 2: Extracting patient data...
[20:48:07] ℹ️  AI extracted raw sex value: 'None'
[20:48:07] ℹ️  AI extracted service line: 'None'
[20:48:07] ℹ️  AI extracted payer source: 'None'
[20:48:07] ℹ️  AI extracted diagnoses:
[20:48:07] ℹ️    - Diagnosis 1: ''
[20:48:07] ℹ️    - Diagnosis 2: ''
[20:48:07] ℹ️    - Diagnosis 3: ''
[20:48:07] ℹ️    - Diagnosis 4: ''
[20:48:07] ℹ️    - Diagnosis 5: ''
[20:48:07] ℹ️    - Diagnosis 6: ''
[20:48:07] ℹ️  Final extracted MRN: ''
[20:48:07] ℹ️  Final extracted Sex: ''
[20:48:07] ℹ️  Final extracted Service Line: ''
[20:48:07] ℹ️  Final extracted Payer Source: ''
[20:48:07] ✅ Patient data extraction completed successfully
[20:48:07] ✅    ✅ Patient data extracted successfully
[20:48:07] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[20:48:07] ⚠️     ❌ Insufficient patient data extracted
[20:48:07] [DOC: 9208202] ℹ️  API push details saved for document 9208202
================================================================================
║                        Processing Document ID: 9208197                         ║
================================================================================
[20:48:07] ℹ️  Agency: Visiting Rehab & Nursing Services
[20:48:07] ℹ️  Date: 03/28/2025
[20:48:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:48:09] [DOC: 9208197] ✅ Text extracted using pdfplumber (5167 chars)
[20:48:09] ✅    ✅ Text extracted using pdfplumber (5167 chars)
[20:48:09] 🔄 
🔄 Step 2: Extracting patient data...
[20:48:11] ℹ️  AI extracted raw sex value: 'None'
[20:48:11] ℹ️  AI extracted service line: 'None'
[20:48:11] ℹ️  AI extracted payer source: 'None'
[20:48:11] ℹ️  AI extracted diagnoses:
[20:48:11] ℹ️    - Diagnosis 1: ''
[20:48:11] ℹ️    - Diagnosis 2: ''
[20:48:11] ℹ️    - Diagnosis 3: ''
[20:48:11] ℹ️    - Diagnosis 4: ''
[20:48:11] ℹ️    - Diagnosis 5: ''
[20:48:11] ℹ️    - Diagnosis 6: ''
[20:48:11] ℹ️  Final extracted MRN: ''
[20:48:11] ℹ️  Final extracted Sex: ''
[20:48:11] ℹ️  Final extracted Service Line: ''
[20:48:11] ℹ️  Final extracted Payer Source: ''
[20:48:11] ✅ Patient data extraction completed successfully
[20:48:11] ✅    ✅ Patient data extracted successfully
[20:48:11] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[20:48:11] ⚠️     ❌ Insufficient patient data extracted
[20:48:11] [DOC: 9208197] ℹ️  API push details saved for document 9208197
================================================================================
║                        Processing Document ID: 9208193                         ║
================================================================================
[20:48:11] ℹ️  Agency: Visiting Rehab & Nursing Services
[20:48:11] ℹ️  Date: 03/28/2025
[20:48:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:48:26] [DOC: 9208193] ✅ Text extracted using pdfplumber (51417 chars)
[20:48:26] ✅    ✅ Text extracted using pdfplumber (51417 chars)
[20:48:26] 🔄 
🔄 Step 2: Extracting patient data...
[20:48:31] ℹ️  AI extracted raw sex value: ''
[20:48:31] ℹ️  AI extracted service line: ''
[20:48:31] ℹ️  AI extracted payer source: ''
[20:48:31] ℹ️  AI extracted diagnoses:
[20:48:31] ℹ️    - Diagnosis 1: ''
[20:48:31] ℹ️    - Diagnosis 2: ''
[20:48:31] ℹ️    - Diagnosis 3: ''
[20:48:31] ℹ️    - Diagnosis 4: ''
[20:48:31] ℹ️    - Diagnosis 5: ''
[20:48:31] ℹ️    - Diagnosis 6: ''
[20:48:31] ℹ️  Final extracted MRN: ''
[20:48:31] ℹ️  Final extracted Sex: ''
[20:48:31] ℹ️  Final extracted Service Line: ''
[20:48:31] ℹ️  Final extracted Payer Source: ''
[20:48:31] ✅ Patient data extraction completed successfully
[20:48:31] ✅    ✅ Patient data extracted successfully
[20:48:31] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[20:48:31] ⚠️     ❌ Insufficient patient data extracted
[20:48:31] [DOC: 9208193] ℹ️  API push details saved for document 9208193
================================================================================
║                        Processing Document ID: 9208191                         ║
================================================================================
[20:48:31] ℹ️  Agency: Visiting Rehab & Nursing Services
[20:48:31] ℹ️  Date: 03/28/2025
[20:48:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:48:54] [DOC: 9208191] ✅ Text extracted using pdfplumber (48474 chars)
[20:48:54] ✅    ✅ Text extracted using pdfplumber (48474 chars)
[20:48:54] 🔄 
🔄 Step 2: Extracting patient data...
[20:48:58] ℹ️  AI extracted raw sex value: 'None'
[20:48:58] ℹ️  AI extracted service line: 'None'
[20:48:58] ℹ️  AI extracted payer source: 'None'
[20:48:58] ℹ️  AI extracted diagnoses:
[20:48:58] ℹ️    - Diagnosis 1: ''
[20:48:58] ℹ️    - Diagnosis 2: ''
[20:48:58] ℹ️    - Diagnosis 3: ''
[20:48:58] ℹ️    - Diagnosis 4: ''
[20:48:58] ℹ️    - Diagnosis 5: ''
[20:48:58] ℹ️    - Diagnosis 6: ''
[20:48:58] ℹ️  Final extracted MRN: ''
[20:48:58] ℹ️  Final extracted Sex: ''
[20:48:58] ℹ️  Final extracted Service Line: ''
[20:48:58] ℹ️  Final extracted Payer Source: ''
[20:48:58] ✅ Patient data extraction completed successfully
[20:48:58] ✅    ✅ Patient data extracted successfully
[20:48:58] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[20:48:58] ⚠️     ❌ Insufficient patient data extracted
[20:48:58] [DOC: 9208191] ℹ️  API push details saved for document 9208191
================================================================================
║                        Processing Document ID: 9207838                         ║
================================================================================
[20:48:58] ℹ️  Agency: Kindred At Home-Fall River
[20:48:58] ℹ️  Date: 03/27/2025
[20:48:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:49:03] [DOC: 9207838] ✅ Text extracted using pdfplumber (1449 chars)
[20:49:03] ✅    ✅ Text extracted using pdfplumber (1449 chars)
[20:49:03] 🔄 
🔄 Step 2: Extracting patient data...
[20:49:06] ℹ️  AI extracted raw sex value: ''
[20:49:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:49:06] ℹ️  AI extracted payer source: ''
[20:49:06] ℹ️  AI extracted diagnoses:
[20:49:06] ℹ️    - Diagnosis 1: 'None'
[20:49:06] ℹ️    - Diagnosis 2: 'None'
[20:49:06] ℹ️    - Diagnosis 3: 'None'
[20:49:06] ℹ️    - Diagnosis 4: 'None'
[20:49:06] ℹ️    - Diagnosis 5: 'None'
[20:49:06] ℹ️    - Diagnosis 6: 'None'
[20:49:06] ℹ️  Final extracted MRN: 'A5300179941701'
[20:49:06] ℹ️  Final extracted Sex: ''
[20:49:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:49:06] ℹ️  Final extracted Payer Source: ''
[20:49:06] ✅ Patient data extraction completed successfully
[20:49:06] ✅    ✅ Patient data extracted successfully
[20:49:06] 📊 Patient Response
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:49:06] ✅    ✅ Patient identified: GEORGE BRAMAN
[20:49:06] ✅    ✅ Patient name validation passed
[20:49:06] 🔄 
🔄 Step 3: Processing patient dates...
[20:49:06] [DOC: 9207838] ℹ️  DOB normalized: 07/29/1941
[20:49:06] [DOC: 9207838] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[20:49:06] [DOC: 9207838] ℹ️  Episode endOfEpisode normalized: 01/16/2025
[20:49:06] [DOC: 9207838] ✅ Patient date processing completed successfully
[20:49:06] ✅    ✅ Date processing completed
[20:49:06] 📊 Processed Patient Data
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025'}]
[20:49:06] 🔄 
🔄 Step 4: Extracting order data...
[20:49:08] ℹ️  Order extraction - MRN: 'A5300179941701'
[20:49:08] ℹ️  Order extraction - Sex: ''
[20:49:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:49:08] ℹ️  Order extraction - Payer Source: ''
[20:49:08] ✅ Order data extraction completed successfully
[20:49:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:49:08] ℹ️  Using MRN from patient data: 'A5300179941701' over 'A5300179941701'
[20:49:08] ℹ️  Inferred sex as MALE from name: GEORGE
[20:49:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:49:08] ✅ Patient name cross-validation successful
[20:49:08] ✅    ✅ Data merged successfully
[20:49:09] ✅    ✅ Order data extracted and validated
[20:49:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:49:09] [DOC: 9207838] ✅ Patient found in local cache: GEORGE BRAMAN, ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[20:49:09] ✅    ✅ Existing patient found with ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[20:49:09] 🔄 
🔄 Step 6: Pushing order to API...
[20:49:09] [DOC: 9207838] ℹ️  Pushing order via API for patient ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[20:49:11] [DOC: 9207838] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13358"}
[20:49:11] ❌    ❌ Failed to push order
[20:49:11] 🔄 
🔄 Step 7: Writing to CSV...
[20:49:11] [DOC: 9207838] ℹ️  Calculated age: 83 from DOB: 07/29/1941
[20:49:11] [DOC: 9207838] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:49:11] [DOC: 9207838] ℹ️  Payer Source extracted: ''
[20:49:11] [DOC: 9207838] ℹ️  Diagnosis codes being written:
[20:49:11] [DOC: 9207838] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:49:11] [DOC: 9207838] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:49:11] [DOC: 9207838] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:49:11] [DOC: 9207838] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:49:11] [DOC: 9207838] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:49:11] [DOC: 9207838] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:49:11] [DOC: 9207838] ✅ Patient data written to CSV: GEORGE BRAMAN | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: A5300179941701
[20:49:11] ✅    ✅ Document 9207838 processed and saved successfully
[20:49:11] 🔄 
🔄 Step 8: Saving API details...
[20:49:11] [DOC: 9207838] ℹ️  API push details saved for document 9207838
[20:49:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207717                         ║
================================================================================
[20:49:11] ℹ️  Agency: Kindred At Home-Fall River
[20:49:11] ℹ️  Date: 03/27/2025
[20:49:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:49:15] [DOC: 9207717] ✅ Text extracted using pdfplumber (1449 chars)
[20:49:15] ✅    ✅ Text extracted using pdfplumber (1449 chars)
[20:49:15] 🔄 
🔄 Step 2: Extracting patient data...
[20:49:18] ℹ️  AI extracted raw sex value: ''
[20:49:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:49:18] ℹ️  AI extracted payer source: ''
[20:49:18] ℹ️  AI extracted diagnoses:
[20:49:18] ℹ️    - Diagnosis 1: 'None'
[20:49:18] ℹ️    - Diagnosis 2: 'None'
[20:49:18] ℹ️    - Diagnosis 3: 'None'
[20:49:18] ℹ️    - Diagnosis 4: 'None'
[20:49:18] ℹ️    - Diagnosis 5: 'None'
[20:49:18] ℹ️    - Diagnosis 6: 'None'
[20:49:18] ℹ️  Final extracted MRN: 'A5300179941701'
[20:49:18] ℹ️  Final extracted Sex: ''
[20:49:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:49:18] ℹ️  Final extracted Payer Source: ''
[20:49:18] ✅ Patient data extraction completed successfully
[20:49:18] ✅    ✅ Patient data extracted successfully
[20:49:18] 📊 Patient Response
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:49:18] ✅    ✅ Patient identified: GEORGE BRAMAN
[20:49:18] ✅    ✅ Patient name validation passed
[20:49:18] 🔄 
🔄 Step 3: Processing patient dates...
[20:49:18] [DOC: 9207717] ℹ️  DOB normalized: 07/29/1941
[20:49:18] [DOC: 9207717] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[20:49:18] [DOC: 9207717] ℹ️  Episode endOfEpisode normalized: 01/16/2025
[20:49:18] [DOC: 9207717] ✅ Patient date processing completed successfully
[20:49:18] ✅    ✅ Date processing completed
[20:49:18] 📊 Processed Patient Data
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025'}]
[20:49:18] 🔄 
🔄 Step 4: Extracting order data...
[20:49:20] ℹ️  Order extraction - MRN: 'A5300179941701'
[20:49:20] ℹ️  Order extraction - Sex: ''
[20:49:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:49:20] ℹ️  Order extraction - Payer Source: ''
[20:49:20] ✅ Order data extraction completed successfully
[20:49:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:49:20] ℹ️  Using MRN from patient data: 'A5300179941701' over 'A5300179941701'
[20:49:20] ℹ️  Inferred sex as MALE from name: GEORGE
[20:49:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:49:20] ✅ Patient name cross-validation successful
[20:49:20] ✅    ✅ Data merged successfully
[20:49:22] ✅    ✅ Order data extracted and validated
[20:49:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:49:22] [DOC: 9207717] ✅ Patient found in local cache: GEORGE BRAMAN, ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[20:49:22] ✅    ✅ Existing patient found with ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[20:49:22] 🔄 
🔄 Step 6: Pushing order to API...
[20:49:22] [DOC: 9207717] ℹ️  Pushing order via API for patient ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[20:49:23] [DOC: 9207717] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13358"}
[20:49:23] ❌    ❌ Failed to push order
[20:49:23] 🔄 
🔄 Step 7: Writing to CSV...
[20:49:23] [DOC: 9207717] ℹ️  Calculated age: 83 from DOB: 07/29/1941
[20:49:23] [DOC: 9207717] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:49:23] [DOC: 9207717] ℹ️  Payer Source extracted: ''
[20:49:23] [DOC: 9207717] ℹ️  Diagnosis codes being written:
[20:49:23] [DOC: 9207717] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:49:23] [DOC: 9207717] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:49:23] [DOC: 9207717] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:49:23] [DOC: 9207717] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:49:23] [DOC: 9207717] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:49:23] [DOC: 9207717] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:49:23] [DOC: 9207717] ✅ Patient data written to CSV: GEORGE BRAMAN | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: A5300179941701
[20:49:23] ✅    ✅ Document 9207717 processed and saved successfully
[20:49:23] 🔄 
🔄 Step 8: Saving API details...
[20:49:23] [DOC: 9207717] ℹ️  API push details saved for document 9207717
[20:49:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207701                         ║
================================================================================
[20:49:23] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[20:49:23] ℹ️  Date: 03/27/2025
[20:49:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:49:25] [DOC: 9207701] ✅ Text extracted using pdfplumber (5010 chars)
[20:49:25] ✅    ✅ Text extracted using pdfplumber (5010 chars)
[20:49:25] 🔄 
🔄 Step 2: Extracting patient data...
[20:49:28] ℹ️  AI extracted raw sex value: 'M'
[20:49:28] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:49:28] ℹ️  AI extracted payer source: ''
[20:49:28] ℹ️  AI extracted diagnoses:
[20:49:28] ℹ️    - Diagnosis 1: 'F20.0'
[20:49:28] ℹ️    - Diagnosis 2: 'None'
[20:49:28] ℹ️    - Diagnosis 3: 'None'
[20:49:28] ℹ️    - Diagnosis 4: 'None'
[20:49:28] ℹ️    - Diagnosis 5: 'None'
[20:49:28] ℹ️    - Diagnosis 6: 'None'
[20:49:28] ℹ️  Final extracted MRN: '174003'
[20:49:28] ℹ️  Final extracted Sex: 'MALE'
[20:49:28] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:49:28] ℹ️  Final extracted Payer Source: ''
[20:49:28] ✅ Patient data extraction completed successfully
[20:49:28] ✅    ✅ Patient data extracted successfully
[20:49:28] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 227504
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:49:28] ✅    ✅ Patient identified: Julio Philogene
[20:49:28] ✅    ✅ Patient name validation passed
[20:49:28] 🔄 
🔄 Step 3: Processing patient dates...
[20:49:28] [DOC: 9207701] ℹ️  DOB normalized: 07/29/1980
[20:49:28] [DOC: 9207701] ℹ️  Episode startOfCare normalized: 09/08/2017
[20:49:28] [DOC: 9207701] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[20:49:28] [DOC: 9207701] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[20:49:28] [DOC: 9207701] ✅ Patient date processing completed successfully
[20:49:28] ✅    ✅ Date processing completed
[20:49:28] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 227504
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F20.0'}]
[20:49:28] 🔄 
🔄 Step 4: Extracting order data...
[20:49:31] ℹ️  Order extraction - MRN: '174003'
[20:49:31] ℹ️  Order extraction - Sex: 'MALE'
[20:49:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:49:31] ℹ️  Order extraction - Payer Source: ''
[20:49:31] ✅ Order data extraction completed successfully
[20:49:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:49:31] ℹ️  Using MRN from patient data: '174003' over '174003'
[20:49:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:49:31] ✅ Patient name cross-validation successful
[20:49:31] ✅    ✅ Data merged successfully
[20:49:32] ✅    ✅ Order data extracted and validated
[20:49:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:49:32] [DOC: 9207701] ✅ Patient found in local cache: Julio Philogene, ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[20:49:32] ✅    ✅ Existing patient found with ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[20:49:32] 🔄 
🔄 Step 6: Pushing order to API...
[20:49:32] [DOC: 9207701] ℹ️  Pushing order via API for patient ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[20:49:34] [DOC: 9207701] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:49:34] ❌    ❌ Failed to push order
[20:49:34] 🔄 
🔄 Step 7: Writing to CSV...
[20:49:34] [DOC: 9207701] ℹ️  Calculated age: 44 from DOB: 07/29/1980
[20:49:34] [DOC: 9207701] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:49:34] [DOC: 9207701] ℹ️  Payer Source extracted: ''
[20:49:34] [DOC: 9207701] ℹ️  Diagnosis codes being written:
[20:49:34] [DOC: 9207701] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.0'
[20:49:34] [DOC: 9207701] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:49:34] [DOC: 9207701] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:49:34] [DOC: 9207701] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:49:34] [DOC: 9207701] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:49:34] [DOC: 9207701] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:49:34] [DOC: 9207701] ✅ Patient data written to CSV: Julio Philogene | Sex: MALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 174003
[20:49:34] ✅    ✅ Document 9207701 processed and saved successfully
[20:49:34] 🔄 
🔄 Step 8: Saving API details...
[20:49:34] [DOC: 9207701] ℹ️  API push details saved for document 9207701
[20:49:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207639                         ║
================================================================================
[20:49:34] ℹ️  Agency: AccentCare Fall River
[20:49:34] ℹ️  Date: 03/27/2025
[20:49:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:50:06] [DOC: 9207639] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[20:50:16] [DOC: 9207639] ✅ Text extracted using tesseract_ocr (18502 chars)
[20:50:16] ✅    ✅ Text extracted using tesseract_ocr (18476 chars)
[20:50:16] 🔄 
🔄 Step 2: Extracting patient data...
[20:50:19] ℹ️  AI extracted raw sex value: 'M'
[20:50:19] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[20:50:19] ℹ️  AI extracted payer source: 'Medicare'
[20:50:19] ℹ️  AI extracted diagnoses:
[20:50:19] ℹ️    - Diagnosis 1: 'I21.02'
[20:50:19] ℹ️    - Diagnosis 2: 'I11.0'
[20:50:19] ℹ️    - Diagnosis 3: 'I50.20'
[20:50:19] ℹ️    - Diagnosis 4: 'E11.9'
[20:50:19] ℹ️    - Diagnosis 5: 'J96.01'
[20:50:19] ℹ️    - Diagnosis 6: 'E78.5'
[20:50:19] ℹ️  Final extracted MRN: '0200233978101'
[20:50:19] ℹ️  Final extracted Sex: 'MALE'
[20:50:19] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[20:50:19] ℹ️  Final extracted Payer Source: 'Medicare'
[20:50:19] ✅ Patient data extraction completed successfully
[20:50:19] ✅    ✅ Patient data extracted successfully
[20:50:19] 📊 Patient Response
     └─ patientFName: PAULO
     └─ patientLName: SANTOS
     └─ dob: 04/12/1971
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200233978101
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 13 SUSAN LANE
     └─ city: MIDDLEBORO
     └─ state: MA
     └─ zip: 02346
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'I21.02', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.20', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'E78.5'}]
[20:50:19] ✅    ✅ Patient identified: PAULO SANTOS
[20:50:19] ✅    ✅ Patient name validation passed
[20:50:19] 🔄 
🔄 Step 3: Processing patient dates...
[20:50:19] [DOC: 9207639] ℹ️  DOB normalized: 04/12/1971
[20:50:19] [DOC: 9207639] ℹ️  Episode startOfCare normalized: 03/14/2025
[20:50:19] [DOC: 9207639] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[20:50:19] [DOC: 9207639] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[20:50:19] [DOC: 9207639] ✅ Patient date processing completed successfully
[20:50:19] ✅    ✅ Date processing completed
[20:50:19] 📊 Processed Patient Data
     └─ patientFName: PAULO
     └─ patientLName: SANTOS
     └─ dob: 04/12/1971
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200233978101
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 13 SUSAN LANE
     └─ city: MIDDLEBORO
     └─ state: MA
     └─ zip: 02346
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'I21.02', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.20', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'E78.5'}]
[20:50:19] 🔄 
🔄 Step 4: Extracting order data...
[20:50:22] ℹ️  Order extraction - MRN: '227203'
[20:50:22] ℹ️  Order extraction - Sex: 'MALE'
[20:50:22] ℹ️  Order extraction - Service Line: 'RN, PT, OT'
[20:50:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:50:22] ✅ Order data extraction completed successfully
[20:50:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:50:22] ℹ️  Using MRN from patient data: '0200233978101' over '227203'
[20:50:22] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='RN, PT, OT' = 'OT, PT, RN, Skilled Nursing'
[20:50:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:50:22] ✅ Patient name cross-validation successful
[20:50:22] ✅    ✅ Data merged successfully
[20:50:24] ✅    ✅ Order data extracted and validated
[20:50:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:51:00] [DOC: 9207639] ℹ️  Patient not found in cache or API: PAULO SANTOS
[20:51:00] [DOC: 9207639] ℹ️  Patient not found, creating new patient via API...
[20:51:00] [DOC: 9207639] ℹ️  Creating patient via API: PAULO SANTOS
[20:51:02] [DOC: 9207639] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:51:02] ❌    ❌ Failed to create patient
[20:51:02] [DOC: 9207639] ℹ️  API push details saved for document 9207639
================================================================================
║                        Processing Document ID: 9207477                         ║
================================================================================
[20:51:02] ℹ️  Agency: AccentCare Fall River
[20:51:02] ℹ️  Date: 03/27/2025
[20:51:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:51:30] [DOC: 9207477] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[20:51:35] [DOC: 9207477] ✅ Text extracted using tesseract_ocr (8133 chars)
[20:51:35] ✅    ✅ Text extracted using tesseract_ocr (8119 chars)
[20:51:35] 🔄 
🔄 Step 2: Extracting patient data...
[20:51:38] ℹ️  AI extracted raw sex value: ''
[20:51:38] ℹ️  AI extracted service line: 'Physical Therapy'
[20:51:38] ℹ️  AI extracted payer source: ''
[20:51:38] ℹ️  AI extracted diagnoses:
[20:51:38] ℹ️    - Diagnosis 1: 'I69.354'
[20:51:38] ℹ️    - Diagnosis 2: 'G40.401'
[20:51:38] ℹ️    - Diagnosis 3: 'None'
[20:51:38] ℹ️    - Diagnosis 4: 'None'
[20:51:38] ℹ️    - Diagnosis 5: 'None'
[20:51:38] ℹ️    - Diagnosis 6: 'None'
[20:51:38] ℹ️  Final extracted MRN: 'C0200204515501'
[20:51:38] ℹ️  Final extracted Sex: ''
[20:51:38] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:51:38] ℹ️  Final extracted Payer Source: ''
[20:51:38] ✅ Patient data extraction completed successfully
[20:51:38] ✅    ✅ Patient data extracted successfully
[20:51:38] 📊 Patient Response
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/06/2025', 'endOfEpisode': None, 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'G40.401', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:51:38] ✅    ✅ Patient identified: MILTON ACOSTA JR
[20:51:38] ✅    ✅ Patient name validation passed
[20:51:38] 🔄 
🔄 Step 3: Processing patient dates...
[20:51:38] [DOC: 9207477] ℹ️  DOB normalized: 10/23/1982
[20:51:38] [DOC: 9207477] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[20:51:38] [DOC: 9207477] ✅ Patient date processing completed successfully
[20:51:38] ✅    ✅ Date processing completed
[20:51:38] 📊 Processed Patient Data
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'G40.401'}]
[20:51:38] 🔄 
🔄 Step 4: Extracting order data...
[20:51:41] ℹ️  Order extraction - MRN: 'C0200204515501'
[20:51:41] ℹ️  Order extraction - Sex: ''
[20:51:41] ℹ️  Order extraction - Service Line: 'PT'
[20:51:41] ℹ️  Order extraction - Payer Source: ''
[20:51:41] ✅ Order data extraction completed successfully
[20:51:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:51:41] ℹ️  Using MRN from patient data: 'C0200204515501' over 'C0200204515501'
[20:51:41] ℹ️  Inferred sex as MALE from name: MILTON
[20:51:41] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[20:51:41] ✅ Patient name cross-validation successful
[20:51:41] ✅    ✅ Data merged successfully
[20:51:43] ✅    ✅ Order data extracted and validated
[20:51:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:52:20] [DOC: 9207477] ℹ️  Patient not found in cache or API: MILTON ACOSTA JR
[20:52:20] [DOC: 9207477] ℹ️  Patient not found, creating new patient via API...
[20:52:20] [DOC: 9207477] ℹ️  Creating patient via API: MILTON ACOSTA JR
[20:52:22] [DOC: 9207477] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:52:22] ❌    ❌ Failed to create patient
[20:52:22] [DOC: 9207477] ℹ️  API push details saved for document 9207477
================================================================================
║                        Processing Document ID: 9207378                         ║
================================================================================
[20:52:22] ℹ️  Agency: Relief Home Health Services
[20:52:22] ℹ️  Date: 03/27/2025
[20:52:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:52:25] [DOC: 9207378] ✅ Text extracted using pdfplumber (15043 chars)
[20:52:25] ✅    ✅ Text extracted using pdfplumber (15043 chars)
[20:52:25] 🔄 
🔄 Step 2: Extracting patient data...
[20:52:29] ℹ️  AI extracted raw sex value: 'M'
[20:52:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:52:29] ℹ️  AI extracted payer source: ''
[20:52:29] ℹ️  AI extracted diagnoses:
[20:52:29] ℹ️    - Diagnosis 1: 'E11.9'
[20:52:29] ℹ️    - Diagnosis 2: 'J44.9'
[20:52:29] ℹ️    - Diagnosis 3: 'I10'
[20:52:29] ℹ️    - Diagnosis 4: 'N17.9'
[20:52:29] ℹ️    - Diagnosis 5: 'F20.0'
[20:52:29] ℹ️    - Diagnosis 6: 'E78.2'
[20:52:29] ℹ️  Final extracted MRN: 'NB0097'
[20:52:29] ℹ️  Final extracted Sex: 'MALE'
[20:52:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:52:29] ℹ️  Final extracted Payer Source: ''
[20:52:29] ✅ Patient data extraction completed successfully
[20:52:29] ✅    ✅ Patient data extracted successfully
[20:52:29] 📊 Patient Response
     └─ patientFName: DANIEL
     └─ patientLName: BERBERENA
     └─ dob: 07/28/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0097
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 17 Mill Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 995-2148
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'F20.0', 'sixthDiagnosis': 'E78.2'}]
[20:52:29] ✅    ✅ Patient identified: DANIEL BERBERENA
[20:52:29] ✅    ✅ Patient name validation passed
[20:52:29] 🔄 
🔄 Step 3: Processing patient dates...
[20:52:29] [DOC: 9207378] ℹ️  DOB normalized: 07/28/1960
[20:52:29] [DOC: 9207378] ℹ️  Episode startOfCare normalized: 03/18/2024
[20:52:29] [DOC: 9207378] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[20:52:29] [DOC: 9207378] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[20:52:29] [DOC: 9207378] ✅ Patient date processing completed successfully
[20:52:29] ✅    ✅ Date processing completed
[20:52:29] 📊 Processed Patient Data
     └─ patientFName: DANIEL
     └─ patientLName: BERBERENA
     └─ dob: 07/28/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0097
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 17 Mill Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 995-2148
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'F20.0', 'sixthDiagnosis': 'E78.2'}]
[20:52:29] 🔄 
🔄 Step 4: Extracting order data...
[20:52:31] ℹ️  Order extraction - MRN: 'NB0097'
[20:52:31] ℹ️  Order extraction - Sex: 'MALE'
[20:52:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:52:31] ℹ️  Order extraction - Payer Source: ''
[20:52:31] ✅ Order data extraction completed successfully
[20:52:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:52:31] ℹ️  Using MRN from patient data: 'NB0097' over 'NB0097'
[20:52:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:52:31] ✅ Patient name cross-validation successful
[20:52:31] ✅    ✅ Data merged successfully
[20:52:33] ✅    ✅ Order data extracted and validated
[20:52:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:52:33] [DOC: 9207378] ✅ Patient found in local cache: DANIEL BERBERENA, ID: 2b25b2e9-ebc2-45fa-8462-b4dba468ebe0
[20:52:33] ✅    ✅ Existing patient found with ID: 2b25b2e9-ebc2-45fa-8462-b4dba468ebe0
[20:52:33] 🔄 
🔄 Step 6: Pushing order to API...
[20:52:33] [DOC: 9207378] ℹ️  Pushing order via API for patient ID: 2b25b2e9-ebc2-45fa-8462-b4dba468ebe0
[20:52:34] [DOC: 9207378] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[20:52:34] ❌    ❌ Failed to push order
[20:52:34] 🔄 
🔄 Step 7: Writing to CSV...
[20:52:34] [DOC: 9207378] ℹ️  Calculated age: 64 from DOB: 07/28/1960
[20:52:34] [DOC: 9207378] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:52:34] [DOC: 9207378] ℹ️  Payer Source extracted: ''
[20:52:34] [DOC: 9207378] ℹ️  Diagnosis codes being written:
[20:52:34] [DOC: 9207378] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[20:52:34] [DOC: 9207378] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[20:52:34] [DOC: 9207378] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[20:52:34] [DOC: 9207378] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N17.9'
[20:52:34] [DOC: 9207378] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F20.0'
[20:52:34] [DOC: 9207378] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.2'
[20:52:34] [DOC: 9207378] ✅ Patient data written to CSV: DANIEL BERBERENA | Sex: MALE | Age: 64 | Service: Skilled Nursing | Payer:  | MRN: NB0097
[20:52:34] ✅    ✅ Document 9207378 processed and saved successfully
[20:52:34] 🔄 
🔄 Step 8: Saving API details...
[20:52:34] [DOC: 9207378] ℹ️  API push details saved for document 9207378
[20:52:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207238                         ║
================================================================================
[20:52:34] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[20:52:34] ℹ️  Date: 03/27/2025
[20:52:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:52:37] [DOC: 9207238] ✅ Text extracted using pdfplumber (8118 chars)
[20:52:37] ✅    ✅ Text extracted using pdfplumber (8118 chars)
[20:52:37] 🔄 
🔄 Step 2: Extracting patient data...
[20:52:41] ℹ️  AI extracted raw sex value: 'F'
[20:52:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:52:41] ℹ️  AI extracted payer source: ''
[20:52:41] ℹ️  AI extracted diagnoses:
[20:52:41] ℹ️    - Diagnosis 1: 'E11.22'
[20:52:41] ℹ️    - Diagnosis 2: 'I12.9'
[20:52:41] ℹ️    - Diagnosis 3: 'N18.31'
[20:52:41] ℹ️    - Diagnosis 4: 'F32.2'
[20:52:41] ℹ️    - Diagnosis 5: 'E11.42'
[20:52:41] ℹ️    - Diagnosis 6: 'K59.00'
[20:52:41] ℹ️  Final extracted MRN: '554005'
[20:52:41] ℹ️  Final extracted Sex: 'FEMALE'
[20:52:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:52:41] ℹ️  Final extracted Payer Source: ''
[20:52:41] ✅ Patient data extraction completed successfully
[20:52:41] ✅    ✅ Patient data extracted successfully
[20:52:41] 📊 Patient Response
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100031947029
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'F32.2', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'K59.00'}]
[20:52:41] ✅    ✅ Patient identified: Yomayra Velez-Morales
[20:52:41] ✅    ✅ Patient name validation passed
[20:52:41] 🔄 
🔄 Step 3: Processing patient dates...
[20:52:41] [DOC: 9207238] ℹ️  DOB normalized: 10/26/1975
[20:52:41] [DOC: 9207238] ℹ️  Episode startOfCare normalized: 06/04/2024
[20:52:41] [DOC: 9207238] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[20:52:41] [DOC: 9207238] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[20:52:41] [DOC: 9207238] ✅ Patient date processing completed successfully
[20:52:41] ✅    ✅ Date processing completed
[20:52:41] 📊 Processed Patient Data
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100031947029
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'F32.2', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'K59.00'}]
[20:52:41] 🔄 
🔄 Step 4: Extracting order data...
[20:52:44] ℹ️  Order extraction - MRN: '554005'
[20:52:44] ℹ️  Order extraction - Sex: 'FEMALE'
[20:52:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[20:52:44] ℹ️  Order extraction - Payer Source: ''
[20:52:44] ✅ Order data extraction completed successfully
[20:52:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:52:44] ℹ️  Using MRN from patient data: '554005' over '554005'
[20:52:44] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[20:52:44] ✅ Patient name cross-validation successful
[20:52:44] ✅    ✅ Data merged successfully
[20:52:45] ✅    ✅ Order data extracted and validated
[20:52:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:52:45] [DOC: 9207238] ✅ Patient found in local cache: Yomayra Velez-Morales, ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[20:52:45] ✅    ✅ Existing patient found with ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[20:52:45] 🔄 
🔄 Step 6: Pushing order to API...
[20:52:45] [DOC: 9207238] ℹ️  Pushing order via API for patient ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[20:52:46] [DOC: 9207238] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14386"}
[20:52:47] ❌    ❌ Failed to push order
[20:52:47] 🔄 
🔄 Step 7: Writing to CSV...
[20:52:47] [DOC: 9207238] ℹ️  Calculated age: 49 from DOB: 10/26/1975
[20:52:47] [DOC: 9207238] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[20:52:47] [DOC: 9207238] ℹ️  Payer Source extracted: ''
[20:52:47] [DOC: 9207238] ℹ️  Diagnosis codes being written:
[20:52:47] [DOC: 9207238] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[20:52:47] [DOC: 9207238] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[20:52:47] [DOC: 9207238] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[20:52:47] [DOC: 9207238] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F32.2'
[20:52:47] [DOC: 9207238] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.42'
[20:52:47] [DOC: 9207238] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.00'
[20:52:47] [DOC: 9207238] ✅ Patient data written to CSV: Yomayra Velez-Morales | Sex: FEMALE | Age: 49 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 554005
[20:52:47] ✅    ✅ Document 9207238 processed and saved successfully
[20:52:47] 🔄 
🔄 Step 8: Saving API details...
[20:52:47] [DOC: 9207238] ℹ️  API push details saved for document 9207238
[20:52:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207208                         ║
================================================================================
[20:52:47] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[20:52:47] ℹ️  Date: 03/27/2025
[20:52:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:52:50] [DOC: 9207208] ✅ Text extracted using pdfplumber (7797 chars)
[20:52:50] ✅    ✅ Text extracted using pdfplumber (7797 chars)
[20:52:50] 🔄 
🔄 Step 2: Extracting patient data...
[20:52:53] ℹ️  AI extracted raw sex value: 'F'
[20:52:53] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[20:52:53] ℹ️  AI extracted payer source: ''
[20:52:53] ℹ️  AI extracted diagnoses:
[20:52:53] ℹ️    - Diagnosis 1: 'E11.22'
[20:52:53] ℹ️    - Diagnosis 2: 'I13.0'
[20:52:53] ℹ️    - Diagnosis 3: 'I50.32'
[20:52:53] ℹ️    - Diagnosis 4: 'N18.30'
[20:52:53] ℹ️    - Diagnosis 5: 'E11.40'
[20:52:53] ℹ️    - Diagnosis 6: 'I48.0'
[20:52:53] ℹ️  Final extracted MRN: '76003'
[20:52:53] ℹ️  Final extracted Sex: 'FEMALE'
[20:52:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[20:52:53] ℹ️  Final extracted Payer Source: ''
[20:52:53] ✅ Patient data extraction completed successfully
[20:52:53] ✅    ✅ Patient data extracted successfully
[20:52:53] 📊 Patient Response
     └─ patientFName: Gili
     └─ patientLName: Aquilina
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 100030707135
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I48.0'}]
[20:52:53] ✅    ✅ Patient identified: Gili Aquilina
[20:52:53] ✅    ✅ Patient name validation passed
[20:52:53] 🔄 
🔄 Step 3: Processing patient dates...
[20:52:53] [DOC: 9207208] ℹ️  DOB normalized: 06/13/1934
[20:52:53] [DOC: 9207208] ℹ️  Episode startOfCare normalized: 08/07/2023
[20:52:53] [DOC: 9207208] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[20:52:53] [DOC: 9207208] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[20:52:53] [DOC: 9207208] ✅ Patient date processing completed successfully
[20:52:53] ✅    ✅ Date processing completed
[20:52:53] 📊 Processed Patient Data
     └─ patientFName: Gili
     └─ patientLName: Aquilina
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 100030707135
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I48.0'}]
[20:52:53] 🔄 
🔄 Step 4: Extracting order data...
[20:52:55] ℹ️  Order extraction - MRN: '76003'
[20:52:55] ℹ️  Order extraction - Sex: 'FEMALE'
[20:52:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[20:52:55] ℹ️  Order extraction - Payer Source: ''
[20:52:55] ✅ Order data extraction completed successfully
[20:52:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:52:55] ℹ️  Using MRN from patient data: '76003' over '76003'
[20:52:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[20:52:55] ✅ Patient name cross-validation successful
[20:52:55] ✅    ✅ Data merged successfully
[20:52:57] ✅    ✅ Order data extracted and validated
[20:52:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:53:21] [DOC: 9207208] ℹ️  Patient not found in cache or API: Gili Aquilina
[20:53:21] [DOC: 9207208] ℹ️  Patient not found, creating new patient via API...
[20:53:21] [DOC: 9207208] ℹ️  Creating patient via API: Gili Aquilina
[20:53:22] [DOC: 9207208] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:53:22] ❌    ❌ Failed to create patient
[20:53:22] [DOC: 9207208] ℹ️  API push details saved for document 9207208
================================================================================
║                        Processing Document ID: 9207206                         ║
================================================================================
[20:53:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:53:22] ℹ️  Date: 03/27/2025
[20:53:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:53:24] [DOC: 9207206] ✅ Text extracted using pdfplumber (1022 chars)
[20:53:24] ✅    ✅ Text extracted using pdfplumber (1022 chars)
[20:53:24] 🔄 
🔄 Step 2: Extracting patient data...
[20:53:26] ℹ️  AI extracted raw sex value: 'M'
[20:53:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:53:26] ℹ️  AI extracted payer source: ''
[20:53:26] ℹ️  AI extracted diagnoses:
[20:53:26] ℹ️    - Diagnosis 1: ''
[20:53:26] ℹ️    - Diagnosis 2: ''
[20:53:26] ℹ️    - Diagnosis 3: ''
[20:53:26] ℹ️    - Diagnosis 4: ''
[20:53:26] ℹ️    - Diagnosis 5: ''
[20:53:26] ℹ️    - Diagnosis 6: ''
[20:53:26] ℹ️  Final extracted MRN: '3018837'
[20:53:26] ℹ️  Final extracted Sex: 'MALE'
[20:53:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:53:26] ℹ️  Final extracted Payer Source: ''
[20:53:26] ✅ Patient data extraction completed successfully
[20:53:26] ✅    ✅ Patient data extracted successfully
[20:53:26] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Sweeney
     └─ dob: 02/21/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 3018837
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:53:26] ✅    ✅ Patient identified: Edward Sweeney
[20:53:26] ✅    ✅ Patient name validation passed
[20:53:26] 🔄 
🔄 Step 3: Processing patient dates...
[20:53:26] [DOC: 9207206] ℹ️  DOB normalized: 02/21/1946
[20:53:26] [DOC: 9207206] ✅ Patient date processing completed successfully
[20:53:26] ✅    ✅ Date processing completed
[20:53:26] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Sweeney
     └─ dob: 02/21/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 3018837
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:53:26] 🔄 
🔄 Step 4: Extracting order data...
[20:53:28] ℹ️  Order extraction - MRN: '3018837'
[20:53:28] ℹ️  Order extraction - Sex: 'MALE'
[20:53:28] ℹ️  Order extraction - Service Line: ''
[20:53:28] ℹ️  Order extraction - Payer Source: ''
[20:53:28] ✅ Order data extraction completed successfully
[20:53:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:53:28] ℹ️  Using MRN from patient data: '3018837' over '3018837'
[20:53:28] ℹ️  Using service line from patient data: 'Skilled Nursing'
[20:53:28] ✅ Patient name cross-validation successful
[20:53:28] ✅    ✅ Data merged successfully
[20:53:30] ✅    ✅ Order data extracted and validated
[20:53:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:53:36] [DOC: 9207206] ℹ️  Patient not found in cache or API: Edward Sweeney
[20:53:36] [DOC: 9207206] ℹ️  Patient not found, creating new patient via API...
[20:53:36] [DOC: 9207206] ℹ️  Creating patient via API: Edward Sweeney
[20:53:37] [DOC: 9207206] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:53:37] ❌    ❌ Failed to create patient
[20:53:37] [DOC: 9207206] ℹ️  API push details saved for document 9207206
================================================================================
║                        Processing Document ID: 9207197                         ║
================================================================================
[20:53:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:53:37] ℹ️  Date: 03/27/2025
[20:53:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:53:38] [DOC: 9207197] ✅ Text extracted using pdfplumber (1191 chars)
[20:53:38] ✅    ✅ Text extracted using pdfplumber (1191 chars)
[20:53:38] 🔄 
🔄 Step 2: Extracting patient data...
[20:53:41] ℹ️  AI extracted raw sex value: 'M'
[20:53:41] ℹ️  AI extracted service line: 'Nursing'
[20:53:41] ℹ️  AI extracted payer source: ''
[20:53:41] ℹ️  AI extracted diagnoses:
[20:53:41] ℹ️    - Diagnosis 1: ''
[20:53:41] ℹ️    - Diagnosis 2: ''
[20:53:41] ℹ️    - Diagnosis 3: ''
[20:53:41] ℹ️    - Diagnosis 4: ''
[20:53:41] ℹ️    - Diagnosis 5: ''
[20:53:41] ℹ️    - Diagnosis 6: ''
[20:53:41] ℹ️  Final extracted MRN: '2060640'
[20:53:41] ℹ️  Final extracted Sex: 'MALE'
[20:53:41] ℹ️  Final extracted Service Line: 'Nursing'
[20:53:41] ℹ️  Final extracted Payer Source: ''
[20:53:41] ✅ Patient data extraction completed successfully
[20:53:41] ✅    ✅ Patient data extracted successfully
[20:53:41] 📊 Patient Response
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:53:41] ✅    ✅ Patient identified: Elisio Pimental
[20:53:41] ✅    ✅ Patient name validation passed
[20:53:41] 🔄 
🔄 Step 3: Processing patient dates...
[20:53:41] [DOC: 9207197] ℹ️  DOB normalized: 05/17/1944
[20:53:41] [DOC: 9207197] ✅ Patient date processing completed successfully
[20:53:41] ✅    ✅ Date processing completed
[20:53:41] 📊 Processed Patient Data
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:53:41] 🔄 
🔄 Step 4: Extracting order data...
[20:53:43] ℹ️  Order extraction - MRN: '2060640'
[20:53:43] ℹ️  Order extraction - Sex: 'MALE'
[20:53:43] ℹ️  Order extraction - Service Line: ''
[20:53:43] ℹ️  Order extraction - Payer Source: ''
[20:53:43] ✅ Order data extraction completed successfully
[20:53:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:53:43] ℹ️  Using MRN from patient data: '2060640' over '2060640'
[20:53:43] ℹ️  Using service line from patient data: 'Nursing'
[20:53:43] ✅ Patient name cross-validation successful
[20:53:43] ✅    ✅ Data merged successfully
[20:53:45] ⚠️     ❌ Skipping - missing episode start date
[20:53:45] [DOC: 9207197] ℹ️  API push details saved for document 9207197
================================================================================
║                        Processing Document ID: 9207178                         ║
================================================================================
[20:53:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:53:45] ℹ️  Date: 03/27/2025
[20:53:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:53:47] [DOC: 9207178] ✅ Text extracted using pdfplumber (1301 chars)
[20:53:47] ✅    ✅ Text extracted using pdfplumber (1301 chars)
[20:53:47] 🔄 
🔄 Step 2: Extracting patient data...
[20:53:49] ℹ️  AI extracted raw sex value: 'F'
[20:53:49] ℹ️  AI extracted service line: 'Nursing'
[20:53:49] ℹ️  AI extracted payer source: ''
[20:53:49] ℹ️  AI extracted diagnoses:
[20:53:49] ℹ️    - Diagnosis 1: 'None'
[20:53:49] ℹ️    - Diagnosis 2: 'None'
[20:53:49] ℹ️    - Diagnosis 3: 'None'
[20:53:49] ℹ️    - Diagnosis 4: 'None'
[20:53:49] ℹ️    - Diagnosis 5: 'None'
[20:53:49] ℹ️    - Diagnosis 6: 'None'
[20:53:49] ℹ️  Final extracted MRN: '2695202'
[20:53:49] ℹ️  Final extracted Sex: 'FEMALE'
[20:53:49] ℹ️  Final extracted Service Line: 'Nursing'
[20:53:49] ℹ️  Final extracted Payer Source: ''
[20:53:49] ✅ Patient data extraction completed successfully
[20:53:49] ✅    ✅ Patient data extracted successfully
[20:53:49] 📊 Patient Response
     └─ patientFName: Jennifer
     └─ patientLName: Mare-Esteireiro
     └─ dob: 03/29/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2695202
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:53:49] ✅    ✅ Patient identified: Jennifer Mare-Esteireiro
[20:53:49] ✅    ✅ Patient name validation passed
[20:53:49] 🔄 
🔄 Step 3: Processing patient dates...
[20:53:49] [DOC: 9207178] ℹ️  DOB normalized: 03/29/1981
[20:53:49] [DOC: 9207178] ✅ Patient date processing completed successfully
[20:53:49] ✅    ✅ Date processing completed
[20:53:49] 📊 Processed Patient Data
     └─ patientFName: Jennifer
     └─ patientLName: Mare-Esteireiro
     └─ dob: 03/29/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2695202
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[20:53:49] 🔄 
🔄 Step 4: Extracting order data...
[20:53:52] ℹ️  Order extraction - MRN: '2695202'
[20:53:52] ℹ️  Order extraction - Sex: 'FEMALE'
[20:53:52] ℹ️  Order extraction - Service Line: ''
[20:53:52] ℹ️  Order extraction - Payer Source: ''
[20:53:52] ✅ Order data extraction completed successfully
[20:53:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:53:52] ℹ️  Using MRN from patient data: '2695202' over '2695202'
[20:53:52] ℹ️  Using service line from patient data: 'Nursing'
[20:53:52] ✅ Patient name cross-validation successful
[20:53:52] ✅    ✅ Data merged successfully
[20:53:53] ✅    ✅ Order data extracted and validated
[20:53:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:54:31] [DOC: 9207178] ℹ️  Patient not found in cache or API: Jennifer Mare-Esteireiro
[20:54:31] [DOC: 9207178] ℹ️  Patient not found, creating new patient via API...
[20:54:31] [DOC: 9207178] ℹ️  Creating patient via API: Jennifer Mare-Esteireiro
[20:54:33] [DOC: 9207178] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:54:33] ❌    ❌ Failed to create patient
[20:54:33] [DOC: 9207178] ℹ️  API push details saved for document 9207178
================================================================================
║                        Processing Document ID: 9207160                         ║
================================================================================
[20:54:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:54:33] ℹ️  Date: 03/27/2025
[20:54:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:54:34] [DOC: 9207160] ✅ Text extracted using pdfplumber (1087 chars)
[20:54:34] ✅    ✅ Text extracted using pdfplumber (1087 chars)
[20:54:34] 🔄 
🔄 Step 2: Extracting patient data...
[20:54:37] ℹ️  AI extracted raw sex value: 'F'
[20:54:37] ℹ️  AI extracted service line: 'RN'
[20:54:37] ℹ️  AI extracted payer source: ''
[20:54:37] ℹ️  AI extracted diagnoses:
[20:54:37] ℹ️    - Diagnosis 1: ''
[20:54:37] ℹ️    - Diagnosis 2: ''
[20:54:37] ℹ️    - Diagnosis 3: ''
[20:54:37] ℹ️    - Diagnosis 4: ''
[20:54:37] ℹ️    - Diagnosis 5: ''
[20:54:37] ℹ️    - Diagnosis 6: ''
[20:54:37] ℹ️  Final extracted MRN: '2467466'
[20:54:37] ℹ️  Final extracted Sex: 'FEMALE'
[20:54:37] ℹ️  Final extracted Service Line: 'RN'
[20:54:37] ℹ️  Final extracted Payer Source: ''
[20:54:37] ✅ Patient data extraction completed successfully
[20:54:37] ✅    ✅ Patient data extracted successfully
[20:54:37] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:54:37] ✅    ✅ Patient identified: Maria Ferreira
[20:54:37] ✅    ✅ Patient name validation passed
[20:54:37] 🔄 
🔄 Step 3: Processing patient dates...
[20:54:37] [DOC: 9207160] ℹ️  DOB normalized: 07/12/1938
[20:54:37] [DOC: 9207160] ✅ Patient date processing completed successfully
[20:54:37] ✅    ✅ Date processing completed
[20:54:37] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:54:37] 🔄 
🔄 Step 4: Extracting order data...
[20:54:39] ℹ️  Order extraction - MRN: '2467466'
[20:54:39] ℹ️  Order extraction - Sex: 'FEMALE'
[20:54:39] ℹ️  Order extraction - Service Line: ''
[20:54:39] ℹ️  Order extraction - Payer Source: ''
[20:54:39] ✅ Order data extraction completed successfully
[20:54:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:54:39] ℹ️  Using MRN from patient data: '2467466' over '2467466'
[20:54:39] ℹ️  Using service line from patient data: 'RN'
[20:54:39] ✅ Patient name cross-validation successful
[20:54:39] ✅    ✅ Data merged successfully
[20:54:40] ⚠️     ❌ Skipping - missing episode start date
[20:54:40] [DOC: 9207160] ℹ️  API push details saved for document 9207160
================================================================================
║                        Processing Document ID: 9207156                         ║
================================================================================
[20:54:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:54:40] ℹ️  Date: 03/27/2025
[20:54:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:54:44] [DOC: 9207156] ✅ Text extracted using pdfplumber (27864 chars)
[20:54:44] ✅    ✅ Text extracted using pdfplumber (27864 chars)
[20:54:44] 🔄 
🔄 Step 2: Extracting patient data...
[20:54:48] ℹ️  AI extracted raw sex value: 'Female'
[20:54:48] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[20:54:48] ℹ️  AI extracted payer source: ''
[20:54:48] ℹ️  AI extracted diagnoses:
[20:54:48] ℹ️    - Diagnosis 1: 'U07.1'
[20:54:48] ℹ️    - Diagnosis 2: 'J10.1'
[20:54:48] ℹ️    - Diagnosis 3: 'J44.1'
[20:54:48] ℹ️    - Diagnosis 4: 'A41.52'
[20:54:48] ℹ️    - Diagnosis 5: 'R65.21'
[20:54:48] ℹ️    - Diagnosis 6: 'J96.01'
[20:54:48] ℹ️  Final extracted MRN: '2455123'
[20:54:48] ℹ️  Final extracted Sex: 'FEMALE'
[20:54:48] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[20:54:48] ℹ️  Final extracted Payer Source: ''
[20:54:48] ✅ Patient data extraction completed successfully
[20:54:48] ✅    ✅ Patient data extracted successfully
[20:54:48] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'A41.52', 'fifthDiagnosis': 'R65.21', 'sixthDiagnosis': 'J96.01'}]
[20:54:48] ✅    ✅ Patient identified: Donna Faria
[20:54:48] ✅    ✅ Patient name validation passed
[20:54:48] 🔄 
🔄 Step 3: Processing patient dates...
[20:54:48] [DOC: 9207156] ℹ️  DOB normalized: 04/27/1958
[20:54:48] [DOC: 9207156] ℹ️  Episode startOfCare normalized: 03/12/2025
[20:54:48] [DOC: 9207156] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[20:54:48] [DOC: 9207156] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[20:54:48] [DOC: 9207156] ✅ Patient date processing completed successfully
[20:54:48] ✅    ✅ Date processing completed
[20:54:48] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'A41.52', 'fifthDiagnosis': 'R65.21', 'sixthDiagnosis': 'J96.01'}]
[20:54:48] 🔄 
🔄 Step 4: Extracting order data...
[20:54:51] ℹ️  Order extraction - MRN: '2455123'
[20:54:51] ℹ️  Order extraction - Sex: 'FEMALE'
[20:54:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[20:54:51] ℹ️  Order extraction - Payer Source: ''
[20:54:51] ✅ Order data extraction completed successfully
[20:54:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:54:51] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[20:54:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[20:54:51] ✅ Patient name cross-validation successful
[20:54:51] ✅    ✅ Data merged successfully
[20:54:52] ✅    ✅ Order data extracted and validated
[20:54:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:54:52] [DOC: 9207156] ✅ Patient found in local cache: Donna Faria, ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[20:54:52] ✅    ✅ Existing patient found with ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[20:54:52] 🔄 
🔄 Step 6: Pushing order to API...
[20:54:52] [DOC: 9207156] ℹ️  Pushing order via API for patient ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[20:54:54] [DOC: 9207156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14142"}
[20:54:54] ❌    ❌ Failed to push order
[20:54:54] 🔄 
🔄 Step 7: Writing to CSV...
[20:54:54] [DOC: 9207156] ℹ️  Calculated age: 67 from DOB: 04/27/1958
[20:54:54] [DOC: 9207156] ℹ️  Service Line extracted: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[20:54:54] [DOC: 9207156] ℹ️  Payer Source extracted: ''
[20:54:54] [DOC: 9207156] ℹ️  Diagnosis codes being written:
[20:54:54] [DOC: 9207156] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[20:54:54] [DOC: 9207156] ℹ️    - Latest_Episode_Seconddiagnosis: 'J10.1'
[20:54:54] [DOC: 9207156] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[20:54:54] [DOC: 9207156] ℹ️    - Latest_Episode_Fourthdiagnosis: 'A41.52'
[20:54:54] [DOC: 9207156] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R65.21'
[20:54:54] [DOC: 9207156] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J96.01'
[20:54:54] [DOC: 9207156] ✅ Patient data written to CSV: Donna Faria | Sex: FEMALE | Age: 67 | Service: Skilled Nursing,Physical Therapy,Occupational Therapy | Payer:  | MRN: 2455123
[20:54:54] ✅    ✅ Document 9207156 processed and saved successfully
[20:54:54] 🔄 
🔄 Step 8: Saving API details...
[20:54:54] [DOC: 9207156] ℹ️  API push details saved for document 9207156
[20:54:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207122                         ║
================================================================================
[20:54:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:54:54] ℹ️  Date: 03/27/2025
[20:54:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:54:57] [DOC: 9207122] ✅ Text extracted using pdfplumber (17790 chars)
[20:54:57] ✅    ✅ Text extracted using pdfplumber (17790 chars)
[20:54:57] 🔄 
🔄 Step 2: Extracting patient data...
[20:55:00] ℹ️  AI extracted raw sex value: 'Female'
[20:55:00] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work'
[20:55:00] ℹ️  AI extracted payer source: ''
[20:55:00] ℹ️  AI extracted diagnoses:
[20:55:00] ℹ️    - Diagnosis 1: 'G30.9'
[20:55:00] ℹ️    - Diagnosis 2: 'F02.811'
[20:55:00] ℹ️    - Diagnosis 3: 'F02.818'
[20:55:00] ℹ️    - Diagnosis 4: 'R29.6'
[20:55:00] ℹ️    - Diagnosis 5: 'I12.9'
[20:55:00] ℹ️    - Diagnosis 6: 'N18.31'
[20:55:00] ℹ️  Final extracted MRN: '2409497'
[20:55:00] ℹ️  Final extracted Sex: 'FEMALE'
[20:55:00] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work'
[20:55:00] ℹ️  Final extracted Payer Source: ''
[20:55:00] ✅ Patient data extraction completed successfully
[20:55:00] ✅    ✅ Patient data extracted successfully
[20:55:00] 📊 Patient Response
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.811', 'thirdDiagnosis': 'F02.818', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.31'}]
[20:55:00] ✅    ✅ Patient identified: Juliet Desnoyers
[20:55:00] ✅    ✅ Patient name validation passed
[20:55:00] 🔄 
🔄 Step 3: Processing patient dates...
[20:55:00] [DOC: 9207122] ℹ️  DOB normalized: 11/13/1938
[20:55:00] [DOC: 9207122] ℹ️  Episode startOfCare normalized: 03/15/2025
[20:55:00] [DOC: 9207122] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[20:55:00] [DOC: 9207122] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[20:55:00] [DOC: 9207122] ✅ Patient date processing completed successfully
[20:55:00] ✅    ✅ Date processing completed
[20:55:00] 📊 Processed Patient Data
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.811', 'thirdDiagnosis': 'F02.818', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.31'}]
[20:55:00] 🔄 
🔄 Step 4: Extracting order data...
[20:55:03] ℹ️  Order extraction - MRN: '2409497'
[20:55:03] ℹ️  Order extraction - Sex: 'FEMALE'
[20:55:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[20:55:03] ℹ️  Order extraction - Payer Source: ''
[20:55:03] ✅ Order data extraction completed successfully
[20:55:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:55:03] ℹ️  Using MRN from patient data: '2409497' over '2409497'
[20:55:03] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work' = 'Medical Social Work, Occupational Therapy, Physical Therapy, Skilled Nursing'
[20:55:03] ✅ Patient name cross-validation successful
[20:55:03] ✅    ✅ Data merged successfully
[20:55:04] ✅    ✅ Order data extracted and validated
[20:55:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:55:39] [DOC: 9207122] ℹ️  Patient not found in cache or API: Juliet Desnoyers
[20:55:39] [DOC: 9207122] ℹ️  Patient not found, creating new patient via API...
[20:55:39] [DOC: 9207122] ℹ️  Creating patient via API: Juliet Desnoyers
[20:55:40] [DOC: 9207122] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:55:40] ❌    ❌ Failed to create patient
[20:55:40] [DOC: 9207122] ℹ️  API push details saved for document 9207122
================================================================================
║                        Processing Document ID: 9207113                         ║
================================================================================
[20:55:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:55:40] ℹ️  Date: 03/27/2025
[20:55:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:55:42] [DOC: 9207113] ✅ Text extracted using pdfplumber (1161 chars)
[20:55:42] ✅    ✅ Text extracted using pdfplumber (1161 chars)
[20:55:42] 🔄 
🔄 Step 2: Extracting patient data...
[20:55:44] ℹ️  AI extracted raw sex value: 'F'
[20:55:44] ℹ️  AI extracted service line: 'Occupational Therapy'
[20:55:44] ℹ️  AI extracted payer source: ''
[20:55:44] ℹ️  AI extracted diagnoses:
[20:55:44] ℹ️    - Diagnosis 1: ''
[20:55:44] ℹ️    - Diagnosis 2: ''
[20:55:44] ℹ️    - Diagnosis 3: ''
[20:55:44] ℹ️    - Diagnosis 4: ''
[20:55:44] ℹ️    - Diagnosis 5: ''
[20:55:44] ℹ️    - Diagnosis 6: ''
[20:55:44] ℹ️  Final extracted MRN: '2467466'
[20:55:44] ℹ️  Final extracted Sex: 'FEMALE'
[20:55:44] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[20:55:44] ℹ️  Final extracted Payer Source: ''
[20:55:44] ✅ Patient data extraction completed successfully
[20:55:44] ✅    ✅ Patient data extracted successfully
[20:55:44] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:55:44] ✅    ✅ Patient identified: Maria Ferreira
[20:55:44] ✅    ✅ Patient name validation passed
[20:55:44] 🔄 
🔄 Step 3: Processing patient dates...
[20:55:44] [DOC: 9207113] ℹ️  DOB normalized: 07/12/1938
[20:55:44] [DOC: 9207113] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[20:55:44] [DOC: 9207113] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[20:55:44] [DOC: 9207113] ✅ Patient date processing completed successfully
[20:55:44] ✅    ✅ Date processing completed
[20:55:44] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:55:44] 🔄 
🔄 Step 4: Extracting order data...
[20:55:46] ℹ️  Order extraction - MRN: '2467466'
[20:55:46] ℹ️  Order extraction - Sex: 'FEMALE'
[20:55:46] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[20:55:46] ℹ️  Order extraction - Payer Source: ''
[20:55:46] ✅ Order data extraction completed successfully
[20:55:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:55:46] ℹ️  Using MRN from patient data: '2467466' over '2467466'
[20:55:46] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[20:55:46] ✅ Patient name cross-validation successful
[20:55:46] ✅    ✅ Data merged successfully
[20:55:48] ✅    ✅ Order data extracted and validated
[20:55:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:56:02] [DOC: 9207113] ℹ️  Patient not found in cache or API: Maria Ferreira
[20:56:02] [DOC: 9207113] ℹ️  Patient not found, creating new patient via API...
[20:56:02] [DOC: 9207113] ℹ️  Creating patient via API: Maria Ferreira
[20:56:04] [DOC: 9207113] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:56:04] ❌    ❌ Failed to create patient
[20:56:04] [DOC: 9207113] ℹ️  API push details saved for document 9207113
================================================================================
║                        Processing Document ID: 9207110                         ║
================================================================================
[20:56:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:56:04] ℹ️  Date: 03/27/2025
[20:56:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:56:09] [DOC: 9207110] ✅ Text extracted using pdfplumber (21512 chars)
[20:56:09] ✅    ✅ Text extracted using pdfplumber (21512 chars)
[20:56:09] 🔄 
🔄 Step 2: Extracting patient data...
[20:56:14] ℹ️  AI extracted raw sex value: 'F'
[20:56:14] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[20:56:14] ℹ️  AI extracted payer source: ''
[20:56:14] ℹ️  AI extracted diagnoses:
[20:56:14] ℹ️    - Diagnosis 1: 'M62.82'
[20:56:14] ℹ️    - Diagnosis 2: 'N17.9'
[20:56:14] ℹ️    - Diagnosis 3: 'I10'
[20:56:14] ℹ️    - Diagnosis 4: 'E11.9'
[20:56:14] ℹ️    - Diagnosis 5: 'D50.9'
[20:56:14] ℹ️    - Diagnosis 6: 'E78.5'
[20:56:14] ℹ️  Final extracted MRN: '2372130'
[20:56:14] ℹ️  Final extracted Sex: 'FEMALE'
[20:56:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[20:56:14] ℹ️  Final extracted Payer Source: ''
[20:56:14] ✅ Patient data extraction completed successfully
[20:56:14] ✅    ✅ Patient data extracted successfully
[20:56:14] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: Crowell
     └─ dob: 07/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2372130
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'M62.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'E78.5'}]
[20:56:14] ✅    ✅ Patient identified: Kathryn Crowell
[20:56:14] ✅    ✅ Patient name validation passed
[20:56:14] 🔄 
🔄 Step 3: Processing patient dates...
[20:56:14] [DOC: 9207110] ℹ️  DOB normalized: 07/27/1941
[20:56:14] [DOC: 9207110] ℹ️  Episode startOfCare normalized: 03/14/2025
[20:56:14] [DOC: 9207110] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[20:56:14] [DOC: 9207110] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[20:56:14] [DOC: 9207110] ✅ Patient date processing completed successfully
[20:56:14] ✅    ✅ Date processing completed
[20:56:14] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: Crowell
     └─ dob: 07/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2372130
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'M62.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'E78.5'}]
[20:56:14] 🔄 
🔄 Step 4: Extracting order data...
[20:56:17] ℹ️  Order extraction - MRN: '2372130'
[20:56:17] ℹ️  Order extraction - Sex: 'FEMALE'
[20:56:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Occupational Therapy,Physical Therapy,Home Health Aide'
[20:56:17] ℹ️  Order extraction - Payer Source: ''
[20:56:17] ✅ Order data extraction completed successfully
[20:56:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:56:17] ℹ️  Using MRN from patient data: '2372130' over '2372130'
[20:56:17] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy, Physical Therapy' + Order='Skilled Nursing,Occupational Therapy,Physical Therapy,Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[20:56:17] ✅ Patient name cross-validation successful
[20:56:17] ✅    ✅ Data merged successfully
[20:56:18] ✅    ✅ Order data extracted and validated
[20:56:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:56:18] [DOC: 9207110] ✅ Patient found in local cache: Kathryn Crowell, ID: fe874f54-af3c-4635-b78e-c3cfb9a73117
[20:56:18] ✅    ✅ Existing patient found with ID: fe874f54-af3c-4635-b78e-c3cfb9a73117
[20:56:18] 🔄 
🔄 Step 6: Pushing order to API...
[20:56:18] [DOC: 9207110] ℹ️  Pushing order via API for patient ID: fe874f54-af3c-4635-b78e-c3cfb9a73117
[20:56:19] [DOC: 9207110] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14134"}
[20:56:19] ❌    ❌ Failed to push order
[20:56:19] 🔄 
🔄 Step 7: Writing to CSV...
[20:56:19] [DOC: 9207110] ℹ️  Calculated age: 83 from DOB: 07/27/1941
[20:56:19] [DOC: 9207110] ℹ️  Service Line extracted: 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[20:56:19] [DOC: 9207110] ℹ️  Payer Source extracted: ''
[20:56:19] [DOC: 9207110] ℹ️  Diagnosis codes being written:
[20:56:19] [DOC: 9207110] ℹ️    - Latest_Episode_Firstdiagnosis: 'M62.82'
[20:56:19] [DOC: 9207110] ℹ️    - Latest_Episode_Seconddiagnosis: 'N17.9'
[20:56:19] [DOC: 9207110] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[20:56:19] [DOC: 9207110] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[20:56:19] [DOC: 9207110] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D50.9'
[20:56:19] [DOC: 9207110] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[20:56:19] [DOC: 9207110] ✅ Patient data written to CSV: Kathryn Crowell | Sex: FEMALE | Age: 83 | Service: Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2372130
[20:56:19] ✅    ✅ Document 9207110 processed and saved successfully
[20:56:19] 🔄 
🔄 Step 8: Saving API details...
[20:56:19] [DOC: 9207110] ℹ️  API push details saved for document 9207110
[20:56:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207101                         ║
================================================================================
[20:56:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:56:19] ℹ️  Date: 03/27/2025
[20:56:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:56:21] [DOC: 9207101] ✅ Text extracted using pdfplumber (1616 chars)
[20:56:21] ✅    ✅ Text extracted using pdfplumber (1616 chars)
[20:56:21] 🔄 
🔄 Step 2: Extracting patient data...
[20:56:24] ℹ️  AI extracted raw sex value: 'F'
[20:56:24] ℹ️  AI extracted service line: 'Occupational Therapy'
[20:56:24] ℹ️  AI extracted payer source: ''
[20:56:24] ℹ️  AI extracted diagnoses:
[20:56:24] ℹ️    - Diagnosis 1: ''
[20:56:24] ℹ️    - Diagnosis 2: ''
[20:56:24] ℹ️    - Diagnosis 3: ''
[20:56:24] ℹ️    - Diagnosis 4: ''
[20:56:24] ℹ️    - Diagnosis 5: ''
[20:56:24] ℹ️    - Diagnosis 6: ''
[20:56:24] ℹ️  Final extracted MRN: '2461998'
[20:56:24] ℹ️  Final extracted Sex: 'FEMALE'
[20:56:24] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[20:56:24] ℹ️  Final extracted Payer Source: ''
[20:56:24] ✅ Patient data extraction completed successfully
[20:56:24] ✅    ✅ Patient data extracted successfully
[20:56:24] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:56:24] ✅    ✅ Patient identified: Dolores Fernandes
[20:56:24] ✅    ✅ Patient name validation passed
[20:56:24] 🔄 
🔄 Step 3: Processing patient dates...
[20:56:24] [DOC: 9207101] ℹ️  DOB normalized: 08/26/1931
[20:56:24] [DOC: 9207101] ✅ Patient date processing completed successfully
[20:56:24] ✅    ✅ Date processing completed
[20:56:24] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:56:24] 🔄 
🔄 Step 4: Extracting order data...
[20:56:26] ℹ️  Order extraction - MRN: '2461998'
[20:56:26] ℹ️  Order extraction - Sex: 'FEMALE'
[20:56:26] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[20:56:26] ℹ️  Order extraction - Payer Source: ''
[20:56:26] ✅ Order data extraction completed successfully
[20:56:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:56:26] ℹ️  Using MRN from patient data: '2461998' over '2461998'
[20:56:26] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[20:56:26] ✅ Patient name cross-validation successful
[20:56:26] ✅    ✅ Data merged successfully
[20:56:27] ✅    ✅ Order data extracted and validated
[20:56:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:56:27] [DOC: 9207101] ✅ Patient found in local cache: Dolores Fernandes, ID: fcab244b-32d7-404c-9e73-965d056a5073
[20:56:27] ✅    ✅ Existing patient found with ID: fcab244b-32d7-404c-9e73-965d056a5073
[20:56:27] 🔄 
🔄 Step 6: Pushing order to API...
[20:56:27] [DOC: 9207101] ℹ️  Pushing order via API for patient ID: fcab244b-32d7-404c-9e73-965d056a5073
[20:56:28] [DOC: 9207101] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14140"}
[20:56:28] ❌    ❌ Failed to push order
[20:56:28] 🔄 
🔄 Step 7: Writing to CSV...
[20:56:28] [DOC: 9207101] ℹ️  Calculated age: 93 from DOB: 08/26/1931
[20:56:28] [DOC: 9207101] ℹ️  Service Line extracted: 'Occupational Therapy'
[20:56:28] [DOC: 9207101] ℹ️  Payer Source extracted: ''
[20:56:28] [DOC: 9207101] ℹ️  Diagnosis codes being written:
[20:56:28] [DOC: 9207101] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:56:28] [DOC: 9207101] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:56:28] [DOC: 9207101] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:56:28] [DOC: 9207101] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:56:28] [DOC: 9207101] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:56:28] [DOC: 9207101] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:56:28] [DOC: 9207101] ✅ Patient data written to CSV: Dolores Fernandes | Sex: FEMALE | Age: 93 | Service: Occupational Therapy | Payer:  | MRN: 2461998
[20:56:28] ✅    ✅ Document 9207101 processed and saved successfully
[20:56:28] 🔄 
🔄 Step 8: Saving API details...
[20:56:28] [DOC: 9207101] ℹ️  API push details saved for document 9207101
[20:56:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207054                         ║
================================================================================
[20:56:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:56:28] ℹ️  Date: 03/27/2025
[20:56:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:56:30] [DOC: 9207054] ✅ Text extracted using pdfplumber (1001 chars)
[20:56:30] ✅    ✅ Text extracted using pdfplumber (1001 chars)
[20:56:30] 🔄 
🔄 Step 2: Extracting patient data...
[20:56:33] ℹ️  AI extracted raw sex value: 'F'
[20:56:33] ℹ️  AI extracted service line: 'Occupational Therapy'
[20:56:33] ℹ️  AI extracted payer source: ''
[20:56:33] ℹ️  AI extracted diagnoses:
[20:56:33] ℹ️    - Diagnosis 1: ''
[20:56:33] ℹ️    - Diagnosis 2: ''
[20:56:33] ℹ️    - Diagnosis 3: ''
[20:56:33] ℹ️    - Diagnosis 4: ''
[20:56:33] ℹ️    - Diagnosis 5: ''
[20:56:33] ℹ️    - Diagnosis 6: ''
[20:56:33] ℹ️  Final extracted MRN: '2450273'
[20:56:33] ℹ️  Final extracted Sex: 'FEMALE'
[20:56:33] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[20:56:33] ℹ️  Final extracted Payer Source: ''
[20:56:33] ✅ Patient data extraction completed successfully
[20:56:33] ✅    ✅ Patient data extracted successfully
[20:56:33] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:56:33] ✅    ✅ Patient identified: Maria Estacio
[20:56:33] ✅    ✅ Patient name validation passed
[20:56:33] 🔄 
🔄 Step 3: Processing patient dates...
[20:56:33] [DOC: 9207054] ℹ️  DOB normalized: 12/14/1935
[20:56:33] [DOC: 9207054] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[20:56:33] [DOC: 9207054] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[20:56:33] [DOC: 9207054] ✅ Patient date processing completed successfully
[20:56:33] ✅    ✅ Date processing completed
[20:56:33] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:56:33] 🔄 
🔄 Step 4: Extracting order data...
[20:56:35] ℹ️  Order extraction - MRN: '2450273'
[20:56:35] ℹ️  Order extraction - Sex: 'FEMALE'
[20:56:35] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[20:56:35] ℹ️  Order extraction - Payer Source: ''
[20:56:35] ✅ Order data extraction completed successfully
[20:56:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:56:35] ℹ️  Using MRN from patient data: '2450273' over '2450273'
[20:56:35] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[20:56:35] ✅ Patient name cross-validation successful
[20:56:35] ✅    ✅ Data merged successfully
[20:56:36] ✅    ✅ Order data extracted and validated
[20:56:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:56:41] [DOC: 9207054] ℹ️  Patient not found in cache or API: Maria Estacio
[20:56:41] [DOC: 9207054] ℹ️  Patient not found, creating new patient via API...
[20:56:41] [DOC: 9207054] ℹ️  Creating patient via API: Maria Estacio
[20:56:42] [DOC: 9207054] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:56:42] ❌    ❌ Failed to create patient
[20:56:42] [DOC: 9207054] ℹ️  API push details saved for document 9207054
================================================================================
║                        Processing Document ID: 9207047                         ║
================================================================================
[20:56:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:56:42] ℹ️  Date: 03/27/2025
[20:56:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:56:44] [DOC: 9207047] ✅ Text extracted using pdfplumber (1999 chars)
[20:56:44] ✅    ✅ Text extracted using pdfplumber (1999 chars)
[20:56:44] 🔄 
🔄 Step 2: Extracting patient data...
[20:56:47] ℹ️  AI extracted raw sex value: 'F'
[20:56:47] ℹ️  AI extracted service line: 'Physical Therapy,Occupational Therapy,Home Health Aide'
[20:56:47] ℹ️  AI extracted payer source: ''
[20:56:47] ℹ️  AI extracted diagnoses:
[20:56:47] ℹ️    - Diagnosis 1: 'None'
[20:56:47] ℹ️    - Diagnosis 2: 'None'
[20:56:47] ℹ️    - Diagnosis 3: 'None'
[20:56:47] ℹ️    - Diagnosis 4: 'None'
[20:56:47] ℹ️    - Diagnosis 5: 'None'
[20:56:47] ℹ️    - Diagnosis 6: 'None'
[20:56:47] ℹ️  Final extracted MRN: '2420800'
[20:56:47] ℹ️  Final extracted Sex: 'FEMALE'
[20:56:47] ℹ️  Final extracted Service Line: 'Physical Therapy,Occupational Therapy,Home Health Aide'
[20:56:47] ℹ️  Final extracted Payer Source: ''
[20:56:47] ✅ Patient data extraction completed successfully
[20:56:47] ✅    ✅ Patient data extracted successfully
[20:56:47] 📊 Patient Response
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy,Occupational Therapy,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:56:47] ✅    ✅ Patient identified: Sally Dobson
[20:56:47] ✅    ✅ Patient name validation passed
[20:56:47] 🔄 
🔄 Step 3: Processing patient dates...
[20:56:47] [DOC: 9207047] ℹ️  DOB normalized: 09/19/1941
[20:56:47] [DOC: 9207047] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[20:56:47] [DOC: 9207047] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[20:56:47] [DOC: 9207047] ✅ Patient date processing completed successfully
[20:56:47] ✅    ✅ Date processing completed
[20:56:47] 📊 Processed Patient Data
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy,Occupational Therapy,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/03/2025'}]
[20:56:47] 🔄 
🔄 Step 4: Extracting order data...
[20:56:49] ℹ️  Order extraction - MRN: '2420800'
[20:56:49] ℹ️  Order extraction - Sex: 'FEMALE'
[20:56:49] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[20:56:49] ℹ️  Order extraction - Payer Source: ''
[20:56:49] ✅ Order data extraction completed successfully
[20:56:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:56:49] ℹ️  Using MRN from patient data: '2420800' over '2420800'
[20:56:49] ℹ️  Combined service lines: Patient='Physical Therapy,Occupational Therapy,Home Health Aide' + Order='Physical Therapy, Occupational Therapy, Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy'
[20:56:49] ✅ Patient name cross-validation successful
[20:56:49] ✅    ✅ Data merged successfully
[20:56:51] ✅    ✅ Order data extracted and validated
[20:56:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:57:14] [DOC: 9207047] ℹ️  Patient not found in cache or API: Sally Dobson
[20:57:14] [DOC: 9207047] ℹ️  Patient not found, creating new patient via API...
[20:57:14] [DOC: 9207047] ℹ️  Creating patient via API: Sally Dobson
[20:57:15] [DOC: 9207047] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:57:15] ❌    ❌ Failed to create patient
[20:57:15] [DOC: 9207047] ℹ️  API push details saved for document 9207047
================================================================================
║                        Processing Document ID: 9206837                         ║
================================================================================
[20:57:15] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:57:15] ℹ️  Date: 03/27/2025
[20:57:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:57:17] [DOC: 9206837] ✅ Text extracted using pdfplumber (1023 chars)
[20:57:17] ✅    ✅ Text extracted using pdfplumber (1023 chars)
[20:57:17] 🔄 
🔄 Step 2: Extracting patient data...
[20:57:20] ℹ️  AI extracted raw sex value: 'M'
[20:57:20] ℹ️  AI extracted service line: 'Physical Therapy'
[20:57:20] ℹ️  AI extracted payer source: ''
[20:57:20] ℹ️  AI extracted diagnoses:
[20:57:20] ℹ️    - Diagnosis 1: ''
[20:57:20] ℹ️    - Diagnosis 2: ''
[20:57:20] ℹ️    - Diagnosis 3: ''
[20:57:20] ℹ️    - Diagnosis 4: ''
[20:57:20] ℹ️    - Diagnosis 5: ''
[20:57:20] ℹ️    - Diagnosis 6: ''
[20:57:20] ℹ️  Final extracted MRN: '2312121'
[20:57:20] ℹ️  Final extracted Sex: 'MALE'
[20:57:20] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:57:20] ℹ️  Final extracted Payer Source: ''
[20:57:20] ✅ Patient data extraction completed successfully
[20:57:20] ✅    ✅ Patient data extracted successfully
[20:57:20] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:57:20] ✅    ✅ Patient identified: Antonio Carvalho
[20:57:20] ✅    ✅ Patient name validation passed
[20:57:20] 🔄 
🔄 Step 3: Processing patient dates...
[20:57:20] [DOC: 9206837] ℹ️  DOB normalized: 07/01/1933
[20:57:20] [DOC: 9206837] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[20:57:20] [DOC: 9206837] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[20:57:20] [DOC: 9206837] ✅ Patient date processing completed successfully
[20:57:20] ✅    ✅ Date processing completed
[20:57:20] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:57:20] 🔄 
🔄 Step 4: Extracting order data...
[20:57:22] ℹ️  Order extraction - MRN: '2312121'
[20:57:22] ℹ️  Order extraction - Sex: 'MALE'
[20:57:22] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:57:22] ℹ️  Order extraction - Payer Source: ''
[20:57:22] ✅ Order data extraction completed successfully
[20:57:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:57:22] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[20:57:22] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:57:22] ✅ Patient name cross-validation successful
[20:57:22] ✅    ✅ Data merged successfully
[20:57:23] ✅    ✅ Order data extracted and validated
[20:57:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:58:07] [DOC: 9206837] ℹ️  Patient not found in cache or API: Antonio Carvalho
[20:58:07] [DOC: 9206837] ℹ️  Patient not found, creating new patient via API...
[20:58:07] [DOC: 9206837] ℹ️  Creating patient via API: Antonio Carvalho
[20:58:08] [DOC: 9206837] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:58:08] ❌    ❌ Failed to create patient
[20:58:08] [DOC: 9206837] ℹ️  API push details saved for document 9206837
================================================================================
║                        Processing Document ID: 9206831                         ║
================================================================================
[20:58:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:58:08] ℹ️  Date: 03/27/2025
[20:58:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:58:10] [DOC: 9206831] ✅ Text extracted using pdfplumber (1073 chars)
[20:58:10] ✅    ✅ Text extracted using pdfplumber (1073 chars)
[20:58:10] 🔄 
🔄 Step 2: Extracting patient data...
[20:58:13] ℹ️  AI extracted raw sex value: 'F'
[20:58:13] ℹ️  AI extracted service line: 'Physical Therapy'
[20:58:13] ℹ️  AI extracted payer source: ''
[20:58:13] ℹ️  AI extracted diagnoses:
[20:58:13] ℹ️    - Diagnosis 1: 'None'
[20:58:13] ℹ️    - Diagnosis 2: 'None'
[20:58:13] ℹ️    - Diagnosis 3: 'None'
[20:58:13] ℹ️    - Diagnosis 4: 'None'
[20:58:13] ℹ️    - Diagnosis 5: 'None'
[20:58:13] ℹ️    - Diagnosis 6: 'None'
[20:58:13] ℹ️  Final extracted MRN: '2301138'
[20:58:13] ℹ️  Final extracted Sex: 'FEMALE'
[20:58:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:58:13] ℹ️  Final extracted Payer Source: ''
[20:58:13] ✅ Patient data extraction completed successfully
[20:58:13] ✅    ✅ Patient data extracted successfully
[20:58:13] 📊 Patient Response
     └─ patientFName: Regina
     └─ patientLName: Capela
     └─ dob: 11/24/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2301138
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/23/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:58:13] ✅    ✅ Patient identified: Regina Capela
[20:58:13] ✅    ✅ Patient name validation passed
[20:58:13] 🔄 
🔄 Step 3: Processing patient dates...
[20:58:13] [DOC: 9206831] ℹ️  DOB normalized: 11/24/1943
[20:58:13] [DOC: 9206831] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[20:58:13] [DOC: 9206831] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[20:58:13] [DOC: 9206831] ✅ Patient date processing completed successfully
[20:58:13] ✅    ✅ Date processing completed
[20:58:13] 📊 Processed Patient Data
     └─ patientFName: Regina
     └─ patientLName: Capela
     └─ dob: 11/24/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2301138
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '04/19/2025'}]
[20:58:13] 🔄 
🔄 Step 4: Extracting order data...
[20:58:15] ℹ️  Order extraction - MRN: '2301138'
[20:58:15] ℹ️  Order extraction - Sex: 'FEMALE'
[20:58:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:58:15] ℹ️  Order extraction - Payer Source: ''
[20:58:15] ✅ Order data extraction completed successfully
[20:58:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:58:15] ℹ️  Using MRN from patient data: '2301138' over '2301138'
[20:58:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:58:15] ✅ Patient name cross-validation successful
[20:58:15] ✅    ✅ Data merged successfully
[20:58:17] ✅    ✅ Order data extracted and validated
[20:58:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:58:17] [DOC: 9206831] ✅ Patient found in local cache: Regina Capela, ID: 9d0c6767-1654-4303-a572-5cf37bae70bd
[20:58:17] ✅    ✅ Existing patient found with ID: 9d0c6767-1654-4303-a572-5cf37bae70bd
[20:58:17] 🔄 
🔄 Step 6: Pushing order to API...
[20:58:17] [DOC: 9206831] ℹ️  Pushing order via API for patient ID: 9d0c6767-1654-4303-a572-5cf37bae70bd
[20:58:18] [DOC: 9206831] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13439"}
[20:58:18] ❌    ❌ Failed to push order
[20:58:18] 🔄 
🔄 Step 7: Writing to CSV...
[20:58:18] [DOC: 9206831] ℹ️  Calculated age: 81 from DOB: 11/24/1943
[20:58:18] [DOC: 9206831] ℹ️  Service Line extracted: 'Physical Therapy'
[20:58:18] [DOC: 9206831] ℹ️  Payer Source extracted: ''
[20:58:18] [DOC: 9206831] ℹ️  Diagnosis codes being written:
[20:58:18] [DOC: 9206831] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:58:18] [DOC: 9206831] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:58:18] [DOC: 9206831] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:58:18] [DOC: 9206831] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:58:18] [DOC: 9206831] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:58:18] [DOC: 9206831] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:58:18] [DOC: 9206831] ✅ Patient data written to CSV: Regina Capela | Sex: FEMALE | Age: 81 | Service: Physical Therapy | Payer:  | MRN: 2301138
[20:58:18] ✅    ✅ Document 9206831 processed and saved successfully
[20:58:18] 🔄 
🔄 Step 8: Saving API details...
[20:58:18] [DOC: 9206831] ℹ️  API push details saved for document 9206831
[20:58:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206821                         ║
================================================================================
[20:58:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:58:18] ℹ️  Date: 03/27/2025
[20:58:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:58:20] [DOC: 9206821] ✅ Text extracted using pdfplumber (984 chars)
[20:58:20] ✅    ✅ Text extracted using pdfplumber (984 chars)
[20:58:20] 🔄 
🔄 Step 2: Extracting patient data...
[20:58:22] ℹ️  AI extracted raw sex value: 'F'
[20:58:22] ℹ️  AI extracted service line: 'Physical Therapy'
[20:58:22] ℹ️  AI extracted payer source: ''
[20:58:22] ℹ️  AI extracted diagnoses:
[20:58:22] ℹ️    - Diagnosis 1: ''
[20:58:22] ℹ️    - Diagnosis 2: ''
[20:58:22] ℹ️    - Diagnosis 3: ''
[20:58:22] ℹ️    - Diagnosis 4: ''
[20:58:22] ℹ️    - Diagnosis 5: ''
[20:58:22] ℹ️    - Diagnosis 6: ''
[20:58:22] ℹ️  Final extracted MRN: '3471157'
[20:58:22] ℹ️  Final extracted Sex: 'FEMALE'
[20:58:22] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:58:22] ℹ️  Final extracted Payer Source: ''
[20:58:22] ✅ Patient data extraction completed successfully
[20:58:22] ✅    ✅ Patient data extracted successfully
[20:58:22] 📊 Patient Response
     └─ patientFName: Claudia
     └─ patientLName: Boujnane
     └─ dob: 01/22/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3471157
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:58:22] ✅    ✅ Patient identified: Claudia Boujnane
[20:58:22] ✅    ✅ Patient name validation passed
[20:58:22] 🔄 
🔄 Step 3: Processing patient dates...
[20:58:22] [DOC: 9206821] ℹ️  DOB normalized: 01/22/1966
[20:58:22] [DOC: 9206821] ✅ Patient date processing completed successfully
[20:58:22] ✅    ✅ Date processing completed
[20:58:22] 📊 Processed Patient Data
     └─ patientFName: Claudia
     └─ patientLName: Boujnane
     └─ dob: 01/22/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3471157
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:58:22] 🔄 
🔄 Step 4: Extracting order data...
[20:58:24] ℹ️  Order extraction - MRN: '3471157'
[20:58:24] ℹ️  Order extraction - Sex: 'FEMALE'
[20:58:24] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:58:24] ℹ️  Order extraction - Payer Source: ''
[20:58:24] ✅ Order data extraction completed successfully
[20:58:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:58:24] ℹ️  Using MRN from patient data: '3471157' over '3471157'
[20:58:24] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:58:24] ✅ Patient name cross-validation successful
[20:58:24] ✅    ✅ Data merged successfully
[20:58:26] ✅    ✅ Order data extracted and validated
[20:58:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:58:26] [DOC: 9206821] ✅ Patient found in local cache: Claudia Boujnane, ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[20:58:26] ✅    ✅ Existing patient found with ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[20:58:26] 🔄 
🔄 Step 6: Pushing order to API...
[20:58:26] [DOC: 9206821] ℹ️  Pushing order via API for patient ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[20:58:27] [DOC: 9206821] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13318"}
[20:58:27] ❌    ❌ Failed to push order
[20:58:27] 🔄 
🔄 Step 7: Writing to CSV...
[20:58:27] [DOC: 9206821] ℹ️  Calculated age: 59 from DOB: 01/22/1966
[20:58:27] [DOC: 9206821] ℹ️  Service Line extracted: 'Physical Therapy'
[20:58:27] [DOC: 9206821] ℹ️  Payer Source extracted: ''
[20:58:27] [DOC: 9206821] ℹ️  Diagnosis codes being written:
[20:58:27] [DOC: 9206821] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[20:58:27] [DOC: 9206821] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[20:58:27] [DOC: 9206821] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[20:58:27] [DOC: 9206821] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[20:58:27] [DOC: 9206821] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[20:58:27] [DOC: 9206821] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[20:58:27] [DOC: 9206821] ✅ Patient data written to CSV: Claudia Boujnane | Sex: FEMALE | Age: 59 | Service: Physical Therapy | Payer:  | MRN: 3471157
[20:58:27] ✅    ✅ Document 9206821 processed and saved successfully
[20:58:27] 🔄 
🔄 Step 8: Saving API details...
[20:58:27] [DOC: 9206821] ℹ️  API push details saved for document 9206821
[20:58:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206745                         ║
================================================================================
[20:58:27] ℹ️  Agency: Alphacare Home Health Agency
[20:58:27] ℹ️  Date: 03/27/2025
[20:58:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:58:31] [DOC: 9206745] ✅ Text extracted using pdfplumber (1422 chars)
[20:58:31] ✅    ✅ Text extracted using pdfplumber (1422 chars)
[20:58:31] 🔄 
🔄 Step 2: Extracting patient data...
[20:58:34] ℹ️  AI extracted raw sex value: ''
[20:58:34] ℹ️  AI extracted service line: 'RN'
[20:58:34] ℹ️  AI extracted payer source: ''
[20:58:34] ℹ️  AI extracted diagnoses:
[20:58:34] ℹ️    - Diagnosis 1: 'None'
[20:58:34] ℹ️    - Diagnosis 2: 'None'
[20:58:34] ℹ️    - Diagnosis 3: 'None'
[20:58:34] ℹ️    - Diagnosis 4: 'None'
[20:58:34] ℹ️    - Diagnosis 5: 'None'
[20:58:34] ℹ️    - Diagnosis 6: 'None'
[20:58:34] ℹ️  Final extracted MRN: '000000015'
[20:58:34] ℹ️  Final extracted Sex: ''
[20:58:34] ℹ️  Final extracted Service Line: 'RN'
[20:58:34] ℹ️  Final extracted Payer Source: ''
[20:58:34] ✅ Patient data extraction completed successfully
[20:58:34] ✅    ✅ Patient data extracted successfully
[20:58:34] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: OBrien
     └─ dob: 04/01/1950
     └─ patientSex: 
     └─ medicalRecordNo: 000000015
     └─ billingProvider: Gularek, Jordan (MD (Dr. Alliance))
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[20:58:34] ✅    ✅ Patient identified: Dennis OBrien
[20:58:34] ✅    ✅ Patient name validation passed
[20:58:34] 🔄 
🔄 Step 3: Processing patient dates...
[20:58:34] [DOC: 9206745] ℹ️  DOB normalized: 04/01/1950
[20:58:34] [DOC: 9206745] ✅ Patient date processing completed successfully
[20:58:34] ✅    ✅ Date processing completed
[20:58:34] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: OBrien
     └─ dob: 04/01/1950
     └─ patientSex: 
     └─ medicalRecordNo: 000000015
     └─ billingProvider: Gularek, Jordan (MD (Dr. Alliance))
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[20:58:34] 🔄 
🔄 Step 4: Extracting order data...
[20:58:36] ℹ️  Order extraction - MRN: '000000015'
[20:58:36] ℹ️  Order extraction - Sex: ''
[20:58:36] ℹ️  Order extraction - Service Line: 'HHA'
[20:58:36] ℹ️  Order extraction - Payer Source: ''
[20:58:36] ✅ Order data extraction completed successfully
[20:58:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:58:36] ℹ️  Using MRN from patient data: '000000015' over '000000015'
[20:58:36] ⚠️  Could not determine sex using any available method
[20:58:36] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[20:58:36] ✅ Patient name cross-validation successful
[20:58:36] ✅    ✅ Data merged successfully
[20:58:37] ⚠️     ❌ Skipping - missing episode start date
[20:58:37] [DOC: 9206745] ℹ️  API push details saved for document 9206745
================================================================================
║                        Processing Document ID: 9206712                         ║
================================================================================
[20:58:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[20:58:37] ℹ️  Date: 03/27/2025
[20:58:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:58:39] [DOC: 9206712] ✅ Text extracted using pdfplumber (1410 chars)
[20:58:39] ✅    ✅ Text extracted using pdfplumber (1410 chars)
[20:58:39] 🔄 
🔄 Step 2: Extracting patient data...
[20:58:41] ℹ️  AI extracted raw sex value: 'M'
[20:58:41] ℹ️  AI extracted service line: 'Physical Therapy'
[20:58:41] ℹ️  AI extracted payer source: ''
[20:58:41] ℹ️  AI extracted diagnoses:
[20:58:41] ℹ️    - Diagnosis 1: '10-A3, B3, C2, D2'
[20:58:41] ℹ️    - Diagnosis 2: 'COPD'
[20:58:41] ℹ️    - Diagnosis 3: 'Flu'
[20:58:41] ℹ️    - Diagnosis 4: ''
[20:58:41] ℹ️    - Diagnosis 5: ''
[20:58:41] ℹ️    - Diagnosis 6: ''
[20:58:41] ℹ️  Final extracted MRN: '2005206'
[20:58:41] ℹ️  Final extracted Sex: 'MALE'
[20:58:41] ℹ️  Final extracted Service Line: 'Physical Therapy'
[20:58:41] ℹ️  Final extracted Payer Source: ''
[20:58:41] ✅ Patient data extraction completed successfully
[20:58:41] ✅    ✅ Patient data extracted successfully
[20:58:41] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '10-A3, B3, C2, D2', 'secondDiagnosis': 'COPD', 'thirdDiagnosis': 'Flu', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:58:41] ✅    ✅ Patient identified: Jose Baptista
[20:58:41] ✅    ✅ Patient name validation passed
[20:58:41] 🔄 
🔄 Step 3: Processing patient dates...
[20:58:41] [DOC: 9206712] ℹ️  DOB normalized: 07/02/1934
[20:58:41] [DOC: 9206712] ✅ Patient date processing completed successfully
[20:58:41] ✅    ✅ Date processing completed
[20:58:41] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '10-A3, B3, C2, D2', 'secondDiagnosis': 'COPD', 'thirdDiagnosis': 'Flu', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[20:58:41] 🔄 
🔄 Step 4: Extracting order data...
[20:58:44] ℹ️  Order extraction - MRN: '2005206'
[20:58:44] ℹ️  Order extraction - Sex: 'MALE'
[20:58:44] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[20:58:44] ℹ️  Order extraction - Payer Source: ''
[20:58:44] ✅ Order data extraction completed successfully
[20:58:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:58:44] ℹ️  Using MRN from patient data: '2005206' over '2005206'
[20:58:44] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[20:58:44] ✅ Patient name cross-validation successful
[20:58:44] ✅    ✅ Data merged successfully
[20:58:45] ✅    ✅ Order data extracted and validated
[20:58:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:59:14] [DOC: 9206712] ℹ️  Patient not found in cache or API: Jose Baptista
[20:59:14] [DOC: 9206712] ℹ️  Patient not found, creating new patient via API...
[20:59:14] [DOC: 9206712] ℹ️  Creating patient via API: Jose Baptista
[20:59:16] [DOC: 9206712] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[20:59:16] ❌    ❌ Failed to create patient
[20:59:16] [DOC: 9206712] ℹ️  API push details saved for document 9206712
================================================================================
║                        Processing Document ID: 9206542                         ║
================================================================================
[20:59:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[20:59:16] ℹ️  Date: 03/27/2025
[20:59:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:59:20] [DOC: 9206542] ✅ Text extracted using pdfplumber (11375 chars)
[20:59:20] ✅    ✅ Text extracted using pdfplumber (11375 chars)
[20:59:20] 🔄 
🔄 Step 2: Extracting patient data...
[20:59:24] ℹ️  AI extracted raw sex value: 'M'
[20:59:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:59:24] ℹ️  AI extracted payer source: 'Medicare'
[20:59:24] ℹ️  AI extracted diagnoses:
[20:59:24] ℹ️    - Diagnosis 1: 'F03.90'
[20:59:24] ℹ️    - Diagnosis 2: 'E11.65'
[20:59:24] ℹ️    - Diagnosis 3: 'I10'
[20:59:24] ℹ️    - Diagnosis 4: 'I48.0'
[20:59:24] ℹ️    - Diagnosis 5: 'R63.4'
[20:59:24] ℹ️    - Diagnosis 6: 'Z68.26'
[20:59:24] ℹ️  Final extracted MRN: 'MA230712124102'
[20:59:24] ℹ️  Final extracted Sex: 'MALE'
[20:59:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:59:24] ℹ️  Final extracted Payer Source: 'Medicare'
[20:59:24] ✅ Patient data extraction completed successfully
[20:59:24] ✅    ✅ Patient data extracted successfully
[20:59:24] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[20:59:24] ✅    ✅ Patient identified: Hiram Cordero
[20:59:24] ✅    ✅ Patient name validation passed
[20:59:24] 🔄 
🔄 Step 3: Processing patient dates...
[20:59:24] [DOC: 9206542] ℹ️  DOB normalized: 12/08/1941
[20:59:24] [DOC: 9206542] ℹ️  Episode startOfCare normalized: 03/21/2024
[20:59:24] [DOC: 9206542] ℹ️  Episode startOfEpisode normalized: 11/16/2024
[20:59:24] [DOC: 9206542] ℹ️  Episode endOfEpisode normalized: 01/14/2025
[20:59:24] [DOC: 9206542] ✅ Patient date processing completed successfully
[20:59:24] ✅    ✅ Date processing completed
[20:59:24] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[20:59:24] 🔄 
🔄 Step 4: Extracting order data...
[20:59:27] ℹ️  Order extraction - MRN: 'MA230712124102'
[20:59:27] ℹ️  Order extraction - Sex: 'MALE'
[20:59:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:59:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:59:27] ✅ Order data extraction completed successfully
[20:59:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:59:27] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[20:59:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:59:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:59:27] ✅ Patient name cross-validation successful
[20:59:27] ✅    ✅ Data merged successfully
[20:59:28] ✅    ✅ Order data extracted and validated
[20:59:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:59:28] [DOC: 9206542] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[20:59:28] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[20:59:28] 🔄 
🔄 Step 6: Pushing order to API...
[20:59:28] [DOC: 9206542] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[20:59:29] [DOC: 9206542] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13646"}
[20:59:29] ❌    ❌ Failed to push order
[20:59:29] 🔄 
🔄 Step 7: Writing to CSV...
[20:59:29] [DOC: 9206542] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[20:59:29] [DOC: 9206542] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:59:29] [DOC: 9206542] ℹ️  Payer Source extracted: 'Medicare'
[20:59:29] [DOC: 9206542] ℹ️  Diagnosis codes being written:
[20:59:29] [DOC: 9206542] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[20:59:29] [DOC: 9206542] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[20:59:29] [DOC: 9206542] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[20:59:29] [DOC: 9206542] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[20:59:29] [DOC: 9206542] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[20:59:29] [DOC: 9206542] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.26'
[20:59:29] [DOC: 9206542] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230712124102
[20:59:29] ✅    ✅ Document 9206542 processed and saved successfully
[20:59:29] 🔄 
🔄 Step 8: Saving API details...
[20:59:29] [DOC: 9206542] ℹ️  API push details saved for document 9206542
[20:59:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206530                         ║
================================================================================
[20:59:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[20:59:29] ℹ️  Date: 03/27/2025
[20:59:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:59:32] [DOC: 9206530] ✅ Text extracted using pdfplumber (9326 chars)
[20:59:32] ✅    ✅ Text extracted using pdfplumber (9326 chars)
[20:59:32] 🔄 
🔄 Step 2: Extracting patient data...
[20:59:36] ℹ️  AI extracted raw sex value: 'F'
[20:59:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:59:36] ℹ️  AI extracted payer source: 'Medicare'
[20:59:36] ℹ️  AI extracted diagnoses:
[20:59:36] ℹ️    - Diagnosis 1: 'Z48.00'
[20:59:36] ℹ️    - Diagnosis 2: 'E11.51'
[20:59:36] ℹ️    - Diagnosis 3: 'I87.2'
[20:59:36] ℹ️    - Diagnosis 4: 'E66.01'
[20:59:36] ℹ️    - Diagnosis 5: 'F25.0'
[20:59:36] ℹ️    - Diagnosis 6: 'I11.0'
[20:59:36] ℹ️  Final extracted MRN: 'MA240708056102'
[20:59:36] ℹ️  Final extracted Sex: 'FEMALE'
[20:59:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:59:36] ℹ️  Final extracted Payer Source: 'Medicare'
[20:59:36] ✅ Patient data extraction completed successfully
[20:59:36] ✅    ✅ Patient data extracted successfully
[20:59:36] 📊 Patient Response
     └─ patientFName: Susan
     └─ patientLName: Turner
     └─ dob: 05/07/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240708056102
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/10/2024', 'startOfEpisode': '07/10/2024', 'endOfEpisode': '09/07/2024', 'firstDiagnosis': 'Z48.00', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I87.2', 'fourthDiagnosis': 'E66.01', 'fifthDiagnosis': 'F25.0', 'sixthDiagnosis': 'I11.0'}]
[20:59:36] ✅    ✅ Patient identified: Susan Turner
[20:59:36] ✅    ✅ Patient name validation passed
[20:59:36] 🔄 
🔄 Step 3: Processing patient dates...
[20:59:36] [DOC: 9206530] ℹ️  DOB normalized: 05/07/1961
[20:59:36] [DOC: 9206530] ℹ️  Episode startOfCare normalized: 07/10/2024
[20:59:36] [DOC: 9206530] ℹ️  Episode startOfEpisode normalized: 07/10/2024
[20:59:36] [DOC: 9206530] ℹ️  Episode endOfEpisode normalized: 09/07/2024
[20:59:36] [DOC: 9206530] ✅ Patient date processing completed successfully
[20:59:36] ✅    ✅ Date processing completed
[20:59:36] 📊 Processed Patient Data
     └─ patientFName: Susan
     └─ patientLName: Turner
     └─ dob: 05/07/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240708056102
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/10/2024', 'startOfEpisode': '07/10/2024', 'endOfEpisode': '09/07/2024', 'firstDiagnosis': 'Z48.00', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I87.2', 'fourthDiagnosis': 'E66.01', 'fifthDiagnosis': 'F25.0', 'sixthDiagnosis': 'I11.0'}]
[20:59:36] 🔄 
🔄 Step 4: Extracting order data...
[20:59:39] ℹ️  Order extraction - MRN: 'MA240708056102'
[20:59:39] ℹ️  Order extraction - Sex: 'FEMALE'
[20:59:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:59:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[20:59:39] ✅ Order data extraction completed successfully
[20:59:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:59:39] ℹ️  Using MRN from patient data: 'MA240708056102' over 'MA240708056102'
[20:59:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:59:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[20:59:39] ✅ Patient name cross-validation successful
[20:59:39] ✅    ✅ Data merged successfully
[20:59:40] ✅    ✅ Order data extracted and validated
[20:59:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:59:40] [DOC: 9206530] ✅ Patient found in local cache: Susan Turner, ID: de2a3148-5757-4c6b-ba15-69b9525b2212
[20:59:40] ✅    ✅ Existing patient found with ID: de2a3148-5757-4c6b-ba15-69b9525b2212
[20:59:40] 🔄 
🔄 Step 6: Pushing order to API...
[20:59:40] [DOC: 9206530] ℹ️  Pushing order via API for patient ID: de2a3148-5757-4c6b-ba15-69b9525b2212
[20:59:41] [DOC: 9206530] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14363"}
[20:59:41] ❌    ❌ Failed to push order
[20:59:41] 🔄 
🔄 Step 7: Writing to CSV...
[20:59:41] [DOC: 9206530] ℹ️  Calculated age: 64 from DOB: 05/07/1961
[20:59:41] [DOC: 9206530] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:59:41] [DOC: 9206530] ℹ️  Payer Source extracted: 'Medicare'
[20:59:41] [DOC: 9206530] ℹ️  Diagnosis codes being written:
[20:59:41] [DOC: 9206530] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.00'
[20:59:41] [DOC: 9206530] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.51'
[20:59:41] [DOC: 9206530] ℹ️    - Latest_Episode_Thirddiagnosis: 'I87.2'
[20:59:41] [DOC: 9206530] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.01'
[20:59:41] [DOC: 9206530] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F25.0'
[20:59:41] [DOC: 9206530] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[20:59:41] [DOC: 9206530] ✅ Patient data written to CSV: Susan Turner | Sex: FEMALE | Age: 64 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240708056102
[20:59:41] ✅    ✅ Document 9206530 processed and saved successfully
[20:59:41] 🔄 
🔄 Step 8: Saving API details...
[20:59:41] [DOC: 9206530] ℹ️  API push details saved for document 9206530
[20:59:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206517                         ║
================================================================================
[20:59:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[20:59:41] ℹ️  Date: 03/27/2025
[20:59:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:59:44] [DOC: 9206517] ✅ Text extracted using pdfplumber (10152 chars)
[20:59:44] ✅    ✅ Text extracted using pdfplumber (10152 chars)
[20:59:44] 🔄 
🔄 Step 2: Extracting patient data...
[20:59:48] ℹ️  AI extracted raw sex value: 'M'
[20:59:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:59:48] ℹ️  AI extracted payer source: 'Medicare'
[20:59:48] ℹ️  AI extracted diagnoses:
[20:59:48] ℹ️    - Diagnosis 1: 'F03.90'
[20:59:48] ℹ️    - Diagnosis 2: 'E11.65'
[20:59:48] ℹ️    - Diagnosis 3: 'I10'
[20:59:48] ℹ️    - Diagnosis 4: 'I48.0'
[20:59:48] ℹ️    - Diagnosis 5: 'R63.4'
[20:59:48] ℹ️    - Diagnosis 6: 'Z68.26'
[20:59:48] ℹ️  Final extracted MRN: 'MA230712124102'
[20:59:48] ℹ️  Final extracted Sex: 'MALE'
[20:59:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:59:48] ℹ️  Final extracted Payer Source: 'Medicare'
[20:59:48] ✅ Patient data extraction completed successfully
[20:59:48] ✅    ✅ Patient data extracted successfully
[20:59:48] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 66 Newcomb St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[20:59:48] ✅    ✅ Patient identified: Hiram Cordero
[20:59:48] ✅    ✅ Patient name validation passed
[20:59:48] 🔄 
🔄 Step 3: Processing patient dates...
[20:59:48] [DOC: 9206517] ℹ️  DOB normalized: 12/08/1941
[20:59:48] [DOC: 9206517] ℹ️  Episode startOfCare normalized: 03/21/2024
[20:59:48] [DOC: 9206517] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[20:59:48] [DOC: 9206517] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[20:59:48] [DOC: 9206517] ✅ Patient date processing completed successfully
[20:59:48] ✅    ✅ Date processing completed
[20:59:48] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 66 Newcomb St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[20:59:48] 🔄 
🔄 Step 4: Extracting order data...
[20:59:50] ℹ️  Order extraction - MRN: 'MA230712124102'
[20:59:50] ℹ️  Order extraction - Sex: 'MALE'
[20:59:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[20:59:50] ℹ️  Order extraction - Payer Source: 'SWH'
[20:59:50] ✅ Order data extraction completed successfully
[20:59:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[20:59:50] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[20:59:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[20:59:50] ⚠️  Payer source mismatch: Patient='Medicare' vs Order='SWH', using patient data
[20:59:50] ✅ Patient name cross-validation successful
[20:59:50] ✅    ✅ Data merged successfully
[20:59:52] ✅    ✅ Order data extracted and validated
[20:59:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[20:59:52] [DOC: 9206517] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[20:59:52] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[20:59:52] 🔄 
🔄 Step 6: Pushing order to API...
[20:59:52] [DOC: 9206517] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[20:59:53] [DOC: 9206517] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13647"}
[20:59:53] ❌    ❌ Failed to push order
[20:59:53] 🔄 
🔄 Step 7: Writing to CSV...
[20:59:53] [DOC: 9206517] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[20:59:53] [DOC: 9206517] ℹ️  Service Line extracted: 'Skilled Nursing'
[20:59:53] [DOC: 9206517] ℹ️  Payer Source extracted: 'Medicare'
[20:59:53] [DOC: 9206517] ℹ️  Diagnosis codes being written:
[20:59:53] [DOC: 9206517] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[20:59:53] [DOC: 9206517] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[20:59:53] [DOC: 9206517] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[20:59:53] [DOC: 9206517] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[20:59:53] [DOC: 9206517] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[20:59:53] [DOC: 9206517] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.26'
[20:59:53] [DOC: 9206517] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230712124102
[20:59:53] ✅    ✅ Document 9206517 processed and saved successfully
[20:59:53] 🔄 
🔄 Step 8: Saving API details...
[20:59:53] [DOC: 9206517] ℹ️  API push details saved for document 9206517
[20:59:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206512                         ║
================================================================================
[20:59:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[20:59:53] ℹ️  Date: 03/27/2025
[20:59:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[20:59:55] [DOC: 9206512] ✅ Text extracted using pdfplumber (10160 chars)
[20:59:55] ✅    ✅ Text extracted using pdfplumber (10160 chars)
[20:59:55] 🔄 
🔄 Step 2: Extracting patient data...
[20:59:59] ℹ️  AI extracted raw sex value: 'M'
[20:59:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[20:59:59] ℹ️  AI extracted payer source: 'SWH'
[20:59:59] ℹ️  AI extracted diagnoses:
[20:59:59] ℹ️    - Diagnosis 1: 'F03.90'
[20:59:59] ℹ️    - Diagnosis 2: 'E11.65'
[20:59:59] ℹ️    - Diagnosis 3: 'I10'
[20:59:59] ℹ️    - Diagnosis 4: 'I48.0'
[20:59:59] ℹ️    - Diagnosis 5: 'R63.4'
[20:59:59] ℹ️    - Diagnosis 6: 'Z68.26'
[20:59:59] ℹ️  Final extracted MRN: 'MA230712124102'
[20:59:59] ℹ️  Final extracted Sex: 'MALE'
[20:59:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[20:59:59] ℹ️  Final extracted Payer Source: 'SWH'
[20:59:59] ✅ Patient data extraction completed successfully
[20:59:59] ✅    ✅ Patient data extracted successfully
[20:59:59] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[20:59:59] ✅    ✅ Patient identified: Hiram Cordero
[20:59:59] ✅    ✅ Patient name validation passed
[20:59:59] 🔄 
🔄 Step 3: Processing patient dates...
[20:59:59] [DOC: 9206512] ℹ️  DOB normalized: 12/08/1941
[20:59:59] [DOC: 9206512] ℹ️  Episode startOfCare normalized: 03/21/2024
[20:59:59] [DOC: 9206512] ℹ️  Episode startOfEpisode normalized: 11/16/2024
[20:59:59] [DOC: 9206512] ℹ️  Episode endOfEpisode normalized: 01/14/2025
[20:59:59] [DOC: 9206512] ✅ Patient date processing completed successfully
[20:59:59] ✅    ✅ Date processing completed
[20:59:59] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[20:59:59] 🔄 
🔄 Step 4: Extracting order data...
[21:00:01] ℹ️  Order extraction - MRN: 'MA230712124102'
[21:00:01] ℹ️  Order extraction - Sex: 'MALE'
[21:00:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:00:01] ℹ️  Order extraction - Payer Source: 'SWH'
[21:00:01] ✅ Order data extraction completed successfully
[21:00:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:00:01] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[21:00:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:00:01] ℹ️  Payer source consistent in both sources: 'SWH'
[21:00:01] ✅ Patient name cross-validation successful
[21:00:01] ✅    ✅ Data merged successfully
[21:00:03] ✅    ✅ Order data extracted and validated
[21:00:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:00:03] [DOC: 9206512] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[21:00:03] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[21:00:03] 🔄 
🔄 Step 6: Pushing order to API...
[21:00:03] [DOC: 9206512] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[21:00:04] [DOC: 9206512] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13646"}
[21:00:04] ❌    ❌ Failed to push order
[21:00:04] 🔄 
🔄 Step 7: Writing to CSV...
[21:00:04] [DOC: 9206512] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[21:00:04] [DOC: 9206512] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:00:04] [DOC: 9206512] ℹ️  Payer Source extracted: 'SWH'
[21:00:04] [DOC: 9206512] ℹ️  Diagnosis codes being written:
[21:00:04] [DOC: 9206512] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[21:00:04] [DOC: 9206512] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[21:00:04] [DOC: 9206512] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:00:04] [DOC: 9206512] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[21:00:04] [DOC: 9206512] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[21:00:04] [DOC: 9206512] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.26'
[21:00:04] [DOC: 9206512] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: SWH | MRN: MA230712124102
[21:00:04] ✅    ✅ Document 9206512 processed and saved successfully
[21:00:04] 🔄 
🔄 Step 8: Saving API details...
[21:00:04] [DOC: 9206512] ℹ️  API push details saved for document 9206512
[21:00:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206491                         ║
================================================================================
[21:00:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:00:04] ℹ️  Date: 03/27/2025
[21:00:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:00:06] [DOC: 9206491] ✅ Text extracted using pdfplumber (1180 chars)
[21:00:06] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[21:00:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:00:09] ℹ️  AI extracted raw sex value: ''
[21:00:09] ℹ️  AI extracted service line: 'Physical Therapy'
[21:00:09] ℹ️  AI extracted payer source: ''
[21:00:09] ℹ️  AI extracted diagnoses:
[21:00:09] ℹ️    - Diagnosis 1: 'F03.90'
[21:00:09] ℹ️    - Diagnosis 2: 'R41.0'
[21:00:09] ℹ️    - Diagnosis 3: 'I10'
[21:00:09] ℹ️    - Diagnosis 4: 'None'
[21:00:09] ℹ️    - Diagnosis 5: 'None'
[21:00:09] ℹ️    - Diagnosis 6: 'None'
[21:00:09] ℹ️  Final extracted MRN: '101002156'
[21:00:09] ℹ️  Final extracted Sex: ''
[21:00:09] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:00:09] ℹ️  Final extracted Payer Source: ''
[21:00:09] ✅ Patient data extraction completed successfully
[21:00:09] ✅    ✅ Patient data extracted successfully
[21:00:09] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:00:09] ✅    ✅ Patient identified: Eleanor Martin
[21:00:09] ✅    ✅ Patient name validation passed
[21:00:09] 🔄 
🔄 Step 3: Processing patient dates...
[21:00:09] [DOC: 9206491] ℹ️  DOB normalized: 03/25/1934
[21:00:09] [DOC: 9206491] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:00:09] [DOC: 9206491] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:00:09] [DOC: 9206491] ✅ Patient date processing completed successfully
[21:00:09] ✅    ✅ Date processing completed
[21:00:09] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10'}]
[21:00:09] 🔄 
🔄 Step 4: Extracting order data...
[21:00:12] ℹ️  Order extraction - MRN: '101002156'
[21:00:12] ℹ️  Order extraction - Sex: ''
[21:00:12] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:00:12] ℹ️  Order extraction - Payer Source: ''
[21:00:12] ✅ Order data extraction completed successfully
[21:00:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:00:12] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:00:12] ⚠️  Could not determine sex using any available method
[21:00:12] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:00:12] ✅ Patient name cross-validation successful
[21:00:12] ✅    ✅ Data merged successfully
[21:00:13] ✅    ✅ Order data extracted and validated
[21:00:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:01:01] [DOC: 9206491] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:01:01] [DOC: 9206491] ℹ️  Patient not found, creating new patient via API...
[21:01:01] [DOC: 9206491] ℹ️  Creating patient via API: Eleanor Martin
[21:01:03] [DOC: 9206491] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:01:03] ❌    ❌ Failed to create patient
[21:01:03] [DOC: 9206491] ℹ️  API push details saved for document 9206491
================================================================================
║                        Processing Document ID: 9206483                         ║
================================================================================
[21:01:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:01:03] ℹ️  Date: 03/27/2025
[21:01:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:01:06] [DOC: 9206483] ✅ Text extracted using pdfplumber (1150 chars)
[21:01:06] ✅    ✅ Text extracted using pdfplumber (1150 chars)
[21:01:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:01:09] ℹ️  AI extracted raw sex value: ''
[21:01:09] ℹ️  AI extracted service line: 'Physical Therapy'
[21:01:09] ℹ️  AI extracted payer source: ''
[21:01:09] ℹ️  AI extracted diagnoses:
[21:01:09] ℹ️    - Diagnosis 1: 'F03.90'
[21:01:09] ℹ️    - Diagnosis 2: 'R41.0'
[21:01:09] ℹ️    - Diagnosis 3: 'I10'
[21:01:09] ℹ️    - Diagnosis 4: 'None'
[21:01:09] ℹ️    - Diagnosis 5: 'None'
[21:01:09] ℹ️    - Diagnosis 6: 'None'
[21:01:09] ℹ️  Final extracted MRN: '101002156'
[21:01:09] ℹ️  Final extracted Sex: ''
[21:01:09] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:01:09] ℹ️  Final extracted Payer Source: ''
[21:01:09] ✅ Patient data extraction completed successfully
[21:01:09] ✅    ✅ Patient data extracted successfully
[21:01:09] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:01:09] ✅    ✅ Patient identified: Eleanor Martin
[21:01:09] ✅    ✅ Patient name validation passed
[21:01:09] 🔄 
🔄 Step 3: Processing patient dates...
[21:01:09] [DOC: 9206483] ℹ️  DOB normalized: 03/25/1934
[21:01:09] [DOC: 9206483] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:01:09] [DOC: 9206483] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:01:09] [DOC: 9206483] ✅ Patient date processing completed successfully
[21:01:09] ✅    ✅ Date processing completed
[21:01:09] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10'}]
[21:01:09] 🔄 
🔄 Step 4: Extracting order data...
[21:01:11] ℹ️  Order extraction - MRN: '101002156'
[21:01:11] ℹ️  Order extraction - Sex: ''
[21:01:11] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:01:11] ℹ️  Order extraction - Payer Source: ''
[21:01:11] ✅ Order data extraction completed successfully
[21:01:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:01:11] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:01:11] ⚠️  Could not determine sex using any available method
[21:01:11] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:01:11] ✅ Patient name cross-validation successful
[21:01:11] ✅    ✅ Data merged successfully
[21:01:13] ✅    ✅ Order data extracted and validated
[21:01:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:01:30] [DOC: 9206483] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:01:30] [DOC: 9206483] ℹ️  Patient not found, creating new patient via API...
[21:01:30] [DOC: 9206483] ℹ️  Creating patient via API: Eleanor Martin
[21:01:31] [DOC: 9206483] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:01:31] ❌    ❌ Failed to create patient
[21:01:31] [DOC: 9206483] ℹ️  API push details saved for document 9206483
================================================================================
║                        Processing Document ID: 9206480                         ║
================================================================================
[21:01:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:01:31] ℹ️  Date: 03/27/2025
[21:01:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:01:36] [DOC: 9206480] ✅ Text extracted using pdfplumber (15740 chars)
[21:01:37] ✅    ✅ Text extracted using pdfplumber (15740 chars)
[21:01:37] 🔄 
🔄 Step 2: Extracting patient data...
[21:01:39] ℹ️  AI extracted raw sex value: 'F'
[21:01:39] ℹ️  AI extracted service line: 'PT'
[21:01:39] ℹ️  AI extracted payer source: 'None'
[21:01:39] ℹ️  AI extracted diagnoses:
[21:01:39] ℹ️    - Diagnosis 1: 'None'
[21:01:39] ℹ️    - Diagnosis 2: 'None'
[21:01:39] ℹ️    - Diagnosis 3: 'None'
[21:01:39] ℹ️    - Diagnosis 4: 'None'
[21:01:39] ℹ️    - Diagnosis 5: 'None'
[21:01:39] ℹ️    - Diagnosis 6: 'None'
[21:01:39] ℹ️  Final extracted MRN: '101002156'
[21:01:39] ℹ️  Final extracted Sex: 'FEMALE'
[21:01:39] ℹ️  Final extracted Service Line: 'PT'
[21:01:39] ℹ️  Final extracted Payer Source: ''
[21:01:39] ✅ Patient data extraction completed successfully
[21:01:39] ✅    ✅ Patient data extracted successfully
[21:01:39] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002156
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/10/2024', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:01:39] ✅    ✅ Patient identified: Eleanor Martin
[21:01:39] ✅    ✅ Patient name validation passed
[21:01:39] 🔄 
🔄 Step 3: Processing patient dates...
[21:01:39] [DOC: 9206480] ℹ️  DOB normalized: 03/25/1934
[21:01:39] [DOC: 9206480] ℹ️  Episode startOfEpisode normalized: 12/10/2024
[21:01:39] [DOC: 9206480] ✅ Patient date processing completed successfully
[21:01:39] ✅    ✅ Date processing completed
[21:01:39] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002156
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/10/2024'}]
[21:01:39] 🔄 
🔄 Step 4: Extracting order data...
[21:01:42] ℹ️  Order extraction - MRN: '101002156'
[21:01:42] ℹ️  Order extraction - Sex: 'FEMALE'
[21:01:42] ℹ️  Order extraction - Service Line: 'PT'
[21:01:42] ℹ️  Order extraction - Payer Source: ''
[21:01:42] ✅ Order data extraction completed successfully
[21:01:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:01:42] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:01:42] ℹ️  Service line consistent in both sources: 'PT'
[21:01:42] ✅ Patient name cross-validation successful
[21:01:42] ✅    ✅ Data merged successfully
[21:01:43] ⚠️     ❌ Skipping - missing episode start date
[21:01:43] [DOC: 9206480] ℹ️  API push details saved for document 9206480
================================================================================
║                        Processing Document ID: 9206479                         ║
================================================================================
[21:01:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:01:43] ℹ️  Date: 03/27/2025
[21:01:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:01:46] [DOC: 9206479] ✅ Text extracted using pdfplumber (1413 chars)
[21:01:46] ✅    ✅ Text extracted using pdfplumber (1413 chars)
[21:01:46] 🔄 
🔄 Step 2: Extracting patient data...
[21:01:48] ℹ️  AI extracted raw sex value: ''
[21:01:48] ℹ️  AI extracted service line: 'Physical Therapy'
[21:01:48] ℹ️  AI extracted payer source: ''
[21:01:48] ℹ️  AI extracted diagnoses:
[21:01:48] ℹ️    - Diagnosis 1: 'F03.90'
[21:01:48] ℹ️    - Diagnosis 2: 'R41.0'
[21:01:48] ℹ️    - Diagnosis 3: 'I10'
[21:01:48] ℹ️    - Diagnosis 4: ''
[21:01:48] ℹ️    - Diagnosis 5: ''
[21:01:48] ℹ️    - Diagnosis 6: ''
[21:01:48] ℹ️  Final extracted MRN: '101002156'
[21:01:48] ℹ️  Final extracted Sex: ''
[21:01:48] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:01:48] ℹ️  Final extracted Payer Source: ''
[21:01:48] ✅ Patient data extraction completed successfully
[21:01:48] ✅    ✅ Patient data extracted successfully
[21:01:48] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:01:48] ✅    ✅ Patient identified: Eleanor Martin
[21:01:48] ✅    ✅ Patient name validation passed
[21:01:48] 🔄 
🔄 Step 3: Processing patient dates...
[21:01:48] [DOC: 9206479] ℹ️  DOB normalized: 03/25/1934
[21:01:48] [DOC: 9206479] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:01:48] [DOC: 9206479] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:01:48] [DOC: 9206479] ✅ Patient date processing completed successfully
[21:01:48] ✅    ✅ Date processing completed
[21:01:48] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:01:48] 🔄 
🔄 Step 4: Extracting order data...
[21:01:51] ℹ️  Order extraction - MRN: '101002156'
[21:01:51] ℹ️  Order extraction - Sex: ''
[21:01:51] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:01:51] ℹ️  Order extraction - Payer Source: ''
[21:01:51] ✅ Order data extraction completed successfully
[21:01:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:01:51] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:01:51] ⚠️  Could not determine sex using any available method
[21:01:51] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:01:51] ✅ Patient name cross-validation successful
[21:01:51] ✅    ✅ Data merged successfully
[21:01:52] ✅    ✅ Order data extracted and validated
[21:01:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:02:24] [DOC: 9206479] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:02:24] [DOC: 9206479] ℹ️  Patient not found, creating new patient via API...
[21:02:24] [DOC: 9206479] ℹ️  Creating patient via API: Eleanor Martin
[21:02:25] [DOC: 9206479] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:02:25] ❌    ❌ Failed to create patient
[21:02:25] [DOC: 9206479] ℹ️  API push details saved for document 9206479
================================================================================
║                        Processing Document ID: 9206475                         ║
================================================================================
[21:02:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:02:25] ℹ️  Date: 03/27/2025
[21:02:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:02:29] [DOC: 9206475] ✅ Text extracted using pdfplumber (1145 chars)
[21:02:29] ✅    ✅ Text extracted using pdfplumber (1145 chars)
[21:02:29] 🔄 
🔄 Step 2: Extracting patient data...
[21:02:32] ℹ️  AI extracted raw sex value: ''
[21:02:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:02:32] ℹ️  AI extracted payer source: ''
[21:02:32] ℹ️  AI extracted diagnoses:
[21:02:32] ℹ️    - Diagnosis 1: 'F03.90'
[21:02:32] ℹ️    - Diagnosis 2: 'R41.0'
[21:02:32] ℹ️    - Diagnosis 3: 'I10'
[21:02:32] ℹ️    - Diagnosis 4: ''
[21:02:32] ℹ️    - Diagnosis 5: ''
[21:02:32] ℹ️    - Diagnosis 6: ''
[21:02:32] ℹ️  Final extracted MRN: '101002156'
[21:02:32] ℹ️  Final extracted Sex: ''
[21:02:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:02:32] ℹ️  Final extracted Payer Source: ''
[21:02:32] ✅ Patient data extraction completed successfully
[21:02:32] ✅    ✅ Patient data extracted successfully
[21:02:32] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:02:32] ✅    ✅ Patient identified: Eleanor Martin
[21:02:32] ✅    ✅ Patient name validation passed
[21:02:32] 🔄 
🔄 Step 3: Processing patient dates...
[21:02:32] [DOC: 9206475] ℹ️  DOB normalized: 03/25/1934
[21:02:32] [DOC: 9206475] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:02:32] [DOC: 9206475] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:02:32] [DOC: 9206475] ✅ Patient date processing completed successfully
[21:02:32] ✅    ✅ Date processing completed
[21:02:32] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:02:32] 🔄 
🔄 Step 4: Extracting order data...
[21:02:35] ℹ️  Order extraction - MRN: '101002156'
[21:02:35] ℹ️  Order extraction - Sex: ''
[21:02:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:02:35] ℹ️  Order extraction - Payer Source: ''
[21:02:35] ✅ Order data extraction completed successfully
[21:02:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:02:35] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:02:35] ⚠️  Could not determine sex using any available method
[21:02:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:02:35] ✅ Patient name cross-validation successful
[21:02:35] ✅    ✅ Data merged successfully
[21:02:36] ✅    ✅ Order data extracted and validated
[21:02:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:02:57] [DOC: 9206475] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:02:57] [DOC: 9206475] ℹ️  Patient not found, creating new patient via API...
[21:02:57] [DOC: 9206475] ℹ️  Creating patient via API: Eleanor Martin
[21:02:58] [DOC: 9206475] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:02:58] ❌    ❌ Failed to create patient
[21:02:58] [DOC: 9206475] ℹ️  API push details saved for document 9206475
================================================================================
║                        Processing Document ID: 9206469                         ║
================================================================================
[21:02:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:02:58] ℹ️  Date: 03/27/2025
[21:02:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:03:03] [DOC: 9206469] ✅ Text extracted using pdfplumber (1393 chars)
[21:03:03] ✅    ✅ Text extracted using pdfplumber (1393 chars)
[21:03:03] 🔄 
🔄 Step 2: Extracting patient data...
[21:03:06] ℹ️  AI extracted raw sex value: ''
[21:03:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:03:06] ℹ️  AI extracted payer source: ''
[21:03:06] ℹ️  AI extracted diagnoses:
[21:03:06] ℹ️    - Diagnosis 1: 'F03.90'
[21:03:06] ℹ️    - Diagnosis 2: 'R41.0'
[21:03:06] ℹ️    - Diagnosis 3: 'I10'
[21:03:06] ℹ️    - Diagnosis 4: 'None'
[21:03:06] ℹ️    - Diagnosis 5: 'None'
[21:03:06] ℹ️    - Diagnosis 6: 'None'
[21:03:06] ℹ️  Final extracted MRN: '101002156'
[21:03:06] ℹ️  Final extracted Sex: ''
[21:03:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:03:06] ℹ️  Final extracted Payer Source: ''
[21:03:06] ✅ Patient data extraction completed successfully
[21:03:06] ✅    ✅ Patient data extracted successfully
[21:03:06] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:03:06] ✅    ✅ Patient identified: Eleanor Martin
[21:03:06] ✅    ✅ Patient name validation passed
[21:03:06] 🔄 
🔄 Step 3: Processing patient dates...
[21:03:06] [DOC: 9206469] ℹ️  DOB normalized: 03/25/1934
[21:03:06] [DOC: 9206469] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:03:06] [DOC: 9206469] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:03:06] [DOC: 9206469] ✅ Patient date processing completed successfully
[21:03:06] ✅    ✅ Date processing completed
[21:03:06] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10'}]
[21:03:06] 🔄 
🔄 Step 4: Extracting order data...
[21:03:08] ℹ️  Order extraction - MRN: '101002156'
[21:03:08] ℹ️  Order extraction - Sex: ''
[21:03:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:03:08] ℹ️  Order extraction - Payer Source: ''
[21:03:08] ✅ Order data extraction completed successfully
[21:03:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:03:08] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:03:08] ⚠️  Could not determine sex using any available method
[21:03:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:03:08] ✅ Patient name cross-validation successful
[21:03:08] ✅    ✅ Data merged successfully
[21:03:10] ✅    ✅ Order data extracted and validated
[21:03:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:03:42] [DOC: 9206469] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:03:42] [DOC: 9206469] ℹ️  Patient not found, creating new patient via API...
[21:03:42] [DOC: 9206469] ℹ️  Creating patient via API: Eleanor Martin
[21:03:44] [DOC: 9206469] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:03:44] ❌    ❌ Failed to create patient
[21:03:44] [DOC: 9206469] ℹ️  API push details saved for document 9206469
================================================================================
║                        Processing Document ID: 9206464                         ║
================================================================================
[21:03:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:03:44] ℹ️  Date: 03/27/2025
[21:03:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:03:48] [DOC: 9206464] ✅ Text extracted using pdfplumber (2907 chars)
[21:03:48] ✅    ✅ Text extracted using pdfplumber (2907 chars)
[21:03:48] 🔄 
🔄 Step 2: Extracting patient data...
[21:03:51] ℹ️  AI extracted raw sex value: ''
[21:03:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:03:51] ℹ️  AI extracted payer source: ''
[21:03:51] ℹ️  AI extracted diagnoses:
[21:03:51] ℹ️    - Diagnosis 1: 'F03.90'
[21:03:51] ℹ️    - Diagnosis 2: 'R41.0'
[21:03:51] ℹ️    - Diagnosis 3: 'I10'
[21:03:51] ℹ️    - Diagnosis 4: ''
[21:03:51] ℹ️    - Diagnosis 5: ''
[21:03:51] ℹ️    - Diagnosis 6: ''
[21:03:51] ℹ️  Final extracted MRN: '101002156'
[21:03:51] ℹ️  Final extracted Sex: ''
[21:03:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:03:51] ℹ️  Final extracted Payer Source: ''
[21:03:51] ✅ Patient data extraction completed successfully
[21:03:51] ✅    ✅ Patient data extracted successfully
[21:03:51] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:03:51] ✅    ✅ Patient identified: Eleanor Martin
[21:03:51] ✅    ✅ Patient name validation passed
[21:03:51] 🔄 
🔄 Step 3: Processing patient dates...
[21:03:51] [DOC: 9206464] ℹ️  DOB normalized: 03/25/1934
[21:03:51] [DOC: 9206464] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:03:51] [DOC: 9206464] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:03:51] [DOC: 9206464] ✅ Patient date processing completed successfully
[21:03:51] ✅    ✅ Date processing completed
[21:03:51] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:03:51] 🔄 
🔄 Step 4: Extracting order data...
[21:03:53] ℹ️  Order extraction - MRN: '101002156'
[21:03:53] ℹ️  Order extraction - Sex: ''
[21:03:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:03:53] ℹ️  Order extraction - Payer Source: ''
[21:03:53] ✅ Order data extraction completed successfully
[21:03:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:03:53] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:03:53] ⚠️  Could not determine sex using any available method
[21:03:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:03:53] ✅ Patient name cross-validation successful
[21:03:53] ✅    ✅ Data merged successfully
[21:03:55] ✅    ✅ Order data extracted and validated
[21:03:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:04:42] [DOC: 9206464] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:04:42] [DOC: 9206464] ℹ️  Patient not found, creating new patient via API...
[21:04:42] [DOC: 9206464] ℹ️  Creating patient via API: Eleanor Martin
[21:04:44] [DOC: 9206464] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:04:44] ❌    ❌ Failed to create patient
[21:04:44] [DOC: 9206464] ℹ️  API push details saved for document 9206464
================================================================================
║                        Processing Document ID: 9206461                         ║
================================================================================
[21:04:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:04:44] ℹ️  Date: 03/27/2025
[21:04:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:04:49] [DOC: 9206461] ✅ Text extracted using pdfplumber (1155 chars)
[21:04:49] ✅    ✅ Text extracted using pdfplumber (1155 chars)
[21:04:49] 🔄 
🔄 Step 2: Extracting patient data...
[21:04:52] ℹ️  AI extracted raw sex value: ''
[21:04:52] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:04:52] ℹ️  AI extracted payer source: ''
[21:04:52] ℹ️  AI extracted diagnoses:
[21:04:52] ℹ️    - Diagnosis 1: 'F03.90'
[21:04:52] ℹ️    - Diagnosis 2: 'R41.0'
[21:04:52] ℹ️    - Diagnosis 3: 'I10'
[21:04:52] ℹ️    - Diagnosis 4: ''
[21:04:52] ℹ️    - Diagnosis 5: ''
[21:04:52] ℹ️    - Diagnosis 6: ''
[21:04:52] ℹ️  Final extracted MRN: '101002156'
[21:04:52] ℹ️  Final extracted Sex: ''
[21:04:52] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:04:52] ℹ️  Final extracted Payer Source: ''
[21:04:52] ✅ Patient data extraction completed successfully
[21:04:52] ✅    ✅ Patient data extracted successfully
[21:04:52] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:04:52] ✅    ✅ Patient identified: Eleanor Martin
[21:04:52] ✅    ✅ Patient name validation passed
[21:04:52] 🔄 
🔄 Step 3: Processing patient dates...
[21:04:52] [DOC: 9206461] ℹ️  DOB normalized: 03/25/1934
[21:04:52] [DOC: 9206461] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[21:04:52] [DOC: 9206461] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[21:04:52] [DOC: 9206461] ✅ Patient date processing completed successfully
[21:04:52] ✅    ✅ Date processing completed
[21:04:52] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:04:52] 🔄 
🔄 Step 4: Extracting order data...
[21:04:54] ℹ️  Order extraction - MRN: '101002156'
[21:04:54] ℹ️  Order extraction - Sex: ''
[21:04:54] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:04:54] ℹ️  Order extraction - Payer Source: ''
[21:04:54] ✅ Order data extraction completed successfully
[21:04:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:04:54] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[21:04:54] ⚠️  Could not determine sex using any available method
[21:04:54] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:04:54] ✅ Patient name cross-validation successful
[21:04:54] ✅    ✅ Data merged successfully
[21:04:56] ✅    ✅ Order data extracted and validated
[21:04:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:05:30] [DOC: 9206461] ℹ️  Patient not found in cache or API: Eleanor Martin
[21:05:30] [DOC: 9206461] ℹ️  Patient not found, creating new patient via API...
[21:05:30] [DOC: 9206461] ℹ️  Creating patient via API: Eleanor Martin
[21:05:32] [DOC: 9206461] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:05:32] ❌    ❌ Failed to create patient
[21:05:32] [DOC: 9206461] ℹ️  API push details saved for document 9206461
================================================================================
║                        Processing Document ID: 9206449                         ║
================================================================================
[21:05:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:05:32] ℹ️  Date: 03/27/2025
[21:05:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:05:34] [DOC: 9206449] ✅ Text extracted using pdfplumber (1218 chars)
[21:05:34] ✅    ✅ Text extracted using pdfplumber (1218 chars)
[21:05:34] 🔄 
🔄 Step 2: Extracting patient data...
[21:05:37] ℹ️  AI extracted raw sex value: ''
[21:05:37] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:05:37] ℹ️  AI extracted payer source: ''
[21:05:37] ℹ️  AI extracted diagnoses:
[21:05:37] ℹ️    - Diagnosis 1: 'E11.65'
[21:05:37] ℹ️    - Diagnosis 2: 'U07.1'
[21:05:37] ℹ️    - Diagnosis 3: 'S32.048'
[21:05:37] ℹ️    - Diagnosis 4: ''
[21:05:37] ℹ️    - Diagnosis 5: ''
[21:05:37] ℹ️    - Diagnosis 6: ''
[21:05:37] ℹ️  Final extracted MRN: '100996161'
[21:05:37] ℹ️  Final extracted Sex: ''
[21:05:37] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:05:37] ℹ️  Final extracted Payer Source: ''
[21:05:37] ✅ Patient data extraction completed successfully
[21:05:37] ✅    ✅ Patient data extracted successfully
[21:05:37] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100996161
     └─ billingProvider: JUSTIN ETTER MD
     └─ npi: 1699113472
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/30/2024', 'endOfEpisode': '07/28/2024', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'S32.048', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:05:37] ✅    ✅ Patient identified: Stephen Estevez
[21:05:37] ✅    ✅ Patient name validation passed
[21:05:37] 🔄 
🔄 Step 3: Processing patient dates...
[21:05:37] [DOC: 9206449] ℹ️  DOB normalized: 10/21/1945
[21:05:37] [DOC: 9206449] ℹ️  Episode startOfEpisode normalized: 05/30/2024
[21:05:37] [DOC: 9206449] ℹ️  Episode endOfEpisode normalized: 07/28/2024
[21:05:37] [DOC: 9206449] ✅ Patient date processing completed successfully
[21:05:37] ✅    ✅ Date processing completed
[21:05:37] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100996161
     └─ billingProvider: JUSTIN ETTER MD
     └─ npi: 1699113472
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/30/2024', 'endOfEpisode': '07/28/2024', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'S32.048', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:05:37] 🔄 
🔄 Step 4: Extracting order data...
[21:05:39] ℹ️  Order extraction - MRN: '100996161'
[21:05:39] ℹ️  Order extraction - Sex: ''
[21:05:39] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:05:39] ℹ️  Order extraction - Payer Source: ''
[21:05:39] ✅ Order data extraction completed successfully
[21:05:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:05:39] ℹ️  Using MRN from patient data: '100996161' over '100996161'
[21:05:39] ℹ️  Inferred sex as MALE from name: Stephen
[21:05:39] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:05:39] ✅ Patient name cross-validation successful
[21:05:39] ✅    ✅ Data merged successfully
[21:05:41] ✅    ✅ Order data extracted and validated
[21:05:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:05:41] [DOC: 9206449] ✅ Patient found in local cache: Stephen Estevez, ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[21:05:41] ✅    ✅ Existing patient found with ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[21:05:41] 🔄 
🔄 Step 6: Pushing order to API...
[21:05:41] [DOC: 9206449] ℹ️  Pushing order via API for patient ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[21:05:42] [DOC: 9206449] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13931"}
[21:05:42] ❌    ❌ Failed to push order
[21:05:42] 🔄 
🔄 Step 7: Writing to CSV...
[21:05:42] [DOC: 9206449] ℹ️  Calculated age: 79 from DOB: 10/21/1945
[21:05:42] [DOC: 9206449] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:05:42] [DOC: 9206449] ℹ️  Payer Source extracted: ''
[21:05:42] [DOC: 9206449] ℹ️  Diagnosis codes being written:
[21:05:42] [DOC: 9206449] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[21:05:42] [DOC: 9206449] ℹ️    - Latest_Episode_Seconddiagnosis: 'U07.1'
[21:05:42] [DOC: 9206449] ℹ️    - Latest_Episode_Thirddiagnosis: 'S32.048'
[21:05:42] [DOC: 9206449] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:05:42] [DOC: 9206449] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:05:42] [DOC: 9206449] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:05:42] [DOC: 9206449] ✅ Patient data written to CSV: Stephen Estevez | Sex: MALE | Age: 79 | Service: Occupational Therapy | Payer:  | MRN: 100996161
[21:05:42] ✅    ✅ Document 9206449 processed and saved successfully
[21:05:42] 🔄 
🔄 Step 8: Saving API details...
[21:05:42] [DOC: 9206449] ℹ️  API push details saved for document 9206449
[21:05:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206295                         ║
================================================================================
[21:05:42] ℹ️  Agency: Alphacare Home Health Agency
[21:05:42] ℹ️  Date: 03/27/2025
[21:05:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:05:45] [DOC: 9206295] ✅ Text extracted using pdfplumber (1483 chars)
[21:05:45] ✅    ✅ Text extracted using pdfplumber (1483 chars)
[21:05:45] 🔄 
🔄 Step 2: Extracting patient data...
[21:05:47] ℹ️  AI extracted raw sex value: ''
[21:05:47] ℹ️  AI extracted service line: 'PT'
[21:05:47] ℹ️  AI extracted payer source: ''
[21:05:47] ℹ️  AI extracted diagnoses:
[21:05:47] ℹ️    - Diagnosis 1: ''
[21:05:47] ℹ️    - Diagnosis 2: ''
[21:05:47] ℹ️    - Diagnosis 3: ''
[21:05:47] ℹ️    - Diagnosis 4: ''
[21:05:47] ℹ️    - Diagnosis 5: ''
[21:05:47] ℹ️    - Diagnosis 6: ''
[21:05:47] ℹ️  Final extracted MRN: '000003599'
[21:05:47] ℹ️  Final extracted Sex: ''
[21:05:47] ℹ️  Final extracted Service Line: 'PT'
[21:05:47] ℹ️  Final extracted Payer Source: ''
[21:05:47] ✅ Patient data extraction completed successfully
[21:05:47] ✅    ✅ Patient data extracted successfully
[21:05:47] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:05:47] ✅    ✅ Patient identified: June Stykowski
[21:05:47] ✅    ✅ Patient name validation passed
[21:05:47] 🔄 
🔄 Step 3: Processing patient dates...
[21:05:47] [DOC: 9206295] ℹ️  DOB normalized: 11/08/1952
[21:05:47] [DOC: 9206295] ✅ Patient date processing completed successfully
[21:05:47] ✅    ✅ Date processing completed
[21:05:47] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:05:47] 🔄 
🔄 Step 4: Extracting order data...
[21:05:49] ℹ️  Order extraction - MRN: '000003599'
[21:05:49] ℹ️  Order extraction - Sex: ''
[21:05:49] ℹ️  Order extraction - Service Line: 'PT'
[21:05:49] ℹ️  Order extraction - Payer Source: ''
[21:05:49] ✅ Order data extraction completed successfully
[21:05:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:05:49] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[21:05:49] ⚠️  Could not determine sex using any available method
[21:05:49] ℹ️  Service line consistent in both sources: 'PT'
[21:05:49] ✅ Patient name cross-validation successful
[21:05:49] ✅    ✅ Data merged successfully
[21:05:51] ✅    ✅ Order data extracted and validated
[21:05:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:05:51] [DOC: 9206295] ✅ Patient found in local cache: June Stykowski, ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[21:05:51] ✅    ✅ Existing patient found with ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[21:05:51] 🔄 
🔄 Step 6: Pushing order to API...
[21:05:51] [DOC: 9206295] ℹ️  Pushing order via API for patient ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[21:05:52] [DOC: 9206295] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:05:52] ❌    ❌ Failed to push order
[21:05:52] 🔄 
🔄 Step 7: Writing to CSV...
[21:05:52] [DOC: 9206295] ℹ️  Calculated age: 72 from DOB: 11/08/1952
[21:05:52] [DOC: 9206295] ℹ️  Service Line extracted: 'PT'
[21:05:52] [DOC: 9206295] ℹ️  Payer Source extracted: ''
[21:05:52] [DOC: 9206295] ℹ️  Diagnosis codes being written:
[21:05:52] [DOC: 9206295] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:05:52] [DOC: 9206295] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:05:52] [DOC: 9206295] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:05:52] [DOC: 9206295] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:05:52] [DOC: 9206295] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:05:52] [DOC: 9206295] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:05:52] [DOC: 9206295] ✅ Patient data written to CSV: June Stykowski | Sex:  | Age: 72 | Service: PT | Payer:  | MRN: 000003599
[21:05:52] ✅    ✅ Document 9206295 processed and saved successfully
[21:05:52] 🔄 
🔄 Step 8: Saving API details...
[21:05:52] [DOC: 9206295] ℹ️  API push details saved for document 9206295
[21:05:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206249                         ║
================================================================================
[21:05:52] ℹ️  Agency: Relief Home Health Services
[21:05:52] ℹ️  Date: 03/27/2025
[21:05:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:05:57] [DOC: 9206249] ✅ Text extracted using pdfplumber (19485 chars)
[21:05:57] ✅    ✅ Text extracted using pdfplumber (19485 chars)
[21:05:57] 🔄 
🔄 Step 2: Extracting patient data...
[21:06:00] ℹ️  AI extracted raw sex value: 'F'
[21:06:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:06:00] ℹ️  AI extracted payer source: ''
[21:06:00] ℹ️  AI extracted diagnoses:
[21:06:00] ℹ️    - Diagnosis 1: 'I50.32'
[21:06:00] ℹ️    - Diagnosis 2: 'J44.9'
[21:06:00] ℹ️    - Diagnosis 3: 'E11.9'
[21:06:00] ℹ️    - Diagnosis 4: 'F32.A'
[21:06:00] ℹ️    - Diagnosis 5: 'F32.89'
[21:06:00] ℹ️    - Diagnosis 6: 'F41.9'
[21:06:00] ℹ️  Final extracted MRN: 'NB2071'
[21:06:00] ℹ️  Final extracted Sex: 'FEMALE'
[21:06:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:06:00] ℹ️  Final extracted Payer Source: ''
[21:06:00] ✅ Patient data extraction completed successfully
[21:06:00] ✅    ✅ Patient data extracted successfully
[21:06:00] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: CARREIRO
     └─ dob: 10/18/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: NB2071
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 89 SEA BREEZE DR
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 996-6084
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/29/2024', 'startOfEpisode': '12/25/2024', 'endOfEpisode': '02/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F32.89', 'sixthDiagnosis': 'F41.9'}]
[21:06:00] ✅    ✅ Patient identified: MARY CARREIRO
[21:06:00] ✅    ✅ Patient name validation passed
[21:06:00] 🔄 
🔄 Step 3: Processing patient dates...
[21:06:00] [DOC: 9206249] ℹ️  DOB normalized: 10/18/1937
[21:06:00] [DOC: 9206249] ℹ️  Episode startOfCare normalized: 02/29/2024
[21:06:00] [DOC: 9206249] ℹ️  Episode startOfEpisode normalized: 12/25/2024
[21:06:00] [DOC: 9206249] ℹ️  Episode endOfEpisode normalized: 02/22/2025
[21:06:00] [DOC: 9206249] ✅ Patient date processing completed successfully
[21:06:00] ✅    ✅ Date processing completed
[21:06:00] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: CARREIRO
     └─ dob: 10/18/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: NB2071
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 89 SEA BREEZE DR
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 996-6084
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/29/2024', 'startOfEpisode': '12/25/2024', 'endOfEpisode': '02/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F32.89', 'sixthDiagnosis': 'F41.9'}]
[21:06:00] 🔄 
🔄 Step 4: Extracting order data...
[21:06:03] ℹ️  Order extraction - MRN: 'NB2071'
[21:06:03] ℹ️  Order extraction - Sex: 'MALE'
[21:06:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:06:03] ℹ️  Order extraction - Payer Source: ''
[21:06:03] ✅ Order data extraction completed successfully
[21:06:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:06:03] ℹ️  Using MRN from patient data: 'NB2071' over 'NB2071'
[21:06:03] ⚠️  Sex mismatch: Patient='FEMALE' vs Order='MALE', using patient data
[21:06:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:06:03] ✅ Patient name cross-validation successful
[21:06:03] ✅    ✅ Data merged successfully
[21:06:05] ✅    ✅ Order data extracted and validated
[21:06:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:06:27] [DOC: 9206249] ℹ️  Patient not found in cache or API: MARY CARREIRO
[21:06:27] [DOC: 9206249] ℹ️  Patient not found, creating new patient via API...
[21:06:27] [DOC: 9206249] ℹ️  Creating patient via API: MARY CARREIRO
[21:06:28] [DOC: 9206249] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:06:28] ❌    ❌ Failed to create patient
[21:06:28] [DOC: 9206249] ℹ️  API push details saved for document 9206249
================================================================================
║                        Processing Document ID: 9206198                         ║
================================================================================
[21:06:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:06:28] ℹ️  Date: 03/27/2025
[21:06:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:06:33] [DOC: 9206198] ✅ Text extracted using pdfplumber (13652 chars)
[21:06:33] ✅    ✅ Text extracted using pdfplumber (13652 chars)
[21:06:33] 🔄 
🔄 Step 2: Extracting patient data...
[21:06:36] ℹ️  AI extracted raw sex value: 'F'
[21:06:36] ℹ️  AI extracted service line: 'OT'
[21:06:36] ℹ️  AI extracted payer source: ''
[21:06:36] ℹ️  AI extracted diagnoses:
[21:06:36] ℹ️    - Diagnosis 1: 'Right Wrist ORIF'
[21:06:36] ℹ️    - Diagnosis 2: 'muscle weakness'
[21:06:36] ℹ️    - Diagnosis 3: ''
[21:06:36] ℹ️    - Diagnosis 4: ''
[21:06:36] ℹ️    - Diagnosis 5: ''
[21:06:36] ℹ️    - Diagnosis 6: ''
[21:06:36] ℹ️  Final extracted MRN: 'MA250127036902'
[21:06:36] ℹ️  Final extracted Sex: 'FEMALE'
[21:06:36] ℹ️  Final extracted Service Line: 'OT'
[21:06:36] ℹ️  Final extracted Payer Source: ''
[21:06:36] ✅ Patient data extraction completed successfully
[21:06:36] ✅    ✅ Patient data extracted successfully
[21:06:36] 📊 Patient Response
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Right Wrist ORIF', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:06:36] ✅    ✅ Patient identified: Lynn Garifales
[21:06:36] ✅    ✅ Patient name validation passed
[21:06:36] 🔄 
🔄 Step 3: Processing patient dates...
[21:06:36] [DOC: 9206198] ℹ️  DOB normalized: 03/04/1969
[21:06:36] [DOC: 9206198] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[21:06:36] [DOC: 9206198] ✅ Patient date processing completed successfully
[21:06:36] ✅    ✅ Date processing completed
[21:06:36] 📊 Processed Patient Data
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Right Wrist ORIF', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:06:36] 🔄 
🔄 Step 4: Extracting order data...
[21:06:39] ℹ️  Order extraction - MRN: 'MA250127036902'
[21:06:39] ℹ️  Order extraction - Sex: 'FEMALE'
[21:06:39] ℹ️  Order extraction - Service Line: 'OT'
[21:06:39] ℹ️  Order extraction - Payer Source: ''
[21:06:39] ✅ Order data extraction completed successfully
[21:06:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:06:39] ℹ️  Using MRN from patient data: 'MA250127036902' over 'MA250127036902'
[21:06:39] ℹ️  Service line consistent in both sources: 'OT'
[21:06:39] ✅ Patient name cross-validation successful
[21:06:39] ✅    ✅ Data merged successfully
[21:06:40] ⚠️     ❌ Skipping - missing episode start date
[21:06:40] [DOC: 9206198] ℹ️  API push details saved for document 9206198
================================================================================
║                        Processing Document ID: 9206195                         ║
================================================================================
[21:06:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:06:40] ℹ️  Date: 03/27/2025
[21:06:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:06:42] [DOC: 9206195] ✅ Text extracted using pdfplumber (1420 chars)
[21:06:42] ✅    ✅ Text extracted using pdfplumber (1408 chars)
[21:06:42] 🔄 
🔄 Step 2: Extracting patient data...
[21:06:45] ℹ️  AI extracted raw sex value: ''
[21:06:45] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:06:45] ℹ️  AI extracted payer source: ''
[21:06:45] ℹ️  AI extracted diagnoses:
[21:06:45] ℹ️    - Diagnosis 1: 'S52.501'
[21:06:45] ℹ️    - Diagnosis 2: 'E78.49'
[21:06:45] ℹ️    - Diagnosis 3: 'D69.3'
[21:06:45] ℹ️    - Diagnosis 4: 'None'
[21:06:45] ℹ️    - Diagnosis 5: 'None'
[21:06:45] ℹ️    - Diagnosis 6: 'None'
[21:06:45] ℹ️  Final extracted MRN: 'MA250127036902'
[21:06:45] ℹ️  Final extracted Sex: ''
[21:06:45] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:06:45] ℹ️  Final extracted Payer Source: ''
[21:06:45] ✅ Patient data extraction completed successfully
[21:06:45] ✅    ✅ Patient data extracted successfully
[21:06:45] 📊 Patient Response
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: 
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'S52.501', 'secondDiagnosis': 'E78.49', 'thirdDiagnosis': 'D69.3', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:06:45] ✅    ✅ Patient identified: Lynn Garifales
[21:06:45] ✅    ✅ Patient name validation passed
[21:06:45] 🔄 
🔄 Step 3: Processing patient dates...
[21:06:45] [DOC: 9206195] ℹ️  DOB normalized: 03/04/1969
[21:06:45] [DOC: 9206195] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[21:06:45] [DOC: 9206195] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[21:06:45] [DOC: 9206195] ✅ Patient date processing completed successfully
[21:06:45] ✅    ✅ Date processing completed
[21:06:45] 📊 Processed Patient Data
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: 
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'S52.501', 'secondDiagnosis': 'E78.49', 'thirdDiagnosis': 'D69.3'}]
[21:06:45] 🔄 
🔄 Step 4: Extracting order data...
[21:06:48] ℹ️  Order extraction - MRN: 'MA250127036902'
[21:06:48] ℹ️  Order extraction - Sex: ''
[21:06:48] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:06:48] ℹ️  Order extraction - Payer Source: ''
[21:06:48] ✅ Order data extraction completed successfully
[21:06:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:06:48] ℹ️  Using MRN from patient data: 'MA250127036902' over 'MA250127036902'
[21:06:48] ⚠️  Could not determine sex using any available method
[21:06:48] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:06:48] ✅ Patient name cross-validation successful
[21:06:48] ✅    ✅ Data merged successfully
[21:06:49] ✅    ✅ Order data extracted and validated
[21:06:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:06:49] [DOC: 9206195] ✅ Patient found in local cache: Lynn Garifales, ID: 7d1a71eb-7fb9-4002-8f28-5a489c76a1a0
[21:06:49] ✅    ✅ Existing patient found with ID: 7d1a71eb-7fb9-4002-8f28-5a489c76a1a0
[21:06:49] 🔄 
🔄 Step 6: Pushing order to API...
[21:06:49] [DOC: 9206195] ℹ️  Pushing order via API for patient ID: 7d1a71eb-7fb9-4002-8f28-5a489c76a1a0
[21:06:50] [DOC: 9206195] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13769"}
[21:06:50] ❌    ❌ Failed to push order
[21:06:50] 🔄 
🔄 Step 7: Writing to CSV...
[21:06:50] [DOC: 9206195] ℹ️  Calculated age: 56 from DOB: 03/04/1969
[21:06:50] [DOC: 9206195] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:06:50] [DOC: 9206195] ℹ️  Payer Source extracted: ''
[21:06:50] [DOC: 9206195] ℹ️  Diagnosis codes being written:
[21:06:50] [DOC: 9206195] ℹ️    - Latest_Episode_Firstdiagnosis: 'S52.501'
[21:06:50] [DOC: 9206195] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.49'
[21:06:50] [DOC: 9206195] ℹ️    - Latest_Episode_Thirddiagnosis: 'D69.3'
[21:06:50] [DOC: 9206195] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:06:50] [DOC: 9206195] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:06:50] [DOC: 9206195] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:06:50] [DOC: 9206195] ✅ Patient data written to CSV: Lynn Garifales | Sex:  | Age: 56 | Service: Occupational Therapy | Payer:  | MRN: MA250127036902
[21:06:50] ✅    ✅ Document 9206195 processed and saved successfully
[21:06:50] 🔄 
🔄 Step 8: Saving API details...
[21:06:50] [DOC: 9206195] ℹ️  API push details saved for document 9206195
[21:06:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206185                         ║
================================================================================
[21:06:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:06:50] ℹ️  Date: 03/27/2025
[21:06:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:06:56] [DOC: 9206185] ✅ Text extracted using pdfplumber (19939 chars)
[21:06:56] ✅    ✅ Text extracted using pdfplumber (19939 chars)
[21:06:56] 🔄 
🔄 Step 2: Extracting patient data...
[21:06:59] ℹ️  AI extracted raw sex value: 'F'
[21:06:59] ℹ️  AI extracted service line: 'PT'
[21:06:59] ℹ️  AI extracted payer source: 'None'
[21:06:59] ℹ️  AI extracted diagnoses:
[21:06:59] ℹ️    - Diagnosis 1: 'G20'
[21:06:59] ℹ️    - Diagnosis 2: 'D51.1'
[21:06:59] ℹ️    - Diagnosis 3: 'G44.4'
[21:06:59] ℹ️    - Diagnosis 4: 'G57.9'
[21:06:59] ℹ️    - Diagnosis 5: 'M54.5'
[21:06:59] ℹ️    - Diagnosis 6: 'R68.84'
[21:06:59] ℹ️  Final extracted MRN: 'MA250220064201'
[21:06:59] ℹ️  Final extracted Sex: 'FEMALE'
[21:06:59] ℹ️  Final extracted Service Line: 'PT'
[21:06:59] ℹ️  Final extracted Payer Source: ''
[21:06:59] ✅ Patient data extraction completed successfully
[21:06:59] ✅    ✅ Patient data extracted successfully
[21:06:59] 📊 Patient Response
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'G20', 'secondDiagnosis': 'D51.1', 'thirdDiagnosis': 'G44.4', 'fourthDiagnosis': 'G57.9', 'fifthDiagnosis': 'M54.5', 'sixthDiagnosis': 'R68.84'}]
[21:06:59] ✅    ✅ Patient identified: Lucy Francis
[21:06:59] ✅    ✅ Patient name validation passed
[21:06:59] 🔄 
🔄 Step 3: Processing patient dates...
[21:06:59] [DOC: 9206185] ℹ️  DOB normalized: 06/12/1942
[21:06:59] [DOC: 9206185] ✅ Patient date processing completed successfully
[21:06:59] ✅    ✅ Date processing completed
[21:06:59] 📊 Processed Patient Data
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'G20', 'secondDiagnosis': 'D51.1', 'thirdDiagnosis': 'G44.4', 'fourthDiagnosis': 'G57.9', 'fifthDiagnosis': 'M54.5', 'sixthDiagnosis': 'R68.84'}]
[21:06:59] 🔄 
🔄 Step 4: Extracting order data...
[21:07:02] ℹ️  Order extraction - MRN: 'MA250220064201'
[21:07:02] ℹ️  Order extraction - Sex: 'FEMALE'
[21:07:02] ℹ️  Order extraction - Service Line: 'PT'
[21:07:02] ℹ️  Order extraction - Payer Source: ''
[21:07:02] ✅ Order data extraction completed successfully
[21:07:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:07:02] ℹ️  Using MRN from patient data: 'MA250220064201' over 'MA250220064201'
[21:07:02] ℹ️  Service line consistent in both sources: 'PT'
[21:07:02] ✅ Patient name cross-validation successful
[21:07:02] ✅    ✅ Data merged successfully
[21:07:03] ✅    ✅ Order data extracted and validated
[21:07:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:07:03] [DOC: 9206185] ✅ Patient found in local cache: Lucy Francis, ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[21:07:03] ✅    ✅ Existing patient found with ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[21:07:03] 🔄 
🔄 Step 6: Pushing order to API...
[21:07:03] [DOC: 9206185] ℹ️  Pushing order via API for patient ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[21:07:05] [DOC: 9206185] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:07:05] ❌    ❌ Failed to push order
[21:07:05] 🔄 
🔄 Step 7: Writing to CSV...
[21:07:05] [DOC: 9206185] ℹ️  Calculated age: 82 from DOB: 06/12/1942
[21:07:05] [DOC: 9206185] ℹ️  Service Line extracted: 'PT'
[21:07:05] [DOC: 9206185] ℹ️  Payer Source extracted: ''
[21:07:05] [DOC: 9206185] ℹ️  Diagnosis codes being written:
[21:07:05] [DOC: 9206185] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20'
[21:07:05] [DOC: 9206185] ℹ️    - Latest_Episode_Seconddiagnosis: 'D51.1'
[21:07:05] [DOC: 9206185] ℹ️    - Latest_Episode_Thirddiagnosis: 'G44.4'
[21:07:05] [DOC: 9206185] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G57.9'
[21:07:05] [DOC: 9206185] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.5'
[21:07:05] [DOC: 9206185] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R68.84'
[21:07:05] [DOC: 9206185] ✅ Patient data written to CSV: Lucy Francis | Sex: FEMALE | Age: 82 | Service: PT | Payer:  | MRN: MA250220064201
[21:07:05] ✅    ✅ Document 9206185 processed and saved successfully
[21:07:05] 🔄 
🔄 Step 8: Saving API details...
[21:07:05] [DOC: 9206185] ℹ️  API push details saved for document 9206185
[21:07:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206175                         ║
================================================================================
[21:07:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:07:05] ℹ️  Date: 03/27/2025
[21:07:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:07:10] [DOC: 9206175] ✅ Text extracted using pdfplumber (15542 chars)
[21:07:10] ✅    ✅ Text extracted using pdfplumber (15530 chars)
[21:07:10] 🔄 
🔄 Step 2: Extracting patient data...
[21:07:13] ℹ️  AI extracted raw sex value: 'F'
[21:07:13] ℹ️  AI extracted service line: 'PT, OT'
[21:07:13] ℹ️  AI extracted payer source: 'Medicare'
[21:07:13] ℹ️  AI extracted diagnoses:
[21:07:13] ℹ️    - Diagnosis 1: 'I69.354'
[21:07:13] ℹ️    - Diagnosis 2: 'E78.00'
[21:07:13] ℹ️    - Diagnosis 3: 'L20.9'
[21:07:13] ℹ️    - Diagnosis 4: 'L28.0'
[21:07:13] ℹ️    - Diagnosis 5: 'I12.9'
[21:07:13] ℹ️    - Diagnosis 6: 'N18.30'
[21:07:13] ℹ️  Final extracted MRN: 'MA230120082705'
[21:07:13] ℹ️  Final extracted Sex: 'FEMALE'
[21:07:13] ℹ️  Final extracted Service Line: 'PT, OT'
[21:07:13] ℹ️  Final extracted Payer Source: 'Medicare'
[21:07:13] ✅ Patient data extraction completed successfully
[21:07:13] ✅    ✅ Patient data extracted successfully
[21:07:13] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9', 'fourthDiagnosis': 'L28.0', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.30'}]
[21:07:13] ✅    ✅ Patient identified: Irene Copley
[21:07:13] ✅    ✅ Patient name validation passed
[21:07:13] 🔄 
🔄 Step 3: Processing patient dates...
[21:07:13] [DOC: 9206175] ℹ️  DOB normalized: 08/04/1927
[21:07:13] [DOC: 9206175] ℹ️  Episode startOfCare normalized: 01/26/2025
[21:07:13] [DOC: 9206175] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[21:07:13] [DOC: 9206175] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[21:07:13] [DOC: 9206175] ✅ Patient date processing completed successfully
[21:07:13] ✅    ✅ Date processing completed
[21:07:13] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9', 'fourthDiagnosis': 'L28.0', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.30'}]
[21:07:13] 🔄 
🔄 Step 4: Extracting order data...
[21:07:15] ℹ️  Order extraction - MRN: 'MA230120082705'
[21:07:15] ℹ️  Order extraction - Sex: 'FEMALE'
[21:07:15] ℹ️  Order extraction - Service Line: 'PT, OT'
[21:07:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:07:15] ✅ Order data extraction completed successfully
[21:07:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:07:15] ℹ️  Using MRN from patient data: 'MA230120082705' over 'MA230120082705'
[21:07:15] ℹ️  Service line consistent in both sources: 'PT, OT'
[21:07:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:07:15] ✅ Patient name cross-validation successful
[21:07:15] ✅    ✅ Data merged successfully
[21:07:17] ✅    ✅ Order data extracted and validated
[21:07:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:07:17] [DOC: 9206175] ✅ Patient found in local cache: Irene Copley, ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[21:07:17] ✅    ✅ Existing patient found with ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[21:07:17] 🔄 
🔄 Step 6: Pushing order to API...
[21:07:17] [DOC: 9206175] ℹ️  Pushing order via API for patient ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[21:07:18] [DOC: 9206175] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13529"}
[21:07:18] ❌    ❌ Failed to push order
[21:07:18] 🔄 
🔄 Step 7: Writing to CSV...
[21:07:18] [DOC: 9206175] ℹ️  Calculated age: 97 from DOB: 08/04/1927
[21:07:18] [DOC: 9206175] ℹ️  Service Line extracted: 'PT, OT'
[21:07:18] [DOC: 9206175] ℹ️  Payer Source extracted: 'Medicare'
[21:07:18] [DOC: 9206175] ℹ️  Diagnosis codes being written:
[21:07:18] [DOC: 9206175] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[21:07:18] [DOC: 9206175] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.00'
[21:07:18] [DOC: 9206175] ℹ️    - Latest_Episode_Thirddiagnosis: 'L20.9'
[21:07:18] [DOC: 9206175] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L28.0'
[21:07:18] [DOC: 9206175] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[21:07:18] [DOC: 9206175] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.30'
[21:07:18] [DOC: 9206175] ✅ Patient data written to CSV: Irene Copley | Sex: FEMALE | Age: 97 | Service: PT, OT | Payer: Medicare | MRN: MA230120082705
[21:07:18] ✅    ✅ Document 9206175 processed and saved successfully
[21:07:18] 🔄 
🔄 Step 8: Saving API details...
[21:07:18] [DOC: 9206175] ℹ️  API push details saved for document 9206175
[21:07:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206097                         ║
================================================================================
[21:07:18] ℹ️  Agency: Nizhoni Health-Fall River
[21:07:18] ℹ️  Date: 03/27/2025
[21:07:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:07:32] [DOC: 9206097] ✅ Text extracted using pdfplumber (5573 chars)
[21:07:32] ✅    ✅ Text extracted using pdfplumber (5573 chars)
[21:07:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:07:35] ℹ️  AI extracted raw sex value: 'M'
[21:07:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:07:35] ℹ️  AI extracted payer source: 'Medicaid/MA'
[21:07:35] ℹ️  AI extracted diagnoses:
[21:07:35] ℹ️    - Diagnosis 1: 'F20.9'
[21:07:35] ℹ️    - Diagnosis 2: 'E11.9'
[21:07:35] ℹ️    - Diagnosis 3: 'I10'
[21:07:35] ℹ️    - Diagnosis 4: 'F41.9'
[21:07:35] ℹ️    - Diagnosis 5: 'I25.10'
[21:07:35] ℹ️    - Diagnosis 6: 'F25.0'
[21:07:35] ℹ️  Final extracted MRN: '6281'
[21:07:35] ℹ️  Final extracted Sex: 'MALE'
[21:07:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:07:35] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[21:07:35] ✅ Patient data extraction completed successfully
[21:07:35] ✅    ✅ Patient data extracted successfully
[21:07:35] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Leiriao
     └─ dob: 04/18/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 6281
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 240 Alden Rd.
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'F25.0'}]
[21:07:35] ✅    ✅ Patient identified: John Leiriao
[21:07:35] ✅    ✅ Patient name validation passed
[21:07:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:07:35] [DOC: 9206097] ℹ️  DOB normalized: 04/18/1964
[21:07:35] [DOC: 9206097] ℹ️  Episode startOfCare normalized: 11/25/2024
[21:07:35] [DOC: 9206097] ℹ️  Episode startOfEpisode normalized: 01/24/2025
[21:07:35] [DOC: 9206097] ℹ️  Episode endOfEpisode normalized: 03/24/2025
[21:07:35] [DOC: 9206097] ✅ Patient date processing completed successfully
[21:07:35] ✅    ✅ Date processing completed
[21:07:35] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Leiriao
     └─ dob: 04/18/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 6281
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 240 Alden Rd.
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'F25.0'}]
[21:07:35] 🔄 
🔄 Step 4: Extracting order data...
[21:07:37] ℹ️  Order extraction - MRN: '6281'
[21:07:37] ℹ️  Order extraction - Sex: 'MALE'
[21:07:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:07:37] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[21:07:37] ✅ Order data extraction completed successfully
[21:07:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:07:37] ℹ️  Using MRN from patient data: '6281' over '6281'
[21:07:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:07:37] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[21:07:37] ✅ Patient name cross-validation successful
[21:07:37] ✅    ✅ Data merged successfully
[21:07:39] ✅    ✅ Order data extracted and validated
[21:07:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:07:39] [DOC: 9206097] ✅ Patient found in local cache: John Leiriao, ID: b1bfe056-b1dc-4acb-9bfb-cb7925d0159b
[21:07:39] ✅    ✅ Existing patient found with ID: b1bfe056-b1dc-4acb-9bfb-cb7925d0159b
[21:07:39] 🔄 
🔄 Step 6: Pushing order to API...
[21:07:39] [DOC: 9206097] ℹ️  Pushing order via API for patient ID: b1bfe056-b1dc-4acb-9bfb-cb7925d0159b
[21:07:40] [DOC: 9206097] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:07:40] ❌    ❌ Failed to push order
[21:07:40] 🔄 
🔄 Step 7: Writing to CSV...
[21:07:40] [DOC: 9206097] ℹ️  Calculated age: 61 from DOB: 04/18/1964
[21:07:40] [DOC: 9206097] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:07:40] [DOC: 9206097] ℹ️  Payer Source extracted: 'Medicaid/MA'
[21:07:40] [DOC: 9206097] ℹ️  Diagnosis codes being written:
[21:07:40] [DOC: 9206097] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[21:07:40] [DOC: 9206097] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[21:07:40] [DOC: 9206097] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:07:40] [DOC: 9206097] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.9'
[21:07:40] [DOC: 9206097] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[21:07:40] [DOC: 9206097] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F25.0'
[21:07:40] [DOC: 9206097] ✅ Patient data written to CSV: John Leiriao | Sex: MALE | Age: 61 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 6281
[21:07:40] ✅    ✅ Document 9206097 processed and saved successfully
[21:07:40] 🔄 
🔄 Step 8: Saving API details...
[21:07:40] [DOC: 9206097] ℹ️  API push details saved for document 9206097
[21:07:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206015                         ║
================================================================================
[21:07:40] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:07:40] ℹ️  Date: 03/27/2025
[21:07:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:07:43] [DOC: 9206015] ✅ Text extracted using pdfplumber (6601 chars)
[21:07:43] ✅    ✅ Text extracted using pdfplumber (6601 chars)
[21:07:43] 🔄 
🔄 Step 2: Extracting patient data...
[21:07:47] ℹ️  AI extracted raw sex value: 'F'
[21:07:47] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[21:07:47] ℹ️  AI extracted payer source: ''
[21:07:47] ℹ️  AI extracted diagnoses:
[21:07:47] ℹ️    - Diagnosis 1: 'F31.10'
[21:07:47] ℹ️    - Diagnosis 2: 'F41.1'
[21:07:47] ℹ️    - Diagnosis 3: 'E11.40'
[21:07:47] ℹ️    - Diagnosis 4: 'I10'
[21:07:47] ℹ️    - Diagnosis 5: 'E66.01'
[21:07:47] ℹ️    - Diagnosis 6: 'M17.0'
[21:07:47] ℹ️  Final extracted MRN: '253005'
[21:07:47] ℹ️  Final extracted Sex: 'FEMALE'
[21:07:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[21:07:47] ℹ️  Final extracted Payer Source: ''
[21:07:47] ✅ Patient data extraction completed successfully
[21:07:47] ✅    ✅ Patient data extracted successfully
[21:07:47] 📊 Patient Response
     └─ patientFName: N/A
     └─ patientLName: N/A
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Fernandes, Versana
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': '12/16/2021', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F31.10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'M17.0'}]
[21:07:47] ✅    ✅ Patient identified: N/A N/A
[21:07:47] ✅    ✅ Patient name validation passed
[21:07:47] 🔄 
🔄 Step 3: Processing patient dates...
[21:07:47] [DOC: 9206015] ℹ️  DOB normalized: 04/22/1971
[21:07:47] [DOC: 9206015] ℹ️  Episode startOfCare normalized: 12/16/2021
[21:07:47] [DOC: 9206015] ℹ️  Episode startOfEpisode normalized: 12/16/2021
[21:07:47] [DOC: 9206015] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[21:07:47] [DOC: 9206015] ✅ Patient date processing completed successfully
[21:07:47] ✅    ✅ Date processing completed
[21:07:47] 📊 Processed Patient Data
     └─ patientFName: N/A
     └─ patientLName: N/A
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Fernandes, Versana
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': '12/16/2021', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F31.10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'M17.0'}]
[21:07:47] 🔄 
🔄 Step 4: Extracting order data...
[21:07:49] ℹ️  Order extraction - MRN: '253005'
[21:07:49] ℹ️  Order extraction - Sex: 'FEMALE'
[21:07:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:07:49] ℹ️  Order extraction - Payer Source: ''
[21:07:49] ✅ Order data extraction completed successfully
[21:07:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:07:49] ℹ️  Using MRN from patient data: '253005' over '253005'
[21:07:49] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[21:07:49] ✅    ✅ Data merged successfully
[21:07:51] ✅    ✅ Order data extracted and validated
[21:07:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:07:51] [DOC: 9206015] ✅ Patient found in local cache: N/A N/A, ID: e9629652-0bca-412d-8c30-df4a73e9513b
[21:07:51] ✅    ✅ Existing patient found with ID: e9629652-0bca-412d-8c30-df4a73e9513b
[21:07:51] 🔄 
🔄 Step 6: Pushing order to API...
[21:07:51] [DOC: 9206015] ℹ️  Pushing order via API for patient ID: e9629652-0bca-412d-8c30-df4a73e9513b
[21:07:52] [DOC: 9206015] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13975"}
[21:07:52] ❌    ❌ Failed to push order
[21:07:52] 🔄 
🔄 Step 7: Writing to CSV...
[21:07:52] [DOC: 9206015] ℹ️  Calculated age: 54 from DOB: 04/22/1971
[21:07:52] [DOC: 9206015] ℹ️  Service Line extracted: 'Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[21:07:52] [DOC: 9206015] ℹ️  Payer Source extracted: ''
[21:07:52] [DOC: 9206015] ℹ️  Diagnosis codes being written:
[21:07:52] [DOC: 9206015] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.10'
[21:07:52] [DOC: 9206015] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[21:07:52] [DOC: 9206015] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[21:07:52] [DOC: 9206015] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[21:07:52] [DOC: 9206015] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.01'
[21:07:52] [DOC: 9206015] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M17.0'
[21:07:52] [DOC: 9206015] ✅ Patient data written to CSV: N/A N/A | Sex: FEMALE | Age: 54 | Service: Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 253005
[21:07:52] ✅    ✅ Document 9206015 processed and saved successfully
[21:07:52] 🔄 
🔄 Step 8: Saving API details...
[21:07:52] [DOC: 9206015] ℹ️  API push details saved for document 9206015
[21:07:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205914                         ║
================================================================================
[21:07:52] ℹ️  Agency: Fairhaven HH&H
[21:07:52] ℹ️  Date: 03/27/2025
[21:07:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:07:54] [DOC: 9205914] ✅ Text extracted using pdfplumber (1170 chars)
[21:07:54] ✅    ✅ Text extracted using pdfplumber (1170 chars)
[21:07:54] 🔄 
🔄 Step 2: Extracting patient data...
[21:07:57] ℹ️  AI extracted raw sex value: 'M'
[21:07:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:07:57] ℹ️  AI extracted payer source: 'Medicare'
[21:07:57] ℹ️  AI extracted diagnoses:
[21:07:57] ℹ️    - Diagnosis 1: ''
[21:07:57] ℹ️    - Diagnosis 2: ''
[21:07:57] ℹ️    - Diagnosis 3: ''
[21:07:57] ℹ️    - Diagnosis 4: ''
[21:07:57] ℹ️    - Diagnosis 5: ''
[21:07:57] ℹ️    - Diagnosis 6: ''
[21:07:57] ℹ️  Final extracted MRN: '5021009'
[21:07:57] ℹ️  Final extracted Sex: 'MALE'
[21:07:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:07:57] ℹ️  Final extracted Payer Source: 'Medicare'
[21:07:57] ✅ Patient data extraction completed successfully
[21:07:57] ✅    ✅ Patient data extracted successfully
[21:07:57] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:07:57] ✅    ✅ Patient identified: William Hughes
[21:07:57] ✅    ✅ Patient name validation passed
[21:07:57] 🔄 
🔄 Step 3: Processing patient dates...
[21:07:57] [DOC: 9205914] ℹ️  DOB normalized: 07/10/1937
[21:07:57] [DOC: 9205914] ℹ️  Episode startOfCare normalized: 11/20/2024
[21:07:57] [DOC: 9205914] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[21:07:57] [DOC: 9205914] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[21:07:57] [DOC: 9205914] ✅ Patient date processing completed successfully
[21:07:57] ✅    ✅ Date processing completed
[21:07:57] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:07:57] 🔄 
🔄 Step 4: Extracting order data...
[21:07:59] ℹ️  Order extraction - MRN: '5021009'
[21:07:59] ℹ️  Order extraction - Sex: 'MALE'
[21:07:59] ℹ️  Order extraction - Service Line: 'RN'
[21:07:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:07:59] ✅ Order data extraction completed successfully
[21:07:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:07:59] ℹ️  Using MRN from patient data: '5021009' over '5021009'
[21:07:59] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[21:07:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:07:59] ✅ Patient name cross-validation successful
[21:07:59] ✅    ✅ Data merged successfully
[21:08:01] ✅    ✅ Order data extracted and validated
[21:08:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:08:26] [DOC: 9205914] ℹ️  Patient not found in cache or API: William Hughes
[21:08:26] [DOC: 9205914] ℹ️  Patient not found, creating new patient via API...
[21:08:26] [DOC: 9205914] ℹ️  Creating patient via API: William Hughes
[21:08:28] [DOC: 9205914] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:08:28] ❌    ❌ Failed to create patient
[21:08:28] [DOC: 9205914] ℹ️  API push details saved for document 9205914
================================================================================
║                        Processing Document ID: 9205898                         ║
================================================================================
[21:08:28] ℹ️  Agency: Compassionate Care Hospice-Taunton
[21:08:28] ℹ️  Date: 03/27/2025
[21:08:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:08:30] [DOC: 9205898] ✅ Text extracted using pdfplumber (1583 chars)
[21:08:30] ✅    ✅ Text extracted using pdfplumber (1571 chars)
[21:08:30] 🔄 
🔄 Step 2: Extracting patient data...
[21:08:32] ℹ️  AI extracted raw sex value: ''
[21:08:32] ℹ️  AI extracted service line: 'Hospice'
[21:08:32] ℹ️  AI extracted payer source: 'Medicare'
[21:08:32] ℹ️  AI extracted diagnoses:
[21:08:32] ℹ️    - Diagnosis 1: 'None'
[21:08:32] ℹ️    - Diagnosis 2: 'None'
[21:08:32] ℹ️    - Diagnosis 3: 'None'
[21:08:32] ℹ️    - Diagnosis 4: 'None'
[21:08:32] ℹ️    - Diagnosis 5: 'None'
[21:08:32] ℹ️    - Diagnosis 6: 'None'
[21:08:32] ℹ️  Final extracted MRN: 'B3700255994202'
[21:08:32] ℹ️  Final extracted Sex: ''
[21:08:32] ℹ️  Final extracted Service Line: 'Hospice'
[21:08:32] ℹ️  Final extracted Payer Source: 'Medicare'
[21:08:32] ✅ Patient data extraction completed successfully
[21:08:32] ✅    ✅ Patient data extracted successfully
[21:08:32] 📊 Patient Response
     └─ patientFName: PATRICIA
     └─ patientLName: SWANSON
     └─ dob: 09/16/1940
     └─ patientSex: 
     └─ medicalRecordNo: B3700255994202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:08:32] ✅    ✅ Patient identified: PATRICIA SWANSON
[21:08:32] ✅    ✅ Patient name validation passed
[21:08:32] 🔄 
🔄 Step 3: Processing patient dates...
[21:08:32] [DOC: 9205898] ℹ️  DOB normalized: 09/16/1940
[21:08:32] [DOC: 9205898] ✅ Patient date processing completed successfully
[21:08:32] ✅    ✅ Date processing completed
[21:08:32] 📊 Processed Patient Data
     └─ patientFName: PATRICIA
     └─ patientLName: SWANSON
     └─ dob: 09/16/1940
     └─ patientSex: 
     └─ medicalRecordNo: B3700255994202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:08:32] 🔄 
🔄 Step 4: Extracting order data...
[21:08:35] ℹ️  Order extraction - MRN: 'B3700255994202'
[21:08:35] ℹ️  Order extraction - Sex: ''
[21:08:35] ℹ️  Order extraction - Service Line: 'Hospice'
[21:08:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:08:35] ✅ Order data extraction completed successfully
[21:08:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:08:35] ℹ️  Using MRN from patient data: 'B3700255994202' over 'B3700255994202'
[21:08:35] ℹ️  Inferred sex as FEMALE from name: PATRICIA
[21:08:35] ℹ️  Service line consistent in both sources: 'Hospice'
[21:08:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:08:35] ✅ Patient name cross-validation successful
[21:08:35] ✅    ✅ Data merged successfully
[21:08:36] ✅    ✅ Order data extracted and validated
[21:08:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:09:00] [DOC: 9205898] ℹ️  Patient not found in cache or API: PATRICIA SWANSON
[21:09:00] [DOC: 9205898] ℹ️  Patient not found, creating new patient via API...
[21:09:00] [DOC: 9205898] ℹ️  Creating patient via API: PATRICIA SWANSON
[21:09:01] [DOC: 9205898] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:09:01] ❌    ❌ Failed to create patient
[21:09:01] [DOC: 9205898] ℹ️  API push details saved for document 9205898
================================================================================
║                        Processing Document ID: 9205856                         ║
================================================================================
[21:09:01] ℹ️  Agency: Dartmouth HH
[21:09:01] ℹ️  Date: 03/27/2025
[21:09:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:09:03] [DOC: 9205856] ✅ Text extracted using pdfplumber (11798 chars)
[21:09:03] ✅    ✅ Text extracted using pdfplumber (11798 chars)
[21:09:03] 🔄 
🔄 Step 2: Extracting patient data...
[21:09:06] ℹ️  AI extracted raw sex value: 'F'
[21:09:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:09:06] ℹ️  AI extracted payer source: 'None'
[21:09:06] ℹ️  AI extracted diagnoses:
[21:09:06] ℹ️    - Diagnosis 1: 'I13.0'
[21:09:06] ℹ️    - Diagnosis 2: 'I50.32'
[21:09:06] ℹ️    - Diagnosis 3: 'N18.31'
[21:09:06] ℹ️    - Diagnosis 4: 'L89.322'
[21:09:06] ℹ️    - Diagnosis 5: 'L89.891'
[21:09:06] ℹ️    - Diagnosis 6: 'J44.9'
[21:09:06] ℹ️  Final extracted MRN: '3177001'
[21:09:06] ℹ️  Final extracted Sex: 'FEMALE'
[21:09:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:09:06] ℹ️  Final extracted Payer Source: ''
[21:09:06] ✅ Patient data extraction completed successfully
[21:09:06] ✅    ✅ Patient data extracted successfully
[21:09:06] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100204971772
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'L89.322', 'fifthDiagnosis': 'L89.891', 'sixthDiagnosis': 'J44.9'}]
[21:09:06] ✅    ✅ Patient identified: Dorothy Lynch
[21:09:06] ✅    ✅ Patient name validation passed
[21:09:06] 🔄 
🔄 Step 3: Processing patient dates...
[21:09:06] [DOC: 9205856] ℹ️  DOB normalized: 03/16/1932
[21:09:06] [DOC: 9205856] ℹ️  Episode startOfCare normalized: 03/12/2025
[21:09:06] [DOC: 9205856] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:09:06] [DOC: 9205856] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:09:06] [DOC: 9205856] ✅ Patient date processing completed successfully
[21:09:06] ✅    ✅ Date processing completed
[21:09:06] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100204971772
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'L89.322', 'fifthDiagnosis': 'L89.891', 'sixthDiagnosis': 'J44.9'}]
[21:09:06] 🔄 
🔄 Step 4: Extracting order data...
[21:09:09] ℹ️  Order extraction - MRN: '3177001'
[21:09:09] ℹ️  Order extraction - Sex: 'FEMALE'
[21:09:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:09:09] ℹ️  Order extraction - Payer Source: ''
[21:09:09] ✅ Order data extraction completed successfully
[21:09:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:09:09] ℹ️  Using MRN from patient data: '3177001' over '3177001'
[21:09:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:09:09] ✅ Patient name cross-validation successful
[21:09:09] ✅    ✅ Data merged successfully
[21:09:10] ✅    ✅ Order data extracted and validated
[21:09:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:09:10] [DOC: 9205856] ✅ Patient found in local cache: Dorothy Lynch, ID: d21b3eef-f066-47f0-b26e-3663176af82f
[21:09:10] ✅    ✅ Existing patient found with ID: d21b3eef-f066-47f0-b26e-3663176af82f
[21:09:10] 🔄 
🔄 Step 6: Pushing order to API...
[21:09:10] [DOC: 9205856] ℹ️  Pushing order via API for patient ID: d21b3eef-f066-47f0-b26e-3663176af82f
[21:09:11] [DOC: 9205856] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:09:11] ❌    ❌ Failed to push order
[21:09:11] 🔄 
🔄 Step 7: Writing to CSV...
[21:09:11] [DOC: 9205856] ℹ️  Calculated age: 93 from DOB: 03/16/1932
[21:09:11] [DOC: 9205856] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:09:11] [DOC: 9205856] ℹ️  Payer Source extracted: ''
[21:09:11] [DOC: 9205856] ℹ️  Diagnosis codes being written:
[21:09:11] [DOC: 9205856] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[21:09:11] [DOC: 9205856] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[21:09:11] [DOC: 9205856] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[21:09:11] [DOC: 9205856] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L89.322'
[21:09:11] [DOC: 9205856] ℹ️    - Latest_Episode_Fifthdiagnosis: 'L89.891'
[21:09:11] [DOC: 9205856] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J44.9'
[21:09:11] [DOC: 9205856] ✅ Patient data written to CSV: Dorothy Lynch | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 3177001
[21:09:11] ✅    ✅ Document 9205856 processed and saved successfully
[21:09:11] 🔄 
🔄 Step 8: Saving API details...
[21:09:11] [DOC: 9205856] ℹ️  API push details saved for document 9205856
[21:09:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205854                         ║
================================================================================
[21:09:11] ℹ️  Agency: Nizhoni Health-Fall River
[21:09:11] ℹ️  Date: 03/27/2025
[21:09:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:09:31] [DOC: 9205854] ✅ Text extracted using pdfplumber (12487 chars)
[21:09:31] ✅    ✅ Text extracted using pdfplumber (12487 chars)
[21:09:31] 🔄 
🔄 Step 2: Extracting patient data...
[21:09:34] ℹ️  AI extracted raw sex value: 'M'
[21:09:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:09:34] ℹ️  AI extracted payer source: 'None'
[21:09:34] ℹ️  AI extracted diagnoses:
[21:09:34] ℹ️    - Diagnosis 1: 'F20.9'
[21:09:34] ℹ️    - Diagnosis 2: 'F32.9'
[21:09:34] ℹ️    - Diagnosis 3: 'F39'
[21:09:34] ℹ️    - Diagnosis 4: 'I10'
[21:09:34] ℹ️    - Diagnosis 5: 'K21.9'
[21:09:34] ℹ️    - Diagnosis 6: 'Z79.899'
[21:09:34] ℹ️  Final extracted MRN: '7864'
[21:09:34] ℹ️  Final extracted Sex: 'MALE'
[21:09:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:09:34] ℹ️  Final extracted Payer Source: ''
[21:09:34] ✅ Patient data extraction completed successfully
[21:09:34] ✅    ✅ Patient data extracted successfully
[21:09:34] 📊 Patient Response
     └─ patientFName: Gary J
     └─ patientLName: Pierce
     └─ dob: 07/14/1967
     └─ patientSex: MALE
     └─ medicalRecordNo: 7864
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/12/2016', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F32.9', 'thirdDiagnosis': 'F39', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'Z79.899'}]
[21:09:34] ✅    ✅ Patient identified: Gary J Pierce
[21:09:34] ✅    ✅ Patient name validation passed
[21:09:34] 🔄 
🔄 Step 3: Processing patient dates...
[21:09:34] [DOC: 9205854] ℹ️  DOB normalized: 07/14/1967
[21:09:34] [DOC: 9205854] ℹ️  Episode startOfCare normalized: 09/12/2016
[21:09:34] [DOC: 9205854] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[21:09:34] [DOC: 9205854] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[21:09:34] [DOC: 9205854] ✅ Patient date processing completed successfully
[21:09:34] ✅    ✅ Date processing completed
[21:09:34] 📊 Processed Patient Data
     └─ patientFName: Gary J
     └─ patientLName: Pierce
     └─ dob: 07/14/1967
     └─ patientSex: MALE
     └─ medicalRecordNo: 7864
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/12/2016', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F32.9', 'thirdDiagnosis': 'F39', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'Z79.899'}]
[21:09:34] 🔄 
🔄 Step 4: Extracting order data...
[21:09:37] ℹ️  Order extraction - MRN: '7864'
[21:09:37] ℹ️  Order extraction - Sex: 'MALE'
[21:09:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:09:37] ℹ️  Order extraction - Payer Source: ''
[21:09:37] ✅ Order data extraction completed successfully
[21:09:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:09:37] ℹ️  Using MRN from patient data: '7864' over '7864'
[21:09:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:09:37] ✅ Patient name cross-validation successful
[21:09:37] ✅    ✅ Data merged successfully
[21:09:38] ✅    ✅ Order data extracted and validated
[21:09:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:09:59] [DOC: 9205854] ✅ Patient exists in API: Gary J Pierce, ID: c0b8fafa-8120-4cdb-9870-73b12f7e1c6b
[21:09:59] ✅    ✅ Existing patient found with ID: c0b8fafa-8120-4cdb-9870-73b12f7e1c6b
[21:09:59] 🔄 
🔄 Step 6: Pushing order to API...
[21:09:59] [DOC: 9205854] ℹ️  Pushing order via API for patient ID: c0b8fafa-8120-4cdb-9870-73b12f7e1c6b
[21:10:00] [DOC: 9205854] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:10:00] ❌    ❌ Failed to push order
[21:10:00] 🔄 
🔄 Step 7: Writing to CSV...
[21:10:00] [DOC: 9205854] ℹ️  Calculated age: 57 from DOB: 07/14/1967
[21:10:00] [DOC: 9205854] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:10:00] [DOC: 9205854] ℹ️  Payer Source extracted: ''
[21:10:00] [DOC: 9205854] ℹ️  Diagnosis codes being written:
[21:10:00] [DOC: 9205854] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[21:10:00] [DOC: 9205854] ℹ️    - Latest_Episode_Seconddiagnosis: 'F32.9'
[21:10:00] [DOC: 9205854] ℹ️    - Latest_Episode_Thirddiagnosis: 'F39'
[21:10:00] [DOC: 9205854] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[21:10:00] [DOC: 9205854] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K21.9'
[21:10:00] [DOC: 9205854] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z79.899'
[21:10:00] [DOC: 9205854] ✅ Patient data written to CSV: Gary J Pierce | Sex: MALE | Age: 57 | Service: Skilled Nursing | Payer:  | MRN: 7864
[21:10:00] ✅    ✅ Document 9205854 processed and saved successfully
[21:10:00] 🔄 
🔄 Step 8: Saving API details...
[21:10:00] [DOC: 9205854] ℹ️  API push details saved for document 9205854
[21:10:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205834                         ║
================================================================================
[21:10:00] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:10:00] ℹ️  Date: 03/27/2025
[21:10:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:02] [DOC: 9205834] ✅ Text extracted using pdfplumber (5197 chars)
[21:10:02] ✅    ✅ Text extracted using pdfplumber (5197 chars)
[21:10:02] 🔄 
🔄 Step 2: Extracting patient data...
[21:10:04] ℹ️  AI extracted raw sex value: 'None'
[21:10:04] ℹ️  AI extracted service line: 'None'
[21:10:04] ℹ️  AI extracted payer source: 'None'
[21:10:04] ℹ️  AI extracted diagnoses:
[21:10:04] ℹ️    - Diagnosis 1: ''
[21:10:04] ℹ️    - Diagnosis 2: ''
[21:10:04] ℹ️    - Diagnosis 3: ''
[21:10:04] ℹ️    - Diagnosis 4: ''
[21:10:04] ℹ️    - Diagnosis 5: ''
[21:10:04] ℹ️    - Diagnosis 6: ''
[21:10:04] ℹ️  Final extracted MRN: ''
[21:10:04] ℹ️  Final extracted Sex: ''
[21:10:04] ℹ️  Final extracted Service Line: ''
[21:10:04] ℹ️  Final extracted Payer Source: ''
[21:10:04] ✅ Patient data extraction completed successfully
[21:10:04] ✅    ✅ Patient data extracted successfully
[21:10:04] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:10:04] ⚠️     ❌ Insufficient patient data extracted
[21:10:04] [DOC: 9205834] ℹ️  API push details saved for document 9205834
================================================================================
║                        Processing Document ID: 9205833                         ║
================================================================================
[21:10:04] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:10:04] ℹ️  Date: 03/27/2025
[21:10:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:12] [DOC: 9205833] ✅ Text extracted using pdfplumber (68506 chars)
[21:10:12] ✅    ✅ Text extracted using pdfplumber (68506 chars)
[21:10:12] 🔄 
🔄 Step 2: Extracting patient data...
[21:10:17] ℹ️  AI extracted raw sex value: ''
[21:10:17] ℹ️  AI extracted service line: ''
[21:10:17] ℹ️  AI extracted payer source: ''
[21:10:17] ℹ️  AI extracted diagnoses:
[21:10:17] ℹ️    - Diagnosis 1: ''
[21:10:17] ℹ️    - Diagnosis 2: ''
[21:10:17] ℹ️    - Diagnosis 3: ''
[21:10:17] ℹ️    - Diagnosis 4: ''
[21:10:17] ℹ️    - Diagnosis 5: ''
[21:10:17] ℹ️    - Diagnosis 6: ''
[21:10:17] ℹ️  Final extracted MRN: ''
[21:10:17] ℹ️  Final extracted Sex: ''
[21:10:17] ℹ️  Final extracted Service Line: ''
[21:10:17] ℹ️  Final extracted Payer Source: ''
[21:10:17] ✅ Patient data extraction completed successfully
[21:10:17] ✅    ✅ Patient data extracted successfully
[21:10:17] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:10:17] ⚠️     ❌ Insufficient patient data extracted
[21:10:17] [DOC: 9205833] ℹ️  API push details saved for document 9205833
================================================================================
║                        Processing Document ID: 2166080                         ║
================================================================================
[21:10:17] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:10:17] ℹ️  Date: 03/26/2025
[21:10:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:19] [DOC: 2166080] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:19] ❌ Failed to extract text for Doc ID 2166080
[21:10:19] [DOC: 2166080] ℹ️  API push details saved for document 2166080
================================================================================
║                        Processing Document ID: 2166079                         ║
================================================================================
[21:10:19] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:10:19] ℹ️  Date: 03/26/2025
[21:10:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:20] [DOC: 2166079] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:20] ❌ Failed to extract text for Doc ID 2166079
[21:10:20] [DOC: 2166079] ℹ️  API push details saved for document 2166079
================================================================================
║                        Processing Document ID: 2166078                         ║
================================================================================
[21:10:20] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:10:20] ℹ️  Date: 03/26/2025
[21:10:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:22] [DOC: 2166078] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:22] ❌ Failed to extract text for Doc ID 2166078
[21:10:22] [DOC: 2166078] ℹ️  API push details saved for document 2166078
================================================================================
║                        Processing Document ID: 2166074                         ║
================================================================================
[21:10:22] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:10:22] ℹ️  Date: 03/26/2025
[21:10:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:23] [DOC: 2166074] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:23] ❌ Failed to extract text for Doc ID 2166074
[21:10:23] [DOC: 2166074] ℹ️  API push details saved for document 2166074
================================================================================
║                        Processing Document ID: 9205138                         ║
================================================================================
[21:10:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:10:23] ℹ️  Date: 03/26/2025
[21:10:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:29] [DOC: 9205138] ✅ Text extracted using pdfplumber (1281 chars)
[21:10:29] ✅    ✅ Text extracted using pdfplumber (1281 chars)
[21:10:29] 🔄 
🔄 Step 2: Extracting patient data...
[21:10:31] ℹ️  AI extracted raw sex value: ''
[21:10:31] ℹ️  AI extracted service line: 'PT'
[21:10:31] ℹ️  AI extracted payer source: ''
[21:10:31] ℹ️  AI extracted diagnoses:
[21:10:31] ℹ️    - Diagnosis 1: 'M54.32'
[21:10:31] ℹ️    - Diagnosis 2: 'I12.9'
[21:10:31] ℹ️    - Diagnosis 3: 'E11.22'
[21:10:31] ℹ️    - Diagnosis 4: 'None'
[21:10:31] ℹ️    - Diagnosis 5: 'None'
[21:10:31] ℹ️    - Diagnosis 6: 'None'
[21:10:31] ℹ️  Final extracted MRN: 'MA220126074307'
[21:10:31] ℹ️  Final extracted Sex: ''
[21:10:31] ℹ️  Final extracted Service Line: 'PT'
[21:10:31] ℹ️  Final extracted Payer Source: ''
[21:10:31] ✅ Patient data extraction completed successfully
[21:10:31] ✅    ✅ Patient data extracted successfully
[21:10:31] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:10:31] ✅    ✅ Patient identified: Manuel Furtado
[21:10:31] ✅    ✅ Patient name validation passed
[21:10:31] 🔄 
🔄 Step 3: Processing patient dates...
[21:10:31] [DOC: 9205138] ℹ️  DOB normalized: 07/13/1943
[21:10:31] [DOC: 9205138] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[21:10:31] [DOC: 9205138] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[21:10:31] [DOC: 9205138] ✅ Patient date processing completed successfully
[21:10:31] ✅    ✅ Date processing completed
[21:10:31] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22'}]
[21:10:31] 🔄 
🔄 Step 4: Extracting order data...
[21:10:34] ℹ️  Order extraction - MRN: 'MA220126074307'
[21:10:34] ℹ️  Order extraction - Sex: ''
[21:10:34] ℹ️  Order extraction - Service Line: 'PT'
[21:10:34] ℹ️  Order extraction - Payer Source: ''
[21:10:34] ✅ Order data extraction completed successfully
[21:10:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:10:34] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[21:10:34] ⚠️  Could not determine sex using any available method
[21:10:34] ℹ️  Service line consistent in both sources: 'PT'
[21:10:34] ✅ Patient name cross-validation successful
[21:10:34] ✅    ✅ Data merged successfully
[21:10:35] ✅    ✅ Order data extracted and validated
[21:10:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:10:35] [DOC: 9205138] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[21:10:35] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[21:10:35] 🔄 
🔄 Step 6: Pushing order to API...
[21:10:35] [DOC: 9205138] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[21:10:36] [DOC: 9205138] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13015"}
[21:10:36] ❌    ❌ Failed to push order
[21:10:36] 🔄 
🔄 Step 7: Writing to CSV...
[21:10:36] [DOC: 9205138] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[21:10:36] [DOC: 9205138] ℹ️  Service Line extracted: 'PT'
[21:10:36] [DOC: 9205138] ℹ️  Payer Source extracted: ''
[21:10:36] [DOC: 9205138] ℹ️  Diagnosis codes being written:
[21:10:36] [DOC: 9205138] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.32'
[21:10:36] [DOC: 9205138] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[21:10:36] [DOC: 9205138] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[21:10:36] [DOC: 9205138] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:10:36] [DOC: 9205138] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:10:36] [DOC: 9205138] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:10:36] [DOC: 9205138] ✅ Patient data written to CSV: Manuel Furtado | Sex:  | Age: 81 | Service: PT | Payer:  | MRN: MA220126074307
[21:10:36] ✅    ✅ Document 9205138 processed and saved successfully
[21:10:36] 🔄 
🔄 Step 8: Saving API details...
[21:10:36] [DOC: 9205138] ℹ️  API push details saved for document 9205138
[21:10:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205136                         ║
================================================================================
[21:10:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:10:36] ℹ️  Date: 03/26/2025
[21:10:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:39] [DOC: 9205136] ✅ Text extracted using pdfplumber (13780 chars)
[21:10:39] ✅    ✅ Text extracted using pdfplumber (13780 chars)
[21:10:39] 🔄 
🔄 Step 2: Extracting patient data...
[21:10:42] ℹ️  AI extracted raw sex value: 'M'
[21:10:42] ℹ️  AI extracted service line: 'Physical Therapy'
[21:10:42] ℹ️  AI extracted payer source: 'Medicare'
[21:10:42] ℹ️  AI extracted diagnoses:
[21:10:42] ℹ️    - Diagnosis 1: 'M54.32'
[21:10:42] ℹ️    - Diagnosis 2: 'I12.9'
[21:10:42] ℹ️    - Diagnosis 3: 'E11.22'
[21:10:42] ℹ️    - Diagnosis 4: 'N18.30'
[21:10:42] ℹ️    - Diagnosis 5: 'I25.10'
[21:10:42] ℹ️    - Diagnosis 6: 'N40.1'
[21:10:42] ℹ️  Final extracted MRN: 'MA220126074307'
[21:10:42] ℹ️  Final extracted Sex: 'MALE'
[21:10:42] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:10:42] ℹ️  Final extracted Payer Source: 'Medicare'
[21:10:42] ✅ Patient data extraction completed successfully
[21:10:42] ✅    ✅ Patient data extracted successfully
[21:10:42] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: SILVA, DILMA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 996-1046
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'N40.1'}]
[21:10:42] ✅    ✅ Patient identified: Manuel Furtado
[21:10:42] ✅    ✅ Patient name validation passed
[21:10:42] 🔄 
🔄 Step 3: Processing patient dates...
[21:10:42] [DOC: 9205136] ℹ️  DOB normalized: 07/13/1943
[21:10:42] [DOC: 9205136] ℹ️  Episode startOfCare normalized: 03/20/2025
[21:10:42] [DOC: 9205136] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[21:10:42] [DOC: 9205136] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[21:10:42] [DOC: 9205136] ✅ Patient date processing completed successfully
[21:10:42] ✅    ✅ Date processing completed
[21:10:42] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: SILVA, DILMA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 996-1046
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'N40.1'}]
[21:10:42] 🔄 
🔄 Step 4: Extracting order data...
[21:10:45] ℹ️  Order extraction - MRN: 'MA220126074307'
[21:10:45] ℹ️  Order extraction - Sex: 'MALE'
[21:10:45] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:10:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:10:45] ✅ Order data extraction completed successfully
[21:10:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:10:45] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[21:10:45] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:10:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:10:45] ✅ Patient name cross-validation successful
[21:10:45] ✅    ✅ Data merged successfully
[21:10:46] ✅    ✅ Order data extracted and validated
[21:10:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:10:46] [DOC: 9205136] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[21:10:46] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[21:10:46] 🔄 
🔄 Step 6: Pushing order to API...
[21:10:46] [DOC: 9205136] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[21:10:48] [DOC: 9205136] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13016"}
[21:10:48] ❌    ❌ Failed to push order
[21:10:48] 🔄 
🔄 Step 7: Writing to CSV...
[21:10:48] [DOC: 9205136] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[21:10:48] [DOC: 9205136] ℹ️  Service Line extracted: 'Physical Therapy'
[21:10:48] [DOC: 9205136] ℹ️  Payer Source extracted: 'Medicare'
[21:10:48] [DOC: 9205136] ℹ️  Diagnosis codes being written:
[21:10:48] [DOC: 9205136] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.32'
[21:10:48] [DOC: 9205136] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[21:10:48] [DOC: 9205136] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[21:10:48] [DOC: 9205136] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[21:10:48] [DOC: 9205136] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[21:10:48] [DOC: 9205136] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[21:10:48] [DOC: 9205136] ✅ Patient data written to CSV: Manuel Furtado | Sex: MALE | Age: 81 | Service: Physical Therapy | Payer: Medicare | MRN: MA220126074307
[21:10:48] ✅    ✅ Document 9205136 processed and saved successfully
[21:10:48] 🔄 
🔄 Step 8: Saving API details...
[21:10:48] [DOC: 9205136] ℹ️  API push details saved for document 9205136
[21:10:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2165940                         ║
================================================================================
[21:10:48] ℹ️  Agency: Brockton Home Health Care
[21:10:48] ℹ️  Date: 03/26/2025
[21:10:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:49] [DOC: 2165940] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:49] ❌ Failed to extract text for Doc ID 2165940
[21:10:49] [DOC: 2165940] ℹ️  API push details saved for document 2165940
================================================================================
║                        Processing Document ID: 2165937                         ║
================================================================================
[21:10:49] ℹ️  Agency: Brockton Home Health Care
[21:10:49] ℹ️  Date: 03/26/2025
[21:10:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:50] [DOC: 2165937] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:50] ❌ Failed to extract text for Doc ID 2165937
[21:10:50] [DOC: 2165937] ℹ️  API push details saved for document 2165937
================================================================================
║                        Processing Document ID: 2165933                         ║
================================================================================
[21:10:50] ℹ️  Agency: Brockton Home Health Care
[21:10:50] ℹ️  Date: 03/26/2025
[21:10:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:52] [DOC: 2165933] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:52] ❌ Failed to extract text for Doc ID 2165933
[21:10:52] [DOC: 2165933] ℹ️  API push details saved for document 2165933
================================================================================
║                        Processing Document ID: 2165932                         ║
================================================================================
[21:10:52] ℹ️  Agency: Brockton Home Health Care
[21:10:52] ℹ️  Date: 03/26/2025
[21:10:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:54] [DOC: 2165932] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:54] ❌ Failed to extract text for Doc ID 2165932
[21:10:54] [DOC: 2165932] ℹ️  API push details saved for document 2165932
================================================================================
║                        Processing Document ID: 2165931                         ║
================================================================================
[21:10:54] ℹ️  Agency: Brockton Home Health Care
[21:10:54] ℹ️  Date: 03/26/2025
[21:10:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:55] [DOC: 2165931] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:55] ❌ Failed to extract text for Doc ID 2165931
[21:10:55] [DOC: 2165931] ℹ️  API push details saved for document 2165931
================================================================================
║                        Processing Document ID: 2165930                         ║
================================================================================
[21:10:55] ℹ️  Agency: Brockton Home Health Care
[21:10:55] ℹ️  Date: 03/26/2025
[21:10:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:56] [DOC: 2165930] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:56] ❌ Failed to extract text for Doc ID 2165930
[21:10:56] [DOC: 2165930] ℹ️  API push details saved for document 2165930
================================================================================
║                        Processing Document ID: 2165929                         ║
================================================================================
[21:10:56] ℹ️  Agency: Brockton Home Health Care
[21:10:56] ℹ️  Date: 03/26/2025
[21:10:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:57] [DOC: 2165929] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:57] ❌ Failed to extract text for Doc ID 2165929
[21:10:57] [DOC: 2165929] ℹ️  API push details saved for document 2165929
================================================================================
║                        Processing Document ID: 2165928                         ║
================================================================================
[21:10:57] ℹ️  Agency: Brockton Home Health Care
[21:10:57] ℹ️  Date: 03/26/2025
[21:10:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:10:59] [DOC: 2165928] ❌ Critical failure in get_pdf_text: Invalid response format
[21:10:59] ❌ Failed to extract text for Doc ID 2165928
[21:10:59] [DOC: 2165928] ℹ️  API push details saved for document 2165928
================================================================================
║                        Processing Document ID: 2165927                         ║
================================================================================
[21:10:59] ℹ️  Agency: Brockton Home Health Care
[21:10:59] ℹ️  Date: 03/26/2025
[21:10:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:11:01] [DOC: 2165927] ❌ Critical failure in get_pdf_text: Invalid response format
[21:11:01] ❌ Failed to extract text for Doc ID 2165927
[21:11:01] [DOC: 2165927] ℹ️  API push details saved for document 2165927
================================================================================
║                        Processing Document ID: 9205760                         ║
================================================================================
[21:11:01] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[21:11:01] ℹ️  Date: 03/26/2025
[21:11:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:11:10] [DOC: 9205760] ✅ Text extracted using pdfplumber (32874 chars)
[21:11:10] ✅    ✅ Text extracted using pdfplumber (32874 chars)
[21:11:10] 🔄 
🔄 Step 2: Extracting patient data...
[21:11:13] ℹ️  AI extracted raw sex value: 'M'
[21:11:13] ℹ️  AI extracted service line: 'Physical Therapy, Speech Therapy, Skilled Nursing'
[21:11:13] ℹ️  AI extracted payer source: 'Medicare'
[21:11:13] ℹ️  AI extracted diagnoses:
[21:11:13] ℹ️    - Diagnosis 1: 'I69.354'
[21:11:13] ℹ️    - Diagnosis 2: 'I69.320'
[21:11:13] ℹ️    - Diagnosis 3: 'I69.322'
[21:11:13] ℹ️    - Diagnosis 4: 'I11.0'
[21:11:13] ℹ️    - Diagnosis 5: 'I50.32'
[21:11:13] ℹ️    - Diagnosis 6: 'E11.9'
[21:11:13] ℹ️  Final extracted MRN: '28700209064601'
[21:11:13] ℹ️  Final extracted Sex: 'MALE'
[21:11:13] ℹ️  Final extracted Service Line: 'Physical Therapy, Speech Therapy, Skilled Nursing'
[21:11:13] ℹ️  Final extracted Payer Source: 'Medicare'
[21:11:13] ✅ Patient data extraction completed successfully
[21:11:13] ✅    ✅ Patient data extracted successfully
[21:11:13] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: COUTO
     └─ dob: 09/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209064601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 887 ROCK ODUNDEE RD
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Physical Therapy, Speech Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'I69.320', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.9'}]
[21:11:13] ✅    ✅ Patient identified: JOHN COUTO
[21:11:13] ✅    ✅ Patient name validation passed
[21:11:13] 🔄 
🔄 Step 3: Processing patient dates...
[21:11:13] [DOC: 9205760] ℹ️  DOB normalized: 09/27/1950
[21:11:13] [DOC: 9205760] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:11:13] [DOC: 9205760] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[21:11:13] [DOC: 9205760] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[21:11:13] [DOC: 9205760] ✅ Patient date processing completed successfully
[21:11:13] ✅    ✅ Date processing completed
[21:11:13] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: COUTO
     └─ dob: 09/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209064601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 887 ROCK ODUNDEE RD
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Physical Therapy, Speech Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'I69.320', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.9'}]
[21:11:13] 🔄 
🔄 Step 4: Extracting order data...
[21:11:17] ℹ️  Order extraction - MRN: '28700209064601'
[21:11:17] ℹ️  Order extraction - Sex: 'MALE'
[21:11:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[21:11:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:11:17] ✅ Order data extraction completed successfully
[21:11:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:11:17] ℹ️  Using MRN from patient data: '28700209064601' over '28700209064601'
[21:11:17] ℹ️  Combined service lines: Patient='Physical Therapy, Speech Therapy, Skilled Nursing' + Order='Skilled Nursing, Physical Therapy, Speech Therapy' = 'Physical Therapy, Skilled Nursing, Speech Therapy'
[21:11:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:11:17] ✅ Patient name cross-validation successful
[21:11:17] ✅    ✅ Data merged successfully
[21:11:18] ✅    ✅ Order data extracted and validated
[21:11:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:11:18] [DOC: 9205760] ✅ Patient found in local cache: JOHN COUTO, ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[21:11:18] ✅    ✅ Existing patient found with ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[21:11:18] 🔄 
🔄 Step 6: Pushing order to API...
[21:11:18] [DOC: 9205760] ℹ️  Pushing order via API for patient ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[21:11:19] [DOC: 9205760] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20076"}
[21:11:19] ❌    ❌ Failed to push order
[21:11:19] 🔄 
🔄 Step 7: Writing to CSV...
[21:11:19] [DOC: 9205760] ℹ️  Calculated age: 74 from DOB: 09/27/1950
[21:11:19] [DOC: 9205760] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing, Speech Therapy'
[21:11:19] [DOC: 9205760] ℹ️  Payer Source extracted: 'Medicare'
[21:11:19] [DOC: 9205760] ℹ️  Diagnosis codes being written:
[21:11:19] [DOC: 9205760] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[21:11:19] [DOC: 9205760] ℹ️    - Latest_Episode_Seconddiagnosis: 'I69.320'
[21:11:19] [DOC: 9205760] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[21:11:19] [DOC: 9205760] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[21:11:19] [DOC: 9205760] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[21:11:19] [DOC: 9205760] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[21:11:19] [DOC: 9205760] ✅ Patient data written to CSV: JOHN COUTO | Sex: MALE | Age: 74 | Service: Physical Therapy, Skilled Nursing, Speech Therapy | Payer: Medicare | MRN: 28700209064601
[21:11:19] ✅    ✅ Document 9205760 processed and saved successfully
[21:11:19] 🔄 
🔄 Step 8: Saving API details...
[21:11:19] [DOC: 9205760] ℹ️  API push details saved for document 9205760
[21:11:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205746                         ║
================================================================================
[21:11:19] ℹ️  Agency: Bayada Home Health Care Inc-Plymouth
[21:11:19] ℹ️  Date: 03/26/2025
[21:11:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:11:22] [DOC: 9205746] ✅ Text extracted using pdfplumber (4531 chars)
[21:11:22] ✅    ✅ Text extracted using pdfplumber (4519 chars)
[21:11:22] 🔄 
🔄 Step 2: Extracting patient data...
[21:11:24] ℹ️  AI extracted raw sex value: ''
[21:11:24] ℹ️  AI extracted service line: 'RN'
[21:11:24] ℹ️  AI extracted payer source: 'Medicare'
[21:11:24] ℹ️  AI extracted diagnoses:
[21:11:24] ℹ️    - Diagnosis 1: ''
[21:11:24] ℹ️    - Diagnosis 2: ''
[21:11:24] ℹ️    - Diagnosis 3: ''
[21:11:24] ℹ️    - Diagnosis 4: ''
[21:11:24] ℹ️    - Diagnosis 5: ''
[21:11:24] ℹ️    - Diagnosis 6: ''
[21:11:24] ℹ️  Final extracted MRN: '13900203941001'
[21:11:24] ℹ️  Final extracted Sex: ''
[21:11:24] ℹ️  Final extracted Service Line: 'RN'
[21:11:24] ℹ️  Final extracted Payer Source: 'Medicare'
[21:11:24] ✅ Patient data extraction completed successfully
[21:11:24] ✅    ✅ Patient data extracted successfully
[21:11:24] 📊 Patient Response
     └─ patientFName: PAULA
     └─ patientLName: LAMOTHE
     └─ dob: 07/19/1956
     └─ patientSex: 
     └─ medicalRecordNo: 13900203941001
     └─ billingProvider: ELAINE WU, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '03/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:11:24] ✅    ✅ Patient identified: PAULA LAMOTHE
[21:11:24] ✅    ✅ Patient name validation passed
[21:11:24] 🔄 
🔄 Step 3: Processing patient dates...
[21:11:24] [DOC: 9205746] ℹ️  DOB normalized: 07/19/1956
[21:11:24] [DOC: 9205746] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[21:11:24] [DOC: 9205746] ℹ️  Episode endOfEpisode normalized: 03/10/2025
[21:11:24] [DOC: 9205746] ✅ Patient date processing completed successfully
[21:11:24] ✅    ✅ Date processing completed
[21:11:24] 📊 Processed Patient Data
     └─ patientFName: PAULA
     └─ patientLName: LAMOTHE
     └─ dob: 07/19/1956
     └─ patientSex: 
     └─ medicalRecordNo: 13900203941001
     └─ billingProvider: ELAINE WU, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '03/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:11:24] 🔄 
🔄 Step 4: Extracting order data...
[21:11:27] ℹ️  Order extraction - MRN: '13900203941001'
[21:11:27] ℹ️  Order extraction - Sex: ''
[21:11:27] ℹ️  Order extraction - Service Line: 'RN'
[21:11:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:11:27] ✅ Order data extraction completed successfully
[21:11:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:11:27] ℹ️  Using MRN from patient data: '13900203941001' over '13900203941001'
[21:11:27] ⚠️  Could not determine sex using any available method
[21:11:27] ℹ️  Service line consistent in both sources: 'RN'
[21:11:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:11:27] ✅ Patient name cross-validation successful
[21:11:27] ✅    ✅ Data merged successfully
[21:11:28] ✅    ✅ Order data extracted and validated
[21:11:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:11:28] [DOC: 9205746] ✅ Patient found in local cache: PAULA LAMOTHE, ID: 3bbfbaf4-4834-4f98-a7a9-bc6645df352f
[21:11:28] ✅    ✅ Existing patient found with ID: 3bbfbaf4-4834-4f98-a7a9-bc6645df352f
[21:11:28] 🔄 
🔄 Step 6: Pushing order to API...
[21:11:28] [DOC: 9205746] ℹ️  Pushing order via API for patient ID: 3bbfbaf4-4834-4f98-a7a9-bc6645df352f
[21:11:30] [DOC: 9205746] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13894"}
[21:11:30] ❌    ❌ Failed to push order
[21:11:30] 🔄 
🔄 Step 7: Writing to CSV...
[21:11:30] [DOC: 9205746] ℹ️  Calculated age: 68 from DOB: 07/19/1956
[21:11:30] [DOC: 9205746] ℹ️  Service Line extracted: 'RN'
[21:11:30] [DOC: 9205746] ℹ️  Payer Source extracted: 'Medicare'
[21:11:30] [DOC: 9205746] ℹ️  Diagnosis codes being written:
[21:11:30] [DOC: 9205746] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:11:30] [DOC: 9205746] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:11:30] [DOC: 9205746] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:11:30] [DOC: 9205746] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:11:30] [DOC: 9205746] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:11:30] [DOC: 9205746] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:11:30] [DOC: 9205746] ✅ Patient data written to CSV: PAULA LAMOTHE | Sex:  | Age: 68 | Service: RN | Payer: Medicare | MRN: 13900203941001
[21:11:30] ✅    ✅ Document 9205746 processed and saved successfully
[21:11:30] 🔄 
🔄 Step 8: Saving API details...
[21:11:30] [DOC: 9205746] ℹ️  API push details saved for document 9205746
[21:11:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205569                         ║
================================================================================
[21:11:30] ℹ️  Agency: AccentCare Fall River
[21:11:30] ℹ️  Date: 03/26/2025
[21:11:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:11:32] [DOC: 9205569] ✅ Text extracted using pdfplumber (1267 chars)
[21:11:32] ✅    ✅ Text extracted using pdfplumber (1267 chars)
[21:11:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:11:36] ℹ️  AI extracted raw sex value: ''
[21:11:36] ℹ️  AI extracted service line: 'OT'
[21:11:36] ℹ️  AI extracted payer source: ''
[21:11:36] ℹ️  AI extracted diagnoses:
[21:11:36] ℹ️    - Diagnosis 1: 'Influenza A'
[21:11:36] ℹ️    - Diagnosis 2: 'Acute Hypoxia'
[21:11:36] ℹ️    - Diagnosis 3: 'COPD Exacerbation'
[21:11:36] ℹ️    - Diagnosis 4: ''
[21:11:36] ℹ️    - Diagnosis 5: ''
[21:11:36] ℹ️    - Diagnosis 6: ''
[21:11:36] ℹ️  Final extracted MRN: 'C0200218671301'
[21:11:36] ℹ️  Final extracted Sex: ''
[21:11:36] ℹ️  Final extracted Service Line: 'OT'
[21:11:36] ℹ️  Final extracted Payer Source: ''
[21:11:36] ✅ Patient data extraction completed successfully
[21:11:36] ✅    ✅ Patient data extracted successfully
[21:11:36] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:11:36] ✅    ✅ Patient identified: MARY LEBLANC
[21:11:36] ✅    ✅ Patient name validation passed
[21:11:36] 🔄 
🔄 Step 3: Processing patient dates...
[21:11:36] [DOC: 9205569] ℹ️  DOB normalized: 03/02/1943
[21:11:36] [DOC: 9205569] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[21:11:36] [DOC: 9205569] ℹ️  Episode endOfEpisode normalized: 02/18/2025
[21:11:36] [DOC: 9205569] ✅ Patient date processing completed successfully
[21:11:36] ✅    ✅ Date processing completed
[21:11:36] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:11:36] 🔄 
🔄 Step 4: Extracting order data...
[21:11:38] ℹ️  Order extraction - MRN: 'C0200218671301'
[21:11:38] ℹ️  Order extraction - Sex: ''
[21:11:38] ℹ️  Order extraction - Service Line: 'OT'
[21:11:38] ℹ️  Order extraction - Payer Source: ''
[21:11:38] ✅ Order data extraction completed successfully
[21:11:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:11:38] ℹ️  Using MRN from patient data: 'C0200218671301' over 'C0200218671301'
[21:11:38] ℹ️  Inferred sex as FEMALE from name: MARY
[21:11:38] ℹ️  Service line consistent in both sources: 'OT'
[21:11:38] ✅ Patient name cross-validation successful
[21:11:38] ✅    ✅ Data merged successfully
[21:11:39] ✅    ✅ Order data extracted and validated
[21:11:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:12:12] [DOC: 9205569] ℹ️  Patient not found in cache or API: MARY LEBLANC
[21:12:12] [DOC: 9205569] ℹ️  Patient not found, creating new patient via API...
[21:12:12] [DOC: 9205569] ℹ️  Creating patient via API: MARY LEBLANC
[21:12:13] [DOC: 9205569] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:12:13] ❌    ❌ Failed to create patient
[21:12:13] [DOC: 9205569] ℹ️  API push details saved for document 9205569
================================================================================
║                        Processing Document ID: 9205443                         ║
================================================================================
[21:12:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:12:13] ℹ️  Date: 03/26/2025
[21:12:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:12:15] [DOC: 9205443] ✅ Text extracted using pdfplumber (1144 chars)
[21:12:15] ✅    ✅ Text extracted using pdfplumber (1132 chars)
[21:12:15] 🔄 
🔄 Step 2: Extracting patient data...
[21:12:18] ℹ️  AI extracted raw sex value: ''
[21:12:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:12:18] ℹ️  AI extracted payer source: ''
[21:12:18] ℹ️  AI extracted diagnoses:
[21:12:18] ℹ️    - Diagnosis 1: 'E11.9'
[21:12:18] ℹ️    - Diagnosis 2: 'E04.1'
[21:12:18] ℹ️    - Diagnosis 3: 'M79.7'
[21:12:18] ℹ️    - Diagnosis 4: ''
[21:12:18] ℹ️    - Diagnosis 5: ''
[21:12:18] ℹ️    - Diagnosis 6: ''
[21:12:18] ℹ️  Final extracted MRN: 'MA250313044605'
[21:12:18] ℹ️  Final extracted Sex: ''
[21:12:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:12:18] ℹ️  Final extracted Payer Source: ''
[21:12:18] ✅ Patient data extraction completed successfully
[21:12:18] ✅    ✅ Patient data extracted successfully
[21:12:18] 📊 Patient Response
     └─ patientFName: Shirley Ann
     └─ patientLName: Marcondes
     └─ dob: 04/09/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA250313044605
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'E04.1', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:12:18] ✅    ✅ Patient identified: Shirley Ann Marcondes
[21:12:18] ✅    ✅ Patient name validation passed
[21:12:18] 🔄 
🔄 Step 3: Processing patient dates...
[21:12:18] [DOC: 9205443] ℹ️  DOB normalized: 04/09/1946
[21:12:18] [DOC: 9205443] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[21:12:18] [DOC: 9205443] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[21:12:18] [DOC: 9205443] ✅ Patient date processing completed successfully
[21:12:18] ✅    ✅ Date processing completed
[21:12:18] 📊 Processed Patient Data
     └─ patientFName: Shirley Ann
     └─ patientLName: Marcondes
     └─ dob: 04/09/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA250313044605
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'E04.1', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:12:18] 🔄 
🔄 Step 4: Extracting order data...
[21:12:20] ℹ️  Order extraction - MRN: 'MA250313044605'
[21:12:20] ℹ️  Order extraction - Sex: ''
[21:12:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:12:20] ℹ️  Order extraction - Payer Source: ''
[21:12:20] ✅ Order data extraction completed successfully
[21:12:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:12:20] ℹ️  Using MRN from patient data: 'MA250313044605' over 'MA250313044605'
[21:12:20] ⚠️  Could not determine sex using any available method
[21:12:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:12:20] ✅ Patient name cross-validation successful
[21:12:20] ✅    ✅ Data merged successfully
[21:12:22] ✅    ✅ Order data extracted and validated
[21:12:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:12:22] [DOC: 9205443] ✅ Patient found in local cache: Shirley Ann Marcondes, ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[21:12:22] ✅    ✅ Existing patient found with ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[21:12:22] 🔄 
🔄 Step 6: Pushing order to API...
[21:12:22] [DOC: 9205443] ℹ️  Pushing order via API for patient ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[21:12:23] [DOC: 9205443] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14020"}
[21:12:23] ❌    ❌ Failed to push order
[21:12:23] 🔄 
🔄 Step 7: Writing to CSV...
[21:12:23] [DOC: 9205443] ℹ️  Calculated age: 79 from DOB: 04/09/1946
[21:12:23] [DOC: 9205443] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:12:23] [DOC: 9205443] ℹ️  Payer Source extracted: ''
[21:12:23] [DOC: 9205443] ℹ️  Diagnosis codes being written:
[21:12:23] [DOC: 9205443] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[21:12:23] [DOC: 9205443] ℹ️    - Latest_Episode_Seconddiagnosis: 'E04.1'
[21:12:23] [DOC: 9205443] ℹ️    - Latest_Episode_Thirddiagnosis: 'M79.7'
[21:12:23] [DOC: 9205443] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:12:23] [DOC: 9205443] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:12:23] [DOC: 9205443] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:12:23] [DOC: 9205443] ✅ Patient data written to CSV: Shirley Ann Marcondes | Sex:  | Age: 79 | Service: Skilled Nursing | Payer:  | MRN: MA250313044605
[21:12:23] ✅    ✅ Document 9205443 processed and saved successfully
[21:12:23] 🔄 
🔄 Step 8: Saving API details...
[21:12:23] [DOC: 9205443] ℹ️  API push details saved for document 9205443
[21:12:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205430                         ║
================================================================================
[21:12:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:12:23] ℹ️  Date: 03/26/2025
[21:12:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:12:26] [DOC: 9205430] ✅ Text extracted using pdfplumber (1429 chars)
[21:12:26] ✅    ✅ Text extracted using pdfplumber (1429 chars)
[21:12:26] 🔄 
🔄 Step 2: Extracting patient data...
[21:12:28] ℹ️  AI extracted raw sex value: ''
[21:12:28] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:12:28] ℹ️  AI extracted payer source: ''
[21:12:28] ℹ️  AI extracted diagnoses:
[21:12:28] ℹ️    - Diagnosis 1: 'J44.0'
[21:12:28] ℹ️    - Diagnosis 2: 'J15.8'
[21:12:28] ℹ️    - Diagnosis 3: 'A41.3'
[21:12:28] ℹ️    - Diagnosis 4: ''
[21:12:28] ℹ️    - Diagnosis 5: ''
[21:12:28] ℹ️    - Diagnosis 6: ''
[21:12:28] ℹ️  Final extracted MRN: 'MA250203063802'
[21:12:28] ℹ️  Final extracted Sex: ''
[21:12:28] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:12:28] ℹ️  Final extracted Payer Source: ''
[21:12:28] ✅ Patient data extraction completed successfully
[21:12:28] ✅    ✅ Patient data extracted successfully
[21:12:28] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:12:28] ✅    ✅ Patient identified: Priscila Diaz
[21:12:28] ✅    ✅ Patient name validation passed
[21:12:28] 🔄 
🔄 Step 3: Processing patient dates...
[21:12:28] [DOC: 9205430] ℹ️  DOB normalized: 06/11/1938
[21:12:28] [DOC: 9205430] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[21:12:28] [DOC: 9205430] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[21:12:28] [DOC: 9205430] ✅ Patient date processing completed successfully
[21:12:28] ✅    ✅ Date processing completed
[21:12:28] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:12:28] 🔄 
🔄 Step 4: Extracting order data...
[21:12:31] ℹ️  Order extraction - MRN: 'MA250203063802'
[21:12:31] ℹ️  Order extraction - Sex: ''
[21:12:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:12:31] ℹ️  Order extraction - Payer Source: ''
[21:12:31] ✅ Order data extraction completed successfully
[21:12:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:12:31] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[21:12:31] ⚠️  Could not determine sex using any available method
[21:12:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:12:31] ✅ Patient name cross-validation successful
[21:12:31] ✅    ✅ Data merged successfully
[21:12:32] ✅    ✅ Order data extracted and validated
[21:12:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:12:32] [DOC: 9205430] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[21:12:32] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[21:12:32] 🔄 
🔄 Step 6: Pushing order to API...
[21:12:32] [DOC: 9205430] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[21:12:33] [DOC: 9205430] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13871"}
[21:12:33] ❌    ❌ Failed to push order
[21:12:33] 🔄 
🔄 Step 7: Writing to CSV...
[21:12:33] [DOC: 9205430] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[21:12:33] [DOC: 9205430] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:12:33] [DOC: 9205430] ℹ️  Payer Source extracted: ''
[21:12:33] [DOC: 9205430] ℹ️  Diagnosis codes being written:
[21:12:33] [DOC: 9205430] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[21:12:33] [DOC: 9205430] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[21:12:33] [DOC: 9205430] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[21:12:33] [DOC: 9205430] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:12:33] [DOC: 9205430] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:12:33] [DOC: 9205430] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:12:33] [DOC: 9205430] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: MA250203063802
[21:12:33] ✅    ✅ Document 9205430 processed and saved successfully
[21:12:33] 🔄 
🔄 Step 8: Saving API details...
[21:12:33] [DOC: 9205430] ℹ️  API push details saved for document 9205430
[21:12:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205428                         ║
================================================================================
[21:12:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:12:33] ℹ️  Date: 03/26/2025
[21:12:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:12:36] [DOC: 9205428] ✅ Text extracted using pdfplumber (1475 chars)
[21:12:36] ✅    ✅ Text extracted using pdfplumber (1475 chars)
[21:12:36] 🔄 
🔄 Step 2: Extracting patient data...
[21:12:39] ℹ️  AI extracted raw sex value: ''
[21:12:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:12:39] ℹ️  AI extracted payer source: ''
[21:12:39] ℹ️  AI extracted diagnoses:
[21:12:39] ℹ️    - Diagnosis 1: 'J44.0'
[21:12:39] ℹ️    - Diagnosis 2: 'J15.8'
[21:12:39] ℹ️    - Diagnosis 3: 'A41.3'
[21:12:39] ℹ️    - Diagnosis 4: 'None'
[21:12:39] ℹ️    - Diagnosis 5: 'None'
[21:12:39] ℹ️    - Diagnosis 6: 'None'
[21:12:39] ℹ️  Final extracted MRN: 'MA250203063802'
[21:12:39] ℹ️  Final extracted Sex: ''
[21:12:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:12:39] ℹ️  Final extracted Payer Source: ''
[21:12:39] ✅ Patient data extraction completed successfully
[21:12:39] ✅    ✅ Patient data extracted successfully
[21:12:39] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:12:39] ✅    ✅ Patient identified: Priscila Diaz
[21:12:39] ✅    ✅ Patient name validation passed
[21:12:39] 🔄 
🔄 Step 3: Processing patient dates...
[21:12:39] [DOC: 9205428] ℹ️  DOB normalized: 06/11/1938
[21:12:39] [DOC: 9205428] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[21:12:39] [DOC: 9205428] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[21:12:39] [DOC: 9205428] ✅ Patient date processing completed successfully
[21:12:39] ✅    ✅ Date processing completed
[21:12:39] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3'}]
[21:12:39] 🔄 
🔄 Step 4: Extracting order data...
[21:12:42] ℹ️  Order extraction - MRN: 'MA250203063802'
[21:12:42] ℹ️  Order extraction - Sex: ''
[21:12:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:12:42] ℹ️  Order extraction - Payer Source: ''
[21:12:42] ✅ Order data extraction completed successfully
[21:12:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:12:42] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[21:12:42] ⚠️  Could not determine sex using any available method
[21:12:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:12:42] ✅ Patient name cross-validation successful
[21:12:42] ✅    ✅ Data merged successfully
[21:12:43] ✅    ✅ Order data extracted and validated
[21:12:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:12:43] [DOC: 9205428] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[21:12:43] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[21:12:43] 🔄 
🔄 Step 6: Pushing order to API...
[21:12:43] [DOC: 9205428] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[21:12:45] [DOC: 9205428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13873"}
[21:12:45] ❌    ❌ Failed to push order
[21:12:45] 🔄 
🔄 Step 7: Writing to CSV...
[21:12:45] [DOC: 9205428] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[21:12:45] [DOC: 9205428] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:12:45] [DOC: 9205428] ℹ️  Payer Source extracted: ''
[21:12:45] [DOC: 9205428] ℹ️  Diagnosis codes being written:
[21:12:45] [DOC: 9205428] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[21:12:45] [DOC: 9205428] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[21:12:45] [DOC: 9205428] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[21:12:45] [DOC: 9205428] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:12:45] [DOC: 9205428] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:12:45] [DOC: 9205428] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:12:45] [DOC: 9205428] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: MA250203063802
[21:12:45] ✅    ✅ Document 9205428 processed and saved successfully
[21:12:45] 🔄 
🔄 Step 8: Saving API details...
[21:12:45] [DOC: 9205428] ℹ️  API push details saved for document 9205428
[21:12:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205369                         ║
================================================================================
[21:12:45] ℹ️  Agency: AccentCare Fall River
[21:12:45] ℹ️  Date: 03/26/2025
[21:12:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:13:07] [DOC: 9205369] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[21:13:22] [DOC: 9205369] ✅ Text extracted using tesseract_ocr (25891 chars)
[21:13:22] ✅    ✅ Text extracted using tesseract_ocr (25866 chars)
[21:13:22] 🔄 
🔄 Step 2: Extracting patient data...
[21:13:25] ℹ️  AI extracted raw sex value: 'M'
[21:13:25] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:13:25] ℹ️  AI extracted payer source: 'Medicare'
[21:13:25] ℹ️  AI extracted diagnoses:
[21:13:25] ℹ️    - Diagnosis 1: 'G40.401'
[21:13:25] ℹ️    - Diagnosis 2: 'I69.354'
[21:13:25] ℹ️    - Diagnosis 3: 'I69.323'
[21:13:25] ℹ️    - Diagnosis 4: 'J45.909'
[21:13:25] ℹ️    - Diagnosis 5: 'F29'
[21:13:25] ℹ️    - Diagnosis 6: 'G89.29'
[21:13:25] ℹ️  Final extracted MRN: '0200204515501'
[21:13:25] ℹ️  Final extracted Sex: 'MALE'
[21:13:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:13:25] ℹ️  Final extracted Payer Source: 'Medicare'
[21:13:25] ✅ Patient data extraction completed successfully
[21:13:25] ✅    ✅ Patient data extracted successfully
[21:13:25] 📊 Patient Response
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA
     └─ dob: 10/23/1982
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200204515501
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 71 MERRIMAC ST, APT 1W
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740-
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/26/2024', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'G40.401', 'secondDiagnosis': 'I69.354', 'thirdDiagnosis': 'I69.323', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'F29', 'sixthDiagnosis': 'G89.29'}]
[21:13:25] ✅    ✅ Patient identified: MILTON ACOSTA
[21:13:25] ✅    ✅ Patient name validation passed
[21:13:25] 🔄 
🔄 Step 3: Processing patient dates...
[21:13:25] [DOC: 9205369] ℹ️  DOB normalized: 10/23/1982
[21:13:25] [DOC: 9205369] ℹ️  Episode startOfCare normalized: 07/26/2024
[21:13:25] [DOC: 9205369] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[21:13:25] [DOC: 9205369] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[21:13:25] [DOC: 9205369] ✅ Patient date processing completed successfully
[21:13:25] ✅    ✅ Date processing completed
[21:13:25] 📊 Processed Patient Data
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA
     └─ dob: 10/23/1982
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200204515501
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 71 MERRIMAC ST, APT 1W
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740-
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/26/2024', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'G40.401', 'secondDiagnosis': 'I69.354', 'thirdDiagnosis': 'I69.323', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'F29', 'sixthDiagnosis': 'G89.29'}]
[21:13:25] 🔄 
🔄 Step 4: Extracting order data...
[21:13:28] ℹ️  Order extraction - MRN: 'C0200204515501'
[21:13:28] ℹ️  Order extraction - Sex: 'MALE'
[21:13:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:13:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:13:28] ✅ Order data extraction completed successfully
[21:13:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:13:28] ℹ️  Using longer MRN from order data: 'C0200204515501' over '0200204515501'
[21:13:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:13:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:13:28] ✅ Patient name cross-validation successful
[21:13:28] ✅    ✅ Data merged successfully
[21:13:30] ✅    ✅ Order data extracted and validated
[21:13:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:13:36] [DOC: 9205369] ℹ️  Patient not found in cache or API: MILTON ACOSTA
[21:13:36] [DOC: 9205369] ℹ️  Patient not found, creating new patient via API...
[21:13:36] [DOC: 9205369] ℹ️  Creating patient via API: MILTON ACOSTA
[21:13:37] [DOC: 9205369] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:13:37] ❌    ❌ Failed to create patient
[21:13:37] [DOC: 9205369] ℹ️  API push details saved for document 9205369
================================================================================
║                        Processing Document ID: 9204844                         ║
================================================================================
[21:13:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:13:37] ℹ️  Date: 03/26/2025
[21:13:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:13:39] [DOC: 9204844] ✅ Text extracted using pdfplumber (1217 chars)
[21:13:39] ✅    ✅ Text extracted using pdfplumber (1217 chars)
[21:13:39] 🔄 
🔄 Step 2: Extracting patient data...
[21:13:41] ℹ️  AI extracted raw sex value: 'M'
[21:13:41] ℹ️  AI extracted service line: 'SN'
[21:13:41] ℹ️  AI extracted payer source: ''
[21:13:41] ℹ️  AI extracted diagnoses:
[21:13:41] ℹ️    - Diagnosis 1: ''
[21:13:41] ℹ️    - Diagnosis 2: ''
[21:13:41] ℹ️    - Diagnosis 3: ''
[21:13:41] ℹ️    - Diagnosis 4: ''
[21:13:41] ℹ️    - Diagnosis 5: ''
[21:13:41] ℹ️    - Diagnosis 6: ''
[21:13:41] ℹ️  Final extracted MRN: '3091790'
[21:13:41] ℹ️  Final extracted Sex: 'MALE'
[21:13:41] ℹ️  Final extracted Service Line: 'SN'
[21:13:41] ℹ️  Final extracted Payer Source: ''
[21:13:41] ✅ Patient data extraction completed successfully
[21:13:41] ✅    ✅ Patient data extracted successfully
[21:13:41] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: SN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:13:41] ✅    ✅ Patient identified: Richard White
[21:13:41] ✅    ✅ Patient name validation passed
[21:13:41] 🔄 
🔄 Step 3: Processing patient dates...
[21:13:41] [DOC: 9204844] ℹ️  DOB normalized: 12/08/1957
[21:13:41] [DOC: 9204844] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[21:13:41] [DOC: 9204844] ✅ Patient date processing completed successfully
[21:13:41] ✅    ✅ Date processing completed
[21:13:41] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: SN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:13:41] 🔄 
🔄 Step 4: Extracting order data...
[21:13:43] ℹ️  Order extraction - MRN: '3091790'
[21:13:43] ℹ️  Order extraction - Sex: 'MALE'
[21:13:43] ℹ️  Order extraction - Service Line: 'SN'
[21:13:43] ℹ️  Order extraction - Payer Source: ''
[21:13:43] ✅ Order data extraction completed successfully
[21:13:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:13:43] ℹ️  Using MRN from patient data: '3091790' over '3091790'
[21:13:43] ℹ️  Service line consistent in both sources: 'SN'
[21:13:43] ✅ Patient name cross-validation successful
[21:13:43] ✅    ✅ Data merged successfully
[21:13:48] ✅    ✅ Order data extracted and validated
[21:13:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:14:02] [DOC: 9204844] ℹ️  Patient not found in cache or API: Richard White
[21:14:02] [DOC: 9204844] ℹ️  Patient not found, creating new patient via API...
[21:14:02] [DOC: 9204844] ℹ️  Creating patient via API: Richard White
[21:14:03] [DOC: 9204844] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:14:03] ❌    ❌ Failed to create patient
[21:14:03] [DOC: 9204844] ℹ️  API push details saved for document 9204844
================================================================================
║                        Processing Document ID: 9204839                         ║
================================================================================
[21:14:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:14:03] ℹ️  Date: 03/26/2025
[21:14:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:14:07] [DOC: 9204839] ✅ Text extracted using pdfplumber (19955 chars)
[21:14:07] ✅    ✅ Text extracted using pdfplumber (19955 chars)
[21:14:07] 🔄 
🔄 Step 2: Extracting patient data...
[21:14:10] ℹ️  AI extracted raw sex value: 'F'
[21:14:10] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[21:14:10] ℹ️  AI extracted payer source: ''
[21:14:10] ℹ️  AI extracted diagnoses:
[21:14:10] ℹ️    - Diagnosis 1: 'M80.061D'
[21:14:10] ℹ️    - Diagnosis 2: 'N18.32'
[21:14:10] ℹ️    - Diagnosis 3: 'D63.1'
[21:14:10] ℹ️    - Diagnosis 4: 'M10.30'
[21:14:10] ℹ️    - Diagnosis 5: 'I73.9'
[21:14:10] ℹ️    - Diagnosis 6: 'G47.33'
[21:14:10] ℹ️  Final extracted MRN: '2936840'
[21:14:10] ℹ️  Final extracted Sex: 'FEMALE'
[21:14:10] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[21:14:10] ℹ️  Final extracted Payer Source: ''
[21:14:10] ✅ Patient data extraction completed successfully
[21:14:10] ✅    ✅ Patient data extracted successfully
[21:14:10] 📊 Patient Response
     └─ patientFName: Fotoula
     └─ patientLName: Sakellaropoulos
     └─ dob: 06/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936840
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 763 Hathaway Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-1945
     └─ email: 
     └─ phoneNumber: 508-496-6025
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'M80.061D', 'secondDiagnosis': 'N18.32', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'M10.30', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'G47.33'}]
[21:14:10] ✅    ✅ Patient identified: Fotoula Sakellaropoulos
[21:14:10] ✅    ✅ Patient name validation passed
[21:14:10] 🔄 
🔄 Step 3: Processing patient dates...
[21:14:10] [DOC: 9204839] ℹ️  DOB normalized: 06/08/1957
[21:14:10] [DOC: 9204839] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:14:10] [DOC: 9204839] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[21:14:10] [DOC: 9204839] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[21:14:10] [DOC: 9204839] ✅ Patient date processing completed successfully
[21:14:10] ✅    ✅ Date processing completed
[21:14:10] 📊 Processed Patient Data
     └─ patientFName: Fotoula
     └─ patientLName: Sakellaropoulos
     └─ dob: 06/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936840
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 763 Hathaway Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-1945
     └─ email: 
     └─ phoneNumber: 508-496-6025
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'M80.061D', 'secondDiagnosis': 'N18.32', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'M10.30', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'G47.33'}]
[21:14:10] 🔄 
🔄 Step 4: Extracting order data...
[21:14:13] ℹ️  Order extraction - MRN: '2936840'
[21:14:13] ℹ️  Order extraction - Sex: 'FEMALE'
[21:14:13] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:14:13] ℹ️  Order extraction - Payer Source: ''
[21:14:13] ✅ Order data extraction completed successfully
[21:14:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:14:13] ℹ️  Using MRN from patient data: '2936840' over '2936840'
[21:14:13] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[21:14:13] ✅ Patient name cross-validation successful
[21:14:13] ✅    ✅ Data merged successfully
[21:14:15] ✅    ✅ Order data extracted and validated
[21:14:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:15:08] [DOC: 9204839] ℹ️  Patient not found in cache or API: Fotoula Sakellaropoulos
[21:15:08] [DOC: 9204839] ℹ️  Patient not found, creating new patient via API...
[21:15:08] [DOC: 9204839] ℹ️  Creating patient via API: Fotoula Sakellaropoulos
[21:15:10] [DOC: 9204839] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:15:10] ❌    ❌ Failed to create patient
[21:15:10] [DOC: 9204839] ℹ️  API push details saved for document 9204839
================================================================================
║                        Processing Document ID: 9204833                         ║
================================================================================
[21:15:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:15:10] ℹ️  Date: 03/26/2025
[21:15:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:15:13] [DOC: 9204833] ✅ Text extracted using pdfplumber (19107 chars)
[21:15:13] ✅    ✅ Text extracted using pdfplumber (19097 chars)
[21:15:13] 🔄 
🔄 Step 2: Extracting patient data...
[21:15:17] ℹ️  AI extracted raw sex value: 'F'
[21:15:17] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:15:17] ℹ️  AI extracted payer source: ''
[21:15:17] ℹ️  AI extracted diagnoses:
[21:15:17] ℹ️    - Diagnosis 1: 'S06.350D'
[21:15:17] ℹ️    - Diagnosis 2: 'I48.0'
[21:15:17] ℹ️    - Diagnosis 3: 'I11.0'
[21:15:17] ℹ️    - Diagnosis 4: 'I50.32'
[21:15:17] ℹ️    - Diagnosis 5: 'G47.00'
[21:15:17] ℹ️    - Diagnosis 6: 'K52.89'
[21:15:17] ℹ️  Final extracted MRN: '2902972'
[21:15:17] ℹ️  Final extracted Sex: 'FEMALE'
[21:15:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:15:17] ℹ️  Final extracted Payer Source: ''
[21:15:17] ✅ Patient data extraction completed successfully
[21:15:17] ✅    ✅ Patient data extracted successfully
[21:15:17] 📊 Patient Response
     └─ patientFName: Anita
     └─ patientLName: Riley-Robinson
     └─ dob: 05/09/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2902972
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'S06.350D', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'G47.00', 'sixthDiagnosis': 'K52.89'}]
[21:15:17] ✅    ✅ Patient identified: Anita Riley-Robinson
[21:15:17] ✅    ✅ Patient name validation passed
[21:15:17] 🔄 
🔄 Step 3: Processing patient dates...
[21:15:17] [DOC: 9204833] ℹ️  DOB normalized: 05/09/1927
[21:15:17] [DOC: 9204833] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:15:17] [DOC: 9204833] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[21:15:17] [DOC: 9204833] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[21:15:17] [DOC: 9204833] ✅ Patient date processing completed successfully
[21:15:17] ✅    ✅ Date processing completed
[21:15:17] 📊 Processed Patient Data
     └─ patientFName: Anita
     └─ patientLName: Riley-Robinson
     └─ dob: 05/09/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2902972
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'S06.350D', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'G47.00', 'sixthDiagnosis': 'K52.89'}]
[21:15:17] 🔄 
🔄 Step 4: Extracting order data...
[21:15:20] ℹ️  Order extraction - MRN: '2902972'
[21:15:20] ℹ️  Order extraction - Sex: 'FEMALE'
[21:15:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:15:20] ℹ️  Order extraction - Payer Source: ''
[21:15:20] ✅ Order data extraction completed successfully
[21:15:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:15:20] ℹ️  Using MRN from patient data: '2902972' over '2902972'
[21:15:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:15:20] ✅ Patient name cross-validation successful
[21:15:20] ✅    ✅ Data merged successfully
[21:15:21] ✅    ✅ Order data extracted and validated
[21:15:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:15:27] [DOC: 9204833] ℹ️  Patient not found in cache or API: Anita Riley-Robinson
[21:15:27] [DOC: 9204833] ℹ️  Patient not found, creating new patient via API...
[21:15:27] [DOC: 9204833] ℹ️  Creating patient via API: Anita Riley-Robinson
[21:15:29] [DOC: 9204833] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:15:29] ❌    ❌ Failed to create patient
[21:15:29] [DOC: 9204833] ℹ️  API push details saved for document 9204833
================================================================================
║                        Processing Document ID: 9204812                         ║
================================================================================
[21:15:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:15:29] ℹ️  Date: 03/26/2025
[21:15:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:15:30] [DOC: 9204812] ✅ Text extracted using pdfplumber (893 chars)
[21:15:30] ✅    ✅ Text extracted using pdfplumber (893 chars)
[21:15:30] 🔄 
🔄 Step 2: Extracting patient data...
[21:15:33] ℹ️  AI extracted raw sex value: 'M'
[21:15:33] ℹ️  AI extracted service line: 'Physical Therapy'
[21:15:33] ℹ️  AI extracted payer source: ''
[21:15:33] ℹ️  AI extracted diagnoses:
[21:15:33] ℹ️    - Diagnosis 1: 'None'
[21:15:33] ℹ️    - Diagnosis 2: 'None'
[21:15:33] ℹ️    - Diagnosis 3: 'None'
[21:15:33] ℹ️    - Diagnosis 4: 'None'
[21:15:33] ℹ️    - Diagnosis 5: 'None'
[21:15:33] ℹ️    - Diagnosis 6: 'None'
[21:15:33] ℹ️  Final extracted MRN: '2405015'
[21:15:33] ℹ️  Final extracted Sex: 'MALE'
[21:15:33] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:15:33] ℹ️  Final extracted Payer Source: ''
[21:15:33] ✅ Patient data extraction completed successfully
[21:15:33] ✅    ✅ Patient data extracted successfully
[21:15:33] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Neves
     └─ dob: 06/17/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2405015
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:15:33] ✅    ✅ Patient identified: Joao Neves
[21:15:33] ✅    ✅ Patient name validation passed
[21:15:33] 🔄 
🔄 Step 3: Processing patient dates...
[21:15:33] [DOC: 9204812] ℹ️  DOB normalized: 06/17/1936
[21:15:33] [DOC: 9204812] ✅ Patient date processing completed successfully
[21:15:33] ✅    ✅ Date processing completed
[21:15:33] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Neves
     └─ dob: 06/17/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2405015
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:15:33] 🔄 
🔄 Step 4: Extracting order data...
[21:15:35] ℹ️  Order extraction - MRN: '2405015'
[21:15:35] ℹ️  Order extraction - Sex: 'MALE'
[21:15:35] ℹ️  Order extraction - Service Line: ''
[21:15:35] ℹ️  Order extraction - Payer Source: ''
[21:15:35] ✅ Order data extraction completed successfully
[21:15:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:15:35] ℹ️  Using MRN from patient data: '2405015' over '2405015'
[21:15:35] ℹ️  Using service line from patient data: 'Physical Therapy'
[21:15:35] ✅ Patient name cross-validation successful
[21:15:35] ✅    ✅ Data merged successfully
[21:15:36] ⚠️     ❌ Skipping - missing episode start date
[21:15:36] [DOC: 9204812] ℹ️  API push details saved for document 9204812
================================================================================
║                        Processing Document ID: 9204802                         ║
================================================================================
[21:15:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:15:36] ℹ️  Date: 03/26/2025
[21:15:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:15:37] [DOC: 9204802] ✅ Text extracted using pdfplumber (1034 chars)
[21:15:37] ✅    ✅ Text extracted using pdfplumber (1034 chars)
[21:15:37] 🔄 
🔄 Step 2: Extracting patient data...
[21:15:40] ℹ️  AI extracted raw sex value: 'F'
[21:15:40] ℹ️  AI extracted service line: 'Skilled Nursing, LPN'
[21:15:40] ℹ️  AI extracted payer source: ''
[21:15:40] ℹ️  AI extracted diagnoses:
[21:15:40] ℹ️    - Diagnosis 1: ''
[21:15:40] ℹ️    - Diagnosis 2: ''
[21:15:40] ℹ️    - Diagnosis 3: ''
[21:15:40] ℹ️    - Diagnosis 4: ''
[21:15:40] ℹ️    - Diagnosis 5: ''
[21:15:40] ℹ️    - Diagnosis 6: ''
[21:15:40] ℹ️  Final extracted MRN: '2773301'
[21:15:40] ℹ️  Final extracted Sex: 'FEMALE'
[21:15:40] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN'
[21:15:40] ℹ️  Final extracted Payer Source: ''
[21:15:40] ✅ Patient data extraction completed successfully
[21:15:40] ✅    ✅ Patient data extracted successfully
[21:15:40] 📊 Patient Response
     └─ patientFName: Arlene
     └─ patientLName: Moss
     └─ dob: 01/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773301
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:15:40] ✅    ✅ Patient identified: Arlene Moss
[21:15:40] ✅    ✅ Patient name validation passed
[21:15:40] 🔄 
🔄 Step 3: Processing patient dates...
[21:15:40] [DOC: 9204802] ℹ️  DOB normalized: 01/24/1959
[21:15:40] [DOC: 9204802] ✅ Patient date processing completed successfully
[21:15:40] ✅    ✅ Date processing completed
[21:15:40] 📊 Processed Patient Data
     └─ patientFName: Arlene
     └─ patientLName: Moss
     └─ dob: 01/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773301
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:15:40] 🔄 
🔄 Step 4: Extracting order data...
[21:15:42] ℹ️  Order extraction - MRN: '2773301'
[21:15:42] ℹ️  Order extraction - Sex: 'FEMALE'
[21:15:42] ℹ️  Order extraction - Service Line: ''
[21:15:42] ℹ️  Order extraction - Payer Source: ''
[21:15:42] ✅ Order data extraction completed successfully
[21:15:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:15:42] ℹ️  Using MRN from patient data: '2773301' over '2773301'
[21:15:42] ℹ️  Using service line from patient data: 'Skilled Nursing, LPN'
[21:15:42] ✅ Patient name cross-validation successful
[21:15:42] ✅    ✅ Data merged successfully
[21:15:44] ✅    ✅ Order data extracted and validated
[21:15:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:15:49] [DOC: 9204802] ℹ️  Patient not found in cache or API: Arlene Moss
[21:15:49] [DOC: 9204802] ℹ️  Patient not found, creating new patient via API...
[21:15:49] [DOC: 9204802] ℹ️  Creating patient via API: Arlene Moss
[21:15:50] [DOC: 9204802] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:15:50] ❌    ❌ Failed to create patient
[21:15:50] [DOC: 9204802] ℹ️  API push details saved for document 9204802
================================================================================
║                        Processing Document ID: 9204798                         ║
================================================================================
[21:15:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:15:50] ℹ️  Date: 03/26/2025
[21:15:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:15:52] [DOC: 9204798] ✅ Text extracted using pdfplumber (1120 chars)
[21:15:52] ✅    ✅ Text extracted using pdfplumber (1120 chars)
[21:15:52] 🔄 
🔄 Step 2: Extracting patient data...
[21:15:54] ℹ️  AI extracted raw sex value: 'F'
[21:15:54] ℹ️  AI extracted service line: 'PT'
[21:15:54] ℹ️  AI extracted payer source: ''
[21:15:54] ℹ️  AI extracted diagnoses:
[21:15:54] ℹ️    - Diagnosis 1: ''
[21:15:54] ℹ️    - Diagnosis 2: ''
[21:15:54] ℹ️    - Diagnosis 3: ''
[21:15:54] ℹ️    - Diagnosis 4: ''
[21:15:54] ℹ️    - Diagnosis 5: ''
[21:15:54] ℹ️    - Diagnosis 6: ''
[21:15:54] ℹ️  Final extracted MRN: '2743829'
[21:15:54] ℹ️  Final extracted Sex: 'FEMALE'
[21:15:54] ℹ️  Final extracted Service Line: 'PT'
[21:15:54] ℹ️  Final extracted Payer Source: ''
[21:15:54] ✅ Patient data extraction completed successfully
[21:15:54] ✅    ✅ Patient data extracted successfully
[21:15:54] 📊 Patient Response
     └─ patientFName: Ilda
     └─ patientLName: Mendes
     └─ dob: 09/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2743829
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:15:54] ✅    ✅ Patient identified: Ilda Mendes
[21:15:54] ✅    ✅ Patient name validation passed
[21:15:54] 🔄 
🔄 Step 3: Processing patient dates...
[21:15:54] [DOC: 9204798] ℹ️  DOB normalized: 09/26/1940
[21:15:54] [DOC: 9204798] ✅ Patient date processing completed successfully
[21:15:54] ✅    ✅ Date processing completed
[21:15:54] 📊 Processed Patient Data
     └─ patientFName: Ilda
     └─ patientLName: Mendes
     └─ dob: 09/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2743829
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:15:54] 🔄 
🔄 Step 4: Extracting order data...
[21:15:57] ℹ️  Order extraction - MRN: '2743829'
[21:15:57] ℹ️  Order extraction - Sex: 'FEMALE'
[21:15:57] ℹ️  Order extraction - Service Line: ''
[21:15:57] ℹ️  Order extraction - Payer Source: ''
[21:15:57] ✅ Order data extraction completed successfully
[21:15:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:15:57] ℹ️  Using MRN from patient data: '2743829' over '2743829'
[21:15:57] ℹ️  Using service line from patient data: 'PT'
[21:15:57] ✅ Patient name cross-validation successful
[21:15:57] ✅    ✅ Data merged successfully
[21:15:58] ✅    ✅ Order data extracted and validated
[21:15:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:16:03] [DOC: 9204798] ℹ️  Patient not found in cache or API: Ilda Mendes
[21:16:03] [DOC: 9204798] ℹ️  Patient not found, creating new patient via API...
[21:16:03] [DOC: 9204798] ℹ️  Creating patient via API: Ilda Mendes
[21:16:04] [DOC: 9204798] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:16:04] ❌    ❌ Failed to create patient
[21:16:04] [DOC: 9204798] ℹ️  API push details saved for document 9204798
================================================================================
║                        Processing Document ID: 9204791                         ║
================================================================================
[21:16:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:16:04] ℹ️  Date: 03/26/2025
[21:16:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:16:06] [DOC: 9204791] ✅ Text extracted using pdfplumber (2236 chars)
[21:16:06] ✅    ✅ Text extracted using pdfplumber (2236 chars)
[21:16:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:16:08] ℹ️  AI extracted raw sex value: 'M'
[21:16:08] ℹ️  AI extracted service line: 'RN'
[21:16:08] ℹ️  AI extracted payer source: ''
[21:16:08] ℹ️  AI extracted diagnoses:
[21:16:08] ℹ️    - Diagnosis 1: 'None'
[21:16:08] ℹ️    - Diagnosis 2: 'None'
[21:16:08] ℹ️    - Diagnosis 3: 'None'
[21:16:08] ℹ️    - Diagnosis 4: 'None'
[21:16:08] ℹ️    - Diagnosis 5: 'None'
[21:16:08] ℹ️    - Diagnosis 6: 'None'
[21:16:08] ℹ️  Final extracted MRN: '2621702'
[21:16:08] ℹ️  Final extracted Sex: 'MALE'
[21:16:08] ℹ️  Final extracted Service Line: 'RN'
[21:16:08] ℹ️  Final extracted Payer Source: ''
[21:16:08] ✅ Patient data extraction completed successfully
[21:16:08] ✅    ✅ Patient data extracted successfully
[21:16:08] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:16:08] ✅    ✅ Patient identified: Bernard Klim
[21:16:08] ✅    ✅ Patient name validation passed
[21:16:08] 🔄 
🔄 Step 3: Processing patient dates...
[21:16:08] [DOC: 9204791] ℹ️  DOB normalized: 09/20/1957
[21:16:08] [DOC: 9204791] ✅ Patient date processing completed successfully
[21:16:08] ✅    ✅ Date processing completed
[21:16:08] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:16:08] 🔄 
🔄 Step 4: Extracting order data...
[21:16:11] ℹ️  Order extraction - MRN: '2621702'
[21:16:11] ℹ️  Order extraction - Sex: 'MALE'
[21:16:11] ℹ️  Order extraction - Service Line: ''
[21:16:11] ℹ️  Order extraction - Payer Source: ''
[21:16:11] ✅ Order data extraction completed successfully
[21:16:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:16:11] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[21:16:11] ℹ️  Using service line from patient data: 'RN'
[21:16:11] ✅ Patient name cross-validation successful
[21:16:11] ✅    ✅ Data merged successfully
[21:16:12] ⚠️     ❌ Skipping - missing episode start date
[21:16:12] [DOC: 9204791] ℹ️  API push details saved for document 9204791
================================================================================
║                        Processing Document ID: 9204785                         ║
================================================================================
[21:16:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:16:12] ℹ️  Date: 03/26/2025
[21:16:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:16:15] [DOC: 9204785] ✅ Text extracted using pdfplumber (17565 chars)
[21:16:15] ✅    ✅ Text extracted using pdfplumber (17555 chars)
[21:16:15] 🔄 
🔄 Step 2: Extracting patient data...
[21:16:18] ℹ️  AI extracted raw sex value: 'M'
[21:16:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:16:18] ℹ️  AI extracted payer source: ''
[21:16:18] ℹ️  AI extracted diagnoses:
[21:16:18] ℹ️    - Diagnosis 1: 'A41.51'
[21:16:18] ℹ️    - Diagnosis 2: 'N39.0'
[21:16:18] ℹ️    - Diagnosis 3: 'I12.9'
[21:16:18] ℹ️    - Diagnosis 4: 'N18.32'
[21:16:18] ℹ️    - Diagnosis 5: 'N31.9'
[21:16:18] ℹ️    - Diagnosis 6: 'F32.A'
[21:16:18] ℹ️  Final extracted MRN: '2621702'
[21:16:18] ℹ️  Final extracted Sex: 'MALE'
[21:16:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:16:18] ℹ️  Final extracted Payer Source: ''
[21:16:18] ✅ Patient data extraction completed successfully
[21:16:18] ✅    ✅ Patient data extracted successfully
[21:16:18] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'F32.A'}]
[21:16:18] ✅    ✅ Patient identified: Bernard Klim
[21:16:18] ✅    ✅ Patient name validation passed
[21:16:18] 🔄 
🔄 Step 3: Processing patient dates...
[21:16:18] [DOC: 9204785] ℹ️  DOB normalized: 09/20/1957
[21:16:18] [DOC: 9204785] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:16:18] [DOC: 9204785] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[21:16:18] [DOC: 9204785] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[21:16:18] [DOC: 9204785] ✅ Patient date processing completed successfully
[21:16:18] ✅    ✅ Date processing completed
[21:16:18] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'F32.A'}]
[21:16:18] 🔄 
🔄 Step 4: Extracting order data...
[21:16:21] ℹ️  Order extraction - MRN: '2621702'
[21:16:21] ℹ️  Order extraction - Sex: 'MALE'
[21:16:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:16:21] ℹ️  Order extraction - Payer Source: ''
[21:16:21] ✅ Order data extraction completed successfully
[21:16:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:16:21] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[21:16:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:16:21] ✅ Patient name cross-validation successful
[21:16:21] ✅    ✅ Data merged successfully
[21:16:24] ✅    ✅ Order data extracted and validated
[21:16:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:16:36] [DOC: 9204785] ℹ️  Patient not found in cache or API: Bernard Klim
[21:16:36] [DOC: 9204785] ℹ️  Patient not found, creating new patient via API...
[21:16:36] [DOC: 9204785] ℹ️  Creating patient via API: Bernard Klim
[21:16:37] [DOC: 9204785] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:16:37] ❌    ❌ Failed to create patient
[21:16:37] [DOC: 9204785] ℹ️  API push details saved for document 9204785
================================================================================
║                        Processing Document ID: 9204778                         ║
================================================================================
[21:16:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:16:37] ℹ️  Date: 03/26/2025
[21:16:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:16:38] [DOC: 9204778] ✅ Text extracted using pdfplumber (1014 chars)
[21:16:38] ✅    ✅ Text extracted using pdfplumber (1014 chars)
[21:16:38] 🔄 
🔄 Step 2: Extracting patient data...
[21:16:41] ℹ️  AI extracted raw sex value: 'M'
[21:16:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:16:41] ℹ️  AI extracted payer source: ''
[21:16:41] ℹ️  AI extracted diagnoses:
[21:16:41] ℹ️    - Diagnosis 1: 'None'
[21:16:41] ℹ️    - Diagnosis 2: 'None'
[21:16:41] ℹ️    - Diagnosis 3: 'None'
[21:16:41] ℹ️    - Diagnosis 4: 'None'
[21:16:41] ℹ️    - Diagnosis 5: 'None'
[21:16:41] ℹ️    - Diagnosis 6: 'None'
[21:16:41] ℹ️  Final extracted MRN: '2136200'
[21:16:41] ℹ️  Final extracted Sex: 'MALE'
[21:16:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:16:41] ℹ️  Final extracted Payer Source: ''
[21:16:41] ✅ Patient data extraction completed successfully
[21:16:41] ✅    ✅ Patient data extracted successfully
[21:16:41] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu A
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:16:41] ✅    ✅ Patient identified: Jacob Amadeu A
[21:16:41] ✅    ✅ Patient name validation passed
[21:16:41] 🔄 
🔄 Step 3: Processing patient dates...
[21:16:41] [DOC: 9204778] ℹ️  DOB normalized: 04/03/1941
[21:16:41] [DOC: 9204778] ✅ Patient date processing completed successfully
[21:16:41] ✅    ✅ Date processing completed
[21:16:41] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu A
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:16:41] 🔄 
🔄 Step 4: Extracting order data...
[21:16:43] ℹ️  Order extraction - MRN: '2136200'
[21:16:43] ℹ️  Order extraction - Sex: 'MALE'
[21:16:43] ℹ️  Order extraction - Service Line: ''
[21:16:43] ℹ️  Order extraction - Payer Source: ''
[21:16:43] ✅ Order data extraction completed successfully
[21:16:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:16:43] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[21:16:43] ℹ️  Using service line from patient data: 'Skilled Nursing'
[21:16:43] ✅ Patient name cross-validation successful
[21:16:43] ✅    ✅ Data merged successfully
[21:16:44] ✅    ✅ Order data extracted and validated
[21:16:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:16:49] [DOC: 9204778] ℹ️  Patient not found in cache or API: Jacob Amadeu A
[21:16:49] [DOC: 9204778] ℹ️  Patient not found, creating new patient via API...
[21:16:49] [DOC: 9204778] ℹ️  Creating patient via API: Jacob Amadeu A
[21:16:50] [DOC: 9204778] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:16:50] ❌    ❌ Failed to create patient
[21:16:50] [DOC: 9204778] ℹ️  API push details saved for document 9204778
================================================================================
║                        Processing Document ID: 9204775                         ║
================================================================================
[21:16:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:16:50] ℹ️  Date: 03/26/2025
[21:16:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:16:51] [DOC: 9204775] ✅ Text extracted using pdfplumber (1039 chars)
[21:16:51] ✅    ✅ Text extracted using pdfplumber (1039 chars)
[21:16:51] 🔄 
🔄 Step 2: Extracting patient data...
[21:16:54] ℹ️  AI extracted raw sex value: 'F'
[21:16:54] ℹ️  AI extracted service line: 'Nursing'
[21:16:54] ℹ️  AI extracted payer source: ''
[21:16:54] ℹ️  AI extracted diagnoses:
[21:16:54] ℹ️    - Diagnosis 1: ''
[21:16:54] ℹ️    - Diagnosis 2: ''
[21:16:54] ℹ️    - Diagnosis 3: ''
[21:16:54] ℹ️    - Diagnosis 4: ''
[21:16:54] ℹ️    - Diagnosis 5: ''
[21:16:54] ℹ️    - Diagnosis 6: ''
[21:16:54] ℹ️  Final extracted MRN: '2467814'
[21:16:54] ℹ️  Final extracted Sex: 'FEMALE'
[21:16:54] ℹ️  Final extracted Service Line: 'Nursing'
[21:16:54] ℹ️  Final extracted Payer Source: ''
[21:16:54] ✅ Patient data extraction completed successfully
[21:16:54] ✅    ✅ Patient data extracted successfully
[21:16:54] 📊 Patient Response
     └─ patientFName: Natalie
     └─ patientLName: Ferreira
     └─ dob: 05/21/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467814
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:16:54] ✅    ✅ Patient identified: Natalie Ferreira
[21:16:54] ✅    ✅ Patient name validation passed
[21:16:54] 🔄 
🔄 Step 3: Processing patient dates...
[21:16:54] [DOC: 9204775] ℹ️  DOB normalized: 05/21/1923
[21:16:54] [DOC: 9204775] ✅ Patient date processing completed successfully
[21:16:54] ✅    ✅ Date processing completed
[21:16:54] 📊 Processed Patient Data
     └─ patientFName: Natalie
     └─ patientLName: Ferreira
     └─ dob: 05/21/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467814
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:16:54] 🔄 
🔄 Step 4: Extracting order data...
[21:16:56] ℹ️  Order extraction - MRN: '2467814'
[21:16:56] ℹ️  Order extraction - Sex: 'FEMALE'
[21:16:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:16:56] ℹ️  Order extraction - Payer Source: ''
[21:16:56] ✅ Order data extraction completed successfully
[21:16:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:16:56] ℹ️  Using MRN from patient data: '2467814' over '2467814'
[21:16:56] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[21:16:56] ✅ Patient name cross-validation successful
[21:16:56] ✅    ✅ Data merged successfully
[21:16:57] ✅    ✅ Order data extracted and validated
[21:16:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:16:57] [DOC: 9204775] ✅ Patient found in local cache: Natalie Ferreira, ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[21:16:57] ✅    ✅ Existing patient found with ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[21:16:57] 🔄 
🔄 Step 6: Pushing order to API...
[21:16:57] [DOC: 9204775] ℹ️  Pushing order via API for patient ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[21:16:58] [DOC: 9204775] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20077"}
[21:16:58] ❌    ❌ Failed to push order
[21:16:58] 🔄 
🔄 Step 7: Writing to CSV...
[21:16:58] [DOC: 9204775] ℹ️  Calculated age: 102 from DOB: 05/21/1923
[21:16:58] [DOC: 9204775] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[21:16:58] [DOC: 9204775] ℹ️  Payer Source extracted: ''
[21:16:58] [DOC: 9204775] ℹ️  Diagnosis codes being written:
[21:16:58] [DOC: 9204775] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:16:58] [DOC: 9204775] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:16:58] [DOC: 9204775] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:16:58] [DOC: 9204775] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:16:58] [DOC: 9204775] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:16:58] [DOC: 9204775] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:16:58] [DOC: 9204775] ✅ Patient data written to CSV: Natalie Ferreira | Sex: FEMALE | Age: 102 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2467814
[21:16:58] ✅    ✅ Document 9204775 processed and saved successfully
[21:16:58] 🔄 
🔄 Step 8: Saving API details...
[21:16:58] [DOC: 9204775] ℹ️  API push details saved for document 9204775
[21:16:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204764                         ║
================================================================================
[21:16:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:16:58] ℹ️  Date: 03/26/2025
[21:16:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:17:00] [DOC: 9204764] ✅ Text extracted using pdfplumber (1614 chars)
[21:17:00] ✅    ✅ Text extracted using pdfplumber (1614 chars)
[21:17:00] 🔄 
🔄 Step 2: Extracting patient data...
[21:17:02] ℹ️  AI extracted raw sex value: 'F'
[21:17:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:17:02] ℹ️  AI extracted payer source: ''
[21:17:02] ℹ️  AI extracted diagnoses:
[21:17:02] ℹ️    - Diagnosis 1: ''
[21:17:02] ℹ️    - Diagnosis 2: ''
[21:17:02] ℹ️    - Diagnosis 3: ''
[21:17:02] ℹ️    - Diagnosis 4: ''
[21:17:02] ℹ️    - Diagnosis 5: ''
[21:17:02] ℹ️    - Diagnosis 6: ''
[21:17:02] ℹ️  Final extracted MRN: '2409497'
[21:17:02] ℹ️  Final extracted Sex: 'FEMALE'
[21:17:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:17:02] ℹ️  Final extracted Payer Source: ''
[21:17:02] ✅ Patient data extraction completed successfully
[21:17:02] ✅    ✅ Patient data extracted successfully
[21:17:02] 📊 Patient Response
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:17:02] ✅    ✅ Patient identified: Juliet Desnoyers
[21:17:02] ✅    ✅ Patient name validation passed
[21:17:02] 🔄 
🔄 Step 3: Processing patient dates...
[21:17:02] [DOC: 9204764] ℹ️  DOB normalized: 11/13/1938
[21:17:02] [DOC: 9204764] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:17:02] [DOC: 9204764] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[21:17:02] [DOC: 9204764] ✅ Patient date processing completed successfully
[21:17:02] ✅    ✅ Date processing completed
[21:17:02] 📊 Processed Patient Data
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:17:02] 🔄 
🔄 Step 4: Extracting order data...
[21:17:05] ℹ️  Order extraction - MRN: '2409497'
[21:17:05] ℹ️  Order extraction - Sex: 'FEMALE'
[21:17:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:17:05] ℹ️  Order extraction - Payer Source: ''
[21:17:05] ✅ Order data extraction completed successfully
[21:17:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:17:05] ℹ️  Using MRN from patient data: '2409497' over '2409497'
[21:17:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:17:05] ✅ Patient name cross-validation successful
[21:17:05] ✅    ✅ Data merged successfully
[21:17:06] ✅    ✅ Order data extracted and validated
[21:17:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:17:11] [DOC: 9204764] ℹ️  Patient not found in cache or API: Juliet Desnoyers
[21:17:11] [DOC: 9204764] ℹ️  Patient not found, creating new patient via API...
[21:17:11] [DOC: 9204764] ℹ️  Creating patient via API: Juliet Desnoyers
[21:17:12] [DOC: 9204764] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:17:12] ❌    ❌ Failed to create patient
[21:17:12] [DOC: 9204764] ℹ️  API push details saved for document 9204764
================================================================================
║                        Processing Document ID: 9204757                         ║
================================================================================
[21:17:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:17:12] ℹ️  Date: 03/26/2025
[21:17:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:17:14] [DOC: 9204757] ✅ Text extracted using pdfplumber (2074 chars)
[21:17:14] ✅    ✅ Text extracted using pdfplumber (2074 chars)
[21:17:14] 🔄 
🔄 Step 2: Extracting patient data...
[21:17:17] ℹ️  AI extracted raw sex value: 'M'
[21:17:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:17:17] ℹ️  AI extracted payer source: ''
[21:17:17] ℹ️  AI extracted diagnoses:
[21:17:17] ℹ️    - Diagnosis 1: ''
[21:17:17] ℹ️    - Diagnosis 2: ''
[21:17:17] ℹ️    - Diagnosis 3: ''
[21:17:17] ℹ️    - Diagnosis 4: ''
[21:17:17] ℹ️    - Diagnosis 5: ''
[21:17:17] ℹ️    - Diagnosis 6: ''
[21:17:17] ℹ️  Final extracted MRN: '2400478'
[21:17:17] ℹ️  Final extracted Sex: 'MALE'
[21:17:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:17:17] ℹ️  Final extracted Payer Source: ''
[21:17:17] ✅ Patient data extraction completed successfully
[21:17:17] ✅    ✅ Patient data extracted successfully
[21:17:17] 📊 Patient Response
     └─ patientFName: Juan
     └─ patientLName: Torres
     └─ dob: 05/10/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2400478
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:17:17] ✅    ✅ Patient identified: Juan Torres
[21:17:17] ✅    ✅ Patient name validation passed
[21:17:17] 🔄 
🔄 Step 3: Processing patient dates...
[21:17:17] [DOC: 9204757] ℹ️  DOB normalized: 05/10/1941
[21:17:17] [DOC: 9204757] ✅ Patient date processing completed successfully
[21:17:17] ✅    ✅ Date processing completed
[21:17:17] 📊 Processed Patient Data
     └─ patientFName: Juan
     └─ patientLName: Torres
     └─ dob: 05/10/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2400478
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:17:17] 🔄 
🔄 Step 4: Extracting order data...
[21:17:19] ℹ️  Order extraction - MRN: '2400478'
[21:17:19] ℹ️  Order extraction - Sex: 'MALE'
[21:17:19] ℹ️  Order extraction - Service Line: ''
[21:17:19] ℹ️  Order extraction - Payer Source: ''
[21:17:19] ✅ Order data extraction completed successfully
[21:17:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:17:19] ℹ️  Using MRN from patient data: '2400478' over '2400478'
[21:17:19] ℹ️  Using service line from patient data: 'Skilled Nursing'
[21:17:19] ✅ Patient name cross-validation successful
[21:17:19] ✅    ✅ Data merged successfully
[21:17:20] ⚠️     ❌ Skipping - missing episode start date
[21:17:20] [DOC: 9204757] ℹ️  API push details saved for document 9204757
================================================================================
║                        Processing Document ID: 9204744                         ║
================================================================================
[21:17:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:17:20] ℹ️  Date: 03/26/2025
[21:17:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:17:24] [DOC: 9204744] ✅ Text extracted using pdfplumber (22412 chars)
[21:17:24] ✅    ✅ Text extracted using pdfplumber (22400 chars)
[21:17:24] 🔄 
🔄 Step 2: Extracting patient data...
[21:17:27] ℹ️  AI extracted raw sex value: 'F'
[21:17:27] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[21:17:27] ℹ️  AI extracted payer source: ''
[21:17:27] ℹ️  AI extracted diagnoses:
[21:17:27] ℹ️    - Diagnosis 1: 'I95.89'
[21:17:27] ℹ️    - Diagnosis 2: 'F03.90'
[21:17:27] ℹ️    - Diagnosis 3: 'M62.84'
[21:17:27] ℹ️    - Diagnosis 4: 'I10'
[21:17:27] ℹ️    - Diagnosis 5: 'L40.9'
[21:17:27] ℹ️    - Diagnosis 6: 'E66.3'
[21:17:27] ℹ️  Final extracted MRN: '2366208'
[21:17:27] ℹ️  Final extracted Sex: 'FEMALE'
[21:17:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[21:17:27] ℹ️  Final extracted Payer Source: ''
[21:17:27] ✅ Patient data extraction completed successfully
[21:17:27] ✅    ✅ Patient data extracted successfully
[21:17:27] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Couto
     └─ dob: 07/02/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2366208
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I95.89', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'M62.84', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'L40.9', 'sixthDiagnosis': 'E66.3'}]
[21:17:27] ✅    ✅ Patient identified: Maria Couto
[21:17:27] ✅    ✅ Patient name validation passed
[21:17:27] 🔄 
🔄 Step 3: Processing patient dates...
[21:17:27] [DOC: 9204744] ℹ️  DOB normalized: 07/02/1943
[21:17:27] [DOC: 9204744] ℹ️  Episode startOfCare normalized: 03/04/2025
[21:17:27] [DOC: 9204744] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:17:27] [DOC: 9204744] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:17:27] [DOC: 9204744] ✅ Patient date processing completed successfully
[21:17:27] ✅    ✅ Date processing completed
[21:17:27] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Couto
     └─ dob: 07/02/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2366208
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I95.89', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'M62.84', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'L40.9', 'sixthDiagnosis': 'E66.3'}]
[21:17:27] 🔄 
🔄 Step 4: Extracting order data...
[21:17:30] ℹ️  Order extraction - MRN: '2366208'
[21:17:30] ℹ️  Order extraction - Sex: 'FEMALE'
[21:17:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Medical Social Work, Occupational Therapy, Physical Therapy'
[21:17:30] ℹ️  Order extraction - Payer Source: ''
[21:17:30] ✅ Order data extraction completed successfully
[21:17:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:17:30] ℹ️  Using MRN from patient data: '2366208' over '2366208'
[21:17:30] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work' + Order='Skilled Nursing, Medical Social Work, Occupational Therapy, Physical Therapy' = 'Medical Social Work, Occupational Therapy, Physical Therapy, Skilled Nursing'
[21:17:30] ✅ Patient name cross-validation successful
[21:17:30] ✅    ✅ Data merged successfully
[21:17:31] ✅    ✅ Order data extracted and validated
[21:17:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:17:38] [DOC: 9204744] ℹ️  Patient not found in cache or API: Maria Couto
[21:17:38] [DOC: 9204744] ℹ️  Patient not found, creating new patient via API...
[21:17:38] [DOC: 9204744] ℹ️  Creating patient via API: Maria Couto
[21:17:39] [DOC: 9204744] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:17:39] ❌    ❌ Failed to create patient
[21:17:39] [DOC: 9204744] ℹ️  API push details saved for document 9204744
================================================================================
║                        Processing Document ID: 9204734                         ║
================================================================================
[21:17:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:17:39] ℹ️  Date: 03/26/2025
[21:17:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:17:41] [DOC: 9204734] ✅ Text extracted using pdfplumber (3548 chars)
[21:17:41] ✅    ✅ Text extracted using pdfplumber (3548 chars)
[21:17:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:17:43] ℹ️  AI extracted raw sex value: 'M'
[21:17:43] ℹ️  AI extracted service line: 'Physical Therapy'
[21:17:43] ℹ️  AI extracted payer source: ''
[21:17:43] ℹ️  AI extracted diagnoses:
[21:17:43] ℹ️    - Diagnosis 1: 'None'
[21:17:43] ℹ️    - Diagnosis 2: 'None'
[21:17:43] ℹ️    - Diagnosis 3: 'None'
[21:17:43] ℹ️    - Diagnosis 4: 'None'
[21:17:43] ℹ️    - Diagnosis 5: 'None'
[21:17:43] ℹ️    - Diagnosis 6: 'None'
[21:17:43] ℹ️  Final extracted MRN: '2094562'
[21:17:43] ℹ️  Final extracted Sex: 'MALE'
[21:17:43] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:17:43] ℹ️  Final extracted Payer Source: ''
[21:17:43] ✅ Patient data extraction completed successfully
[21:17:43] ✅    ✅ Patient data extracted successfully
[21:17:43] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:17:43] ✅    ✅ Patient identified: Edward Correia
[21:17:43] ✅    ✅ Patient name validation passed
[21:17:43] 🔄 
🔄 Step 3: Processing patient dates...
[21:17:43] [DOC: 9204734] ℹ️  DOB normalized: 07/27/1950
[21:17:43] [DOC: 9204734] ✅ Patient date processing completed successfully
[21:17:43] ✅    ✅ Date processing completed
[21:17:43] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:17:43] 🔄 
🔄 Step 4: Extracting order data...
[21:17:46] ℹ️  Order extraction - MRN: '2094562'
[21:17:46] ℹ️  Order extraction - Sex: 'MALE'
[21:17:46] ℹ️  Order extraction - Service Line: ''
[21:17:46] ℹ️  Order extraction - Payer Source: ''
[21:17:46] ✅ Order data extraction completed successfully
[21:17:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:17:46] ℹ️  Using MRN from patient data: '2094562' over '2094562'
[21:17:46] ℹ️  Using service line from patient data: 'Physical Therapy'
[21:17:46] ✅ Patient name cross-validation successful
[21:17:46] ✅    ✅ Data merged successfully
[21:17:47] ⚠️     ❌ Skipping - missing episode start date
[21:17:47] [DOC: 9204734] ℹ️  API push details saved for document 9204734
================================================================================
║                        Processing Document ID: 9204721                         ║
================================================================================
[21:17:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:17:47] ℹ️  Date: 03/26/2025
[21:17:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:17:49] [DOC: 9204721] ✅ Text extracted using pdfplumber (1196 chars)
[21:17:49] ✅    ✅ Text extracted using pdfplumber (1196 chars)
[21:17:49] 🔄 
🔄 Step 2: Extracting patient data...
[21:17:52] ℹ️  AI extracted raw sex value: 'M'
[21:17:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:17:52] ℹ️  AI extracted payer source: ''
[21:17:52] ℹ️  AI extracted diagnoses:
[21:17:52] ℹ️    - Diagnosis 1: ''
[21:17:52] ℹ️    - Diagnosis 2: ''
[21:17:52] ℹ️    - Diagnosis 3: ''
[21:17:52] ℹ️    - Diagnosis 4: ''
[21:17:52] ℹ️    - Diagnosis 5: ''
[21:17:52] ℹ️    - Diagnosis 6: ''
[21:17:52] ℹ️  Final extracted MRN: '2312121'
[21:17:52] ℹ️  Final extracted Sex: 'MALE'
[21:17:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:17:52] ℹ️  Final extracted Payer Source: ''
[21:17:52] ✅ Patient data extraction completed successfully
[21:17:52] ✅    ✅ Patient data extracted successfully
[21:17:52] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:17:52] ✅    ✅ Patient identified: Antonio Carvalho
[21:17:52] ✅    ✅ Patient name validation passed
[21:17:52] 🔄 
🔄 Step 3: Processing patient dates...
[21:17:52] [DOC: 9204721] ℹ️  DOB normalized: 07/01/1933
[21:17:52] [DOC: 9204721] ✅ Patient date processing completed successfully
[21:17:52] ✅    ✅ Date processing completed
[21:17:52] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:17:52] 🔄 
🔄 Step 4: Extracting order data...
[21:17:54] ℹ️  Order extraction - MRN: '2312121'
[21:17:54] ℹ️  Order extraction - Sex: 'MALE'
[21:17:54] ℹ️  Order extraction - Service Line: ''
[21:17:54] ℹ️  Order extraction - Payer Source: ''
[21:17:54] ✅ Order data extraction completed successfully
[21:17:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:17:54] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[21:17:54] ℹ️  Using service line from patient data: 'Skilled Nursing'
[21:17:54] ✅ Patient name cross-validation successful
[21:17:54] ✅    ✅ Data merged successfully
[21:17:55] ⚠️     ❌ Skipping - missing episode start date
[21:17:55] [DOC: 9204721] ℹ️  API push details saved for document 9204721
================================================================================
║                        Processing Document ID: 9204716                         ║
================================================================================
[21:17:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:17:55] ℹ️  Date: 03/26/2025
[21:17:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:17:58] [DOC: 9204716] ✅ Text extracted using pdfplumber (10101 chars)
[21:17:58] ✅    ✅ Text extracted using pdfplumber (10101 chars)
[21:17:58] 🔄 
🔄 Step 2: Extracting patient data...
[21:18:01] ℹ️  AI extracted raw sex value: 'F'
[21:18:01] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:18:01] ℹ️  AI extracted payer source: ''
[21:18:01] ℹ️  AI extracted diagnoses:
[21:18:01] ℹ️    - Diagnosis 1: 'C92.00'
[21:18:01] ℹ️    - Diagnosis 2: 'D63.0'
[21:18:01] ℹ️    - Diagnosis 3: 'D69.6'
[21:18:01] ℹ️    - Diagnosis 4: 'D72.820'
[21:18:01] ℹ️    - Diagnosis 5: 'M17.12'
[21:18:01] ℹ️    - Diagnosis 6: 'S80.12XD'
[21:18:01] ℹ️  Final extracted MRN: '2287746'
[21:18:01] ℹ️  Final extracted Sex: 'FEMALE'
[21:18:01] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:18:01] ℹ️  Final extracted Payer Source: ''
[21:18:01] ✅ Patient data extraction completed successfully
[21:18:01] ✅    ✅ Patient data extracted successfully
[21:18:01] 📊 Patient Response
     └─ patientFName: Priscilla
     └─ patientLName: Cabeca
     └─ dob: 01/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2287746
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': 'C92.00', 'secondDiagnosis': 'D63.0', 'thirdDiagnosis': 'D69.6', 'fourthDiagnosis': 'D72.820', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'S80.12XD'}]
[21:18:01] ✅    ✅ Patient identified: Priscilla Cabeca
[21:18:01] ✅    ✅ Patient name validation passed
[21:18:01] 🔄 
🔄 Step 3: Processing patient dates...
[21:18:01] [DOC: 9204716] ℹ️  DOB normalized: 01/21/1941
[21:18:01] [DOC: 9204716] ℹ️  Episode startOfCare normalized: 03/14/2025
[21:18:01] [DOC: 9204716] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[21:18:01] [DOC: 9204716] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[21:18:01] [DOC: 9204716] ✅ Patient date processing completed successfully
[21:18:01] ✅    ✅ Date processing completed
[21:18:01] 📊 Processed Patient Data
     └─ patientFName: Priscilla
     └─ patientLName: Cabeca
     └─ dob: 01/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2287746
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': 'C92.00', 'secondDiagnosis': 'D63.0', 'thirdDiagnosis': 'D69.6', 'fourthDiagnosis': 'D72.820', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'S80.12XD'}]
[21:18:01] 🔄 
🔄 Step 4: Extracting order data...
[21:18:04] ℹ️  Order extraction - MRN: '2287746'
[21:18:04] ℹ️  Order extraction - Sex: 'FEMALE'
[21:18:04] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:18:04] ℹ️  Order extraction - Payer Source: ''
[21:18:04] ✅ Order data extraction completed successfully
[21:18:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:18:04] ℹ️  Using MRN from patient data: '2287746' over '2287746'
[21:18:04] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:18:04] ✅ Patient name cross-validation successful
[21:18:04] ✅    ✅ Data merged successfully
[21:18:05] ✅    ✅ Order data extracted and validated
[21:18:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:18:05] [DOC: 9204716] ✅ Patient found in local cache: Priscilla Cabeca, ID: eb0c3877-011b-4332-aac2-fb95712aa53e
[21:18:05] ✅    ✅ Existing patient found with ID: eb0c3877-011b-4332-aac2-fb95712aa53e
[21:18:05] 🔄 
🔄 Step 6: Pushing order to API...
[21:18:05] [DOC: 9204716] ℹ️  Pushing order via API for patient ID: eb0c3877-011b-4332-aac2-fb95712aa53e
[21:18:06] [DOC: 9204716] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13421"}
[21:18:06] ❌    ❌ Failed to push order
[21:18:06] 🔄 
🔄 Step 7: Writing to CSV...
[21:18:06] [DOC: 9204716] ℹ️  Calculated age: 84 from DOB: 01/21/1941
[21:18:06] [DOC: 9204716] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:18:06] [DOC: 9204716] ℹ️  Payer Source extracted: ''
[21:18:06] [DOC: 9204716] ℹ️  Diagnosis codes being written:
[21:18:06] [DOC: 9204716] ℹ️    - Latest_Episode_Firstdiagnosis: 'C92.00'
[21:18:06] [DOC: 9204716] ℹ️    - Latest_Episode_Seconddiagnosis: 'D63.0'
[21:18:06] [DOC: 9204716] ℹ️    - Latest_Episode_Thirddiagnosis: 'D69.6'
[21:18:06] [DOC: 9204716] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D72.820'
[21:18:06] [DOC: 9204716] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M17.12'
[21:18:06] [DOC: 9204716] ℹ️    - Latest_Episode_Sixthdiagnosis: 'S80.12XD'
[21:18:06] [DOC: 9204716] ✅ Patient data written to CSV: Priscilla Cabeca | Sex: FEMALE | Age: 84 | Service: Occupational Therapy | Payer:  | MRN: 2287746
[21:18:06] ✅    ✅ Document 9204716 processed and saved successfully
[21:18:06] 🔄 
🔄 Step 8: Saving API details...
[21:18:06] [DOC: 9204716] ℹ️  API push details saved for document 9204716
[21:18:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204710                         ║
================================================================================
[21:18:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:18:06] ℹ️  Date: 03/26/2025
[21:18:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:18:07] [DOC: 9204710] ✅ Text extracted using pdfplumber (1028 chars)
[21:18:07] ✅    ✅ Text extracted using pdfplumber (1028 chars)
[21:18:07] 🔄 
🔄 Step 2: Extracting patient data...
[21:18:10] ℹ️  AI extracted raw sex value: 'M'
[21:18:10] ℹ️  AI extracted service line: 'PT'
[21:18:10] ℹ️  AI extracted payer source: ''
[21:18:10] ℹ️  AI extracted diagnoses:
[21:18:10] ℹ️    - Diagnosis 1: ''
[21:18:10] ℹ️    - Diagnosis 2: ''
[21:18:10] ℹ️    - Diagnosis 3: ''
[21:18:10] ℹ️    - Diagnosis 4: ''
[21:18:10] ℹ️    - Diagnosis 5: ''
[21:18:10] ℹ️    - Diagnosis 6: ''
[21:18:10] ℹ️  Final extracted MRN: '2261639'
[21:18:10] ℹ️  Final extracted Sex: 'MALE'
[21:18:10] ℹ️  Final extracted Service Line: 'PT'
[21:18:10] ℹ️  Final extracted Payer Source: ''
[21:18:10] ✅ Patient data extraction completed successfully
[21:18:10] ✅    ✅ Patient data extracted successfully
[21:18:10] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:18:10] ✅    ✅ Patient identified: Webster Bowen
[21:18:10] ✅    ✅ Patient name validation passed
[21:18:10] 🔄 
🔄 Step 3: Processing patient dates...
[21:18:10] [DOC: 9204710] ℹ️  DOB normalized: 09/12/1949
[21:18:10] [DOC: 9204710] ✅ Patient date processing completed successfully
[21:18:10] ✅    ✅ Date processing completed
[21:18:10] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:18:10] 🔄 
🔄 Step 4: Extracting order data...
[21:18:12] ℹ️  Order extraction - MRN: '2261639'
[21:18:12] ℹ️  Order extraction - Sex: 'MALE'
[21:18:12] ℹ️  Order extraction - Service Line: 'PT'
[21:18:12] ℹ️  Order extraction - Payer Source: ''
[21:18:12] ✅ Order data extraction completed successfully
[21:18:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:18:12] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[21:18:12] ℹ️  Service line consistent in both sources: 'PT'
[21:18:12] ✅ Patient name cross-validation successful
[21:18:12] ✅    ✅ Data merged successfully
[21:18:13] ⚠️     ❌ Skipping - missing episode start date
[21:18:13] [DOC: 9204710] ℹ️  API push details saved for document 9204710
================================================================================
║                        Processing Document ID: 9204704                         ║
================================================================================
[21:18:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:18:13] ℹ️  Date: 03/26/2025
[21:18:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:18:15] [DOC: 9204704] ✅ Text extracted using pdfplumber (1388 chars)
[21:18:15] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[21:18:15] 🔄 
🔄 Step 2: Extracting patient data...
[21:18:17] ℹ️  AI extracted raw sex value: 'F'
[21:18:17] ℹ️  AI extracted service line: 'RN'
[21:18:17] ℹ️  AI extracted payer source: ''
[21:18:17] ℹ️  AI extracted diagnoses:
[21:18:17] ℹ️    - Diagnosis 1: 'None'
[21:18:17] ℹ️    - Diagnosis 2: 'None'
[21:18:17] ℹ️    - Diagnosis 3: 'None'
[21:18:17] ℹ️    - Diagnosis 4: 'None'
[21:18:17] ℹ️    - Diagnosis 5: 'None'
[21:18:17] ℹ️    - Diagnosis 6: 'None'
[21:18:17] ℹ️  Final extracted MRN: '2221050'
[21:18:17] ℹ️  Final extracted Sex: 'FEMALE'
[21:18:17] ℹ️  Final extracted Service Line: 'RN'
[21:18:17] ℹ️  Final extracted Payer Source: ''
[21:18:17] ✅ Patient data extraction completed successfully
[21:18:17] ✅    ✅ Patient data extracted successfully
[21:18:17] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Barros
     └─ dob: 04/30/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2221050
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:18:17] ✅    ✅ Patient identified: Maria Barros
[21:18:17] ✅    ✅ Patient name validation passed
[21:18:17] 🔄 
🔄 Step 3: Processing patient dates...
[21:18:17] [DOC: 9204704] ℹ️  DOB normalized: 04/30/1936
[21:18:17] [DOC: 9204704] ✅ Patient date processing completed successfully
[21:18:17] ✅    ✅ Date processing completed
[21:18:17] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Barros
     └─ dob: 04/30/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2221050
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:18:17] 🔄 
🔄 Step 4: Extracting order data...
[21:18:19] ℹ️  Order extraction - MRN: '2221050'
[21:18:19] ℹ️  Order extraction - Sex: 'FEMALE'
[21:18:19] ℹ️  Order extraction - Service Line: ''
[21:18:19] ℹ️  Order extraction - Payer Source: ''
[21:18:19] ✅ Order data extraction completed successfully
[21:18:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:18:19] ℹ️  Using MRN from patient data: '2221050' over '2221050'
[21:18:19] ℹ️  Using service line from patient data: 'RN'
[21:18:19] ✅ Patient name cross-validation successful
[21:18:19] ✅    ✅ Data merged successfully
[21:18:21] ✅    ✅ Order data extracted and validated
[21:18:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:18:57] [DOC: 9204704] ℹ️  Patient not found in cache or API: Maria Barros
[21:18:57] [DOC: 9204704] ℹ️  Patient not found, creating new patient via API...
[21:18:57] [DOC: 9204704] ℹ️  Creating patient via API: Maria Barros
[21:18:59] [DOC: 9204704] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:18:59] ❌    ❌ Failed to create patient
[21:18:59] [DOC: 9204704] ℹ️  API push details saved for document 9204704
================================================================================
║                        Processing Document ID: 9204702                         ║
================================================================================
[21:18:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:18:59] ℹ️  Date: 03/26/2025
[21:18:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:19:01] [DOC: 9204702] ✅ Text extracted using pdfplumber (994 chars)
[21:19:01] ✅    ✅ Text extracted using pdfplumber (994 chars)
[21:19:01] 🔄 
🔄 Step 2: Extracting patient data...
[21:19:03] ℹ️  AI extracted raw sex value: 'F'
[21:19:03] ℹ️  AI extracted service line: 'Physical Therapy'
[21:19:03] ℹ️  AI extracted payer source: ''
[21:19:03] ℹ️  AI extracted diagnoses:
[21:19:03] ℹ️    - Diagnosis 1: ''
[21:19:03] ℹ️    - Diagnosis 2: ''
[21:19:03] ℹ️    - Diagnosis 3: ''
[21:19:03] ℹ️    - Diagnosis 4: ''
[21:19:03] ℹ️    - Diagnosis 5: ''
[21:19:03] ℹ️    - Diagnosis 6: ''
[21:19:03] ℹ️  Final extracted MRN: '2193337'
[21:19:03] ℹ️  Final extracted Sex: 'FEMALE'
[21:19:03] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:19:03] ℹ️  Final extracted Payer Source: ''
[21:19:03] ✅ Patient data extraction completed successfully
[21:19:03] ✅    ✅ Patient data extracted successfully
[21:19:03] 📊 Patient Response
     └─ patientFName: Muriel
     └─ patientLName: Angers
     └─ dob: 01/21/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2193337
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:19:03] ✅    ✅ Patient identified: Muriel Angers
[21:19:03] ✅    ✅ Patient name validation passed
[21:19:03] 🔄 
🔄 Step 3: Processing patient dates...
[21:19:03] [DOC: 9204702] ℹ️  DOB normalized: 01/21/1935
[21:19:03] [DOC: 9204702] ✅ Patient date processing completed successfully
[21:19:03] ✅    ✅ Date processing completed
[21:19:03] 📊 Processed Patient Data
     └─ patientFName: Muriel
     └─ patientLName: Angers
     └─ dob: 01/21/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2193337
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:19:03] 🔄 
🔄 Step 4: Extracting order data...
[21:19:05] ℹ️  Order extraction - MRN: '2193337'
[21:19:05] ℹ️  Order extraction - Sex: 'FEMALE'
[21:19:05] ℹ️  Order extraction - Service Line: 'PT'
[21:19:05] ℹ️  Order extraction - Payer Source: ''
[21:19:05] ✅ Order data extraction completed successfully
[21:19:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:19:05] ℹ️  Using MRN from patient data: '2193337' over '2193337'
[21:19:05] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[21:19:05] ✅ Patient name cross-validation successful
[21:19:05] ✅    ✅ Data merged successfully
[21:19:07] ✅    ✅ Order data extracted and validated
[21:19:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:19:12] [DOC: 9204702] ℹ️  Patient not found in cache or API: Muriel Angers
[21:19:12] [DOC: 9204702] ℹ️  Patient not found, creating new patient via API...
[21:19:12] [DOC: 9204702] ℹ️  Creating patient via API: Muriel Angers
[21:19:14] [DOC: 9204702] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:19:14] ❌    ❌ Failed to create patient
[21:19:14] [DOC: 9204702] ℹ️  API push details saved for document 9204702
================================================================================
║                        Processing Document ID: 9204692                         ║
================================================================================
[21:19:14] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:19:14] ℹ️  Date: 03/26/2025
[21:19:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:19:15] [DOC: 9204692] ✅ Text extracted using pdfplumber (1658 chars)
[21:19:15] ✅    ✅ Text extracted using pdfplumber (1658 chars)
[21:19:15] 🔄 
🔄 Step 2: Extracting patient data...
[21:19:18] ℹ️  AI extracted raw sex value: 'F'
[21:19:18] ℹ️  AI extracted service line: 'RN'
[21:19:18] ℹ️  AI extracted payer source: ''
[21:19:18] ℹ️  AI extracted diagnoses:
[21:19:18] ℹ️    - Diagnosis 1: 'None'
[21:19:18] ℹ️    - Diagnosis 2: 'None'
[21:19:18] ℹ️    - Diagnosis 3: 'None'
[21:19:18] ℹ️    - Diagnosis 4: 'None'
[21:19:18] ℹ️    - Diagnosis 5: 'None'
[21:19:18] ℹ️    - Diagnosis 6: 'None'
[21:19:18] ℹ️  Final extracted MRN: '2168743'
[21:19:18] ℹ️  Final extracted Sex: 'FEMALE'
[21:19:18] ℹ️  Final extracted Service Line: 'RN'
[21:19:18] ℹ️  Final extracted Payer Source: ''
[21:19:18] ✅ Patient data extraction completed successfully
[21:19:18] ✅    ✅ Patient data extracted successfully
[21:19:18] 📊 Patient Response
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:19:18] ✅    ✅ Patient identified: Sheila Adesso
[21:19:18] ✅    ✅ Patient name validation passed
[21:19:18] 🔄 
🔄 Step 3: Processing patient dates...
[21:19:18] [DOC: 9204692] ℹ️  DOB normalized: 11/24/1963
[21:19:18] [DOC: 9204692] ✅ Patient date processing completed successfully
[21:19:18] ✅    ✅ Date processing completed
[21:19:18] 📊 Processed Patient Data
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:19:18] 🔄 
🔄 Step 4: Extracting order data...
[21:19:20] ℹ️  Order extraction - MRN: '2168743'
[21:19:20] ℹ️  Order extraction - Sex: 'FEMALE'
[21:19:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:19:20] ℹ️  Order extraction - Payer Source: ''
[21:19:20] ✅ Order data extraction completed successfully
[21:19:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:19:20] ℹ️  Using MRN from patient data: '2168743' over '2168743'
[21:19:20] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[21:19:20] ✅ Patient name cross-validation successful
[21:19:20] ✅    ✅ Data merged successfully
[21:19:21] ⚠️     ❌ Skipping - missing episode start date
[21:19:21] [DOC: 9204692] ℹ️  API push details saved for document 9204692
================================================================================
║                        Processing Document ID: 9204659                         ║
================================================================================
[21:19:21] ℹ️  Agency: Alphacare Home Health Agency
[21:19:21] ℹ️  Date: 03/26/2025
[21:19:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:19:28] [DOC: 9204659] ✅ Text extracted using pdfplumber (23987 chars)
[21:19:28] ✅    ✅ Text extracted using pdfplumber (23987 chars)
[21:19:28] 🔄 
🔄 Step 2: Extracting patient data...
[21:19:31] ℹ️  AI extracted raw sex value: 'M'
[21:19:31] ℹ️  AI extracted service line: 'Skilled Nursing, Medication Management'
[21:19:31] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[21:19:31] ℹ️  AI extracted diagnoses:
[21:19:31] ℹ️    - Diagnosis 1: 'F31.81'
[21:19:31] ℹ️    - Diagnosis 2: 'F33.9'
[21:19:31] ℹ️    - Diagnosis 3: 'F41.1'
[21:19:31] ℹ️    - Diagnosis 4: 'M79.7'
[21:19:31] ℹ️    - Diagnosis 5: 'E66.9'
[21:19:31] ℹ️    - Diagnosis 6: 'M50.90'
[21:19:31] ℹ️  Final extracted MRN: '000001761'
[21:19:31] ℹ️  Final extracted Sex: 'MALE'
[21:19:31] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medication Management'
[21:19:31] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[21:19:31] ✅ Patient data extraction completed successfully
[21:19:31] ✅    ✅ Patient data extracted successfully
[21:19:31] 📊 Patient Response
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing, Medication Management
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[21:19:31] ✅    ✅ Patient identified: Melissa Edwards
[21:19:31] ✅    ✅ Patient name validation passed
[21:19:31] 🔄 
🔄 Step 3: Processing patient dates...
[21:19:31] [DOC: 9204659] ℹ️  DOB normalized: 07/10/1978
[21:19:31] [DOC: 9204659] ℹ️  Episode startOfCare normalized: 05/21/2021
[21:19:31] [DOC: 9204659] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[21:19:31] [DOC: 9204659] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[21:19:31] [DOC: 9204659] ✅ Patient date processing completed successfully
[21:19:31] ✅    ✅ Date processing completed
[21:19:31] 📊 Processed Patient Data
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing, Medication Management
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[21:19:31] 🔄 
🔄 Step 4: Extracting order data...
[21:19:34] ℹ️  Order extraction - MRN: '000001761'
[21:19:34] ℹ️  Order extraction - Sex: 'MALE'
[21:19:34] ℹ️  Order extraction - Service Line: 'RN'
[21:19:34] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[21:19:34] ✅ Order data extraction completed successfully
[21:19:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:19:34] ℹ️  Using MRN from patient data: '000001761' over '000001761'
[21:19:34] ℹ️  Combined service lines: Patient='Skilled Nursing, Medication Management' + Order='RN' = 'Medication Management, RN, Skilled Nursing'
[21:19:34] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[21:19:34] ✅ Patient name cross-validation successful
[21:19:34] ✅    ✅ Data merged successfully
[21:19:35] ✅    ✅ Order data extracted and validated
[21:19:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:19:35] [DOC: 9204659] ✅ Patient found in local cache: Melissa Edwards, ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[21:19:35] ✅    ✅ Existing patient found with ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[21:19:35] 🔄 
🔄 Step 6: Pushing order to API...
[21:19:35] [DOC: 9204659] ℹ️  Pushing order via API for patient ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[21:19:37] [DOC: 9204659] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:19:37] ❌    ❌ Failed to push order
[21:19:37] 🔄 
🔄 Step 7: Writing to CSV...
[21:19:37] [DOC: 9204659] ℹ️  Calculated age: 46 from DOB: 07/10/1978
[21:19:37] [DOC: 9204659] ℹ️  Service Line extracted: 'Medication Management, RN, Skilled Nursing'
[21:19:37] [DOC: 9204659] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[21:19:37] [DOC: 9204659] ℹ️  Diagnosis codes being written:
[21:19:37] [DOC: 9204659] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.81'
[21:19:37] [DOC: 9204659] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.9'
[21:19:37] [DOC: 9204659] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[21:19:37] [DOC: 9204659] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M79.7'
[21:19:37] [DOC: 9204659] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.9'
[21:19:37] [DOC: 9204659] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M50.90'
[21:19:37] [DOC: 9204659] ✅ Patient data written to CSV: Melissa Edwards | Sex: MALE | Age: 46 | Service: Medication Management, RN, Skilled Nursing | Payer: MassHealth (Medicaid) | MRN: 000001761
[21:19:37] ✅    ✅ Document 9204659 processed and saved successfully
[21:19:37] 🔄 
🔄 Step 8: Saving API details...
[21:19:37] [DOC: 9204659] ℹ️  API push details saved for document 9204659
[21:19:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204644                         ║
================================================================================
[21:19:37] ℹ️  Agency: Alphacare Home Health Agency
[21:19:37] ℹ️  Date: 03/26/2025
[21:19:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:19:39] [DOC: 9204644] ✅ Text extracted using pdfplumber (1533 chars)
[21:19:39] ✅    ✅ Text extracted using pdfplumber (1533 chars)
[21:19:39] 🔄 
🔄 Step 2: Extracting patient data...
[21:19:42] ℹ️  AI extracted raw sex value: ''
[21:19:42] ℹ️  AI extracted service line: 'RN'
[21:19:42] ℹ️  AI extracted payer source: ''
[21:19:42] ℹ️  AI extracted diagnoses:
[21:19:42] ℹ️    - Diagnosis 1: 'None'
[21:19:42] ℹ️    - Diagnosis 2: 'None'
[21:19:42] ℹ️    - Diagnosis 3: 'None'
[21:19:42] ℹ️    - Diagnosis 4: 'None'
[21:19:42] ℹ️    - Diagnosis 5: 'None'
[21:19:42] ℹ️    - Diagnosis 6: 'None'
[21:19:42] ℹ️  Final extracted MRN: '000003599'
[21:19:42] ℹ️  Final extracted Sex: ''
[21:19:42] ℹ️  Final extracted Service Line: 'RN'
[21:19:42] ℹ️  Final extracted Payer Source: ''
[21:19:42] ✅ Patient data extraction completed successfully
[21:19:42] ✅    ✅ Patient data extracted successfully
[21:19:42] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:19:42] ✅    ✅ Patient identified: June Stykowski
[21:19:42] ✅    ✅ Patient name validation passed
[21:19:42] 🔄 
🔄 Step 3: Processing patient dates...
[21:19:42] [DOC: 9204644] ℹ️  DOB normalized: 11/08/1952
[21:19:42] [DOC: 9204644] ✅ Patient date processing completed successfully
[21:19:42] ✅    ✅ Date processing completed
[21:19:42] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:19:42] 🔄 
🔄 Step 4: Extracting order data...
[21:19:44] ℹ️  Order extraction - MRN: '000003599'
[21:19:44] ℹ️  Order extraction - Sex: ''
[21:19:44] ℹ️  Order extraction - Service Line: 'HHA'
[21:19:44] ℹ️  Order extraction - Payer Source: ''
[21:19:44] ✅ Order data extraction completed successfully
[21:19:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:19:44] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[21:19:44] ⚠️  Could not determine sex using any available method
[21:19:44] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[21:19:44] ✅ Patient name cross-validation successful
[21:19:44] ✅    ✅ Data merged successfully
[21:19:45] ⚠️     ❌ Skipping - missing episode start date
[21:19:45] [DOC: 9204644] ℹ️  API push details saved for document 9204644
================================================================================
║                        Processing Document ID: 9204499                         ║
================================================================================
[21:19:45] ℹ️  Agency: Alphacare Home Health Agency
[21:19:45] ℹ️  Date: 03/26/2025
[21:19:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:19:48] [DOC: 9204499] ✅ Text extracted using pdfplumber (1632 chars)
[21:19:48] ✅    ✅ Text extracted using pdfplumber (1632 chars)
[21:19:48] 🔄 
🔄 Step 2: Extracting patient data...
[21:19:50] ℹ️  AI extracted raw sex value: ''
[21:19:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:19:50] ℹ️  AI extracted payer source: ''
[21:19:50] ℹ️  AI extracted diagnoses:
[21:19:50] ℹ️    - Diagnosis 1: ''
[21:19:50] ℹ️    - Diagnosis 2: ''
[21:19:50] ℹ️    - Diagnosis 3: ''
[21:19:50] ℹ️    - Diagnosis 4: ''
[21:19:50] ℹ️    - Diagnosis 5: ''
[21:19:50] ℹ️    - Diagnosis 6: ''
[21:19:50] ℹ️  Final extracted MRN: '000003599'
[21:19:50] ℹ️  Final extracted Sex: ''
[21:19:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:19:50] ℹ️  Final extracted Payer Source: ''
[21:19:50] ✅ Patient data extraction completed successfully
[21:19:50] ✅    ✅ Patient data extracted successfully
[21:19:50] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:19:50] ✅    ✅ Patient identified: June Stykowski
[21:19:50] ✅    ✅ Patient name validation passed
[21:19:50] 🔄 
🔄 Step 3: Processing patient dates...
[21:19:50] [DOC: 9204499] ℹ️  DOB normalized: 11/08/1952
[21:19:50] [DOC: 9204499] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[21:19:50] [DOC: 9204499] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[21:19:50] [DOC: 9204499] ✅ Patient date processing completed successfully
[21:19:50] ✅    ✅ Date processing completed
[21:19:50] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:19:50] 🔄 
🔄 Step 4: Extracting order data...
[21:19:53] ⚠️  JSON parsing failed (attempt 1): Invalid control character at: line 23 column 27 (char 570)
[21:19:56] ⚠️  JSON parsing failed (attempt 2): Invalid control character at: line 23 column 27 (char 543)
[21:19:59] ⚠️  JSON parsing failed (attempt 3): Invalid control character at: line 23 column 27 (char 544)
[21:19:59] ❌ All JSON parsing attempts failed
[21:19:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:19:59] ℹ️  Using MRN from patient data: '000003599'
[21:19:59] ⚠️  Could not determine sex using any available method
[21:19:59] ℹ️  Using service line from patient data: 'Skilled Nursing'
[21:19:59] ✅    ✅ Data merged successfully
[21:20:00] ⚠️     ❌ Skipping - missing episode start date
[21:20:00] [DOC: 9204499] ℹ️  API push details saved for document 9204499
================================================================================
║                        Processing Document ID: 9204360                         ║
================================================================================
[21:20:00] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:20:00] ℹ️  Date: 03/26/2025
[21:20:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:20:06] [DOC: 9204360] ✅ Text extracted using pdfplumber (94763 chars)
[21:20:06] ✅    ✅ Text extracted using pdfplumber (94763 chars)
[21:20:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:20:11] ℹ️  AI extracted raw sex value: ''
[21:20:11] ℹ️  AI extracted service line: ''
[21:20:11] ℹ️  AI extracted payer source: ''
[21:20:11] ℹ️  AI extracted diagnoses:
[21:20:11] ℹ️    - Diagnosis 1: ''
[21:20:11] ℹ️    - Diagnosis 2: ''
[21:20:11] ℹ️    - Diagnosis 3: ''
[21:20:11] ℹ️    - Diagnosis 4: ''
[21:20:11] ℹ️    - Diagnosis 5: ''
[21:20:11] ℹ️    - Diagnosis 6: ''
[21:20:11] ℹ️  Final extracted MRN: ''
[21:20:11] ℹ️  Final extracted Sex: ''
[21:20:11] ℹ️  Final extracted Service Line: ''
[21:20:11] ℹ️  Final extracted Payer Source: ''
[21:20:11] ✅ Patient data extraction completed successfully
[21:20:11] ✅    ✅ Patient data extracted successfully
[21:20:11] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:20:11] ⚠️     ❌ Insufficient patient data extracted
[21:20:11] [DOC: 9204360] ℹ️  API push details saved for document 9204360
================================================================================
║                        Processing Document ID: 9204304                         ║
================================================================================
[21:20:11] ℹ️  Agency: Dartmouth HH
[21:20:11] ℹ️  Date: 03/26/2025
[21:20:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:20:14] [DOC: 9204304] ✅ Text extracted using pdfplumber (11304 chars)
[21:20:14] ✅    ✅ Text extracted using pdfplumber (11292 chars)
[21:20:14] 🔄 
🔄 Step 2: Extracting patient data...
[21:20:17] ℹ️  AI extracted raw sex value: 'F'
[21:20:17] ℹ️  AI extracted service line: 'PT'
[21:20:17] ℹ️  AI extracted payer source: 'None'
[21:20:17] ℹ️  AI extracted diagnoses:
[21:20:17] ℹ️    - Diagnosis 1: 'Z47.1'
[21:20:17] ℹ️    - Diagnosis 2: 'E66.9'
[21:20:17] ℹ️    - Diagnosis 3: 'Z68.37'
[21:20:17] ℹ️    - Diagnosis 4: 'M19.90'
[21:20:17] ℹ️    - Diagnosis 5: 'D50.9'
[21:20:17] ℹ️    - Diagnosis 6: 'F41.9'
[21:20:17] ℹ️  Final extracted MRN: '6043015'
[21:20:17] ℹ️  Final extracted Sex: 'FEMALE'
[21:20:17] ℹ️  Final extracted Service Line: 'PT'
[21:20:17] ℹ️  Final extracted Payer Source: ''
[21:20:17] ✅ Patient data extraction completed successfully
[21:20:17] ✅    ✅ Patient data extracted successfully
[21:20:17] 📊 Patient Response
     └─ patientFName: Debra
     └─ patientLName: Ozug
     └─ dob: 10/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6043015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.37', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'F41.9'}]
[21:20:17] ✅    ✅ Patient identified: Debra Ozug
[21:20:17] ✅    ✅ Patient name validation passed
[21:20:17] 🔄 
🔄 Step 3: Processing patient dates...
[21:20:17] [DOC: 9204304] ℹ️  DOB normalized: 10/08/1957
[21:20:17] [DOC: 9204304] ℹ️  Episode startOfCare normalized: 03/20/2025
[21:20:17] [DOC: 9204304] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[21:20:17] [DOC: 9204304] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[21:20:17] [DOC: 9204304] ✅ Patient date processing completed successfully
[21:20:17] ✅    ✅ Date processing completed
[21:20:17] 📊 Processed Patient Data
     └─ patientFName: Debra
     └─ patientLName: Ozug
     └─ dob: 10/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6043015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.37', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'F41.9'}]
[21:20:17] 🔄 
🔄 Step 4: Extracting order data...
[21:20:20] ℹ️  Order extraction - MRN: '6043015'
[21:20:20] ℹ️  Order extraction - Sex: 'FEMALE'
[21:20:20] ℹ️  Order extraction - Service Line: 'PT, RN'
[21:20:20] ℹ️  Order extraction - Payer Source: ''
[21:20:20] ✅ Order data extraction completed successfully
[21:20:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:20:20] ℹ️  Using MRN from patient data: '6043015' over '6043015'
[21:20:20] ℹ️  Combined service lines: Patient='PT' + Order='PT, RN' = 'PT, RN'
[21:20:20] ✅ Patient name cross-validation successful
[21:20:20] ✅    ✅ Data merged successfully
[21:20:21] ✅    ✅ Order data extracted and validated
[21:20:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:20:21] [DOC: 9204304] ✅ Patient found in local cache: Debra Ozug, ID: 9adb191b-5424-4c5c-9a7b-715e2cbd658c
[21:20:21] ✅    ✅ Existing patient found with ID: 9adb191b-5424-4c5c-9a7b-715e2cbd658c
[21:20:21] 🔄 
🔄 Step 6: Pushing order to API...
[21:20:21] [DOC: 9204304] ℹ️  Pushing order via API for patient ID: 9adb191b-5424-4c5c-9a7b-715e2cbd658c
[21:20:22] [DOC: 9204304] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:20:22] ❌    ❌ Failed to push order
[21:20:22] 🔄 
🔄 Step 7: Writing to CSV...
[21:20:22] [DOC: 9204304] ℹ️  Calculated age: 67 from DOB: 10/08/1957
[21:20:22] [DOC: 9204304] ℹ️  Service Line extracted: 'PT, RN'
[21:20:22] [DOC: 9204304] ℹ️  Payer Source extracted: ''
[21:20:22] [DOC: 9204304] ℹ️  Diagnosis codes being written:
[21:20:22] [DOC: 9204304] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[21:20:22] [DOC: 9204304] ℹ️    - Latest_Episode_Seconddiagnosis: 'E66.9'
[21:20:22] [DOC: 9204304] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z68.37'
[21:20:22] [DOC: 9204304] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M19.90'
[21:20:22] [DOC: 9204304] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D50.9'
[21:20:22] [DOC: 9204304] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[21:20:22] [DOC: 9204304] ✅ Patient data written to CSV: Debra Ozug | Sex: FEMALE | Age: 67 | Service: PT, RN | Payer:  | MRN: 6043015
[21:20:22] ✅    ✅ Document 9204304 processed and saved successfully
[21:20:22] 🔄 
🔄 Step 8: Saving API details...
[21:20:22] [DOC: 9204304] ℹ️  API push details saved for document 9204304
[21:20:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204300                         ║
================================================================================
[21:20:22] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:20:22] ℹ️  Date: 03/26/2025
[21:20:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:20:25] [DOC: 9204300] ✅ Text extracted using pdfplumber (1839 chars)
[21:20:25] ✅    ✅ Text extracted using pdfplumber (1839 chars)
[21:20:25] 🔄 
🔄 Step 2: Extracting patient data...
[21:20:28] ℹ️  AI extracted raw sex value: 'M'
[21:20:28] ℹ️  AI extracted service line: 'RN'
[21:20:28] ℹ️  AI extracted payer source: 'Senior Whole Health'
[21:20:28] ℹ️  AI extracted diagnoses:
[21:20:28] ℹ️    - Diagnosis 1: 'None'
[21:20:28] ℹ️    - Diagnosis 2: 'None'
[21:20:28] ℹ️    - Diagnosis 3: 'None'
[21:20:28] ℹ️    - Diagnosis 4: 'None'
[21:20:28] ℹ️    - Diagnosis 5: 'None'
[21:20:28] ℹ️    - Diagnosis 6: 'None'
[21:20:28] ℹ️  Final extracted MRN: '114004'
[21:20:28] ℹ️  Final extracted Sex: 'MALE'
[21:20:28] ℹ️  Final extracted Service Line: 'RN'
[21:20:28] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[21:20:28] ✅ Patient data extraction completed successfully
[21:20:28] ✅    ✅ Patient data extracted successfully
[21:20:28] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:20:28] ✅    ✅ Patient identified: Donald Brown
[21:20:28] ✅    ✅ Patient name validation passed
[21:20:28] 🔄 
🔄 Step 3: Processing patient dates...
[21:20:28] [DOC: 9204300] ℹ️  DOB normalized: 06/18/1949
[21:20:28] [DOC: 9204300] ℹ️  Episode startOfCare normalized: 12/01/2018
[21:20:28] [DOC: 9204300] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[21:20:28] [DOC: 9204300] ✅ Patient date processing completed successfully
[21:20:28] ✅    ✅ Date processing completed
[21:20:28] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'endOfEpisode': '04/27/2025'}]
[21:20:28] 🔄 
🔄 Step 4: Extracting order data...
[21:20:30] ℹ️  Order extraction - MRN: '114004'
[21:20:30] ℹ️  Order extraction - Sex: 'MALE'
[21:20:30] ℹ️  Order extraction - Service Line: 'HHA'
[21:20:30] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[21:20:30] ✅ Order data extraction completed successfully
[21:20:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:20:30] ℹ️  Using MRN from patient data: '114004' over '114004'
[21:20:30] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[21:20:30] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[21:20:30] ✅ Patient name cross-validation successful
[21:20:30] ✅    ✅ Data merged successfully
[21:20:31] ✅    ✅ Order data extracted and validated
[21:20:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:20:31] [DOC: 9204300] ✅ Patient found in local cache: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[21:20:31] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[21:20:31] 🔄 
🔄 Step 6: Pushing order to API...
[21:20:31] [DOC: 9204300] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[21:20:33] [DOC: 9204300] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:20:33] ❌    ❌ Failed to push order
[21:20:33] 🔄 
🔄 Step 7: Writing to CSV...
[21:20:33] [DOC: 9204300] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[21:20:33] [DOC: 9204300] ℹ️  Service Line extracted: 'HHA, RN'
[21:20:33] [DOC: 9204300] ℹ️  Payer Source extracted: 'Senior Whole Health'
[21:20:33] [DOC: 9204300] ℹ️  Diagnosis codes being written:
[21:20:33] [DOC: 9204300] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:20:33] [DOC: 9204300] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:20:33] [DOC: 9204300] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:20:33] [DOC: 9204300] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:20:33] [DOC: 9204300] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:20:33] [DOC: 9204300] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:20:33] [DOC: 9204300] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: HHA, RN | Payer: Senior Whole Health | MRN: 114004
[21:20:33] ✅    ✅ Document 9204300 processed and saved successfully
[21:20:33] 🔄 
🔄 Step 8: Saving API details...
[21:20:33] [DOC: 9204300] ℹ️  API push details saved for document 9204300
[21:20:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204288                         ║
================================================================================
[21:20:33] ℹ️  Agency: Dartmouth HH
[21:20:33] ℹ️  Date: 03/26/2025
[21:20:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:20:36] [DOC: 9204288] ✅ Text extracted using pdfplumber (10176 chars)
[21:20:36] ✅    ✅ Text extracted using pdfplumber (10164 chars)
[21:20:36] 🔄 
🔄 Step 2: Extracting patient data...
[21:20:39] ℹ️  AI extracted raw sex value: 'F'
[21:20:39] ℹ️  AI extracted service line: 'PT, RN'
[21:20:39] ℹ️  AI extracted payer source: 'None'
[21:20:39] ℹ️  AI extracted diagnoses:
[21:20:39] ℹ️    - Diagnosis 1: 'Z47.1'
[21:20:39] ℹ️    - Diagnosis 2: 'Z96.652'
[21:20:39] ℹ️    - Diagnosis 3: 'J96.01'
[21:20:39] ℹ️    - Diagnosis 4: 'I13.0'
[21:20:39] ℹ️    - Diagnosis 5: 'I50.33'
[21:20:39] ℹ️    - Diagnosis 6: 'N18.32'
[21:20:39] ℹ️  Final extracted MRN: '227027'
[21:20:39] ℹ️  Final extracted Sex: 'FEMALE'
[21:20:39] ℹ️  Final extracted Service Line: 'PT, RN'
[21:20:39] ℹ️  Final extracted Payer Source: ''
[21:20:39] ✅ Patient data extraction completed successfully
[21:20:39] ✅    ✅ Patient data extracted successfully
[21:20:39] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.32'}]
[21:20:39] ✅    ✅ Patient identified: Joan E Harb
[21:20:39] ✅    ✅ Patient name validation passed
[21:20:39] 🔄 
🔄 Step 3: Processing patient dates...
[21:20:39] [DOC: 9204288] ℹ️  DOB normalized: 12/27/1945
[21:20:39] [DOC: 9204288] ℹ️  Episode startOfCare normalized: 01/14/2025
[21:20:39] [DOC: 9204288] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[21:20:39] [DOC: 9204288] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[21:20:39] [DOC: 9204288] ✅ Patient date processing completed successfully
[21:20:39] ✅    ✅ Date processing completed
[21:20:39] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.32'}]
[21:20:39] 🔄 
🔄 Step 4: Extracting order data...
[21:20:42] ℹ️  Order extraction - MRN: '804015'
[21:20:42] ℹ️  Order extraction - Sex: 'FEMALE'
[21:20:42] ℹ️  Order extraction - Service Line: 'PT, Skilled Nursing'
[21:20:42] ℹ️  Order extraction - Payer Source: ''
[21:20:42] ✅ Order data extraction completed successfully
[21:20:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:20:42] ℹ️  Using MRN from patient data: '227027' over '804015'
[21:20:42] ℹ️  Combined service lines: Patient='PT, RN' + Order='PT, Skilled Nursing' = 'PT, RN, Skilled Nursing'
[21:20:42] ✅ Patient name cross-validation successful
[21:20:42] ✅    ✅ Data merged successfully
[21:20:43] ✅    ✅ Order data extracted and validated
[21:20:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:21:18] [DOC: 9204288] ℹ️  Patient not found in cache or API: Joan E Harb
[21:21:18] [DOC: 9204288] ℹ️  Patient not found, creating new patient via API...
[21:21:18] [DOC: 9204288] ℹ️  Creating patient via API: Joan E Harb
[21:21:19] [DOC: 9204288] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:21:19] ❌    ❌ Failed to create patient
[21:21:19] [DOC: 9204288] ℹ️  API push details saved for document 9204288
================================================================================
║                        Processing Document ID: 9204260                         ║
================================================================================
[21:21:19] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:21:19] ℹ️  Date: 03/26/2025
[21:21:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:21:28] [DOC: 9204260] ✅ Text extracted using pdfplumber (2659 chars)
[21:21:28] ✅    ✅ Text extracted using pdfplumber (2659 chars)
[21:21:28] 🔄 
🔄 Step 2: Extracting patient data...
[21:21:31] ℹ️  AI extracted raw sex value: 'M'
[21:21:31] ℹ️  AI extracted service line: 'HHA'
[21:21:31] ℹ️  AI extracted payer source: 'Medicaid/MA'
[21:21:31] ℹ️  AI extracted diagnoses:
[21:21:31] ℹ️    - Diagnosis 1: 'F25.0'
[21:21:31] ℹ️    - Diagnosis 2: 'E11.22'
[21:21:31] ℹ️    - Diagnosis 3: 'I13.10'
[21:21:31] ℹ️    - Diagnosis 4: 'N18.31'
[21:21:31] ℹ️    - Diagnosis 5: 'F41.0'
[21:21:31] ℹ️    - Diagnosis 6: 'F41.9'
[21:21:31] ℹ️  Final extracted MRN: '879'
[21:21:31] ℹ️  Final extracted Sex: 'MALE'
[21:21:31] ℹ️  Final extracted Service Line: 'HHA'
[21:21:31] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[21:21:31] ✅ Patient data extraction completed successfully
[21:21:31] ✅    ✅ Patient data extracted successfully
[21:21:31] 📊 Patient Response
     └─ patientFName: Sean R
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/30/2024', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[21:21:31] ✅    ✅ Patient identified: Sean R McCarthy
[21:21:31] ✅    ✅ Patient name validation passed
[21:21:31] 🔄 
🔄 Step 3: Processing patient dates...
[21:21:31] [DOC: 9204260] ℹ️  DOB normalized: 09/16/1969
[21:21:31] [DOC: 9204260] ℹ️  Episode startOfCare normalized: 03/30/2024
[21:21:31] [DOC: 9204260] ℹ️  Episode startOfEpisode normalized: 03/30/2024
[21:21:31] [DOC: 9204260] ℹ️  Episode endOfEpisode normalized: 03/24/2025
[21:21:31] [DOC: 9204260] ✅ Patient date processing completed successfully
[21:21:31] ✅    ✅ Date processing completed
[21:21:31] 📊 Processed Patient Data
     └─ patientFName: Sean R
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/30/2024', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[21:21:31] 🔄 
🔄 Step 4: Extracting order data...
[21:21:33] ℹ️  Order extraction - MRN: '879'
[21:21:33] ℹ️  Order extraction - Sex: 'MALE'
[21:21:33] ℹ️  Order extraction - Service Line: 'HHA'
[21:21:33] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[21:21:33] ✅ Order data extraction completed successfully
[21:21:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:21:33] ℹ️  Using MRN from patient data: '879' over '879'
[21:21:33] ℹ️  Service line consistent in both sources: 'HHA'
[21:21:33] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[21:21:33] ✅ Patient name cross-validation successful
[21:21:33] ✅    ✅ Data merged successfully
[21:21:35] ✅    ✅ Order data extracted and validated
[21:21:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:21:35] [DOC: 9204260] ✅ Patient found in local cache: Sean R McCarthy, ID: 3b7c4c27-b1aa-4316-acf8-d16068b27ef3
[21:21:35] ✅    ✅ Existing patient found with ID: 3b7c4c27-b1aa-4316-acf8-d16068b27ef3
[21:21:35] 🔄 
🔄 Step 6: Pushing order to API...
[21:21:35] [DOC: 9204260] ℹ️  Pushing order via API for patient ID: 3b7c4c27-b1aa-4316-acf8-d16068b27ef3
[21:21:36] [DOC: 9204260] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[21:21:36] ❌    ❌ Failed to push order
[21:21:36] 🔄 
🔄 Step 7: Writing to CSV...
[21:21:36] [DOC: 9204260] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[21:21:36] [DOC: 9204260] ℹ️  Service Line extracted: 'HHA'
[21:21:36] [DOC: 9204260] ℹ️  Payer Source extracted: 'Medicaid/MA'
[21:21:36] [DOC: 9204260] ℹ️  Diagnosis codes being written:
[21:21:36] [DOC: 9204260] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[21:21:36] [DOC: 9204260] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[21:21:36] [DOC: 9204260] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.10'
[21:21:36] [DOC: 9204260] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[21:21:36] [DOC: 9204260] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.0'
[21:21:36] [DOC: 9204260] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[21:21:36] [DOC: 9204260] ✅ Patient data written to CSV: Sean R McCarthy | Sex: MALE | Age: 55 | Service: HHA | Payer: Medicaid/MA | MRN: 879
[21:21:36] ✅    ✅ Document 9204260 processed and saved successfully
[21:21:36] 🔄 
🔄 Step 8: Saving API details...
[21:21:36] [DOC: 9204260] ℹ️  API push details saved for document 9204260
[21:21:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204222                         ║
================================================================================
[21:21:36] ℹ️  Agency: Dartmouth HH
[21:21:36] ℹ️  Date: 03/26/2025
[21:21:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:21:39] [DOC: 9204222] ✅ Text extracted using pdfplumber (22754 chars)
[21:21:39] ✅    ✅ Text extracted using pdfplumber (22754 chars)
[21:21:39] 🔄 
🔄 Step 2: Extracting patient data...
[21:21:42] ℹ️  AI extracted raw sex value: 'F'
[21:21:42] ℹ️  AI extracted service line: 'Skilled Nursing, MSW'
[21:21:42] ℹ️  AI extracted payer source: ''
[21:21:42] ℹ️  AI extracted diagnoses:
[21:21:42] ℹ️    - Diagnosis 1: 'I87.2'
[21:21:42] ℹ️    - Diagnosis 2: 'L97.311'
[21:21:42] ℹ️    - Diagnosis 3: 'B37.2'
[21:21:42] ℹ️    - Diagnosis 4: 'F41.9'
[21:21:42] ℹ️    - Diagnosis 5: 'I12.9'
[21:21:42] ℹ️    - Diagnosis 6: 'N18.4'
[21:21:42] ℹ️  Final extracted MRN: '651015'
[21:21:42] ℹ️  Final extracted Sex: 'FEMALE'
[21:21:42] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW'
[21:21:42] ℹ️  Final extracted Payer Source: ''
[21:21:42] ✅ Patient data extraction completed successfully
[21:21:42] ✅    ✅ Patient data extracted successfully
[21:21:42] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Roseman
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, MSW
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'L97.311', 'thirdDiagnosis': 'B37.2', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.4'}]
[21:21:42] ✅    ✅ Patient identified: Jane Roseman
[21:21:42] ✅    ✅ Patient name validation passed
[21:21:42] 🔄 
🔄 Step 3: Processing patient dates...
[21:21:42] [DOC: 9204222] ℹ️  DOB normalized: 01/19/1935
[21:21:42] [DOC: 9204222] ℹ️  Episode startOfCare normalized: 05/23/2024
[21:21:42] [DOC: 9204222] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[21:21:42] [DOC: 9204222] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[21:21:42] [DOC: 9204222] ✅ Patient date processing completed successfully
[21:21:42] ✅    ✅ Date processing completed
[21:21:42] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Roseman
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, MSW
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'L97.311', 'thirdDiagnosis': 'B37.2', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.4'}]
[21:21:42] 🔄 
🔄 Step 4: Extracting order data...
[21:21:45] ℹ️  Order extraction - MRN: '651015'
[21:21:45] ℹ️  Order extraction - Sex: 'FEMALE'
[21:21:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW'
[21:21:45] ℹ️  Order extraction - Payer Source: ''
[21:21:45] ✅ Order data extraction completed successfully
[21:21:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:21:45] ℹ️  Using MRN from patient data: '651015' over '651015'
[21:21:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW'
[21:21:45] ⚠️  Patient name mismatch: Order='Jadlowe, A Shirley' vs Patient='Jane Roseman'
[21:21:45] ✅    ✅ Data merged successfully
[21:21:46] ✅    ✅ Order data extracted and validated
[21:21:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:21:57] [DOC: 9204222] ℹ️  Patient not found in cache or API: Jane Roseman
[21:21:57] [DOC: 9204222] ℹ️  Patient not found, creating new patient via API...
[21:21:57] [DOC: 9204222] ℹ️  Creating patient via API: Jane Roseman
[21:21:58] [DOC: 9204222] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:21:58] ❌    ❌ Failed to create patient
[21:21:58] [DOC: 9204222] ℹ️  API push details saved for document 9204222
================================================================================
║                        Processing Document ID: 9204212                         ║
================================================================================
[21:21:58] ℹ️  Agency: Dartmouth HH
[21:21:58] ℹ️  Date: 03/26/2025
[21:21:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:22:03] [DOC: 9204212] ✅ Text extracted using pdfplumber (10354 chars)
[21:22:03] ✅    ✅ Text extracted using pdfplumber (10342 chars)
[21:22:03] 🔄 
🔄 Step 2: Extracting patient data...
[21:22:06] ℹ️  AI extracted raw sex value: 'F'
[21:22:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:22:06] ℹ️  AI extracted payer source: ''
[21:22:06] ℹ️  AI extracted diagnoses:
[21:22:06] ℹ️    - Diagnosis 1: 'G80.9'
[21:22:06] ℹ️    - Diagnosis 2: 'R33.9'
[21:22:06] ℹ️    - Diagnosis 3: 'S21.201D'
[21:22:06] ℹ️    - Diagnosis 4: 'K59.04'
[21:22:06] ℹ️    - Diagnosis 5: 'B37.2'
[21:22:06] ℹ️    - Diagnosis 6: 'R13.12'
[21:22:06] ℹ️  Final extracted MRN: '227027'
[21:22:06] ℹ️  Final extracted Sex: 'FEMALE'
[21:22:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:22:06] ℹ️  Final extracted Payer Source: ''
[21:22:06] ✅ Patient data extraction completed successfully
[21:22:06] ✅    ✅ Patient data extracted successfully
[21:22:06] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/17/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'G80.9', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'S21.201D', 'fourthDiagnosis': 'K59.04', 'fifthDiagnosis': 'B37.2', 'sixthDiagnosis': 'R13.12'}]
[21:22:06] ✅    ✅ Patient identified: Kim Teixeira
[21:22:06] ✅    ✅ Patient name validation passed
[21:22:06] 🔄 
🔄 Step 3: Processing patient dates...
[21:22:06] [DOC: 9204212] ℹ️  DOB normalized: 02/28/1964
[21:22:06] [DOC: 9204212] ℹ️  Episode startOfCare normalized: 01/17/2025
[21:22:06] [DOC: 9204212] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[21:22:06] [DOC: 9204212] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[21:22:06] [DOC: 9204212] ✅ Patient date processing completed successfully
[21:22:06] ✅    ✅ Date processing completed
[21:22:06] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/17/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'G80.9', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'S21.201D', 'fourthDiagnosis': 'K59.04', 'fifthDiagnosis': 'B37.2', 'sixthDiagnosis': 'R13.12'}]
[21:22:06] 🔄 
🔄 Step 4: Extracting order data...
[21:22:08] ℹ️  Order extraction - MRN: '227027'
[21:22:08] ℹ️  Order extraction - Sex: 'FEMALE'
[21:22:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[21:22:08] ℹ️  Order extraction - Payer Source: ''
[21:22:08] ✅ Order data extraction completed successfully
[21:22:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:22:08] ℹ️  Using MRN from patient data: '227027' over '227027'
[21:22:08] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[21:22:08] ✅ Patient name cross-validation successful
[21:22:08] ✅    ✅ Data merged successfully
[21:22:10] ✅    ✅ Order data extracted and validated
[21:22:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:22:10] [DOC: 9204212] ✅ Patient found in local cache: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[21:22:10] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[21:22:10] 🔄 
🔄 Step 6: Pushing order to API...
[21:22:10] [DOC: 9204212] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[21:22:11] [DOC: 9204212] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:22:11] ❌    ❌ Failed to push order
[21:22:11] 🔄 
🔄 Step 7: Writing to CSV...
[21:22:11] [DOC: 9204212] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[21:22:11] [DOC: 9204212] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[21:22:11] [DOC: 9204212] ℹ️  Payer Source extracted: ''
[21:22:11] [DOC: 9204212] ℹ️  Diagnosis codes being written:
[21:22:11] [DOC: 9204212] ℹ️    - Latest_Episode_Firstdiagnosis: 'G80.9'
[21:22:11] [DOC: 9204212] ℹ️    - Latest_Episode_Seconddiagnosis: 'R33.9'
[21:22:11] [DOC: 9204212] ℹ️    - Latest_Episode_Thirddiagnosis: 'S21.201D'
[21:22:11] [DOC: 9204212] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K59.04'
[21:22:11] [DOC: 9204212] ℹ️    - Latest_Episode_Fifthdiagnosis: 'B37.2'
[21:22:11] [DOC: 9204212] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R13.12'
[21:22:11] [DOC: 9204212] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 227027
[21:22:11] ✅    ✅ Document 9204212 processed and saved successfully
[21:22:11] 🔄 
🔄 Step 8: Saving API details...
[21:22:11] [DOC: 9204212] ℹ️  API push details saved for document 9204212
[21:22:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204192                         ║
================================================================================
[21:22:11] ℹ️  Agency: Dartmouth HH
[21:22:11] ℹ️  Date: 03/26/2025
[21:22:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:22:14] [DOC: 9204192] ✅ Text extracted using pdfplumber (6929 chars)
[21:22:14] ✅    ✅ Text extracted using pdfplumber (6929 chars)
[21:22:14] 🔄 
🔄 Step 2: Extracting patient data...
[21:22:18] ℹ️  AI extracted raw sex value: 'F'
[21:22:18] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[21:22:18] ℹ️  AI extracted payer source: 'Medicare'
[21:22:18] ℹ️  AI extracted diagnoses:
[21:22:18] ℹ️    - Diagnosis 1: 'RSV'
[21:22:18] ℹ️    - Diagnosis 2: 'None'
[21:22:18] ℹ️    - Diagnosis 3: 'None'
[21:22:18] ℹ️    - Diagnosis 4: 'None'
[21:22:18] ℹ️    - Diagnosis 5: 'None'
[21:22:18] ℹ️    - Diagnosis 6: 'None'
[21:22:18] ℹ️  Final extracted MRN: '5915015'
[21:22:18] ℹ️  Final extracted Sex: 'FEMALE'
[21:22:18] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[21:22:18] ℹ️  Final extracted Payer Source: 'Medicare'
[21:22:18] ✅ Patient data extraction completed successfully
[21:22:18] ✅    ✅ Patient data extracted successfully
[21:22:18] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'afib', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:22:18] ✅    ✅ Patient identified: Suzanne Fawcett
[21:22:18] ✅    ✅ Patient name validation passed
[21:22:18] 🔄 
🔄 Step 3: Processing patient dates...
[21:22:18] [DOC: 9204192] ℹ️  DOB normalized: 12/08/1939
[21:22:18] [DOC: 9204192] ℹ️  Episode startOfCare normalized: 01/26/2025
[21:22:18] [DOC: 9204192] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[21:22:18] [DOC: 9204192] ℹ️  Episode endOfEpisode normalized: 01/25/2025
[21:22:18] [DOC: 9204192] ✅ Patient date processing completed successfully
[21:22:18] ✅    ✅ Date processing completed
[21:22:18] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV'}, {'startOfCare': '', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'afib'}, {'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia'}]
[21:22:18] 🔄 
🔄 Step 4: Extracting order data...
[21:22:20] ℹ️  Order extraction - MRN: '5915015'
[21:22:20] ℹ️  Order extraction - Sex: 'FEMALE'
[21:22:20] ℹ️  Order extraction - Service Line: 'PT, SN'
[21:22:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:22:20] ✅ Order data extraction completed successfully
[21:22:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:22:20] ℹ️  Using MRN from patient data: '5915015' over '5915015'
[21:22:20] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT, SN' = 'PT, Physical Therapy, SN, Skilled Nursing'
[21:22:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:22:20] ✅ Patient name cross-validation successful
[21:22:20] ✅    ✅ Data merged successfully
[21:22:21] ✅    ✅ Order data extracted and validated
[21:22:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:22:36] [DOC: 9204192] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[21:22:36] [DOC: 9204192] ℹ️  Patient not found, creating new patient via API...
[21:22:36] [DOC: 9204192] ℹ️  Creating patient via API: Suzanne Fawcett
[21:22:38] [DOC: 9204192] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:22:38] ❌    ❌ Failed to create patient
[21:22:38] [DOC: 9204192] ℹ️  API push details saved for document 9204192
================================================================================
║                        Processing Document ID: 9204191                         ║
================================================================================
[21:22:38] ℹ️  Agency: Dartmouth HH
[21:22:38] ℹ️  Date: 03/26/2025
[21:22:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:22:40] [DOC: 9204191] ✅ Text extracted using pdfplumber (1303 chars)
[21:22:40] ✅    ✅ Text extracted using pdfplumber (1303 chars)
[21:22:40] 🔄 
🔄 Step 2: Extracting patient data...
[21:22:42] ℹ️  AI extracted raw sex value: 'M'
[21:22:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:22:42] ℹ️  AI extracted payer source: 'Medicare'
[21:22:42] ℹ️  AI extracted diagnoses:
[21:22:42] ℹ️    - Diagnosis 1: 'None'
[21:22:42] ℹ️    - Diagnosis 2: 'None'
[21:22:42] ℹ️    - Diagnosis 3: 'None'
[21:22:42] ℹ️    - Diagnosis 4: 'None'
[21:22:42] ℹ️    - Diagnosis 5: 'None'
[21:22:42] ℹ️    - Diagnosis 6: 'None'
[21:22:42] ℹ️  Final extracted MRN: '3745015'
[21:22:42] ℹ️  Final extracted Sex: 'MALE'
[21:22:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:22:42] ℹ️  Final extracted Payer Source: 'Medicare'
[21:22:42] ✅ Patient data extraction completed successfully
[21:22:42] ✅    ✅ Patient data extracted successfully
[21:22:42] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:22:42] ✅    ✅ Patient identified: Stanley Waters
[21:22:42] ✅    ✅ Patient name validation passed
[21:22:42] 🔄 
🔄 Step 3: Processing patient dates...
[21:22:42] [DOC: 9204191] ℹ️  DOB normalized: 08/19/1941
[21:22:42] [DOC: 9204191] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:22:42] [DOC: 9204191] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[21:22:42] [DOC: 9204191] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[21:22:42] [DOC: 9204191] ✅ Patient date processing completed successfully
[21:22:42] ✅    ✅ Date processing completed
[21:22:42] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025'}]
[21:22:42] 🔄 
🔄 Step 4: Extracting order data...
[21:22:45] ℹ️  Order extraction - MRN: '3745015'
[21:22:45] ℹ️  Order extraction - Sex: 'MALE'
[21:22:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:22:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:22:45] ✅ Order data extraction completed successfully
[21:22:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:22:45] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[21:22:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:22:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:22:45] ✅ Patient name cross-validation successful
[21:22:45] ✅    ✅ Data merged successfully
[21:22:46] ✅    ✅ Order data extracted and validated
[21:22:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:22:46] [DOC: 9204191] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[21:22:46] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[21:22:46] 🔄 
🔄 Step 6: Pushing order to API...
[21:22:46] [DOC: 9204191] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[21:22:47] [DOC: 9204191] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:22:47] ❌    ❌ Failed to push order
[21:22:47] 🔄 
🔄 Step 7: Writing to CSV...
[21:22:47] [DOC: 9204191] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[21:22:47] [DOC: 9204191] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:22:47] [DOC: 9204191] ℹ️  Payer Source extracted: 'Medicare'
[21:22:47] [DOC: 9204191] ℹ️  Diagnosis codes being written:
[21:22:47] [DOC: 9204191] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:22:47] [DOC: 9204191] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:22:47] [DOC: 9204191] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:22:47] [DOC: 9204191] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:22:47] [DOC: 9204191] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:22:47] [DOC: 9204191] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:22:47] [DOC: 9204191] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 3745015
[21:22:47] ✅    ✅ Document 9204191 processed and saved successfully
[21:22:47] 🔄 
🔄 Step 8: Saving API details...
[21:22:47] [DOC: 9204191] ℹ️  API push details saved for document 9204191
[21:22:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204187                         ║
================================================================================
[21:22:47] ℹ️  Agency: Dartmouth HH
[21:22:47] ℹ️  Date: 03/26/2025
[21:22:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:22:57] [DOC: 9204187] ✅ Text extracted using pdfplumber (11338 chars)
[21:22:57] ✅    ✅ Text extracted using pdfplumber (11326 chars)
[21:22:57] 🔄 
🔄 Step 2: Extracting patient data...
[21:23:00] ℹ️  AI extracted raw sex value: 'M'
[21:23:00] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:23:00] ℹ️  AI extracted payer source: 'None'
[21:23:00] ℹ️  AI extracted diagnoses:
[21:23:00] ℹ️    - Diagnosis 1: 'L89.150'
[21:23:00] ℹ️    - Diagnosis 2: 'K62.5'
[21:23:00] ℹ️    - Diagnosis 3: 'J44.9'
[21:23:00] ℹ️    - Diagnosis 4: 'D64.9'
[21:23:00] ℹ️    - Diagnosis 5: 'R63.4'
[21:23:00] ℹ️    - Diagnosis 6: 'G90.09'
[21:23:00] ℹ️  Final extracted MRN: '3745015'
[21:23:00] ℹ️  Final extracted Sex: 'MALE'
[21:23:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:23:00] ℹ️  Final extracted Payer Source: ''
[21:23:00] ✅ Patient data extraction completed successfully
[21:23:00] ✅    ✅ Patient data extracted successfully
[21:23:00] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'L89.150', 'secondDiagnosis': 'K62.5', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'G90.09'}]
[21:23:00] ✅    ✅ Patient identified: Stanley Waters
[21:23:00] ✅    ✅ Patient name validation passed
[21:23:00] 🔄 
🔄 Step 3: Processing patient dates...
[21:23:00] [DOC: 9204187] ℹ️  DOB normalized: 08/19/1941
[21:23:00] [DOC: 9204187] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:23:00] [DOC: 9204187] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[21:23:00] [DOC: 9204187] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[21:23:00] [DOC: 9204187] ✅ Patient date processing completed successfully
[21:23:00] ✅    ✅ Date processing completed
[21:23:00] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'L89.150', 'secondDiagnosis': 'K62.5', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'G90.09'}]
[21:23:00] 🔄 
🔄 Step 4: Extracting order data...
[21:23:02] ℹ️  Order extraction - MRN: '3745015'
[21:23:02] ℹ️  Order extraction - Sex: 'MALE'
[21:23:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:23:02] ℹ️  Order extraction - Payer Source: ''
[21:23:02] ✅ Order data extraction completed successfully
[21:23:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:23:02] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[21:23:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:23:02] ✅ Patient name cross-validation successful
[21:23:02] ✅    ✅ Data merged successfully
[21:23:03] ✅    ✅ Order data extracted and validated
[21:23:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:23:03] [DOC: 9204187] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[21:23:03] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[21:23:03] 🔄 
🔄 Step 6: Pushing order to API...
[21:23:03] [DOC: 9204187] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[21:23:05] [DOC: 9204187] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:23:05] ❌    ❌ Failed to push order
[21:23:05] 🔄 
🔄 Step 7: Writing to CSV...
[21:23:05] [DOC: 9204187] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[21:23:05] [DOC: 9204187] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:23:05] [DOC: 9204187] ℹ️  Payer Source extracted: ''
[21:23:05] [DOC: 9204187] ℹ️  Diagnosis codes being written:
[21:23:05] [DOC: 9204187] ℹ️    - Latest_Episode_Firstdiagnosis: 'L89.150'
[21:23:05] [DOC: 9204187] ℹ️    - Latest_Episode_Seconddiagnosis: 'K62.5'
[21:23:05] [DOC: 9204187] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[21:23:05] [DOC: 9204187] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D64.9'
[21:23:05] [DOC: 9204187] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[21:23:05] [DOC: 9204187] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G90.09'
[21:23:05] [DOC: 9204187] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 3745015
[21:23:05] ✅    ✅ Document 9204187 processed and saved successfully
[21:23:05] 🔄 
🔄 Step 8: Saving API details...
[21:23:05] [DOC: 9204187] ℹ️  API push details saved for document 9204187
[21:23:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204172                         ║
================================================================================
[21:23:05] ℹ️  Agency: Dartmouth HH
[21:23:05] ℹ️  Date: 03/26/2025
[21:23:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:23:07] [DOC: 9204172] ✅ Text extracted using pdfplumber (9517 chars)
[21:23:07] ✅    ✅ Text extracted using pdfplumber (9505 chars)
[21:23:07] 🔄 
🔄 Step 2: Extracting patient data...
[21:23:10] ℹ️  AI extracted raw sex value: 'M'
[21:23:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:23:10] ℹ️  AI extracted payer source: 'None'
[21:23:10] ℹ️  AI extracted diagnoses:
[21:23:10] ℹ️    - Diagnosis 1: 'N40.1'
[21:23:10] ℹ️    - Diagnosis 2: 'R33.9'
[21:23:10] ℹ️    - Diagnosis 3: 'R31.9'
[21:23:10] ℹ️    - Diagnosis 4: 'N42.9'
[21:23:10] ℹ️    - Diagnosis 5: 'D45'
[21:23:10] ℹ️    - Diagnosis 6: 'I10'
[21:23:10] ℹ️  Final extracted MRN: '227027'
[21:23:10] ℹ️  Final extracted Sex: 'MALE'
[21:23:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:23:10] ℹ️  Final extracted Payer Source: ''
[21:23:10] ✅ Patient data extraction completed successfully
[21:23:10] ✅    ✅ Patient data extracted successfully
[21:23:10] 📊 Patient Response
     └─ patientFName: Doherty
     └─ patientLName: Louis
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/19/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'N40.1', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'R31.9', 'fourthDiagnosis': 'N42.9', 'fifthDiagnosis': 'D45', 'sixthDiagnosis': 'I10'}]
[21:23:10] ✅    ✅ Patient identified: Doherty Louis
[21:23:10] ✅    ✅ Patient name validation passed
[21:23:10] 🔄 
🔄 Step 3: Processing patient dates...
[21:23:10] [DOC: 9204172] ℹ️  DOB normalized: 09/22/1939
[21:23:10] [DOC: 9204172] ℹ️  Episode startOfCare normalized: 01/19/2025
[21:23:10] [DOC: 9204172] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[21:23:10] [DOC: 9204172] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[21:23:10] [DOC: 9204172] ✅ Patient date processing completed successfully
[21:23:10] ✅    ✅ Date processing completed
[21:23:10] 📊 Processed Patient Data
     └─ patientFName: Doherty
     └─ patientLName: Louis
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/19/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'N40.1', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'R31.9', 'fourthDiagnosis': 'N42.9', 'fifthDiagnosis': 'D45', 'sixthDiagnosis': 'I10'}]
[21:23:10] 🔄 
🔄 Step 4: Extracting order data...
[21:23:12] ℹ️  Order extraction - MRN: '227027'
[21:23:12] ℹ️  Order extraction - Sex: 'MALE'
[21:23:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[21:23:12] ℹ️  Order extraction - Payer Source: ''
[21:23:12] ✅ Order data extraction completed successfully
[21:23:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:23:12] ℹ️  Using MRN from patient data: '227027' over '227027'
[21:23:12] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT' = 'PT, Skilled Nursing'
[21:23:12] ✅ Patient name cross-validation successful
[21:23:12] ✅    ✅ Data merged successfully
[21:23:14] ✅    ✅ Order data extracted and validated
[21:23:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:23:30] [DOC: 9204172] ℹ️  Patient not found in cache or API: Doherty Louis
[21:23:30] [DOC: 9204172] ℹ️  Patient not found, creating new patient via API...
[21:23:30] [DOC: 9204172] ℹ️  Creating patient via API: Doherty Louis
[21:23:31] [DOC: 9204172] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:23:31] ❌    ❌ Failed to create patient
[21:23:31] [DOC: 9204172] ℹ️  API push details saved for document 9204172
================================================================================
║                        Processing Document ID: 9204169                         ║
================================================================================
[21:23:31] ℹ️  Agency: Dartmouth HH
[21:23:31] ℹ️  Date: 03/26/2025
[21:23:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:23:33] [DOC: 9204169] ✅ Text extracted using pdfplumber (1954 chars)
[21:23:33] ✅    ✅ Text extracted using pdfplumber (1954 chars)
[21:23:33] 🔄 
🔄 Step 2: Extracting patient data...
[21:23:36] ℹ️  AI extracted raw sex value: 'M'
[21:23:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:23:36] ℹ️  AI extracted payer source: 'Medicare'
[21:23:36] ℹ️  AI extracted diagnoses:
[21:23:36] ℹ️    - Diagnosis 1: 'None'
[21:23:36] ℹ️    - Diagnosis 2: 'None'
[21:23:36] ℹ️    - Diagnosis 3: 'None'
[21:23:36] ℹ️    - Diagnosis 4: 'None'
[21:23:36] ℹ️    - Diagnosis 5: 'None'
[21:23:36] ℹ️    - Diagnosis 6: 'None'
[21:23:36] ℹ️  Final extracted MRN: '5894015'
[21:23:36] ℹ️  Final extracted Sex: 'MALE'
[21:23:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:23:36] ℹ️  Final extracted Payer Source: 'Medicare'
[21:23:36] ✅ Patient data extraction completed successfully
[21:23:36] ✅    ✅ Patient data extracted successfully
[21:23:36] 📊 Patient Response
     └─ patientFName: Louis
     └─ patientLName: Doherty
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 5894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:23:36] ✅    ✅ Patient identified: Louis Doherty
[21:23:36] ✅    ✅ Patient name validation passed
[21:23:36] 🔄 
🔄 Step 3: Processing patient dates...
[21:23:36] [DOC: 9204169] ℹ️  DOB normalized: 09/22/1939
[21:23:36] [DOC: 9204169] ℹ️  Episode startOfCare normalized: 01/20/2025
[21:23:36] [DOC: 9204169] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[21:23:36] [DOC: 9204169] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[21:23:36] [DOC: 9204169] ✅ Patient date processing completed successfully
[21:23:36] ✅    ✅ Date processing completed
[21:23:36] 📊 Processed Patient Data
     └─ patientFName: Louis
     └─ patientLName: Doherty
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 5894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025'}]
[21:23:36] 🔄 
🔄 Step 4: Extracting order data...
[21:23:38] ℹ️  Order extraction - MRN: ''
[21:23:38] ℹ️  Order extraction - Sex: 'MALE'
[21:23:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:23:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:23:38] ✅ Order data extraction completed successfully
[21:23:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:23:38] ℹ️  Using MRN from patient data: '5894015'
[21:23:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:23:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:23:38] ✅ Patient name cross-validation successful
[21:23:38] ✅    ✅ Data merged successfully
[21:23:39] ✅    ✅ Order data extracted and validated
[21:23:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:23:39] [DOC: 9204169] ✅ Patient found in local cache: Louis Doherty, ID: d22c2c4d-c413-4c62-bd0e-f571b12a80e7
[21:23:39] ✅    ✅ Existing patient found with ID: d22c2c4d-c413-4c62-bd0e-f571b12a80e7
[21:23:39] 🔄 
🔄 Step 6: Pushing order to API...
[21:23:39] [DOC: 9204169] ℹ️  Pushing order via API for patient ID: d22c2c4d-c413-4c62-bd0e-f571b12a80e7
[21:23:40] [DOC: 9204169] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13886"}
[21:23:40] ❌    ❌ Failed to push order
[21:23:40] 🔄 
🔄 Step 7: Writing to CSV...
[21:23:40] [DOC: 9204169] ℹ️  Calculated age: 85 from DOB: 09/22/1939
[21:23:40] [DOC: 9204169] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:23:40] [DOC: 9204169] ℹ️  Payer Source extracted: 'Medicare'
[21:23:40] [DOC: 9204169] ℹ️  Diagnosis codes being written:
[21:23:40] [DOC: 9204169] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:23:40] [DOC: 9204169] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:23:40] [DOC: 9204169] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:23:40] [DOC: 9204169] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:23:40] [DOC: 9204169] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:23:40] [DOC: 9204169] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:23:40] [DOC: 9204169] ✅ Patient data written to CSV: Louis Doherty | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: 5894015
[21:23:40] ✅    ✅ Document 9204169 processed and saved successfully
[21:23:40] 🔄 
🔄 Step 8: Saving API details...
[21:23:40] [DOC: 9204169] ℹ️  API push details saved for document 9204169
[21:23:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204166                         ║
================================================================================
[21:23:40] ℹ️  Agency: Dartmouth HH
[21:23:40] ℹ️  Date: 03/26/2025
[21:23:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:23:44] [DOC: 9204166] ✅ Text extracted using pdfplumber (19867 chars)
[21:23:44] ✅    ✅ Text extracted using pdfplumber (19867 chars)
[21:23:44] 🔄 
🔄 Step 2: Extracting patient data...
[21:23:47] ℹ️  AI extracted raw sex value: 'F'
[21:23:47] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[21:23:47] ℹ️  AI extracted payer source: 'None'
[21:23:47] ℹ️  AI extracted diagnoses:
[21:23:47] ℹ️    - Diagnosis 1: 'J18.9'
[21:23:47] ℹ️    - Diagnosis 2: 'S22.31XD'
[21:23:47] ℹ️    - Diagnosis 3: 'I48.20'
[21:23:47] ℹ️    - Diagnosis 4: 'I10'
[21:23:47] ℹ️    - Diagnosis 5: 'E78.5'
[21:23:47] ℹ️    - Diagnosis 6: 'F41.9'
[21:23:47] ℹ️  Final extracted MRN: '3188009'
[21:23:47] ℹ️  Final extracted Sex: 'FEMALE'
[21:23:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[21:23:47] ℹ️  Final extracted Payer Source: ''
[21:23:47] ✅ Patient data extraction completed successfully
[21:23:47] ✅    ✅ Patient data extracted successfully
[21:23:47] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Blanchette
     └─ dob: 10/06/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3188009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'S22.31XD', 'thirdDiagnosis': 'I48.20', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[21:23:47] ✅    ✅ Patient identified: Rita Blanchette
[21:23:47] ✅    ✅ Patient name validation passed
[21:23:47] 🔄 
🔄 Step 3: Processing patient dates...
[21:23:47] [DOC: 9204166] ℹ️  DOB normalized: 10/06/1928
[21:23:47] [DOC: 9204166] ℹ️  Episode startOfCare normalized: 03/12/2025
[21:23:47] [DOC: 9204166] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:23:47] [DOC: 9204166] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:23:47] [DOC: 9204166] ✅ Patient date processing completed successfully
[21:23:47] ✅    ✅ Date processing completed
[21:23:47] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Blanchette
     └─ dob: 10/06/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3188009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'S22.31XD', 'thirdDiagnosis': 'I48.20', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[21:23:47] 🔄 
🔄 Step 4: Extracting order data...
[21:23:50] ℹ️  Order extraction - MRN: '3188009'
[21:23:50] ℹ️  Order extraction - Sex: 'FEMALE'
[21:23:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[21:23:50] ℹ️  Order extraction - Payer Source: ''
[21:23:50] ✅ Order data extraction completed successfully
[21:23:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:23:50] ℹ️  Using MRN from patient data: '3188009' over '3188009'
[21:23:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[21:23:50] ✅ Patient name cross-validation successful
[21:23:50] ✅    ✅ Data merged successfully
[21:23:51] ✅    ✅ Order data extracted and validated
[21:23:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:23:51] [DOC: 9204166] ✅ Patient found in local cache: Rita Blanchette, ID: ea808626-f6db-4916-b57d-dae1fb46c508
[21:23:51] ✅    ✅ Existing patient found with ID: ea808626-f6db-4916-b57d-dae1fb46c508
[21:23:51] 🔄 
🔄 Step 6: Pushing order to API...
[21:23:51] [DOC: 9204166] ℹ️  Pushing order via API for patient ID: ea808626-f6db-4916-b57d-dae1fb46c508
[21:23:53] [DOC: 9204166] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:23:53] ❌    ❌ Failed to push order
[21:23:53] 🔄 
🔄 Step 7: Writing to CSV...
[21:23:53] [DOC: 9204166] ℹ️  Calculated age: 96 from DOB: 10/06/1928
[21:23:53] [DOC: 9204166] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[21:23:53] [DOC: 9204166] ℹ️  Payer Source extracted: ''
[21:23:53] [DOC: 9204166] ℹ️  Diagnosis codes being written:
[21:23:53] [DOC: 9204166] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[21:23:53] [DOC: 9204166] ℹ️    - Latest_Episode_Seconddiagnosis: 'S22.31XD'
[21:23:53] [DOC: 9204166] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.20'
[21:23:53] [DOC: 9204166] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[21:23:53] [DOC: 9204166] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[21:23:53] [DOC: 9204166] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[21:23:53] [DOC: 9204166] ✅ Patient data written to CSV: Rita Blanchette | Sex: FEMALE | Age: 96 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 3188009
[21:23:53] ✅    ✅ Document 9204166 processed and saved successfully
[21:23:53] 🔄 
🔄 Step 8: Saving API details...
[21:23:53] [DOC: 9204166] ℹ️  API push details saved for document 9204166
[21:23:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204160                         ║
================================================================================
[21:23:53] ℹ️  Agency: Dartmouth HH
[21:23:53] ℹ️  Date: 03/26/2025
[21:23:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:23:56] [DOC: 9204160] ✅ Text extracted using pdfplumber (20451 chars)
[21:23:56] ✅    ✅ Text extracted using pdfplumber (20451 chars)
[21:23:56] 🔄 
🔄 Step 2: Extracting patient data...
[21:23:59] ℹ️  AI extracted raw sex value: 'F'
[21:23:59] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[21:23:59] ℹ️  AI extracted payer source: ''
[21:23:59] ℹ️  AI extracted diagnoses:
[21:23:59] ℹ️    - Diagnosis 1: 'K29.70'
[21:23:59] ℹ️    - Diagnosis 2: 'R10.13'
[21:23:59] ℹ️    - Diagnosis 3: 'E11.65'
[21:23:59] ℹ️    - Diagnosis 4: 'E03.1'
[21:23:59] ℹ️    - Diagnosis 5: 'I13.0'
[21:23:59] ℹ️    - Diagnosis 6: 'I50.30'
[21:23:59] ℹ️  Final extracted MRN: '4929009'
[21:23:59] ℹ️  Final extracted Sex: 'FEMALE'
[21:23:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[21:23:59] ℹ️  Final extracted Payer Source: ''
[21:23:59] ✅ Patient data extraction completed successfully
[21:23:59] ✅    ✅ Patient data extracted successfully
[21:23:59] 📊 Patient Response
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K29.70', 'secondDiagnosis': 'R10.13', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E03.1', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[21:23:59] ✅    ✅ Patient identified: Katherine Ferreira
[21:23:59] ✅    ✅ Patient name validation passed
[21:23:59] 🔄 
🔄 Step 3: Processing patient dates...
[21:23:59] [DOC: 9204160] ℹ️  DOB normalized: 02/26/1929
[21:23:59] [DOC: 9204160] ℹ️  Episode startOfCare normalized: 03/09/2025
[21:23:59] [DOC: 9204160] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[21:23:59] [DOC: 9204160] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[21:23:59] [DOC: 9204160] ✅ Patient date processing completed successfully
[21:23:59] ✅    ✅ Date processing completed
[21:23:59] 📊 Processed Patient Data
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K29.70', 'secondDiagnosis': 'R10.13', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E03.1', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[21:23:59] 🔄 
🔄 Step 4: Extracting order data...
[21:24:02] ℹ️  Order extraction - MRN: '4929009'
[21:24:02] ℹ️  Order extraction - Sex: 'FEMALE'
[21:24:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[21:24:02] ℹ️  Order extraction - Payer Source: ''
[21:24:02] ✅ Order data extraction completed successfully
[21:24:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:24:02] ℹ️  Using MRN from patient data: '4929009' over '4929009'
[21:24:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[21:24:02] ✅ Patient name cross-validation successful
[21:24:02] ✅    ✅ Data merged successfully
[21:24:03] ✅    ✅ Order data extracted and validated
[21:24:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:24:03] [DOC: 9204160] ✅ Patient found in local cache: Katherine Ferreira, ID: a91e06c9-4785-41d3-ae13-67be5545d837
[21:24:03] ✅    ✅ Existing patient found with ID: a91e06c9-4785-41d3-ae13-67be5545d837
[21:24:03] 🔄 
🔄 Step 6: Pushing order to API...
[21:24:03] [DOC: 9204160] ℹ️  Pushing order via API for patient ID: a91e06c9-4785-41d3-ae13-67be5545d837
[21:24:04] [DOC: 9204160] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:24:04] ❌    ❌ Failed to push order
[21:24:04] 🔄 
🔄 Step 7: Writing to CSV...
[21:24:04] [DOC: 9204160] ℹ️  Calculated age: 96 from DOB: 02/26/1929
[21:24:04] [DOC: 9204160] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[21:24:04] [DOC: 9204160] ℹ️  Payer Source extracted: ''
[21:24:04] [DOC: 9204160] ℹ️  Diagnosis codes being written:
[21:24:04] [DOC: 9204160] ℹ️    - Latest_Episode_Firstdiagnosis: 'K29.70'
[21:24:04] [DOC: 9204160] ℹ️    - Latest_Episode_Seconddiagnosis: 'R10.13'
[21:24:04] [DOC: 9204160] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[21:24:04] [DOC: 9204160] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.1'
[21:24:04] [DOC: 9204160] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I13.0'
[21:24:04] [DOC: 9204160] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.30'
[21:24:04] [DOC: 9204160] ✅ Patient data written to CSV: Katherine Ferreira | Sex: FEMALE | Age: 96 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 4929009
[21:24:04] ✅    ✅ Document 9204160 processed and saved successfully
[21:24:04] 🔄 
🔄 Step 8: Saving API details...
[21:24:04] [DOC: 9204160] ℹ️  API push details saved for document 9204160
[21:24:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204156                         ║
================================================================================
[21:24:04] ℹ️  Agency: Dartmouth HH
[21:24:04] ℹ️  Date: 03/26/2025
[21:24:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:24:06] [DOC: 9204156] ✅ Text extracted using pdfplumber (1475 chars)
[21:24:06] ✅    ✅ Text extracted using pdfplumber (1475 chars)
[21:24:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:24:09] ℹ️  AI extracted raw sex value: 'F'
[21:24:09] ℹ️  AI extracted service line: 'RN, OT'
[21:24:09] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[21:24:09] ℹ️  AI extracted diagnoses:
[21:24:09] ℹ️    - Diagnosis 1: ''
[21:24:09] ℹ️    - Diagnosis 2: ''
[21:24:09] ℹ️    - Diagnosis 3: ''
[21:24:09] ℹ️    - Diagnosis 4: ''
[21:24:09] ℹ️    - Diagnosis 5: ''
[21:24:09] ℹ️    - Diagnosis 6: ''
[21:24:09] ℹ️  Final extracted MRN: '4929009'
[21:24:09] ℹ️  Final extracted Sex: 'FEMALE'
[21:24:09] ℹ️  Final extracted Service Line: 'RN, OT'
[21:24:09] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[21:24:09] ✅ Patient data extraction completed successfully
[21:24:09] ✅    ✅ Patient data extracted successfully
[21:24:09] 📊 Patient Response
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, OT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:24:09] ✅    ✅ Patient identified: Katherine Ferreira
[21:24:09] ✅    ✅ Patient name validation passed
[21:24:09] 🔄 
🔄 Step 3: Processing patient dates...
[21:24:09] [DOC: 9204156] ℹ️  DOB normalized: 02/26/1929
[21:24:09] [DOC: 9204156] ℹ️  Episode startOfCare normalized: 03/10/2025
[21:24:09] [DOC: 9204156] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[21:24:09] [DOC: 9204156] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[21:24:09] [DOC: 9204156] ✅ Patient date processing completed successfully
[21:24:09] ✅    ✅ Date processing completed
[21:24:09] 📊 Processed Patient Data
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, OT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:24:09] 🔄 
🔄 Step 4: Extracting order data...
[21:24:11] ℹ️  Order extraction - MRN: ''
[21:24:11] ℹ️  Order extraction - Sex: 'FEMALE'
[21:24:11] ℹ️  Order extraction - Service Line: 'OT, RN'
[21:24:11] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[21:24:11] ✅ Order data extraction completed successfully
[21:24:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:24:11] ℹ️  Using MRN from patient data: '4929009'
[21:24:11] ℹ️  Combined service lines: Patient='RN, OT' + Order='OT, RN' = 'OT, RN'
[21:24:11] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[21:24:11] ✅ Patient name cross-validation successful
[21:24:11] ✅    ✅ Data merged successfully
[21:24:12] ✅    ✅ Order data extracted and validated
[21:24:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:24:12] [DOC: 9204156] ✅ Patient found in local cache: Katherine Ferreira, ID: a91e06c9-4785-41d3-ae13-67be5545d837
[21:24:12] ✅    ✅ Existing patient found with ID: a91e06c9-4785-41d3-ae13-67be5545d837
[21:24:12] 🔄 
🔄 Step 6: Pushing order to API...
[21:24:12] [DOC: 9204156] ℹ️  Pushing order via API for patient ID: a91e06c9-4785-41d3-ae13-67be5545d837
[21:24:14] [DOC: 9204156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:24:14] ❌    ❌ Failed to push order
[21:24:14] 🔄 
🔄 Step 7: Writing to CSV...
[21:24:14] [DOC: 9204156] ℹ️  Calculated age: 96 from DOB: 02/26/1929
[21:24:14] [DOC: 9204156] ℹ️  Service Line extracted: 'OT, RN'
[21:24:14] [DOC: 9204156] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[21:24:14] [DOC: 9204156] ℹ️  Diagnosis codes being written:
[21:24:14] [DOC: 9204156] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:24:14] [DOC: 9204156] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:24:14] [DOC: 9204156] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:24:14] [DOC: 9204156] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:24:14] [DOC: 9204156] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:24:14] [DOC: 9204156] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:24:14] [DOC: 9204156] ✅ Patient data written to CSV: Katherine Ferreira | Sex: FEMALE | Age: 96 | Service: OT, RN | Payer: Tufts Health Plan Senior Care Options | MRN: 4929009
[21:24:14] ✅    ✅ Document 9204156 processed and saved successfully
[21:24:14] 🔄 
🔄 Step 8: Saving API details...
[21:24:14] [DOC: 9204156] ℹ️  API push details saved for document 9204156
[21:24:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204151                         ║
================================================================================
[21:24:14] ℹ️  Agency: Dartmouth HH
[21:24:14] ℹ️  Date: 03/26/2025
[21:24:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:24:16] [DOC: 9204151] ✅ Text extracted using pdfplumber (9909 chars)
[21:24:16] ✅    ✅ Text extracted using pdfplumber (9897 chars)
[21:24:16] 🔄 
🔄 Step 2: Extracting patient data...
[21:24:19] ℹ️  AI extracted raw sex value: 'M'
[21:24:19] ℹ️  AI extracted service line: 'PT, RN'
[21:24:19] ℹ️  AI extracted payer source: ''
[21:24:19] ℹ️  AI extracted diagnoses:
[21:24:19] ℹ️    - Diagnosis 1: 'I69.354'
[21:24:19] ℹ️    - Diagnosis 2: 'F41.9'
[21:24:19] ℹ️    - Diagnosis 3: 'I11.0'
[21:24:19] ℹ️    - Diagnosis 4: 'I50.9'
[21:24:19] ℹ️    - Diagnosis 5: 'K59.00'
[21:24:19] ℹ️    - Diagnosis 6: 'I25.2'
[21:24:19] ℹ️  Final extracted MRN: '227027'
[21:24:19] ℹ️  Final extracted Sex: 'MALE'
[21:24:19] ℹ️  Final extracted Service Line: 'PT, RN'
[21:24:19] ℹ️  Final extracted Payer Source: ''
[21:24:19] ✅ Patient data extraction completed successfully
[21:24:19] ✅    ✅ Patient data extracted successfully
[21:24:19] 📊 Patient Response
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/05/2024', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'K59.00', 'sixthDiagnosis': 'I25.2'}]
[21:24:19] ✅    ✅ Patient identified: Wayne Dubreuil
[21:24:19] ✅    ✅ Patient name validation passed
[21:24:19] 🔄 
🔄 Step 3: Processing patient dates...
[21:24:19] [DOC: 9204151] ℹ️  DOB normalized: 08/14/1953
[21:24:19] [DOC: 9204151] ℹ️  Episode startOfCare normalized: 11/05/2024
[21:24:19] [DOC: 9204151] ℹ️  Episode startOfEpisode normalized: 01/16/2025
[21:24:19] [DOC: 9204151] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[21:24:19] [DOC: 9204151] ✅ Patient date processing completed successfully
[21:24:19] ✅    ✅ Date processing completed
[21:24:19] 📊 Processed Patient Data
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/05/2024', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'K59.00', 'sixthDiagnosis': 'I25.2'}]
[21:24:19] 🔄 
🔄 Step 4: Extracting order data...
[21:24:22] ℹ️  Order extraction - MRN: '227027'
[21:24:22] ℹ️  Order extraction - Sex: 'MALE'
[21:24:22] ℹ️  Order extraction - Service Line: 'PT, RN'
[21:24:22] ℹ️  Order extraction - Payer Source: ''
[21:24:22] ✅ Order data extraction completed successfully
[21:24:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:24:22] ℹ️  Using MRN from patient data: '227027' over '227027'
[21:24:22] ℹ️  Service line consistent in both sources: 'PT, RN'
[21:24:22] ✅ Patient name cross-validation successful
[21:24:22] ✅    ✅ Data merged successfully
[21:24:23] ✅    ✅ Order data extracted and validated
[21:24:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:24:23] [DOC: 9204151] ✅ Patient found in local cache: Wayne Dubreuil, ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[21:24:23] ✅    ✅ Existing patient found with ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[21:24:23] 🔄 
🔄 Step 6: Pushing order to API...
[21:24:23] [DOC: 9204151] ℹ️  Pushing order via API for patient ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[21:24:25] [DOC: 9204151] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:24:25] ❌    ❌ Failed to push order
[21:24:25] 🔄 
🔄 Step 7: Writing to CSV...
[21:24:25] [DOC: 9204151] ℹ️  Calculated age: 71 from DOB: 08/14/1953
[21:24:25] [DOC: 9204151] ℹ️  Service Line extracted: 'PT, RN'
[21:24:25] [DOC: 9204151] ℹ️  Payer Source extracted: ''
[21:24:25] [DOC: 9204151] ℹ️  Diagnosis codes being written:
[21:24:25] [DOC: 9204151] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[21:24:25] [DOC: 9204151] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[21:24:25] [DOC: 9204151] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[21:24:25] [DOC: 9204151] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.9'
[21:24:25] [DOC: 9204151] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K59.00'
[21:24:25] [DOC: 9204151] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.2'
[21:24:25] [DOC: 9204151] ✅ Patient data written to CSV: Wayne Dubreuil | Sex: MALE | Age: 71 | Service: PT, RN | Payer:  | MRN: 227027
[21:24:25] ✅    ✅ Document 9204151 processed and saved successfully
[21:24:25] 🔄 
🔄 Step 8: Saving API details...
[21:24:25] [DOC: 9204151] ℹ️  API push details saved for document 9204151
[21:24:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204148                         ║
================================================================================
[21:24:25] ℹ️  Agency: Dartmouth HH
[21:24:25] ℹ️  Date: 03/26/2025
[21:24:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:24:27] [DOC: 9204148] ✅ Text extracted using pdfplumber (11338 chars)
[21:24:27] ✅    ✅ Text extracted using pdfplumber (11338 chars)
[21:24:27] 🔄 
🔄 Step 2: Extracting patient data...
[21:24:31] ℹ️  AI extracted raw sex value: 'F'
[21:24:31] ℹ️  AI extracted service line: 'PT'
[21:24:31] ℹ️  AI extracted payer source: 'None'
[21:24:31] ℹ️  AI extracted diagnoses:
[21:24:31] ℹ️    - Diagnosis 1: 'Z47.1'
[21:24:31] ℹ️    - Diagnosis 2: 'E66.9'
[21:24:31] ℹ️    - Diagnosis 3: 'Z68.30'
[21:24:31] ℹ️    - Diagnosis 4: 'F41.9'
[21:24:31] ℹ️    - Diagnosis 5: 'E55.9'
[21:24:31] ℹ️    - Diagnosis 6: 'M81.0'
[21:24:31] ℹ️  Final extracted MRN: '6191015'
[21:24:31] ℹ️  Final extracted Sex: 'FEMALE'
[21:24:31] ℹ️  Final extracted Service Line: 'PT'
[21:24:31] ℹ️  Final extracted Payer Source: ''
[21:24:31] ✅ Patient data extraction completed successfully
[21:24:31] ✅    ✅ Patient data extracted successfully
[21:24:31] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Fernandes
     └─ dob: 12/06/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6191015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.30', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'M81.0'}]
[21:24:31] ✅    ✅ Patient identified: Janice Fernandes
[21:24:31] ✅    ✅ Patient name validation passed
[21:24:31] 🔄 
🔄 Step 3: Processing patient dates...
[21:24:31] [DOC: 9204148] ℹ️  DOB normalized: 12/06/1950
[21:24:31] [DOC: 9204148] ℹ️  Episode startOfCare normalized: 03/13/2025
[21:24:31] [DOC: 9204148] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[21:24:31] [DOC: 9204148] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[21:24:31] [DOC: 9204148] ✅ Patient date processing completed successfully
[21:24:31] ✅    ✅ Date processing completed
[21:24:31] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Fernandes
     └─ dob: 12/06/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6191015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.30', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'M81.0'}]
[21:24:31] 🔄 
🔄 Step 4: Extracting order data...
[21:24:34] ℹ️  Order extraction - MRN: '6191015'
[21:24:34] ℹ️  Order extraction - Sex: 'FEMALE'
[21:24:34] ℹ️  Order extraction - Service Line: 'PT'
[21:24:34] ℹ️  Order extraction - Payer Source: ''
[21:24:34] ✅ Order data extraction completed successfully
[21:24:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:24:34] ℹ️  Using MRN from patient data: '6191015' over '6191015'
[21:24:34] ℹ️  Service line consistent in both sources: 'PT'
[21:24:34] ✅ Patient name cross-validation successful
[21:24:34] ✅    ✅ Data merged successfully
[21:24:36] ✅    ✅ Order data extracted and validated
[21:24:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:25:14] [DOC: 9204148] ℹ️  Patient not found in cache or API: Janice Fernandes
[21:25:14] [DOC: 9204148] ℹ️  Patient not found, creating new patient via API...
[21:25:14] [DOC: 9204148] ℹ️  Creating patient via API: Janice Fernandes
[21:25:16] [DOC: 9204148] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:25:16] ❌    ❌ Failed to create patient
[21:25:16] [DOC: 9204148] ℹ️  API push details saved for document 9204148
================================================================================
║                        Processing Document ID: 9204139                         ║
================================================================================
[21:25:16] ℹ️  Agency: Dartmouth HH
[21:25:16] ℹ️  Date: 03/26/2025
[21:25:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:25:18] [DOC: 9204139] ✅ Text extracted using pdfplumber (14197 chars)
[21:25:18] ✅    ✅ Text extracted using pdfplumber (14197 chars)
[21:25:18] 🔄 
🔄 Step 2: Extracting patient data...
[21:25:21] ℹ️  AI extracted raw sex value: 'M'
[21:25:21] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[21:25:21] ℹ️  AI extracted payer source: ''
[21:25:21] ℹ️  AI extracted diagnoses:
[21:25:21] ℹ️    - Diagnosis 1: 'E11.65'
[21:25:21] ℹ️    - Diagnosis 2: 'J84.9'
[21:25:21] ℹ️    - Diagnosis 3: 'I13.0'
[21:25:21] ℹ️    - Diagnosis 4: 'I50.32'
[21:25:21] ℹ️    - Diagnosis 5: 'E11.22'
[21:25:21] ℹ️    - Diagnosis 6: 'N18.30'
[21:25:21] ℹ️  Final extracted MRN: '5879015'
[21:25:21] ℹ️  Final extracted Sex: 'MALE'
[21:25:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[21:25:21] ℹ️  Final extracted Payer Source: ''
[21:25:21] ✅ Patient data extraction completed successfully
[21:25:21] ✅    ✅ Patient data extracted successfully
[21:25:21] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'J84.9', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[21:25:21] ✅    ✅ Patient identified: Roger Alves
[21:25:21] ✅    ✅ Patient name validation passed
[21:25:21] 🔄 
🔄 Step 3: Processing patient dates...
[21:25:21] [DOC: 9204139] ℹ️  DOB normalized: 11/12/1943
[21:25:21] [DOC: 9204139] ℹ️  Episode startOfCare normalized: 01/20/2025
[21:25:21] [DOC: 9204139] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[21:25:21] [DOC: 9204139] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[21:25:21] [DOC: 9204139] ✅ Patient date processing completed successfully
[21:25:21] ✅    ✅ Date processing completed
[21:25:21] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'J84.9', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[21:25:21] 🔄 
🔄 Step 4: Extracting order data...
[21:25:24] ℹ️  Order extraction - MRN: '5879015'
[21:25:24] ℹ️  Order extraction - Sex: 'MALE'
[21:25:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[21:25:24] ℹ️  Order extraction - Payer Source: ''
[21:25:24] ✅ Order data extraction completed successfully
[21:25:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:25:24] ℹ️  Using MRN from patient data: '5879015' over '5879015'
[21:25:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[21:25:24] ✅ Patient name cross-validation successful
[21:25:24] ✅    ✅ Data merged successfully
[21:25:26] ✅    ✅ Order data extracted and validated
[21:25:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:25:26] [DOC: 9204139] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[21:25:26] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[21:25:26] 🔄 
🔄 Step 6: Pushing order to API...
[21:25:26] [DOC: 9204139] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[21:25:28] [DOC: 9204139] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12874"}
[21:25:28] ❌    ❌ Failed to push order
[21:25:28] 🔄 
🔄 Step 7: Writing to CSV...
[21:25:28] [DOC: 9204139] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[21:25:28] [DOC: 9204139] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[21:25:28] [DOC: 9204139] ℹ️  Payer Source extracted: ''
[21:25:28] [DOC: 9204139] ℹ️  Diagnosis codes being written:
[21:25:28] [DOC: 9204139] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[21:25:28] [DOC: 9204139] ℹ️    - Latest_Episode_Seconddiagnosis: 'J84.9'
[21:25:28] [DOC: 9204139] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[21:25:28] [DOC: 9204139] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.32'
[21:25:28] [DOC: 9204139] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[21:25:28] [DOC: 9204139] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.30'
[21:25:28] [DOC: 9204139] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 5879015
[21:25:28] ✅    ✅ Document 9204139 processed and saved successfully
[21:25:28] 🔄 
🔄 Step 8: Saving API details...
[21:25:28] [DOC: 9204139] ℹ️  API push details saved for document 9204139
[21:25:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204135                         ║
================================================================================
[21:25:28] ℹ️  Agency: Dartmouth HH
[21:25:28] ℹ️  Date: 03/26/2025
[21:25:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:25:30] [DOC: 9204135] ✅ Text extracted using pdfplumber (1322 chars)
[21:25:30] ✅    ✅ Text extracted using pdfplumber (1322 chars)
[21:25:30] 🔄 
🔄 Step 2: Extracting patient data...
[21:25:33] ℹ️  AI extracted raw sex value: 'M'
[21:25:33] ℹ️  AI extracted service line: 'RN'
[21:25:33] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[21:25:33] ℹ️  AI extracted diagnoses:
[21:25:33] ℹ️    - Diagnosis 1: ''
[21:25:33] ℹ️    - Diagnosis 2: ''
[21:25:33] ℹ️    - Diagnosis 3: ''
[21:25:33] ℹ️    - Diagnosis 4: ''
[21:25:33] ℹ️    - Diagnosis 5: ''
[21:25:33] ℹ️    - Diagnosis 6: ''
[21:25:33] ℹ️  Final extracted MRN: '5879015'
[21:25:33] ℹ️  Final extracted Sex: 'MALE'
[21:25:33] ℹ️  Final extracted Service Line: 'RN'
[21:25:33] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[21:25:33] ✅ Patient data extraction completed successfully
[21:25:33] ✅    ✅ Patient data extracted successfully
[21:25:33] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Community Nurse Home Care, Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:25:33] ✅    ✅ Patient identified: Roger Alves
[21:25:33] ✅    ✅ Patient name validation passed
[21:25:33] 🔄 
🔄 Step 3: Processing patient dates...
[21:25:33] [DOC: 9204135] ℹ️  DOB normalized: 11/12/1943
[21:25:33] [DOC: 9204135] ℹ️  Episode startOfCare normalized: 01/20/2025
[21:25:33] [DOC: 9204135] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[21:25:33] [DOC: 9204135] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[21:25:33] [DOC: 9204135] ✅ Patient date processing completed successfully
[21:25:33] ✅    ✅ Date processing completed
[21:25:33] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Community Nurse Home Care, Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:25:33] 🔄 
🔄 Step 4: Extracting order data...
[21:25:35] ℹ️  Order extraction - MRN: '5879015'
[21:25:35] ℹ️  Order extraction - Sex: 'MALE'
[21:25:35] ℹ️  Order extraction - Service Line: 'RN'
[21:25:35] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[21:25:35] ✅ Order data extraction completed successfully
[21:25:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:25:35] ℹ️  Using MRN from patient data: '5879015' over '5879015'
[21:25:35] ℹ️  Service line consistent in both sources: 'RN'
[21:25:35] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[21:25:35] ✅ Patient name cross-validation successful
[21:25:35] ✅    ✅ Data merged successfully
[21:25:37] ✅    ✅ Order data extracted and validated
[21:25:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:25:37] [DOC: 9204135] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[21:25:37] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[21:25:37] 🔄 
🔄 Step 6: Pushing order to API...
[21:25:37] [DOC: 9204135] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[21:25:43] [DOC: 9204135] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12874"}
[21:25:43] ❌    ❌ Failed to push order
[21:25:43] 🔄 
🔄 Step 7: Writing to CSV...
[21:25:43] [DOC: 9204135] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[21:25:43] [DOC: 9204135] ℹ️  Service Line extracted: 'RN'
[21:25:43] [DOC: 9204135] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[21:25:43] [DOC: 9204135] ℹ️  Diagnosis codes being written:
[21:25:43] [DOC: 9204135] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:25:43] [DOC: 9204135] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:25:43] [DOC: 9204135] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:25:43] [DOC: 9204135] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:25:43] [DOC: 9204135] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:25:43] [DOC: 9204135] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:25:43] [DOC: 9204135] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 5879015
[21:25:43] ✅    ✅ Document 9204135 processed and saved successfully
[21:25:43] 🔄 
🔄 Step 8: Saving API details...
[21:25:43] [DOC: 9204135] ℹ️  API push details saved for document 9204135
[21:25:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204131                         ║
================================================================================
[21:25:43] ℹ️  Agency: Fairhaven HH&H
[21:25:43] ℹ️  Date: 03/26/2025
[21:25:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:25:45] [DOC: 9204131] ❌ Critical failure in get_pdf_text: Invalid response format
[21:25:45] ❌ Failed to extract text for Doc ID 9204131
[21:25:45] [DOC: 9204131] ℹ️  API push details saved for document 9204131
================================================================================
║                        Processing Document ID: 9203913                         ║
================================================================================
[21:25:45] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:25:45] ℹ️  Date: 03/26/2025
[21:25:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:25:48] [DOC: 9203913] ✅ Text extracted using pdfplumber (5333 chars)
[21:25:48] ✅    ✅ Text extracted using pdfplumber (5333 chars)
[21:25:48] 🔄 
🔄 Step 2: Extracting patient data...
[21:25:51] ℹ️  AI extracted raw sex value: 'F'
[21:25:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:25:51] ℹ️  AI extracted payer source: 'Fallon Navicare'
[21:25:51] ℹ️  AI extracted diagnoses:
[21:25:51] ℹ️    - Diagnosis 1: 'E11.22'
[21:25:51] ℹ️    - Diagnosis 2: 'I13.0'
[21:25:51] ℹ️    - Diagnosis 3: 'I50.32'
[21:25:51] ℹ️    - Diagnosis 4: 'N18.30'
[21:25:51] ℹ️    - Diagnosis 5: 'D63.1'
[21:25:51] ℹ️    - Diagnosis 6: 'F41.8'
[21:25:51] ℹ️  Final extracted MRN: '528005'
[21:25:51] ℹ️  Final extracted Sex: 'FEMALE'
[21:25:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:25:51] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[21:25:51] ✅ Patient data extraction completed successfully
[21:25:51] ✅    ✅ Patient data extracted successfully
[21:25:51] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 528005
     └─ billingProvider: Shan Qin, MD
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[21:25:51] ✅    ✅ Patient identified: Lorraine Moniz
[21:25:51] ✅    ✅ Patient name validation passed
[21:25:51] 🔄 
🔄 Step 3: Processing patient dates...
[21:25:51] [DOC: 9203913] ℹ️  DOB normalized: 07/18/1944
[21:25:51] [DOC: 9203913] ℹ️  Episode startOfCare normalized: 04/05/2024
[21:25:51] [DOC: 9203913] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[21:25:51] [DOC: 9203913] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[21:25:51] [DOC: 9203913] ✅ Patient date processing completed successfully
[21:25:51] ✅    ✅ Date processing completed
[21:25:51] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 528005
     └─ billingProvider: Shan Qin, MD
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[21:25:51] 🔄 
🔄 Step 4: Extracting order data...
[21:25:54] ℹ️  Order extraction - MRN: '528005'
[21:25:54] ℹ️  Order extraction - Sex: 'FEMALE'
[21:25:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:25:54] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[21:25:54] ✅ Order data extraction completed successfully
[21:25:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:25:54] ℹ️  Using MRN from patient data: '528005' over '528005'
[21:25:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:25:54] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[21:25:54] ✅ Patient name cross-validation successful
[21:25:54] ✅    ✅ Data merged successfully
[21:25:55] ✅    ✅ Order data extracted and validated
[21:25:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:25:55] [DOC: 9203913] ✅ Patient found in local cache: Lorraine Moniz, ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[21:25:55] ✅    ✅ Existing patient found with ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[21:25:55] 🔄 
🔄 Step 6: Pushing order to API...
[21:25:55] [DOC: 9203913] ℹ️  Pushing order via API for patient ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[21:25:56] [DOC: 9203913] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:25:56] ❌    ❌ Failed to push order
[21:25:56] 🔄 
🔄 Step 7: Writing to CSV...
[21:25:56] [DOC: 9203913] ℹ️  Calculated age: 80 from DOB: 07/18/1944
[21:25:56] [DOC: 9203913] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:25:56] [DOC: 9203913] ℹ️  Payer Source extracted: 'Fallon Navicare'
[21:25:56] [DOC: 9203913] ℹ️  Diagnosis codes being written:
[21:25:56] [DOC: 9203913] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[21:25:56] [DOC: 9203913] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[21:25:56] [DOC: 9203913] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[21:25:56] [DOC: 9203913] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[21:25:56] [DOC: 9203913] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[21:25:56] [DOC: 9203913] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.8'
[21:25:56] [DOC: 9203913] ✅ Patient data written to CSV: Lorraine Moniz | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Fallon Navicare | MRN: 528005
[21:25:56] ✅    ✅ Document 9203913 processed and saved successfully
[21:25:56] 🔄 
🔄 Step 8: Saving API details...
[21:25:56] [DOC: 9203913] ℹ️  API push details saved for document 9203913
[21:25:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203906                         ║
================================================================================
[21:25:56] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:25:56] ℹ️  Date: 03/26/2025
[21:25:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:25:58] [DOC: 9203906] ✅ Text extracted using pdfplumber (1751 chars)
[21:25:58] ✅    ✅ Text extracted using pdfplumber (1751 chars)
[21:25:58] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:01] ℹ️  AI extracted raw sex value: 'F'
[21:26:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:26:01] ℹ️  AI extracted payer source: 'Senior Whole Health'
[21:26:01] ℹ️  AI extracted diagnoses:
[21:26:01] ℹ️    - Diagnosis 1: ''
[21:26:01] ℹ️    - Diagnosis 2: ''
[21:26:01] ℹ️    - Diagnosis 3: ''
[21:26:01] ℹ️    - Diagnosis 4: ''
[21:26:01] ℹ️    - Diagnosis 5: ''
[21:26:01] ℹ️    - Diagnosis 6: ''
[21:26:01] ℹ️  Final extracted MRN: '333005'
[21:26:01] ℹ️  Final extracted Sex: 'FEMALE'
[21:26:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:26:01] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[21:26:01] ✅ Patient data extraction completed successfully
[21:26:01] ✅    ✅ Patient data extracted successfully
[21:26:01] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ billingProvider: Karmina Bautista, MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:01] ✅    ✅ Patient identified: Shirley Tavares
[21:26:01] ✅    ✅ Patient name validation passed
[21:26:01] 🔄 
🔄 Step 3: Processing patient dates...
[21:26:01] [DOC: 9203906] ℹ️  DOB normalized: 11/10/1949
[21:26:01] [DOC: 9203906] ℹ️  Episode startOfCare normalized: 09/19/2022
[21:26:01] [DOC: 9203906] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[21:26:01] [DOC: 9203906] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[21:26:01] [DOC: 9203906] ✅ Patient date processing completed successfully
[21:26:01] ✅    ✅ Date processing completed
[21:26:01] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ billingProvider: Karmina Bautista, MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:01] 🔄 
🔄 Step 4: Extracting order data...
[21:26:04] ℹ️  Order extraction - MRN: '333005'
[21:26:04] ℹ️  Order extraction - Sex: 'FEMALE'
[21:26:04] ℹ️  Order extraction - Service Line: 'HHA'
[21:26:04] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[21:26:04] ✅ Order data extraction completed successfully
[21:26:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:26:04] ℹ️  Using MRN from patient data: '333005' over '333005'
[21:26:04] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='HHA' = 'HHA, Skilled Nursing'
[21:26:04] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[21:26:04] ✅ Patient name cross-validation successful
[21:26:04] ✅    ✅ Data merged successfully
[21:26:05] ✅    ✅ Order data extracted and validated
[21:26:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:26:05] [DOC: 9203906] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[21:26:05] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[21:26:05] 🔄 
🔄 Step 6: Pushing order to API...
[21:26:05] [DOC: 9203906] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[21:26:06] [DOC: 9203906] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:26:06] ❌    ❌ Failed to push order
[21:26:06] 🔄 
🔄 Step 7: Writing to CSV...
[21:26:06] [DOC: 9203906] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[21:26:06] [DOC: 9203906] ℹ️  Service Line extracted: 'HHA, Skilled Nursing'
[21:26:06] [DOC: 9203906] ℹ️  Payer Source extracted: 'Senior Whole Health'
[21:26:06] [DOC: 9203906] ℹ️  Diagnosis codes being written:
[21:26:06] [DOC: 9203906] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:26:06] [DOC: 9203906] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:26:06] [DOC: 9203906] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:26:06] [DOC: 9203906] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:26:06] [DOC: 9203906] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:26:06] [DOC: 9203906] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:26:06] [DOC: 9203906] ✅ Patient data written to CSV: Shirley Tavares | Sex: FEMALE | Age: 75 | Service: HHA, Skilled Nursing | Payer: Senior Whole Health | MRN: 333005
[21:26:06] ✅    ✅ Document 9203906 processed and saved successfully
[21:26:06] 🔄 
🔄 Step 8: Saving API details...
[21:26:06] [DOC: 9203906] ℹ️  API push details saved for document 9203906
[21:26:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203819                         ║
================================================================================
[21:26:06] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:26:06] ℹ️  Date: 03/26/2025
[21:26:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:26:11] [DOC: 9203819] ✅ Text extracted using pdfplumber (48698 chars)
[21:26:11] ✅    ✅ Text extracted using pdfplumber (48698 chars)
[21:26:11] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:15] ℹ️  AI extracted raw sex value: ''
[21:26:15] ℹ️  AI extracted service line: ''
[21:26:15] ℹ️  AI extracted payer source: ''
[21:26:15] ℹ️  AI extracted diagnoses:
[21:26:15] ℹ️    - Diagnosis 1: ''
[21:26:15] ℹ️    - Diagnosis 2: ''
[21:26:15] ℹ️    - Diagnosis 3: ''
[21:26:15] ℹ️    - Diagnosis 4: ''
[21:26:15] ℹ️    - Diagnosis 5: ''
[21:26:15] ℹ️    - Diagnosis 6: ''
[21:26:15] ℹ️  Final extracted MRN: ''
[21:26:15] ℹ️  Final extracted Sex: ''
[21:26:15] ℹ️  Final extracted Service Line: ''
[21:26:15] ℹ️  Final extracted Payer Source: ''
[21:26:15] ✅ Patient data extraction completed successfully
[21:26:15] ✅    ✅ Patient data extracted successfully
[21:26:15] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:15] ⚠️     ❌ Insufficient patient data extracted
[21:26:15] [DOC: 9203819] ℹ️  API push details saved for document 9203819
================================================================================
║                        Processing Document ID: 9203811                         ║
================================================================================
[21:26:15] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:26:15] ℹ️  Date: 03/26/2025
[21:26:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:26:18] [DOC: 9203811] ✅ Text extracted using pdfplumber (4627 chars)
[21:26:18] ✅    ✅ Text extracted using pdfplumber (4627 chars)
[21:26:18] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:19] ℹ️  AI extracted raw sex value: 'None'
[21:26:19] ℹ️  AI extracted service line: 'None'
[21:26:19] ℹ️  AI extracted payer source: 'None'
[21:26:19] ℹ️  AI extracted diagnoses:
[21:26:19] ℹ️    - Diagnosis 1: ''
[21:26:19] ℹ️    - Diagnosis 2: ''
[21:26:19] ℹ️    - Diagnosis 3: ''
[21:26:19] ℹ️    - Diagnosis 4: ''
[21:26:19] ℹ️    - Diagnosis 5: ''
[21:26:19] ℹ️    - Diagnosis 6: ''
[21:26:19] ℹ️  Final extracted MRN: ''
[21:26:19] ℹ️  Final extracted Sex: ''
[21:26:19] ℹ️  Final extracted Service Line: ''
[21:26:19] ℹ️  Final extracted Payer Source: ''
[21:26:19] ✅ Patient data extraction completed successfully
[21:26:19] ✅    ✅ Patient data extracted successfully
[21:26:19] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:26:19] ⚠️     ❌ Insufficient patient data extracted
[21:26:19] [DOC: 9203811] ℹ️  API push details saved for document 9203811
================================================================================
║                        Processing Document ID: 9203598                         ║
================================================================================
[21:26:19] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:26:19] ℹ️  Date: 03/26/2025
[21:26:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:26:22] [DOC: 9203598] ✅ Text extracted using pdfplumber (7399 chars)
[21:26:22] ✅    ✅ Text extracted using pdfplumber (7399 chars)
[21:26:22] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:25] ℹ️  AI extracted raw sex value: 'M'
[21:26:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:26:25] ℹ️  AI extracted payer source: ''
[21:26:25] ℹ️  AI extracted diagnoses:
[21:26:25] ℹ️    - Diagnosis 1: 'F25.0'
[21:26:25] ℹ️    - Diagnosis 2: 'E11.22'
[21:26:25] ℹ️    - Diagnosis 3: 'I13.10'
[21:26:25] ℹ️    - Diagnosis 4: 'N18.31'
[21:26:25] ℹ️    - Diagnosis 5: 'F41.0'
[21:26:25] ℹ️    - Diagnosis 6: 'F41.9'
[21:26:25] ℹ️  Final extracted MRN: '879'
[21:26:25] ℹ️  Final extracted Sex: 'MALE'
[21:26:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:26:25] ℹ️  Final extracted Payer Source: ''
[21:26:25] ✅ Patient data extraction completed successfully
[21:26:25] ✅    ✅ Patient data extracted successfully
[21:26:25] 📊 Patient Response
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[21:26:25] ✅    ✅ Patient identified: Sean McCarthy
[21:26:25] ✅    ✅ Patient name validation passed
[21:26:25] 🔄 
🔄 Step 3: Processing patient dates...
[21:26:25] [DOC: 9203598] ℹ️  DOB normalized: 09/16/1969
[21:26:25] [DOC: 9203598] ℹ️  Episode startOfCare normalized: 03/30/2024
[21:26:25] [DOC: 9203598] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[21:26:25] [DOC: 9203598] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[21:26:25] [DOC: 9203598] ✅ Patient date processing completed successfully
[21:26:25] ✅    ✅ Date processing completed
[21:26:25] 📊 Processed Patient Data
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[21:26:25] 🔄 
🔄 Step 4: Extracting order data...
[21:26:28] ℹ️  Order extraction - MRN: '879'
[21:26:28] ℹ️  Order extraction - Sex: 'MALE'
[21:26:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:26:28] ℹ️  Order extraction - Payer Source: ''
[21:26:28] ✅ Order data extraction completed successfully
[21:26:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:26:28] ℹ️  Using MRN from patient data: '879' over '879'
[21:26:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:26:28] ✅ Patient name cross-validation successful
[21:26:28] ✅    ✅ Data merged successfully
[21:26:29] ✅    ✅ Order data extracted and validated
[21:26:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:26:29] [DOC: 9203598] ✅ Patient found in local cache: Sean McCarthy, ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[21:26:29] ✅    ✅ Existing patient found with ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[21:26:29] 🔄 
🔄 Step 6: Pushing order to API...
[21:26:29] [DOC: 9203598] ℹ️  Pushing order via API for patient ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[21:26:31] [DOC: 9203598] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[21:26:31] ❌    ❌ Failed to push order
[21:26:31] 🔄 
🔄 Step 7: Writing to CSV...
[21:26:31] [DOC: 9203598] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[21:26:31] [DOC: 9203598] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:26:31] [DOC: 9203598] ℹ️  Payer Source extracted: ''
[21:26:31] [DOC: 9203598] ℹ️  Diagnosis codes being written:
[21:26:31] [DOC: 9203598] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[21:26:31] [DOC: 9203598] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[21:26:31] [DOC: 9203598] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.10'
[21:26:31] [DOC: 9203598] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[21:26:31] [DOC: 9203598] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.0'
[21:26:31] [DOC: 9203598] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[21:26:31] [DOC: 9203598] ✅ Patient data written to CSV: Sean McCarthy | Sex: MALE | Age: 55 | Service: Skilled Nursing | Payer:  | MRN: 879
[21:26:31] ✅    ✅ Document 9203598 processed and saved successfully
[21:26:31] 🔄 
🔄 Step 8: Saving API details...
[21:26:31] [DOC: 9203598] ℹ️  API push details saved for document 9203598
[21:26:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203542                         ║
================================================================================
[21:26:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:26:31] ℹ️  Date: 03/26/2025
[21:26:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:26:32] [DOC: 9203542] ✅ Text extracted using pdfplumber (1347 chars)
[21:26:32] ✅    ✅ Text extracted using pdfplumber (1347 chars)
[21:26:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:35] ℹ️  AI extracted raw sex value: 'F'
[21:26:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:26:35] ℹ️  AI extracted payer source: ''
[21:26:35] ℹ️  AI extracted diagnoses:
[21:26:35] ℹ️    - Diagnosis 1: ''
[21:26:35] ℹ️    - Diagnosis 2: ''
[21:26:35] ℹ️    - Diagnosis 3: ''
[21:26:35] ℹ️    - Diagnosis 4: ''
[21:26:35] ℹ️    - Diagnosis 5: ''
[21:26:35] ℹ️    - Diagnosis 6: ''
[21:26:35] ℹ️  Final extracted MRN: '2085476'
[21:26:35] ℹ️  Final extracted Sex: 'FEMALE'
[21:26:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:26:35] ℹ️  Final extracted Payer Source: ''
[21:26:35] ✅ Patient data extraction completed successfully
[21:26:35] ✅    ✅ Patient data extracted successfully
[21:26:35] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Simon
     └─ dob: 01/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085476
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:35] ✅    ✅ Patient identified: Joyce Simon
[21:26:35] ✅    ✅ Patient name validation passed
[21:26:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:26:35] [DOC: 9203542] ℹ️  DOB normalized: 01/01/1936
[21:26:35] [DOC: 9203542] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[21:26:35] [DOC: 9203542] ✅ Patient date processing completed successfully
[21:26:35] ✅    ✅ Date processing completed
[21:26:35] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Simon
     └─ dob: 01/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085476
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:35] 🔄 
🔄 Step 4: Extracting order data...
[21:26:37] ℹ️  Order extraction - MRN: '2085476'
[21:26:37] ℹ️  Order extraction - Sex: 'FEMALE'
[21:26:37] ℹ️  Order extraction - Service Line: 'SN'
[21:26:37] ℹ️  Order extraction - Payer Source: ''
[21:26:37] ✅ Order data extraction completed successfully
[21:26:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:26:37] ℹ️  Using MRN from patient data: '2085476' over '2085476'
[21:26:37] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[21:26:37] ✅ Patient name cross-validation successful
[21:26:37] ✅    ✅ Data merged successfully
[21:26:38] ✅    ✅ Order data extracted and validated
[21:26:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:26:38] [DOC: 9203542] ✅ Patient found in local cache: Joyce Simon, ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[21:26:38] ✅    ✅ Existing patient found with ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[21:26:38] 🔄 
🔄 Step 6: Pushing order to API...
[21:26:38] [DOC: 9203542] ℹ️  Pushing order via API for patient ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[21:26:39] [DOC: 9203542] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20078"}
[21:26:39] ❌    ❌ Failed to push order
[21:26:39] 🔄 
🔄 Step 7: Writing to CSV...
[21:26:39] [DOC: 9203542] ℹ️  Calculated age: 89 from DOB: 01/01/1936
[21:26:39] [DOC: 9203542] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[21:26:39] [DOC: 9203542] ℹ️  Payer Source extracted: ''
[21:26:39] [DOC: 9203542] ℹ️  Diagnosis codes being written:
[21:26:39] [DOC: 9203542] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:26:39] [DOC: 9203542] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:26:39] [DOC: 9203542] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:26:39] [DOC: 9203542] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:26:39] [DOC: 9203542] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:26:39] [DOC: 9203542] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:26:39] [DOC: 9203542] ✅ Patient data written to CSV: Joyce Simon | Sex: FEMALE | Age: 89 | Service: SN, Skilled Nursing | Payer:  | MRN: 2085476
[21:26:39] ✅    ✅ Document 9203542 processed and saved successfully
[21:26:39] 🔄 
🔄 Step 8: Saving API details...
[21:26:39] [DOC: 9203542] ℹ️  API push details saved for document 9203542
[21:26:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203520                         ║
================================================================================
[21:26:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:26:39] ℹ️  Date: 03/26/2025
[21:26:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:26:41] [DOC: 9203520] ✅ Text extracted using pdfplumber (1180 chars)
[21:26:41] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[21:26:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:43] ℹ️  AI extracted raw sex value: 'M'
[21:26:43] ℹ️  AI extracted service line: 'Home Health Aide'
[21:26:43] ℹ️  AI extracted payer source: ''
[21:26:43] ℹ️  AI extracted diagnoses:
[21:26:43] ℹ️    - Diagnosis 1: ''
[21:26:43] ℹ️    - Diagnosis 2: ''
[21:26:43] ℹ️    - Diagnosis 3: ''
[21:26:43] ℹ️    - Diagnosis 4: ''
[21:26:43] ℹ️    - Diagnosis 5: ''
[21:26:43] ℹ️    - Diagnosis 6: ''
[21:26:43] ℹ️  Final extracted MRN: '2716471'
[21:26:43] ℹ️  Final extracted Sex: 'MALE'
[21:26:43] ℹ️  Final extracted Service Line: 'Home Health Aide'
[21:26:43] ℹ️  Final extracted Payer Source: ''
[21:26:43] ✅ Patient data extraction completed successfully
[21:26:43] ✅    ✅ Patient data extracted successfully
[21:26:43] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:43] ✅    ✅ Patient identified: Thomas McCormack
[21:26:43] ✅    ✅ Patient name validation passed
[21:26:43] 🔄 
🔄 Step 3: Processing patient dates...
[21:26:43] [DOC: 9203520] ℹ️  DOB normalized: 03/17/1944
[21:26:43] [DOC: 9203520] ✅ Patient date processing completed successfully
[21:26:43] ✅    ✅ Date processing completed
[21:26:43] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:26:43] 🔄 
🔄 Step 4: Extracting order data...
[21:26:46] ℹ️  Order extraction - MRN: '2716471'
[21:26:46] ℹ️  Order extraction - Sex: 'MALE'
[21:26:46] ℹ️  Order extraction - Service Line: 'Home Health Aide'
[21:26:46] ℹ️  Order extraction - Payer Source: ''
[21:26:46] ✅ Order data extraction completed successfully
[21:26:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:26:46] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[21:26:46] ℹ️  Service line consistent in both sources: 'Home Health Aide'
[21:26:46] ✅ Patient name cross-validation successful
[21:26:46] ✅    ✅ Data merged successfully
[21:26:47] ✅    ✅ Order data extracted and validated
[21:26:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:26:47] [DOC: 9203520] ✅ Patient found in local cache: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[21:26:47] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[21:26:47] 🔄 
🔄 Step 6: Pushing order to API...
[21:26:47] [DOC: 9203520] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[21:26:48] [DOC: 9203520] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13335"}
[21:26:48] ❌    ❌ Failed to push order
[21:26:48] 🔄 
🔄 Step 7: Writing to CSV...
[21:26:48] [DOC: 9203520] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[21:26:48] [DOC: 9203520] ℹ️  Service Line extracted: 'Home Health Aide'
[21:26:48] [DOC: 9203520] ℹ️  Payer Source extracted: ''
[21:26:48] [DOC: 9203520] ℹ️  Diagnosis codes being written:
[21:26:48] [DOC: 9203520] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:26:48] [DOC: 9203520] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:26:48] [DOC: 9203520] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:26:48] [DOC: 9203520] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:26:48] [DOC: 9203520] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:26:48] [DOC: 9203520] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:26:48] [DOC: 9203520] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Home Health Aide | Payer:  | MRN: 2716471
[21:26:48] ✅    ✅ Document 9203520 processed and saved successfully
[21:26:48] 🔄 
🔄 Step 8: Saving API details...
[21:26:48] [DOC: 9203520] ℹ️  API push details saved for document 9203520
[21:26:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203483                         ║
================================================================================
[21:26:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:26:48] ℹ️  Date: 03/26/2025
[21:26:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:26:49] [DOC: 9203483] ✅ Text extracted using pdfplumber (2293 chars)
[21:26:49] ✅    ✅ Text extracted using pdfplumber (2293 chars)
[21:26:49] 🔄 
🔄 Step 2: Extracting patient data...
[21:26:51] ℹ️  AI extracted raw sex value: 'F'
[21:26:51] ℹ️  AI extracted service line: 'Medical Social Work'
[21:26:51] ℹ️  AI extracted payer source: ''
[21:26:51] ℹ️  AI extracted diagnoses:
[21:26:51] ℹ️    - Diagnosis 1: ''
[21:26:51] ℹ️    - Diagnosis 2: ''
[21:26:51] ℹ️    - Diagnosis 3: ''
[21:26:51] ℹ️    - Diagnosis 4: ''
[21:26:51] ℹ️    - Diagnosis 5: ''
[21:26:51] ℹ️    - Diagnosis 6: ''
[21:26:51] ℹ️  Final extracted MRN: '2544762'
[21:26:51] ℹ️  Final extracted Sex: 'FEMALE'
[21:26:51] ℹ️  Final extracted Service Line: 'Medical Social Work'
[21:26:51] ℹ️  Final extracted Payer Source: ''
[21:26:51] ✅ Patient data extraction completed successfully
[21:26:51] ✅    ✅ Patient data extracted successfully
[21:26:51] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Gurney
     └─ dob: 12/05/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2544762
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:26:51] ✅    ✅ Patient identified: Janice Gurney
[21:26:51] ✅    ✅ Patient name validation passed
[21:26:51] 🔄 
🔄 Step 3: Processing patient dates...
[21:26:51] [DOC: 9203483] ℹ️  DOB normalized: 12/05/1929
[21:26:51] [DOC: 9203483] ✅ Patient date processing completed successfully
[21:26:51] ✅    ✅ Date processing completed
[21:26:51] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Gurney
     └─ dob: 12/05/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2544762
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:26:51] 🔄 
🔄 Step 4: Extracting order data...
[21:26:54] ℹ️  Order extraction - MRN: '2544762'
[21:26:54] ℹ️  Order extraction - Sex: 'FEMALE'
[21:26:54] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[21:26:54] ℹ️  Order extraction - Payer Source: ''
[21:26:54] ✅ Order data extraction completed successfully
[21:26:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:26:54] ℹ️  Using MRN from patient data: '2544762' over '2544762'
[21:26:54] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[21:26:54] ✅ Patient name cross-validation successful
[21:26:54] ✅    ✅ Data merged successfully
[21:26:55] ✅    ✅ Order data extracted and validated
[21:26:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:27:02] [DOC: 9203483] ℹ️  Patient not found in cache or API: Janice Gurney
[21:27:02] [DOC: 9203483] ℹ️  Patient not found, creating new patient via API...
[21:27:02] [DOC: 9203483] ℹ️  Creating patient via API: Janice Gurney
[21:27:03] [DOC: 9203483] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:27:03] ❌    ❌ Failed to create patient
[21:27:03] [DOC: 9203483] ℹ️  API push details saved for document 9203483
================================================================================
║                        Processing Document ID: 9203466                         ║
================================================================================
[21:27:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:27:03] ℹ️  Date: 03/26/2025
[21:27:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:27:06] [DOC: 9203466] ✅ Text extracted using pdfplumber (1410 chars)
[21:27:06] ✅    ✅ Text extracted using pdfplumber (1398 chars)
[21:27:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:27:09] ℹ️  AI extracted raw sex value: ''
[21:27:09] ℹ️  AI extracted service line: 'Physical Therapy'
[21:27:09] ℹ️  AI extracted payer source: ''
[21:27:09] ℹ️  AI extracted diagnoses:
[21:27:09] ℹ️    - Diagnosis 1: 'I82.412'
[21:27:09] ℹ️    - Diagnosis 2: 'E78.5'
[21:27:09] ℹ️    - Diagnosis 3: 'I10'
[21:27:09] ℹ️    - Diagnosis 4: ''
[21:27:09] ℹ️    - Diagnosis 5: ''
[21:27:09] ℹ️    - Diagnosis 6: ''
[21:27:09] ℹ️  Final extracted MRN: 'MA250121084101'
[21:27:09] ℹ️  Final extracted Sex: ''
[21:27:09] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:27:09] ℹ️  Final extracted Payer Source: ''
[21:27:09] ✅ Patient data extraction completed successfully
[21:27:09] ✅    ✅ Patient data extracted successfully
[21:27:09] 📊 Patient Response
     └─ patientFName: Dora
     └─ patientLName: Simas
     └─ dob: 08/03/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA250121084101
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I82.412', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:27:09] ✅    ✅ Patient identified: Dora Simas
[21:27:09] ✅    ✅ Patient name validation passed
[21:27:09] 🔄 
🔄 Step 3: Processing patient dates...
[21:27:09] [DOC: 9203466] ℹ️  DOB normalized: 08/03/1941
[21:27:09] [DOC: 9203466] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[21:27:09] [DOC: 9203466] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[21:27:09] [DOC: 9203466] ✅ Patient date processing completed successfully
[21:27:09] ✅    ✅ Date processing completed
[21:27:09] 📊 Processed Patient Data
     └─ patientFName: Dora
     └─ patientLName: Simas
     └─ dob: 08/03/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA250121084101
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I82.412', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:27:09] 🔄 
🔄 Step 4: Extracting order data...
[21:27:11] ℹ️  Order extraction - MRN: 'MA250121084101'
[21:27:11] ℹ️  Order extraction - Sex: ''
[21:27:11] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:27:11] ℹ️  Order extraction - Payer Source: ''
[21:27:11] ✅ Order data extraction completed successfully
[21:27:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:27:11] ℹ️  Using MRN from patient data: 'MA250121084101' over 'MA250121084101'
[21:27:11] ⚠️  Could not determine sex using any available method
[21:27:11] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:27:11] ✅ Patient name cross-validation successful
[21:27:11] ✅    ✅ Data merged successfully
[21:27:12] ✅    ✅ Order data extracted and validated
[21:27:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:27:29] [DOC: 9203466] ℹ️  Patient not found in cache or API: Dora Simas
[21:27:29] [DOC: 9203466] ℹ️  Patient not found, creating new patient via API...
[21:27:29] [DOC: 9203466] ℹ️  Creating patient via API: Dora Simas
[21:27:30] [DOC: 9203466] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:27:30] ❌    ❌ Failed to create patient
[21:27:30] [DOC: 9203466] ℹ️  API push details saved for document 9203466
================================================================================
║                        Processing Document ID: 9203465                         ║
================================================================================
[21:27:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:27:30] ℹ️  Date: 03/26/2025
[21:27:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:27:33] [DOC: 9203465] ✅ Text extracted using pdfplumber (1136 chars)
[21:27:33] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[21:27:33] 🔄 
🔄 Step 2: Extracting patient data...
[21:27:35] ℹ️  AI extracted raw sex value: ''
[21:27:35] ℹ️  AI extracted service line: 'LVN/LPN'
[21:27:35] ℹ️  AI extracted payer source: ''
[21:27:35] ℹ️  AI extracted diagnoses:
[21:27:35] ℹ️    - Diagnosis 1: 'F31.30'
[21:27:35] ℹ️    - Diagnosis 2: 'I11.0'
[21:27:35] ℹ️    - Diagnosis 3: 'I50.32'
[21:27:35] ℹ️    - Diagnosis 4: 'None'
[21:27:35] ℹ️    - Diagnosis 5: 'None'
[21:27:35] ℹ️    - Diagnosis 6: 'None'
[21:27:35] ℹ️  Final extracted MRN: '100991032'
[21:27:35] ℹ️  Final extracted Sex: ''
[21:27:35] ℹ️  Final extracted Service Line: 'LVN/LPN'
[21:27:35] ℹ️  Final extracted Payer Source: ''
[21:27:35] ✅ Patient data extraction completed successfully
[21:27:35] ✅    ✅ Patient data extracted successfully
[21:27:35] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Ferreira
     └─ dob: 10/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100991032
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/11/2024', 'endOfEpisode': '09/08/2024', 'firstDiagnosis': 'F31.30', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:27:35] ✅    ✅ Patient identified: Gloria Ferreira
[21:27:35] ✅    ✅ Patient name validation passed
[21:27:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:27:35] [DOC: 9203465] ℹ️  DOB normalized: 10/01/1944
[21:27:35] [DOC: 9203465] ℹ️  Episode startOfEpisode normalized: 07/11/2024
[21:27:35] [DOC: 9203465] ℹ️  Episode endOfEpisode normalized: 09/08/2024
[21:27:35] [DOC: 9203465] ✅ Patient date processing completed successfully
[21:27:35] ✅    ✅ Date processing completed
[21:27:35] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Ferreira
     └─ dob: 10/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100991032
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/11/2024', 'endOfEpisode': '09/08/2024', 'firstDiagnosis': 'F31.30', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32'}]
[21:27:35] 🔄 
🔄 Step 4: Extracting order data...
[21:27:38] ℹ️  Order extraction - MRN: '100991032'
[21:27:38] ℹ️  Order extraction - Sex: ''
[21:27:38] ℹ️  Order extraction - Service Line: 'Nursing'
[21:27:38] ℹ️  Order extraction - Payer Source: ''
[21:27:38] ✅ Order data extraction completed successfully
[21:27:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:27:38] ℹ️  Using MRN from patient data: '100991032' over '100991032'
[21:27:38] ⚠️  Could not determine sex using any available method
[21:27:38] ℹ️  Combined service lines: Patient='LVN/LPN' + Order='Nursing' = 'LVN/LPN, Nursing'
[21:27:38] ✅ Patient name cross-validation successful
[21:27:38] ✅    ✅ Data merged successfully
[21:27:40] ✅    ✅ Order data extracted and validated
[21:27:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:27:40] [DOC: 9203465] ✅ Patient found in local cache: Gloria Ferreira, ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[21:27:40] ✅    ✅ Existing patient found with ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[21:27:40] 🔄 
🔄 Step 6: Pushing order to API...
[21:27:40] [DOC: 9203465] ℹ️  Pushing order via API for patient ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[21:27:41] [DOC: 9203465] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13976"}
[21:27:41] ❌    ❌ Failed to push order
[21:27:41] 🔄 
🔄 Step 7: Writing to CSV...
[21:27:41] [DOC: 9203465] ℹ️  Calculated age: 80 from DOB: 10/01/1944
[21:27:41] [DOC: 9203465] ℹ️  Service Line extracted: 'LVN/LPN, Nursing'
[21:27:41] [DOC: 9203465] ℹ️  Payer Source extracted: ''
[21:27:41] [DOC: 9203465] ℹ️  Diagnosis codes being written:
[21:27:41] [DOC: 9203465] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.30'
[21:27:41] [DOC: 9203465] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[21:27:41] [DOC: 9203465] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[21:27:41] [DOC: 9203465] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:27:41] [DOC: 9203465] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:27:41] [DOC: 9203465] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:27:41] [DOC: 9203465] ✅ Patient data written to CSV: Gloria Ferreira | Sex:  | Age: 80 | Service: LVN/LPN, Nursing | Payer:  | MRN: 100991032
[21:27:41] ✅    ✅ Document 9203465 processed and saved successfully
[21:27:41] 🔄 
🔄 Step 8: Saving API details...
[21:27:41] [DOC: 9203465] ℹ️  API push details saved for document 9203465
[21:27:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203408                         ║
================================================================================
[21:27:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:27:41] ℹ️  Date: 03/26/2025
[21:27:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:27:45] [DOC: 9203408] ✅ Text extracted using pdfplumber (15671 chars)
[21:27:45] ✅    ✅ Text extracted using pdfplumber (15671 chars)
[21:27:45] 🔄 
🔄 Step 2: Extracting patient data...
[21:27:48] ℹ️  AI extracted raw sex value: 'F'
[21:27:48] ℹ️  AI extracted service line: 'PT'
[21:27:48] ℹ️  AI extracted payer source: ''
[21:27:48] ℹ️  AI extracted diagnoses:
[21:27:48] ℹ️    - Diagnosis 1: ''
[21:27:48] ℹ️    - Diagnosis 2: ''
[21:27:48] ℹ️    - Diagnosis 3: ''
[21:27:48] ℹ️    - Diagnosis 4: ''
[21:27:48] ℹ️    - Diagnosis 5: ''
[21:27:48] ℹ️    - Diagnosis 6: ''
[21:27:48] ℹ️  Final extracted MRN: 'MA211018024802'
[21:27:48] ℹ️  Final extracted Sex: 'FEMALE'
[21:27:48] ℹ️  Final extracted Service Line: 'PT'
[21:27:48] ℹ️  Final extracted Payer Source: ''
[21:27:48] ✅ Patient data extraction completed successfully
[21:27:48] ✅    ✅ Patient data extracted successfully
[21:27:48] 📊 Patient Response
     └─ patientFName: Bernice
     └─ patientLName: Duarte
     └─ dob: 02/07/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA211018024802
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/09/2024', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:27:48] ✅    ✅ Patient identified: Bernice Duarte
[21:27:48] ✅    ✅ Patient name validation passed
[21:27:48] 🔄 
🔄 Step 3: Processing patient dates...
[21:27:48] [DOC: 9203408] ℹ️  DOB normalized: 02/07/1948
[21:27:48] [DOC: 9203408] ℹ️  Episode startOfEpisode normalized: 09/09/2024
[21:27:48] [DOC: 9203408] ✅ Patient date processing completed successfully
[21:27:48] ✅    ✅ Date processing completed
[21:27:48] 📊 Processed Patient Data
     └─ patientFName: Bernice
     └─ patientLName: Duarte
     └─ dob: 02/07/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA211018024802
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/09/2024', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:27:48] 🔄 
🔄 Step 4: Extracting order data...
[21:27:50] ℹ️  Order extraction - MRN: 'MA211018024802'
[21:27:50] ℹ️  Order extraction - Sex: 'FEMALE'
[21:27:50] ℹ️  Order extraction - Service Line: 'PT'
[21:27:50] ℹ️  Order extraction - Payer Source: ''
[21:27:50] ✅ Order data extraction completed successfully
[21:27:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:27:50] ℹ️  Using MRN from patient data: 'MA211018024802' over 'MA211018024802'
[21:27:50] ℹ️  Service line consistent in both sources: 'PT'
[21:27:50] ✅ Patient name cross-validation successful
[21:27:50] ✅    ✅ Data merged successfully
[21:27:52] ⚠️     ❌ Skipping - missing episode start date
[21:27:52] [DOC: 9203408] ℹ️  API push details saved for document 9203408
================================================================================
║                        Processing Document ID: 9203400                         ║
================================================================================
[21:27:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:27:52] ℹ️  Date: 03/26/2025
[21:27:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:27:54] [DOC: 9203400] ✅ Text extracted using pdfplumber (2381 chars)
[21:27:54] ✅    ✅ Text extracted using pdfplumber (2369 chars)
[21:27:54] 🔄 
🔄 Step 2: Extracting patient data...
[21:27:57] ℹ️  AI extracted raw sex value: ''
[21:27:57] ℹ️  AI extracted service line: 'PT'
[21:27:57] ℹ️  AI extracted payer source: ''
[21:27:57] ℹ️  AI extracted diagnoses:
[21:27:57] ℹ️    - Diagnosis 1: 'I69.354'
[21:27:57] ℹ️    - Diagnosis 2: 'E78.00'
[21:27:57] ℹ️    - Diagnosis 3: 'L20.9'
[21:27:57] ℹ️    - Diagnosis 4: 'None'
[21:27:57] ℹ️    - Diagnosis 5: 'None'
[21:27:57] ℹ️    - Diagnosis 6: 'None'
[21:27:57] ℹ️  Final extracted MRN: 'MA230120082705'
[21:27:57] ℹ️  Final extracted Sex: ''
[21:27:57] ℹ️  Final extracted Service Line: 'PT'
[21:27:57] ℹ️  Final extracted Payer Source: ''
[21:27:57] ✅ Patient data extraction completed successfully
[21:27:57] ✅    ✅ Patient data extracted successfully
[21:27:57] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: 
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:27:57] ✅    ✅ Patient identified: Irene Copley
[21:27:57] ✅    ✅ Patient name validation passed
[21:27:57] 🔄 
🔄 Step 3: Processing patient dates...
[21:27:57] [DOC: 9203400] ℹ️  DOB normalized: 08/04/1927
[21:27:57] [DOC: 9203400] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[21:27:57] [DOC: 9203400] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[21:27:57] [DOC: 9203400] ✅ Patient date processing completed successfully
[21:27:57] ✅    ✅ Date processing completed
[21:27:57] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: 
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9'}]
[21:27:57] 🔄 
🔄 Step 4: Extracting order data...
[21:27:59] ℹ️  Order extraction - MRN: 'MA230120082705'
[21:27:59] ℹ️  Order extraction - Sex: ''
[21:27:59] ℹ️  Order extraction - Service Line: 'PT'
[21:27:59] ℹ️  Order extraction - Payer Source: ''
[21:27:59] ✅ Order data extraction completed successfully
[21:27:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:27:59] ℹ️  Using MRN from patient data: 'MA230120082705' over 'MA230120082705'
[21:27:59] ⚠️  Could not determine sex using any available method
[21:27:59] ℹ️  Service line consistent in both sources: 'PT'
[21:27:59] ✅ Patient name cross-validation successful
[21:27:59] ✅    ✅ Data merged successfully
[21:28:01] ✅    ✅ Order data extracted and validated
[21:28:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:28:01] [DOC: 9203400] ✅ Patient found in local cache: Irene Copley, ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[21:28:01] ✅    ✅ Existing patient found with ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[21:28:01] 🔄 
🔄 Step 6: Pushing order to API...
[21:28:01] [DOC: 9203400] ℹ️  Pushing order via API for patient ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[21:28:02] [DOC: 9203400] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13530"}
[21:28:02] ❌    ❌ Failed to push order
[21:28:02] 🔄 
🔄 Step 7: Writing to CSV...
[21:28:02] [DOC: 9203400] ℹ️  Calculated age: 97 from DOB: 08/04/1927
[21:28:02] [DOC: 9203400] ℹ️  Service Line extracted: 'PT'
[21:28:02] [DOC: 9203400] ℹ️  Payer Source extracted: ''
[21:28:02] [DOC: 9203400] ℹ️  Diagnosis codes being written:
[21:28:02] [DOC: 9203400] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[21:28:02] [DOC: 9203400] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.00'
[21:28:02] [DOC: 9203400] ℹ️    - Latest_Episode_Thirddiagnosis: 'L20.9'
[21:28:02] [DOC: 9203400] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:28:02] [DOC: 9203400] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:28:02] [DOC: 9203400] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:28:02] [DOC: 9203400] ✅ Patient data written to CSV: Irene Copley | Sex:  | Age: 97 | Service: PT | Payer:  | MRN: MA230120082705
[21:28:02] ✅    ✅ Document 9203400 processed and saved successfully
[21:28:02] 🔄 
🔄 Step 8: Saving API details...
[21:28:02] [DOC: 9203400] ℹ️  API push details saved for document 9203400
[21:28:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203378                         ║
================================================================================
[21:28:02] ℹ️  Agency: Nizhoni Health-Fall River
[21:28:02] ℹ️  Date: 03/26/2025
[21:28:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:28:07] [DOC: 9203378] ✅ Text extracted using pdfplumber (5782 chars)
[21:28:07] ✅    ✅ Text extracted using pdfplumber (5782 chars)
[21:28:07] 🔄 
🔄 Step 2: Extracting patient data...
[21:28:10] ℹ️  AI extracted raw sex value: 'F'
[21:28:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:28:10] ℹ️  AI extracted payer source: 'Medicaid/MA'
[21:28:10] ℹ️  AI extracted diagnoses:
[21:28:10] ℹ️    - Diagnosis 1: 'F33.3'
[21:28:10] ℹ️    - Diagnosis 2: 'F41.1'
[21:28:10] ℹ️    - Diagnosis 3: 'K51.90'
[21:28:10] ℹ️    - Diagnosis 4: 'M54.50'
[21:28:10] ℹ️    - Diagnosis 5: 'N18.30'
[21:28:10] ℹ️    - Diagnosis 6: 'F01.518'
[21:28:10] ℹ️  Final extracted MRN: '24037'
[21:28:10] ℹ️  Final extracted Sex: 'FEMALE'
[21:28:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:28:10] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[21:28:10] ✅ Patient data extraction completed successfully
[21:28:10] ✅    ✅ Patient data extracted successfully
[21:28:10] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Gibson
     └─ dob: 07/27/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 24037
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2018', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'F33.3', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'K51.90', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'F01.518'}]
[21:28:10] ✅    ✅ Patient identified: Patricia Gibson
[21:28:10] ✅    ✅ Patient name validation passed
[21:28:10] 🔄 
🔄 Step 3: Processing patient dates...
[21:28:10] [DOC: 9203378] ℹ️  DOB normalized: 07/27/1952
[21:28:10] [DOC: 9203378] ℹ️  Episode startOfCare normalized: 11/13/2018
[21:28:10] [DOC: 9203378] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[21:28:10] [DOC: 9203378] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[21:28:10] [DOC: 9203378] ✅ Patient date processing completed successfully
[21:28:10] ✅    ✅ Date processing completed
[21:28:10] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Gibson
     └─ dob: 07/27/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 24037
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2018', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'F33.3', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'K51.90', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'F01.518'}]
[21:28:10] 🔄 
🔄 Step 4: Extracting order data...
[21:28:12] ℹ️  Order extraction - MRN: '24037'
[21:28:12] ℹ️  Order extraction - Sex: 'FEMALE'
[21:28:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:28:12] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[21:28:12] ✅ Order data extraction completed successfully
[21:28:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:28:12] ℹ️  Using MRN from patient data: '24037' over '24037'
[21:28:12] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:28:12] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[21:28:12] ✅ Patient name cross-validation successful
[21:28:12] ✅    ✅ Data merged successfully
[21:28:14] ✅    ✅ Order data extracted and validated
[21:28:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:28:14] [DOC: 9203378] ✅ Patient found in local cache: Patricia Gibson, ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[21:28:14] ✅    ✅ Existing patient found with ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[21:28:14] 🔄 
🔄 Step 6: Pushing order to API...
[21:28:14] [DOC: 9203378] ℹ️  Pushing order via API for patient ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[21:28:15] [DOC: 9203378] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:28:15] ❌    ❌ Failed to push order
[21:28:15] 🔄 
🔄 Step 7: Writing to CSV...
[21:28:15] [DOC: 9203378] ℹ️  Calculated age: 72 from DOB: 07/27/1952
[21:28:15] [DOC: 9203378] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:28:15] [DOC: 9203378] ℹ️  Payer Source extracted: 'Medicaid/MA'
[21:28:15] [DOC: 9203378] ℹ️  Diagnosis codes being written:
[21:28:15] [DOC: 9203378] ℹ️    - Latest_Episode_Firstdiagnosis: 'F33.3'
[21:28:15] [DOC: 9203378] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[21:28:15] [DOC: 9203378] ℹ️    - Latest_Episode_Thirddiagnosis: 'K51.90'
[21:28:15] [DOC: 9203378] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.50'
[21:28:15] [DOC: 9203378] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[21:28:15] [DOC: 9203378] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F01.518'
[21:28:15] [DOC: 9203378] ✅ Patient data written to CSV: Patricia Gibson | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 24037
[21:28:15] ✅    ✅ Document 9203378 processed and saved successfully
[21:28:15] 🔄 
🔄 Step 8: Saving API details...
[21:28:15] [DOC: 9203378] ℹ️  API push details saved for document 9203378
[21:28:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9201676                         ║
================================================================================
[21:28:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:28:15] ℹ️  Date: 03/25/2025
[21:28:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:28:17] [DOC: 9201676] ✅ Text extracted using pdfplumber (1480 chars)
[21:28:17] ✅    ✅ Text extracted using pdfplumber (1480 chars)
[21:28:17] 🔄 
🔄 Step 2: Extracting patient data...
[21:28:20] ℹ️  AI extracted raw sex value: ''
[21:28:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:28:20] ℹ️  AI extracted payer source: ''
[21:28:20] ℹ️  AI extracted diagnoses:
[21:28:20] ℹ️    - Diagnosis 1: 'I10'
[21:28:20] ℹ️    - Diagnosis 2: 'G89.29'
[21:28:20] ℹ️    - Diagnosis 3: 'M19.90'
[21:28:20] ℹ️    - Diagnosis 4: 'None'
[21:28:20] ℹ️    - Diagnosis 5: 'None'
[21:28:20] ℹ️    - Diagnosis 6: 'None'
[21:28:20] ℹ️  Final extracted MRN: 'MA240624105104'
[21:28:20] ℹ️  Final extracted Sex: ''
[21:28:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:28:20] ℹ️  Final extracted Payer Source: ''
[21:28:20] ✅ Patient data extraction completed successfully
[21:28:20] ✅    ✅ Patient data extracted successfully
[21:28:20] 📊 Patient Response
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: JUNE RODRIGUES NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:28:20] ✅    ✅ Patient identified: Marsha Tilley
[21:28:20] ✅    ✅ Patient name validation passed
[21:28:20] 🔄 
🔄 Step 3: Processing patient dates...
[21:28:20] [DOC: 9201676] ℹ️  DOB normalized: 10/08/1951
[21:28:20] [DOC: 9201676] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[21:28:20] [DOC: 9201676] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[21:28:20] [DOC: 9201676] ✅ Patient date processing completed successfully
[21:28:20] ✅    ✅ Date processing completed
[21:28:20] 📊 Processed Patient Data
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: JUNE RODRIGUES NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'M19.90'}]
[21:28:20] 🔄 
🔄 Step 4: Extracting order data...
[21:28:23] ℹ️  Order extraction - MRN: 'MA240624105104'
[21:28:23] ℹ️  Order extraction - Sex: ''
[21:28:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:28:23] ℹ️  Order extraction - Payer Source: ''
[21:28:23] ✅ Order data extraction completed successfully
[21:28:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:28:23] ℹ️  Using MRN from patient data: 'MA240624105104' over 'MA240624105104'
[21:28:23] ⚠️  Could not determine sex using any available method
[21:28:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:28:23] ✅ Patient name cross-validation successful
[21:28:23] ✅    ✅ Data merged successfully
[21:28:24] ✅    ✅ Order data extracted and validated
[21:28:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:28:24] [DOC: 9201676] ✅ Patient found in local cache: Marsha Tilley, ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[21:28:24] ✅    ✅ Existing patient found with ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[21:28:24] 🔄 
🔄 Step 6: Pushing order to API...
[21:28:24] [DOC: 9201676] ℹ️  Pushing order via API for patient ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[21:28:25] [DOC: 9201676] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14356"}
[21:28:25] ❌    ❌ Failed to push order
[21:28:25] 🔄 
🔄 Step 7: Writing to CSV...
[21:28:25] [DOC: 9201676] ℹ️  Calculated age: 73 from DOB: 10/08/1951
[21:28:25] [DOC: 9201676] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:28:25] [DOC: 9201676] ℹ️  Payer Source extracted: ''
[21:28:25] [DOC: 9201676] ℹ️  Diagnosis codes being written:
[21:28:25] [DOC: 9201676] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[21:28:25] [DOC: 9201676] ℹ️    - Latest_Episode_Seconddiagnosis: 'G89.29'
[21:28:25] [DOC: 9201676] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.90'
[21:28:25] [DOC: 9201676] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:28:25] [DOC: 9201676] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:28:25] [DOC: 9201676] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:28:25] [DOC: 9201676] ✅ Patient data written to CSV: Marsha Tilley | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA240624105104
[21:28:25] ✅    ✅ Document 9201676 processed and saved successfully
[21:28:25] 🔄 
🔄 Step 8: Saving API details...
[21:28:25] [DOC: 9201676] ℹ️  API push details saved for document 9201676
[21:28:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203303                         ║
================================================================================
[21:28:25] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[21:28:25] ℹ️  Date: 03/25/2025
[21:28:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:28:28] [DOC: 9203303] ✅ Text extracted using pdfplumber (25199 chars)
[21:28:28] ✅    ✅ Text extracted using pdfplumber (25199 chars)
[21:28:28] 🔄 
🔄 Step 2: Extracting patient data...
[21:28:32] ℹ️  AI extracted raw sex value: 'M'
[21:28:32] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:28:32] ℹ️  AI extracted payer source: 'Medicare'
[21:28:32] ℹ️  AI extracted diagnoses:
[21:28:32] ℹ️    - Diagnosis 1: 'B35.6'
[21:28:32] ℹ️    - Diagnosis 2: 'I12.9'
[21:28:32] ℹ️    - Diagnosis 3: 'E11.22'
[21:28:32] ℹ️    - Diagnosis 4: 'N18.31'
[21:28:32] ℹ️    - Diagnosis 5: 'E78.49'
[21:28:32] ℹ️    - Diagnosis 6: 'N40.1'
[21:28:32] ℹ️  Final extracted MRN: '28700209267201'
[21:28:32] ℹ️  Final extracted Sex: 'MALE'
[21:28:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:28:32] ℹ️  Final extracted Payer Source: 'Medicare'
[21:28:32] ✅ Patient data extraction completed successfully
[21:28:32] ✅    ✅ Patient data extracted successfully
[21:28:32] 📊 Patient Response
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 217 DEANE ST APT 304
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02746-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'E78.49', 'sixthDiagnosis': 'N40.1'}]
[21:28:32] ✅    ✅ Patient identified: ROGER VARIEUR
[21:28:32] ✅    ✅ Patient name validation passed
[21:28:32] 🔄 
🔄 Step 3: Processing patient dates...
[21:28:32] [DOC: 9203303] ℹ️  DOB normalized: 05/12/1938
[21:28:32] [DOC: 9203303] ℹ️  Episode startOfCare normalized: 03/15/2025
[21:28:32] [DOC: 9203303] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[21:28:32] [DOC: 9203303] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[21:28:32] [DOC: 9203303] ✅ Patient date processing completed successfully
[21:28:32] ✅    ✅ Date processing completed
[21:28:32] 📊 Processed Patient Data
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 217 DEANE ST APT 304
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02746-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'E78.49', 'sixthDiagnosis': 'N40.1'}]
[21:28:32] 🔄 
🔄 Step 4: Extracting order data...
[21:28:34] ℹ️  Order extraction - MRN: '28700209267201'
[21:28:34] ℹ️  Order extraction - Sex: 'MALE'
[21:28:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:28:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:28:34] ✅ Order data extraction completed successfully
[21:28:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:28:34] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[21:28:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:28:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:28:34] ✅ Patient name cross-validation successful
[21:28:34] ✅    ✅ Data merged successfully
[21:28:36] ✅    ✅ Order data extracted and validated
[21:28:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:28:43] [DOC: 9203303] ℹ️  Patient not found in cache or API: ROGER VARIEUR
[21:28:43] [DOC: 9203303] ℹ️  Patient not found, creating new patient via API...
[21:28:43] [DOC: 9203303] ℹ️  Creating patient via API: ROGER VARIEUR
[21:28:44] [DOC: 9203303] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:28:44] ❌    ❌ Failed to create patient
[21:28:44] [DOC: 9203303] ℹ️  API push details saved for document 9203303
================================================================================
║                        Processing Document ID: 9201180                         ║
================================================================================
[21:28:44] ℹ️  Agency: Alliance Home Care VNA
[21:28:44] ℹ️  Date: 03/25/2025
[21:28:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:28:46] [DOC: 9201180] ✅ Text extracted using pdfplumber (2677 chars)
[21:28:46] ✅    ✅ Text extracted using pdfplumber (2677 chars)
[21:28:46] 🔄 
🔄 Step 2: Extracting patient data...
[21:28:49] ℹ️  AI extracted raw sex value: ''
[21:28:49] ℹ️  AI extracted service line: 'PT'
[21:28:49] ℹ️  AI extracted payer source: ''
[21:28:49] ℹ️  AI extracted diagnoses:
[21:28:49] ℹ️    - Diagnosis 1: ''
[21:28:49] ℹ️    - Diagnosis 2: ''
[21:28:49] ℹ️    - Diagnosis 3: ''
[21:28:49] ℹ️    - Diagnosis 4: ''
[21:28:49] ℹ️    - Diagnosis 5: ''
[21:28:49] ℹ️    - Diagnosis 6: ''
[21:28:49] ℹ️  Final extracted MRN: ''
[21:28:49] ℹ️  Final extracted Sex: ''
[21:28:49] ℹ️  Final extracted Service Line: 'PT'
[21:28:49] ℹ️  Final extracted Payer Source: ''
[21:28:49] ✅ Patient data extraction completed successfully
[21:28:49] ✅    ✅ Patient data extracted successfully
[21:28:49] 📊 Patient Response
     └─ patientFName: Colm
     └─ patientLName: Mccarthy
     └─ dob: 09/06/1969
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 1376784660
     └─ physicianNPI: 
     └─ nameOfAgency: Alliance Home Care VNA Inc
     └─ address: 277 Pleasant St
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02721
     └─ email: arryc@alliancevna.com
     └─ phoneNumber: (781) 281-1626
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:28:49] ✅    ✅ Patient identified: Colm Mccarthy
[21:28:49] ✅    ✅ Patient name validation passed
[21:28:49] 🔄 
🔄 Step 3: Processing patient dates...
[21:28:49] [DOC: 9201180] ℹ️  DOB normalized: 09/06/1969
[21:28:49] [DOC: 9201180] ℹ️  Episode startOfCare normalized: 03/09/2025
[21:28:49] [DOC: 9201180] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:28:49] [DOC: 9201180] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:28:49] [DOC: 9201180] ✅ Patient date processing completed successfully
[21:28:49] ✅    ✅ Date processing completed
[21:28:49] 📊 Processed Patient Data
     └─ patientFName: Colm
     └─ patientLName: Mccarthy
     └─ dob: 09/06/1969
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 1376784660
     └─ physicianNPI: 
     └─ nameOfAgency: Alliance Home Care VNA Inc
     └─ address: 277 Pleasant St
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02721
     └─ email: arryc@alliancevna.com
     └─ phoneNumber: (781) 281-1626
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:28:49] 🔄 
🔄 Step 4: Extracting order data...
[21:28:51] ℹ️  Order extraction - MRN: ''
[21:28:51] ℹ️  Order extraction - Sex: ''
[21:28:51] ℹ️  Order extraction - Service Line: 'PT'
[21:28:51] ℹ️  Order extraction - Payer Source: ''
[21:28:51] ✅ Order data extraction completed successfully
[21:28:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:28:51] ⚠️  No MRN found in either patient or order data
[21:28:51] ⚠️  Could not determine sex using any available method
[21:28:51] ℹ️  Service line consistent in both sources: 'PT'
[21:28:51] ✅ Patient name cross-validation successful
[21:28:51] ✅    ✅ Data merged successfully
[21:28:52] ✅    ✅ Order data extracted and validated
[21:28:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:29:14] [DOC: 9201180] ℹ️  Patient not found in cache or API: Colm Mccarthy
[21:29:15] [DOC: 9201180] ℹ️  Patient not found, creating new patient via API...
[21:29:15] [DOC: 9201180] ℹ️  Creating patient via API: Colm Mccarthy
[21:29:16] [DOC: 9201180] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:29:16] ❌    ❌ Failed to create patient
[21:29:16] [DOC: 9201180] ℹ️  API push details saved for document 9201180
================================================================================
║                        Processing Document ID: 9201104                         ║
================================================================================
[21:29:16] ℹ️  Agency: Fairhaven HH&H
[21:29:16] ℹ️  Date: 03/25/2025
[21:29:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:29:17] [DOC: 9201104] ❌ Critical failure in get_pdf_text: Invalid response format
[21:29:17] ❌ Failed to extract text for Doc ID 9201104
[21:29:17] [DOC: 9201104] ℹ️  API push details saved for document 9201104
================================================================================
║                        Processing Document ID: 9201090                         ║
================================================================================
[21:29:17] ℹ️  Agency: Fairhaven HH&H
[21:29:17] ℹ️  Date: 03/25/2025
[21:29:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:29:18] [DOC: 9201090] ❌ Critical failure in get_pdf_text: Invalid response format
[21:29:18] ❌ Failed to extract text for Doc ID 9201090
[21:29:18] [DOC: 9201090] ℹ️  API push details saved for document 9201090
================================================================================
║                        Processing Document ID: 9200776                         ║
================================================================================
[21:29:18] ℹ️  Agency: Dartmouth HH
[21:29:18] ℹ️  Date: 03/25/2025
[21:29:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:29:20] [DOC: 9200776] ✅ Text extracted using pdfplumber (1667 chars)
[21:29:20] ✅    ✅ Text extracted using pdfplumber (1667 chars)
[21:29:20] 🔄 
🔄 Step 2: Extracting patient data...
[21:29:23] ℹ️  AI extracted raw sex value: 'F'
[21:29:23] ℹ️  AI extracted service line: 'RN, LPN'
[21:29:23] ℹ️  AI extracted payer source: 'Medicare'
[21:29:23] ℹ️  AI extracted diagnoses:
[21:29:23] ℹ️    - Diagnosis 1: ''
[21:29:23] ℹ️    - Diagnosis 2: ''
[21:29:23] ℹ️    - Diagnosis 3: ''
[21:29:23] ℹ️    - Diagnosis 4: ''
[21:29:23] ℹ️    - Diagnosis 5: ''
[21:29:23] ℹ️    - Diagnosis 6: ''
[21:29:23] ℹ️  Final extracted MRN: '5094015'
[21:29:23] ℹ️  Final extracted Sex: 'FEMALE'
[21:29:23] ℹ️  Final extracted Service Line: 'RN, LPN'
[21:29:23] ℹ️  Final extracted Payer Source: 'Medicare'
[21:29:23] ✅ Patient data extraction completed successfully
[21:29:23] ✅    ✅ Patient data extracted successfully
[21:29:23] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:29:23] ✅    ✅ Patient identified: Laura Gregoire
[21:29:23] ✅    ✅ Patient name validation passed
[21:29:23] 🔄 
🔄 Step 3: Processing patient dates...
[21:29:23] [DOC: 9200776] ℹ️  DOB normalized: 12/06/1944
[21:29:23] [DOC: 9200776] ℹ️  Episode startOfCare normalized: 08/26/2024
[21:29:23] [DOC: 9200776] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[21:29:23] [DOC: 9200776] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[21:29:23] [DOC: 9200776] ✅ Patient date processing completed successfully
[21:29:23] ✅    ✅ Date processing completed
[21:29:23] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:29:23] 🔄 
🔄 Step 4: Extracting order data...
[21:29:25] ℹ️  Order extraction - MRN: ''
[21:29:25] ℹ️  Order extraction - Sex: 'FEMALE'
[21:29:25] ℹ️  Order extraction - Service Line: 'RN, LPN'
[21:29:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:29:25] ✅ Order data extraction completed successfully
[21:29:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:29:25] ℹ️  Using MRN from patient data: '5094015'
[21:29:25] ℹ️  Service line consistent in both sources: 'RN, LPN'
[21:29:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:29:25] ✅ Patient name cross-validation successful
[21:29:25] ✅    ✅ Data merged successfully
[21:29:26] ✅    ✅ Order data extracted and validated
[21:29:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:29:26] [DOC: 9200776] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[21:29:26] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[21:29:26] 🔄 
🔄 Step 6: Pushing order to API...
[21:29:26] [DOC: 9200776] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[21:29:28] [DOC: 9200776] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:29:28] ❌    ❌ Failed to push order
[21:29:28] 🔄 
🔄 Step 7: Writing to CSV...
[21:29:28] [DOC: 9200776] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[21:29:28] [DOC: 9200776] ℹ️  Service Line extracted: 'RN, LPN'
[21:29:28] [DOC: 9200776] ℹ️  Payer Source extracted: 'Medicare'
[21:29:28] [DOC: 9200776] ℹ️  Diagnosis codes being written:
[21:29:28] [DOC: 9200776] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:29:28] [DOC: 9200776] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:29:28] [DOC: 9200776] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:29:28] [DOC: 9200776] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:29:28] [DOC: 9200776] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:29:28] [DOC: 9200776] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:29:28] [DOC: 9200776] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: RN, LPN | Payer: Medicare | MRN: 5094015
[21:29:28] ✅    ✅ Document 9200776 processed and saved successfully
[21:29:28] 🔄 
🔄 Step 8: Saving API details...
[21:29:28] [DOC: 9200776] ℹ️  API push details saved for document 9200776
[21:29:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200769                         ║
================================================================================
[21:29:28] ℹ️  Agency: Dartmouth HH
[21:29:28] ℹ️  Date: 03/25/2025
[21:29:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:29:32] [DOC: 9200769] ✅ Text extracted using pdfplumber (10860 chars)
[21:29:32] ✅    ✅ Text extracted using pdfplumber (10848 chars)
[21:29:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:29:35] ℹ️  AI extracted raw sex value: 'F'
[21:29:35] ℹ️  AI extracted service line: 'PT, HCA'
[21:29:35] ℹ️  AI extracted payer source: ''
[21:29:35] ℹ️  AI extracted diagnoses:
[21:29:35] ℹ️    - Diagnosis 1: 'J44.89'
[21:29:35] ℹ️    - Diagnosis 2: 'J45.50'
[21:29:35] ℹ️    - Diagnosis 3: 'M54.50'
[21:29:35] ℹ️    - Diagnosis 4: 'E11.9'
[21:29:35] ℹ️    - Diagnosis 5: 'F41.9'
[21:29:35] ℹ️    - Diagnosis 6: 'M19.90'
[21:29:35] ℹ️  Final extracted MRN: '227027'
[21:29:35] ℹ️  Final extracted Sex: 'FEMALE'
[21:29:35] ℹ️  Final extracted Service Line: 'PT, HCA'
[21:29:35] ℹ️  Final extracted Payer Source: ''
[21:29:35] ✅ Patient data extraction completed successfully
[21:29:35] ✅    ✅ Patient data extracted successfully
[21:29:35] 📊 Patient Response
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, HCA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'J44.89', 'secondDiagnosis': 'J45.50', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'M19.90'}]
[21:29:35] ✅    ✅ Patient identified: Lisa Pavao
[21:29:35] ✅    ✅ Patient name validation passed
[21:29:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:29:35] [DOC: 9200769] ℹ️  DOB normalized: 06/09/1966
[21:29:35] [DOC: 9200769] ℹ️  Episode startOfCare normalized: 01/06/2025
[21:29:35] [DOC: 9200769] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[21:29:35] [DOC: 9200769] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[21:29:35] [DOC: 9200769] ✅ Patient date processing completed successfully
[21:29:35] ✅    ✅ Date processing completed
[21:29:35] 📊 Processed Patient Data
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, HCA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'J44.89', 'secondDiagnosis': 'J45.50', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'M19.90'}]
[21:29:35] 🔄 
🔄 Step 4: Extracting order data...
[21:29:38] ℹ️  Order extraction - MRN: '227027'
[21:29:38] ℹ️  Order extraction - Sex: 'FEMALE'
[21:29:38] ℹ️  Order extraction - Service Line: 'PT, HCA'
[21:29:38] ℹ️  Order extraction - Payer Source: ''
[21:29:38] ✅ Order data extraction completed successfully
[21:29:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:29:38] ℹ️  Using MRN from patient data: '227027' over '227027'
[21:29:38] ℹ️  Service line consistent in both sources: 'PT, HCA'
[21:29:38] ✅ Patient name cross-validation successful
[21:29:38] ✅    ✅ Data merged successfully
[21:29:39] ✅    ✅ Order data extracted and validated
[21:29:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:29:39] [DOC: 9200769] ✅ Patient found in local cache: Lisa Pavao, ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[21:29:39] ✅    ✅ Existing patient found with ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[21:29:39] 🔄 
🔄 Step 6: Pushing order to API...
[21:29:39] [DOC: 9200769] ℹ️  Pushing order via API for patient ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[21:29:41] [DOC: 9200769] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:29:41] ❌    ❌ Failed to push order
[21:29:41] 🔄 
🔄 Step 7: Writing to CSV...
[21:29:41] [DOC: 9200769] ℹ️  Calculated age: 58 from DOB: 06/09/1966
[21:29:41] [DOC: 9200769] ℹ️  Service Line extracted: 'PT, HCA'
[21:29:41] [DOC: 9200769] ℹ️  Payer Source extracted: ''
[21:29:41] [DOC: 9200769] ℹ️  Diagnosis codes being written:
[21:29:41] [DOC: 9200769] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.89'
[21:29:41] [DOC: 9200769] ℹ️    - Latest_Episode_Seconddiagnosis: 'J45.50'
[21:29:41] [DOC: 9200769] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.50'
[21:29:41] [DOC: 9200769] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[21:29:41] [DOC: 9200769] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[21:29:41] [DOC: 9200769] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M19.90'
[21:29:41] [DOC: 9200769] ✅ Patient data written to CSV: Lisa Pavao | Sex: FEMALE | Age: 58 | Service: PT, HCA | Payer:  | MRN: 227027
[21:29:41] ✅    ✅ Document 9200769 processed and saved successfully
[21:29:41] 🔄 
🔄 Step 8: Saving API details...
[21:29:41] [DOC: 9200769] ℹ️  API push details saved for document 9200769
[21:29:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200761                         ║
================================================================================
[21:29:41] ℹ️  Agency: Dartmouth HH
[21:29:41] ℹ️  Date: 03/25/2025
[21:29:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:29:42] [DOC: 9200761] ✅ Text extracted using pdfplumber (2998 chars)
[21:29:42] ✅    ✅ Text extracted using pdfplumber (2998 chars)
[21:29:42] 🔄 
🔄 Step 2: Extracting patient data...
[21:29:45] ℹ️  AI extracted raw sex value: 'M'
[21:29:45] ℹ️  AI extracted service line: 'PT'
[21:29:45] ℹ️  AI extracted payer source: 'Medicare'
[21:29:45] ℹ️  AI extracted diagnoses:
[21:29:45] ℹ️    - Diagnosis 1: ''
[21:29:45] ℹ️    - Diagnosis 2: ''
[21:29:45] ℹ️    - Diagnosis 3: ''
[21:29:45] ℹ️    - Diagnosis 4: ''
[21:29:45] ℹ️    - Diagnosis 5: ''
[21:29:45] ℹ️    - Diagnosis 6: ''
[21:29:45] ℹ️  Final extracted MRN: '2731011'
[21:29:45] ℹ️  Final extracted Sex: 'MALE'
[21:29:45] ℹ️  Final extracted Service Line: 'PT'
[21:29:45] ℹ️  Final extracted Payer Source: 'Medicare'
[21:29:45] ✅ Patient data extraction completed successfully
[21:29:45] ✅    ✅ Patient data extracted successfully
[21:29:45] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:29:45] ✅    ✅ Patient identified: Paul Penha
[21:29:45] ✅    ✅ Patient name validation passed
[21:29:45] 🔄 
🔄 Step 3: Processing patient dates...
[21:29:45] [DOC: 9200761] ℹ️  DOB normalized: 07/08/1934
[21:29:45] [DOC: 9200761] ℹ️  Episode startOfCare normalized: 02/02/2025
[21:29:45] [DOC: 9200761] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[21:29:45] [DOC: 9200761] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[21:29:45] [DOC: 9200761] ✅ Patient date processing completed successfully
[21:29:45] ✅    ✅ Date processing completed
[21:29:45] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:29:45] 🔄 
🔄 Step 4: Extracting order data...
[21:29:47] ℹ️  Order extraction - MRN: ''
[21:29:47] ℹ️  Order extraction - Sex: 'MALE'
[21:29:47] ℹ️  Order extraction - Service Line: 'PT'
[21:29:47] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:29:47] ✅ Order data extraction completed successfully
[21:29:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:29:47] ℹ️  Using MRN from patient data: '2731011'
[21:29:47] ℹ️  Service line consistent in both sources: 'PT'
[21:29:47] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:29:47] ✅ Patient name cross-validation successful
[21:29:47] ✅    ✅ Data merged successfully
[21:29:49] ✅    ✅ Order data extracted and validated
[21:29:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:29:49] [DOC: 9200761] ✅ Patient found in local cache: Paul Penha, ID: acd1fced-75ff-43a8-8304-4681296c9d26
[21:29:49] ✅    ✅ Existing patient found with ID: acd1fced-75ff-43a8-8304-4681296c9d26
[21:29:49] 🔄 
🔄 Step 6: Pushing order to API...
[21:29:49] [DOC: 9200761] ℹ️  Pushing order via API for patient ID: acd1fced-75ff-43a8-8304-4681296c9d26
[21:29:50] [DOC: 9200761] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:29:50] ❌    ❌ Failed to push order
[21:29:50] 🔄 
🔄 Step 7: Writing to CSV...
[21:29:50] [DOC: 9200761] ℹ️  Calculated age: 90 from DOB: 07/08/1934
[21:29:50] [DOC: 9200761] ℹ️  Service Line extracted: 'PT'
[21:29:50] [DOC: 9200761] ℹ️  Payer Source extracted: 'Medicare'
[21:29:50] [DOC: 9200761] ℹ️  Diagnosis codes being written:
[21:29:50] [DOC: 9200761] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:29:50] [DOC: 9200761] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:29:50] [DOC: 9200761] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:29:50] [DOC: 9200761] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:29:50] [DOC: 9200761] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:29:50] [DOC: 9200761] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:29:50] [DOC: 9200761] ✅ Patient data written to CSV: Paul Penha | Sex: MALE | Age: 90 | Service: PT | Payer: Medicare | MRN: 2731011
[21:29:50] ✅    ✅ Document 9200761 processed and saved successfully
[21:29:50] 🔄 
🔄 Step 8: Saving API details...
[21:29:50] [DOC: 9200761] ℹ️  API push details saved for document 9200761
[21:29:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200759                         ║
================================================================================
[21:29:50] ℹ️  Agency: Dartmouth HH
[21:29:50] ℹ️  Date: 03/25/2025
[21:29:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:29:52] [DOC: 9200759] ✅ Text extracted using pdfplumber (1247 chars)
[21:29:52] ✅    ✅ Text extracted using pdfplumber (1247 chars)
[21:29:52] 🔄 
🔄 Step 2: Extracting patient data...
[21:29:55] ℹ️  AI extracted raw sex value: 'M'
[21:29:55] ℹ️  AI extracted service line: 'RN'
[21:29:55] ℹ️  AI extracted payer source: 'Medicare'
[21:29:55] ℹ️  AI extracted diagnoses:
[21:29:55] ℹ️    - Diagnosis 1: 'None'
[21:29:55] ℹ️    - Diagnosis 2: 'None'
[21:29:55] ℹ️    - Diagnosis 3: 'None'
[21:29:55] ℹ️    - Diagnosis 4: 'None'
[21:29:55] ℹ️    - Diagnosis 5: 'None'
[21:29:55] ℹ️    - Diagnosis 6: 'None'
[21:29:55] ℹ️  Final extracted MRN: '956008'
[21:29:55] ℹ️  Final extracted Sex: 'MALE'
[21:29:55] ℹ️  Final extracted Service Line: 'RN'
[21:29:55] ℹ️  Final extracted Payer Source: 'Medicare'
[21:29:55] ✅ Patient data extraction completed successfully
[21:29:55] ✅    ✅ Patient data extracted successfully
[21:29:55] 📊 Patient Response
     └─ patientFName: Gerald
     └─ patientLName: Ferreira
     └─ dob: 07/12/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 956008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2025', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:29:55] ✅    ✅ Patient identified: Gerald Ferreira
[21:29:55] ✅    ✅ Patient name validation passed
[21:29:55] 🔄 
🔄 Step 3: Processing patient dates...
[21:29:55] [DOC: 9200759] ℹ️  DOB normalized: 07/12/1942
[21:29:55] [DOC: 9200759] ℹ️  Episode startOfCare normalized: 02/24/2025
[21:29:55] [DOC: 9200759] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[21:29:55] [DOC: 9200759] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[21:29:55] [DOC: 9200759] ✅ Patient date processing completed successfully
[21:29:55] ✅    ✅ Date processing completed
[21:29:55] 📊 Processed Patient Data
     └─ patientFName: Gerald
     └─ patientLName: Ferreira
     └─ dob: 07/12/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 956008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2025', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025'}]
[21:29:55] 🔄 
🔄 Step 4: Extracting order data...
[21:29:57] ℹ️  Order extraction - MRN: ''
[21:29:57] ℹ️  Order extraction - Sex: 'MALE'
[21:29:57] ℹ️  Order extraction - Service Line: ''
[21:29:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:29:57] ✅ Order data extraction completed successfully
[21:29:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:29:57] ℹ️  Using MRN from patient data: '956008'
[21:29:57] ℹ️  Using service line from patient data: 'RN'
[21:29:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:29:57] ✅ Patient name cross-validation successful
[21:29:57] ✅    ✅ Data merged successfully
[21:29:58] ✅    ✅ Order data extracted and validated
[21:29:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:29:58] [DOC: 9200759] ✅ Patient found in local cache: Gerald Ferreira, ID: 00478924-474c-4077-836a-7cb43c03a9bc
[21:29:58] ✅    ✅ Existing patient found with ID: 00478924-474c-4077-836a-7cb43c03a9bc
[21:29:58] 🔄 
🔄 Step 6: Pushing order to API...
[21:29:58] [DOC: 9200759] ℹ️  Pushing order via API for patient ID: 00478924-474c-4077-836a-7cb43c03a9bc
[21:30:00] [DOC: 9200759] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13982"}
[21:30:00] ❌    ❌ Failed to push order
[21:30:00] 🔄 
🔄 Step 7: Writing to CSV...
[21:30:00] [DOC: 9200759] ℹ️  Calculated age: 82 from DOB: 07/12/1942
[21:30:00] [DOC: 9200759] ℹ️  Service Line extracted: 'RN'
[21:30:00] [DOC: 9200759] ℹ️  Payer Source extracted: 'Medicare'
[21:30:00] [DOC: 9200759] ℹ️  Diagnosis codes being written:
[21:30:00] [DOC: 9200759] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:30:00] [DOC: 9200759] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:30:00] [DOC: 9200759] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:30:00] [DOC: 9200759] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:30:00] [DOC: 9200759] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:30:00] [DOC: 9200759] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:30:00] [DOC: 9200759] ✅ Patient data written to CSV: Gerald Ferreira | Sex: MALE | Age: 82 | Service: RN | Payer: Medicare | MRN: 956008
[21:30:00] ✅    ✅ Document 9200759 processed and saved successfully
[21:30:00] 🔄 
🔄 Step 8: Saving API details...
[21:30:00] [DOC: 9200759] ℹ️  API push details saved for document 9200759
[21:30:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200754                         ║
================================================================================
[21:30:00] ℹ️  Agency: Dartmouth HH
[21:30:00] ℹ️  Date: 03/25/2025
[21:30:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:30:01] [DOC: 9200754] ✅ Text extracted using pdfplumber (1203 chars)
[21:30:01] ✅    ✅ Text extracted using pdfplumber (1203 chars)
[21:30:01] 🔄 
🔄 Step 2: Extracting patient data...
[21:30:04] ℹ️  AI extracted raw sex value: 'F'
[21:30:04] ℹ️  AI extracted service line: 'RN'
[21:30:04] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[21:30:04] ℹ️  AI extracted diagnoses:
[21:30:04] ℹ️    - Diagnosis 1: 'None'
[21:30:04] ℹ️    - Diagnosis 2: 'None'
[21:30:04] ℹ️    - Diagnosis 3: 'None'
[21:30:04] ℹ️    - Diagnosis 4: 'None'
[21:30:04] ℹ️    - Diagnosis 5: 'None'
[21:30:04] ℹ️    - Diagnosis 6: 'None'
[21:30:04] ℹ️  Final extracted MRN: '6843'
[21:30:04] ℹ️  Final extracted Sex: 'FEMALE'
[21:30:04] ℹ️  Final extracted Service Line: 'RN'
[21:30:04] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[21:30:04] ✅ Patient data extraction completed successfully
[21:30:04] ✅    ✅ Patient data extracted successfully
[21:30:04] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': None, 'endOfEpisode': '04/17/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:30:04] ✅    ✅ Patient identified: Pearl Moura
[21:30:04] ✅    ✅ Patient name validation passed
[21:30:04] 🔄 
🔄 Step 3: Processing patient dates...
[21:30:04] [DOC: 9200754] ℹ️  DOB normalized: 01/29/1930
[21:30:04] [DOC: 9200754] ℹ️  Episode startOfCare normalized: 01/04/2022
[21:30:04] [DOC: 9200754] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[21:30:04] [DOC: 9200754] ✅ Patient date processing completed successfully
[21:30:04] ✅    ✅ Date processing completed
[21:30:04] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'endOfEpisode': '04/17/2025'}]
[21:30:04] 🔄 
🔄 Step 4: Extracting order data...
[21:30:07] ℹ️  Order extraction - MRN: ''
[21:30:07] ℹ️  Order extraction - Sex: 'FEMALE'
[21:30:07] ℹ️  Order extraction - Service Line: ''
[21:30:07] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[21:30:07] ✅ Order data extraction completed successfully
[21:30:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:30:07] ℹ️  Using MRN from patient data: '6843'
[21:30:07] ℹ️  Using service line from patient data: 'RN'
[21:30:07] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[21:30:07] ✅ Patient name cross-validation successful
[21:30:07] ✅    ✅ Data merged successfully
[21:30:08] ✅    ✅ Order data extracted and validated
[21:30:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:30:08] [DOC: 9200754] ✅ Patient found in local cache: Pearl Moura, ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[21:30:08] ✅    ✅ Existing patient found with ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[21:30:08] 🔄 
🔄 Step 6: Pushing order to API...
[21:30:08] [DOC: 9200754] ℹ️  Pushing order via API for patient ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[21:30:09] [DOC: 9200754] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14163"}
[21:30:09] ❌    ❌ Failed to push order
[21:30:09] 🔄 
🔄 Step 7: Writing to CSV...
[21:30:09] [DOC: 9200754] ℹ️  Calculated age: 95 from DOB: 01/29/1930
[21:30:09] [DOC: 9200754] ℹ️  Service Line extracted: 'RN'
[21:30:09] [DOC: 9200754] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[21:30:09] [DOC: 9200754] ℹ️  Diagnosis codes being written:
[21:30:09] [DOC: 9200754] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:30:09] [DOC: 9200754] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:30:09] [DOC: 9200754] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:30:09] [DOC: 9200754] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:30:09] [DOC: 9200754] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:30:09] [DOC: 9200754] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:30:09] [DOC: 9200754] ✅ Patient data written to CSV: Pearl Moura | Sex: FEMALE | Age: 95 | Service: RN | Payer: Aetna- Mcare | MRN: 6843
[21:30:09] ✅    ✅ Document 9200754 processed and saved successfully
[21:30:09] 🔄 
🔄 Step 8: Saving API details...
[21:30:09] [DOC: 9200754] ℹ️  API push details saved for document 9200754
[21:30:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200752                         ║
================================================================================
[21:30:09] ℹ️  Agency: Dartmouth HH
[21:30:09] ℹ️  Date: 03/25/2025
[21:30:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:30:11] [DOC: 9200752] ✅ Text extracted using pdfplumber (1664 chars)
[21:30:11] ✅    ✅ Text extracted using pdfplumber (1664 chars)
[21:30:11] 🔄 
🔄 Step 2: Extracting patient data...
[21:30:14] ℹ️  AI extracted raw sex value: 'F'
[21:30:14] ℹ️  AI extracted service line: 'RN'
[21:30:14] ℹ️  AI extracted payer source: 'Fallon Health'
[21:30:14] ℹ️  AI extracted diagnoses:
[21:30:14] ℹ️    - Diagnosis 1: ''
[21:30:14] ℹ️    - Diagnosis 2: ''
[21:30:14] ℹ️    - Diagnosis 3: ''
[21:30:14] ℹ️    - Diagnosis 4: ''
[21:30:14] ℹ️    - Diagnosis 5: ''
[21:30:14] ℹ️    - Diagnosis 6: ''
[21:30:14] ℹ️  Final extracted MRN: '4034011'
[21:30:14] ℹ️  Final extracted Sex: 'FEMALE'
[21:30:14] ℹ️  Final extracted Service Line: 'RN'
[21:30:14] ℹ️  Final extracted Payer Source: 'Fallon Health'
[21:30:14] ✅ Patient data extraction completed successfully
[21:30:14] ✅    ✅ Patient data extracted successfully
[21:30:14] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:30:14] ✅    ✅ Patient identified: Joan Swift
[21:30:14] ✅    ✅ Patient name validation passed
[21:30:14] 🔄 
🔄 Step 3: Processing patient dates...
[21:30:14] [DOC: 9200752] ℹ️  DOB normalized: 05/05/1943
[21:30:14] [DOC: 9200752] ℹ️  Episode startOfCare normalized: 01/08/2025
[21:30:14] [DOC: 9200752] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:30:14] [DOC: 9200752] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:30:14] [DOC: 9200752] ✅ Patient date processing completed successfully
[21:30:14] ✅    ✅ Date processing completed
[21:30:14] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:30:14] 🔄 
🔄 Step 4: Extracting order data...
[21:30:16] ℹ️  Order extraction - MRN: ''
[21:30:16] ℹ️  Order extraction - Sex: 'FEMALE'
[21:30:16] ℹ️  Order extraction - Service Line: 'RN'
[21:30:16] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[21:30:16] ✅ Order data extraction completed successfully
[21:30:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:30:16] ℹ️  Using MRN from patient data: '4034011'
[21:30:16] ℹ️  Service line consistent in both sources: 'RN'
[21:30:16] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[21:30:16] ✅ Patient name cross-validation successful
[21:30:16] ✅    ✅ Data merged successfully
[21:30:17] ✅    ✅ Order data extracted and validated
[21:30:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:30:17] [DOC: 9200752] ✅ Patient found in local cache: Joan Swift, ID: e83d8c65-60ef-4130-a086-35a05793cc68
[21:30:17] ✅    ✅ Existing patient found with ID: e83d8c65-60ef-4130-a086-35a05793cc68
[21:30:17] 🔄 
🔄 Step 6: Pushing order to API...
[21:30:17] [DOC: 9200752] ℹ️  Pushing order via API for patient ID: e83d8c65-60ef-4130-a086-35a05793cc68
[21:30:18] [DOC: 9200752] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14468"}
[21:30:18] ❌    ❌ Failed to push order
[21:30:18] 🔄 
🔄 Step 7: Writing to CSV...
[21:30:18] [DOC: 9200752] ℹ️  Calculated age: 82 from DOB: 05/05/1943
[21:30:18] [DOC: 9200752] ℹ️  Service Line extracted: 'RN'
[21:30:18] [DOC: 9200752] ℹ️  Payer Source extracted: 'Fallon Health'
[21:30:18] [DOC: 9200752] ℹ️  Diagnosis codes being written:
[21:30:18] [DOC: 9200752] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:30:18] [DOC: 9200752] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:30:18] [DOC: 9200752] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:30:18] [DOC: 9200752] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:30:18] [DOC: 9200752] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:30:18] [DOC: 9200752] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:30:18] [DOC: 9200752] ✅ Patient data written to CSV: Joan Swift | Sex: FEMALE | Age: 82 | Service: RN | Payer: Fallon Health | MRN: 4034011
[21:30:18] ✅    ✅ Document 9200752 processed and saved successfully
[21:30:18] 🔄 
🔄 Step 8: Saving API details...
[21:30:18] [DOC: 9200752] ℹ️  API push details saved for document 9200752
[21:30:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200748                         ║
================================================================================
[21:30:18] ℹ️  Agency: Dartmouth HH
[21:30:18] ℹ️  Date: 03/25/2025
[21:30:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:30:21] [DOC: 9200748] ✅ Text extracted using pdfplumber (1195 chars)
[21:30:21] ✅    ✅ Text extracted using pdfplumber (1195 chars)
[21:30:21] 🔄 
🔄 Step 2: Extracting patient data...
[21:30:24] ℹ️  AI extracted raw sex value: 'F'
[21:30:24] ℹ️  AI extracted service line: 'RN'
[21:30:24] ℹ️  AI extracted payer source: 'Medicare'
[21:30:24] ℹ️  AI extracted diagnoses:
[21:30:24] ℹ️    - Diagnosis 1: ''
[21:30:24] ℹ️    - Diagnosis 2: ''
[21:30:24] ℹ️    - Diagnosis 3: ''
[21:30:24] ℹ️    - Diagnosis 4: ''
[21:30:24] ℹ️    - Diagnosis 5: ''
[21:30:24] ℹ️    - Diagnosis 6: ''
[21:30:24] ℹ️  Final extracted MRN: '5939015'
[21:30:24] ℹ️  Final extracted Sex: 'FEMALE'
[21:30:24] ℹ️  Final extracted Service Line: 'RN'
[21:30:24] ℹ️  Final extracted Payer Source: 'Medicare'
[21:30:24] ✅ Patient data extraction completed successfully
[21:30:24] ✅    ✅ Patient data extracted successfully
[21:30:24] 📊 Patient Response
     └─ patientFName: Darlene
     └─ patientLName: Tremblay
     └─ dob: 09/07/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5939015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 179 State Street Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:30:24] ✅    ✅ Patient identified: Darlene Tremblay
[21:30:24] ✅    ✅ Patient name validation passed
[21:30:24] 🔄 
🔄 Step 3: Processing patient dates...
[21:30:24] [DOC: 9200748] ℹ️  DOB normalized: 09/07/1955
[21:30:24] [DOC: 9200748] ℹ️  Episode startOfCare normalized: 01/30/2025
[21:30:24] [DOC: 9200748] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[21:30:24] [DOC: 9200748] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[21:30:24] [DOC: 9200748] ✅ Patient date processing completed successfully
[21:30:24] ✅    ✅ Date processing completed
[21:30:24] 📊 Processed Patient Data
     └─ patientFName: Darlene
     └─ patientLName: Tremblay
     └─ dob: 09/07/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5939015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 179 State Street Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:30:24] 🔄 
🔄 Step 4: Extracting order data...
[21:30:26] ℹ️  Order extraction - MRN: ''
[21:30:26] ℹ️  Order extraction - Sex: 'FEMALE'
[21:30:26] ℹ️  Order extraction - Service Line: ''
[21:30:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:30:26] ✅ Order data extraction completed successfully
[21:30:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:30:26] ℹ️  Using MRN from patient data: '5939015'
[21:30:26] ℹ️  Using service line from patient data: 'RN'
[21:30:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:30:26] ✅ Patient name cross-validation successful
[21:30:26] ✅    ✅ Data merged successfully
[21:30:27] ✅    ✅ Order data extracted and validated
[21:30:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:30:27] [DOC: 9200748] ✅ Patient found in local cache: Darlene Tremblay, ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[21:30:27] ✅    ✅ Existing patient found with ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[21:30:27] 🔄 
🔄 Step 6: Pushing order to API...
[21:30:27] [DOC: 9200748] ℹ️  Pushing order via API for patient ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[21:30:28] [DOC: 9200748] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:30:28] ❌    ❌ Failed to push order
[21:30:28] 🔄 
🔄 Step 7: Writing to CSV...
[21:30:28] [DOC: 9200748] ℹ️  Calculated age: 69 from DOB: 09/07/1955
[21:30:28] [DOC: 9200748] ℹ️  Service Line extracted: 'RN'
[21:30:28] [DOC: 9200748] ℹ️  Payer Source extracted: 'Medicare'
[21:30:28] [DOC: 9200748] ℹ️  Diagnosis codes being written:
[21:30:28] [DOC: 9200748] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:30:28] [DOC: 9200748] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:30:28] [DOC: 9200748] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:30:28] [DOC: 9200748] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:30:28] [DOC: 9200748] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:30:28] [DOC: 9200748] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:30:28] [DOC: 9200748] ✅ Patient data written to CSV: Darlene Tremblay | Sex: FEMALE | Age: 69 | Service: RN | Payer: Medicare | MRN: 5939015
[21:30:28] ✅    ✅ Document 9200748 processed and saved successfully
[21:30:28] 🔄 
🔄 Step 8: Saving API details...
[21:30:28] [DOC: 9200748] ℹ️  API push details saved for document 9200748
[21:30:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200743                         ║
================================================================================
[21:30:28] ℹ️  Agency: Dartmouth HH
[21:30:28] ℹ️  Date: 03/25/2025
[21:30:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:30:37] [DOC: 9200743] ✅ Text extracted using pdfplumber (12029 chars)
[21:30:37] ✅    ✅ Text extracted using pdfplumber (12017 chars)
[21:30:37] 🔄 
🔄 Step 2: Extracting patient data...
[21:30:40] ℹ️  AI extracted raw sex value: 'F'
[21:30:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:30:40] ℹ️  AI extracted payer source: ''
[21:30:40] ℹ️  AI extracted diagnoses:
[21:30:40] ℹ️    - Diagnosis 1: 'J44.9'
[21:30:40] ℹ️    - Diagnosis 2: 'I89.0'
[21:30:40] ℹ️    - Diagnosis 3: 'I10'
[21:30:40] ℹ️    - Diagnosis 4: 'R09.02'
[21:30:40] ℹ️    - Diagnosis 5: 'M15.9'
[21:30:40] ℹ️    - Diagnosis 6: 'E03.9'
[21:30:40] ℹ️  Final extracted MRN: '5240015'
[21:30:40] ℹ️  Final extracted Sex: 'FEMALE'
[21:30:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:30:40] ℹ️  Final extracted Payer Source: ''
[21:30:40] ✅ Patient data extraction completed successfully
[21:30:40] ✅    ✅ Patient data extracted successfully
[21:30:40] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'R09.02', 'fifthDiagnosis': 'M15.9', 'sixthDiagnosis': 'E03.9'}]
[21:30:40] ✅    ✅ Patient identified: Donna Cabral
[21:30:40] ✅    ✅ Patient name validation passed
[21:30:40] 🔄 
🔄 Step 3: Processing patient dates...
[21:30:40] [DOC: 9200743] ℹ️  DOB normalized: 10/03/1947
[21:30:40] [DOC: 9200743] ℹ️  Episode startOfCare normalized: 09/18/2024
[21:30:40] [DOC: 9200743] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[21:30:40] [DOC: 9200743] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[21:30:40] [DOC: 9200743] ✅ Patient date processing completed successfully
[21:30:40] ✅    ✅ Date processing completed
[21:30:40] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'R09.02', 'fifthDiagnosis': 'M15.9', 'sixthDiagnosis': 'E03.9'}]
[21:30:40] 🔄 
🔄 Step 4: Extracting order data...
[21:30:42] ℹ️  Order extraction - MRN: '5240015'
[21:30:42] ℹ️  Order extraction - Sex: 'FEMALE'
[21:30:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:30:42] ℹ️  Order extraction - Payer Source: ''
[21:30:42] ✅ Order data extraction completed successfully
[21:30:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:30:42] ℹ️  Using MRN from patient data: '5240015' over '5240015'
[21:30:42] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[21:30:42] ✅ Patient name cross-validation successful
[21:30:42] ✅    ✅ Data merged successfully
[21:30:44] ✅    ✅ Order data extracted and validated
[21:30:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:30:44] [DOC: 9200743] ✅ Patient found in local cache: Donna Cabral, ID: 79190189-814f-4114-a438-904080ae2281
[21:30:44] ✅    ✅ Existing patient found with ID: 79190189-814f-4114-a438-904080ae2281
[21:30:44] 🔄 
🔄 Step 6: Pushing order to API...
[21:30:44] [DOC: 9200743] ℹ️  Pushing order via API for patient ID: 79190189-814f-4114-a438-904080ae2281
[21:30:45] [DOC: 9200743] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:30:45] ❌    ❌ Failed to push order
[21:30:45] 🔄 
🔄 Step 7: Writing to CSV...
[21:30:45] [DOC: 9200743] ℹ️  Calculated age: 77 from DOB: 10/03/1947
[21:30:45] [DOC: 9200743] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[21:30:45] [DOC: 9200743] ℹ️  Payer Source extracted: ''
[21:30:45] [DOC: 9200743] ℹ️  Diagnosis codes being written:
[21:30:45] [DOC: 9200743] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[21:30:45] [DOC: 9200743] ℹ️    - Latest_Episode_Seconddiagnosis: 'I89.0'
[21:30:45] [DOC: 9200743] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:30:45] [DOC: 9200743] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R09.02'
[21:30:45] [DOC: 9200743] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M15.9'
[21:30:45] [DOC: 9200743] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E03.9'
[21:30:45] [DOC: 9200743] ✅ Patient data written to CSV: Donna Cabral | Sex: FEMALE | Age: 77 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 5240015
[21:30:45] ✅    ✅ Document 9200743 processed and saved successfully
[21:30:45] 🔄 
🔄 Step 8: Saving API details...
[21:30:45] [DOC: 9200743] ℹ️  API push details saved for document 9200743
[21:30:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200715                         ║
================================================================================
[21:30:45] ℹ️  Agency: Dartmouth HH
[21:30:45] ℹ️  Date: 03/25/2025
[21:30:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:30:47] [DOC: 9200715] ✅ Text extracted using pdfplumber (6872 chars)
[21:30:47] ✅    ✅ Text extracted using pdfplumber (6872 chars)
[21:30:47] 🔄 
🔄 Step 2: Extracting patient data...
[21:30:50] ℹ️  AI extracted raw sex value: 'F'
[21:30:50] ℹ️  AI extracted service line: 'PT, OT'
[21:30:50] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[21:30:50] ℹ️  AI extracted diagnoses:
[21:30:50] ℹ️    - Diagnosis 1: 'None'
[21:30:50] ℹ️    - Diagnosis 2: 'None'
[21:30:50] ℹ️    - Diagnosis 3: 'None'
[21:30:50] ℹ️    - Diagnosis 4: 'None'
[21:30:50] ℹ️    - Diagnosis 5: 'None'
[21:30:50] ℹ️    - Diagnosis 6: 'None'
[21:30:50] ℹ️  Final extracted MRN: '6066015'
[21:30:50] ℹ️  Final extracted Sex: 'FEMALE'
[21:30:50] ℹ️  Final extracted Service Line: 'PT, OT'
[21:30:50] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[21:30:50] ✅ Patient data extraction completed successfully
[21:30:50] ✅    ✅ Patient data extracted successfully
[21:30:50] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:30:50] ✅    ✅ Patient identified: Lois Fernandes
[21:30:50] ✅    ✅ Patient name validation passed
[21:30:50] 🔄 
🔄 Step 3: Processing patient dates...
[21:30:50] [DOC: 9200715] ℹ️  DOB normalized: 05/15/1941
[21:30:50] [DOC: 9200715] ℹ️  Episode startOfCare normalized: 02/22/2025
[21:30:50] [DOC: 9200715] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[21:30:50] [DOC: 9200715] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[21:30:50] [DOC: 9200715] ✅ Patient date processing completed successfully
[21:30:50] ✅    ✅ Date processing completed
[21:30:50] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025'}]
[21:30:50] 🔄 
🔄 Step 4: Extracting order data...
[21:30:52] ℹ️  Order extraction - MRN: ''
[21:30:52] ℹ️  Order extraction - Sex: 'FEMALE'
[21:30:52] ℹ️  Order extraction - Service Line: 'PT, OT'
[21:30:52] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[21:30:52] ✅ Order data extraction completed successfully
[21:30:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:30:52] ℹ️  Using MRN from patient data: '6066015'
[21:30:52] ℹ️  Service line consistent in both sources: 'PT, OT'
[21:30:52] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[21:30:52] ✅ Patient name cross-validation successful
[21:30:52] ✅    ✅ Data merged successfully
[21:30:54] ✅    ✅ Order data extracted and validated
[21:30:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:30:54] [DOC: 9200715] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[21:30:54] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[21:30:54] 🔄 
🔄 Step 6: Pushing order to API...
[21:30:54] [DOC: 9200715] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[21:30:56] [DOC: 9200715] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:30:56] ❌    ❌ Failed to push order
[21:30:56] 🔄 
🔄 Step 7: Writing to CSV...
[21:30:56] [DOC: 9200715] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[21:30:56] [DOC: 9200715] ℹ️  Service Line extracted: 'PT, OT'
[21:30:56] [DOC: 9200715] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[21:30:56] [DOC: 9200715] ℹ️  Diagnosis codes being written:
[21:30:56] [DOC: 9200715] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:30:56] [DOC: 9200715] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:30:56] [DOC: 9200715] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:30:56] [DOC: 9200715] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:30:56] [DOC: 9200715] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:30:56] [DOC: 9200715] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:30:56] [DOC: 9200715] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: PT, OT | Payer: Blue Cross Medicare Adv | MRN: 6066015
[21:30:56] ✅    ✅ Document 9200715 processed and saved successfully
[21:30:56] 🔄 
🔄 Step 8: Saving API details...
[21:30:56] [DOC: 9200715] ℹ️  API push details saved for document 9200715
[21:30:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200549                         ║
================================================================================
[21:30:56] ℹ️  Agency: Fairhaven HH&H
[21:30:56] ℹ️  Date: 03/25/2025
[21:30:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:30:57] [DOC: 9200549] ❌ Critical failure in get_pdf_text: Invalid response format
[21:30:57] ❌ Failed to extract text for Doc ID 9200549
[21:30:57] [DOC: 9200549] ℹ️  API push details saved for document 9200549
================================================================================
║                        Processing Document ID: 9199459                         ║
================================================================================
[21:30:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:30:57] ℹ️  Date: 03/24/2025
[21:30:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:31:00] [DOC: 9199459] ✅ Text extracted using pdfplumber (11356 chars)
[21:31:00] ✅    ✅ Text extracted using pdfplumber (11356 chars)
[21:31:00] 🔄 
🔄 Step 2: Extracting patient data...
[21:31:03] ℹ️  AI extracted raw sex value: 'M'
[21:31:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:31:03] ℹ️  AI extracted payer source: 'SWH'
[21:31:03] ℹ️  AI extracted diagnoses:
[21:31:03] ℹ️    - Diagnosis 1: 'E11.65'
[21:31:03] ℹ️    - Diagnosis 2: 'I10'
[21:31:03] ℹ️    - Diagnosis 3: 'M54.50'
[21:31:03] ℹ️    - Diagnosis 4: 'F41.9'
[21:31:03] ℹ️    - Diagnosis 5: 'Z79.84'
[21:31:03] ℹ️    - Diagnosis 6: 'None'
[21:31:03] ℹ️  Final extracted MRN: '100994870'
[21:31:03] ℹ️  Final extracted Sex: 'MALE'
[21:31:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:31:03] ℹ️  Final extracted Payer Source: 'SWH'
[21:31:03] ✅ Patient data extraction completed successfully
[21:31:03] ✅    ✅ Patient data extracted successfully
[21:31:03] 📊 Patient Response
     └─ patientFName: Ismael
     └─ patientLName: Diaz
     └─ dob: 08/16/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 100994870
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 151 Rockway St, #D
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 762-7069
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '06/22/2018', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'Z79.84', 'sixthDiagnosis': None}]
[21:31:03] ✅    ✅ Patient identified: Ismael Diaz
[21:31:03] ✅    ✅ Patient name validation passed
[21:31:03] 🔄 
🔄 Step 3: Processing patient dates...
[21:31:03] [DOC: 9199459] ℹ️  DOB normalized: 08/16/1938
[21:31:03] [DOC: 9199459] ℹ️  Episode startOfCare normalized: 06/22/2018
[21:31:03] [DOC: 9199459] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[21:31:03] [DOC: 9199459] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[21:31:03] [DOC: 9199459] ✅ Patient date processing completed successfully
[21:31:03] ✅    ✅ Date processing completed
[21:31:03] 📊 Processed Patient Data
     └─ patientFName: Ismael
     └─ patientLName: Diaz
     └─ dob: 08/16/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 100994870
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 151 Rockway St, #D
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 762-7069
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '06/22/2018', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'Z79.84'}]
[21:31:03] 🔄 
🔄 Step 4: Extracting order data...
[21:31:06] ℹ️  Order extraction - MRN: '100994870'
[21:31:06] ℹ️  Order extraction - Sex: 'MALE'
[21:31:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:31:06] ℹ️  Order extraction - Payer Source: 'SWH'
[21:31:06] ✅ Order data extraction completed successfully
[21:31:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:31:06] ℹ️  Using MRN from patient data: '100994870' over '100994870'
[21:31:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:31:06] ℹ️  Payer source consistent in both sources: 'SWH'
[21:31:06] ✅ Patient name cross-validation successful
[21:31:06] ✅    ✅ Data merged successfully
[21:31:07] ✅    ✅ Order data extracted and validated
[21:31:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:31:07] [DOC: 9199459] ✅ Patient found in local cache: Ismael Diaz, ID: ad826fad-cf4a-4cdb-853f-b093f8c3b547
[21:31:07] ✅    ✅ Existing patient found with ID: ad826fad-cf4a-4cdb-853f-b093f8c3b547
[21:31:07] 🔄 
🔄 Step 6: Pushing order to API...
[21:31:07] [DOC: 9199459] ℹ️  Pushing order via API for patient ID: ad826fad-cf4a-4cdb-853f-b093f8c3b547
[21:31:08] [DOC: 9199459] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13860"}
[21:31:08] ❌    ❌ Failed to push order
[21:31:08] 🔄 
🔄 Step 7: Writing to CSV...
[21:31:08] [DOC: 9199459] ℹ️  Calculated age: 86 from DOB: 08/16/1938
[21:31:08] [DOC: 9199459] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:31:08] [DOC: 9199459] ℹ️  Payer Source extracted: 'SWH'
[21:31:08] [DOC: 9199459] ℹ️  Diagnosis codes being written:
[21:31:08] [DOC: 9199459] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[21:31:08] [DOC: 9199459] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[21:31:08] [DOC: 9199459] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.50'
[21:31:08] [DOC: 9199459] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.9'
[21:31:08] [DOC: 9199459] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z79.84'
[21:31:08] [DOC: 9199459] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:31:08] [DOC: 9199459] ✅ Patient data written to CSV: Ismael Diaz | Sex: MALE | Age: 86 | Service: Skilled Nursing | Payer: SWH | MRN: 100994870
[21:31:08] ✅    ✅ Document 9199459 processed and saved successfully
[21:31:08] 🔄 
🔄 Step 8: Saving API details...
[21:31:08] [DOC: 9199459] ℹ️  API push details saved for document 9199459
[21:31:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199448                         ║
================================================================================
[21:31:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:31:08] ℹ️  Date: 03/24/2025
[21:31:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:31:11] [DOC: 9199448] ✅ Text extracted using pdfplumber (1768 chars)
[21:31:11] ✅    ✅ Text extracted using pdfplumber (1768 chars)
[21:31:11] 🔄 
🔄 Step 2: Extracting patient data...
[21:31:14] ℹ️  AI extracted raw sex value: ''
[21:31:14] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:31:14] ℹ️  AI extracted payer source: ''
[21:31:14] ℹ️  AI extracted diagnoses:
[21:31:14] ℹ️    - Diagnosis 1: 'J10.00'
[21:31:14] ℹ️    - Diagnosis 2: 'E11.59'
[21:31:14] ℹ️    - Diagnosis 3: 'I15.2'
[21:31:14] ℹ️    - Diagnosis 4: 'None'
[21:31:14] ℹ️    - Diagnosis 5: 'None'
[21:31:14] ℹ️    - Diagnosis 6: 'None'
[21:31:14] ℹ️  Final extracted MRN: 'MA250110074701'
[21:31:14] ℹ️  Final extracted Sex: ''
[21:31:14] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:31:14] ℹ️  Final extracted Payer Source: ''
[21:31:14] ✅ Patient data extraction completed successfully
[21:31:14] ✅    ✅ Patient data extracted successfully
[21:31:14] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:31:14] ✅    ✅ Patient identified: Gloria Couto
[21:31:14] ✅    ✅ Patient name validation passed
[21:31:14] 🔄 
🔄 Step 3: Processing patient dates...
[21:31:14] [DOC: 9199448] ℹ️  DOB normalized: 07/30/1947
[21:31:14] [DOC: 9199448] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[21:31:14] [DOC: 9199448] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[21:31:14] [DOC: 9199448] ✅ Patient date processing completed successfully
[21:31:14] ✅    ✅ Date processing completed
[21:31:14] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2'}]
[21:31:14] 🔄 
🔄 Step 4: Extracting order data...
[21:31:17] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:31:17] ℹ️  Order extraction - Sex: ''
[21:31:17] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:31:17] ℹ️  Order extraction - Payer Source: ''
[21:31:17] ✅ Order data extraction completed successfully
[21:31:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:31:17] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:31:17] ⚠️  Could not determine sex using any available method
[21:31:17] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:31:17] ✅ Patient name cross-validation successful
[21:31:17] ✅    ✅ Data merged successfully
[21:31:18] ✅    ✅ Order data extracted and validated
[21:31:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:31:18] [DOC: 9199448] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:18] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:18] 🔄 
🔄 Step 6: Pushing order to API...
[21:31:18] [DOC: 9199448] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:19] [DOC: 9199448] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13738"}
[21:31:19] ❌    ❌ Failed to push order
[21:31:19] 🔄 
🔄 Step 7: Writing to CSV...
[21:31:19] [DOC: 9199448] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:31:19] [DOC: 9199448] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:31:19] [DOC: 9199448] ℹ️  Payer Source extracted: ''
[21:31:19] [DOC: 9199448] ℹ️  Diagnosis codes being written:
[21:31:19] [DOC: 9199448] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[21:31:19] [DOC: 9199448] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.59'
[21:31:19] [DOC: 9199448] ℹ️    - Latest_Episode_Thirddiagnosis: 'I15.2'
[21:31:19] [DOC: 9199448] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:31:19] [DOC: 9199448] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:31:19] [DOC: 9199448] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:31:19] [DOC: 9199448] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[21:31:19] ✅    ✅ Document 9199448 processed and saved successfully
[21:31:19] 🔄 
🔄 Step 8: Saving API details...
[21:31:19] [DOC: 9199448] ℹ️  API push details saved for document 9199448
[21:31:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199446                         ║
================================================================================
[21:31:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:31:19] ℹ️  Date: 03/24/2025
[21:31:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:31:22] [DOC: 9199446] ✅ Text extracted using pdfplumber (12800 chars)
[21:31:22] ✅    ✅ Text extracted using pdfplumber (12800 chars)
[21:31:22] 🔄 
🔄 Step 2: Extracting patient data...
[21:31:25] ℹ️  AI extracted raw sex value: 'F'
[21:31:25] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[21:31:25] ℹ️  AI extracted payer source: 'Medicare'
[21:31:25] ℹ️  AI extracted diagnoses:
[21:31:25] ℹ️    - Diagnosis 1: 'J10.00'
[21:31:25] ℹ️    - Diagnosis 2: 'E11.59'
[21:31:25] ℹ️    - Diagnosis 3: 'I15.2'
[21:31:25] ℹ️    - Diagnosis 4: 'E11.69'
[21:31:25] ℹ️    - Diagnosis 5: 'E78.5'
[21:31:25] ℹ️    - Diagnosis 6: 'F41.9'
[21:31:25] ℹ️  Final extracted MRN: 'MA250110074701'
[21:31:25] ℹ️  Final extracted Sex: 'FEMALE'
[21:31:25] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[21:31:25] ℹ️  Final extracted Payer Source: 'Medicare'
[21:31:25] ✅ Patient data extraction completed successfully
[21:31:25] ✅    ✅ Patient data extracted successfully
[21:31:25] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[21:31:25] ✅    ✅ Patient identified: Gloria Couto
[21:31:25] ✅    ✅ Patient name validation passed
[21:31:25] 🔄 
🔄 Step 3: Processing patient dates...
[21:31:25] [DOC: 9199446] ℹ️  DOB normalized: 07/30/1947
[21:31:25] [DOC: 9199446] ℹ️  Episode startOfCare normalized: 01/14/2025
[21:31:25] [DOC: 9199446] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[21:31:25] [DOC: 9199446] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[21:31:25] [DOC: 9199446] ✅ Patient date processing completed successfully
[21:31:25] ✅    ✅ Date processing completed
[21:31:25] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[21:31:25] 🔄 
🔄 Step 4: Extracting order data...
[21:31:28] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:31:28] ℹ️  Order extraction - Sex: 'FEMALE'
[21:31:28] ℹ️  Order extraction - Service Line: 'PT, OT'
[21:31:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:31:28] ✅ Order data extraction completed successfully
[21:31:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:31:28] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:31:28] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[21:31:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:31:28] ✅ Patient name cross-validation successful
[21:31:28] ✅    ✅ Data merged successfully
[21:31:29] ✅    ✅ Order data extracted and validated
[21:31:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:31:29] [DOC: 9199446] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:29] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:29] 🔄 
🔄 Step 6: Pushing order to API...
[21:31:29] [DOC: 9199446] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:30] [DOC: 9199446] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13739"}
[21:31:30] ❌    ❌ Failed to push order
[21:31:30] 🔄 
🔄 Step 7: Writing to CSV...
[21:31:30] [DOC: 9199446] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:31:30] [DOC: 9199446] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[21:31:30] [DOC: 9199446] ℹ️  Payer Source extracted: 'Medicare'
[21:31:30] [DOC: 9199446] ℹ️  Diagnosis codes being written:
[21:31:30] [DOC: 9199446] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[21:31:30] [DOC: 9199446] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.59'
[21:31:30] [DOC: 9199446] ℹ️    - Latest_Episode_Thirddiagnosis: 'I15.2'
[21:31:30] [DOC: 9199446] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.69'
[21:31:30] [DOC: 9199446] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[21:31:30] [DOC: 9199446] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[21:31:30] [DOC: 9199446] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: MA250110074701
[21:31:30] ✅    ✅ Document 9199446 processed and saved successfully
[21:31:30] 🔄 
🔄 Step 8: Saving API details...
[21:31:30] [DOC: 9199446] ℹ️  API push details saved for document 9199446
[21:31:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199440                         ║
================================================================================
[21:31:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:31:30] ℹ️  Date: 03/24/2025
[21:31:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:31:33] [DOC: 9199440] ✅ Text extracted using pdfplumber (1472 chars)
[21:31:33] ✅    ✅ Text extracted using pdfplumber (1472 chars)
[21:31:33] 🔄 
🔄 Step 2: Extracting patient data...
[21:31:35] ℹ️  AI extracted raw sex value: ''
[21:31:35] ℹ️  AI extracted service line: 'Physical Therapy'
[21:31:35] ℹ️  AI extracted payer source: ''
[21:31:35] ℹ️  AI extracted diagnoses:
[21:31:35] ℹ️    - Diagnosis 1: 'U07.1'
[21:31:35] ℹ️    - Diagnosis 2: 'J12.82'
[21:31:35] ℹ️    - Diagnosis 3: 'R13.12'
[21:31:35] ℹ️    - Diagnosis 4: 'None'
[21:31:35] ℹ️    - Diagnosis 5: 'None'
[21:31:35] ℹ️    - Diagnosis 6: 'None'
[21:31:35] ℹ️  Final extracted MRN: 'MA250110074701'
[21:31:35] ℹ️  Final extracted Sex: ''
[21:31:35] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:31:35] ℹ️  Final extracted Payer Source: ''
[21:31:35] ✅ Patient data extraction completed successfully
[21:31:35] ✅    ✅ Patient data extracted successfully
[21:31:35] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:31:35] ✅    ✅ Patient identified: Gloria Couto
[21:31:35] ✅    ✅ Patient name validation passed
[21:31:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:31:35] [DOC: 9199440] ℹ️  DOB normalized: 07/30/1947
[21:31:35] [DOC: 9199440] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[21:31:35] [DOC: 9199440] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:31:35] [DOC: 9199440] ✅ Patient date processing completed successfully
[21:31:35] ✅    ✅ Date processing completed
[21:31:35] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[21:31:35] 🔄 
🔄 Step 4: Extracting order data...
[21:31:38] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:31:38] ℹ️  Order extraction - Sex: ''
[21:31:38] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:31:38] ℹ️  Order extraction - Payer Source: ''
[21:31:38] ✅ Order data extraction completed successfully
[21:31:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:31:38] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:31:38] ⚠️  Could not determine sex using any available method
[21:31:38] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:31:38] ✅ Patient name cross-validation successful
[21:31:38] ✅    ✅ Data merged successfully
[21:31:40] ✅    ✅ Order data extracted and validated
[21:31:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:31:40] [DOC: 9199440] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:40] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:40] 🔄 
🔄 Step 6: Pushing order to API...
[21:31:40] [DOC: 9199440] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:41] [DOC: 9199440] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13740"}
[21:31:41] ❌    ❌ Failed to push order
[21:31:41] 🔄 
🔄 Step 7: Writing to CSV...
[21:31:41] [DOC: 9199440] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:31:41] [DOC: 9199440] ℹ️  Service Line extracted: 'Physical Therapy'
[21:31:41] [DOC: 9199440] ℹ️  Payer Source extracted: ''
[21:31:41] [DOC: 9199440] ℹ️  Diagnosis codes being written:
[21:31:41] [DOC: 9199440] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[21:31:41] [DOC: 9199440] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[21:31:41] [DOC: 9199440] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[21:31:41] [DOC: 9199440] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:31:41] [DOC: 9199440] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:31:41] [DOC: 9199440] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:31:41] [DOC: 9199440] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy | Payer:  | MRN: MA250110074701
[21:31:41] ✅    ✅ Document 9199440 processed and saved successfully
[21:31:41] 🔄 
🔄 Step 8: Saving API details...
[21:31:41] [DOC: 9199440] ℹ️  API push details saved for document 9199440
[21:31:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199438                         ║
================================================================================
[21:31:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:31:41] ℹ️  Date: 03/24/2025
[21:31:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:31:45] [DOC: 9199438] ✅ Text extracted using pdfplumber (17205 chars)
[21:31:45] ✅    ✅ Text extracted using pdfplumber (17205 chars)
[21:31:45] 🔄 
🔄 Step 2: Extracting patient data...
[21:31:48] ℹ️  AI extracted raw sex value: 'F'
[21:31:48] ℹ️  AI extracted service line: 'PT'
[21:31:48] ℹ️  AI extracted payer source: 'None'
[21:31:48] ℹ️  AI extracted diagnoses:
[21:31:48] ℹ️    - Diagnosis 1: 'Influenza A'
[21:31:48] ℹ️    - Diagnosis 2: 'HTN ASSOCIATED WITH TYPE 2 DM'
[21:31:48] ℹ️    - Diagnosis 3: 'HLD ASSOCIATED WITH TYPE 2 DM'
[21:31:48] ℹ️    - Diagnosis 4: 'DM'
[21:31:48] ℹ️    - Diagnosis 5: 'HX OF BREAST CANCER'
[21:31:48] ℹ️    - Diagnosis 6: 'ANXIETY'
[21:31:48] ℹ️  Final extracted MRN: 'MA250110074701'
[21:31:48] ℹ️  Final extracted Sex: 'FEMALE'
[21:31:48] ℹ️  Final extracted Service Line: 'PT'
[21:31:48] ℹ️  Final extracted Payer Source: ''
[21:31:48] ✅ Patient data extraction completed successfully
[21:31:48] ✅    ✅ Patient data extracted successfully
[21:31:48] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/06/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'HTN ASSOCIATED WITH TYPE 2 DM', 'thirdDiagnosis': 'HLD ASSOCIATED WITH TYPE 2 DM', 'fourthDiagnosis': 'DM', 'fifthDiagnosis': 'HX OF BREAST CANCER', 'sixthDiagnosis': 'ANXIETY'}]
[21:31:48] ✅    ✅ Patient identified: Gloria Couto
[21:31:48] ✅    ✅ Patient name validation passed
[21:31:48] 🔄 
🔄 Step 3: Processing patient dates...
[21:31:48] [DOC: 9199438] ℹ️  DOB normalized: 07/30/1947
[21:31:48] [DOC: 9199438] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[21:31:48] [DOC: 9199438] ✅ Patient date processing completed successfully
[21:31:48] ✅    ✅ Date processing completed
[21:31:48] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'HTN ASSOCIATED WITH TYPE 2 DM', 'thirdDiagnosis': 'HLD ASSOCIATED WITH TYPE 2 DM', 'fourthDiagnosis': 'DM', 'fifthDiagnosis': 'HX OF BREAST CANCER', 'sixthDiagnosis': 'ANXIETY'}]
[21:31:48] 🔄 
🔄 Step 4: Extracting order data...
[21:31:51] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:31:51] ℹ️  Order extraction - Sex: 'FEMALE'
[21:31:51] ℹ️  Order extraction - Service Line: 'PT'
[21:31:51] ℹ️  Order extraction - Payer Source: ''
[21:31:51] ✅ Order data extraction completed successfully
[21:31:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:31:51] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:31:51] ℹ️  Service line consistent in both sources: 'PT'
[21:31:51] ✅ Patient name cross-validation successful
[21:31:51] ✅    ✅ Data merged successfully
[21:31:53] ✅    ✅ Order data extracted and validated
[21:31:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:31:53] [DOC: 9199438] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:53] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:53] 🔄 
🔄 Step 6: Pushing order to API...
[21:31:53] [DOC: 9199438] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:31:54] [DOC: 9199438] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:31:54] ❌    ❌ Failed to push order
[21:31:54] 🔄 
🔄 Step 7: Writing to CSV...
[21:31:54] [DOC: 9199438] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:31:54] [DOC: 9199438] ℹ️  Service Line extracted: 'PT'
[21:31:54] [DOC: 9199438] ℹ️  Payer Source extracted: ''
[21:31:54] [DOC: 9199438] ℹ️  Diagnosis codes being written:
[21:31:54] [DOC: 9199438] ℹ️    - Latest_Episode_Firstdiagnosis: 'Influenza A'
[21:31:54] [DOC: 9199438] ℹ️    - Latest_Episode_Seconddiagnosis: 'HTN ASSOCIATED WITH TYPE 2 DM'
[21:31:54] [DOC: 9199438] ℹ️    - Latest_Episode_Thirddiagnosis: 'HLD ASSOCIATED WITH TYPE 2 DM'
[21:31:54] [DOC: 9199438] ℹ️    - Latest_Episode_Fourthdiagnosis: 'DM'
[21:31:54] [DOC: 9199438] ℹ️    - Latest_Episode_Fifthdiagnosis: 'HX OF BREAST CANCER'
[21:31:54] [DOC: 9199438] ℹ️    - Latest_Episode_Sixthdiagnosis: 'ANXIETY'
[21:31:54] [DOC: 9199438] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: PT | Payer:  | MRN: MA250110074701
[21:31:54] ✅    ✅ Document 9199438 processed and saved successfully
[21:31:54] 🔄 
🔄 Step 8: Saving API details...
[21:31:54] [DOC: 9199438] ℹ️  API push details saved for document 9199438
[21:31:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199433                         ║
================================================================================
[21:31:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:31:54] ℹ️  Date: 03/24/2025
[21:31:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:31:56] [DOC: 9199433] ✅ Text extracted using pdfplumber (1591 chars)
[21:31:56] ✅    ✅ Text extracted using pdfplumber (1591 chars)
[21:31:56] 🔄 
🔄 Step 2: Extracting patient data...
[21:31:59] ℹ️  AI extracted raw sex value: ''
[21:31:59] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:31:59] ℹ️  AI extracted payer source: ''
[21:31:59] ℹ️  AI extracted diagnoses:
[21:31:59] ℹ️    - Diagnosis 1: 'U07.1'
[21:31:59] ℹ️    - Diagnosis 2: 'J12.82'
[21:31:59] ℹ️    - Diagnosis 3: 'R13.12'
[21:31:59] ℹ️    - Diagnosis 4: 'None'
[21:31:59] ℹ️    - Diagnosis 5: 'None'
[21:31:59] ℹ️    - Diagnosis 6: 'None'
[21:31:59] ℹ️  Final extracted MRN: 'MA250110074701'
[21:31:59] ℹ️  Final extracted Sex: ''
[21:31:59] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:31:59] ℹ️  Final extracted Payer Source: ''
[21:31:59] ✅ Patient data extraction completed successfully
[21:31:59] ✅    ✅ Patient data extracted successfully
[21:31:59] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:31:59] ✅    ✅ Patient identified: Gloria Couto
[21:31:59] ✅    ✅ Patient name validation passed
[21:31:59] 🔄 
🔄 Step 3: Processing patient dates...
[21:31:59] [DOC: 9199433] ℹ️  DOB normalized: 07/30/1947
[21:31:59] [DOC: 9199433] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[21:31:59] [DOC: 9199433] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:31:59] [DOC: 9199433] ✅ Patient date processing completed successfully
[21:31:59] ✅    ✅ Date processing completed
[21:31:59] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[21:31:59] 🔄 
🔄 Step 4: Extracting order data...
[21:32:02] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:32:02] ℹ️  Order extraction - Sex: ''
[21:32:02] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:32:02] ℹ️  Order extraction - Payer Source: ''
[21:32:02] ✅ Order data extraction completed successfully
[21:32:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:32:02] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:32:02] ⚠️  Could not determine sex using any available method
[21:32:02] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:32:02] ✅ Patient name cross-validation successful
[21:32:02] ✅    ✅ Data merged successfully
[21:32:04] ✅    ✅ Order data extracted and validated
[21:32:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:32:04] [DOC: 9199433] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:04] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:04] 🔄 
🔄 Step 6: Pushing order to API...
[21:32:04] [DOC: 9199433] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:08] [DOC: 9199433] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13741"}
[21:32:08] ❌    ❌ Failed to push order
[21:32:08] 🔄 
🔄 Step 7: Writing to CSV...
[21:32:08] [DOC: 9199433] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:32:08] [DOC: 9199433] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:32:08] [DOC: 9199433] ℹ️  Payer Source extracted: ''
[21:32:08] [DOC: 9199433] ℹ️  Diagnosis codes being written:
[21:32:08] [DOC: 9199433] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[21:32:08] [DOC: 9199433] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[21:32:08] [DOC: 9199433] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[21:32:08] [DOC: 9199433] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:32:08] [DOC: 9199433] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:32:08] [DOC: 9199433] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:32:08] [DOC: 9199433] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[21:32:08] ✅    ✅ Document 9199433 processed and saved successfully
[21:32:08] 🔄 
🔄 Step 8: Saving API details...
[21:32:08] [DOC: 9199433] ℹ️  API push details saved for document 9199433
[21:32:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199430                         ║
================================================================================
[21:32:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:32:08] ℹ️  Date: 03/24/2025
[21:32:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:32:15] [DOC: 9199430] ✅ Text extracted using pdfplumber (12283 chars)
[21:32:15] ✅    ✅ Text extracted using pdfplumber (12283 chars)
[21:32:15] 🔄 
🔄 Step 2: Extracting patient data...
[21:32:18] ℹ️  AI extracted raw sex value: 'F'
[21:32:18] ℹ️  AI extracted service line: 'OT'
[21:32:18] ℹ️  AI extracted payer source: ''
[21:32:18] ℹ️  AI extracted diagnoses:
[21:32:18] ℹ️    - Diagnosis 1: ''
[21:32:18] ℹ️    - Diagnosis 2: ''
[21:32:18] ℹ️    - Diagnosis 3: ''
[21:32:18] ℹ️    - Diagnosis 4: ''
[21:32:18] ℹ️    - Diagnosis 5: ''
[21:32:18] ℹ️    - Diagnosis 6: ''
[21:32:18] ℹ️  Final extracted MRN: 'MA250110074701'
[21:32:18] ℹ️  Final extracted Sex: 'FEMALE'
[21:32:18] ℹ️  Final extracted Service Line: 'OT'
[21:32:18] ℹ️  Final extracted Payer Source: ''
[21:32:18] ✅ Patient data extraction completed successfully
[21:32:18] ✅    ✅ Patient data extracted successfully
[21:32:18] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:32:18] ✅    ✅ Patient identified: Gloria Couto
[21:32:18] ✅    ✅ Patient name validation passed
[21:32:18] 🔄 
🔄 Step 3: Processing patient dates...
[21:32:18] [DOC: 9199430] ℹ️  DOB normalized: 07/30/1947
[21:32:18] [DOC: 9199430] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[21:32:18] [DOC: 9199430] ℹ️  Episode endOfEpisode normalized: 02/26/2025
[21:32:18] [DOC: 9199430] ✅ Patient date processing completed successfully
[21:32:18] ✅    ✅ Date processing completed
[21:32:18] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:32:18] 🔄 
🔄 Step 4: Extracting order data...
[21:32:21] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:32:21] ℹ️  Order extraction - Sex: 'FEMALE'
[21:32:21] ℹ️  Order extraction - Service Line: 'OT'
[21:32:21] ℹ️  Order extraction - Payer Source: ''
[21:32:21] ✅ Order data extraction completed successfully
[21:32:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:32:21] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:32:21] ℹ️  Service line consistent in both sources: 'OT'
[21:32:21] ✅ Patient name cross-validation successful
[21:32:21] ✅    ✅ Data merged successfully
[21:32:22] ✅    ✅ Order data extracted and validated
[21:32:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:32:22] [DOC: 9199430] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:22] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:22] 🔄 
🔄 Step 6: Pushing order to API...
[21:32:22] [DOC: 9199430] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:23] [DOC: 9199430] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:32:23] ❌    ❌ Failed to push order
[21:32:23] 🔄 
🔄 Step 7: Writing to CSV...
[21:32:23] [DOC: 9199430] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:32:23] [DOC: 9199430] ℹ️  Service Line extracted: 'OT'
[21:32:23] [DOC: 9199430] ℹ️  Payer Source extracted: ''
[21:32:23] [DOC: 9199430] ℹ️  Diagnosis codes being written:
[21:32:23] [DOC: 9199430] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:32:23] [DOC: 9199430] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:32:23] [DOC: 9199430] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:32:23] [DOC: 9199430] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:32:23] [DOC: 9199430] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:32:23] [DOC: 9199430] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:32:23] [DOC: 9199430] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT | Payer:  | MRN: MA250110074701
[21:32:23] ✅    ✅ Document 9199430 processed and saved successfully
[21:32:23] 🔄 
🔄 Step 8: Saving API details...
[21:32:23] [DOC: 9199430] ℹ️  API push details saved for document 9199430
[21:32:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199415                         ║
================================================================================
[21:32:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:32:23] ℹ️  Date: 03/24/2025
[21:32:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:32:26] [DOC: 9199415] ✅ Text extracted using pdfplumber (1594 chars)
[21:32:26] ✅    ✅ Text extracted using pdfplumber (1594 chars)
[21:32:26] 🔄 
🔄 Step 2: Extracting patient data...
[21:32:30] ℹ️  AI extracted raw sex value: ''
[21:32:30] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[21:32:30] ℹ️  AI extracted payer source: ''
[21:32:30] ℹ️  AI extracted diagnoses:
[21:32:30] ℹ️    - Diagnosis 1: 'U07.1'
[21:32:30] ℹ️    - Diagnosis 2: 'J12.82'
[21:32:30] ℹ️    - Diagnosis 3: 'R13.12'
[21:32:30] ℹ️    - Diagnosis 4: 'None'
[21:32:30] ℹ️    - Diagnosis 5: 'None'
[21:32:30] ℹ️    - Diagnosis 6: 'None'
[21:32:30] ℹ️  Final extracted MRN: 'MA250110074701'
[21:32:30] ℹ️  Final extracted Sex: ''
[21:32:30] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[21:32:30] ℹ️  Final extracted Payer Source: ''
[21:32:30] ✅ Patient data extraction completed successfully
[21:32:30] ✅    ✅ Patient data extracted successfully
[21:32:30] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:32:30] ✅    ✅ Patient identified: Gloria Couto
[21:32:30] ✅    ✅ Patient name validation passed
[21:32:30] 🔄 
🔄 Step 3: Processing patient dates...
[21:32:30] [DOC: 9199415] ℹ️  DOB normalized: 07/30/1947
[21:32:30] [DOC: 9199415] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[21:32:30] [DOC: 9199415] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:32:30] [DOC: 9199415] ✅ Patient date processing completed successfully
[21:32:30] ✅    ✅ Date processing completed
[21:32:30] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[21:32:30] 🔄 
🔄 Step 4: Extracting order data...
[21:32:33] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:32:33] ℹ️  Order extraction - Sex: ''
[21:32:33] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[21:32:33] ℹ️  Order extraction - Payer Source: ''
[21:32:33] ✅ Order data extraction completed successfully
[21:32:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:32:33] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:32:33] ⚠️  Could not determine sex using any available method
[21:32:33] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[21:32:33] ✅ Patient name cross-validation successful
[21:32:33] ✅    ✅ Data merged successfully
[21:32:34] ✅    ✅ Order data extracted and validated
[21:32:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:32:34] [DOC: 9199415] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:34] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:34] 🔄 
🔄 Step 6: Pushing order to API...
[21:32:34] [DOC: 9199415] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:35] [DOC: 9199415] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13743"}
[21:32:35] ❌    ❌ Failed to push order
[21:32:35] 🔄 
🔄 Step 7: Writing to CSV...
[21:32:35] [DOC: 9199415] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:32:35] [DOC: 9199415] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[21:32:35] [DOC: 9199415] ℹ️  Payer Source extracted: ''
[21:32:35] [DOC: 9199415] ℹ️  Diagnosis codes being written:
[21:32:35] [DOC: 9199415] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[21:32:35] [DOC: 9199415] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[21:32:35] [DOC: 9199415] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[21:32:35] [DOC: 9199415] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:32:35] [DOC: 9199415] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:32:35] [DOC: 9199415] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:32:35] [DOC: 9199415] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy, Occupational Therapy, Speech Therapy | Payer:  | MRN: MA250110074701
[21:32:35] ✅    ✅ Document 9199415 processed and saved successfully
[21:32:35] 🔄 
🔄 Step 8: Saving API details...
[21:32:35] [DOC: 9199415] ℹ️  API push details saved for document 9199415
[21:32:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199412                         ║
================================================================================
[21:32:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:32:35] ℹ️  Date: 03/24/2025
[21:32:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:32:37] [DOC: 9199412] ✅ Text extracted using pdfplumber (1400 chars)
[21:32:37] ✅    ✅ Text extracted using pdfplumber (1400 chars)
[21:32:37] 🔄 
🔄 Step 2: Extracting patient data...
[21:32:40] ℹ️  AI extracted raw sex value: ''
[21:32:40] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:32:40] ℹ️  AI extracted payer source: ''
[21:32:40] ℹ️  AI extracted diagnoses:
[21:32:40] ℹ️    - Diagnosis 1: 'U07.1'
[21:32:40] ℹ️    - Diagnosis 2: 'J12.82'
[21:32:40] ℹ️    - Diagnosis 3: 'R13.12'
[21:32:40] ℹ️    - Diagnosis 4: 'None'
[21:32:40] ℹ️    - Diagnosis 5: 'None'
[21:32:40] ℹ️    - Diagnosis 6: 'None'
[21:32:40] ℹ️  Final extracted MRN: 'MA250110074701'
[21:32:40] ℹ️  Final extracted Sex: ''
[21:32:40] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:32:40] ℹ️  Final extracted Payer Source: ''
[21:32:40] ✅ Patient data extraction completed successfully
[21:32:40] ✅    ✅ Patient data extracted successfully
[21:32:40] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:32:40] ✅    ✅ Patient identified: Gloria Couto
[21:32:40] ✅    ✅ Patient name validation passed
[21:32:40] 🔄 
🔄 Step 3: Processing patient dates...
[21:32:40] [DOC: 9199412] ℹ️  DOB normalized: 07/30/1947
[21:32:40] [DOC: 9199412] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[21:32:40] [DOC: 9199412] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:32:40] [DOC: 9199412] ✅ Patient date processing completed successfully
[21:32:40] ✅    ✅ Date processing completed
[21:32:40] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[21:32:40] 🔄 
🔄 Step 4: Extracting order data...
[21:32:43] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:32:43] ℹ️  Order extraction - Sex: ''
[21:32:43] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:32:43] ℹ️  Order extraction - Payer Source: ''
[21:32:43] ✅ Order data extraction completed successfully
[21:32:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:32:43] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:32:43] ⚠️  Could not determine sex using any available method
[21:32:43] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:32:43] ✅ Patient name cross-validation successful
[21:32:43] ✅    ✅ Data merged successfully
[21:32:44] ✅    ✅ Order data extracted and validated
[21:32:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:32:44] [DOC: 9199412] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:44] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:44] 🔄 
🔄 Step 6: Pushing order to API...
[21:32:44] [DOC: 9199412] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:45] [DOC: 9199412] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13745"}
[21:32:45] ❌    ❌ Failed to push order
[21:32:45] 🔄 
🔄 Step 7: Writing to CSV...
[21:32:45] [DOC: 9199412] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:32:45] [DOC: 9199412] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:32:45] [DOC: 9199412] ℹ️  Payer Source extracted: ''
[21:32:45] [DOC: 9199412] ℹ️  Diagnosis codes being written:
[21:32:45] [DOC: 9199412] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[21:32:45] [DOC: 9199412] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[21:32:45] [DOC: 9199412] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[21:32:45] [DOC: 9199412] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:32:45] [DOC: 9199412] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:32:45] [DOC: 9199412] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:32:45] [DOC: 9199412] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[21:32:45] ✅    ✅ Document 9199412 processed and saved successfully
[21:32:45] 🔄 
🔄 Step 8: Saving API details...
[21:32:45] [DOC: 9199412] ℹ️  API push details saved for document 9199412
[21:32:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199408                         ║
================================================================================
[21:32:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:32:45] ℹ️  Date: 03/24/2025
[21:32:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:32:48] [DOC: 9199408] ✅ Text extracted using pdfplumber (1397 chars)
[21:32:48] ✅    ✅ Text extracted using pdfplumber (1397 chars)
[21:32:48] 🔄 
🔄 Step 2: Extracting patient data...
[21:32:51] ℹ️  AI extracted raw sex value: ''
[21:32:51] ℹ️  AI extracted service line: 'Physical Therapy'
[21:32:51] ℹ️  AI extracted payer source: ''
[21:32:51] ℹ️  AI extracted diagnoses:
[21:32:51] ℹ️    - Diagnosis 1: 'U07.1'
[21:32:51] ℹ️    - Diagnosis 2: 'J12.82'
[21:32:51] ℹ️    - Diagnosis 3: 'R13.12'
[21:32:51] ℹ️    - Diagnosis 4: ''
[21:32:51] ℹ️    - Diagnosis 5: ''
[21:32:51] ℹ️    - Diagnosis 6: ''
[21:32:51] ℹ️  Final extracted MRN: 'MA250110074701'
[21:32:51] ℹ️  Final extracted Sex: ''
[21:32:51] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:32:51] ℹ️  Final extracted Payer Source: ''
[21:32:51] ✅ Patient data extraction completed successfully
[21:32:51] ✅    ✅ Patient data extracted successfully
[21:32:51] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:32:51] ✅    ✅ Patient identified: Gloria Couto
[21:32:51] ✅    ✅ Patient name validation passed
[21:32:51] 🔄 
🔄 Step 3: Processing patient dates...
[21:32:51] [DOC: 9199408] ℹ️  DOB normalized: 07/30/1947
[21:32:51] [DOC: 9199408] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[21:32:51] [DOC: 9199408] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:32:51] [DOC: 9199408] ✅ Patient date processing completed successfully
[21:32:51] ✅    ✅ Date processing completed
[21:32:51] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:32:51] 🔄 
🔄 Step 4: Extracting order data...
[21:32:53] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:32:53] ℹ️  Order extraction - Sex: ''
[21:32:53] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:32:53] ℹ️  Order extraction - Payer Source: ''
[21:32:53] ✅ Order data extraction completed successfully
[21:32:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:32:53] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:32:53] ⚠️  Could not determine sex using any available method
[21:32:53] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:32:53] ✅ Patient name cross-validation successful
[21:32:53] ✅    ✅ Data merged successfully
[21:32:54] ✅    ✅ Order data extracted and validated
[21:32:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:32:54] [DOC: 9199408] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:54] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:54] 🔄 
🔄 Step 6: Pushing order to API...
[21:32:54] [DOC: 9199408] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:32:56] [DOC: 9199408] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13746"}
[21:32:56] ❌    ❌ Failed to push order
[21:32:56] 🔄 
🔄 Step 7: Writing to CSV...
[21:32:56] [DOC: 9199408] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:32:56] [DOC: 9199408] ℹ️  Service Line extracted: 'Physical Therapy'
[21:32:56] [DOC: 9199408] ℹ️  Payer Source extracted: ''
[21:32:56] [DOC: 9199408] ℹ️  Diagnosis codes being written:
[21:32:56] [DOC: 9199408] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[21:32:56] [DOC: 9199408] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[21:32:56] [DOC: 9199408] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[21:32:56] [DOC: 9199408] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:32:56] [DOC: 9199408] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:32:56] [DOC: 9199408] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:32:56] [DOC: 9199408] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy | Payer:  | MRN: MA250110074701
[21:32:56] ✅    ✅ Document 9199408 processed and saved successfully
[21:32:56] 🔄 
🔄 Step 8: Saving API details...
[21:32:56] [DOC: 9199408] ℹ️  API push details saved for document 9199408
[21:32:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199403                         ║
================================================================================
[21:32:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:32:56] ℹ️  Date: 03/24/2025
[21:32:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:32:59] [DOC: 9199403] ✅ Text extracted using pdfplumber (10246 chars)
[21:32:59] ✅    ✅ Text extracted using pdfplumber (10246 chars)
[21:32:59] 🔄 
🔄 Step 2: Extracting patient data...
[21:33:01] ℹ️  AI extracted raw sex value: 'F'
[21:33:01] ℹ️  AI extracted service line: 'PT, OT, SLP'
[21:33:01] ℹ️  AI extracted payer source: ''
[21:33:01] ℹ️  AI extracted diagnoses:
[21:33:01] ℹ️    - Diagnosis 1: 'U071'
[21:33:01] ℹ️    - Diagnosis 2: 'J1282'
[21:33:01] ℹ️    - Diagnosis 3: ''
[21:33:01] ℹ️    - Diagnosis 4: ''
[21:33:01] ℹ️    - Diagnosis 5: ''
[21:33:01] ℹ️    - Diagnosis 6: ''
[21:33:01] ℹ️  Final extracted MRN: 'MA250110074701'
[21:33:01] ℹ️  Final extracted Sex: 'FEMALE'
[21:33:01] ℹ️  Final extracted Service Line: 'PT, OT, SLP'
[21:33:01] ℹ️  Final extracted Payer Source: ''
[21:33:01] ✅ Patient data extraction completed successfully
[21:33:01] ✅    ✅ Patient data extracted successfully
[21:33:01] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT, SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U071', 'secondDiagnosis': 'J1282', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:33:01] ✅    ✅ Patient identified: Gloria Couto
[21:33:01] ✅    ✅ Patient name validation passed
[21:33:01] 🔄 
🔄 Step 3: Processing patient dates...
[21:33:01] [DOC: 9199403] ℹ️  DOB normalized: 07/30/1947
[21:33:01] [DOC: 9199403] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[21:33:01] [DOC: 9199403] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:33:01] [DOC: 9199403] ✅ Patient date processing completed successfully
[21:33:01] ✅    ✅ Date processing completed
[21:33:01] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT, SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U071', 'secondDiagnosis': 'J1282', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:33:01] 🔄 
🔄 Step 4: Extracting order data...
[21:33:04] ℹ️  Order extraction - MRN: 'MA250110074701'
[21:33:04] ℹ️  Order extraction - Sex: 'FEMALE'
[21:33:04] ℹ️  Order extraction - Service Line: 'PT, OT, ST'
[21:33:04] ℹ️  Order extraction - Payer Source: ''
[21:33:04] ✅ Order data extraction completed successfully
[21:33:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:33:04] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[21:33:04] ℹ️  Combined service lines: Patient='PT, OT, SLP' + Order='PT, OT, ST' = 'OT, PT, SLP, ST'
[21:33:04] ✅ Patient name cross-validation successful
[21:33:04] ✅    ✅ Data merged successfully
[21:33:05] ✅    ✅ Order data extracted and validated
[21:33:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:33:05] [DOC: 9199403] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:33:05] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:33:05] 🔄 
🔄 Step 6: Pushing order to API...
[21:33:05] [DOC: 9199403] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[21:33:06] [DOC: 9199403] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13747"}
[21:33:06] ❌    ❌ Failed to push order
[21:33:06] 🔄 
🔄 Step 7: Writing to CSV...
[21:33:06] [DOC: 9199403] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[21:33:06] [DOC: 9199403] ℹ️  Service Line extracted: 'OT, PT, SLP, ST'
[21:33:06] [DOC: 9199403] ℹ️  Payer Source extracted: ''
[21:33:06] [DOC: 9199403] ℹ️  Diagnosis codes being written:
[21:33:06] [DOC: 9199403] ℹ️    - Latest_Episode_Firstdiagnosis: 'U071'
[21:33:06] [DOC: 9199403] ℹ️    - Latest_Episode_Seconddiagnosis: 'J1282'
[21:33:06] [DOC: 9199403] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:33:06] [DOC: 9199403] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:33:06] [DOC: 9199403] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:33:06] [DOC: 9199403] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:33:06] [DOC: 9199403] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT, PT, SLP, ST | Payer:  | MRN: MA250110074701
[21:33:06] ✅    ✅ Document 9199403 processed and saved successfully
[21:33:06] 🔄 
🔄 Step 8: Saving API details...
[21:33:06] [DOC: 9199403] ℹ️  API push details saved for document 9199403
[21:33:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9196561                         ║
================================================================================
[21:33:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:33:06] ℹ️  Date: 03/21/2025
[21:33:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:33:09] [DOC: 9196561] ✅ Text extracted using pdfplumber (15639 chars)
[21:33:09] ✅    ✅ Text extracted using pdfplumber (15639 chars)
[21:33:09] 🔄 
🔄 Step 2: Extracting patient data...
[21:33:12] ℹ️  AI extracted raw sex value: 'M'
[21:33:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:33:12] ℹ️  AI extracted payer source: ''
[21:33:12] ℹ️  AI extracted diagnoses:
[21:33:12] ℹ️    - Diagnosis 1: 'N39.0'
[21:33:12] ℹ️    - Diagnosis 2: 'D64.9'
[21:33:12] ℹ️    - Diagnosis 3: 'D69.6'
[21:33:12] ℹ️    - Diagnosis 4: 'R53.1'
[21:33:12] ℹ️    - Diagnosis 5: 'I48.91'
[21:33:12] ℹ️    - Diagnosis 6: 'I13.0'
[21:33:12] ℹ️  Final extracted MRN: '3028278'
[21:33:12] ℹ️  Final extracted Sex: 'MALE'
[21:33:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:33:12] ℹ️  Final extracted Payer Source: ''
[21:33:12] ✅ Patient data extraction completed successfully
[21:33:12] ✅    ✅ Patient data extracted successfully
[21:33:12] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Tavares
     └─ dob: 07/26/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 3028278
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'D64.9', 'thirdDiagnosis': 'D69.6', 'fourthDiagnosis': 'R53.1', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I13.0'}]
[21:33:12] ✅    ✅ Patient identified: Jose Tavares
[21:33:12] ✅    ✅ Patient name validation passed
[21:33:12] 🔄 
🔄 Step 3: Processing patient dates...
[21:33:12] [DOC: 9196561] ℹ️  DOB normalized: 07/26/1927
[21:33:12] [DOC: 9196561] ℹ️  Episode startOfCare normalized: 03/02/2025
[21:33:12] [DOC: 9196561] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[21:33:12] [DOC: 9196561] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[21:33:12] [DOC: 9196561] ✅ Patient date processing completed successfully
[21:33:12] ✅    ✅ Date processing completed
[21:33:12] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Tavares
     └─ dob: 07/26/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 3028278
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'D64.9', 'thirdDiagnosis': 'D69.6', 'fourthDiagnosis': 'R53.1', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I13.0'}]
[21:33:12] 🔄 
🔄 Step 4: Extracting order data...
[21:33:15] ℹ️  Order extraction - MRN: '3028278'
[21:33:15] ℹ️  Order extraction - Sex: 'MALE'
[21:33:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:33:15] ℹ️  Order extraction - Payer Source: ''
[21:33:15] ✅ Order data extraction completed successfully
[21:33:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:33:15] ℹ️  Using MRN from patient data: '3028278' over '3028278'
[21:33:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:33:15] ✅ Patient name cross-validation successful
[21:33:15] ✅    ✅ Data merged successfully
[21:33:16] ✅    ✅ Order data extracted and validated
[21:33:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:33:41] [DOC: 9196561] ℹ️  Patient not found in cache or API: Jose Tavares
[21:33:41] [DOC: 9196561] ℹ️  Patient not found, creating new patient via API...
[21:33:41] [DOC: 9196561] ℹ️  Creating patient via API: Jose Tavares
[21:33:42] [DOC: 9196561] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:33:42] ❌    ❌ Failed to create patient
[21:33:42] [DOC: 9196561] ℹ️  API push details saved for document 9196561
================================================================================
║                        Processing Document ID: 9196545                         ║
================================================================================
[21:33:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:33:42] ℹ️  Date: 03/21/2025
[21:33:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:33:43] [DOC: 9196545] ✅ Text extracted using pdfplumber (1018 chars)
[21:33:43] ✅    ✅ Text extracted using pdfplumber (1018 chars)
[21:33:43] 🔄 
🔄 Step 2: Extracting patient data...
[21:33:46] ℹ️  AI extracted raw sex value: 'F'
[21:33:46] ℹ️  AI extracted service line: 'PT'
[21:33:46] ℹ️  AI extracted payer source: ''
[21:33:46] ℹ️  AI extracted diagnoses:
[21:33:46] ℹ️    - Diagnosis 1: ''
[21:33:46] ℹ️    - Diagnosis 2: ''
[21:33:46] ℹ️    - Diagnosis 3: ''
[21:33:46] ℹ️    - Diagnosis 4: ''
[21:33:46] ℹ️    - Diagnosis 5: ''
[21:33:46] ℹ️    - Diagnosis 6: ''
[21:33:46] ℹ️  Final extracted MRN: '2120086'
[21:33:46] ℹ️  Final extracted Sex: 'FEMALE'
[21:33:46] ℹ️  Final extracted Service Line: 'PT'
[21:33:46] ℹ️  Final extracted Payer Source: ''
[21:33:46] ✅ Patient data extraction completed successfully
[21:33:46] ✅    ✅ Patient data extracted successfully
[21:33:46] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:33:46] ✅    ✅ Patient identified: Elaine Dupont
[21:33:46] ✅    ✅ Patient name validation passed
[21:33:46] 🔄 
🔄 Step 3: Processing patient dates...
[21:33:46] [DOC: 9196545] ℹ️  DOB normalized: 09/06/1942
[21:33:46] [DOC: 9196545] ✅ Patient date processing completed successfully
[21:33:46] ✅    ✅ Date processing completed
[21:33:46] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:33:46] 🔄 
🔄 Step 4: Extracting order data...
[21:33:48] ℹ️  Order extraction - MRN: '2120086'
[21:33:48] ℹ️  Order extraction - Sex: 'FEMALE'
[21:33:48] ℹ️  Order extraction - Service Line: ''
[21:33:48] ℹ️  Order extraction - Payer Source: ''
[21:33:48] ✅ Order data extraction completed successfully
[21:33:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:33:48] ℹ️  Using MRN from patient data: '2120086' over '2120086'
[21:33:48] ℹ️  Using service line from patient data: 'PT'
[21:33:48] ✅ Patient name cross-validation successful
[21:33:48] ✅    ✅ Data merged successfully
[21:33:49] ⚠️     ❌ Skipping - missing episode start date
[21:33:49] [DOC: 9196545] ℹ️  API push details saved for document 9196545
================================================================================
║                        Processing Document ID: 9194248                         ║
================================================================================
[21:33:49] ℹ️  Agency: AccentCare Fall River
[21:33:49] ℹ️  Date: 03/20/2025
[21:33:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:33:59] [DOC: 9194248] ✅ Text extracted using pdfplumber (20923 chars)
[21:33:59] ✅    ✅ Text extracted using pdfplumber (20851 chars)
[21:33:59] 🔄 
🔄 Step 2: Extracting patient data...
[21:34:03] ℹ️  AI extracted raw sex value: 'F'
[21:34:03] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:34:03] ℹ️  AI extracted payer source: 'Medicare'
[21:34:03] ℹ️  AI extracted diagnoses:
[21:34:03] ℹ️    - Diagnosis 1: 'S81.812D'
[21:34:03] ℹ️    - Diagnosis 2: 'B99.9'
[21:34:03] ℹ️    - Diagnosis 3: 'I10'
[21:34:03] ℹ️    - Diagnosis 4: 'I48.91'
[21:34:03] ℹ️    - Diagnosis 5: 'E78.00'
[21:34:03] ℹ️    - Diagnosis 6: 'D64.9'
[21:34:03] ℹ️  Final extracted MRN: 'C0200225862501'
[21:34:03] ℹ️  Final extracted Sex: 'FEMALE'
[21:34:03] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:34:03] ℹ️  Final extracted Payer Source: 'Medicare'
[21:34:03] ✅ Patient data extraction completed successfully
[21:34:03] ✅    ✅ Patient data extracted successfully
[21:34:03] 📊 Patient Response
     └─ patientFName: JOAN
     └─ patientLName: BULLARD
     └─ dob: 05/18/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225862501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'B99.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'E78.00', 'sixthDiagnosis': 'D64.9'}]
[21:34:03] ✅    ✅ Patient identified: JOAN BULLARD
[21:34:03] ✅    ✅ Patient name validation passed
[21:34:03] 🔄 
🔄 Step 3: Processing patient dates...
[21:34:03] [DOC: 9194248] ℹ️  DOB normalized: 05/18/1932
[21:34:03] [DOC: 9194248] ℹ️  Episode startOfCare normalized: 01/16/2025
[21:34:03] [DOC: 9194248] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[21:34:03] [DOC: 9194248] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[21:34:03] [DOC: 9194248] ✅ Patient date processing completed successfully
[21:34:03] ✅    ✅ Date processing completed
[21:34:03] 📊 Processed Patient Data
     └─ patientFName: JOAN
     └─ patientLName: BULLARD
     └─ dob: 05/18/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225862501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'B99.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'E78.00', 'sixthDiagnosis': 'D64.9'}]
[21:34:03] 🔄 
🔄 Step 4: Extracting order data...
[21:34:06] ℹ️  Order extraction - MRN: '227203'
[21:34:06] ℹ️  Order extraction - Sex: 'FEMALE'
[21:34:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:34:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:34:06] ✅ Order data extraction completed successfully
[21:34:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:34:06] ℹ️  Using MRN from patient data: 'C0200225862501' over '227203'
[21:34:06] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[21:34:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:34:06] ✅ Patient name cross-validation successful
[21:34:06] ✅    ✅ Data merged successfully
[21:34:07] ✅    ✅ Order data extracted and validated
[21:34:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:34:21] [DOC: 9194248] ℹ️  Patient not found in cache or API: JOAN BULLARD
[21:34:21] [DOC: 9194248] ℹ️  Patient not found, creating new patient via API...
[21:34:21] [DOC: 9194248] ℹ️  Creating patient via API: JOAN BULLARD
[21:34:22] [DOC: 9194248] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:34:22] ❌    ❌ Failed to create patient
[21:34:22] [DOC: 9194248] ℹ️  API push details saved for document 9194248
================================================================================
║                        Processing Document ID: 9194204                         ║
================================================================================
[21:34:22] ℹ️  Agency: AccentCare Fall River
[21:34:22] ℹ️  Date: 03/20/2025
[21:34:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:34:26] [DOC: 9194204] ✅ Text extracted using pdfplumber (17412 chars)
[21:34:26] ✅    ✅ Text extracted using pdfplumber (17352 chars)
[21:34:26] 🔄 
🔄 Step 2: Extracting patient data...
[21:34:29] ℹ️  AI extracted raw sex value: 'M'
[21:34:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:34:29] ℹ️  AI extracted payer source: 'Medicare'
[21:34:29] ℹ️  AI extracted diagnoses:
[21:34:29] ℹ️    - Diagnosis 1: 'I10'
[21:34:29] ℹ️    - Diagnosis 2: 'N40.0'
[21:34:29] ℹ️    - Diagnosis 3: 'N32.0'
[21:34:29] ℹ️    - Diagnosis 4: 'E66.3'
[21:34:29] ℹ️    - Diagnosis 5: 'Z68.27'
[21:34:29] ℹ️    - Diagnosis 6: 'Z91.81'
[21:34:29] ℹ️  Final extracted MRN: 'C0200218380901'
[21:34:29] ℹ️  Final extracted Sex: 'MALE'
[21:34:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:34:29] ℹ️  Final extracted Payer Source: 'Medicare'
[21:34:29] ✅ Patient data extraction completed successfully
[21:34:29] ✅    ✅ Patient data extracted successfully
[21:34:29] 📊 Patient Response
     └─ patientFName: JOSE
     └─ patientLName: CASADO
     └─ dob: 02/24/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200218380901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 89 BROOKLAWN ST
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: None
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/15/2024', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N40.0', 'thirdDiagnosis': 'N32.0', 'fourthDiagnosis': 'E66.3', 'fifthDiagnosis': 'Z68.27', 'sixthDiagnosis': 'Z91.81'}]
[21:34:29] ✅    ✅ Patient identified: JOSE CASADO
[21:34:29] ✅    ✅ Patient name validation passed
[21:34:29] 🔄 
🔄 Step 3: Processing patient dates...
[21:34:29] [DOC: 9194204] ℹ️  DOB normalized: 02/24/1954
[21:34:29] [DOC: 9194204] ℹ️  Episode startOfCare normalized: 11/15/2024
[21:34:29] [DOC: 9194204] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[21:34:29] [DOC: 9194204] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[21:34:29] [DOC: 9194204] ✅ Patient date processing completed successfully
[21:34:29] ✅    ✅ Date processing completed
[21:34:29] 📊 Processed Patient Data
     └─ patientFName: JOSE
     └─ patientLName: CASADO
     └─ dob: 02/24/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200218380901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 89 BROOKLAWN ST
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/15/2024', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N40.0', 'thirdDiagnosis': 'N32.0', 'fourthDiagnosis': 'E66.3', 'fifthDiagnosis': 'Z68.27', 'sixthDiagnosis': 'Z91.81'}]
[21:34:29] 🔄 
🔄 Step 4: Extracting order data...
[21:34:32] ℹ️  Order extraction - MRN: '227203'
[21:34:32] ℹ️  Order extraction - Sex: 'MALE'
[21:34:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:34:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:34:32] ✅ Order data extraction completed successfully
[21:34:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:34:32] ℹ️  Using MRN from patient data: 'C0200218380901' over '227203'
[21:34:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:34:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:34:32] ✅ Patient name cross-validation successful
[21:34:32] ✅    ✅ Data merged successfully
[21:34:33] ✅    ✅ Order data extracted and validated
[21:34:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:34:33] [DOC: 9194204] ✅ Patient found in local cache: JOSE CASADO, ID: 82dd4811-5b48-4329-a55b-8cd28c1370fb
[21:34:33] ✅    ✅ Existing patient found with ID: 82dd4811-5b48-4329-a55b-8cd28c1370fb
[21:34:33] 🔄 
🔄 Step 6: Pushing order to API...
[21:34:33] [DOC: 9194204] ℹ️  Pushing order via API for patient ID: 82dd4811-5b48-4329-a55b-8cd28c1370fb
[21:34:35] [DOC: 9194204] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13527"}
[21:34:35] ❌    ❌ Failed to push order
[21:34:35] 🔄 
🔄 Step 7: Writing to CSV...
[21:34:35] [DOC: 9194204] ℹ️  Calculated age: 71 from DOB: 02/24/1954
[21:34:35] [DOC: 9194204] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:34:35] [DOC: 9194204] ℹ️  Payer Source extracted: 'Medicare'
[21:34:35] [DOC: 9194204] ℹ️  Diagnosis codes being written:
[21:34:35] [DOC: 9194204] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[21:34:35] [DOC: 9194204] ℹ️    - Latest_Episode_Seconddiagnosis: 'N40.0'
[21:34:35] [DOC: 9194204] ℹ️    - Latest_Episode_Thirddiagnosis: 'N32.0'
[21:34:35] [DOC: 9194204] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.3'
[21:34:35] [DOC: 9194204] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.27'
[21:34:35] [DOC: 9194204] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z91.81'
[21:34:35] [DOC: 9194204] ✅ Patient data written to CSV: JOSE CASADO | Sex: MALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: C0200218380901
[21:34:35] ✅    ✅ Document 9194204 processed and saved successfully
[21:34:35] 🔄 
🔄 Step 8: Saving API details...
[21:34:35] [DOC: 9194204] ℹ️  API push details saved for document 9194204
[21:34:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194096                         ║
================================================================================
[21:34:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:34:35] ℹ️  Date: 03/20/2025
[21:34:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:34:41] [DOC: 9194096] ✅ Text extracted using pdfplumber (15179 chars)
[21:34:41] ✅    ✅ Text extracted using pdfplumber (15179 chars)
[21:34:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:34:44] ℹ️  AI extracted raw sex value: 'F'
[21:34:44] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[21:34:44] ℹ️  AI extracted payer source: ''
[21:34:44] ℹ️  AI extracted diagnoses:
[21:34:44] ℹ️    - Diagnosis 1: 'I26.94'
[21:34:44] ℹ️    - Diagnosis 2: 'J18.9'
[21:34:44] ℹ️    - Diagnosis 3: 'I24.89'
[21:34:44] ℹ️    - Diagnosis 4: 'E87.6'
[21:34:44] ℹ️    - Diagnosis 5: 'I10'
[21:34:44] ℹ️    - Diagnosis 6: 'R55'
[21:34:44] ℹ️  Final extracted MRN: '3073617'
[21:34:44] ℹ️  Final extracted Sex: 'FEMALE'
[21:34:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[21:34:44] ℹ️  Final extracted Payer Source: ''
[21:34:44] ✅ Patient data extraction completed successfully
[21:34:44] ✅    ✅ Patient data extracted successfully
[21:34:44] 📊 Patient Response
     └─ patientFName: Ruth
     └─ patientLName: Vital
     └─ dob: 10/11/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3073617
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.94', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'I24.89', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R55'}]
[21:34:44] ✅    ✅ Patient identified: Ruth Vital
[21:34:44] ✅    ✅ Patient name validation passed
[21:34:44] 🔄 
🔄 Step 3: Processing patient dates...
[21:34:44] [DOC: 9194096] ℹ️  DOB normalized: 10/11/1936
[21:34:44] [DOC: 9194096] ℹ️  Episode startOfCare normalized: 03/08/2025
[21:34:44] [DOC: 9194096] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:34:44] [DOC: 9194096] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:34:44] [DOC: 9194096] ✅ Patient date processing completed successfully
[21:34:44] ✅    ✅ Date processing completed
[21:34:44] 📊 Processed Patient Data
     └─ patientFName: Ruth
     └─ patientLName: Vital
     └─ dob: 10/11/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3073617
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.94', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'I24.89', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R55'}]
[21:34:44] 🔄 
🔄 Step 4: Extracting order data...
[21:34:47] ℹ️  Order extraction - MRN: '3073617'
[21:34:47] ℹ️  Order extraction - Sex: 'FEMALE'
[21:34:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[21:34:47] ℹ️  Order extraction - Payer Source: ''
[21:34:47] ✅ Order data extraction completed successfully
[21:34:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:34:47] ℹ️  Using MRN from patient data: '3073617' over '3073617'
[21:34:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[21:34:47] ✅ Patient name cross-validation successful
[21:34:47] ✅    ✅ Data merged successfully
[21:34:48] ✅    ✅ Order data extracted and validated
[21:34:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:34:48] [DOC: 9194096] ✅ Patient found in local cache: Ruth Vital, ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[21:34:48] ✅    ✅ Existing patient found with ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[21:34:48] 🔄 
🔄 Step 6: Pushing order to API...
[21:34:48] [DOC: 9194096] ℹ️  Pushing order via API for patient ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[21:34:49] [DOC: 9194096] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20080"}
[21:34:49] ❌    ❌ Failed to push order
[21:34:49] 🔄 
🔄 Step 7: Writing to CSV...
[21:34:49] [DOC: 9194096] ℹ️  Calculated age: 88 from DOB: 10/11/1936
[21:34:49] [DOC: 9194096] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[21:34:49] [DOC: 9194096] ℹ️  Payer Source extracted: ''
[21:34:49] [DOC: 9194096] ℹ️  Diagnosis codes being written:
[21:34:49] [DOC: 9194096] ℹ️    - Latest_Episode_Firstdiagnosis: 'I26.94'
[21:34:49] [DOC: 9194096] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[21:34:49] [DOC: 9194096] ℹ️    - Latest_Episode_Thirddiagnosis: 'I24.89'
[21:34:49] [DOC: 9194096] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E87.6'
[21:34:49] [DOC: 9194096] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[21:34:49] [DOC: 9194096] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R55'
[21:34:49] [DOC: 9194096] ✅ Patient data written to CSV: Ruth Vital | Sex: FEMALE | Age: 88 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 3073617
[21:34:49] ✅    ✅ Document 9194096 processed and saved successfully
[21:34:49] 🔄 
🔄 Step 8: Saving API details...
[21:34:49] [DOC: 9194096] ℹ️  API push details saved for document 9194096
[21:34:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194090                         ║
================================================================================
[21:34:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:34:49] ℹ️  Date: 03/20/2025
[21:34:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:34:50] [DOC: 9194090] ✅ Text extracted using pdfplumber (906 chars)
[21:34:50] ✅    ✅ Text extracted using pdfplumber (906 chars)
[21:34:50] 🔄 
🔄 Step 2: Extracting patient data...
[21:34:53] ℹ️  AI extracted raw sex value: 'F'
[21:34:53] ℹ️  AI extracted service line: 'Physical Therapy'
[21:34:53] ℹ️  AI extracted payer source: ''
[21:34:53] ℹ️  AI extracted diagnoses:
[21:34:53] ℹ️    - Diagnosis 1: ''
[21:34:53] ℹ️    - Diagnosis 2: ''
[21:34:53] ℹ️    - Diagnosis 3: ''
[21:34:53] ℹ️    - Diagnosis 4: ''
[21:34:53] ℹ️    - Diagnosis 5: ''
[21:34:53] ℹ️    - Diagnosis 6: ''
[21:34:53] ℹ️  Final extracted MRN: '2017657'
[21:34:53] ℹ️  Final extracted Sex: 'FEMALE'
[21:34:53] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:34:53] ℹ️  Final extracted Payer Source: ''
[21:34:53] ✅ Patient data extraction completed successfully
[21:34:53] ✅    ✅ Patient data extracted successfully
[21:34:53] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Tripp
     └─ dob: 10/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2017657
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:34:53] ✅    ✅ Patient identified: Theresa Tripp
[21:34:53] ✅    ✅ Patient name validation passed
[21:34:53] 🔄 
🔄 Step 3: Processing patient dates...
[21:34:53] [DOC: 9194090] ℹ️  DOB normalized: 10/28/1964
[21:34:53] [DOC: 9194090] ✅ Patient date processing completed successfully
[21:34:53] ✅    ✅ Date processing completed
[21:34:53] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Tripp
     └─ dob: 10/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2017657
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:34:53] 🔄 
🔄 Step 4: Extracting order data...
[21:34:55] ℹ️  Order extraction - MRN: '2017657'
[21:34:55] ℹ️  Order extraction - Sex: 'FEMALE'
[21:34:55] ℹ️  Order extraction - Service Line: ''
[21:34:55] ℹ️  Order extraction - Payer Source: ''
[21:34:55] ✅ Order data extraction completed successfully
[21:34:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:34:55] ℹ️  Using MRN from patient data: '2017657' over '2017657'
[21:34:55] ℹ️  Using service line from patient data: 'Physical Therapy'
[21:34:55] ✅ Patient name cross-validation successful
[21:34:55] ✅    ✅ Data merged successfully
[21:34:56] ⚠️     ❌ Skipping - missing episode start date
[21:34:56] [DOC: 9194090] ℹ️  API push details saved for document 9194090
================================================================================
║                        Processing Document ID: 9194082                         ║
================================================================================
[21:34:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:34:56] ℹ️  Date: 03/20/2025
[21:34:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:35:26] [DOC: 9194082] ⚠️  Network error attempt 1, retrying...
[21:35:30] [DOC: 9194082] ✅ Text extracted using pdfplumber (1496 chars)
[21:35:30] ✅    ✅ Text extracted using pdfplumber (1496 chars)
[21:35:30] 🔄 
🔄 Step 2: Extracting patient data...
[21:35:33] ℹ️  AI extracted raw sex value: 'M'
[21:35:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:35:33] ℹ️  AI extracted payer source: ''
[21:35:33] ℹ️  AI extracted diagnoses:
[21:35:33] ℹ️    - Diagnosis 1: ''
[21:35:33] ℹ️    - Diagnosis 2: ''
[21:35:33] ℹ️    - Diagnosis 3: ''
[21:35:33] ℹ️    - Diagnosis 4: ''
[21:35:33] ℹ️    - Diagnosis 5: ''
[21:35:33] ℹ️    - Diagnosis 6: ''
[21:35:33] ℹ️  Final extracted MRN: '2944175'
[21:35:33] ℹ️  Final extracted Sex: 'MALE'
[21:35:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:35:33] ℹ️  Final extracted Payer Source: ''
[21:35:33] ✅ Patient data extraction completed successfully
[21:35:33] ✅    ✅ Patient data extracted successfully
[21:35:33] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:35:33] ✅    ✅ Patient identified: Ernest Santos
[21:35:33] ✅    ✅ Patient name validation passed
[21:35:33] 🔄 
🔄 Step 3: Processing patient dates...
[21:35:33] [DOC: 9194082] ℹ️  DOB normalized: 08/29/1944
[21:35:33] [DOC: 9194082] ✅ Patient date processing completed successfully
[21:35:33] ✅    ✅ Date processing completed
[21:35:33] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:35:33] 🔄 
🔄 Step 4: Extracting order data...
[21:35:36] ℹ️  Order extraction - MRN: '2944175'
[21:35:36] ℹ️  Order extraction - Sex: 'MALE'
[21:35:36] ℹ️  Order extraction - Service Line: ''
[21:35:36] ℹ️  Order extraction - Payer Source: ''
[21:35:36] ✅ Order data extraction completed successfully
[21:35:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:35:36] ℹ️  Using MRN from patient data: '2944175' over '2944175'
[21:35:36] ℹ️  Using service line from patient data: 'Skilled Nursing'
[21:35:36] ✅ Patient name cross-validation successful
[21:35:36] ✅    ✅ Data merged successfully
[21:35:37] ✅    ✅ Order data extracted and validated
[21:35:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:35:44] [DOC: 9194082] ℹ️  Patient not found in cache or API: Ernest Santos
[21:35:44] [DOC: 9194082] ℹ️  Patient not found, creating new patient via API...
[21:35:44] [DOC: 9194082] ℹ️  Creating patient via API: Ernest Santos
[21:35:45] [DOC: 9194082] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:35:45] ❌    ❌ Failed to create patient
[21:35:45] [DOC: 9194082] ℹ️  API push details saved for document 9194082
================================================================================
║                        Processing Document ID: 9194076                         ║
================================================================================
[21:35:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:35:45] ℹ️  Date: 03/20/2025
[21:35:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:35:47] [DOC: 9194076] ✅ Text extracted using pdfplumber (1721 chars)
[21:35:47] ✅    ✅ Text extracted using pdfplumber (1721 chars)
[21:35:47] 🔄 
🔄 Step 2: Extracting patient data...
[21:35:49] ℹ️  AI extracted raw sex value: 'M'
[21:35:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:35:49] ℹ️  AI extracted payer source: ''
[21:35:49] ℹ️  AI extracted diagnoses:
[21:35:49] ℹ️    - Diagnosis 1: 'Alzheimers/Dementia'
[21:35:49] ℹ️    - Diagnosis 2: ''
[21:35:49] ℹ️    - Diagnosis 3: ''
[21:35:49] ℹ️    - Diagnosis 4: ''
[21:35:49] ℹ️    - Diagnosis 5: ''
[21:35:49] ℹ️    - Diagnosis 6: ''
[21:35:49] ℹ️  Final extracted MRN: '2944175'
[21:35:49] ℹ️  Final extracted Sex: 'MALE'
[21:35:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:35:49] ℹ️  Final extracted Payer Source: ''
[21:35:49] ✅ Patient data extraction completed successfully
[21:35:49] ✅    ✅ Patient data extracted successfully
[21:35:49] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Alzheimers/Dementia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:35:49] ✅    ✅ Patient identified: Ernest Santos
[21:35:49] ✅    ✅ Patient name validation passed
[21:35:49] 🔄 
🔄 Step 3: Processing patient dates...
[21:35:49] [DOC: 9194076] ℹ️  DOB normalized: 08/29/1944
[21:35:49] [DOC: 9194076] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[21:35:49] [DOC: 9194076] ✅ Patient date processing completed successfully
[21:35:49] ✅    ✅ Date processing completed
[21:35:49] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Alzheimers/Dementia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:35:49] 🔄 
🔄 Step 4: Extracting order data...
[21:35:51] ℹ️  Order extraction - MRN: '2944175'
[21:35:51] ℹ️  Order extraction - Sex: 'MALE'
[21:35:51] ℹ️  Order extraction - Service Line: 'SN'
[21:35:51] ℹ️  Order extraction - Payer Source: ''
[21:35:51] ✅ Order data extraction completed successfully
[21:35:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:35:51] ℹ️  Using MRN from patient data: '2944175' over '2944175'
[21:35:51] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[21:35:51] ✅ Patient name cross-validation successful
[21:35:51] ✅    ✅ Data merged successfully
[21:35:53] ✅    ✅ Order data extracted and validated
[21:35:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:36:45] [DOC: 9194076] ℹ️  Patient not found in cache or API: Ernest Santos
[21:36:45] [DOC: 9194076] ℹ️  Patient not found, creating new patient via API...
[21:36:45] [DOC: 9194076] ℹ️  Creating patient via API: Ernest Santos
[21:36:46] [DOC: 9194076] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:36:46] ❌    ❌ Failed to create patient
[21:36:46] [DOC: 9194076] ℹ️  API push details saved for document 9194076
================================================================================
║                        Processing Document ID: 9194062                         ║
================================================================================
[21:36:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:36:46] ℹ️  Date: 03/20/2025
[21:36:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:36:50] [DOC: 9194062] ✅ Text extracted using pdfplumber (1062 chars)
[21:36:50] ✅    ✅ Text extracted using pdfplumber (1062 chars)
[21:36:50] 🔄 
🔄 Step 2: Extracting patient data...
[21:36:53] ℹ️  AI extracted raw sex value: 'F'
[21:36:53] ℹ️  AI extracted service line: 'RN'
[21:36:53] ℹ️  AI extracted payer source: ''
[21:36:53] ℹ️  AI extracted diagnoses:
[21:36:53] ℹ️    - Diagnosis 1: 'None'
[21:36:53] ℹ️    - Diagnosis 2: 'None'
[21:36:53] ℹ️    - Diagnosis 3: 'None'
[21:36:53] ℹ️    - Diagnosis 4: 'None'
[21:36:53] ℹ️    - Diagnosis 5: 'None'
[21:36:53] ℹ️    - Diagnosis 6: 'None'
[21:36:53] ℹ️  Final extracted MRN: '2848942'
[21:36:53] ℹ️  Final extracted Sex: 'FEMALE'
[21:36:53] ℹ️  Final extracted Service Line: 'RN'
[21:36:53] ℹ️  Final extracted Payer Source: ''
[21:36:53] ✅ Patient data extraction completed successfully
[21:36:53] ✅    ✅ Patient data extracted successfully
[21:36:53] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Phaneuf
     └─ dob: 10/04/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2848942
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:36:53] ✅    ✅ Patient identified: Jean Phaneuf
[21:36:53] ✅    ✅ Patient name validation passed
[21:36:53] 🔄 
🔄 Step 3: Processing patient dates...
[21:36:53] [DOC: 9194062] ℹ️  DOB normalized: 10/04/1956
[21:36:53] [DOC: 9194062] ✅ Patient date processing completed successfully
[21:36:53] ✅    ✅ Date processing completed
[21:36:53] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Phaneuf
     └─ dob: 10/04/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2848942
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:36:53] 🔄 
🔄 Step 4: Extracting order data...
[21:36:55] ℹ️  Order extraction - MRN: '2848942'
[21:36:55] ℹ️  Order extraction - Sex: 'FEMALE'
[21:36:55] ℹ️  Order extraction - Service Line: ''
[21:36:55] ℹ️  Order extraction - Payer Source: ''
[21:36:55] ✅ Order data extraction completed successfully
[21:36:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:36:55] ℹ️  Using MRN from patient data: '2848942' over '2848942'
[21:36:55] ℹ️  Using service line from patient data: 'RN'
[21:36:55] ✅ Patient name cross-validation successful
[21:36:55] ✅    ✅ Data merged successfully
[21:36:56] ✅    ✅ Order data extracted and validated
[21:36:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:37:27] [DOC: 9194062] ℹ️  Patient not found in cache or API: Jean Phaneuf
[21:37:27] [DOC: 9194062] ℹ️  Patient not found, creating new patient via API...
[21:37:27] [DOC: 9194062] ℹ️  Creating patient via API: Jean Phaneuf
[21:37:29] [DOC: 9194062] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:37:29] ❌    ❌ Failed to create patient
[21:37:29] [DOC: 9194062] ℹ️  API push details saved for document 9194062
================================================================================
║                        Processing Document ID: 9194059                         ║
================================================================================
[21:37:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:37:29] ℹ️  Date: 03/20/2025
[21:37:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:37:30] [DOC: 9194059] ✅ Text extracted using pdfplumber (807 chars)
[21:37:30] ✅    ✅ Text extracted using pdfplumber (807 chars)
[21:37:30] 🔄 
🔄 Step 2: Extracting patient data...
[21:37:33] ℹ️  AI extracted raw sex value: 'F'
[21:37:33] ℹ️  AI extracted service line: ''
[21:37:33] ℹ️  AI extracted payer source: ''
[21:37:33] ℹ️  AI extracted diagnoses:
[21:37:33] ℹ️    - Diagnosis 1: ''
[21:37:33] ℹ️    - Diagnosis 2: ''
[21:37:33] ℹ️    - Diagnosis 3: ''
[21:37:33] ℹ️    - Diagnosis 4: ''
[21:37:33] ℹ️    - Diagnosis 5: ''
[21:37:33] ℹ️    - Diagnosis 6: ''
[21:37:33] ℹ️  Final extracted MRN: '2796046'
[21:37:33] ℹ️  Final extracted Sex: 'FEMALE'
[21:37:33] ℹ️  Final extracted Service Line: ''
[21:37:33] ℹ️  Final extracted Payer Source: ''
[21:37:33] ✅ Patient data extraction completed successfully
[21:37:33] ✅    ✅ Patient data extracted successfully
[21:37:33] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:37:33] ✅    ✅ Patient identified: Betty Nunes
[21:37:33] ✅    ✅ Patient name validation passed
[21:37:33] 🔄 
🔄 Step 3: Processing patient dates...
[21:37:33] [DOC: 9194059] ℹ️  DOB normalized: 02/21/1933
[21:37:33] [DOC: 9194059] ✅ Patient date processing completed successfully
[21:37:33] ✅    ✅ Date processing completed
[21:37:33] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:37:33] 🔄 
🔄 Step 4: Extracting order data...
[21:37:35] ℹ️  Order extraction - MRN: '2796046'
[21:37:35] ℹ️  Order extraction - Sex: 'FEMALE'
[21:37:35] ℹ️  Order extraction - Service Line: ''
[21:37:35] ℹ️  Order extraction - Payer Source: ''
[21:37:35] ✅ Order data extraction completed successfully
[21:37:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:37:35] ℹ️  Using MRN from patient data: '2796046' over '2796046'
[21:37:35] ✅ Patient name cross-validation successful
[21:37:35] ✅    ✅ Data merged successfully
[21:37:36] ⚠️     ❌ Skipping - missing episode start date
[21:37:36] [DOC: 9194059] ℹ️  API push details saved for document 9194059
================================================================================
║                        Processing Document ID: 9194055                         ║
================================================================================
[21:37:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:37:36] ℹ️  Date: 03/20/2025
[21:37:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:37:38] [DOC: 9194055] ✅ Text extracted using pdfplumber (7376 chars)
[21:37:38] ✅    ✅ Text extracted using pdfplumber (7376 chars)
[21:37:38] 🔄 
🔄 Step 2: Extracting patient data...
[21:37:41] ℹ️  AI extracted raw sex value: 'F'
[21:37:41] ℹ️  AI extracted service line: 'Hospice'
[21:37:41] ℹ️  AI extracted payer source: ''
[21:37:41] ℹ️  AI extracted diagnoses:
[21:37:41] ℹ️    - Diagnosis 1: 'I69.90'
[21:37:41] ℹ️    - Diagnosis 2: ''
[21:37:41] ℹ️    - Diagnosis 3: ''
[21:37:41] ℹ️    - Diagnosis 4: ''
[21:37:41] ℹ️    - Diagnosis 5: ''
[21:37:41] ℹ️    - Diagnosis 6: ''
[21:37:41] ℹ️  Final extracted MRN: '2796046'
[21:37:41] ℹ️  Final extracted Sex: 'FEMALE'
[21:37:41] ℹ️  Final extracted Service Line: 'Hospice'
[21:37:41] ℹ️  Final extracted Payer Source: ''
[21:37:41] ✅ Patient data extraction completed successfully
[21:37:41] ✅    ✅ Patient data extracted successfully
[21:37:41] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:37:41] ✅    ✅ Patient identified: Betty Nunes
[21:37:41] ✅    ✅ Patient name validation passed
[21:37:41] 🔄 
🔄 Step 3: Processing patient dates...
[21:37:41] [DOC: 9194055] ℹ️  DOB normalized: 02/21/1933
[21:37:41] [DOC: 9194055] ℹ️  Episode startOfCare normalized: 03/19/2025
[21:37:41] [DOC: 9194055] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[21:37:41] [DOC: 9194055] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[21:37:41] [DOC: 9194055] ✅ Patient date processing completed successfully
[21:37:41] ✅    ✅ Date processing completed
[21:37:41] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:37:41] 🔄 
🔄 Step 4: Extracting order data...
[21:37:45] ℹ️  Order extraction - MRN: '2796046'
[21:37:45] ℹ️  Order extraction - Sex: 'FEMALE'
[21:37:45] ℹ️  Order extraction - Service Line: 'RN'
[21:37:45] ℹ️  Order extraction - Payer Source: ''
[21:37:45] ✅ Order data extraction completed successfully
[21:37:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:37:45] ℹ️  Using MRN from patient data: '2796046' over '2796046'
[21:37:45] ℹ️  Combined service lines: Patient='Hospice' + Order='RN' = 'Hospice, RN'
[21:37:45] ✅ Patient name cross-validation successful
[21:37:45] ✅    ✅ Data merged successfully
[21:37:46] ✅    ✅ Order data extracted and validated
[21:37:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:37:46] [DOC: 9194055] ✅ Patient found in local cache: Betty Nunes, ID: 4b03624c-2fcd-456b-a080-3d1ced8d722b
[21:37:46] ✅    ✅ Existing patient found with ID: 4b03624c-2fcd-456b-a080-3d1ced8d722b
[21:37:46] 🔄 
🔄 Step 6: Pushing order to API...
[21:37:46] [DOC: 9194055] ℹ️  Pushing order via API for patient ID: 4b03624c-2fcd-456b-a080-3d1ced8d722b
[21:37:47] [DOC: 9194055] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12928"}
[21:37:47] ❌    ❌ Failed to push order
[21:37:47] 🔄 
🔄 Step 7: Writing to CSV...
[21:37:47] [DOC: 9194055] ℹ️  Calculated age: 92 from DOB: 02/21/1933
[21:37:47] [DOC: 9194055] ℹ️  Service Line extracted: 'Hospice, RN'
[21:37:47] [DOC: 9194055] ℹ️  Payer Source extracted: ''
[21:37:47] [DOC: 9194055] ℹ️  Diagnosis codes being written:
[21:37:47] [DOC: 9194055] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.90'
[21:37:47] [DOC: 9194055] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:37:47] [DOC: 9194055] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:37:47] [DOC: 9194055] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:37:47] [DOC: 9194055] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:37:47] [DOC: 9194055] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:37:47] [DOC: 9194055] ✅ Patient data written to CSV: Betty Nunes | Sex: FEMALE | Age: 92 | Service: Hospice, RN | Payer:  | MRN: 2796046
[21:37:47] ✅    ✅ Document 9194055 processed and saved successfully
[21:37:47] 🔄 
🔄 Step 8: Saving API details...
[21:37:47] [DOC: 9194055] ℹ️  API push details saved for document 9194055
[21:37:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194046                         ║
================================================================================
[21:37:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:37:47] ℹ️  Date: 03/20/2025
[21:37:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:37:49] [DOC: 9194046] ✅ Text extracted using pdfplumber (1020 chars)
[21:37:49] ✅    ✅ Text extracted using pdfplumber (1020 chars)
[21:37:49] 🔄 
🔄 Step 2: Extracting patient data...
[21:37:51] ℹ️  AI extracted raw sex value: 'F'
[21:37:51] ℹ️  AI extracted service line: 'Physical Therapy'
[21:37:51] ℹ️  AI extracted payer source: ''
[21:37:51] ℹ️  AI extracted diagnoses:
[21:37:51] ℹ️    - Diagnosis 1: ''
[21:37:51] ℹ️    - Diagnosis 2: ''
[21:37:51] ℹ️    - Diagnosis 3: ''
[21:37:51] ℹ️    - Diagnosis 4: ''
[21:37:51] ℹ️    - Diagnosis 5: ''
[21:37:51] ℹ️    - Diagnosis 6: ''
[21:37:51] ℹ️  Final extracted MRN: '2794259'
[21:37:51] ℹ️  Final extracted Sex: 'FEMALE'
[21:37:51] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:37:51] ℹ️  Final extracted Payer Source: ''
[21:37:51] ✅ Patient data extraction completed successfully
[21:37:51] ✅    ✅ Patient data extracted successfully
[21:37:51] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:37:51] ✅    ✅ Patient identified: Joyce Normandin
[21:37:51] ✅    ✅ Patient name validation passed
[21:37:51] 🔄 
🔄 Step 3: Processing patient dates...
[21:37:51] [DOC: 9194046] ℹ️  DOB normalized: 09/26/1950
[21:37:51] [DOC: 9194046] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:37:51] [DOC: 9194046] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:37:51] [DOC: 9194046] ✅ Patient date processing completed successfully
[21:37:51] ✅    ✅ Date processing completed
[21:37:51] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:37:51] 🔄 
🔄 Step 4: Extracting order data...
[21:37:54] ℹ️  Order extraction - MRN: '2794259'
[21:37:54] ℹ️  Order extraction - Sex: 'FEMALE'
[21:37:54] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:37:54] ℹ️  Order extraction - Payer Source: ''
[21:37:54] ✅ Order data extraction completed successfully
[21:37:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:37:54] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[21:37:54] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:37:54] ✅ Patient name cross-validation successful
[21:37:54] ✅    ✅ Data merged successfully
[21:37:55] ✅    ✅ Order data extracted and validated
[21:37:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:37:55] [DOC: 9194046] ✅ Patient found in local cache: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[21:37:55] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[21:37:55] 🔄 
🔄 Step 6: Pushing order to API...
[21:37:55] [DOC: 9194046] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[21:37:56] [DOC: 9194046] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12923"}
[21:37:56] ❌    ❌ Failed to push order
[21:37:56] 🔄 
🔄 Step 7: Writing to CSV...
[21:37:56] [DOC: 9194046] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[21:37:56] [DOC: 9194046] ℹ️  Service Line extracted: 'Physical Therapy'
[21:37:56] [DOC: 9194046] ℹ️  Payer Source extracted: ''
[21:37:56] [DOC: 9194046] ℹ️  Diagnosis codes being written:
[21:37:56] [DOC: 9194046] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:37:56] [DOC: 9194046] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:37:56] [DOC: 9194046] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:37:56] [DOC: 9194046] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:37:56] [DOC: 9194046] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:37:56] [DOC: 9194046] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:37:56] [DOC: 9194046] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Physical Therapy | Payer:  | MRN: 2794259
[21:37:56] ✅    ✅ Document 9194046 processed and saved successfully
[21:37:56] 🔄 
🔄 Step 8: Saving API details...
[21:37:56] [DOC: 9194046] ℹ️  API push details saved for document 9194046
[21:37:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194043                         ║
================================================================================
[21:37:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:37:56] ℹ️  Date: 03/20/2025
[21:37:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:38:02] [DOC: 9194043] ✅ Text extracted using pdfplumber (22091 chars)
[21:38:02] ✅    ✅ Text extracted using pdfplumber (22091 chars)
[21:38:02] 🔄 
🔄 Step 2: Extracting patient data...
[21:38:06] ℹ️  AI extracted raw sex value: 'F'
[21:38:06] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide'
[21:38:06] ℹ️  AI extracted payer source: ''
[21:38:06] ℹ️  AI extracted diagnoses:
[21:38:06] ℹ️    - Diagnosis 1: 'I69.393'
[21:38:06] ℹ️    - Diagnosis 2: 'I10'
[21:38:06] ℹ️    - Diagnosis 3: 'I69.322'
[21:38:06] ℹ️    - Diagnosis 4: 'H53.2'
[21:38:06] ℹ️    - Diagnosis 5: 'R41.89'
[21:38:06] ℹ️    - Diagnosis 6: 'E78.2'
[21:38:06] ℹ️  Final extracted MRN: '2794259'
[21:38:06] ℹ️  Final extracted Sex: 'FEMALE'
[21:38:06] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide'
[21:38:06] ℹ️  Final extracted Payer Source: ''
[21:38:06] ✅ Patient data extraction completed successfully
[21:38:06] ✅    ✅ Patient data extracted successfully
[21:38:06] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I69.393', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'H53.2', 'fifthDiagnosis': 'R41.89', 'sixthDiagnosis': 'E78.2'}]
[21:38:06] ✅    ✅ Patient identified: Joyce Normandin
[21:38:06] ✅    ✅ Patient name validation passed
[21:38:06] 🔄 
🔄 Step 3: Processing patient dates...
[21:38:06] [DOC: 9194043] ℹ️  DOB normalized: 09/26/1950
[21:38:06] [DOC: 9194043] ℹ️  Episode startOfCare normalized: 03/07/2025
[21:38:06] [DOC: 9194043] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:38:06] [DOC: 9194043] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:38:06] [DOC: 9194043] ✅ Patient date processing completed successfully
[21:38:06] ✅    ✅ Date processing completed
[21:38:06] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I69.393', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'H53.2', 'fifthDiagnosis': 'R41.89', 'sixthDiagnosis': 'E78.2'}]
[21:38:06] 🔄 
🔄 Step 4: Extracting order data...
[21:38:09] ℹ️  Order extraction - MRN: '2794259'
[21:38:09] ℹ️  Order extraction - Sex: 'FEMALE'
[21:38:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide'
[21:38:09] ℹ️  Order extraction - Payer Source: ''
[21:38:09] ✅ Order data extraction completed successfully
[21:38:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:38:09] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[21:38:09] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[21:38:09] ✅ Patient name cross-validation successful
[21:38:09] ✅    ✅ Data merged successfully
[21:38:10] ✅    ✅ Order data extracted and validated
[21:38:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:38:10] [DOC: 9194043] ✅ Patient found in local cache: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[21:38:10] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[21:38:10] 🔄 
🔄 Step 6: Pushing order to API...
[21:38:10] [DOC: 9194043] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[21:38:11] [DOC: 9194043] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12924"}
[21:38:11] ❌    ❌ Failed to push order
[21:38:11] 🔄 
🔄 Step 7: Writing to CSV...
[21:38:11] [DOC: 9194043] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[21:38:11] [DOC: 9194043] ℹ️  Service Line extracted: 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[21:38:11] [DOC: 9194043] ℹ️  Payer Source extracted: ''
[21:38:11] [DOC: 9194043] ℹ️  Diagnosis codes being written:
[21:38:11] [DOC: 9194043] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.393'
[21:38:11] [DOC: 9194043] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[21:38:11] [DOC: 9194043] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[21:38:11] [DOC: 9194043] ℹ️    - Latest_Episode_Fourthdiagnosis: 'H53.2'
[21:38:11] [DOC: 9194043] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R41.89'
[21:38:11] [DOC: 9194043] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.2'
[21:38:11] [DOC: 9194043] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology | Payer:  | MRN: 2794259
[21:38:11] ✅    ✅ Document 9194043 processed and saved successfully
[21:38:11] 🔄 
🔄 Step 8: Saving API details...
[21:38:11] [DOC: 9194043] ℹ️  API push details saved for document 9194043
[21:38:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194037                         ║
================================================================================
[21:38:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:38:11] ℹ️  Date: 03/20/2025
[21:38:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:38:13] [DOC: 9194037] ✅ Text extracted using pdfplumber (1714 chars)
[21:38:13] ✅    ✅ Text extracted using pdfplumber (1714 chars)
[21:38:13] 🔄 
🔄 Step 2: Extracting patient data...
[21:38:15] ℹ️  AI extracted raw sex value: 'M'
[21:38:15] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[21:38:15] ℹ️  AI extracted payer source: ''
[21:38:15] ℹ️  AI extracted diagnoses:
[21:38:15] ℹ️    - Diagnosis 1: ''
[21:38:15] ℹ️    - Diagnosis 2: ''
[21:38:15] ℹ️    - Diagnosis 3: ''
[21:38:15] ℹ️    - Diagnosis 4: ''
[21:38:15] ℹ️    - Diagnosis 5: ''
[21:38:15] ℹ️    - Diagnosis 6: ''
[21:38:15] ℹ️  Final extracted MRN: '2773750'
[21:38:15] ℹ️  Final extracted Sex: 'MALE'
[21:38:15] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[21:38:15] ℹ️  Final extracted Payer Source: ''
[21:38:15] ✅ Patient data extraction completed successfully
[21:38:15] ✅    ✅ Patient data extracted successfully
[21:38:15] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:38:15] ✅    ✅ Patient identified: Luis Mota
[21:38:15] ✅    ✅ Patient name validation passed
[21:38:15] 🔄 
🔄 Step 3: Processing patient dates...
[21:38:15] [DOC: 9194037] ℹ️  DOB normalized: 12/02/1942
[21:38:15] [DOC: 9194037] ✅ Patient date processing completed successfully
[21:38:15] ✅    ✅ Date processing completed
[21:38:15] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:38:15] 🔄 
🔄 Step 4: Extracting order data...
[21:38:18] ℹ️  Order extraction - MRN: '2773750'
[21:38:18] ℹ️  Order extraction - Sex: 'MALE'
[21:38:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[21:38:18] ℹ️  Order extraction - Payer Source: ''
[21:38:18] ✅ Order data extraction completed successfully
[21:38:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:38:18] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[21:38:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[21:38:18] ✅ Patient name cross-validation successful
[21:38:18] ✅    ✅ Data merged successfully
[21:38:19] ✅    ✅ Order data extracted and validated
[21:38:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:38:59] [DOC: 9194037] ℹ️  Patient not found in cache or API: Luis Mota
[21:38:59] [DOC: 9194037] ℹ️  Patient not found, creating new patient via API...
[21:38:59] [DOC: 9194037] ℹ️  Creating patient via API: Luis Mota
[21:39:03] [DOC: 9194037] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:39:03] ❌    ❌ Failed to create patient
[21:39:03] [DOC: 9194037] ℹ️  API push details saved for document 9194037
================================================================================
║                        Processing Document ID: 9194034                         ║
================================================================================
[21:39:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:39:03] ℹ️  Date: 03/20/2025
[21:39:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:39:04] [DOC: 9194034] ✅ Text extracted using pdfplumber (1299 chars)
[21:39:04] ✅    ✅ Text extracted using pdfplumber (1299 chars)
[21:39:04] 🔄 
🔄 Step 2: Extracting patient data...
[21:39:07] ℹ️  AI extracted raw sex value: 'F'
[21:39:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:39:07] ℹ️  AI extracted payer source: ''
[21:39:07] ℹ️  AI extracted diagnoses:
[21:39:07] ℹ️    - Diagnosis 1: ''
[21:39:07] ℹ️    - Diagnosis 2: ''
[21:39:07] ℹ️    - Diagnosis 3: ''
[21:39:07] ℹ️    - Diagnosis 4: ''
[21:39:07] ℹ️    - Diagnosis 5: ''
[21:39:07] ℹ️    - Diagnosis 6: ''
[21:39:07] ℹ️  Final extracted MRN: '2737072'
[21:39:07] ℹ️  Final extracted Sex: 'FEMALE'
[21:39:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:39:07] ℹ️  Final extracted Payer Source: ''
[21:39:07] ✅ Patient data extraction completed successfully
[21:39:07] ✅    ✅ Patient data extracted successfully
[21:39:07] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:39:07] ✅    ✅ Patient identified: Mary Melancon
[21:39:07] ✅    ✅ Patient name validation passed
[21:39:07] 🔄 
🔄 Step 3: Processing patient dates...
[21:39:07] [DOC: 9194034] ℹ️  DOB normalized: 08/02/1934
[21:39:07] [DOC: 9194034] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[21:39:07] [DOC: 9194034] ✅ Patient date processing completed successfully
[21:39:07] ✅    ✅ Date processing completed
[21:39:07] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:39:07] 🔄 
🔄 Step 4: Extracting order data...
[21:39:09] ℹ️  Order extraction - MRN: '2737072'
[21:39:09] ℹ️  Order extraction - Sex: 'FEMALE'
[21:39:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:39:09] ℹ️  Order extraction - Payer Source: ''
[21:39:09] ✅ Order data extraction completed successfully
[21:39:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:39:09] ℹ️  Using MRN from patient data: '2737072' over '2737072'
[21:39:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:39:09] ✅ Patient name cross-validation successful
[21:39:09] ✅    ✅ Data merged successfully
[21:39:10] ✅    ✅ Order data extracted and validated
[21:39:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:39:10] [DOC: 9194034] ✅ Patient found in local cache: Mary Melancon, ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[21:39:10] ✅    ✅ Existing patient found with ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[21:39:10] 🔄 
🔄 Step 6: Pushing order to API...
[21:39:10] [DOC: 9194034] ℹ️  Pushing order via API for patient ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[21:39:12] [DOC: 9194034] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14621"}
[21:39:12] ❌    ❌ Failed to push order
[21:39:12] 🔄 
🔄 Step 7: Writing to CSV...
[21:39:12] [DOC: 9194034] ℹ️  Calculated age: 90 from DOB: 08/02/1934
[21:39:12] [DOC: 9194034] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:39:12] [DOC: 9194034] ℹ️  Payer Source extracted: ''
[21:39:12] [DOC: 9194034] ℹ️  Diagnosis codes being written:
[21:39:12] [DOC: 9194034] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:39:12] [DOC: 9194034] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:39:12] [DOC: 9194034] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:39:12] [DOC: 9194034] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:39:12] [DOC: 9194034] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:39:12] [DOC: 9194034] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:39:12] [DOC: 9194034] ✅ Patient data written to CSV: Mary Melancon | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: 2737072
[21:39:12] ✅    ✅ Document 9194034 processed and saved successfully
[21:39:12] 🔄 
🔄 Step 8: Saving API details...
[21:39:12] [DOC: 9194034] ℹ️  API push details saved for document 9194034
[21:39:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194031                         ║
================================================================================
[21:39:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:39:12] ℹ️  Date: 03/20/2025
[21:39:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:39:14] [DOC: 9194031] ✅ Text extracted using pdfplumber (1547 chars)
[21:39:14] ✅    ✅ Text extracted using pdfplumber (1547 chars)
[21:39:14] 🔄 
🔄 Step 2: Extracting patient data...
[21:39:16] ℹ️  AI extracted raw sex value: 'M'
[21:39:16] ℹ️  AI extracted service line: 'RN'
[21:39:16] ℹ️  AI extracted payer source: ''
[21:39:16] ℹ️  AI extracted diagnoses:
[21:39:16] ℹ️    - Diagnosis 1: 'None'
[21:39:16] ℹ️    - Diagnosis 2: 'None'
[21:39:16] ℹ️    - Diagnosis 3: 'None'
[21:39:16] ℹ️    - Diagnosis 4: 'None'
[21:39:16] ℹ️    - Diagnosis 5: 'None'
[21:39:16] ℹ️    - Diagnosis 6: 'None'
[21:39:16] ℹ️  Final extracted MRN: '2679776'
[21:39:16] ℹ️  Final extracted Sex: 'MALE'
[21:39:16] ℹ️  Final extracted Service Line: 'RN'
[21:39:16] ℹ️  Final extracted Payer Source: ''
[21:39:16] ✅ Patient data extraction completed successfully
[21:39:16] ✅    ✅ Patient data extracted successfully
[21:39:16] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:39:16] ✅    ✅ Patient identified: Milton MacDonald
[21:39:16] ✅    ✅ Patient name validation passed
[21:39:16] 🔄 
🔄 Step 3: Processing patient dates...
[21:39:16] [DOC: 9194031] ℹ️  DOB normalized: 03/20/1939
[21:39:16] [DOC: 9194031] ✅ Patient date processing completed successfully
[21:39:16] ✅    ✅ Date processing completed
[21:39:16] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:39:16] 🔄 
🔄 Step 4: Extracting order data...
[21:39:19] ℹ️  Order extraction - MRN: '2679776'
[21:39:19] ℹ️  Order extraction - Sex: 'MALE'
[21:39:19] ℹ️  Order extraction - Service Line: ''
[21:39:19] ℹ️  Order extraction - Payer Source: ''
[21:39:19] ✅ Order data extraction completed successfully
[21:39:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:39:19] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[21:39:19] ℹ️  Using service line from patient data: 'RN'
[21:39:19] ✅ Patient name cross-validation successful
[21:39:19] ✅    ✅ Data merged successfully
[21:39:20] ✅    ✅ Order data extracted and validated
[21:39:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:39:20] [DOC: 9194031] ✅ Patient found in local cache: Milton MacDonald, ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[21:39:20] ✅    ✅ Existing patient found with ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[21:39:20] 🔄 
🔄 Step 6: Pushing order to API...
[21:39:20] [DOC: 9194031] ℹ️  Pushing order via API for patient ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[21:39:21] [DOC: 9194031] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20081"}
[21:39:21] ❌    ❌ Failed to push order
[21:39:21] 🔄 
🔄 Step 7: Writing to CSV...
[21:39:21] [DOC: 9194031] ℹ️  Calculated age: 86 from DOB: 03/20/1939
[21:39:21] [DOC: 9194031] ℹ️  Service Line extracted: 'RN'
[21:39:21] [DOC: 9194031] ℹ️  Payer Source extracted: ''
[21:39:21] [DOC: 9194031] ℹ️  Diagnosis codes being written:
[21:39:21] [DOC: 9194031] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:39:21] [DOC: 9194031] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:39:21] [DOC: 9194031] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:39:21] [DOC: 9194031] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:39:21] [DOC: 9194031] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:39:21] [DOC: 9194031] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:39:21] [DOC: 9194031] ✅ Patient data written to CSV: Milton MacDonald | Sex: MALE | Age: 86 | Service: RN | Payer:  | MRN: 2679776
[21:39:21] ✅    ✅ Document 9194031 processed and saved successfully
[21:39:21] 🔄 
🔄 Step 8: Saving API details...
[21:39:21] [DOC: 9194031] ℹ️  API push details saved for document 9194031
[21:39:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194027                         ║
================================================================================
[21:39:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:39:21] ℹ️  Date: 03/20/2025
[21:39:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:39:22] [DOC: 9194027] ✅ Text extracted using pdfplumber (1063 chars)
[21:39:22] ✅    ✅ Text extracted using pdfplumber (1063 chars)
[21:39:22] 🔄 
🔄 Step 2: Extracting patient data...
[21:39:25] ℹ️  AI extracted raw sex value: 'M'
[21:39:25] ℹ️  AI extracted service line: 'Physical Therapy'
[21:39:25] ℹ️  AI extracted payer source: ''
[21:39:25] ℹ️  AI extracted diagnoses:
[21:39:25] ℹ️    - Diagnosis 1: ''
[21:39:25] ℹ️    - Diagnosis 2: ''
[21:39:25] ℹ️    - Diagnosis 3: ''
[21:39:25] ℹ️    - Diagnosis 4: ''
[21:39:25] ℹ️    - Diagnosis 5: ''
[21:39:25] ℹ️    - Diagnosis 6: ''
[21:39:25] ℹ️  Final extracted MRN: '2648815'
[21:39:25] ℹ️  Final extracted Sex: 'MALE'
[21:39:25] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:39:25] ℹ️  Final extracted Payer Source: ''
[21:39:25] ✅ Patient data extraction completed successfully
[21:39:25] ✅    ✅ Patient data extracted successfully
[21:39:25] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:39:25] ✅    ✅ Patient identified: Robert Ledoux
[21:39:25] ✅    ✅ Patient name validation passed
[21:39:25] 🔄 
🔄 Step 3: Processing patient dates...
[21:39:25] [DOC: 9194027] ℹ️  DOB normalized: 04/07/1968
[21:39:25] [DOC: 9194027] ✅ Patient date processing completed successfully
[21:39:25] ✅    ✅ Date processing completed
[21:39:25] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:39:25] 🔄 
🔄 Step 4: Extracting order data...
[21:39:27] ℹ️  Order extraction - MRN: '2648815'
[21:39:27] ℹ️  Order extraction - Sex: 'MALE'
[21:39:27] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:39:27] ℹ️  Order extraction - Payer Source: ''
[21:39:27] ✅ Order data extraction completed successfully
[21:39:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:39:27] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[21:39:27] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:39:27] ✅ Patient name cross-validation successful
[21:39:27] ✅    ✅ Data merged successfully
[21:39:31] ✅    ✅ Order data extracted and validated
[21:39:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:39:57] [DOC: 9194027] ℹ️  Patient not found in cache or API: Robert Ledoux
[21:39:57] [DOC: 9194027] ℹ️  Patient not found, creating new patient via API...
[21:39:57] [DOC: 9194027] ℹ️  Creating patient via API: Robert Ledoux
[21:39:59] [DOC: 9194027] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:39:59] ❌    ❌ Failed to create patient
[21:39:59] [DOC: 9194027] ℹ️  API push details saved for document 9194027
================================================================================
║                        Processing Document ID: 9194022                         ║
================================================================================
[21:39:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:39:59] ℹ️  Date: 03/20/2025
[21:39:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:40:02] [DOC: 9194022] ✅ Text extracted using pdfplumber (22838 chars)
[21:40:02] ✅    ✅ Text extracted using pdfplumber (22838 chars)
[21:40:02] 🔄 
🔄 Step 2: Extracting patient data...
[21:40:05] ℹ️  AI extracted raw sex value: 'M'
[21:40:05] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:40:05] ℹ️  AI extracted payer source: ''
[21:40:05] ℹ️  AI extracted diagnoses:
[21:40:05] ℹ️    - Diagnosis 1: 'Z47.89'
[21:40:05] ℹ️    - Diagnosis 2: 'M17.12'
[21:40:05] ℹ️    - Diagnosis 3: 'J44.1'
[21:40:05] ℹ️    - Diagnosis 4: 'I12.9'
[21:40:05] ℹ️    - Diagnosis 5: 'E11.22'
[21:40:05] ℹ️    - Diagnosis 6: 'N18.30'
[21:40:06] ℹ️  Final extracted MRN: '2648815'
[21:40:06] ℹ️  Final extracted Sex: 'MALE'
[21:40:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:40:06] ℹ️  Final extracted Payer Source: ''
[21:40:06] ✅ Patient data extraction completed successfully
[21:40:06] ✅    ✅ Patient data extracted successfully
[21:40:06] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 28 Durfee St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-5549
     └─ email: 
     └─ phoneNumber: 508-509-6628
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M17.12', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[21:40:06] ✅    ✅ Patient identified: Robert Ledoux
[21:40:06] ✅    ✅ Patient name validation passed
[21:40:06] 🔄 
🔄 Step 3: Processing patient dates...
[21:40:06] [DOC: 9194022] ℹ️  DOB normalized: 04/07/1968
[21:40:06] [DOC: 9194022] ℹ️  Episode startOfCare normalized: 03/08/2025
[21:40:06] [DOC: 9194022] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:40:06] [DOC: 9194022] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:40:06] [DOC: 9194022] ✅ Patient date processing completed successfully
[21:40:06] ✅    ✅ Date processing completed
[21:40:06] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 28 Durfee St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-5549
     └─ email: 
     └─ phoneNumber: 508-509-6628
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M17.12', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[21:40:06] 🔄 
🔄 Step 4: Extracting order data...
[21:40:08] ℹ️  Order extraction - MRN: '2648815'
[21:40:08] ℹ️  Order extraction - Sex: 'MALE'
[21:40:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[21:40:08] ℹ️  Order extraction - Payer Source: ''
[21:40:08] ✅ Order data extraction completed successfully
[21:40:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:40:08] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[21:40:08] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[21:40:08] ✅ Patient name cross-validation successful
[21:40:08] ✅    ✅ Data merged successfully
[21:40:10] ✅    ✅ Order data extracted and validated
[21:40:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:40:40] [DOC: 9194022] ℹ️  Patient not found in cache or API: Robert Ledoux
[21:40:40] [DOC: 9194022] ℹ️  Patient not found, creating new patient via API...
[21:40:40] [DOC: 9194022] ℹ️  Creating patient via API: Robert Ledoux
[21:40:41] [DOC: 9194022] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:40:41] ❌    ❌ Failed to create patient
[21:40:41] [DOC: 9194022] ℹ️  API push details saved for document 9194022
================================================================================
║                        Processing Document ID: 9194018                         ║
================================================================================
[21:40:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:40:41] ℹ️  Date: 03/20/2025
[21:40:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:40:43] [DOC: 9194018] ✅ Text extracted using pdfplumber (1064 chars)
[21:40:43] ✅    ✅ Text extracted using pdfplumber (1064 chars)
[21:40:43] 🔄 
🔄 Step 2: Extracting patient data...
[21:40:45] ℹ️  AI extracted raw sex value: 'F'
[21:40:45] ℹ️  AI extracted service line: 'Physical Therapy'
[21:40:45] ℹ️  AI extracted payer source: ''
[21:40:45] ℹ️  AI extracted diagnoses:
[21:40:45] ℹ️    - Diagnosis 1: ''
[21:40:45] ℹ️    - Diagnosis 2: ''
[21:40:45] ℹ️    - Diagnosis 3: ''
[21:40:45] ℹ️    - Diagnosis 4: ''
[21:40:45] ℹ️    - Diagnosis 5: ''
[21:40:45] ℹ️    - Diagnosis 6: ''
[21:40:45] ℹ️  Final extracted MRN: '2104551'
[21:40:45] ℹ️  Final extracted Sex: 'FEMALE'
[21:40:45] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:40:45] ℹ️  Final extracted Payer Source: ''
[21:40:45] ✅ Patient data extraction completed successfully
[21:40:45] ✅    ✅ Patient data extracted successfully
[21:40:45] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: Keough
     └─ dob: 06/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104551
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:40:45] ✅    ✅ Patient identified: Jacqueline Keough
[21:40:45] ✅    ✅ Patient name validation passed
[21:40:45] 🔄 
🔄 Step 3: Processing patient dates...
[21:40:45] [DOC: 9194018] ℹ️  DOB normalized: 06/29/1942
[21:40:45] [DOC: 9194018] ✅ Patient date processing completed successfully
[21:40:45] ✅    ✅ Date processing completed
[21:40:45] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: Keough
     └─ dob: 06/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104551
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:40:45] 🔄 
🔄 Step 4: Extracting order data...
[21:40:48] ℹ️  Order extraction - MRN: '2104551'
[21:40:48] ℹ️  Order extraction - Sex: 'FEMALE'
[21:40:48] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:40:48] ℹ️  Order extraction - Payer Source: ''
[21:40:48] ✅ Order data extraction completed successfully
[21:40:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:40:48] ℹ️  Using MRN from patient data: '2104551' over '2104551'
[21:40:48] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:40:48] ✅ Patient name cross-validation successful
[21:40:48] ✅    ✅ Data merged successfully
[21:40:49] ✅    ✅ Order data extracted and validated
[21:40:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:40:49] [DOC: 9194018] ✅ Patient found in local cache: Jacqueline Keough, ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[21:40:49] ✅    ✅ Existing patient found with ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[21:40:49] 🔄 
🔄 Step 6: Pushing order to API...
[21:40:49] [DOC: 9194018] ℹ️  Pushing order via API for patient ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[21:40:50] [DOC: 9194018] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13102"}
[21:40:50] ❌    ❌ Failed to push order
[21:40:50] 🔄 
🔄 Step 7: Writing to CSV...
[21:40:50] [DOC: 9194018] ℹ️  Calculated age: 82 from DOB: 06/29/1942
[21:40:50] [DOC: 9194018] ℹ️  Service Line extracted: 'Physical Therapy'
[21:40:50] [DOC: 9194018] ℹ️  Payer Source extracted: ''
[21:40:50] [DOC: 9194018] ℹ️  Diagnosis codes being written:
[21:40:50] [DOC: 9194018] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:40:50] [DOC: 9194018] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:40:50] [DOC: 9194018] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:40:50] [DOC: 9194018] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:40:50] [DOC: 9194018] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:40:50] [DOC: 9194018] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:40:50] [DOC: 9194018] ✅ Patient data written to CSV: Jacqueline Keough | Sex: FEMALE | Age: 82 | Service: Physical Therapy | Payer:  | MRN: 2104551
[21:40:50] ✅    ✅ Document 9194018 processed and saved successfully
[21:40:50] 🔄 
🔄 Step 8: Saving API details...
[21:40:50] [DOC: 9194018] ℹ️  API push details saved for document 9194018
[21:40:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194015                         ║
================================================================================
[21:40:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:40:50] ℹ️  Date: 03/20/2025
[21:40:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:40:51] [DOC: 9194015] ✅ Text extracted using pdfplumber (1186 chars)
[21:40:51] ✅    ✅ Text extracted using pdfplumber (1186 chars)
[21:40:51] 🔄 
🔄 Step 2: Extracting patient data...
[21:40:54] ℹ️  AI extracted raw sex value: 'F'
[21:40:54] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:40:54] ℹ️  AI extracted payer source: ''
[21:40:54] ℹ️  AI extracted diagnoses:
[21:40:54] ℹ️    - Diagnosis 1: ''
[21:40:54] ℹ️    - Diagnosis 2: ''
[21:40:54] ℹ️    - Diagnosis 3: ''
[21:40:54] ℹ️    - Diagnosis 4: ''
[21:40:54] ℹ️    - Diagnosis 5: ''
[21:40:54] ℹ️    - Diagnosis 6: ''
[21:40:54] ℹ️  Final extracted MRN: '2530633'
[21:40:54] ℹ️  Final extracted Sex: 'FEMALE'
[21:40:54] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:40:54] ℹ️  Final extracted Payer Source: ''
[21:40:54] ✅ Patient data extraction completed successfully
[21:40:54] ✅    ✅ Patient data extracted successfully
[21:40:54] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Goulart
     └─ dob: 06/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2530633
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:40:54] ✅    ✅ Patient identified: Beverly Goulart
[21:40:54] ✅    ✅ Patient name validation passed
[21:40:54] 🔄 
🔄 Step 3: Processing patient dates...
[21:40:54] [DOC: 9194015] ℹ️  DOB normalized: 06/08/1936
[21:40:54] [DOC: 9194015] ✅ Patient date processing completed successfully
[21:40:54] ✅    ✅ Date processing completed
[21:40:54] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Goulart
     └─ dob: 06/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2530633
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:40:54] 🔄 
🔄 Step 4: Extracting order data...
[21:40:57] ℹ️  Order extraction - MRN: '2530633'
[21:40:57] ℹ️  Order extraction - Sex: 'FEMALE'
[21:40:57] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:40:57] ℹ️  Order extraction - Payer Source: ''
[21:40:57] ✅ Order data extraction completed successfully
[21:40:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:40:57] ℹ️  Using MRN from patient data: '2530633' over '2530633'
[21:40:57] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:40:57] ✅ Patient name cross-validation successful
[21:40:57] ✅    ✅ Data merged successfully
[21:40:59] ✅    ✅ Order data extracted and validated
[21:40:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:41:13] [DOC: 9194015] ℹ️  Patient not found in cache or API: Beverly Goulart
[21:41:13] [DOC: 9194015] ℹ️  Patient not found, creating new patient via API...
[21:41:13] [DOC: 9194015] ℹ️  Creating patient via API: Beverly Goulart
[21:41:14] [DOC: 9194015] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:41:14] ❌    ❌ Failed to create patient
[21:41:14] [DOC: 9194015] ℹ️  API push details saved for document 9194015
================================================================================
║                        Processing Document ID: 9194001                         ║
================================================================================
[21:41:14] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:41:14] ℹ️  Date: 03/20/2025
[21:41:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:41:18] [DOC: 9194001] ✅ Text extracted using pdfplumber (14341 chars)
[21:41:18] ✅    ✅ Text extracted using pdfplumber (14341 chars)
[21:41:18] 🔄 
🔄 Step 2: Extracting patient data...
[21:41:21] ℹ️  AI extracted raw sex value: 'F'
[21:41:21] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[21:41:21] ℹ️  AI extracted payer source: ''
[21:41:21] ℹ️  AI extracted diagnoses:
[21:41:21] ℹ️    - Diagnosis 1: 'I26.99'
[21:41:21] ℹ️    - Diagnosis 2: 'I10'
[21:41:21] ℹ️    - Diagnosis 3: 'J10.1'
[21:41:21] ℹ️    - Diagnosis 4: 'E78.00'
[21:41:21] ℹ️    - Diagnosis 5: 'R91.1'
[21:41:21] ℹ️    - Diagnosis 6: 'Z79.01'
[21:41:21] ℹ️  Final extracted MRN: '2459108'
[21:41:21] ℹ️  Final extracted Sex: 'FEMALE'
[21:41:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[21:41:21] ℹ️  Final extracted Payer Source: ''
[21:41:21] ✅ Patient data extraction completed successfully
[21:41:21] ✅    ✅ Patient data extracted successfully
[21:41:21] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: Feener
     └─ dob: 09/28/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2459108
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'J10.1', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'R91.1', 'sixthDiagnosis': 'Z79.01'}]
[21:41:21] ✅    ✅ Patient identified: Jacqueline Feener
[21:41:21] ✅    ✅ Patient name validation passed
[21:41:21] 🔄 
🔄 Step 3: Processing patient dates...
[21:41:21] [DOC: 9194001] ℹ️  DOB normalized: 09/28/1944
[21:41:21] [DOC: 9194001] ℹ️  Episode startOfCare normalized: 03/04/2025
[21:41:21] [DOC: 9194001] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[21:41:21] [DOC: 9194001] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[21:41:21] [DOC: 9194001] ✅ Patient date processing completed successfully
[21:41:21] ✅    ✅ Date processing completed
[21:41:21] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: Feener
     └─ dob: 09/28/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2459108
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'J10.1', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'R91.1', 'sixthDiagnosis': 'Z79.01'}]
[21:41:21] 🔄 
🔄 Step 4: Extracting order data...
[21:41:24] ℹ️  Order extraction - MRN: '2459108'
[21:41:24] ℹ️  Order extraction - Sex: 'FEMALE'
[21:41:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy'
[21:41:24] ℹ️  Order extraction - Payer Source: ''
[21:41:24] ✅ Order data extraction completed successfully
[21:41:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:41:24] ℹ️  Using MRN from patient data: '2459108' over '2459108'
[21:41:24] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing,Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[21:41:24] ✅ Patient name cross-validation successful
[21:41:24] ✅    ✅ Data merged successfully
[21:41:25] ✅    ✅ Order data extracted and validated
[21:41:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:42:04] [DOC: 9194001] ℹ️  Patient not found in cache or API: Jacqueline Feener
[21:42:04] [DOC: 9194001] ℹ️  Patient not found, creating new patient via API...
[21:42:04] [DOC: 9194001] ℹ️  Creating patient via API: Jacqueline Feener
[21:42:05] [DOC: 9194001] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:42:05] ❌    ❌ Failed to create patient
[21:42:05] [DOC: 9194001] ℹ️  API push details saved for document 9194001
================================================================================
║                        Processing Document ID: 9193996                         ║
================================================================================
[21:42:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:42:05] ℹ️  Date: 03/20/2025
[21:42:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:42:08] [DOC: 9193996] ✅ Text extracted using pdfplumber (18351 chars)
[21:42:08] ✅    ✅ Text extracted using pdfplumber (18351 chars)
[21:42:08] 🔄 
🔄 Step 2: Extracting patient data...
[21:42:11] ℹ️  AI extracted raw sex value: 'M'
[21:42:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:42:11] ℹ️  AI extracted payer source: ''
[21:42:11] ℹ️  AI extracted diagnoses:
[21:42:11] ℹ️    - Diagnosis 1: 'I11.0'
[21:42:11] ℹ️    - Diagnosis 2: 'I50.23'
[21:42:11] ℹ️    - Diagnosis 3: 'E11.29'
[21:42:11] ℹ️    - Diagnosis 4: 'D50.0'
[21:42:11] ℹ️    - Diagnosis 5: 'E11.51'
[21:42:11] ℹ️    - Diagnosis 6: 'I25.10'
[21:42:11] ℹ️  Final extracted MRN: '2106160'
[21:42:11] ℹ️  Final extracted Sex: 'MALE'
[21:42:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:42:11] ℹ️  Final extracted Payer Source: ''
[21:42:11] ✅ Patient data extraction completed successfully
[21:42:11] ✅    ✅ Patient data extracted successfully
[21:42:11] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Demello
     └─ dob: 03/22/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 2106160
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'E11.29', 'fourthDiagnosis': 'D50.0', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'I25.10'}]
[21:42:11] ✅    ✅ Patient identified: Manuel Demello
[21:42:11] ✅    ✅ Patient name validation passed
[21:42:11] 🔄 
🔄 Step 3: Processing patient dates...
[21:42:11] [DOC: 9193996] ℹ️  DOB normalized: 03/22/1945
[21:42:11] [DOC: 9193996] ℹ️  Episode startOfCare normalized: 03/09/2025
[21:42:11] [DOC: 9193996] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[21:42:11] [DOC: 9193996] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[21:42:11] [DOC: 9193996] ✅ Patient date processing completed successfully
[21:42:11] ✅    ✅ Date processing completed
[21:42:11] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Demello
     └─ dob: 03/22/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 2106160
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'E11.29', 'fourthDiagnosis': 'D50.0', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'I25.10'}]
[21:42:11] 🔄 
🔄 Step 4: Extracting order data...
[21:42:14] ℹ️  Order extraction - MRN: '2106160'
[21:42:14] ℹ️  Order extraction - Sex: 'MALE'
[21:42:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:42:14] ℹ️  Order extraction - Payer Source: ''
[21:42:14] ✅ Order data extraction completed successfully
[21:42:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:42:14] ℹ️  Using MRN from patient data: '2106160' over '2106160'
[21:42:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:42:14] ✅ Patient name cross-validation successful
[21:42:14] ✅    ✅ Data merged successfully
[21:42:15] ✅    ✅ Order data extracted and validated
[21:42:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:42:15] [DOC: 9193996] ✅ Patient found in local cache: Manuel Demello, ID: 54784569-a65e-445e-be68-20a38f0b9a63
[21:42:15] ✅    ✅ Existing patient found with ID: 54784569-a65e-445e-be68-20a38f0b9a63
[21:42:15] 🔄 
🔄 Step 6: Pushing order to API...
[21:42:15] [DOC: 9193996] ℹ️  Pushing order via API for patient ID: 54784569-a65e-445e-be68-20a38f0b9a63
[21:42:16] [DOC: 9193996] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20082"}
[21:42:16] ❌    ❌ Failed to push order
[21:42:16] 🔄 
🔄 Step 7: Writing to CSV...
[21:42:16] [DOC: 9193996] ℹ️  Calculated age: 80 from DOB: 03/22/1945
[21:42:16] [DOC: 9193996] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:42:16] [DOC: 9193996] ℹ️  Payer Source extracted: ''
[21:42:16] [DOC: 9193996] ℹ️  Diagnosis codes being written:
[21:42:16] [DOC: 9193996] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[21:42:16] [DOC: 9193996] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.23'
[21:42:16] [DOC: 9193996] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.29'
[21:42:16] [DOC: 9193996] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.0'
[21:42:16] [DOC: 9193996] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.51'
[21:42:16] [DOC: 9193996] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[21:42:16] [DOC: 9193996] ✅ Patient data written to CSV: Manuel Demello | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: 2106160
[21:42:16] ✅    ✅ Document 9193996 processed and saved successfully
[21:42:16] 🔄 
🔄 Step 8: Saving API details...
[21:42:16] [DOC: 9193996] ℹ️  API push details saved for document 9193996
[21:42:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193994                         ║
================================================================================
[21:42:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:42:16] ℹ️  Date: 03/20/2025
[21:42:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:42:18] [DOC: 9193994] ✅ Text extracted using pdfplumber (983 chars)
[21:42:18] ✅    ✅ Text extracted using pdfplumber (983 chars)
[21:42:18] 🔄 
🔄 Step 2: Extracting patient data...
[21:42:20] ℹ️  AI extracted raw sex value: 'F'
[21:42:20] ℹ️  AI extracted service line: 'OT'
[21:42:20] ℹ️  AI extracted payer source: ''
[21:42:20] ℹ️  AI extracted diagnoses:
[21:42:20] ℹ️    - Diagnosis 1: ''
[21:42:20] ℹ️    - Diagnosis 2: ''
[21:42:20] ℹ️    - Diagnosis 3: ''
[21:42:20] ℹ️    - Diagnosis 4: ''
[21:42:20] ℹ️    - Diagnosis 5: ''
[21:42:20] ℹ️    - Diagnosis 6: ''
[21:42:20] ℹ️  Final extracted MRN: '2397060'
[21:42:20] ℹ️  Final extracted Sex: 'FEMALE'
[21:42:20] ℹ️  Final extracted Service Line: 'OT'
[21:42:20] ℹ️  Final extracted Payer Source: ''
[21:42:20] ✅ Patient data extraction completed successfully
[21:42:20] ✅    ✅ Patient data extracted successfully
[21:42:20] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Defrias
     └─ dob: 11/25/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2397060
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:42:20] ✅    ✅ Patient identified: Maria Defrias
[21:42:20] ✅    ✅ Patient name validation passed
[21:42:20] 🔄 
🔄 Step 3: Processing patient dates...
[21:42:20] [DOC: 9193994] ℹ️  DOB normalized: 11/25/1941
[21:42:20] [DOC: 9193994] ✅ Patient date processing completed successfully
[21:42:20] ✅    ✅ Date processing completed
[21:42:20] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Defrias
     └─ dob: 11/25/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2397060
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:42:20] 🔄 
🔄 Step 4: Extracting order data...
[21:42:22] ℹ️  Order extraction - MRN: '2397060'
[21:42:22] ℹ️  Order extraction - Sex: 'FEMALE'
[21:42:22] ℹ️  Order extraction - Service Line: ''
[21:42:22] ℹ️  Order extraction - Payer Source: ''
[21:42:22] ✅ Order data extraction completed successfully
[21:42:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:42:22] ℹ️  Using MRN from patient data: '2397060' over '2397060'
[21:42:22] ℹ️  Using service line from patient data: 'OT'
[21:42:22] ✅ Patient name cross-validation successful
[21:42:22] ✅    ✅ Data merged successfully
[21:42:23] ⚠️     ❌ Skipping - missing episode start date
[21:42:23] [DOC: 9193994] ℹ️  API push details saved for document 9193994
================================================================================
║                        Processing Document ID: 9193993                         ║
================================================================================
[21:42:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:42:23] ℹ️  Date: 03/20/2025
[21:42:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:42:27] [DOC: 9193993] ✅ Text extracted using pdfplumber (1595 chars)
[21:42:27] ✅    ✅ Text extracted using pdfplumber (1595 chars)
[21:42:27] 🔄 
🔄 Step 2: Extracting patient data...
[21:42:30] ℹ️  AI extracted raw sex value: 'F'
[21:42:30] ℹ️  AI extracted service line: 'Medical Social Work'
[21:42:30] ℹ️  AI extracted payer source: ''
[21:42:30] ℹ️  AI extracted diagnoses:
[21:42:30] ℹ️    - Diagnosis 1: ''
[21:42:30] ℹ️    - Diagnosis 2: ''
[21:42:30] ℹ️    - Diagnosis 3: ''
[21:42:30] ℹ️    - Diagnosis 4: ''
[21:42:30] ℹ️    - Diagnosis 5: ''
[21:42:30] ℹ️    - Diagnosis 6: ''
[21:42:30] ℹ️  Final extracted MRN: '2385572'
[21:42:30] ℹ️  Final extracted Sex: 'FEMALE'
[21:42:30] ℹ️  Final extracted Service Line: 'Medical Social Work'
[21:42:30] ℹ️  Final extracted Payer Source: ''
[21:42:30] ✅ Patient data extraction completed successfully
[21:42:30] ✅    ✅ Patient data extracted successfully
[21:42:30] 📊 Patient Response
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:42:30] ✅    ✅ Patient identified: Anneliese Darling
[21:42:30] ✅    ✅ Patient name validation passed
[21:42:30] 🔄 
🔄 Step 3: Processing patient dates...
[21:42:30] [DOC: 9193993] ℹ️  DOB normalized: 10/19/1927
[21:42:30] [DOC: 9193993] ✅ Patient date processing completed successfully
[21:42:30] ✅    ✅ Date processing completed
[21:42:30] 📊 Processed Patient Data
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:42:30] 🔄 
🔄 Step 4: Extracting order data...
[21:42:32] ℹ️  Order extraction - MRN: '2385572'
[21:42:32] ℹ️  Order extraction - Sex: 'FEMALE'
[21:42:32] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[21:42:32] ℹ️  Order extraction - Payer Source: ''
[21:42:32] ✅ Order data extraction completed successfully
[21:42:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:42:32] ℹ️  Using MRN from patient data: '2385572' over '2385572'
[21:42:32] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[21:42:32] ✅ Patient name cross-validation successful
[21:42:32] ✅    ✅ Data merged successfully
[21:42:33] ✅    ✅ Order data extracted and validated
[21:42:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:42:33] [DOC: 9193993] ✅ Patient found in local cache: Anneliese Darling, ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:42:33] ✅    ✅ Existing patient found with ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:42:33] 🔄 
🔄 Step 6: Pushing order to API...
[21:42:33] [DOC: 9193993] ℹ️  Pushing order via API for patient ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:42:35] [DOC: 9193993] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20083"}
[21:42:35] ❌    ❌ Failed to push order
[21:42:35] 🔄 
🔄 Step 7: Writing to CSV...
[21:42:35] [DOC: 9193993] ℹ️  Calculated age: 97 from DOB: 10/19/1927
[21:42:35] [DOC: 9193993] ℹ️  Service Line extracted: 'Medical Social Work'
[21:42:35] [DOC: 9193993] ℹ️  Payer Source extracted: ''
[21:42:35] [DOC: 9193993] ℹ️  Diagnosis codes being written:
[21:42:35] [DOC: 9193993] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:42:35] [DOC: 9193993] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:42:35] [DOC: 9193993] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:42:35] [DOC: 9193993] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:42:35] [DOC: 9193993] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:42:35] [DOC: 9193993] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:42:35] [DOC: 9193993] ✅ Patient data written to CSV: Anneliese Darling | Sex: FEMALE | Age: 97 | Service: Medical Social Work | Payer:  | MRN: 2385572
[21:42:35] ✅    ✅ Document 9193993 processed and saved successfully
[21:42:35] 🔄 
🔄 Step 8: Saving API details...
[21:42:35] [DOC: 9193993] ℹ️  API push details saved for document 9193993
[21:42:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193992                         ║
================================================================================
[21:42:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:42:35] ℹ️  Date: 03/20/2025
[21:42:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:42:43] [DOC: 9193992] ✅ Text extracted using pdfplumber (29116 chars)
[21:42:43] ✅    ✅ Text extracted using pdfplumber (29116 chars)
[21:42:43] 🔄 
🔄 Step 2: Extracting patient data...
[21:42:46] ℹ️  AI extracted raw sex value: 'F'
[21:42:46] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[21:42:46] ℹ️  AI extracted payer source: ''
[21:42:46] ℹ️  AI extracted diagnoses:
[21:42:46] ℹ️    - Diagnosis 1: 'E43'
[21:42:46] ℹ️    - Diagnosis 2: 'S32.592S'
[21:42:46] ℹ️    - Diagnosis 3: 'W19.XXXS'
[21:42:46] ℹ️    - Diagnosis 4: 'J18.9'
[21:42:46] ℹ️    - Diagnosis 5: 'A04.72'
[21:42:46] ℹ️    - Diagnosis 6: 'K59.09'
[21:42:46] ℹ️  Final extracted MRN: '2385572'
[21:42:46] ℹ️  Final extracted Sex: 'FEMALE'
[21:42:46] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[21:42:46] ℹ️  Final extracted Payer Source: ''
[21:42:46] ✅ Patient data extraction completed successfully
[21:42:46] ✅    ✅ Patient data extracted successfully
[21:42:46] 📊 Patient Response
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[21:42:46] ✅    ✅ Patient identified: Anneliese Darling
[21:42:46] ✅    ✅ Patient name validation passed
[21:42:46] 🔄 
🔄 Step 3: Processing patient dates...
[21:42:46] [DOC: 9193992] ℹ️  DOB normalized: 10/19/1927
[21:42:46] [DOC: 9193992] ℹ️  Episode startOfCare normalized: 03/18/2025
[21:42:46] [DOC: 9193992] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[21:42:46] [DOC: 9193992] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[21:42:46] [DOC: 9193992] ✅ Patient date processing completed successfully
[21:42:46] ✅    ✅ Date processing completed
[21:42:46] 📊 Processed Patient Data
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[21:42:46] 🔄 
🔄 Step 4: Extracting order data...
[21:42:49] ℹ️  Order extraction - MRN: '2385572'
[21:42:49] ℹ️  Order extraction - Sex: 'FEMALE'
[21:42:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA, Clergy'
[21:42:49] ℹ️  Order extraction - Payer Source: ''
[21:42:49] ✅ Order data extraction completed successfully
[21:42:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:42:49] ℹ️  Using MRN from patient data: '2385572' over '2385572'
[21:42:49] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, Home Health Aide' + Order='Skilled Nursing, MSW, HHA, Clergy' = 'Clergy, HHA, Home Health Aide, MSW, Skilled Nursing'
[21:42:49] ✅ Patient name cross-validation successful
[21:42:49] ✅    ✅ Data merged successfully
[21:42:50] ✅    ✅ Order data extracted and validated
[21:42:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:42:50] [DOC: 9193992] ✅ Patient found in local cache: Anneliese Darling, ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:42:50] ✅    ✅ Existing patient found with ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:42:50] 🔄 
🔄 Step 6: Pushing order to API...
[21:42:50] [DOC: 9193992] ℹ️  Pushing order via API for patient ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:42:52] [DOC: 9193992] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14628"}
[21:42:52] ❌    ❌ Failed to push order
[21:42:52] 🔄 
🔄 Step 7: Writing to CSV...
[21:42:52] [DOC: 9193992] ℹ️  Calculated age: 97 from DOB: 10/19/1927
[21:42:52] [DOC: 9193992] ℹ️  Service Line extracted: 'Clergy, HHA, Home Health Aide, MSW, Skilled Nursing'
[21:42:52] [DOC: 9193992] ℹ️  Payer Source extracted: ''
[21:42:52] [DOC: 9193992] ℹ️  Diagnosis codes being written:
[21:42:52] [DOC: 9193992] ℹ️    - Latest_Episode_Firstdiagnosis: 'E43'
[21:42:52] [DOC: 9193992] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.592S'
[21:42:52] [DOC: 9193992] ℹ️    - Latest_Episode_Thirddiagnosis: 'W19.XXXS'
[21:42:52] [DOC: 9193992] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J18.9'
[21:42:52] [DOC: 9193992] ℹ️    - Latest_Episode_Fifthdiagnosis: 'A04.72'
[21:42:52] [DOC: 9193992] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.09'
[21:42:52] [DOC: 9193992] ✅ Patient data written to CSV: Anneliese Darling | Sex: FEMALE | Age: 97 | Service: Clergy, HHA, Home Health Aide, MSW, Skilled Nursing | Payer:  | MRN: 2385572
[21:42:52] ✅    ✅ Document 9193992 processed and saved successfully
[21:42:52] 🔄 
🔄 Step 8: Saving API details...
[21:42:52] [DOC: 9193992] ℹ️  API push details saved for document 9193992
[21:42:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193990                         ║
================================================================================
[21:42:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:42:52] ℹ️  Date: 03/20/2025
[21:42:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:42:54] [DOC: 9193990] ✅ Text extracted using pdfplumber (7221 chars)
[21:42:54] ✅    ✅ Text extracted using pdfplumber (7221 chars)
[21:42:54] 🔄 
🔄 Step 2: Extracting patient data...
[21:42:57] ℹ️  AI extracted raw sex value: 'F'
[21:42:57] ℹ️  AI extracted service line: 'Hospice'
[21:42:57] ℹ️  AI extracted payer source: ''
[21:42:57] ℹ️  AI extracted diagnoses:
[21:42:57] ℹ️    - Diagnosis 1: 'E43'
[21:42:57] ℹ️    - Diagnosis 2: 'S32.592S'
[21:42:57] ℹ️    - Diagnosis 3: 'W19.XXXS'
[21:42:57] ℹ️    - Diagnosis 4: 'J18.9'
[21:42:57] ℹ️    - Diagnosis 5: 'A04.72'
[21:42:57] ℹ️    - Diagnosis 6: 'K59.09'
[21:42:57] ℹ️  Final extracted MRN: '2385572'
[21:42:57] ℹ️  Final extracted Sex: 'FEMALE'
[21:42:57] ℹ️  Final extracted Service Line: 'Hospice'
[21:42:57] ℹ️  Final extracted Payer Source: ''
[21:42:57] ✅ Patient data extraction completed successfully
[21:42:57] ✅    ✅ Patient data extracted successfully
[21:42:57] 📊 Patient Response
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[21:42:57] ✅    ✅ Patient identified: Anneliese Darling
[21:42:57] ✅    ✅ Patient name validation passed
[21:42:57] 🔄 
🔄 Step 3: Processing patient dates...
[21:42:57] [DOC: 9193990] ℹ️  DOB normalized: 10/19/1927
[21:42:57] [DOC: 9193990] ℹ️  Episode startOfCare normalized: 03/18/2025
[21:42:57] [DOC: 9193990] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[21:42:57] [DOC: 9193990] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[21:42:57] [DOC: 9193990] ✅ Patient date processing completed successfully
[21:42:57] ✅    ✅ Date processing completed
[21:42:57] 📊 Processed Patient Data
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[21:42:57] 🔄 
🔄 Step 4: Extracting order data...
[21:43:00] ℹ️  Order extraction - MRN: '2385572'
[21:43:00] ℹ️  Order extraction - Sex: 'FEMALE'
[21:43:00] ℹ️  Order extraction - Service Line: 'Hospice'
[21:43:00] ℹ️  Order extraction - Payer Source: ''
[21:43:00] ✅ Order data extraction completed successfully
[21:43:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:43:00] ℹ️  Using MRN from patient data: '2385572' over '2385572'
[21:43:00] ℹ️  Service line consistent in both sources: 'Hospice'
[21:43:00] ✅ Patient name cross-validation successful
[21:43:00] ✅    ✅ Data merged successfully
[21:43:01] ✅    ✅ Order data extracted and validated
[21:43:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:43:01] [DOC: 9193990] ✅ Patient found in local cache: Anneliese Darling, ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:43:01] ✅    ✅ Existing patient found with ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:43:01] 🔄 
🔄 Step 6: Pushing order to API...
[21:43:01] [DOC: 9193990] ℹ️  Pushing order via API for patient ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[21:43:02] [DOC: 9193990] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14629"}
[21:43:02] ❌    ❌ Failed to push order
[21:43:02] 🔄 
🔄 Step 7: Writing to CSV...
[21:43:02] [DOC: 9193990] ℹ️  Calculated age: 97 from DOB: 10/19/1927
[21:43:02] [DOC: 9193990] ℹ️  Service Line extracted: 'Hospice'
[21:43:02] [DOC: 9193990] ℹ️  Payer Source extracted: ''
[21:43:02] [DOC: 9193990] ℹ️  Diagnosis codes being written:
[21:43:02] [DOC: 9193990] ℹ️    - Latest_Episode_Firstdiagnosis: 'E43'
[21:43:02] [DOC: 9193990] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.592S'
[21:43:02] [DOC: 9193990] ℹ️    - Latest_Episode_Thirddiagnosis: 'W19.XXXS'
[21:43:02] [DOC: 9193990] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J18.9'
[21:43:02] [DOC: 9193990] ℹ️    - Latest_Episode_Fifthdiagnosis: 'A04.72'
[21:43:02] [DOC: 9193990] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.09'
[21:43:02] [DOC: 9193990] ✅ Patient data written to CSV: Anneliese Darling | Sex: FEMALE | Age: 97 | Service: Hospice | Payer:  | MRN: 2385572
[21:43:02] ✅    ✅ Document 9193990 processed and saved successfully
[21:43:02] 🔄 
🔄 Step 8: Saving API details...
[21:43:02] [DOC: 9193990] ℹ️  API push details saved for document 9193990
[21:43:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193975                         ║
================================================================================
[21:43:02] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:43:02] ℹ️  Date: 03/20/2025
[21:43:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:43:06] [DOC: 9193975] ✅ Text extracted using pdfplumber (27280 chars)
[21:43:06] ✅    ✅ Text extracted using pdfplumber (27280 chars)
[21:43:06] 🔄 
🔄 Step 2: Extracting patient data...
[21:43:09] ℹ️  AI extracted raw sex value: 'F'
[21:43:09] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[21:43:09] ℹ️  AI extracted payer source: ''
[21:43:09] ℹ️  AI extracted diagnoses:
[21:43:09] ℹ️    - Diagnosis 1: 'K74.69'
[21:43:09] ℹ️    - Diagnosis 2: 'R26.81'
[21:43:09] ℹ️    - Diagnosis 3: 'D61.818'
[21:43:09] ℹ️    - Diagnosis 4: 'I13.0'
[21:43:09] ℹ️    - Diagnosis 5: 'I50.22'
[21:43:09] ℹ️    - Diagnosis 6: 'E11.22'
[21:43:09] ℹ️  Final extracted MRN: '2258674'
[21:43:09] ℹ️  Final extracted Sex: 'FEMALE'
[21:43:09] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[21:43:09] ℹ️  Final extracted Payer Source: ''
[21:43:09] ✅ Patient data extraction completed successfully
[21:43:09] ✅    ✅ Patient data extracted successfully
[21:43:09] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'D61.818', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.22', 'sixthDiagnosis': 'E11.22'}]
[21:43:09] ✅    ✅ Patient identified: Maryann Boucher
[21:43:09] ✅    ✅ Patient name validation passed
[21:43:09] 🔄 
🔄 Step 3: Processing patient dates...
[21:43:09] [DOC: 9193975] ℹ️  DOB normalized: 03/22/1946
[21:43:09] [DOC: 9193975] ℹ️  Episode startOfCare normalized: 03/10/2025
[21:43:09] [DOC: 9193975] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[21:43:09] [DOC: 9193975] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[21:43:09] [DOC: 9193975] ✅ Patient date processing completed successfully
[21:43:09] ✅    ✅ Date processing completed
[21:43:09] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'D61.818', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.22', 'sixthDiagnosis': 'E11.22'}]
[21:43:09] 🔄 
🔄 Step 4: Extracting order data...
[21:43:12] ℹ️  Order extraction - MRN: '2258674'
[21:43:12] ℹ️  Order extraction - Sex: 'FEMALE'
[21:43:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:43:12] ℹ️  Order extraction - Payer Source: ''
[21:43:12] ✅ Order data extraction completed successfully
[21:43:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:43:12] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[21:43:12] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[21:43:12] ✅ Patient name cross-validation successful
[21:43:12] ✅    ✅ Data merged successfully
[21:43:13] ✅    ✅ Order data extracted and validated
[21:43:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:43:48] [DOC: 9193975] ℹ️  Patient not found in cache or API: Maryann Boucher
[21:43:48] [DOC: 9193975] ℹ️  Patient not found, creating new patient via API...
[21:43:48] [DOC: 9193975] ℹ️  Creating patient via API: Maryann Boucher
[21:43:49] [DOC: 9193975] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:43:49] ❌    ❌ Failed to create patient
[21:43:49] [DOC: 9193975] ℹ️  API push details saved for document 9193975
================================================================================
║                        Processing Document ID: 9193962                         ║
================================================================================
[21:43:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[21:43:49] ℹ️  Date: 03/20/2025
[21:43:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:43:51] [DOC: 9193962] ✅ Text extracted using pdfplumber (1508 chars)
[21:43:51] ✅    ✅ Text extracted using pdfplumber (1508 chars)
[21:43:51] 🔄 
🔄 Step 2: Extracting patient data...
[21:43:53] ℹ️  AI extracted raw sex value: 'F'
[21:43:53] ℹ️  AI extracted service line: 'RN'
[21:43:53] ℹ️  AI extracted payer source: ''
[21:43:53] ℹ️  AI extracted diagnoses:
[21:43:53] ℹ️    - Diagnosis 1: 'None'
[21:43:53] ℹ️    - Diagnosis 2: 'None'
[21:43:53] ℹ️    - Diagnosis 3: 'None'
[21:43:53] ℹ️    - Diagnosis 4: 'None'
[21:43:53] ℹ️    - Diagnosis 5: 'None'
[21:43:53] ℹ️    - Diagnosis 6: 'None'
[21:43:53] ℹ️  Final extracted MRN: '2189741'
[21:43:53] ℹ️  Final extracted Sex: 'FEMALE'
[21:43:53] ℹ️  Final extracted Service Line: 'RN'
[21:43:53] ℹ️  Final extracted Payer Source: ''
[21:43:53] ✅ Patient data extraction completed successfully
[21:43:53] ✅    ✅ Patient data extracted successfully
[21:43:53] 📊 Patient Response
     └─ patientFName: Cizaltina
     └─ patientLName: Andrade
     └─ dob: 09/06/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2189741
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:43:53] ✅    ✅ Patient identified: Cizaltina Andrade
[21:43:53] ✅    ✅ Patient name validation passed
[21:43:53] 🔄 
🔄 Step 3: Processing patient dates...
[21:43:53] [DOC: 9193962] ℹ️  DOB normalized: 09/06/1936
[21:43:53] [DOC: 9193962] ✅ Patient date processing completed successfully
[21:43:53] ✅    ✅ Date processing completed
[21:43:53] 📊 Processed Patient Data
     └─ patientFName: Cizaltina
     └─ patientLName: Andrade
     └─ dob: 09/06/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2189741
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[21:43:53] 🔄 
🔄 Step 4: Extracting order data...
[21:43:56] ℹ️  Order extraction - MRN: '2189741'
[21:43:56] ℹ️  Order extraction - Sex: 'FEMALE'
[21:43:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:43:56] ℹ️  Order extraction - Payer Source: ''
[21:43:56] ✅ Order data extraction completed successfully
[21:43:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:43:56] ℹ️  Using MRN from patient data: '2189741' over '2189741'
[21:43:56] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[21:43:56] ✅ Patient name cross-validation successful
[21:43:56] ✅    ✅ Data merged successfully
[21:43:57] ✅    ✅ Order data extracted and validated
[21:43:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:44:56] [DOC: 9193962] ℹ️  Patient not found in cache or API: Cizaltina Andrade
[21:44:56] [DOC: 9193962] ℹ️  Patient not found, creating new patient via API...
[21:44:56] [DOC: 9193962] ℹ️  Creating patient via API: Cizaltina Andrade
[21:44:57] [DOC: 9193962] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:44:57] ❌    ❌ Failed to create patient
[21:44:57] [DOC: 9193962] ℹ️  API push details saved for document 9193962
================================================================================
║                        Processing Document ID: 9193920                         ║
================================================================================
[21:44:57] ℹ️  Agency: Alphacare Home Health Agency
[21:44:57] ℹ️  Date: 03/20/2025
[21:44:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:45:03] [DOC: 9193920] ✅ Text extracted using pdfplumber (9862 chars)
[21:45:03] ✅    ✅ Text extracted using pdfplumber (9862 chars)
[21:45:03] 🔄 
🔄 Step 2: Extracting patient data...
[21:45:05] ℹ️  AI extracted raw sex value: 'F'
[21:45:05] ℹ️  AI extracted service line: 'Physical Therapy'
[21:45:05] ℹ️  AI extracted payer source: 'None'
[21:45:05] ℹ️  AI extracted diagnoses:
[21:45:05] ℹ️    - Diagnosis 1: 'None'
[21:45:05] ℹ️    - Diagnosis 2: 'None'
[21:45:05] ℹ️    - Diagnosis 3: 'None'
[21:45:05] ℹ️    - Diagnosis 4: 'None'
[21:45:05] ℹ️    - Diagnosis 5: 'None'
[21:45:05] ℹ️    - Diagnosis 6: 'None'
[21:45:05] ℹ️  Final extracted MRN: '000003599'
[21:45:05] ℹ️  Final extracted Sex: 'FEMALE'
[21:45:05] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:45:05] ℹ️  Final extracted Payer Source: ''
[21:45:05] ✅ Patient data extraction completed successfully
[21:45:05] ✅    ✅ Patient data extracted successfully
[21:45:05] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000003599
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/31/2025', 'endOfEpisode': '02/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:45:05] ✅    ✅ Patient identified: June Stykowski
[21:45:05] ✅    ✅ Patient name validation passed
[21:45:05] 🔄 
🔄 Step 3: Processing patient dates...
[21:45:05] [DOC: 9193920] ℹ️  DOB normalized: 11/08/1952
[21:45:05] [DOC: 9193920] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[21:45:05] [DOC: 9193920] ℹ️  Episode endOfEpisode normalized: 02/10/2025
[21:45:05] [DOC: 9193920] ✅ Patient date processing completed successfully
[21:45:05] ✅    ✅ Date processing completed
[21:45:05] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000003599
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ zip: 
     └─ phoneNumber: 
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '02/10/2025'}]
[21:45:05] 🔄 
🔄 Step 4: Extracting order data...
[21:45:08] ℹ️  Order extraction - MRN: '000003599'
[21:45:08] ℹ️  Order extraction - Sex: 'FEMALE'
[21:45:08] ℹ️  Order extraction - Service Line: 'PT'
[21:45:08] ℹ️  Order extraction - Payer Source: ''
[21:45:08] ✅ Order data extraction completed successfully
[21:45:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:45:08] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[21:45:08] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[21:45:08] ✅ Patient name cross-validation successful
[21:45:08] ✅    ✅ Data merged successfully
[21:45:09] ✅    ✅ Order data extracted and validated
[21:45:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:45:09] [DOC: 9193920] ✅ Patient found in local cache: June Stykowski, ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[21:45:09] ✅    ✅ Existing patient found with ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[21:45:09] 🔄 
🔄 Step 6: Pushing order to API...
[21:45:09] [DOC: 9193920] ℹ️  Pushing order via API for patient ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[21:45:10] [DOC: 9193920] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:45:10] ❌    ❌ Failed to push order
[21:45:10] 🔄 
🔄 Step 7: Writing to CSV...
[21:45:10] [DOC: 9193920] ℹ️  Calculated age: 72 from DOB: 11/08/1952
[21:45:10] [DOC: 9193920] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[21:45:10] [DOC: 9193920] ℹ️  Payer Source extracted: ''
[21:45:10] [DOC: 9193920] ℹ️  Diagnosis codes being written:
[21:45:10] [DOC: 9193920] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:45:10] [DOC: 9193920] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:45:10] [DOC: 9193920] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:45:10] [DOC: 9193920] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:45:10] [DOC: 9193920] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:45:10] [DOC: 9193920] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:45:10] [DOC: 9193920] ✅ Patient data written to CSV: June Stykowski | Sex: FEMALE | Age: 72 | Service: PT, Physical Therapy | Payer:  | MRN: 000003599
[21:45:10] ✅    ✅ Document 9193920 processed and saved successfully
[21:45:10] 🔄 
🔄 Step 8: Saving API details...
[21:45:10] [DOC: 9193920] ℹ️  API push details saved for document 9193920
[21:45:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193509                         ║
================================================================================
[21:45:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:45:10] ℹ️  Date: 03/20/2025
[21:45:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:45:12] [DOC: 9193509] ✅ Text extracted using pdfplumber (1202 chars)
[21:45:12] ✅    ✅ Text extracted using pdfplumber (1202 chars)
[21:45:12] 🔄 
🔄 Step 2: Extracting patient data...
[21:45:15] ℹ️  AI extracted raw sex value: ''
[21:45:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:45:15] ℹ️  AI extracted payer source: ''
[21:45:15] ℹ️  AI extracted diagnoses:
[21:45:15] ℹ️    - Diagnosis 1: 'F39'
[21:45:15] ℹ️    - Diagnosis 2: 'F32.A'
[21:45:15] ℹ️    - Diagnosis 3: 'E11.42'
[21:45:15] ℹ️    - Diagnosis 4: 'None'
[21:45:15] ℹ️    - Diagnosis 5: 'None'
[21:45:15] ℹ️    - Diagnosis 6: 'None'
[21:45:15] ℹ️  Final extracted MRN: 'MA221103064405'
[21:45:15] ℹ️  Final extracted Sex: ''
[21:45:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:45:15] ℹ️  Final extracted Payer Source: ''
[21:45:15] ✅ Patient data extraction completed successfully
[21:45:15] ✅    ✅ Patient data extracted successfully
[21:45:15] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:45:15] ✅    ✅ Patient identified: Marie Mendoza
[21:45:15] ✅    ✅ Patient name validation passed
[21:45:15] 🔄 
🔄 Step 3: Processing patient dates...
[21:45:15] [DOC: 9193509] ℹ️  DOB normalized: 06/25/1944
[21:45:15] [DOC: 9193509] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[21:45:15] [DOC: 9193509] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[21:45:15] [DOC: 9193509] ✅ Patient date processing completed successfully
[21:45:15] ✅    ✅ Date processing completed
[21:45:15] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42'}]
[21:45:15] 🔄 
🔄 Step 4: Extracting order data...
[21:45:18] ℹ️  Order extraction - MRN: 'MA221103064405'
[21:45:18] ℹ️  Order extraction - Sex: ''
[21:45:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:45:18] ℹ️  Order extraction - Payer Source: ''
[21:45:18] ✅ Order data extraction completed successfully
[21:45:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:45:18] ℹ️  Using MRN from patient data: 'MA221103064405' over 'MA221103064405'
[21:45:18] ℹ️  Inferred sex as FEMALE from name: Marie
[21:45:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:45:18] ✅ Patient name cross-validation successful
[21:45:18] ✅    ✅ Data merged successfully
[21:45:19] ✅    ✅ Order data extracted and validated
[21:45:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:45:26] [DOC: 9193509] ℹ️  Patient not found in cache or API: Marie Mendoza
[21:45:26] [DOC: 9193509] ℹ️  Patient not found, creating new patient via API...
[21:45:26] [DOC: 9193509] ℹ️  Creating patient via API: Marie Mendoza
[21:45:27] [DOC: 9193509] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:45:27] ❌    ❌ Failed to create patient
[21:45:27] [DOC: 9193509] ℹ️  API push details saved for document 9193509
================================================================================
║                        Processing Document ID: 9193505                         ║
================================================================================
[21:45:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:45:27] ℹ️  Date: 03/20/2025
[21:45:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:45:30] [DOC: 9193505] ✅ Text extracted using pdfplumber (1085 chars)
[21:45:30] ✅    ✅ Text extracted using pdfplumber (1073 chars)
[21:45:30] 🔄 
🔄 Step 2: Extracting patient data...
[21:45:32] ℹ️  AI extracted raw sex value: ''
[21:45:32] ℹ️  AI extracted service line: 'RN'
[21:45:32] ℹ️  AI extracted payer source: ''
[21:45:32] ℹ️  AI extracted diagnoses:
[21:45:32] ℹ️    - Diagnosis 1: 'I10'
[21:45:32] ℹ️    - Diagnosis 2: 'E11.65'
[21:45:32] ℹ️    - Diagnosis 3: 'E78.5'
[21:45:32] ℹ️    - Diagnosis 4: ''
[21:45:32] ℹ️    - Diagnosis 5: ''
[21:45:32] ℹ️    - Diagnosis 6: ''
[21:45:32] ℹ️  Final extracted MRN: '100993650'
[21:45:32] ℹ️  Final extracted Sex: ''
[21:45:32] ℹ️  Final extracted Service Line: 'RN'
[21:45:32] ℹ️  Final extracted Payer Source: ''
[21:45:32] ✅ Patient data extraction completed successfully
[21:45:32] ✅    ✅ Patient data extracted successfully
[21:45:32] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Fernandes
     └─ dob: 04/12/1949
     └─ patientSex: 
     └─ medicalRecordNo: 100993650
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:45:32] ✅    ✅ Patient identified: Maria Fernandes
[21:45:32] ✅    ✅ Patient name validation passed
[21:45:32] 🔄 
🔄 Step 3: Processing patient dates...
[21:45:32] [DOC: 9193505] ℹ️  DOB normalized: 04/12/1949
[21:45:32] [DOC: 9193505] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:45:32] [DOC: 9193505] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:45:32] [DOC: 9193505] ✅ Patient date processing completed successfully
[21:45:32] ✅    ✅ Date processing completed
[21:45:32] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Fernandes
     └─ dob: 04/12/1949
     └─ patientSex: 
     └─ medicalRecordNo: 100993650
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:45:32] 🔄 
🔄 Step 4: Extracting order data...
[21:45:36] ℹ️  Order extraction - MRN: '100993650'
[21:45:36] ℹ️  Order extraction - Sex: ''
[21:45:36] ℹ️  Order extraction - Service Line: 'PCP'
[21:45:36] ℹ️  Order extraction - Payer Source: ''
[21:45:36] ✅ Order data extraction completed successfully
[21:45:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:45:36] ℹ️  Using MRN from patient data: '100993650' over '100993650'
[21:45:36] ℹ️  Inferred sex as FEMALE from name: Maria
[21:45:36] ℹ️  Combined service lines: Patient='RN' + Order='PCP' = 'PCP, RN'
[21:45:36] ✅ Patient name cross-validation successful
[21:45:36] ✅    ✅ Data merged successfully
[21:45:37] ✅    ✅ Order data extracted and validated
[21:45:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:45:37] [DOC: 9193505] ✅ Patient found in local cache: Maria Fernandes, ID: d8e266a9-d047-44ee-a281-6fd6c44fed89
[21:45:37] ✅    ✅ Existing patient found with ID: d8e266a9-d047-44ee-a281-6fd6c44fed89
[21:45:37] 🔄 
🔄 Step 6: Pushing order to API...
[21:45:37] [DOC: 9193505] ℹ️  Pushing order via API for patient ID: d8e266a9-d047-44ee-a281-6fd6c44fed89
[21:45:38] [DOC: 9193505] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13969"}
[21:45:38] ❌    ❌ Failed to push order
[21:45:38] 🔄 
🔄 Step 7: Writing to CSV...
[21:45:38] [DOC: 9193505] ℹ️  Calculated age: 76 from DOB: 04/12/1949
[21:45:38] [DOC: 9193505] ℹ️  Service Line extracted: 'PCP, RN'
[21:45:38] [DOC: 9193505] ℹ️  Payer Source extracted: ''
[21:45:38] [DOC: 9193505] ℹ️  Diagnosis codes being written:
[21:45:38] [DOC: 9193505] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[21:45:38] [DOC: 9193505] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[21:45:38] [DOC: 9193505] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[21:45:38] [DOC: 9193505] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:45:38] [DOC: 9193505] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:45:38] [DOC: 9193505] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:45:38] [DOC: 9193505] ✅ Patient data written to CSV: Maria Fernandes | Sex: FEMALE | Age: 76 | Service: PCP, RN | Payer:  | MRN: 100993650
[21:45:38] ✅    ✅ Document 9193505 processed and saved successfully
[21:45:38] 🔄 
🔄 Step 8: Saving API details...
[21:45:38] [DOC: 9193505] ℹ️  API push details saved for document 9193505
[21:45:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193502                         ║
================================================================================
[21:45:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:45:38] ℹ️  Date: 03/20/2025
[21:45:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:45:41] [DOC: 9193502] ✅ Text extracted using pdfplumber (1237 chars)
[21:45:41] ✅    ✅ Text extracted using pdfplumber (1237 chars)
[21:45:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:45:43] ℹ️  AI extracted raw sex value: ''
[21:45:43] ℹ️  AI extracted service line: 'Physical Therapy'
[21:45:43] ℹ️  AI extracted payer source: ''
[21:45:43] ℹ️  AI extracted diagnoses:
[21:45:43] ℹ️    - Diagnosis 1: 'S81.801'
[21:45:43] ℹ️    - Diagnosis 2: 'E11.51'
[21:45:43] ℹ️    - Diagnosis 3: 'I70.209'
[21:45:43] ℹ️    - Diagnosis 4: 'None'
[21:45:43] ℹ️    - Diagnosis 5: 'None'
[21:45:43] ℹ️    - Diagnosis 6: 'None'
[21:45:43] ℹ️  Final extracted MRN: 'MA200528053701'
[21:45:43] ℹ️  Final extracted Sex: ''
[21:45:43] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:45:43] ℹ️  Final extracted Payer Source: ''
[21:45:43] ✅ Patient data extraction completed successfully
[21:45:43] ✅    ✅ Patient data extracted successfully
[21:45:43] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:45:43] ✅    ✅ Patient identified: Roderick Lopez
[21:45:43] ✅    ✅ Patient name validation passed
[21:45:43] 🔄 
🔄 Step 3: Processing patient dates...
[21:45:43] [DOC: 9193502] ℹ️  DOB normalized: 05/21/1937
[21:45:43] [DOC: 9193502] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[21:45:43] [DOC: 9193502] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[21:45:43] [DOC: 9193502] ✅ Patient date processing completed successfully
[21:45:43] ✅    ✅ Date processing completed
[21:45:43] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209'}]
[21:45:43] 🔄 
🔄 Step 4: Extracting order data...
[21:45:51] ℹ️  Order extraction - MRN: 'MA200528053701'
[21:45:51] ℹ️  Order extraction - Sex: ''
[21:45:51] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:45:51] ℹ️  Order extraction - Payer Source: ''
[21:45:51] ✅ Order data extraction completed successfully
[21:45:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:45:51] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[21:45:51] ℹ️  Inferred sex as MALE from name: Roderick
[21:45:51] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:45:51] ✅ Patient name cross-validation successful
[21:45:51] ✅    ✅ Data merged successfully
[21:45:53] ✅    ✅ Order data extracted and validated
[21:45:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:46:08] [DOC: 9193502] ℹ️  Patient not found in cache or API: Roderick Lopez
[21:46:08] [DOC: 9193502] ℹ️  Patient not found, creating new patient via API...
[21:46:08] [DOC: 9193502] ℹ️  Creating patient via API: Roderick Lopez
[21:46:10] [DOC: 9193502] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:46:10] ❌    ❌ Failed to create patient
[21:46:10] [DOC: 9193502] ℹ️  API push details saved for document 9193502
================================================================================
║                        Processing Document ID: 9193499                         ║
================================================================================
[21:46:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:46:10] ℹ️  Date: 03/20/2025
[21:46:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:46:13] [DOC: 9193499] ✅ Text extracted using pdfplumber (7990 chars)
[21:46:13] ✅    ✅ Text extracted using pdfplumber (7990 chars)
[21:46:13] 🔄 
🔄 Step 2: Extracting patient data...
[21:46:16] ℹ️  AI extracted raw sex value: ''
[21:46:16] ℹ️  AI extracted service line: 'ST'
[21:46:16] ℹ️  AI extracted payer source: ''
[21:46:16] ℹ️  AI extracted diagnoses:
[21:46:16] ℹ️    - Diagnosis 1: 'pneumonia'
[21:46:16] ℹ️    - Diagnosis 2: 'dysphagia'
[21:46:16] ℹ️    - Diagnosis 3: 'post laminectomy syndrome'
[21:46:16] ℹ️    - Diagnosis 4: 'spinal stenosis with neurogenic claudication'
[21:46:16] ℹ️    - Diagnosis 5: 'UTI'
[21:46:16] ℹ️    - Diagnosis 6: 'COPD'
[21:46:16] ℹ️  Final extracted MRN: 'MA250210123603'
[21:46:16] ℹ️  Final extracted Sex: ''
[21:46:16] ℹ️  Final extracted Service Line: 'ST'
[21:46:16] ℹ️  Final extracted Payer Source: ''
[21:46:16] ✅ Patient data extraction completed successfully
[21:46:16] ✅    ✅ Patient data extracted successfully
[21:46:16] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'pneumonia', 'secondDiagnosis': 'dysphagia', 'thirdDiagnosis': 'post laminectomy syndrome', 'fourthDiagnosis': 'spinal stenosis with neurogenic claudication', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COPD'}]
[21:46:16] ✅    ✅ Patient identified: David Boswell
[21:46:16] ✅    ✅ Patient name validation passed
[21:46:16] 🔄 
🔄 Step 3: Processing patient dates...
[21:46:16] [DOC: 9193499] ℹ️  DOB normalized: 12/29/1936
[21:46:16] [DOC: 9193499] ✅ Patient date processing completed successfully
[21:46:16] ✅    ✅ Date processing completed
[21:46:16] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'pneumonia', 'secondDiagnosis': 'dysphagia', 'thirdDiagnosis': 'post laminectomy syndrome', 'fourthDiagnosis': 'spinal stenosis with neurogenic claudication', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COPD'}]
[21:46:16] 🔄 
🔄 Step 4: Extracting order data...
[21:46:18] ℹ️  Order extraction - MRN: 'MA250210123603'
[21:46:18] ℹ️  Order extraction - Sex: ''
[21:46:18] ℹ️  Order extraction - Service Line: 'ST'
[21:46:18] ℹ️  Order extraction - Payer Source: ''
[21:46:18] ✅ Order data extraction completed successfully
[21:46:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:46:18] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[21:46:18] ℹ️  Inferred sex as MALE from name: David
[21:46:18] ℹ️  Service line consistent in both sources: 'ST'
[21:46:18] ✅ Patient name cross-validation successful
[21:46:18] ✅    ✅ Data merged successfully
[21:46:19] ⚠️     ❌ Skipping - missing episode start date
[21:46:19] [DOC: 9193499] ℹ️  API push details saved for document 9193499
================================================================================
║                        Processing Document ID: 9193497                         ║
================================================================================
[21:46:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:46:19] ℹ️  Date: 03/20/2025
[21:46:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:46:23] [DOC: 9193497] ✅ Text extracted using pdfplumber (15662 chars)
[21:46:23] ✅    ✅ Text extracted using pdfplumber (15662 chars)
[21:46:23] 🔄 
🔄 Step 2: Extracting patient data...
[21:46:25] ℹ️  AI extracted raw sex value: 'M'
[21:46:25] ℹ️  AI extracted service line: 'OT'
[21:46:25] ℹ️  AI extracted payer source: ''
[21:46:25] ℹ️  AI extracted diagnoses:
[21:46:25] ℹ️    - Diagnosis 1: 'J44.1'
[21:46:25] ℹ️    - Diagnosis 2: ''
[21:46:25] ℹ️    - Diagnosis 3: ''
[21:46:25] ℹ️    - Diagnosis 4: ''
[21:46:25] ℹ️    - Diagnosis 5: ''
[21:46:25] ℹ️    - Diagnosis 6: ''
[21:46:25] ℹ️  Final extracted MRN: 'MA250210123603'
[21:46:25] ℹ️  Final extracted Sex: 'MALE'
[21:46:25] ℹ️  Final extracted Service Line: 'OT'
[21:46:25] ℹ️  Final extracted Payer Source: ''
[21:46:25] ✅ Patient data extraction completed successfully
[21:46:25] ✅    ✅ Patient data extracted successfully
[21:46:25] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:46:25] ✅    ✅ Patient identified: David Boswell
[21:46:25] ✅    ✅ Patient name validation passed
[21:46:25] 🔄 
🔄 Step 3: Processing patient dates...
[21:46:25] [DOC: 9193497] ℹ️  DOB normalized: 12/29/1936
[21:46:25] [DOC: 9193497] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[21:46:25] [DOC: 9193497] ✅ Patient date processing completed successfully
[21:46:25] ✅    ✅ Date processing completed
[21:46:25] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:46:25] 🔄 
🔄 Step 4: Extracting order data...
[21:46:28] ℹ️  Order extraction - MRN: 'MA250210123603'
[21:46:28] ℹ️  Order extraction - Sex: 'MALE'
[21:46:28] ℹ️  Order extraction - Service Line: 'OT'
[21:46:28] ℹ️  Order extraction - Payer Source: ''
[21:46:28] ✅ Order data extraction completed successfully
[21:46:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:46:28] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[21:46:28] ℹ️  Service line consistent in both sources: 'OT'
[21:46:28] ✅ Patient name cross-validation successful
[21:46:28] ✅    ✅ Data merged successfully
[21:46:29] ⚠️     ❌ Skipping - missing episode start date
[21:46:29] [DOC: 9193497] ℹ️  API push details saved for document 9193497
================================================================================
║                        Processing Document ID: 9193494                         ║
================================================================================
[21:46:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:46:29] ℹ️  Date: 03/20/2025
[21:46:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:46:32] [DOC: 9193494] ✅ Text extracted using pdfplumber (13068 chars)
[21:46:32] ✅    ✅ Text extracted using pdfplumber (13068 chars)
[21:46:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:46:35] ℹ️  AI extracted raw sex value: 'M'
[21:46:35] ℹ️  AI extracted service line: 'OT'
[21:46:35] ℹ️  AI extracted payer source: ''
[21:46:35] ℹ️  AI extracted diagnoses:
[21:46:35] ℹ️    - Diagnosis 1: 'J12.1'
[21:46:35] ℹ️    - Diagnosis 2: 'J09'
[21:46:35] ℹ️    - Diagnosis 3: 'J44.1'
[21:46:35] ℹ️    - Diagnosis 4: 'None'
[21:46:35] ℹ️    - Diagnosis 5: 'None'
[21:46:35] ℹ️    - Diagnosis 6: 'None'
[21:46:35] ℹ️  Final extracted MRN: 'MA250210123603'
[21:46:35] ℹ️  Final extracted Sex: 'MALE'
[21:46:35] ℹ️  Final extracted Service Line: 'OT'
[21:46:35] ℹ️  Final extracted Payer Source: ''
[21:46:35] ✅ Patient data extraction completed successfully
[21:46:35] ✅    ✅ Patient data extracted successfully
[21:46:35] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/10/2025', 'endOfEpisode': None, 'firstDiagnosis': 'J12.1', 'secondDiagnosis': 'J09', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:46:35] ✅    ✅ Patient identified: David Boswell
[21:46:35] ✅    ✅ Patient name validation passed
[21:46:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:46:35] [DOC: 9193494] ℹ️  DOB normalized: 12/29/1936
[21:46:35] [DOC: 9193494] ℹ️  Episode startOfEpisode normalized: 02/10/2025
[21:46:35] [DOC: 9193494] ✅ Patient date processing completed successfully
[21:46:35] ✅    ✅ Date processing completed
[21:46:35] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/10/2025', 'firstDiagnosis': 'J12.1', 'secondDiagnosis': 'J09', 'thirdDiagnosis': 'J44.1'}]
[21:46:35] 🔄 
🔄 Step 4: Extracting order data...
[21:46:38] ℹ️  Order extraction - MRN: 'MA250210123603'
[21:46:38] ℹ️  Order extraction - Sex: 'MALE'
[21:46:38] ℹ️  Order extraction - Service Line: 'OT'
[21:46:38] ℹ️  Order extraction - Payer Source: ''
[21:46:38] ✅ Order data extraction completed successfully
[21:46:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:46:38] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[21:46:38] ℹ️  Service line consistent in both sources: 'OT'
[21:46:38] ✅ Patient name cross-validation successful
[21:46:38] ✅    ✅ Data merged successfully
[21:46:39] ⚠️     ❌ Skipping - missing episode start date
[21:46:39] [DOC: 9193494] ℹ️  API push details saved for document 9193494
================================================================================
║                        Processing Document ID: 9193491                         ║
================================================================================
[21:46:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:46:39] ℹ️  Date: 03/20/2025
[21:46:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:46:41] [DOC: 9193491] ✅ Text extracted using pdfplumber (1313 chars)
[21:46:41] ✅    ✅ Text extracted using pdfplumber (1313 chars)
[21:46:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:46:44] ℹ️  AI extracted raw sex value: ''
[21:46:44] ℹ️  AI extracted service line: 'Physical Therapy'
[21:46:44] ℹ️  AI extracted payer source: ''
[21:46:44] ℹ️  AI extracted diagnoses:
[21:46:44] ℹ️    - Diagnosis 1: 'B37.81'
[21:46:44] ℹ️    - Diagnosis 2: 'J44.1'
[21:46:44] ℹ️    - Diagnosis 3: 'J18.9'
[21:46:44] ℹ️    - Diagnosis 4: 'None'
[21:46:44] ℹ️    - Diagnosis 5: 'None'
[21:46:44] ℹ️    - Diagnosis 6: 'None'
[21:46:44] ℹ️  Final extracted MRN: 'MA250210123603'
[21:46:44] ℹ️  Final extracted Sex: ''
[21:46:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:46:44] ℹ️  Final extracted Payer Source: ''
[21:46:44] ✅ Patient data extraction completed successfully
[21:46:44] ✅    ✅ Patient data extracted successfully
[21:46:44] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:46:44] ✅    ✅ Patient identified: David Boswell
[21:46:44] ✅    ✅ Patient name validation passed
[21:46:44] 🔄 
🔄 Step 3: Processing patient dates...
[21:46:44] [DOC: 9193491] ℹ️  DOB normalized: 12/29/1936
[21:46:44] [DOC: 9193491] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[21:46:44] [DOC: 9193491] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[21:46:44] [DOC: 9193491] ✅ Patient date processing completed successfully
[21:46:44] ✅    ✅ Date processing completed
[21:46:44] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9'}]
[21:46:44] 🔄 
🔄 Step 4: Extracting order data...
[21:46:46] ℹ️  Order extraction - MRN: 'MA250210123603'
[21:46:46] ℹ️  Order extraction - Sex: ''
[21:46:46] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:46:46] ℹ️  Order extraction - Payer Source: ''
[21:46:46] ✅ Order data extraction completed successfully
[21:46:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:46:46] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[21:46:46] ℹ️  Inferred sex as MALE from name: David
[21:46:46] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:46:46] ✅ Patient name cross-validation successful
[21:46:46] ✅    ✅ Data merged successfully
[21:46:47] ✅    ✅ Order data extracted and validated
[21:46:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:46:47] [DOC: 9193491] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[21:46:47] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[21:46:47] 🔄 
🔄 Step 6: Pushing order to API...
[21:46:47] [DOC: 9193491] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[21:46:49] [DOC: 9193491] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13211"}
[21:46:49] ❌    ❌ Failed to push order
[21:46:49] 🔄 
🔄 Step 7: Writing to CSV...
[21:46:49] [DOC: 9193491] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[21:46:49] [DOC: 9193491] ℹ️  Service Line extracted: 'Physical Therapy'
[21:46:49] [DOC: 9193491] ℹ️  Payer Source extracted: ''
[21:46:49] [DOC: 9193491] ℹ️  Diagnosis codes being written:
[21:46:49] [DOC: 9193491] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.81'
[21:46:49] [DOC: 9193491] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.1'
[21:46:49] [DOC: 9193491] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[21:46:49] [DOC: 9193491] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:46:49] [DOC: 9193491] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:46:49] [DOC: 9193491] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:46:49] [DOC: 9193491] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA250210123603
[21:46:49] ✅    ✅ Document 9193491 processed and saved successfully
[21:46:49] 🔄 
🔄 Step 8: Saving API details...
[21:46:49] [DOC: 9193491] ℹ️  API push details saved for document 9193491
[21:46:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193490                         ║
================================================================================
[21:46:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:46:49] ℹ️  Date: 03/20/2025
[21:46:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:46:51] [DOC: 9193490] ✅ Text extracted using pdfplumber (1286 chars)
[21:46:51] ✅    ✅ Text extracted using pdfplumber (1286 chars)
[21:46:51] 🔄 
🔄 Step 2: Extracting patient data...
[21:46:55] ℹ️  AI extracted raw sex value: ''
[21:46:55] ℹ️  AI extracted service line: 'Speech Therapy'
[21:46:55] ℹ️  AI extracted payer source: ''
[21:46:55] ℹ️  AI extracted diagnoses:
[21:46:55] ℹ️    - Diagnosis 1: 'B37.81'
[21:46:55] ℹ️    - Diagnosis 2: 'J44.1'
[21:46:55] ℹ️    - Diagnosis 3: 'J18.9'
[21:46:55] ℹ️    - Diagnosis 4: ''
[21:46:55] ℹ️    - Diagnosis 5: ''
[21:46:55] ℹ️    - Diagnosis 6: ''
[21:46:55] ℹ️  Final extracted MRN: 'MA250210123603'
[21:46:55] ℹ️  Final extracted Sex: ''
[21:46:55] ℹ️  Final extracted Service Line: 'Speech Therapy'
[21:46:55] ℹ️  Final extracted Payer Source: ''
[21:46:55] ✅ Patient data extraction completed successfully
[21:46:55] ✅    ✅ Patient data extracted successfully
[21:46:55] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:46:55] ✅    ✅ Patient identified: David Boswell
[21:46:55] ✅    ✅ Patient name validation passed
[21:46:55] 🔄 
🔄 Step 3: Processing patient dates...
[21:46:55] [DOC: 9193490] ℹ️  DOB normalized: 12/29/1936
[21:46:55] [DOC: 9193490] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[21:46:55] [DOC: 9193490] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[21:46:55] [DOC: 9193490] ✅ Patient date processing completed successfully
[21:46:55] ✅    ✅ Date processing completed
[21:46:55] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:46:55] 🔄 
🔄 Step 4: Extracting order data...
[21:46:57] ℹ️  Order extraction - MRN: 'MA250210123603'
[21:46:57] ℹ️  Order extraction - Sex: ''
[21:46:57] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[21:46:57] ℹ️  Order extraction - Payer Source: ''
[21:46:57] ✅ Order data extraction completed successfully
[21:46:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:46:57] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[21:46:57] ℹ️  Inferred sex as MALE from name: David
[21:46:57] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[21:46:57] ✅ Patient name cross-validation successful
[21:46:57] ✅    ✅ Data merged successfully
[21:46:58] ✅    ✅ Order data extracted and validated
[21:46:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:46:58] [DOC: 9193490] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[21:46:58] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[21:46:58] 🔄 
🔄 Step 6: Pushing order to API...
[21:46:58] [DOC: 9193490] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[21:47:00] [DOC: 9193490] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13212"}
[21:47:00] ❌    ❌ Failed to push order
[21:47:00] 🔄 
🔄 Step 7: Writing to CSV...
[21:47:00] [DOC: 9193490] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[21:47:00] [DOC: 9193490] ℹ️  Service Line extracted: 'Speech Therapy'
[21:47:00] [DOC: 9193490] ℹ️  Payer Source extracted: ''
[21:47:00] [DOC: 9193490] ℹ️  Diagnosis codes being written:
[21:47:00] [DOC: 9193490] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.81'
[21:47:00] [DOC: 9193490] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.1'
[21:47:00] [DOC: 9193490] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[21:47:00] [DOC: 9193490] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:47:00] [DOC: 9193490] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:47:00] [DOC: 9193490] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:47:00] [DOC: 9193490] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: Speech Therapy | Payer:  | MRN: MA250210123603
[21:47:00] ✅    ✅ Document 9193490 processed and saved successfully
[21:47:00] 🔄 
🔄 Step 8: Saving API details...
[21:47:00] [DOC: 9193490] ℹ️  API push details saved for document 9193490
[21:47:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193008                         ║
================================================================================
[21:47:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:47:00] ℹ️  Date: 03/20/2025
[21:47:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:02] [DOC: 9193008] ✅ Text extracted using pdfplumber (11606 chars)
[21:47:02] ✅    ✅ Text extracted using pdfplumber (11606 chars)
[21:47:02] 🔄 
🔄 Step 2: Extracting patient data...
[21:47:06] ℹ️  AI extracted raw sex value: 'F'
[21:47:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:47:06] ℹ️  AI extracted payer source: 'SWH insurance provider'
[21:47:06] ℹ️  AI extracted diagnoses:
[21:47:06] ℹ️    - Diagnosis 1: 'E11.21'
[21:47:06] ℹ️    - Diagnosis 2: 'J44.9'
[21:47:06] ℹ️    - Diagnosis 3: 'I10'
[21:47:06] ℹ️    - Diagnosis 4: 'D50.9'
[21:47:06] ℹ️    - Diagnosis 5: 'F41.9'
[21:47:06] ℹ️    - Diagnosis 6: 'F33.8'
[21:47:06] ℹ️  Final extracted MRN: '100990266'
[21:47:06] ℹ️  Final extracted Sex: 'FEMALE'
[21:47:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:47:06] ℹ️  Final extracted Payer Source: 'SWH insurance provider'
[21:47:06] ✅ Patient data extraction completed successfully
[21:47:06] ✅    ✅ Patient data extracted successfully
[21:47:06] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance provider
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '09/05/2023', 'endOfEpisode': '11/03/2023', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[21:47:06] ✅    ✅ Patient identified: Maria Antunes
[21:47:06] ✅    ✅ Patient name validation passed
[21:47:06] 🔄 
🔄 Step 3: Processing patient dates...
[21:47:06] [DOC: 9193008] ℹ️  DOB normalized: 11/22/1934
[21:47:06] [DOC: 9193008] ℹ️  Episode startOfCare normalized: 09/05/2023
[21:47:06] [DOC: 9193008] ℹ️  Episode startOfEpisode normalized: 09/05/2023
[21:47:06] [DOC: 9193008] ℹ️  Episode endOfEpisode normalized: 11/03/2023
[21:47:06] [DOC: 9193008] ✅ Patient date processing completed successfully
[21:47:06] ✅    ✅ Date processing completed
[21:47:06] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance provider
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '09/05/2023', 'endOfEpisode': '11/03/2023', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[21:47:06] 🔄 
🔄 Step 4: Extracting order data...
[21:47:08] ℹ️  Order extraction - MRN: '100990266'
[21:47:08] ℹ️  Order extraction - Sex: 'FEMALE'
[21:47:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:47:08] ℹ️  Order extraction - Payer Source: 'SWH insurance provider'
[21:47:08] ✅ Order data extraction completed successfully
[21:47:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:47:08] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[21:47:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:47:08] ℹ️  Payer source consistent in both sources: 'SWH insurance provider'
[21:47:08] ✅ Patient name cross-validation successful
[21:47:08] ✅    ✅ Data merged successfully
[21:47:09] ✅    ✅ Order data extracted and validated
[21:47:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:47:09] [DOC: 9193008] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:09] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:09] 🔄 
🔄 Step 6: Pushing order to API...
[21:47:09] [DOC: 9193008] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:11] [DOC: 9193008] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12938"}
[21:47:11] ❌    ❌ Failed to push order
[21:47:11] 🔄 
🔄 Step 7: Writing to CSV...
[21:47:11] [DOC: 9193008] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[21:47:11] [DOC: 9193008] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:47:11] [DOC: 9193008] ℹ️  Payer Source extracted: 'SWH insurance provider'
[21:47:11] [DOC: 9193008] ℹ️  Diagnosis codes being written:
[21:47:11] [DOC: 9193008] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.21'
[21:47:11] [DOC: 9193008] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[21:47:11] [DOC: 9193008] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:47:11] [DOC: 9193008] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[21:47:11] [DOC: 9193008] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[21:47:11] [DOC: 9193008] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[21:47:11] [DOC: 9193008] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: SWH insurance provider | MRN: 100990266
[21:47:11] ✅    ✅ Document 9193008 processed and saved successfully
[21:47:11] 🔄 
🔄 Step 8: Saving API details...
[21:47:11] [DOC: 9193008] ℹ️  API push details saved for document 9193008
[21:47:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193006                         ║
================================================================================
[21:47:11] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:47:11] ℹ️  Date: 03/20/2025
[21:47:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:14] [DOC: 9193006] ✅ Text extracted using pdfplumber (1543 chars)
[21:47:14] ✅    ✅ Text extracted using pdfplumber (1543 chars)
[21:47:14] 🔄 
🔄 Step 2: Extracting patient data...
[21:47:16] ℹ️  AI extracted raw sex value: 'F'
[21:47:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:47:16] ℹ️  AI extracted payer source: 'Senior Whole Health'
[21:47:16] ℹ️  AI extracted diagnoses:
[21:47:16] ℹ️    - Diagnosis 1: 'None'
[21:47:16] ℹ️    - Diagnosis 2: 'None'
[21:47:16] ℹ️    - Diagnosis 3: 'None'
[21:47:16] ℹ️    - Diagnosis 4: 'None'
[21:47:16] ℹ️    - Diagnosis 5: 'None'
[21:47:16] ℹ️    - Diagnosis 6: 'None'
[21:47:16] ℹ️  Final extracted MRN: '333005'
[21:47:16] ℹ️  Final extracted Sex: 'FEMALE'
[21:47:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:47:16] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[21:47:16] ✅ Patient data extraction completed successfully
[21:47:16] ✅    ✅ Patient data extracted successfully
[21:47:16] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ billingProvider: None
     └─ npi: 1053367128
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:47:16] ✅    ✅ Patient identified: Shirley Tavares
[21:47:16] ✅    ✅ Patient name validation passed
[21:47:16] 🔄 
🔄 Step 3: Processing patient dates...
[21:47:16] [DOC: 9193006] ℹ️  DOB normalized: 11/10/1949
[21:47:16] [DOC: 9193006] ℹ️  Episode startOfCare normalized: 09/19/2022
[21:47:16] [DOC: 9193006] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[21:47:16] [DOC: 9193006] ℹ️  Episode endOfEpisode normalized: 03/06/2025
[21:47:16] [DOC: 9193006] ✅ Patient date processing completed successfully
[21:47:16] ✅    ✅ Date processing completed
[21:47:16] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ npi: 1053367128
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025'}]
[21:47:16] 🔄 
🔄 Step 4: Extracting order data...
[21:47:19] ℹ️  Order extraction - MRN: '333005'
[21:47:19] ℹ️  Order extraction - Sex: 'FEMALE'
[21:47:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:47:19] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[21:47:19] ✅ Order data extraction completed successfully
[21:47:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:47:19] ℹ️  Using MRN from patient data: '333005' over '333005'
[21:47:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:47:19] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[21:47:19] ✅ Patient name cross-validation successful
[21:47:19] ✅    ✅ Data merged successfully
[21:47:20] ✅    ✅ Order data extracted and validated
[21:47:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:47:20] [DOC: 9193006] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[21:47:20] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[21:47:20] 🔄 
🔄 Step 6: Pushing order to API...
[21:47:20] [DOC: 9193006] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[21:47:21] [DOC: 9193006] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:47:21] ❌    ❌ Failed to push order
[21:47:21] 🔄 
🔄 Step 7: Writing to CSV...
[21:47:21] [DOC: 9193006] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[21:47:21] [DOC: 9193006] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:47:21] [DOC: 9193006] ℹ️  Payer Source extracted: 'Senior Whole Health'
[21:47:21] [DOC: 9193006] ℹ️  Diagnosis codes being written:
[21:47:21] [DOC: 9193006] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:47:21] [DOC: 9193006] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:47:21] [DOC: 9193006] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:47:21] [DOC: 9193006] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:47:21] [DOC: 9193006] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:47:21] [DOC: 9193006] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:47:21] [DOC: 9193006] ✅ Patient data written to CSV: Shirley Tavares | Sex: FEMALE | Age: 75 | Service: Skilled Nursing | Payer: Senior Whole Health | MRN: 333005
[21:47:21] ✅    ✅ Document 9193006 processed and saved successfully
[21:47:21] 🔄 
🔄 Step 8: Saving API details...
[21:47:21] [DOC: 9193006] ℹ️  API push details saved for document 9193006
[21:47:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193005                         ║
================================================================================
[21:47:21] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:47:21] ℹ️  Date: 03/20/2025
[21:47:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:24] [DOC: 9193005] ✅ Text extracted using pdfplumber (13630 chars)
[21:47:24] ✅    ✅ Text extracted using pdfplumber (13630 chars)
[21:47:24] 🔄 
🔄 Step 2: Extracting patient data...
[21:47:27] ℹ️  AI extracted raw sex value: 'F'
[21:47:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:47:27] ℹ️  AI extracted payer source: 'Medicare'
[21:47:27] ℹ️  AI extracted diagnoses:
[21:47:27] ℹ️    - Diagnosis 1: 'E11.9'
[21:47:27] ℹ️    - Diagnosis 2: 'J44.9'
[21:47:27] ℹ️    - Diagnosis 3: 'I10'
[21:47:27] ℹ️    - Diagnosis 4: 'D50.9'
[21:47:27] ℹ️    - Diagnosis 5: 'F41.9'
[21:47:27] ℹ️    - Diagnosis 6: 'F33.8'
[21:47:27] ℹ️  Final extracted MRN: '100990266'
[21:47:27] ℹ️  Final extracted Sex: 'FEMALE'
[21:47:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:47:27] ℹ️  Final extracted Payer Source: 'Medicare'
[21:47:27] ✅ Patient data extraction completed successfully
[21:47:27] ✅    ✅ Patient data extracted successfully
[21:47:27] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[21:47:27] ✅    ✅ Patient identified: Maria Antunes
[21:47:27] ✅    ✅ Patient name validation passed
[21:47:27] 🔄 
🔄 Step 3: Processing patient dates...
[21:47:27] [DOC: 9193005] ℹ️  DOB normalized: 11/22/1934
[21:47:27] [DOC: 9193005] ℹ️  Episode startOfCare normalized: 02/01/2023
[21:47:27] [DOC: 9193005] ℹ️  Episode startOfEpisode normalized: 06/01/2023
[21:47:27] [DOC: 9193005] ℹ️  Episode endOfEpisode normalized: 07/30/2023
[21:47:27] [DOC: 9193005] ✅ Patient date processing completed successfully
[21:47:27] ✅    ✅ Date processing completed
[21:47:27] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[21:47:27] 🔄 
🔄 Step 4: Extracting order data...
[21:47:30] ℹ️  Order extraction - MRN: '100990266'
[21:47:30] ℹ️  Order extraction - Sex: 'FEMALE'
[21:47:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:47:30] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:47:30] ✅ Order data extraction completed successfully
[21:47:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:47:30] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[21:47:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:47:30] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:47:30] ✅ Patient name cross-validation successful
[21:47:30] ✅    ✅ Data merged successfully
[21:47:31] ✅    ✅ Order data extracted and validated
[21:47:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:47:31] [DOC: 9193005] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:31] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:31] 🔄 
🔄 Step 6: Pushing order to API...
[21:47:31] [DOC: 9193005] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:32] [DOC: 9193005] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12939"}
[21:47:32] ❌    ❌ Failed to push order
[21:47:32] 🔄 
🔄 Step 7: Writing to CSV...
[21:47:32] [DOC: 9193005] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[21:47:32] [DOC: 9193005] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:47:32] [DOC: 9193005] ℹ️  Payer Source extracted: 'Medicare'
[21:47:32] [DOC: 9193005] ℹ️  Diagnosis codes being written:
[21:47:32] [DOC: 9193005] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[21:47:32] [DOC: 9193005] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[21:47:32] [DOC: 9193005] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:47:32] [DOC: 9193005] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[21:47:32] [DOC: 9193005] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[21:47:32] [DOC: 9193005] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[21:47:32] [DOC: 9193005] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990266
[21:47:32] ✅    ✅ Document 9193005 processed and saved successfully
[21:47:32] 🔄 
🔄 Step 8: Saving API details...
[21:47:32] [DOC: 9193005] ℹ️  API push details saved for document 9193005
[21:47:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193002                         ║
================================================================================
[21:47:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:47:32] ℹ️  Date: 03/20/2025
[21:47:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:35] [DOC: 9193002] ✅ Text extracted using pdfplumber (13630 chars)
[21:47:35] ✅    ✅ Text extracted using pdfplumber (13630 chars)
[21:47:35] 🔄 
🔄 Step 2: Extracting patient data...
[21:47:38] ℹ️  AI extracted raw sex value: 'F'
[21:47:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:47:38] ℹ️  AI extracted payer source: 'Medicare'
[21:47:38] ℹ️  AI extracted diagnoses:
[21:47:38] ℹ️    - Diagnosis 1: 'E11.9'
[21:47:38] ℹ️    - Diagnosis 2: 'J44.9'
[21:47:38] ℹ️    - Diagnosis 3: 'I10'
[21:47:38] ℹ️    - Diagnosis 4: 'D50.9'
[21:47:38] ℹ️    - Diagnosis 5: 'F41.9'
[21:47:38] ℹ️    - Diagnosis 6: 'F33.8'
[21:47:38] ℹ️  Final extracted MRN: '100990266'
[21:47:38] ℹ️  Final extracted Sex: 'FEMALE'
[21:47:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:47:38] ℹ️  Final extracted Payer Source: 'Medicare'
[21:47:38] ✅ Patient data extraction completed successfully
[21:47:38] ✅    ✅ Patient data extracted successfully
[21:47:38] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[21:47:38] ✅    ✅ Patient identified: Maria Antunes
[21:47:38] ✅    ✅ Patient name validation passed
[21:47:38] 🔄 
🔄 Step 3: Processing patient dates...
[21:47:38] [DOC: 9193002] ℹ️  DOB normalized: 11/22/1934
[21:47:38] [DOC: 9193002] ℹ️  Episode startOfCare normalized: 02/01/2023
[21:47:38] [DOC: 9193002] ℹ️  Episode startOfEpisode normalized: 06/01/2023
[21:47:38] [DOC: 9193002] ℹ️  Episode endOfEpisode normalized: 07/30/2023
[21:47:38] [DOC: 9193002] ✅ Patient date processing completed successfully
[21:47:38] ✅    ✅ Date processing completed
[21:47:38] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[21:47:38] 🔄 
🔄 Step 4: Extracting order data...
[21:47:41] ℹ️  Order extraction - MRN: '100990266'
[21:47:41] ℹ️  Order extraction - Sex: 'FEMALE'
[21:47:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:47:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:47:41] ✅ Order data extraction completed successfully
[21:47:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:47:41] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[21:47:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:47:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:47:41] ✅ Patient name cross-validation successful
[21:47:41] ✅    ✅ Data merged successfully
[21:47:42] ✅    ✅ Order data extracted and validated
[21:47:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:47:42] [DOC: 9193002] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:42] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:42] 🔄 
🔄 Step 6: Pushing order to API...
[21:47:42] [DOC: 9193002] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:43] [DOC: 9193002] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12939"}
[21:47:43] ❌    ❌ Failed to push order
[21:47:43] 🔄 
🔄 Step 7: Writing to CSV...
[21:47:43] [DOC: 9193002] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[21:47:43] [DOC: 9193002] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:47:43] [DOC: 9193002] ℹ️  Payer Source extracted: 'Medicare'
[21:47:43] [DOC: 9193002] ℹ️  Diagnosis codes being written:
[21:47:43] [DOC: 9193002] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[21:47:43] [DOC: 9193002] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[21:47:43] [DOC: 9193002] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:47:43] [DOC: 9193002] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[21:47:43] [DOC: 9193002] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[21:47:43] [DOC: 9193002] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[21:47:43] [DOC: 9193002] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990266
[21:47:43] ✅    ✅ Document 9193002 processed and saved successfully
[21:47:43] 🔄 
🔄 Step 8: Saving API details...
[21:47:43] [DOC: 9193002] ℹ️  API push details saved for document 9193002
[21:47:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193001                         ║
================================================================================
[21:47:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:47:43] ℹ️  Date: 03/20/2025
[21:47:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:45] [DOC: 9193001] ✅ Text extracted using pdfplumber (1234 chars)
[21:47:45] ✅    ✅ Text extracted using pdfplumber (1234 chars)
[21:47:45] 🔄 
🔄 Step 2: Extracting patient data...
[21:47:48] ℹ️  AI extracted raw sex value: ''
[21:47:48] ℹ️  AI extracted service line: 'LPN'
[21:47:48] ℹ️  AI extracted payer source: ''
[21:47:48] ℹ️  AI extracted diagnoses:
[21:47:48] ℹ️    - Diagnosis 1: 'E11.9'
[21:47:48] ℹ️    - Diagnosis 2: 'J44.9'
[21:47:48] ℹ️    - Diagnosis 3: 'I10'
[21:47:48] ℹ️    - Diagnosis 4: ''
[21:47:48] ℹ️    - Diagnosis 5: ''
[21:47:48] ℹ️    - Diagnosis 6: ''
[21:47:48] ℹ️  Final extracted MRN: '100990266'
[21:47:48] ℹ️  Final extracted Sex: ''
[21:47:48] ℹ️  Final extracted Service Line: 'LPN'
[21:47:48] ℹ️  Final extracted Payer Source: ''
[21:47:48] ✅ Patient data extraction completed successfully
[21:47:48] ✅    ✅ Patient data extracted successfully
[21:47:48] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2023', 'endOfEpisode': '05/31/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:47:48] ✅    ✅ Patient identified: Maria Antunes
[21:47:48] ✅    ✅ Patient name validation passed
[21:47:48] 🔄 
🔄 Step 3: Processing patient dates...
[21:47:48] [DOC: 9193001] ℹ️  DOB normalized: 11/22/1934
[21:47:48] [DOC: 9193001] ℹ️  Episode startOfEpisode normalized: 04/02/2023
[21:47:48] [DOC: 9193001] ℹ️  Episode endOfEpisode normalized: 05/31/2023
[21:47:48] [DOC: 9193001] ✅ Patient date processing completed successfully
[21:47:48] ✅    ✅ Date processing completed
[21:47:48] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2023', 'endOfEpisode': '05/31/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:47:48] 🔄 
🔄 Step 4: Extracting order data...
[21:47:51] ℹ️  Order extraction - MRN: '100990266'
[21:47:51] ℹ️  Order extraction - Sex: ''
[21:47:51] ℹ️  Order extraction - Service Line: 'Nursing'
[21:47:51] ℹ️  Order extraction - Payer Source: ''
[21:47:51] ✅ Order data extraction completed successfully
[21:47:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:47:51] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[21:47:51] ℹ️  Inferred sex as FEMALE from name: Maria
[21:47:51] ℹ️  Combined service lines: Patient='LPN' + Order='Nursing' = 'LPN, Nursing'
[21:47:51] ✅ Patient name cross-validation successful
[21:47:51] ✅    ✅ Data merged successfully
[21:47:52] ✅    ✅ Order data extracted and validated
[21:47:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:47:52] [DOC: 9193001] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:52] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:52] 🔄 
🔄 Step 6: Pushing order to API...
[21:47:52] [DOC: 9193001] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[21:47:53] [DOC: 9193001] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12940"}
[21:47:53] ❌    ❌ Failed to push order
[21:47:53] 🔄 
🔄 Step 7: Writing to CSV...
[21:47:53] [DOC: 9193001] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[21:47:53] [DOC: 9193001] ℹ️  Service Line extracted: 'LPN, Nursing'
[21:47:53] [DOC: 9193001] ℹ️  Payer Source extracted: ''
[21:47:53] [DOC: 9193001] ℹ️  Diagnosis codes being written:
[21:47:53] [DOC: 9193001] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[21:47:53] [DOC: 9193001] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[21:47:53] [DOC: 9193001] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[21:47:53] [DOC: 9193001] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:47:53] [DOC: 9193001] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:47:53] [DOC: 9193001] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:47:53] [DOC: 9193001] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: LPN, Nursing | Payer:  | MRN: 100990266
[21:47:53] ✅    ✅ Document 9193001 processed and saved successfully
[21:47:53] 🔄 
🔄 Step 8: Saving API details...
[21:47:53] [DOC: 9193001] ℹ️  API push details saved for document 9193001
[21:47:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192875                         ║
================================================================================
[21:47:53] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:47:53] ℹ️  Date: 03/20/2025
[21:47:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:55] [DOC: 9192875] ✅ Text extracted using pdfplumber (6159 chars)
[21:47:55] ✅    ✅ Text extracted using pdfplumber (6159 chars)
[21:47:55] 🔄 
🔄 Step 2: Extracting patient data...
[21:47:57] ℹ️  AI extracted raw sex value: 'None'
[21:47:57] ℹ️  AI extracted service line: 'None'
[21:47:57] ℹ️  AI extracted payer source: 'None'
[21:47:57] ℹ️  AI extracted diagnoses:
[21:47:57] ℹ️    - Diagnosis 1: ''
[21:47:57] ℹ️    - Diagnosis 2: ''
[21:47:57] ℹ️    - Diagnosis 3: ''
[21:47:57] ℹ️    - Diagnosis 4: ''
[21:47:57] ℹ️    - Diagnosis 5: ''
[21:47:57] ℹ️    - Diagnosis 6: ''
[21:47:57] ℹ️  Final extracted MRN: ''
[21:47:57] ℹ️  Final extracted Sex: ''
[21:47:57] ℹ️  Final extracted Service Line: ''
[21:47:57] ℹ️  Final extracted Payer Source: ''
[21:47:57] ✅ Patient data extraction completed successfully
[21:47:57] ✅    ✅ Patient data extracted successfully
[21:47:57] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:47:57] ⚠️     ❌ Insufficient patient data extracted
[21:47:57] [DOC: 9192875] ℹ️  API push details saved for document 9192875
================================================================================
║                        Processing Document ID: 9192864                         ║
================================================================================
[21:47:57] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:47:57] ℹ️  Date: 03/20/2025
[21:47:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:47:59] [DOC: 9192864] ✅ Text extracted using pdfplumber (7273 chars)
[21:47:59] ✅    ✅ Text extracted using pdfplumber (7273 chars)
[21:47:59] 🔄 
🔄 Step 2: Extracting patient data...
[21:48:01] ℹ️  AI extracted raw sex value: 'None'
[21:48:01] ℹ️  AI extracted service line: 'None'
[21:48:01] ℹ️  AI extracted payer source: 'None'
[21:48:01] ℹ️  AI extracted diagnoses:
[21:48:01] ℹ️    - Diagnosis 1: ''
[21:48:01] ℹ️    - Diagnosis 2: ''
[21:48:01] ℹ️    - Diagnosis 3: ''
[21:48:01] ℹ️    - Diagnosis 4: ''
[21:48:01] ℹ️    - Diagnosis 5: ''
[21:48:01] ℹ️    - Diagnosis 6: ''
[21:48:01] ℹ️  Final extracted MRN: ''
[21:48:01] ℹ️  Final extracted Sex: ''
[21:48:01] ℹ️  Final extracted Service Line: ''
[21:48:01] ℹ️  Final extracted Payer Source: ''
[21:48:01] ✅ Patient data extraction completed successfully
[21:48:01] ✅    ✅ Patient data extracted successfully
[21:48:01] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:48:01] ⚠️     ❌ Insufficient patient data extracted
[21:48:01] [DOC: 9192864] ℹ️  API push details saved for document 9192864
================================================================================
║                        Processing Document ID: 9192858                         ║
================================================================================
[21:48:01] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:48:01] ℹ️  Date: 03/20/2025
[21:48:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:48:04] [DOC: 9192858] ✅ Text extracted using pdfplumber (6105 chars)
[21:48:04] ✅    ✅ Text extracted using pdfplumber (6105 chars)
[21:48:04] 🔄 
🔄 Step 2: Extracting patient data...
[21:48:05] ℹ️  AI extracted raw sex value: 'None'
[21:48:05] ℹ️  AI extracted service line: 'None'
[21:48:05] ℹ️  AI extracted payer source: 'None'
[21:48:05] ℹ️  AI extracted diagnoses:
[21:48:05] ℹ️    - Diagnosis 1: ''
[21:48:05] ℹ️    - Diagnosis 2: ''
[21:48:05] ℹ️    - Diagnosis 3: ''
[21:48:05] ℹ️    - Diagnosis 4: ''
[21:48:05] ℹ️    - Diagnosis 5: ''
[21:48:05] ℹ️    - Diagnosis 6: ''
[21:48:05] ℹ️  Final extracted MRN: ''
[21:48:05] ℹ️  Final extracted Sex: ''
[21:48:05] ℹ️  Final extracted Service Line: ''
[21:48:05] ℹ️  Final extracted Payer Source: ''
[21:48:05] ✅ Patient data extraction completed successfully
[21:48:05] ✅    ✅ Patient data extracted successfully
[21:48:05] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:48:05] ⚠️     ❌ Insufficient patient data extracted
[21:48:05] [DOC: 9192858] ℹ️  API push details saved for document 9192858
================================================================================
║                        Processing Document ID: 9192851                         ║
================================================================================
[21:48:05] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:48:05] ℹ️  Date: 03/20/2025
[21:48:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:48:14] [DOC: 9192851] ✅ Text extracted using pdfplumber (46498 chars)
[21:48:14] ✅    ✅ Text extracted using pdfplumber (46498 chars)
[21:48:14] 🔄 
🔄 Step 2: Extracting patient data...
[21:48:18] ℹ️  AI extracted raw sex value: 'None'
[21:48:18] ℹ️  AI extracted service line: 'None'
[21:48:18] ℹ️  AI extracted payer source: 'None'
[21:48:18] ℹ️  AI extracted diagnoses:
[21:48:18] ℹ️    - Diagnosis 1: ''
[21:48:18] ℹ️    - Diagnosis 2: ''
[21:48:18] ℹ️    - Diagnosis 3: ''
[21:48:18] ℹ️    - Diagnosis 4: ''
[21:48:18] ℹ️    - Diagnosis 5: ''
[21:48:18] ℹ️    - Diagnosis 6: ''
[21:48:18] ℹ️  Final extracted MRN: ''
[21:48:18] ℹ️  Final extracted Sex: ''
[21:48:18] ℹ️  Final extracted Service Line: ''
[21:48:18] ℹ️  Final extracted Payer Source: ''
[21:48:18] ✅ Patient data extraction completed successfully
[21:48:18] ✅    ✅ Patient data extracted successfully
[21:48:18] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[21:48:18] ⚠️     ❌ Insufficient patient data extracted
[21:48:18] [DOC: 9192851] ℹ️  API push details saved for document 9192851
================================================================================
║                        Processing Document ID: 9192836                         ║
================================================================================
[21:48:18] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[21:48:18] ℹ️  Date: 03/20/2025
[21:48:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:48:21] [DOC: 9192836] ✅ Text extracted using pdfplumber (1709 chars)
[21:48:21] ✅    ✅ Text extracted using pdfplumber (1709 chars)
[21:48:21] 🔄 
🔄 Step 2: Extracting patient data...
[21:48:24] ℹ️  AI extracted raw sex value: 'F'
[21:48:24] ℹ️  AI extracted service line: 'HHA'
[21:48:24] ℹ️  AI extracted payer source: 'Medicaid/MA'
[21:48:24] ℹ️  AI extracted diagnoses:
[21:48:24] ℹ️    - Diagnosis 1: ''
[21:48:24] ℹ️    - Diagnosis 2: ''
[21:48:24] ℹ️    - Diagnosis 3: ''
[21:48:24] ℹ️    - Diagnosis 4: ''
[21:48:24] ℹ️    - Diagnosis 5: ''
[21:48:24] ℹ️    - Diagnosis 6: ''
[21:48:24] ℹ️  Final extracted MRN: '263005'
[21:48:24] ℹ️  Final extracted Sex: 'FEMALE'
[21:48:24] ℹ️  Final extracted Service Line: 'HHA'
[21:48:24] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[21:48:24] ✅ Patient data extraction completed successfully
[21:48:24] ✅    ✅ Patient data extracted successfully
[21:48:24] 📊 Patient Response
     └─ patientFName: Racine
     └─ patientLName: Przystarz
     └─ dob: 01/29/1985
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 263005
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2022', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:48:24] ✅    ✅ Patient identified: Racine Przystarz
[21:48:24] ✅    ✅ Patient name validation passed
[21:48:24] 🔄 
🔄 Step 3: Processing patient dates...
[21:48:24] [DOC: 9192836] ℹ️  DOB normalized: 01/29/1985
[21:48:24] [DOC: 9192836] ℹ️  Episode startOfCare normalized: 02/07/2022
[21:48:24] [DOC: 9192836] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[21:48:24] [DOC: 9192836] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[21:48:24] [DOC: 9192836] ✅ Patient date processing completed successfully
[21:48:24] ✅    ✅ Date processing completed
[21:48:24] 📊 Processed Patient Data
     └─ patientFName: Racine
     └─ patientLName: Przystarz
     └─ dob: 01/29/1985
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 263005
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2022', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:48:24] 🔄 
🔄 Step 4: Extracting order data...
[21:48:26] ℹ️  Order extraction - MRN: '263005'
[21:48:26] ℹ️  Order extraction - Sex: 'FEMALE'
[21:48:26] ℹ️  Order extraction - Service Line: 'HHA'
[21:48:26] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[21:48:26] ✅ Order data extraction completed successfully
[21:48:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:48:26] ℹ️  Using MRN from patient data: '263005' over '263005'
[21:48:26] ℹ️  Service line consistent in both sources: 'HHA'
[21:48:26] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[21:48:26] ✅ Patient name cross-validation successful
[21:48:26] ✅    ✅ Data merged successfully
[21:48:28] ✅    ✅ Order data extracted and validated
[21:48:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:48:35] [DOC: 9192836] ℹ️  Patient not found in cache or API: Racine Przystarz
[21:48:35] [DOC: 9192836] ℹ️  Patient not found, creating new patient via API...
[21:48:35] [DOC: 9192836] ℹ️  Creating patient via API: Racine Przystarz
[21:48:36] [DOC: 9192836] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:48:36] ❌    ❌ Failed to create patient
[21:48:36] [DOC: 9192836] ℹ️  API push details saved for document 9192836
================================================================================
║                        Processing Document ID: 9192805                         ║
================================================================================
[21:48:36] ℹ️  Agency: AccentCare Fall River
[21:48:36] ℹ️  Date: 03/20/2025
[21:48:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:48:38] [DOC: 9192805] ✅ Text extracted using pdfplumber (1177 chars)
[21:48:38] ✅    ✅ Text extracted using pdfplumber (1177 chars)
[21:48:38] 🔄 
🔄 Step 2: Extracting patient data...
[21:48:41] ℹ️  AI extracted raw sex value: ''
[21:48:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:48:41] ℹ️  AI extracted payer source: ''
[21:48:41] ℹ️  AI extracted diagnoses:
[21:48:41] ℹ️    - Diagnosis 1: 'K51.9'
[21:48:41] ℹ️    - Diagnosis 2: ''
[21:48:41] ℹ️    - Diagnosis 3: ''
[21:48:41] ℹ️    - Diagnosis 4: ''
[21:48:41] ℹ️    - Diagnosis 5: ''
[21:48:41] ℹ️    - Diagnosis 6: ''
[21:48:41] ℹ️  Final extracted MRN: 'C0200234381101'
[21:48:41] ℹ️  Final extracted Sex: ''
[21:48:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:48:41] ℹ️  Final extracted Payer Source: ''
[21:48:41] ✅ Patient data extraction completed successfully
[21:48:41] ✅    ✅ Patient data extracted successfully
[21:48:41] 📊 Patient Response
     └─ patientFName: SUSAN G
     └─ patientLName: STRANZ
     └─ dob: 11/22/1957
     └─ patientSex: 
     └─ medicalRecordNo: C0200234381101
     └─ billingProvider: PARAJULI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/17/2025', 'firstDiagnosis': 'K51.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:48:41] ✅    ✅ Patient identified: SUSAN G STRANZ
[21:48:41] ✅    ✅ Patient name validation passed
[21:48:41] 🔄 
🔄 Step 3: Processing patient dates...
[21:48:41] [DOC: 9192805] ℹ️  DOB normalized: 11/22/1957
[21:48:41] [DOC: 9192805] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[21:48:41] [DOC: 9192805] ℹ️  Episode endOfEpisode normalized: 03/17/2025
[21:48:41] [DOC: 9192805] ✅ Patient date processing completed successfully
[21:48:41] ✅    ✅ Date processing completed
[21:48:41] 📊 Processed Patient Data
     └─ patientFName: SUSAN G
     └─ patientLName: STRANZ
     └─ dob: 11/22/1957
     └─ patientSex: 
     └─ medicalRecordNo: C0200234381101
     └─ billingProvider: PARAJULI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/17/2025', 'firstDiagnosis': 'K51.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:48:41] 🔄 
🔄 Step 4: Extracting order data...
[21:48:44] ℹ️  Order extraction - MRN: 'C0200234381101'
[21:48:44] ℹ️  Order extraction - Sex: ''
[21:48:44] ℹ️  Order extraction - Service Line: 'RN'
[21:48:44] ℹ️  Order extraction - Payer Source: ''
[21:48:44] ✅ Order data extraction completed successfully
[21:48:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:48:44] ℹ️  Using MRN from patient data: 'C0200234381101' over 'C0200234381101'
[21:48:44] ⚠️  Could not determine sex using any available method
[21:48:44] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[21:48:44] ✅ Patient name cross-validation successful
[21:48:44] ✅    ✅ Data merged successfully
[21:48:45] ✅    ✅ Order data extracted and validated
[21:48:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:48:51] [DOC: 9192805] ℹ️  Patient not found in cache or API: SUSAN G STRANZ
[21:48:51] [DOC: 9192805] ℹ️  Patient not found, creating new patient via API...
[21:48:51] [DOC: 9192805] ℹ️  Creating patient via API: SUSAN G STRANZ
[21:48:52] [DOC: 9192805] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:48:52] ❌    ❌ Failed to create patient
[21:48:52] [DOC: 9192805] ℹ️  API push details saved for document 9192805
================================================================================
║                        Processing Document ID: 9192708                         ║
================================================================================
[21:48:52] ℹ️  Agency: AccentCare Fall River
[21:48:52] ℹ️  Date: 03/20/2025
[21:48:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:48:57] [DOC: 9192708] ✅ Text extracted using pdfplumber (16536 chars)
[21:48:57] ✅    ✅ Text extracted using pdfplumber (16536 chars)
[21:48:57] 🔄 
🔄 Step 2: Extracting patient data...
[21:49:00] ℹ️  AI extracted raw sex value: 'F'
[21:49:00] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[21:49:00] ℹ️  AI extracted payer source: ''
[21:49:00] ℹ️  AI extracted diagnoses:
[21:49:00] ℹ️    - Diagnosis 1: 'F03.911'
[21:49:00] ℹ️    - Diagnosis 2: 'F03.918'
[21:49:00] ℹ️    - Diagnosis 3: 'F03.93'
[21:49:00] ℹ️    - Diagnosis 4: 'F32.A'
[21:49:00] ℹ️    - Diagnosis 5: 'F03.94'
[21:49:00] ℹ️    - Diagnosis 6: 'F03.92'
[21:49:00] ℹ️  Final extracted MRN: 'C0200197668001'
[21:49:00] ℹ️  Final extracted Sex: 'FEMALE'
[21:49:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[21:49:00] ℹ️  Final extracted Payer Source: ''
[21:49:00] ✅ Patient data extraction completed successfully
[21:49:00] ✅    ✅ Patient data extracted successfully
[21:49:00] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Rumney
     └─ dob: 01/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200197668001
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Psychiatric Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/19/2024', 'endOfEpisode': None, 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'F03.918', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.92'}]
[21:49:00] ✅    ✅ Patient identified: Patricia Rumney
[21:49:00] ✅    ✅ Patient name validation passed
[21:49:00] 🔄 
🔄 Step 3: Processing patient dates...
[21:49:00] [DOC: 9192708] ℹ️  DOB normalized: 01/11/1940
[21:49:00] [DOC: 9192708] ℹ️  Episode startOfEpisode normalized: 12/19/2024
[21:49:00] [DOC: 9192708] ✅ Patient date processing completed successfully
[21:49:00] ✅    ✅ Date processing completed
[21:49:00] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Rumney
     └─ dob: 01/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200197668001
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Psychiatric Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/19/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'F03.918', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.92'}]
[21:49:00] 🔄 
🔄 Step 4: Extracting order data...
[21:49:02] ℹ️  Order extraction - MRN: 'C0200197668001'
[21:49:02] ℹ️  Order extraction - Sex: 'FEMALE'
[21:49:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[21:49:02] ℹ️  Order extraction - Payer Source: ''
[21:49:02] ✅ Order data extraction completed successfully
[21:49:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:49:02] ℹ️  Using MRN from patient data: 'C0200197668001' over 'C0200197668001'
[21:49:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[21:49:02] ✅ Patient name cross-validation successful
[21:49:02] ✅    ✅ Data merged successfully
[21:49:04] ✅    ✅ Order data extracted and validated
[21:49:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:49:21] [DOC: 9192708] ℹ️  Patient not found in cache or API: Patricia Rumney
[21:49:21] [DOC: 9192708] ℹ️  Patient not found, creating new patient via API...
[21:49:21] [DOC: 9192708] ℹ️  Creating patient via API: Patricia Rumney
[21:49:22] [DOC: 9192708] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:49:22] ❌    ❌ Failed to create patient
[21:49:22] [DOC: 9192708] ℹ️  API push details saved for document 9192708
================================================================================
║                        Processing Document ID: 9192681                         ║
================================================================================
[21:49:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:49:22] ℹ️  Date: 03/20/2025
[21:49:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:49:25] [DOC: 9192681] ✅ Text extracted using pdfplumber (1215 chars)
[21:49:25] ✅    ✅ Text extracted using pdfplumber (1215 chars)
[21:49:25] 🔄 
🔄 Step 2: Extracting patient data...
[21:49:28] ℹ️  AI extracted raw sex value: ''
[21:49:28] ℹ️  AI extracted service line: 'Physical Therapy'
[21:49:28] ℹ️  AI extracted payer source: ''
[21:49:28] ℹ️  AI extracted diagnoses:
[21:49:28] ℹ️    - Diagnosis 1: 'F03.911'
[21:49:28] ℹ️    - Diagnosis 2: 'M62.81'
[21:49:28] ℹ️    - Diagnosis 3: 'R26.89'
[21:49:28] ℹ️    - Diagnosis 4: 'None'
[21:49:28] ℹ️    - Diagnosis 5: 'None'
[21:49:28] ℹ️    - Diagnosis 6: 'None'
[21:49:28] ℹ️  Final extracted MRN: 'MA221128094306'
[21:49:28] ℹ️  Final extracted Sex: ''
[21:49:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:49:28] ℹ️  Final extracted Payer Source: ''
[21:49:28] ✅ Patient data extraction completed successfully
[21:49:28] ✅    ✅ Patient data extracted successfully
[21:49:28] 📊 Patient Response
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/07/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:49:28] ✅    ✅ Patient identified: Vicente Amaro
[21:49:28] ✅    ✅ Patient name validation passed
[21:49:28] 🔄 
🔄 Step 3: Processing patient dates...
[21:49:28] [DOC: 9192681] ℹ️  DOB normalized: 09/09/1943
[21:49:28] [DOC: 9192681] ℹ️  Episode startOfEpisode normalized: 09/10/2024
[21:49:28] [DOC: 9192681] ℹ️  Episode endOfEpisode normalized: 11/07/2024
[21:49:28] [DOC: 9192681] ✅ Patient date processing completed successfully
[21:49:28] ✅    ✅ Date processing completed
[21:49:28] 📊 Processed Patient Data
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/07/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89'}]
[21:49:28] 🔄 
🔄 Step 4: Extracting order data...
[21:49:30] ℹ️  Order extraction - MRN: 'MA221128094306'
[21:49:30] ℹ️  Order extraction - Sex: ''
[21:49:30] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:49:30] ℹ️  Order extraction - Payer Source: ''
[21:49:30] ✅ Order data extraction completed successfully
[21:49:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:49:30] ℹ️  Using MRN from patient data: 'MA221128094306' over 'MA221128094306'
[21:49:30] ⚠️  Could not determine sex using any available method
[21:49:30] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:49:30] ✅ Patient name cross-validation successful
[21:49:30] ✅    ✅ Data merged successfully
[21:49:32] ✅    ✅ Order data extracted and validated
[21:49:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:49:32] [DOC: 9192681] ✅ Patient found in local cache: Vicente Amaro, ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[21:49:32] ✅    ✅ Existing patient found with ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[21:49:32] 🔄 
🔄 Step 6: Pushing order to API...
[21:49:32] [DOC: 9192681] ℹ️  Pushing order via API for patient ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[21:49:33] [DOC: 9192681] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12905"}
[21:49:33] ❌    ❌ Failed to push order
[21:49:33] 🔄 
🔄 Step 7: Writing to CSV...
[21:49:33] [DOC: 9192681] ℹ️  Calculated age: 81 from DOB: 09/09/1943
[21:49:33] [DOC: 9192681] ℹ️  Service Line extracted: 'Physical Therapy'
[21:49:33] [DOC: 9192681] ℹ️  Payer Source extracted: ''
[21:49:33] [DOC: 9192681] ℹ️  Diagnosis codes being written:
[21:49:33] [DOC: 9192681] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.911'
[21:49:33] [DOC: 9192681] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[21:49:33] [DOC: 9192681] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.89'
[21:49:33] [DOC: 9192681] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:49:33] [DOC: 9192681] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:49:33] [DOC: 9192681] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:49:33] [DOC: 9192681] ✅ Patient data written to CSV: Vicente Amaro | Sex:  | Age: 81 | Service: Physical Therapy | Payer:  | MRN: MA221128094306
[21:49:33] ✅    ✅ Document 9192681 processed and saved successfully
[21:49:33] 🔄 
🔄 Step 8: Saving API details...
[21:49:33] [DOC: 9192681] ℹ️  API push details saved for document 9192681
[21:49:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192680                         ║
================================================================================
[21:49:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:49:33] ℹ️  Date: 03/20/2025
[21:49:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:49:37] [DOC: 9192680] ✅ Text extracted using pdfplumber (11892 chars)
[21:49:37] ✅    ✅ Text extracted using pdfplumber (11892 chars)
[21:49:37] 🔄 
🔄 Step 2: Extracting patient data...
[21:49:40] ℹ️  AI extracted raw sex value: 'M'
[21:49:40] ℹ️  AI extracted service line: 'Physical Therapy'
[21:49:40] ℹ️  AI extracted payer source: 'Medicare'
[21:49:40] ℹ️  AI extracted diagnoses:
[21:49:40] ℹ️    - Diagnosis 1: 'F03.911'
[21:49:40] ℹ️    - Diagnosis 2: 'M62.81'
[21:49:40] ℹ️    - Diagnosis 3: 'R26.89'
[21:49:40] ℹ️    - Diagnosis 4: 'F03.93'
[21:49:40] ℹ️    - Diagnosis 5: 'F03.94'
[21:49:40] ℹ️    - Diagnosis 6: 'I50.9'
[21:49:40] ℹ️  Final extracted MRN: 'MA221128094306'
[21:49:40] ℹ️  Final extracted Sex: 'MALE'
[21:49:40] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:49:40] ℹ️  Final extracted Payer Source: 'Medicare'
[21:49:40] ✅ Patient data extraction completed successfully
[21:49:40] ✅    ✅ Patient data extracted successfully
[21:49:40] 📊 Patient Response
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/12/2024', 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/08/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'F03.93', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'I50.9'}]
[21:49:40] ✅    ✅ Patient identified: Vicente Amaro
[21:49:40] ✅    ✅ Patient name validation passed
[21:49:40] 🔄 
🔄 Step 3: Processing patient dates...
[21:49:40] [DOC: 9192680] ℹ️  DOB normalized: 09/09/1943
[21:49:40] [DOC: 9192680] ℹ️  Episode startOfCare normalized: 07/12/2024
[21:49:40] [DOC: 9192680] ℹ️  Episode startOfEpisode normalized: 09/10/2024
[21:49:40] [DOC: 9192680] ℹ️  Episode endOfEpisode normalized: 11/08/2024
[21:49:40] [DOC: 9192680] ✅ Patient date processing completed successfully
[21:49:40] ✅    ✅ Date processing completed
[21:49:40] 📊 Processed Patient Data
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/12/2024', 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/08/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'F03.93', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'I50.9'}]
[21:49:40] 🔄 
🔄 Step 4: Extracting order data...
[21:49:43] ℹ️  Order extraction - MRN: 'MA221128094306'
[21:49:43] ℹ️  Order extraction - Sex: 'MALE'
[21:49:43] ℹ️  Order extraction - Service Line: 'PT'
[21:49:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:49:43] ✅ Order data extraction completed successfully
[21:49:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:49:43] ℹ️  Using MRN from patient data: 'MA221128094306' over 'MA221128094306'
[21:49:43] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[21:49:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:49:43] ✅ Patient name cross-validation successful
[21:49:43] ✅    ✅ Data merged successfully
[21:49:44] ✅    ✅ Order data extracted and validated
[21:49:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:49:44] [DOC: 9192680] ✅ Patient found in local cache: Vicente Amaro, ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[21:49:44] ✅    ✅ Existing patient found with ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[21:49:44] 🔄 
🔄 Step 6: Pushing order to API...
[21:49:44] [DOC: 9192680] ℹ️  Pushing order via API for patient ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[21:49:46] [DOC: 9192680] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12906"}
[21:49:46] ❌    ❌ Failed to push order
[21:49:46] 🔄 
🔄 Step 7: Writing to CSV...
[21:49:46] [DOC: 9192680] ℹ️  Calculated age: 81 from DOB: 09/09/1943
[21:49:46] [DOC: 9192680] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[21:49:46] [DOC: 9192680] ℹ️  Payer Source extracted: 'Medicare'
[21:49:46] [DOC: 9192680] ℹ️  Diagnosis codes being written:
[21:49:46] [DOC: 9192680] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.911'
[21:49:46] [DOC: 9192680] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[21:49:46] [DOC: 9192680] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.89'
[21:49:46] [DOC: 9192680] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F03.93'
[21:49:46] [DOC: 9192680] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F03.94'
[21:49:46] [DOC: 9192680] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.9'
[21:49:46] [DOC: 9192680] ✅ Patient data written to CSV: Vicente Amaro | Sex: MALE | Age: 81 | Service: PT, Physical Therapy | Payer: Medicare | MRN: MA221128094306
[21:49:46] ✅    ✅ Document 9192680 processed and saved successfully
[21:49:46] 🔄 
🔄 Step 8: Saving API details...
[21:49:46] [DOC: 9192680] ℹ️  API push details saved for document 9192680
[21:49:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192674                         ║
================================================================================
[21:49:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:49:46] ℹ️  Date: 03/20/2025
[21:49:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:49:48] [DOC: 9192674] ✅ Text extracted using pdfplumber (1962 chars)
[21:49:48] ✅    ✅ Text extracted using pdfplumber (1950 chars)
[21:49:48] 🔄 
🔄 Step 2: Extracting patient data...
[21:49:51] ℹ️  AI extracted raw sex value: ''
[21:49:51] ℹ️  AI extracted service line: 'Physical Therapy'
[21:49:51] ℹ️  AI extracted payer source: ''
[21:49:51] ℹ️  AI extracted diagnoses:
[21:49:51] ℹ️    - Diagnosis 1: 'I12.9'
[21:49:51] ℹ️    - Diagnosis 2: 'N17.9'
[21:49:51] ℹ️    - Diagnosis 3: 'G35'
[21:49:51] ℹ️    - Diagnosis 4: ''
[21:49:51] ℹ️    - Diagnosis 5: ''
[21:49:51] ℹ️    - Diagnosis 6: ''
[21:49:51] ℹ️  Final extracted MRN: 'MA210203125202'
[21:49:51] ℹ️  Final extracted Sex: ''
[21:49:51] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:49:51] ℹ️  Final extracted Payer Source: ''
[21:49:51] ✅ Patient data extraction completed successfully
[21:49:51] ✅    ✅ Patient data extracted successfully
[21:49:51] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:49:51] ✅    ✅ Patient identified: Ida Souza
[21:49:51] ✅    ✅ Patient name validation passed
[21:49:51] 🔄 
🔄 Step 3: Processing patient dates...
[21:49:51] [DOC: 9192674] ℹ️  DOB normalized: 12/11/1952
[21:49:51] [DOC: 9192674] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[21:49:51] [DOC: 9192674] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[21:49:51] [DOC: 9192674] ✅ Patient date processing completed successfully
[21:49:51] ✅    ✅ Date processing completed
[21:49:51] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:49:51] 🔄 
🔄 Step 4: Extracting order data...
[21:49:53] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:49:53] ℹ️  Order extraction - Sex: ''
[21:49:53] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:49:53] ℹ️  Order extraction - Payer Source: ''
[21:49:53] ✅ Order data extraction completed successfully
[21:49:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:49:53] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:49:53] ⚠️  Could not determine sex using any available method
[21:49:53] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:49:53] ✅ Patient name cross-validation successful
[21:49:53] ✅    ✅ Data merged successfully
[21:49:55] ✅    ✅ Order data extracted and validated
[21:49:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:50:37] [DOC: 9192674] ℹ️  Patient not found in cache or API: Ida Souza
[21:50:37] [DOC: 9192674] ℹ️  Patient not found, creating new patient via API...
[21:50:37] [DOC: 9192674] ℹ️  Creating patient via API: Ida Souza
[21:50:41] [DOC: 9192674] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:50:41] ❌    ❌ Failed to create patient
[21:50:41] [DOC: 9192674] ℹ️  API push details saved for document 9192674
================================================================================
║                        Processing Document ID: 9192670                         ║
================================================================================
[21:50:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:50:41] ℹ️  Date: 03/20/2025
[21:50:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:50:45] [DOC: 9192670] ✅ Text extracted using pdfplumber (13212 chars)
[21:50:45] ✅    ✅ Text extracted using pdfplumber (13212 chars)
[21:50:45] 🔄 
🔄 Step 2: Extracting patient data...
[21:50:48] ℹ️  AI extracted raw sex value: 'F'
[21:50:48] ℹ️  AI extracted service line: 'PT'
[21:50:48] ℹ️  AI extracted payer source: ''
[21:50:48] ℹ️  AI extracted diagnoses:
[21:50:48] ℹ️    - Diagnosis 1: 'I12.9'
[21:50:48] ℹ️    - Diagnosis 2: 'N18.9'
[21:50:48] ℹ️    - Diagnosis 3: 'M86.00'
[21:50:48] ℹ️    - Diagnosis 4: 'L97.119'
[21:50:48] ℹ️    - Diagnosis 5: 'I48.91'
[21:50:48] ℹ️    - Diagnosis 6: 'G35.9'
[21:50:48] ℹ️  Final extracted MRN: 'MA210203125202'
[21:50:48] ℹ️  Final extracted Sex: 'FEMALE'
[21:50:48] ℹ️  Final extracted Service Line: 'PT'
[21:50:48] ℹ️  Final extracted Payer Source: ''
[21:50:48] ✅ Patient data extraction completed successfully
[21:50:48] ✅    ✅ Patient data extracted successfully
[21:50:48] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/07/2025', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N18.9', 'thirdDiagnosis': 'M86.00', 'fourthDiagnosis': 'L97.119', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'G35.9'}]
[21:50:48] ✅    ✅ Patient identified: Ida Souza
[21:50:48] ✅    ✅ Patient name validation passed
[21:50:48] 🔄 
🔄 Step 3: Processing patient dates...
[21:50:48] [DOC: 9192670] ℹ️  DOB normalized: 12/11/1952
[21:50:48] [DOC: 9192670] ℹ️  Episode startOfCare normalized: 01/07/2025
[21:50:48] [DOC: 9192670] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[21:50:48] [DOC: 9192670] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[21:50:48] [DOC: 9192670] ✅ Patient date processing completed successfully
[21:50:48] ✅    ✅ Date processing completed
[21:50:48] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/07/2025', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N18.9', 'thirdDiagnosis': 'M86.00', 'fourthDiagnosis': 'L97.119', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'G35.9'}]
[21:50:48] 🔄 
🔄 Step 4: Extracting order data...
[21:50:50] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:50:50] ℹ️  Order extraction - Sex: 'FEMALE'
[21:50:50] ℹ️  Order extraction - Service Line: 'PT'
[21:50:50] ℹ️  Order extraction - Payer Source: ''
[21:50:50] ✅ Order data extraction completed successfully
[21:50:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:50:50] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:50:50] ℹ️  Service line consistent in both sources: 'PT'
[21:50:50] ✅ Patient name cross-validation successful
[21:50:50] ✅    ✅ Data merged successfully
[21:50:51] ⚠️     ❌ Skipping - missing episode start date
[21:50:51] [DOC: 9192670] ℹ️  API push details saved for document 9192670
================================================================================
║                        Processing Document ID: 9192669                         ║
================================================================================
[21:50:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:50:51] ℹ️  Date: 03/20/2025
[21:50:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:50:54] [DOC: 9192669] ✅ Text extracted using pdfplumber (2372 chars)
[21:50:54] ✅    ✅ Text extracted using pdfplumber (2360 chars)
[21:50:54] 🔄 
🔄 Step 2: Extracting patient data...
[21:50:57] ℹ️  AI extracted raw sex value: ''
[21:50:57] ℹ️  AI extracted service line: 'PT'
[21:50:57] ℹ️  AI extracted payer source: ''
[21:50:57] ℹ️  AI extracted diagnoses:
[21:50:57] ℹ️    - Diagnosis 1: 'I12.9'
[21:50:57] ℹ️    - Diagnosis 2: 'N17.9'
[21:50:57] ℹ️    - Diagnosis 3: 'G35'
[21:50:57] ℹ️    - Diagnosis 4: 'None'
[21:50:57] ℹ️    - Diagnosis 5: 'None'
[21:50:57] ℹ️    - Diagnosis 6: 'None'
[21:50:57] ℹ️  Final extracted MRN: 'MA210203125202'
[21:50:57] ℹ️  Final extracted Sex: ''
[21:50:57] ℹ️  Final extracted Service Line: 'PT'
[21:50:57] ℹ️  Final extracted Payer Source: ''
[21:50:57] ✅ Patient data extraction completed successfully
[21:50:57] ✅    ✅ Patient data extracted successfully
[21:50:57] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:50:57] ✅    ✅ Patient identified: Ida Souza
[21:50:57] ✅    ✅ Patient name validation passed
[21:50:57] 🔄 
🔄 Step 3: Processing patient dates...
[21:50:57] [DOC: 9192669] ℹ️  DOB normalized: 12/11/1952
[21:50:57] [DOC: 9192669] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[21:50:57] [DOC: 9192669] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[21:50:57] [DOC: 9192669] ✅ Patient date processing completed successfully
[21:50:57] ✅    ✅ Date processing completed
[21:50:57] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[21:50:57] 🔄 
🔄 Step 4: Extracting order data...
[21:51:00] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:51:00] ℹ️  Order extraction - Sex: ''
[21:51:00] ℹ️  Order extraction - Service Line: 'PT'
[21:51:00] ℹ️  Order extraction - Payer Source: ''
[21:51:00] ✅ Order data extraction completed successfully
[21:51:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:51:00] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:51:00] ⚠️  Could not determine sex using any available method
[21:51:00] ℹ️  Service line consistent in both sources: 'PT'
[21:51:00] ✅ Patient name cross-validation successful
[21:51:00] ✅    ✅ Data merged successfully
[21:51:02] ✅    ✅ Order data extracted and validated
[21:51:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:51:07] [DOC: 9192669] ℹ️  Patient not found in cache or API: Ida Souza
[21:51:07] [DOC: 9192669] ℹ️  Patient not found, creating new patient via API...
[21:51:07] [DOC: 9192669] ℹ️  Creating patient via API: Ida Souza
[21:51:08] [DOC: 9192669] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:51:08] ❌    ❌ Failed to create patient
[21:51:08] [DOC: 9192669] ℹ️  API push details saved for document 9192669
================================================================================
║                        Processing Document ID: 9192666                         ║
================================================================================
[21:51:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:51:08] ℹ️  Date: 03/20/2025
[21:51:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:51:11] [DOC: 9192666] ✅ Text extracted using pdfplumber (1964 chars)
[21:51:11] ✅    ✅ Text extracted using pdfplumber (1952 chars)
[21:51:11] 🔄 
🔄 Step 2: Extracting patient data...
[21:51:14] ℹ️  AI extracted raw sex value: ''
[21:51:14] ℹ️  AI extracted service line: 'Physical Therapy'
[21:51:14] ℹ️  AI extracted payer source: ''
[21:51:14] ℹ️  AI extracted diagnoses:
[21:51:14] ℹ️    - Diagnosis 1: 'I12.9'
[21:51:14] ℹ️    - Diagnosis 2: 'N17.9'
[21:51:14] ℹ️    - Diagnosis 3: 'G35'
[21:51:14] ℹ️    - Diagnosis 4: 'None'
[21:51:14] ℹ️    - Diagnosis 5: 'None'
[21:51:14] ℹ️    - Diagnosis 6: 'None'
[21:51:14] ℹ️  Final extracted MRN: 'MA210203125202'
[21:51:14] ℹ️  Final extracted Sex: ''
[21:51:14] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:51:14] ℹ️  Final extracted Payer Source: ''
[21:51:14] ✅ Patient data extraction completed successfully
[21:51:14] ✅    ✅ Patient data extracted successfully
[21:51:14] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:51:14] ✅    ✅ Patient identified: Ida Souza
[21:51:14] ✅    ✅ Patient name validation passed
[21:51:14] 🔄 
🔄 Step 3: Processing patient dates...
[21:51:14] [DOC: 9192666] ℹ️  DOB normalized: 12/11/1952
[21:51:14] [DOC: 9192666] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[21:51:14] [DOC: 9192666] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[21:51:14] [DOC: 9192666] ✅ Patient date processing completed successfully
[21:51:14] ✅    ✅ Date processing completed
[21:51:14] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[21:51:14] 🔄 
🔄 Step 4: Extracting order data...
[21:51:16] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:51:16] ℹ️  Order extraction - Sex: ''
[21:51:16] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:51:16] ℹ️  Order extraction - Payer Source: ''
[21:51:16] ✅ Order data extraction completed successfully
[21:51:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:51:16] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:51:16] ⚠️  Could not determine sex using any available method
[21:51:16] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:51:16] ✅ Patient name cross-validation successful
[21:51:16] ✅    ✅ Data merged successfully
[21:51:17] ✅    ✅ Order data extracted and validated
[21:51:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:51:23] [DOC: 9192666] ℹ️  Patient not found in cache or API: Ida Souza
[21:51:23] [DOC: 9192666] ℹ️  Patient not found, creating new patient via API...
[21:51:23] [DOC: 9192666] ℹ️  Creating patient via API: Ida Souza
[21:51:24] [DOC: 9192666] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:51:24] ❌    ❌ Failed to create patient
[21:51:24] [DOC: 9192666] ℹ️  API push details saved for document 9192666
================================================================================
║                        Processing Document ID: 9192664                         ║
================================================================================
[21:51:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:51:24] ℹ️  Date: 03/20/2025
[21:51:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:51:34] [DOC: 9192664] ✅ Text extracted using pdfplumber (14823 chars)
[21:51:34] ✅    ✅ Text extracted using pdfplumber (14823 chars)
[21:51:34] 🔄 
🔄 Step 2: Extracting patient data...
[21:51:37] ℹ️  AI extracted raw sex value: 'F'
[21:51:37] ℹ️  AI extracted service line: 'PT'
[21:51:37] ℹ️  AI extracted payer source: ''
[21:51:37] ℹ️  AI extracted diagnoses:
[21:51:37] ℹ️    - Diagnosis 1: 'Hypertensive chronic kidney disease w stg 1-4/ unsp chr kdny'
[21:51:37] ℹ️    - Diagnosis 2: 'Muscle weakness'
[21:51:37] ℹ️    - Diagnosis 3: 'Left leg osteomyelitis'
[21:51:37] ℹ️    - Diagnosis 4: 'Left leg ulcers'
[21:51:37] ℹ️    - Diagnosis 5: 'HTN'
[21:51:37] ℹ️    - Diagnosis 6: 'A-fib'
[21:51:37] ℹ️  Final extracted MRN: 'MA210203125202'
[21:51:37] ℹ️  Final extracted Sex: 'FEMALE'
[21:51:37] ℹ️  Final extracted Service Line: 'PT'
[21:51:37] ℹ️  Final extracted Payer Source: ''
[21:51:37] ✅ Patient data extraction completed successfully
[21:51:37] ✅    ✅ Patient data extracted successfully
[21:51:37] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/07/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Hypertensive chronic kidney disease w stg 1-4/ unsp chr kdny', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'Left leg osteomyelitis', 'fourthDiagnosis': 'Left leg ulcers', 'fifthDiagnosis': 'HTN', 'sixthDiagnosis': 'A-fib'}]
[21:51:37] ✅    ✅ Patient identified: Ida Souza
[21:51:37] ✅    ✅ Patient name validation passed
[21:51:37] 🔄 
🔄 Step 3: Processing patient dates...
[21:51:37] [DOC: 9192664] ℹ️  DOB normalized: 12/11/1952
[21:51:37] [DOC: 9192664] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[21:51:37] [DOC: 9192664] ✅ Patient date processing completed successfully
[21:51:37] ✅    ✅ Date processing completed
[21:51:37] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'firstDiagnosis': 'Hypertensive chronic kidney disease w stg 1-4/ unsp chr kdny', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'Left leg osteomyelitis', 'fourthDiagnosis': 'Left leg ulcers', 'fifthDiagnosis': 'HTN', 'sixthDiagnosis': 'A-fib'}]
[21:51:37] 🔄 
🔄 Step 4: Extracting order data...
[21:51:40] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:51:40] ℹ️  Order extraction - Sex: 'FEMALE'
[21:51:40] ℹ️  Order extraction - Service Line: 'PT'
[21:51:40] ℹ️  Order extraction - Payer Source: ''
[21:51:40] ✅ Order data extraction completed successfully
[21:51:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:51:40] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:51:40] ℹ️  Service line consistent in both sources: 'PT'
[21:51:40] ✅ Patient name cross-validation successful
[21:51:40] ✅    ✅ Data merged successfully
[21:51:41] ✅    ✅ Order data extracted and validated
[21:51:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:52:10] [DOC: 9192664] ℹ️  Patient not found in cache or API: Ida Souza
[21:52:10] [DOC: 9192664] ℹ️  Patient not found, creating new patient via API...
[21:52:10] [DOC: 9192664] ℹ️  Creating patient via API: Ida Souza
[21:52:11] [DOC: 9192664] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:52:11] ❌    ❌ Failed to create patient
[21:52:11] [DOC: 9192664] ℹ️  API push details saved for document 9192664
================================================================================
║                        Processing Document ID: 9192663                         ║
================================================================================
[21:52:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:52:11] ℹ️  Date: 03/20/2025
[21:52:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:52:16] [DOC: 9192663] ✅ Text extracted using pdfplumber (2242 chars)
[21:52:16] ✅    ✅ Text extracted using pdfplumber (2230 chars)
[21:52:16] 🔄 
🔄 Step 2: Extracting patient data...
[21:52:19] ℹ️  AI extracted raw sex value: ''
[21:52:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:52:19] ℹ️  AI extracted payer source: ''
[21:52:19] ℹ️  AI extracted diagnoses:
[21:52:19] ℹ️    - Diagnosis 1: 'I12.9'
[21:52:19] ℹ️    - Diagnosis 2: 'N17.9'
[21:52:19] ℹ️    - Diagnosis 3: 'G35'
[21:52:19] ℹ️    - Diagnosis 4: 'None'
[21:52:19] ℹ️    - Diagnosis 5: 'None'
[21:52:19] ℹ️    - Diagnosis 6: 'None'
[21:52:19] ℹ️  Final extracted MRN: 'MA210203125202'
[21:52:19] ℹ️  Final extracted Sex: ''
[21:52:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:52:19] ℹ️  Final extracted Payer Source: ''
[21:52:19] ✅ Patient data extraction completed successfully
[21:52:19] ✅    ✅ Patient data extracted successfully
[21:52:19] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:52:19] ✅    ✅ Patient identified: Ida Souza
[21:52:19] ✅    ✅ Patient name validation passed
[21:52:19] 🔄 
🔄 Step 3: Processing patient dates...
[21:52:19] [DOC: 9192663] ℹ️  DOB normalized: 12/11/1952
[21:52:19] [DOC: 9192663] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[21:52:19] [DOC: 9192663] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[21:52:19] [DOC: 9192663] ✅ Patient date processing completed successfully
[21:52:19] ✅    ✅ Date processing completed
[21:52:19] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[21:52:19] 🔄 
🔄 Step 4: Extracting order data...
[21:52:21] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:52:21] ℹ️  Order extraction - Sex: ''
[21:52:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:52:21] ℹ️  Order extraction - Payer Source: ''
[21:52:21] ✅ Order data extraction completed successfully
[21:52:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:52:21] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:52:21] ⚠️  Could not determine sex using any available method
[21:52:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:52:21] ✅ Patient name cross-validation successful
[21:52:21] ✅    ✅ Data merged successfully
[21:52:22] ✅    ✅ Order data extracted and validated
[21:52:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:52:29] [DOC: 9192663] ℹ️  Patient not found in cache or API: Ida Souza
[21:52:29] [DOC: 9192663] ℹ️  Patient not found, creating new patient via API...
[21:52:29] [DOC: 9192663] ℹ️  Creating patient via API: Ida Souza
[21:52:30] [DOC: 9192663] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:52:30] ❌    ❌ Failed to create patient
[21:52:30] [DOC: 9192663] ℹ️  API push details saved for document 9192663
================================================================================
║                        Processing Document ID: 9192660                         ║
================================================================================
[21:52:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:52:30] ℹ️  Date: 03/20/2025
[21:52:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:52:32] [DOC: 9192660] ✅ Text extracted using pdfplumber (1924 chars)
[21:52:32] ✅    ✅ Text extracted using pdfplumber (1912 chars)
[21:52:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:52:35] ℹ️  AI extracted raw sex value: ''
[21:52:35] ℹ️  AI extracted service line: 'Physical Therapy'
[21:52:35] ℹ️  AI extracted payer source: ''
[21:52:35] ℹ️  AI extracted diagnoses:
[21:52:35] ℹ️    - Diagnosis 1: 'I12.9'
[21:52:35] ℹ️    - Diagnosis 2: 'N17.9'
[21:52:35] ℹ️    - Diagnosis 3: 'G35'
[21:52:35] ℹ️    - Diagnosis 4: ''
[21:52:35] ℹ️    - Diagnosis 5: ''
[21:52:35] ℹ️    - Diagnosis 6: ''
[21:52:35] ℹ️  Final extracted MRN: 'MA210203125202'
[21:52:35] ℹ️  Final extracted Sex: ''
[21:52:35] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:52:35] ℹ️  Final extracted Payer Source: ''
[21:52:35] ✅ Patient data extraction completed successfully
[21:52:35] ✅    ✅ Patient data extracted successfully
[21:52:35] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:52:35] ✅    ✅ Patient identified: Ida Souza
[21:52:35] ✅    ✅ Patient name validation passed
[21:52:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:52:35] [DOC: 9192660] ℹ️  DOB normalized: 12/11/1952
[21:52:35] [DOC: 9192660] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[21:52:35] [DOC: 9192660] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[21:52:35] [DOC: 9192660] ✅ Patient date processing completed successfully
[21:52:35] ✅    ✅ Date processing completed
[21:52:35] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:52:35] 🔄 
🔄 Step 4: Extracting order data...
[21:52:38] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:52:38] ℹ️  Order extraction - Sex: ''
[21:52:38] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:52:38] ℹ️  Order extraction - Payer Source: ''
[21:52:38] ✅ Order data extraction completed successfully
[21:52:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:52:38] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:52:38] ⚠️  Could not determine sex using any available method
[21:52:38] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:52:38] ✅ Patient name cross-validation successful
[21:52:38] ✅    ✅ Data merged successfully
[21:52:39] ✅    ✅ Order data extracted and validated
[21:52:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:53:13] [DOC: 9192660] ℹ️  Patient not found in cache or API: Ida Souza
[21:53:13] [DOC: 9192660] ℹ️  Patient not found, creating new patient via API...
[21:53:13] [DOC: 9192660] ℹ️  Creating patient via API: Ida Souza
[21:53:14] [DOC: 9192660] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:53:14] ❌    ❌ Failed to create patient
[21:53:14] [DOC: 9192660] ℹ️  API push details saved for document 9192660
================================================================================
║                        Processing Document ID: 9192657                         ║
================================================================================
[21:53:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:53:14] ℹ️  Date: 03/20/2025
[21:53:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:53:19] [DOC: 9192657] ✅ Text extracted using pdfplumber (17755 chars)
[21:53:19] ✅    ✅ Text extracted using pdfplumber (17755 chars)
[21:53:19] 🔄 
🔄 Step 2: Extracting patient data...
[21:53:22] ℹ️  AI extracted raw sex value: 'F'
[21:53:22] ℹ️  AI extracted service line: 'OT'
[21:53:22] ℹ️  AI extracted payer source: ''
[21:53:22] ℹ️  AI extracted diagnoses:
[21:53:22] ℹ️    - Diagnosis 1: 'altered mental status'
[21:53:22] ℹ️    - Diagnosis 2: 'weakness/limitations/bed bound'
[21:53:22] ℹ️    - Diagnosis 3: 'MS'
[21:53:22] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[21:53:22] ℹ️    - Diagnosis 5: 'Spondylosis w/o myelopathy or radiculopathy, cervical region'
[21:53:22] ℹ️    - Diagnosis 6: 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'
[21:53:22] ℹ️  Final extracted MRN: 'MA210203125202'
[21:53:22] ℹ️  Final extracted Sex: 'FEMALE'
[21:53:22] ℹ️  Final extracted Service Line: 'OT'
[21:53:22] ℹ️  Final extracted Payer Source: ''
[21:53:22] ✅ Patient data extraction completed successfully
[21:53:22] ✅    ✅ Patient data extracted successfully
[21:53:22] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/11/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'altered mental status', 'secondDiagnosis': 'weakness/limitations/bed bound', 'thirdDiagnosis': 'MS', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'Spondylosis w/o myelopathy or radiculopathy, cervical region', 'sixthDiagnosis': 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'}]
[21:53:22] ✅    ✅ Patient identified: Ida Souza
[21:53:22] ✅    ✅ Patient name validation passed
[21:53:22] 🔄 
🔄 Step 3: Processing patient dates...
[21:53:22] [DOC: 9192657] ℹ️  DOB normalized: 12/11/1952
[21:53:22] [DOC: 9192657] ℹ️  Episode startOfCare normalized: 01/11/2025
[21:53:22] [DOC: 9192657] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[21:53:22] [DOC: 9192657] ✅ Patient date processing completed successfully
[21:53:22] ✅    ✅ Date processing completed
[21:53:22] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/11/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'altered mental status', 'secondDiagnosis': 'weakness/limitations/bed bound', 'thirdDiagnosis': 'MS', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'Spondylosis w/o myelopathy or radiculopathy, cervical region', 'sixthDiagnosis': 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'}]
[21:53:22] 🔄 
🔄 Step 4: Extracting order data...
[21:53:25] ℹ️  Order extraction - MRN: 'MA210203125202'
[21:53:25] ℹ️  Order extraction - Sex: 'FEMALE'
[21:53:25] ℹ️  Order extraction - Service Line: 'OT'
[21:53:25] ℹ️  Order extraction - Payer Source: ''
[21:53:25] ✅ Order data extraction completed successfully
[21:53:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:53:25] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[21:53:25] ℹ️  Service line consistent in both sources: 'OT'
[21:53:25] ✅ Patient name cross-validation successful
[21:53:25] ✅    ✅ Data merged successfully
[21:53:26] ⚠️     ❌ Skipping - missing episode start date
[21:53:26] [DOC: 9192657] ℹ️  API push details saved for document 9192657
================================================================================
║                        Processing Document ID: 9192655                         ║
================================================================================
[21:53:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:53:26] ℹ️  Date: 03/20/2025
[21:53:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:53:31] [DOC: 9192655] ✅ Text extracted using pdfplumber (12735 chars)
[21:53:31] ✅    ✅ Text extracted using pdfplumber (12735 chars)
[21:53:31] 🔄 
🔄 Step 2: Extracting patient data...
[21:53:34] ℹ️  AI extracted raw sex value: 'F'
[21:53:34] ℹ️  AI extracted service line: 'Physical Therapy'
[21:53:34] ℹ️  AI extracted payer source: 'Medicare'
[21:53:34] ℹ️  AI extracted diagnoses:
[21:53:34] ℹ️    - Diagnosis 1: 'S82.891'
[21:53:34] ℹ️    - Diagnosis 2: 'R29.6'
[21:53:34] ℹ️    - Diagnosis 3: 'R27.0'
[21:53:34] ℹ️    - Diagnosis 4: 'F31.9'
[21:53:34] ℹ️    - Diagnosis 5: 'E11.9'
[21:53:34] ℹ️    - Diagnosis 6: 'M47.12'
[21:53:34] ℹ️  Final extracted MRN: 'MA210216076302'
[21:53:34] ℹ️  Final extracted Sex: 'FEMALE'
[21:53:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:53:34] ℹ️  Final extracted Payer Source: 'Medicare'
[21:53:34] ✅ Patient data extraction completed successfully
[21:53:34] ✅    ✅ Patient data extracted successfully
[21:53:34] 📊 Patient Response
     └─ patientFName: Jeannine
     └─ patientLName: Lavigne
     └─ dob: 09/27/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210216076302
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 394 Briggs Rd
     └─ city: Westport
     └─ state: MA
     └─ zip: 02790
     └─ email: None
     └─ phoneNumber: (774) 319-4126
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'S82.891', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'R27.0', 'fourthDiagnosis': 'F31.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'M47.12'}]
[21:53:34] ✅    ✅ Patient identified: Jeannine Lavigne
[21:53:34] ✅    ✅ Patient name validation passed
[21:53:34] 🔄 
🔄 Step 3: Processing patient dates...
[21:53:34] [DOC: 9192655] ℹ️  DOB normalized: 09/27/1963
[21:53:34] [DOC: 9192655] ℹ️  Episode startOfCare normalized: 03/04/2025
[21:53:34] [DOC: 9192655] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[21:53:34] [DOC: 9192655] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[21:53:34] [DOC: 9192655] ✅ Patient date processing completed successfully
[21:53:34] ✅    ✅ Date processing completed
[21:53:34] 📊 Processed Patient Data
     └─ patientFName: Jeannine
     └─ patientLName: Lavigne
     └─ dob: 09/27/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210216076302
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 394 Briggs Rd
     └─ city: Westport
     └─ state: MA
     └─ zip: 02790
     └─ phoneNumber: (774) 319-4126
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'S82.891', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'R27.0', 'fourthDiagnosis': 'F31.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'M47.12'}]
[21:53:34] 🔄 
🔄 Step 4: Extracting order data...
[21:53:37] ℹ️  Order extraction - MRN: 'MA210216076302'
[21:53:37] ℹ️  Order extraction - Sex: 'FEMALE'
[21:53:37] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:53:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:53:37] ✅ Order data extraction completed successfully
[21:53:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:53:37] ℹ️  Using MRN from patient data: 'MA210216076302' over 'MA210216076302'
[21:53:37] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:53:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:53:37] ✅ Patient name cross-validation successful
[21:53:37] ✅    ✅ Data merged successfully
[21:53:38] ✅    ✅ Order data extracted and validated
[21:53:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:54:25] [DOC: 9192655] ℹ️  Patient not found in cache or API: Jeannine Lavigne
[21:54:25] [DOC: 9192655] ℹ️  Patient not found, creating new patient via API...
[21:54:25] [DOC: 9192655] ℹ️  Creating patient via API: Jeannine Lavigne
[21:54:26] [DOC: 9192655] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:54:26] ❌    ❌ Failed to create patient
[21:54:26] [DOC: 9192655] ℹ️  API push details saved for document 9192655
================================================================================
║                        Processing Document ID: 9192653                         ║
================================================================================
[21:54:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:54:26] ℹ️  Date: 03/20/2025
[21:54:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:54:29] [DOC: 9192653] ✅ Text extracted using pdfplumber (10148 chars)
[21:54:29] ✅    ✅ Text extracted using pdfplumber (10148 chars)
[21:54:29] 🔄 
🔄 Step 2: Extracting patient data...
[21:54:33] ℹ️  AI extracted raw sex value: 'F'
[21:54:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:54:33] ℹ️  AI extracted payer source: 'Medicare'
[21:54:33] ℹ️  AI extracted diagnoses:
[21:54:33] ℹ️    - Diagnosis 1: 'E11.65'
[21:54:33] ℹ️    - Diagnosis 2: 'E78.00'
[21:54:33] ℹ️    - Diagnosis 3: 'M15.9'
[21:54:33] ℹ️    - Diagnosis 4: 'K91.2'
[21:54:33] ℹ️    - Diagnosis 5: 'G25.81'
[21:54:33] ℹ️    - Diagnosis 6: 'D50.9'
[21:54:33] ℹ️  Final extracted MRN: 'MA241111055903'
[21:54:33] ℹ️  Final extracted Sex: 'FEMALE'
[21:54:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:54:33] ℹ️  Final extracted Payer Source: 'Medicare'
[21:54:33] ✅ Patient data extraction completed successfully
[21:54:33] ✅    ✅ Patient data extracted successfully
[21:54:33] 📊 Patient Response
     └─ patientFName: Anabela
     └─ patientLName: Ferrinha
     └─ dob: 05/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241111055903
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 956 Rockdale Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 728-5414
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/14/2024', 'startOfEpisode': '11/14/2024', 'endOfEpisode': '01/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'K91.2', 'fifthDiagnosis': 'G25.81', 'sixthDiagnosis': 'D50.9'}]
[21:54:33] ✅    ✅ Patient identified: Anabela Ferrinha
[21:54:33] ✅    ✅ Patient name validation passed
[21:54:33] 🔄 
🔄 Step 3: Processing patient dates...
[21:54:33] [DOC: 9192653] ℹ️  DOB normalized: 05/24/1959
[21:54:33] [DOC: 9192653] ℹ️  Episode startOfCare normalized: 11/14/2024
[21:54:33] [DOC: 9192653] ℹ️  Episode startOfEpisode normalized: 11/14/2024
[21:54:33] [DOC: 9192653] ℹ️  Episode endOfEpisode normalized: 01/12/2025
[21:54:33] [DOC: 9192653] ✅ Patient date processing completed successfully
[21:54:33] ✅    ✅ Date processing completed
[21:54:33] 📊 Processed Patient Data
     └─ patientFName: Anabela
     └─ patientLName: Ferrinha
     └─ dob: 05/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241111055903
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 956 Rockdale Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 728-5414
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/14/2024', 'startOfEpisode': '11/14/2024', 'endOfEpisode': '01/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'K91.2', 'fifthDiagnosis': 'G25.81', 'sixthDiagnosis': 'D50.9'}]
[21:54:33] 🔄 
🔄 Step 4: Extracting order data...
[21:54:35] ℹ️  Order extraction - MRN: 'MA241111055903'
[21:54:35] ℹ️  Order extraction - Sex: 'FEMALE'
[21:54:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:54:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:54:35] ✅ Order data extraction completed successfully
[21:54:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:54:35] ℹ️  Using MRN from patient data: 'MA241111055903' over 'MA241111055903'
[21:54:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:54:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:54:35] ✅ Patient name cross-validation successful
[21:54:35] ✅    ✅ Data merged successfully
[21:54:37] ✅    ✅ Order data extracted and validated
[21:54:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:54:42] [DOC: 9192653] ℹ️  Patient not found in cache or API: Anabela Ferrinha
[21:54:42] [DOC: 9192653] ℹ️  Patient not found, creating new patient via API...
[21:54:42] [DOC: 9192653] ℹ️  Creating patient via API: Anabela Ferrinha
[21:54:44] [DOC: 9192653] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:54:44] ❌    ❌ Failed to create patient
[21:54:44] [DOC: 9192653] ℹ️  API push details saved for document 9192653
================================================================================
║                        Processing Document ID: 9192650                         ║
================================================================================
[21:54:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:54:44] ℹ️  Date: 03/20/2025
[21:54:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:54:47] [DOC: 9192650] ✅ Text extracted using pdfplumber (12431 chars)
[21:54:47] ✅    ✅ Text extracted using pdfplumber (12431 chars)
[21:54:47] 🔄 
🔄 Step 2: Extracting patient data...
[21:54:50] ℹ️  AI extracted raw sex value: 'F'
[21:54:50] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[21:54:50] ℹ️  AI extracted payer source: 'Medicare'
[21:54:50] ℹ️  AI extracted diagnoses:
[21:54:50] ℹ️    - Diagnosis 1: 'L97.519'
[21:54:50] ℹ️    - Diagnosis 2: 'E11.621'
[21:54:50] ℹ️    - Diagnosis 3: 'Z47.81'
[21:54:50] ℹ️    - Diagnosis 4: 'L03.115'
[21:54:50] ℹ️    - Diagnosis 5: 'M54.31'
[21:54:50] ℹ️    - Diagnosis 6: 'I10'
[21:54:50] ℹ️  Final extracted MRN: '100994258'
[21:54:50] ℹ️  Final extracted Sex: 'FEMALE'
[21:54:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[21:54:50] ℹ️  Final extracted Payer Source: 'Medicare'
[21:54:50] ✅ Patient data extraction completed successfully
[21:54:50] ✅    ✅ Patient data extracted successfully
[21:54:50] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994258
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 830 County St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 202-2631
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/21/2023', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'L97.519', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'Z47.81', 'fourthDiagnosis': 'L03.115', 'fifthDiagnosis': 'M54.31', 'sixthDiagnosis': 'I10'}]
[21:54:50] ✅    ✅ Patient identified: Gloria Diaz
[21:54:50] ✅    ✅ Patient name validation passed
[21:54:50] 🔄 
🔄 Step 3: Processing patient dates...
[21:54:50] [DOC: 9192650] ℹ️  DOB normalized: 04/09/1951
[21:54:50] [DOC: 9192650] ℹ️  Episode startOfCare normalized: 04/21/2023
[21:54:50] [DOC: 9192650] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[21:54:50] [DOC: 9192650] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[21:54:50] [DOC: 9192650] ✅ Patient date processing completed successfully
[21:54:50] ✅    ✅ Date processing completed
[21:54:50] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994258
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 830 County St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 202-2631
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/21/2023', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'L97.519', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'Z47.81', 'fourthDiagnosis': 'L03.115', 'fifthDiagnosis': 'M54.31', 'sixthDiagnosis': 'I10'}]
[21:54:50] 🔄 
🔄 Step 4: Extracting order data...
[21:54:52] ℹ️  Order extraction - MRN: '100994258'
[21:54:52] ℹ️  Order extraction - Sex: 'FEMALE'
[21:54:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[21:54:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:54:52] ✅ Order data extraction completed successfully
[21:54:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:54:52] ℹ️  Using MRN from patient data: '100994258' over '100994258'
[21:54:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[21:54:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:54:52] ✅ Patient name cross-validation successful
[21:54:52] ✅    ✅ Data merged successfully
[21:54:54] ✅    ✅ Order data extracted and validated
[21:54:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:55:24] [DOC: 9192650] ℹ️  Patient not found in cache or API: Gloria Diaz
[21:55:24] [DOC: 9192650] ℹ️  Patient not found, creating new patient via API...
[21:55:24] [DOC: 9192650] ℹ️  Creating patient via API: Gloria Diaz
[21:55:25] [DOC: 9192650] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:55:25] ❌    ❌ Failed to create patient
[21:55:25] [DOC: 9192650] ℹ️  API push details saved for document 9192650
================================================================================
║                        Processing Document ID: 9192560                         ║
================================================================================
[21:55:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:55:25] ℹ️  Date: 03/20/2025
[21:55:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:55:27] [DOC: 9192560] ✅ Text extracted using pdfplumber (1334 chars)
[21:55:27] ✅    ✅ Text extracted using pdfplumber (1322 chars)
[21:55:27] 🔄 
🔄 Step 2: Extracting patient data...
[21:55:30] ℹ️  AI extracted raw sex value: ''
[21:55:30] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:55:30] ℹ️  AI extracted payer source: ''
[21:55:30] ℹ️  AI extracted diagnoses:
[21:55:30] ℹ️    - Diagnosis 1: 'G89.4'
[21:55:30] ℹ️    - Diagnosis 2: 'M54.9'
[21:55:30] ℹ️    - Diagnosis 3: 'J44.89'
[21:55:30] ℹ️    - Diagnosis 4: 'None'
[21:55:30] ℹ️    - Diagnosis 5: 'None'
[21:55:30] ℹ️    - Diagnosis 6: 'None'
[21:55:30] ℹ️  Final extracted MRN: 'MA241122026006'
[21:55:30] ℹ️  Final extracted Sex: ''
[21:55:30] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:55:30] ℹ️  Final extracted Payer Source: ''
[21:55:30] ✅ Patient data extraction completed successfully
[21:55:30] ✅    ✅ Patient data extracted successfully
[21:55:30] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:55:30] ✅    ✅ Patient identified: Elba Rivera
[21:55:30] ✅    ✅ Patient name validation passed
[21:55:30] 🔄 
🔄 Step 3: Processing patient dates...
[21:55:30] [DOC: 9192560] ℹ️  DOB normalized: 02/14/1960
[21:55:30] [DOC: 9192560] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[21:55:30] [DOC: 9192560] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[21:55:30] [DOC: 9192560] ✅ Patient date processing completed successfully
[21:55:30] ✅    ✅ Date processing completed
[21:55:30] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89'}]
[21:55:30] 🔄 
🔄 Step 4: Extracting order data...
[21:55:33] ℹ️  Order extraction - MRN: 'MA241122026006'
[21:55:33] ℹ️  Order extraction - Sex: ''
[21:55:33] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:55:33] ℹ️  Order extraction - Payer Source: ''
[21:55:33] ✅ Order data extraction completed successfully
[21:55:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:55:33] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[21:55:33] ⚠️  Could not determine sex using any available method
[21:55:33] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:55:33] ✅ Patient name cross-validation successful
[21:55:33] ✅    ✅ Data merged successfully
[21:55:34] ✅    ✅ Order data extracted and validated
[21:55:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:56:17] [DOC: 9192560] ℹ️  Patient not found in cache or API: Elba Rivera
[21:56:17] [DOC: 9192560] ℹ️  Patient not found, creating new patient via API...
[21:56:17] [DOC: 9192560] ℹ️  Creating patient via API: Elba Rivera
[21:56:18] [DOC: 9192560] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[21:56:18] ❌    ❌ Failed to create patient
[21:56:18] [DOC: 9192560] ℹ️  API push details saved for document 9192560
================================================================================
║                        Processing Document ID: 9192558                         ║
================================================================================
[21:56:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:56:18] ℹ️  Date: 03/20/2025
[21:56:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:56:21] [DOC: 9192558] ✅ Text extracted using pdfplumber (14570 chars)
[21:56:21] ✅    ✅ Text extracted using pdfplumber (14570 chars)
[21:56:21] 🔄 
🔄 Step 2: Extracting patient data...
[21:56:24] ℹ️  AI extracted raw sex value: 'F'
[21:56:24] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:56:24] ℹ️  AI extracted payer source: ''
[21:56:24] ℹ️  AI extracted diagnoses:
[21:56:24] ℹ️    - Diagnosis 1: 'I110'
[21:56:24] ℹ️    - Diagnosis 2: 'I5032'
[21:56:24] ℹ️    - Diagnosis 3: ''
[21:56:24] ℹ️    - Diagnosis 4: ''
[21:56:24] ℹ️    - Diagnosis 5: ''
[21:56:24] ℹ️    - Diagnosis 6: ''
[21:56:24] ℹ️  Final extracted MRN: 'MA221012094404'
[21:56:24] ℹ️  Final extracted Sex: 'FEMALE'
[21:56:24] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:56:24] ℹ️  Final extracted Payer Source: ''
[21:56:24] ✅ Patient data extraction completed successfully
[21:56:24] ✅    ✅ Patient data extracted successfully
[21:56:24] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/29/2025', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:56:24] ✅    ✅ Patient identified: Maria Ferreira
[21:56:24] ✅    ✅ Patient name validation passed
[21:56:24] 🔄 
🔄 Step 3: Processing patient dates...
[21:56:24] [DOC: 9192558] ℹ️  DOB normalized: 09/29/1944
[21:56:24] [DOC: 9192558] ℹ️  Episode startOfCare normalized: 01/29/2025
[21:56:24] [DOC: 9192558] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[21:56:24] [DOC: 9192558] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[21:56:24] [DOC: 9192558] ✅ Patient date processing completed successfully
[21:56:24] ✅    ✅ Date processing completed
[21:56:24] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/29/2025', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:56:24] 🔄 
🔄 Step 4: Extracting order data...
[21:56:27] ℹ️  Order extraction - MRN: 'MA221012094404'
[21:56:27] ℹ️  Order extraction - Sex: 'FEMALE'
[21:56:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:56:27] ℹ️  Order extraction - Payer Source: ''
[21:56:27] ✅ Order data extraction completed successfully
[21:56:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:56:27] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[21:56:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:56:27] ✅ Patient name cross-validation successful
[21:56:27] ✅    ✅ Data merged successfully
[21:56:28] ✅    ✅ Order data extracted and validated
[21:56:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:56:28] [DOC: 9192558] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:56:28] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:56:28] 🔄 
🔄 Step 6: Pushing order to API...
[21:56:28] [DOC: 9192558] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:56:29] [DOC: 9192558] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13994"}
[21:56:29] ❌    ❌ Failed to push order
[21:56:29] 🔄 
🔄 Step 7: Writing to CSV...
[21:56:29] [DOC: 9192558] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[21:56:29] [DOC: 9192558] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:56:29] [DOC: 9192558] ℹ️  Payer Source extracted: ''
[21:56:29] [DOC: 9192558] ℹ️  Diagnosis codes being written:
[21:56:29] [DOC: 9192558] ℹ️    - Latest_Episode_Firstdiagnosis: 'I110'
[21:56:29] [DOC: 9192558] ℹ️    - Latest_Episode_Seconddiagnosis: 'I5032'
[21:56:29] [DOC: 9192558] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:56:29] [DOC: 9192558] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:56:29] [DOC: 9192558] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:56:29] [DOC: 9192558] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:56:29] [DOC: 9192558] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA221012094404
[21:56:29] ✅    ✅ Document 9192558 processed and saved successfully
[21:56:29] 🔄 
🔄 Step 8: Saving API details...
[21:56:29] [DOC: 9192558] ℹ️  API push details saved for document 9192558
[21:56:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192556                         ║
================================================================================
[21:56:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:56:29] ℹ️  Date: 03/20/2025
[21:56:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:56:32] [DOC: 9192556] ✅ Text extracted using pdfplumber (10623 chars)
[21:56:32] ✅    ✅ Text extracted using pdfplumber (10623 chars)
[21:56:32] 🔄 
🔄 Step 2: Extracting patient data...
[21:56:35] ℹ️  AI extracted raw sex value: 'F'
[21:56:35] ℹ️  AI extracted service line: 'OT'
[21:56:35] ℹ️  AI extracted payer source: ''
[21:56:35] ℹ️  AI extracted diagnoses:
[21:56:35] ℹ️    - Diagnosis 1: ''
[21:56:35] ℹ️    - Diagnosis 2: ''
[21:56:35] ℹ️    - Diagnosis 3: ''
[21:56:35] ℹ️    - Diagnosis 4: ''
[21:56:35] ℹ️    - Diagnosis 5: ''
[21:56:35] ℹ️    - Diagnosis 6: ''
[21:56:35] ℹ️  Final extracted MRN: 'MA221012094404'
[21:56:35] ℹ️  Final extracted Sex: 'FEMALE'
[21:56:35] ℹ️  Final extracted Service Line: 'OT'
[21:56:35] ℹ️  Final extracted Payer Source: ''
[21:56:35] ✅ Patient data extraction completed successfully
[21:56:35] ✅    ✅ Patient data extracted successfully
[21:56:35] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:56:35] ✅    ✅ Patient identified: Maria Ferreira
[21:56:35] ✅    ✅ Patient name validation passed
[21:56:35] 🔄 
🔄 Step 3: Processing patient dates...
[21:56:35] [DOC: 9192556] ℹ️  DOB normalized: 09/29/1944
[21:56:35] [DOC: 9192556] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[21:56:35] [DOC: 9192556] ✅ Patient date processing completed successfully
[21:56:35] ✅    ✅ Date processing completed
[21:56:35] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:56:35] 🔄 
🔄 Step 4: Extracting order data...
[21:56:38] ℹ️  Order extraction - MRN: 'MA221012094404'
[21:56:38] ℹ️  Order extraction - Sex: 'FEMALE'
[21:56:38] ℹ️  Order extraction - Service Line: 'OT'
[21:56:38] ℹ️  Order extraction - Payer Source: ''
[21:56:38] ✅ Order data extraction completed successfully
[21:56:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:56:38] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[21:56:38] ℹ️  Service line consistent in both sources: 'OT'
[21:56:38] ✅ Patient name cross-validation successful
[21:56:38] ✅    ✅ Data merged successfully
[21:56:39] ⚠️     ❌ Skipping - missing episode start date
[21:56:39] [DOC: 9192556] ℹ️  API push details saved for document 9192556
================================================================================
║                        Processing Document ID: 9192555                         ║
================================================================================
[21:56:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:56:39] ℹ️  Date: 03/20/2025
[21:56:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:56:41] [DOC: 9192555] ✅ Text extracted using pdfplumber (1474 chars)
[21:56:41] ✅    ✅ Text extracted using pdfplumber (1462 chars)
[21:56:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:56:44] ℹ️  AI extracted raw sex value: ''
[21:56:44] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:56:44] ℹ️  AI extracted payer source: ''
[21:56:44] ℹ️  AI extracted diagnoses:
[21:56:44] ℹ️    - Diagnosis 1: 'I11.0'
[21:56:44] ℹ️    - Diagnosis 2: 'I50.32'
[21:56:44] ℹ️    - Diagnosis 3: ''
[21:56:44] ℹ️    - Diagnosis 4: ''
[21:56:44] ℹ️    - Diagnosis 5: ''
[21:56:44] ℹ️    - Diagnosis 6: ''
[21:56:44] ℹ️  Final extracted MRN: 'MA221012094404'
[21:56:44] ℹ️  Final extracted Sex: ''
[21:56:44] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:56:44] ℹ️  Final extracted Payer Source: ''
[21:56:44] ✅ Patient data extraction completed successfully
[21:56:44] ✅    ✅ Patient data extracted successfully
[21:56:44] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:56:44] ✅    ✅ Patient identified: Maria Ferreira
[21:56:44] ✅    ✅ Patient name validation passed
[21:56:44] 🔄 
🔄 Step 3: Processing patient dates...
[21:56:44] [DOC: 9192555] ℹ️  DOB normalized: 09/29/1944
[21:56:44] [DOC: 9192555] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[21:56:44] [DOC: 9192555] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[21:56:44] [DOC: 9192555] ✅ Patient date processing completed successfully
[21:56:44] ✅    ✅ Date processing completed
[21:56:44] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:56:44] 🔄 
🔄 Step 4: Extracting order data...
[21:56:47] ℹ️  Order extraction - MRN: 'MA221012094404'
[21:56:47] ℹ️  Order extraction - Sex: ''
[21:56:47] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:56:47] ℹ️  Order extraction - Payer Source: ''
[21:56:47] ✅ Order data extraction completed successfully
[21:56:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:56:47] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[21:56:47] ℹ️  Inferred sex as FEMALE from name: Maria
[21:56:47] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:56:47] ✅ Patient name cross-validation successful
[21:56:47] ✅    ✅ Data merged successfully
[21:57:25] ✅    ✅ Order data extracted and validated
[21:57:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:57:25] [DOC: 9192555] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:25] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:25] 🔄 
🔄 Step 6: Pushing order to API...
[21:57:25] [DOC: 9192555] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:28] [DOC: 9192555] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13985"}
[21:57:28] ❌    ❌ Failed to push order
[21:57:28] 🔄 
🔄 Step 7: Writing to CSV...
[21:57:28] [DOC: 9192555] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[21:57:28] [DOC: 9192555] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:57:28] [DOC: 9192555] ℹ️  Payer Source extracted: ''
[21:57:28] [DOC: 9192555] ℹ️  Diagnosis codes being written:
[21:57:28] [DOC: 9192555] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[21:57:28] [DOC: 9192555] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[21:57:28] [DOC: 9192555] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:57:28] [DOC: 9192555] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:57:28] [DOC: 9192555] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:57:28] [DOC: 9192555] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:57:28] [DOC: 9192555] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[21:57:28] ✅    ✅ Document 9192555 processed and saved successfully
[21:57:28] 🔄 
🔄 Step 8: Saving API details...
[21:57:28] [DOC: 9192555] ℹ️  API push details saved for document 9192555
[21:57:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192553                         ║
================================================================================
[21:57:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:57:28] ℹ️  Date: 03/20/2025
[21:57:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:57:31] [DOC: 9192553] ✅ Text extracted using pdfplumber (1382 chars)
[21:57:31] ✅    ✅ Text extracted using pdfplumber (1370 chars)
[21:57:31] 🔄 
🔄 Step 2: Extracting patient data...
[21:57:34] ℹ️  AI extracted raw sex value: ''
[21:57:34] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:57:34] ℹ️  AI extracted payer source: ''
[21:57:34] ℹ️  AI extracted diagnoses:
[21:57:34] ℹ️    - Diagnosis 1: 'I11.0'
[21:57:34] ℹ️    - Diagnosis 2: 'I50.32'
[21:57:34] ℹ️    - Diagnosis 3: 'None'
[21:57:34] ℹ️    - Diagnosis 4: 'None'
[21:57:34] ℹ️    - Diagnosis 5: 'None'
[21:57:34] ℹ️    - Diagnosis 6: 'None'
[21:57:34] ℹ️  Final extracted MRN: 'MA221012094404'
[21:57:34] ℹ️  Final extracted Sex: ''
[21:57:34] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:57:34] ℹ️  Final extracted Payer Source: ''
[21:57:34] ✅ Patient data extraction completed successfully
[21:57:34] ✅    ✅ Patient data extracted successfully
[21:57:34] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:57:34] ✅    ✅ Patient identified: Maria Ferreira
[21:57:34] ✅    ✅ Patient name validation passed
[21:57:34] 🔄 
🔄 Step 3: Processing patient dates...
[21:57:34] [DOC: 9192553] ℹ️  DOB normalized: 09/29/1944
[21:57:34] [DOC: 9192553] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[21:57:34] [DOC: 9192553] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[21:57:34] [DOC: 9192553] ✅ Patient date processing completed successfully
[21:57:34] ✅    ✅ Date processing completed
[21:57:34] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32'}]
[21:57:34] 🔄 
🔄 Step 4: Extracting order data...
[21:57:36] ℹ️  Order extraction - MRN: 'MA221012094404'
[21:57:36] ℹ️  Order extraction - Sex: ''
[21:57:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:57:36] ℹ️  Order extraction - Payer Source: ''
[21:57:36] ✅ Order data extraction completed successfully
[21:57:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:57:36] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[21:57:36] ℹ️  Inferred sex as FEMALE from name: Maria
[21:57:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:57:36] ✅ Patient name cross-validation successful
[21:57:36] ✅    ✅ Data merged successfully
[21:57:38] ✅    ✅ Order data extracted and validated
[21:57:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:57:38] [DOC: 9192553] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:38] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:38] 🔄 
🔄 Step 6: Pushing order to API...
[21:57:38] [DOC: 9192553] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:39] [DOC: 9192553] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13986"}
[21:57:39] ❌    ❌ Failed to push order
[21:57:39] 🔄 
🔄 Step 7: Writing to CSV...
[21:57:39] [DOC: 9192553] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[21:57:39] [DOC: 9192553] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:57:39] [DOC: 9192553] ℹ️  Payer Source extracted: ''
[21:57:39] [DOC: 9192553] ℹ️  Diagnosis codes being written:
[21:57:39] [DOC: 9192553] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[21:57:39] [DOC: 9192553] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[21:57:39] [DOC: 9192553] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:57:39] [DOC: 9192553] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:57:39] [DOC: 9192553] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:57:39] [DOC: 9192553] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:57:39] [DOC: 9192553] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[21:57:39] ✅    ✅ Document 9192553 processed and saved successfully
[21:57:39] 🔄 
🔄 Step 8: Saving API details...
[21:57:39] [DOC: 9192553] ℹ️  API push details saved for document 9192553
[21:57:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192550                         ║
================================================================================
[21:57:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:57:39] ℹ️  Date: 03/20/2025
[21:57:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:57:41] [DOC: 9192550] ✅ Text extracted using pdfplumber (1377 chars)
[21:57:41] ✅    ✅ Text extracted using pdfplumber (1365 chars)
[21:57:41] 🔄 
🔄 Step 2: Extracting patient data...
[21:57:44] ℹ️  AI extracted raw sex value: ''
[21:57:44] ℹ️  AI extracted service line: 'Physical Therapy'
[21:57:44] ℹ️  AI extracted payer source: ''
[21:57:44] ℹ️  AI extracted diagnoses:
[21:57:44] ℹ️    - Diagnosis 1: 'I11.0'
[21:57:44] ℹ️    - Diagnosis 2: 'I50.32'
[21:57:44] ℹ️    - Diagnosis 3: ''
[21:57:44] ℹ️    - Diagnosis 4: ''
[21:57:44] ℹ️    - Diagnosis 5: ''
[21:57:44] ℹ️    - Diagnosis 6: ''
[21:57:44] ℹ️  Final extracted MRN: 'MA221012094404'
[21:57:44] ℹ️  Final extracted Sex: ''
[21:57:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:57:44] ℹ️  Final extracted Payer Source: ''
[21:57:44] ✅ Patient data extraction completed successfully
[21:57:44] ✅    ✅ Patient data extracted successfully
[21:57:44] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:57:44] ✅    ✅ Patient identified: Maria Ferreira
[21:57:44] ✅    ✅ Patient name validation passed
[21:57:44] 🔄 
🔄 Step 3: Processing patient dates...
[21:57:44] [DOC: 9192550] ℹ️  DOB normalized: 09/29/1944
[21:57:44] [DOC: 9192550] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[21:57:44] [DOC: 9192550] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[21:57:44] [DOC: 9192550] ✅ Patient date processing completed successfully
[21:57:44] ✅    ✅ Date processing completed
[21:57:44] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:57:44] 🔄 
🔄 Step 4: Extracting order data...
[21:57:46] ℹ️  Order extraction - MRN: 'MA221012094404'
[21:57:46] ℹ️  Order extraction - Sex: ''
[21:57:46] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:57:46] ℹ️  Order extraction - Payer Source: ''
[21:57:46] ✅ Order data extraction completed successfully
[21:57:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:57:46] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[21:57:46] ℹ️  Inferred sex as FEMALE from name: Maria
[21:57:46] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:57:46] ✅ Patient name cross-validation successful
[21:57:46] ✅    ✅ Data merged successfully
[21:57:48] ✅    ✅ Order data extracted and validated
[21:57:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:57:48] [DOC: 9192550] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:48] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:48] 🔄 
🔄 Step 6: Pushing order to API...
[21:57:48] [DOC: 9192550] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:49] [DOC: 9192550] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14001"}
[21:57:49] ❌    ❌ Failed to push order
[21:57:49] 🔄 
🔄 Step 7: Writing to CSV...
[21:57:49] [DOC: 9192550] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[21:57:49] [DOC: 9192550] ℹ️  Service Line extracted: 'Physical Therapy'
[21:57:49] [DOC: 9192550] ℹ️  Payer Source extracted: ''
[21:57:49] [DOC: 9192550] ℹ️  Diagnosis codes being written:
[21:57:49] [DOC: 9192550] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[21:57:49] [DOC: 9192550] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[21:57:49] [DOC: 9192550] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:57:49] [DOC: 9192550] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:57:49] [DOC: 9192550] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:57:49] [DOC: 9192550] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:57:49] [DOC: 9192550] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA221012094404
[21:57:49] ✅    ✅ Document 9192550 processed and saved successfully
[21:57:49] 🔄 
🔄 Step 8: Saving API details...
[21:57:49] [DOC: 9192550] ℹ️  API push details saved for document 9192550
[21:57:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192547                         ║
================================================================================
[21:57:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:57:49] ℹ️  Date: 03/20/2025
[21:57:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:57:51] [DOC: 9192547] ✅ Text extracted using pdfplumber (1386 chars)
[21:57:51] ✅    ✅ Text extracted using pdfplumber (1374 chars)
[21:57:51] 🔄 
🔄 Step 2: Extracting patient data...
[21:57:54] ℹ️  AI extracted raw sex value: ''
[21:57:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:57:54] ℹ️  AI extracted payer source: ''
[21:57:54] ℹ️  AI extracted diagnoses:
[21:57:54] ℹ️    - Diagnosis 1: 'I11.0'
[21:57:54] ℹ️    - Diagnosis 2: 'I50.32'
[21:57:54] ℹ️    - Diagnosis 3: ''
[21:57:54] ℹ️    - Diagnosis 4: ''
[21:57:54] ℹ️    - Diagnosis 5: ''
[21:57:54] ℹ️    - Diagnosis 6: ''
[21:57:54] ℹ️  Final extracted MRN: 'MA221012094404'
[21:57:54] ℹ️  Final extracted Sex: ''
[21:57:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:57:54] ℹ️  Final extracted Payer Source: ''
[21:57:54] ✅ Patient data extraction completed successfully
[21:57:54] ✅    ✅ Patient data extracted successfully
[21:57:54] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:57:54] ✅    ✅ Patient identified: Maria Ferreira
[21:57:54] ✅    ✅ Patient name validation passed
[21:57:54] 🔄 
🔄 Step 3: Processing patient dates...
[21:57:54] [DOC: 9192547] ℹ️  DOB normalized: 09/29/1944
[21:57:54] [DOC: 9192547] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[21:57:54] [DOC: 9192547] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[21:57:54] [DOC: 9192547] ✅ Patient date processing completed successfully
[21:57:54] ✅    ✅ Date processing completed
[21:57:54] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:57:54] 🔄 
🔄 Step 4: Extracting order data...
[21:57:57] ℹ️  Order extraction - MRN: 'MA221012094404'
[21:57:57] ℹ️  Order extraction - Sex: ''
[21:57:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:57:57] ℹ️  Order extraction - Payer Source: ''
[21:57:57] ✅ Order data extraction completed successfully
[21:57:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:57:57] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[21:57:57] ℹ️  Inferred sex as FEMALE from name: Maria
[21:57:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:57:57] ✅ Patient name cross-validation successful
[21:57:57] ✅    ✅ Data merged successfully
[21:57:58] ✅    ✅ Order data extracted and validated
[21:57:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:57:58] [DOC: 9192547] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:58] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:57:58] 🔄 
🔄 Step 6: Pushing order to API...
[21:57:58] [DOC: 9192547] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[21:58:01] [DOC: 9192547] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14002"}
[21:58:01] ❌    ❌ Failed to push order
[21:58:01] 🔄 
🔄 Step 7: Writing to CSV...
[21:58:01] [DOC: 9192547] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[21:58:01] [DOC: 9192547] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:58:01] [DOC: 9192547] ℹ️  Payer Source extracted: ''
[21:58:01] [DOC: 9192547] ℹ️  Diagnosis codes being written:
[21:58:01] [DOC: 9192547] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[21:58:01] [DOC: 9192547] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[21:58:01] [DOC: 9192547] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:58:01] [DOC: 9192547] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:58:01] [DOC: 9192547] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:58:01] [DOC: 9192547] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:58:01] [DOC: 9192547] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: MA221012094404
[21:58:01] ✅    ✅ Document 9192547 processed and saved successfully
[21:58:01] 🔄 
🔄 Step 8: Saving API details...
[21:58:01] [DOC: 9192547] ℹ️  API push details saved for document 9192547
[21:58:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192546                         ║
================================================================================
[21:58:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:58:01] ℹ️  Date: 03/20/2025
[21:58:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:58:05] [DOC: 9192546] ✅ Text extracted using pdfplumber (15257 chars)
[21:58:05] ✅    ✅ Text extracted using pdfplumber (15257 chars)
[21:58:05] 🔄 
🔄 Step 2: Extracting patient data...
[21:58:08] ℹ️  AI extracted raw sex value: 'F'
[21:58:08] ℹ️  AI extracted service line: 'Physical Therapy'
[21:58:08] ℹ️  AI extracted payer source: ''
[21:58:08] ℹ️  AI extracted diagnoses:
[21:58:08] ℹ️    - Diagnosis 1: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[21:58:08] ℹ️    - Diagnosis 2: 'Muscle weakness'
[21:58:08] ℹ️    - Diagnosis 3: 'L LE cellulitis'
[21:58:08] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[21:58:08] ℹ️    - Diagnosis 5: 'GERD'
[21:58:08] ℹ️    - Diagnosis 6: 'DM type 2 with hyperglycemia'
[21:58:08] ℹ️  Final extracted MRN: 'MA240822115704'
[21:58:08] ℹ️  Final extracted Sex: 'FEMALE'
[21:58:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:58:08] ℹ️  Final extracted Payer Source: ''
[21:58:08] ✅ Patient data extraction completed successfully
[21:58:08] ✅    ✅ Patient data extracted successfully
[21:58:08] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[21:58:08] ✅    ✅ Patient identified: Charlene Couto
[21:58:08] ✅    ✅ Patient name validation passed
[21:58:08] 🔄 
🔄 Step 3: Processing patient dates...
[21:58:08] [DOC: 9192546] ℹ️  DOB normalized: 11/01/1957
[21:58:08] [DOC: 9192546] ℹ️  Episode startOfCare normalized: 02/21/2025
[21:58:08] [DOC: 9192546] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[21:58:08] [DOC: 9192546] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[21:58:08] [DOC: 9192546] ✅ Patient date processing completed successfully
[21:58:08] ✅    ✅ Date processing completed
[21:58:08] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[21:58:08] 🔄 
🔄 Step 4: Extracting order data...
[21:58:10] ℹ️  Order extraction - MRN: 'MA240822115704'
[21:58:10] ℹ️  Order extraction - Sex: 'FEMALE'
[21:58:10] ℹ️  Order extraction - Service Line: 'PT'
[21:58:10] ℹ️  Order extraction - Payer Source: ''
[21:58:10] ✅ Order data extraction completed successfully
[21:58:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:58:10] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[21:58:10] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[21:58:10] ✅ Patient name cross-validation successful
[21:58:10] ✅    ✅ Data merged successfully
[21:58:12] ✅    ✅ Order data extracted and validated
[21:58:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:58:12] [DOC: 9192546] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[21:58:12] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[21:58:12] 🔄 
🔄 Step 6: Pushing order to API...
[21:58:12] [DOC: 9192546] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[21:58:13] [DOC: 9192546] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:58:13] ❌    ❌ Failed to push order
[21:58:13] 🔄 
🔄 Step 7: Writing to CSV...
[21:58:13] [DOC: 9192546] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[21:58:13] [DOC: 9192546] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[21:58:13] [DOC: 9192546] ℹ️  Payer Source extracted: ''
[21:58:13] [DOC: 9192546] ℹ️  Diagnosis codes being written:
[21:58:13] [DOC: 9192546] ℹ️    - Latest_Episode_Firstdiagnosis: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[21:58:13] [DOC: 9192546] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[21:58:13] [DOC: 9192546] ℹ️    - Latest_Episode_Thirddiagnosis: 'L LE cellulitis'
[21:58:13] [DOC: 9192546] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Multiple sclerosis'
[21:58:13] [DOC: 9192546] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GERD'
[21:58:13] [DOC: 9192546] ℹ️    - Latest_Episode_Sixthdiagnosis: 'DM type 2 with hyperglycemia'
[21:58:13] [DOC: 9192546] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: PT, Physical Therapy | Payer:  | MRN: MA240822115704
[21:58:13] ✅    ✅ Document 9192546 processed and saved successfully
[21:58:13] 🔄 
🔄 Step 8: Saving API details...
[21:58:13] [DOC: 9192546] ℹ️  API push details saved for document 9192546
[21:58:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192523                         ║
================================================================================
[21:58:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:58:13] ℹ️  Date: 03/20/2025
[21:58:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:58:19] [DOC: 9192523] ✅ Text extracted using pdfplumber (15257 chars)
[21:58:19] ✅    ✅ Text extracted using pdfplumber (15257 chars)
[21:58:19] 🔄 
🔄 Step 2: Extracting patient data...
[21:58:22] ℹ️  AI extracted raw sex value: 'F'
[21:58:22] ℹ️  AI extracted service line: 'PT'
[21:58:22] ℹ️  AI extracted payer source: ''
[21:58:22] ℹ️  AI extracted diagnoses:
[21:58:22] ℹ️    - Diagnosis 1: 'E11.9'
[21:58:22] ℹ️    - Diagnosis 2: 'M16.0'
[21:58:22] ℹ️    - Diagnosis 3: 'K21.9'
[21:58:22] ℹ️    - Diagnosis 4: 'I70.9'
[21:58:22] ℹ️    - Diagnosis 5: 'I10'
[21:58:22] ℹ️    - Diagnosis 6: 'F31.9'
[21:58:22] ℹ️  Final extracted MRN: 'MA240822115704'
[21:58:22] ℹ️  Final extracted Sex: 'FEMALE'
[21:58:22] ℹ️  Final extracted Service Line: 'PT'
[21:58:22] ℹ️  Final extracted Payer Source: ''
[21:58:22] ✅ Patient data extraction completed successfully
[21:58:22] ✅    ✅ Patient data extracted successfully
[21:58:22] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'M16.0', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'I70.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F31.9'}]
[21:58:22] ✅    ✅ Patient identified: Charlene Couto
[21:58:22] ✅    ✅ Patient name validation passed
[21:58:22] 🔄 
🔄 Step 3: Processing patient dates...
[21:58:22] [DOC: 9192523] ℹ️  DOB normalized: 11/01/1957
[21:58:22] [DOC: 9192523] ℹ️  Episode startOfCare normalized: 02/21/2025
[21:58:22] [DOC: 9192523] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[21:58:22] [DOC: 9192523] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[21:58:22] [DOC: 9192523] ✅ Patient date processing completed successfully
[21:58:22] ✅    ✅ Date processing completed
[21:58:22] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'M16.0', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'I70.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F31.9'}]
[21:58:22] 🔄 
🔄 Step 4: Extracting order data...
[21:58:24] ℹ️  Order extraction - MRN: 'MA240822115704'
[21:58:24] ℹ️  Order extraction - Sex: 'FEMALE'
[21:58:24] ℹ️  Order extraction - Service Line: 'PT'
[21:58:24] ℹ️  Order extraction - Payer Source: ''
[21:58:24] ✅ Order data extraction completed successfully
[21:58:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:58:24] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[21:58:24] ℹ️  Service line consistent in both sources: 'PT'
[21:58:24] ✅ Patient name cross-validation successful
[21:58:24] ✅    ✅ Data merged successfully
[21:58:25] ✅    ✅ Order data extracted and validated
[21:58:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:58:25] [DOC: 9192523] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[21:58:25] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[21:58:25] 🔄 
🔄 Step 6: Pushing order to API...
[21:58:25] [DOC: 9192523] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[21:58:27] [DOC: 9192523] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:58:27] ❌    ❌ Failed to push order
[21:58:27] 🔄 
🔄 Step 7: Writing to CSV...
[21:58:27] [DOC: 9192523] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[21:58:27] [DOC: 9192523] ℹ️  Service Line extracted: 'PT'
[21:58:27] [DOC: 9192523] ℹ️  Payer Source extracted: ''
[21:58:27] [DOC: 9192523] ℹ️  Diagnosis codes being written:
[21:58:27] [DOC: 9192523] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[21:58:27] [DOC: 9192523] ℹ️    - Latest_Episode_Seconddiagnosis: 'M16.0'
[21:58:27] [DOC: 9192523] ℹ️    - Latest_Episode_Thirddiagnosis: 'K21.9'
[21:58:27] [DOC: 9192523] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I70.9'
[21:58:27] [DOC: 9192523] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[21:58:27] [DOC: 9192523] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F31.9'
[21:58:27] [DOC: 9192523] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: PT | Payer:  | MRN: MA240822115704
[21:58:27] ✅    ✅ Document 9192523 processed and saved successfully
[21:58:27] 🔄 
🔄 Step 8: Saving API details...
[21:58:27] [DOC: 9192523] ℹ️  API push details saved for document 9192523
[21:58:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192508                         ║
================================================================================
[21:58:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:58:27] ℹ️  Date: 03/20/2025
[21:58:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:58:29] [DOC: 9192508] ✅ Text extracted using pdfplumber (1552 chars)
[21:58:29] ✅    ✅ Text extracted using pdfplumber (1552 chars)
[21:58:29] 🔄 
🔄 Step 2: Extracting patient data...
[21:58:32] ℹ️  AI extracted raw sex value: ''
[21:58:32] ℹ️  AI extracted service line: 'Occupational Therapy'
[21:58:32] ℹ️  AI extracted payer source: ''
[21:58:32] ℹ️  AI extracted diagnoses:
[21:58:32] ℹ️    - Diagnosis 1: 'G40.909'
[21:58:32] ℹ️    - Diagnosis 2: 'F51.04'
[21:58:32] ℹ️    - Diagnosis 3: 'G81.94'
[21:58:32] ℹ️    - Diagnosis 4: ''
[21:58:32] ℹ️    - Diagnosis 5: ''
[21:58:32] ℹ️    - Diagnosis 6: ''
[21:58:32] ℹ️  Final extracted MRN: 'MA240318025203'
[21:58:32] ℹ️  Final extracted Sex: ''
[21:58:32] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[21:58:32] ℹ️  Final extracted Payer Source: ''
[21:58:32] ✅ Patient data extraction completed successfully
[21:58:32] ✅    ✅ Patient data extracted successfully
[21:58:32] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:58:32] ✅    ✅ Patient identified: Dale Brooks
[21:58:32] ✅    ✅ Patient name validation passed
[21:58:32] 🔄 
🔄 Step 3: Processing patient dates...
[21:58:32] [DOC: 9192508] ℹ️  DOB normalized: 02/24/1952
[21:58:32] [DOC: 9192508] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:58:32] [DOC: 9192508] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:58:32] [DOC: 9192508] ✅ Patient date processing completed successfully
[21:58:32] ✅    ✅ Date processing completed
[21:58:32] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:58:32] 🔄 
🔄 Step 4: Extracting order data...
[21:58:35] ℹ️  Order extraction - MRN: 'MA240318025203'
[21:58:35] ℹ️  Order extraction - Sex: ''
[21:58:35] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[21:58:35] ℹ️  Order extraction - Payer Source: ''
[21:58:35] ✅ Order data extraction completed successfully
[21:58:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:58:35] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[21:58:35] ⚠️  Could not determine sex using any available method
[21:58:35] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[21:58:35] ✅ Patient name cross-validation successful
[21:58:35] ✅    ✅ Data merged successfully
[21:58:36] ✅    ✅ Order data extracted and validated
[21:58:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:58:36] [DOC: 9192508] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:36] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:36] 🔄 
🔄 Step 6: Pushing order to API...
[21:58:36] [DOC: 9192508] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:37] [DOC: 9192508] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13361"}
[21:58:37] ❌    ❌ Failed to push order
[21:58:37] 🔄 
🔄 Step 7: Writing to CSV...
[21:58:37] [DOC: 9192508] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[21:58:37] [DOC: 9192508] ℹ️  Service Line extracted: 'Occupational Therapy'
[21:58:37] [DOC: 9192508] ℹ️  Payer Source extracted: ''
[21:58:37] [DOC: 9192508] ℹ️  Diagnosis codes being written:
[21:58:37] [DOC: 9192508] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[21:58:37] [DOC: 9192508] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[21:58:37] [DOC: 9192508] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[21:58:37] [DOC: 9192508] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:58:37] [DOC: 9192508] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:58:37] [DOC: 9192508] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:58:37] [DOC: 9192508] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Occupational Therapy | Payer:  | MRN: MA240318025203
[21:58:37] ✅    ✅ Document 9192508 processed and saved successfully
[21:58:37] 🔄 
🔄 Step 8: Saving API details...
[21:58:37] [DOC: 9192508] ℹ️  API push details saved for document 9192508
[21:58:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192505                         ║
================================================================================
[21:58:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:58:37] ℹ️  Date: 03/20/2025
[21:58:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:58:39] [DOC: 9192505] ✅ Text extracted using pdfplumber (1547 chars)
[21:58:39] ✅    ✅ Text extracted using pdfplumber (1547 chars)
[21:58:39] 🔄 
🔄 Step 2: Extracting patient data...
[21:58:42] ℹ️  AI extracted raw sex value: ''
[21:58:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:58:42] ℹ️  AI extracted payer source: ''
[21:58:42] ℹ️  AI extracted diagnoses:
[21:58:42] ℹ️    - Diagnosis 1: 'G40.909'
[21:58:42] ℹ️    - Diagnosis 2: 'F51.04'
[21:58:42] ℹ️    - Diagnosis 3: 'G81.94'
[21:58:42] ℹ️    - Diagnosis 4: ''
[21:58:42] ℹ️    - Diagnosis 5: ''
[21:58:42] ℹ️    - Diagnosis 6: ''
[21:58:42] ℹ️  Final extracted MRN: 'MA240318025203'
[21:58:42] ℹ️  Final extracted Sex: ''
[21:58:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:58:42] ℹ️  Final extracted Payer Source: ''
[21:58:42] ✅ Patient data extraction completed successfully
[21:58:42] ✅    ✅ Patient data extracted successfully
[21:58:42] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:58:42] ✅    ✅ Patient identified: Dale Brooks
[21:58:42] ✅    ✅ Patient name validation passed
[21:58:42] 🔄 
🔄 Step 3: Processing patient dates...
[21:58:42] [DOC: 9192505] ℹ️  DOB normalized: 02/24/1952
[21:58:42] [DOC: 9192505] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:58:42] [DOC: 9192505] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:58:42] [DOC: 9192505] ✅ Patient date processing completed successfully
[21:58:42] ✅    ✅ Date processing completed
[21:58:42] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:58:42] 🔄 
🔄 Step 4: Extracting order data...
[21:58:45] ℹ️  Order extraction - MRN: 'MA240318025203'
[21:58:45] ℹ️  Order extraction - Sex: ''
[21:58:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:58:45] ℹ️  Order extraction - Payer Source: ''
[21:58:45] ✅ Order data extraction completed successfully
[21:58:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:58:45] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[21:58:45] ⚠️  Could not determine sex using any available method
[21:58:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:58:45] ✅ Patient name cross-validation successful
[21:58:45] ✅    ✅ Data merged successfully
[21:58:46] ✅    ✅ Order data extracted and validated
[21:58:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:58:46] [DOC: 9192505] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:46] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:46] 🔄 
🔄 Step 6: Pushing order to API...
[21:58:46] [DOC: 9192505] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:47] [DOC: 9192505] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13362"}
[21:58:47] ❌    ❌ Failed to push order
[21:58:47] 🔄 
🔄 Step 7: Writing to CSV...
[21:58:47] [DOC: 9192505] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[21:58:47] [DOC: 9192505] ℹ️  Service Line extracted: 'Skilled Nursing'
[21:58:47] [DOC: 9192505] ℹ️  Payer Source extracted: ''
[21:58:47] [DOC: 9192505] ℹ️  Diagnosis codes being written:
[21:58:47] [DOC: 9192505] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[21:58:47] [DOC: 9192505] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[21:58:47] [DOC: 9192505] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[21:58:47] [DOC: 9192505] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:58:47] [DOC: 9192505] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:58:47] [DOC: 9192505] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:58:47] [DOC: 9192505] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA240318025203
[21:58:47] ✅    ✅ Document 9192505 processed and saved successfully
[21:58:47] 🔄 
🔄 Step 8: Saving API details...
[21:58:47] [DOC: 9192505] ℹ️  API push details saved for document 9192505
[21:58:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192504                         ║
================================================================================
[21:58:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:58:47] ℹ️  Date: 03/20/2025
[21:58:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:58:50] [DOC: 9192504] ✅ Text extracted using pdfplumber (1702 chars)
[21:58:50] ✅    ✅ Text extracted using pdfplumber (1702 chars)
[21:58:50] 🔄 
🔄 Step 2: Extracting patient data...
[21:58:53] ℹ️  AI extracted raw sex value: ''
[21:58:53] ℹ️  AI extracted service line: 'Physical Therapy'
[21:58:53] ℹ️  AI extracted payer source: ''
[21:58:53] ℹ️  AI extracted diagnoses:
[21:58:53] ℹ️    - Diagnosis 1: 'G40.909'
[21:58:53] ℹ️    - Diagnosis 2: 'F51.04'
[21:58:53] ℹ️    - Diagnosis 3: 'G81.94'
[21:58:53] ℹ️    - Diagnosis 4: 'None'
[21:58:53] ℹ️    - Diagnosis 5: 'None'
[21:58:53] ℹ️    - Diagnosis 6: 'None'
[21:58:53] ℹ️  Final extracted MRN: 'MA240318025203'
[21:58:53] ℹ️  Final extracted Sex: ''
[21:58:53] ℹ️  Final extracted Service Line: 'Physical Therapy'
[21:58:53] ℹ️  Final extracted Payer Source: ''
[21:58:53] ✅ Patient data extraction completed successfully
[21:58:53] ✅    ✅ Patient data extracted successfully
[21:58:53] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:58:53] ✅    ✅ Patient identified: Dale Brooks
[21:58:53] ✅    ✅ Patient name validation passed
[21:58:53] 🔄 
🔄 Step 3: Processing patient dates...
[21:58:53] [DOC: 9192504] ℹ️  DOB normalized: 02/24/1952
[21:58:53] [DOC: 9192504] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:58:53] [DOC: 9192504] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:58:53] [DOC: 9192504] ✅ Patient date processing completed successfully
[21:58:53] ✅    ✅ Date processing completed
[21:58:53] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94'}]
[21:58:53] 🔄 
🔄 Step 4: Extracting order data...
[21:58:56] ℹ️  Order extraction - MRN: 'MA240318025203'
[21:58:56] ℹ️  Order extraction - Sex: ''
[21:58:56] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[21:58:56] ℹ️  Order extraction - Payer Source: ''
[21:58:56] ✅ Order data extraction completed successfully
[21:58:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:58:56] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[21:58:56] ⚠️  Could not determine sex using any available method
[21:58:56] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[21:58:56] ✅ Patient name cross-validation successful
[21:58:56] ✅    ✅ Data merged successfully
[21:58:57] ✅    ✅ Order data extracted and validated
[21:58:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:58:57] [DOC: 9192504] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:57] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:57] 🔄 
🔄 Step 6: Pushing order to API...
[21:58:57] [DOC: 9192504] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:58:58] [DOC: 9192504] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13368"}
[21:58:58] ❌    ❌ Failed to push order
[21:58:58] 🔄 
🔄 Step 7: Writing to CSV...
[21:58:58] [DOC: 9192504] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[21:58:58] [DOC: 9192504] ℹ️  Service Line extracted: 'Physical Therapy'
[21:58:58] [DOC: 9192504] ℹ️  Payer Source extracted: ''
[21:58:58] [DOC: 9192504] ℹ️  Diagnosis codes being written:
[21:58:58] [DOC: 9192504] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[21:58:58] [DOC: 9192504] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[21:58:58] [DOC: 9192504] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[21:58:58] [DOC: 9192504] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:58:58] [DOC: 9192504] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:58:58] [DOC: 9192504] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:58:58] [DOC: 9192504] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Physical Therapy | Payer:  | MRN: MA240318025203
[21:58:58] ✅    ✅ Document 9192504 processed and saved successfully
[21:58:58] 🔄 
🔄 Step 8: Saving API details...
[21:58:58] [DOC: 9192504] ℹ️  API push details saved for document 9192504
[21:58:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192502                         ║
================================================================================
[21:58:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[21:58:58] ℹ️  Date: 03/20/2025
[21:58:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:00] [DOC: 9192502] ✅ Text extracted using pdfplumber (1959 chars)
[21:59:00] ✅    ✅ Text extracted using pdfplumber (1959 chars)
[21:59:00] 🔄 
🔄 Step 2: Extracting patient data...
[21:59:03] ℹ️  AI extracted raw sex value: ''
[21:59:03] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:59:03] ℹ️  AI extracted payer source: ''
[21:59:03] ℹ️  AI extracted diagnoses:
[21:59:03] ℹ️    - Diagnosis 1: 'G40.909'
[21:59:03] ℹ️    - Diagnosis 2: 'F51.04'
[21:59:03] ℹ️    - Diagnosis 3: 'G81.94'
[21:59:03] ℹ️    - Diagnosis 4: ''
[21:59:03] ℹ️    - Diagnosis 5: ''
[21:59:03] ℹ️    - Diagnosis 6: ''
[21:59:03] ℹ️  Final extracted MRN: 'MA240318025203'
[21:59:03] ℹ️  Final extracted Sex: ''
[21:59:03] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:59:03] ℹ️  Final extracted Payer Source: ''
[21:59:03] ✅ Patient data extraction completed successfully
[21:59:03] ✅    ✅ Patient data extracted successfully
[21:59:03] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:59:03] ✅    ✅ Patient identified: Dale Brooks
[21:59:03] ✅    ✅ Patient name validation passed
[21:59:03] 🔄 
🔄 Step 3: Processing patient dates...
[21:59:03] [DOC: 9192502] ℹ️  DOB normalized: 02/24/1952
[21:59:03] [DOC: 9192502] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:59:03] [DOC: 9192502] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[21:59:03] [DOC: 9192502] ✅ Patient date processing completed successfully
[21:59:03] ✅    ✅ Date processing completed
[21:59:03] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:59:03] 🔄 
🔄 Step 4: Extracting order data...
[21:59:06] ℹ️  Order extraction - MRN: 'MA240318025203'
[21:59:06] ℹ️  Order extraction - Sex: ''
[21:59:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:59:06] ℹ️  Order extraction - Payer Source: ''
[21:59:06] ✅ Order data extraction completed successfully
[21:59:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:59:06] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[21:59:06] ⚠️  Could not determine sex using any available method
[21:59:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:59:06] ✅ Patient name cross-validation successful
[21:59:06] ✅    ✅ Data merged successfully
[21:59:07] ✅    ✅ Order data extracted and validated
[21:59:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:59:07] [DOC: 9192502] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:59:07] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:59:07] 🔄 
🔄 Step 6: Pushing order to API...
[21:59:07] [DOC: 9192502] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[21:59:08] [DOC: 9192502] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13369"}
[21:59:08] ❌    ❌ Failed to push order
[21:59:08] 🔄 
🔄 Step 7: Writing to CSV...
[21:59:08] [DOC: 9192502] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[21:59:08] [DOC: 9192502] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[21:59:08] [DOC: 9192502] ℹ️  Payer Source extracted: ''
[21:59:08] [DOC: 9192502] ℹ️  Diagnosis codes being written:
[21:59:08] [DOC: 9192502] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[21:59:08] [DOC: 9192502] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[21:59:08] [DOC: 9192502] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[21:59:08] [DOC: 9192502] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:59:08] [DOC: 9192502] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:59:08] [DOC: 9192502] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:59:08] [DOC: 9192502] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA240318025203
[21:59:08] ✅    ✅ Document 9192502 processed and saved successfully
[21:59:08] 🔄 
🔄 Step 8: Saving API details...
[21:59:08] [DOC: 9192502] ℹ️  API push details saved for document 9192502
[21:59:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192470                         ║
================================================================================
[21:59:08] ℹ️  Agency: Nizhoni Health-Fall River
[21:59:08] ℹ️  Date: 03/20/2025
[21:59:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:13] [DOC: 9192470] ✅ Text extracted using pdfplumber (1125 chars)
[21:59:13] ✅    ✅ Text extracted using pdfplumber (1125 chars)
[21:59:13] 🔄 
🔄 Step 2: Extracting patient data...
[21:59:15] ℹ️  AI extracted raw sex value: 'M'
[21:59:15] ℹ️  AI extracted service line: 'HHA'
[21:59:15] ℹ️  AI extracted payer source: 'Medicaid/MA'
[21:59:15] ℹ️  AI extracted diagnoses:
[21:59:15] ℹ️    - Diagnosis 1: ''
[21:59:15] ℹ️    - Diagnosis 2: ''
[21:59:15] ℹ️    - Diagnosis 3: ''
[21:59:15] ℹ️    - Diagnosis 4: ''
[21:59:15] ℹ️    - Diagnosis 5: ''
[21:59:15] ℹ️    - Diagnosis 6: ''
[21:59:15] ℹ️  Final extracted MRN: '8496020'
[21:59:15] ℹ️  Final extracted Sex: 'MALE'
[21:59:15] ℹ️  Final extracted Service Line: 'HHA'
[21:59:15] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[21:59:15] ✅ Patient data extraction completed successfully
[21:59:15] ✅    ✅ Patient data extracted successfully
[21:59:15] 📊 Patient Response
     └─ patientFName: Cullen
     └─ patientLName: Tate
     └─ dob: 11/23/2000
     └─ patientSex: MALE
     └─ medicalRecordNo: 8496020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 2 Acushnet Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2023', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:59:15] ✅    ✅ Patient identified: Cullen Tate
[21:59:15] ✅    ✅ Patient name validation passed
[21:59:15] 🔄 
🔄 Step 3: Processing patient dates...
[21:59:15] [DOC: 9192470] ℹ️  DOB normalized: 11/23/2000
[21:59:15] [DOC: 9192470] ℹ️  Episode startOfCare normalized: 11/03/2023
[21:59:15] [DOC: 9192470] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[21:59:15] [DOC: 9192470] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[21:59:15] [DOC: 9192470] ✅ Patient date processing completed successfully
[21:59:15] ✅    ✅ Date processing completed
[21:59:15] 📊 Processed Patient Data
     └─ patientFName: Cullen
     └─ patientLName: Tate
     └─ dob: 11/23/2000
     └─ patientSex: MALE
     └─ medicalRecordNo: 8496020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 2 Acushnet Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2023', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:59:15] 🔄 
🔄 Step 4: Extracting order data...
[21:59:18] ℹ️  Order extraction - MRN: '8496020'
[21:59:18] ℹ️  Order extraction - Sex: 'MALE'
[21:59:18] ℹ️  Order extraction - Service Line: 'HHA'
[21:59:18] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[21:59:18] ✅ Order data extraction completed successfully
[21:59:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:59:18] ℹ️  Using MRN from patient data: '8496020' over '8496020'
[21:59:18] ℹ️  Service line consistent in both sources: 'HHA'
[21:59:18] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[21:59:18] ✅ Patient name cross-validation successful
[21:59:18] ✅    ✅ Data merged successfully
[21:59:21] ✅    ✅ Order data extracted and validated
[21:59:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[21:59:21] [DOC: 9192470] ✅ Patient found in local cache: Cullen Tate, ID: a5853fc6-5bef-4f78-9edc-fefdecd72573
[21:59:21] ✅    ✅ Existing patient found with ID: a5853fc6-5bef-4f78-9edc-fefdecd72573
[21:59:21] 🔄 
🔄 Step 6: Pushing order to API...
[21:59:21] [DOC: 9192470] ℹ️  Pushing order via API for patient ID: a5853fc6-5bef-4f78-9edc-fefdecd72573
[21:59:22] [DOC: 9192470] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[21:59:22] ❌    ❌ Failed to push order
[21:59:22] 🔄 
🔄 Step 7: Writing to CSV...
[21:59:22] [DOC: 9192470] ℹ️  Calculated age: 24 from DOB: 11/23/2000
[21:59:22] [DOC: 9192470] ℹ️  Service Line extracted: 'HHA'
[21:59:22] [DOC: 9192470] ℹ️  Payer Source extracted: 'Medicaid/MA'
[21:59:22] [DOC: 9192470] ℹ️  Diagnosis codes being written:
[21:59:22] [DOC: 9192470] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[21:59:22] [DOC: 9192470] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[21:59:22] [DOC: 9192470] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[21:59:22] [DOC: 9192470] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[21:59:22] [DOC: 9192470] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[21:59:22] [DOC: 9192470] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[21:59:22] [DOC: 9192470] ✅ Patient data written to CSV: Cullen Tate | Sex: MALE | Age: 24 | Service: HHA | Payer: Medicaid/MA | MRN: 8496020
[21:59:22] ✅    ✅ Document 9192470 processed and saved successfully
[21:59:22] 🔄 
🔄 Step 8: Saving API details...
[21:59:22] [DOC: 9192470] ℹ️  API push details saved for document 9192470
[21:59:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192081                         ║
================================================================================
[21:59:22] ℹ️  Agency: Brigham Home Care Services.Inc
[21:59:22] ℹ️  Date: 03/19/2025
[21:59:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:24] [DOC: 9192081] ✅ Text extracted using pdfplumber (1956 chars)
[21:59:24] ✅    ✅ Text extracted using pdfplumber (1956 chars)
[21:59:24] 🔄 
🔄 Step 2: Extracting patient data...
[21:59:27] ℹ️  AI extracted raw sex value: 'M'
[21:59:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:59:27] ℹ️  AI extracted payer source: ''
[21:59:27] ℹ️  AI extracted diagnoses:
[21:59:27] ℹ️    - Diagnosis 1: ''
[21:59:27] ℹ️    - Diagnosis 2: ''
[21:59:27] ℹ️    - Diagnosis 3: ''
[21:59:27] ℹ️    - Diagnosis 4: ''
[21:59:27] ℹ️    - Diagnosis 5: ''
[21:59:27] ℹ️    - Diagnosis 6: ''
[21:59:27] ℹ️  Final extracted MRN: '1442'
[21:59:27] ℹ️  Final extracted Sex: 'MALE'
[21:59:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:59:27] ℹ️  Final extracted Payer Source: ''
[21:59:27] ✅ Patient data extraction completed successfully
[21:59:27] ✅    ✅ Patient data extracted successfully
[21:59:27] 📊 Patient Response
     └─ patientFName: STEVEN
     └─ patientLName: PICHE
     └─ dob: 04/10/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 1442
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/21/2024', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:59:27] ✅    ✅ Patient identified: STEVEN PICHE
[21:59:27] ✅    ✅ Patient name validation passed
[21:59:27] 🔄 
🔄 Step 3: Processing patient dates...
[21:59:27] [DOC: 9192081] ℹ️  DOB normalized: 04/10/1968
[21:59:27] [DOC: 9192081] ℹ️  Episode startOfEpisode normalized: 12/21/2024
[21:59:27] [DOC: 9192081] ℹ️  Episode endOfEpisode normalized: 02/18/2025
[21:59:27] [DOC: 9192081] ✅ Patient date processing completed successfully
[21:59:27] ✅    ✅ Date processing completed
[21:59:27] 📊 Processed Patient Data
     └─ patientFName: STEVEN
     └─ patientLName: PICHE
     └─ dob: 04/10/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 1442
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/21/2024', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[21:59:27] 🔄 
🔄 Step 4: Extracting order data...
[21:59:29] ℹ️  Order extraction - MRN: '1442'
[21:59:29] ℹ️  Order extraction - Sex: 'MALE'
[21:59:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:59:29] ℹ️  Order extraction - Payer Source: ''
[21:59:29] ✅ Order data extraction completed successfully
[21:59:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:59:29] ℹ️  Using MRN from patient data: '1442' over '1442'
[21:59:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:59:29] ✅ Patient name cross-validation successful
[21:59:29] ✅    ✅ Data merged successfully
[21:59:30] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[21:59:30] [DOC: 9192081] ℹ️  API push details saved for document 9192081
================================================================================
║                        Processing Document ID: 2164334                         ║
================================================================================
[21:59:30] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:59:30] ℹ️  Date: 03/19/2025
[21:59:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:31] [DOC: 2164334] ❌ Critical failure in get_pdf_text: Invalid response format
[21:59:31] ❌ Failed to extract text for Doc ID 2164334
[21:59:31] [DOC: 2164334] ℹ️  API push details saved for document 2164334
================================================================================
║                        Processing Document ID: 2164330                         ║
================================================================================
[21:59:31] ℹ️  Agency: Visiting Rehab & Nursing Services
[21:59:31] ℹ️  Date: 03/19/2025
[21:59:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:32] [DOC: 2164330] ❌ Critical failure in get_pdf_text: Invalid response format
[21:59:32] ❌ Failed to extract text for Doc ID 2164330
[21:59:32] [DOC: 2164330] ℹ️  API push details saved for document 2164330
================================================================================
║                        Processing Document ID: 9190942                         ║
================================================================================
[21:59:32] ℹ️  Agency: Brigham Home Care Services.Inc
[21:59:32] ℹ️  Date: 03/19/2025
[21:59:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:35] [DOC: 9190942] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[21:59:36] [DOC: 9190942] ✅ Text extracted using tesseract_ocr (1785 chars)
[21:59:36] ✅    ✅ Text extracted using tesseract_ocr (1758 chars)
[21:59:36] 🔄 
🔄 Step 2: Extracting patient data...
[21:59:39] ℹ️  AI extracted raw sex value: 'M'
[21:59:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[21:59:39] ℹ️  AI extracted payer source: ''
[21:59:39] ℹ️  AI extracted diagnoses:
[21:59:39] ℹ️    - Diagnosis 1: 'None'
[21:59:39] ℹ️    - Diagnosis 2: 'None'
[21:59:39] ℹ️    - Diagnosis 3: 'None'
[21:59:39] ℹ️    - Diagnosis 4: 'None'
[21:59:39] ℹ️    - Diagnosis 5: 'None'
[21:59:39] ℹ️    - Diagnosis 6: 'None'
[21:59:39] ℹ️  Final extracted MRN: '3757'
[21:59:39] ℹ️  Final extracted Sex: 'MALE'
[21:59:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[21:59:39] ℹ️  Final extracted Payer Source: ''
[21:59:39] ✅ Patient data extraction completed successfully
[21:59:39] ✅    ✅ Patient data extracted successfully
[21:59:39] 📊 Patient Response
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc.
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:59:39] ✅    ✅ Patient identified: RYAN MENDONCA
[21:59:39] ✅    ✅ Patient name validation passed
[21:59:39] 🔄 
🔄 Step 3: Processing patient dates...
[21:59:39] [DOC: 9190942] ℹ️  DOB normalized: 04/23/1980
[21:59:39] [DOC: 9190942] ℹ️  Episode startOfEpisode normalized: 01/11/2025
[21:59:39] [DOC: 9190942] ℹ️  Episode endOfEpisode normalized: 03/11/2025
[21:59:39] [DOC: 9190942] ✅ Patient date processing completed successfully
[21:59:39] ✅    ✅ Date processing completed
[21:59:39] 📊 Processed Patient Data
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc.
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/11/2025'}]
[21:59:39] 🔄 
🔄 Step 4: Extracting order data...
[21:59:41] ℹ️  Order extraction - MRN: '3757'
[21:59:41] ℹ️  Order extraction - Sex: 'MALE'
[21:59:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[21:59:41] ℹ️  Order extraction - Payer Source: ''
[21:59:41] ✅ Order data extraction completed successfully
[21:59:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:59:41] ℹ️  Using MRN from patient data: '3757' over '3757'
[21:59:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[21:59:41] ✅ Patient name cross-validation successful
[21:59:41] ✅    ✅ Data merged successfully
[21:59:42] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[21:59:42] [DOC: 9190942] ℹ️  API push details saved for document 9190942
================================================================================
║                        Processing Document ID: 9192368                         ║
================================================================================
[21:59:42] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[21:59:42] ℹ️  Date: 03/19/2025
[21:59:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[21:59:44] [DOC: 9192368] ✅ Text extracted using pdfplumber (1439 chars)
[21:59:44] ✅    ✅ Text extracted using pdfplumber (1439 chars)
[21:59:44] 🔄 
🔄 Step 2: Extracting patient data...
[21:59:47] ℹ️  AI extracted raw sex value: ''
[21:59:47] ℹ️  AI extracted service line: 'PT'
[21:59:47] ℹ️  AI extracted payer source: 'Medicare'
[21:59:47] ℹ️  AI extracted diagnoses:
[21:59:47] ℹ️    - Diagnosis 1: 'B35.6'
[21:59:47] ℹ️    - Diagnosis 2: 'None'
[21:59:47] ℹ️    - Diagnosis 3: 'None'
[21:59:47] ℹ️    - Diagnosis 4: 'None'
[21:59:47] ℹ️    - Diagnosis 5: 'None'
[21:59:47] ℹ️    - Diagnosis 6: 'None'
[21:59:47] ℹ️  Final extracted MRN: '28700209267201'
[21:59:47] ℹ️  Final extracted Sex: ''
[21:59:47] ℹ️  Final extracted Service Line: 'PT'
[21:59:47] ℹ️  Final extracted Payer Source: 'Medicare'
[21:59:47] ✅ Patient data extraction completed successfully
[21:59:47] ✅    ✅ Patient data extracted successfully
[21:59:47] 📊 Patient Response
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: CHRISTINE WILL, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[21:59:47] ✅    ✅ Patient identified: ROGER VARIEUR
[21:59:47] ✅    ✅ Patient name validation passed
[21:59:47] 🔄 
🔄 Step 3: Processing patient dates...
[21:59:47] [DOC: 9192368] ℹ️  DOB normalized: 05/12/1938
[21:59:47] [DOC: 9192368] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[21:59:47] [DOC: 9192368] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[21:59:47] [DOC: 9192368] ✅ Patient date processing completed successfully
[21:59:47] ✅    ✅ Date processing completed
[21:59:47] 📊 Processed Patient Data
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: CHRISTINE WILL, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6'}]
[21:59:47] 🔄 
🔄 Step 4: Extracting order data...
[21:59:50] ℹ️  Order extraction - MRN: '28700209267201'
[21:59:50] ℹ️  Order extraction - Sex: ''
[21:59:50] ℹ️  Order extraction - Service Line: 'PT'
[21:59:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[21:59:50] ✅ Order data extraction completed successfully
[21:59:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[21:59:50] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[21:59:50] ⚠️  Could not determine sex using any available method
[21:59:50] ℹ️  Service line consistent in both sources: 'PT'
[21:59:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[21:59:50] ✅ Patient name cross-validation successful
[21:59:50] ✅    ✅ Data merged successfully
[21:59:51] ✅    ✅ Order data extracted and validated
[21:59:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:00:10] [DOC: 9192368] ℹ️  Patient not found in cache or API: ROGER VARIEUR
[22:00:10] [DOC: 9192368] ℹ️  Patient not found, creating new patient via API...
[22:00:10] [DOC: 9192368] ℹ️  Creating patient via API: ROGER VARIEUR
[22:00:11] [DOC: 9192368] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:00:11] ❌    ❌ Failed to create patient
[22:00:11] [DOC: 9192368] ℹ️  API push details saved for document 9192368
================================================================================
║                        Processing Document ID: 9192367                         ║
================================================================================
[22:00:11] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[22:00:11] ℹ️  Date: 03/19/2025
[22:00:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:00:13] [DOC: 9192367] ✅ Text extracted using pdfplumber (1440 chars)
[22:00:13] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[22:00:13] 🔄 
🔄 Step 2: Extracting patient data...
[22:00:16] ℹ️  AI extracted raw sex value: ''
[22:00:16] ℹ️  AI extracted service line: 'OT'
[22:00:16] ℹ️  AI extracted payer source: 'Medicare'
[22:00:16] ℹ️  AI extracted diagnoses:
[22:00:16] ℹ️    - Diagnosis 1: 'B35.6'
[22:00:16] ℹ️    - Diagnosis 2: 'None'
[22:00:16] ℹ️    - Diagnosis 3: 'None'
[22:00:16] ℹ️    - Diagnosis 4: 'None'
[22:00:16] ℹ️    - Diagnosis 5: 'None'
[22:00:16] ℹ️    - Diagnosis 6: 'None'
[22:00:16] ℹ️  Final extracted MRN: '28700209267201'
[22:00:16] ℹ️  Final extracted Sex: ''
[22:00:16] ℹ️  Final extracted Service Line: 'OT'
[22:00:16] ℹ️  Final extracted Payer Source: 'Medicare'
[22:00:16] ✅ Patient data extraction completed successfully
[22:00:16] ✅    ✅ Patient data extracted successfully
[22:00:16] 📊 Patient Response
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:00:16] ✅    ✅ Patient identified: ROGER VARIEUR
[22:00:16] ✅    ✅ Patient name validation passed
[22:00:16] 🔄 
🔄 Step 3: Processing patient dates...
[22:00:16] [DOC: 9192367] ℹ️  DOB normalized: 05/12/1938
[22:00:16] [DOC: 9192367] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[22:00:16] [DOC: 9192367] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[22:00:16] [DOC: 9192367] ✅ Patient date processing completed successfully
[22:00:16] ✅    ✅ Date processing completed
[22:00:16] 📊 Processed Patient Data
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6'}]
[22:00:16] 🔄 
🔄 Step 4: Extracting order data...
[22:00:19] ℹ️  Order extraction - MRN: '28700209267201'
[22:00:19] ℹ️  Order extraction - Sex: ''
[22:00:19] ℹ️  Order extraction - Service Line: 'OT'
[22:00:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:00:19] ✅ Order data extraction completed successfully
[22:00:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:00:19] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[22:00:19] ⚠️  Could not determine sex using any available method
[22:00:19] ℹ️  Service line consistent in both sources: 'OT'
[22:00:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:00:19] ✅ Patient name cross-validation successful
[22:00:19] ✅    ✅ Data merged successfully
[22:00:20] ✅    ✅ Order data extracted and validated
[22:00:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:00:37] [DOC: 9192367] ℹ️  Patient not found in cache or API: ROGER VARIEUR
[22:00:37] [DOC: 9192367] ℹ️  Patient not found, creating new patient via API...
[22:00:37] [DOC: 9192367] ℹ️  Creating patient via API: ROGER VARIEUR
[22:00:38] [DOC: 9192367] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:00:38] ❌    ❌ Failed to create patient
[22:00:38] [DOC: 9192367] ℹ️  API push details saved for document 9192367
================================================================================
║                        Processing Document ID: 9190396                         ║
================================================================================
[22:00:38] ℹ️  Agency: Dartmouth HH
[22:00:38] ℹ️  Date: 03/19/2025
[22:00:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:00:40] [DOC: 9190396] ✅ Text extracted using pdfplumber (1250 chars)
[22:00:40] ✅    ✅ Text extracted using pdfplumber (1250 chars)
[22:00:40] 🔄 
🔄 Step 2: Extracting patient data...
[22:00:43] ℹ️  AI extracted raw sex value: 'M'
[22:00:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:00:43] ℹ️  AI extracted payer source: 'Medicare'
[22:00:43] ℹ️  AI extracted diagnoses:
[22:00:43] ℹ️    - Diagnosis 1: ''
[22:00:43] ℹ️    - Diagnosis 2: ''
[22:00:43] ℹ️    - Diagnosis 3: ''
[22:00:43] ℹ️    - Diagnosis 4: ''
[22:00:43] ℹ️    - Diagnosis 5: ''
[22:00:43] ℹ️    - Diagnosis 6: ''
[22:00:43] ℹ️  Final extracted MRN: '842002'
[22:00:43] ℹ️  Final extracted Sex: 'MALE'
[22:00:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:00:43] ℹ️  Final extracted Payer Source: 'Medicare'
[22:00:43] ✅ Patient data extraction completed successfully
[22:00:43] ✅    ✅ Patient data extracted successfully
[22:00:43] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:00:43] ✅    ✅ Patient identified: Johannes Bjornson
[22:00:43] ✅    ✅ Patient name validation passed
[22:00:43] 🔄 
🔄 Step 3: Processing patient dates...
[22:00:43] [DOC: 9190396] ℹ️  DOB normalized: 02/09/1942
[22:00:43] [DOC: 9190396] ℹ️  Episode startOfCare normalized: 10/10/2024
[22:00:43] [DOC: 9190396] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:00:43] [DOC: 9190396] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:00:43] [DOC: 9190396] ✅ Patient date processing completed successfully
[22:00:43] ✅    ✅ Date processing completed
[22:00:43] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:00:43] 🔄 
🔄 Step 4: Extracting order data...
[22:00:46] ℹ️  Order extraction - MRN: ''
[22:00:46] ℹ️  Order extraction - Sex: 'MALE'
[22:00:46] ℹ️  Order extraction - Service Line: 'RN'
[22:00:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:00:46] ✅ Order data extraction completed successfully
[22:00:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:00:46] ℹ️  Using MRN from patient data: '842002'
[22:00:46] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[22:00:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:00:46] ✅ Patient name cross-validation successful
[22:00:46] ✅    ✅ Data merged successfully
[22:00:47] ✅    ✅ Order data extracted and validated
[22:00:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:00:47] [DOC: 9190396] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:00:47] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:00:47] 🔄 
🔄 Step 6: Pushing order to API...
[22:00:47] [DOC: 9190396] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:00:48] [DOC: 9190396] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[22:00:48] ❌    ❌ Failed to push order
[22:00:48] 🔄 
🔄 Step 7: Writing to CSV...
[22:00:48] [DOC: 9190396] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[22:00:48] [DOC: 9190396] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[22:00:48] [DOC: 9190396] ℹ️  Payer Source extracted: 'Medicare'
[22:00:48] [DOC: 9190396] ℹ️  Diagnosis codes being written:
[22:00:48] [DOC: 9190396] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:00:48] [DOC: 9190396] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:00:48] [DOC: 9190396] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:00:48] [DOC: 9190396] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:00:48] [DOC: 9190396] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:00:48] [DOC: 9190396] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:00:48] [DOC: 9190396] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 842002
[22:00:48] ✅    ✅ Document 9190396 processed and saved successfully
[22:00:48] 🔄 
🔄 Step 8: Saving API details...
[22:00:48] [DOC: 9190396] ℹ️  API push details saved for document 9190396
[22:00:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9190392                         ║
================================================================================
[22:00:48] ℹ️  Agency: Dartmouth HH
[22:00:48] ℹ️  Date: 03/19/2025
[22:00:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:00:50] [DOC: 9190392] ✅ Text extracted using pdfplumber (1250 chars)
[22:00:50] ✅    ✅ Text extracted using pdfplumber (1250 chars)
[22:00:50] 🔄 
🔄 Step 2: Extracting patient data...
[22:00:53] ℹ️  AI extracted raw sex value: 'F'
[22:00:53] ℹ️  AI extracted service line: 'RN'
[22:00:53] ℹ️  AI extracted payer source: 'Medicare'
[22:00:53] ℹ️  AI extracted diagnoses:
[22:00:53] ℹ️    - Diagnosis 1: ''
[22:00:53] ℹ️    - Diagnosis 2: ''
[22:00:53] ℹ️    - Diagnosis 3: ''
[22:00:53] ℹ️    - Diagnosis 4: ''
[22:00:53] ℹ️    - Diagnosis 5: ''
[22:00:53] ℹ️    - Diagnosis 6: ''
[22:00:53] ℹ️  Final extracted MRN: '5938015'
[22:00:53] ℹ️  Final extracted Sex: 'FEMALE'
[22:00:53] ℹ️  Final extracted Service Line: 'RN'
[22:00:53] ℹ️  Final extracted Payer Source: 'Medicare'
[22:00:53] ✅ Patient data extraction completed successfully
[22:00:53] ✅    ✅ Patient data extracted successfully
[22:00:53] 📊 Patient Response
     └─ patientFName: Lorna
     └─ patientLName: Lessa
     └─ dob: 07/26/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5938015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 390 Purchase Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:00:53] ✅    ✅ Patient identified: Lorna Lessa
[22:00:53] ✅    ✅ Patient name validation passed
[22:00:53] 🔄 
🔄 Step 3: Processing patient dates...
[22:00:53] [DOC: 9190392] ℹ️  DOB normalized: 07/26/1959
[22:00:53] [DOC: 9190392] ℹ️  Episode startOfCare normalized: 01/31/2025
[22:00:53] [DOC: 9190392] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[22:00:53] [DOC: 9190392] ℹ️  Episode endOfEpisode normalized: 03/31/2025
[22:00:53] [DOC: 9190392] ✅ Patient date processing completed successfully
[22:00:53] ✅    ✅ Date processing completed
[22:00:53] 📊 Processed Patient Data
     └─ patientFName: Lorna
     └─ patientLName: Lessa
     └─ dob: 07/26/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5938015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 390 Purchase Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:00:53] 🔄 
🔄 Step 4: Extracting order data...
[22:00:55] ℹ️  Order extraction - MRN: ''
[22:00:55] ℹ️  Order extraction - Sex: 'FEMALE'
[22:00:55] ℹ️  Order extraction - Service Line: ''
[22:00:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:00:55] ✅ Order data extraction completed successfully
[22:00:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:00:55] ℹ️  Using MRN from patient data: '5938015'
[22:00:55] ℹ️  Using service line from patient data: 'RN'
[22:00:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:00:55] ✅ Patient name cross-validation successful
[22:00:55] ✅    ✅ Data merged successfully
[22:00:56] ✅    ✅ Order data extracted and validated
[22:00:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:00:56] [DOC: 9190392] ✅ Patient found in local cache: Lorna Lessa, ID: f3a9f4a1-957c-4a56-8c8b-ac101bef954d
[22:00:56] ✅    ✅ Existing patient found with ID: f3a9f4a1-957c-4a56-8c8b-ac101bef954d
[22:00:56] 🔄 
🔄 Step 6: Pushing order to API...
[22:00:56] [DOC: 9190392] ℹ️  Pushing order via API for patient ID: f3a9f4a1-957c-4a56-8c8b-ac101bef954d
[22:00:58] [DOC: 9190392] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:00:58] ❌    ❌ Failed to push order
[22:00:58] 🔄 
🔄 Step 7: Writing to CSV...
[22:00:58] [DOC: 9190392] ℹ️  Calculated age: 65 from DOB: 07/26/1959
[22:00:58] [DOC: 9190392] ℹ️  Service Line extracted: 'RN'
[22:00:58] [DOC: 9190392] ℹ️  Payer Source extracted: 'Medicare'
[22:00:58] [DOC: 9190392] ℹ️  Diagnosis codes being written:
[22:00:58] [DOC: 9190392] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:00:58] [DOC: 9190392] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:00:58] [DOC: 9190392] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:00:58] [DOC: 9190392] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:00:58] [DOC: 9190392] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:00:58] [DOC: 9190392] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:00:58] [DOC: 9190392] ✅ Patient data written to CSV: Lorna Lessa | Sex: FEMALE | Age: 65 | Service: RN | Payer: Medicare | MRN: 5938015
[22:00:58] ✅    ✅ Document 9190392 processed and saved successfully
[22:00:58] 🔄 
🔄 Step 8: Saving API details...
[22:00:58] [DOC: 9190392] ℹ️  API push details saved for document 9190392
[22:00:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189930                         ║
================================================================================
[22:00:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:00:58] ℹ️  Date: 03/19/2025
[22:00:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:01:06] [DOC: 9189930] ✅ Text extracted using pdfplumber (12733 chars)
[22:01:06] ✅    ✅ Text extracted using pdfplumber (12733 chars)
[22:01:06] 🔄 
🔄 Step 2: Extracting patient data...
[22:01:09] ℹ️  AI extracted raw sex value: 'F'
[22:01:09] ℹ️  AI extracted service line: 'OT'
[22:01:09] ℹ️  AI extracted payer source: ''
[22:01:09] ℹ️  AI extracted diagnoses:
[22:01:09] ℹ️    - Diagnosis 1: 'HTN'
[22:01:09] ℹ️    - Diagnosis 2: 'CVA'
[22:01:09] ℹ️    - Diagnosis 3: 'muscle weakness'
[22:01:09] ℹ️    - Diagnosis 4: 'anxiety'
[22:01:09] ℹ️    - Diagnosis 5: 'UTI'
[22:01:09] ℹ️    - Diagnosis 6: 'COVID'
[22:01:09] ℹ️  Final extracted MRN: 'MA230120073707'
[22:01:09] ℹ️  Final extracted Sex: 'FEMALE'
[22:01:09] ℹ️  Final extracted Service Line: 'OT'
[22:01:09] ℹ️  Final extracted Payer Source: ''
[22:01:09] ✅ Patient data extraction completed successfully
[22:01:09] ✅    ✅ Patient data extracted successfully
[22:01:09] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2024', 'endOfEpisode': '', 'firstDiagnosis': 'HTN', 'secondDiagnosis': 'CVA', 'thirdDiagnosis': 'muscle weakness', 'fourthDiagnosis': 'anxiety', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COVID'}]
[22:01:09] ✅    ✅ Patient identified: Diamantina Frias
[22:01:09] ✅    ✅ Patient name validation passed
[22:01:09] 🔄 
🔄 Step 3: Processing patient dates...
[22:01:09] [DOC: 9189930] ℹ️  DOB normalized: 07/04/1937
[22:01:09] [DOC: 9189930] ℹ️  Episode startOfEpisode normalized: 01/26/2024
[22:01:09] [DOC: 9189930] ✅ Patient date processing completed successfully
[22:01:09] ✅    ✅ Date processing completed
[22:01:09] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2024', 'endOfEpisode': '', 'firstDiagnosis': 'HTN', 'secondDiagnosis': 'CVA', 'thirdDiagnosis': 'muscle weakness', 'fourthDiagnosis': 'anxiety', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COVID'}]
[22:01:09] 🔄 
🔄 Step 4: Extracting order data...
[22:01:12] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:01:12] ℹ️  Order extraction - Sex: 'FEMALE'
[22:01:12] ℹ️  Order extraction - Service Line: 'OT'
[22:01:12] ℹ️  Order extraction - Payer Source: ''
[22:01:12] ✅ Order data extraction completed successfully
[22:01:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:01:12] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:01:12] ℹ️  Service line consistent in both sources: 'OT'
[22:01:12] ✅ Patient name cross-validation successful
[22:01:12] ✅    ✅ Data merged successfully
[22:01:13] ⚠️     ❌ Skipping - missing episode start date
[22:01:13] [DOC: 9189930] ℹ️  API push details saved for document 9189930
================================================================================
║                        Processing Document ID: 9189921                         ║
================================================================================
[22:01:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:01:13] ℹ️  Date: 03/19/2025
[22:01:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:01:16] [DOC: 9189921] ✅ Text extracted using pdfplumber (1388 chars)
[22:01:16] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[22:01:16] 🔄 
🔄 Step 2: Extracting patient data...
[22:01:19] ℹ️  AI extracted raw sex value: ''
[22:01:19] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:01:19] ℹ️  AI extracted payer source: ''
[22:01:19] ℹ️  AI extracted diagnoses:
[22:01:19] ℹ️    - Diagnosis 1: 'I10'
[22:01:19] ℹ️    - Diagnosis 2: 'I63.00'
[22:01:19] ℹ️    - Diagnosis 3: 'F41.9'
[22:01:19] ℹ️    - Diagnosis 4: ''
[22:01:19] ℹ️    - Diagnosis 5: ''
[22:01:19] ℹ️    - Diagnosis 6: ''
[22:01:19] ℹ️  Final extracted MRN: 'MA230120073707'
[22:01:19] ℹ️  Final extracted Sex: ''
[22:01:19] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:01:19] ℹ️  Final extracted Payer Source: ''
[22:01:19] ✅ Patient data extraction completed successfully
[22:01:19] ✅    ✅ Patient data extracted successfully
[22:01:19] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:01:19] ✅    ✅ Patient identified: Diamantina Frias
[22:01:19] ✅    ✅ Patient name validation passed
[22:01:19] 🔄 
🔄 Step 3: Processing patient dates...
[22:01:19] [DOC: 9189921] ℹ️  DOB normalized: 07/04/1937
[22:01:19] [DOC: 9189921] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[22:01:19] [DOC: 9189921] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[22:01:19] [DOC: 9189921] ✅ Patient date processing completed successfully
[22:01:19] ✅    ✅ Date processing completed
[22:01:19] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:01:19] 🔄 
🔄 Step 4: Extracting order data...
[22:01:21] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:01:21] ℹ️  Order extraction - Sex: ''
[22:01:21] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:01:21] ℹ️  Order extraction - Payer Source: ''
[22:01:21] ✅ Order data extraction completed successfully
[22:01:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:01:21] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:01:21] ⚠️  Could not determine sex using any available method
[22:01:21] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:01:21] ✅ Patient name cross-validation successful
[22:01:21] ✅    ✅ Data merged successfully
[22:01:22] ✅    ✅ Order data extracted and validated
[22:01:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:01:22] [DOC: 9189921] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:22] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:22] 🔄 
🔄 Step 6: Pushing order to API...
[22:01:22] [DOC: 9189921] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:24] [DOC: 9189921] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12943"}
[22:01:24] ❌    ❌ Failed to push order
[22:01:24] 🔄 
🔄 Step 7: Writing to CSV...
[22:01:24] [DOC: 9189921] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[22:01:24] [DOC: 9189921] ℹ️  Service Line extracted: 'Occupational Therapy'
[22:01:24] [DOC: 9189921] ℹ️  Payer Source extracted: ''
[22:01:24] [DOC: 9189921] ℹ️  Diagnosis codes being written:
[22:01:24] [DOC: 9189921] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:01:24] [DOC: 9189921] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[22:01:24] [DOC: 9189921] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[22:01:24] [DOC: 9189921] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:01:24] [DOC: 9189921] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:01:24] [DOC: 9189921] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:01:24] [DOC: 9189921] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Occupational Therapy | Payer:  | MRN: MA230120073707
[22:01:24] ✅    ✅ Document 9189921 processed and saved successfully
[22:01:24] 🔄 
🔄 Step 8: Saving API details...
[22:01:24] [DOC: 9189921] ℹ️  API push details saved for document 9189921
[22:01:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189919                         ║
================================================================================
[22:01:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:01:24] ℹ️  Date: 03/19/2025
[22:01:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:01:26] [DOC: 9189919] ✅ Text extracted using pdfplumber (1385 chars)
[22:01:26] ✅    ✅ Text extracted using pdfplumber (1385 chars)
[22:01:26] 🔄 
🔄 Step 2: Extracting patient data...
[22:01:29] ℹ️  AI extracted raw sex value: ''
[22:01:29] ℹ️  AI extracted service line: 'Physical Therapy'
[22:01:29] ℹ️  AI extracted payer source: ''
[22:01:29] ℹ️  AI extracted diagnoses:
[22:01:29] ℹ️    - Diagnosis 1: 'I10'
[22:01:29] ℹ️    - Diagnosis 2: 'I63.00'
[22:01:29] ℹ️    - Diagnosis 3: 'F41.9'
[22:01:29] ℹ️    - Diagnosis 4: ''
[22:01:29] ℹ️    - Diagnosis 5: ''
[22:01:29] ℹ️    - Diagnosis 6: ''
[22:01:29] ℹ️  Final extracted MRN: 'MA230120073707'
[22:01:29] ℹ️  Final extracted Sex: ''
[22:01:29] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:01:29] ℹ️  Final extracted Payer Source: ''
[22:01:29] ✅ Patient data extraction completed successfully
[22:01:29] ✅    ✅ Patient data extracted successfully
[22:01:29] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:01:29] ✅    ✅ Patient identified: Diamantina Frias
[22:01:29] ✅    ✅ Patient name validation passed
[22:01:29] 🔄 
🔄 Step 3: Processing patient dates...
[22:01:29] [DOC: 9189919] ℹ️  DOB normalized: 07/04/1937
[22:01:29] [DOC: 9189919] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[22:01:29] [DOC: 9189919] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[22:01:29] [DOC: 9189919] ✅ Patient date processing completed successfully
[22:01:29] ✅    ✅ Date processing completed
[22:01:29] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:01:29] 🔄 
🔄 Step 4: Extracting order data...
[22:01:31] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:01:31] ℹ️  Order extraction - Sex: ''
[22:01:31] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:01:31] ℹ️  Order extraction - Payer Source: ''
[22:01:31] ✅ Order data extraction completed successfully
[22:01:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:01:31] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:01:31] ⚠️  Could not determine sex using any available method
[22:01:31] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:01:31] ✅ Patient name cross-validation successful
[22:01:31] ✅    ✅ Data merged successfully
[22:01:33] ✅    ✅ Order data extracted and validated
[22:01:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:01:33] [DOC: 9189919] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:33] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:01:33] [DOC: 9189919] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:34] [DOC: 9189919] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12944"}
[22:01:34] ❌    ❌ Failed to push order
[22:01:34] 🔄 
🔄 Step 7: Writing to CSV...
[22:01:34] [DOC: 9189919] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[22:01:34] [DOC: 9189919] ℹ️  Service Line extracted: 'Physical Therapy'
[22:01:34] [DOC: 9189919] ℹ️  Payer Source extracted: ''
[22:01:34] [DOC: 9189919] ℹ️  Diagnosis codes being written:
[22:01:34] [DOC: 9189919] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:01:34] [DOC: 9189919] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[22:01:34] [DOC: 9189919] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[22:01:34] [DOC: 9189919] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:01:34] [DOC: 9189919] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:01:34] [DOC: 9189919] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:01:34] [DOC: 9189919] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA230120073707
[22:01:34] ✅    ✅ Document 9189919 processed and saved successfully
[22:01:34] 🔄 
🔄 Step 8: Saving API details...
[22:01:34] [DOC: 9189919] ℹ️  API push details saved for document 9189919
[22:01:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189918                         ║
================================================================================
[22:01:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:01:34] ℹ️  Date: 03/19/2025
[22:01:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:01:37] [DOC: 9189918] ✅ Text extracted using pdfplumber (1388 chars)
[22:01:37] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[22:01:37] 🔄 
🔄 Step 2: Extracting patient data...
[22:01:40] ℹ️  AI extracted raw sex value: ''
[22:01:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:01:40] ℹ️  AI extracted payer source: ''
[22:01:40] ℹ️  AI extracted diagnoses:
[22:01:40] ℹ️    - Diagnosis 1: 'I10'
[22:01:40] ℹ️    - Diagnosis 2: 'I63.00'
[22:01:40] ℹ️    - Diagnosis 3: 'F41.9'
[22:01:40] ℹ️    - Diagnosis 4: 'None'
[22:01:40] ℹ️    - Diagnosis 5: 'None'
[22:01:40] ℹ️    - Diagnosis 6: 'None'
[22:01:40] ℹ️  Final extracted MRN: 'MA230120073707'
[22:01:40] ℹ️  Final extracted Sex: ''
[22:01:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:01:40] ℹ️  Final extracted Payer Source: ''
[22:01:40] ✅ Patient data extraction completed successfully
[22:01:40] ✅    ✅ Patient data extracted successfully
[22:01:40] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: AILEEN SOUZA
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:01:40] ✅    ✅ Patient identified: Diamantina Frias
[22:01:40] ✅    ✅ Patient name validation passed
[22:01:40] 🔄 
🔄 Step 3: Processing patient dates...
[22:01:40] [DOC: 9189918] ℹ️  DOB normalized: 07/04/1937
[22:01:40] [DOC: 9189918] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[22:01:40] [DOC: 9189918] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[22:01:40] [DOC: 9189918] ✅ Patient date processing completed successfully
[22:01:40] ✅    ✅ Date processing completed
[22:01:40] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: AILEEN SOUZA
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9'}]
[22:01:40] 🔄 
🔄 Step 4: Extracting order data...
[22:01:42] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:01:42] ℹ️  Order extraction - Sex: ''
[22:01:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:01:42] ℹ️  Order extraction - Payer Source: ''
[22:01:42] ✅ Order data extraction completed successfully
[22:01:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:01:42] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:01:42] ⚠️  Could not determine sex using any available method
[22:01:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:01:42] ✅ Patient name cross-validation successful
[22:01:42] ✅    ✅ Data merged successfully
[22:01:44] ✅    ✅ Order data extracted and validated
[22:01:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:01:44] [DOC: 9189918] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:44] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:44] 🔄 
🔄 Step 6: Pushing order to API...
[22:01:44] [DOC: 9189918] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:45] [DOC: 9189918] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12945"}
[22:01:45] ❌    ❌ Failed to push order
[22:01:45] 🔄 
🔄 Step 7: Writing to CSV...
[22:01:45] [DOC: 9189918] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[22:01:45] [DOC: 9189918] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:01:45] [DOC: 9189918] ℹ️  Payer Source extracted: ''
[22:01:45] [DOC: 9189918] ℹ️  Diagnosis codes being written:
[22:01:45] [DOC: 9189918] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:01:45] [DOC: 9189918] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[22:01:45] [DOC: 9189918] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[22:01:45] [DOC: 9189918] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:01:45] [DOC: 9189918] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:01:45] [DOC: 9189918] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:01:45] [DOC: 9189918] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Skilled Nursing | Payer:  | MRN: MA230120073707
[22:01:45] ✅    ✅ Document 9189918 processed and saved successfully
[22:01:45] 🔄 
🔄 Step 8: Saving API details...
[22:01:45] [DOC: 9189918] ℹ️  API push details saved for document 9189918
[22:01:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189917                         ║
================================================================================
[22:01:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:01:45] ℹ️  Date: 03/19/2025
[22:01:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:01:48] [DOC: 9189917] ✅ Text extracted using pdfplumber (1375 chars)
[22:01:48] ✅    ✅ Text extracted using pdfplumber (1375 chars)
[22:01:48] 🔄 
🔄 Step 2: Extracting patient data...
[22:01:51] ℹ️  AI extracted raw sex value: ''
[22:01:51] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:01:51] ℹ️  AI extracted payer source: ''
[22:01:51] ℹ️  AI extracted diagnoses:
[22:01:51] ℹ️    - Diagnosis 1: 'I10'
[22:01:51] ℹ️    - Diagnosis 2: 'I63.00'
[22:01:51] ℹ️    - Diagnosis 3: 'F41.9'
[22:01:51] ℹ️    - Diagnosis 4: ''
[22:01:51] ℹ️    - Diagnosis 5: ''
[22:01:51] ℹ️    - Diagnosis 6: ''
[22:01:51] ℹ️  Final extracted MRN: 'MA230120073707'
[22:01:51] ℹ️  Final extracted Sex: ''
[22:01:51] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:01:51] ℹ️  Final extracted Payer Source: ''
[22:01:51] ✅ Patient data extraction completed successfully
[22:01:51] ✅    ✅ Patient data extracted successfully
[22:01:51] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:01:51] ✅    ✅ Patient identified: Diamantina Frias
[22:01:51] ✅    ✅ Patient name validation passed
[22:01:51] 🔄 
🔄 Step 3: Processing patient dates...
[22:01:51] [DOC: 9189917] ℹ️  DOB normalized: 07/04/1937
[22:01:51] [DOC: 9189917] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[22:01:51] [DOC: 9189917] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[22:01:51] [DOC: 9189917] ✅ Patient date processing completed successfully
[22:01:51] ✅    ✅ Date processing completed
[22:01:51] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:01:51] 🔄 
🔄 Step 4: Extracting order data...
[22:01:54] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:01:54] ℹ️  Order extraction - Sex: ''
[22:01:54] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:01:54] ℹ️  Order extraction - Payer Source: ''
[22:01:54] ✅ Order data extraction completed successfully
[22:01:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:01:54] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:01:54] ⚠️  Could not determine sex using any available method
[22:01:54] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:01:54] ✅ Patient name cross-validation successful
[22:01:54] ✅    ✅ Data merged successfully
[22:01:55] ✅    ✅ Order data extracted and validated
[22:01:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:01:55] [DOC: 9189917] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:55] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:55] 🔄 
🔄 Step 6: Pushing order to API...
[22:01:55] [DOC: 9189917] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:01:56] [DOC: 9189917] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12946"}
[22:01:56] ❌    ❌ Failed to push order
[22:01:56] 🔄 
🔄 Step 7: Writing to CSV...
[22:01:56] [DOC: 9189917] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[22:01:56] [DOC: 9189917] ℹ️  Service Line extracted: 'Occupational Therapy'
[22:01:56] [DOC: 9189917] ℹ️  Payer Source extracted: ''
[22:01:56] [DOC: 9189917] ℹ️  Diagnosis codes being written:
[22:01:56] [DOC: 9189917] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:01:56] [DOC: 9189917] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[22:01:56] [DOC: 9189917] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[22:01:56] [DOC: 9189917] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:01:56] [DOC: 9189917] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:01:56] [DOC: 9189917] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:01:56] [DOC: 9189917] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Occupational Therapy | Payer:  | MRN: MA230120073707
[22:01:56] ✅    ✅ Document 9189917 processed and saved successfully
[22:01:56] 🔄 
🔄 Step 8: Saving API details...
[22:01:56] [DOC: 9189917] ℹ️  API push details saved for document 9189917
[22:01:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189916                         ║
================================================================================
[22:01:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:01:56] ℹ️  Date: 03/19/2025
[22:01:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:01:59] [DOC: 9189916] ✅ Text extracted using pdfplumber (1305 chars)
[22:01:59] ✅    ✅ Text extracted using pdfplumber (1305 chars)
[22:01:59] 🔄 
🔄 Step 2: Extracting patient data...
[22:02:01] ℹ️  AI extracted raw sex value: ''
[22:02:01] ℹ️  AI extracted service line: 'Physical Therapy'
[22:02:01] ℹ️  AI extracted payer source: ''
[22:02:01] ℹ️  AI extracted diagnoses:
[22:02:01] ℹ️    - Diagnosis 1: 'I10'
[22:02:01] ℹ️    - Diagnosis 2: 'I63.00'
[22:02:01] ℹ️    - Diagnosis 3: 'F41.9'
[22:02:01] ℹ️    - Diagnosis 4: 'None'
[22:02:01] ℹ️    - Diagnosis 5: 'None'
[22:02:01] ℹ️    - Diagnosis 6: 'None'
[22:02:01] ℹ️  Final extracted MRN: 'MA230120073707'
[22:02:01] ℹ️  Final extracted Sex: ''
[22:02:01] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:02:01] ℹ️  Final extracted Payer Source: ''
[22:02:01] ✅ Patient data extraction completed successfully
[22:02:01] ✅    ✅ Patient data extracted successfully
[22:02:01] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:02:01] ✅    ✅ Patient identified: Diamantina Frias
[22:02:01] ✅    ✅ Patient name validation passed
[22:02:01] 🔄 
🔄 Step 3: Processing patient dates...
[22:02:01] [DOC: 9189916] ℹ️  DOB normalized: 07/04/1937
[22:02:01] [DOC: 9189916] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[22:02:01] [DOC: 9189916] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[22:02:01] [DOC: 9189916] ✅ Patient date processing completed successfully
[22:02:01] ✅    ✅ Date processing completed
[22:02:01] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9'}]
[22:02:01] 🔄 
🔄 Step 4: Extracting order data...
[22:02:04] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:02:04] ℹ️  Order extraction - Sex: ''
[22:02:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:02:04] ℹ️  Order extraction - Payer Source: ''
[22:02:04] ✅ Order data extraction completed successfully
[22:02:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:02:04] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:02:04] ⚠️  Could not determine sex using any available method
[22:02:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:02:04] ✅ Patient name cross-validation successful
[22:02:04] ✅    ✅ Data merged successfully
[22:02:05] ✅    ✅ Order data extracted and validated
[22:02:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:02:05] [DOC: 9189916] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:02:05] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:02:05] 🔄 
🔄 Step 6: Pushing order to API...
[22:02:05] [DOC: 9189916] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:02:06] [DOC: 9189916] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12947"}
[22:02:06] ❌    ❌ Failed to push order
[22:02:06] 🔄 
🔄 Step 7: Writing to CSV...
[22:02:06] [DOC: 9189916] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[22:02:06] [DOC: 9189916] ℹ️  Service Line extracted: 'Physical Therapy'
[22:02:06] [DOC: 9189916] ℹ️  Payer Source extracted: ''
[22:02:06] [DOC: 9189916] ℹ️  Diagnosis codes being written:
[22:02:06] [DOC: 9189916] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:02:06] [DOC: 9189916] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[22:02:06] [DOC: 9189916] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[22:02:06] [DOC: 9189916] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:02:06] [DOC: 9189916] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:02:06] [DOC: 9189916] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:02:06] [DOC: 9189916] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA230120073707
[22:02:06] ✅    ✅ Document 9189916 processed and saved successfully
[22:02:06] 🔄 
🔄 Step 8: Saving API details...
[22:02:06] [DOC: 9189916] ℹ️  API push details saved for document 9189916
[22:02:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189873                         ║
================================================================================
[22:02:06] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:02:06] ℹ️  Date: 03/19/2025
[22:02:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:02:11] [DOC: 9189873] ✅ Text extracted using pdfplumber (39690 chars)
[22:02:11] ✅    ✅ Text extracted using pdfplumber (39690 chars)
[22:02:11] 🔄 
🔄 Step 2: Extracting patient data...
[22:02:14] ℹ️  AI extracted raw sex value: 'None'
[22:02:14] ℹ️  AI extracted service line: 'None'
[22:02:14] ℹ️  AI extracted payer source: 'None'
[22:02:14] ℹ️  AI extracted diagnoses:
[22:02:14] ℹ️    - Diagnosis 1: ''
[22:02:14] ℹ️    - Diagnosis 2: ''
[22:02:14] ℹ️    - Diagnosis 3: ''
[22:02:14] ℹ️    - Diagnosis 4: ''
[22:02:14] ℹ️    - Diagnosis 5: ''
[22:02:14] ℹ️    - Diagnosis 6: ''
[22:02:14] ℹ️  Final extracted MRN: ''
[22:02:14] ℹ️  Final extracted Sex: ''
[22:02:14] ℹ️  Final extracted Service Line: ''
[22:02:14] ℹ️  Final extracted Payer Source: ''
[22:02:14] ✅ Patient data extraction completed successfully
[22:02:14] ✅    ✅ Patient data extracted successfully
[22:02:14] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:02:14] ⚠️     ❌ Insufficient patient data extracted
[22:02:14] [DOC: 9189873] ℹ️  API push details saved for document 9189873
================================================================================
║                        Processing Document ID: 9187500                         ║
================================================================================
[22:02:14] ℹ️  Agency: Dartmouth HH
[22:02:14] ℹ️  Date: 03/18/2025
[22:02:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:02:16] [DOC: 9187500] ✅ Text extracted using pdfplumber (1184 chars)
[22:02:16] ✅    ✅ Text extracted using pdfplumber (1184 chars)
[22:02:16] 🔄 
🔄 Step 2: Extracting patient data...
[22:02:18] ℹ️  AI extracted raw sex value: 'M'
[22:02:18] ℹ️  AI extracted service line: 'RN, LPN'
[22:02:18] ℹ️  AI extracted payer source: 'Medicare'
[22:02:18] ℹ️  AI extracted diagnoses:
[22:02:18] ℹ️    - Diagnosis 1: 'None'
[22:02:18] ℹ️    - Diagnosis 2: 'None'
[22:02:18] ℹ️    - Diagnosis 3: 'None'
[22:02:18] ℹ️    - Diagnosis 4: 'None'
[22:02:18] ℹ️    - Diagnosis 5: 'None'
[22:02:18] ℹ️    - Diagnosis 6: 'None'
[22:02:18] ℹ️  Final extracted MRN: '842002'
[22:02:18] ℹ️  Final extracted Sex: 'MALE'
[22:02:18] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:02:18] ℹ️  Final extracted Payer Source: 'Medicare'
[22:02:18] ✅ Patient data extraction completed successfully
[22:02:18] ✅    ✅ Patient data extracted successfully
[22:02:18] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:02:18] ✅    ✅ Patient identified: Johannes Bjornson
[22:02:18] ✅    ✅ Patient name validation passed
[22:02:18] 🔄 
🔄 Step 3: Processing patient dates...
[22:02:18] [DOC: 9187500] ℹ️  DOB normalized: 02/09/1942
[22:02:18] [DOC: 9187500] ℹ️  Episode startOfCare normalized: 10/10/2024
[22:02:18] [DOC: 9187500] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:02:18] [DOC: 9187500] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:02:18] [DOC: 9187500] ✅ Patient date processing completed successfully
[22:02:18] ✅    ✅ Date processing completed
[22:02:18] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025'}]
[22:02:18] 🔄 
🔄 Step 4: Extracting order data...
[22:02:21] ℹ️  Order extraction - MRN: ''
[22:02:21] ℹ️  Order extraction - Sex: 'MALE'
[22:02:21] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:02:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:02:21] ✅ Order data extraction completed successfully
[22:02:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:02:21] ℹ️  Using MRN from patient data: '842002'
[22:02:21] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:02:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:02:21] ✅ Patient name cross-validation successful
[22:02:21] ✅    ✅ Data merged successfully
[22:02:25] ✅    ✅ Order data extracted and validated
[22:02:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:02:25] [DOC: 9187500] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:02:25] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:02:25] 🔄 
🔄 Step 6: Pushing order to API...
[22:02:25] [DOC: 9187500] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:02:26] [DOC: 9187500] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[22:02:26] ❌    ❌ Failed to push order
[22:02:26] 🔄 
🔄 Step 7: Writing to CSV...
[22:02:26] [DOC: 9187500] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[22:02:26] [DOC: 9187500] ℹ️  Service Line extracted: 'RN, LPN'
[22:02:26] [DOC: 9187500] ℹ️  Payer Source extracted: 'Medicare'
[22:02:26] [DOC: 9187500] ℹ️  Diagnosis codes being written:
[22:02:26] [DOC: 9187500] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:02:26] [DOC: 9187500] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:02:26] [DOC: 9187500] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:02:26] [DOC: 9187500] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:02:26] [DOC: 9187500] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:02:26] [DOC: 9187500] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:02:26] [DOC: 9187500] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: RN, LPN | Payer: Medicare | MRN: 842002
[22:02:26] ✅    ✅ Document 9187500 processed and saved successfully
[22:02:26] 🔄 
🔄 Step 8: Saving API details...
[22:02:26] [DOC: 9187500] ℹ️  API push details saved for document 9187500
[22:02:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187493                         ║
================================================================================
[22:02:26] ℹ️  Agency: Dartmouth HH
[22:02:26] ℹ️  Date: 03/18/2025
[22:02:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:02:29] [DOC: 9187493] ✅ Text extracted using pdfplumber (1668 chars)
[22:02:29] ✅    ✅ Text extracted using pdfplumber (1668 chars)
[22:02:29] 🔄 
🔄 Step 2: Extracting patient data...
[22:02:31] ℹ️  AI extracted raw sex value: 'F'
[22:02:31] ℹ️  AI extracted service line: 'RN, LPN'
[22:02:31] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[22:02:31] ℹ️  AI extracted diagnoses:
[22:02:31] ℹ️    - Diagnosis 1: ''
[22:02:31] ℹ️    - Diagnosis 2: ''
[22:02:31] ℹ️    - Diagnosis 3: ''
[22:02:31] ℹ️    - Diagnosis 4: ''
[22:02:31] ℹ️    - Diagnosis 5: ''
[22:02:31] ℹ️    - Diagnosis 6: ''
[22:02:31] ℹ️  Final extracted MRN: '6066015'
[22:02:31] ℹ️  Final extracted Sex: 'FEMALE'
[22:02:31] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:02:31] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[22:02:31] ✅ Patient data extraction completed successfully
[22:02:31] ✅    ✅ Patient data extracted successfully
[22:02:31] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Perry Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:02:31] ✅    ✅ Patient identified: Lois Fernandes
[22:02:31] ✅    ✅ Patient name validation passed
[22:02:31] 🔄 
🔄 Step 3: Processing patient dates...
[22:02:31] [DOC: 9187493] ℹ️  DOB normalized: 05/15/1941
[22:02:31] [DOC: 9187493] ℹ️  Episode startOfCare normalized: 02/22/2025
[22:02:31] [DOC: 9187493] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[22:02:31] [DOC: 9187493] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:02:31] [DOC: 9187493] ✅ Patient date processing completed successfully
[22:02:31] ✅    ✅ Date processing completed
[22:02:31] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Perry Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:02:31] 🔄 
🔄 Step 4: Extracting order data...
[22:02:36] ℹ️  Order extraction - MRN: ''
[22:02:36] ℹ️  Order extraction - Sex: 'FEMALE'
[22:02:36] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:02:36] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[22:02:36] ✅ Order data extraction completed successfully
[22:02:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:02:36] ℹ️  Using MRN from patient data: '6066015'
[22:02:36] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:02:36] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[22:02:36] ✅ Patient name cross-validation successful
[22:02:36] ✅    ✅ Data merged successfully
[22:02:37] ✅    ✅ Order data extracted and validated
[22:02:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:02:37] [DOC: 9187493] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:02:37] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:02:37] 🔄 
🔄 Step 6: Pushing order to API...
[22:02:37] [DOC: 9187493] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:02:38] [DOC: 9187493] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13961"}
[22:02:38] ❌    ❌ Failed to push order
[22:02:38] 🔄 
🔄 Step 7: Writing to CSV...
[22:02:38] [DOC: 9187493] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[22:02:38] [DOC: 9187493] ℹ️  Service Line extracted: 'RN, LPN'
[22:02:38] [DOC: 9187493] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[22:02:38] [DOC: 9187493] ℹ️  Diagnosis codes being written:
[22:02:38] [DOC: 9187493] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:02:38] [DOC: 9187493] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:02:38] [DOC: 9187493] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:02:38] [DOC: 9187493] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:02:38] [DOC: 9187493] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:02:38] [DOC: 9187493] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:02:38] [DOC: 9187493] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: RN, LPN | Payer: Blue Cross Medicare Adv | MRN: 6066015
[22:02:38] ✅    ✅ Document 9187493 processed and saved successfully
[22:02:38] 🔄 
🔄 Step 8: Saving API details...
[22:02:38] [DOC: 9187493] ℹ️  API push details saved for document 9187493
[22:02:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187373                         ║
================================================================================
[22:02:38] ℹ️  Agency: Dartmouth HH
[22:02:38] ℹ️  Date: 03/18/2025
[22:02:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:02:42] [DOC: 9187373] ✅ Text extracted using pdfplumber (13362 chars)
[22:02:42] ✅    ✅ Text extracted using pdfplumber (13362 chars)
[22:02:42] 🔄 
🔄 Step 2: Extracting patient data...
[22:02:45] ℹ️  AI extracted raw sex value: 'M'
[22:02:45] ℹ️  AI extracted service line: 'PT'
[22:02:45] ℹ️  AI extracted payer source: 'None'
[22:02:45] ℹ️  AI extracted diagnoses:
[22:02:45] ℹ️    - Diagnosis 1: 'M18.11'
[22:02:45] ℹ️    - Diagnosis 2: 'Z47.1'
[22:02:45] ℹ️    - Diagnosis 3: 'E11.9'
[22:02:45] ℹ️    - Diagnosis 4: 'I10'
[22:02:45] ℹ️    - Diagnosis 5: 'J44.89'
[22:02:45] ℹ️    - Diagnosis 6: 'G47.31'
[22:02:45] ℹ️  Final extracted MRN: '227027'
[22:02:45] ℹ️  Final extracted Sex: 'MALE'
[22:02:45] ℹ️  Final extracted Service Line: 'PT'
[22:02:45] ℹ️  Final extracted Payer Source: ''
[22:02:45] ✅ Patient data extraction completed successfully
[22:02:45] ✅    ✅ Patient data extracted successfully
[22:02:45] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Dossantos
     └─ dob: 08/22/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'M18.11', 'secondDiagnosis': 'Z47.1', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'G47.31'}]
[22:02:45] ✅    ✅ Patient identified: John Dossantos
[22:02:45] ✅    ✅ Patient name validation passed
[22:02:45] 🔄 
🔄 Step 3: Processing patient dates...
[22:02:45] [DOC: 9187373] ℹ️  DOB normalized: 08/22/1947
[22:02:45] [DOC: 9187373] ℹ️  Episode startOfCare normalized: 03/01/2025
[22:02:45] [DOC: 9187373] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[22:02:45] [DOC: 9187373] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[22:02:45] [DOC: 9187373] ✅ Patient date processing completed successfully
[22:02:45] ✅    ✅ Date processing completed
[22:02:45] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Dossantos
     └─ dob: 08/22/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'M18.11', 'secondDiagnosis': 'Z47.1', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'G47.31'}]
[22:02:45] 🔄 
🔄 Step 4: Extracting order data...
[22:02:48] ℹ️  Order extraction - MRN: '227027'
[22:02:48] ℹ️  Order extraction - Sex: 'MALE'
[22:02:48] ℹ️  Order extraction - Service Line: 'PT'
[22:02:48] ℹ️  Order extraction - Payer Source: ''
[22:02:48] ✅ Order data extraction completed successfully
[22:02:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:02:48] ℹ️  Using MRN from patient data: '227027' over '227027'
[22:02:48] ℹ️  Service line consistent in both sources: 'PT'
[22:02:48] ✅ Patient name cross-validation successful
[22:02:48] ✅    ✅ Data merged successfully
[22:02:49] ✅    ✅ Order data extracted and validated
[22:02:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:02:55] [DOC: 9187373] ✅ Patient exists in API: John Dossantos, ID: 4e555c01-e9bb-406d-b1ce-17837319bce2
[22:02:55] ✅    ✅ Existing patient found with ID: 4e555c01-e9bb-406d-b1ce-17837319bce2
[22:02:55] 🔄 
🔄 Step 6: Pushing order to API...
[22:02:55] [DOC: 9187373] ℹ️  Pushing order via API for patient ID: 4e555c01-e9bb-406d-b1ce-17837319bce2
[22:02:57] [DOC: 9187373] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:02:57] ❌    ❌ Failed to push order
[22:02:57] 🔄 
🔄 Step 7: Writing to CSV...
[22:02:57] [DOC: 9187373] ℹ️  Calculated age: 77 from DOB: 08/22/1947
[22:02:57] [DOC: 9187373] ℹ️  Service Line extracted: 'PT'
[22:02:57] [DOC: 9187373] ℹ️  Payer Source extracted: ''
[22:02:57] [DOC: 9187373] ℹ️  Diagnosis codes being written:
[22:02:57] [DOC: 9187373] ℹ️    - Latest_Episode_Firstdiagnosis: 'M18.11'
[22:02:57] [DOC: 9187373] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z47.1'
[22:02:57] [DOC: 9187373] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[22:02:57] [DOC: 9187373] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[22:02:57] [DOC: 9187373] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.89'
[22:02:57] [DOC: 9187373] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.31'
[22:02:57] [DOC: 9187373] ✅ Patient data written to CSV: John Dossantos | Sex: MALE | Age: 77 | Service: PT | Payer:  | MRN: 227027
[22:02:57] ✅    ✅ Document 9187373 processed and saved successfully
[22:02:57] 🔄 
🔄 Step 8: Saving API details...
[22:02:57] [DOC: 9187373] ℹ️  API push details saved for document 9187373
[22:02:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187187                         ║
================================================================================
[22:02:57] ℹ️  Agency: Westwood
[22:02:57] ℹ️  Date: 03/18/2025
[22:02:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:03:00] [DOC: 9187187] ✅ Text extracted using pdfplumber (26251 chars)
[22:03:00] ✅    ✅ Text extracted using pdfplumber (26155 chars)
[22:03:00] 🔄 
🔄 Step 2: Extracting patient data...
[22:03:04] ℹ️  AI extracted raw sex value: 'F'
[22:03:04] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services'
[22:03:04] ℹ️  AI extracted payer source: 'Medicare'
[22:03:04] ℹ️  AI extracted diagnoses:
[22:03:04] ℹ️    - Diagnosis 1: 'I10'
[22:03:04] ℹ️    - Diagnosis 2: 'B02.9'
[22:03:04] ℹ️    - Diagnosis 3: 'E11.22'
[22:03:04] ℹ️    - Diagnosis 4: 'N18.30'
[22:03:04] ℹ️    - Diagnosis 5: 'E03.9'
[22:03:04] ℹ️    - Diagnosis 6: 'E78.2'
[22:03:04] ℹ️  Final extracted MRN: 'C0100232006701'
[22:03:04] ℹ️  Final extracted Sex: 'FEMALE'
[22:03:04] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services'
[22:03:04] ℹ️  Final extracted Payer Source: 'Medicare'
[22:03:04] ✅ Patient data extraction completed successfully
[22:03:04] ✅    ✅ Patient data extracted successfully
[22:03:04] 📊 Patient Response
     └─ patientFName: THELMA
     └─ patientLName: CARPENTER
     └─ dob: 07/25/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0100232006701
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 1 EDGEWATER DR STE 103
     └─ city: NORWOOD
     └─ state: MA
     └─ zip: 02062
     └─ email: 
     └─ phoneNumber: (781) 551-5600
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'B02.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'E78.2'}]
[22:03:04] ✅    ✅ Patient identified: THELMA CARPENTER
[22:03:04] ✅    ✅ Patient name validation passed
[22:03:04] 🔄 
🔄 Step 3: Processing patient dates...
[22:03:04] [DOC: 9187187] ℹ️  DOB normalized: 07/25/1938
[22:03:04] [DOC: 9187187] ℹ️  Episode startOfCare normalized: 03/02/2025
[22:03:04] [DOC: 9187187] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[22:03:04] [DOC: 9187187] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[22:03:04] [DOC: 9187187] ✅ Patient date processing completed successfully
[22:03:04] ✅    ✅ Date processing completed
[22:03:04] 📊 Processed Patient Data
     └─ patientFName: THELMA
     └─ patientLName: CARPENTER
     └─ dob: 07/25/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0100232006701
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 1 EDGEWATER DR STE 103
     └─ city: NORWOOD
     └─ state: MA
     └─ zip: 02062
     └─ email: 
     └─ phoneNumber: (781) 551-5600
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'B02.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'E78.2'}]
[22:03:04] 🔄 
🔄 Step 4: Extracting order data...
[22:03:07] ℹ️  Order extraction - MRN: '227203'
[22:03:07] ℹ️  Order extraction - Sex: 'FEMALE'
[22:03:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services'
[22:03:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:03:07] ✅ Order data extraction completed successfully
[22:03:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:03:07] ℹ️  Using MRN from patient data: 'C0100232006701' over '227203'
[22:03:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services'
[22:03:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:03:07] ✅ Patient name cross-validation successful
[22:03:07] ✅    ✅ Data merged successfully
[22:03:08] ⚠️     ❌ Skipping - missing company ID for agency: Westwood
[22:03:08] [DOC: 9187187] ℹ️  API push details saved for document 9187187
================================================================================
║                        Processing Document ID: 9187184                         ║
================================================================================
[22:03:08] ℹ️  Agency: Nizhoni Health-Fall River
[22:03:08] ℹ️  Date: 03/18/2025
[22:03:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:03:13] [DOC: 9187184] ✅ Text extracted using pdfplumber (2085 chars)
[22:03:13] ✅    ✅ Text extracted using pdfplumber (2085 chars)
[22:03:13] 🔄 
🔄 Step 2: Extracting patient data...
[22:03:16] ℹ️  AI extracted raw sex value: 'F'
[22:03:16] ℹ️  AI extracted service line: 'HHA'
[22:03:16] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance One Care'
[22:03:16] ℹ️  AI extracted diagnoses:
[22:03:16] ℹ️    - Diagnosis 1: ''
[22:03:16] ℹ️    - Diagnosis 2: ''
[22:03:16] ℹ️    - Diagnosis 3: ''
[22:03:16] ℹ️    - Diagnosis 4: ''
[22:03:16] ℹ️    - Diagnosis 5: ''
[22:03:16] ℹ️    - Diagnosis 6: ''
[22:03:16] ℹ️  Final extracted MRN: '149007'
[22:03:16] ℹ️  Final extracted Sex: 'FEMALE'
[22:03:16] ℹ️  Final extracted Service Line: 'HHA'
[22:03:16] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance One Care'
[22:03:16] ✅ Patient data extraction completed successfully
[22:03:16] ✅    ✅ Patient data extracted successfully
[22:03:16] 📊 Patient Response
     └─ patientFName: Michelle
     └─ patientLName: Medeiros
     └─ dob: 04/01/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 149007
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 12 Ruth Street Apt 219
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '12/07/2018', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:03:16] ✅    ✅ Patient identified: Michelle Medeiros
[22:03:16] ✅    ✅ Patient name validation passed
[22:03:16] 🔄 
🔄 Step 3: Processing patient dates...
[22:03:16] [DOC: 9187184] ℹ️  DOB normalized: 04/01/1976
[22:03:16] [DOC: 9187184] ℹ️  Episode startOfCare normalized: 12/07/2018
[22:03:16] [DOC: 9187184] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[22:03:16] [DOC: 9187184] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[22:03:16] [DOC: 9187184] ✅ Patient date processing completed successfully
[22:03:16] ✅    ✅ Date processing completed
[22:03:16] 📊 Processed Patient Data
     └─ patientFName: Michelle
     └─ patientLName: Medeiros
     └─ dob: 04/01/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 149007
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 12 Ruth Street Apt 219
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '12/07/2018', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:03:16] 🔄 
🔄 Step 4: Extracting order data...
[22:03:18] ℹ️  Order extraction - MRN: '149007'
[22:03:18] ℹ️  Order extraction - Sex: 'FEMALE'
[22:03:18] ℹ️  Order extraction - Service Line: ''
[22:03:18] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance One Care'
[22:03:18] ✅ Order data extraction completed successfully
[22:03:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:03:18] ℹ️  Using MRN from patient data: '149007' over '149007'
[22:03:18] ℹ️  Using service line from patient data: 'HHA'
[22:03:18] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance One Care'
[22:03:18] ✅ Patient name cross-validation successful
[22:03:18] ✅    ✅ Data merged successfully
[22:03:20] ✅    ✅ Order data extracted and validated
[22:03:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:03:20] [DOC: 9187184] ✅ Patient found in local cache: Michelle Medeiros, ID: a22c4d90-a8e4-46e8-9f60-ed12d9f03a92
[22:03:20] ✅    ✅ Existing patient found with ID: a22c4d90-a8e4-46e8-9f60-ed12d9f03a92
[22:03:20] 🔄 
🔄 Step 6: Pushing order to API...
[22:03:20] [DOC: 9187184] ℹ️  Pushing order via API for patient ID: a22c4d90-a8e4-46e8-9f60-ed12d9f03a92
[22:03:21] [DOC: 9187184] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:03:21] ❌    ❌ Failed to push order
[22:03:21] 🔄 
🔄 Step 7: Writing to CSV...
[22:03:21] [DOC: 9187184] ℹ️  Calculated age: 49 from DOB: 04/01/1976
[22:03:21] [DOC: 9187184] ℹ️  Service Line extracted: 'HHA'
[22:03:21] [DOC: 9187184] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance One Care'
[22:03:21] [DOC: 9187184] ℹ️  Diagnosis codes being written:
[22:03:21] [DOC: 9187184] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:03:21] [DOC: 9187184] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:03:21] [DOC: 9187184] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:03:21] [DOC: 9187184] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:03:21] [DOC: 9187184] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:03:21] [DOC: 9187184] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:03:21] [DOC: 9187184] ✅ Patient data written to CSV: Michelle Medeiros | Sex: FEMALE | Age: 49 | Service: HHA | Payer: Commonwealth Care Alliance One Care | MRN: 149007
[22:03:21] ✅    ✅ Document 9187184 processed and saved successfully
[22:03:21] 🔄 
🔄 Step 8: Saving API details...
[22:03:21] [DOC: 9187184] ℹ️  API push details saved for document 9187184
[22:03:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187141                         ║
================================================================================
[22:03:21] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:03:21] ℹ️  Date: 03/18/2025
[22:03:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:03:27] [DOC: 9187141] ✅ Text extracted using pdfplumber (3734 chars)
[22:03:27] ✅    ✅ Text extracted using pdfplumber (3734 chars)
[22:03:27] 🔄 
🔄 Step 2: Extracting patient data...
[22:03:29] ℹ️  AI extracted raw sex value: 'None'
[22:03:29] ℹ️  AI extracted service line: 'None'
[22:03:29] ℹ️  AI extracted payer source: 'None'
[22:03:29] ℹ️  AI extracted diagnoses:
[22:03:29] ℹ️    - Diagnosis 1: 'None'
[22:03:29] ℹ️    - Diagnosis 2: 'None'
[22:03:29] ℹ️    - Diagnosis 3: 'None'
[22:03:29] ℹ️    - Diagnosis 4: 'None'
[22:03:29] ℹ️    - Diagnosis 5: 'None'
[22:03:29] ℹ️    - Diagnosis 6: 'None'
[22:03:29] ℹ️  Final extracted MRN: ''
[22:03:29] ℹ️  Final extracted Sex: ''
[22:03:29] ℹ️  Final extracted Service Line: ''
[22:03:29] ℹ️  Final extracted Payer Source: ''
[22:03:29] ✅ Patient data extraction completed successfully
[22:03:29] ✅    ✅ Patient data extracted successfully
[22:03:29] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:03:29] ⚠️     ❌ Insufficient patient data extracted
[22:03:29] [DOC: 9187141] ℹ️  API push details saved for document 9187141
================================================================================
║                        Processing Document ID: 9186406                         ║
================================================================================
[22:03:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:03:29] ℹ️  Date: 03/17/2025
[22:03:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:03:31] [DOC: 9186406] ✅ Text extracted using pdfplumber (12339 chars)
[22:03:31] ✅    ✅ Text extracted using pdfplumber (12339 chars)
[22:03:31] 🔄 
🔄 Step 2: Extracting patient data...
[22:03:34] ℹ️  AI extracted raw sex value: 'F'
[22:03:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:03:34] ℹ️  AI extracted payer source: 'Medicare'
[22:03:34] ℹ️  AI extracted diagnoses:
[22:03:34] ℹ️    - Diagnosis 1: 'N30.00'
[22:03:34] ℹ️    - Diagnosis 2: 'N12.'
[22:03:34] ℹ️    - Diagnosis 3: 'R33.9'
[22:03:34] ℹ️    - Diagnosis 4: 'N13.30'
[22:03:34] ℹ️    - Diagnosis 5: 'K25.4'
[22:03:34] ℹ️    - Diagnosis 6: 'D50.0'
[22:03:34] ℹ️  Final extracted MRN: 'MA240624105104'
[22:03:34] ℹ️  Final extracted Sex: 'FEMALE'
[22:03:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:03:34] ℹ️  Final extracted Payer Source: 'Medicare'
[22:03:34] ✅ Patient data extraction completed successfully
[22:03:34] ✅    ✅ Patient data extracted successfully
[22:03:34] 📊 Patient Response
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: RODRIGUES, JUNE NP
     └─ npi: 1821065913
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, Apt 408
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 951-0061
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/25/2024', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'N12.', 'thirdDiagnosis': 'R33.9', 'fourthDiagnosis': 'N13.30', 'fifthDiagnosis': 'K25.4', 'sixthDiagnosis': 'D50.0'}]
[22:03:34] ✅    ✅ Patient identified: Marsha Tilley
[22:03:34] ✅    ✅ Patient name validation passed
[22:03:34] 🔄 
🔄 Step 3: Processing patient dates...
[22:03:34] [DOC: 9186406] ℹ️  DOB normalized: 10/08/1951
[22:03:34] [DOC: 9186406] ℹ️  Episode startOfCare normalized: 06/25/2024
[22:03:34] [DOC: 9186406] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[22:03:34] [DOC: 9186406] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[22:03:34] [DOC: 9186406] ✅ Patient date processing completed successfully
[22:03:34] ✅    ✅ Date processing completed
[22:03:34] 📊 Processed Patient Data
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: RODRIGUES, JUNE NP
     └─ npi: 1821065913
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, Apt 408
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 951-0061
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/25/2024', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'N12.', 'thirdDiagnosis': 'R33.9', 'fourthDiagnosis': 'N13.30', 'fifthDiagnosis': 'K25.4', 'sixthDiagnosis': 'D50.0'}]
[22:03:34] 🔄 
🔄 Step 4: Extracting order data...
[22:03:37] ℹ️  Order extraction - MRN: 'MA240624105104'
[22:03:37] ℹ️  Order extraction - Sex: 'FEMALE'
[22:03:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:03:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:03:37] ✅ Order data extraction completed successfully
[22:03:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:03:37] ℹ️  Using MRN from patient data: 'MA240624105104' over 'MA240624105104'
[22:03:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:03:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:03:37] ✅ Patient name cross-validation successful
[22:03:37] ✅    ✅ Data merged successfully
[22:03:38] ✅    ✅ Order data extracted and validated
[22:03:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:03:38] [DOC: 9186406] ✅ Patient found in local cache: Marsha Tilley, ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[22:03:38] ✅    ✅ Existing patient found with ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[22:03:38] 🔄 
🔄 Step 6: Pushing order to API...
[22:03:38] [DOC: 9186406] ℹ️  Pushing order via API for patient ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[22:03:39] [DOC: 9186406] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14357"}
[22:03:39] ❌    ❌ Failed to push order
[22:03:39] 🔄 
🔄 Step 7: Writing to CSV...
[22:03:39] [DOC: 9186406] ℹ️  Calculated age: 73 from DOB: 10/08/1951
[22:03:39] [DOC: 9186406] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:03:39] [DOC: 9186406] ℹ️  Payer Source extracted: 'Medicare'
[22:03:39] [DOC: 9186406] ℹ️  Diagnosis codes being written:
[22:03:39] [DOC: 9186406] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[22:03:39] [DOC: 9186406] ℹ️    - Latest_Episode_Seconddiagnosis: 'N12.'
[22:03:39] [DOC: 9186406] ℹ️    - Latest_Episode_Thirddiagnosis: 'R33.9'
[22:03:39] [DOC: 9186406] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N13.30'
[22:03:39] [DOC: 9186406] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K25.4'
[22:03:39] [DOC: 9186406] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D50.0'
[22:03:39] [DOC: 9186406] ✅ Patient data written to CSV: Marsha Tilley | Sex: FEMALE | Age: 73 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240624105104
[22:03:39] ✅    ✅ Document 9186406 processed and saved successfully
[22:03:39] 🔄 
🔄 Step 8: Saving API details...
[22:03:39] [DOC: 9186406] ℹ️  API push details saved for document 9186406
[22:03:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9184235                         ║
================================================================================
[22:03:39] ℹ️  Agency: Nizhoni Health-Fall River
[22:03:39] ℹ️  Date: 03/17/2025
[22:03:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:03:53] [DOC: 9184235] ✅ Text extracted using pdfplumber (13501 chars)
[22:03:53] ✅    ✅ Text extracted using pdfplumber (13501 chars)
[22:03:53] 🔄 
🔄 Step 2: Extracting patient data...
[22:03:57] ℹ️  AI extracted raw sex value: 'M'
[22:03:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:03:57] ℹ️  AI extracted payer source: 'None'
[22:03:57] ℹ️  AI extracted diagnoses:
[22:03:57] ℹ️    - Diagnosis 1: 'F31.9'
[22:03:57] ℹ️    - Diagnosis 2: 'F33.9'
[22:03:57] ℹ️    - Diagnosis 3: 'F41.9'
[22:03:57] ℹ️    - Diagnosis 4: 'F43.10'
[22:03:57] ℹ️    - Diagnosis 5: 'J44.9'
[22:03:57] ℹ️    - Diagnosis 6: 'K21.9'
[22:03:57] ℹ️  Final extracted MRN: '6844020'
[22:03:57] ℹ️  Final extracted Sex: 'MALE'
[22:03:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:03:57] ℹ️  Final extracted Payer Source: ''
[22:03:57] ✅ Patient data extraction completed successfully
[22:03:57] ✅    ✅ Patient data extracted successfully
[22:03:57] 📊 Patient Response
     └─ patientFName: Randall
     └─ patientLName: Hansen
     └─ dob: 04/17/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 6844020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100011179635
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA services
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2024', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F43.10', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'K21.9'}]
[22:03:57] ✅    ✅ Patient identified: Randall Hansen
[22:03:57] ✅    ✅ Patient name validation passed
[22:03:57] 🔄 
🔄 Step 3: Processing patient dates...
[22:03:57] [DOC: 9184235] ℹ️  DOB normalized: 04/17/1966
[22:03:57] [DOC: 9184235] ℹ️  Episode startOfCare normalized: 03/15/2024
[22:03:57] [DOC: 9184235] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[22:03:57] [DOC: 9184235] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[22:03:57] [DOC: 9184235] ✅ Patient date processing completed successfully
[22:03:57] ✅    ✅ Date processing completed
[22:03:57] 📊 Processed Patient Data
     └─ patientFName: Randall
     └─ patientLName: Hansen
     └─ dob: 04/17/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 6844020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100011179635
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA services
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2024', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F43.10', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'K21.9'}]
[22:03:57] 🔄 
🔄 Step 4: Extracting order data...
[22:03:59] ℹ️  Order extraction - MRN: '6844020'
[22:03:59] ℹ️  Order extraction - Sex: 'MALE'
[22:03:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:03:59] ℹ️  Order extraction - Payer Source: ''
[22:03:59] ✅ Order data extraction completed successfully
[22:03:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:03:59] ℹ️  Using MRN from patient data: '6844020' over '6844020'
[22:03:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:03:59] ✅ Patient name cross-validation successful
[22:03:59] ✅    ✅ Data merged successfully
[22:04:01] ✅    ✅ Order data extracted and validated
[22:04:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:04:33] [DOC: 9184235] ✅ Patient exists in API: Randall Hansen, ID: 25e5a8c3-72c6-4e7c-8b49-6d569db99b05
[22:04:33] ✅    ✅ Existing patient found with ID: 25e5a8c3-72c6-4e7c-8b49-6d569db99b05
[22:04:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:04:33] [DOC: 9184235] ℹ️  Pushing order via API for patient ID: 25e5a8c3-72c6-4e7c-8b49-6d569db99b05
[22:04:35] [DOC: 9184235] ❌ Order push failed with status 201: {"id":"195e5e50-e205-4499-ba2e-e44c5ee1c5b1","orderWAVId":"ORD20084","orderNo":"6844020","orderDate":"03/15/2025","startOfCare":"03/19/2024","episodeStartDate":"03/14/2025","episodeEndDate":"05/12/2025","documentID":"9184235","mrn":"6844020","patientName":"Hansen, Randall S","sentToPhysicianDate":"03/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"25e5a8c3-72c6-4e7c-8b49-6d569db99b05","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[22:04:35] ❌    ❌ Failed to push order
[22:04:35] 🔄 
🔄 Step 7: Writing to CSV...
[22:04:35] [DOC: 9184235] ℹ️  Calculated age: 59 from DOB: 04/17/1966
[22:04:35] [DOC: 9184235] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:04:35] [DOC: 9184235] ℹ️  Payer Source extracted: ''
[22:04:35] [DOC: 9184235] ℹ️  Diagnosis codes being written:
[22:04:35] [DOC: 9184235] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.9'
[22:04:35] [DOC: 9184235] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.9'
[22:04:35] [DOC: 9184235] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[22:04:35] [DOC: 9184235] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F43.10'
[22:04:35] [DOC: 9184235] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.9'
[22:04:35] [DOC: 9184235] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[22:04:35] [DOC: 9184235] ✅ Patient data written to CSV: Randall Hansen | Sex: MALE | Age: 59 | Service: Skilled Nursing | Payer:  | MRN: 6844020
[22:04:35] ✅    ✅ Document 9184235 processed and saved successfully
[22:04:35] 🔄 
🔄 Step 8: Saving API details...
[22:04:35] [DOC: 9184235] ℹ️  API push details saved for document 9184235
[22:04:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187051                         ║
================================================================================
[22:04:35] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[22:04:35] ℹ️  Date: 03/17/2025
[22:04:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:04:37] [DOC: 9187051] ✅ Text extracted using pdfplumber (1523 chars)
[22:04:37] ✅    ✅ Text extracted using pdfplumber (1511 chars)
[22:04:37] 🔄 
🔄 Step 2: Extracting patient data...
[22:04:40] ℹ️  AI extracted raw sex value: ''
[22:04:40] ℹ️  AI extracted service line: 'PT'
[22:04:40] ℹ️  AI extracted payer source: 'Medicare'
[22:04:40] ℹ️  AI extracted diagnoses:
[22:04:40] ℹ️    - Diagnosis 1: ''
[22:04:40] ℹ️    - Diagnosis 2: ''
[22:04:40] ℹ️    - Diagnosis 3: ''
[22:04:40] ℹ️    - Diagnosis 4: ''
[22:04:40] ℹ️    - Diagnosis 5: ''
[22:04:40] ℹ️    - Diagnosis 6: ''
[22:04:40] ℹ️  Final extracted MRN: '28700204505101'
[22:04:40] ℹ️  Final extracted Sex: ''
[22:04:40] ℹ️  Final extracted Service Line: 'PT'
[22:04:40] ℹ️  Final extracted Payer Source: 'Medicare'
[22:04:40] ✅ Patient data extraction completed successfully
[22:04:40] ✅    ✅ Patient data extracted successfully
[22:04:40] 📊 Patient Response
     └─ patientFName: ROBERT
     └─ patientLName: MICHAUD
     └─ dob: 03/13/1937
     └─ patientSex: 
     └─ medicalRecordNo: 28700204505101
     └─ billingProvider: HUGO JAUREGUI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUCNE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/21/2025', 'endOfEpisode': '02/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:04:40] ✅    ✅ Patient identified: ROBERT MICHAUD
[22:04:40] ✅    ✅ Patient name validation passed
[22:04:40] 🔄 
🔄 Step 3: Processing patient dates...
[22:04:40] [DOC: 9187051] ℹ️  DOB normalized: 03/13/1937
[22:04:40] [DOC: 9187051] ℹ️  Episode startOfEpisode normalized: 01/21/2025
[22:04:40] [DOC: 9187051] ℹ️  Episode endOfEpisode normalized: 02/07/2025
[22:04:40] [DOC: 9187051] ✅ Patient date processing completed successfully
[22:04:40] ✅    ✅ Date processing completed
[22:04:40] 📊 Processed Patient Data
     └─ patientFName: ROBERT
     └─ patientLName: MICHAUD
     └─ dob: 03/13/1937
     └─ patientSex: 
     └─ medicalRecordNo: 28700204505101
     └─ billingProvider: HUGO JAUREGUI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUCNE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/21/2025', 'endOfEpisode': '02/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:04:40] 🔄 
🔄 Step 4: Extracting order data...
[22:04:43] ℹ️  Order extraction - MRN: '28700204505101'
[22:04:43] ℹ️  Order extraction - Sex: ''
[22:04:43] ℹ️  Order extraction - Service Line: 'PT'
[22:04:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:04:43] ✅ Order data extraction completed successfully
[22:04:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:04:43] ℹ️  Using MRN from patient data: '28700204505101' over '28700204505101'
[22:04:43] ℹ️  Inferred sex as MALE from name: ROBERT
[22:04:43] ℹ️  Service line consistent in both sources: 'PT'
[22:04:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:04:43] ✅ Patient name cross-validation successful
[22:04:43] ✅    ✅ Data merged successfully
[22:04:44] ✅    ✅ Order data extracted and validated
[22:04:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:04:44] [DOC: 9187051] ✅ Patient found in local cache: ROBERT MICHAUD, ID: b2f8cef3-41f9-4633-abdc-41afddf1457e
[22:04:44] ✅    ✅ Existing patient found with ID: b2f8cef3-41f9-4633-abdc-41afddf1457e
[22:04:44] 🔄 
🔄 Step 6: Pushing order to API...
[22:04:44] [DOC: 9187051] ℹ️  Pushing order via API for patient ID: b2f8cef3-41f9-4633-abdc-41afddf1457e
[22:04:45] [DOC: 9187051] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14103"}
[22:04:45] ❌    ❌ Failed to push order
[22:04:45] 🔄 
🔄 Step 7: Writing to CSV...
[22:04:45] [DOC: 9187051] ℹ️  Calculated age: 88 from DOB: 03/13/1937
[22:04:45] [DOC: 9187051] ℹ️  Service Line extracted: 'PT'
[22:04:45] [DOC: 9187051] ℹ️  Payer Source extracted: 'Medicare'
[22:04:45] [DOC: 9187051] ℹ️  Diagnosis codes being written:
[22:04:45] [DOC: 9187051] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:04:45] [DOC: 9187051] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:04:45] [DOC: 9187051] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:04:45] [DOC: 9187051] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:04:45] [DOC: 9187051] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:04:45] [DOC: 9187051] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:04:45] [DOC: 9187051] ✅ Patient data written to CSV: ROBERT MICHAUD | Sex: MALE | Age: 88 | Service: PT | Payer: Medicare | MRN: 28700204505101
[22:04:45] ✅    ✅ Document 9187051 processed and saved successfully
[22:04:45] 🔄 
🔄 Step 8: Saving API details...
[22:04:45] [DOC: 9187051] ℹ️  API push details saved for document 9187051
[22:04:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9185621                         ║
================================================================================
[22:04:45] ℹ️  Agency: COMFORT HOME CARE LLC-METHUEN
[22:04:45] ℹ️  Date: 03/17/2025
[22:04:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:04:50] [DOC: 9185621] ✅ Text extracted using pdfplumber (7457 chars)
[22:04:50] ✅    ✅ Text extracted using pdfplumber (7457 chars)
[22:04:50] 🔄 
🔄 Step 2: Extracting patient data...
[22:04:53] ℹ️  AI extracted raw sex value: 'M'
[22:04:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:04:53] ℹ️  AI extracted payer source: 'None'
[22:04:53] ℹ️  AI extracted diagnoses:
[22:04:53] ℹ️    - Diagnosis 1: 'F20.9'
[22:04:53] ℹ️    - Diagnosis 2: 'F31.2'
[22:04:53] ℹ️    - Diagnosis 3: 'E11.9'
[22:04:53] ℹ️    - Diagnosis 4: 'K21.9'
[22:04:53] ℹ️    - Diagnosis 5: 'I10'
[22:04:53] ℹ️    - Diagnosis 6: 'R73.03'
[22:04:53] ℹ️  Final extracted MRN: '3398005'
[22:04:53] ℹ️  Final extracted Sex: 'MALE'
[22:04:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:04:53] ℹ️  Final extracted Payer Source: ''
[22:04:53] ✅ Patient data extraction completed successfully
[22:04:53] ✅    ✅ Patient data extracted successfully
[22:04:53] 📊 Patient Response
     └─ patientFName: Damian
     └─ patientLName: MacCord
     └─ dob: 05/20/1995
     └─ patientSex: MALE
     └─ medicalRecordNo: 3398005
     └─ billingProvider: Comfort Home Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Comfort Home Care, LLC
     └─ address: 147 Pelham Street
     └─ city: Methuen
     └─ state: MA
     └─ zip: 01844
     └─ email: None
     └─ phoneNumber: (617) 242-1000
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '07/03/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F31.2', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R73.03'}]
[22:04:53] ✅    ✅ Patient identified: Damian MacCord
[22:04:53] ✅    ✅ Patient name validation passed
[22:04:53] 🔄 
🔄 Step 3: Processing patient dates...
[22:04:53] [DOC: 9185621] ℹ️  DOB normalized: 05/20/1995
[22:04:53] [DOC: 9185621] ℹ️  Episode startOfCare normalized: 02/28/2025
[22:04:53] [DOC: 9185621] ℹ️  Episode startOfEpisode normalized: 07/03/2024
[22:04:53] [DOC: 9185621] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[22:04:53] [DOC: 9185621] ✅ Patient date processing completed successfully
[22:04:53] ✅    ✅ Date processing completed
[22:04:53] 📊 Processed Patient Data
     └─ patientFName: Damian
     └─ patientLName: MacCord
     └─ dob: 05/20/1995
     └─ patientSex: MALE
     └─ medicalRecordNo: 3398005
     └─ billingProvider: Comfort Home Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Comfort Home Care, LLC
     └─ address: 147 Pelham Street
     └─ city: Methuen
     └─ state: MA
     └─ zip: 01844
     └─ phoneNumber: (617) 242-1000
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '07/03/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F31.2', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R73.03'}]
[22:04:53] 🔄 
🔄 Step 4: Extracting order data...
[22:04:55] ℹ️  Order extraction - MRN: ''
[22:04:55] ℹ️  Order extraction - Sex: 'MALE'
[22:04:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:04:55] ℹ️  Order extraction - Payer Source: ''
[22:04:55] ✅ Order data extraction completed successfully
[22:04:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:04:55] ℹ️  Using MRN from patient data: '3398005'
[22:04:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:04:55] ✅ Patient name cross-validation successful
[22:04:55] ✅    ✅ Data merged successfully
[22:04:57] ✅    ✅ Order data extracted and validated
[22:04:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:05:24] [DOC: 9185621] ✅ Patient exists in API: Damian MacCord, ID: caa71080-3e70-495f-bb79-948f55c165a0
[22:05:24] ✅    ✅ Existing patient found with ID: caa71080-3e70-495f-bb79-948f55c165a0
[22:05:24] 🔄 
🔄 Step 6: Pushing order to API...
[22:05:24] [DOC: 9185621] ℹ️  Pushing order via API for patient ID: caa71080-3e70-495f-bb79-948f55c165a0
[22:05:25] [DOC: 9185621] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:05:25] ❌    ❌ Failed to push order
[22:05:25] 🔄 
🔄 Step 7: Writing to CSV...
[22:05:25] [DOC: 9185621] ℹ️  Calculated age: 30 from DOB: 05/20/1995
[22:05:25] [DOC: 9185621] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:05:25] [DOC: 9185621] ℹ️  Payer Source extracted: ''
[22:05:25] [DOC: 9185621] ℹ️  Diagnosis codes being written:
[22:05:25] [DOC: 9185621] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[22:05:25] [DOC: 9185621] ℹ️    - Latest_Episode_Seconddiagnosis: 'F31.2'
[22:05:25] [DOC: 9185621] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[22:05:25] [DOC: 9185621] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K21.9'
[22:05:25] [DOC: 9185621] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[22:05:25] [DOC: 9185621] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R73.03'
[22:05:25] [DOC: 9185621] ✅ Patient data written to CSV: Damian MacCord | Sex: MALE | Age: 30 | Service: Skilled Nursing | Payer:  | MRN: 3398005
[22:05:25] ✅    ✅ Document 9185621 processed and saved successfully
[22:05:25] 🔄 
🔄 Step 8: Saving API details...
[22:05:25] [DOC: 9185621] ℹ️  API push details saved for document 9185621
[22:05:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9185063                         ║
================================================================================
[22:05:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:05:25] ℹ️  Date: 03/17/2025
[22:05:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:05:27] [DOC: 9185063] ✅ Text extracted using pdfplumber (10084 chars)
[22:05:27] ✅    ✅ Text extracted using pdfplumber (10072 chars)
[22:05:27] 🔄 
🔄 Step 2: Extracting patient data...
[22:05:31] ℹ️  AI extracted raw sex value: 'F'
[22:05:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:05:31] ℹ️  AI extracted payer source: 'Medicare'
[22:05:31] ℹ️  AI extracted diagnoses:
[22:05:31] ℹ️    - Diagnosis 1: 'F32.A'
[22:05:31] ℹ️    - Diagnosis 2: 'F41.9'
[22:05:31] ℹ️    - Diagnosis 3: 'J44.9'
[22:05:31] ℹ️    - Diagnosis 4: 'I10'
[22:05:31] ℹ️    - Diagnosis 5: 'M47.816'
[22:05:31] ℹ️    - Diagnosis 6: 'M81.0'
[22:05:31] ℹ️  Final extracted MRN: 'MA230315023303'
[22:05:31] ℹ️  Final extracted Sex: 'FEMALE'
[22:05:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:05:31] ℹ️  Final extracted Payer Source: 'Medicare'
[22:05:31] ✅ Patient data extraction completed successfully
[22:05:31] ✅    ✅ Patient data extracted successfully
[22:05:31] 📊 Patient Response
     └─ patientFName: Alice
     └─ patientLName: Frates
     └─ dob: 02/13/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230315023303
     └─ billingProvider: POTHIER, JAHN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 108 Coggeshall St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 995-4755
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/08/2023', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'M81.0'}]
[22:05:31] ✅    ✅ Patient identified: Alice Frates
[22:05:31] ✅    ✅ Patient name validation passed
[22:05:31] 🔄 
🔄 Step 3: Processing patient dates...
[22:05:31] [DOC: 9185063] ℹ️  DOB normalized: 02/13/1933
[22:05:31] [DOC: 9185063] ℹ️  Episode startOfCare normalized: 07/08/2023
[22:05:31] [DOC: 9185063] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[22:05:31] [DOC: 9185063] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[22:05:31] [DOC: 9185063] ✅ Patient date processing completed successfully
[22:05:31] ✅    ✅ Date processing completed
[22:05:31] 📊 Processed Patient Data
     └─ patientFName: Alice
     └─ patientLName: Frates
     └─ dob: 02/13/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230315023303
     └─ billingProvider: POTHIER, JAHN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 108 Coggeshall St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 995-4755
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/08/2023', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'M81.0'}]
[22:05:31] 🔄 
🔄 Step 4: Extracting order data...
[22:05:34] ℹ️  Order extraction - MRN: 'MA230315023303'
[22:05:34] ℹ️  Order extraction - Sex: 'FEMALE'
[22:05:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:05:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:05:34] ✅ Order data extraction completed successfully
[22:05:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:05:34] ℹ️  Using MRN from patient data: 'MA230315023303' over 'MA230315023303'
[22:05:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:05:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:05:34] ✅ Patient name cross-validation successful
[22:05:34] ✅    ✅ Data merged successfully
[22:05:35] ✅    ✅ Order data extracted and validated
[22:05:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:05:35] [DOC: 9185063] ✅ Patient found in local cache: Alice Frates, ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[22:05:35] ✅    ✅ Existing patient found with ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[22:05:35] 🔄 
🔄 Step 6: Pushing order to API...
[22:05:35] [DOC: 9185063] ℹ️  Pushing order via API for patient ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[22:05:36] [DOC: 9185063] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12909"}
[22:05:36] ❌    ❌ Failed to push order
[22:05:36] 🔄 
🔄 Step 7: Writing to CSV...
[22:05:36] [DOC: 9185063] ℹ️  Calculated age: 92 from DOB: 02/13/1933
[22:05:36] [DOC: 9185063] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:05:36] [DOC: 9185063] ℹ️  Payer Source extracted: 'Medicare'
[22:05:36] [DOC: 9185063] ℹ️  Diagnosis codes being written:
[22:05:36] [DOC: 9185063] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.A'
[22:05:36] [DOC: 9185063] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[22:05:36] [DOC: 9185063] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[22:05:36] [DOC: 9185063] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[22:05:36] [DOC: 9185063] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M47.816'
[22:05:36] [DOC: 9185063] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M81.0'
[22:05:36] [DOC: 9185063] ✅ Patient data written to CSV: Alice Frates | Sex: FEMALE | Age: 92 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230315023303
[22:05:36] ✅    ✅ Document 9185063 processed and saved successfully
[22:05:36] 🔄 
🔄 Step 8: Saving API details...
[22:05:36] [DOC: 9185063] ℹ️  API push details saved for document 9185063
[22:05:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9182649                         ║
================================================================================
[22:05:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:05:36] ℹ️  Date: 03/14/2025
[22:05:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:05:37] [DOC: 9182649] ✅ Text extracted using pdfplumber (1526 chars)
[22:05:37] ✅    ✅ Text extracted using pdfplumber (1526 chars)
[22:05:37] 🔄 
🔄 Step 2: Extracting patient data...
[22:05:40] ℹ️  AI extracted raw sex value: 'F'
[22:05:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:05:40] ℹ️  AI extracted payer source: ''
[22:05:40] ℹ️  AI extracted diagnoses:
[22:05:40] ℹ️    - Diagnosis 1: ''
[22:05:40] ℹ️    - Diagnosis 2: ''
[22:05:40] ℹ️    - Diagnosis 3: ''
[22:05:40] ℹ️    - Diagnosis 4: ''
[22:05:40] ℹ️    - Diagnosis 5: ''
[22:05:40] ℹ️    - Diagnosis 6: ''
[22:05:40] ℹ️  Final extracted MRN: '2168743'
[22:05:40] ℹ️  Final extracted Sex: 'FEMALE'
[22:05:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:05:40] ℹ️  Final extracted Payer Source: ''
[22:05:40] ✅ Patient data extraction completed successfully
[22:05:40] ✅    ✅ Patient data extracted successfully
[22:05:40] 📊 Patient Response
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:05:40] ✅    ✅ Patient identified: Sheila Adesso
[22:05:40] ✅    ✅ Patient name validation passed
[22:05:40] 🔄 
🔄 Step 3: Processing patient dates...
[22:05:40] [DOC: 9182649] ℹ️  DOB normalized: 11/24/1963
[22:05:40] [DOC: 9182649] ✅ Patient date processing completed successfully
[22:05:40] ✅    ✅ Date processing completed
[22:05:40] 📊 Processed Patient Data
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:05:40] 🔄 
🔄 Step 4: Extracting order data...
[22:05:42] ℹ️  Order extraction - MRN: '2168743'
[22:05:42] ℹ️  Order extraction - Sex: 'FEMALE'
[22:05:42] ℹ️  Order extraction - Service Line: ''
[22:05:42] ℹ️  Order extraction - Payer Source: ''
[22:05:42] ✅ Order data extraction completed successfully
[22:05:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:05:42] ℹ️  Using MRN from patient data: '2168743' over '2168743'
[22:05:42] ℹ️  Using service line from patient data: 'Skilled Nursing'
[22:05:42] ✅ Patient name cross-validation successful
[22:05:42] ✅    ✅ Data merged successfully
[22:05:43] ⚠️     ❌ Skipping - missing episode start date
[22:05:43] [DOC: 9182649] ℹ️  API push details saved for document 9182649
================================================================================
║                        Processing Document ID: 9180823                         ║
================================================================================
[22:05:43] ℹ️  Agency: Dartmouth HH
[22:05:43] ℹ️  Date: 03/13/2025
[22:05:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:05:45] [DOC: 9180823] ✅ Text extracted using pdfplumber (3867 chars)
[22:05:45] ✅    ✅ Text extracted using pdfplumber (3867 chars)
[22:05:45] 🔄 
🔄 Step 2: Extracting patient data...
[22:05:48] ℹ️  AI extracted raw sex value: 'M'
[22:05:48] ℹ️  AI extracted service line: 'PT'
[22:05:48] ℹ️  AI extracted payer source: 'Medicare'
[22:05:48] ℹ️  AI extracted diagnoses:
[22:05:48] ℹ️    - Diagnosis 1: ''
[22:05:48] ℹ️    - Diagnosis 2: ''
[22:05:48] ℹ️    - Diagnosis 3: ''
[22:05:48] ℹ️    - Diagnosis 4: ''
[22:05:48] ℹ️    - Diagnosis 5: ''
[22:05:48] ℹ️    - Diagnosis 6: ''
[22:05:48] ℹ️  Final extracted MRN: '5405015'
[22:05:48] ℹ️  Final extracted Sex: 'MALE'
[22:05:48] ℹ️  Final extracted Service Line: 'PT'
[22:05:48] ℹ️  Final extracted Payer Source: 'Medicare'
[22:05:48] ✅ Patient data extraction completed successfully
[22:05:48] ✅    ✅ Patient data extracted successfully
[22:05:48] 📊 Patient Response
     └─ patientFName: Octavio
     └─ patientLName: Silva
     └─ dob: 02/02/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 5405015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/20/2025', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:05:48] ✅    ✅ Patient identified: Octavio Silva
[22:05:48] ✅    ✅ Patient name validation passed
[22:05:48] 🔄 
🔄 Step 3: Processing patient dates...
[22:05:48] [DOC: 9180823] ℹ️  DOB normalized: 02/02/1950
[22:05:48] [DOC: 9180823] ℹ️  Episode startOfCare normalized: 02/20/2025
[22:05:48] [DOC: 9180823] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[22:05:48] [DOC: 9180823] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[22:05:48] [DOC: 9180823] ✅ Patient date processing completed successfully
[22:05:48] ✅    ✅ Date processing completed
[22:05:48] 📊 Processed Patient Data
     └─ patientFName: Octavio
     └─ patientLName: Silva
     └─ dob: 02/02/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 5405015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/20/2025', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:05:48] 🔄 
🔄 Step 4: Extracting order data...
[22:05:50] ℹ️  Order extraction - MRN: '5405015'
[22:05:50] ℹ️  Order extraction - Sex: 'MALE'
[22:05:50] ℹ️  Order extraction - Service Line: 'PT'
[22:05:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:05:50] ✅ Order data extraction completed successfully
[22:05:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:05:50] ℹ️  Using MRN from patient data: '5405015' over '5405015'
[22:05:50] ℹ️  Service line consistent in both sources: 'PT'
[22:05:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:05:50] ✅ Patient name cross-validation successful
[22:05:50] ✅    ✅ Data merged successfully
[22:05:52] ✅    ✅ Order data extracted and validated
[22:05:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:05:59] [DOC: 9180823] ✅ Patient exists in API: Octavio Silva, ID: fd342871-2a0a-4a8b-bd02-46217ccd03f9
[22:05:59] ✅    ✅ Existing patient found with ID: fd342871-2a0a-4a8b-bd02-46217ccd03f9
[22:05:59] 🔄 
🔄 Step 6: Pushing order to API...
[22:05:59] [DOC: 9180823] ℹ️  Pushing order via API for patient ID: fd342871-2a0a-4a8b-bd02-46217ccd03f9
[22:06:01] [DOC: 9180823] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:06:01] ❌    ❌ Failed to push order
[22:06:01] 🔄 
🔄 Step 7: Writing to CSV...
[22:06:01] [DOC: 9180823] ℹ️  Calculated age: 75 from DOB: 02/02/1950
[22:06:01] [DOC: 9180823] ℹ️  Service Line extracted: 'PT'
[22:06:01] [DOC: 9180823] ℹ️  Payer Source extracted: 'Medicare'
[22:06:01] [DOC: 9180823] ℹ️  Diagnosis codes being written:
[22:06:01] [DOC: 9180823] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:06:01] [DOC: 9180823] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:06:01] [DOC: 9180823] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:06:01] [DOC: 9180823] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:06:01] [DOC: 9180823] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:06:01] [DOC: 9180823] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:06:01] [DOC: 9180823] ✅ Patient data written to CSV: Octavio Silva | Sex: MALE | Age: 75 | Service: PT | Payer: Medicare | MRN: 5405015
[22:06:01] ✅    ✅ Document 9180823 processed and saved successfully
[22:06:01] 🔄 
🔄 Step 8: Saving API details...
[22:06:01] [DOC: 9180823] ℹ️  API push details saved for document 9180823
[22:06:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9180079                         ║
================================================================================
[22:06:01] ℹ️  Agency: Dartmouth HH
[22:06:01] ℹ️  Date: 03/13/2025
[22:06:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:06:03] [DOC: 9180079] ✅ Text extracted using pdfplumber (6999 chars)
[22:06:03] ✅    ✅ Text extracted using pdfplumber (6999 chars)
[22:06:03] 🔄 
🔄 Step 2: Extracting patient data...
[22:06:06] ℹ️  AI extracted raw sex value: 'M'
[22:06:06] ℹ️  AI extracted service line: 'OT'
[22:06:06] ℹ️  AI extracted payer source: 'Medicare'
[22:06:06] ℹ️  AI extracted diagnoses:
[22:06:06] ℹ️    - Diagnosis 1: 'None'
[22:06:06] ℹ️    - Diagnosis 2: 'None'
[22:06:06] ℹ️    - Diagnosis 3: 'None'
[22:06:06] ℹ️    - Diagnosis 4: 'None'
[22:06:06] ℹ️    - Diagnosis 5: 'None'
[22:06:06] ℹ️    - Diagnosis 6: 'None'
[22:06:06] ℹ️  Final extracted MRN: '894015'
[22:06:06] ℹ️  Final extracted Sex: 'MALE'
[22:06:06] ℹ️  Final extracted Service Line: 'OT'
[22:06:06] ℹ️  Final extracted Payer Source: 'Medicare'
[22:06:06] ✅ Patient data extraction completed successfully
[22:06:06] ✅    ✅ Patient data extracted successfully
[22:06:06] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Bourassa
     └─ dob: 05/10/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 894015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:06:06] ✅    ✅ Patient identified: Joseph Bourassa
[22:06:06] ✅    ✅ Patient name validation passed
[22:06:06] 🔄 
🔄 Step 3: Processing patient dates...
[22:06:06] [DOC: 9180079] ℹ️  DOB normalized: 05/10/1944
[22:06:06] [DOC: 9180079] ℹ️  Episode startOfCare normalized: 03/05/2025
[22:06:06] [DOC: 9180079] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[22:06:06] [DOC: 9180079] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[22:06:06] [DOC: 9180079] ✅ Patient date processing completed successfully
[22:06:06] ✅    ✅ Date processing completed
[22:06:06] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Bourassa
     └─ dob: 05/10/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 894015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025'}]
[22:06:06] 🔄 
🔄 Step 4: Extracting order data...
[22:06:08] ℹ️  Order extraction - MRN: ''
[22:06:08] ℹ️  Order extraction - Sex: 'MALE'
[22:06:08] ℹ️  Order extraction - Service Line: 'OT'
[22:06:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:06:08] ✅ Order data extraction completed successfully
[22:06:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:06:08] ℹ️  Using MRN from patient data: '894015'
[22:06:08] ℹ️  Service line consistent in both sources: 'OT'
[22:06:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:06:08] ✅ Patient name cross-validation successful
[22:06:08] ✅    ✅ Data merged successfully
[22:06:09] ✅    ✅ Order data extracted and validated
[22:06:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:06:09] [DOC: 9180079] ✅ Patient found in local cache: Joseph Bourassa, ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[22:06:09] ✅    ✅ Existing patient found with ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[22:06:09] 🔄 
🔄 Step 6: Pushing order to API...
[22:06:09] [DOC: 9180079] ℹ️  Pushing order via API for patient ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[22:06:11] [DOC: 9180079] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:06:11] ❌    ❌ Failed to push order
[22:06:11] 🔄 
🔄 Step 7: Writing to CSV...
[22:06:11] [DOC: 9180079] ℹ️  Calculated age: 81 from DOB: 05/10/1944
[22:06:11] [DOC: 9180079] ℹ️  Service Line extracted: 'OT'
[22:06:11] [DOC: 9180079] ℹ️  Payer Source extracted: 'Medicare'
[22:06:11] [DOC: 9180079] ℹ️  Diagnosis codes being written:
[22:06:11] [DOC: 9180079] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:06:11] [DOC: 9180079] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:06:11] [DOC: 9180079] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:06:11] [DOC: 9180079] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:06:11] [DOC: 9180079] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:06:11] [DOC: 9180079] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:06:11] [DOC: 9180079] ✅ Patient data written to CSV: Joseph Bourassa | Sex: MALE | Age: 81 | Service: OT | Payer: Medicare | MRN: 894015
[22:06:11] ✅    ✅ Document 9180079 processed and saved successfully
[22:06:11] 🔄 
🔄 Step 8: Saving API details...
[22:06:11] [DOC: 9180079] ℹ️  API push details saved for document 9180079
[22:06:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9179884                         ║
================================================================================
[22:06:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:06:11] ℹ️  Date: 03/13/2025
[22:06:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:06:12] [DOC: 9179884] ✅ Text extracted using pdfplumber (1075 chars)
[22:06:12] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[22:06:12] 🔄 
🔄 Step 2: Extracting patient data...
[22:06:15] ℹ️  AI extracted raw sex value: 'F'
[22:06:15] ℹ️  AI extracted service line: 'PT'
[22:06:15] ℹ️  AI extracted payer source: ''
[22:06:15] ℹ️  AI extracted diagnoses:
[22:06:15] ℹ️    - Diagnosis 1: 'None'
[22:06:15] ℹ️    - Diagnosis 2: 'None'
[22:06:15] ℹ️    - Diagnosis 3: 'None'
[22:06:15] ℹ️    - Diagnosis 4: 'None'
[22:06:15] ℹ️    - Diagnosis 5: 'None'
[22:06:15] ℹ️    - Diagnosis 6: 'None'
[22:06:15] ℹ️  Final extracted MRN: '2261397'
[22:06:15] ℹ️  Final extracted Sex: 'FEMALE'
[22:06:15] ℹ️  Final extracted Service Line: 'PT'
[22:06:15] ℹ️  Final extracted Payer Source: ''
[22:06:15] ✅ Patient data extraction completed successfully
[22:06:15] ✅    ✅ Patient data extracted successfully
[22:06:15] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bowden
     └─ dob: 11/20/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2261397
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:06:15] ✅    ✅ Patient identified: Pauline Bowden
[22:06:15] ✅    ✅ Patient name validation passed
[22:06:15] 🔄 
🔄 Step 3: Processing patient dates...
[22:06:15] [DOC: 9179884] ℹ️  DOB normalized: 11/20/1957
[22:06:15] [DOC: 9179884] ✅ Patient date processing completed successfully
[22:06:15] ✅    ✅ Date processing completed
[22:06:15] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bowden
     └─ dob: 11/20/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2261397
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[22:06:15] 🔄 
🔄 Step 4: Extracting order data...
[22:06:17] ℹ️  Order extraction - MRN: '2261397'
[22:06:17] ℹ️  Order extraction - Sex: 'FEMALE'
[22:06:17] ℹ️  Order extraction - Service Line: 'PT'
[22:06:17] ℹ️  Order extraction - Payer Source: ''
[22:06:17] ✅ Order data extraction completed successfully
[22:06:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:06:17] ℹ️  Using MRN from patient data: '2261397' over '2261397'
[22:06:17] ℹ️  Service line consistent in both sources: 'PT'
[22:06:17] ✅ Patient name cross-validation successful
[22:06:17] ✅    ✅ Data merged successfully
[22:06:19] ✅    ✅ Order data extracted and validated
[22:06:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:06:25] [DOC: 9179884] ℹ️  Patient not found in cache or API: Pauline Bowden
[22:06:25] [DOC: 9179884] ℹ️  Patient not found, creating new patient via API...
[22:06:25] [DOC: 9179884] ℹ️  Creating patient via API: Pauline Bowden
[22:06:27] [DOC: 9179884] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:06:27] ❌    ❌ Failed to create patient
[22:06:27] [DOC: 9179884] ℹ️  API push details saved for document 9179884
================================================================================
║                        Processing Document ID: 9179864                         ║
================================================================================
[22:06:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:06:27] ℹ️  Date: 03/13/2025
[22:06:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:06:28] [DOC: 9179864] ✅ Text extracted using pdfplumber (1652 chars)
[22:06:28] ✅    ✅ Text extracted using pdfplumber (1652 chars)
[22:06:28] 🔄 
🔄 Step 2: Extracting patient data...
[22:06:31] ℹ️  AI extracted raw sex value: 'F'
[22:06:31] ℹ️  AI extracted service line: 'Physical Therapy'
[22:06:31] ℹ️  AI extracted payer source: ''
[22:06:31] ℹ️  AI extracted diagnoses:
[22:06:31] ℹ️    - Diagnosis 1: ''
[22:06:31] ℹ️    - Diagnosis 2: ''
[22:06:31] ℹ️    - Diagnosis 3: ''
[22:06:31] ℹ️    - Diagnosis 4: ''
[22:06:31] ℹ️    - Diagnosis 5: ''
[22:06:31] ℹ️    - Diagnosis 6: ''
[22:06:31] ℹ️  Final extracted MRN: '2168743'
[22:06:31] ℹ️  Final extracted Sex: 'FEMALE'
[22:06:31] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:06:31] ℹ️  Final extracted Payer Source: ''
[22:06:31] ✅ Patient data extraction completed successfully
[22:06:31] ✅    ✅ Patient data extracted successfully
[22:06:31] 📊 Patient Response
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:06:31] ✅    ✅ Patient identified: Sheila Adesso
[22:06:31] ✅    ✅ Patient name validation passed
[22:06:31] 🔄 
🔄 Step 3: Processing patient dates...
[22:06:31] [DOC: 9179864] ℹ️  DOB normalized: 11/24/1963
[22:06:31] [DOC: 9179864] ✅ Patient date processing completed successfully
[22:06:31] ✅    ✅ Date processing completed
[22:06:31] 📊 Processed Patient Data
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:06:31] 🔄 
🔄 Step 4: Extracting order data...
[22:06:33] ℹ️  Order extraction - MRN: '2168743'
[22:06:33] ℹ️  Order extraction - Sex: 'FEMALE'
[22:06:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:06:33] ℹ️  Order extraction - Payer Source: ''
[22:06:33] ✅ Order data extraction completed successfully
[22:06:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:06:33] ℹ️  Using MRN from patient data: '2168743' over '2168743'
[22:06:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:06:33] ✅ Patient name cross-validation successful
[22:06:33] ✅    ✅ Data merged successfully
[22:06:34] ✅    ✅ Order data extracted and validated
[22:06:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:06:54] [DOC: 9179864] ℹ️  Patient not found in cache or API: Sheila Adesso
[22:06:54] [DOC: 9179864] ℹ️  Patient not found, creating new patient via API...
[22:06:54] [DOC: 9179864] ℹ️  Creating patient via API: Sheila Adesso
[22:06:55] [DOC: 9179864] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:06:55] ❌    ❌ Failed to create patient
[22:06:55] [DOC: 9179864] ℹ️  API push details saved for document 9179864
================================================================================
║                        Processing Document ID: 9176857                         ║
================================================================================
[22:06:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:06:55] ℹ️  Date: 03/12/2025
[22:06:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:06:57] [DOC: 9176857] ✅ Text extracted using pdfplumber (9785 chars)
[22:06:57] ✅    ✅ Text extracted using pdfplumber (9773 chars)
[22:06:57] 🔄 
🔄 Step 2: Extracting patient data...
[22:07:01] ℹ️  AI extracted raw sex value: 'M'
[22:07:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:07:01] ℹ️  AI extracted payer source: 'Medicare'
[22:07:01] ℹ️  AI extracted diagnoses:
[22:07:01] ℹ️    - Diagnosis 1: 'I10'
[22:07:01] ℹ️    - Diagnosis 2: 'E11.8'
[22:07:01] ℹ️    - Diagnosis 3: 'R57.1'
[22:07:01] ℹ️    - Diagnosis 4: 'K74.60'
[22:07:01] ℹ️    - Diagnosis 5: 'J44.9'
[22:07:01] ℹ️    - Diagnosis 6: 'None'
[22:07:01] ℹ️  Final extracted MRN: 'MA211216035507'
[22:07:01] ℹ️  Final extracted Sex: 'MALE'
[22:07:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:07:01] ℹ️  Final extracted Payer Source: 'Medicare'
[22:07:01] ✅ Patient data extraction completed successfully
[22:07:01] ✅    ✅ Patient data extracted successfully
[22:07:01] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Catulo
     └─ dob: 03/23/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: MA211216035507
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1235622960
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2023', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.8', 'thirdDiagnosis': 'R57.1', 'fourthDiagnosis': 'K74.60', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': None}]
[22:07:01] ✅    ✅ Patient identified: Joseph Catulo
[22:07:01] ✅    ✅ Patient name validation passed
[22:07:01] 🔄 
🔄 Step 3: Processing patient dates...
[22:07:01] [DOC: 9176857] ℹ️  DOB normalized: 03/23/1955
[22:07:01] [DOC: 9176857] ℹ️  Episode startOfCare normalized: 03/08/2023
[22:07:01] [DOC: 9176857] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[22:07:01] [DOC: 9176857] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[22:07:01] [DOC: 9176857] ✅ Patient date processing completed successfully
[22:07:01] ✅    ✅ Date processing completed
[22:07:01] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Catulo
     └─ dob: 03/23/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: MA211216035507
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1235622960
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2023', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.8', 'thirdDiagnosis': 'R57.1', 'fourthDiagnosis': 'K74.60', 'fifthDiagnosis': 'J44.9'}]
[22:07:01] 🔄 
🔄 Step 4: Extracting order data...
[22:07:03] ℹ️  Order extraction - MRN: 'MA211216035507'
[22:07:03] ℹ️  Order extraction - Sex: 'MALE'
[22:07:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:07:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:07:03] ✅ Order data extraction completed successfully
[22:07:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:07:03] ℹ️  Using MRN from patient data: 'MA211216035507' over 'MA211216035507'
[22:07:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:07:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:07:03] ✅ Patient name cross-validation successful
[22:07:03] ✅    ✅ Data merged successfully
[22:07:04] ✅    ✅ Order data extracted and validated
[22:07:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:07:24] [DOC: 9176857] ℹ️  Patient not found in cache or API: Joseph Catulo
[22:07:24] [DOC: 9176857] ℹ️  Patient not found, creating new patient via API...
[22:07:24] [DOC: 9176857] ℹ️  Creating patient via API: Joseph Catulo
[22:07:26] [DOC: 9176857] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:07:26] ❌    ❌ Failed to create patient
[22:07:26] [DOC: 9176857] ℹ️  API push details saved for document 9176857
================================================================================
║                        Processing Document ID: 9176656                         ║
================================================================================
[22:07:26] ℹ️  Agency: Nizhoni Health-Fall River
[22:07:26] ℹ️  Date: 03/12/2025
[22:07:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:07:29] [DOC: 9176656] ✅ Text extracted using pdfplumber (1085 chars)
[22:07:29] ✅    ✅ Text extracted using pdfplumber (1085 chars)
[22:07:29] 🔄 
🔄 Step 2: Extracting patient data...
[22:07:32] ℹ️  AI extracted raw sex value: 'F'
[22:07:32] ℹ️  AI extracted service line: 'HHA'
[22:07:32] ℹ️  AI extracted payer source: 'Medicaid/MA'
[22:07:32] ℹ️  AI extracted diagnoses:
[22:07:32] ℹ️    - Diagnosis 1: ''
[22:07:32] ℹ️    - Diagnosis 2: ''
[22:07:32] ℹ️    - Diagnosis 3: ''
[22:07:32] ℹ️    - Diagnosis 4: ''
[22:07:32] ℹ️    - Diagnosis 5: ''
[22:07:32] ℹ️    - Diagnosis 6: ''
[22:07:32] ℹ️  Final extracted MRN: '25598'
[22:07:32] ℹ️  Final extracted Sex: 'FEMALE'
[22:07:32] ℹ️  Final extracted Service Line: 'HHA'
[22:07:32] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[22:07:32] ✅ Patient data extraction completed successfully
[22:07:32] ✅    ✅ Patient data extracted successfully
[22:07:32] 📊 Patient Response
     └─ patientFName: Helena
     └─ patientLName: Brooks
     └─ dob: 05/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25598
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 60 S 2nd St APT 5F
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2018', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:07:32] ✅    ✅ Patient identified: Helena Brooks
[22:07:32] ✅    ✅ Patient name validation passed
[22:07:32] 🔄 
🔄 Step 3: Processing patient dates...
[22:07:32] [DOC: 9176656] ℹ️  DOB normalized: 05/27/1958
[22:07:32] [DOC: 9176656] ℹ️  Episode startOfCare normalized: 07/15/2018
[22:07:32] [DOC: 9176656] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[22:07:32] [DOC: 9176656] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[22:07:32] [DOC: 9176656] ✅ Patient date processing completed successfully
[22:07:32] ✅    ✅ Date processing completed
[22:07:32] 📊 Processed Patient Data
     └─ patientFName: Helena
     └─ patientLName: Brooks
     └─ dob: 05/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25598
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 60 S 2nd St APT 5F
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2018', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:07:32] 🔄 
🔄 Step 4: Extracting order data...
[22:07:34] ℹ️  Order extraction - MRN: '25598'
[22:07:34] ℹ️  Order extraction - Sex: 'FEMALE'
[22:07:34] ℹ️  Order extraction - Service Line: ''
[22:07:34] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[22:07:34] ✅ Order data extraction completed successfully
[22:07:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:07:34] ℹ️  Using MRN from patient data: '25598' over '25598'
[22:07:34] ℹ️  Using service line from patient data: 'HHA'
[22:07:34] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[22:07:34] ✅ Patient name cross-validation successful
[22:07:34] ✅    ✅ Data merged successfully
[22:07:36] ✅    ✅ Order data extracted and validated
[22:07:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:07:36] [DOC: 9176656] ✅ Patient found in local cache: Helena Brooks, ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[22:07:36] ✅    ✅ Existing patient found with ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[22:07:36] 🔄 
🔄 Step 6: Pushing order to API...
[22:07:36] [DOC: 9176656] ℹ️  Pushing order via API for patient ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[22:07:37] [DOC: 9176656] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:07:37] ❌    ❌ Failed to push order
[22:07:37] 🔄 
🔄 Step 7: Writing to CSV...
[22:07:37] [DOC: 9176656] ℹ️  Calculated age: 67 from DOB: 05/27/1958
[22:07:37] [DOC: 9176656] ℹ️  Service Line extracted: 'HHA'
[22:07:37] [DOC: 9176656] ℹ️  Payer Source extracted: 'Medicaid/MA'
[22:07:37] [DOC: 9176656] ℹ️  Diagnosis codes being written:
[22:07:37] [DOC: 9176656] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:07:37] [DOC: 9176656] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:07:37] [DOC: 9176656] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:07:37] [DOC: 9176656] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:07:37] [DOC: 9176656] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:07:37] [DOC: 9176656] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:07:37] [DOC: 9176656] ✅ Patient data written to CSV: Helena Brooks | Sex: FEMALE | Age: 67 | Service: HHA | Payer: Medicaid/MA | MRN: 25598
[22:07:37] ✅    ✅ Document 9176656 processed and saved successfully
[22:07:37] 🔄 
🔄 Step 8: Saving API details...
[22:07:37] [DOC: 9176656] ℹ️  API push details saved for document 9176656
[22:07:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9178875                         ║
================================================================================
[22:07:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:07:37] ℹ️  Date: 03/12/2025
[22:07:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:07:41] [DOC: 9178875] ✅ Text extracted using pdfplumber (11414 chars)
[22:07:41] ✅    ✅ Text extracted using pdfplumber (11414 chars)
[22:07:41] 🔄 
🔄 Step 2: Extracting patient data...
[22:07:44] ℹ️  AI extracted raw sex value: 'F'
[22:07:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:07:44] ℹ️  AI extracted payer source: 'Medicare'
[22:07:44] ℹ️  AI extracted diagnoses:
[22:07:44] ℹ️    - Diagnosis 1: 'I10'
[22:07:44] ℹ️    - Diagnosis 2: 'L03.115'
[22:07:44] ℹ️    - Diagnosis 3: 'R60.0'
[22:07:44] ℹ️    - Diagnosis 4: 'F03.90'
[22:07:44] ℹ️    - Diagnosis 5: 'M81.0'
[22:07:44] ℹ️    - Diagnosis 6: 'Z79.82'
[22:07:44] ℹ️  Final extracted MRN: '100990085'
[22:07:44] ℹ️  Final extracted Sex: 'FEMALE'
[22:07:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:07:44] ℹ️  Final extracted Payer Source: 'Medicare'
[22:07:44] ✅ Patient data extraction completed successfully
[22:07:44] ✅    ✅ Patient data extracted successfully
[22:07:44] 📊 Patient Response
     └─ patientFName: Marialucil
     └─ patientLName: Dacosta
     └─ dob: 01/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990085
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 10 Puritan Way
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 991-1622
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/02/2017', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'L03.115', 'thirdDiagnosis': 'R60.0', 'fourthDiagnosis': 'F03.90', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'Z79.82'}]
[22:07:44] ✅    ✅ Patient identified: Marialucil Dacosta
[22:07:44] ✅    ✅ Patient name validation passed
[22:07:44] 🔄 
🔄 Step 3: Processing patient dates...
[22:07:44] [DOC: 9178875] ℹ️  DOB normalized: 01/13/1934
[22:07:44] [DOC: 9178875] ℹ️  Episode startOfCare normalized: 06/02/2017
[22:07:44] [DOC: 9178875] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[22:07:44] [DOC: 9178875] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[22:07:44] [DOC: 9178875] ✅ Patient date processing completed successfully
[22:07:44] ✅    ✅ Date processing completed
[22:07:44] 📊 Processed Patient Data
     └─ patientFName: Marialucil
     └─ patientLName: Dacosta
     └─ dob: 01/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990085
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 10 Puritan Way
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 991-1622
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/02/2017', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'L03.115', 'thirdDiagnosis': 'R60.0', 'fourthDiagnosis': 'F03.90', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'Z79.82'}]
[22:07:44] 🔄 
🔄 Step 4: Extracting order data...
[22:07:47] ℹ️  Order extraction - MRN: '100990085'
[22:07:47] ℹ️  Order extraction - Sex: 'FEMALE'
[22:07:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:07:47] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:07:47] ✅ Order data extraction completed successfully
[22:07:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:07:47] ℹ️  Using MRN from patient data: '100990085' over '100990085'
[22:07:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:07:47] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:07:47] ✅ Patient name cross-validation successful
[22:07:47] ✅    ✅ Data merged successfully
[22:07:48] ✅    ✅ Order data extracted and validated
[22:07:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:07:58] [DOC: 9178875] ℹ️  Patient not found in cache or API: Marialucil Dacosta
[22:07:58] [DOC: 9178875] ℹ️  Patient not found, creating new patient via API...
[22:07:58] [DOC: 9178875] ℹ️  Creating patient via API: Marialucil Dacosta
[22:08:00] [DOC: 9178875] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:08:00] ❌    ❌ Failed to create patient
[22:08:00] [DOC: 9178875] ℹ️  API push details saved for document 9178875
================================================================================
║                        Processing Document ID: 9178871                         ║
================================================================================
[22:08:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:08:00] ℹ️  Date: 03/12/2025
[22:08:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:08:03] [DOC: 9178871] ✅ Text extracted using pdfplumber (17797 chars)
[22:08:03] ✅    ✅ Text extracted using pdfplumber (17797 chars)
[22:08:03] 🔄 
🔄 Step 2: Extracting patient data...
[22:08:06] ℹ️  AI extracted raw sex value: 'M'
[22:08:06] ℹ️  AI extracted service line: 'PT'
[22:08:06] ℹ️  AI extracted payer source: 'None'
[22:08:06] ℹ️  AI extracted diagnoses:
[22:08:06] ℹ️    - Diagnosis 1: 'complete trisomy 21 syndrome'
[22:08:06] ℹ️    - Diagnosis 2: 'Generalized weakness'
[22:08:06] ℹ️    - Diagnosis 3: 'Asthma'
[22:08:06] ℹ️    - Diagnosis 4: 'ostium secundum type atrial septal defect'
[22:08:06] ℹ️    - Diagnosis 5: 'DM'
[22:08:06] ℹ️    - Diagnosis 6: 'hypothyroidism'
[22:08:06] ℹ️  Final extracted MRN: 'MA240808027001'
[22:08:06] ℹ️  Final extracted Sex: 'MALE'
[22:08:06] ℹ️  Final extracted Service Line: 'PT'
[22:08:06] ℹ️  Final extracted Payer Source: ''
[22:08:06] ✅ Patient data extraction completed successfully
[22:08:06] ✅    ✅ Patient data extracted successfully
[22:08:06] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': None, 'firstDiagnosis': 'complete trisomy 21 syndrome', 'secondDiagnosis': 'Generalized weakness', 'thirdDiagnosis': 'Asthma', 'fourthDiagnosis': 'ostium secundum type atrial septal defect', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'hypothyroidism'}]
[22:08:06] ✅    ✅ Patient identified: Rafael Talavera
[22:08:06] ✅    ✅ Patient name validation passed
[22:08:06] 🔄 
🔄 Step 3: Processing patient dates...
[22:08:06] [DOC: 9178871] ℹ️  DOB normalized: 02/10/1970
[22:08:06] [DOC: 9178871] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[22:08:06] [DOC: 9178871] ✅ Patient date processing completed successfully
[22:08:06] ✅    ✅ Date processing completed
[22:08:06] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'firstDiagnosis': 'complete trisomy 21 syndrome', 'secondDiagnosis': 'Generalized weakness', 'thirdDiagnosis': 'Asthma', 'fourthDiagnosis': 'ostium secundum type atrial septal defect', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'hypothyroidism'}]
[22:08:06] 🔄 
🔄 Step 4: Extracting order data...
[22:08:09] ℹ️  Order extraction - MRN: 'MA240808027001'
[22:08:09] ℹ️  Order extraction - Sex: 'MALE'
[22:08:09] ℹ️  Order extraction - Service Line: 'PT'
[22:08:09] ℹ️  Order extraction - Payer Source: ''
[22:08:09] ✅ Order data extraction completed successfully
[22:08:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:08:09] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[22:08:09] ℹ️  Service line consistent in both sources: 'PT'
[22:08:09] ✅ Patient name cross-validation successful
[22:08:09] ✅    ✅ Data merged successfully
[22:08:10] ✅    ✅ Order data extracted and validated
[22:08:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:08:10] [DOC: 9178871] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[22:08:10] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[22:08:10] 🔄 
🔄 Step 6: Pushing order to API...
[22:08:10] [DOC: 9178871] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[22:08:16] [DOC: 9178871] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:08:16] ❌    ❌ Failed to push order
[22:08:16] 🔄 
🔄 Step 7: Writing to CSV...
[22:08:16] [DOC: 9178871] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[22:08:16] [DOC: 9178871] ℹ️  Service Line extracted: 'PT'
[22:08:16] [DOC: 9178871] ℹ️  Payer Source extracted: ''
[22:08:16] [DOC: 9178871] ℹ️  Diagnosis codes being written:
[22:08:16] [DOC: 9178871] ℹ️    - Latest_Episode_Firstdiagnosis: 'complete trisomy 21 syndrome'
[22:08:16] [DOC: 9178871] ℹ️    - Latest_Episode_Seconddiagnosis: 'Generalized weakness'
[22:08:16] [DOC: 9178871] ℹ️    - Latest_Episode_Thirddiagnosis: 'Asthma'
[22:08:16] [DOC: 9178871] ℹ️    - Latest_Episode_Fourthdiagnosis: 'ostium secundum type atrial septal defect'
[22:08:16] [DOC: 9178871] ℹ️    - Latest_Episode_Fifthdiagnosis: 'DM'
[22:08:16] [DOC: 9178871] ℹ️    - Latest_Episode_Sixthdiagnosis: 'hypothyroidism'
[22:08:16] [DOC: 9178871] ✅ Patient data written to CSV: Rafael Talavera | Sex: MALE | Age: 55 | Service: PT | Payer:  | MRN: MA240808027001
[22:08:16] ✅    ✅ Document 9178871 processed and saved successfully
[22:08:16] 🔄 
🔄 Step 8: Saving API details...
[22:08:16] [DOC: 9178871] ℹ️  API push details saved for document 9178871
[22:08:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9178674                         ║
================================================================================
[22:08:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:08:16] ℹ️  Date: 03/12/2025
[22:08:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:08:18] [DOC: 9178674] ✅ Text extracted using pdfplumber (2224 chars)
[22:08:18] ✅    ✅ Text extracted using pdfplumber (2212 chars)
[22:08:18] 🔄 
🔄 Step 2: Extracting patient data...
[22:08:21] ℹ️  AI extracted raw sex value: ''
[22:08:21] ℹ️  AI extracted service line: 'Physical Therapy'
[22:08:21] ℹ️  AI extracted payer source: ''
[22:08:21] ℹ️  AI extracted diagnoses:
[22:08:21] ℹ️    - Diagnosis 1: 'I10'
[22:08:21] ℹ️    - Diagnosis 2: 'E11.51'
[22:08:21] ℹ️    - Diagnosis 3: 'I69.392'
[22:08:21] ℹ️    - Diagnosis 4: ''
[22:08:21] ℹ️    - Diagnosis 5: ''
[22:08:21] ℹ️    - Diagnosis 6: ''
[22:08:21] ℹ️  Final extracted MRN: 'MA210707054107'
[22:08:21] ℹ️  Final extracted Sex: ''
[22:08:21] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:08:21] ℹ️  Final extracted Payer Source: ''
[22:08:21] ✅ Patient data extraction completed successfully
[22:08:21] ✅    ✅ Patient data extracted successfully
[22:08:21] 📊 Patient Response
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I69.392', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:08:21] ✅    ✅ Patient identified: Carmen Nunes
[22:08:21] ✅    ✅ Patient name validation passed
[22:08:21] 🔄 
🔄 Step 3: Processing patient dates...
[22:08:21] [DOC: 9178674] ℹ️  DOB normalized: 05/24/1941
[22:08:21] [DOC: 9178674] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[22:08:21] [DOC: 9178674] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[22:08:21] [DOC: 9178674] ✅ Patient date processing completed successfully
[22:08:21] ✅    ✅ Date processing completed
[22:08:21] 📊 Processed Patient Data
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I69.392', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:08:21] 🔄 
🔄 Step 4: Extracting order data...
[22:08:24] ℹ️  Order extraction - MRN: 'MA210707054107'
[22:08:24] ℹ️  Order extraction - Sex: ''
[22:08:24] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:08:24] ℹ️  Order extraction - Payer Source: ''
[22:08:24] ✅ Order data extraction completed successfully
[22:08:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:08:24] ℹ️  Using MRN from patient data: 'MA210707054107' over 'MA210707054107'
[22:08:24] ⚠️  Could not determine sex using any available method
[22:08:24] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:08:24] ✅ Patient name cross-validation successful
[22:08:24] ✅    ✅ Data merged successfully
[22:08:25] ✅    ✅ Order data extracted and validated
[22:08:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:08:25] [DOC: 9178674] ✅ Patient found in local cache: Carmen Nunes, ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:25] ✅    ✅ Existing patient found with ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:25] 🔄 
🔄 Step 6: Pushing order to API...
[22:08:25] [DOC: 9178674] ℹ️  Pushing order via API for patient ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:26] [DOC: 9178674] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12935"}
[22:08:26] ❌    ❌ Failed to push order
[22:08:26] 🔄 
🔄 Step 7: Writing to CSV...
[22:08:26] [DOC: 9178674] ℹ️  Calculated age: 84 from DOB: 05/24/1941
[22:08:26] [DOC: 9178674] ℹ️  Service Line extracted: 'Physical Therapy'
[22:08:26] [DOC: 9178674] ℹ️  Payer Source extracted: ''
[22:08:26] [DOC: 9178674] ℹ️  Diagnosis codes being written:
[22:08:26] [DOC: 9178674] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:08:26] [DOC: 9178674] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.51'
[22:08:26] [DOC: 9178674] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.392'
[22:08:26] [DOC: 9178674] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:08:26] [DOC: 9178674] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:08:26] [DOC: 9178674] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:08:26] [DOC: 9178674] ✅ Patient data written to CSV: Carmen Nunes | Sex:  | Age: 84 | Service: Physical Therapy | Payer:  | MRN: MA210707054107
[22:08:26] ✅    ✅ Document 9178674 processed and saved successfully
[22:08:26] 🔄 
🔄 Step 8: Saving API details...
[22:08:26] [DOC: 9178674] ℹ️  API push details saved for document 9178674
[22:08:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9178671                         ║
================================================================================
[22:08:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:08:26] ℹ️  Date: 03/12/2025
[22:08:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:08:30] [DOC: 9178671] ✅ Text extracted using pdfplumber (19529 chars)
[22:08:30] ✅    ✅ Text extracted using pdfplumber (19529 chars)
[22:08:30] 🔄 
🔄 Step 2: Extracting patient data...
[22:08:33] ℹ️  AI extracted raw sex value: 'F'
[22:08:33] ℹ️  AI extracted service line: 'PT'
[22:08:33] ℹ️  AI extracted payer source: ''
[22:08:33] ℹ️  AI extracted diagnoses:
[22:08:33] ℹ️    - Diagnosis 1: 'I10'
[22:08:33] ℹ️    - Diagnosis 2: 'M54.5'
[22:08:33] ℹ️    - Diagnosis 3: 'C56'
[22:08:33] ℹ️    - Diagnosis 4: 'E03.9'
[22:08:33] ℹ️    - Diagnosis 5: 'E78.5'
[22:08:33] ℹ️    - Diagnosis 6: 'F41.1'
[22:08:33] ℹ️  Final extracted MRN: 'MA210707054107'
[22:08:33] ℹ️  Final extracted Sex: 'FEMALE'
[22:08:33] ℹ️  Final extracted Service Line: 'PT'
[22:08:33] ℹ️  Final extracted Payer Source: ''
[22:08:33] ✅ Patient data extraction completed successfully
[22:08:33] ✅    ✅ Patient data extracted successfully
[22:08:33] 📊 Patient Response
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/19/25', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'C56', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.1'}]
[22:08:33] ✅    ✅ Patient identified: Carmen Nunes
[22:08:33] ✅    ✅ Patient name validation passed
[22:08:33] 🔄 
🔄 Step 3: Processing patient dates...
[22:08:33] [DOC: 9178671] ℹ️  DOB normalized: 05/24/1941
[22:08:33] [DOC: 9178671] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[22:08:33] [DOC: 9178671] ⚠️  Invalid endOfEpisode format: 04/19/25
[22:08:33] [DOC: 9178671] ✅ Patient date processing completed successfully
[22:08:33] ✅    ✅ Date processing completed
[22:08:33] 📊 Processed Patient Data
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/19/25', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'C56', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.1'}]
[22:08:33] 🔄 
🔄 Step 4: Extracting order data...
[22:08:36] ℹ️  Order extraction - MRN: 'MA210707054107'
[22:08:36] ℹ️  Order extraction - Sex: 'FEMALE'
[22:08:36] ℹ️  Order extraction - Service Line: 'PT'
[22:08:36] ℹ️  Order extraction - Payer Source: ''
[22:08:36] ✅ Order data extraction completed successfully
[22:08:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:08:36] ℹ️  Using MRN from patient data: 'MA210707054107' over 'MA210707054107'
[22:08:36] ℹ️  Service line consistent in both sources: 'PT'
[22:08:36] ✅ Patient name cross-validation successful
[22:08:36] ✅    ✅ Data merged successfully
[22:08:37] ✅    ✅ Order data extracted and validated
[22:08:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:08:37] [DOC: 9178671] ✅ Patient found in local cache: Carmen Nunes, ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:37] ✅    ✅ Existing patient found with ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:37] 🔄 
🔄 Step 6: Pushing order to API...
[22:08:37] [DOC: 9178671] ℹ️  Pushing order via API for patient ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:38] [DOC: 9178671] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:08:38] ❌    ❌ Failed to push order
[22:08:38] 🔄 
🔄 Step 7: Writing to CSV...
[22:08:38] [DOC: 9178671] ℹ️  Calculated age: 84 from DOB: 05/24/1941
[22:08:38] [DOC: 9178671] ℹ️  Service Line extracted: 'PT'
[22:08:38] [DOC: 9178671] ℹ️  Payer Source extracted: ''
[22:08:38] [DOC: 9178671] ℹ️  Diagnosis codes being written:
[22:08:38] [DOC: 9178671] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:08:38] [DOC: 9178671] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.5'
[22:08:38] [DOC: 9178671] ℹ️    - Latest_Episode_Thirddiagnosis: 'C56'
[22:08:38] [DOC: 9178671] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.9'
[22:08:38] [DOC: 9178671] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[22:08:38] [DOC: 9178671] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.1'
[22:08:38] [DOC: 9178671] ✅ Patient data written to CSV: Carmen Nunes | Sex: FEMALE | Age: 84 | Service: PT | Payer:  | MRN: MA210707054107
[22:08:38] ✅    ✅ Document 9178671 processed and saved successfully
[22:08:38] 🔄 
🔄 Step 8: Saving API details...
[22:08:38] [DOC: 9178671] ℹ️  API push details saved for document 9178671
[22:08:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9178669                         ║
================================================================================
[22:08:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:08:38] ℹ️  Date: 03/12/2025
[22:08:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:08:41] [DOC: 9178669] ✅ Text extracted using pdfplumber (2212 chars)
[22:08:41] ✅    ✅ Text extracted using pdfplumber (2200 chars)
[22:08:41] 🔄 
🔄 Step 2: Extracting patient data...
[22:08:44] ℹ️  AI extracted raw sex value: ''
[22:08:44] ℹ️  AI extracted service line: 'Physical Therapy'
[22:08:44] ℹ️  AI extracted payer source: ''
[22:08:44] ℹ️  AI extracted diagnoses:
[22:08:44] ℹ️    - Diagnosis 1: 'I10'
[22:08:44] ℹ️    - Diagnosis 2: 'E11.51'
[22:08:44] ℹ️    - Diagnosis 3: 'I69.392'
[22:08:44] ℹ️    - Diagnosis 4: ''
[22:08:44] ℹ️    - Diagnosis 5: ''
[22:08:44] ℹ️    - Diagnosis 6: ''
[22:08:44] ℹ️  Final extracted MRN: 'MA210707054107'
[22:08:44] ℹ️  Final extracted Sex: ''
[22:08:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:08:44] ℹ️  Final extracted Payer Source: ''
[22:08:44] ✅ Patient data extraction completed successfully
[22:08:44] ✅    ✅ Patient data extracted successfully
[22:08:44] 📊 Patient Response
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I69.392', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:08:44] ✅    ✅ Patient identified: Carmen Nunes
[22:08:44] ✅    ✅ Patient name validation passed
[22:08:44] 🔄 
🔄 Step 3: Processing patient dates...
[22:08:44] [DOC: 9178669] ℹ️  DOB normalized: 05/24/1941
[22:08:44] [DOC: 9178669] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[22:08:44] [DOC: 9178669] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[22:08:44] [DOC: 9178669] ✅ Patient date processing completed successfully
[22:08:44] ✅    ✅ Date processing completed
[22:08:44] 📊 Processed Patient Data
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I69.392', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:08:44] 🔄 
🔄 Step 4: Extracting order data...
[22:08:46] ℹ️  Order extraction - MRN: 'MA210707054107'
[22:08:46] ℹ️  Order extraction - Sex: ''
[22:08:46] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:08:46] ℹ️  Order extraction - Payer Source: ''
[22:08:46] ✅ Order data extraction completed successfully
[22:08:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:08:46] ℹ️  Using MRN from patient data: 'MA210707054107' over 'MA210707054107'
[22:08:46] ⚠️  Could not determine sex using any available method
[22:08:46] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:08:46] ✅ Patient name cross-validation successful
[22:08:46] ✅    ✅ Data merged successfully
[22:08:47] ✅    ✅ Order data extracted and validated
[22:08:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:08:47] [DOC: 9178669] ✅ Patient found in local cache: Carmen Nunes, ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:47] ✅    ✅ Existing patient found with ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:47] 🔄 
🔄 Step 6: Pushing order to API...
[22:08:47] [DOC: 9178669] ℹ️  Pushing order via API for patient ID: 322b997c-fe51-4513-a943-636e9b6ec412
[22:08:49] [DOC: 9178669] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12955"}
[22:08:49] ❌    ❌ Failed to push order
[22:08:49] 🔄 
🔄 Step 7: Writing to CSV...
[22:08:49] [DOC: 9178669] ℹ️  Calculated age: 84 from DOB: 05/24/1941
[22:08:49] [DOC: 9178669] ℹ️  Service Line extracted: 'Physical Therapy'
[22:08:49] [DOC: 9178669] ℹ️  Payer Source extracted: ''
[22:08:49] [DOC: 9178669] ℹ️  Diagnosis codes being written:
[22:08:49] [DOC: 9178669] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[22:08:49] [DOC: 9178669] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.51'
[22:08:49] [DOC: 9178669] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.392'
[22:08:49] [DOC: 9178669] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:08:49] [DOC: 9178669] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:08:49] [DOC: 9178669] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:08:49] [DOC: 9178669] ✅ Patient data written to CSV: Carmen Nunes | Sex:  | Age: 84 | Service: Physical Therapy | Payer:  | MRN: MA210707054107
[22:08:49] ✅    ✅ Document 9178669 processed and saved successfully
[22:08:49] 🔄 
🔄 Step 8: Saving API details...
[22:08:49] [DOC: 9178669] ℹ️  API push details saved for document 9178669
[22:08:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9178658                         ║
================================================================================
[22:08:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:08:49] ℹ️  Date: 03/12/2025
[22:08:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:08:54] [DOC: 9178658] ✅ Text extracted using pdfplumber (14222 chars)
[22:08:54] ✅    ✅ Text extracted using pdfplumber (14222 chars)
[22:08:54] 🔄 
🔄 Step 2: Extracting patient data...
[22:08:57] ℹ️  AI extracted raw sex value: 'F'
[22:08:57] ℹ️  AI extracted service line: 'OT'
[22:08:57] ℹ️  AI extracted payer source: 'None'
[22:08:57] ℹ️  AI extracted diagnoses:
[22:08:57] ℹ️    - Diagnosis 1: 'None'
[22:08:57] ℹ️    - Diagnosis 2: 'None'
[22:08:57] ℹ️    - Diagnosis 3: 'None'
[22:08:57] ℹ️    - Diagnosis 4: 'None'
[22:08:57] ℹ️    - Diagnosis 5: 'None'
[22:08:57] ℹ️    - Diagnosis 6: 'None'
[22:08:57] ℹ️  Final extracted MRN: '1257821075'
[22:08:57] ℹ️  Final extracted Sex: 'FEMALE'
[22:08:57] ℹ️  Final extracted Service Line: 'OT'
[22:08:57] ℹ️  Final extracted Payer Source: ''
[22:08:57] ✅ Patient data extraction completed successfully
[22:08:57] ✅    ✅ Patient data extracted successfully
[22:08:57] 📊 Patient Response
     └─ patientFName: Carmen G.
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1257821075
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/24/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:08:57] ✅    ✅ Patient identified: Carmen G. Nunes
[22:08:57] ✅    ✅ Patient name validation passed
[22:08:57] 🔄 
🔄 Step 3: Processing patient dates...
[22:08:57] [DOC: 9178658] ℹ️  DOB normalized: 05/24/1941
[22:08:57] [DOC: 9178658] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[22:08:57] [DOC: 9178658] ✅ Patient date processing completed successfully
[22:08:57] ✅    ✅ Date processing completed
[22:08:57] 📊 Processed Patient Data
     └─ patientFName: Carmen G.
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1257821075
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025'}]
[22:08:57] 🔄 
🔄 Step 4: Extracting order data...
[22:09:00] ℹ️  Order extraction - MRN: 'MA210707054107'
[22:09:00] ℹ️  Order extraction - Sex: 'FEMALE'
[22:09:00] ℹ️  Order extraction - Service Line: 'OT'
[22:09:00] ℹ️  Order extraction - Payer Source: ''
[22:09:00] ✅ Order data extraction completed successfully
[22:09:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:09:00] ℹ️  Using longer MRN from order data: 'MA210707054107' over '1257821075'
[22:09:00] ℹ️  Service line consistent in both sources: 'OT'
[22:09:00] ✅ Patient name cross-validation successful
[22:09:00] ✅    ✅ Data merged successfully
[22:09:01] ✅    ✅ Order data extracted and validated
[22:09:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:09:07] [DOC: 9178658] ✅ Patient exists in API: Carmen G. Nunes, ID: d585bd48-b9f3-4f6e-a0c4-cc2006dd4bf7
[22:09:07] ✅    ✅ Existing patient found with ID: d585bd48-b9f3-4f6e-a0c4-cc2006dd4bf7
[22:09:07] 🔄 
🔄 Step 6: Pushing order to API...
[22:09:07] [DOC: 9178658] ℹ️  Pushing order via API for patient ID: d585bd48-b9f3-4f6e-a0c4-cc2006dd4bf7
[22:09:09] [DOC: 9178658] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:09:09] ❌    ❌ Failed to push order
[22:09:09] 🔄 
🔄 Step 7: Writing to CSV...
[22:09:09] [DOC: 9178658] ℹ️  Calculated age: 84 from DOB: 05/24/1941
[22:09:09] [DOC: 9178658] ℹ️  Service Line extracted: 'OT'
[22:09:09] [DOC: 9178658] ℹ️  Payer Source extracted: ''
[22:09:09] [DOC: 9178658] ℹ️  Diagnosis codes being written:
[22:09:09] [DOC: 9178658] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:09:09] [DOC: 9178658] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:09:09] [DOC: 9178658] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:09:09] [DOC: 9178658] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:09:09] [DOC: 9178658] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:09:09] [DOC: 9178658] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:09:09] [DOC: 9178658] ✅ Patient data written to CSV: Carmen G. Nunes | Sex: FEMALE | Age: 84 | Service: OT | Payer:  | MRN: MA210707054107
[22:09:09] ✅    ✅ Document 9178658 processed and saved successfully
[22:09:09] 🔄 
🔄 Step 8: Saving API details...
[22:09:09] [DOC: 9178658] ℹ️  API push details saved for document 9178658
[22:09:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177848                         ║
================================================================================
[22:09:09] ℹ️  Agency: Alphacare Home Health Agency
[22:09:09] ℹ️  Date: 03/12/2025
[22:09:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:09:15] [DOC: 9177848] ✅ Text extracted using pdfplumber (3306 chars)
[22:09:15] ✅    ✅ Text extracted using pdfplumber (3306 chars)
[22:09:15] 🔄 
🔄 Step 2: Extracting patient data...
[22:09:17] ℹ️  AI extracted raw sex value: ''
[22:09:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:09:17] ℹ️  AI extracted payer source: ''
[22:09:17] ℹ️  AI extracted diagnoses:
[22:09:17] ℹ️    - Diagnosis 1: 'J44.9'
[22:09:17] ℹ️    - Diagnosis 2: 'J96.20'
[22:09:17] ℹ️    - Diagnosis 3: 'J18.9'
[22:09:17] ℹ️    - Diagnosis 4: 'None'
[22:09:17] ℹ️    - Diagnosis 5: 'None'
[22:09:17] ℹ️    - Diagnosis 6: 'None'
[22:09:17] ℹ️  Final extracted MRN: '000003097'
[22:09:17] ℹ️  Final extracted Sex: ''
[22:09:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:09:17] ℹ️  Final extracted Payer Source: ''
[22:09:17] ✅ Patient data extraction completed successfully
[22:09:17] ✅    ✅ Patient data extracted successfully
[22:09:17] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/04/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:09:17] ✅    ✅ Patient identified: Gloria Medeiros
[22:09:17] ✅    ✅ Patient name validation passed
[22:09:17] 🔄 
🔄 Step 3: Processing patient dates...
[22:09:17] [DOC: 9177848] ℹ️  DOB normalized: 07/04/1946
[22:09:17] [DOC: 9177848] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[22:09:17] [DOC: 9177848] ℹ️  Episode endOfEpisode normalized: 03/04/2025
[22:09:17] [DOC: 9177848] ✅ Patient date processing completed successfully
[22:09:17] ✅    ✅ Date processing completed
[22:09:17] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'J18.9'}]
[22:09:17] 🔄 
🔄 Step 4: Extracting order data...
[22:09:20] ℹ️  Order extraction - MRN: '000003097'
[22:09:20] ℹ️  Order extraction - Sex: ''
[22:09:20] ℹ️  Order extraction - Service Line: 'SN'
[22:09:20] ℹ️  Order extraction - Payer Source: ''
[22:09:20] ✅ Order data extraction completed successfully
[22:09:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:09:20] ℹ️  Using MRN from patient data: '000003097' over '000003097'
[22:09:20] ⚠️  Could not determine sex using any available method
[22:09:20] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[22:09:20] ✅ Patient name cross-validation successful
[22:09:20] ✅    ✅ Data merged successfully
[22:09:21] ⚠️     ❌ Skipping - missing episode start date
[22:09:21] [DOC: 9177848] ℹ️  API push details saved for document 9177848
================================================================================
║                        Processing Document ID: 9177758                         ║
================================================================================
[22:09:21] ℹ️  Agency: Nizhoni Health-Fall River
[22:09:21] ℹ️  Date: 03/12/2025
[22:09:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:09:24] [DOC: 9177758] ✅ Text extracted using pdfplumber (987 chars)
[22:09:24] ✅    ✅ Text extracted using pdfplumber (987 chars)
[22:09:24] 🔄 
🔄 Step 2: Extracting patient data...
[22:09:26] ℹ️  AI extracted raw sex value: 'F'
[22:09:26] ℹ️  AI extracted service line: 'HHA'
[22:09:26] ℹ️  AI extracted payer source: 'Medicaid/MA'
[22:09:26] ℹ️  AI extracted diagnoses:
[22:09:26] ℹ️    - Diagnosis 1: ''
[22:09:26] ℹ️    - Diagnosis 2: ''
[22:09:26] ℹ️    - Diagnosis 3: ''
[22:09:26] ℹ️    - Diagnosis 4: ''
[22:09:26] ℹ️    - Diagnosis 5: ''
[22:09:26] ℹ️    - Diagnosis 6: ''
[22:09:26] ℹ️  Final extracted MRN: '14458020'
[22:09:26] ℹ️  Final extracted Sex: 'FEMALE'
[22:09:26] ℹ️  Final extracted Service Line: 'HHA'
[22:09:26] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[22:09:26] ✅ Patient data extraction completed successfully
[22:09:26] ✅    ✅ Patient data extracted successfully
[22:09:26] 📊 Patient Response
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:09:26] ✅    ✅ Patient identified: Gina Reich
[22:09:26] ✅    ✅ Patient name validation passed
[22:09:26] 🔄 
🔄 Step 3: Processing patient dates...
[22:09:26] [DOC: 9177758] ℹ️  DOB normalized: 12/30/1962
[22:09:26] [DOC: 9177758] ℹ️  Episode startOfCare normalized: 10/22/2024
[22:09:26] [DOC: 9177758] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[22:09:26] [DOC: 9177758] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[22:09:26] [DOC: 9177758] ✅ Patient date processing completed successfully
[22:09:26] ✅    ✅ Date processing completed
[22:09:26] 📊 Processed Patient Data
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:09:26] 🔄 
🔄 Step 4: Extracting order data...
[22:09:29] ℹ️  Order extraction - MRN: '14458020'
[22:09:29] ℹ️  Order extraction - Sex: 'FEMALE'
[22:09:29] ℹ️  Order extraction - Service Line: ''
[22:09:29] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[22:09:29] ✅ Order data extraction completed successfully
[22:09:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:09:29] ℹ️  Using MRN from patient data: '14458020' over '14458020'
[22:09:29] ℹ️  Using service line from patient data: 'HHA'
[22:09:29] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[22:09:29] ✅ Patient name cross-validation successful
[22:09:29] ✅    ✅ Data merged successfully
[22:09:30] ✅    ✅ Order data extracted and validated
[22:09:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:09:30] [DOC: 9177758] ✅ Patient found in local cache: Gina Reich, ID: d58989e3-7402-4034-9b32-9290658d7724
[22:09:30] ✅    ✅ Existing patient found with ID: d58989e3-7402-4034-9b32-9290658d7724
[22:09:30] 🔄 
🔄 Step 6: Pushing order to API...
[22:09:30] [DOC: 9177758] ℹ️  Pushing order via API for patient ID: d58989e3-7402-4034-9b32-9290658d7724
[22:09:31] [DOC: 9177758] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:09:31] ❌    ❌ Failed to push order
[22:09:31] 🔄 
🔄 Step 7: Writing to CSV...
[22:09:31] [DOC: 9177758] ℹ️  Calculated age: 62 from DOB: 12/30/1962
[22:09:31] [DOC: 9177758] ℹ️  Service Line extracted: 'HHA'
[22:09:31] [DOC: 9177758] ℹ️  Payer Source extracted: 'Medicaid/MA'
[22:09:31] [DOC: 9177758] ℹ️  Diagnosis codes being written:
[22:09:31] [DOC: 9177758] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:09:31] [DOC: 9177758] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:09:31] [DOC: 9177758] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:09:31] [DOC: 9177758] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:09:31] [DOC: 9177758] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:09:31] [DOC: 9177758] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:09:31] [DOC: 9177758] ✅ Patient data written to CSV: Gina Reich | Sex: FEMALE | Age: 62 | Service: HHA | Payer: Medicaid/MA | MRN: 14458020
[22:09:31] ✅    ✅ Document 9177758 processed and saved successfully
[22:09:31] 🔄 
🔄 Step 8: Saving API details...
[22:09:31] [DOC: 9177758] ℹ️  API push details saved for document 9177758
[22:09:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177663                         ║
================================================================================
[22:09:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:09:31] ℹ️  Date: 03/12/2025
[22:09:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:09:35] [DOC: 9177663] ✅ Text extracted using pdfplumber (25696 chars)
[22:09:35] ✅    ✅ Text extracted using pdfplumber (25686 chars)
[22:09:35] 🔄 
🔄 Step 2: Extracting patient data...
[22:09:38] ℹ️  AI extracted raw sex value: 'Female'
[22:09:38] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[22:09:38] ℹ️  AI extracted payer source: ''
[22:09:38] ℹ️  AI extracted diagnoses:
[22:09:38] ℹ️    - Diagnosis 1: 'A41.51'
[22:09:38] ℹ️    - Diagnosis 2: 'N30.00'
[22:09:38] ℹ️    - Diagnosis 3: 'K80.50'
[22:09:38] ℹ️    - Diagnosis 4: 'E11.9'
[22:09:38] ℹ️    - Diagnosis 5: 'E80.6'
[22:09:38] ℹ️    - Diagnosis 6: 'R74.01'
[22:09:38] ℹ️  Final extracted MRN: '3070136'
[22:09:38] ℹ️  Final extracted Sex: 'FEMALE'
[22:09:38] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[22:09:38] ℹ️  Final extracted Payer Source: ''
[22:09:38] ✅ Patient data extraction completed successfully
[22:09:38] ✅    ✅ Patient data extracted successfully
[22:09:38] 📊 Patient Response
     └─ patientFName: Lillian
     └─ patientLName: Vieira
     └─ dob: 04/10/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3070136
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N30.00', 'thirdDiagnosis': 'K80.50', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'E80.6', 'sixthDiagnosis': 'R74.01'}]
[22:09:38] ✅    ✅ Patient identified: Lillian Vieira
[22:09:38] ✅    ✅ Patient name validation passed
[22:09:38] 🔄 
🔄 Step 3: Processing patient dates...
[22:09:38] [DOC: 9177663] ℹ️  DOB normalized: 04/10/1939
[22:09:38] [DOC: 9177663] ℹ️  Episode startOfCare normalized: 02/28/2025
[22:09:38] [DOC: 9177663] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[22:09:38] [DOC: 9177663] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[22:09:38] [DOC: 9177663] ✅ Patient date processing completed successfully
[22:09:38] ✅    ✅ Date processing completed
[22:09:38] 📊 Processed Patient Data
     └─ patientFName: Lillian
     └─ patientLName: Vieira
     └─ dob: 04/10/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3070136
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N30.00', 'thirdDiagnosis': 'K80.50', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'E80.6', 'sixthDiagnosis': 'R74.01'}]
[22:09:38] 🔄 
🔄 Step 4: Extracting order data...
[22:09:41] ℹ️  Order extraction - MRN: '3070136'
[22:09:41] ℹ️  Order extraction - Sex: 'FEMALE'
[22:09:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[22:09:41] ℹ️  Order extraction - Payer Source: ''
[22:09:41] ✅ Order data extraction completed successfully
[22:09:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:09:41] ℹ️  Using MRN from patient data: '3070136' over '3070136'
[22:09:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[22:09:41] ✅ Patient name cross-validation successful
[22:09:41] ✅    ✅ Data merged successfully
[22:09:42] ✅    ✅ Order data extracted and validated
[22:09:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:10:37] [DOC: 9177663] ℹ️  Patient not found in cache or API: Lillian Vieira
[22:10:37] [DOC: 9177663] ℹ️  Patient not found, creating new patient via API...
[22:10:37] [DOC: 9177663] ℹ️  Creating patient via API: Lillian Vieira
[22:10:39] [DOC: 9177663] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:10:39] ❌    ❌ Failed to create patient
[22:10:39] [DOC: 9177663] ℹ️  API push details saved for document 9177663
================================================================================
║                        Processing Document ID: 9177659                         ║
================================================================================
[22:10:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:10:39] ℹ️  Date: 03/12/2025
[22:10:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:10:40] [DOC: 9177659] ✅ Text extracted using pdfplumber (2496 chars)
[22:10:40] ✅    ✅ Text extracted using pdfplumber (2496 chars)
[22:10:40] 🔄 
🔄 Step 2: Extracting patient data...
[22:10:42] ℹ️  AI extracted raw sex value: 'M'
[22:10:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:10:42] ℹ️  AI extracted payer source: ''
[22:10:42] ℹ️  AI extracted diagnoses:
[22:10:42] ℹ️    - Diagnosis 1: ''
[22:10:42] ℹ️    - Diagnosis 2: ''
[22:10:42] ℹ️    - Diagnosis 3: ''
[22:10:42] ℹ️    - Diagnosis 4: ''
[22:10:42] ℹ️    - Diagnosis 5: ''
[22:10:42] ℹ️    - Diagnosis 6: ''
[22:10:42] ℹ️  Final extracted MRN: '2868041'
[22:10:42] ℹ️  Final extracted Sex: 'MALE'
[22:10:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:10:42] ℹ️  Final extracted Payer Source: ''
[22:10:42] ✅ Patient data extraction completed successfully
[22:10:42] ✅    ✅ Patient data extracted successfully
[22:10:42] 📊 Patient Response
     └─ patientFName: Kenneth
     └─ patientLName: Power
     └─ dob: 02/14/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 2868041
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:10:42] ✅    ✅ Patient identified: Kenneth Power
[22:10:42] ✅    ✅ Patient name validation passed
[22:10:42] 🔄 
🔄 Step 3: Processing patient dates...
[22:10:42] [DOC: 9177659] ℹ️  DOB normalized: 02/14/1964
[22:10:42] [DOC: 9177659] ✅ Patient date processing completed successfully
[22:10:42] ✅    ✅ Date processing completed
[22:10:42] 📊 Processed Patient Data
     └─ patientFName: Kenneth
     └─ patientLName: Power
     └─ dob: 02/14/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 2868041
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:10:42] 🔄 
🔄 Step 4: Extracting order data...
[22:10:45] ℹ️  Order extraction - MRN: '2868041'
[22:10:45] ℹ️  Order extraction - Sex: 'MALE'
[22:10:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:10:45] ℹ️  Order extraction - Payer Source: ''
[22:10:45] ✅ Order data extraction completed successfully
[22:10:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:10:45] ℹ️  Using MRN from patient data: '2868041' over '2868041'
[22:10:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:10:45] ✅ Patient name cross-validation successful
[22:10:45] ✅    ✅ Data merged successfully
[22:10:46] ✅    ✅ Order data extracted and validated
[22:10:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:10:51] [DOC: 9177659] ℹ️  Patient not found in cache or API: Kenneth Power
[22:10:51] [DOC: 9177659] ℹ️  Patient not found, creating new patient via API...
[22:10:51] [DOC: 9177659] ℹ️  Creating patient via API: Kenneth Power
[22:10:52] [DOC: 9177659] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:10:52] ❌    ❌ Failed to create patient
[22:10:52] [DOC: 9177659] ℹ️  API push details saved for document 9177659
================================================================================
║                        Processing Document ID: 9177658                         ║
================================================================================
[22:10:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:10:52] ℹ️  Date: 03/12/2025
[22:10:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:10:56] [DOC: 9177658] ✅ Text extracted using pdfplumber (26727 chars)
[22:10:56] ✅    ✅ Text extracted using pdfplumber (26727 chars)
[22:10:56] 🔄 
🔄 Step 2: Extracting patient data...
[22:10:59] ℹ️  AI extracted raw sex value: 'M'
[22:10:59] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[22:10:59] ℹ️  AI extracted payer source: ''
[22:10:59] ℹ️  AI extracted diagnoses:
[22:10:59] ℹ️    - Diagnosis 1: 'T81.30XA'
[22:10:59] ℹ️    - Diagnosis 2: 'K25.9'
[22:10:59] ℹ️    - Diagnosis 3: 'F10.921'
[22:10:59] ℹ️    - Diagnosis 4: 'K76.82'
[22:10:59] ℹ️    - Diagnosis 5: 'I10'
[22:10:59] ℹ️    - Diagnosis 6: 'E78.5'
[22:10:59] ℹ️  Final extracted MRN: '2858411'
[22:10:59] ℹ️  Final extracted Sex: 'MALE'
[22:10:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[22:10:59] ℹ️  Final extracted Payer Source: ''
[22:10:59] ✅ Patient data extraction completed successfully
[22:10:59] ✅    ✅ Patient data extracted successfully
[22:10:59] 📊 Patient Response
     └─ patientFName: Alcides
     └─ patientLName: Pires
     └─ dob: 09/11/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 2858411
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'T81.30XA', 'secondDiagnosis': 'K25.9', 'thirdDiagnosis': 'F10.921', 'fourthDiagnosis': 'K76.82', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[22:10:59] ✅    ✅ Patient identified: Alcides Pires
[22:10:59] ✅    ✅ Patient name validation passed
[22:10:59] 🔄 
🔄 Step 3: Processing patient dates...
[22:10:59] [DOC: 9177658] ℹ️  DOB normalized: 09/11/1966
[22:10:59] [DOC: 9177658] ℹ️  Episode startOfCare normalized: 02/28/2025
[22:10:59] [DOC: 9177658] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[22:10:59] [DOC: 9177658] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[22:10:59] [DOC: 9177658] ✅ Patient date processing completed successfully
[22:10:59] ✅    ✅ Date processing completed
[22:10:59] 📊 Processed Patient Data
     └─ patientFName: Alcides
     └─ patientLName: Pires
     └─ dob: 09/11/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 2858411
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'T81.30XA', 'secondDiagnosis': 'K25.9', 'thirdDiagnosis': 'F10.921', 'fourthDiagnosis': 'K76.82', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[22:10:59] 🔄 
🔄 Step 4: Extracting order data...
[22:11:02] ℹ️  Order extraction - MRN: '2858411'
[22:11:02] ℹ️  Order extraction - Sex: 'MALE'
[22:11:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[22:11:02] ℹ️  Order extraction - Payer Source: ''
[22:11:02] ✅ Order data extraction completed successfully
[22:11:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:11:02] ℹ️  Using MRN from patient data: '2858411' over '2858411'
[22:11:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[22:11:02] ✅ Patient name cross-validation successful
[22:11:02] ✅    ✅ Data merged successfully
[22:11:03] ✅    ✅ Order data extracted and validated
[22:11:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:11:22] [DOC: 9177658] ℹ️  Patient not found in cache or API: Alcides Pires
[22:11:22] [DOC: 9177658] ℹ️  Patient not found, creating new patient via API...
[22:11:22] [DOC: 9177658] ℹ️  Creating patient via API: Alcides Pires
[22:11:23] [DOC: 9177658] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:11:23] ❌    ❌ Failed to create patient
[22:11:23] [DOC: 9177658] ℹ️  API push details saved for document 9177658
================================================================================
║                        Processing Document ID: 9177647                         ║
================================================================================
[22:11:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:11:23] ℹ️  Date: 03/12/2025
[22:11:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:11:24] [DOC: 9177647] ✅ Text extracted using pdfplumber (1000 chars)
[22:11:24] ✅    ✅ Text extracted using pdfplumber (1000 chars)
[22:11:24] 🔄 
🔄 Step 2: Extracting patient data...
[22:11:27] ℹ️  AI extracted raw sex value: 'M'
[22:11:27] ℹ️  AI extracted service line: 'Physical Therapy'
[22:11:27] ℹ️  AI extracted payer source: ''
[22:11:27] ℹ️  AI extracted diagnoses:
[22:11:27] ℹ️    - Diagnosis 1: ''
[22:11:27] ℹ️    - Diagnosis 2: ''
[22:11:27] ℹ️    - Diagnosis 3: ''
[22:11:27] ℹ️    - Diagnosis 4: ''
[22:11:27] ℹ️    - Diagnosis 5: ''
[22:11:27] ℹ️    - Diagnosis 6: ''
[22:11:27] ℹ️  Final extracted MRN: '2854278'
[22:11:27] ℹ️  Final extracted Sex: 'MALE'
[22:11:27] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:11:27] ℹ️  Final extracted Payer Source: ''
[22:11:27] ✅ Patient data extraction completed successfully
[22:11:27] ✅    ✅ Patient data extracted successfully
[22:11:27] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Pimental
     └─ dob: 10/16/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 2854278
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:11:27] ✅    ✅ Patient identified: Robert Pimental
[22:11:27] ✅    ✅ Patient name validation passed
[22:11:27] 🔄 
🔄 Step 3: Processing patient dates...
[22:11:27] [DOC: 9177647] ℹ️  DOB normalized: 10/16/1938
[22:11:27] [DOC: 9177647] ✅ Patient date processing completed successfully
[22:11:27] ✅    ✅ Date processing completed
[22:11:27] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Pimental
     └─ dob: 10/16/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 2854278
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:11:27] 🔄 
🔄 Step 4: Extracting order data...
[22:11:29] ℹ️  Order extraction - MRN: '2854278'
[22:11:29] ℹ️  Order extraction - Sex: 'MALE'
[22:11:29] ℹ️  Order extraction - Service Line: 'PT'
[22:11:29] ℹ️  Order extraction - Payer Source: ''
[22:11:29] ✅ Order data extraction completed successfully
[22:11:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:11:29] ℹ️  Using MRN from patient data: '2854278' over '2854278'
[22:11:29] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[22:11:29] ✅ Patient name cross-validation successful
[22:11:29] ✅    ✅ Data merged successfully
[22:11:30] ⚠️     ❌ Skipping - missing episode start date
[22:11:30] [DOC: 9177647] ℹ️  API push details saved for document 9177647
================================================================================
║                        Processing Document ID: 9177613                         ║
================================================================================
[22:11:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:11:30] ℹ️  Date: 03/12/2025
[22:11:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:11:35] [DOC: 9177613] ✅ Text extracted using pdfplumber (14618 chars)
[22:11:35] ✅    ✅ Text extracted using pdfplumber (14618 chars)
[22:11:35] 🔄 
🔄 Step 2: Extracting patient data...
[22:11:38] ℹ️  AI extracted raw sex value: 'F'
[22:11:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:11:38] ℹ️  AI extracted payer source: ''
[22:11:38] ℹ️  AI extracted diagnoses:
[22:11:38] ℹ️    - Diagnosis 1: 'A09'
[22:11:38] ℹ️    - Diagnosis 2: 'K59.09'
[22:11:38] ℹ️    - Diagnosis 3: 'J44.9'
[22:11:38] ℹ️    - Diagnosis 4: 'E11.9'
[22:11:38] ℹ️    - Diagnosis 5: 'I69.351'
[22:11:38] ℹ️    - Diagnosis 6: 'I48.0'
[22:11:38] ℹ️  Final extracted MRN: '2761021'
[22:11:38] ℹ️  Final extracted Sex: 'FEMALE'
[22:11:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:11:38] ℹ️  Final extracted Payer Source: ''
[22:11:38] ✅ Patient data extraction completed successfully
[22:11:38] ✅    ✅ Patient data extracted successfully
[22:11:38] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/03/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': 'A09', 'secondDiagnosis': 'K59.09', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I69.351', 'sixthDiagnosis': 'I48.0'}]
[22:11:38] ✅    ✅ Patient identified: Theresa Moniz
[22:11:38] ✅    ✅ Patient name validation passed
[22:11:38] 🔄 
🔄 Step 3: Processing patient dates...
[22:11:38] [DOC: 9177613] ℹ️  DOB normalized: 07/09/1956
[22:11:38] [DOC: 9177613] ℹ️  Episode startOfCare normalized: 03/03/2025
[22:11:38] [DOC: 9177613] ℹ️  Episode startOfEpisode normalized: 03/08/2025
[22:11:38] [DOC: 9177613] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[22:11:38] [DOC: 9177613] ✅ Patient date processing completed successfully
[22:11:38] ✅    ✅ Date processing completed
[22:11:38] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/03/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': 'A09', 'secondDiagnosis': 'K59.09', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I69.351', 'sixthDiagnosis': 'I48.0'}]
[22:11:38] 🔄 
🔄 Step 4: Extracting order data...
[22:11:41] ℹ️  Order extraction - MRN: '2761021'
[22:11:41] ℹ️  Order extraction - Sex: 'FEMALE'
[22:11:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:11:41] ℹ️  Order extraction - Payer Source: ''
[22:11:41] ✅ Order data extraction completed successfully
[22:11:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:11:41] ℹ️  Using MRN from patient data: '2761021' over '2761021'
[22:11:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:11:41] ✅ Patient name cross-validation successful
[22:11:41] ✅    ✅ Data merged successfully
[22:11:44] ✅    ✅ Order data extracted and validated
[22:11:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:11:55] [DOC: 9177613] ℹ️  Patient not found in cache or API: Theresa Moniz
[22:11:55] [DOC: 9177613] ℹ️  Patient not found, creating new patient via API...
[22:11:55] [DOC: 9177613] ℹ️  Creating patient via API: Theresa Moniz
[22:11:56] [DOC: 9177613] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:11:56] ❌    ❌ Failed to create patient
[22:11:56] [DOC: 9177613] ℹ️  API push details saved for document 9177613
================================================================================
║                        Processing Document ID: 9177609                         ║
================================================================================
[22:11:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:11:56] ℹ️  Date: 03/12/2025
[22:11:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:11:59] [DOC: 9177609] ✅ Text extracted using pdfplumber (15629 chars)
[22:11:59] ✅    ✅ Text extracted using pdfplumber (15629 chars)
[22:11:59] 🔄 
🔄 Step 2: Extracting patient data...
[22:12:02] ℹ️  AI extracted raw sex value: 'Female'
[22:12:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:12:02] ℹ️  AI extracted payer source: ''
[22:12:02] ℹ️  AI extracted diagnoses:
[22:12:02] ℹ️    - Diagnosis 1: 'Z48.3'
[22:12:02] ℹ️    - Diagnosis 2: 'C50.912'
[22:12:02] ℹ️    - Diagnosis 3: 'Z90.12'
[22:12:02] ℹ️    - Diagnosis 4: 'E03.9'
[22:12:02] ℹ️    - Diagnosis 5: 'J44.89'
[22:12:02] ℹ️    - Diagnosis 6: 'E78.5'
[22:12:02] ℹ️  Final extracted MRN: '2734515'
[22:12:02] ℹ️  Final extracted Sex: 'FEMALE'
[22:12:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:12:02] ℹ️  Final extracted Payer Source: ''
[22:12:02] ✅ Patient data extraction completed successfully
[22:12:02] ✅    ✅ Patient data extracted successfully
[22:12:02] 📊 Patient Response
     └─ patientFName: Ruth
     └─ patientLName: Medeiros
     └─ dob: 03/28/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2734515
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'Z48.3', 'secondDiagnosis': 'C50.912', 'thirdDiagnosis': 'Z90.12', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'E78.5'}]
[22:12:02] ✅    ✅ Patient identified: Ruth Medeiros
[22:12:02] ✅    ✅ Patient name validation passed
[22:12:02] 🔄 
🔄 Step 3: Processing patient dates...
[22:12:02] [DOC: 9177609] ℹ️  DOB normalized: 03/28/1957
[22:12:02] [DOC: 9177609] ℹ️  Episode startOfCare normalized: 03/01/2025
[22:12:02] [DOC: 9177609] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[22:12:02] [DOC: 9177609] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[22:12:02] [DOC: 9177609] ✅ Patient date processing completed successfully
[22:12:02] ✅    ✅ Date processing completed
[22:12:02] 📊 Processed Patient Data
     └─ patientFName: Ruth
     └─ patientLName: Medeiros
     └─ dob: 03/28/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2734515
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'Z48.3', 'secondDiagnosis': 'C50.912', 'thirdDiagnosis': 'Z90.12', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'E78.5'}]
[22:12:02] 🔄 
🔄 Step 4: Extracting order data...
[22:12:05] ℹ️  Order extraction - MRN: '2734515'
[22:12:05] ℹ️  Order extraction - Sex: 'FEMALE'
[22:12:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:12:05] ℹ️  Order extraction - Payer Source: ''
[22:12:05] ✅ Order data extraction completed successfully
[22:12:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:12:05] ℹ️  Using MRN from patient data: '2734515' over '2734515'
[22:12:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:12:05] ✅ Patient name cross-validation successful
[22:12:05] ✅    ✅ Data merged successfully
[22:12:06] ✅    ✅ Order data extracted and validated
[22:12:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:12:11] [DOC: 9177609] ✅ Patient exists in API: Ruth Medeiros, ID: 6563e7b0-8499-460b-bf13-1272cac8fe12
[22:12:11] ✅    ✅ Existing patient found with ID: 6563e7b0-8499-460b-bf13-1272cac8fe12
[22:12:11] 🔄 
🔄 Step 6: Pushing order to API...
[22:12:11] [DOC: 9177609] ℹ️  Pushing order via API for patient ID: 6563e7b0-8499-460b-bf13-1272cac8fe12
[22:12:12] [DOC: 9177609] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13344"}
[22:12:12] ❌    ❌ Failed to push order
[22:12:12] 🔄 
🔄 Step 7: Writing to CSV...
[22:12:12] [DOC: 9177609] ℹ️  Calculated age: 68 from DOB: 03/28/1957
[22:12:12] [DOC: 9177609] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:12:12] [DOC: 9177609] ℹ️  Payer Source extracted: ''
[22:12:12] [DOC: 9177609] ℹ️  Diagnosis codes being written:
[22:12:12] [DOC: 9177609] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.3'
[22:12:12] [DOC: 9177609] ℹ️    - Latest_Episode_Seconddiagnosis: 'C50.912'
[22:12:12] [DOC: 9177609] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z90.12'
[22:12:12] [DOC: 9177609] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.9'
[22:12:12] [DOC: 9177609] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.89'
[22:12:12] [DOC: 9177609] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[22:12:12] [DOC: 9177609] ✅ Patient data written to CSV: Ruth Medeiros | Sex: FEMALE | Age: 68 | Service: Skilled Nursing | Payer:  | MRN: 2734515
[22:12:12] ✅    ✅ Document 9177609 processed and saved successfully
[22:12:12] 🔄 
🔄 Step 8: Saving API details...
[22:12:12] [DOC: 9177609] ℹ️  API push details saved for document 9177609
[22:12:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177589                         ║
================================================================================
[22:12:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:12:12] ℹ️  Date: 03/12/2025
[22:12:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:12:15] [DOC: 9177589] ✅ Text extracted using pdfplumber (11513 chars)
[22:12:15] ✅    ✅ Text extracted using pdfplumber (11513 chars)
[22:12:15] 🔄 
🔄 Step 2: Extracting patient data...
[22:12:18] ℹ️  AI extracted raw sex value: 'Male'
[22:12:18] ℹ️  AI extracted service line: 'Physical Therapy, Skilled nursing'
[22:12:18] ℹ️  AI extracted payer source: ''
[22:12:18] ℹ️  AI extracted diagnoses:
[22:12:18] ℹ️    - Diagnosis 1: 'S22.42XD'
[22:12:18] ℹ️    - Diagnosis 2: 'K20.80'
[22:12:18] ℹ️    - Diagnosis 3: 'F10.120'
[22:12:18] ℹ️    - Diagnosis 4: 'I48.91'
[22:12:18] ℹ️    - Diagnosis 5: 'I10'
[22:12:18] ℹ️    - Diagnosis 6: 'G47.33'
[22:12:18] ℹ️  Final extracted MRN: '2690381'
[22:12:18] ℹ️  Final extracted Sex: 'MALE'
[22:12:18] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled nursing'
[22:12:18] ℹ️  Final extracted Payer Source: ''
[22:12:18] ✅ Patient data extraction completed successfully
[22:12:18] ✅    ✅ Patient data extracted successfully
[22:12:18] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Maloney
     └─ dob: 10/05/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2690381
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'S22.42XD', 'secondDiagnosis': 'K20.80', 'thirdDiagnosis': 'F10.120', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G47.33'}]
[22:12:18] ✅    ✅ Patient identified: John Maloney
[22:12:18] ✅    ✅ Patient name validation passed
[22:12:18] 🔄 
🔄 Step 3: Processing patient dates...
[22:12:18] [DOC: 9177589] ℹ️  DOB normalized: 10/05/1944
[22:12:18] [DOC: 9177589] ℹ️  Episode startOfCare normalized: 03/01/2025
[22:12:18] [DOC: 9177589] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[22:12:18] [DOC: 9177589] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[22:12:18] [DOC: 9177589] ✅ Patient date processing completed successfully
[22:12:18] ✅    ✅ Date processing completed
[22:12:18] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Maloney
     └─ dob: 10/05/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2690381
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': 'S22.42XD', 'secondDiagnosis': 'K20.80', 'thirdDiagnosis': 'F10.120', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G47.33'}]
[22:12:18] 🔄 
🔄 Step 4: Extracting order data...
[22:12:21] ℹ️  Order extraction - MRN: '2690381'
[22:12:21] ℹ️  Order extraction - Sex: 'MALE'
[22:12:21] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[22:12:21] ℹ️  Order extraction - Payer Source: ''
[22:12:21] ✅ Order data extraction completed successfully
[22:12:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:12:21] ℹ️  Using MRN from patient data: '2690381' over '2690381'
[22:12:21] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled nursing'
[22:12:21] ✅ Patient name cross-validation successful
[22:12:21] ✅    ✅ Data merged successfully
[22:12:22] ✅    ✅ Order data extracted and validated
[22:12:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:12:53] [DOC: 9177589] ℹ️  Patient not found in cache or API: John Maloney
[22:12:53] [DOC: 9177589] ℹ️  Patient not found, creating new patient via API...
[22:12:53] [DOC: 9177589] ℹ️  Creating patient via API: John Maloney
[22:12:54] [DOC: 9177589] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:12:54] ❌    ❌ Failed to create patient
[22:12:54] [DOC: 9177589] ℹ️  API push details saved for document 9177589
================================================================================
║                        Processing Document ID: 9177586                         ║
================================================================================
[22:12:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:12:54] ℹ️  Date: 03/12/2025
[22:12:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:12:55] [DOC: 9177586] ✅ Text extracted using pdfplumber (1253 chars)
[22:12:55] ✅    ✅ Text extracted using pdfplumber (1253 chars)
[22:12:55] 🔄 
🔄 Step 2: Extracting patient data...
[22:12:58] ℹ️  AI extracted raw sex value: 'F'
[22:12:58] ℹ️  AI extracted service line: 'Physical Therapy'
[22:12:58] ℹ️  AI extracted payer source: ''
[22:12:58] ℹ️  AI extracted diagnoses:
[22:12:58] ℹ️    - Diagnosis 1: 'None'
[22:12:58] ℹ️    - Diagnosis 2: 'None'
[22:12:58] ℹ️    - Diagnosis 3: 'None'
[22:12:58] ℹ️    - Diagnosis 4: 'None'
[22:12:58] ℹ️    - Diagnosis 5: 'None'
[22:12:58] ℹ️    - Diagnosis 6: 'None'
[22:12:58] ℹ️  Final extracted MRN: '2689758'
[22:12:58] ℹ️  Final extracted Sex: 'FEMALE'
[22:12:58] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:12:58] ℹ️  Final extracted Payer Source: ''
[22:12:58] ✅ Patient data extraction completed successfully
[22:12:58] ✅    ✅ Patient data extracted successfully
[22:12:58] 📊 Patient Response
     └─ patientFName: Darlene
     └─ patientLName: Mallen
     └─ dob: 07/06/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2689758
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:12:58] ✅    ✅ Patient identified: Darlene Mallen
[22:12:58] ✅    ✅ Patient name validation passed
[22:12:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:12:58] [DOC: 9177586] ℹ️  DOB normalized: 07/06/1967
[22:12:58] [DOC: 9177586] ✅ Patient date processing completed successfully
[22:12:58] ✅    ✅ Date processing completed
[22:12:58] 📊 Processed Patient Data
     └─ patientFName: Darlene
     └─ patientLName: Mallen
     └─ dob: 07/06/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2689758
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[22:12:58] 🔄 
🔄 Step 4: Extracting order data...
[22:13:00] ℹ️  Order extraction - MRN: '2689758'
[22:13:00] ℹ️  Order extraction - Sex: 'FEMALE'
[22:13:00] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:13:00] ℹ️  Order extraction - Payer Source: ''
[22:13:00] ✅ Order data extraction completed successfully
[22:13:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:13:00] ℹ️  Using MRN from patient data: '2689758' over '2689758'
[22:13:00] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:13:00] ✅ Patient name cross-validation successful
[22:13:00] ✅    ✅ Data merged successfully
[22:13:01] ✅    ✅ Order data extracted and validated
[22:13:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:13:19] [DOC: 9177586] ℹ️  Patient not found in cache or API: Darlene Mallen
[22:13:19] [DOC: 9177586] ℹ️  Patient not found, creating new patient via API...
[22:13:19] [DOC: 9177586] ℹ️  Creating patient via API: Darlene Mallen
[22:13:22] [DOC: 9177586] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:13:22] ❌    ❌ Failed to create patient
[22:13:22] [DOC: 9177586] ℹ️  API push details saved for document 9177586
================================================================================
║                        Processing Document ID: 9177584                         ║
================================================================================
[22:13:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:13:22] ℹ️  Date: 03/12/2025
[22:13:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:13:26] [DOC: 9177584] ✅ Text extracted using pdfplumber (22795 chars)
[22:13:26] ✅    ✅ Text extracted using pdfplumber (22783 chars)
[22:13:26] 🔄 
🔄 Step 2: Extracting patient data...
[22:13:29] ℹ️  AI extracted raw sex value: 'Female'
[22:13:29] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:13:29] ℹ️  AI extracted payer source: ''
[22:13:29] ℹ️  AI extracted diagnoses:
[22:13:29] ℹ️    - Diagnosis 1: 'D62'
[22:13:29] ℹ️    - Diagnosis 2: 'S70.12XD'
[22:13:29] ℹ️    - Diagnosis 3: 'D69.3'
[22:13:29] ℹ️    - Diagnosis 4: 'I11.0'
[22:13:29] ℹ️    - Diagnosis 5: 'I50.30'
[22:13:29] ℹ️    - Diagnosis 6: 'I71.40'
[22:13:29] ℹ️  Final extracted MRN: '2104551'
[22:13:29] ℹ️  Final extracted Sex: 'FEMALE'
[22:13:29] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:13:29] ℹ️  Final extracted Payer Source: ''
[22:13:29] ✅ Patient data extraction completed successfully
[22:13:29] ✅    ✅ Patient data extracted successfully
[22:13:29] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: Keough
     └─ dob: 06/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104551
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'D62', 'secondDiagnosis': 'S70.12XD', 'thirdDiagnosis': 'D69.3', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.30', 'sixthDiagnosis': 'I71.40'}]
[22:13:29] ✅    ✅ Patient identified: Jacqueline Keough
[22:13:29] ✅    ✅ Patient name validation passed
[22:13:29] 🔄 
🔄 Step 3: Processing patient dates...
[22:13:29] [DOC: 9177584] ℹ️  DOB normalized: 06/29/1942
[22:13:29] [DOC: 9177584] ℹ️  Episode startOfCare normalized: 02/25/2025
[22:13:29] [DOC: 9177584] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[22:13:29] [DOC: 9177584] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[22:13:29] [DOC: 9177584] ✅ Patient date processing completed successfully
[22:13:29] ✅    ✅ Date processing completed
[22:13:29] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: Keough
     └─ dob: 06/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104551
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'D62', 'secondDiagnosis': 'S70.12XD', 'thirdDiagnosis': 'D69.3', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.30', 'sixthDiagnosis': 'I71.40'}]
[22:13:29] 🔄 
🔄 Step 4: Extracting order data...
[22:13:32] ℹ️  Order extraction - MRN: '2104551'
[22:13:32] ℹ️  Order extraction - Sex: 'FEMALE'
[22:13:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:13:32] ℹ️  Order extraction - Payer Source: ''
[22:13:32] ✅ Order data extraction completed successfully
[22:13:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:13:32] ℹ️  Using MRN from patient data: '2104551' over '2104551'
[22:13:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:13:32] ✅ Patient name cross-validation successful
[22:13:32] ✅    ✅ Data merged successfully
[22:13:33] ✅    ✅ Order data extracted and validated
[22:13:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:13:33] [DOC: 9177584] ✅ Patient found in local cache: Jacqueline Keough, ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[22:13:33] ✅    ✅ Existing patient found with ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[22:13:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:13:33] [DOC: 9177584] ℹ️  Pushing order via API for patient ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[22:13:34] [DOC: 9177584] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13103"}
[22:13:34] ❌    ❌ Failed to push order
[22:13:34] 🔄 
🔄 Step 7: Writing to CSV...
[22:13:34] [DOC: 9177584] ℹ️  Calculated age: 82 from DOB: 06/29/1942
[22:13:34] [DOC: 9177584] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:13:34] [DOC: 9177584] ℹ️  Payer Source extracted: ''
[22:13:34] [DOC: 9177584] ℹ️  Diagnosis codes being written:
[22:13:34] [DOC: 9177584] ℹ️    - Latest_Episode_Firstdiagnosis: 'D62'
[22:13:34] [DOC: 9177584] ℹ️    - Latest_Episode_Seconddiagnosis: 'S70.12XD'
[22:13:34] [DOC: 9177584] ℹ️    - Latest_Episode_Thirddiagnosis: 'D69.3'
[22:13:34] [DOC: 9177584] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[22:13:34] [DOC: 9177584] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.30'
[22:13:34] [DOC: 9177584] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I71.40'
[22:13:34] [DOC: 9177584] ✅ Patient data written to CSV: Jacqueline Keough | Sex: FEMALE | Age: 82 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2104551
[22:13:34] ✅    ✅ Document 9177584 processed and saved successfully
[22:13:34] 🔄 
🔄 Step 8: Saving API details...
[22:13:34] [DOC: 9177584] ℹ️  API push details saved for document 9177584
[22:13:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177568                         ║
================================================================================
[22:13:34] ℹ️  Agency: AccentCare Fall River
[22:13:34] ℹ️  Date: 03/12/2025
[22:13:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:13:55] [DOC: 9177568] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[22:14:08] [DOC: 9177568] ✅ Text extracted using tesseract_ocr (20560 chars)
[22:14:08] ✅    ✅ Text extracted using tesseract_ocr (20528 chars)
[22:14:08] 🔄 
🔄 Step 2: Extracting patient data...
[22:14:11] ℹ️  AI extracted raw sex value: 'F'
[22:14:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:14:11] ℹ️  AI extracted payer source: ''
[22:14:11] ℹ️  AI extracted diagnoses:
[22:14:11] ℹ️    - Diagnosis 1: 'N39.0'
[22:14:11] ℹ️    - Diagnosis 2: 'I10'
[22:14:11] ℹ️    - Diagnosis 3: 'I25.10'
[22:14:11] ℹ️    - Diagnosis 4: 'C83.30'
[22:14:11] ℹ️    - Diagnosis 5: 'K76.0'
[22:14:11] ℹ️    - Diagnosis 6: 'K21.9'
[22:14:11] ℹ️  Final extracted MRN: 'C0200117976701'
[22:14:11] ℹ️  Final extracted Sex: 'FEMALE'
[22:14:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:14:11] ℹ️  Final extracted Payer Source: ''
[22:14:11] ✅ Patient data extraction completed successfully
[22:14:11] ✅    ✅ Patient data extracted successfully
[22:14:11] 📊 Patient Response
     └─ patientFName: LISA
     └─ patientLName: MEDEIROS
     └─ dob: 11/03/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200117976701
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 1053304469
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/25/2025', 'startOfEpisode': '01/25/2025', 'endOfEpisode': None, 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'C83.30', 'fifthDiagnosis': 'K76.0', 'sixthDiagnosis': 'K21.9'}]
[22:14:11] ✅    ✅ Patient identified: LISA MEDEIROS
[22:14:11] ✅    ✅ Patient name validation passed
[22:14:11] 🔄 
🔄 Step 3: Processing patient dates...
[22:14:11] [DOC: 9177568] ℹ️  DOB normalized: 11/03/1967
[22:14:11] [DOC: 9177568] ℹ️  Episode startOfCare normalized: 01/25/2025
[22:14:11] [DOC: 9177568] ℹ️  Episode startOfEpisode normalized: 01/25/2025
[22:14:11] [DOC: 9177568] ✅ Patient date processing completed successfully
[22:14:11] ✅    ✅ Date processing completed
[22:14:11] 📊 Processed Patient Data
     └─ patientFName: LISA
     └─ patientLName: MEDEIROS
     └─ dob: 11/03/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200117976701
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 1053304469
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/25/2025', 'startOfEpisode': '01/25/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'C83.30', 'fifthDiagnosis': 'K76.0', 'sixthDiagnosis': 'K21.9'}]
[22:14:11] 🔄 
🔄 Step 4: Extracting order data...
[22:14:14] ℹ️  Order extraction - MRN: 'C0200117976701'
[22:14:14] ℹ️  Order extraction - Sex: 'FEMALE'
[22:14:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:14:14] ℹ️  Order extraction - Payer Source: ''
[22:14:14] ✅ Order data extraction completed successfully
[22:14:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:14:14] ℹ️  Using MRN from patient data: 'C0200117976701' over 'C0200117976701'
[22:14:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:14:14] ✅ Patient name cross-validation successful
[22:14:14] ✅    ✅ Data merged successfully
[22:14:15] ✅    ✅ Order data extracted and validated
[22:14:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:14:28] [DOC: 9177568] ℹ️  Patient not found in cache or API: LISA MEDEIROS
[22:14:28] [DOC: 9177568] ℹ️  Patient not found, creating new patient via API...
[22:14:28] [DOC: 9177568] ℹ️  Creating patient via API: LISA MEDEIROS
[22:14:29] [DOC: 9177568] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:14:29] ❌    ❌ Failed to create patient
[22:14:29] [DOC: 9177568] ℹ️  API push details saved for document 9177568
================================================================================
║                        Processing Document ID: 9177566                         ║
================================================================================
[22:14:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:14:29] ℹ️  Date: 03/12/2025
[22:14:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:14:31] [DOC: 9177566] ✅ Text extracted using pdfplumber (16015 chars)
[22:14:31] ✅    ✅ Text extracted using pdfplumber (16015 chars)
[22:14:31] 🔄 
🔄 Step 2: Extracting patient data...
[22:14:35] ℹ️  AI extracted raw sex value: 'Female'
[22:14:35] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[22:14:35] ℹ️  AI extracted payer source: ''
[22:14:35] ℹ️  AI extracted diagnoses:
[22:14:35] ℹ️    - Diagnosis 1: 'S32.511D'
[22:14:35] ℹ️    - Diagnosis 2: 'W19.XXXD'
[22:14:35] ℹ️    - Diagnosis 3: 'I10'
[22:14:35] ℹ️    - Diagnosis 4: 'E78.5'
[22:14:35] ℹ️    - Diagnosis 5: 'K75.4'
[22:14:35] ℹ️    - Diagnosis 6: 'E21.0'
[22:14:35] ℹ️  Final extracted MRN: '2120086'
[22:14:35] ℹ️  Final extracted Sex: 'FEMALE'
[22:14:35] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[22:14:35] ℹ️  Final extracted Payer Source: ''
[22:14:35] ✅ Patient data extraction completed successfully
[22:14:35] ✅    ✅ Patient data extracted successfully
[22:14:35] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'S32.511D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'K75.4', 'sixthDiagnosis': 'E21.0'}]
[22:14:35] ✅    ✅ Patient identified: Elaine Dupont
[22:14:35] ✅    ✅ Patient name validation passed
[22:14:35] 🔄 
🔄 Step 3: Processing patient dates...
[22:14:35] [DOC: 9177566] ℹ️  DOB normalized: 09/06/1942
[22:14:35] [DOC: 9177566] ℹ️  Episode startOfCare normalized: 03/01/2025
[22:14:35] [DOC: 9177566] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[22:14:35] [DOC: 9177566] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[22:14:35] [DOC: 9177566] ✅ Patient date processing completed successfully
[22:14:35] ✅    ✅ Date processing completed
[22:14:35] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'S32.511D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'K75.4', 'sixthDiagnosis': 'E21.0'}]
[22:14:35] 🔄 
🔄 Step 4: Extracting order data...
[22:14:38] ℹ️  Order extraction - MRN: '2120086'
[22:14:38] ℹ️  Order extraction - Sex: 'FEMALE'
[22:14:38] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[22:14:38] ℹ️  Order extraction - Payer Source: ''
[22:14:38] ✅ Order data extraction completed successfully
[22:14:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:14:38] ℹ️  Using MRN from patient data: '2120086' over '2120086'
[22:14:38] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[22:14:38] ✅ Patient name cross-validation successful
[22:14:38] ✅    ✅ Data merged successfully
[22:14:39] ✅    ✅ Order data extracted and validated
[22:14:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:14:46] [DOC: 9177566] ℹ️  Patient not found in cache or API: Elaine Dupont
[22:14:46] [DOC: 9177566] ℹ️  Patient not found, creating new patient via API...
[22:14:46] [DOC: 9177566] ℹ️  Creating patient via API: Elaine Dupont
[22:14:49] [DOC: 9177566] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:14:49] ❌    ❌ Failed to create patient
[22:14:49] [DOC: 9177566] ℹ️  API push details saved for document 9177566
================================================================================
║                        Processing Document ID: 9177553                         ║
================================================================================
[22:14:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:14:49] ℹ️  Date: 03/12/2025
[22:14:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:14:50] [DOC: 9177553] ✅ Text extracted using pdfplumber (969 chars)
[22:14:50] ✅    ✅ Text extracted using pdfplumber (969 chars)
[22:14:50] 🔄 
🔄 Step 2: Extracting patient data...
[22:14:53] ℹ️  AI extracted raw sex value: 'F'
[22:14:53] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:14:53] ℹ️  AI extracted payer source: ''
[22:14:53] ℹ️  AI extracted diagnoses:
[22:14:53] ℹ️    - Diagnosis 1: ''
[22:14:53] ℹ️    - Diagnosis 2: ''
[22:14:53] ℹ️    - Diagnosis 3: ''
[22:14:53] ℹ️    - Diagnosis 4: ''
[22:14:53] ℹ️    - Diagnosis 5: ''
[22:14:53] ℹ️    - Diagnosis 6: ''
[22:14:53] ℹ️  Final extracted MRN: '2261397'
[22:14:53] ℹ️  Final extracted Sex: 'FEMALE'
[22:14:53] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:14:53] ℹ️  Final extracted Payer Source: ''
[22:14:53] ✅ Patient data extraction completed successfully
[22:14:53] ✅    ✅ Patient data extracted successfully
[22:14:53] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bowden
     └─ dob: 11/20/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2261397
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:14:53] ✅    ✅ Patient identified: Pauline Bowden
[22:14:53] ✅    ✅ Patient name validation passed
[22:14:53] 🔄 
🔄 Step 3: Processing patient dates...
[22:14:53] [DOC: 9177553] ℹ️  DOB normalized: 11/20/1957
[22:14:53] [DOC: 9177553] ✅ Patient date processing completed successfully
[22:14:53] ✅    ✅ Date processing completed
[22:14:53] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bowden
     └─ dob: 11/20/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2261397
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:14:53] 🔄 
🔄 Step 4: Extracting order data...
[22:14:55] ℹ️  Order extraction - MRN: '2261397'
[22:14:55] ℹ️  Order extraction - Sex: 'FEMALE'
[22:14:55] ℹ️  Order extraction - Service Line: ''
[22:14:55] ℹ️  Order extraction - Payer Source: ''
[22:14:55] ✅ Order data extraction completed successfully
[22:14:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:14:55] ℹ️  Using MRN from patient data: '2261397' over '2261397'
[22:14:55] ℹ️  Using service line from patient data: 'Occupational Therapy'
[22:14:55] ✅ Patient name cross-validation successful
[22:14:55] ✅    ✅ Data merged successfully
[22:14:56] ⚠️     ❌ Skipping - missing episode start date
[22:14:56] [DOC: 9177553] ℹ️  API push details saved for document 9177553
================================================================================
║                        Processing Document ID: 9177551                         ║
================================================================================
[22:14:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:14:56] ℹ️  Date: 03/12/2025
[22:14:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:14:59] [DOC: 9177551] ✅ Text extracted using pdfplumber (21295 chars)
[22:14:59] ✅    ✅ Text extracted using pdfplumber (21295 chars)
[22:14:59] 🔄 
🔄 Step 2: Extracting patient data...
[22:15:02] ℹ️  AI extracted raw sex value: 'F'
[22:15:02] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:15:02] ℹ️  AI extracted payer source: ''
[22:15:02] ℹ️  AI extracted diagnoses:
[22:15:02] ℹ️    - Diagnosis 1: 'I61.8'
[22:15:02] ℹ️    - Diagnosis 2: 'I16.1'
[22:15:02] ℹ️    - Diagnosis 3: 'I10'
[22:15:02] ℹ️    - Diagnosis 4: 'E11.9'
[22:15:02] ℹ️    - Diagnosis 5: 'F32.A'
[22:15:02] ℹ️    - Diagnosis 6: 'Z79.84'
[22:15:02] ℹ️  Final extracted MRN: '2216273'
[22:15:02] ℹ️  Final extracted Sex: 'FEMALE'
[22:15:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:15:02] ℹ️  Final extracted Payer Source: ''
[22:15:02] ✅ Patient data extraction completed successfully
[22:15:02] ✅    ✅ Patient data extracted successfully
[22:15:02] 📊 Patient Response
     └─ patientFName: Silvana
     └─ patientLName: Barbosa
     └─ dob: 04/14/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2216273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'I61.8', 'secondDiagnosis': 'I16.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'Z79.84'}]
[22:15:02] ✅    ✅ Patient identified: Silvana Barbosa
[22:15:02] ✅    ✅ Patient name validation passed
[22:15:02] 🔄 
🔄 Step 3: Processing patient dates...
[22:15:02] [DOC: 9177551] ℹ️  DOB normalized: 04/14/1949
[22:15:02] [DOC: 9177551] ℹ️  Episode startOfCare normalized: 03/02/2025
[22:15:02] [DOC: 9177551] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[22:15:02] [DOC: 9177551] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[22:15:02] [DOC: 9177551] ✅ Patient date processing completed successfully
[22:15:02] ✅    ✅ Date processing completed
[22:15:02] 📊 Processed Patient Data
     └─ patientFName: Silvana
     └─ patientLName: Barbosa
     └─ dob: 04/14/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2216273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'I61.8', 'secondDiagnosis': 'I16.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'Z79.84'}]
[22:15:02] 🔄 
🔄 Step 4: Extracting order data...
[22:15:05] ℹ️  Order extraction - MRN: '2216273'
[22:15:05] ℹ️  Order extraction - Sex: 'FEMALE'
[22:15:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[22:15:05] ℹ️  Order extraction - Payer Source: ''
[22:15:05] ✅ Order data extraction completed successfully
[22:15:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:15:05] ℹ️  Using MRN from patient data: '2216273' over '2216273'
[22:15:05] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[22:15:05] ✅ Patient name cross-validation successful
[22:15:05] ✅    ✅ Data merged successfully
[22:15:07] ✅    ✅ Order data extracted and validated
[22:15:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:15:14] [DOC: 9177551] ✅ Patient exists in API: Silvana Barbosa, ID: 480bcb5d-b094-4af3-94fb-7fc3d5ff433c
[22:15:14] ✅    ✅ Existing patient found with ID: 480bcb5d-b094-4af3-94fb-7fc3d5ff433c
[22:15:14] 🔄 
🔄 Step 6: Pushing order to API...
[22:15:14] [DOC: 9177551] ℹ️  Pushing order via API for patient ID: 480bcb5d-b094-4af3-94fb-7fc3d5ff433c
[22:15:15] [DOC: 9177551] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13000"}
[22:15:15] ❌    ❌ Failed to push order
[22:15:15] 🔄 
🔄 Step 7: Writing to CSV...
[22:15:15] [DOC: 9177551] ℹ️  Calculated age: 76 from DOB: 04/14/1949
[22:15:15] [DOC: 9177551] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[22:15:15] [DOC: 9177551] ℹ️  Payer Source extracted: ''
[22:15:15] [DOC: 9177551] ℹ️  Diagnosis codes being written:
[22:15:15] [DOC: 9177551] ℹ️    - Latest_Episode_Firstdiagnosis: 'I61.8'
[22:15:15] [DOC: 9177551] ℹ️    - Latest_Episode_Seconddiagnosis: 'I16.1'
[22:15:15] [DOC: 9177551] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:15:15] [DOC: 9177551] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[22:15:15] [DOC: 9177551] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.A'
[22:15:15] [DOC: 9177551] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z79.84'
[22:15:15] [DOC: 9177551] ✅ Patient data written to CSV: Silvana Barbosa | Sex: FEMALE | Age: 76 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2216273
[22:15:15] ✅    ✅ Document 9177551 processed and saved successfully
[22:15:15] 🔄 
🔄 Step 8: Saving API details...
[22:15:15] [DOC: 9177551] ℹ️  API push details saved for document 9177551
[22:15:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177512                         ║
================================================================================
[22:15:15] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[22:15:15] ℹ️  Date: 03/12/2025
[22:15:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:15:25] [DOC: 9177512] ✅ Text extracted using pdfplumber (1455 chars)
[22:15:25] ✅    ✅ Text extracted using pdfplumber (1455 chars)
[22:15:25] 🔄 
🔄 Step 2: Extracting patient data...
[22:15:28] ℹ️  AI extracted raw sex value: 'M'
[22:15:28] ℹ️  AI extracted service line: 'HHA'
[22:15:28] ℹ️  AI extracted payer source: 'Medicaid/MA'
[22:15:28] ℹ️  AI extracted diagnoses:
[22:15:28] ℹ️    - Diagnosis 1: ''
[22:15:28] ℹ️    - Diagnosis 2: ''
[22:15:28] ℹ️    - Diagnosis 3: ''
[22:15:28] ℹ️    - Diagnosis 4: ''
[22:15:28] ℹ️    - Diagnosis 5: ''
[22:15:28] ℹ️    - Diagnosis 6: ''
[22:15:28] ℹ️  Final extracted MRN: '343005'
[22:15:28] ℹ️  Final extracted Sex: 'MALE'
[22:15:28] ℹ️  Final extracted Service Line: 'HHA'
[22:15:28] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[22:15:28] ✅ Patient data extraction completed successfully
[22:15:28] ✅    ✅ Patient data extracted successfully
[22:15:28] 📊 Patient Response
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:15:28] ✅    ✅ Patient identified: Kevin Livramento
[22:15:28] ✅    ✅ Patient name validation passed
[22:15:28] 🔄 
🔄 Step 3: Processing patient dates...
[22:15:28] [DOC: 9177512] ℹ️  DOB normalized: 08/25/1966
[22:15:28] [DOC: 9177512] ℹ️  Episode startOfCare normalized: 09/27/2022
[22:15:28] [DOC: 9177512] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[22:15:28] [DOC: 9177512] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[22:15:28] [DOC: 9177512] ✅ Patient date processing completed successfully
[22:15:28] ✅    ✅ Date processing completed
[22:15:28] 📊 Processed Patient Data
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:15:28] 🔄 
🔄 Step 4: Extracting order data...
[22:15:30] ℹ️  Order extraction - MRN: '343005'
[22:15:30] ℹ️  Order extraction - Sex: 'MALE'
[22:15:30] ℹ️  Order extraction - Service Line: 'HHA'
[22:15:30] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[22:15:30] ✅ Order data extraction completed successfully
[22:15:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:15:30] ℹ️  Using MRN from patient data: '343005' over '343005'
[22:15:30] ℹ️  Service line consistent in both sources: 'HHA'
[22:15:30] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[22:15:30] ✅ Patient name cross-validation successful
[22:15:30] ✅    ✅ Data merged successfully
[22:15:32] ✅    ✅ Order data extracted and validated
[22:15:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:15:32] [DOC: 9177512] ✅ Patient found in local cache: Kevin Livramento, ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[22:15:32] ✅    ✅ Existing patient found with ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[22:15:32] 🔄 
🔄 Step 6: Pushing order to API...
[22:15:32] [DOC: 9177512] ℹ️  Pushing order via API for patient ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[22:15:33] [DOC: 9177512] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:15:33] ❌    ❌ Failed to push order
[22:15:33] 🔄 
🔄 Step 7: Writing to CSV...
[22:15:33] [DOC: 9177512] ℹ️  Calculated age: 58 from DOB: 08/25/1966
[22:15:33] [DOC: 9177512] ℹ️  Service Line extracted: 'HHA'
[22:15:33] [DOC: 9177512] ℹ️  Payer Source extracted: 'Medicaid/MA'
[22:15:33] [DOC: 9177512] ℹ️  Diagnosis codes being written:
[22:15:33] [DOC: 9177512] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:15:33] [DOC: 9177512] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:15:33] [DOC: 9177512] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:15:33] [DOC: 9177512] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:15:33] [DOC: 9177512] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:15:33] [DOC: 9177512] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:15:33] [DOC: 9177512] ✅ Patient data written to CSV: Kevin Livramento | Sex: MALE | Age: 58 | Service: HHA | Payer: Medicaid/MA | MRN: 343005
[22:15:33] ✅    ✅ Document 9177512 processed and saved successfully
[22:15:33] 🔄 
🔄 Step 8: Saving API details...
[22:15:33] [DOC: 9177512] ℹ️  API push details saved for document 9177512
[22:15:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177475                         ║
================================================================================
[22:15:33] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[22:15:33] ℹ️  Date: 03/12/2025
[22:15:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:15:35] [DOC: 9177475] ✅ Text extracted using pdfplumber (1377 chars)
[22:15:35] ✅    ✅ Text extracted using pdfplumber (1377 chars)
[22:15:35] 🔄 
🔄 Step 2: Extracting patient data...
[22:15:37] ℹ️  AI extracted raw sex value: 'F'
[22:15:37] ℹ️  AI extracted service line: 'HHA'
[22:15:37] ℹ️  AI extracted payer source: 'Senior Whole Health'
[22:15:37] ℹ️  AI extracted diagnoses:
[22:15:37] ℹ️    - Diagnosis 1: ''
[22:15:37] ℹ️    - Diagnosis 2: ''
[22:15:37] ℹ️    - Diagnosis 3: ''
[22:15:37] ℹ️    - Diagnosis 4: ''
[22:15:37] ℹ️    - Diagnosis 5: ''
[22:15:37] ℹ️    - Diagnosis 6: ''
[22:15:37] ℹ️  Final extracted MRN: '283005'
[22:15:37] ℹ️  Final extracted Sex: 'FEMALE'
[22:15:37] ℹ️  Final extracted Service Line: 'HHA'
[22:15:37] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[22:15:37] ✅ Patient data extraction completed successfully
[22:15:37] ✅    ✅ Patient data extracted successfully
[22:15:37] 📊 Patient Response
     └─ patientFName: Fatima
     └─ patientLName: Correia
     └─ dob: 06/30/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 283005
     └─ billingProvider: Gloriane Afonso Fede, MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:15:37] ✅    ✅ Patient identified: Fatima Correia
[22:15:37] ✅    ✅ Patient name validation passed
[22:15:37] 🔄 
🔄 Step 3: Processing patient dates...
[22:15:37] [DOC: 9177475] ℹ️  DOB normalized: 06/30/1942
[22:15:37] [DOC: 9177475] ℹ️  Episode startOfCare normalized: 05/29/2024
[22:15:37] [DOC: 9177475] ℹ️  Episode startOfEpisode normalized: 01/24/2025
[22:15:37] [DOC: 9177475] ℹ️  Episode endOfEpisode normalized: 03/24/2025
[22:15:37] [DOC: 9177475] ✅ Patient date processing completed successfully
[22:15:37] ✅    ✅ Date processing completed
[22:15:37] 📊 Processed Patient Data
     └─ patientFName: Fatima
     └─ patientLName: Correia
     └─ dob: 06/30/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 283005
     └─ billingProvider: Gloriane Afonso Fede, MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:15:37] 🔄 
🔄 Step 4: Extracting order data...
[22:15:40] ℹ️  Order extraction - MRN: '283005'
[22:15:40] ℹ️  Order extraction - Sex: 'FEMALE'
[22:15:40] ℹ️  Order extraction - Service Line: 'HHA'
[22:15:40] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[22:15:40] ✅ Order data extraction completed successfully
[22:15:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:15:40] ℹ️  Using MRN from patient data: '283005' over '283005'
[22:15:40] ℹ️  Service line consistent in both sources: 'HHA'
[22:15:40] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[22:15:40] ✅ Patient name cross-validation successful
[22:15:40] ✅    ✅ Data merged successfully
[22:15:41] ✅    ✅ Order data extracted and validated
[22:15:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:15:41] [DOC: 9177475] ✅ Patient found in local cache: Fatima Correia, ID: 3cf90aad-62c0-4b52-a46f-2c326a3f6af9
[22:15:41] ✅    ✅ Existing patient found with ID: 3cf90aad-62c0-4b52-a46f-2c326a3f6af9
[22:15:41] 🔄 
🔄 Step 6: Pushing order to API...
[22:15:41] [DOC: 9177475] ℹ️  Pushing order via API for patient ID: 3cf90aad-62c0-4b52-a46f-2c326a3f6af9
[22:15:44] [DOC: 9177475] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:15:44] ❌    ❌ Failed to push order
[22:15:44] 🔄 
🔄 Step 7: Writing to CSV...
[22:15:44] [DOC: 9177475] ℹ️  Calculated age: 82 from DOB: 06/30/1942
[22:15:44] [DOC: 9177475] ℹ️  Service Line extracted: 'HHA'
[22:15:44] [DOC: 9177475] ℹ️  Payer Source extracted: 'Senior Whole Health'
[22:15:44] [DOC: 9177475] ℹ️  Diagnosis codes being written:
[22:15:44] [DOC: 9177475] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:15:44] [DOC: 9177475] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:15:44] [DOC: 9177475] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:15:44] [DOC: 9177475] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:15:44] [DOC: 9177475] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:15:44] [DOC: 9177475] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:15:44] [DOC: 9177475] ✅ Patient data written to CSV: Fatima Correia | Sex: FEMALE | Age: 82 | Service: HHA | Payer: Senior Whole Health | MRN: 283005
[22:15:44] ✅    ✅ Document 9177475 processed and saved successfully
[22:15:44] 🔄 
🔄 Step 8: Saving API details...
[22:15:44] [DOC: 9177475] ℹ️  API push details saved for document 9177475
[22:15:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9177438                         ║
================================================================================
[22:15:44] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[22:15:44] ℹ️  Date: 03/12/2025
[22:15:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:15:47] [DOC: 9177438] ✅ Text extracted using pdfplumber (1221 chars)
[22:15:47] ✅    ✅ Text extracted using pdfplumber (1221 chars)
[22:15:47] 🔄 
🔄 Step 2: Extracting patient data...
[22:15:50] ℹ️  AI extracted raw sex value: 'F'
[22:15:50] ℹ️  AI extracted service line: 'HHA'
[22:15:50] ℹ️  AI extracted payer source: 'Senior Whole Health'
[22:15:50] ℹ️  AI extracted diagnoses:
[22:15:50] ℹ️    - Diagnosis 1: ''
[22:15:50] ℹ️    - Diagnosis 2: ''
[22:15:50] ℹ️    - Diagnosis 3: ''
[22:15:50] ℹ️    - Diagnosis 4: ''
[22:15:50] ℹ️    - Diagnosis 5: ''
[22:15:50] ℹ️    - Diagnosis 6: ''
[22:15:50] ℹ️  Final extracted MRN: '225004'
[22:15:50] ℹ️  Final extracted Sex: 'FEMALE'
[22:15:50] ℹ️  Final extracted Service Line: 'HHA'
[22:15:50] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[22:15:50] ✅ Patient data extraction completed successfully
[22:15:50] ✅    ✅ Patient data extracted successfully
[22:15:50] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Desousa
     └─ dob: 01/21/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 225004
     └─ billingProvider: David J Shih, MD
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2024', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:15:50] ✅    ✅ Patient identified: Maria Desousa
[22:15:50] ✅    ✅ Patient name validation passed
[22:15:50] 🔄 
🔄 Step 3: Processing patient dates...
[22:15:50] [DOC: 9177438] ℹ️  DOB normalized: 01/21/1959
[22:15:50] [DOC: 9177438] ℹ️  Episode startOfCare normalized: 09/04/2024
[22:15:50] [DOC: 9177438] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[22:15:50] [DOC: 9177438] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[22:15:50] [DOC: 9177438] ✅ Patient date processing completed successfully
[22:15:50] ✅    ✅ Date processing completed
[22:15:50] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Desousa
     └─ dob: 01/21/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 225004
     └─ billingProvider: David J Shih, MD
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2024', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:15:50] 🔄 
🔄 Step 4: Extracting order data...
[22:15:52] ℹ️  Order extraction - MRN: '225004'
[22:15:52] ℹ️  Order extraction - Sex: 'FEMALE'
[22:15:52] ℹ️  Order extraction - Service Line: ''
[22:15:52] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[22:15:52] ✅ Order data extraction completed successfully
[22:15:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:15:52] ℹ️  Using MRN from patient data: '225004' over '225004'
[22:15:52] ℹ️  Using service line from patient data: 'HHA'
[22:15:52] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[22:15:52] ✅ Patient name cross-validation successful
[22:15:52] ✅    ✅ Data merged successfully
[22:15:53] ✅    ✅ Order data extracted and validated
[22:15:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:15:59] [DOC: 9177438] ℹ️  Patient not found in cache or API: Maria Desousa
[22:15:59] [DOC: 9177438] ℹ️  Patient not found, creating new patient via API...
[22:15:59] [DOC: 9177438] ℹ️  Creating patient via API: Maria Desousa
[22:16:00] [DOC: 9177438] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:16:00] ❌    ❌ Failed to create patient
[22:16:00] [DOC: 9177438] ℹ️  API push details saved for document 9177438
================================================================================
║                        Processing Document ID: 9177025                         ║
================================================================================
[22:16:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:16:00] ℹ️  Date: 03/12/2025
[22:16:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:16:09] [DOC: 9177025] ✅ Text extracted using pdfplumber (14102 chars)
[22:16:09] ✅    ✅ Text extracted using pdfplumber (14102 chars)
[22:16:09] 🔄 
🔄 Step 2: Extracting patient data...
[22:16:12] ℹ️  AI extracted raw sex value: 'F'
[22:16:12] ℹ️  AI extracted service line: 'OT'
[22:16:12] ℹ️  AI extracted payer source: ''
[22:16:12] ℹ️  AI extracted diagnoses:
[22:16:12] ℹ️    - Diagnosis 1: 'E11.9'
[22:16:12] ℹ️    - Diagnosis 2: 'None'
[22:16:12] ℹ️    - Diagnosis 3: 'None'
[22:16:12] ℹ️    - Diagnosis 4: 'None'
[22:16:12] ℹ️    - Diagnosis 5: 'None'
[22:16:12] ℹ️    - Diagnosis 6: 'None'
[22:16:12] ℹ️  Final extracted MRN: 'MA230222024501'
[22:16:12] ℹ️  Final extracted Sex: 'FEMALE'
[22:16:12] ℹ️  Final extracted Service Line: 'OT'
[22:16:12] ℹ️  Final extracted Payer Source: ''
[22:16:12] ✅ Patient data extraction completed successfully
[22:16:12] ✅    ✅ Patient data extracted successfully
[22:16:12] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/06/2024', 'endOfEpisode': None, 'firstDiagnosis': 'E11.9', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:16:12] ✅    ✅ Patient identified: Pauline Bergeron
[22:16:12] ✅    ✅ Patient name validation passed
[22:16:12] 🔄 
🔄 Step 3: Processing patient dates...
[22:16:12] [DOC: 9177025] ℹ️  DOB normalized: 02/22/1945
[22:16:12] [DOC: 9177025] ℹ️  Episode startOfEpisode normalized: 12/06/2024
[22:16:12] [DOC: 9177025] ✅ Patient date processing completed successfully
[22:16:12] ✅    ✅ Date processing completed
[22:16:12] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/06/2024', 'firstDiagnosis': 'E11.9'}]
[22:16:12] 🔄 
🔄 Step 4: Extracting order data...
[22:16:14] ℹ️  Order extraction - MRN: 'MA230222024501'
[22:16:14] ℹ️  Order extraction - Sex: 'FEMALE'
[22:16:14] ℹ️  Order extraction - Service Line: 'OT'
[22:16:14] ℹ️  Order extraction - Payer Source: ''
[22:16:14] ✅ Order data extraction completed successfully
[22:16:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:16:14] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[22:16:14] ℹ️  Service line consistent in both sources: 'OT'
[22:16:14] ✅ Patient name cross-validation successful
[22:16:14] ✅    ✅ Data merged successfully
[22:16:15] ✅    ✅ Order data extracted and validated
[22:16:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:16:15] [DOC: 9177025] ✅ Patient found in local cache: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[22:16:15] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[22:16:15] 🔄 
🔄 Step 6: Pushing order to API...
[22:16:15] [DOC: 9177025] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[22:16:17] [DOC: 9177025] ❌ Order push failed with status 201: {"id":"60e8f8c6-c1eb-48bc-b4a2-f576fa01548f","orderWAVId":"ORD20085","orderNo":"1247536914","orderDate":"02/26/2025","startOfCare":"02/26/2025","episodeStartDate":"02/26/2025","episodeEndDate":"04/26/2025","documentID":"9177025","mrn":"MA230222024501","patientName":"Bergeron, Pauline","sentToPhysicianDate":"03/12/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/18/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"OT Re-Evaluation","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"b363f434-a07c-425b-a8b8-cdf671a2a905","companyId":"b2d6c486-d448-45bc-91ac-8e3e898a1620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[22:16:17] ❌    ❌ Failed to push order
[22:16:17] 🔄 
🔄 Step 7: Writing to CSV...
[22:16:17] [DOC: 9177025] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[22:16:17] [DOC: 9177025] ℹ️  Service Line extracted: 'OT'
[22:16:17] [DOC: 9177025] ℹ️  Payer Source extracted: ''
[22:16:17] [DOC: 9177025] ℹ️  Diagnosis codes being written:
[22:16:17] [DOC: 9177025] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[22:16:17] [DOC: 9177025] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:16:17] [DOC: 9177025] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:16:17] [DOC: 9177025] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:16:17] [DOC: 9177025] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:16:17] [DOC: 9177025] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:16:17] [DOC: 9177025] ✅ Patient data written to CSV: Pauline Bergeron | Sex: FEMALE | Age: 80 | Service: OT | Payer:  | MRN: MA230222024501
[22:16:17] ✅    ✅ Document 9177025 processed and saved successfully
[22:16:17] 🔄 
🔄 Step 8: Saving API details...
[22:16:17] [DOC: 9177025] ℹ️  API push details saved for document 9177025
[22:16:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176998                         ║
================================================================================
[22:16:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:16:17] ℹ️  Date: 03/12/2025
[22:16:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:16:19] [DOC: 9176998] ✅ Text extracted using pdfplumber (1421 chars)
[22:16:19] ✅    ✅ Text extracted using pdfplumber (1421 chars)
[22:16:19] 🔄 
🔄 Step 2: Extracting patient data...
[22:16:22] ℹ️  AI extracted raw sex value: ''
[22:16:22] ℹ️  AI extracted service line: 'Physical Therapy'
[22:16:22] ℹ️  AI extracted payer source: ''
[22:16:22] ℹ️  AI extracted diagnoses:
[22:16:22] ℹ️    - Diagnosis 1: 'J44.1'
[22:16:22] ℹ️    - Diagnosis 2: 'J96.20'
[22:16:22] ℹ️    - Diagnosis 3: 'I83.893'
[22:16:22] ℹ️    - Diagnosis 4: ''
[22:16:22] ℹ️    - Diagnosis 5: ''
[22:16:22] ℹ️    - Diagnosis 6: ''
[22:16:22] ℹ️  Final extracted MRN: 'MA231024053804'
[22:16:22] ℹ️  Final extracted Sex: ''
[22:16:22] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:16:22] ℹ️  Final extracted Payer Source: ''
[22:16:22] ✅ Patient data extraction completed successfully
[22:16:22] ✅    ✅ Patient data extracted successfully
[22:16:22] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:16:22] ✅    ✅ Patient identified: Sylvia Rosalie
[22:16:22] ✅    ✅ Patient name validation passed
[22:16:22] 🔄 
🔄 Step 3: Processing patient dates...
[22:16:22] [DOC: 9176998] ℹ️  DOB normalized: 05/22/1938
[22:16:22] [DOC: 9176998] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[22:16:22] [DOC: 9176998] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:16:22] [DOC: 9176998] ✅ Patient date processing completed successfully
[22:16:22] ✅    ✅ Date processing completed
[22:16:22] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:16:22] 🔄 
🔄 Step 4: Extracting order data...
[22:16:26] ℹ️  Order extraction - MRN: 'MA231024053804'
[22:16:26] ℹ️  Order extraction - Sex: ''
[22:16:26] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:16:26] ℹ️  Order extraction - Payer Source: ''
[22:16:26] ✅ Order data extraction completed successfully
[22:16:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:16:26] ℹ️  Using MRN from patient data: 'MA231024053804' over 'MA231024053804'
[22:16:26] ⚠️  Could not determine sex using any available method
[22:16:26] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:16:26] ✅ Patient name cross-validation successful
[22:16:26] ✅    ✅ Data merged successfully
[22:16:27] ✅    ✅ Order data extracted and validated
[22:16:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:16:27] [DOC: 9176998] ✅ Patient found in local cache: Sylvia Rosalie, ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:27] ✅    ✅ Existing patient found with ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:27] 🔄 
🔄 Step 6: Pushing order to API...
[22:16:27] [DOC: 9176998] ℹ️  Pushing order via API for patient ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:28] [DOC: 9176998] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14476"}
[22:16:28] ❌    ❌ Failed to push order
[22:16:28] 🔄 
🔄 Step 7: Writing to CSV...
[22:16:28] [DOC: 9176998] ℹ️  Calculated age: 87 from DOB: 05/22/1938
[22:16:28] [DOC: 9176998] ℹ️  Service Line extracted: 'Physical Therapy'
[22:16:28] [DOC: 9176998] ℹ️  Payer Source extracted: ''
[22:16:28] [DOC: 9176998] ℹ️  Diagnosis codes being written:
[22:16:28] [DOC: 9176998] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[22:16:28] [DOC: 9176998] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.20'
[22:16:28] [DOC: 9176998] ℹ️    - Latest_Episode_Thirddiagnosis: 'I83.893'
[22:16:28] [DOC: 9176998] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:16:28] [DOC: 9176998] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:16:28] [DOC: 9176998] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:16:28] [DOC: 9176998] ✅ Patient data written to CSV: Sylvia Rosalie | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA231024053804
[22:16:28] ✅    ✅ Document 9176998 processed and saved successfully
[22:16:28] 🔄 
🔄 Step 8: Saving API details...
[22:16:28] [DOC: 9176998] ℹ️  API push details saved for document 9176998
[22:16:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176995                         ║
================================================================================
[22:16:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:16:28] ℹ️  Date: 03/12/2025
[22:16:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:16:30] [DOC: 9176995] ✅ Text extracted using pdfplumber (1421 chars)
[22:16:30] ✅    ✅ Text extracted using pdfplumber (1421 chars)
[22:16:30] 🔄 
🔄 Step 2: Extracting patient data...
[22:16:32] ℹ️  AI extracted raw sex value: ''
[22:16:32] ℹ️  AI extracted service line: 'Physical Therapy'
[22:16:32] ℹ️  AI extracted payer source: ''
[22:16:32] ℹ️  AI extracted diagnoses:
[22:16:32] ℹ️    - Diagnosis 1: 'J44.1'
[22:16:32] ℹ️    - Diagnosis 2: 'J96.20'
[22:16:32] ℹ️    - Diagnosis 3: 'I83.893'
[22:16:32] ℹ️    - Diagnosis 4: ''
[22:16:32] ℹ️    - Diagnosis 5: ''
[22:16:32] ℹ️    - Diagnosis 6: ''
[22:16:32] ℹ️  Final extracted MRN: 'MA231024053804'
[22:16:32] ℹ️  Final extracted Sex: ''
[22:16:32] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:16:32] ℹ️  Final extracted Payer Source: ''
[22:16:32] ✅ Patient data extraction completed successfully
[22:16:32] ✅    ✅ Patient data extracted successfully
[22:16:32] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:16:32] ✅    ✅ Patient identified: Sylvia Rosalie
[22:16:32] ✅    ✅ Patient name validation passed
[22:16:32] 🔄 
🔄 Step 3: Processing patient dates...
[22:16:32] [DOC: 9176995] ℹ️  DOB normalized: 05/22/1938
[22:16:32] [DOC: 9176995] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[22:16:32] [DOC: 9176995] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:16:32] [DOC: 9176995] ✅ Patient date processing completed successfully
[22:16:32] ✅    ✅ Date processing completed
[22:16:32] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:16:32] 🔄 
🔄 Step 4: Extracting order data...
[22:16:35] ℹ️  Order extraction - MRN: 'MA231024053804'
[22:16:35] ℹ️  Order extraction - Sex: ''
[22:16:35] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:16:35] ℹ️  Order extraction - Payer Source: ''
[22:16:35] ✅ Order data extraction completed successfully
[22:16:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:16:35] ℹ️  Using MRN from patient data: 'MA231024053804' over 'MA231024053804'
[22:16:35] ⚠️  Could not determine sex using any available method
[22:16:35] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:16:35] ✅ Patient name cross-validation successful
[22:16:35] ✅    ✅ Data merged successfully
[22:16:37] ✅    ✅ Order data extracted and validated
[22:16:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:16:37] [DOC: 9176995] ✅ Patient found in local cache: Sylvia Rosalie, ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:37] ✅    ✅ Existing patient found with ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:37] 🔄 
🔄 Step 6: Pushing order to API...
[22:16:37] [DOC: 9176995] ℹ️  Pushing order via API for patient ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:38] [DOC: 9176995] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14477"}
[22:16:38] ❌    ❌ Failed to push order
[22:16:38] 🔄 
🔄 Step 7: Writing to CSV...
[22:16:38] [DOC: 9176995] ℹ️  Calculated age: 87 from DOB: 05/22/1938
[22:16:38] [DOC: 9176995] ℹ️  Service Line extracted: 'Physical Therapy'
[22:16:38] [DOC: 9176995] ℹ️  Payer Source extracted: ''
[22:16:38] [DOC: 9176995] ℹ️  Diagnosis codes being written:
[22:16:38] [DOC: 9176995] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[22:16:38] [DOC: 9176995] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.20'
[22:16:38] [DOC: 9176995] ℹ️    - Latest_Episode_Thirddiagnosis: 'I83.893'
[22:16:38] [DOC: 9176995] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:16:38] [DOC: 9176995] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:16:38] [DOC: 9176995] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:16:38] [DOC: 9176995] ✅ Patient data written to CSV: Sylvia Rosalie | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA231024053804
[22:16:38] ✅    ✅ Document 9176995 processed and saved successfully
[22:16:38] 🔄 
🔄 Step 8: Saving API details...
[22:16:38] [DOC: 9176995] ℹ️  API push details saved for document 9176995
[22:16:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176993                         ║
================================================================================
[22:16:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:16:38] ℹ️  Date: 03/12/2025
[22:16:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:16:40] [DOC: 9176993] ✅ Text extracted using pdfplumber (1793 chars)
[22:16:40] ✅    ✅ Text extracted using pdfplumber (1793 chars)
[22:16:40] 🔄 
🔄 Step 2: Extracting patient data...
[22:16:43] ℹ️  AI extracted raw sex value: ''
[22:16:43] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:16:43] ℹ️  AI extracted payer source: ''
[22:16:43] ℹ️  AI extracted diagnoses:
[22:16:43] ℹ️    - Diagnosis 1: 'J44.1'
[22:16:43] ℹ️    - Diagnosis 2: 'J96.20'
[22:16:43] ℹ️    - Diagnosis 3: 'I83.893'
[22:16:43] ℹ️    - Diagnosis 4: 'None'
[22:16:43] ℹ️    - Diagnosis 5: 'None'
[22:16:43] ℹ️    - Diagnosis 6: 'None'
[22:16:43] ℹ️  Final extracted MRN: 'MA231024053804'
[22:16:43] ℹ️  Final extracted Sex: ''
[22:16:43] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:16:43] ℹ️  Final extracted Payer Source: ''
[22:16:43] ✅ Patient data extraction completed successfully
[22:16:43] ✅    ✅ Patient data extracted successfully
[22:16:43] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:16:43] ✅    ✅ Patient identified: Sylvia Rosalie
[22:16:43] ✅    ✅ Patient name validation passed
[22:16:43] 🔄 
🔄 Step 3: Processing patient dates...
[22:16:43] [DOC: 9176993] ℹ️  DOB normalized: 05/22/1938
[22:16:43] [DOC: 9176993] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[22:16:43] [DOC: 9176993] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:16:43] [DOC: 9176993] ✅ Patient date processing completed successfully
[22:16:43] ✅    ✅ Date processing completed
[22:16:43] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893'}]
[22:16:43] 🔄 
🔄 Step 4: Extracting order data...
[22:16:46] ℹ️  Order extraction - MRN: 'MA231024053804'
[22:16:46] ℹ️  Order extraction - Sex: ''
[22:16:46] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:16:46] ℹ️  Order extraction - Payer Source: ''
[22:16:46] ✅ Order data extraction completed successfully
[22:16:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:16:46] ℹ️  Using MRN from patient data: 'MA231024053804' over 'MA231024053804'
[22:16:46] ⚠️  Could not determine sex using any available method
[22:16:46] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:16:46] ✅ Patient name cross-validation successful
[22:16:46] ✅    ✅ Data merged successfully
[22:16:47] ✅    ✅ Order data extracted and validated
[22:16:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:16:47] [DOC: 9176993] ✅ Patient found in local cache: Sylvia Rosalie, ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:47] ✅    ✅ Existing patient found with ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:47] 🔄 
🔄 Step 6: Pushing order to API...
[22:16:47] [DOC: 9176993] ℹ️  Pushing order via API for patient ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:16:49] [DOC: 9176993] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14478"}
[22:16:49] ❌    ❌ Failed to push order
[22:16:49] 🔄 
🔄 Step 7: Writing to CSV...
[22:16:49] [DOC: 9176993] ℹ️  Calculated age: 87 from DOB: 05/22/1938
[22:16:49] [DOC: 9176993] ℹ️  Service Line extracted: 'Occupational Therapy'
[22:16:49] [DOC: 9176993] ℹ️  Payer Source extracted: ''
[22:16:49] [DOC: 9176993] ℹ️  Diagnosis codes being written:
[22:16:49] [DOC: 9176993] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[22:16:49] [DOC: 9176993] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.20'
[22:16:49] [DOC: 9176993] ℹ️    - Latest_Episode_Thirddiagnosis: 'I83.893'
[22:16:49] [DOC: 9176993] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:16:49] [DOC: 9176993] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:16:49] [DOC: 9176993] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:16:49] [DOC: 9176993] ✅ Patient data written to CSV: Sylvia Rosalie | Sex:  | Age: 87 | Service: Occupational Therapy | Payer:  | MRN: MA231024053804
[22:16:49] ✅    ✅ Document 9176993 processed and saved successfully
[22:16:49] 🔄 
🔄 Step 8: Saving API details...
[22:16:49] [DOC: 9176993] ℹ️  API push details saved for document 9176993
[22:16:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176992                         ║
================================================================================
[22:16:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:16:49] ℹ️  Date: 03/12/2025
[22:16:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:16:53] [DOC: 9176992] ✅ Text extracted using pdfplumber (13181 chars)
[22:16:53] ✅    ✅ Text extracted using pdfplumber (13181 chars)
[22:16:53] 🔄 
🔄 Step 2: Extracting patient data...
[22:16:56] ℹ️  AI extracted raw sex value: 'F'
[22:16:56] ℹ️  AI extracted service line: 'OT'
[22:16:56] ℹ️  AI extracted payer source: ''
[22:16:56] ℹ️  AI extracted diagnoses:
[22:16:56] ℹ️    - Diagnosis 1: 'J44.1'
[22:16:56] ℹ️    - Diagnosis 2: 'I25.10'
[22:16:56] ℹ️    - Diagnosis 3: 'I10'
[22:16:56] ℹ️    - Diagnosis 4: 'E78.5'
[22:16:56] ℹ️    - Diagnosis 5: 'F06.9'
[22:16:56] ℹ️    - Diagnosis 6: ''
[22:16:56] ℹ️  Final extracted MRN: '1257885317'
[22:16:56] ℹ️  Final extracted Sex: 'FEMALE'
[22:16:56] ℹ️  Final extracted Service Line: 'OT'
[22:16:56] ℹ️  Final extracted Payer Source: ''
[22:16:56] ✅ Patient data extraction completed successfully
[22:16:56] ✅    ✅ Patient data extracted successfully
[22:16:56] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1257885317
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F06.9', 'sixthDiagnosis': ''}]
[22:16:56] ✅    ✅ Patient identified: Sylvia Rosalie
[22:16:56] ✅    ✅ Patient name validation passed
[22:16:56] 🔄 
🔄 Step 3: Processing patient dates...
[22:16:56] [DOC: 9176992] ℹ️  DOB normalized: 05/22/1938
[22:16:56] [DOC: 9176992] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[22:16:56] [DOC: 9176992] ℹ️  Episode endOfEpisode normalized: 02/21/2025
[22:16:56] [DOC: 9176992] ✅ Patient date processing completed successfully
[22:16:56] ✅    ✅ Date processing completed
[22:16:56] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1257885317
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F06.9', 'sixthDiagnosis': ''}]
[22:16:56] 🔄 
🔄 Step 4: Extracting order data...
[22:16:58] ℹ️  Order extraction - MRN: 'MA231024053804'
[22:16:58] ℹ️  Order extraction - Sex: 'FEMALE'
[22:16:58] ℹ️  Order extraction - Service Line: 'OT'
[22:16:58] ℹ️  Order extraction - Payer Source: ''
[22:16:58] ✅ Order data extraction completed successfully
[22:16:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:16:58] ℹ️  Using longer MRN from order data: 'MA231024053804' over '1257885317'
[22:16:58] ℹ️  Service line consistent in both sources: 'OT'
[22:16:58] ✅ Patient name cross-validation successful
[22:16:58] ✅    ✅ Data merged successfully
[22:17:00] ✅    ✅ Order data extracted and validated
[22:17:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:17:00] [DOC: 9176992] ✅ Patient found in local cache: Sylvia Rosalie, ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:17:00] ✅    ✅ Existing patient found with ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:17:00] 🔄 
🔄 Step 6: Pushing order to API...
[22:17:00] [DOC: 9176992] ℹ️  Pushing order via API for patient ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[22:17:03] [DOC: 9176992] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:17:03] ❌    ❌ Failed to push order
[22:17:03] 🔄 
🔄 Step 7: Writing to CSV...
[22:17:03] [DOC: 9176992] ℹ️  Calculated age: 87 from DOB: 05/22/1938
[22:17:03] [DOC: 9176992] ℹ️  Service Line extracted: 'OT'
[22:17:03] [DOC: 9176992] ℹ️  Payer Source extracted: ''
[22:17:03] [DOC: 9176992] ℹ️  Diagnosis codes being written:
[22:17:03] [DOC: 9176992] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[22:17:03] [DOC: 9176992] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[22:17:03] [DOC: 9176992] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:17:03] [DOC: 9176992] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[22:17:03] [DOC: 9176992] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F06.9'
[22:17:03] [DOC: 9176992] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:17:03] [DOC: 9176992] ✅ Patient data written to CSV: Sylvia Rosalie | Sex: FEMALE | Age: 87 | Service: OT | Payer:  | MRN: MA231024053804
[22:17:03] ✅    ✅ Document 9176992 processed and saved successfully
[22:17:03] 🔄 
🔄 Step 8: Saving API details...
[22:17:03] [DOC: 9176992] ℹ️  API push details saved for document 9176992
[22:17:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176974                         ║
================================================================================
[22:17:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:17:03] ℹ️  Date: 03/12/2025
[22:17:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:17:05] [DOC: 9176974] ✅ Text extracted using pdfplumber (1583 chars)
[22:17:05] ✅    ✅ Text extracted using pdfplumber (1571 chars)
[22:17:05] 🔄 
🔄 Step 2: Extracting patient data...
[22:17:08] ℹ️  AI extracted raw sex value: ''
[22:17:08] ℹ️  AI extracted service line: 'Physical Therapy'
[22:17:08] ℹ️  AI extracted payer source: ''
[22:17:08] ℹ️  AI extracted diagnoses:
[22:17:08] ℹ️    - Diagnosis 1: 'E11.610'
[22:17:08] ℹ️    - Diagnosis 2: 'L89.616'
[22:17:08] ℹ️    - Diagnosis 3: 'I89.0'
[22:17:08] ℹ️    - Diagnosis 4: ''
[22:17:08] ℹ️    - Diagnosis 5: ''
[22:17:08] ℹ️    - Diagnosis 6: ''
[22:17:08] ℹ️  Final extracted MRN: 'MA240822115704'
[22:17:08] ℹ️  Final extracted Sex: ''
[22:17:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:17:08] ℹ️  Final extracted Payer Source: ''
[22:17:08] ✅ Patient data extraction completed successfully
[22:17:08] ✅    ✅ Patient data extracted successfully
[22:17:08] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:17:08] ✅    ✅ Patient identified: Charlene Couto
[22:17:08] ✅    ✅ Patient name validation passed
[22:17:08] 🔄 
🔄 Step 3: Processing patient dates...
[22:17:08] [DOC: 9176974] ℹ️  DOB normalized: 11/01/1957
[22:17:08] [DOC: 9176974] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[22:17:08] [DOC: 9176974] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[22:17:08] [DOC: 9176974] ✅ Patient date processing completed successfully
[22:17:08] ✅    ✅ Date processing completed
[22:17:08] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:17:08] 🔄 
🔄 Step 4: Extracting order data...
[22:17:10] ℹ️  Order extraction - MRN: 'MA240822115704'
[22:17:10] ℹ️  Order extraction - Sex: ''
[22:17:10] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:17:10] ℹ️  Order extraction - Payer Source: ''
[22:17:10] ✅ Order data extraction completed successfully
[22:17:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:17:10] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[22:17:10] ⚠️  Could not determine sex using any available method
[22:17:10] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:17:10] ✅ Patient name cross-validation successful
[22:17:10] ✅    ✅ Data merged successfully
[22:17:12] ✅    ✅ Order data extracted and validated
[22:17:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:17:12] [DOC: 9176974] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:12] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:12] 🔄 
🔄 Step 6: Pushing order to API...
[22:17:12] [DOC: 9176974] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:13] [DOC: 9176974] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13734"}
[22:17:13] ❌    ❌ Failed to push order
[22:17:13] 🔄 
🔄 Step 7: Writing to CSV...
[22:17:13] [DOC: 9176974] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[22:17:13] [DOC: 9176974] ℹ️  Service Line extracted: 'Physical Therapy'
[22:17:13] [DOC: 9176974] ℹ️  Payer Source extracted: ''
[22:17:13] [DOC: 9176974] ℹ️  Diagnosis codes being written:
[22:17:13] [DOC: 9176974] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.610'
[22:17:13] [DOC: 9176974] ℹ️    - Latest_Episode_Seconddiagnosis: 'L89.616'
[22:17:13] [DOC: 9176974] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[22:17:13] [DOC: 9176974] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:17:13] [DOC: 9176974] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:17:13] [DOC: 9176974] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:17:13] [DOC: 9176974] ✅ Patient data written to CSV: Charlene Couto | Sex:  | Age: 67 | Service: Physical Therapy | Payer:  | MRN: MA240822115704
[22:17:13] ✅    ✅ Document 9176974 processed and saved successfully
[22:17:13] 🔄 
🔄 Step 8: Saving API details...
[22:17:13] [DOC: 9176974] ℹ️  API push details saved for document 9176974
[22:17:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176970                         ║
================================================================================
[22:17:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:17:13] ℹ️  Date: 03/12/2025
[22:17:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:17:18] [DOC: 9176970] ✅ Text extracted using pdfplumber (1444 chars)
[22:17:18] ✅    ✅ Text extracted using pdfplumber (1432 chars)
[22:17:18] 🔄 
🔄 Step 2: Extracting patient data...
[22:17:21] ℹ️  AI extracted raw sex value: ''
[22:17:21] ℹ️  AI extracted service line: 'Physical Therapy'
[22:17:21] ℹ️  AI extracted payer source: ''
[22:17:21] ℹ️  AI extracted diagnoses:
[22:17:21] ℹ️    - Diagnosis 1: 'E11.610'
[22:17:21] ℹ️    - Diagnosis 2: 'L89.616'
[22:17:21] ℹ️    - Diagnosis 3: 'I89.0'
[22:17:21] ℹ️    - Diagnosis 4: ''
[22:17:21] ℹ️    - Diagnosis 5: ''
[22:17:21] ℹ️    - Diagnosis 6: ''
[22:17:21] ℹ️  Final extracted MRN: 'MA240822115704'
[22:17:21] ℹ️  Final extracted Sex: ''
[22:17:21] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:17:21] ℹ️  Final extracted Payer Source: ''
[22:17:21] ✅ Patient data extraction completed successfully
[22:17:21] ✅    ✅ Patient data extracted successfully
[22:17:21] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:17:21] ✅    ✅ Patient identified: Charlene Couto
[22:17:21] ✅    ✅ Patient name validation passed
[22:17:21] 🔄 
🔄 Step 3: Processing patient dates...
[22:17:21] [DOC: 9176970] ℹ️  DOB normalized: 11/01/1957
[22:17:21] [DOC: 9176970] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[22:17:21] [DOC: 9176970] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[22:17:21] [DOC: 9176970] ✅ Patient date processing completed successfully
[22:17:21] ✅    ✅ Date processing completed
[22:17:21] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:17:21] 🔄 
🔄 Step 4: Extracting order data...
[22:17:24] ℹ️  Order extraction - MRN: 'MA240822115704'
[22:17:24] ℹ️  Order extraction - Sex: ''
[22:17:24] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:17:24] ℹ️  Order extraction - Payer Source: ''
[22:17:24] ✅ Order data extraction completed successfully
[22:17:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:17:24] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[22:17:24] ⚠️  Could not determine sex using any available method
[22:17:24] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:17:24] ✅ Patient name cross-validation successful
[22:17:24] ✅    ✅ Data merged successfully
[22:17:25] ✅    ✅ Order data extracted and validated
[22:17:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:17:25] [DOC: 9176970] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:25] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:25] 🔄 
🔄 Step 6: Pushing order to API...
[22:17:25] [DOC: 9176970] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:26] [DOC: 9176970] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13735"}
[22:17:26] ❌    ❌ Failed to push order
[22:17:26] 🔄 
🔄 Step 7: Writing to CSV...
[22:17:26] [DOC: 9176970] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[22:17:26] [DOC: 9176970] ℹ️  Service Line extracted: 'Physical Therapy'
[22:17:26] [DOC: 9176970] ℹ️  Payer Source extracted: ''
[22:17:26] [DOC: 9176970] ℹ️  Diagnosis codes being written:
[22:17:26] [DOC: 9176970] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.610'
[22:17:26] [DOC: 9176970] ℹ️    - Latest_Episode_Seconddiagnosis: 'L89.616'
[22:17:26] [DOC: 9176970] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[22:17:26] [DOC: 9176970] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:17:26] [DOC: 9176970] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:17:26] [DOC: 9176970] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:17:26] [DOC: 9176970] ✅ Patient data written to CSV: Charlene Couto | Sex:  | Age: 67 | Service: Physical Therapy | Payer:  | MRN: MA240822115704
[22:17:26] ✅    ✅ Document 9176970 processed and saved successfully
[22:17:26] 🔄 
🔄 Step 8: Saving API details...
[22:17:26] [DOC: 9176970] ℹ️  API push details saved for document 9176970
[22:17:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176969                         ║
================================================================================
[22:17:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:17:26] ℹ️  Date: 03/12/2025
[22:17:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:17:29] [DOC: 9176969] ✅ Text extracted using pdfplumber (1512 chars)
[22:17:29] ✅    ✅ Text extracted using pdfplumber (1500 chars)
[22:17:29] 🔄 
🔄 Step 2: Extracting patient data...
[22:17:31] ℹ️  AI extracted raw sex value: ''
[22:17:31] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:17:31] ℹ️  AI extracted payer source: ''
[22:17:31] ℹ️  AI extracted diagnoses:
[22:17:31] ℹ️    - Diagnosis 1: 'E11.610'
[22:17:31] ℹ️    - Diagnosis 2: 'L89.616'
[22:17:31] ℹ️    - Diagnosis 3: 'I89.0'
[22:17:31] ℹ️    - Diagnosis 4: 'None'
[22:17:31] ℹ️    - Diagnosis 5: 'None'
[22:17:31] ℹ️    - Diagnosis 6: 'None'
[22:17:31] ℹ️  Final extracted MRN: 'MA240822115704'
[22:17:31] ℹ️  Final extracted Sex: ''
[22:17:31] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:17:31] ℹ️  Final extracted Payer Source: ''
[22:17:31] ✅ Patient data extraction completed successfully
[22:17:31] ✅    ✅ Patient data extracted successfully
[22:17:31] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:17:31] ✅    ✅ Patient identified: Charlene Couto
[22:17:31] ✅    ✅ Patient name validation passed
[22:17:31] 🔄 
🔄 Step 3: Processing patient dates...
[22:17:31] [DOC: 9176969] ℹ️  DOB normalized: 11/01/1957
[22:17:31] [DOC: 9176969] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[22:17:31] [DOC: 9176969] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[22:17:31] [DOC: 9176969] ✅ Patient date processing completed successfully
[22:17:31] ✅    ✅ Date processing completed
[22:17:31] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0'}]
[22:17:31] 🔄 
🔄 Step 4: Extracting order data...
[22:17:34] ℹ️  Order extraction - MRN: 'MA240822115704'
[22:17:34] ℹ️  Order extraction - Sex: ''
[22:17:34] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:17:34] ℹ️  Order extraction - Payer Source: ''
[22:17:34] ✅ Order data extraction completed successfully
[22:17:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:17:34] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[22:17:34] ⚠️  Could not determine sex using any available method
[22:17:34] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:17:34] ✅ Patient name cross-validation successful
[22:17:34] ✅    ✅ Data merged successfully
[22:17:35] ✅    ✅ Order data extracted and validated
[22:17:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:17:35] [DOC: 9176969] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:35] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:35] 🔄 
🔄 Step 6: Pushing order to API...
[22:17:35] [DOC: 9176969] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:36] [DOC: 9176969] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13736"}
[22:17:36] ❌    ❌ Failed to push order
[22:17:36] 🔄 
🔄 Step 7: Writing to CSV...
[22:17:36] [DOC: 9176969] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[22:17:36] [DOC: 9176969] ℹ️  Service Line extracted: 'Occupational Therapy'
[22:17:36] [DOC: 9176969] ℹ️  Payer Source extracted: ''
[22:17:36] [DOC: 9176969] ℹ️  Diagnosis codes being written:
[22:17:36] [DOC: 9176969] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.610'
[22:17:36] [DOC: 9176969] ℹ️    - Latest_Episode_Seconddiagnosis: 'L89.616'
[22:17:36] [DOC: 9176969] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[22:17:36] [DOC: 9176969] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:17:36] [DOC: 9176969] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:17:36] [DOC: 9176969] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:17:36] [DOC: 9176969] ✅ Patient data written to CSV: Charlene Couto | Sex:  | Age: 67 | Service: Occupational Therapy | Payer:  | MRN: MA240822115704
[22:17:36] ✅    ✅ Document 9176969 processed and saved successfully
[22:17:36] 🔄 
🔄 Step 8: Saving API details...
[22:17:36] [DOC: 9176969] ℹ️  API push details saved for document 9176969
[22:17:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176965                         ║
================================================================================
[22:17:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:17:36] ℹ️  Date: 03/12/2025
[22:17:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:17:40] [DOC: 9176965] ✅ Text extracted using pdfplumber (13301 chars)
[22:17:40] ✅    ✅ Text extracted using pdfplumber (13301 chars)
[22:17:40] 🔄 
🔄 Step 2: Extracting patient data...
[22:17:43] ℹ️  AI extracted raw sex value: 'F'
[22:17:43] ℹ️  AI extracted service line: 'OT'
[22:17:43] ℹ️  AI extracted payer source: 'None'
[22:17:43] ℹ️  AI extracted diagnoses:
[22:17:43] ℹ️    - Diagnosis 1: 'None'
[22:17:43] ℹ️    - Diagnosis 2: 'None'
[22:17:43] ℹ️    - Diagnosis 3: 'None'
[22:17:43] ℹ️    - Diagnosis 4: 'None'
[22:17:43] ℹ️    - Diagnosis 5: 'None'
[22:17:43] ℹ️    - Diagnosis 6: 'None'
[22:17:43] ℹ️  Final extracted MRN: 'MA240822115704'
[22:17:43] ℹ️  Final extracted Sex: 'FEMALE'
[22:17:43] ℹ️  Final extracted Service Line: 'OT'
[22:17:43] ℹ️  Final extracted Payer Source: ''
[22:17:43] ✅ Patient data extraction completed successfully
[22:17:43] ✅    ✅ Patient data extracted successfully
[22:17:43] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:17:43] ✅    ✅ Patient identified: Charlene Couto
[22:17:43] ✅    ✅ Patient name validation passed
[22:17:43] 🔄 
🔄 Step 3: Processing patient dates...
[22:17:43] [DOC: 9176965] ℹ️  DOB normalized: 11/01/1957
[22:17:43] [DOC: 9176965] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[22:17:43] [DOC: 9176965] ✅ Patient date processing completed successfully
[22:17:43] ✅    ✅ Date processing completed
[22:17:43] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025'}]
[22:17:43] 🔄 
🔄 Step 4: Extracting order data...
[22:17:46] ℹ️  Order extraction - MRN: 'MA240822115704'
[22:17:46] ℹ️  Order extraction - Sex: 'FEMALE'
[22:17:46] ℹ️  Order extraction - Service Line: 'OT'
[22:17:46] ℹ️  Order extraction - Payer Source: ''
[22:17:46] ✅ Order data extraction completed successfully
[22:17:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:17:46] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[22:17:46] ℹ️  Service line consistent in both sources: 'OT'
[22:17:46] ✅ Patient name cross-validation successful
[22:17:46] ✅    ✅ Data merged successfully
[22:17:47] ✅    ✅ Order data extracted and validated
[22:17:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:17:47] [DOC: 9176965] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:47] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:47] 🔄 
🔄 Step 6: Pushing order to API...
[22:17:47] [DOC: 9176965] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:17:48] [DOC: 9176965] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:17:48] ❌    ❌ Failed to push order
[22:17:48] 🔄 
🔄 Step 7: Writing to CSV...
[22:17:48] [DOC: 9176965] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[22:17:48] [DOC: 9176965] ℹ️  Service Line extracted: 'OT'
[22:17:48] [DOC: 9176965] ℹ️  Payer Source extracted: ''
[22:17:48] [DOC: 9176965] ℹ️  Diagnosis codes being written:
[22:17:48] [DOC: 9176965] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:17:48] [DOC: 9176965] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:17:48] [DOC: 9176965] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:17:48] [DOC: 9176965] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:17:48] [DOC: 9176965] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:17:48] [DOC: 9176965] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:17:48] [DOC: 9176965] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: OT | Payer:  | MRN: MA240822115704
[22:17:48] ✅    ✅ Document 9176965 processed and saved successfully
[22:17:48] 🔄 
🔄 Step 8: Saving API details...
[22:17:48] [DOC: 9176965] ℹ️  API push details saved for document 9176965
[22:17:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176964                         ║
================================================================================
[22:17:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:17:48] ℹ️  Date: 03/12/2025
[22:17:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:17:55] [DOC: 9176964] ✅ Text extracted using pdfplumber (20980 chars)
[22:17:55] ✅    ✅ Text extracted using pdfplumber (20968 chars)
[22:17:55] 🔄 
🔄 Step 2: Extracting patient data...
[22:17:58] ℹ️  AI extracted raw sex value: 'F'
[22:17:58] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:17:58] ℹ️  AI extracted payer source: 'Medicare'
[22:17:58] ℹ️  AI extracted diagnoses:
[22:17:58] ℹ️    - Diagnosis 1: 'E11.610'
[22:17:58] ℹ️    - Diagnosis 2: 'L89.616'
[22:17:58] ℹ️    - Diagnosis 3: 'I89.0'
[22:17:58] ℹ️    - Diagnosis 4: 'E04.1'
[22:17:58] ℹ️    - Diagnosis 5: 'G35.'
[22:17:58] ℹ️    - Diagnosis 6: 'G31.84'
[22:17:58] ℹ️  Final extracted MRN: 'MA240822115704'
[22:17:58] ℹ️  Final extracted Sex: 'FEMALE'
[22:17:58] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:17:58] ℹ️  Final extracted Payer Source: 'Medicare'
[22:17:58] ✅ Patient data extraction completed successfully
[22:17:58] ✅    ✅ Patient data extracted successfully
[22:17:58] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian,
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 347 Main St, Apt 102
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (774) 425-3322
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'E04.1', 'fifthDiagnosis': 'G35.', 'sixthDiagnosis': 'G31.84'}]
[22:17:58] ✅    ✅ Patient identified: Charlene Couto
[22:17:58] ✅    ✅ Patient name validation passed
[22:17:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:17:58] [DOC: 9176964] ℹ️  DOB normalized: 11/01/1957
[22:17:58] [DOC: 9176964] ℹ️  Episode startOfCare normalized: 02/21/2025
[22:17:58] [DOC: 9176964] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[22:17:58] [DOC: 9176964] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[22:17:58] [DOC: 9176964] ✅ Patient date processing completed successfully
[22:17:58] ✅    ✅ Date processing completed
[22:17:58] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian,
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 347 Main St, Apt 102
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (774) 425-3322
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'E04.1', 'fifthDiagnosis': 'G35.', 'sixthDiagnosis': 'G31.84'}]
[22:17:58] 🔄 
🔄 Step 4: Extracting order data...
[22:18:01] ℹ️  Order extraction - MRN: 'MA240822115704'
[22:18:01] ℹ️  Order extraction - Sex: 'FEMALE'
[22:18:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:18:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:18:01] ✅ Order data extraction completed successfully
[22:18:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:18:01] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[22:18:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:18:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:18:01] ✅ Patient name cross-validation successful
[22:18:01] ✅    ✅ Data merged successfully
[22:18:02] ✅    ✅ Order data extracted and validated
[22:18:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:18:02] [DOC: 9176964] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:18:02] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:18:02] 🔄 
🔄 Step 6: Pushing order to API...
[22:18:02] [DOC: 9176964] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[22:18:04] [DOC: 9176964] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13737"}
[22:18:04] ❌    ❌ Failed to push order
[22:18:04] 🔄 
🔄 Step 7: Writing to CSV...
[22:18:04] [DOC: 9176964] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[22:18:04] [DOC: 9176964] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:18:04] [DOC: 9176964] ℹ️  Payer Source extracted: 'Medicare'
[22:18:04] [DOC: 9176964] ℹ️  Diagnosis codes being written:
[22:18:04] [DOC: 9176964] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.610'
[22:18:04] [DOC: 9176964] ℹ️    - Latest_Episode_Seconddiagnosis: 'L89.616'
[22:18:04] [DOC: 9176964] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[22:18:04] [DOC: 9176964] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E04.1'
[22:18:04] [DOC: 9176964] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G35.'
[22:18:04] [DOC: 9176964] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G31.84'
[22:18:04] [DOC: 9176964] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA240822115704
[22:18:04] ✅    ✅ Document 9176964 processed and saved successfully
[22:18:04] 🔄 
🔄 Step 8: Saving API details...
[22:18:04] [DOC: 9176964] ℹ️  API push details saved for document 9176964
[22:18:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176958                         ║
================================================================================
[22:18:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:18:04] ℹ️  Date: 03/12/2025
[22:18:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:18:13] [DOC: 9176958] ✅ Text extracted using pdfplumber (12639 chars)
[22:18:13] ✅    ✅ Text extracted using pdfplumber (12639 chars)
[22:18:13] 🔄 
🔄 Step 2: Extracting patient data...
[22:18:16] ℹ️  AI extracted raw sex value: 'F'
[22:18:16] ℹ️  AI extracted service line: 'OT'
[22:18:16] ℹ️  AI extracted payer source: ''
[22:18:16] ℹ️  AI extracted diagnoses:
[22:18:16] ℹ️    - Diagnosis 1: 'Parkinsons'
[22:18:16] ℹ️    - Diagnosis 2: 'CHF Exacerbation'
[22:18:16] ℹ️    - Diagnosis 3: 'COPD'
[22:18:16] ℹ️    - Diagnosis 4: 'CVA'
[22:18:16] ℹ️    - Diagnosis 5: 'A fib'
[22:18:16] ℹ️    - Diagnosis 6: ''
[22:18:16] ℹ️  Final extracted MRN: 'MA221012094404'
[22:18:16] ℹ️  Final extracted Sex: 'FEMALE'
[22:18:16] ℹ️  Final extracted Service Line: 'OT'
[22:18:16] ℹ️  Final extracted Payer Source: ''
[22:18:16] ✅ Patient data extraction completed successfully
[22:18:16] ✅    ✅ Patient data extracted successfully
[22:18:16] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '08/15/2024', 'endOfEpisode': None, 'firstDiagnosis': 'Parkinsons', 'secondDiagnosis': 'CHF Exacerbation', 'thirdDiagnosis': 'COPD', 'fourthDiagnosis': 'CVA', 'fifthDiagnosis': 'A fib', 'sixthDiagnosis': ''}]
[22:18:16] ✅    ✅ Patient identified: Maria Ferreira
[22:18:16] ✅    ✅ Patient name validation passed
[22:18:16] 🔄 
🔄 Step 3: Processing patient dates...
[22:18:16] [DOC: 9176958] ℹ️  DOB normalized: 09/29/1944
[22:18:16] [DOC: 9176958] ℹ️  Episode startOfEpisode normalized: 08/15/2024
[22:18:16] [DOC: 9176958] ✅ Patient date processing completed successfully
[22:18:16] ✅    ✅ Date processing completed
[22:18:16] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '08/15/2024', 'firstDiagnosis': 'Parkinsons', 'secondDiagnosis': 'CHF Exacerbation', 'thirdDiagnosis': 'COPD', 'fourthDiagnosis': 'CVA', 'fifthDiagnosis': 'A fib', 'sixthDiagnosis': ''}]
[22:18:16] 🔄 
🔄 Step 4: Extracting order data...
[22:18:19] ℹ️  Order extraction - MRN: 'MA221012094404'
[22:18:19] ℹ️  Order extraction - Sex: 'FEMALE'
[22:18:19] ℹ️  Order extraction - Service Line: 'OT'
[22:18:19] ℹ️  Order extraction - Payer Source: ''
[22:18:19] ✅ Order data extraction completed successfully
[22:18:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:18:19] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[22:18:19] ℹ️  Service line consistent in both sources: 'OT'
[22:18:19] ✅ Patient name cross-validation successful
[22:18:19] ✅    ✅ Data merged successfully
[22:18:20] ✅    ✅ Order data extracted and validated
[22:18:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:18:20] [DOC: 9176958] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:20] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:20] 🔄 
🔄 Step 6: Pushing order to API...
[22:18:20] [DOC: 9176958] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:21] [DOC: 9176958] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:18:21] ❌    ❌ Failed to push order
[22:18:21] 🔄 
🔄 Step 7: Writing to CSV...
[22:18:21] [DOC: 9176958] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[22:18:21] [DOC: 9176958] ℹ️  Service Line extracted: 'OT'
[22:18:21] [DOC: 9176958] ℹ️  Payer Source extracted: ''
[22:18:21] [DOC: 9176958] ℹ️  Diagnosis codes being written:
[22:18:21] [DOC: 9176958] ℹ️    - Latest_Episode_Firstdiagnosis: 'Parkinsons'
[22:18:21] [DOC: 9176958] ℹ️    - Latest_Episode_Seconddiagnosis: 'CHF Exacerbation'
[22:18:21] [DOC: 9176958] ℹ️    - Latest_Episode_Thirddiagnosis: 'COPD'
[22:18:21] [DOC: 9176958] ℹ️    - Latest_Episode_Fourthdiagnosis: 'CVA'
[22:18:21] [DOC: 9176958] ℹ️    - Latest_Episode_Fifthdiagnosis: 'A fib'
[22:18:21] [DOC: 9176958] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:18:21] [DOC: 9176958] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: OT | Payer:  | MRN: MA221012094404
[22:18:21] ✅    ✅ Document 9176958 processed and saved successfully
[22:18:21] 🔄 
🔄 Step 8: Saving API details...
[22:18:21] [DOC: 9176958] ℹ️  API push details saved for document 9176958
[22:18:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176954                         ║
================================================================================
[22:18:21] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:18:21] ℹ️  Date: 03/12/2025
[22:18:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:18:24] [DOC: 9176954] ✅ Text extracted using pdfplumber (1589 chars)
[22:18:24] ✅    ✅ Text extracted using pdfplumber (1577 chars)
[22:18:24] 🔄 
🔄 Step 2: Extracting patient data...
[22:18:27] ℹ️  AI extracted raw sex value: ''
[22:18:27] ℹ️  AI extracted service line: 'Physical Therapy'
[22:18:27] ℹ️  AI extracted payer source: ''
[22:18:27] ℹ️  AI extracted diagnoses:
[22:18:27] ℹ️    - Diagnosis 1: 'I11.0'
[22:18:27] ℹ️    - Diagnosis 2: 'I50.32'
[22:18:27] ℹ️    - Diagnosis 3: 'E87.6'
[22:18:27] ℹ️    - Diagnosis 4: 'None'
[22:18:27] ℹ️    - Diagnosis 5: 'None'
[22:18:27] ℹ️    - Diagnosis 6: 'None'
[22:18:27] ℹ️  Final extracted MRN: 'MA221012094404'
[22:18:27] ℹ️  Final extracted Sex: ''
[22:18:27] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:18:27] ℹ️  Final extracted Payer Source: ''
[22:18:27] ✅ Patient data extraction completed successfully
[22:18:27] ✅    ✅ Patient data extracted successfully
[22:18:27] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E87.6', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:18:27] ✅    ✅ Patient identified: Maria Ferreira
[22:18:27] ✅    ✅ Patient name validation passed
[22:18:27] 🔄 
🔄 Step 3: Processing patient dates...
[22:18:27] [DOC: 9176954] ℹ️  DOB normalized: 09/29/1944
[22:18:27] [DOC: 9176954] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[22:18:27] [DOC: 9176954] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[22:18:27] [DOC: 9176954] ✅ Patient date processing completed successfully
[22:18:27] ✅    ✅ Date processing completed
[22:18:27] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E87.6'}]
[22:18:27] 🔄 
🔄 Step 4: Extracting order data...
[22:18:30] ℹ️  Order extraction - MRN: 'MA221012094404'
[22:18:30] ℹ️  Order extraction - Sex: ''
[22:18:30] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:18:30] ℹ️  Order extraction - Payer Source: ''
[22:18:30] ✅ Order data extraction completed successfully
[22:18:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:18:30] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[22:18:30] ℹ️  Inferred sex as FEMALE from name: Maria
[22:18:30] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:18:30] ✅ Patient name cross-validation successful
[22:18:30] ✅    ✅ Data merged successfully
[22:18:31] ✅    ✅ Order data extracted and validated
[22:18:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:18:31] [DOC: 9176954] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:31] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:31] 🔄 
🔄 Step 6: Pushing order to API...
[22:18:31] [DOC: 9176954] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:32] [DOC: 9176954] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14005"}
[22:18:32] ❌    ❌ Failed to push order
[22:18:32] 🔄 
🔄 Step 7: Writing to CSV...
[22:18:32] [DOC: 9176954] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[22:18:32] [DOC: 9176954] ℹ️  Service Line extracted: 'Physical Therapy'
[22:18:32] [DOC: 9176954] ℹ️  Payer Source extracted: ''
[22:18:32] [DOC: 9176954] ℹ️  Diagnosis codes being written:
[22:18:32] [DOC: 9176954] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[22:18:32] [DOC: 9176954] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[22:18:32] [DOC: 9176954] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.6'
[22:18:32] [DOC: 9176954] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:18:32] [DOC: 9176954] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:18:32] [DOC: 9176954] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:18:32] [DOC: 9176954] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA221012094404
[22:18:32] ✅    ✅ Document 9176954 processed and saved successfully
[22:18:32] 🔄 
🔄 Step 8: Saving API details...
[22:18:32] [DOC: 9176954] ℹ️  API push details saved for document 9176954
[22:18:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176950                         ║
================================================================================
[22:18:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:18:32] ℹ️  Date: 03/12/2025
[22:18:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:18:41] [DOC: 9176950] ✅ Text extracted using pdfplumber (20021 chars)
[22:18:41] ✅    ✅ Text extracted using pdfplumber (20021 chars)
[22:18:41] 🔄 
🔄 Step 2: Extracting patient data...
[22:18:44] ℹ️  AI extracted raw sex value: 'F'
[22:18:44] ℹ️  AI extracted service line: 'PT'
[22:18:44] ℹ️  AI extracted payer source: ''
[22:18:44] ℹ️  AI extracted diagnoses:
[22:18:44] ℹ️    - Diagnosis 1: 'I50.9'
[22:18:44] ℹ️    - Diagnosis 2: 'I27.89'
[22:18:44] ℹ️    - Diagnosis 3: 'None'
[22:18:44] ℹ️    - Diagnosis 4: 'None'
[22:18:44] ℹ️    - Diagnosis 5: 'None'
[22:18:44] ℹ️    - Diagnosis 6: 'None'
[22:18:44] ℹ️  Final extracted MRN: 'MA221012094404'
[22:18:44] ℹ️  Final extracted Sex: 'FEMALE'
[22:18:44] ℹ️  Final extracted Service Line: 'PT'
[22:18:44] ℹ️  Final extracted Payer Source: ''
[22:18:44] ✅ Patient data extraction completed successfully
[22:18:44] ✅    ✅ Patient data extracted successfully
[22:18:44] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/29/25', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:18:44] ✅    ✅ Patient identified: Maria Ferreira
[22:18:44] ✅    ✅ Patient name validation passed
[22:18:44] 🔄 
🔄 Step 3: Processing patient dates...
[22:18:44] [DOC: 9176950] ℹ️  DOB normalized: 09/29/1944
[22:18:44] [DOC: 9176950] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[22:18:44] [DOC: 9176950] ⚠️  Invalid endOfEpisode format: 03/29/25
[22:18:44] [DOC: 9176950] ✅ Patient date processing completed successfully
[22:18:44] ✅    ✅ Date processing completed
[22:18:44] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/29/25', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89'}]
[22:18:44] 🔄 
🔄 Step 4: Extracting order data...
[22:18:47] ℹ️  Order extraction - MRN: 'MA221012094404'
[22:18:47] ℹ️  Order extraction - Sex: 'FEMALE'
[22:18:47] ℹ️  Order extraction - Service Line: 'PT'
[22:18:47] ℹ️  Order extraction - Payer Source: ''
[22:18:47] ✅ Order data extraction completed successfully
[22:18:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:18:47] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[22:18:47] ℹ️  Service line consistent in both sources: 'PT'
[22:18:47] ✅ Patient name cross-validation successful
[22:18:47] ✅    ✅ Data merged successfully
[22:18:48] ✅    ✅ Order data extracted and validated
[22:18:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:18:48] [DOC: 9176950] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:48] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:48] 🔄 
🔄 Step 6: Pushing order to API...
[22:18:48] [DOC: 9176950] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:18:49] [DOC: 9176950] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:18:49] ❌    ❌ Failed to push order
[22:18:49] 🔄 
🔄 Step 7: Writing to CSV...
[22:18:49] [DOC: 9176950] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[22:18:49] [DOC: 9176950] ℹ️  Service Line extracted: 'PT'
[22:18:49] [DOC: 9176950] ℹ️  Payer Source extracted: ''
[22:18:49] [DOC: 9176950] ℹ️  Diagnosis codes being written:
[22:18:49] [DOC: 9176950] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.9'
[22:18:49] [DOC: 9176950] ℹ️    - Latest_Episode_Seconddiagnosis: 'I27.89'
[22:18:49] [DOC: 9176950] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:18:49] [DOC: 9176950] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:18:49] [DOC: 9176950] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:18:49] [DOC: 9176950] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:18:49] [DOC: 9176950] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA221012094404
[22:18:49] ✅    ✅ Document 9176950 processed and saved successfully
[22:18:49] 🔄 
🔄 Step 8: Saving API details...
[22:18:49] [DOC: 9176950] ℹ️  API push details saved for document 9176950
[22:18:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176948                         ║
================================================================================
[22:18:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:18:49] ℹ️  Date: 03/12/2025
[22:18:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:18:53] [DOC: 9176948] ✅ Text extracted using pdfplumber (20021 chars)
[22:18:53] ✅    ✅ Text extracted using pdfplumber (20021 chars)
[22:18:53] 🔄 
🔄 Step 2: Extracting patient data...
[22:18:56] ℹ️  AI extracted raw sex value: 'F'
[22:18:56] ℹ️  AI extracted service line: 'PT'
[22:18:56] ℹ️  AI extracted payer source: ''
[22:18:56] ℹ️  AI extracted diagnoses:
[22:18:56] ℹ️    - Diagnosis 1: 'I50.9'
[22:18:56] ℹ️    - Diagnosis 2: 'I27.89'
[22:18:56] ℹ️    - Diagnosis 3: ''
[22:18:56] ℹ️    - Diagnosis 4: ''
[22:18:56] ℹ️    - Diagnosis 5: ''
[22:18:56] ℹ️    - Diagnosis 6: ''
[22:18:56] ℹ️  Final extracted MRN: 'MA221012094404'
[22:18:56] ℹ️  Final extracted Sex: 'FEMALE'
[22:18:56] ℹ️  Final extracted Service Line: 'PT'
[22:18:56] ℹ️  Final extracted Payer Source: ''
[22:18:56] ✅ Patient data extraction completed successfully
[22:18:56] ✅    ✅ Patient data extracted successfully
[22:18:56] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/29/25', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:18:56] ✅    ✅ Patient identified: Maria Ferreira
[22:18:56] ✅    ✅ Patient name validation passed
[22:18:56] 🔄 
🔄 Step 3: Processing patient dates...
[22:18:56] [DOC: 9176948] ℹ️  DOB normalized: 09/29/1944
[22:18:56] [DOC: 9176948] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[22:18:56] [DOC: 9176948] ⚠️  Invalid endOfEpisode format: 03/29/25
[22:18:56] [DOC: 9176948] ✅ Patient date processing completed successfully
[22:18:56] ✅    ✅ Date processing completed
[22:18:56] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/29/25', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:18:56] 🔄 
🔄 Step 4: Extracting order data...
[22:18:59] ℹ️  Order extraction - MRN: 'MA221012094404'
[22:18:59] ℹ️  Order extraction - Sex: 'FEMALE'
[22:18:59] ℹ️  Order extraction - Service Line: 'PT'
[22:18:59] ℹ️  Order extraction - Payer Source: ''
[22:18:59] ✅ Order data extraction completed successfully
[22:18:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:18:59] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[22:18:59] ℹ️  Service line consistent in both sources: 'PT'
[22:18:59] ✅ Patient name cross-validation successful
[22:18:59] ✅    ✅ Data merged successfully
[22:19:01] ✅    ✅ Order data extracted and validated
[22:19:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:19:01] [DOC: 9176948] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:19:01] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:19:01] 🔄 
🔄 Step 6: Pushing order to API...
[22:19:01] [DOC: 9176948] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:19:02] [DOC: 9176948] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:19:02] ❌    ❌ Failed to push order
[22:19:02] 🔄 
🔄 Step 7: Writing to CSV...
[22:19:02] [DOC: 9176948] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[22:19:02] [DOC: 9176948] ℹ️  Service Line extracted: 'PT'
[22:19:02] [DOC: 9176948] ℹ️  Payer Source extracted: ''
[22:19:02] [DOC: 9176948] ℹ️  Diagnosis codes being written:
[22:19:02] [DOC: 9176948] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.9'
[22:19:02] [DOC: 9176948] ℹ️    - Latest_Episode_Seconddiagnosis: 'I27.89'
[22:19:02] [DOC: 9176948] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:19:02] [DOC: 9176948] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:19:02] [DOC: 9176948] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:19:02] [DOC: 9176948] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:19:02] [DOC: 9176948] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA221012094404
[22:19:02] ✅    ✅ Document 9176948 processed and saved successfully
[22:19:02] 🔄 
🔄 Step 8: Saving API details...
[22:19:02] [DOC: 9176948] ℹ️  API push details saved for document 9176948
[22:19:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176945                         ║
================================================================================
[22:19:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:19:02] ℹ️  Date: 03/12/2025
[22:19:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:19:04] [DOC: 9176945] ✅ Text extracted using pdfplumber (8646 chars)
[22:19:04] ✅    ✅ Text extracted using pdfplumber (8646 chars)
[22:19:04] 🔄 
🔄 Step 2: Extracting patient data...
[22:19:07] ℹ️  AI extracted raw sex value: 'F'
[22:19:07] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[22:19:07] ℹ️  AI extracted payer source: 'None'
[22:19:07] ℹ️  AI extracted diagnoses:
[22:19:07] ℹ️    - Diagnosis 1: 'I110'
[22:19:07] ℹ️    - Diagnosis 2: 'I5032'
[22:19:07] ℹ️    - Diagnosis 3: 'None'
[22:19:07] ℹ️    - Diagnosis 4: 'None'
[22:19:07] ℹ️    - Diagnosis 5: 'None'
[22:19:07] ℹ️    - Diagnosis 6: 'None'
[22:19:07] ℹ️  Final extracted MRN: 'MA221012094404'
[22:19:07] ℹ️  Final extracted Sex: 'FEMALE'
[22:19:07] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[22:19:07] ℹ️  Final extracted Payer Source: ''
[22:19:07] ✅ Patient data extraction completed successfully
[22:19:07] ✅    ✅ Patient data extracted successfully
[22:19:07] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:19:07] ✅    ✅ Patient identified: Maria Ferreira
[22:19:07] ✅    ✅ Patient name validation passed
[22:19:07] 🔄 
🔄 Step 3: Processing patient dates...
[22:19:07] [DOC: 9176945] ℹ️  DOB normalized: 09/29/1944
[22:19:07] [DOC: 9176945] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[22:19:07] [DOC: 9176945] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[22:19:07] [DOC: 9176945] ✅ Patient date processing completed successfully
[22:19:07] ✅    ✅ Date processing completed
[22:19:07] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032'}]
[22:19:07] 🔄 
🔄 Step 4: Extracting order data...
[22:19:10] ℹ️  Order extraction - MRN: 'MA221012094404'
[22:19:10] ℹ️  Order extraction - Sex: 'FEMALE'
[22:19:10] ℹ️  Order extraction - Service Line: 'PT, OT, SN'
[22:19:10] ℹ️  Order extraction - Payer Source: ''
[22:19:10] ✅ Order data extraction completed successfully
[22:19:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:19:10] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[22:19:10] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy, Skilled Nursing' + Order='PT, OT, SN' = 'OT, Occupational Therapy, PT, Physical Therapy, SN, Skilled Nursing'
[22:19:10] ✅ Patient name cross-validation successful
[22:19:10] ✅    ✅ Data merged successfully
[22:19:11] ✅    ✅ Order data extracted and validated
[22:19:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:19:11] [DOC: 9176945] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:19:11] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:19:11] 🔄 
🔄 Step 6: Pushing order to API...
[22:19:11] [DOC: 9176945] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[22:19:12] [DOC: 9176945] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13984"}
[22:19:12] ❌    ❌ Failed to push order
[22:19:12] 🔄 
🔄 Step 7: Writing to CSV...
[22:19:12] [DOC: 9176945] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[22:19:12] [DOC: 9176945] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, SN, Skilled Nursing'
[22:19:12] [DOC: 9176945] ℹ️  Payer Source extracted: ''
[22:19:12] [DOC: 9176945] ℹ️  Diagnosis codes being written:
[22:19:12] [DOC: 9176945] ℹ️    - Latest_Episode_Firstdiagnosis: 'I110'
[22:19:12] [DOC: 9176945] ℹ️    - Latest_Episode_Seconddiagnosis: 'I5032'
[22:19:12] [DOC: 9176945] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:19:12] [DOC: 9176945] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:19:12] [DOC: 9176945] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:19:12] [DOC: 9176945] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:19:12] [DOC: 9176945] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: OT, Occupational Therapy, PT, Physical Therapy, SN, Skilled Nursing | Payer:  | MRN: MA221012094404
[22:19:12] ✅    ✅ Document 9176945 processed and saved successfully
[22:19:12] 🔄 
🔄 Step 8: Saving API details...
[22:19:12] [DOC: 9176945] ℹ️  API push details saved for document 9176945
[22:19:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176911                         ║
================================================================================
[22:19:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:19:12] ℹ️  Date: 03/12/2025
[22:19:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:19:16] [DOC: 9176911] ✅ Text extracted using pdfplumber (13027 chars)
[22:19:16] ✅    ✅ Text extracted using pdfplumber (13027 chars)
[22:19:16] 🔄 
🔄 Step 2: Extracting patient data...
[22:19:19] ℹ️  AI extracted raw sex value: 'F'
[22:19:19] ℹ️  AI extracted service line: 'OT'
[22:19:19] ℹ️  AI extracted payer source: 'None'
[22:19:19] ℹ️  AI extracted diagnoses:
[22:19:19] ℹ️    - Diagnosis 1: 'None'
[22:19:19] ℹ️    - Diagnosis 2: 'None'
[22:19:19] ℹ️    - Diagnosis 3: 'None'
[22:19:19] ℹ️    - Diagnosis 4: 'None'
[22:19:19] ℹ️    - Diagnosis 5: 'None'
[22:19:19] ℹ️    - Diagnosis 6: 'None'
[22:19:19] ℹ️  Final extracted MRN: 'MA220701015501'
[22:19:19] ℹ️  Final extracted Sex: 'FEMALE'
[22:19:19] ℹ️  Final extracted Service Line: 'OT'
[22:19:19] ℹ️  Final extracted Payer Source: ''
[22:19:19] ✅ Patient data extraction completed successfully
[22:19:19] ✅    ✅ Patient data extracted successfully
[22:19:19] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/12/2022', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:19:19] ✅    ✅ Patient identified: Ada Burns
[22:19:19] ✅    ✅ Patient name validation passed
[22:19:19] 🔄 
🔄 Step 3: Processing patient dates...
[22:19:19] [DOC: 9176911] ℹ️  DOB normalized: 01/15/1955
[22:19:19] [DOC: 9176911] ℹ️  Episode startOfEpisode normalized: 07/12/2022
[22:19:19] [DOC: 9176911] ✅ Patient date processing completed successfully
[22:19:19] ✅    ✅ Date processing completed
[22:19:19] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/12/2022'}]
[22:19:19] 🔄 
🔄 Step 4: Extracting order data...
[22:19:22] ℹ️  Order extraction - MRN: 'MA220701015501'
[22:19:22] ℹ️  Order extraction - Sex: 'FEMALE'
[22:19:22] ℹ️  Order extraction - Service Line: 'OT'
[22:19:22] ℹ️  Order extraction - Payer Source: ''
[22:19:22] ✅ Order data extraction completed successfully
[22:19:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:19:22] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[22:19:22] ℹ️  Service line consistent in both sources: 'OT'
[22:19:22] ✅ Patient name cross-validation successful
[22:19:22] ✅    ✅ Data merged successfully
[22:19:23] ✅    ✅ Order data extracted and validated
[22:19:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:19:23] [DOC: 9176911] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[22:19:23] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[22:19:23] 🔄 
🔄 Step 6: Pushing order to API...
[22:19:23] [DOC: 9176911] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[22:19:24] [DOC: 9176911] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:19:24] ❌    ❌ Failed to push order
[22:19:24] 🔄 
🔄 Step 7: Writing to CSV...
[22:19:24] [DOC: 9176911] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[22:19:24] [DOC: 9176911] ℹ️  Service Line extracted: 'OT'
[22:19:24] [DOC: 9176911] ℹ️  Payer Source extracted: ''
[22:19:24] [DOC: 9176911] ℹ️  Diagnosis codes being written:
[22:19:24] [DOC: 9176911] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:19:24] [DOC: 9176911] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:19:24] [DOC: 9176911] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:19:24] [DOC: 9176911] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:19:24] [DOC: 9176911] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:19:24] [DOC: 9176911] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:19:24] [DOC: 9176911] ✅ Patient data written to CSV: Ada Burns | Sex: FEMALE | Age: 70 | Service: OT | Payer:  | MRN: MA220701015501
[22:19:24] ✅    ✅ Document 9176911 processed and saved successfully
[22:19:24] 🔄 
🔄 Step 8: Saving API details...
[22:19:24] [DOC: 9176911] ℹ️  API push details saved for document 9176911
[22:19:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176838                         ║
================================================================================
[22:19:24] ℹ️  Agency: Compassionate Care Hospice-Taunton
[22:19:24] ℹ️  Date: 03/12/2025
[22:19:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:19:29] [DOC: 9176838] ✅ Text extracted using pdfplumber (2157 chars)
[22:19:29] ✅    ✅ Text extracted using pdfplumber (2145 chars)
[22:19:29] 🔄 
🔄 Step 2: Extracting patient data...
[22:19:32] ℹ️  AI extracted raw sex value: ''
[22:19:32] ℹ️  AI extracted service line: 'Hospice'
[22:19:32] ℹ️  AI extracted payer source: 'Medicare'
[22:19:32] ℹ️  AI extracted diagnoses:
[22:19:32] ℹ️    - Diagnosis 1: 'None'
[22:19:32] ℹ️    - Diagnosis 2: 'None'
[22:19:32] ℹ️    - Diagnosis 3: 'None'
[22:19:32] ℹ️    - Diagnosis 4: 'None'
[22:19:32] ℹ️    - Diagnosis 5: 'None'
[22:19:32] ℹ️    - Diagnosis 6: 'None'
[22:19:32] ℹ️  Final extracted MRN: 'B3700296223202'
[22:19:32] ℹ️  Final extracted Sex: ''
[22:19:32] ℹ️  Final extracted Service Line: 'Hospice'
[22:19:32] ℹ️  Final extracted Payer Source: 'Medicare'
[22:19:32] ✅ Patient data extraction completed successfully
[22:19:32] ✅    ✅ Patient data extracted successfully
[22:19:32] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:19:32] ✅    ✅ Patient identified: MARIA JARDIM
[22:19:32] ✅    ✅ Patient name validation passed
[22:19:32] 🔄 
🔄 Step 3: Processing patient dates...
[22:19:32] [DOC: 9176838] ℹ️  DOB normalized: 05/20/1931
[22:19:32] [DOC: 9176838] ✅ Patient date processing completed successfully
[22:19:32] ✅    ✅ Date processing completed
[22:19:32] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[22:19:32] 🔄 
🔄 Step 4: Extracting order data...
[22:19:34] ℹ️  Order extraction - MRN: 'B3700296223202'
[22:19:34] ℹ️  Order extraction - Sex: ''
[22:19:34] ℹ️  Order extraction - Service Line: 'Hospice'
[22:19:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:19:34] ✅ Order data extraction completed successfully
[22:19:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:19:34] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[22:19:34] ℹ️  Inferred sex as FEMALE from name: MARIA
[22:19:34] ℹ️  Service line consistent in both sources: 'Hospice'
[22:19:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:19:34] ✅ Patient name cross-validation successful
[22:19:34] ✅    ✅ Data merged successfully
[22:19:36] ⚠️     ❌ Skipping - missing episode start date
[22:19:36] [DOC: 9176838] ℹ️  API push details saved for document 9176838
================================================================================
║                        Processing Document ID: 9176742                         ║
================================================================================
[22:19:36] ℹ️  Agency: Fairhaven HH&H
[22:19:36] ℹ️  Date: 03/12/2025
[22:19:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:19:38] [DOC: 9176742] ✅ Text extracted using pdfplumber (1314 chars)
[22:19:38] ✅    ✅ Text extracted using pdfplumber (1314 chars)
[22:19:38] 🔄 
🔄 Step 2: Extracting patient data...
[22:19:40] ℹ️  AI extracted raw sex value: 'M'
[22:19:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:19:40] ℹ️  AI extracted payer source: 'Medicare'
[22:19:40] ℹ️  AI extracted diagnoses:
[22:19:40] ℹ️    - Diagnosis 1: ''
[22:19:40] ℹ️    - Diagnosis 2: ''
[22:19:40] ℹ️    - Diagnosis 3: ''
[22:19:40] ℹ️    - Diagnosis 4: ''
[22:19:40] ℹ️    - Diagnosis 5: ''
[22:19:40] ℹ️    - Diagnosis 6: ''
[22:19:40] ℹ️  Final extracted MRN: '2486002'
[22:19:40] ℹ️  Final extracted Sex: 'MALE'
[22:19:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:19:40] ℹ️  Final extracted Payer Source: 'Medicare'
[22:19:40] ✅ Patient data extraction completed successfully
[22:19:40] ✅    ✅ Patient data extracted successfully
[22:19:40] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Andrade
     └─ dob: 06/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2486002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '12/19/2024', 'endOfEpisode': '03/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:19:40] ✅    ✅ Patient identified: Robert Andrade
[22:19:40] ✅    ✅ Patient name validation passed
[22:19:40] 🔄 
🔄 Step 3: Processing patient dates...
[22:19:40] [DOC: 9176742] ℹ️  DOB normalized: 06/25/1943
[22:19:40] [DOC: 9176742] ℹ️  Episode startOfCare normalized: 12/19/2024
[22:19:40] [DOC: 9176742] ℹ️  Episode startOfEpisode normalized: 12/19/2024
[22:19:40] [DOC: 9176742] ℹ️  Episode endOfEpisode normalized: 03/18/2025
[22:19:40] [DOC: 9176742] ✅ Patient date processing completed successfully
[22:19:40] ✅    ✅ Date processing completed
[22:19:40] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Andrade
     └─ dob: 06/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2486002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '12/19/2024', 'endOfEpisode': '03/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:19:40] 🔄 
🔄 Step 4: Extracting order data...
[22:19:43] ℹ️  Order extraction - MRN: ''
[22:19:43] ℹ️  Order extraction - Sex: 'MALE'
[22:19:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:19:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:19:43] ✅ Order data extraction completed successfully
[22:19:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:19:43] ℹ️  Using MRN from patient data: '2486002'
[22:19:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:19:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:19:43] ✅ Patient name cross-validation successful
[22:19:43] ✅    ✅ Data merged successfully
[22:19:44] ✅    ✅ Order data extracted and validated
[22:19:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:19:44] [DOC: 9176742] ✅ Patient found in local cache: Robert Andrade, ID: e367e440-5660-423f-9c06-de94c71235ec
[22:19:44] ✅    ✅ Existing patient found with ID: e367e440-5660-423f-9c06-de94c71235ec
[22:19:44] 🔄 
🔄 Step 6: Pushing order to API...
[22:19:44] [DOC: 9176742] ℹ️  Pushing order via API for patient ID: e367e440-5660-423f-9c06-de94c71235ec
[22:19:45] [DOC: 9176742] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:19:45] ❌    ❌ Failed to push order
[22:19:45] 🔄 
🔄 Step 7: Writing to CSV...
[22:19:45] [DOC: 9176742] ℹ️  Calculated age: 81 from DOB: 06/25/1943
[22:19:45] [DOC: 9176742] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:19:45] [DOC: 9176742] ℹ️  Payer Source extracted: 'Medicare'
[22:19:45] [DOC: 9176742] ℹ️  Diagnosis codes being written:
[22:19:45] [DOC: 9176742] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:19:45] [DOC: 9176742] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:19:45] [DOC: 9176742] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:19:45] [DOC: 9176742] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:19:45] [DOC: 9176742] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:19:45] [DOC: 9176742] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:19:45] [DOC: 9176742] ✅ Patient data written to CSV: Robert Andrade | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: 2486002
[22:19:45] ✅    ✅ Document 9176742 processed and saved successfully
[22:19:45] 🔄 
🔄 Step 8: Saving API details...
[22:19:45] [DOC: 9176742] ℹ️  API push details saved for document 9176742
[22:19:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176733                         ║
================================================================================
[22:19:45] ℹ️  Agency: Fairhaven HH&H
[22:19:45] ℹ️  Date: 03/12/2025
[22:19:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:19:47] [DOC: 9176733] ✅ Text extracted using pdfplumber (1219 chars)
[22:19:47] ✅    ✅ Text extracted using pdfplumber (1219 chars)
[22:19:47] 🔄 
🔄 Step 2: Extracting patient data...
[22:19:49] ℹ️  AI extracted raw sex value: 'F'
[22:19:49] ℹ️  AI extracted service line: 'Hospice'
[22:19:49] ℹ️  AI extracted payer source: 'Medicare'
[22:19:49] ℹ️  AI extracted diagnoses:
[22:19:49] ℹ️    - Diagnosis 1: ''
[22:19:49] ℹ️    - Diagnosis 2: ''
[22:19:49] ℹ️    - Diagnosis 3: ''
[22:19:49] ℹ️    - Diagnosis 4: ''
[22:19:49] ℹ️    - Diagnosis 5: ''
[22:19:49] ℹ️    - Diagnosis 6: ''
[22:19:49] ℹ️  Final extracted MRN: '4668015'
[22:19:49] ℹ️  Final extracted Sex: 'FEMALE'
[22:19:49] ℹ️  Final extracted Service Line: 'Hospice'
[22:19:49] ℹ️  Final extracted Payer Source: 'Medicare'
[22:19:49] ✅ Patient data extraction completed successfully
[22:19:49] ✅    ✅ Patient data extracted successfully
[22:19:49] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Arroyo
     └─ dob: 05/16/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4668015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:19:49] ✅    ✅ Patient identified: Carol Arroyo
[22:19:49] ✅    ✅ Patient name validation passed
[22:19:49] 🔄 
🔄 Step 3: Processing patient dates...
[22:19:49] [DOC: 9176733] ℹ️  DOB normalized: 05/16/1941
[22:19:49] [DOC: 9176733] ℹ️  Episode startOfCare normalized: 05/28/2024
[22:19:49] [DOC: 9176733] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[22:19:49] [DOC: 9176733] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[22:19:49] [DOC: 9176733] ✅ Patient date processing completed successfully
[22:19:49] ✅    ✅ Date processing completed
[22:19:49] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Arroyo
     └─ dob: 05/16/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4668015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:19:49] 🔄 
🔄 Step 4: Extracting order data...
[22:19:52] ℹ️  Order extraction - MRN: '4668015'
[22:19:52] ℹ️  Order extraction - Sex: 'FEMALE'
[22:19:52] ℹ️  Order extraction - Service Line: 'Hospice'
[22:19:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:19:52] ✅ Order data extraction completed successfully
[22:19:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:19:52] ℹ️  Using MRN from patient data: '4668015' over '4668015'
[22:19:52] ℹ️  Service line consistent in both sources: 'Hospice'
[22:19:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:19:52] ✅ Patient name cross-validation successful
[22:19:52] ✅    ✅ Data merged successfully
[22:19:53] ✅    ✅ Order data extracted and validated
[22:19:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:20:06] [DOC: 9176733] ✅ Patient exists in API: Carol Arroyo, ID: 14bc2f83-eec9-4276-9b44-66905e98bb36
[22:20:06] ✅    ✅ Existing patient found with ID: 14bc2f83-eec9-4276-9b44-66905e98bb36
[22:20:06] 🔄 
🔄 Step 6: Pushing order to API...
[22:20:06] [DOC: 9176733] ℹ️  Pushing order via API for patient ID: 14bc2f83-eec9-4276-9b44-66905e98bb36
[22:20:07] [DOC: 9176733] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:20:07] ❌    ❌ Failed to push order
[22:20:07] 🔄 
🔄 Step 7: Writing to CSV...
[22:20:07] [DOC: 9176733] ℹ️  Calculated age: 84 from DOB: 05/16/1941
[22:20:07] [DOC: 9176733] ℹ️  Service Line extracted: 'Hospice'
[22:20:07] [DOC: 9176733] ℹ️  Payer Source extracted: 'Medicare'
[22:20:07] [DOC: 9176733] ℹ️  Diagnosis codes being written:
[22:20:07] [DOC: 9176733] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:20:07] [DOC: 9176733] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:20:07] [DOC: 9176733] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:20:07] [DOC: 9176733] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:20:07] [DOC: 9176733] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:20:07] [DOC: 9176733] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:20:07] [DOC: 9176733] ✅ Patient data written to CSV: Carol Arroyo | Sex: FEMALE | Age: 84 | Service: Hospice | Payer: Medicare | MRN: 4668015
[22:20:07] ✅    ✅ Document 9176733 processed and saved successfully
[22:20:07] 🔄 
🔄 Step 8: Saving API details...
[22:20:07] [DOC: 9176733] ℹ️  API push details saved for document 9176733
[22:20:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176731                         ║
================================================================================
[22:20:07] ℹ️  Agency: Fairhaven HH&H
[22:20:07] ℹ️  Date: 03/12/2025
[22:20:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:20:09] [DOC: 9176731] ✅ Text extracted using pdfplumber (1232 chars)
[22:20:09] ✅    ✅ Text extracted using pdfplumber (1232 chars)
[22:20:09] 🔄 
🔄 Step 2: Extracting patient data...
[22:20:12] ℹ️  AI extracted raw sex value: 'M'
[22:20:12] ℹ️  AI extracted service line: 'Hospice'
[22:20:12] ℹ️  AI extracted payer source: 'Medicare'
[22:20:12] ℹ️  AI extracted diagnoses:
[22:20:12] ℹ️    - Diagnosis 1: ''
[22:20:12] ℹ️    - Diagnosis 2: ''
[22:20:12] ℹ️    - Diagnosis 3: ''
[22:20:12] ℹ️    - Diagnosis 4: ''
[22:20:12] ℹ️    - Diagnosis 5: ''
[22:20:12] ℹ️    - Diagnosis 6: ''
[22:20:12] ℹ️  Final extracted MRN: '5021009'
[22:20:12] ℹ️  Final extracted Sex: 'MALE'
[22:20:12] ℹ️  Final extracted Service Line: 'Hospice'
[22:20:12] ℹ️  Final extracted Payer Source: 'Medicare'
[22:20:12] ✅ Patient data extraction completed successfully
[22:20:12] ✅    ✅ Patient data extracted successfully
[22:20:12] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:20:12] ✅    ✅ Patient identified: William Hughes
[22:20:12] ✅    ✅ Patient name validation passed
[22:20:12] 🔄 
🔄 Step 3: Processing patient dates...
[22:20:12] [DOC: 9176731] ℹ️  DOB normalized: 07/10/1937
[22:20:12] [DOC: 9176731] ℹ️  Episode startOfCare normalized: 11/20/2024
[22:20:12] [DOC: 9176731] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[22:20:12] [DOC: 9176731] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[22:20:12] [DOC: 9176731] ✅ Patient date processing completed successfully
[22:20:12] ✅    ✅ Date processing completed
[22:20:12] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:20:12] 🔄 
🔄 Step 4: Extracting order data...
[22:20:14] ℹ️  Order extraction - MRN: ''
[22:20:14] ℹ️  Order extraction - Sex: 'MALE'
[22:20:14] ℹ️  Order extraction - Service Line: 'Hospice'
[22:20:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:20:14] ✅ Order data extraction completed successfully
[22:20:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:20:14] ℹ️  Using MRN from patient data: '5021009'
[22:20:14] ℹ️  Service line consistent in both sources: 'Hospice'
[22:20:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:20:14] ✅ Patient name cross-validation successful
[22:20:14] ✅    ✅ Data merged successfully
[22:20:15] ✅    ✅ Order data extracted and validated
[22:20:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:20:48] [DOC: 9176731] ℹ️  Patient not found in cache or API: William Hughes
[22:20:48] [DOC: 9176731] ℹ️  Patient not found, creating new patient via API...
[22:20:48] [DOC: 9176731] ℹ️  Creating patient via API: William Hughes
[22:20:50] [DOC: 9176731] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:20:50] ❌    ❌ Failed to create patient
[22:20:50] [DOC: 9176731] ℹ️  API push details saved for document 9176731
================================================================================
║                        Processing Document ID: 9176724                         ║
================================================================================
[22:20:50] ℹ️  Agency: Dartmouth HH
[22:20:50] ℹ️  Date: 03/12/2025
[22:20:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:20:53] [DOC: 9176724] ✅ Text extracted using pdfplumber (10940 chars)
[22:20:53] ✅    ✅ Text extracted using pdfplumber (10928 chars)
[22:20:53] 🔄 
🔄 Step 2: Extracting patient data...
[22:20:56] ℹ️  AI extracted raw sex value: 'F'
[22:20:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:20:56] ℹ️  AI extracted payer source: ''
[22:20:56] ℹ️  AI extracted diagnoses:
[22:20:56] ℹ️    - Diagnosis 1: 'I50.32'
[22:20:56] ℹ️    - Diagnosis 2: 'I13.0'
[22:20:56] ℹ️    - Diagnosis 3: 'N18.32'
[22:20:56] ℹ️    - Diagnosis 4: 'I48.0'
[22:20:56] ℹ️    - Diagnosis 5: 'I25.10'
[22:20:56] ℹ️    - Diagnosis 6: 'D50.0'
[22:20:56] ℹ️  Final extracted MRN: '771002'
[22:20:56] ℹ️  Final extracted Sex: 'FEMALE'
[22:20:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:20:56] ℹ️  Final extracted Payer Source: ''
[22:20:56] ✅ Patient data extraction completed successfully
[22:20:56] ✅    ✅ Patient data extracted successfully
[22:20:56] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/13/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'D50.0'}]
[22:20:56] ✅    ✅ Patient identified: Kathryn McCollester
[22:20:56] ✅    ✅ Patient name validation passed
[22:20:56] 🔄 
🔄 Step 3: Processing patient dates...
[22:20:56] [DOC: 9176724] ℹ️  DOB normalized: 09/24/1930
[22:20:56] [DOC: 9176724] ℹ️  Episode startOfCare normalized: 02/13/2025
[22:20:56] [DOC: 9176724] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[22:20:56] [DOC: 9176724] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[22:20:56] [DOC: 9176724] ✅ Patient date processing completed successfully
[22:20:56] ✅    ✅ Date processing completed
[22:20:56] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/13/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'D50.0'}]
[22:20:56] 🔄 
🔄 Step 4: Extracting order data...
[22:20:59] ℹ️  Order extraction - MRN: '771002'
[22:20:59] ℹ️  Order extraction - Sex: 'FEMALE'
[22:20:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:20:59] ℹ️  Order extraction - Payer Source: ''
[22:20:59] ✅ Order data extraction completed successfully
[22:20:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:20:59] ℹ️  Using MRN from patient data: '771002' over '771002'
[22:20:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:20:59] ✅ Patient name cross-validation successful
[22:20:59] ✅    ✅ Data merged successfully
[22:21:00] ✅    ✅ Order data extracted and validated
[22:21:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:21:00] [DOC: 9176724] ✅ Patient found in local cache: Kathryn McCollester, ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[22:21:00] ✅    ✅ Existing patient found with ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[22:21:00] 🔄 
🔄 Step 6: Pushing order to API...
[22:21:00] [DOC: 9176724] ℹ️  Pushing order via API for patient ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[22:21:01] [DOC: 9176724] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:21:01] ❌    ❌ Failed to push order
[22:21:01] 🔄 
🔄 Step 7: Writing to CSV...
[22:21:01] [DOC: 9176724] ℹ️  Calculated age: 94 from DOB: 09/24/1930
[22:21:01] [DOC: 9176724] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:21:01] [DOC: 9176724] ℹ️  Payer Source extracted: ''
[22:21:01] [DOC: 9176724] ℹ️  Diagnosis codes being written:
[22:21:01] [DOC: 9176724] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.32'
[22:21:01] [DOC: 9176724] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[22:21:01] [DOC: 9176724] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.32'
[22:21:01] [DOC: 9176724] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[22:21:01] [DOC: 9176724] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[22:21:01] [DOC: 9176724] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D50.0'
[22:21:01] [DOC: 9176724] ✅ Patient data written to CSV: Kathryn McCollester | Sex: FEMALE | Age: 94 | Service: Skilled Nursing | Payer:  | MRN: 771002
[22:21:01] ✅    ✅ Document 9176724 processed and saved successfully
[22:21:01] 🔄 
🔄 Step 8: Saving API details...
[22:21:01] [DOC: 9176724] ℹ️  API push details saved for document 9176724
[22:21:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176713                         ║
================================================================================
[22:21:01] ℹ️  Agency: Dartmouth HH
[22:21:01] ℹ️  Date: 03/12/2025
[22:21:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:21:05] [DOC: 9176713] ✅ Text extracted using pdfplumber (12215 chars)
[22:21:05] ✅    ✅ Text extracted using pdfplumber (12215 chars)
[22:21:05] 🔄 
🔄 Step 2: Extracting patient data...
[22:21:08] ℹ️  AI extracted raw sex value: 'F'
[22:21:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:21:08] ℹ️  AI extracted payer source: ''
[22:21:08] ℹ️  AI extracted diagnoses:
[22:21:08] ℹ️    - Diagnosis 1: 'D51.0'
[22:21:08] ℹ️    - Diagnosis 2: 'E11.9'
[22:21:08] ℹ️    - Diagnosis 3: 'G89.4'
[22:21:08] ℹ️    - Diagnosis 4: 'M47.16'
[22:21:08] ℹ️    - Diagnosis 5: 'M48.061'
[22:21:08] ℹ️    - Diagnosis 6: 'M54.41'
[22:21:08] ℹ️  Final extracted MRN: '1728009'
[22:21:08] ℹ️  Final extracted Sex: 'FEMALE'
[22:21:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:21:08] ℹ️  Final extracted Payer Source: ''
[22:21:08] ✅ Patient data extraction completed successfully
[22:21:08] ✅    ✅ Patient data extracted successfully
[22:21:08] 📊 Patient Response
     └─ patientFName: Marjorie
     └─ patientLName: Oliver
     └─ dob: 03/03/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1728009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/09/2024', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'D51.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M47.16', 'fifthDiagnosis': 'M48.061', 'sixthDiagnosis': 'M54.41'}]
[22:21:08] ✅    ✅ Patient identified: Marjorie Oliver
[22:21:08] ✅    ✅ Patient name validation passed
[22:21:08] 🔄 
🔄 Step 3: Processing patient dates...
[22:21:08] [DOC: 9176713] ℹ️  DOB normalized: 03/03/1946
[22:21:08] [DOC: 9176713] ℹ️  Episode startOfCare normalized: 07/09/2024
[22:21:08] [DOC: 9176713] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[22:21:08] [DOC: 9176713] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[22:21:08] [DOC: 9176713] ✅ Patient date processing completed successfully
[22:21:08] ✅    ✅ Date processing completed
[22:21:08] 📊 Processed Patient Data
     └─ patientFName: Marjorie
     └─ patientLName: Oliver
     └─ dob: 03/03/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1728009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/09/2024', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'D51.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M47.16', 'fifthDiagnosis': 'M48.061', 'sixthDiagnosis': 'M54.41'}]
[22:21:08] 🔄 
🔄 Step 4: Extracting order data...
[22:21:10] ℹ️  Order extraction - MRN: '1728009'
[22:21:10] ℹ️  Order extraction - Sex: 'FEMALE'
[22:21:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[22:21:10] ℹ️  Order extraction - Payer Source: ''
[22:21:10] ✅ Order data extraction completed successfully
[22:21:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:21:10] ℹ️  Using MRN from patient data: '1728009' over '1728009'
[22:21:10] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[22:21:10] ✅ Patient name cross-validation successful
[22:21:10] ✅    ✅ Data merged successfully
[22:21:11] ✅    ✅ Order data extracted and validated
[22:21:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:22:26] [DOC: 9176713] ✅ Patient exists in API: Marjorie Oliver, ID: 968e6f1a-b535-4135-a7b7-5d39e4d63fc5
[22:22:26] ✅    ✅ Existing patient found with ID: 968e6f1a-b535-4135-a7b7-5d39e4d63fc5
[22:22:26] 🔄 
🔄 Step 6: Pushing order to API...
[22:22:26] [DOC: 9176713] ℹ️  Pushing order via API for patient ID: 968e6f1a-b535-4135-a7b7-5d39e4d63fc5
[22:22:28] [DOC: 9176713] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:22:28] ❌    ❌ Failed to push order
[22:22:28] 🔄 
🔄 Step 7: Writing to CSV...
[22:22:28] [DOC: 9176713] ℹ️  Calculated age: 79 from DOB: 03/03/1946
[22:22:28] [DOC: 9176713] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[22:22:28] [DOC: 9176713] ℹ️  Payer Source extracted: ''
[22:22:28] [DOC: 9176713] ℹ️  Diagnosis codes being written:
[22:22:28] [DOC: 9176713] ℹ️    - Latest_Episode_Firstdiagnosis: 'D51.0'
[22:22:28] [DOC: 9176713] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[22:22:28] [DOC: 9176713] ℹ️    - Latest_Episode_Thirddiagnosis: 'G89.4'
[22:22:28] [DOC: 9176713] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M47.16'
[22:22:28] [DOC: 9176713] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M48.061'
[22:22:28] [DOC: 9176713] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.41'
[22:22:28] [DOC: 9176713] ✅ Patient data written to CSV: Marjorie Oliver | Sex: FEMALE | Age: 79 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 1728009
[22:22:28] ✅    ✅ Document 9176713 processed and saved successfully
[22:22:28] 🔄 
🔄 Step 8: Saving API details...
[22:22:28] [DOC: 9176713] ℹ️  API push details saved for document 9176713
[22:22:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176709                         ║
================================================================================
[22:22:28] ℹ️  Agency: Dartmouth HH
[22:22:28] ℹ️  Date: 03/12/2025
[22:22:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:22:31] [DOC: 9176709] ✅ Text extracted using pdfplumber (12656 chars)
[22:22:31] ✅    ✅ Text extracted using pdfplumber (12644 chars)
[22:22:31] 🔄 
🔄 Step 2: Extracting patient data...
[22:22:34] ℹ️  AI extracted raw sex value: 'F'
[22:22:34] ℹ️  AI extracted service line: 'PT, RN'
[22:22:34] ℹ️  AI extracted payer source: 'None'
[22:22:34] ℹ️  AI extracted diagnoses:
[22:22:34] ℹ️    - Diagnosis 1: 'Z47.1'
[22:22:34] ℹ️    - Diagnosis 2: 'M70.70'
[22:22:34] ℹ️    - Diagnosis 3: 'M19.90'
[22:22:34] ℹ️    - Diagnosis 4: 'I10'
[22:22:34] ℹ️    - Diagnosis 5: 'K21.9'
[22:22:34] ℹ️    - Diagnosis 6: 'G47.00'
[22:22:34] ℹ️  Final extracted MRN: '5140015'
[22:22:34] ℹ️  Final extracted Sex: 'FEMALE'
[22:22:34] ℹ️  Final extracted Service Line: 'PT, RN'
[22:22:34] ℹ️  Final extracted Payer Source: ''
[22:22:34] ✅ Patient data extraction completed successfully
[22:22:34] ✅    ✅ Patient data extracted successfully
[22:22:34] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dealmeida
     └─ dob: 05/01/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5140015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/27/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M70.70', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'G47.00'}]
[22:22:34] ✅    ✅ Patient identified: Maria Dealmeida
[22:22:34] ✅    ✅ Patient name validation passed
[22:22:34] 🔄 
🔄 Step 3: Processing patient dates...
[22:22:34] [DOC: 9176709] ℹ️  DOB normalized: 05/01/1944
[22:22:34] [DOC: 9176709] ℹ️  Episode startOfCare normalized: 02/27/2025
[22:22:34] [DOC: 9176709] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[22:22:34] [DOC: 9176709] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[22:22:34] [DOC: 9176709] ✅ Patient date processing completed successfully
[22:22:34] ✅    ✅ Date processing completed
[22:22:34] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dealmeida
     └─ dob: 05/01/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5140015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/27/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M70.70', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'G47.00'}]
[22:22:34] 🔄 
🔄 Step 4: Extracting order data...
[22:22:37] ℹ️  Order extraction - MRN: '5140015'
[22:22:37] ℹ️  Order extraction - Sex: 'FEMALE'
[22:22:37] ℹ️  Order extraction - Service Line: 'PT, RN'
[22:22:37] ℹ️  Order extraction - Payer Source: ''
[22:22:37] ✅ Order data extraction completed successfully
[22:22:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:22:37] ℹ️  Using MRN from patient data: '5140015' over '5140015'
[22:22:37] ℹ️  Service line consistent in both sources: 'PT, RN'
[22:22:37] ✅ Patient name cross-validation successful
[22:22:37] ✅    ✅ Data merged successfully
[22:22:38] ✅    ✅ Order data extracted and validated
[22:22:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:23:29] [DOC: 9176709] ℹ️  Patient not found in cache or API: Maria Dealmeida
[22:23:29] [DOC: 9176709] ℹ️  Patient not found, creating new patient via API...
[22:23:29] [DOC: 9176709] ℹ️  Creating patient via API: Maria Dealmeida
[22:23:30] [DOC: 9176709] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:23:30] ❌    ❌ Failed to create patient
[22:23:30] [DOC: 9176709] ℹ️  API push details saved for document 9176709
================================================================================
║                        Processing Document ID: 9176707                         ║
================================================================================
[22:23:30] ℹ️  Agency: Dartmouth HH
[22:23:30] ℹ️  Date: 03/12/2025
[22:23:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:23:32] [DOC: 9176707] ✅ Text extracted using pdfplumber (3375 chars)
[22:23:32] ✅    ✅ Text extracted using pdfplumber (3375 chars)
[22:23:32] 🔄 
🔄 Step 2: Extracting patient data...
[22:23:35] ℹ️  AI extracted raw sex value: 'F'
[22:23:35] ℹ️  AI extracted service line: 'PT'
[22:23:35] ℹ️  AI extracted payer source: 'Medicare'
[22:23:35] ℹ️  AI extracted diagnoses:
[22:23:35] ℹ️    - Diagnosis 1: 'None'
[22:23:35] ℹ️    - Diagnosis 2: 'None'
[22:23:35] ℹ️    - Diagnosis 3: 'None'
[22:23:35] ℹ️    - Diagnosis 4: 'None'
[22:23:35] ℹ️    - Diagnosis 5: 'None'
[22:23:35] ℹ️    - Diagnosis 6: 'None'
[22:23:35] ℹ️  Final extracted MRN: '5811015'
[22:23:35] ℹ️  Final extracted Sex: 'FEMALE'
[22:23:35] ℹ️  Final extracted Service Line: 'PT'
[22:23:35] ℹ️  Final extracted Payer Source: 'Medicare'
[22:23:35] ✅ Patient data extraction completed successfully
[22:23:35] ✅    ✅ Patient data extracted successfully
[22:23:35] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Ostler
     └─ dob: 12/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5811015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/11/2025', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:23:35] ✅    ✅ Patient identified: Judith Ostler
[22:23:35] ✅    ✅ Patient name validation passed
[22:23:35] 🔄 
🔄 Step 3: Processing patient dates...
[22:23:35] [DOC: 9176707] ℹ️  DOB normalized: 12/28/1942
[22:23:35] [DOC: 9176707] ℹ️  Episode startOfCare normalized: 02/11/2025
[22:23:35] [DOC: 9176707] ℹ️  Episode startOfEpisode normalized: 02/11/2025
[22:23:35] [DOC: 9176707] ℹ️  Episode endOfEpisode normalized: 04/11/2025
[22:23:35] [DOC: 9176707] ✅ Patient date processing completed successfully
[22:23:35] ✅    ✅ Date processing completed
[22:23:35] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Ostler
     └─ dob: 12/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5811015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/11/2025', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025'}]
[22:23:35] 🔄 
🔄 Step 4: Extracting order data...
[22:23:38] ℹ️  Order extraction - MRN: ''
[22:23:38] ℹ️  Order extraction - Sex: 'FEMALE'
[22:23:38] ℹ️  Order extraction - Service Line: 'PT'
[22:23:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:23:38] ✅ Order data extraction completed successfully
[22:23:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:23:38] ℹ️  Using MRN from patient data: '5811015'
[22:23:38] ℹ️  Service line consistent in both sources: 'PT'
[22:23:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:23:38] ✅ Patient name cross-validation successful
[22:23:38] ✅    ✅ Data merged successfully
[22:23:39] ✅    ✅ Order data extracted and validated
[22:23:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:23:39] [DOC: 9176707] ✅ Patient found in local cache: Judith Ostler, ID: 28827423-cd3d-4c01-a205-c6ff32e90080
[22:23:39] ✅    ✅ Existing patient found with ID: 28827423-cd3d-4c01-a205-c6ff32e90080
[22:23:39] 🔄 
🔄 Step 6: Pushing order to API...
[22:23:39] [DOC: 9176707] ℹ️  Pushing order via API for patient ID: 28827423-cd3d-4c01-a205-c6ff32e90080
[22:23:40] [DOC: 9176707] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12967"}
[22:23:40] ❌    ❌ Failed to push order
[22:23:40] 🔄 
🔄 Step 7: Writing to CSV...
[22:23:40] [DOC: 9176707] ℹ️  Calculated age: 82 from DOB: 12/28/1942
[22:23:40] [DOC: 9176707] ℹ️  Service Line extracted: 'PT'
[22:23:40] [DOC: 9176707] ℹ️  Payer Source extracted: 'Medicare'
[22:23:40] [DOC: 9176707] ℹ️  Diagnosis codes being written:
[22:23:40] [DOC: 9176707] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:23:40] [DOC: 9176707] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:23:40] [DOC: 9176707] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:23:40] [DOC: 9176707] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:23:40] [DOC: 9176707] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:23:40] [DOC: 9176707] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:23:40] [DOC: 9176707] ✅ Patient data written to CSV: Judith Ostler | Sex: FEMALE | Age: 82 | Service: PT | Payer: Medicare | MRN: 5811015
[22:23:40] ✅    ✅ Document 9176707 processed and saved successfully
[22:23:40] 🔄 
🔄 Step 8: Saving API details...
[22:23:40] [DOC: 9176707] ℹ️  API push details saved for document 9176707
[22:23:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176706                         ║
================================================================================
[22:23:40] ℹ️  Agency: Dartmouth HH
[22:23:40] ℹ️  Date: 03/12/2025
[22:23:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:23:42] [DOC: 9176706] ✅ Text extracted using pdfplumber (1088 chars)
[22:23:42] ✅    ✅ Text extracted using pdfplumber (1088 chars)
[22:23:42] 🔄 
🔄 Step 2: Extracting patient data...
[22:23:45] ℹ️  AI extracted raw sex value: 'F'
[22:23:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:23:45] ℹ️  AI extracted payer source: 'Medicare'
[22:23:45] ℹ️  AI extracted diagnoses:
[22:23:45] ℹ️    - Diagnosis 1: ''
[22:23:45] ℹ️    - Diagnosis 2: ''
[22:23:45] ℹ️    - Diagnosis 3: ''
[22:23:45] ℹ️    - Diagnosis 4: ''
[22:23:45] ℹ️    - Diagnosis 5: ''
[22:23:45] ℹ️    - Diagnosis 6: ''
[22:23:45] ℹ️  Final extracted MRN: '3684011'
[22:23:45] ℹ️  Final extracted Sex: 'FEMALE'
[22:23:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:23:45] ℹ️  Final extracted Payer Source: 'Medicare'
[22:23:45] ✅ Patient data extraction completed successfully
[22:23:45] ✅    ✅ Patient data extracted successfully
[22:23:45] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:23:45] ✅    ✅ Patient identified: Frances Levin
[22:23:45] ✅    ✅ Patient name validation passed
[22:23:45] 🔄 
🔄 Step 3: Processing patient dates...
[22:23:45] [DOC: 9176706] ℹ️  DOB normalized: 01/16/1935
[22:23:45] [DOC: 9176706] ℹ️  Episode startOfCare normalized: 06/28/2024
[22:23:45] [DOC: 9176706] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[22:23:45] [DOC: 9176706] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[22:23:45] [DOC: 9176706] ✅ Patient date processing completed successfully
[22:23:45] ✅    ✅ Date processing completed
[22:23:45] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:23:45] 🔄 
🔄 Step 4: Extracting order data...
[22:23:47] ℹ️  Order extraction - MRN: ''
[22:23:47] ℹ️  Order extraction - Sex: 'FEMALE'
[22:23:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:23:47] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:23:47] ✅ Order data extraction completed successfully
[22:23:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:23:47] ℹ️  Using MRN from patient data: '3684011'
[22:23:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:23:47] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:23:47] ✅ Patient name cross-validation successful
[22:23:47] ✅    ✅ Data merged successfully
[22:23:48] ✅    ✅ Order data extracted and validated
[22:23:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:24:14] [DOC: 9176706] ℹ️  Patient not found in cache or API: Frances Levin
[22:24:14] [DOC: 9176706] ℹ️  Patient not found, creating new patient via API...
[22:24:14] [DOC: 9176706] ℹ️  Creating patient via API: Frances Levin
[22:24:15] [DOC: 9176706] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:24:15] ❌    ❌ Failed to create patient
[22:24:15] [DOC: 9176706] ℹ️  API push details saved for document 9176706
================================================================================
║                        Processing Document ID: 9176688                         ║
================================================================================
[22:24:15] ℹ️  Agency: Dartmouth HH
[22:24:15] ℹ️  Date: 03/12/2025
[22:24:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:24:17] [DOC: 9176688] ✅ Text extracted using pdfplumber (1091 chars)
[22:24:17] ✅    ✅ Text extracted using pdfplumber (1091 chars)
[22:24:17] 🔄 
🔄 Step 2: Extracting patient data...
[22:24:20] ℹ️  AI extracted raw sex value: 'F'
[22:24:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:24:20] ℹ️  AI extracted payer source: 'Medicare'
[22:24:20] ℹ️  AI extracted diagnoses:
[22:24:20] ℹ️    - Diagnosis 1: ''
[22:24:20] ℹ️    - Diagnosis 2: ''
[22:24:20] ℹ️    - Diagnosis 3: ''
[22:24:20] ℹ️    - Diagnosis 4: ''
[22:24:20] ℹ️    - Diagnosis 5: ''
[22:24:20] ℹ️    - Diagnosis 6: ''
[22:24:20] ℹ️  Final extracted MRN: '5837015'
[22:24:20] ℹ️  Final extracted Sex: 'FEMALE'
[22:24:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:24:20] ℹ️  Final extracted Payer Source: 'Medicare'
[22:24:20] ✅ Patient data extraction completed successfully
[22:24:20] ✅    ✅ Patient data extracted successfully
[22:24:20] 📊 Patient Response
     └─ patientFName: Hilda
     └─ patientLName: Correia
     └─ dob: 05/15/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5837015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:24:20] ✅    ✅ Patient identified: Hilda Correia
[22:24:20] ✅    ✅ Patient name validation passed
[22:24:20] 🔄 
🔄 Step 3: Processing patient dates...
[22:24:20] [DOC: 9176688] ℹ️  DOB normalized: 05/15/1939
[22:24:20] [DOC: 9176688] ℹ️  Episode startOfCare normalized: 01/09/2025
[22:24:20] [DOC: 9176688] ℹ️  Episode startOfEpisode normalized: 01/09/2025
[22:24:20] [DOC: 9176688] ℹ️  Episode endOfEpisode normalized: 03/09/2025
[22:24:20] [DOC: 9176688] ✅ Patient date processing completed successfully
[22:24:20] ✅    ✅ Date processing completed
[22:24:20] 📊 Processed Patient Data
     └─ patientFName: Hilda
     └─ patientLName: Correia
     └─ dob: 05/15/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5837015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:24:20] 🔄 
🔄 Step 4: Extracting order data...
[22:24:22] ℹ️  Order extraction - MRN: '5837015'
[22:24:22] ℹ️  Order extraction - Sex: 'FEMALE'
[22:24:22] ℹ️  Order extraction - Service Line: 'SN'
[22:24:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:24:22] ✅ Order data extraction completed successfully
[22:24:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:24:22] ℹ️  Using MRN from patient data: '5837015' over '5837015'
[22:24:22] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[22:24:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:24:22] ✅ Patient name cross-validation successful
[22:24:22] ✅    ✅ Data merged successfully
[22:24:23] ✅    ✅ Order data extracted and validated
[22:24:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:24:43] [DOC: 9176688] ℹ️  Patient not found in cache or API: Hilda Correia
[22:24:43] [DOC: 9176688] ℹ️  Patient not found, creating new patient via API...
[22:24:43] [DOC: 9176688] ℹ️  Creating patient via API: Hilda Correia
[22:24:44] [DOC: 9176688] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:24:44] ❌    ❌ Failed to create patient
[22:24:44] [DOC: 9176688] ℹ️  API push details saved for document 9176688
================================================================================
║                        Processing Document ID: 9176687                         ║
================================================================================
[22:24:44] ℹ️  Agency: Dartmouth HH
[22:24:44] ℹ️  Date: 03/12/2025
[22:24:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:24:49] [DOC: 9176687] ✅ Text extracted using pdfplumber (1248 chars)
[22:24:49] ✅    ✅ Text extracted using pdfplumber (1248 chars)
[22:24:49] 🔄 
🔄 Step 2: Extracting patient data...
[22:24:52] ℹ️  AI extracted raw sex value: 'F'
[22:24:52] ℹ️  AI extracted service line: 'HHA'
[22:24:52] ℹ️  AI extracted payer source: 'Medicare'
[22:24:52] ℹ️  AI extracted diagnoses:
[22:24:52] ℹ️    - Diagnosis 1: ''
[22:24:52] ℹ️    - Diagnosis 2: ''
[22:24:52] ℹ️    - Diagnosis 3: ''
[22:24:52] ℹ️    - Diagnosis 4: ''
[22:24:52] ℹ️    - Diagnosis 5: ''
[22:24:52] ℹ️    - Diagnosis 6: ''
[22:24:52] ℹ️  Final extracted MRN: '6048015'
[22:24:52] ℹ️  Final extracted Sex: 'FEMALE'
[22:24:52] ℹ️  Final extracted Service Line: 'HHA'
[22:24:52] ℹ️  Final extracted Payer Source: 'Medicare'
[22:24:52] ✅ Patient data extraction completed successfully
[22:24:52] ✅    ✅ Patient data extracted successfully
[22:24:52] 📊 Patient Response
     └─ patientFName: Cynthia
     └─ patientLName: Sears
     └─ dob: 03/18/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6048015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 206 Rockland Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/18/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:24:52] ✅    ✅ Patient identified: Cynthia Sears
[22:24:52] ✅    ✅ Patient name validation passed
[22:24:52] 🔄 
🔄 Step 3: Processing patient dates...
[22:24:52] [DOC: 9176687] ℹ️  DOB normalized: 03/18/1941
[22:24:52] [DOC: 9176687] ℹ️  Episode startOfCare normalized: 02/18/2025
[22:24:52] [DOC: 9176687] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[22:24:52] [DOC: 9176687] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[22:24:52] [DOC: 9176687] ✅ Patient date processing completed successfully
[22:24:52] ✅    ✅ Date processing completed
[22:24:52] 📊 Processed Patient Data
     └─ patientFName: Cynthia
     └─ patientLName: Sears
     └─ dob: 03/18/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6048015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 206 Rockland Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/18/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:24:52] 🔄 
🔄 Step 4: Extracting order data...
[22:24:54] ℹ️  Order extraction - MRN: ''
[22:24:54] ℹ️  Order extraction - Sex: 'FEMALE'
[22:24:54] ℹ️  Order extraction - Service Line: 'RN'
[22:24:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:24:54] ✅ Order data extraction completed successfully
[22:24:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:24:54] ℹ️  Using MRN from patient data: '6048015'
[22:24:54] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[22:24:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:24:54] ✅ Patient name cross-validation successful
[22:24:54] ✅    ✅ Data merged successfully
[22:24:55] ✅    ✅ Order data extracted and validated
[22:24:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:25:19] [DOC: 9176687] ✅ Patient exists in API: Cynthia Sears, ID: 7025632b-db20-4573-957f-881741894f25
[22:25:19] ✅    ✅ Existing patient found with ID: 7025632b-db20-4573-957f-881741894f25
[22:25:19] 🔄 
🔄 Step 6: Pushing order to API...
[22:25:19] [DOC: 9176687] ℹ️  Pushing order via API for patient ID: 7025632b-db20-4573-957f-881741894f25
[22:25:20] [DOC: 9176687] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14389"}
[22:25:20] ❌    ❌ Failed to push order
[22:25:20] 🔄 
🔄 Step 7: Writing to CSV...
[22:25:20] [DOC: 9176687] ℹ️  Calculated age: 84 from DOB: 03/18/1941
[22:25:20] [DOC: 9176687] ℹ️  Service Line extracted: 'HHA, RN'
[22:25:20] [DOC: 9176687] ℹ️  Payer Source extracted: 'Medicare'
[22:25:20] [DOC: 9176687] ℹ️  Diagnosis codes being written:
[22:25:20] [DOC: 9176687] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:25:20] [DOC: 9176687] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:25:20] [DOC: 9176687] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:25:20] [DOC: 9176687] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:25:20] [DOC: 9176687] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:25:20] [DOC: 9176687] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:25:20] [DOC: 9176687] ✅ Patient data written to CSV: Cynthia Sears | Sex: FEMALE | Age: 84 | Service: HHA, RN | Payer: Medicare | MRN: 6048015
[22:25:20] ✅    ✅ Document 9176687 processed and saved successfully
[22:25:20] 🔄 
🔄 Step 8: Saving API details...
[22:25:20] [DOC: 9176687] ℹ️  API push details saved for document 9176687
[22:25:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176685                         ║
================================================================================
[22:25:20] ℹ️  Agency: Dartmouth HH
[22:25:20] ℹ️  Date: 03/12/2025
[22:25:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:25:24] [DOC: 9176685] ✅ Text extracted using pdfplumber (11918 chars)
[22:25:24] ✅    ✅ Text extracted using pdfplumber (11906 chars)
[22:25:24] 🔄 
🔄 Step 2: Extracting patient data...
[22:25:26] ℹ️  AI extracted raw sex value: 'F'
[22:25:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:25:26] ℹ️  AI extracted payer source: 'None'
[22:25:26] ℹ️  AI extracted diagnoses:
[22:25:26] ℹ️    - Diagnosis 1: 'A04.72'
[22:25:26] ℹ️    - Diagnosis 2: 'R53.83'
[22:25:26] ℹ️    - Diagnosis 3: 'I13.0'
[22:25:26] ℹ️    - Diagnosis 4: 'I50.32'
[22:25:26] ℹ️    - Diagnosis 5: 'N18.30'
[22:25:26] ℹ️    - Diagnosis 6: 'G20.A1'
[22:25:26] ℹ️  Final extracted MRN: '6048015'
[22:25:26] ℹ️  Final extracted Sex: 'FEMALE'
[22:25:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:25:26] ℹ️  Final extracted Payer Source: ''
[22:25:26] ✅ Patient data extraction completed successfully
[22:25:26] ✅    ✅ Patient data extracted successfully
[22:25:26] 📊 Patient Response
     └─ patientFName: Cynthia L
     └─ patientLName: Sears
     └─ dob: 03/18/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6048015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'R53.83', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'G20.A1'}]
[22:25:26] ✅    ✅ Patient identified: Cynthia L Sears
[22:25:26] ✅    ✅ Patient name validation passed
[22:25:26] 🔄 
🔄 Step 3: Processing patient dates...
[22:25:26] [DOC: 9176685] ℹ️  DOB normalized: 03/18/1941
[22:25:26] [DOC: 9176685] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[22:25:26] [DOC: 9176685] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[22:25:26] [DOC: 9176685] ✅ Patient date processing completed successfully
[22:25:26] ✅    ✅ Date processing completed
[22:25:26] 📊 Processed Patient Data
     └─ patientFName: Cynthia L
     └─ patientLName: Sears
     └─ dob: 03/18/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6048015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'R53.83', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'G20.A1'}]
[22:25:26] 🔄 
🔄 Step 4: Extracting order data...
[22:25:29] ℹ️  Order extraction - MRN: '6048015'
[22:25:29] ℹ️  Order extraction - Sex: 'FEMALE'
[22:25:29] ℹ️  Order extraction - Service Line: 'RN'
[22:25:29] ℹ️  Order extraction - Payer Source: ''
[22:25:29] ✅ Order data extraction completed successfully
[22:25:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:25:29] ℹ️  Using MRN from patient data: '6048015' over '6048015'
[22:25:29] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[22:25:29] ✅ Patient name cross-validation successful
[22:25:29] ✅    ✅ Data merged successfully
[22:25:30] ✅    ✅ Order data extracted and validated
[22:25:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:25:37] [DOC: 9176685] ✅ Patient exists in API: Cynthia L Sears, ID: 37d73460-9b60-48c0-8885-b9016c397fb8
[22:25:37] ✅    ✅ Existing patient found with ID: 37d73460-9b60-48c0-8885-b9016c397fb8
[22:25:37] 🔄 
🔄 Step 6: Pushing order to API...
[22:25:37] [DOC: 9176685] ℹ️  Pushing order via API for patient ID: 37d73460-9b60-48c0-8885-b9016c397fb8
[22:25:38] [DOC: 9176685] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:25:38] ❌    ❌ Failed to push order
[22:25:38] 🔄 
🔄 Step 7: Writing to CSV...
[22:25:38] [DOC: 9176685] ℹ️  Calculated age: 84 from DOB: 03/18/1941
[22:25:38] [DOC: 9176685] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[22:25:38] [DOC: 9176685] ℹ️  Payer Source extracted: ''
[22:25:38] [DOC: 9176685] ℹ️  Diagnosis codes being written:
[22:25:38] [DOC: 9176685] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[22:25:38] [DOC: 9176685] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.83'
[22:25:38] [DOC: 9176685] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[22:25:38] [DOC: 9176685] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.32'
[22:25:38] [DOC: 9176685] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[22:25:38] [DOC: 9176685] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G20.A1'
[22:25:38] [DOC: 9176685] ✅ Patient data written to CSV: Cynthia L Sears | Sex: FEMALE | Age: 84 | Service: RN, Skilled Nursing | Payer:  | MRN: 6048015
[22:25:38] ✅    ✅ Document 9176685 processed and saved successfully
[22:25:38] 🔄 
🔄 Step 8: Saving API details...
[22:25:38] [DOC: 9176685] ℹ️  API push details saved for document 9176685
[22:25:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176683                         ║
================================================================================
[22:25:38] ℹ️  Agency: Dartmouth HH
[22:25:38] ℹ️  Date: 03/12/2025
[22:25:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:25:40] [DOC: 9176683] ✅ Text extracted using pdfplumber (7162 chars)
[22:25:40] ✅    ✅ Text extracted using pdfplumber (7162 chars)
[22:25:40] 🔄 
🔄 Step 2: Extracting patient data...
[22:25:43] ℹ️  AI extracted raw sex value: 'F'
[22:25:43] ℹ️  AI extracted service line: 'OT'
[22:25:43] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[22:25:43] ℹ️  AI extracted diagnoses:
[22:25:43] ℹ️    - Diagnosis 1: ''
[22:25:43] ℹ️    - Diagnosis 2: ''
[22:25:43] ℹ️    - Diagnosis 3: ''
[22:25:43] ℹ️    - Diagnosis 4: ''
[22:25:43] ℹ️    - Diagnosis 5: ''
[22:25:43] ℹ️    - Diagnosis 6: ''
[22:25:43] ℹ️  Final extracted MRN: '6082015'
[22:25:43] ℹ️  Final extracted Sex: 'FEMALE'
[22:25:43] ℹ️  Final extracted Service Line: 'OT'
[22:25:43] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[22:25:43] ✅ Patient data extraction completed successfully
[22:25:43] ✅    ✅ Patient data extracted successfully
[22:25:43] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Santos
     └─ dob: 10/13/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6082015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:25:43] ✅    ✅ Patient identified: Marie Santos
[22:25:43] ✅    ✅ Patient name validation passed
[22:25:43] 🔄 
🔄 Step 3: Processing patient dates...
[22:25:43] [DOC: 9176683] ℹ️  DOB normalized: 10/13/1952
[22:25:43] [DOC: 9176683] ℹ️  Episode startOfCare normalized: 02/21/2025
[22:25:43] [DOC: 9176683] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[22:25:43] [DOC: 9176683] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[22:25:43] [DOC: 9176683] ✅ Patient date processing completed successfully
[22:25:43] ✅    ✅ Date processing completed
[22:25:43] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Santos
     └─ dob: 10/13/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6082015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:25:43] 🔄 
🔄 Step 4: Extracting order data...
[22:25:45] ℹ️  Order extraction - MRN: ''
[22:25:45] ℹ️  Order extraction - Sex: 'FEMALE'
[22:25:45] ℹ️  Order extraction - Service Line: 'OT'
[22:25:45] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[22:25:45] ✅ Order data extraction completed successfully
[22:25:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:25:45] ℹ️  Using MRN from patient data: '6082015'
[22:25:45] ℹ️  Service line consistent in both sources: 'OT'
[22:25:45] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[22:25:45] ✅ Patient name cross-validation successful
[22:25:45] ✅    ✅ Data merged successfully
[22:25:47] ✅    ✅ Order data extracted and validated
[22:25:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:25:53] [DOC: 9176683] ✅ Patient exists in API: Marie Santos, ID: 1ba6b0c1-88df-466d-a896-fc1b25b88d0f
[22:25:54] ✅    ✅ Existing patient found with ID: 1ba6b0c1-88df-466d-a896-fc1b25b88d0f
[22:25:54] 🔄 
🔄 Step 6: Pushing order to API...
[22:25:54] [DOC: 9176683] ℹ️  Pushing order via API for patient ID: 1ba6b0c1-88df-466d-a896-fc1b25b88d0f
[22:25:55] [DOC: 9176683] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14381"}
[22:25:55] ❌    ❌ Failed to push order
[22:25:55] 🔄 
🔄 Step 7: Writing to CSV...
[22:25:55] [DOC: 9176683] ℹ️  Calculated age: 72 from DOB: 10/13/1952
[22:25:55] [DOC: 9176683] ℹ️  Service Line extracted: 'OT'
[22:25:55] [DOC: 9176683] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[22:25:55] [DOC: 9176683] ℹ️  Diagnosis codes being written:
[22:25:55] [DOC: 9176683] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:25:55] [DOC: 9176683] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:25:55] [DOC: 9176683] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:25:55] [DOC: 9176683] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:25:55] [DOC: 9176683] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:25:55] [DOC: 9176683] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:25:55] [DOC: 9176683] ✅ Patient data written to CSV: Marie Santos | Sex: FEMALE | Age: 72 | Service: OT | Payer: Aetna- Mcare | MRN: 6082015
[22:25:55] ✅    ✅ Document 9176683 processed and saved successfully
[22:25:55] 🔄 
🔄 Step 8: Saving API details...
[22:25:55] [DOC: 9176683] ℹ️  API push details saved for document 9176683
[22:25:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176681                         ║
================================================================================
[22:25:55] ℹ️  Agency: Dartmouth HH
[22:25:55] ℹ️  Date: 03/12/2025
[22:25:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:25:58] [DOC: 9176681] ✅ Text extracted using pdfplumber (14973 chars)
[22:25:58] ✅    ✅ Text extracted using pdfplumber (14961 chars)
[22:25:58] 🔄 
🔄 Step 2: Extracting patient data...
[22:26:01] ℹ️  AI extracted raw sex value: 'M'
[22:26:01] ℹ️  AI extracted service line: 'PT, OT'
[22:26:01] ℹ️  AI extracted payer source: 'None'
[22:26:01] ℹ️  AI extracted diagnoses:
[22:26:01] ℹ️    - Diagnosis 1: 'S12.600D'
[22:26:01] ℹ️    - Diagnosis 2: 'S22.010D'
[22:26:01] ℹ️    - Diagnosis 3: 'S22.32XD'
[22:26:01] ℹ️    - Diagnosis 4: 'S62.305D'
[22:26:01] ℹ️    - Diagnosis 5: 'R27.0'
[22:26:01] ℹ️    - Diagnosis 6: 'I82.409'
[22:26:01] ℹ️  Final extracted MRN: '751009'
[22:26:01] ℹ️  Final extracted Sex: 'MALE'
[22:26:01] ℹ️  Final extracted Service Line: 'PT, OT'
[22:26:01] ℹ️  Final extracted Payer Source: ''
[22:26:01] ✅ Patient data extraction completed successfully
[22:26:01] ✅    ✅ Patient data extracted successfully
[22:26:01] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Moniz
     └─ dob: 07/30/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 751009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'S12.600D', 'secondDiagnosis': 'S22.010D', 'thirdDiagnosis': 'S22.32XD', 'fourthDiagnosis': 'S62.305D', 'fifthDiagnosis': 'R27.0', 'sixthDiagnosis': 'I82.409'}]
[22:26:01] ✅    ✅ Patient identified: George Moniz
[22:26:01] ✅    ✅ Patient name validation passed
[22:26:01] 🔄 
🔄 Step 3: Processing patient dates...
[22:26:01] [DOC: 9176681] ℹ️  DOB normalized: 07/30/1933
[22:26:01] [DOC: 9176681] ℹ️  Episode startOfCare normalized: 02/19/2025
[22:26:01] [DOC: 9176681] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[22:26:01] [DOC: 9176681] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[22:26:01] [DOC: 9176681] ✅ Patient date processing completed successfully
[22:26:01] ✅    ✅ Date processing completed
[22:26:01] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Moniz
     └─ dob: 07/30/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 751009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'S12.600D', 'secondDiagnosis': 'S22.010D', 'thirdDiagnosis': 'S22.32XD', 'fourthDiagnosis': 'S62.305D', 'fifthDiagnosis': 'R27.0', 'sixthDiagnosis': 'I82.409'}]
[22:26:01] 🔄 
🔄 Step 4: Extracting order data...
[22:26:04] ℹ️  Order extraction - MRN: '751009'
[22:26:04] ℹ️  Order extraction - Sex: 'MALE'
[22:26:04] ℹ️  Order extraction - Service Line: 'PT, OT'
[22:26:04] ℹ️  Order extraction - Payer Source: ''
[22:26:04] ✅ Order data extraction completed successfully
[22:26:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:26:04] ℹ️  Using MRN from patient data: '751009' over '751009'
[22:26:04] ℹ️  Service line consistent in both sources: 'PT, OT'
[22:26:04] ✅ Patient name cross-validation successful
[22:26:04] ✅    ✅ Data merged successfully
[22:26:05] ✅    ✅ Order data extracted and validated
[22:26:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:26:11] [DOC: 9176681] ✅ Patient exists in API: George Moniz, ID: c1b19621-d801-44af-b881-2f69b13f00de
[22:26:11] ✅    ✅ Existing patient found with ID: c1b19621-d801-44af-b881-2f69b13f00de
[22:26:11] 🔄 
🔄 Step 6: Pushing order to API...
[22:26:11] [DOC: 9176681] ℹ️  Pushing order via API for patient ID: c1b19621-d801-44af-b881-2f69b13f00de
[22:26:12] [DOC: 9176681] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:26:12] ❌    ❌ Failed to push order
[22:26:12] 🔄 
🔄 Step 7: Writing to CSV...
[22:26:12] [DOC: 9176681] ℹ️  Calculated age: 91 from DOB: 07/30/1933
[22:26:12] [DOC: 9176681] ℹ️  Service Line extracted: 'PT, OT'
[22:26:12] [DOC: 9176681] ℹ️  Payer Source extracted: ''
[22:26:12] [DOC: 9176681] ℹ️  Diagnosis codes being written:
[22:26:12] [DOC: 9176681] ℹ️    - Latest_Episode_Firstdiagnosis: 'S12.600D'
[22:26:12] [DOC: 9176681] ℹ️    - Latest_Episode_Seconddiagnosis: 'S22.010D'
[22:26:12] [DOC: 9176681] ℹ️    - Latest_Episode_Thirddiagnosis: 'S22.32XD'
[22:26:12] [DOC: 9176681] ℹ️    - Latest_Episode_Fourthdiagnosis: 'S62.305D'
[22:26:12] [DOC: 9176681] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R27.0'
[22:26:12] [DOC: 9176681] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I82.409'
[22:26:12] [DOC: 9176681] ✅ Patient data written to CSV: George Moniz | Sex: MALE | Age: 91 | Service: PT, OT | Payer:  | MRN: 751009
[22:26:12] ✅    ✅ Document 9176681 processed and saved successfully
[22:26:12] 🔄 
🔄 Step 8: Saving API details...
[22:26:12] [DOC: 9176681] ℹ️  API push details saved for document 9176681
[22:26:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176675                         ║
================================================================================
[22:26:12] ℹ️  Agency: Dartmouth HH
[22:26:12] ℹ️  Date: 03/12/2025
[22:26:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:26:14] [DOC: 9176675] ✅ Text extracted using pdfplumber (1223 chars)
[22:26:14] ✅    ✅ Text extracted using pdfplumber (1223 chars)
[22:26:14] 🔄 
🔄 Step 2: Extracting patient data...
[22:26:17] ℹ️  AI extracted raw sex value: 'M'
[22:26:17] ℹ️  AI extracted service line: 'RN'
[22:26:17] ℹ️  AI extracted payer source: 'Medicare'
[22:26:17] ℹ️  AI extracted diagnoses:
[22:26:17] ℹ️    - Diagnosis 1: 'None'
[22:26:17] ℹ️    - Diagnosis 2: 'None'
[22:26:17] ℹ️    - Diagnosis 3: 'None'
[22:26:17] ℹ️    - Diagnosis 4: 'None'
[22:26:17] ℹ️    - Diagnosis 5: 'None'
[22:26:17] ℹ️    - Diagnosis 6: 'None'
[22:26:17] ℹ️  Final extracted MRN: '842002'
[22:26:17] ℹ️  Final extracted Sex: 'MALE'
[22:26:17] ℹ️  Final extracted Service Line: 'RN'
[22:26:17] ℹ️  Final extracted Payer Source: 'Medicare'
[22:26:17] ✅ Patient data extraction completed successfully
[22:26:17] ✅    ✅ Patient data extracted successfully
[22:26:17] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:26:17] ✅    ✅ Patient identified: Johannes Bjornson
[22:26:17] ✅    ✅ Patient name validation passed
[22:26:17] 🔄 
🔄 Step 3: Processing patient dates...
[22:26:17] [DOC: 9176675] ℹ️  DOB normalized: 02/09/1942
[22:26:17] [DOC: 9176675] ℹ️  Episode startOfCare normalized: 10/10/2024
[22:26:17] [DOC: 9176675] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:26:17] [DOC: 9176675] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:26:17] [DOC: 9176675] ✅ Patient date processing completed successfully
[22:26:17] ✅    ✅ Date processing completed
[22:26:17] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025'}]
[22:26:17] 🔄 
🔄 Step 4: Extracting order data...
[22:26:19] ℹ️  Order extraction - MRN: ''
[22:26:19] ℹ️  Order extraction - Sex: 'MALE'
[22:26:19] ℹ️  Order extraction - Service Line: 'RN'
[22:26:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:26:19] ✅ Order data extraction completed successfully
[22:26:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:26:19] ℹ️  Using MRN from patient data: '842002'
[22:26:19] ℹ️  Service line consistent in both sources: 'RN'
[22:26:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:26:19] ✅ Patient name cross-validation successful
[22:26:19] ✅    ✅ Data merged successfully
[22:26:20] ✅    ✅ Order data extracted and validated
[22:26:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:26:20] [DOC: 9176675] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:26:20] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:26:20] 🔄 
🔄 Step 6: Pushing order to API...
[22:26:20] [DOC: 9176675] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[22:26:21] [DOC: 9176675] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[22:26:21] ❌    ❌ Failed to push order
[22:26:21] 🔄 
🔄 Step 7: Writing to CSV...
[22:26:21] [DOC: 9176675] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[22:26:21] [DOC: 9176675] ℹ️  Service Line extracted: 'RN'
[22:26:21] [DOC: 9176675] ℹ️  Payer Source extracted: 'Medicare'
[22:26:21] [DOC: 9176675] ℹ️  Diagnosis codes being written:
[22:26:21] [DOC: 9176675] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:26:21] [DOC: 9176675] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:26:21] [DOC: 9176675] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:26:21] [DOC: 9176675] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:26:21] [DOC: 9176675] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:26:21] [DOC: 9176675] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:26:21] [DOC: 9176675] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: RN | Payer: Medicare | MRN: 842002
[22:26:21] ✅    ✅ Document 9176675 processed and saved successfully
[22:26:21] 🔄 
🔄 Step 8: Saving API details...
[22:26:21] [DOC: 9176675] ℹ️  API push details saved for document 9176675
[22:26:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176674                         ║
================================================================================
[22:26:21] ℹ️  Agency: Dartmouth HH
[22:26:21] ℹ️  Date: 03/12/2025
[22:26:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:26:23] [DOC: 9176674] ✅ Text extracted using pdfplumber (1076 chars)
[22:26:23] ✅    ✅ Text extracted using pdfplumber (1076 chars)
[22:26:23] 🔄 
🔄 Step 2: Extracting patient data...
[22:26:26] ℹ️  AI extracted raw sex value: 'F'
[22:26:26] ℹ️  AI extracted service line: 'MSW'
[22:26:26] ℹ️  AI extracted payer source: 'Medicare'
[22:26:26] ℹ️  AI extracted diagnoses:
[22:26:26] ℹ️    - Diagnosis 1: ''
[22:26:26] ℹ️    - Diagnosis 2: ''
[22:26:26] ℹ️    - Diagnosis 3: ''
[22:26:26] ℹ️    - Diagnosis 4: ''
[22:26:26] ℹ️    - Diagnosis 5: ''
[22:26:26] ℹ️    - Diagnosis 6: ''
[22:26:26] ℹ️  Final extracted MRN: '5939015'
[22:26:26] ℹ️  Final extracted Sex: 'FEMALE'
[22:26:26] ℹ️  Final extracted Service Line: 'MSW'
[22:26:26] ℹ️  Final extracted Payer Source: 'Medicare'
[22:26:26] ✅ Patient data extraction completed successfully
[22:26:26] ✅    ✅ Patient data extracted successfully
[22:26:26] 📊 Patient Response
     └─ patientFName: Darlene
     └─ patientLName: Tremblay
     └─ dob: 09/07/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5939015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:26:26] ✅    ✅ Patient identified: Darlene Tremblay
[22:26:26] ✅    ✅ Patient name validation passed
[22:26:26] 🔄 
🔄 Step 3: Processing patient dates...
[22:26:26] [DOC: 9176674] ℹ️  DOB normalized: 09/07/1955
[22:26:26] [DOC: 9176674] ℹ️  Episode startOfCare normalized: 01/30/2025
[22:26:26] [DOC: 9176674] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[22:26:26] [DOC: 9176674] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[22:26:26] [DOC: 9176674] ✅ Patient date processing completed successfully
[22:26:26] ✅    ✅ Date processing completed
[22:26:26] 📊 Processed Patient Data
     └─ patientFName: Darlene
     └─ patientLName: Tremblay
     └─ dob: 09/07/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5939015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:26:26] 🔄 
🔄 Step 4: Extracting order data...
[22:26:29] ℹ️  Order extraction - MRN: '5939015'
[22:26:29] ℹ️  Order extraction - Sex: 'FEMALE'
[22:26:29] ℹ️  Order extraction - Service Line: 'MSW'
[22:26:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:26:29] ✅ Order data extraction completed successfully
[22:26:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:26:29] ℹ️  Using MRN from patient data: '5939015' over '5939015'
[22:26:29] ℹ️  Service line consistent in both sources: 'MSW'
[22:26:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:26:29] ✅ Patient name cross-validation successful
[22:26:29] ✅    ✅ Data merged successfully
[22:26:30] ✅    ✅ Order data extracted and validated
[22:26:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:26:30] [DOC: 9176674] ✅ Patient found in local cache: Darlene Tremblay, ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[22:26:30] ✅    ✅ Existing patient found with ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[22:26:30] 🔄 
🔄 Step 6: Pushing order to API...
[22:26:30] [DOC: 9176674] ℹ️  Pushing order via API for patient ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[22:26:31] [DOC: 9176674] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:26:31] ❌    ❌ Failed to push order
[22:26:31] 🔄 
🔄 Step 7: Writing to CSV...
[22:26:31] [DOC: 9176674] ℹ️  Calculated age: 69 from DOB: 09/07/1955
[22:26:31] [DOC: 9176674] ℹ️  Service Line extracted: 'MSW'
[22:26:31] [DOC: 9176674] ℹ️  Payer Source extracted: 'Medicare'
[22:26:31] [DOC: 9176674] ℹ️  Diagnosis codes being written:
[22:26:31] [DOC: 9176674] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:26:31] [DOC: 9176674] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:26:31] [DOC: 9176674] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:26:31] [DOC: 9176674] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:26:31] [DOC: 9176674] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:26:31] [DOC: 9176674] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:26:31] [DOC: 9176674] ✅ Patient data written to CSV: Darlene Tremblay | Sex: FEMALE | Age: 69 | Service: MSW | Payer: Medicare | MRN: 5939015
[22:26:31] ✅    ✅ Document 9176674 processed and saved successfully
[22:26:31] 🔄 
🔄 Step 8: Saving API details...
[22:26:31] [DOC: 9176674] ℹ️  API push details saved for document 9176674
[22:26:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176673                         ║
================================================================================
[22:26:31] ℹ️  Agency: Dartmouth HH
[22:26:31] ℹ️  Date: 03/12/2025
[22:26:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:26:33] [DOC: 9176673] ✅ Text extracted using pdfplumber (1651 chars)
[22:26:33] ✅    ✅ Text extracted using pdfplumber (1651 chars)
[22:26:33] 🔄 
🔄 Step 2: Extracting patient data...
[22:26:36] ℹ️  AI extracted raw sex value: 'M'
[22:26:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:26:36] ℹ️  AI extracted payer source: 'United Health Care'
[22:26:36] ℹ️  AI extracted diagnoses:
[22:26:36] ℹ️    - Diagnosis 1: ''
[22:26:36] ℹ️    - Diagnosis 2: ''
[22:26:36] ℹ️    - Diagnosis 3: ''
[22:26:36] ℹ️    - Diagnosis 4: ''
[22:26:36] ℹ️    - Diagnosis 5: ''
[22:26:36] ℹ️    - Diagnosis 6: ''
[22:26:36] ℹ️  Final extracted MRN: '5846015'
[22:26:36] ℹ️  Final extracted Sex: 'MALE'
[22:26:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:26:36] ℹ️  Final extracted Payer Source: 'United Health Care'
[22:26:36] ✅ Patient data extraction completed successfully
[22:26:36] ✅    ✅ Patient data extracted successfully
[22:26:36] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Silvestre
     └─ dob: 06/27/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 5846015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 80 Cross Road apt 308
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:26:36] ✅    ✅ Patient identified: Carlos Silvestre
[22:26:36] ✅    ✅ Patient name validation passed
[22:26:36] 🔄 
🔄 Step 3: Processing patient dates...
[22:26:36] [DOC: 9176673] ℹ️  DOB normalized: 06/27/1957
[22:26:36] [DOC: 9176673] ℹ️  Episode startOfCare normalized: 02/01/2025
[22:26:36] [DOC: 9176673] ℹ️  Episode startOfEpisode normalized: 02/01/2025
[22:26:36] [DOC: 9176673] ℹ️  Episode endOfEpisode normalized: 04/01/2025
[22:26:36] [DOC: 9176673] ✅ Patient date processing completed successfully
[22:26:36] ✅    ✅ Date processing completed
[22:26:36] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Silvestre
     └─ dob: 06/27/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 5846015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 80 Cross Road apt 308
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:26:36] 🔄 
🔄 Step 4: Extracting order data...
[22:26:38] ℹ️  Order extraction - MRN: '5846015'
[22:26:38] ℹ️  Order extraction - Sex: 'MALE'
[22:26:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:26:38] ℹ️  Order extraction - Payer Source: 'United Health Care'
[22:26:38] ✅ Order data extraction completed successfully
[22:26:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:26:38] ℹ️  Using MRN from patient data: '5846015' over '5846015'
[22:26:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:26:38] ℹ️  Payer source consistent in both sources: 'United Health Care'
[22:26:38] ✅ Patient name cross-validation successful
[22:26:38] ✅    ✅ Data merged successfully
[22:26:39] ✅    ✅ Order data extracted and validated
[22:26:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:26:45] [DOC: 9176673] ✅ Patient exists in API: Carlos Silvestre, ID: e650f0f0-2a2b-4106-8017-a7d4fdce158a
[22:26:45] ✅    ✅ Existing patient found with ID: e650f0f0-2a2b-4106-8017-a7d4fdce158a
[22:26:45] 🔄 
🔄 Step 6: Pushing order to API...
[22:26:45] [DOC: 9176673] ℹ️  Pushing order via API for patient ID: e650f0f0-2a2b-4106-8017-a7d4fdce158a
[22:26:47] [DOC: 9176673] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:26:47] ❌    ❌ Failed to push order
[22:26:47] 🔄 
🔄 Step 7: Writing to CSV...
[22:26:47] [DOC: 9176673] ℹ️  Calculated age: 67 from DOB: 06/27/1957
[22:26:47] [DOC: 9176673] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:26:47] [DOC: 9176673] ℹ️  Payer Source extracted: 'United Health Care'
[22:26:47] [DOC: 9176673] ℹ️  Diagnosis codes being written:
[22:26:47] [DOC: 9176673] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:26:47] [DOC: 9176673] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:26:47] [DOC: 9176673] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:26:47] [DOC: 9176673] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:26:47] [DOC: 9176673] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:26:47] [DOC: 9176673] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:26:47] [DOC: 9176673] ✅ Patient data written to CSV: Carlos Silvestre | Sex: MALE | Age: 67 | Service: Skilled Nursing | Payer: United Health Care | MRN: 5846015
[22:26:47] ✅    ✅ Document 9176673 processed and saved successfully
[22:26:47] 🔄 
🔄 Step 8: Saving API details...
[22:26:47] [DOC: 9176673] ℹ️  API push details saved for document 9176673
[22:26:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176671                         ║
================================================================================
[22:26:47] ℹ️  Agency: Dartmouth HH
[22:26:47] ℹ️  Date: 03/12/2025
[22:26:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:26:51] [DOC: 9176671] ✅ Text extracted using pdfplumber (1055 chars)
[22:26:51] ✅    ✅ Text extracted using pdfplumber (1055 chars)
[22:26:51] 🔄 
🔄 Step 2: Extracting patient data...
[22:26:53] ℹ️  AI extracted raw sex value: 'M'
[22:26:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:26:53] ℹ️  AI extracted payer source: 'Medicare'
[22:26:53] ℹ️  AI extracted diagnoses:
[22:26:53] ℹ️    - Diagnosis 1: ''
[22:26:53] ℹ️    - Diagnosis 2: ''
[22:26:53] ℹ️    - Diagnosis 3: ''
[22:26:53] ℹ️    - Diagnosis 4: ''
[22:26:53] ℹ️    - Diagnosis 5: ''
[22:26:53] ℹ️    - Diagnosis 6: ''
[22:26:53] ℹ️  Final extracted MRN: '4550011'
[22:26:53] ℹ️  Final extracted Sex: 'MALE'
[22:26:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:26:53] ℹ️  Final extracted Payer Source: 'Medicare'
[22:26:53] ✅ Patient data extraction completed successfully
[22:26:53] ✅    ✅ Patient data extracted successfully
[22:26:53] 📊 Patient Response
     └─ patientFName: Daniel
     └─ patientLName: Francis
     └─ dob: 07/20/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4550011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/28/2025', 'startOfEpisode': '01/28/2025', 'endOfEpisode': '03/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:26:53] ✅    ✅ Patient identified: Daniel Francis
[22:26:53] ✅    ✅ Patient name validation passed
[22:26:53] 🔄 
🔄 Step 3: Processing patient dates...
[22:26:53] [DOC: 9176671] ℹ️  DOB normalized: 07/20/1944
[22:26:53] [DOC: 9176671] ℹ️  Episode startOfCare normalized: 01/28/2025
[22:26:53] [DOC: 9176671] ℹ️  Episode startOfEpisode normalized: 01/28/2025
[22:26:53] [DOC: 9176671] ℹ️  Episode endOfEpisode normalized: 03/28/2025
[22:26:53] [DOC: 9176671] ✅ Patient date processing completed successfully
[22:26:53] ✅    ✅ Date processing completed
[22:26:53] 📊 Processed Patient Data
     └─ patientFName: Daniel
     └─ patientLName: Francis
     └─ dob: 07/20/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4550011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/28/2025', 'startOfEpisode': '01/28/2025', 'endOfEpisode': '03/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:26:53] 🔄 
🔄 Step 4: Extracting order data...
[22:26:56] ℹ️  Order extraction - MRN: ''
[22:26:56] ℹ️  Order extraction - Sex: 'MALE'
[22:26:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:26:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:26:56] ✅ Order data extraction completed successfully
[22:26:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:26:56] ℹ️  Using MRN from patient data: '4550011'
[22:26:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:26:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:26:56] ✅ Patient name cross-validation successful
[22:26:56] ✅    ✅ Data merged successfully
[22:26:57] ✅    ✅ Order data extracted and validated
[22:26:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:27:38] [DOC: 9176671] ✅ Patient exists in API: Daniel Francis, ID: c3a1a640-96b2-4a49-8c2a-bce3ee1a121a
[22:27:38] ✅    ✅ Existing patient found with ID: c3a1a640-96b2-4a49-8c2a-bce3ee1a121a
[22:27:38] 🔄 
🔄 Step 6: Pushing order to API...
[22:27:38] [DOC: 9176671] ℹ️  Pushing order via API for patient ID: c3a1a640-96b2-4a49-8c2a-bce3ee1a121a
[22:27:40] [DOC: 9176671] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:27:40] ❌    ❌ Failed to push order
[22:27:40] 🔄 
🔄 Step 7: Writing to CSV...
[22:27:40] [DOC: 9176671] ℹ️  Calculated age: 80 from DOB: 07/20/1944
[22:27:40] [DOC: 9176671] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:27:40] [DOC: 9176671] ℹ️  Payer Source extracted: 'Medicare'
[22:27:40] [DOC: 9176671] ℹ️  Diagnosis codes being written:
[22:27:40] [DOC: 9176671] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:27:40] [DOC: 9176671] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:27:40] [DOC: 9176671] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:27:40] [DOC: 9176671] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:27:40] [DOC: 9176671] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:27:40] [DOC: 9176671] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:27:40] [DOC: 9176671] ✅ Patient data written to CSV: Daniel Francis | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 4550011
[22:27:40] ✅    ✅ Document 9176671 processed and saved successfully
[22:27:40] 🔄 
🔄 Step 8: Saving API details...
[22:27:40] [DOC: 9176671] ℹ️  API push details saved for document 9176671
[22:27:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176670                         ║
================================================================================
[22:27:40] ℹ️  Agency: Dartmouth HH
[22:27:40] ℹ️  Date: 03/12/2025
[22:27:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:27:42] [DOC: 9176670] ✅ Text extracted using pdfplumber (2220 chars)
[22:27:42] ✅    ✅ Text extracted using pdfplumber (2220 chars)
[22:27:42] 🔄 
🔄 Step 2: Extracting patient data...
[22:27:45] ℹ️  AI extracted raw sex value: 'F'
[22:27:45] ℹ️  AI extracted service line: 'HHA, OT'
[22:27:45] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[22:27:45] ℹ️  AI extracted diagnoses:
[22:27:45] ℹ️    - Diagnosis 1: 'None'
[22:27:45] ℹ️    - Diagnosis 2: 'None'
[22:27:45] ℹ️    - Diagnosis 3: 'None'
[22:27:45] ℹ️    - Diagnosis 4: 'None'
[22:27:45] ℹ️    - Diagnosis 5: 'None'
[22:27:45] ℹ️    - Diagnosis 6: 'None'
[22:27:45] ℹ️  Final extracted MRN: '6066015'
[22:27:45] ℹ️  Final extracted Sex: 'FEMALE'
[22:27:45] ℹ️  Final extracted Service Line: 'HHA, OT'
[22:27:45] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[22:27:45] ✅ Patient data extraction completed successfully
[22:27:45] ✅    ✅ Patient data extracted successfully
[22:27:45] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Perry Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA, OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': None, 'endOfEpisode': '04/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:27:45] ✅    ✅ Patient identified: Lois Fernandes
[22:27:45] ✅    ✅ Patient name validation passed
[22:27:45] 🔄 
🔄 Step 3: Processing patient dates...
[22:27:45] [DOC: 9176670] ℹ️  DOB normalized: 05/15/1941
[22:27:45] [DOC: 9176670] ℹ️  Episode startOfCare normalized: 02/22/2025
[22:27:45] [DOC: 9176670] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:27:45] [DOC: 9176670] ✅ Patient date processing completed successfully
[22:27:45] ✅    ✅ Date processing completed
[22:27:45] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Perry Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA, OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'endOfEpisode': '04/22/2025'}]
[22:27:45] 🔄 
🔄 Step 4: Extracting order data...
[22:27:48] ℹ️  Order extraction - MRN: '6066015'
[22:27:48] ℹ️  Order extraction - Sex: 'FEMALE'
[22:27:48] ℹ️  Order extraction - Service Line: 'HHA, OT, Diet'
[22:27:48] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[22:27:48] ✅ Order data extraction completed successfully
[22:27:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:27:48] ℹ️  Using MRN from patient data: '6066015' over '6066015'
[22:27:48] ℹ️  Combined service lines: Patient='HHA, OT' + Order='HHA, OT, Diet' = 'Diet, HHA, OT'
[22:27:48] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[22:27:48] ✅ Patient name cross-validation successful
[22:27:48] ✅    ✅ Data merged successfully
[22:27:49] ✅    ✅ Order data extracted and validated
[22:27:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:27:49] [DOC: 9176670] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:27:49] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:27:49] 🔄 
🔄 Step 6: Pushing order to API...
[22:27:49] [DOC: 9176670] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:27:50] [DOC: 9176670] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:27:50] ❌    ❌ Failed to push order
[22:27:50] 🔄 
🔄 Step 7: Writing to CSV...
[22:27:50] [DOC: 9176670] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[22:27:50] [DOC: 9176670] ℹ️  Service Line extracted: 'Diet, HHA, OT'
[22:27:50] [DOC: 9176670] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[22:27:50] [DOC: 9176670] ℹ️  Diagnosis codes being written:
[22:27:50] [DOC: 9176670] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:27:50] [DOC: 9176670] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:27:50] [DOC: 9176670] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:27:50] [DOC: 9176670] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:27:50] [DOC: 9176670] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:27:50] [DOC: 9176670] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:27:50] [DOC: 9176670] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: Diet, HHA, OT | Payer: Blue Cross Medicare Adv | MRN: 6066015
[22:27:50] ✅    ✅ Document 9176670 processed and saved successfully
[22:27:50] 🔄 
🔄 Step 8: Saving API details...
[22:27:50] [DOC: 9176670] ℹ️  API push details saved for document 9176670
[22:27:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176666                         ║
================================================================================
[22:27:50] ℹ️  Agency: Dartmouth HH
[22:27:50] ℹ️  Date: 03/12/2025
[22:27:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:27:54] [DOC: 9176666] ✅ Text extracted using pdfplumber (16003 chars)
[22:27:54] ✅    ✅ Text extracted using pdfplumber (16003 chars)
[22:27:54] 🔄 
🔄 Step 2: Extracting patient data...
[22:27:58] ℹ️  AI extracted raw sex value: 'F'
[22:27:58] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[22:27:58] ℹ️  AI extracted payer source: ''
[22:27:58] ℹ️  AI extracted diagnoses:
[22:27:58] ℹ️    - Diagnosis 1: 'I48.91'
[22:27:58] ℹ️    - Diagnosis 2: 'I13.0'
[22:27:58] ℹ️    - Diagnosis 3: 'I50.43'
[22:27:58] ℹ️    - Diagnosis 4: 'E11.22'
[22:27:58] ℹ️    - Diagnosis 5: 'N18.30'
[22:27:58] ℹ️    - Diagnosis 6: 'J18.9'
[22:27:58] ℹ️  Final extracted MRN: '6066015'
[22:27:58] ℹ️  Final extracted Sex: 'FEMALE'
[22:27:58] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[22:27:58] ℹ️  Final extracted Payer Source: ''
[22:27:58] ✅ Patient data extraction completed successfully
[22:27:58] ✅    ✅ Patient data extracted successfully
[22:27:58] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.43', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'J18.9'}]
[22:27:58] ✅    ✅ Patient identified: Lois Fernandes
[22:27:58] ✅    ✅ Patient name validation passed
[22:27:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:27:58] [DOC: 9176666] ℹ️  DOB normalized: 05/15/1941
[22:27:58] [DOC: 9176666] ℹ️  Episode startOfCare normalized: 02/22/2025
[22:27:58] [DOC: 9176666] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[22:27:58] [DOC: 9176666] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:27:58] [DOC: 9176666] ✅ Patient date processing completed successfully
[22:27:58] ✅    ✅ Date processing completed
[22:27:58] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.43', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'J18.9'}]
[22:27:58] 🔄 
🔄 Step 4: Extracting order data...
[22:28:00] ℹ️  Order extraction - MRN: '6066015'
[22:28:00] ℹ️  Order extraction - Sex: 'FEMALE'
[22:28:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, HCA'
[22:28:00] ℹ️  Order extraction - Payer Source: ''
[22:28:00] ✅ Order data extraction completed successfully
[22:28:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:28:00] ℹ️  Using MRN from patient data: '6066015' over '6066015'
[22:28:00] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Home Health Aide' + Order='Skilled Nursing, PT, HCA' = 'HCA, Home Health Aide, PT, Physical Therapy, Skilled Nursing'
[22:28:00] ✅ Patient name cross-validation successful
[22:28:00] ✅    ✅ Data merged successfully
[22:28:01] ✅    ✅ Order data extracted and validated
[22:28:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:28:01] [DOC: 9176666] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:28:01] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:28:01] 🔄 
🔄 Step 6: Pushing order to API...
[22:28:01] [DOC: 9176666] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[22:28:03] [DOC: 9176666] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:28:03] ❌    ❌ Failed to push order
[22:28:03] 🔄 
🔄 Step 7: Writing to CSV...
[22:28:03] [DOC: 9176666] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[22:28:03] [DOC: 9176666] ℹ️  Service Line extracted: 'HCA, Home Health Aide, PT, Physical Therapy, Skilled Nursing'
[22:28:03] [DOC: 9176666] ℹ️  Payer Source extracted: ''
[22:28:03] [DOC: 9176666] ℹ️  Diagnosis codes being written:
[22:28:03] [DOC: 9176666] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.91'
[22:28:03] [DOC: 9176666] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[22:28:03] [DOC: 9176666] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.43'
[22:28:03] [DOC: 9176666] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[22:28:03] [DOC: 9176666] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[22:28:03] [DOC: 9176666] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J18.9'
[22:28:03] [DOC: 9176666] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: HCA, Home Health Aide, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 6066015
[22:28:03] ✅    ✅ Document 9176666 processed and saved successfully
[22:28:03] 🔄 
🔄 Step 8: Saving API details...
[22:28:03] [DOC: 9176666] ℹ️  API push details saved for document 9176666
[22:28:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176664                         ║
================================================================================
[22:28:03] ℹ️  Agency: Dartmouth HH
[22:28:03] ℹ️  Date: 03/12/2025
[22:28:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:28:05] [DOC: 9176664] ✅ Text extracted using pdfplumber (1129 chars)
[22:28:05] ✅    ✅ Text extracted using pdfplumber (1129 chars)
[22:28:05] 🔄 
🔄 Step 2: Extracting patient data...
[22:28:08] ℹ️  AI extracted raw sex value: 'M'
[22:28:08] ℹ️  AI extracted service line: 'Physical Therapy, MSW'
[22:28:08] ℹ️  AI extracted payer source: 'Medicare'
[22:28:08] ℹ️  AI extracted diagnoses:
[22:28:08] ℹ️    - Diagnosis 1: ''
[22:28:08] ℹ️    - Diagnosis 2: ''
[22:28:08] ℹ️    - Diagnosis 3: ''
[22:28:08] ℹ️    - Diagnosis 4: ''
[22:28:08] ℹ️    - Diagnosis 5: ''
[22:28:08] ℹ️    - Diagnosis 6: ''
[22:28:08] ℹ️  Final extracted MRN: '374009'
[22:28:08] ℹ️  Final extracted Sex: 'MALE'
[22:28:08] ℹ️  Final extracted Service Line: 'Physical Therapy, MSW'
[22:28:08] ℹ️  Final extracted Payer Source: 'Medicare'
[22:28:08] ✅ Patient data extraction completed successfully
[22:28:08] ✅    ✅ Patient data extracted successfully
[22:28:08] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Miranda
     └─ dob: 09/18/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 374009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:28:08] ✅    ✅ Patient identified: Robert Miranda
[22:28:08] ✅    ✅ Patient name validation passed
[22:28:08] 🔄 
🔄 Step 3: Processing patient dates...
[22:28:08] [DOC: 9176664] ℹ️  DOB normalized: 09/18/1945
[22:28:08] [DOC: 9176664] ℹ️  Episode startOfCare normalized: 01/16/2025
[22:28:08] [DOC: 9176664] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[22:28:08] [DOC: 9176664] ℹ️  Episode endOfEpisode normalized: 03/16/2025
[22:28:08] [DOC: 9176664] ✅ Patient date processing completed successfully
[22:28:08] ✅    ✅ Date processing completed
[22:28:08] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Miranda
     └─ dob: 09/18/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 374009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:28:08] 🔄 
🔄 Step 4: Extracting order data...
[22:28:10] ℹ️  Order extraction - MRN: ''
[22:28:10] ℹ️  Order extraction - Sex: 'MALE'
[22:28:10] ℹ️  Order extraction - Service Line: 'Physical Therapy, MSW'
[22:28:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:28:10] ✅ Order data extraction completed successfully
[22:28:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:28:10] ℹ️  Using MRN from patient data: '374009'
[22:28:10] ℹ️  Service line consistent in both sources: 'Physical Therapy, MSW'
[22:28:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:28:10] ✅ Patient name cross-validation successful
[22:28:10] ✅    ✅ Data merged successfully
[22:28:11] ✅    ✅ Order data extracted and validated
[22:28:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:28:21] [DOC: 9176664] ✅ Patient exists in API: Robert Miranda, ID: 35eac0d7-1efb-4c44-a536-65d9a01c1b0e
[22:28:21] ✅    ✅ Existing patient found with ID: 35eac0d7-1efb-4c44-a536-65d9a01c1b0e
[22:28:21] 🔄 
🔄 Step 6: Pushing order to API...
[22:28:21] [DOC: 9176664] ℹ️  Pushing order via API for patient ID: 35eac0d7-1efb-4c44-a536-65d9a01c1b0e
[22:28:22] [DOC: 9176664] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:28:22] ❌    ❌ Failed to push order
[22:28:22] 🔄 
🔄 Step 7: Writing to CSV...
[22:28:22] [DOC: 9176664] ℹ️  Calculated age: 79 from DOB: 09/18/1945
[22:28:22] [DOC: 9176664] ℹ️  Service Line extracted: 'Physical Therapy, MSW'
[22:28:22] [DOC: 9176664] ℹ️  Payer Source extracted: 'Medicare'
[22:28:22] [DOC: 9176664] ℹ️  Diagnosis codes being written:
[22:28:22] [DOC: 9176664] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:28:22] [DOC: 9176664] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:28:22] [DOC: 9176664] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:28:22] [DOC: 9176664] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:28:22] [DOC: 9176664] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:28:22] [DOC: 9176664] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:28:22] [DOC: 9176664] ✅ Patient data written to CSV: Robert Miranda | Sex: MALE | Age: 79 | Service: Physical Therapy, MSW | Payer: Medicare | MRN: 374009
[22:28:22] ✅    ✅ Document 9176664 processed and saved successfully
[22:28:22] 🔄 
🔄 Step 8: Saving API details...
[22:28:22] [DOC: 9176664] ℹ️  API push details saved for document 9176664
[22:28:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176663                         ║
================================================================================
[22:28:22] ℹ️  Agency: Dartmouth HH
[22:28:22] ℹ️  Date: 03/12/2025
[22:28:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:28:25] [DOC: 9176663] ✅ Text extracted using pdfplumber (19917 chars)
[22:28:25] ✅    ✅ Text extracted using pdfplumber (19905 chars)
[22:28:25] 🔄 
🔄 Step 2: Extracting patient data...
[22:28:28] ℹ️  AI extracted raw sex value: 'F'
[22:28:28] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[22:28:28] ℹ️  AI extracted payer source: 'None'
[22:28:28] ℹ️  AI extracted diagnoses:
[22:28:28] ℹ️    - Diagnosis 1: 'Z47.1'
[22:28:28] ℹ️    - Diagnosis 2: 'Z96.611'
[22:28:28] ℹ️    - Diagnosis 3: 'M25.511'
[22:28:28] ℹ️    - Diagnosis 4: 'I10'
[22:28:28] ℹ️    - Diagnosis 5: 'E55.9'
[22:28:28] ℹ️    - Diagnosis 6: 'M25.512'
[22:28:28] ℹ️  Final extracted MRN: '227027'
[22:28:28] ℹ️  Final extracted Sex: 'FEMALE'
[22:28:28] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[22:28:28] ℹ️  Final extracted Payer Source: ''
[22:28:28] ✅ Patient data extraction completed successfully
[22:28:28] ✅    ✅ Patient data extracted successfully
[22:28:28] 📊 Patient Response
     └─ patientFName: Gina L
     └─ patientLName: Despres
     └─ dob: 01/25/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'M25.511', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'M25.512'}]
[22:28:28] ✅    ✅ Patient identified: Gina L Despres
[22:28:28] ✅    ✅ Patient name validation passed
[22:28:28] 🔄 
🔄 Step 3: Processing patient dates...
[22:28:28] [DOC: 9176663] ℹ️  DOB normalized: 01/25/1955
[22:28:28] [DOC: 9176663] ℹ️  Episode startOfCare normalized: 02/22/2025
[22:28:28] [DOC: 9176663] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[22:28:28] [DOC: 9176663] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[22:28:28] [DOC: 9176663] ✅ Patient date processing completed successfully
[22:28:28] ✅    ✅ Date processing completed
[22:28:28] 📊 Processed Patient Data
     └─ patientFName: Gina L
     └─ patientLName: Despres
     └─ dob: 01/25/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'M25.511', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'M25.512'}]
[22:28:28] 🔄 
🔄 Step 4: Extracting order data...
[22:28:31] ℹ️  Order extraction - MRN: '5913015'
[22:28:31] ℹ️  Order extraction - Sex: 'FEMALE'
[22:28:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[22:28:31] ℹ️  Order extraction - Payer Source: ''
[22:28:31] ✅ Order data extraction completed successfully
[22:28:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:28:31] ℹ️  Using longer MRN from order data: '5913015' over '227027'
[22:28:31] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[22:28:31] ✅ Patient name cross-validation successful
[22:28:31] ✅    ✅ Data merged successfully
[22:28:32] ✅    ✅ Order data extracted and validated
[22:28:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:28:38] [DOC: 9176663] ✅ Patient exists in API: Gina L Despres, ID: 9e6c2fe4-7f28-41d1-ac69-3e82e6fc3802
[22:28:38] ✅    ✅ Existing patient found with ID: 9e6c2fe4-7f28-41d1-ac69-3e82e6fc3802
[22:28:38] 🔄 
🔄 Step 6: Pushing order to API...
[22:28:38] [DOC: 9176663] ℹ️  Pushing order via API for patient ID: 9e6c2fe4-7f28-41d1-ac69-3e82e6fc3802
[22:28:39] [DOC: 9176663] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:28:39] ❌    ❌ Failed to push order
[22:28:39] 🔄 
🔄 Step 7: Writing to CSV...
[22:28:39] [DOC: 9176663] ℹ️  Calculated age: 70 from DOB: 01/25/1955
[22:28:39] [DOC: 9176663] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[22:28:39] [DOC: 9176663] ℹ️  Payer Source extracted: ''
[22:28:39] [DOC: 9176663] ℹ️  Diagnosis codes being written:
[22:28:39] [DOC: 9176663] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[22:28:39] [DOC: 9176663] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.611'
[22:28:39] [DOC: 9176663] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.511'
[22:28:39] [DOC: 9176663] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[22:28:39] [DOC: 9176663] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E55.9'
[22:28:39] [DOC: 9176663] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M25.512'
[22:28:39] [DOC: 9176663] ✅ Patient data written to CSV: Gina L Despres | Sex: FEMALE | Age: 70 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 5913015
[22:28:39] ✅    ✅ Document 9176663 processed and saved successfully
[22:28:39] 🔄 
🔄 Step 8: Saving API details...
[22:28:39] [DOC: 9176663] ℹ️  API push details saved for document 9176663
[22:28:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176661                         ║
================================================================================
[22:28:39] ℹ️  Agency: Dartmouth HH
[22:28:39] ℹ️  Date: 03/12/2025
[22:28:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:28:41] [DOC: 9176661] ✅ Text extracted using pdfplumber (2362 chars)
[22:28:41] ✅    ✅ Text extracted using pdfplumber (2362 chars)
[22:28:41] 🔄 
🔄 Step 2: Extracting patient data...
[22:28:44] ℹ️  AI extracted raw sex value: 'F'
[22:28:44] ℹ️  AI extracted service line: 'RN, OT'
[22:28:44] ℹ️  AI extracted payer source: 'Medicaid/MA'
[22:28:44] ℹ️  AI extracted diagnoses:
[22:28:44] ℹ️    - Diagnosis 1: 'None'
[22:28:44] ℹ️    - Diagnosis 2: 'None'
[22:28:44] ℹ️    - Diagnosis 3: 'None'
[22:28:44] ℹ️    - Diagnosis 4: 'None'
[22:28:44] ℹ️    - Diagnosis 5: 'None'
[22:28:44] ℹ️    - Diagnosis 6: 'None'
[22:28:44] ℹ️  Final extracted MRN: '5559015'
[22:28:44] ℹ️  Final extracted Sex: 'FEMALE'
[22:28:44] ℹ️  Final extracted Service Line: 'RN, OT'
[22:28:44] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[22:28:44] ✅ Patient data extraction completed successfully
[22:28:44] ✅    ✅ Patient data extracted successfully
[22:28:44] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Pena
     └─ dob: 09/03/1968
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5559015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, OT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2024', 'startOfEpisode': '01/12/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:28:44] ✅    ✅ Patient identified: Tina Pena
[22:28:44] ✅    ✅ Patient name validation passed
[22:28:44] 🔄 
🔄 Step 3: Processing patient dates...
[22:28:44] [DOC: 9176661] ℹ️  DOB normalized: 09/03/1968
[22:28:44] [DOC: 9176661] ℹ️  Episode startOfCare normalized: 11/13/2024
[22:28:44] [DOC: 9176661] ℹ️  Episode startOfEpisode normalized: 01/12/2025
[22:28:44] [DOC: 9176661] ℹ️  Episode endOfEpisode normalized: 03/12/2025
[22:28:44] [DOC: 9176661] ✅ Patient date processing completed successfully
[22:28:44] ✅    ✅ Date processing completed
[22:28:44] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Pena
     └─ dob: 09/03/1968
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5559015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, OT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2024', 'startOfEpisode': '01/12/2025', 'endOfEpisode': '03/12/2025'}]
[22:28:44] 🔄 
🔄 Step 4: Extracting order data...
[22:28:46] ℹ️  Order extraction - MRN: '5559015'
[22:28:46] ℹ️  Order extraction - Sex: 'FEMALE'
[22:28:46] ℹ️  Order extraction - Service Line: 'RN, OT'
[22:28:46] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[22:28:46] ✅ Order data extraction completed successfully
[22:28:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:28:46] ℹ️  Using MRN from patient data: '5559015' over '5559015'
[22:28:46] ℹ️  Service line consistent in both sources: 'RN, OT'
[22:28:46] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[22:28:46] ✅ Patient name cross-validation successful
[22:28:46] ✅    ✅ Data merged successfully
[22:28:48] ✅    ✅ Order data extracted and validated
[22:28:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:28:48] [DOC: 9176661] ✅ Patient found in local cache: Tina Pena, ID: a86c6a8a-06f8-495e-be55-9369ee2df30f
[22:28:48] ✅    ✅ Existing patient found with ID: a86c6a8a-06f8-495e-be55-9369ee2df30f
[22:28:48] 🔄 
🔄 Step 6: Pushing order to API...
[22:28:48] [DOC: 9176661] ℹ️  Pushing order via API for patient ID: a86c6a8a-06f8-495e-be55-9369ee2df30f
[22:28:49] [DOC: 9176661] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:28:49] ❌    ❌ Failed to push order
[22:28:49] 🔄 
🔄 Step 7: Writing to CSV...
[22:28:49] [DOC: 9176661] ℹ️  Calculated age: 56 from DOB: 09/03/1968
[22:28:49] [DOC: 9176661] ℹ️  Service Line extracted: 'RN, OT'
[22:28:49] [DOC: 9176661] ℹ️  Payer Source extracted: 'Medicaid/MA'
[22:28:49] [DOC: 9176661] ℹ️  Diagnosis codes being written:
[22:28:49] [DOC: 9176661] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:28:49] [DOC: 9176661] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:28:49] [DOC: 9176661] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:28:49] [DOC: 9176661] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:28:49] [DOC: 9176661] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:28:49] [DOC: 9176661] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:28:49] [DOC: 9176661] ✅ Patient data written to CSV: Tina Pena | Sex: FEMALE | Age: 56 | Service: RN, OT | Payer: Medicaid/MA | MRN: 5559015
[22:28:49] ✅    ✅ Document 9176661 processed and saved successfully
[22:28:49] 🔄 
🔄 Step 8: Saving API details...
[22:28:49] [DOC: 9176661] ℹ️  API push details saved for document 9176661
[22:28:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176657                         ║
================================================================================
[22:28:49] ℹ️  Agency: Dartmouth HH
[22:28:49] ℹ️  Date: 03/12/2025
[22:28:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:28:52] [DOC: 9176657] ✅ Text extracted using pdfplumber (13803 chars)
[22:28:52] ✅    ✅ Text extracted using pdfplumber (13791 chars)
[22:28:52] 🔄 
🔄 Step 2: Extracting patient data...
[22:28:55] ℹ️  AI extracted raw sex value: 'M'
[22:28:55] ℹ️  AI extracted service line: 'PT, OT'
[22:28:55] ℹ️  AI extracted payer source: 'None'
[22:28:55] ℹ️  AI extracted diagnoses:
[22:28:55] ℹ️    - Diagnosis 1: 'G20.B2'
[22:28:55] ℹ️    - Diagnosis 2: 'M54.9'
[22:28:55] ℹ️    - Diagnosis 3: 'I10'
[22:28:55] ℹ️    - Diagnosis 4: 'E11.69'
[22:28:55] ℹ️    - Diagnosis 5: 'E78.2'
[22:28:55] ℹ️    - Diagnosis 6: 'E55.9'
[22:28:55] ℹ️  Final extracted MRN: '894015'
[22:28:55] ℹ️  Final extracted Sex: 'MALE'
[22:28:55] ℹ️  Final extracted Service Line: 'PT, OT'
[22:28:55] ℹ️  Final extracted Payer Source: ''
[22:28:55] ✅ Patient data extraction completed successfully
[22:28:55] ✅    ✅ Patient data extracted successfully
[22:28:55] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Bourassa
     └─ dob: 05/10/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': 'G20.B2', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'E78.2', 'sixthDiagnosis': 'E55.9'}]
[22:28:55] ✅    ✅ Patient identified: Joseph Bourassa
[22:28:55] ✅    ✅ Patient name validation passed
[22:28:55] 🔄 
🔄 Step 3: Processing patient dates...
[22:28:55] [DOC: 9176657] ℹ️  DOB normalized: 05/10/1944
[22:28:55] [DOC: 9176657] ℹ️  Episode startOfCare normalized: 03/05/2025
[22:28:55] [DOC: 9176657] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[22:28:55] [DOC: 9176657] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[22:28:55] [DOC: 9176657] ✅ Patient date processing completed successfully
[22:28:55] ✅    ✅ Date processing completed
[22:28:55] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Bourassa
     └─ dob: 05/10/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': 'G20.B2', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'E78.2', 'sixthDiagnosis': 'E55.9'}]
[22:28:55] 🔄 
🔄 Step 4: Extracting order data...
[22:28:57] ℹ️  Order extraction - MRN: '894015'
[22:28:57] ℹ️  Order extraction - Sex: 'MALE'
[22:28:57] ℹ️  Order extraction - Service Line: 'PT, OT'
[22:28:57] ℹ️  Order extraction - Payer Source: ''
[22:28:57] ✅ Order data extraction completed successfully
[22:28:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:28:57] ℹ️  Using MRN from patient data: '894015' over '894015'
[22:28:57] ℹ️  Service line consistent in both sources: 'PT, OT'
[22:28:57] ✅ Patient name cross-validation successful
[22:28:57] ✅    ✅ Data merged successfully
[22:28:58] ✅    ✅ Order data extracted and validated
[22:28:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:28:58] [DOC: 9176657] ✅ Patient found in local cache: Joseph Bourassa, ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[22:28:58] ✅    ✅ Existing patient found with ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[22:28:58] 🔄 
🔄 Step 6: Pushing order to API...
[22:28:58] [DOC: 9176657] ℹ️  Pushing order via API for patient ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[22:29:00] [DOC: 9176657] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:29:00] ❌    ❌ Failed to push order
[22:29:00] 🔄 
🔄 Step 7: Writing to CSV...
[22:29:00] [DOC: 9176657] ℹ️  Calculated age: 81 from DOB: 05/10/1944
[22:29:00] [DOC: 9176657] ℹ️  Service Line extracted: 'PT, OT'
[22:29:00] [DOC: 9176657] ℹ️  Payer Source extracted: ''
[22:29:00] [DOC: 9176657] ℹ️  Diagnosis codes being written:
[22:29:00] [DOC: 9176657] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.B2'
[22:29:00] [DOC: 9176657] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.9'
[22:29:00] [DOC: 9176657] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:29:00] [DOC: 9176657] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.69'
[22:29:00] [DOC: 9176657] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.2'
[22:29:00] [DOC: 9176657] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E55.9'
[22:29:00] [DOC: 9176657] ✅ Patient data written to CSV: Joseph Bourassa | Sex: MALE | Age: 81 | Service: PT, OT | Payer:  | MRN: 894015
[22:29:00] ✅    ✅ Document 9176657 processed and saved successfully
[22:29:00] 🔄 
🔄 Step 8: Saving API details...
[22:29:00] [DOC: 9176657] ℹ️  API push details saved for document 9176657
[22:29:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176655                         ║
================================================================================
[22:29:00] ℹ️  Agency: Dartmouth HH
[22:29:00] ℹ️  Date: 03/12/2025
[22:29:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:29:02] [DOC: 9176655] ✅ Text extracted using pdfplumber (6657 chars)
[22:29:02] ✅    ✅ Text extracted using pdfplumber (6657 chars)
[22:29:02] 🔄 
🔄 Step 2: Extracting patient data...
[22:29:05] ℹ️  AI extracted raw sex value: 'M'
[22:29:05] ℹ️  AI extracted service line: 'MSW'
[22:29:05] ℹ️  AI extracted payer source: 'Medicare'
[22:29:05] ℹ️  AI extracted diagnoses:
[22:29:05] ℹ️    - Diagnosis 1: ''
[22:29:05] ℹ️    - Diagnosis 2: ''
[22:29:05] ℹ️    - Diagnosis 3: ''
[22:29:05] ℹ️    - Diagnosis 4: ''
[22:29:05] ℹ️    - Diagnosis 5: ''
[22:29:05] ℹ️    - Diagnosis 6: ''
[22:29:05] ℹ️  Final extracted MRN: '3502015'
[22:29:05] ℹ️  Final extracted Sex: 'MALE'
[22:29:05] ℹ️  Final extracted Service Line: 'MSW'
[22:29:05] ℹ️  Final extracted Payer Source: 'Medicare'
[22:29:05] ✅ Patient data extraction completed successfully
[22:29:05] ✅    ✅ Patient data extracted successfully
[22:29:05] 📊 Patient Response
     └─ patientFName: Vitorino
     └─ patientLName: Cabral
     └─ dob: 03/20/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 3502015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:29:05] ✅    ✅ Patient identified: Vitorino Cabral
[22:29:05] ✅    ✅ Patient name validation passed
[22:29:05] 🔄 
🔄 Step 3: Processing patient dates...
[22:29:05] [DOC: 9176655] ℹ️  DOB normalized: 03/20/1943
[22:29:05] [DOC: 9176655] ℹ️  Episode startOfCare normalized: 01/31/2025
[22:29:05] [DOC: 9176655] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[22:29:05] [DOC: 9176655] ℹ️  Episode endOfEpisode normalized: 03/31/2025
[22:29:05] [DOC: 9176655] ✅ Patient date processing completed successfully
[22:29:05] ✅    ✅ Date processing completed
[22:29:05] 📊 Processed Patient Data
     └─ patientFName: Vitorino
     └─ patientLName: Cabral
     └─ dob: 03/20/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 3502015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:29:05] 🔄 
🔄 Step 4: Extracting order data...
[22:29:07] ℹ️  Order extraction - MRN: ''
[22:29:07] ℹ️  Order extraction - Sex: 'MALE'
[22:29:07] ℹ️  Order extraction - Service Line: 'MSW'
[22:29:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:29:07] ✅ Order data extraction completed successfully
[22:29:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:29:07] ℹ️  Using MRN from patient data: '3502015'
[22:29:07] ℹ️  Service line consistent in both sources: 'MSW'
[22:29:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:29:07] ✅ Patient name cross-validation successful
[22:29:07] ✅    ✅ Data merged successfully
[22:29:09] ✅    ✅ Order data extracted and validated
[22:29:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:29:23] [DOC: 9176655] ✅ Patient exists in API: Vitorino Cabral, ID: a658cdc2-75a2-4daa-b9d1-494302195da1
[22:29:23] ✅    ✅ Existing patient found with ID: a658cdc2-75a2-4daa-b9d1-494302195da1
[22:29:23] 🔄 
🔄 Step 6: Pushing order to API...
[22:29:23] [DOC: 9176655] ℹ️  Pushing order via API for patient ID: a658cdc2-75a2-4daa-b9d1-494302195da1
[22:29:24] [DOC: 9176655] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:29:24] ❌    ❌ Failed to push order
[22:29:24] 🔄 
🔄 Step 7: Writing to CSV...
[22:29:24] [DOC: 9176655] ℹ️  Calculated age: 82 from DOB: 03/20/1943
[22:29:24] [DOC: 9176655] ℹ️  Service Line extracted: 'MSW'
[22:29:24] [DOC: 9176655] ℹ️  Payer Source extracted: 'Medicare'
[22:29:24] [DOC: 9176655] ℹ️  Diagnosis codes being written:
[22:29:24] [DOC: 9176655] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:29:24] [DOC: 9176655] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:29:24] [DOC: 9176655] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:29:24] [DOC: 9176655] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:29:24] [DOC: 9176655] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:29:24] [DOC: 9176655] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:29:24] [DOC: 9176655] ✅ Patient data written to CSV: Vitorino Cabral | Sex: MALE | Age: 82 | Service: MSW | Payer: Medicare | MRN: 3502015
[22:29:24] ✅    ✅ Document 9176655 processed and saved successfully
[22:29:24] 🔄 
🔄 Step 8: Saving API details...
[22:29:24] [DOC: 9176655] ℹ️  API push details saved for document 9176655
[22:29:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176654                         ║
================================================================================
[22:29:24] ℹ️  Agency: Dartmouth HH
[22:29:24] ℹ️  Date: 03/12/2025
[22:29:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:29:27] [DOC: 9176654] ✅ Text extracted using pdfplumber (10318 chars)
[22:29:27] ✅    ✅ Text extracted using pdfplumber (10318 chars)
[22:29:27] 🔄 
🔄 Step 2: Extracting patient data...
[22:29:30] ℹ️  AI extracted raw sex value: 'M'
[22:29:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:29:30] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[22:29:30] ℹ️  AI extracted diagnoses:
[22:29:30] ℹ️    - Diagnosis 1: 'C25.9'
[22:29:30] ℹ️    - Diagnosis 2: 'Z48.815'
[22:29:30] ℹ️    - Diagnosis 3: 'Z90.49'
[22:29:30] ℹ️    - Diagnosis 4: 'C61'
[22:29:30] ℹ️    - Diagnosis 5: 'I10'
[22:29:30] ℹ️    - Diagnosis 6: 'G47.09'
[22:29:30] ℹ️  Final extracted MRN: '4777015'
[22:29:30] ℹ️  Final extracted Sex: 'MALE'
[22:29:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:29:30] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:29:30] ✅ Patient data extraction completed successfully
[22:29:30] ✅    ✅ Patient data extracted successfully
[22:29:30] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '08/19/2024', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'C25.9', 'secondDiagnosis': 'Z48.815', 'thirdDiagnosis': 'Z90.49', 'fourthDiagnosis': 'C61', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G47.09'}]
[22:29:30] ✅    ✅ Patient identified: Dennis Langevin
[22:29:30] ✅    ✅ Patient name validation passed
[22:29:30] 🔄 
🔄 Step 3: Processing patient dates...
[22:29:30] [DOC: 9176654] ℹ️  DOB normalized: 04/22/1944
[22:29:30] [DOC: 9176654] ℹ️  Episode startOfCare normalized: 08/21/2024
[22:29:30] [DOC: 9176654] ℹ️  Episode startOfEpisode normalized: 08/19/2024
[22:29:30] [DOC: 9176654] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[22:29:30] [DOC: 9176654] ✅ Patient date processing completed successfully
[22:29:30] ✅    ✅ Date processing completed
[22:29:30] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '08/19/2024', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'C25.9', 'secondDiagnosis': 'Z48.815', 'thirdDiagnosis': 'Z90.49', 'fourthDiagnosis': 'C61', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G47.09'}]
[22:29:30] 🔄 
🔄 Step 4: Extracting order data...
[22:29:32] ℹ️  Order extraction - MRN: '4777015'
[22:29:32] ℹ️  Order extraction - Sex: 'MALE'
[22:29:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:29:32] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:29:32] ✅ Order data extraction completed successfully
[22:29:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:29:32] ℹ️  Using MRN from patient data: '4777015' over '4777015'
[22:29:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:29:32] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[22:29:32] ✅ Patient name cross-validation successful
[22:29:32] ✅    ✅ Data merged successfully
[22:29:33] ✅    ✅ Order data extracted and validated
[22:29:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:29:33] [DOC: 9176654] ✅ Patient found in local cache: Dennis Langevin, ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[22:29:33] ✅    ✅ Existing patient found with ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[22:29:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:29:33] [DOC: 9176654] ℹ️  Pushing order via API for patient ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[22:29:35] [DOC: 9176654] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:29:35] ❌    ❌ Failed to push order
[22:29:35] 🔄 
🔄 Step 7: Writing to CSV...
[22:29:35] [DOC: 9176654] ℹ️  Calculated age: 81 from DOB: 04/22/1944
[22:29:35] [DOC: 9176654] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:29:35] [DOC: 9176654] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[22:29:35] [DOC: 9176654] ℹ️  Diagnosis codes being written:
[22:29:35] [DOC: 9176654] ℹ️    - Latest_Episode_Firstdiagnosis: 'C25.9'
[22:29:35] [DOC: 9176654] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z48.815'
[22:29:35] [DOC: 9176654] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z90.49'
[22:29:35] [DOC: 9176654] ℹ️    - Latest_Episode_Fourthdiagnosis: 'C61'
[22:29:35] [DOC: 9176654] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[22:29:35] [DOC: 9176654] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.09'
[22:29:35] [DOC: 9176654] ✅ Patient data written to CSV: Dennis Langevin | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer: Tufts Health Plan Medicare Preferred | MRN: 4777015
[22:29:35] ✅    ✅ Document 9176654 processed and saved successfully
[22:29:35] 🔄 
🔄 Step 8: Saving API details...
[22:29:35] [DOC: 9176654] ℹ️  API push details saved for document 9176654
[22:29:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176652                         ║
================================================================================
[22:29:35] ℹ️  Agency: Dartmouth HH
[22:29:35] ℹ️  Date: 03/12/2025
[22:29:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:29:36] [DOC: 9176652] ✅ Text extracted using pdfplumber (1319 chars)
[22:29:36] ✅    ✅ Text extracted using pdfplumber (1319 chars)
[22:29:36] 🔄 
🔄 Step 2: Extracting patient data...
[22:29:39] ℹ️  AI extracted raw sex value: 'M'
[22:29:39] ℹ️  AI extracted service line: 'RN'
[22:29:39] ℹ️  AI extracted payer source: 'Medicare'
[22:29:39] ℹ️  AI extracted diagnoses:
[22:29:39] ℹ️    - Diagnosis 1: ''
[22:29:39] ℹ️    - Diagnosis 2: ''
[22:29:39] ℹ️    - Diagnosis 3: ''
[22:29:39] ℹ️    - Diagnosis 4: ''
[22:29:39] ℹ️    - Diagnosis 5: ''
[22:29:39] ℹ️    - Diagnosis 6: ''
[22:29:39] ℹ️  Final extracted MRN: '4937015'
[22:29:39] ℹ️  Final extracted Sex: 'MALE'
[22:29:39] ℹ️  Final extracted Service Line: 'RN'
[22:29:39] ℹ️  Final extracted Payer Source: 'Medicare'
[22:29:39] ✅ Patient data extraction completed successfully
[22:29:39] ✅    ✅ Patient data extracted successfully
[22:29:39] 📊 Patient Response
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:29:39] ✅    ✅ Patient identified: Harvey Lewis
[22:29:39] ✅    ✅ Patient name validation passed
[22:29:39] 🔄 
🔄 Step 3: Processing patient dates...
[22:29:39] [DOC: 9176652] ℹ️  DOB normalized: 05/02/1949
[22:29:39] [DOC: 9176652] ℹ️  Episode startOfCare normalized: 12/18/2024
[22:29:39] [DOC: 9176652] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:29:39] [DOC: 9176652] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:29:39] [DOC: 9176652] ✅ Patient date processing completed successfully
[22:29:39] ✅    ✅ Date processing completed
[22:29:39] 📊 Processed Patient Data
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:29:39] 🔄 
🔄 Step 4: Extracting order data...
[22:29:41] ℹ️  Order extraction - MRN: '4937015'
[22:29:41] ℹ️  Order extraction - Sex: 'MALE'
[22:29:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:29:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:29:41] ✅ Order data extraction completed successfully
[22:29:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:29:41] ℹ️  Using MRN from patient data: '4937015' over '4937015'
[22:29:41] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[22:29:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:29:41] ✅ Patient name cross-validation successful
[22:29:41] ✅    ✅ Data merged successfully
[22:29:43] ✅    ✅ Order data extracted and validated
[22:29:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:29:43] [DOC: 9176652] ✅ Patient found in local cache: Harvey Lewis, ID: 173f09ed-5f3d-4120-a940-63a4db422257
[22:29:43] ✅    ✅ Existing patient found with ID: 173f09ed-5f3d-4120-a940-63a4db422257
[22:29:43] 🔄 
🔄 Step 6: Pushing order to API...
[22:29:43] [DOC: 9176652] ℹ️  Pushing order via API for patient ID: 173f09ed-5f3d-4120-a940-63a4db422257
[22:29:44] [DOC: 9176652] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:29:44] ❌    ❌ Failed to push order
[22:29:44] 🔄 
🔄 Step 7: Writing to CSV...
[22:29:44] [DOC: 9176652] ℹ️  Calculated age: 76 from DOB: 05/02/1949
[22:29:44] [DOC: 9176652] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[22:29:44] [DOC: 9176652] ℹ️  Payer Source extracted: 'Medicare'
[22:29:44] [DOC: 9176652] ℹ️  Diagnosis codes being written:
[22:29:44] [DOC: 9176652] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:29:44] [DOC: 9176652] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:29:44] [DOC: 9176652] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:29:44] [DOC: 9176652] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:29:44] [DOC: 9176652] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:29:44] [DOC: 9176652] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:29:44] [DOC: 9176652] ✅ Patient data written to CSV: Harvey Lewis | Sex: MALE | Age: 76 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 4937015
[22:29:44] ✅    ✅ Document 9176652 processed and saved successfully
[22:29:44] 🔄 
🔄 Step 8: Saving API details...
[22:29:44] [DOC: 9176652] ℹ️  API push details saved for document 9176652
[22:29:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176651                         ║
================================================================================
[22:29:44] ℹ️  Agency: Dartmouth HH
[22:29:44] ℹ️  Date: 03/12/2025
[22:29:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:29:46] [DOC: 9176651] ✅ Text extracted using pdfplumber (1556 chars)
[22:29:46] ✅    ✅ Text extracted using pdfplumber (1556 chars)
[22:29:46] 🔄 
🔄 Step 2: Extracting patient data...
[22:29:49] ℹ️  AI extracted raw sex value: 'F'
[22:29:49] ℹ️  AI extracted service line: 'RN, LPN'
[22:29:49] ℹ️  AI extracted payer source: 'Medicare'
[22:29:49] ℹ️  AI extracted diagnoses:
[22:29:49] ℹ️    - Diagnosis 1: ''
[22:29:49] ℹ️    - Diagnosis 2: ''
[22:29:49] ℹ️    - Diagnosis 3: ''
[22:29:49] ℹ️    - Diagnosis 4: ''
[22:29:49] ℹ️    - Diagnosis 5: ''
[22:29:49] ℹ️    - Diagnosis 6: ''
[22:29:49] ℹ️  Final extracted MRN: '5662015'
[22:29:49] ℹ️  Final extracted Sex: 'FEMALE'
[22:29:49] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:29:49] ℹ️  Final extracted Payer Source: 'Medicare'
[22:29:49] ✅ Patient data extraction completed successfully
[22:29:49] ✅    ✅ Patient data extracted successfully
[22:29:49] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:29:49] ✅    ✅ Patient identified: Betty Mendonca
[22:29:49] ✅    ✅ Patient name validation passed
[22:29:49] 🔄 
🔄 Step 3: Processing patient dates...
[22:29:49] [DOC: 9176651] ℹ️  DOB normalized: 04/08/1948
[22:29:49] [DOC: 9176651] ℹ️  Episode startOfCare normalized: 12/08/2024
[22:29:49] [DOC: 9176651] ℹ️  Episode startOfEpisode normalized: 02/06/2025
[22:29:49] [DOC: 9176651] ℹ️  Episode endOfEpisode normalized: 04/06/2025
[22:29:49] [DOC: 9176651] ✅ Patient date processing completed successfully
[22:29:49] ✅    ✅ Date processing completed
[22:29:49] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:29:49] 🔄 
🔄 Step 4: Extracting order data...
[22:29:51] ℹ️  Order extraction - MRN: ''
[22:29:51] ℹ️  Order extraction - Sex: 'FEMALE'
[22:29:51] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:29:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:29:51] ✅ Order data extraction completed successfully
[22:29:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:29:51] ℹ️  Using MRN from patient data: '5662015'
[22:29:51] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:29:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:29:51] ✅ Patient name cross-validation successful
[22:29:51] ✅    ✅ Data merged successfully
[22:29:52] ✅    ✅ Order data extracted and validated
[22:29:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:29:52] [DOC: 9176651] ✅ Patient found in local cache: Betty Mendonca, ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[22:29:52] ✅    ✅ Existing patient found with ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[22:29:52] 🔄 
🔄 Step 6: Pushing order to API...
[22:29:52] [DOC: 9176651] ℹ️  Pushing order via API for patient ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[22:29:53] [DOC: 9176651] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14093"}
[22:29:53] ❌    ❌ Failed to push order
[22:29:53] 🔄 
🔄 Step 7: Writing to CSV...
[22:29:53] [DOC: 9176651] ℹ️  Calculated age: 77 from DOB: 04/08/1948
[22:29:53] [DOC: 9176651] ℹ️  Service Line extracted: 'RN, LPN'
[22:29:53] [DOC: 9176651] ℹ️  Payer Source extracted: 'Medicare'
[22:29:53] [DOC: 9176651] ℹ️  Diagnosis codes being written:
[22:29:53] [DOC: 9176651] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:29:53] [DOC: 9176651] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:29:53] [DOC: 9176651] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:29:53] [DOC: 9176651] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:29:53] [DOC: 9176651] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:29:53] [DOC: 9176651] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:29:53] [DOC: 9176651] ✅ Patient data written to CSV: Betty Mendonca | Sex: FEMALE | Age: 77 | Service: RN, LPN | Payer: Medicare | MRN: 5662015
[22:29:53] ✅    ✅ Document 9176651 processed and saved successfully
[22:29:53] 🔄 
🔄 Step 8: Saving API details...
[22:29:53] [DOC: 9176651] ℹ️  API push details saved for document 9176651
[22:29:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176650                         ║
================================================================================
[22:29:53] ℹ️  Agency: Dartmouth HH
[22:29:53] ℹ️  Date: 03/12/2025
[22:29:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:29:55] [DOC: 9176650] ✅ Text extracted using pdfplumber (1124 chars)
[22:29:55] ✅    ✅ Text extracted using pdfplumber (1124 chars)
[22:29:55] 🔄 
🔄 Step 2: Extracting patient data...
[22:29:58] ℹ️  AI extracted raw sex value: 'F'
[22:29:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:29:58] ℹ️  AI extracted payer source: 'Senior Whole Health'
[22:29:58] ℹ️  AI extracted diagnoses:
[22:29:58] ℹ️    - Diagnosis 1: 'None'
[22:29:58] ℹ️    - Diagnosis 2: 'None'
[22:29:58] ℹ️    - Diagnosis 3: 'None'
[22:29:58] ℹ️    - Diagnosis 4: 'None'
[22:29:58] ℹ️    - Diagnosis 5: 'None'
[22:29:58] ℹ️    - Diagnosis 6: 'None'
[22:29:58] ℹ️  Final extracted MRN: '2502009'
[22:29:58] ℹ️  Final extracted Sex: 'FEMALE'
[22:29:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:29:58] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[22:29:58] ✅ Patient data extraction completed successfully
[22:29:58] ✅    ✅ Patient data extracted successfully
[22:29:58] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Croken
     └─ dob: 03/23/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 11 Spencer Street Apt 11B
     └─ city: Middleboro
     └─ state: MA
     └─ zip: 02346
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:29:58] ✅    ✅ Patient identified: Judith Croken
[22:29:58] ✅    ✅ Patient name validation passed
[22:29:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:29:58] [DOC: 9176650] ℹ️  DOB normalized: 03/23/1943
[22:29:58] [DOC: 9176650] ℹ️  Episode startOfCare normalized: 02/26/2025
[22:29:58] [DOC: 9176650] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[22:29:58] [DOC: 9176650] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[22:29:58] [DOC: 9176650] ✅ Patient date processing completed successfully
[22:29:58] ✅    ✅ Date processing completed
[22:29:58] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Croken
     └─ dob: 03/23/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 11 Spencer Street Apt 11B
     └─ city: Middleboro
     └─ state: MA
     └─ zip: 02346
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '04/26/2025'}]
[22:29:58] 🔄 
🔄 Step 4: Extracting order data...
[22:30:01] ℹ️  Order extraction - MRN: ''
[22:30:01] ℹ️  Order extraction - Sex: 'FEMALE'
[22:30:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:30:01] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[22:30:01] ✅ Order data extraction completed successfully
[22:30:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:30:01] ℹ️  Using MRN from patient data: '2502009'
[22:30:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:30:01] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[22:30:01] ✅ Patient name cross-validation successful
[22:30:01] ✅    ✅ Data merged successfully
[22:30:02] ✅    ✅ Order data extracted and validated
[22:30:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:30:07] [DOC: 9176650] ✅ Patient exists in API: Judith Croken, ID: 0f90bcc6-75d3-424b-9a82-3bfbf7e38ce7
[22:30:07] ✅    ✅ Existing patient found with ID: 0f90bcc6-75d3-424b-9a82-3bfbf7e38ce7
[22:30:07] 🔄 
🔄 Step 6: Pushing order to API...
[22:30:07] [DOC: 9176650] ℹ️  Pushing order via API for patient ID: 0f90bcc6-75d3-424b-9a82-3bfbf7e38ce7
[22:30:08] [DOC: 9176650] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:30:08] ❌    ❌ Failed to push order
[22:30:08] 🔄 
🔄 Step 7: Writing to CSV...
[22:30:08] [DOC: 9176650] ℹ️  Calculated age: 82 from DOB: 03/23/1943
[22:30:08] [DOC: 9176650] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:30:08] [DOC: 9176650] ℹ️  Payer Source extracted: 'Senior Whole Health'
[22:30:08] [DOC: 9176650] ℹ️  Diagnosis codes being written:
[22:30:08] [DOC: 9176650] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:30:08] [DOC: 9176650] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:30:08] [DOC: 9176650] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:30:08] [DOC: 9176650] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:30:08] [DOC: 9176650] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:30:08] [DOC: 9176650] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:30:08] [DOC: 9176650] ✅ Patient data written to CSV: Judith Croken | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer: Senior Whole Health | MRN: 2502009
[22:30:08] ✅    ✅ Document 9176650 processed and saved successfully
[22:30:08] 🔄 
🔄 Step 8: Saving API details...
[22:30:08] [DOC: 9176650] ℹ️  API push details saved for document 9176650
[22:30:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176648                         ║
================================================================================
[22:30:08] ℹ️  Agency: Dartmouth HH
[22:30:08] ℹ️  Date: 03/12/2025
[22:30:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:30:10] [DOC: 9176648] ✅ Text extracted using pdfplumber (1186 chars)
[22:30:10] ✅    ✅ Text extracted using pdfplumber (1186 chars)
[22:30:10] 🔄 
🔄 Step 2: Extracting patient data...
[22:30:13] ℹ️  AI extracted raw sex value: 'F'
[22:30:13] ℹ️  AI extracted service line: 'RN'
[22:30:13] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[22:30:13] ℹ️  AI extracted diagnoses:
[22:30:13] ℹ️    - Diagnosis 1: ''
[22:30:13] ℹ️    - Diagnosis 2: ''
[22:30:13] ℹ️    - Diagnosis 3: ''
[22:30:13] ℹ️    - Diagnosis 4: ''
[22:30:13] ℹ️    - Diagnosis 5: ''
[22:30:13] ℹ️    - Diagnosis 6: ''
[22:30:13] ℹ️  Final extracted MRN: '2989001'
[22:30:13] ℹ️  Final extracted Sex: 'FEMALE'
[22:30:13] ℹ️  Final extracted Service Line: 'RN'
[22:30:13] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:30:13] ✅ Patient data extraction completed successfully
[22:30:13] ✅    ✅ Patient data extracted successfully
[22:30:13] 📊 Patient Response
     └─ patientFName: Orize
     └─ patientLName: Bourgeois
     └─ dob: 11/05/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2989001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:30:13] ✅    ✅ Patient identified: Orize Bourgeois
[22:30:13] ✅    ✅ Patient name validation passed
[22:30:13] 🔄 
🔄 Step 3: Processing patient dates...
[22:30:13] [DOC: 9176648] ℹ️  DOB normalized: 11/05/1932
[22:30:13] [DOC: 9176648] ℹ️  Episode startOfCare normalized: 02/16/2025
[22:30:13] [DOC: 9176648] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:30:13] [DOC: 9176648] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:30:13] [DOC: 9176648] ✅ Patient date processing completed successfully
[22:30:13] ✅    ✅ Date processing completed
[22:30:13] 📊 Processed Patient Data
     └─ patientFName: Orize
     └─ patientLName: Bourgeois
     └─ dob: 11/05/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2989001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:30:13] 🔄 
🔄 Step 4: Extracting order data...
[22:30:15] ℹ️  Order extraction - MRN: ''
[22:30:15] ℹ️  Order extraction - Sex: 'FEMALE'
[22:30:15] ℹ️  Order extraction - Service Line: 'RN'
[22:30:15] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:30:15] ✅ Order data extraction completed successfully
[22:30:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:30:15] ℹ️  Using MRN from patient data: '2989001'
[22:30:15] ℹ️  Service line consistent in both sources: 'RN'
[22:30:15] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[22:30:15] ✅ Patient name cross-validation successful
[22:30:15] ✅    ✅ Data merged successfully
[22:30:17] ✅    ✅ Order data extracted and validated
[22:30:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:30:30] [DOC: 9176648] ✅ Patient exists in API: Orize Bourgeois, ID: 535e4a0d-1cc7-4dac-85e9-971f6ab5e5af
[22:30:30] ✅    ✅ Existing patient found with ID: 535e4a0d-1cc7-4dac-85e9-971f6ab5e5af
[22:30:30] 🔄 
🔄 Step 6: Pushing order to API...
[22:30:30] [DOC: 9176648] ℹ️  Pushing order via API for patient ID: 535e4a0d-1cc7-4dac-85e9-971f6ab5e5af
[22:30:31] [DOC: 9176648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13322"}
[22:30:31] ❌    ❌ Failed to push order
[22:30:31] 🔄 
🔄 Step 7: Writing to CSV...
[22:30:31] [DOC: 9176648] ℹ️  Calculated age: 92 from DOB: 11/05/1932
[22:30:31] [DOC: 9176648] ℹ️  Service Line extracted: 'RN'
[22:30:31] [DOC: 9176648] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[22:30:31] [DOC: 9176648] ℹ️  Diagnosis codes being written:
[22:30:31] [DOC: 9176648] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:30:31] [DOC: 9176648] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:30:31] [DOC: 9176648] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:30:31] [DOC: 9176648] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:30:31] [DOC: 9176648] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:30:31] [DOC: 9176648] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:30:31] [DOC: 9176648] ✅ Patient data written to CSV: Orize Bourgeois | Sex: FEMALE | Age: 92 | Service: RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 2989001
[22:30:31] ✅    ✅ Document 9176648 processed and saved successfully
[22:30:31] 🔄 
🔄 Step 8: Saving API details...
[22:30:31] [DOC: 9176648] ℹ️  API push details saved for document 9176648
[22:30:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9176645                         ║
================================================================================
[22:30:31] ℹ️  Agency: Dartmouth HH
[22:30:31] ℹ️  Date: 03/12/2025
[22:30:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:30:34] [DOC: 9176645] ✅ Text extracted using pdfplumber (9154 chars)
[22:30:34] ✅    ✅ Text extracted using pdfplumber (9154 chars)
[22:30:34] 🔄 
🔄 Step 2: Extracting patient data...
[22:30:37] ℹ️  AI extracted raw sex value: 'M'
[22:30:37] ℹ️  AI extracted service line: 'PT, OT'
[22:30:37] ℹ️  AI extracted payer source: 'Medicare'
[22:30:37] ℹ️  AI extracted diagnoses:
[22:30:37] ℹ️    - Diagnosis 1: ''
[22:30:37] ℹ️    - Diagnosis 2: ''
[22:30:37] ℹ️    - Diagnosis 3: ''
[22:30:37] ℹ️    - Diagnosis 4: ''
[22:30:37] ℹ️    - Diagnosis 5: ''
[22:30:37] ℹ️    - Diagnosis 6: ''
[22:30:37] ℹ️  Final extracted MRN: '1452015'
[22:30:37] ℹ️  Final extracted Sex: 'MALE'
[22:30:37] ℹ️  Final extracted Service Line: 'PT, OT'
[22:30:37] ℹ️  Final extracted Payer Source: 'Medicare'
[22:30:37] ✅ Patient data extraction completed successfully
[22:30:37] ✅    ✅ Patient data extracted successfully
[22:30:37] 📊 Patient Response
     └─ patientFName: Normand
     └─ patientLName: Paquette
     └─ dob: 08/20/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1452015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/05/2025', 'endOfEpisode': '02/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:30:37] ✅    ✅ Patient identified: Normand Paquette
[22:30:37] ✅    ✅ Patient name validation passed
[22:30:37] 🔄 
🔄 Step 3: Processing patient dates...
[22:30:37] [DOC: 9176645] ℹ️  DOB normalized: 08/20/1935
[22:30:37] [DOC: 9176645] ℹ️  Episode startOfCare normalized: 02/16/2025
[22:30:37] [DOC: 9176645] ℹ️  Episode startOfEpisode normalized: 02/05/2025
[22:30:37] [DOC: 9176645] ℹ️  Episode endOfEpisode normalized: 02/06/2025
[22:30:37] [DOC: 9176645] ✅ Patient date processing completed successfully
[22:30:37] ✅    ✅ Date processing completed
[22:30:37] 📊 Processed Patient Data
     └─ patientFName: Normand
     └─ patientLName: Paquette
     └─ dob: 08/20/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1452015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/05/2025', 'endOfEpisode': '02/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:30:37] 🔄 
🔄 Step 4: Extracting order data...
[22:30:39] ℹ️  Order extraction - MRN: '1452015'
[22:30:39] ℹ️  Order extraction - Sex: 'MALE'
[22:30:39] ℹ️  Order extraction - Service Line: 'PT, OT'
[22:30:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:30:39] ✅ Order data extraction completed successfully
[22:30:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:30:39] ℹ️  Using MRN from patient data: '1452015' over '1452015'
[22:30:39] ℹ️  Service line consistent in both sources: 'PT, OT'
[22:30:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:30:39] ✅ Patient name cross-validation successful
[22:30:39] ✅    ✅ Data merged successfully
[22:30:40] ✅    ✅ Order data extracted and validated
[22:30:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:30:40] [DOC: 9176645] ✅ Patient found in local cache: Normand Paquette, ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[22:30:40] ✅    ✅ Existing patient found with ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[22:30:40] 🔄 
🔄 Step 6: Pushing order to API...
[22:30:41] [DOC: 9176645] ℹ️  Pushing order via API for patient ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[22:30:42] [DOC: 9176645] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:30:42] ❌    ❌ Failed to push order
[22:30:42] 🔄 
🔄 Step 7: Writing to CSV...
[22:30:42] [DOC: 9176645] ℹ️  Calculated age: 89 from DOB: 08/20/1935
[22:30:42] [DOC: 9176645] ℹ️  Service Line extracted: 'PT, OT'
[22:30:42] [DOC: 9176645] ℹ️  Payer Source extracted: 'Medicare'
[22:30:42] [DOC: 9176645] ℹ️  Diagnosis codes being written:
[22:30:42] [DOC: 9176645] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:30:42] [DOC: 9176645] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:30:42] [DOC: 9176645] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:30:42] [DOC: 9176645] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:30:42] [DOC: 9176645] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:30:42] [DOC: 9176645] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:30:42] [DOC: 9176645] ✅ Patient data written to CSV: Normand Paquette | Sex: MALE | Age: 89 | Service: PT, OT | Payer: Medicare | MRN: 1452015
[22:30:42] ✅    ✅ Document 9176645 processed and saved successfully
[22:30:42] 🔄 
🔄 Step 8: Saving API details...
[22:30:42] [DOC: 9176645] ℹ️  API push details saved for document 9176645
[22:30:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9175522                         ║
================================================================================
[22:30:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:30:42] ℹ️  Date: 03/11/2025
[22:30:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:30:45] [DOC: 9175522] ✅ Text extracted using pdfplumber (13464 chars)
[22:30:45] ✅    ✅ Text extracted using pdfplumber (13464 chars)
[22:30:45] 🔄 
🔄 Step 2: Extracting patient data...
[22:30:49] ℹ️  AI extracted raw sex value: 'F'
[22:30:49] ℹ️  AI extracted service line: 'Physical Therapy'
[22:30:49] ℹ️  AI extracted payer source: 'Medicare'
[22:30:49] ℹ️  AI extracted diagnoses:
[22:30:49] ℹ️    - Diagnosis 1: 'Q07.00'
[22:30:49] ℹ️    - Diagnosis 2: 'G31.9'
[22:30:49] ℹ️    - Diagnosis 3: 'R53.1'
[22:30:49] ℹ️    - Diagnosis 4: 'R26.9'
[22:30:49] ℹ️    - Diagnosis 5: 'I10'
[22:30:49] ℹ️    - Diagnosis 6: 'G62.9'
[22:30:49] ℹ️  Final extracted MRN: 'MA230120073707'
[22:30:49] ℹ️  Final extracted Sex: 'FEMALE'
[22:30:49] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:30:49] ℹ️  Final extracted Payer Source: 'Medicare'
[22:30:49] ✅ Patient data extraction completed successfully
[22:30:49] ✅    ✅ Patient data extracted successfully
[22:30:49] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: JAUREGUI, HUGO MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 80 Swift St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 496-8821
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'Q07.00', 'secondDiagnosis': 'G31.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'R26.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G62.9'}]
[22:30:49] ✅    ✅ Patient identified: Diamantina Frias
[22:30:49] ✅    ✅ Patient name validation passed
[22:30:49] 🔄 
🔄 Step 3: Processing patient dates...
[22:30:49] [DOC: 9175522] ℹ️  DOB normalized: 07/04/1937
[22:30:49] [DOC: 9175522] ℹ️  Episode startOfCare normalized: 12/18/2024
[22:30:49] [DOC: 9175522] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:30:49] [DOC: 9175522] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:30:49] [DOC: 9175522] ✅ Patient date processing completed successfully
[22:30:49] ✅    ✅ Date processing completed
[22:30:49] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: JAUREGUI, HUGO MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 80 Swift St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 496-8821
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'Q07.00', 'secondDiagnosis': 'G31.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'R26.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G62.9'}]
[22:30:49] 🔄 
🔄 Step 4: Extracting order data...
[22:30:51] ℹ️  Order extraction - MRN: 'MA230120073707'
[22:30:51] ℹ️  Order extraction - Sex: 'FEMALE'
[22:30:51] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:30:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:30:51] ✅ Order data extraction completed successfully
[22:30:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:30:51] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[22:30:51] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:30:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:30:51] ✅ Patient name cross-validation successful
[22:30:51] ✅    ✅ Data merged successfully
[22:30:53] ✅    ✅ Order data extracted and validated
[22:30:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:30:53] [DOC: 9175522] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:30:53] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:30:53] 🔄 
🔄 Step 6: Pushing order to API...
[22:30:53] [DOC: 9175522] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[22:30:54] [DOC: 9175522] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13005"}
[22:30:54] ❌    ❌ Failed to push order
[22:30:54] 🔄 
🔄 Step 7: Writing to CSV...
[22:30:54] [DOC: 9175522] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[22:30:54] [DOC: 9175522] ℹ️  Service Line extracted: 'Physical Therapy'
[22:30:54] [DOC: 9175522] ℹ️  Payer Source extracted: 'Medicare'
[22:30:54] [DOC: 9175522] ℹ️  Diagnosis codes being written:
[22:30:54] [DOC: 9175522] ℹ️    - Latest_Episode_Firstdiagnosis: 'Q07.00'
[22:30:54] [DOC: 9175522] ℹ️    - Latest_Episode_Seconddiagnosis: 'G31.9'
[22:30:54] [DOC: 9175522] ℹ️    - Latest_Episode_Thirddiagnosis: 'R53.1'
[22:30:54] [DOC: 9175522] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R26.9'
[22:30:54] [DOC: 9175522] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[22:30:54] [DOC: 9175522] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G62.9'
[22:30:54] [DOC: 9175522] ✅ Patient data written to CSV: Diamantina Frias | Sex: FEMALE | Age: 87 | Service: Physical Therapy | Payer: Medicare | MRN: MA230120073707
[22:30:54] ✅    ✅ Document 9175522 processed and saved successfully
[22:30:54] 🔄 
🔄 Step 8: Saving API details...
[22:30:54] [DOC: 9175522] ℹ️  API push details saved for document 9175522
[22:30:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9175274                         ║
================================================================================
[22:30:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:30:54] ℹ️  Date: 03/11/2025
[22:30:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:30:56] [DOC: 9175274] ✅ Text extracted using pdfplumber (1277 chars)
[22:30:56] ✅    ✅ Text extracted using pdfplumber (1277 chars)
[22:30:56] 🔄 
🔄 Step 2: Extracting patient data...
[22:30:58] ℹ️  AI extracted raw sex value: 'F'
[22:30:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:30:58] ℹ️  AI extracted payer source: ''
[22:30:58] ℹ️  AI extracted diagnoses:
[22:30:58] ℹ️    - Diagnosis 1: ''
[22:30:58] ℹ️    - Diagnosis 2: ''
[22:30:58] ℹ️    - Diagnosis 3: ''
[22:30:58] ℹ️    - Diagnosis 4: ''
[22:30:58] ℹ️    - Diagnosis 5: ''
[22:30:58] ℹ️    - Diagnosis 6: ''
[22:30:58] ℹ️  Final extracted MRN: '2221050'
[22:30:58] ℹ️  Final extracted Sex: 'FEMALE'
[22:30:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:30:58] ℹ️  Final extracted Payer Source: ''
[22:30:58] ✅ Patient data extraction completed successfully
[22:30:58] ✅    ✅ Patient data extracted successfully
[22:30:58] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Barros
     └─ dob: 04/30/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2221050
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:30:58] ✅    ✅ Patient identified: Maria Barros
[22:30:58] ✅    ✅ Patient name validation passed
[22:30:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:30:58] [DOC: 9175274] ℹ️  DOB normalized: 04/30/1936
[22:30:58] [DOC: 9175274] ✅ Patient date processing completed successfully
[22:30:58] ✅    ✅ Date processing completed
[22:30:58] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Barros
     └─ dob: 04/30/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2221050
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:30:58] 🔄 
🔄 Step 4: Extracting order data...
[22:31:00] ℹ️  Order extraction - MRN: '2221050'
[22:31:00] ℹ️  Order extraction - Sex: 'FEMALE'
[22:31:00] ℹ️  Order extraction - Service Line: ''
[22:31:00] ℹ️  Order extraction - Payer Source: ''
[22:31:00] ✅ Order data extraction completed successfully
[22:31:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:31:00] ℹ️  Using MRN from patient data: '2221050' over '2221050'
[22:31:00] ℹ️  Using service line from patient data: 'Skilled Nursing'
[22:31:00] ✅ Patient name cross-validation successful
[22:31:00] ✅    ✅ Data merged successfully
[22:31:01] ✅    ✅ Order data extracted and validated
[22:31:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:31:23] [DOC: 9175274] ℹ️  Patient not found in cache or API: Maria Barros
[22:31:23] [DOC: 9175274] ℹ️  Patient not found, creating new patient via API...
[22:31:23] [DOC: 9175274] ℹ️  Creating patient via API: Maria Barros
[22:31:24] [DOC: 9175274] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:31:24] ❌    ❌ Failed to create patient
[22:31:24] [DOC: 9175274] ℹ️  API push details saved for document 9175274
================================================================================
║                        Processing Document ID: 9172119                         ║
================================================================================
[22:31:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:31:24] ℹ️  Date: 03/10/2025
[22:31:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:31:28] [DOC: 9172119] ✅ Text extracted using pdfplumber (17139 chars)
[22:31:28] ✅    ✅ Text extracted using pdfplumber (17139 chars)
[22:31:28] 🔄 
🔄 Step 2: Extracting patient data...
[22:31:31] ℹ️  AI extracted raw sex value: ''
[22:31:31] ℹ️  AI extracted service line: 'PT'
[22:31:31] ℹ️  AI extracted payer source: ''
[22:31:31] ℹ️  AI extracted diagnoses:
[22:31:31] ℹ️    - Diagnosis 1: 'S32.010D'
[22:31:31] ℹ️    - Diagnosis 2: 'R26.2'
[22:31:31] ℹ️    - Diagnosis 3: ''
[22:31:31] ℹ️    - Diagnosis 4: ''
[22:31:31] ℹ️    - Diagnosis 5: ''
[22:31:31] ℹ️    - Diagnosis 6: ''
[22:31:31] ℹ️  Final extracted MRN: 'MA250130055202'
[22:31:31] ℹ️  Final extracted Sex: ''
[22:31:31] ℹ️  Final extracted Service Line: 'PT'
[22:31:31] ℹ️  Final extracted Payer Source: ''
[22:31:31] ✅ Patient data extraction completed successfully
[22:31:31] ✅    ✅ Patient data extracted successfully
[22:31:31] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'S32.010D', 'secondDiagnosis': 'R26.2', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:31:31] ✅    ✅ Patient identified: Philip Dowling
[22:31:31] ✅    ✅ Patient name validation passed
[22:31:31] 🔄 
🔄 Step 3: Processing patient dates...
[22:31:31] [DOC: 9172119] ℹ️  DOB normalized: 05/26/1952
[22:31:31] [DOC: 9172119] ✅ Patient date processing completed successfully
[22:31:31] ✅    ✅ Date processing completed
[22:31:31] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'S32.010D', 'secondDiagnosis': 'R26.2', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:31:31] 🔄 
🔄 Step 4: Extracting order data...
[22:31:33] ℹ️  Order extraction - MRN: 'MA250130055202'
[22:31:33] ℹ️  Order extraction - Sex: 'MALE'
[22:31:33] ℹ️  Order extraction - Service Line: 'PT'
[22:31:33] ℹ️  Order extraction - Payer Source: ''
[22:31:33] ✅ Order data extraction completed successfully
[22:31:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:31:33] ℹ️  Using MRN from patient data: 'MA250130055202' over 'MA250130055202'
[22:31:33] ℹ️  Service line consistent in both sources: 'PT'
[22:31:33] ✅ Patient name cross-validation successful
[22:31:33] ✅    ✅ Data merged successfully
[22:31:35] ✅    ✅ Order data extracted and validated
[22:31:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:32:05] [DOC: 9172119] ℹ️  Patient not found in cache or API: Philip Dowling
[22:32:05] [DOC: 9172119] ℹ️  Patient not found, creating new patient via API...
[22:32:05] [DOC: 9172119] ℹ️  Creating patient via API: Philip Dowling
[22:32:07] [DOC: 9172119] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:32:07] ❌    ❌ Failed to create patient
[22:32:07] [DOC: 9172119] ℹ️  API push details saved for document 9172119
================================================================================
║                        Processing Document ID: 9172118                         ║
================================================================================
[22:32:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:32:07] ℹ️  Date: 03/10/2025
[22:32:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:32:09] [DOC: 9172118] ✅ Text extracted using pdfplumber (1414 chars)
[22:32:09] ✅    ✅ Text extracted using pdfplumber (1402 chars)
[22:32:09] 🔄 
🔄 Step 2: Extracting patient data...
[22:32:13] ℹ️  AI extracted raw sex value: ''
[22:32:13] ℹ️  AI extracted service line: 'Physical Therapy'
[22:32:13] ℹ️  AI extracted payer source: ''
[22:32:13] ℹ️  AI extracted diagnoses:
[22:32:13] ℹ️    - Diagnosis 1: 'S32.010'
[22:32:13] ℹ️    - Diagnosis 2: 'G82.20'
[22:32:13] ℹ️    - Diagnosis 3: 'I69.391'
[22:32:13] ℹ️    - Diagnosis 4: 'None'
[22:32:13] ℹ️    - Diagnosis 5: 'None'
[22:32:13] ℹ️    - Diagnosis 6: 'None'
[22:32:13] ℹ️  Final extracted MRN: 'MA250130055202'
[22:32:13] ℹ️  Final extracted Sex: ''
[22:32:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:32:13] ℹ️  Final extracted Payer Source: ''
[22:32:13] ✅ Patient data extraction completed successfully
[22:32:13] ✅    ✅ Patient data extracted successfully
[22:32:13] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: HANNAH LIEBMAN MD
     └─ npi: 1366975401
     └─ physicianNPI: 1366975401
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'S32.010', 'secondDiagnosis': 'G82.20', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:32:13] ✅    ✅ Patient identified: Philip Dowling
[22:32:13] ✅    ✅ Patient name validation passed
[22:32:13] 🔄 
🔄 Step 3: Processing patient dates...
[22:32:13] [DOC: 9172118] ℹ️  DOB normalized: 05/26/1952
[22:32:13] [DOC: 9172118] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:32:13] [DOC: 9172118] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:32:13] [DOC: 9172118] ✅ Patient date processing completed successfully
[22:32:13] ✅    ✅ Date processing completed
[22:32:13] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: HANNAH LIEBMAN MD
     └─ npi: 1366975401
     └─ physicianNPI: 1366975401
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'S32.010', 'secondDiagnosis': 'G82.20', 'thirdDiagnosis': 'I69.391'}]
[22:32:13] 🔄 
🔄 Step 4: Extracting order data...
[22:32:15] ℹ️  Order extraction - MRN: 'MA250130055202'
[22:32:15] ℹ️  Order extraction - Sex: ''
[22:32:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:32:15] ℹ️  Order extraction - Payer Source: ''
[22:32:15] ✅ Order data extraction completed successfully
[22:32:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:32:15] ℹ️  Using MRN from patient data: 'MA250130055202' over 'MA250130055202'
[22:32:15] ⚠️  Could not determine sex using any available method
[22:32:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:32:15] ✅ Patient name cross-validation successful
[22:32:15] ✅    ✅ Data merged successfully
[22:32:16] ✅    ✅ Order data extracted and validated
[22:32:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:32:44] [DOC: 9172118] ℹ️  Patient not found in cache or API: Philip Dowling
[22:32:44] [DOC: 9172118] ℹ️  Patient not found, creating new patient via API...
[22:32:44] [DOC: 9172118] ℹ️  Creating patient via API: Philip Dowling
[22:32:46] [DOC: 9172118] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:32:46] ❌    ❌ Failed to create patient
[22:32:46] [DOC: 9172118] ℹ️  API push details saved for document 9172118
================================================================================
║                        Processing Document ID: 9172117                         ║
================================================================================
[22:32:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:32:46] ℹ️  Date: 03/10/2025
[22:32:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:32:51] [DOC: 9172117] ✅ Text extracted using pdfplumber (13801 chars)
[22:32:51] ✅    ✅ Text extracted using pdfplumber (13801 chars)
[22:32:51] 🔄 
🔄 Step 2: Extracting patient data...
[22:32:54] ℹ️  AI extracted raw sex value: 'M'
[22:32:54] ℹ️  AI extracted service line: 'OT'
[22:32:54] ℹ️  AI extracted payer source: ''
[22:32:54] ℹ️  AI extracted diagnoses:
[22:32:54] ℹ️    - Diagnosis 1: 'G80.1'
[22:32:54] ℹ️    - Diagnosis 2: 'S11.011A'
[22:32:54] ℹ️    - Diagnosis 3: 'T14.2XXA'
[22:32:54] ℹ️    - Diagnosis 4: 'Rhabdomyolysis'
[22:32:54] ℹ️    - Diagnosis 5: ''
[22:32:54] ℹ️    - Diagnosis 6: ''
[22:32:54] ℹ️  Final extracted MRN: '1253035703'
[22:32:54] ℹ️  Final extracted Sex: 'MALE'
[22:32:54] ℹ️  Final extracted Service Line: 'OT'
[22:32:54] ℹ️  Final extracted Payer Source: ''
[22:32:54] ✅ Patient data extraction completed successfully
[22:32:54] ✅    ✅ Patient data extracted successfully
[22:32:54] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 1253035703
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'G80.1', 'secondDiagnosis': 'S11.011A', 'thirdDiagnosis': 'T14.2XXA', 'fourthDiagnosis': 'Rhabdomyolysis', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:32:54] ✅    ✅ Patient identified: Philip Dowling
[22:32:54] ✅    ✅ Patient name validation passed
[22:32:54] 🔄 
🔄 Step 3: Processing patient dates...
[22:32:54] [DOC: 9172117] ℹ️  DOB normalized: 05/26/1952
[22:32:54] [DOC: 9172117] ✅ Patient date processing completed successfully
[22:32:54] ✅    ✅ Date processing completed
[22:32:54] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 1253035703
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'G80.1', 'secondDiagnosis': 'S11.011A', 'thirdDiagnosis': 'T14.2XXA', 'fourthDiagnosis': 'Rhabdomyolysis', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:32:54] 🔄 
🔄 Step 4: Extracting order data...
[22:32:56] ℹ️  Order extraction - MRN: 'MA250130055202'
[22:32:56] ℹ️  Order extraction - Sex: 'MALE'
[22:32:56] ℹ️  Order extraction - Service Line: 'OT'
[22:32:56] ℹ️  Order extraction - Payer Source: ''
[22:32:56] ✅ Order data extraction completed successfully
[22:32:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:32:56] ℹ️  Using longer MRN from order data: 'MA250130055202' over '1253035703'
[22:32:56] ℹ️  Service line consistent in both sources: 'OT'
[22:32:56] ✅ Patient name cross-validation successful
[22:32:56] ✅    ✅ Data merged successfully
[22:32:57] ✅    ✅ Order data extracted and validated
[22:32:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:33:35] [DOC: 9172117] ℹ️  Patient not found in cache or API: Philip Dowling
[22:33:35] [DOC: 9172117] ℹ️  Patient not found, creating new patient via API...
[22:33:35] [DOC: 9172117] ℹ️  Creating patient via API: Philip Dowling
[22:33:41] [DOC: 9172117] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:33:41] ❌    ❌ Failed to create patient
[22:33:41] [DOC: 9172117] ℹ️  API push details saved for document 9172117
================================================================================
║                        Processing Document ID: 9172115                         ║
================================================================================
[22:33:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:33:41] ℹ️  Date: 03/10/2025
[22:33:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:33:44] [DOC: 9172115] ✅ Text extracted using pdfplumber (1528 chars)
[22:33:44] ✅    ✅ Text extracted using pdfplumber (1516 chars)
[22:33:44] 🔄 
🔄 Step 2: Extracting patient data...
[22:33:47] ℹ️  AI extracted raw sex value: ''
[22:33:47] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:33:47] ℹ️  AI extracted payer source: ''
[22:33:47] ℹ️  AI extracted diagnoses:
[22:33:47] ℹ️    - Diagnosis 1: 'S32.010'
[22:33:47] ℹ️    - Diagnosis 2: 'G82.20'
[22:33:47] ℹ️    - Diagnosis 3: 'I69.391'
[22:33:47] ℹ️    - Diagnosis 4: 'None'
[22:33:47] ℹ️    - Diagnosis 5: 'None'
[22:33:47] ℹ️    - Diagnosis 6: 'None'
[22:33:47] ℹ️  Final extracted MRN: 'MA250130055202'
[22:33:47] ℹ️  Final extracted Sex: ''
[22:33:47] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:33:47] ℹ️  Final extracted Payer Source: ''
[22:33:47] ✅ Patient data extraction completed successfully
[22:33:47] ✅    ✅ Patient data extracted successfully
[22:33:47] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: HANNAH LIEBMAN MD
     └─ npi: 1366975401
     └─ physicianNPI: 1366975401
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'S32.010', 'secondDiagnosis': 'G82.20', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:33:47] ✅    ✅ Patient identified: Philip Dowling
[22:33:47] ✅    ✅ Patient name validation passed
[22:33:47] 🔄 
🔄 Step 3: Processing patient dates...
[22:33:47] [DOC: 9172115] ℹ️  DOB normalized: 05/26/1952
[22:33:47] [DOC: 9172115] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:33:47] [DOC: 9172115] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:33:47] [DOC: 9172115] ✅ Patient date processing completed successfully
[22:33:47] ✅    ✅ Date processing completed
[22:33:47] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: HANNAH LIEBMAN MD
     └─ npi: 1366975401
     └─ physicianNPI: 1366975401
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'S32.010', 'secondDiagnosis': 'G82.20', 'thirdDiagnosis': 'I69.391'}]
[22:33:47] 🔄 
🔄 Step 4: Extracting order data...
[22:33:50] ℹ️  Order extraction - MRN: 'MA250130055202'
[22:33:50] ℹ️  Order extraction - Sex: ''
[22:33:50] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:33:50] ℹ️  Order extraction - Payer Source: ''
[22:33:50] ✅ Order data extraction completed successfully
[22:33:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:33:50] ℹ️  Using MRN from patient data: 'MA250130055202' over 'MA250130055202'
[22:33:50] ⚠️  Could not determine sex using any available method
[22:33:50] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:33:50] ✅ Patient name cross-validation successful
[22:33:50] ✅    ✅ Data merged successfully
[22:33:51] ✅    ✅ Order data extracted and validated
[22:33:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:34:08] [DOC: 9172115] ℹ️  Patient not found in cache or API: Philip Dowling
[22:34:08] [DOC: 9172115] ℹ️  Patient not found, creating new patient via API...
[22:34:08] [DOC: 9172115] ℹ️  Creating patient via API: Philip Dowling
[22:34:10] [DOC: 9172115] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:34:10] ❌    ❌ Failed to create patient
[22:34:10] [DOC: 9172115] ℹ️  API push details saved for document 9172115
================================================================================
║                        Processing Document ID: 9172114                         ║
================================================================================
[22:34:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:34:10] ℹ️  Date: 03/10/2025
[22:34:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:34:14] [DOC: 9172114] ✅ Text extracted using pdfplumber (21518 chars)
[22:34:14] ✅    ✅ Text extracted using pdfplumber (21506 chars)
[22:34:14] 🔄 
🔄 Step 2: Extracting patient data...
[22:34:17] ℹ️  AI extracted raw sex value: 'M'
[22:34:17] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:34:17] ℹ️  AI extracted payer source: 'Medicare'
[22:34:17] ℹ️  AI extracted diagnoses:
[22:34:17] ℹ️    - Diagnosis 1: 'S32.010'
[22:34:17] ℹ️    - Diagnosis 2: 'G82.20'
[22:34:17] ℹ️    - Diagnosis 3: 'I69.391'
[22:34:17] ℹ️    - Diagnosis 4: 'R13.11'
[22:34:17] ℹ️    - Diagnosis 5: 'I69.328'
[22:34:17] ℹ️    - Diagnosis 6: 'M51.369'
[22:34:17] ℹ️  Final extracted MRN: 'MA250130055202'
[22:34:17] ℹ️  Final extracted Sex: 'MALE'
[22:34:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:34:17] ℹ️  Final extracted Payer Source: 'Medicare'
[22:34:17] ✅ Patient data extraction completed successfully
[22:34:17] ✅    ✅ Patient data extracted successfully
[22:34:17] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: Marshman, Dannielle
     └─ npi: 1881923936
     └─ physicianNPI: 1366975401
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 4380 N Main St, #106
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02720
     └─ email: None
     └─ phoneNumber: (508) 676-1859
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2025', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'S32.010', 'secondDiagnosis': 'G82.20', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': 'R13.11', 'fifthDiagnosis': 'I69.328', 'sixthDiagnosis': 'M51.369'}]
[22:34:17] ✅    ✅ Patient identified: Philip Dowling
[22:34:17] ✅    ✅ Patient name validation passed
[22:34:17] 🔄 
🔄 Step 3: Processing patient dates...
[22:34:17] [DOC: 9172114] ℹ️  DOB normalized: 05/26/1952
[22:34:17] [DOC: 9172114] ℹ️  Episode startOfCare normalized: 02/07/2025
[22:34:17] [DOC: 9172114] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:34:17] [DOC: 9172114] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:34:17] [DOC: 9172114] ✅ Patient date processing completed successfully
[22:34:17] ✅    ✅ Date processing completed
[22:34:17] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Dowling
     └─ dob: 05/26/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250130055202
     └─ billingProvider: Marshman, Dannielle
     └─ npi: 1881923936
     └─ physicianNPI: 1366975401
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 4380 N Main St, #106
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02720
     └─ phoneNumber: (508) 676-1859
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2025', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'S32.010', 'secondDiagnosis': 'G82.20', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': 'R13.11', 'fifthDiagnosis': 'I69.328', 'sixthDiagnosis': 'M51.369'}]
[22:34:17] 🔄 
🔄 Step 4: Extracting order data...
[22:34:20] ℹ️  Order extraction - MRN: 'MA250130055202'
[22:34:20] ℹ️  Order extraction - Sex: 'MALE'
[22:34:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:34:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:34:20] ✅ Order data extraction completed successfully
[22:34:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:34:20] ℹ️  Using MRN from patient data: 'MA250130055202' over 'MA250130055202'
[22:34:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:34:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:34:20] ✅ Patient name cross-validation successful
[22:34:20] ✅    ✅ Data merged successfully
[22:34:21] ✅    ✅ Order data extracted and validated
[22:34:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:34:29] [DOC: 9172114] ℹ️  Patient not found in cache or API: Philip Dowling
[22:34:29] [DOC: 9172114] ℹ️  Patient not found, creating new patient via API...
[22:34:29] [DOC: 9172114] ℹ️  Creating patient via API: Philip Dowling
[22:34:30] [DOC: 9172114] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:34:30] ❌    ❌ Failed to create patient
[22:34:30] [DOC: 9172114] ℹ️  API push details saved for document 9172114
================================================================================
║                        Processing Document ID: 9171609                         ║
================================================================================
[22:34:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:34:30] ℹ️  Date: 03/10/2025
[22:34:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:34:33] [DOC: 9171609] ✅ Text extracted using pdfplumber (1200 chars)
[22:34:33] ✅    ✅ Text extracted using pdfplumber (1200 chars)
[22:34:33] 🔄 
🔄 Step 2: Extracting patient data...
[22:34:36] ℹ️  AI extracted raw sex value: ''
[22:34:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:34:36] ℹ️  AI extracted payer source: ''
[22:34:36] ℹ️  AI extracted diagnoses:
[22:34:36] ℹ️    - Diagnosis 1: 'I87.2'
[22:34:36] ℹ️    - Diagnosis 2: 'I87.319'
[22:34:36] ℹ️    - Diagnosis 3: 'L03.115'
[22:34:36] ℹ️    - Diagnosis 4: ''
[22:34:36] ℹ️    - Diagnosis 5: ''
[22:34:36] ℹ️    - Diagnosis 6: ''
[22:34:36] ℹ️  Final extracted MRN: 'MA240208045102'
[22:34:36] ℹ️  Final extracted Sex: ''
[22:34:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:34:36] ℹ️  Final extracted Payer Source: ''
[22:34:36] ✅ Patient data extraction completed successfully
[22:34:36] ✅    ✅ Patient data extracted successfully
[22:34:36] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Nunes
     └─ dob: 04/21/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA240208045102
     └─ billingProvider: THEOPHILUS ADDO MD
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/12/2024', 'endOfEpisode': '04/11/2024', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'I87.319', 'thirdDiagnosis': 'L03.115', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:34:36] ✅    ✅ Patient identified: Jay Nunes
[22:34:36] ✅    ✅ Patient name validation passed
[22:34:36] 🔄 
🔄 Step 3: Processing patient dates...
[22:34:36] [DOC: 9171609] ℹ️  DOB normalized: 04/21/1951
[22:34:36] [DOC: 9171609] ℹ️  Episode startOfEpisode normalized: 02/12/2024
[22:34:36] [DOC: 9171609] ℹ️  Episode endOfEpisode normalized: 04/11/2024
[22:34:36] [DOC: 9171609] ✅ Patient date processing completed successfully
[22:34:36] ✅    ✅ Date processing completed
[22:34:36] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Nunes
     └─ dob: 04/21/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA240208045102
     └─ billingProvider: THEOPHILUS ADDO MD
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/12/2024', 'endOfEpisode': '04/11/2024', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'I87.319', 'thirdDiagnosis': 'L03.115', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:34:36] 🔄 
🔄 Step 4: Extracting order data...
[22:34:39] ℹ️  Order extraction - MRN: 'MA240208045102'
[22:34:39] ℹ️  Order extraction - Sex: ''
[22:34:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:34:39] ℹ️  Order extraction - Payer Source: ''
[22:34:39] ✅ Order data extraction completed successfully
[22:34:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:34:39] ℹ️  Using MRN from patient data: 'MA240208045102' over 'MA240208045102'
[22:34:39] ⚠️  Could not determine sex using any available method
[22:34:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:34:39] ✅ Patient name cross-validation successful
[22:34:39] ✅    ✅ Data merged successfully
[22:34:40] ✅    ✅ Order data extracted and validated
[22:34:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:34:51] [DOC: 9171609] ✅ Patient exists in API: Jay Nunes, ID: 58b9c6ad-589a-4fa2-bb72-7c256db3c73b
[22:34:51] ✅    ✅ Existing patient found with ID: 58b9c6ad-589a-4fa2-bb72-7c256db3c73b
[22:34:51] 🔄 
🔄 Step 6: Pushing order to API...
[22:34:51] [DOC: 9171609] ℹ️  Pushing order via API for patient ID: 58b9c6ad-589a-4fa2-bb72-7c256db3c73b
[22:34:52] [DOC: 9171609] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12957"}
[22:34:52] ❌    ❌ Failed to push order
[22:34:52] 🔄 
🔄 Step 7: Writing to CSV...
[22:34:52] [DOC: 9171609] ℹ️  Calculated age: 74 from DOB: 04/21/1951
[22:34:52] [DOC: 9171609] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:34:52] [DOC: 9171609] ℹ️  Payer Source extracted: ''
[22:34:52] [DOC: 9171609] ℹ️  Diagnosis codes being written:
[22:34:52] [DOC: 9171609] ℹ️    - Latest_Episode_Firstdiagnosis: 'I87.2'
[22:34:52] [DOC: 9171609] ℹ️    - Latest_Episode_Seconddiagnosis: 'I87.319'
[22:34:52] [DOC: 9171609] ℹ️    - Latest_Episode_Thirddiagnosis: 'L03.115'
[22:34:52] [DOC: 9171609] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:34:52] [DOC: 9171609] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:34:52] [DOC: 9171609] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:34:52] [DOC: 9171609] ✅ Patient data written to CSV: Jay Nunes | Sex:  | Age: 74 | Service: Skilled Nursing | Payer:  | MRN: MA240208045102
[22:34:52] ✅    ✅ Document 9171609 processed and saved successfully
[22:34:52] 🔄 
🔄 Step 8: Saving API details...
[22:34:52] [DOC: 9171609] ℹ️  API push details saved for document 9171609
[22:34:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9171601                         ║
================================================================================
[22:34:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:34:52] ℹ️  Date: 03/10/2025
[22:34:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:34:55] [DOC: 9171601] ✅ Text extracted using pdfplumber (12258 chars)
[22:34:55] ✅    ✅ Text extracted using pdfplumber (12258 chars)
[22:34:55] 🔄 
🔄 Step 2: Extracting patient data...
[22:34:58] ℹ️  AI extracted raw sex value: 'M'
[22:34:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:34:58] ℹ️  AI extracted payer source: 'Medicare'
[22:34:58] ℹ️  AI extracted diagnoses:
[22:34:58] ℹ️    - Diagnosis 1: 'I87.2'
[22:34:58] ℹ️    - Diagnosis 2: 'I87.319'
[22:34:58] ℹ️    - Diagnosis 3: 'L03.115'
[22:34:58] ℹ️    - Diagnosis 4: 'E11.65'
[22:34:58] ℹ️    - Diagnosis 5: 'I48.91'
[22:34:58] ℹ️    - Diagnosis 6: 'I10'
[22:34:58] ℹ️  Final extracted MRN: 'MA240208045102'
[22:34:58] ℹ️  Final extracted Sex: 'MALE'
[22:34:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:34:58] ℹ️  Final extracted Payer Source: 'Medicare'
[22:34:58] ✅ Patient data extraction completed successfully
[22:34:58] ✅    ✅ Patient data extracted successfully
[22:34:58] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Nunes
     └─ dob: 04/21/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240208045102
     └─ billingProvider: SOSA, JESUS M.D.
     └─ npi: 1881923936
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 180 Rochambeau St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (774) 202-3589
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2024', 'startOfEpisode': '06/11/2024', 'endOfEpisode': '08/09/2024', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'I87.319', 'thirdDiagnosis': 'L03.115', 'fourthDiagnosis': 'E11.65', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I10'}]
[22:34:58] ✅    ✅ Patient identified: Jay Nunes
[22:34:58] ✅    ✅ Patient name validation passed
[22:34:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:34:58] [DOC: 9171601] ℹ️  DOB normalized: 04/21/1951
[22:34:58] [DOC: 9171601] ℹ️  Episode startOfCare normalized: 02/12/2024
[22:34:58] [DOC: 9171601] ℹ️  Episode startOfEpisode normalized: 06/11/2024
[22:34:58] [DOC: 9171601] ℹ️  Episode endOfEpisode normalized: 08/09/2024
[22:34:58] [DOC: 9171601] ✅ Patient date processing completed successfully
[22:34:58] ✅    ✅ Date processing completed
[22:34:58] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Nunes
     └─ dob: 04/21/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240208045102
     └─ billingProvider: SOSA, JESUS M.D.
     └─ npi: 1881923936
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 180 Rochambeau St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (774) 202-3589
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2024', 'startOfEpisode': '06/11/2024', 'endOfEpisode': '08/09/2024', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'I87.319', 'thirdDiagnosis': 'L03.115', 'fourthDiagnosis': 'E11.65', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I10'}]
[22:34:58] 🔄 
🔄 Step 4: Extracting order data...
[22:35:01] ℹ️  Order extraction - MRN: 'MA240208045102'
[22:35:01] ℹ️  Order extraction - Sex: 'MALE'
[22:35:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:35:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:35:01] ✅ Order data extraction completed successfully
[22:35:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:35:01] ℹ️  Using MRN from patient data: 'MA240208045102' over 'MA240208045102'
[22:35:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:35:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:35:01] ✅ Patient name cross-validation successful
[22:35:01] ✅    ✅ Data merged successfully
[22:35:02] ✅    ✅ Order data extracted and validated
[22:35:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:35:02] [DOC: 9171601] ✅ Patient found in local cache: Jay Nunes, ID: 58b9c6ad-589a-4fa2-bb72-7c256db3c73b
[22:35:02] ✅    ✅ Existing patient found with ID: 58b9c6ad-589a-4fa2-bb72-7c256db3c73b
[22:35:02] 🔄 
🔄 Step 6: Pushing order to API...
[22:35:02] [DOC: 9171601] ℹ️  Pushing order via API for patient ID: 58b9c6ad-589a-4fa2-bb72-7c256db3c73b
[22:35:03] [DOC: 9171601] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12958"}
[22:35:03] ❌    ❌ Failed to push order
[22:35:03] 🔄 
🔄 Step 7: Writing to CSV...
[22:35:03] [DOC: 9171601] ℹ️  Calculated age: 74 from DOB: 04/21/1951
[22:35:03] [DOC: 9171601] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:35:03] [DOC: 9171601] ℹ️  Payer Source extracted: 'Medicare'
[22:35:03] [DOC: 9171601] ℹ️  Diagnosis codes being written:
[22:35:03] [DOC: 9171601] ℹ️    - Latest_Episode_Firstdiagnosis: 'I87.2'
[22:35:03] [DOC: 9171601] ℹ️    - Latest_Episode_Seconddiagnosis: 'I87.319'
[22:35:03] [DOC: 9171601] ℹ️    - Latest_Episode_Thirddiagnosis: 'L03.115'
[22:35:03] [DOC: 9171601] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.65'
[22:35:03] [DOC: 9171601] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[22:35:03] [DOC: 9171601] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[22:35:03] [DOC: 9171601] ✅ Patient data written to CSV: Jay Nunes | Sex: MALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240208045102
[22:35:03] ✅    ✅ Document 9171601 processed and saved successfully
[22:35:03] 🔄 
🔄 Step 8: Saving API details...
[22:35:03] [DOC: 9171601] ℹ️  API push details saved for document 9171601
[22:35:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9171067                         ║
================================================================================
[22:35:03] ℹ️  Agency: Nizhoni Health-Fall River
[22:35:03] ℹ️  Date: 03/10/2025
[22:35:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:35:13] [DOC: 9171067] ✅ Text extracted using pdfplumber (1034 chars)
[22:35:13] ✅    ✅ Text extracted using pdfplumber (1034 chars)
[22:35:13] 🔄 
🔄 Step 2: Extracting patient data...
[22:35:15] ℹ️  AI extracted raw sex value: 'M'
[22:35:15] ℹ️  AI extracted service line: 'HHA'
[22:35:15] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance One Care'
[22:35:15] ℹ️  AI extracted diagnoses:
[22:35:15] ℹ️    - Diagnosis 1: 'None'
[22:35:15] ℹ️    - Diagnosis 2: 'None'
[22:35:15] ℹ️    - Diagnosis 3: 'None'
[22:35:15] ℹ️    - Diagnosis 4: 'None'
[22:35:15] ℹ️    - Diagnosis 5: 'None'
[22:35:15] ℹ️    - Diagnosis 6: 'None'
[22:35:15] ℹ️  Final extracted MRN: '18016'
[22:35:15] ℹ️  Final extracted Sex: 'MALE'
[22:35:15] ℹ️  Final extracted Service Line: 'HHA'
[22:35:15] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance One Care'
[22:35:15] ✅ Patient data extraction completed successfully
[22:35:15] ✅    ✅ Patient data extracted successfully
[22:35:15] 📊 Patient Response
     └─ patientFName: Craig
     └─ patientLName: Leite
     └─ dob: 12/14/1987
     └─ patientSex: MALE
     └─ medicalRecordNo: 18016
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 161 Maxfield st 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 973-1140
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2020', 'startOfEpisode': None, 'endOfEpisode': '04/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:35:15] ✅    ✅ Patient identified: Craig Leite
[22:35:15] ✅    ✅ Patient name validation passed
[22:35:15] 🔄 
🔄 Step 3: Processing patient dates...
[22:35:15] [DOC: 9171067] ℹ️  DOB normalized: 12/14/1987
[22:35:15] [DOC: 9171067] ℹ️  Episode startOfCare normalized: 01/22/2020
[22:35:15] [DOC: 9171067] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[22:35:15] [DOC: 9171067] ✅ Patient date processing completed successfully
[22:35:15] ✅    ✅ Date processing completed
[22:35:15] 📊 Processed Patient Data
     └─ patientFName: Craig
     └─ patientLName: Leite
     └─ dob: 12/14/1987
     └─ patientSex: MALE
     └─ medicalRecordNo: 18016
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 161 Maxfield st 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 973-1140
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2020', 'endOfEpisode': '04/24/2025'}]
[22:35:15] 🔄 
🔄 Step 4: Extracting order data...
[22:35:18] ℹ️  Order extraction - MRN: '18016'
[22:35:18] ℹ️  Order extraction - Sex: 'MALE'
[22:35:18] ℹ️  Order extraction - Service Line: ''
[22:35:18] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance One Care'
[22:35:18] ✅ Order data extraction completed successfully
[22:35:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:35:18] ℹ️  Using MRN from patient data: '18016' over '18016'
[22:35:18] ℹ️  Using service line from patient data: 'HHA'
[22:35:18] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance One Care'
[22:35:18] ✅ Patient name cross-validation successful
[22:35:18] ✅    ✅ Data merged successfully
[22:35:19] ✅    ✅ Order data extracted and validated
[22:35:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:35:19] [DOC: 9171067] ✅ Patient found in local cache: Craig Leite, ID: 841862b6-562d-466d-bbe3-040191d78347
[22:35:19] ✅    ✅ Existing patient found with ID: 841862b6-562d-466d-bbe3-040191d78347
[22:35:19] 🔄 
🔄 Step 6: Pushing order to API...
[22:35:19] [DOC: 9171067] ℹ️  Pushing order via API for patient ID: 841862b6-562d-466d-bbe3-040191d78347
[22:35:21] [DOC: 9171067] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:35:21] ❌    ❌ Failed to push order
[22:35:21] 🔄 
🔄 Step 7: Writing to CSV...
[22:35:21] [DOC: 9171067] ℹ️  Calculated age: 37 from DOB: 12/14/1987
[22:35:21] [DOC: 9171067] ℹ️  Service Line extracted: 'HHA'
[22:35:21] [DOC: 9171067] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance One Care'
[22:35:21] [DOC: 9171067] ℹ️  Diagnosis codes being written:
[22:35:21] [DOC: 9171067] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:35:21] [DOC: 9171067] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:35:21] [DOC: 9171067] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:35:21] [DOC: 9171067] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:35:21] [DOC: 9171067] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:35:21] [DOC: 9171067] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:35:21] [DOC: 9171067] ✅ Patient data written to CSV: Craig Leite | Sex: MALE | Age: 37 | Service: HHA | Payer: Commonwealth Care Alliance One Care | MRN: 18016
[22:35:21] ✅    ✅ Document 9171067 processed and saved successfully
[22:35:21] 🔄 
🔄 Step 8: Saving API details...
[22:35:21] [DOC: 9171067] ℹ️  API push details saved for document 9171067
[22:35:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9172183                         ║
================================================================================
[22:35:21] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:35:21] ℹ️  Date: 03/10/2025
[22:35:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:35:24] [DOC: 9172183] ✅ Text extracted using pdfplumber (11838 chars)
[22:35:24] ✅    ✅ Text extracted using pdfplumber (11838 chars)
[22:35:24] 🔄 
🔄 Step 2: Extracting patient data...
[22:35:27] ℹ️  AI extracted raw sex value: 'F'
[22:35:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:35:27] ℹ️  AI extracted payer source: 'SWH insurance'
[22:35:27] ℹ️  AI extracted diagnoses:
[22:35:27] ℹ️    - Diagnosis 1: 'E11.21'
[22:35:27] ℹ️    - Diagnosis 2: 'J44.9'
[22:35:27] ℹ️    - Diagnosis 3: 'I10'
[22:35:27] ℹ️    - Diagnosis 4: 'D50.9'
[22:35:27] ℹ️    - Diagnosis 5: 'F41.9'
[22:35:27] ℹ️    - Diagnosis 6: 'F33.8'
[22:35:27] ℹ️  Final extracted MRN: '100990266'
[22:35:27] ℹ️  Final extracted Sex: 'FEMALE'
[22:35:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:35:27] ℹ️  Final extracted Payer Source: 'SWH insurance'
[22:35:27] ✅ Patient data extraction completed successfully
[22:35:27] ✅    ✅ Patient data extracted successfully
[22:35:27] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '12/28/2024', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[22:35:27] ✅    ✅ Patient identified: Maria Antunes
[22:35:27] ✅    ✅ Patient name validation passed
[22:35:27] 🔄 
🔄 Step 3: Processing patient dates...
[22:35:27] [DOC: 9172183] ℹ️  DOB normalized: 11/22/1934
[22:35:27] [DOC: 9172183] ℹ️  Episode startOfCare normalized: 09/05/2023
[22:35:27] [DOC: 9172183] ℹ️  Episode startOfEpisode normalized: 12/28/2024
[22:35:27] [DOC: 9172183] ℹ️  Episode endOfEpisode normalized: 02/25/2025
[22:35:27] [DOC: 9172183] ✅ Patient date processing completed successfully
[22:35:27] ✅    ✅ Date processing completed
[22:35:27] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '12/28/2024', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[22:35:27] 🔄 
🔄 Step 4: Extracting order data...
[22:35:30] ℹ️  Order extraction - MRN: '100990266'
[22:35:30] ℹ️  Order extraction - Sex: 'FEMALE'
[22:35:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:35:30] ℹ️  Order extraction - Payer Source: 'SWH insurance'
[22:35:30] ✅ Order data extraction completed successfully
[22:35:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:35:30] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[22:35:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:35:30] ℹ️  Payer source consistent in both sources: 'SWH insurance'
[22:35:30] ✅ Patient name cross-validation successful
[22:35:30] ✅    ✅ Data merged successfully
[22:35:31] ✅    ✅ Order data extracted and validated
[22:35:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:35:31] [DOC: 9172183] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:31] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:31] 🔄 
🔄 Step 6: Pushing order to API...
[22:35:31] [DOC: 9172183] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:32] [DOC: 9172183] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12941"}
[22:35:32] ❌    ❌ Failed to push order
[22:35:32] 🔄 
🔄 Step 7: Writing to CSV...
[22:35:32] [DOC: 9172183] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[22:35:32] [DOC: 9172183] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:35:32] [DOC: 9172183] ℹ️  Payer Source extracted: 'SWH insurance'
[22:35:32] [DOC: 9172183] ℹ️  Diagnosis codes being written:
[22:35:32] [DOC: 9172183] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.21'
[22:35:32] [DOC: 9172183] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[22:35:32] [DOC: 9172183] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:35:32] [DOC: 9172183] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[22:35:32] [DOC: 9172183] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[22:35:32] [DOC: 9172183] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[22:35:32] [DOC: 9172183] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: SWH insurance | MRN: 100990266
[22:35:32] ✅    ✅ Document 9172183 processed and saved successfully
[22:35:32] 🔄 
🔄 Step 8: Saving API details...
[22:35:32] [DOC: 9172183] ℹ️  API push details saved for document 9172183
[22:35:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9172134                         ║
================================================================================
[22:35:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:35:32] ℹ️  Date: 03/10/2025
[22:35:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:35:34] [DOC: 9172134] ✅ Text extracted using pdfplumber (1244 chars)
[22:35:34] ✅    ✅ Text extracted using pdfplumber (1244 chars)
[22:35:34] 🔄 
🔄 Step 2: Extracting patient data...
[22:35:37] ℹ️  AI extracted raw sex value: ''
[22:35:37] ℹ️  AI extracted service line: 'LPN'
[22:35:37] ℹ️  AI extracted payer source: ''
[22:35:37] ℹ️  AI extracted diagnoses:
[22:35:37] ℹ️    - Diagnosis 1: 'E11.21'
[22:35:37] ℹ️    - Diagnosis 2: 'J44.9'
[22:35:37] ℹ️    - Diagnosis 3: 'I10'
[22:35:37] ℹ️    - Diagnosis 4: ''
[22:35:37] ℹ️    - Diagnosis 5: ''
[22:35:37] ℹ️    - Diagnosis 6: ''
[22:35:37] ℹ️  Final extracted MRN: '100990266'
[22:35:37] ℹ️  Final extracted Sex: ''
[22:35:37] ℹ️  Final extracted Service Line: 'LPN'
[22:35:37] ℹ️  Final extracted Payer Source: ''
[22:35:37] ✅ Patient data extraction completed successfully
[22:35:37] ✅    ✅ Patient data extracted successfully
[22:35:37] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/28/2024', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:35:37] ✅    ✅ Patient identified: Maria Antunes
[22:35:37] ✅    ✅ Patient name validation passed
[22:35:37] 🔄 
🔄 Step 3: Processing patient dates...
[22:35:37] [DOC: 9172134] ℹ️  DOB normalized: 11/22/1934
[22:35:37] [DOC: 9172134] ℹ️  Episode startOfEpisode normalized: 12/28/2024
[22:35:37] [DOC: 9172134] ℹ️  Episode endOfEpisode normalized: 02/25/2025
[22:35:37] [DOC: 9172134] ✅ Patient date processing completed successfully
[22:35:37] ✅    ✅ Date processing completed
[22:35:37] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/28/2024', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:35:37] 🔄 
🔄 Step 4: Extracting order data...
[22:35:39] ℹ️  Order extraction - MRN: '100990266'
[22:35:39] ℹ️  Order extraction - Sex: ''
[22:35:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:35:39] ℹ️  Order extraction - Payer Source: ''
[22:35:39] ✅ Order data extraction completed successfully
[22:35:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:35:39] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[22:35:39] ℹ️  Inferred sex as FEMALE from name: Maria
[22:35:39] ℹ️  Combined service lines: Patient='LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[22:35:39] ✅ Patient name cross-validation successful
[22:35:39] ✅    ✅ Data merged successfully
[22:35:40] ✅    ✅ Order data extracted and validated
[22:35:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:35:40] [DOC: 9172134] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:40] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:40] 🔄 
🔄 Step 6: Pushing order to API...
[22:35:40] [DOC: 9172134] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:42] [DOC: 9172134] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12948"}
[22:35:42] ❌    ❌ Failed to push order
[22:35:42] 🔄 
🔄 Step 7: Writing to CSV...
[22:35:42] [DOC: 9172134] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[22:35:42] [DOC: 9172134] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[22:35:42] [DOC: 9172134] ℹ️  Payer Source extracted: ''
[22:35:42] [DOC: 9172134] ℹ️  Diagnosis codes being written:
[22:35:42] [DOC: 9172134] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.21'
[22:35:42] [DOC: 9172134] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[22:35:42] [DOC: 9172134] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:35:42] [DOC: 9172134] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:35:42] [DOC: 9172134] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:35:42] [DOC: 9172134] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:35:42] [DOC: 9172134] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: LPN, Skilled Nursing | Payer:  | MRN: 100990266
[22:35:42] ✅    ✅ Document 9172134 processed and saved successfully
[22:35:42] 🔄 
🔄 Step 8: Saving API details...
[22:35:42] [DOC: 9172134] ℹ️  API push details saved for document 9172134
[22:35:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9172109                         ║
================================================================================
[22:35:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:35:42] ℹ️  Date: 03/10/2025
[22:35:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:35:44] [DOC: 9172109] ✅ Text extracted using pdfplumber (1732 chars)
[22:35:44] ✅    ✅ Text extracted using pdfplumber (1732 chars)
[22:35:44] 🔄 
🔄 Step 2: Extracting patient data...
[22:35:47] ℹ️  AI extracted raw sex value: ''
[22:35:47] ℹ️  AI extracted service line: 'Skilled Nursing, LPN'
[22:35:47] ℹ️  AI extracted payer source: ''
[22:35:47] ℹ️  AI extracted diagnoses:
[22:35:47] ℹ️    - Diagnosis 1: 'E11.21'
[22:35:47] ℹ️    - Diagnosis 2: 'J44.9'
[22:35:47] ℹ️    - Diagnosis 3: 'I10'
[22:35:47] ℹ️    - Diagnosis 4: ''
[22:35:47] ℹ️    - Diagnosis 5: ''
[22:35:47] ℹ️    - Diagnosis 6: ''
[22:35:47] ℹ️  Final extracted MRN: '100990266'
[22:35:47] ℹ️  Final extracted Sex: ''
[22:35:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN'
[22:35:47] ℹ️  Final extracted Payer Source: ''
[22:35:47] ✅ Patient data extraction completed successfully
[22:35:47] ✅    ✅ Patient data extracted successfully
[22:35:47] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '10/29/2024', 'endOfEpisode': '12/27/2024', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:35:47] ✅    ✅ Patient identified: Maria Antunes
[22:35:47] ✅    ✅ Patient name validation passed
[22:35:47] 🔄 
🔄 Step 3: Processing patient dates...
[22:35:47] [DOC: 9172109] ℹ️  DOB normalized: 11/22/1934
[22:35:47] [DOC: 9172109] ℹ️  Episode startOfEpisode normalized: 10/29/2024
[22:35:47] [DOC: 9172109] ℹ️  Episode endOfEpisode normalized: 12/27/2024
[22:35:47] [DOC: 9172109] ✅ Patient date processing completed successfully
[22:35:47] ✅    ✅ Date processing completed
[22:35:47] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '10/29/2024', 'endOfEpisode': '12/27/2024', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:35:47] 🔄 
🔄 Step 4: Extracting order data...
[22:35:50] ℹ️  Order extraction - MRN: '100990266'
[22:35:50] ℹ️  Order extraction - Sex: ''
[22:35:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:35:50] ℹ️  Order extraction - Payer Source: ''
[22:35:50] ✅ Order data extraction completed successfully
[22:35:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:35:50] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[22:35:50] ℹ️  Inferred sex as FEMALE from name: Maria
[22:35:50] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[22:35:50] ✅ Patient name cross-validation successful
[22:35:50] ✅    ✅ Data merged successfully
[22:35:51] ✅    ✅ Order data extracted and validated
[22:35:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:35:51] [DOC: 9172109] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:51] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:51] 🔄 
🔄 Step 6: Pushing order to API...
[22:35:51] [DOC: 9172109] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:35:52] [DOC: 9172109] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12949"}
[22:35:52] ❌    ❌ Failed to push order
[22:35:52] 🔄 
🔄 Step 7: Writing to CSV...
[22:35:52] [DOC: 9172109] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[22:35:52] [DOC: 9172109] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[22:35:52] [DOC: 9172109] ℹ️  Payer Source extracted: ''
[22:35:52] [DOC: 9172109] ℹ️  Diagnosis codes being written:
[22:35:52] [DOC: 9172109] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.21'
[22:35:52] [DOC: 9172109] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[22:35:52] [DOC: 9172109] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:35:52] [DOC: 9172109] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:35:52] [DOC: 9172109] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:35:52] [DOC: 9172109] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:35:52] [DOC: 9172109] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: LPN, Skilled Nursing | Payer:  | MRN: 100990266
[22:35:52] ✅    ✅ Document 9172109 processed and saved successfully
[22:35:52] 🔄 
🔄 Step 8: Saving API details...
[22:35:52] [DOC: 9172109] ℹ️  API push details saved for document 9172109
[22:35:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9170853                         ║
================================================================================
[22:35:52] ℹ️  Agency: Dartmouth HH
[22:35:52] ℹ️  Date: 03/10/2025
[22:35:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:35:55] [DOC: 9170853] ✅ Text extracted using pdfplumber (17158 chars)
[22:35:55] ✅    ✅ Text extracted using pdfplumber (17146 chars)
[22:35:55] 🔄 
🔄 Step 2: Extracting patient data...
[22:35:58] ℹ️  AI extracted raw sex value: 'M'
[22:35:58] ℹ️  AI extracted service line: 'PT, OT'
[22:35:58] ℹ️  AI extracted payer source: 'None'
[22:35:58] ℹ️  AI extracted diagnoses:
[22:35:58] ℹ️    - Diagnosis 1: 'S32.040A'
[22:35:58] ℹ️    - Diagnosis 2: 'S32.050A'
[22:35:58] ℹ️    - Diagnosis 3: 'I12.9'
[22:35:58] ℹ️    - Diagnosis 4: 'E11.22'
[22:35:58] ℹ️    - Diagnosis 5: 'N18.31'
[22:35:58] ℹ️    - Diagnosis 6: 'I25.10'
[22:35:58] ℹ️  Final extracted MRN: '6129015'
[22:35:58] ℹ️  Final extracted Sex: 'MALE'
[22:35:58] ℹ️  Final extracted Service Line: 'PT, OT'
[22:35:58] ℹ️  Final extracted Payer Source: ''
[22:35:58] ✅ Patient data extraction completed successfully
[22:35:58] ✅    ✅ Patient data extracted successfully
[22:35:58] 📊 Patient Response
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'S32.040A', 'secondDiagnosis': 'S32.050A', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'I25.10'}]
[22:35:58] ✅    ✅ Patient identified: Theodore Small
[22:35:58] ✅    ✅ Patient name validation passed
[22:35:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:35:58] [DOC: 9170853] ℹ️  DOB normalized: 09/25/1931
[22:35:58] [DOC: 9170853] ℹ️  Episode startOfCare normalized: 02/28/2025
[22:35:58] [DOC: 9170853] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[22:35:58] [DOC: 9170853] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[22:35:58] [DOC: 9170853] ✅ Patient date processing completed successfully
[22:35:58] ✅    ✅ Date processing completed
[22:35:58] 📊 Processed Patient Data
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'S32.040A', 'secondDiagnosis': 'S32.050A', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'I25.10'}]
[22:35:58] 🔄 
🔄 Step 4: Extracting order data...
[22:36:01] ℹ️  Order extraction - MRN: '6129015'
[22:36:01] ℹ️  Order extraction - Sex: 'MALE'
[22:36:01] ℹ️  Order extraction - Service Line: 'PT, OT'
[22:36:01] ℹ️  Order extraction - Payer Source: ''
[22:36:01] ✅ Order data extraction completed successfully
[22:36:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:36:01] ℹ️  Using MRN from patient data: '6129015' over '6129015'
[22:36:01] ℹ️  Service line consistent in both sources: 'PT, OT'
[22:36:01] ✅ Patient name cross-validation successful
[22:36:01] ✅    ✅ Data merged successfully
[22:36:02] ✅    ✅ Order data extracted and validated
[22:36:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:36:02] [DOC: 9170853] ✅ Patient found in local cache: Theodore Small, ID: 8c849805-1775-4653-aa7c-ce211697fc95
[22:36:02] ✅    ✅ Existing patient found with ID: 8c849805-1775-4653-aa7c-ce211697fc95
[22:36:02] 🔄 
🔄 Step 6: Pushing order to API...
[22:36:02] [DOC: 9170853] ℹ️  Pushing order via API for patient ID: 8c849805-1775-4653-aa7c-ce211697fc95
[22:36:03] [DOC: 9170853] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:36:03] ❌    ❌ Failed to push order
[22:36:03] 🔄 
🔄 Step 7: Writing to CSV...
[22:36:03] [DOC: 9170853] ℹ️  Calculated age: 93 from DOB: 09/25/1931
[22:36:03] [DOC: 9170853] ℹ️  Service Line extracted: 'PT, OT'
[22:36:03] [DOC: 9170853] ℹ️  Payer Source extracted: ''
[22:36:03] [DOC: 9170853] ℹ️  Diagnosis codes being written:
[22:36:03] [DOC: 9170853] ℹ️    - Latest_Episode_Firstdiagnosis: 'S32.040A'
[22:36:03] [DOC: 9170853] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.050A'
[22:36:03] [DOC: 9170853] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[22:36:03] [DOC: 9170853] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[22:36:03] [DOC: 9170853] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.31'
[22:36:03] [DOC: 9170853] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[22:36:03] [DOC: 9170853] ✅ Patient data written to CSV: Theodore Small | Sex: MALE | Age: 93 | Service: PT, OT | Payer:  | MRN: 6129015
[22:36:03] ✅    ✅ Document 9170853 processed and saved successfully
[22:36:03] 🔄 
🔄 Step 8: Saving API details...
[22:36:03] [DOC: 9170853] ℹ️  API push details saved for document 9170853
[22:36:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9170254                         ║
================================================================================
[22:36:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:36:03] ℹ️  Date: 03/07/2025
[22:36:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:36:06] [DOC: 9170254] ✅ Text extracted using pdfplumber (1632 chars)
[22:36:06] ✅    ✅ Text extracted using pdfplumber (1632 chars)
[22:36:06] 🔄 
🔄 Step 2: Extracting patient data...
[22:36:09] ℹ️  AI extracted raw sex value: ''
[22:36:09] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:36:09] ℹ️  AI extracted payer source: ''
[22:36:09] ℹ️  AI extracted diagnoses:
[22:36:09] ℹ️    - Diagnosis 1: 'J44.1'
[22:36:09] ℹ️    - Diagnosis 2: 'I10'
[22:36:09] ℹ️    - Diagnosis 3: 'E11.65'
[22:36:09] ℹ️    - Diagnosis 4: ''
[22:36:09] ℹ️    - Diagnosis 5: ''
[22:36:09] ℹ️    - Diagnosis 6: ''
[22:36:09] ℹ️  Final extracted MRN: '100990744'
[22:36:09] ℹ️  Final extracted Sex: ''
[22:36:09] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:36:09] ℹ️  Final extracted Payer Source: ''
[22:36:09] ✅ Patient data extraction completed successfully
[22:36:09] ✅    ✅ Patient data extracted successfully
[22:36:09] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:09] ✅    ✅ Patient identified: Barbara Grace
[22:36:09] ✅    ✅ Patient name validation passed
[22:36:09] 🔄 
🔄 Step 3: Processing patient dates...
[22:36:09] [DOC: 9170254] ℹ️  DOB normalized: 10/21/1948
[22:36:09] [DOC: 9170254] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[22:36:09] [DOC: 9170254] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[22:36:09] [DOC: 9170254] ✅ Patient date processing completed successfully
[22:36:09] ✅    ✅ Date processing completed
[22:36:09] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:09] 🔄 
🔄 Step 4: Extracting order data...
[22:36:11] ℹ️  Order extraction - MRN: '100990744'
[22:36:11] ℹ️  Order extraction - Sex: ''
[22:36:11] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:36:11] ℹ️  Order extraction - Payer Source: ''
[22:36:11] ✅ Order data extraction completed successfully
[22:36:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:36:11] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[22:36:11] ℹ️  Inferred sex as FEMALE from name: Barbara
[22:36:11] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:36:11] ✅ Patient name cross-validation successful
[22:36:11] ✅    ✅ Data merged successfully
[22:36:12] ✅    ✅ Order data extracted and validated
[22:36:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:36:12] [DOC: 9170254] ✅ Patient found in local cache: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[22:36:12] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[22:36:12] 🔄 
🔄 Step 6: Pushing order to API...
[22:36:12] [DOC: 9170254] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[22:36:14] [DOC: 9170254] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13822"}
[22:36:14] ❌    ❌ Failed to push order
[22:36:14] 🔄 
🔄 Step 7: Writing to CSV...
[22:36:14] [DOC: 9170254] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[22:36:14] [DOC: 9170254] ℹ️  Service Line extracted: 'Occupational Therapy'
[22:36:14] [DOC: 9170254] ℹ️  Payer Source extracted: ''
[22:36:14] [DOC: 9170254] ℹ️  Diagnosis codes being written:
[22:36:14] [DOC: 9170254] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[22:36:14] [DOC: 9170254] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[22:36:14] [DOC: 9170254] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[22:36:14] [DOC: 9170254] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:36:14] [DOC: 9170254] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:36:14] [DOC: 9170254] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:36:14] [DOC: 9170254] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: 100990744
[22:36:14] ✅    ✅ Document 9170254 processed and saved successfully
[22:36:14] 🔄 
🔄 Step 8: Saving API details...
[22:36:14] [DOC: 9170254] ℹ️  API push details saved for document 9170254
[22:36:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9170015                         ║
================================================================================
[22:36:14] ℹ️  Agency: Alphacare Home Health Agency
[22:36:14] ℹ️  Date: 03/07/2025
[22:36:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:36:16] [DOC: 9170015] ✅ Text extracted using pdfplumber (1653 chars)
[22:36:16] ✅    ✅ Text extracted using pdfplumber (1653 chars)
[22:36:16] 🔄 
🔄 Step 2: Extracting patient data...
[22:36:19] ℹ️  AI extracted raw sex value: ''
[22:36:19] ℹ️  AI extracted service line: 'LPN'
[22:36:19] ℹ️  AI extracted payer source: ''
[22:36:19] ℹ️  AI extracted diagnoses:
[22:36:19] ℹ️    - Diagnosis 1: ''
[22:36:19] ℹ️    - Diagnosis 2: ''
[22:36:19] ℹ️    - Diagnosis 3: ''
[22:36:19] ℹ️    - Diagnosis 4: ''
[22:36:19] ℹ️    - Diagnosis 5: ''
[22:36:19] ℹ️    - Diagnosis 6: ''
[22:36:19] ℹ️  Final extracted MRN: '000000331'
[22:36:19] ℹ️  Final extracted Sex: ''
[22:36:19] ℹ️  Final extracted Service Line: 'LPN'
[22:36:19] ℹ️  Final extracted Payer Source: ''
[22:36:19] ✅ Patient data extraction completed successfully
[22:36:19] ✅    ✅ Patient data extracted successfully
[22:36:19] 📊 Patient Response
     └─ patientFName: Cynthia
     └─ patientLName: Stone
     └─ dob: 05/06/1957
     └─ patientSex: 
     └─ medicalRecordNo: 000000331
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:19] ✅    ✅ Patient identified: Cynthia Stone
[22:36:19] ✅    ✅ Patient name validation passed
[22:36:19] 🔄 
🔄 Step 3: Processing patient dates...
[22:36:19] [DOC: 9170015] ℹ️  DOB normalized: 05/06/1957
[22:36:19] [DOC: 9170015] ✅ Patient date processing completed successfully
[22:36:19] ✅    ✅ Date processing completed
[22:36:19] 📊 Processed Patient Data
     └─ patientFName: Cynthia
     └─ patientLName: Stone
     └─ dob: 05/06/1957
     └─ patientSex: 
     └─ medicalRecordNo: 000000331
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:19] 🔄 
🔄 Step 4: Extracting order data...
[22:36:21] ℹ️  Order extraction - MRN: '000000331'
[22:36:21] ℹ️  Order extraction - Sex: ''
[22:36:21] ℹ️  Order extraction - Service Line: 'LPN'
[22:36:21] ℹ️  Order extraction - Payer Source: ''
[22:36:21] ✅ Order data extraction completed successfully
[22:36:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:36:21] ℹ️  Using MRN from patient data: '000000331' over '000000331'
[22:36:21] ℹ️  Inferred sex as FEMALE from name: Cynthia
[22:36:21] ℹ️  Service line consistent in both sources: 'LPN'
[22:36:21] ✅ Patient name cross-validation successful
[22:36:21] ✅    ✅ Data merged successfully
[22:36:22] ⚠️     ❌ Skipping - missing episode start date
[22:36:22] [DOC: 9170015] ℹ️  API push details saved for document 9170015
================================================================================
║                        Processing Document ID: 9170001                         ║
================================================================================
[22:36:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:36:22] ℹ️  Date: 03/07/2025
[22:36:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:36:24] [DOC: 9170001] ✅ Text extracted using pdfplumber (1578 chars)
[22:36:24] ✅    ✅ Text extracted using pdfplumber (1578 chars)
[22:36:24] 🔄 
🔄 Step 2: Extracting patient data...
[22:36:27] ℹ️  AI extracted raw sex value: ''
[22:36:27] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:36:27] ℹ️  AI extracted payer source: ''
[22:36:27] ℹ️  AI extracted diagnoses:
[22:36:27] ℹ️    - Diagnosis 1: 'N30.00'
[22:36:27] ℹ️    - Diagnosis 2: 'B96.1'
[22:36:27] ℹ️    - Diagnosis 3: 'N28.9'
[22:36:27] ℹ️    - Diagnosis 4: ''
[22:36:27] ℹ️    - Diagnosis 5: ''
[22:36:27] ℹ️    - Diagnosis 6: ''
[22:36:27] ℹ️  Final extracted MRN: 'MA200828043902'
[22:36:27] ℹ️  Final extracted Sex: ''
[22:36:27] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:36:27] ℹ️  Final extracted Payer Source: ''
[22:36:27] ✅ Patient data extraction completed successfully
[22:36:27] ✅    ✅ Patient data extracted successfully
[22:36:27] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Marden
     └─ dob: 04/22/1939
     └─ patientSex: 
     └─ medicalRecordNo: MA200828043902
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '09/15/2023', 'endOfEpisode': '11/13/2023', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'B96.1', 'thirdDiagnosis': 'N28.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:27] ✅    ✅ Patient identified: Richard Marden
[22:36:27] ✅    ✅ Patient name validation passed
[22:36:27] 🔄 
🔄 Step 3: Processing patient dates...
[22:36:27] [DOC: 9170001] ℹ️  DOB normalized: 04/22/1939
[22:36:27] [DOC: 9170001] ℹ️  Episode startOfEpisode normalized: 09/15/2023
[22:36:27] [DOC: 9170001] ℹ️  Episode endOfEpisode normalized: 11/13/2023
[22:36:27] [DOC: 9170001] ✅ Patient date processing completed successfully
[22:36:27] ✅    ✅ Date processing completed
[22:36:27] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Marden
     └─ dob: 04/22/1939
     └─ patientSex: 
     └─ medicalRecordNo: MA200828043902
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/15/2023', 'endOfEpisode': '11/13/2023', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'B96.1', 'thirdDiagnosis': 'N28.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:27] 🔄 
🔄 Step 4: Extracting order data...
[22:36:30] ℹ️  Order extraction - MRN: 'MA200828043902'
[22:36:30] ℹ️  Order extraction - Sex: ''
[22:36:30] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:36:30] ℹ️  Order extraction - Payer Source: ''
[22:36:30] ✅ Order data extraction completed successfully
[22:36:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:36:30] ℹ️  Using MRN from patient data: 'MA200828043902' over 'MA200828043902'
[22:36:30] ℹ️  Inferred sex as MALE from name: Richard
[22:36:30] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:36:30] ✅ Patient name cross-validation successful
[22:36:30] ✅    ✅ Data merged successfully
[22:36:31] ✅    ✅ Order data extracted and validated
[22:36:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:36:43] [DOC: 9170001] ℹ️  Patient not found in cache or API: Richard Marden
[22:36:43] [DOC: 9170001] ℹ️  Patient not found, creating new patient via API...
[22:36:43] [DOC: 9170001] ℹ️  Creating patient via API: Richard Marden
[22:36:45] [DOC: 9170001] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:36:45] ❌    ❌ Failed to create patient
[22:36:45] [DOC: 9170001] ℹ️  API push details saved for document 9170001
================================================================================
║                        Processing Document ID: 9169750                         ║
================================================================================
[22:36:45] ℹ️  Agency: Nizhoni Health-Fall River
[22:36:45] ℹ️  Date: 03/07/2025
[22:36:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:36:48] [DOC: 9169750] ✅ Text extracted using pdfplumber (1815 chars)
[22:36:48] ✅    ✅ Text extracted using pdfplumber (1815 chars)
[22:36:48] 🔄 
🔄 Step 2: Extracting patient data...
[22:36:51] ℹ️  AI extracted raw sex value: 'M'
[22:36:51] ℹ️  AI extracted service line: 'HHA'
[22:36:51] ℹ️  AI extracted payer source: 'Medicaid/MA'
[22:36:51] ℹ️  AI extracted diagnoses:
[22:36:51] ℹ️    - Diagnosis 1: ''
[22:36:51] ℹ️    - Diagnosis 2: ''
[22:36:51] ℹ️    - Diagnosis 3: ''
[22:36:51] ℹ️    - Diagnosis 4: ''
[22:36:51] ℹ️    - Diagnosis 5: ''
[22:36:51] ℹ️    - Diagnosis 6: ''
[22:36:51] ℹ️  Final extracted MRN: '15538'
[22:36:51] ℹ️  Final extracted Sex: 'MALE'
[22:36:51] ℹ️  Final extracted Service Line: 'HHA'
[22:36:51] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[22:36:51] ✅ Patient data extraction completed successfully
[22:36:51] ✅    ✅ Patient data extracted successfully
[22:36:51] 📊 Patient Response
     └─ patientFName: Darryl
     └─ patientLName: Brooks
     └─ dob: 09/12/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 15538
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2014', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:51] ✅    ✅ Patient identified: Darryl Brooks
[22:36:51] ✅    ✅ Patient name validation passed
[22:36:51] 🔄 
🔄 Step 3: Processing patient dates...
[22:36:51] [DOC: 9169750] ℹ️  DOB normalized: 09/12/1978
[22:36:51] [DOC: 9169750] ℹ️  Episode startOfCare normalized: 09/04/2014
[22:36:51] [DOC: 9169750] ℹ️  Episode startOfEpisode normalized: 01/09/2025
[22:36:51] [DOC: 9169750] ℹ️  Episode endOfEpisode normalized: 03/09/2025
[22:36:51] [DOC: 9169750] ✅ Patient date processing completed successfully
[22:36:51] ✅    ✅ Date processing completed
[22:36:51] 📊 Processed Patient Data
     └─ patientFName: Darryl
     └─ patientLName: Brooks
     └─ dob: 09/12/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 15538
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2014', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:36:51] 🔄 
🔄 Step 4: Extracting order data...
[22:36:53] ℹ️  Order extraction - MRN: '15538'
[22:36:53] ℹ️  Order extraction - Sex: 'MALE'
[22:36:53] ℹ️  Order extraction - Service Line: ''
[22:36:53] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[22:36:53] ✅ Order data extraction completed successfully
[22:36:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:36:53] ℹ️  Using MRN from patient data: '15538' over '15538'
[22:36:53] ℹ️  Using service line from patient data: 'HHA'
[22:36:53] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[22:36:53] ✅ Patient name cross-validation successful
[22:36:53] ✅    ✅ Data merged successfully
[22:36:55] ✅    ✅ Order data extracted and validated
[22:36:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:36:55] [DOC: 9169750] ✅ Patient found in local cache: Darryl Brooks, ID: d50c5701-e6e1-4a5d-aec6-2bc64ed0d496
[22:36:55] ✅    ✅ Existing patient found with ID: d50c5701-e6e1-4a5d-aec6-2bc64ed0d496
[22:36:55] 🔄 
🔄 Step 6: Pushing order to API...
[22:36:55] [DOC: 9169750] ℹ️  Pushing order via API for patient ID: d50c5701-e6e1-4a5d-aec6-2bc64ed0d496
[22:36:56] [DOC: 9169750] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:36:56] ❌    ❌ Failed to push order
[22:36:56] 🔄 
🔄 Step 7: Writing to CSV...
[22:36:56] [DOC: 9169750] ℹ️  Calculated age: 46 from DOB: 09/12/1978
[22:36:56] [DOC: 9169750] ℹ️  Service Line extracted: 'HHA'
[22:36:56] [DOC: 9169750] ℹ️  Payer Source extracted: 'Medicaid/MA'
[22:36:56] [DOC: 9169750] ℹ️  Diagnosis codes being written:
[22:36:56] [DOC: 9169750] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:36:56] [DOC: 9169750] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:36:56] [DOC: 9169750] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:36:56] [DOC: 9169750] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:36:56] [DOC: 9169750] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:36:56] [DOC: 9169750] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:36:56] [DOC: 9169750] ✅ Patient data written to CSV: Darryl Brooks | Sex: MALE | Age: 46 | Service: HHA | Payer: Medicaid/MA | MRN: 15538
[22:36:56] ✅    ✅ Document 9169750 processed and saved successfully
[22:36:56] 🔄 
🔄 Step 8: Saving API details...
[22:36:56] [DOC: 9169750] ℹ️  API push details saved for document 9169750
[22:36:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9169591                         ║
================================================================================
[22:36:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:36:56] ℹ️  Date: 03/07/2025
[22:36:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:36:58] [DOC: 9169591] ✅ Text extracted using pdfplumber (1500 chars)
[22:36:58] ✅    ✅ Text extracted using pdfplumber (1488 chars)
[22:36:58] 🔄 
🔄 Step 2: Extracting patient data...
[22:37:01] ℹ️  AI extracted raw sex value: ''
[22:37:01] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:37:01] ℹ️  AI extracted payer source: ''
[22:37:01] ℹ️  AI extracted diagnoses:
[22:37:01] ℹ️    - Diagnosis 1: 'G20.A1'
[22:37:01] ℹ️    - Diagnosis 2: 'E04.9'
[22:37:01] ℹ️    - Diagnosis 3: 'G60.9'
[22:37:01] ℹ️    - Diagnosis 4: ''
[22:37:01] ℹ️    - Diagnosis 5: ''
[22:37:01] ℹ️    - Diagnosis 6: ''
[22:37:01] ℹ️  Final extracted MRN: 'MA250220064201'
[22:37:01] ℹ️  Final extracted Sex: ''
[22:37:01] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:37:01] ℹ️  Final extracted Payer Source: ''
[22:37:01] ✅ Patient data extraction completed successfully
[22:37:01] ✅    ✅ Patient data extracted successfully
[22:37:01] 📊 Patient Response
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'E04.9', 'thirdDiagnosis': 'G60.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:37:01] ✅    ✅ Patient identified: Lucy Francis
[22:37:01] ✅    ✅ Patient name validation passed
[22:37:01] 🔄 
🔄 Step 3: Processing patient dates...
[22:37:01] [DOC: 9169591] ℹ️  DOB normalized: 06/12/1942
[22:37:01] [DOC: 9169591] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[22:37:01] [DOC: 9169591] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[22:37:01] [DOC: 9169591] ✅ Patient date processing completed successfully
[22:37:01] ✅    ✅ Date processing completed
[22:37:01] 📊 Processed Patient Data
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'E04.9', 'thirdDiagnosis': 'G60.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:37:01] 🔄 
🔄 Step 4: Extracting order data...
[22:37:04] ℹ️  Order extraction - MRN: 'MA250220064201'
[22:37:04] ℹ️  Order extraction - Sex: ''
[22:37:04] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:37:04] ℹ️  Order extraction - Payer Source: ''
[22:37:04] ✅ Order data extraction completed successfully
[22:37:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:37:04] ℹ️  Using MRN from patient data: 'MA250220064201' over 'MA250220064201'
[22:37:04] ⚠️  Could not determine sex using any available method
[22:37:04] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:37:04] ✅ Patient name cross-validation successful
[22:37:04] ✅    ✅ Data merged successfully
[22:37:05] ✅    ✅ Order data extracted and validated
[22:37:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:37:05] [DOC: 9169591] ✅ Patient found in local cache: Lucy Francis, ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[22:37:05] ✅    ✅ Existing patient found with ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[22:37:05] 🔄 
🔄 Step 6: Pushing order to API...
[22:37:05] [DOC: 9169591] ℹ️  Pushing order via API for patient ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[22:37:06] [DOC: 9169591] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14072"}
[22:37:06] ❌    ❌ Failed to push order
[22:37:06] 🔄 
🔄 Step 7: Writing to CSV...
[22:37:06] [DOC: 9169591] ℹ️  Calculated age: 82 from DOB: 06/12/1942
[22:37:06] [DOC: 9169591] ℹ️  Service Line extracted: 'Occupational Therapy'
[22:37:06] [DOC: 9169591] ℹ️  Payer Source extracted: ''
[22:37:06] [DOC: 9169591] ℹ️  Diagnosis codes being written:
[22:37:06] [DOC: 9169591] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[22:37:06] [DOC: 9169591] ℹ️    - Latest_Episode_Seconddiagnosis: 'E04.9'
[22:37:06] [DOC: 9169591] ℹ️    - Latest_Episode_Thirddiagnosis: 'G60.9'
[22:37:06] [DOC: 9169591] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:37:06] [DOC: 9169591] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:37:06] [DOC: 9169591] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:37:06] [DOC: 9169591] ✅ Patient data written to CSV: Lucy Francis | Sex:  | Age: 82 | Service: Occupational Therapy | Payer:  | MRN: MA250220064201
[22:37:06] ✅    ✅ Document 9169591 processed and saved successfully
[22:37:06] 🔄 
🔄 Step 8: Saving API details...
[22:37:06] [DOC: 9169591] ℹ️  API push details saved for document 9169591
[22:37:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9169588                         ║
================================================================================
[22:37:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:37:06] ℹ️  Date: 03/07/2025
[22:37:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:37:09] [DOC: 9169588] ✅ Text extracted using pdfplumber (3619 chars)
[22:37:09] ✅    ✅ Text extracted using pdfplumber (3607 chars)
[22:37:09] 🔄 
🔄 Step 2: Extracting patient data...
[22:37:12] ℹ️  AI extracted raw sex value: 'F'
[22:37:12] ℹ️  AI extracted service line: 'PT, OT'
[22:37:12] ℹ️  AI extracted payer source: ''
[22:37:12] ℹ️  AI extracted diagnoses:
[22:37:12] ℹ️    - Diagnosis 1: 'G20.A1'
[22:37:12] ℹ️    - Diagnosis 2: 'E04.9'
[22:37:12] ℹ️    - Diagnosis 3: 'G60.9'
[22:37:12] ℹ️    - Diagnosis 4: 'None'
[22:37:12] ℹ️    - Diagnosis 5: 'None'
[22:37:12] ℹ️    - Diagnosis 6: 'None'
[22:37:12] ℹ️  Final extracted MRN: 'MA250220064201'
[22:37:12] ℹ️  Final extracted Sex: 'FEMALE'
[22:37:12] ℹ️  Final extracted Service Line: 'PT, OT'
[22:37:12] ℹ️  Final extracted Payer Source: ''
[22:37:12] ✅ Patient data extraction completed successfully
[22:37:12] ✅    ✅ Patient data extracted successfully
[22:37:12] 📊 Patient Response
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'E04.9', 'thirdDiagnosis': 'G60.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:37:12] ✅    ✅ Patient identified: Lucy Francis
[22:37:12] ✅    ✅ Patient name validation passed
[22:37:12] 🔄 
🔄 Step 3: Processing patient dates...
[22:37:12] [DOC: 9169588] ℹ️  DOB normalized: 06/12/1942
[22:37:12] [DOC: 9169588] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[22:37:12] [DOC: 9169588] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[22:37:12] [DOC: 9169588] ✅ Patient date processing completed successfully
[22:37:12] ✅    ✅ Date processing completed
[22:37:12] 📊 Processed Patient Data
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'E04.9', 'thirdDiagnosis': 'G60.9'}]
[22:37:12] 🔄 
🔄 Step 4: Extracting order data...
[22:37:14] ℹ️  Order extraction - MRN: 'MA250220064201'
[22:37:14] ℹ️  Order extraction - Sex: 'FEMALE'
[22:37:14] ℹ️  Order extraction - Service Line: 'PT, OT'
[22:37:14] ℹ️  Order extraction - Payer Source: ''
[22:37:14] ✅ Order data extraction completed successfully
[22:37:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:37:14] ℹ️  Using MRN from patient data: 'MA250220064201' over 'MA250220064201'
[22:37:14] ℹ️  Service line consistent in both sources: 'PT, OT'
[22:37:14] ✅ Patient name cross-validation successful
[22:37:14] ✅    ✅ Data merged successfully
[22:37:15] ✅    ✅ Order data extracted and validated
[22:37:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:37:15] [DOC: 9169588] ✅ Patient found in local cache: Lucy Francis, ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[22:37:15] ✅    ✅ Existing patient found with ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[22:37:15] 🔄 
🔄 Step 6: Pushing order to API...
[22:37:15] [DOC: 9169588] ℹ️  Pushing order via API for patient ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[22:37:17] [DOC: 9169588] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14073"}
[22:37:17] ❌    ❌ Failed to push order
[22:37:17] 🔄 
🔄 Step 7: Writing to CSV...
[22:37:17] [DOC: 9169588] ℹ️  Calculated age: 82 from DOB: 06/12/1942
[22:37:17] [DOC: 9169588] ℹ️  Service Line extracted: 'PT, OT'
[22:37:17] [DOC: 9169588] ℹ️  Payer Source extracted: ''
[22:37:17] [DOC: 9169588] ℹ️  Diagnosis codes being written:
[22:37:17] [DOC: 9169588] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[22:37:17] [DOC: 9169588] ℹ️    - Latest_Episode_Seconddiagnosis: 'E04.9'
[22:37:17] [DOC: 9169588] ℹ️    - Latest_Episode_Thirddiagnosis: 'G60.9'
[22:37:17] [DOC: 9169588] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:37:17] [DOC: 9169588] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:37:17] [DOC: 9169588] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:37:17] [DOC: 9169588] ✅ Patient data written to CSV: Lucy Francis | Sex: FEMALE | Age: 82 | Service: PT, OT | Payer:  | MRN: MA250220064201
[22:37:17] ✅    ✅ Document 9169588 processed and saved successfully
[22:37:17] 🔄 
🔄 Step 8: Saving API details...
[22:37:17] [DOC: 9169588] ℹ️  API push details saved for document 9169588
[22:37:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9169049                         ║
================================================================================
[22:37:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:37:17] ℹ️  Date: 03/07/2025
[22:37:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:37:19] [DOC: 9169049] ✅ Text extracted using pdfplumber (13352 chars)
[22:37:19] ✅    ✅ Text extracted using pdfplumber (13352 chars)
[22:37:19] 🔄 
🔄 Step 2: Extracting patient data...
[22:37:23] ℹ️  AI extracted raw sex value: 'F'
[22:37:23] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:37:23] ℹ️  AI extracted payer source: 'None'
[22:37:23] ℹ️  AI extracted diagnoses:
[22:37:23] ℹ️    - Diagnosis 1: 'K5289'
[22:37:23] ℹ️    - Diagnosis 2: 'E119'
[22:37:23] ℹ️    - Diagnosis 3: 'None'
[22:37:23] ℹ️    - Diagnosis 4: 'None'
[22:37:23] ℹ️    - Diagnosis 5: 'None'
[22:37:23] ℹ️    - Diagnosis 6: 'None'
[22:37:23] ℹ️  Final extracted MRN: 'MA200827105106'
[22:37:23] ℹ️  Final extracted Sex: 'FEMALE'
[22:37:23] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:37:23] ℹ️  Final extracted Payer Source: ''
[22:37:23] ✅ Patient data extraction completed successfully
[22:37:23] ✅    ✅ Patient data extracted successfully
[22:37:23] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Correia
     └─ dob: 10/15/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA200827105106
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': 'K5289', 'secondDiagnosis': 'E119', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:37:23] ✅    ✅ Patient identified: Maria Correia
[22:37:23] ✅    ✅ Patient name validation passed
[22:37:23] 🔄 
🔄 Step 3: Processing patient dates...
[22:37:23] [DOC: 9169049] ℹ️  DOB normalized: 10/15/1951
[22:37:23] [DOC: 9169049] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[22:37:23] [DOC: 9169049] ℹ️  Episode endOfEpisode normalized: 03/31/2025
[22:37:23] [DOC: 9169049] ✅ Patient date processing completed successfully
[22:37:23] ✅    ✅ Date processing completed
[22:37:23] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Correia
     └─ dob: 10/15/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA200827105106
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': 'K5289', 'secondDiagnosis': 'E119'}]
[22:37:23] 🔄 
🔄 Step 4: Extracting order data...
[22:37:25] ℹ️  Order extraction - MRN: 'MA200827105106'
[22:37:25] ℹ️  Order extraction - Sex: 'FEMALE'
[22:37:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:37:25] ℹ️  Order extraction - Payer Source: ''
[22:37:25] ✅ Order data extraction completed successfully
[22:37:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:37:25] ℹ️  Using MRN from patient data: 'MA200827105106' over 'MA200827105106'
[22:37:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:37:25] ✅ Patient name cross-validation successful
[22:37:25] ✅    ✅ Data merged successfully
[22:37:26] ✅    ✅ Order data extracted and validated
[22:37:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:37:33] [DOC: 9169049] ✅ Patient exists in API: Maria Correia, ID: 090574e4-9555-4e8f-bbbc-347e7acc5ca5
[22:37:33] ✅    ✅ Existing patient found with ID: 090574e4-9555-4e8f-bbbc-347e7acc5ca5
[22:37:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:37:33] [DOC: 9169049] ℹ️  Pushing order via API for patient ID: 090574e4-9555-4e8f-bbbc-347e7acc5ca5
[22:37:34] [DOC: 9169049] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12863"}
[22:37:34] ❌    ❌ Failed to push order
[22:37:34] 🔄 
🔄 Step 7: Writing to CSV...
[22:37:34] [DOC: 9169049] ℹ️  Calculated age: 73 from DOB: 10/15/1951
[22:37:34] [DOC: 9169049] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:37:34] [DOC: 9169049] ℹ️  Payer Source extracted: ''
[22:37:34] [DOC: 9169049] ℹ️  Diagnosis codes being written:
[22:37:34] [DOC: 9169049] ℹ️    - Latest_Episode_Firstdiagnosis: 'K5289'
[22:37:34] [DOC: 9169049] ℹ️    - Latest_Episode_Seconddiagnosis: 'E119'
[22:37:34] [DOC: 9169049] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:37:34] [DOC: 9169049] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:37:34] [DOC: 9169049] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:37:34] [DOC: 9169049] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:37:34] [DOC: 9169049] ✅ Patient data written to CSV: Maria Correia | Sex: FEMALE | Age: 73 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA200827105106
[22:37:34] ✅    ✅ Document 9169049 processed and saved successfully
[22:37:34] 🔄 
🔄 Step 8: Saving API details...
[22:37:34] [DOC: 9169049] ℹ️  API push details saved for document 9169049
[22:37:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9169006                         ║
================================================================================
[22:37:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:37:34] ℹ️  Date: 03/07/2025
[22:37:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:37:37] [DOC: 9169006] ✅ Text extracted using pdfplumber (11760 chars)
[22:37:37] ✅    ✅ Text extracted using pdfplumber (11760 chars)
[22:37:37] 🔄 
🔄 Step 2: Extracting patient data...
[22:37:40] ℹ️  AI extracted raw sex value: 'F'
[22:37:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:37:40] ℹ️  AI extracted payer source: 'Medicare'
[22:37:40] ℹ️  AI extracted diagnoses:
[22:37:40] ℹ️    - Diagnosis 1: 'J44.9'
[22:37:40] ℹ️    - Diagnosis 2: 'S42.402'
[22:37:40] ℹ️    - Diagnosis 3: 'M19.90'
[22:37:40] ℹ️    - Diagnosis 4: 'F32.9'
[22:37:40] ℹ️    - Diagnosis 5: 'F41.9'
[22:37:40] ℹ️    - Diagnosis 6: 'G89.4'
[22:37:40] ℹ️  Final extracted MRN: '100999305'
[22:37:40] ℹ️  Final extracted Sex: 'FEMALE'
[22:37:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:37:40] ℹ️  Final extracted Payer Source: 'Medicare'
[22:37:40] ✅ Patient data extraction completed successfully
[22:37:40] ✅    ✅ Patient data extracted successfully
[22:37:40] 📊 Patient Response
     └─ patientFName: Phyllis
     └─ patientLName: Monteiro
     └─ dob: 01/07/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100999305
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 904-3912
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2023', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'S42.402', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'F32.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'G89.4'}]
[22:37:40] ✅    ✅ Patient identified: Phyllis Monteiro
[22:37:40] ✅    ✅ Patient name validation passed
[22:37:40] 🔄 
🔄 Step 3: Processing patient dates...
[22:37:40] [DOC: 9169006] ℹ️  DOB normalized: 01/07/1951
[22:37:40] [DOC: 9169006] ℹ️  Episode startOfCare normalized: 02/26/2023
[22:37:40] [DOC: 9169006] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[22:37:40] [DOC: 9169006] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[22:37:40] [DOC: 9169006] ✅ Patient date processing completed successfully
[22:37:40] ✅    ✅ Date processing completed
[22:37:40] 📊 Processed Patient Data
     └─ patientFName: Phyllis
     └─ patientLName: Monteiro
     └─ dob: 01/07/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100999305
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 904-3912
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2023', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'S42.402', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'F32.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'G89.4'}]
[22:37:40] 🔄 
🔄 Step 4: Extracting order data...
[22:37:43] ℹ️  Order extraction - MRN: '100999305'
[22:37:43] ℹ️  Order extraction - Sex: 'FEMALE'
[22:37:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:37:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:37:43] ✅ Order data extraction completed successfully
[22:37:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:37:43] ℹ️  Using MRN from patient data: '100999305' over '100999305'
[22:37:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:37:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:37:43] ✅ Patient name cross-validation successful
[22:37:43] ✅    ✅ Data merged successfully
[22:37:44] ✅    ✅ Order data extracted and validated
[22:37:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:37:44] [DOC: 9169006] ✅ Patient found in local cache: Phyllis Monteiro, ID: 1e3fa9e7-2fe2-4bdf-8848-72aa7b1811ea
[22:37:44] ✅    ✅ Existing patient found with ID: 1e3fa9e7-2fe2-4bdf-8848-72aa7b1811ea
[22:37:44] 🔄 
🔄 Step 6: Pushing order to API...
[22:37:44] [DOC: 9169006] ℹ️  Pushing order via API for patient ID: 1e3fa9e7-2fe2-4bdf-8848-72aa7b1811ea
[22:37:46] [DOC: 9169006] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14141"}
[22:37:46] ❌    ❌ Failed to push order
[22:37:46] 🔄 
🔄 Step 7: Writing to CSV...
[22:37:46] [DOC: 9169006] ℹ️  Calculated age: 74 from DOB: 01/07/1951
[22:37:46] [DOC: 9169006] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:37:46] [DOC: 9169006] ℹ️  Payer Source extracted: 'Medicare'
[22:37:46] [DOC: 9169006] ℹ️  Diagnosis codes being written:
[22:37:46] [DOC: 9169006] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[22:37:46] [DOC: 9169006] ℹ️    - Latest_Episode_Seconddiagnosis: 'S42.402'
[22:37:46] [DOC: 9169006] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.90'
[22:37:46] [DOC: 9169006] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F32.9'
[22:37:46] [DOC: 9169006] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[22:37:46] [DOC: 9169006] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G89.4'
[22:37:46] [DOC: 9169006] ✅ Patient data written to CSV: Phyllis Monteiro | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 100999305
[22:37:46] ✅    ✅ Document 9169006 processed and saved successfully
[22:37:46] 🔄 
🔄 Step 8: Saving API details...
[22:37:46] [DOC: 9169006] ℹ️  API push details saved for document 9169006
[22:37:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168635                         ║
================================================================================
[22:37:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:37:46] ℹ️  Date: 03/07/2025
[22:37:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:37:47] [DOC: 9168635] ✅ Text extracted using pdfplumber (1114 chars)
[22:37:47] ✅    ✅ Text extracted using pdfplumber (1114 chars)
[22:37:47] 🔄 
🔄 Step 2: Extracting patient data...
[22:37:50] ℹ️  AI extracted raw sex value: 'F'
[22:37:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:37:50] ℹ️  AI extracted payer source: ''
[22:37:50] ℹ️  AI extracted diagnoses:
[22:37:50] ℹ️    - Diagnosis 1: ''
[22:37:50] ℹ️    - Diagnosis 2: ''
[22:37:50] ℹ️    - Diagnosis 3: ''
[22:37:50] ℹ️    - Diagnosis 4: ''
[22:37:50] ℹ️    - Diagnosis 5: ''
[22:37:50] ℹ️    - Diagnosis 6: ''
[22:37:50] ℹ️  Final extracted MRN: '2936720'
[22:37:50] ℹ️  Final extracted Sex: 'FEMALE'
[22:37:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:37:50] ℹ️  Final extracted Payer Source: ''
[22:37:50] ✅ Patient data extraction completed successfully
[22:37:50] ✅    ✅ Patient data extracted successfully
[22:37:50] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:37:50] ✅    ✅ Patient identified: Stella Saint
[22:37:50] ✅    ✅ Patient name validation passed
[22:37:50] 🔄 
🔄 Step 3: Processing patient dates...
[22:37:50] [DOC: 9168635] ℹ️  DOB normalized: 07/02/1928
[22:37:50] [DOC: 9168635] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[22:37:50] [DOC: 9168635] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[22:37:50] [DOC: 9168635] ✅ Patient date processing completed successfully
[22:37:50] ✅    ✅ Date processing completed
[22:37:50] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:37:50] 🔄 
🔄 Step 4: Extracting order data...
[22:37:52] ℹ️  Order extraction - MRN: '2936720'
[22:37:52] ℹ️  Order extraction - Sex: 'FEMALE'
[22:37:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:37:52] ℹ️  Order extraction - Payer Source: ''
[22:37:52] ✅ Order data extraction completed successfully
[22:37:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:37:52] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[22:37:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:37:52] ✅ Patient name cross-validation successful
[22:37:52] ✅    ✅ Data merged successfully
[22:37:53] ✅    ✅ Order data extracted and validated
[22:37:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:37:53] [DOC: 9168635] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[22:37:53] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[22:37:53] 🔄 
🔄 Step 6: Pushing order to API...
[22:37:53] [DOC: 9168635] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[22:37:55] [DOC: 9168635] ❌ Order push failed with status 201: {"id":"344bd12a-6d7d-4dca-98f7-93437859d8e7","orderWAVId":"ORD20086","orderNo":"1068821","orderDate":"03/06/2025","startOfCare":"02/23/2025","episodeStartDate":"02/23/2025","episodeEndDate":"04/23/2025","documentID":"9168635","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"03/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/19/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[22:37:55] ❌    ❌ Failed to push order
[22:37:55] 🔄 
🔄 Step 7: Writing to CSV...
[22:37:55] [DOC: 9168635] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[22:37:55] [DOC: 9168635] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:37:55] [DOC: 9168635] ℹ️  Payer Source extracted: ''
[22:37:55] [DOC: 9168635] ℹ️  Diagnosis codes being written:
[22:37:55] [DOC: 9168635] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:37:55] [DOC: 9168635] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:37:55] [DOC: 9168635] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:37:55] [DOC: 9168635] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:37:55] [DOC: 9168635] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:37:55] [DOC: 9168635] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:37:55] [DOC: 9168635] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Skilled Nursing | Payer:  | MRN: 2936720
[22:37:55] ✅    ✅ Document 9168635 processed and saved successfully
[22:37:55] 🔄 
🔄 Step 8: Saving API details...
[22:37:55] [DOC: 9168635] ℹ️  API push details saved for document 9168635
[22:37:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168611                         ║
================================================================================
[22:37:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:37:55] ℹ️  Date: 03/07/2025
[22:37:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:37:57] [DOC: 9168611] ✅ Text extracted using pdfplumber (1006 chars)
[22:37:57] ✅    ✅ Text extracted using pdfplumber (1006 chars)
[22:37:57] 🔄 
🔄 Step 2: Extracting patient data...
[22:37:59] ℹ️  AI extracted raw sex value: 'F'
[22:37:59] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:37:59] ℹ️  AI extracted payer source: ''
[22:37:59] ℹ️  AI extracted diagnoses:
[22:37:59] ℹ️    - Diagnosis 1: ''
[22:37:59] ℹ️    - Diagnosis 2: ''
[22:37:59] ℹ️    - Diagnosis 3: ''
[22:37:59] ℹ️    - Diagnosis 4: ''
[22:37:59] ℹ️    - Diagnosis 5: ''
[22:37:59] ℹ️    - Diagnosis 6: ''
[22:37:59] ℹ️  Final extracted MRN: '2848942'
[22:37:59] ℹ️  Final extracted Sex: 'FEMALE'
[22:37:59] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:37:59] ℹ️  Final extracted Payer Source: ''
[22:37:59] ✅ Patient data extraction completed successfully
[22:37:59] ✅    ✅ Patient data extracted successfully
[22:37:59] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Phaneuf
     └─ dob: 10/04/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2848942
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:37:59] ✅    ✅ Patient identified: Jean Phaneuf
[22:37:59] ✅    ✅ Patient name validation passed
[22:37:59] 🔄 
🔄 Step 3: Processing patient dates...
[22:37:59] [DOC: 9168611] ℹ️  DOB normalized: 10/04/1956
[22:37:59] [DOC: 9168611] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[22:37:59] [DOC: 9168611] ℹ️  Episode endOfEpisode normalized: 04/05/2025
[22:37:59] [DOC: 9168611] ✅ Patient date processing completed successfully
[22:37:59] ✅    ✅ Date processing completed
[22:37:59] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Phaneuf
     └─ dob: 10/04/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2848942
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:37:59] 🔄 
🔄 Step 4: Extracting order data...
[22:38:02] ℹ️  Order extraction - MRN: '2848942'
[22:38:02] ℹ️  Order extraction - Sex: 'FEMALE'
[22:38:02] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:38:02] ℹ️  Order extraction - Payer Source: ''
[22:38:02] ✅ Order data extraction completed successfully
[22:38:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:38:02] ℹ️  Using MRN from patient data: '2848942' over '2848942'
[22:38:02] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:38:02] ✅ Patient name cross-validation successful
[22:38:02] ✅    ✅ Data merged successfully
[22:38:03] ✅    ✅ Order data extracted and validated
[22:38:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:38:12] [DOC: 9168611] ℹ️  Patient not found in cache or API: Jean Phaneuf
[22:38:12] [DOC: 9168611] ℹ️  Patient not found, creating new patient via API...
[22:38:12] [DOC: 9168611] ℹ️  Creating patient via API: Jean Phaneuf
[22:38:13] [DOC: 9168611] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:38:13] ❌    ❌ Failed to create patient
[22:38:13] [DOC: 9168611] ℹ️  API push details saved for document 9168611
================================================================================
║                        Processing Document ID: 9168599                         ║
================================================================================
[22:38:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:38:13] ℹ️  Date: 03/07/2025
[22:38:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:38:15] [DOC: 9168599] ✅ Text extracted using pdfplumber (3511 chars)
[22:38:15] ✅    ✅ Text extracted using pdfplumber (3511 chars)
[22:38:15] 🔄 
🔄 Step 2: Extracting patient data...
[22:38:17] ℹ️  AI extracted raw sex value: 'F'
[22:38:17] ℹ️  AI extracted service line: 'Medical Social Work'
[22:38:17] ℹ️  AI extracted payer source: ''
[22:38:17] ℹ️  AI extracted diagnoses:
[22:38:17] ℹ️    - Diagnosis 1: ''
[22:38:17] ℹ️    - Diagnosis 2: ''
[22:38:17] ℹ️    - Diagnosis 3: ''
[22:38:17] ℹ️    - Diagnosis 4: ''
[22:38:17] ℹ️    - Diagnosis 5: ''
[22:38:17] ℹ️    - Diagnosis 6: ''
[22:38:17] ℹ️  Final extracted MRN: '2790060'
[22:38:17] ℹ️  Final extracted Sex: 'FEMALE'
[22:38:17] ℹ️  Final extracted Service Line: 'Medical Social Work'
[22:38:17] ℹ️  Final extracted Payer Source: ''
[22:38:17] ✅ Patient data extraction completed successfully
[22:38:17] ✅    ✅ Patient data extracted successfully
[22:38:17] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Nicholson
     └─ dob: 09/21/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2790060
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:38:17] ✅    ✅ Patient identified: Barbara Nicholson
[22:38:17] ✅    ✅ Patient name validation passed
[22:38:17] 🔄 
🔄 Step 3: Processing patient dates...
[22:38:17] [DOC: 9168599] ℹ️  DOB normalized: 09/21/1926
[22:38:17] [DOC: 9168599] ✅ Patient date processing completed successfully
[22:38:17] ✅    ✅ Date processing completed
[22:38:17] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Nicholson
     └─ dob: 09/21/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2790060
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:38:17] 🔄 
🔄 Step 4: Extracting order data...
[22:38:19] ℹ️  Order extraction - MRN: '2790060'
[22:38:19] ℹ️  Order extraction - Sex: 'FEMALE'
[22:38:19] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[22:38:19] ℹ️  Order extraction - Payer Source: ''
[22:38:19] ✅ Order data extraction completed successfully
[22:38:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:38:19] ℹ️  Using MRN from patient data: '2790060' over '2790060'
[22:38:19] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[22:38:19] ✅ Patient name cross-validation successful
[22:38:19] ✅    ✅ Data merged successfully
[22:38:20] ✅    ✅ Order data extracted and validated
[22:38:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:38:20] [DOC: 9168599] ✅ Patient found in local cache: Barbara Nicholson, ID: b5656471-cab3-4be5-a25c-bebb43a87639
[22:38:20] ✅    ✅ Existing patient found with ID: b5656471-cab3-4be5-a25c-bebb43a87639
[22:38:20] 🔄 
🔄 Step 6: Pushing order to API...
[22:38:20] [DOC: 9168599] ℹ️  Pushing order via API for patient ID: b5656471-cab3-4be5-a25c-bebb43a87639
[22:38:22] [DOC: 9168599] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13375"}
[22:38:22] ❌    ❌ Failed to push order
[22:38:22] 🔄 
🔄 Step 7: Writing to CSV...
[22:38:22] [DOC: 9168599] ℹ️  Calculated age: 98 from DOB: 09/21/1926
[22:38:22] [DOC: 9168599] ℹ️  Service Line extracted: 'Medical Social Work'
[22:38:22] [DOC: 9168599] ℹ️  Payer Source extracted: ''
[22:38:22] [DOC: 9168599] ℹ️  Diagnosis codes being written:
[22:38:22] [DOC: 9168599] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:38:22] [DOC: 9168599] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:38:22] [DOC: 9168599] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:38:22] [DOC: 9168599] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:38:22] [DOC: 9168599] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:38:22] [DOC: 9168599] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:38:22] [DOC: 9168599] ✅ Patient data written to CSV: Barbara Nicholson | Sex: FEMALE | Age: 98 | Service: Medical Social Work | Payer:  | MRN: 2790060
[22:38:22] ✅    ✅ Document 9168599 processed and saved successfully
[22:38:22] 🔄 
🔄 Step 8: Saving API details...
[22:38:22] [DOC: 9168599] ℹ️  API push details saved for document 9168599
[22:38:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168591                         ║
================================================================================
[22:38:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:38:22] ℹ️  Date: 03/07/2025
[22:38:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:38:23] [DOC: 9168591] ✅ Text extracted using pdfplumber (1449 chars)
[22:38:23] ✅    ✅ Text extracted using pdfplumber (1449 chars)
[22:38:23] 🔄 
🔄 Step 2: Extracting patient data...
[22:38:25] ℹ️  AI extracted raw sex value: 'F'
[22:38:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:38:25] ℹ️  AI extracted payer source: ''
[22:38:25] ℹ️  AI extracted diagnoses:
[22:38:25] ℹ️    - Diagnosis 1: ''
[22:38:25] ℹ️    - Diagnosis 2: ''
[22:38:25] ℹ️    - Diagnosis 3: ''
[22:38:25] ℹ️    - Diagnosis 4: ''
[22:38:25] ℹ️    - Diagnosis 5: ''
[22:38:25] ℹ️    - Diagnosis 6: ''
[22:38:25] ℹ️  Final extracted MRN: '3545821'
[22:38:25] ℹ️  Final extracted Sex: 'FEMALE'
[22:38:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:38:25] ℹ️  Final extracted Payer Source: ''
[22:38:25] ✅ Patient data extraction completed successfully
[22:38:25] ✅    ✅ Patient data extracted successfully
[22:38:25] 📊 Patient Response
     └─ patientFName: Mary Lou
     └─ patientLName: Moubray
     └─ dob: 05/27/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3545821
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:38:25] ✅    ✅ Patient identified: Mary Lou Moubray
[22:38:25] ✅    ✅ Patient name validation passed
[22:38:25] 🔄 
🔄 Step 3: Processing patient dates...
[22:38:25] [DOC: 9168591] ℹ️  DOB normalized: 05/27/1954
[22:38:25] [DOC: 9168591] ✅ Patient date processing completed successfully
[22:38:25] ✅    ✅ Date processing completed
[22:38:25] 📊 Processed Patient Data
     └─ patientFName: Mary Lou
     └─ patientLName: Moubray
     └─ dob: 05/27/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3545821
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:38:25] 🔄 
🔄 Step 4: Extracting order data...
[22:38:28] ℹ️  Order extraction - MRN: '3545821'
[22:38:28] ℹ️  Order extraction - Sex: 'FEMALE'
[22:38:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:38:28] ℹ️  Order extraction - Payer Source: ''
[22:38:28] ✅ Order data extraction completed successfully
[22:38:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:38:28] ℹ️  Using MRN from patient data: '3545821' over '3545821'
[22:38:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:38:28] ✅ Patient name cross-validation successful
[22:38:28] ✅    ✅ Data merged successfully
[22:38:29] ✅    ✅ Order data extracted and validated
[22:38:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:38:39] [DOC: 9168591] ℹ️  Patient not found in cache or API: Mary Lou Moubray
[22:38:39] [DOC: 9168591] ℹ️  Patient not found, creating new patient via API...
[22:38:39] [DOC: 9168591] ℹ️  Creating patient via API: Mary Lou Moubray
[22:38:40] [DOC: 9168591] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:38:40] ❌    ❌ Failed to create patient
[22:38:40] [DOC: 9168591] ℹ️  API push details saved for document 9168591
================================================================================
║                        Processing Document ID: 9168586                         ║
================================================================================
[22:38:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:38:40] ℹ️  Date: 03/07/2025
[22:38:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:38:44] [DOC: 9168586] ✅ Text extracted using pdfplumber (24211 chars)
[22:38:44] ✅    ✅ Text extracted using pdfplumber (24211 chars)
[22:38:44] 🔄 
🔄 Step 2: Extracting patient data...
[22:38:47] ℹ️  AI extracted raw sex value: 'F'
[22:38:47] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer'
[22:38:47] ℹ️  AI extracted payer source: ''
[22:38:47] ℹ️  AI extracted diagnoses:
[22:38:47] ℹ️    - Diagnosis 1: 'G30.9'
[22:38:47] ℹ️    - Diagnosis 2: 'J18.9'
[22:38:47] ℹ️    - Diagnosis 3: 'R13.10'
[22:38:47] ℹ️    - Diagnosis 4: 'G47.00'
[22:38:47] ℹ️    - Diagnosis 5: 'F41.9'
[22:38:47] ℹ️    - Diagnosis 6: 'I10'
[22:38:47] ℹ️  Final extracted MRN: '2737072'
[22:38:47] ℹ️  Final extracted Sex: 'FEMALE'
[22:38:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer'
[22:38:47] ℹ️  Final extracted Payer Source: ''
[22:38:47] ✅ Patient data extraction completed successfully
[22:38:47] ✅    ✅ Patient data extracted successfully
[22:38:47] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[22:38:47] ✅    ✅ Patient identified: Mary Melancon
[22:38:47] ✅    ✅ Patient name validation passed
[22:38:47] 🔄 
🔄 Step 3: Processing patient dates...
[22:38:47] [DOC: 9168586] ℹ️  DOB normalized: 08/02/1934
[22:38:47] [DOC: 9168586] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[22:38:47] [DOC: 9168586] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[22:38:47] [DOC: 9168586] ✅ Patient date processing completed successfully
[22:38:47] ✅    ✅ Date processing completed
[22:38:47] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[22:38:47] 🔄 
🔄 Step 4: Extracting order data...
[22:38:50] ℹ️  Order extraction - MRN: '2737072'
[22:38:50] ℹ️  Order extraction - Sex: 'FEMALE'
[22:38:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[22:38:50] ℹ️  Order extraction - Payer Source: ''
[22:38:50] ✅ Order data extraction completed successfully
[22:38:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:38:50] ℹ️  Using MRN from patient data: '2737072' over '2737072'
[22:38:50] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer' + Order='Skilled Nursing, MSW, Clergy, Home Health Aide' = 'Clergy, Home Health Aide, MSW, Skilled Nursing, Volunteer'
[22:38:50] ✅ Patient name cross-validation successful
[22:38:50] ✅    ✅ Data merged successfully
[22:38:51] ✅    ✅ Order data extracted and validated
[22:38:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:38:51] [DOC: 9168586] ✅ Patient found in local cache: Mary Melancon, ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[22:38:51] ✅    ✅ Existing patient found with ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[22:38:51] 🔄 
🔄 Step 6: Pushing order to API...
[22:38:51] [DOC: 9168586] ℹ️  Pushing order via API for patient ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[22:38:52] [DOC: 9168586] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13347"}
[22:38:52] ❌    ❌ Failed to push order
[22:38:52] 🔄 
🔄 Step 7: Writing to CSV...
[22:38:52] [DOC: 9168586] ℹ️  Calculated age: 90 from DOB: 08/02/1934
[22:38:52] [DOC: 9168586] ℹ️  Service Line extracted: 'Clergy, Home Health Aide, MSW, Skilled Nursing, Volunteer'
[22:38:52] [DOC: 9168586] ℹ️  Payer Source extracted: ''
[22:38:52] [DOC: 9168586] ℹ️  Diagnosis codes being written:
[22:38:52] [DOC: 9168586] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[22:38:52] [DOC: 9168586] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[22:38:52] [DOC: 9168586] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.10'
[22:38:52] [DOC: 9168586] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G47.00'
[22:38:52] [DOC: 9168586] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[22:38:52] [DOC: 9168586] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[22:38:52] [DOC: 9168586] ✅ Patient data written to CSV: Mary Melancon | Sex: FEMALE | Age: 90 | Service: Clergy, Home Health Aide, MSW, Skilled Nursing, Volunteer | Payer:  | MRN: 2737072
[22:38:52] ✅    ✅ Document 9168586 processed and saved successfully
[22:38:52] 🔄 
🔄 Step 8: Saving API details...
[22:38:52] [DOC: 9168586] ℹ️  API push details saved for document 9168586
[22:38:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168584                         ║
================================================================================
[22:38:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:38:52] ℹ️  Date: 03/07/2025
[22:38:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:38:55] [DOC: 9168584] ✅ Text extracted using pdfplumber (9492 chars)
[22:38:55] ✅    ✅ Text extracted using pdfplumber (9492 chars)
[22:38:55] 🔄 
🔄 Step 2: Extracting patient data...
[22:38:58] ℹ️  AI extracted raw sex value: 'M'
[22:38:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:38:58] ℹ️  AI extracted payer source: ''
[22:38:58] ℹ️  AI extracted diagnoses:
[22:38:58] ℹ️    - Diagnosis 1: 'C43.9'
[22:38:58] ℹ️    - Diagnosis 2: 'I10'
[22:38:58] ℹ️    - Diagnosis 3: 'E78.5'
[22:38:58] ℹ️    - Diagnosis 4: 'E11.9'
[22:38:58] ℹ️    - Diagnosis 5: 'N18.4'
[22:38:58] ℹ️    - Diagnosis 6: 'K75.81'
[22:38:58] ℹ️  Final extracted MRN: '2716471'
[22:38:58] ℹ️  Final extracted Sex: 'MALE'
[22:38:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:38:58] ℹ️  Final extracted Payer Source: ''
[22:38:58] ✅ Patient data extraction completed successfully
[22:38:58] ✅    ✅ Patient data extracted successfully
[22:38:58] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'C43.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'K75.81'}]
[22:38:58] ✅    ✅ Patient identified: Thomas McCormack
[22:38:58] ✅    ✅ Patient name validation passed
[22:38:58] 🔄 
🔄 Step 3: Processing patient dates...
[22:38:58] [DOC: 9168584] ℹ️  DOB normalized: 03/17/1944
[22:38:58] [DOC: 9168584] ℹ️  Episode startOfCare normalized: 03/05/2025
[22:38:58] [DOC: 9168584] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[22:38:58] [DOC: 9168584] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[22:38:58] [DOC: 9168584] ✅ Patient date processing completed successfully
[22:38:58] ✅    ✅ Date processing completed
[22:38:58] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'C43.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'K75.81'}]
[22:38:58] 🔄 
🔄 Step 4: Extracting order data...
[22:39:01] ℹ️  Order extraction - MRN: '2716471'
[22:39:01] ℹ️  Order extraction - Sex: 'MALE'
[22:39:01] ℹ️  Order extraction - Service Line: 'Hospice'
[22:39:01] ℹ️  Order extraction - Payer Source: ''
[22:39:01] ✅ Order data extraction completed successfully
[22:39:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:39:01] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[22:39:01] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Hospice' = 'Hospice, Skilled Nursing'
[22:39:01] ✅ Patient name cross-validation successful
[22:39:01] ✅    ✅ Data merged successfully
[22:39:02] ✅    ✅ Order data extracted and validated
[22:39:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:39:02] [DOC: 9168584] ✅ Patient found in local cache: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:02] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:02] 🔄 
🔄 Step 6: Pushing order to API...
[22:39:02] [DOC: 9168584] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:04] [DOC: 9168584] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13336"}
[22:39:04] ❌    ❌ Failed to push order
[22:39:04] 🔄 
🔄 Step 7: Writing to CSV...
[22:39:04] [DOC: 9168584] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[22:39:04] [DOC: 9168584] ℹ️  Service Line extracted: 'Hospice, Skilled Nursing'
[22:39:04] [DOC: 9168584] ℹ️  Payer Source extracted: ''
[22:39:04] [DOC: 9168584] ℹ️  Diagnosis codes being written:
[22:39:04] [DOC: 9168584] ℹ️    - Latest_Episode_Firstdiagnosis: 'C43.9'
[22:39:04] [DOC: 9168584] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[22:39:04] [DOC: 9168584] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[22:39:04] [DOC: 9168584] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[22:39:04] [DOC: 9168584] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.4'
[22:39:04] [DOC: 9168584] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K75.81'
[22:39:04] [DOC: 9168584] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Hospice, Skilled Nursing | Payer:  | MRN: 2716471
[22:39:04] ✅    ✅ Document 9168584 processed and saved successfully
[22:39:04] 🔄 
🔄 Step 8: Saving API details...
[22:39:04] [DOC: 9168584] ℹ️  API push details saved for document 9168584
[22:39:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168580                         ║
================================================================================
[22:39:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:39:04] ℹ️  Date: 03/07/2025
[22:39:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:39:05] [DOC: 9168580] ✅ Text extracted using pdfplumber (1096 chars)
[22:39:05] ✅    ✅ Text extracted using pdfplumber (1096 chars)
[22:39:05] 🔄 
🔄 Step 2: Extracting patient data...
[22:39:08] ℹ️  AI extracted raw sex value: 'M'
[22:39:08] ℹ️  AI extracted service line: 'Medical Social Work'
[22:39:08] ℹ️  AI extracted payer source: ''
[22:39:08] ℹ️  AI extracted diagnoses:
[22:39:08] ℹ️    - Diagnosis 1: ''
[22:39:08] ℹ️    - Diagnosis 2: ''
[22:39:08] ℹ️    - Diagnosis 3: ''
[22:39:08] ℹ️    - Diagnosis 4: ''
[22:39:08] ℹ️    - Diagnosis 5: ''
[22:39:08] ℹ️    - Diagnosis 6: ''
[22:39:08] ℹ️  Final extracted MRN: '2716471'
[22:39:08] ℹ️  Final extracted Sex: 'MALE'
[22:39:08] ℹ️  Final extracted Service Line: 'Medical Social Work'
[22:39:08] ℹ️  Final extracted Payer Source: ''
[22:39:08] ✅ Patient data extraction completed successfully
[22:39:08] ✅    ✅ Patient data extracted successfully
[22:39:08] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:39:08] ✅    ✅ Patient identified: Thomas McCormack
[22:39:08] ✅    ✅ Patient name validation passed
[22:39:08] 🔄 
🔄 Step 3: Processing patient dates...
[22:39:08] [DOC: 9168580] ℹ️  DOB normalized: 03/17/1944
[22:39:08] [DOC: 9168580] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[22:39:08] [DOC: 9168580] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[22:39:08] [DOC: 9168580] ✅ Patient date processing completed successfully
[22:39:08] ✅    ✅ Date processing completed
[22:39:08] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:39:08] 🔄 
🔄 Step 4: Extracting order data...
[22:39:10] ℹ️  Order extraction - MRN: '2716471'
[22:39:10] ℹ️  Order extraction - Sex: 'MALE'
[22:39:10] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[22:39:10] ℹ️  Order extraction - Payer Source: ''
[22:39:10] ✅ Order data extraction completed successfully
[22:39:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:39:10] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[22:39:10] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[22:39:10] ✅ Patient name cross-validation successful
[22:39:10] ✅    ✅ Data merged successfully
[22:39:12] ✅    ✅ Order data extracted and validated
[22:39:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:39:12] [DOC: 9168580] ✅ Patient found in local cache: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:12] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:12] 🔄 
🔄 Step 6: Pushing order to API...
[22:39:12] [DOC: 9168580] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:13] [DOC: 9168580] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13337"}
[22:39:13] ❌    ❌ Failed to push order
[22:39:13] 🔄 
🔄 Step 7: Writing to CSV...
[22:39:13] [DOC: 9168580] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[22:39:13] [DOC: 9168580] ℹ️  Service Line extracted: 'Medical Social Work'
[22:39:13] [DOC: 9168580] ℹ️  Payer Source extracted: ''
[22:39:13] [DOC: 9168580] ℹ️  Diagnosis codes being written:
[22:39:13] [DOC: 9168580] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:39:13] [DOC: 9168580] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:39:13] [DOC: 9168580] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:39:13] [DOC: 9168580] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:39:13] [DOC: 9168580] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:39:13] [DOC: 9168580] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:39:13] [DOC: 9168580] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Medical Social Work | Payer:  | MRN: 2716471
[22:39:13] ✅    ✅ Document 9168580 processed and saved successfully
[22:39:13] 🔄 
🔄 Step 8: Saving API details...
[22:39:13] [DOC: 9168580] ℹ️  API push details saved for document 9168580
[22:39:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168577                         ║
================================================================================
[22:39:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:39:13] ℹ️  Date: 03/07/2025
[22:39:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:39:17] [DOC: 9168577] ✅ Text extracted using pdfplumber (34890 chars)
[22:39:17] ✅    ✅ Text extracted using pdfplumber (34890 chars)
[22:39:17] 🔄 
🔄 Step 2: Extracting patient data...
[22:39:21] ℹ️  AI extracted raw sex value: 'M'
[22:39:21] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[22:39:21] ℹ️  AI extracted payer source: ''
[22:39:21] ℹ️  AI extracted diagnoses:
[22:39:21] ℹ️    - Diagnosis 1: 'C43.9'
[22:39:21] ℹ️    - Diagnosis 2: 'I10'
[22:39:21] ℹ️    - Diagnosis 3: 'E78.5'
[22:39:21] ℹ️    - Diagnosis 4: 'E11.9'
[22:39:21] ℹ️    - Diagnosis 5: 'N18.4'
[22:39:21] ℹ️    - Diagnosis 6: 'K75.81'
[22:39:21] ℹ️  Final extracted MRN: '2716471'
[22:39:21] ℹ️  Final extracted Sex: 'MALE'
[22:39:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[22:39:21] ℹ️  Final extracted Payer Source: ''
[22:39:21] ✅ Patient data extraction completed successfully
[22:39:21] ✅    ✅ Patient data extracted successfully
[22:39:21] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'C43.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'K75.81'}]
[22:39:21] ✅    ✅ Patient identified: Thomas McCormack
[22:39:21] ✅    ✅ Patient name validation passed
[22:39:21] 🔄 
🔄 Step 3: Processing patient dates...
[22:39:21] [DOC: 9168577] ℹ️  DOB normalized: 03/17/1944
[22:39:21] [DOC: 9168577] ℹ️  Episode startOfCare normalized: 03/05/2025
[22:39:21] [DOC: 9168577] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[22:39:21] [DOC: 9168577] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[22:39:21] [DOC: 9168577] ✅ Patient date processing completed successfully
[22:39:21] ✅    ✅ Date processing completed
[22:39:21] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'C43.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'K75.81'}]
[22:39:21] 🔄 
🔄 Step 4: Extracting order data...
[22:39:24] ℹ️  Order extraction - MRN: '2716471'
[22:39:24] ℹ️  Order extraction - Sex: 'MALE'
[22:39:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[22:39:24] ℹ️  Order extraction - Payer Source: ''
[22:39:24] ✅ Order data extraction completed successfully
[22:39:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:39:24] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[22:39:24] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, HHA' + Order='Skilled Nursing, MSW, HHA' = 'Clergy, HHA, MSW, Skilled Nursing'
[22:39:24] ✅ Patient name cross-validation successful
[22:39:24] ✅    ✅ Data merged successfully
[22:39:25] ✅    ✅ Order data extracted and validated
[22:39:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:39:25] [DOC: 9168577] ✅ Patient found in local cache: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:25] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:25] 🔄 
🔄 Step 6: Pushing order to API...
[22:39:25] [DOC: 9168577] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[22:39:26] [DOC: 9168577] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13338"}
[22:39:26] ❌    ❌ Failed to push order
[22:39:26] 🔄 
🔄 Step 7: Writing to CSV...
[22:39:26] [DOC: 9168577] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[22:39:26] [DOC: 9168577] ℹ️  Service Line extracted: 'Clergy, HHA, MSW, Skilled Nursing'
[22:39:26] [DOC: 9168577] ℹ️  Payer Source extracted: ''
[22:39:26] [DOC: 9168577] ℹ️  Diagnosis codes being written:
[22:39:26] [DOC: 9168577] ℹ️    - Latest_Episode_Firstdiagnosis: 'C43.9'
[22:39:26] [DOC: 9168577] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[22:39:26] [DOC: 9168577] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[22:39:26] [DOC: 9168577] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[22:39:26] [DOC: 9168577] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.4'
[22:39:26] [DOC: 9168577] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K75.81'
[22:39:26] [DOC: 9168577] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Clergy, HHA, MSW, Skilled Nursing | Payer:  | MRN: 2716471
[22:39:26] ✅    ✅ Document 9168577 processed and saved successfully
[22:39:26] 🔄 
🔄 Step 8: Saving API details...
[22:39:26] [DOC: 9168577] ℹ️  API push details saved for document 9168577
[22:39:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168558                         ║
================================================================================
[22:39:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:39:26] ℹ️  Date: 03/07/2025
[22:39:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:39:29] [DOC: 9168558] ✅ Text extracted using pdfplumber (19073 chars)
[22:39:29] ✅    ✅ Text extracted using pdfplumber (19073 chars)
[22:39:29] 🔄 
🔄 Step 2: Extracting patient data...
[22:39:32] ℹ️  AI extracted raw sex value: 'F'
[22:39:32] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[22:39:32] ℹ️  AI extracted payer source: ''
[22:39:32] ℹ️  AI extracted diagnoses:
[22:39:32] ℹ️    - Diagnosis 1: 'S63.104D'
[22:39:32] ℹ️    - Diagnosis 2: 'J10.1'
[22:39:32] ℹ️    - Diagnosis 3: 'S61.001D'
[22:39:32] ℹ️    - Diagnosis 4: 'M62.82'
[22:39:32] ℹ️    - Diagnosis 5: 'I48.91'
[22:39:32] ℹ️    - Diagnosis 6: 'E87.6'
[22:39:32] ℹ️  Final extracted MRN: '2647449'
[22:39:32] ℹ️  Final extracted Sex: 'FEMALE'
[22:39:32] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[22:39:32] ℹ️  Final extracted Payer Source: ''
[22:39:32] ✅ Patient data extraction completed successfully
[22:39:32] ✅    ✅ Patient data extracted successfully
[22:39:32] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Leblanc
     └─ dob: 07/13/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2647449
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 1063 Tacoma St # 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745-1506
     └─ email: 
     └─ phoneNumber: 508-995-3530
     └─ serviceLine: Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'S63.104D', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'S61.001D', 'fourthDiagnosis': 'M62.82', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'E87.6'}]
[22:39:32] ✅    ✅ Patient identified: Mary Leblanc
[22:39:32] ✅    ✅ Patient name validation passed
[22:39:32] 🔄 
🔄 Step 3: Processing patient dates...
[22:39:32] [DOC: 9168558] ℹ️  DOB normalized: 07/13/1935
[22:39:32] [DOC: 9168558] ℹ️  Episode startOfCare normalized: 02/26/2025
[22:39:32] [DOC: 9168558] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[22:39:32] [DOC: 9168558] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[22:39:32] [DOC: 9168558] ✅ Patient date processing completed successfully
[22:39:32] ✅    ✅ Date processing completed
[22:39:32] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Leblanc
     └─ dob: 07/13/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2647449
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 1063 Tacoma St # 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745-1506
     └─ email: 
     └─ phoneNumber: 508-995-3530
     └─ serviceLine: Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'S63.104D', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'S61.001D', 'fourthDiagnosis': 'M62.82', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'E87.6'}]
[22:39:32] 🔄 
🔄 Step 4: Extracting order data...
[22:39:35] ℹ️  Order extraction - MRN: '2647449'
[22:39:35] ℹ️  Order extraction - Sex: 'FEMALE'
[22:39:35] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[22:39:35] ℹ️  Order extraction - Payer Source: ''
[22:39:35] ✅ Order data extraction completed successfully
[22:39:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:39:35] ℹ️  Using MRN from patient data: '2647449' over '2647449'
[22:39:35] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[22:39:35] ✅ Patient name cross-validation successful
[22:39:35] ✅    ✅ Data merged successfully
[22:39:36] ✅    ✅ Order data extracted and validated
[22:39:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:39:36] [DOC: 9168558] ✅ Patient found in local cache: Mary Leblanc, ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[22:39:36] ✅    ✅ Existing patient found with ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[22:39:36] 🔄 
🔄 Step 6: Pushing order to API...
[22:39:36] [DOC: 9168558] ℹ️  Pushing order via API for patient ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[22:39:37] [DOC: 9168558] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13172"}
[22:39:37] ❌    ❌ Failed to push order
[22:39:37] 🔄 
🔄 Step 7: Writing to CSV...
[22:39:37] [DOC: 9168558] ℹ️  Calculated age: 89 from DOB: 07/13/1935
[22:39:37] [DOC: 9168558] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[22:39:37] [DOC: 9168558] ℹ️  Payer Source extracted: ''
[22:39:37] [DOC: 9168558] ℹ️  Diagnosis codes being written:
[22:39:37] [DOC: 9168558] ℹ️    - Latest_Episode_Firstdiagnosis: 'S63.104D'
[22:39:37] [DOC: 9168558] ℹ️    - Latest_Episode_Seconddiagnosis: 'J10.1'
[22:39:37] [DOC: 9168558] ℹ️    - Latest_Episode_Thirddiagnosis: 'S61.001D'
[22:39:37] [DOC: 9168558] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M62.82'
[22:39:37] [DOC: 9168558] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[22:39:37] [DOC: 9168558] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.6'
[22:39:37] [DOC: 9168558] ✅ Patient data written to CSV: Mary Leblanc | Sex: FEMALE | Age: 89 | Service: Physical Therapy, Occupational Therapy, Home Health Aide | Payer:  | MRN: 2647449
[22:39:37] ✅    ✅ Document 9168558 processed and saved successfully
[22:39:37] 🔄 
🔄 Step 8: Saving API details...
[22:39:37] [DOC: 9168558] ℹ️  API push details saved for document 9168558
[22:39:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168538                         ║
================================================================================
[22:39:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:39:37] ℹ️  Date: 03/07/2025
[22:39:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:39:39] [DOC: 9168538] ✅ Text extracted using pdfplumber (1070 chars)
[22:39:39] ✅    ✅ Text extracted using pdfplumber (1070 chars)
[22:39:39] 🔄 
🔄 Step 2: Extracting patient data...
[22:39:41] ℹ️  AI extracted raw sex value: 'M'
[22:39:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:39:41] ℹ️  AI extracted payer source: ''
[22:39:41] ℹ️  AI extracted diagnoses:
[22:39:41] ℹ️    - Diagnosis 1: ''
[22:39:41] ℹ️    - Diagnosis 2: ''
[22:39:41] ℹ️    - Diagnosis 3: ''
[22:39:41] ℹ️    - Diagnosis 4: ''
[22:39:41] ℹ️    - Diagnosis 5: ''
[22:39:41] ℹ️    - Diagnosis 6: ''
[22:39:41] ℹ️  Final extracted MRN: '2136200'
[22:39:41] ℹ️  Final extracted Sex: 'MALE'
[22:39:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:39:41] ℹ️  Final extracted Payer Source: ''
[22:39:41] ✅ Patient data extraction completed successfully
[22:39:41] ✅    ✅ Patient data extracted successfully
[22:39:41] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:39:41] ✅    ✅ Patient identified: Jacob Amadeu
[22:39:41] ✅    ✅ Patient name validation passed
[22:39:41] 🔄 
🔄 Step 3: Processing patient dates...
[22:39:41] [DOC: 9168538] ℹ️  DOB normalized: 04/03/1941
[22:39:41] [DOC: 9168538] ✅ Patient date processing completed successfully
[22:39:41] ✅    ✅ Date processing completed
[22:39:41] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:39:41] 🔄 
🔄 Step 4: Extracting order data...
[22:39:44] ℹ️  Order extraction - MRN: '2136200'
[22:39:44] ℹ️  Order extraction - Sex: 'MALE'
[22:39:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:39:44] ℹ️  Order extraction - Payer Source: ''
[22:39:44] ✅ Order data extraction completed successfully
[22:39:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:39:44] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[22:39:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:39:44] ✅ Patient name cross-validation successful
[22:39:44] ✅    ✅ Data merged successfully
[22:39:45] ✅    ✅ Order data extracted and validated
[22:39:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:39:55] [DOC: 9168538] ℹ️  Patient not found in cache or API: Jacob Amadeu
[22:39:55] [DOC: 9168538] ℹ️  Patient not found, creating new patient via API...
[22:39:55] [DOC: 9168538] ℹ️  Creating patient via API: Jacob Amadeu
[22:39:56] [DOC: 9168538] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:39:56] ❌    ❌ Failed to create patient
[22:39:56] [DOC: 9168538] ℹ️  API push details saved for document 9168538
================================================================================
║                        Processing Document ID: 9168522                         ║
================================================================================
[22:39:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:39:56] ℹ️  Date: 03/07/2025
[22:39:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:39:58] [DOC: 9168522] ✅ Text extracted using pdfplumber (1300 chars)
[22:39:58] ✅    ✅ Text extracted using pdfplumber (1300 chars)
[22:39:58] 🔄 
🔄 Step 2: Extracting patient data...
[22:40:00] ℹ️  AI extracted raw sex value: 'F'
[22:40:00] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[22:40:00] ℹ️  AI extracted payer source: ''
[22:40:00] ℹ️  AI extracted diagnoses:
[22:40:00] ℹ️    - Diagnosis 1: ''
[22:40:00] ℹ️    - Diagnosis 2: ''
[22:40:00] ℹ️    - Diagnosis 3: ''
[22:40:00] ℹ️    - Diagnosis 4: ''
[22:40:00] ℹ️    - Diagnosis 5: ''
[22:40:00] ℹ️    - Diagnosis 6: ''
[22:40:00] ℹ️  Final extracted MRN: '2450273'
[22:40:00] ℹ️  Final extracted Sex: 'FEMALE'
[22:40:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[22:40:00] ℹ️  Final extracted Payer Source: ''
[22:40:00] ✅ Patient data extraction completed successfully
[22:40:00] ✅    ✅ Patient data extracted successfully
[22:40:00] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:40:00] ✅    ✅ Patient identified: Maria Estacio
[22:40:00] ✅    ✅ Patient name validation passed
[22:40:00] 🔄 
🔄 Step 3: Processing patient dates...
[22:40:00] [DOC: 9168522] ℹ️  DOB normalized: 12/14/1935
[22:40:00] [DOC: 9168522] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[22:40:00] [DOC: 9168522] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[22:40:00] [DOC: 9168522] ✅ Patient date processing completed successfully
[22:40:00] ✅    ✅ Date processing completed
[22:40:00] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:40:00] 🔄 
🔄 Step 4: Extracting order data...
[22:40:03] ℹ️  Order extraction - MRN: '2450273'
[22:40:03] ℹ️  Order extraction - Sex: 'FEMALE'
[22:40:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[22:40:03] ℹ️  Order extraction - Payer Source: ''
[22:40:03] ✅ Order data extraction completed successfully
[22:40:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:40:03] ℹ️  Using MRN from patient data: '2450273' over '2450273'
[22:40:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[22:40:03] ✅ Patient name cross-validation successful
[22:40:03] ✅    ✅ Data merged successfully
[22:40:04] ✅    ✅ Order data extracted and validated
[22:40:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:40:23] [DOC: 9168522] ℹ️  Patient not found in cache or API: Maria Estacio
[22:40:23] [DOC: 9168522] ℹ️  Patient not found, creating new patient via API...
[22:40:23] [DOC: 9168522] ℹ️  Creating patient via API: Maria Estacio
[22:40:24] [DOC: 9168522] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:40:24] ❌    ❌ Failed to create patient
[22:40:24] [DOC: 9168522] ℹ️  API push details saved for document 9168522
================================================================================
║                        Processing Document ID: 9168514                         ║
================================================================================
[22:40:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:40:24] ℹ️  Date: 03/07/2025
[22:40:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:40:25] [DOC: 9168514] ✅ Text extracted using pdfplumber (943 chars)
[22:40:25] ✅    ✅ Text extracted using pdfplumber (943 chars)
[22:40:25] 🔄 
🔄 Step 2: Extracting patient data...
[22:40:28] ℹ️  AI extracted raw sex value: 'F'
[22:40:28] ℹ️  AI extracted service line: 'RN'
[22:40:28] ℹ️  AI extracted payer source: ''
[22:40:28] ℹ️  AI extracted diagnoses:
[22:40:28] ℹ️    - Diagnosis 1: ''
[22:40:28] ℹ️    - Diagnosis 2: ''
[22:40:28] ℹ️    - Diagnosis 3: ''
[22:40:28] ℹ️    - Diagnosis 4: ''
[22:40:28] ℹ️    - Diagnosis 5: ''
[22:40:28] ℹ️    - Diagnosis 6: ''
[22:40:28] ℹ️  Final extracted MRN: '2391867'
[22:40:28] ℹ️  Final extracted Sex: 'FEMALE'
[22:40:28] ℹ️  Final extracted Service Line: 'RN'
[22:40:28] ℹ️  Final extracted Payer Source: ''
[22:40:28] ✅ Patient data extraction completed successfully
[22:40:28] ✅    ✅ Patient data extracted successfully
[22:40:28] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Dawson
     └─ dob: 05/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2391867
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:40:28] ✅    ✅ Patient identified: Pearl Dawson
[22:40:28] ✅    ✅ Patient name validation passed
[22:40:28] 🔄 
🔄 Step 3: Processing patient dates...
[22:40:28] [DOC: 9168514] ℹ️  DOB normalized: 05/01/1931
[22:40:28] [DOC: 9168514] ✅ Patient date processing completed successfully
[22:40:28] ✅    ✅ Date processing completed
[22:40:28] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Dawson
     └─ dob: 05/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2391867
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:40:28] 🔄 
🔄 Step 4: Extracting order data...
[22:40:30] ℹ️  Order extraction - MRN: '2391867'
[22:40:30] ℹ️  Order extraction - Sex: 'FEMALE'
[22:40:30] ℹ️  Order extraction - Service Line: ''
[22:40:30] ℹ️  Order extraction - Payer Source: ''
[22:40:30] ✅ Order data extraction completed successfully
[22:40:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:40:30] ℹ️  Using MRN from patient data: '2391867' over '2391867'
[22:40:30] ℹ️  Using service line from patient data: 'RN'
[22:40:30] ✅ Patient name cross-validation successful
[22:40:30] ✅    ✅ Data merged successfully
[22:40:31] ⚠️     ❌ Skipping - missing episode start date
[22:40:31] [DOC: 9168514] ℹ️  API push details saved for document 9168514
================================================================================
║                        Processing Document ID: 9168498                         ║
================================================================================
[22:40:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:40:31] ℹ️  Date: 03/07/2025
[22:40:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:40:34] [DOC: 9168498] ✅ Text extracted using pdfplumber (17572 chars)
[22:40:34] ✅    ✅ Text extracted using pdfplumber (17572 chars)
[22:40:34] 🔄 
🔄 Step 2: Extracting patient data...
[22:40:37] ℹ️  AI extracted raw sex value: 'F'
[22:40:37] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[22:40:37] ℹ️  AI extracted payer source: ''
[22:40:37] ℹ️  AI extracted diagnoses:
[22:40:37] ℹ️    - Diagnosis 1: 'Z47.1'
[22:40:37] ℹ️    - Diagnosis 2: 'Z96.652'
[22:40:37] ℹ️    - Diagnosis 3: 'I69.351'
[22:40:37] ℹ️    - Diagnosis 4: 'I69.320'
[22:40:37] ℹ️    - Diagnosis 5: 'M48.00'
[22:40:37] ℹ️    - Diagnosis 6: 'M81.0'
[22:40:37] ℹ️  Final extracted MRN: '2261397'
[22:40:37] ℹ️  Final extracted Sex: 'FEMALE'
[22:40:37] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[22:40:37] ℹ️  Final extracted Payer Source: ''
[22:40:37] ✅ Patient data extraction completed successfully
[22:40:37] ✅    ✅ Patient data extracted successfully
[22:40:37] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bowden
     └─ dob: 11/20/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2261397
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'I69.351', 'fourthDiagnosis': 'I69.320', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'M81.0'}]
[22:40:37] ✅    ✅ Patient identified: Pauline Bowden
[22:40:37] ✅    ✅ Patient name validation passed
[22:40:37] 🔄 
🔄 Step 3: Processing patient dates...
[22:40:37] [DOC: 9168498] ℹ️  DOB normalized: 11/20/1957
[22:40:37] [DOC: 9168498] ℹ️  Episode startOfCare normalized: 02/26/2025
[22:40:37] [DOC: 9168498] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[22:40:37] [DOC: 9168498] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[22:40:37] [DOC: 9168498] ✅ Patient date processing completed successfully
[22:40:37] ✅    ✅ Date processing completed
[22:40:37] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bowden
     └─ dob: 11/20/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2261397
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'I69.351', 'fourthDiagnosis': 'I69.320', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'M81.0'}]
[22:40:37] 🔄 
🔄 Step 4: Extracting order data...
[22:40:40] ℹ️  Order extraction - MRN: '2261397'
[22:40:40] ℹ️  Order extraction - Sex: 'FEMALE'
[22:40:40] ℹ️  Order extraction - Service Line: 'PT, OT'
[22:40:40] ℹ️  Order extraction - Payer Source: ''
[22:40:40] ✅ Order data extraction completed successfully
[22:40:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:40:40] ℹ️  Using MRN from patient data: '2261397' over '2261397'
[22:40:40] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[22:40:40] ✅ Patient name cross-validation successful
[22:40:40] ✅    ✅ Data merged successfully
[22:40:42] ✅    ✅ Order data extracted and validated
[22:40:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:41:17] [DOC: 9168498] ℹ️  Patient not found in cache or API: Pauline Bowden
[22:41:17] [DOC: 9168498] ℹ️  Patient not found, creating new patient via API...
[22:41:17] [DOC: 9168498] ℹ️  Creating patient via API: Pauline Bowden
[22:41:21] [DOC: 9168498] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:41:21] ❌    ❌ Failed to create patient
[22:41:21] [DOC: 9168498] ℹ️  API push details saved for document 9168498
================================================================================
║                        Processing Document ID: 9168488                         ║
================================================================================
[22:41:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:41:21] ℹ️  Date: 03/07/2025
[22:41:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:41:22] [DOC: 9168488] ✅ Text extracted using pdfplumber (1000 chars)
[22:41:22] ✅    ✅ Text extracted using pdfplumber (1000 chars)
[22:41:22] 🔄 
🔄 Step 2: Extracting patient data...
[22:41:25] ℹ️  AI extracted raw sex value: 'F'
[22:41:25] ℹ️  AI extracted service line: 'Occupational Therapy'
[22:41:25] ℹ️  AI extracted payer source: ''
[22:41:25] ℹ️  AI extracted diagnoses:
[22:41:25] ℹ️    - Diagnosis 1: ''
[22:41:25] ℹ️    - Diagnosis 2: ''
[22:41:25] ℹ️    - Diagnosis 3: ''
[22:41:25] ℹ️    - Diagnosis 4: ''
[22:41:25] ℹ️    - Diagnosis 5: ''
[22:41:25] ℹ️    - Diagnosis 6: ''
[22:41:25] ℹ️  Final extracted MRN: '2242860'
[22:41:25] ℹ️  Final extracted Sex: 'FEMALE'
[22:41:25] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[22:41:25] ℹ️  Final extracted Payer Source: ''
[22:41:25] ✅ Patient data extraction completed successfully
[22:41:25] ✅    ✅ Patient data extracted successfully
[22:41:25] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Bilodeau
     └─ dob: 12/02/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2242860
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:41:25] ✅    ✅ Patient identified: Sandra Bilodeau
[22:41:25] ✅    ✅ Patient name validation passed
[22:41:25] 🔄 
🔄 Step 3: Processing patient dates...
[22:41:25] [DOC: 9168488] ℹ️  DOB normalized: 12/02/1938
[22:41:25] [DOC: 9168488] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[22:41:25] [DOC: 9168488] ℹ️  Episode endOfEpisode normalized: 03/15/2025
[22:41:25] [DOC: 9168488] ✅ Patient date processing completed successfully
[22:41:25] ✅    ✅ Date processing completed
[22:41:25] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Bilodeau
     └─ dob: 12/02/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2242860
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:41:25] 🔄 
🔄 Step 4: Extracting order data...
[22:41:27] ℹ️  Order extraction - MRN: '2242860'
[22:41:27] ℹ️  Order extraction - Sex: 'FEMALE'
[22:41:27] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[22:41:27] ℹ️  Order extraction - Payer Source: ''
[22:41:27] ✅ Order data extraction completed successfully
[22:41:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:41:27] ℹ️  Using MRN from patient data: '2242860' over '2242860'
[22:41:27] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[22:41:27] ✅ Patient name cross-validation successful
[22:41:27] ✅    ✅ Data merged successfully
[22:41:28] ✅    ✅ Order data extracted and validated
[22:41:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:41:37] [DOC: 9168488] ℹ️  Patient not found in cache or API: Sandra Bilodeau
[22:41:37] [DOC: 9168488] ℹ️  Patient not found, creating new patient via API...
[22:41:37] [DOC: 9168488] ℹ️  Creating patient via API: Sandra Bilodeau
[22:41:38] [DOC: 9168488] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:41:38] ❌    ❌ Failed to create patient
[22:41:38] [DOC: 9168488] ℹ️  API push details saved for document 9168488
================================================================================
║                        Processing Document ID: 9168487                         ║
================================================================================
[22:41:38] ℹ️  Agency: Dartmouth HH
[22:41:38] ℹ️  Date: 03/07/2025
[22:41:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:41:41] [DOC: 9168487] ✅ Text extracted using pdfplumber (23355 chars)
[22:41:41] ✅    ✅ Text extracted using pdfplumber (23355 chars)
[22:41:41] 🔄 
🔄 Step 2: Extracting patient data...
[22:41:44] ℹ️  AI extracted raw sex value: 'M'
[22:41:44] ℹ️  AI extracted service line: 'PT, OT, HCA'
[22:41:44] ℹ️  AI extracted payer source: 'United Health Care'
[22:41:44] ℹ️  AI extracted diagnoses:
[22:41:44] ℹ️    - Diagnosis 1: 'C Diff'
[22:41:44] ℹ️    - Diagnosis 2: 'PNA'
[22:41:44] ℹ️    - Diagnosis 3: 'UTI'
[22:41:44] ℹ️    - Diagnosis 4: ''
[22:41:44] ℹ️    - Diagnosis 5: ''
[22:41:44] ℹ️    - Diagnosis 6: ''
[22:41:44] ℹ️  Final extracted MRN: '926015'
[22:41:44] ℹ️  Final extracted Sex: 'MALE'
[22:41:44] ℹ️  Final extracted Service Line: 'PT, OT, HCA'
[22:41:44] ℹ️  Final extracted Payer Source: 'United Health Care'
[22:41:44] ✅ Patient data extraction completed successfully
[22:41:44] ✅    ✅ Patient data extracted successfully
[22:41:44] 📊 Patient Response
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, HCA
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'C Diff', 'secondDiagnosis': 'PNA', 'thirdDiagnosis': 'UTI', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:41:44] ✅    ✅ Patient identified: Clinton Sowle
[22:41:44] ✅    ✅ Patient name validation passed
[22:41:44] 🔄 
🔄 Step 3: Processing patient dates...
[22:41:44] [DOC: 9168487] ℹ️  DOB normalized: 12/01/1943
[22:41:44] [DOC: 9168487] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:41:44] [DOC: 9168487] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[22:41:44] [DOC: 9168487] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[22:41:44] [DOC: 9168487] ✅ Patient date processing completed successfully
[22:41:44] ✅    ✅ Date processing completed
[22:41:44] 📊 Processed Patient Data
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, HCA
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'C Diff', 'secondDiagnosis': 'PNA', 'thirdDiagnosis': 'UTI', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:41:44] 🔄 
🔄 Step 4: Extracting order data...
[22:41:47] ℹ️  Order extraction - MRN: ''
[22:41:47] ℹ️  Order extraction - Sex: 'MALE'
[22:41:47] ℹ️  Order extraction - Service Line: 'PT, OT, HCA'
[22:41:47] ℹ️  Order extraction - Payer Source: 'United Health Care'
[22:41:47] ✅ Order data extraction completed successfully
[22:41:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:41:47] ℹ️  Using MRN from patient data: '926015'
[22:41:47] ℹ️  Service line consistent in both sources: 'PT, OT, HCA'
[22:41:47] ℹ️  Payer source consistent in both sources: 'United Health Care'
[22:41:47] ✅ Patient name cross-validation successful
[22:41:47] ✅    ✅ Data merged successfully
[22:41:48] ✅    ✅ Order data extracted and validated
[22:41:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:41:48] [DOC: 9168487] ✅ Patient found in local cache: Clinton Sowle, ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[22:41:48] ✅    ✅ Existing patient found with ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[22:41:48] 🔄 
🔄 Step 6: Pushing order to API...
[22:41:48] [DOC: 9168487] ℹ️  Pushing order via API for patient ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[22:41:51] [DOC: 9168487] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:41:51] ❌    ❌ Failed to push order
[22:41:51] 🔄 
🔄 Step 7: Writing to CSV...
[22:41:51] [DOC: 9168487] ℹ️  Calculated age: 81 from DOB: 12/01/1943
[22:41:51] [DOC: 9168487] ℹ️  Service Line extracted: 'PT, OT, HCA'
[22:41:51] [DOC: 9168487] ℹ️  Payer Source extracted: 'United Health Care'
[22:41:51] [DOC: 9168487] ℹ️  Diagnosis codes being written:
[22:41:51] [DOC: 9168487] ℹ️    - Latest_Episode_Firstdiagnosis: 'C Diff'
[22:41:51] [DOC: 9168487] ℹ️    - Latest_Episode_Seconddiagnosis: 'PNA'
[22:41:51] [DOC: 9168487] ℹ️    - Latest_Episode_Thirddiagnosis: 'UTI'
[22:41:51] [DOC: 9168487] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:41:51] [DOC: 9168487] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:41:51] [DOC: 9168487] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:41:51] [DOC: 9168487] ✅ Patient data written to CSV: Clinton Sowle | Sex: MALE | Age: 81 | Service: PT, OT, HCA | Payer: United Health Care | MRN: 926015
[22:41:51] ✅    ✅ Document 9168487 processed and saved successfully
[22:41:51] 🔄 
🔄 Step 8: Saving API details...
[22:41:51] [DOC: 9168487] ℹ️  API push details saved for document 9168487
[22:41:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168484                         ║
================================================================================
[22:41:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:41:51] ℹ️  Date: 03/07/2025
[22:41:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:41:53] [DOC: 9168484] ✅ Text extracted using pdfplumber (13126 chars)
[22:41:53] ✅    ✅ Text extracted using pdfplumber (13126 chars)
[22:41:53] 🔄 
🔄 Step 2: Extracting patient data...
[22:41:56] ℹ️  AI extracted raw sex value: 'F'
[22:41:56] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:41:56] ℹ️  AI extracted payer source: ''
[22:41:56] ℹ️  AI extracted diagnoses:
[22:41:56] ℹ️    - Diagnosis 1: 'M05.79'
[22:41:56] ℹ️    - Diagnosis 2: 'J45.909'
[22:41:56] ℹ️    - Diagnosis 3: 'E87.1'
[22:41:56] ℹ️    - Diagnosis 4: 'I10'
[22:41:56] ℹ️    - Diagnosis 5: 'D64.9'
[22:41:56] ℹ️    - Diagnosis 6: 'G47.33'
[22:41:56] ℹ️  Final extracted MRN: '2242860'
[22:41:56] ℹ️  Final extracted Sex: 'FEMALE'
[22:41:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:41:56] ℹ️  Final extracted Payer Source: ''
[22:41:56] ✅ Patient data extraction completed successfully
[22:41:56] ✅    ✅ Patient data extracted successfully
[22:41:56] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Bilodeau
     └─ dob: 12/02/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2242860
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'M05.79', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'G47.33'}]
[22:41:56] ✅    ✅ Patient identified: Sandra Bilodeau
[22:41:56] ✅    ✅ Patient name validation passed
[22:41:56] 🔄 
🔄 Step 3: Processing patient dates...
[22:41:56] [DOC: 9168484] ℹ️  DOB normalized: 12/02/1938
[22:41:56] [DOC: 9168484] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:41:56] [DOC: 9168484] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[22:41:56] [DOC: 9168484] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[22:41:56] [DOC: 9168484] ✅ Patient date processing completed successfully
[22:41:56] ✅    ✅ Date processing completed
[22:41:56] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Bilodeau
     └─ dob: 12/02/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2242860
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'M05.79', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'G47.33'}]
[22:41:56] 🔄 
🔄 Step 4: Extracting order data...
[22:41:59] ℹ️  Order extraction - MRN: '2242860'
[22:41:59] ℹ️  Order extraction - Sex: 'FEMALE'
[22:41:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:41:59] ℹ️  Order extraction - Payer Source: ''
[22:41:59] ✅ Order data extraction completed successfully
[22:41:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:41:59] ℹ️  Using MRN from patient data: '2242860' over '2242860'
[22:41:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:41:59] ✅ Patient name cross-validation successful
[22:41:59] ✅    ✅ Data merged successfully
[22:42:01] ✅    ✅ Order data extracted and validated
[22:42:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:42:15] [DOC: 9168484] ℹ️  Patient not found in cache or API: Sandra Bilodeau
[22:42:15] [DOC: 9168484] ℹ️  Patient not found, creating new patient via API...
[22:42:15] [DOC: 9168484] ℹ️  Creating patient via API: Sandra Bilodeau
[22:42:17] [DOC: 9168484] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:42:17] ❌    ❌ Failed to create patient
[22:42:17] [DOC: 9168484] ℹ️  API push details saved for document 9168484
================================================================================
║                        Processing Document ID: 9168247                         ║
================================================================================
[22:42:17] ℹ️  Agency: Fairhaven HH&H
[22:42:17] ℹ️  Date: 03/07/2025
[22:42:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:42:19] [DOC: 9168247] ✅ Text extracted using pdfplumber (6706 chars)
[22:42:19] ✅    ✅ Text extracted using pdfplumber (6706 chars)
[22:42:19] 🔄 
🔄 Step 2: Extracting patient data...
[22:42:22] ℹ️  AI extracted raw sex value: 'F'
[22:42:22] ℹ️  AI extracted service line: 'RN, MSW, HHA'
[22:42:22] ℹ️  AI extracted payer source: 'Medicare'
[22:42:22] ℹ️  AI extracted diagnoses:
[22:42:22] ℹ️    - Diagnosis 1: ''
[22:42:22] ℹ️    - Diagnosis 2: ''
[22:42:22] ℹ️    - Diagnosis 3: ''
[22:42:22] ℹ️    - Diagnosis 4: ''
[22:42:22] ℹ️    - Diagnosis 5: ''
[22:42:22] ℹ️    - Diagnosis 6: ''
[22:42:22] ℹ️  Final extracted MRN: '5745015'
[22:42:22] ℹ️  Final extracted Sex: 'FEMALE'
[22:42:22] ℹ️  Final extracted Service Line: 'RN, MSW, HHA'
[22:42:22] ℹ️  Final extracted Payer Source: 'Medicare'
[22:42:22] ✅ Patient data extraction completed successfully
[22:42:22] ✅    ✅ Patient data extracted successfully
[22:42:22] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Renzi
     └─ dob: 07/23/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5745015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, MSW, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:42:22] ✅    ✅ Patient identified: Patricia Renzi
[22:42:22] ✅    ✅ Patient name validation passed
[22:42:22] 🔄 
🔄 Step 3: Processing patient dates...
[22:42:22] [DOC: 9168247] ℹ️  DOB normalized: 07/23/1949
[22:42:22] [DOC: 9168247] ℹ️  Episode startOfCare normalized: 02/21/2025
[22:42:22] [DOC: 9168247] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[22:42:22] [DOC: 9168247] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[22:42:22] [DOC: 9168247] ✅ Patient date processing completed successfully
[22:42:22] ✅    ✅ Date processing completed
[22:42:22] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Renzi
     └─ dob: 07/23/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5745015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, MSW, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:42:22] 🔄 
🔄 Step 4: Extracting order data...
[22:42:24] ℹ️  Order extraction - MRN: '5745015'
[22:42:24] ℹ️  Order extraction - Sex: 'FEMALE'
[22:42:24] ℹ️  Order extraction - Service Line: 'RN, MSW'
[22:42:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:42:24] ✅ Order data extraction completed successfully
[22:42:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:42:24] ℹ️  Using MRN from patient data: '5745015' over '5745015'
[22:42:24] ℹ️  Combined service lines: Patient='RN, MSW, HHA' + Order='RN, MSW' = 'HHA, MSW, RN'
[22:42:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:42:24] ✅ Patient name cross-validation successful
[22:42:24] ✅    ✅ Data merged successfully
[22:42:26] ✅    ✅ Order data extracted and validated
[22:42:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:42:33] [DOC: 9168247] ✅ Patient exists in API: Patricia Renzi, ID: 9fef0918-dd74-47f9-a3ed-a5a660409269
[22:42:33] ✅    ✅ Existing patient found with ID: 9fef0918-dd74-47f9-a3ed-a5a660409269
[22:42:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:42:33] [DOC: 9168247] ℹ️  Pushing order via API for patient ID: 9fef0918-dd74-47f9-a3ed-a5a660409269
[22:42:34] [DOC: 9168247] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:42:34] ❌    ❌ Failed to push order
[22:42:34] 🔄 
🔄 Step 7: Writing to CSV...
[22:42:34] [DOC: 9168247] ℹ️  Calculated age: 75 from DOB: 07/23/1949
[22:42:34] [DOC: 9168247] ℹ️  Service Line extracted: 'HHA, MSW, RN'
[22:42:34] [DOC: 9168247] ℹ️  Payer Source extracted: 'Medicare'
[22:42:34] [DOC: 9168247] ℹ️  Diagnosis codes being written:
[22:42:34] [DOC: 9168247] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:42:34] [DOC: 9168247] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:42:34] [DOC: 9168247] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:42:34] [DOC: 9168247] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:42:34] [DOC: 9168247] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:42:34] [DOC: 9168247] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:42:34] [DOC: 9168247] ✅ Patient data written to CSV: Patricia Renzi | Sex: FEMALE | Age: 75 | Service: HHA, MSW, RN | Payer: Medicare | MRN: 5745015
[22:42:34] ✅    ✅ Document 9168247 processed and saved successfully
[22:42:34] 🔄 
🔄 Step 8: Saving API details...
[22:42:34] [DOC: 9168247] ℹ️  API push details saved for document 9168247
[22:42:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168235                         ║
================================================================================
[22:42:34] ℹ️  Agency: Fairhaven HH&H
[22:42:34] ℹ️  Date: 03/07/2025
[22:42:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:42:36] [DOC: 9168235] ✅ Text extracted using pdfplumber (1284 chars)
[22:42:36] ✅    ✅ Text extracted using pdfplumber (1284 chars)
[22:42:36] 🔄 
🔄 Step 2: Extracting patient data...
[22:42:39] ℹ️  AI extracted raw sex value: 'F'
[22:42:39] ℹ️  AI extracted service line: 'RN, MSW, HHA'
[22:42:39] ℹ️  AI extracted payer source: 'Medicare'
[22:42:39] ℹ️  AI extracted diagnoses:
[22:42:39] ℹ️    - Diagnosis 1: 'None'
[22:42:39] ℹ️    - Diagnosis 2: 'None'
[22:42:39] ℹ️    - Diagnosis 3: 'None'
[22:42:39] ℹ️    - Diagnosis 4: 'None'
[22:42:39] ℹ️    - Diagnosis 5: 'None'
[22:42:39] ℹ️    - Diagnosis 6: 'None'
[22:42:39] ℹ️  Final extracted MRN: '3156011'
[22:42:39] ℹ️  Final extracted Sex: 'FEMALE'
[22:42:39] ℹ️  Final extracted Service Line: 'RN, MSW, HHA'
[22:42:39] ℹ️  Final extracted Payer Source: 'Medicare'
[22:42:39] ✅ Patient data extraction completed successfully
[22:42:39] ✅    ✅ Patient data extracted successfully
[22:42:39] 📊 Patient Response
     └─ patientFName: Rose
     └─ patientLName: Gouveia
     └─ dob: 03/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3156011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, MSW, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:42:39] ✅    ✅ Patient identified: Rose Gouveia
[22:42:39] ✅    ✅ Patient name validation passed
[22:42:39] 🔄 
🔄 Step 3: Processing patient dates...
[22:42:39] [DOC: 9168235] ℹ️  DOB normalized: 03/06/1931
[22:42:39] [DOC: 9168235] ℹ️  Episode startOfCare normalized: 05/28/2024
[22:42:39] [DOC: 9168235] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[22:42:39] [DOC: 9168235] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[22:42:39] [DOC: 9168235] ✅ Patient date processing completed successfully
[22:42:39] ✅    ✅ Date processing completed
[22:42:39] 📊 Processed Patient Data
     └─ patientFName: Rose
     └─ patientLName: Gouveia
     └─ dob: 03/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3156011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, MSW, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025'}]
[22:42:39] 🔄 
🔄 Step 4: Extracting order data...
[22:42:41] ℹ️  Order extraction - MRN: ''
[22:42:41] ℹ️  Order extraction - Sex: 'FEMALE'
[22:42:41] ℹ️  Order extraction - Service Line: 'RN, MSW'
[22:42:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:42:41] ✅ Order data extraction completed successfully
[22:42:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:42:41] ℹ️  Using MRN from patient data: '3156011'
[22:42:41] ℹ️  Combined service lines: Patient='RN, MSW, HHA' + Order='RN, MSW' = 'HHA, MSW, RN'
[22:42:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:42:41] ✅ Patient name cross-validation successful
[22:42:41] ✅    ✅ Data merged successfully
[22:42:42] ✅    ✅ Order data extracted and validated
[22:42:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:42:42] [DOC: 9168235] ✅ Patient found in local cache: Rose Gouveia, ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[22:42:42] ✅    ✅ Existing patient found with ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[22:42:42] 🔄 
🔄 Step 6: Pushing order to API...
[22:42:42] [DOC: 9168235] ℹ️  Pushing order via API for patient ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[22:42:44] [DOC: 9168235] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13816"}
[22:42:44] ❌    ❌ Failed to push order
[22:42:44] 🔄 
🔄 Step 7: Writing to CSV...
[22:42:44] [DOC: 9168235] ℹ️  Calculated age: 94 from DOB: 03/06/1931
[22:42:44] [DOC: 9168235] ℹ️  Service Line extracted: 'HHA, MSW, RN'
[22:42:44] [DOC: 9168235] ℹ️  Payer Source extracted: 'Medicare'
[22:42:44] [DOC: 9168235] ℹ️  Diagnosis codes being written:
[22:42:44] [DOC: 9168235] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:42:44] [DOC: 9168235] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:42:44] [DOC: 9168235] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:42:44] [DOC: 9168235] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:42:44] [DOC: 9168235] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:42:44] [DOC: 9168235] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:42:44] [DOC: 9168235] ✅ Patient data written to CSV: Rose Gouveia | Sex: FEMALE | Age: 94 | Service: HHA, MSW, RN | Payer: Medicare | MRN: 3156011
[22:42:44] ✅    ✅ Document 9168235 processed and saved successfully
[22:42:44] 🔄 
🔄 Step 8: Saving API details...
[22:42:44] [DOC: 9168235] ℹ️  API push details saved for document 9168235
[22:42:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168228                         ║
================================================================================
[22:42:44] ℹ️  Agency: Fairhaven HH&H
[22:42:44] ℹ️  Date: 03/07/2025
[22:42:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:42:46] [DOC: 9168228] ✅ Text extracted using pdfplumber (1183 chars)
[22:42:46] ✅    ✅ Text extracted using pdfplumber (1183 chars)
[22:42:46] 🔄 
🔄 Step 2: Extracting patient data...
[22:42:48] ℹ️  AI extracted raw sex value: 'M'
[22:42:48] ℹ️  AI extracted service line: 'Hospice, RN, LPN'
[22:42:48] ℹ️  AI extracted payer source: 'Medicare'
[22:42:48] ℹ️  AI extracted diagnoses:
[22:42:48] ℹ️    - Diagnosis 1: ''
[22:42:48] ℹ️    - Diagnosis 2: ''
[22:42:48] ℹ️    - Diagnosis 3: ''
[22:42:48] ℹ️    - Diagnosis 4: ''
[22:42:48] ℹ️    - Diagnosis 5: ''
[22:42:48] ℹ️    - Diagnosis 6: ''
[22:42:48] ℹ️  Final extracted MRN: '3564011'
[22:42:48] ℹ️  Final extracted Sex: 'MALE'
[22:42:48] ℹ️  Final extracted Service Line: 'Hospice, RN, LPN'
[22:42:48] ℹ️  Final extracted Payer Source: 'Medicare'
[22:42:48] ✅ Patient data extraction completed successfully
[22:42:48] ✅    ✅ Patient data extracted successfully
[22:42:48] 📊 Patient Response
     └─ patientFName: Armindo
     └─ patientLName: Demelo
     └─ dob: 02/08/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 3564011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 26 Rounseville St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:42:48] ✅    ✅ Patient identified: Armindo Demelo
[22:42:48] ✅    ✅ Patient name validation passed
[22:42:48] 🔄 
🔄 Step 3: Processing patient dates...
[22:42:48] [DOC: 9168228] ℹ️  DOB normalized: 02/08/1932
[22:42:48] [DOC: 9168228] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:42:48] [DOC: 9168228] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[22:42:48] [DOC: 9168228] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[22:42:48] [DOC: 9168228] ✅ Patient date processing completed successfully
[22:42:48] ✅    ✅ Date processing completed
[22:42:48] 📊 Processed Patient Data
     └─ patientFName: Armindo
     └─ patientLName: Demelo
     └─ dob: 02/08/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 3564011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 26 Rounseville St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:42:48] 🔄 
🔄 Step 4: Extracting order data...
[22:42:51] ℹ️  Order extraction - MRN: '3564011'
[22:42:51] ℹ️  Order extraction - Sex: 'MALE'
[22:42:51] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:42:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:42:51] ✅ Order data extraction completed successfully
[22:42:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:42:51] ℹ️  Using MRN from patient data: '3564011' over '3564011'
[22:42:51] ℹ️  Combined service lines: Patient='Hospice, RN, LPN' + Order='RN, LPN' = 'Hospice, LPN, RN'
[22:42:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:42:51] ✅ Patient name cross-validation successful
[22:42:51] ✅    ✅ Data merged successfully
[22:42:52] ✅    ✅ Order data extracted and validated
[22:42:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:42:58] [DOC: 9168228] ✅ Patient exists in API: Armindo Demelo, ID: 6fda06bb-ba2c-4e12-9893-3059a8c92aed
[22:42:58] ✅    ✅ Existing patient found with ID: 6fda06bb-ba2c-4e12-9893-3059a8c92aed
[22:42:58] 🔄 
🔄 Step 6: Pushing order to API...
[22:42:58] [DOC: 9168228] ℹ️  Pushing order via API for patient ID: 6fda06bb-ba2c-4e12-9893-3059a8c92aed
[22:42:59] [DOC: 9168228] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:42:59] ❌    ❌ Failed to push order
[22:42:59] 🔄 
🔄 Step 7: Writing to CSV...
[22:42:59] [DOC: 9168228] ℹ️  Calculated age: 93 from DOB: 02/08/1932
[22:42:59] [DOC: 9168228] ℹ️  Service Line extracted: 'Hospice, LPN, RN'
[22:42:59] [DOC: 9168228] ℹ️  Payer Source extracted: 'Medicare'
[22:42:59] [DOC: 9168228] ℹ️  Diagnosis codes being written:
[22:42:59] [DOC: 9168228] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:42:59] [DOC: 9168228] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:42:59] [DOC: 9168228] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:42:59] [DOC: 9168228] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:42:59] [DOC: 9168228] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:42:59] [DOC: 9168228] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:42:59] [DOC: 9168228] ✅ Patient data written to CSV: Armindo Demelo | Sex: MALE | Age: 93 | Service: Hospice, LPN, RN | Payer: Medicare | MRN: 3564011
[22:42:59] ✅    ✅ Document 9168228 processed and saved successfully
[22:42:59] 🔄 
🔄 Step 8: Saving API details...
[22:42:59] [DOC: 9168228] ℹ️  API push details saved for document 9168228
[22:42:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168216                         ║
================================================================================
[22:42:59] ℹ️  Agency: Dartmouth HH
[22:42:59] ℹ️  Date: 03/07/2025
[22:42:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:43:01] [DOC: 9168216] ✅ Text extracted using pdfplumber (3949 chars)
[22:43:01] ✅    ✅ Text extracted using pdfplumber (3949 chars)
[22:43:01] 🔄 
🔄 Step 2: Extracting patient data...
[22:43:04] ℹ️  AI extracted raw sex value: 'F'
[22:43:04] ℹ️  AI extracted service line: 'PT'
[22:43:04] ℹ️  AI extracted payer source: 'Medicare'
[22:43:04] ℹ️  AI extracted diagnoses:
[22:43:04] ℹ️    - Diagnosis 1: ''
[22:43:04] ℹ️    - Diagnosis 2: ''
[22:43:04] ℹ️    - Diagnosis 3: ''
[22:43:04] ℹ️    - Diagnosis 4: ''
[22:43:04] ℹ️    - Diagnosis 5: ''
[22:43:04] ℹ️    - Diagnosis 6: ''
[22:43:04] ℹ️  Final extracted MRN: '6469009'
[22:43:04] ℹ️  Final extracted Sex: 'FEMALE'
[22:43:04] ℹ️  Final extracted Service Line: 'PT'
[22:43:04] ℹ️  Final extracted Payer Source: 'Medicare'
[22:43:04] ✅ Patient data extraction completed successfully
[22:43:04] ✅    ✅ Patient data extracted successfully
[22:43:04] 📊 Patient Response
     └─ patientFName: Arlene
     └─ patientLName: Todd
     └─ dob: 04/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6469009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/06/2025', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:43:04] ✅    ✅ Patient identified: Arlene Todd
[22:43:04] ✅    ✅ Patient name validation passed
[22:43:04] 🔄 
🔄 Step 3: Processing patient dates...
[22:43:04] [DOC: 9168216] ℹ️  DOB normalized: 04/08/1941
[22:43:04] [DOC: 9168216] ℹ️  Episode startOfCare normalized: 02/06/2025
[22:43:04] [DOC: 9168216] ℹ️  Episode startOfEpisode normalized: 02/06/2025
[22:43:04] [DOC: 9168216] ℹ️  Episode endOfEpisode normalized: 04/06/2025
[22:43:04] [DOC: 9168216] ✅ Patient date processing completed successfully
[22:43:04] ✅    ✅ Date processing completed
[22:43:04] 📊 Processed Patient Data
     └─ patientFName: Arlene
     └─ patientLName: Todd
     └─ dob: 04/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6469009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/06/2025', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:43:04] 🔄 
🔄 Step 4: Extracting order data...
[22:43:06] ℹ️  Order extraction - MRN: '6469009'
[22:43:06] ℹ️  Order extraction - Sex: 'FEMALE'
[22:43:06] ℹ️  Order extraction - Service Line: 'PT'
[22:43:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:43:06] ✅ Order data extraction completed successfully
[22:43:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:43:06] ℹ️  Using MRN from patient data: '6469009' over '6469009'
[22:43:06] ℹ️  Service line consistent in both sources: 'PT'
[22:43:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:43:06] ✅ Patient name cross-validation successful
[22:43:06] ✅    ✅ Data merged successfully
[22:43:08] ✅    ✅ Order data extracted and validated
[22:43:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:43:14] [DOC: 9168216] ✅ Patient exists in API: Arlene Todd, ID: f91ce87d-4289-483c-a1a6-0abcc98cc571
[22:43:14] ✅    ✅ Existing patient found with ID: f91ce87d-4289-483c-a1a6-0abcc98cc571
[22:43:14] 🔄 
🔄 Step 6: Pushing order to API...
[22:43:14] [DOC: 9168216] ℹ️  Pushing order via API for patient ID: f91ce87d-4289-483c-a1a6-0abcc98cc571
[22:43:15] [DOC: 9168216] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:43:15] ❌    ❌ Failed to push order
[22:43:15] 🔄 
🔄 Step 7: Writing to CSV...
[22:43:15] [DOC: 9168216] ℹ️  Calculated age: 84 from DOB: 04/08/1941
[22:43:15] [DOC: 9168216] ℹ️  Service Line extracted: 'PT'
[22:43:15] [DOC: 9168216] ℹ️  Payer Source extracted: 'Medicare'
[22:43:15] [DOC: 9168216] ℹ️  Diagnosis codes being written:
[22:43:15] [DOC: 9168216] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:43:15] [DOC: 9168216] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:43:15] [DOC: 9168216] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:43:15] [DOC: 9168216] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:43:15] [DOC: 9168216] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:43:15] [DOC: 9168216] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:43:15] [DOC: 9168216] ✅ Patient data written to CSV: Arlene Todd | Sex: FEMALE | Age: 84 | Service: PT | Payer: Medicare | MRN: 6469009
[22:43:15] ✅    ✅ Document 9168216 processed and saved successfully
[22:43:15] 🔄 
🔄 Step 8: Saving API details...
[22:43:15] [DOC: 9168216] ℹ️  API push details saved for document 9168216
[22:43:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168214                         ║
================================================================================
[22:43:15] ℹ️  Agency: Dartmouth HH
[22:43:15] ℹ️  Date: 03/07/2025
[22:43:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:43:18] [DOC: 9168214] ✅ Text extracted using pdfplumber (4067 chars)
[22:43:18] ✅    ✅ Text extracted using pdfplumber (4067 chars)
[22:43:18] 🔄 
🔄 Step 2: Extracting patient data...
[22:43:20] ℹ️  AI extracted raw sex value: 'F'
[22:43:20] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[22:43:20] ℹ️  AI extracted payer source: 'Medicare'
[22:43:20] ℹ️  AI extracted diagnoses:
[22:43:20] ℹ️    - Diagnosis 1: ''
[22:43:20] ℹ️    - Diagnosis 2: ''
[22:43:20] ℹ️    - Diagnosis 3: ''
[22:43:20] ℹ️    - Diagnosis 4: ''
[22:43:20] ℹ️    - Diagnosis 5: ''
[22:43:20] ℹ️    - Diagnosis 6: ''
[22:43:20] ℹ️  Final extracted MRN: '6448011'
[22:43:20] ℹ️  Final extracted Sex: 'FEMALE'
[22:43:20] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[22:43:20] ℹ️  Final extracted Payer Source: 'Medicare'
[22:43:20] ✅ Patient data extraction completed successfully
[22:43:20] ✅    ✅ Patient data extracted successfully
[22:43:20] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '03/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:43:20] ✅    ✅ Patient identified: Kim Teixeira
[22:43:20] ✅    ✅ Patient name validation passed
[22:43:20] 🔄 
🔄 Step 3: Processing patient dates...
[22:43:20] [DOC: 9168214] ℹ️  DOB normalized: 02/28/1964
[22:43:20] [DOC: 9168214] ℹ️  Episode startOfCare normalized: 01/18/2025
[22:43:20] [DOC: 9168214] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:43:20] [DOC: 9168214] ℹ️  Episode endOfEpisode normalized: 03/18/2025
[22:43:20] [DOC: 9168214] ✅ Patient date processing completed successfully
[22:43:20] ✅    ✅ Date processing completed
[22:43:20] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '03/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:43:20] 🔄 
🔄 Step 4: Extracting order data...
[22:43:23] ℹ️  Order extraction - MRN: '6448011'
[22:43:23] ℹ️  Order extraction - Sex: 'FEMALE'
[22:43:23] ℹ️  Order extraction - Service Line: 'PT, RN, LPN'
[22:43:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:43:23] ✅ Order data extraction completed successfully
[22:43:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:43:23] ℹ️  Using MRN from patient data: '6448011' over '6448011'
[22:43:23] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT, RN, LPN' = 'LPN, PT, Physical Therapy, RN, Skilled Nursing'
[22:43:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:43:23] ✅ Patient name cross-validation successful
[22:43:23] ✅    ✅ Data merged successfully
[22:43:24] ✅    ✅ Order data extracted and validated
[22:43:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:43:24] [DOC: 9168214] ✅ Patient found in local cache: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[22:43:24] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[22:43:24] 🔄 
🔄 Step 6: Pushing order to API...
[22:43:24] [DOC: 9168214] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[22:43:25] [DOC: 9168214] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:43:25] ❌    ❌ Failed to push order
[22:43:25] 🔄 
🔄 Step 7: Writing to CSV...
[22:43:25] [DOC: 9168214] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[22:43:25] [DOC: 9168214] ℹ️  Service Line extracted: 'LPN, PT, Physical Therapy, RN, Skilled Nursing'
[22:43:25] [DOC: 9168214] ℹ️  Payer Source extracted: 'Medicare'
[22:43:25] [DOC: 9168214] ℹ️  Diagnosis codes being written:
[22:43:25] [DOC: 9168214] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:43:25] [DOC: 9168214] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:43:25] [DOC: 9168214] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:43:25] [DOC: 9168214] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:43:25] [DOC: 9168214] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:43:25] [DOC: 9168214] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:43:25] [DOC: 9168214] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: LPN, PT, Physical Therapy, RN, Skilled Nursing | Payer: Medicare | MRN: 6448011
[22:43:25] ✅    ✅ Document 9168214 processed and saved successfully
[22:43:25] 🔄 
🔄 Step 8: Saving API details...
[22:43:25] [DOC: 9168214] ℹ️  API push details saved for document 9168214
[22:43:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168211                         ║
================================================================================
[22:43:25] ℹ️  Agency: Dartmouth HH
[22:43:25] ℹ️  Date: 03/07/2025
[22:43:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:43:28] [DOC: 9168211] ✅ Text extracted using pdfplumber (4256 chars)
[22:43:28] ✅    ✅ Text extracted using pdfplumber (4256 chars)
[22:43:28] 🔄 
🔄 Step 2: Extracting patient data...
[22:43:31] ℹ️  AI extracted raw sex value: 'F'
[22:43:31] ℹ️  AI extracted service line: 'OT'
[22:43:31] ℹ️  AI extracted payer source: 'Medicare'
[22:43:31] ℹ️  AI extracted diagnoses:
[22:43:31] ℹ️    - Diagnosis 1: 'Dressler's Syndrome'
[22:43:31] ℹ️    - Diagnosis 2: 'Myocardial Infarction'
[22:43:31] ℹ️    - Diagnosis 3: 'Diastolic HF'
[22:43:31] ℹ️    - Diagnosis 4: 'HTN'
[22:43:31] ℹ️    - Diagnosis 5: ''
[22:43:31] ℹ️    - Diagnosis 6: ''
[22:43:31] ℹ️  Final extracted MRN: '6045015'
[22:43:31] ℹ️  Final extracted Sex: 'FEMALE'
[22:43:31] ℹ️  Final extracted Service Line: 'OT'
[22:43:31] ℹ️  Final extracted Payer Source: 'Medicare'
[22:43:31] ✅ Patient data extraction completed successfully
[22:43:31] ✅    ✅ Patient data extracted successfully
[22:43:31] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6045015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/15/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': "Dressler's Syndrome", 'secondDiagnosis': 'Myocardial Infarction', 'thirdDiagnosis': 'Diastolic HF', 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:43:31] ✅    ✅ Patient identified: Bonnie Desrochers
[22:43:31] ✅    ✅ Patient name validation passed
[22:43:31] 🔄 
🔄 Step 3: Processing patient dates...
[22:43:31] [DOC: 9168211] ℹ️  DOB normalized: 08/14/1951
[22:43:31] [DOC: 9168211] ℹ️  Episode startOfCare normalized: 02/15/2025
[22:43:31] [DOC: 9168211] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[22:43:31] [DOC: 9168211] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[22:43:31] [DOC: 9168211] ✅ Patient date processing completed successfully
[22:43:31] ✅    ✅ Date processing completed
[22:43:31] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6045015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/15/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': "Dressler's Syndrome", 'secondDiagnosis': 'Myocardial Infarction', 'thirdDiagnosis': 'Diastolic HF', 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:43:31] 🔄 
🔄 Step 4: Extracting order data...
[22:43:33] ℹ️  Order extraction - MRN: '6045015'
[22:43:33] ℹ️  Order extraction - Sex: 'FEMALE'
[22:43:33] ℹ️  Order extraction - Service Line: 'OT'
[22:43:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:43:33] ✅ Order data extraction completed successfully
[22:43:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:43:33] ℹ️  Using MRN from patient data: '6045015' over '6045015'
[22:43:33] ℹ️  Service line consistent in both sources: 'OT'
[22:43:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:43:33] ✅ Patient name cross-validation successful
[22:43:33] ✅    ✅ Data merged successfully
[22:43:34] ✅    ✅ Order data extracted and validated
[22:43:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:43:40] [DOC: 9168211] ℹ️  Patient not found in cache or API: Bonnie Desrochers
[22:43:40] [DOC: 9168211] ℹ️  Patient not found, creating new patient via API...
[22:43:40] [DOC: 9168211] ℹ️  Creating patient via API: Bonnie Desrochers
[22:43:41] [DOC: 9168211] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:43:41] ❌    ❌ Failed to create patient
[22:43:41] [DOC: 9168211] ℹ️  API push details saved for document 9168211
================================================================================
║                        Processing Document ID: 9168207                         ║
================================================================================
[22:43:41] ℹ️  Agency: Dartmouth HH
[22:43:41] ℹ️  Date: 03/07/2025
[22:43:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:43:46] [DOC: 9168207] ✅ Text extracted using pdfplumber (19565 chars)
[22:43:46] ✅    ✅ Text extracted using pdfplumber (19553 chars)
[22:43:46] 🔄 
🔄 Step 2: Extracting patient data...
[22:43:49] ℹ️  AI extracted raw sex value: 'F'
[22:43:49] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[22:43:49] ℹ️  AI extracted payer source: ''
[22:43:49] ℹ️  AI extracted diagnoses:
[22:43:49] ℹ️    - Diagnosis 1: 'S51.811D'
[22:43:49] ℹ️    - Diagnosis 2: 'I25.10'
[22:43:49] ℹ️    - Diagnosis 3: 'M25.562'
[22:43:49] ℹ️    - Diagnosis 4: 'M25.561'
[22:43:49] ℹ️    - Diagnosis 5: 'E04.2'
[22:43:49] ℹ️    - Diagnosis 6: 'I10'
[22:43:49] ℹ️  Final extracted MRN: '502008'
[22:43:49] ℹ️  Final extracted Sex: 'FEMALE'
[22:43:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[22:43:49] ℹ️  Final extracted Payer Source: ''
[22:43:49] ✅ Patient data extraction completed successfully
[22:43:49] ✅    ✅ Patient data extracted successfully
[22:43:49] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Mitchell
     └─ dob: 06/30/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 502008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/07/2024', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': 'S51.811D', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'M25.561', 'fifthDiagnosis': 'E04.2', 'sixthDiagnosis': 'I10'}]
[22:43:49] ✅    ✅ Patient identified: Mary Mitchell
[22:43:49] ✅    ✅ Patient name validation passed
[22:43:49] 🔄 
🔄 Step 3: Processing patient dates...
[22:43:49] [DOC: 9168207] ℹ️  DOB normalized: 06/30/1948
[22:43:49] [DOC: 9168207] ℹ️  Episode startOfCare normalized: 09/07/2024
[22:43:49] [DOC: 9168207] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[22:43:49] [DOC: 9168207] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[22:43:49] [DOC: 9168207] ✅ Patient date processing completed successfully
[22:43:49] ✅    ✅ Date processing completed
[22:43:49] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Mitchell
     └─ dob: 06/30/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 502008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/07/2024', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': 'S51.811D', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'M25.561', 'fifthDiagnosis': 'E04.2', 'sixthDiagnosis': 'I10'}]
[22:43:49] 🔄 
🔄 Step 4: Extracting order data...
[22:43:51] ℹ️  Order extraction - MRN: '502008'
[22:43:51] ℹ️  Order extraction - Sex: 'FEMALE'
[22:43:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[22:43:51] ℹ️  Order extraction - Payer Source: ''
[22:43:51] ✅ Order data extraction completed successfully
[22:43:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:43:51] ℹ️  Using MRN from patient data: '502008' over '502008'
[22:43:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[22:43:51] ✅ Patient name cross-validation successful
[22:43:51] ✅    ✅ Data merged successfully
[22:43:53] ✅    ✅ Order data extracted and validated
[22:43:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:43:59] [DOC: 9168207] ℹ️  Patient not found in cache or API: Mary Mitchell
[22:43:59] [DOC: 9168207] ℹ️  Patient not found, creating new patient via API...
[22:43:59] [DOC: 9168207] ℹ️  Creating patient via API: Mary Mitchell
[22:44:00] [DOC: 9168207] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:44:00] ❌    ❌ Failed to create patient
[22:44:00] [DOC: 9168207] ℹ️  API push details saved for document 9168207
================================================================================
║                        Processing Document ID: 9168202                         ║
================================================================================
[22:44:00] ℹ️  Agency: Dartmouth HH
[22:44:00] ℹ️  Date: 03/07/2025
[22:44:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:44:02] [DOC: 9168202] ✅ Text extracted using pdfplumber (1144 chars)
[22:44:02] ✅    ✅ Text extracted using pdfplumber (1144 chars)
[22:44:02] 🔄 
🔄 Step 2: Extracting patient data...
[22:44:04] ℹ️  AI extracted raw sex value: 'F'
[22:44:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:44:04] ℹ️  AI extracted payer source: 'Medicare'
[22:44:04] ℹ️  AI extracted diagnoses:
[22:44:04] ℹ️    - Diagnosis 1: ''
[22:44:04] ℹ️    - Diagnosis 2: ''
[22:44:04] ℹ️    - Diagnosis 3: ''
[22:44:04] ℹ️    - Diagnosis 4: ''
[22:44:04] ℹ️    - Diagnosis 5: ''
[22:44:04] ℹ️    - Diagnosis 6: ''
[22:44:04] ℹ️  Final extracted MRN: '4367015'
[22:44:04] ℹ️  Final extracted Sex: 'FEMALE'
[22:44:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:44:04] ℹ️  Final extracted Payer Source: 'Medicare'
[22:44:04] ✅ Patient data extraction completed successfully
[22:44:04] ✅    ✅ Patient data extracted successfully
[22:44:04] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Sturtevant
     └─ dob: 02/05/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4367015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/23/2025', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:44:04] ✅    ✅ Patient identified: Linda Sturtevant
[22:44:04] ✅    ✅ Patient name validation passed
[22:44:04] 🔄 
🔄 Step 3: Processing patient dates...
[22:44:04] [DOC: 9168202] ℹ️  DOB normalized: 02/05/1947
[22:44:04] [DOC: 9168202] ℹ️  Episode startOfCare normalized: 01/23/2025
[22:44:04] [DOC: 9168202] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[22:44:04] [DOC: 9168202] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[22:44:04] [DOC: 9168202] ✅ Patient date processing completed successfully
[22:44:04] ✅    ✅ Date processing completed
[22:44:04] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Sturtevant
     └─ dob: 02/05/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4367015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/23/2025', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:44:04] 🔄 
🔄 Step 4: Extracting order data...
[22:44:07] ℹ️  Order extraction - MRN: ''
[22:44:07] ℹ️  Order extraction - Sex: 'FEMALE'
[22:44:07] ℹ️  Order extraction - Service Line: 'RN'
[22:44:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:44:07] ✅ Order data extraction completed successfully
[22:44:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:44:07] ℹ️  Using MRN from patient data: '4367015'
[22:44:07] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[22:44:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:44:07] ✅ Patient name cross-validation successful
[22:44:07] ✅    ✅ Data merged successfully
[22:44:08] ✅    ✅ Order data extracted and validated
[22:44:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:44:16] [DOC: 9168202] ✅ Patient exists in API: Linda Sturtevant, ID: 8ee9c354-3dd0-4581-807d-d454fbf032a2
[22:44:16] ✅    ✅ Existing patient found with ID: 8ee9c354-3dd0-4581-807d-d454fbf032a2
[22:44:16] 🔄 
🔄 Step 6: Pushing order to API...
[22:44:16] [DOC: 9168202] ℹ️  Pushing order via API for patient ID: 8ee9c354-3dd0-4581-807d-d454fbf032a2
[22:44:18] [DOC: 9168202] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14219"}
[22:44:18] ❌    ❌ Failed to push order
[22:44:18] 🔄 
🔄 Step 7: Writing to CSV...
[22:44:18] [DOC: 9168202] ℹ️  Calculated age: 78 from DOB: 02/05/1947
[22:44:18] [DOC: 9168202] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[22:44:18] [DOC: 9168202] ℹ️  Payer Source extracted: 'Medicare'
[22:44:18] [DOC: 9168202] ℹ️  Diagnosis codes being written:
[22:44:18] [DOC: 9168202] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:44:18] [DOC: 9168202] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:44:18] [DOC: 9168202] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:44:18] [DOC: 9168202] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:44:18] [DOC: 9168202] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:44:18] [DOC: 9168202] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:44:18] [DOC: 9168202] ✅ Patient data written to CSV: Linda Sturtevant | Sex: FEMALE | Age: 78 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 4367015
[22:44:18] ✅    ✅ Document 9168202 processed and saved successfully
[22:44:18] 🔄 
🔄 Step 8: Saving API details...
[22:44:18] [DOC: 9168202] ℹ️  API push details saved for document 9168202
[22:44:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168199                         ║
================================================================================
[22:44:18] ℹ️  Agency: Dartmouth HH
[22:44:18] ℹ️  Date: 03/07/2025
[22:44:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:44:20] [DOC: 9168199] ✅ Text extracted using pdfplumber (1503 chars)
[22:44:20] ✅    ✅ Text extracted using pdfplumber (1503 chars)
[22:44:20] 🔄 
🔄 Step 2: Extracting patient data...
[22:44:23] ℹ️  AI extracted raw sex value: 'F'
[22:44:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:44:23] ℹ️  AI extracted payer source: 'Medicare'
[22:44:23] ℹ️  AI extracted diagnoses:
[22:44:23] ℹ️    - Diagnosis 1: ''
[22:44:23] ℹ️    - Diagnosis 2: ''
[22:44:23] ℹ️    - Diagnosis 3: ''
[22:44:23] ℹ️    - Diagnosis 4: ''
[22:44:23] ℹ️    - Diagnosis 5: ''
[22:44:23] ℹ️    - Diagnosis 6: ''
[22:44:23] ℹ️  Final extracted MRN: '502008'
[22:44:23] ℹ️  Final extracted Sex: 'FEMALE'
[22:44:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:44:23] ℹ️  Final extracted Payer Source: 'Medicare'
[22:44:23] ✅ Patient data extraction completed successfully
[22:44:23] ✅    ✅ Patient data extracted successfully
[22:44:23] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Mitchell
     └─ dob: 06/30/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 502008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/07/2024', 'startOfEpisode': '01/05/2025', 'endOfEpisode': '03/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:44:23] ✅    ✅ Patient identified: Mary Mitchell
[22:44:23] ✅    ✅ Patient name validation passed
[22:44:23] 🔄 
🔄 Step 3: Processing patient dates...
[22:44:23] [DOC: 9168199] ℹ️  DOB normalized: 06/30/1948
[22:44:23] [DOC: 9168199] ℹ️  Episode startOfCare normalized: 09/07/2024
[22:44:23] [DOC: 9168199] ℹ️  Episode startOfEpisode normalized: 01/05/2025
[22:44:23] [DOC: 9168199] ℹ️  Episode endOfEpisode normalized: 03/05/2025
[22:44:23] [DOC: 9168199] ✅ Patient date processing completed successfully
[22:44:23] ✅    ✅ Date processing completed
[22:44:23] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Mitchell
     └─ dob: 06/30/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 502008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/07/2024', 'startOfEpisode': '01/05/2025', 'endOfEpisode': '03/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:44:23] 🔄 
🔄 Step 4: Extracting order data...
[22:44:25] ℹ️  Order extraction - MRN: ''
[22:44:25] ℹ️  Order extraction - Sex: 'FEMALE'
[22:44:25] ℹ️  Order extraction - Service Line: 'RN'
[22:44:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:44:25] ✅ Order data extraction completed successfully
[22:44:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:44:25] ℹ️  Using MRN from patient data: '502008'
[22:44:25] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[22:44:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:44:25] ✅ Patient name cross-validation successful
[22:44:25] ✅    ✅ Data merged successfully
[22:44:26] ✅    ✅ Order data extracted and validated
[22:44:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:44:34] [DOC: 9168199] ℹ️  Patient not found in cache or API: Mary Mitchell
[22:44:34] [DOC: 9168199] ℹ️  Patient not found, creating new patient via API...
[22:44:34] [DOC: 9168199] ℹ️  Creating patient via API: Mary Mitchell
[22:44:35] [DOC: 9168199] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:44:35] ❌    ❌ Failed to create patient
[22:44:35] [DOC: 9168199] ℹ️  API push details saved for document 9168199
================================================================================
║                        Processing Document ID: 9168194                         ║
================================================================================
[22:44:35] ℹ️  Agency: Dartmouth HH
[22:44:35] ℹ️  Date: 03/07/2025
[22:44:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:44:38] [DOC: 9168194] ✅ Text extracted using pdfplumber (10588 chars)
[22:44:38] ✅    ✅ Text extracted using pdfplumber (10576 chars)
[22:44:38] 🔄 
🔄 Step 2: Extracting patient data...
[22:44:41] ℹ️  AI extracted raw sex value: 'F'
[22:44:41] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[22:44:41] ℹ️  AI extracted payer source: 'None'
[22:44:41] ℹ️  AI extracted diagnoses:
[22:44:41] ℹ️    - Diagnosis 1: 'L89.890'
[22:44:41] ℹ️    - Diagnosis 2: 'F41.1'
[22:44:41] ℹ️    - Diagnosis 3: 'I11.0'
[22:44:41] ℹ️    - Diagnosis 4: 'I50.31'
[22:44:41] ℹ️    - Diagnosis 5: 'G89.29'
[22:44:41] ℹ️    - Diagnosis 6: 'M47.16'
[22:44:41] ℹ️  Final extracted MRN: '378001'
[22:44:41] ℹ️  Final extracted Sex: 'FEMALE'
[22:44:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[22:44:41] ℹ️  Final extracted Payer Source: ''
[22:44:41] ✅ Patient data extraction completed successfully
[22:44:41] ✅    ✅ Patient data extracted successfully
[22:44:41] 📊 Patient Response
     └─ patientFName: Judith K
     └─ patientLName: Drinkwater
     └─ dob: 05/10/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 378001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'L89.890', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.31', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M47.16'}]
[22:44:41] ✅    ✅ Patient identified: Judith K Drinkwater
[22:44:41] ✅    ✅ Patient name validation passed
[22:44:41] 🔄 
🔄 Step 3: Processing patient dates...
[22:44:41] [DOC: 9168194] ℹ️  DOB normalized: 05/10/1948
[22:44:41] [DOC: 9168194] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[22:44:41] [DOC: 9168194] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[22:44:41] [DOC: 9168194] ✅ Patient date processing completed successfully
[22:44:41] ✅    ✅ Date processing completed
[22:44:41] 📊 Processed Patient Data
     └─ patientFName: Judith K
     └─ patientLName: Drinkwater
     └─ dob: 05/10/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 378001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'L89.890', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.31', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M47.16'}]
[22:44:41] 🔄 
🔄 Step 4: Extracting order data...
[22:44:44] ℹ️  Order extraction - MRN: '378001'
[22:44:44] ℹ️  Order extraction - Sex: 'FEMALE'
[22:44:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[22:44:44] ℹ️  Order extraction - Payer Source: ''
[22:44:44] ✅ Order data extraction completed successfully
[22:44:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:44:44] ℹ️  Using MRN from patient data: '378001' over '378001'
[22:44:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[22:44:44] ✅ Patient name cross-validation successful
[22:44:44] ✅    ✅ Data merged successfully
[22:44:45] ✅    ✅ Order data extracted and validated
[22:44:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:45:03] [DOC: 9168194] ℹ️  Patient not found in cache or API: Judith K Drinkwater
[22:45:03] [DOC: 9168194] ℹ️  Patient not found, creating new patient via API...
[22:45:03] [DOC: 9168194] ℹ️  Creating patient via API: Judith K Drinkwater
[22:45:04] [DOC: 9168194] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:45:04] ❌    ❌ Failed to create patient
[22:45:04] [DOC: 9168194] ℹ️  API push details saved for document 9168194
================================================================================
║                        Processing Document ID: 9168190                         ║
================================================================================
[22:45:04] ℹ️  Agency: Dartmouth HH
[22:45:04] ℹ️  Date: 03/07/2025
[22:45:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:45:07] [DOC: 9168190] ✅ Text extracted using pdfplumber (15399 chars)
[22:45:07] ✅    ✅ Text extracted using pdfplumber (15399 chars)
[22:45:07] 🔄 
🔄 Step 2: Extracting patient data...
[22:45:10] ℹ️  AI extracted raw sex value: 'F'
[22:45:10] ℹ️  AI extracted service line: 'OT, PT, SN'
[22:45:10] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[22:45:10] ℹ️  AI extracted diagnoses:
[22:45:10] ℹ️    - Diagnosis 1: ''
[22:45:10] ℹ️    - Diagnosis 2: ''
[22:45:10] ℹ️    - Diagnosis 3: ''
[22:45:10] ℹ️    - Diagnosis 4: ''
[22:45:10] ℹ️    - Diagnosis 5: ''
[22:45:10] ℹ️    - Diagnosis 6: ''
[22:45:10] ℹ️  Final extracted MRN: '1992015'
[22:45:10] ℹ️  Final extracted Sex: 'FEMALE'
[22:45:10] ℹ️  Final extracted Service Line: 'OT, PT, SN'
[22:45:10] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[22:45:10] ✅ Patient data extraction completed successfully
[22:45:10] ✅    ✅ Patient data extracted successfully
[22:45:10] 📊 Patient Response
     └─ patientFName: Urgelia
     └─ patientLName: Batista
     └─ dob: 12/11/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1992015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT, SN
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:45:10] ✅    ✅ Patient identified: Urgelia Batista
[22:45:10] ✅    ✅ Patient name validation passed
[22:45:10] 🔄 
🔄 Step 3: Processing patient dates...
[22:45:10] [DOC: 9168190] ℹ️  DOB normalized: 12/11/1933
[22:45:10] [DOC: 9168190] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:45:10] [DOC: 9168190] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[22:45:10] [DOC: 9168190] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[22:45:10] [DOC: 9168190] ✅ Patient date processing completed successfully
[22:45:10] ✅    ✅ Date processing completed
[22:45:10] 📊 Processed Patient Data
     └─ patientFName: Urgelia
     └─ patientLName: Batista
     └─ dob: 12/11/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1992015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT, SN
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:45:10] 🔄 
🔄 Step 4: Extracting order data...
[22:45:13] ℹ️  Order extraction - MRN: '1992015'
[22:45:13] ℹ️  Order extraction - Sex: 'FEMALE'
[22:45:13] ℹ️  Order extraction - Service Line: 'OT, PT, SN'
[22:45:13] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[22:45:13] ✅ Order data extraction completed successfully
[22:45:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:45:13] ℹ️  Using MRN from patient data: '1992015' over '1992015'
[22:45:13] ℹ️  Service line consistent in both sources: 'OT, PT, SN'
[22:45:13] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[22:45:13] ✅ Patient name cross-validation successful
[22:45:13] ✅    ✅ Data merged successfully
[22:45:14] ✅    ✅ Order data extracted and validated
[22:45:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:45:22] [DOC: 9168190] ✅ Patient exists in API: Urgelia Batista, ID: 0a08590d-6fc7-40b6-859c-d905879d06fa
[22:45:22] ✅    ✅ Existing patient found with ID: 0a08590d-6fc7-40b6-859c-d905879d06fa
[22:45:22] 🔄 
🔄 Step 6: Pushing order to API...
[22:45:22] [DOC: 9168190] ℹ️  Pushing order via API for patient ID: 0a08590d-6fc7-40b6-859c-d905879d06fa
[22:45:24] [DOC: 9168190] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:45:24] ❌    ❌ Failed to push order
[22:45:24] 🔄 
🔄 Step 7: Writing to CSV...
[22:45:24] [DOC: 9168190] ℹ️  Calculated age: 91 from DOB: 12/11/1933
[22:45:24] [DOC: 9168190] ℹ️  Service Line extracted: 'OT, PT, SN'
[22:45:24] [DOC: 9168190] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[22:45:24] [DOC: 9168190] ℹ️  Diagnosis codes being written:
[22:45:24] [DOC: 9168190] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:45:24] [DOC: 9168190] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:45:24] [DOC: 9168190] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:45:24] [DOC: 9168190] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:45:24] [DOC: 9168190] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:45:24] [DOC: 9168190] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:45:24] [DOC: 9168190] ✅ Patient data written to CSV: Urgelia Batista | Sex: FEMALE | Age: 91 | Service: OT, PT, SN | Payer: Tufts Health Plan Senior Care Options | MRN: 1992015
[22:45:24] ✅    ✅ Document 9168190 processed and saved successfully
[22:45:24] 🔄 
🔄 Step 8: Saving API details...
[22:45:24] [DOC: 9168190] ℹ️  API push details saved for document 9168190
[22:45:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168183                         ║
================================================================================
[22:45:24] ℹ️  Agency: Dartmouth HH
[22:45:24] ℹ️  Date: 03/07/2025
[22:45:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:45:33] [DOC: 9168183] ✅ Text extracted using pdfplumber (14399 chars)
[22:45:33] ✅    ✅ Text extracted using pdfplumber (14399 chars)
[22:45:33] 🔄 
🔄 Step 2: Extracting patient data...
[22:45:36] ℹ️  AI extracted raw sex value: 'F'
[22:45:36] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, HHA'
[22:45:36] ℹ️  AI extracted payer source: ''
[22:45:36] ℹ️  AI extracted diagnoses:
[22:45:36] ℹ️    - Diagnosis 1: 'I69.312'
[22:45:36] ℹ️    - Diagnosis 2: 'I69.311'
[22:45:36] ℹ️    - Diagnosis 3: 'I69.315'
[22:45:36] ℹ️    - Diagnosis 4: 'I69.334'
[22:45:36] ℹ️    - Diagnosis 5: 'I12.9'
[22:45:36] ℹ️    - Diagnosis 6: 'E11.22'
[22:45:36] ℹ️  Final extracted MRN: '1992015'
[22:45:36] ℹ️  Final extracted Sex: 'FEMALE'
[22:45:36] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, HHA'
[22:45:36] ℹ️  Final extracted Payer Source: ''
[22:45:36] ✅ Patient data extraction completed successfully
[22:45:36] ✅    ✅ Patient data extracted successfully
[22:45:36] 📊 Patient Response
     └─ patientFName: Urgelia
     └─ patientLName: Batista
     └─ dob: 12/11/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1992015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'I69.312', 'secondDiagnosis': 'I69.311', 'thirdDiagnosis': 'I69.315', 'fourthDiagnosis': 'I69.334', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'E11.22'}]
[22:45:36] ✅    ✅ Patient identified: Urgelia Batista
[22:45:36] ✅    ✅ Patient name validation passed
[22:45:36] 🔄 
🔄 Step 3: Processing patient dates...
[22:45:36] [DOC: 9168183] ℹ️  DOB normalized: 12/11/1933
[22:45:36] [DOC: 9168183] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:45:36] [DOC: 9168183] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[22:45:36] [DOC: 9168183] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[22:45:36] [DOC: 9168183] ✅ Patient date processing completed successfully
[22:45:36] ✅    ✅ Date processing completed
[22:45:36] 📊 Processed Patient Data
     └─ patientFName: Urgelia
     └─ patientLName: Batista
     └─ dob: 12/11/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1992015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'I69.312', 'secondDiagnosis': 'I69.311', 'thirdDiagnosis': 'I69.315', 'fourthDiagnosis': 'I69.334', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'E11.22'}]
[22:45:36] 🔄 
🔄 Step 4: Extracting order data...
[22:45:39] ℹ️  Order extraction - MRN: '1992015'
[22:45:39] ℹ️  Order extraction - Sex: 'FEMALE'
[22:45:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT, HHA'
[22:45:39] ℹ️  Order extraction - Payer Source: ''
[22:45:39] ✅ Order data extraction completed successfully
[22:45:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:45:39] ℹ️  Using MRN from patient data: '1992015' over '1992015'
[22:45:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT, HHA'
[22:45:39] ✅ Patient name cross-validation successful
[22:45:39] ✅    ✅ Data merged successfully
[22:45:40] ✅    ✅ Order data extracted and validated
[22:45:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:45:40] [DOC: 9168183] ✅ Patient found in local cache: Urgelia Batista, ID: 0a08590d-6fc7-40b6-859c-d905879d06fa
[22:45:40] ✅    ✅ Existing patient found with ID: 0a08590d-6fc7-40b6-859c-d905879d06fa
[22:45:40] 🔄 
🔄 Step 6: Pushing order to API...
[22:45:40] [DOC: 9168183] ℹ️  Pushing order via API for patient ID: 0a08590d-6fc7-40b6-859c-d905879d06fa
[22:45:41] [DOC: 9168183] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:45:41] ❌    ❌ Failed to push order
[22:45:41] 🔄 
🔄 Step 7: Writing to CSV...
[22:45:41] [DOC: 9168183] ℹ️  Calculated age: 91 from DOB: 12/11/1933
[22:45:41] [DOC: 9168183] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT, HHA'
[22:45:41] [DOC: 9168183] ℹ️  Payer Source extracted: ''
[22:45:41] [DOC: 9168183] ℹ️  Diagnosis codes being written:
[22:45:41] [DOC: 9168183] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.312'
[22:45:41] [DOC: 9168183] ℹ️    - Latest_Episode_Seconddiagnosis: 'I69.311'
[22:45:41] [DOC: 9168183] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.315'
[22:45:41] [DOC: 9168183] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I69.334'
[22:45:41] [DOC: 9168183] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[22:45:41] [DOC: 9168183] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.22'
[22:45:41] [DOC: 9168183] ✅ Patient data written to CSV: Urgelia Batista | Sex: FEMALE | Age: 91 | Service: Skilled Nursing, PT, OT, HHA | Payer:  | MRN: 1992015
[22:45:41] ✅    ✅ Document 9168183 processed and saved successfully
[22:45:41] 🔄 
🔄 Step 8: Saving API details...
[22:45:41] [DOC: 9168183] ℹ️  API push details saved for document 9168183
[22:45:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168174                         ║
================================================================================
[22:45:41] ℹ️  Agency: Dartmouth HH
[22:45:41] ℹ️  Date: 03/07/2025
[22:45:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:45:44] [DOC: 9168174] ✅ Text extracted using pdfplumber (13927 chars)
[22:45:44] ✅    ✅ Text extracted using pdfplumber (13915 chars)
[22:45:44] 🔄 
🔄 Step 2: Extracting patient data...
[22:45:47] ℹ️  AI extracted raw sex value: 'F'
[22:45:47] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:45:47] ℹ️  AI extracted payer source: ''
[22:45:47] ℹ️  AI extracted diagnoses:
[22:45:47] ℹ️    - Diagnosis 1: 'I11.0'
[22:45:47] ℹ️    - Diagnosis 2: 'I50.20'
[22:45:47] ℹ️    - Diagnosis 3: 'F32.9'
[22:45:47] ℹ️    - Diagnosis 4: 'F41.9'
[22:45:47] ℹ️    - Diagnosis 5: 'I67.1'
[22:45:47] ℹ️    - Diagnosis 6: 'I69.098'
[22:45:47] ℹ️  Final extracted MRN: '227027'
[22:45:47] ℹ️  Final extracted Sex: 'FEMALE'
[22:45:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:45:47] ℹ️  Final extracted Payer Source: ''
[22:45:47] ✅ Patient data extraction completed successfully
[22:45:47] ✅    ✅ Patient data extracted successfully
[22:45:47] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: Howes
     └─ dob: 05/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.20', 'thirdDiagnosis': 'F32.9', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I67.1', 'sixthDiagnosis': 'I69.098'}]
[22:45:47] ✅    ✅ Patient identified: Brenda Howes
[22:45:47] ✅    ✅ Patient name validation passed
[22:45:47] 🔄 
🔄 Step 3: Processing patient dates...
[22:45:47] [DOC: 9168174] ℹ️  DOB normalized: 05/08/1948
[22:45:47] [DOC: 9168174] ℹ️  Episode startOfCare normalized: 09/01/2024
[22:45:47] [DOC: 9168174] ℹ️  Episode startOfEpisode normalized: 09/01/2024
[22:45:47] [DOC: 9168174] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[22:45:47] [DOC: 9168174] ✅ Patient date processing completed successfully
[22:45:47] ✅    ✅ Date processing completed
[22:45:47] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: Howes
     └─ dob: 05/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.20', 'thirdDiagnosis': 'F32.9', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I67.1', 'sixthDiagnosis': 'I69.098'}]
[22:45:47] 🔄 
🔄 Step 4: Extracting order data...
[22:45:49] ℹ️  Order extraction - MRN: '4489015'
[22:45:49] ℹ️  Order extraction - Sex: 'FEMALE'
[22:45:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:45:49] ℹ️  Order extraction - Payer Source: ''
[22:45:49] ✅ Order data extraction completed successfully
[22:45:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:45:49] ℹ️  Using longer MRN from order data: '4489015' over '227027'
[22:45:49] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[22:45:49] ✅ Patient name cross-validation successful
[22:45:49] ✅    ✅ Data merged successfully
[22:45:51] ✅    ✅ Order data extracted and validated
[22:45:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:45:57] [DOC: 9168174] ℹ️  Patient not found in cache or API: Brenda Howes
[22:45:57] [DOC: 9168174] ℹ️  Patient not found, creating new patient via API...
[22:45:57] [DOC: 9168174] ℹ️  Creating patient via API: Brenda Howes
[22:45:58] [DOC: 9168174] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:45:58] ❌    ❌ Failed to create patient
[22:45:58] [DOC: 9168174] ℹ️  API push details saved for document 9168174
================================================================================
║                        Processing Document ID: 9168170                         ║
================================================================================
[22:45:58] ℹ️  Agency: AccentCare Fall River
[22:45:58] ℹ️  Date: 03/07/2025
[22:45:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:46:01] [DOC: 9168170] ✅ Text extracted using pdfplumber (1407 chars)
[22:46:01] ✅    ✅ Text extracted using pdfplumber (1407 chars)
[22:46:01] 🔄 
🔄 Step 2: Extracting patient data...
[22:46:04] ℹ️  AI extracted raw sex value: ''
[22:46:04] ℹ️  AI extracted service line: 'RN, LPN'
[22:46:04] ℹ️  AI extracted payer source: ''
[22:46:04] ℹ️  AI extracted diagnoses:
[22:46:04] ℹ️    - Diagnosis 1: 'Influenza A'
[22:46:04] ℹ️    - Diagnosis 2: 'Acute Hypoxia'
[22:46:04] ℹ️    - Diagnosis 3: 'COPD Exacerbation'
[22:46:04] ℹ️    - Diagnosis 4: ''
[22:46:04] ℹ️    - Diagnosis 5: ''
[22:46:04] ℹ️    - Diagnosis 6: ''
[22:46:04] ℹ️  Final extracted MRN: 'C0200218671301'
[22:46:04] ℹ️  Final extracted Sex: ''
[22:46:04] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:46:04] ℹ️  Final extracted Payer Source: ''
[22:46:04] ✅ Patient data extraction completed successfully
[22:46:04] ✅    ✅ Patient data extracted successfully
[22:46:04] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:46:04] ✅    ✅ Patient identified: MARY LEBLANC
[22:46:04] ✅    ✅ Patient name validation passed
[22:46:04] 🔄 
🔄 Step 3: Processing patient dates...
[22:46:04] [DOC: 9168170] ℹ️  DOB normalized: 03/02/1943
[22:46:04] [DOC: 9168170] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[22:46:04] [DOC: 9168170] ℹ️  Episode endOfEpisode normalized: 02/18/2025
[22:46:04] [DOC: 9168170] ✅ Patient date processing completed successfully
[22:46:04] ✅    ✅ Date processing completed
[22:46:04] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:46:04] 🔄 
🔄 Step 4: Extracting order data...
[22:46:07] ℹ️  Order extraction - MRN: 'C0200218671301'
[22:46:07] ℹ️  Order extraction - Sex: ''
[22:46:07] ℹ️  Order extraction - Service Line: 'RN'
[22:46:07] ℹ️  Order extraction - Payer Source: ''
[22:46:07] ✅ Order data extraction completed successfully
[22:46:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:46:07] ℹ️  Using MRN from patient data: 'C0200218671301' over 'C0200218671301'
[22:46:07] ℹ️  Inferred sex as FEMALE from name: MARY
[22:46:07] ℹ️  Combined service lines: Patient='RN, LPN' + Order='RN' = 'LPN, RN'
[22:46:07] ✅ Patient name cross-validation successful
[22:46:07] ✅    ✅ Data merged successfully
[22:46:08] ✅    ✅ Order data extracted and validated
[22:46:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:46:37] [DOC: 9168170] ℹ️  Patient not found in cache or API: MARY LEBLANC
[22:46:37] [DOC: 9168170] ℹ️  Patient not found, creating new patient via API...
[22:46:37] [DOC: 9168170] ℹ️  Creating patient via API: MARY LEBLANC
[22:46:38] [DOC: 9168170] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:46:38] ❌    ❌ Failed to create patient
[22:46:38] [DOC: 9168170] ℹ️  API push details saved for document 9168170
================================================================================
║                        Processing Document ID: 9168169                         ║
================================================================================
[22:46:38] ℹ️  Agency: Dartmouth HH
[22:46:38] ℹ️  Date: 03/07/2025
[22:46:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:46:40] [DOC: 9168169] ✅ Text extracted using pdfplumber (1081 chars)
[22:46:40] ✅    ✅ Text extracted using pdfplumber (1081 chars)
[22:46:40] 🔄 
🔄 Step 2: Extracting patient data...
[22:46:43] ℹ️  AI extracted raw sex value: 'F'
[22:46:43] ℹ️  AI extracted service line: 'HHA'
[22:46:43] ℹ️  AI extracted payer source: 'Medicare'
[22:46:43] ℹ️  AI extracted diagnoses:
[22:46:43] ℹ️    - Diagnosis 1: ''
[22:46:43] ℹ️    - Diagnosis 2: ''
[22:46:43] ℹ️    - Diagnosis 3: ''
[22:46:43] ℹ️    - Diagnosis 4: ''
[22:46:43] ℹ️    - Diagnosis 5: ''
[22:46:43] ℹ️    - Diagnosis 6: ''
[22:46:43] ℹ️  Final extracted MRN: '4489015'
[22:46:43] ℹ️  Final extracted Sex: 'FEMALE'
[22:46:43] ℹ️  Final extracted Service Line: 'HHA'
[22:46:43] ℹ️  Final extracted Payer Source: 'Medicare'
[22:46:43] ✅ Patient data extraction completed successfully
[22:46:43] ✅    ✅ Patient data extracted successfully
[22:46:43] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: Howes
     └─ dob: 05/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4489015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '02/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:46:43] ✅    ✅ Patient identified: Brenda Howes
[22:46:43] ✅    ✅ Patient name validation passed
[22:46:43] 🔄 
🔄 Step 3: Processing patient dates...
[22:46:43] [DOC: 9168169] ℹ️  DOB normalized: 05/08/1948
[22:46:43] [DOC: 9168169] ℹ️  Episode startOfCare normalized: 09/01/2024
[22:46:43] [DOC: 9168169] ℹ️  Episode startOfEpisode normalized: 09/01/2024
[22:46:43] [DOC: 9168169] ℹ️  Episode endOfEpisode normalized: 02/27/2025
[22:46:43] [DOC: 9168169] ✅ Patient date processing completed successfully
[22:46:43] ✅    ✅ Date processing completed
[22:46:43] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: Howes
     └─ dob: 05/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4489015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '02/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:46:43] 🔄 
🔄 Step 4: Extracting order data...
[22:46:45] ℹ️  Order extraction - MRN: ''
[22:46:45] ℹ️  Order extraction - Sex: 'FEMALE'
[22:46:45] ℹ️  Order extraction - Service Line: ''
[22:46:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:46:45] ✅ Order data extraction completed successfully
[22:46:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:46:45] ℹ️  Using MRN from patient data: '4489015'
[22:46:45] ℹ️  Using service line from patient data: 'HHA'
[22:46:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:46:45] ✅ Patient name cross-validation successful
[22:46:45] ✅    ✅ Data merged successfully
[22:46:47] ✅    ✅ Order data extracted and validated
[22:46:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:46:54] [DOC: 9168169] ℹ️  Patient not found in cache or API: Brenda Howes
[22:46:54] [DOC: 9168169] ℹ️  Patient not found, creating new patient via API...
[22:46:54] [DOC: 9168169] ℹ️  Creating patient via API: Brenda Howes
[22:46:55] [DOC: 9168169] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:46:55] ❌    ❌ Failed to create patient
[22:46:55] [DOC: 9168169] ℹ️  API push details saved for document 9168169
================================================================================
║                        Processing Document ID: 9168166                         ║
================================================================================
[22:46:55] ℹ️  Agency: Dartmouth HH
[22:46:55] ℹ️  Date: 03/07/2025
[22:46:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:46:58] [DOC: 9168166] ✅ Text extracted using pdfplumber (13148 chars)
[22:46:58] ✅    ✅ Text extracted using pdfplumber (13148 chars)
[22:46:58] 🔄 
🔄 Step 2: Extracting patient data...
[22:47:01] ℹ️  AI extracted raw sex value: 'F'
[22:47:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:47:01] ℹ️  AI extracted payer source: ''
[22:47:01] ℹ️  AI extracted diagnoses:
[22:47:01] ℹ️    - Diagnosis 1: 'E11.622'
[22:47:01] ℹ️    - Diagnosis 2: 'I87.2'
[22:47:01] ℹ️    - Diagnosis 3: 'L97.822'
[22:47:01] ℹ️    - Diagnosis 4: 'G93.40'
[22:47:01] ℹ️    - Diagnosis 5: 'F03.A3'
[22:47:01] ℹ️    - Diagnosis 6: 'F32.A'
[22:47:01] ℹ️  Final extracted MRN: '3205015'
[22:47:01] ℹ️  Final extracted Sex: 'FEMALE'
[22:47:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:47:01] ℹ️  Final extracted Payer Source: ''
[22:47:01] ✅ Patient data extraction completed successfully
[22:47:01] ✅    ✅ Patient data extracted successfully
[22:47:01] 📊 Patient Response
     └─ patientFName: Cristina
     └─ patientLName: Garcia
     └─ dob: 11/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3205015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/03/2024', 'startOfEpisode': '09/06/2024', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': 'E11.622', 'secondDiagnosis': 'I87.2', 'thirdDiagnosis': 'L97.822', 'fourthDiagnosis': 'G93.40', 'fifthDiagnosis': 'F03.A3', 'sixthDiagnosis': 'F32.A'}]
[22:47:01] ✅    ✅ Patient identified: Cristina Garcia
[22:47:01] ✅    ✅ Patient name validation passed
[22:47:01] 🔄 
🔄 Step 3: Processing patient dates...
[22:47:01] [DOC: 9168166] ℹ️  DOB normalized: 11/23/1947
[22:47:01] [DOC: 9168166] ℹ️  Episode startOfCare normalized: 09/03/2024
[22:47:01] [DOC: 9168166] ℹ️  Episode startOfEpisode normalized: 09/06/2024
[22:47:01] [DOC: 9168166] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[22:47:01] [DOC: 9168166] ✅ Patient date processing completed successfully
[22:47:01] ✅    ✅ Date processing completed
[22:47:01] 📊 Processed Patient Data
     └─ patientFName: Cristina
     └─ patientLName: Garcia
     └─ dob: 11/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3205015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/03/2024', 'startOfEpisode': '09/06/2024', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': 'E11.622', 'secondDiagnosis': 'I87.2', 'thirdDiagnosis': 'L97.822', 'fourthDiagnosis': 'G93.40', 'fifthDiagnosis': 'F03.A3', 'sixthDiagnosis': 'F32.A'}]
[22:47:01] 🔄 
🔄 Step 4: Extracting order data...
[22:47:04] ℹ️  Order extraction - MRN: '3205015'
[22:47:04] ℹ️  Order extraction - Sex: 'FEMALE'
[22:47:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:47:04] ℹ️  Order extraction - Payer Source: ''
[22:47:04] ✅ Order data extraction completed successfully
[22:47:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:47:04] ℹ️  Using MRN from patient data: '3205015' over '3205015'
[22:47:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:47:04] ✅ Patient name cross-validation successful
[22:47:04] ✅    ✅ Data merged successfully
[22:47:05] ✅    ✅ Order data extracted and validated
[22:47:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:47:35] [DOC: 9168166] ✅ Patient exists in API: Cristina Garcia, ID: 6c5cc104-3234-4c64-89c7-9b7bb1d803c2
[22:47:35] ✅    ✅ Existing patient found with ID: 6c5cc104-3234-4c64-89c7-9b7bb1d803c2
[22:47:35] 🔄 
🔄 Step 6: Pushing order to API...
[22:47:35] [DOC: 9168166] ℹ️  Pushing order via API for patient ID: 6c5cc104-3234-4c64-89c7-9b7bb1d803c2
[22:47:36] [DOC: 9168166] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:47:36] ❌    ❌ Failed to push order
[22:47:36] 🔄 
🔄 Step 7: Writing to CSV...
[22:47:36] [DOC: 9168166] ℹ️  Calculated age: 77 from DOB: 11/23/1947
[22:47:36] [DOC: 9168166] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:47:36] [DOC: 9168166] ℹ️  Payer Source extracted: ''
[22:47:36] [DOC: 9168166] ℹ️  Diagnosis codes being written:
[22:47:36] [DOC: 9168166] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.622'
[22:47:36] [DOC: 9168166] ℹ️    - Latest_Episode_Seconddiagnosis: 'I87.2'
[22:47:36] [DOC: 9168166] ℹ️    - Latest_Episode_Thirddiagnosis: 'L97.822'
[22:47:36] [DOC: 9168166] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G93.40'
[22:47:36] [DOC: 9168166] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F03.A3'
[22:47:36] [DOC: 9168166] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.A'
[22:47:36] [DOC: 9168166] ✅ Patient data written to CSV: Cristina Garcia | Sex: FEMALE | Age: 77 | Service: Skilled Nursing | Payer:  | MRN: 3205015
[22:47:36] ✅    ✅ Document 9168166 processed and saved successfully
[22:47:36] 🔄 
🔄 Step 8: Saving API details...
[22:47:36] [DOC: 9168166] ℹ️  API push details saved for document 9168166
[22:47:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168162                         ║
================================================================================
[22:47:36] ℹ️  Agency: AccentCare Fall River
[22:47:36] ℹ️  Date: 03/07/2025
[22:47:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:47:39] [DOC: 9168162] ✅ Text extracted using pdfplumber (1213 chars)
[22:47:39] ✅    ✅ Text extracted using pdfplumber (1213 chars)
[22:47:39] 🔄 
🔄 Step 2: Extracting patient data...
[22:47:42] ℹ️  AI extracted raw sex value: ''
[22:47:42] ℹ️  AI extracted service line: 'OT'
[22:47:42] ℹ️  AI extracted payer source: ''
[22:47:42] ℹ️  AI extracted diagnoses:
[22:47:42] ℹ️    - Diagnosis 1: 'Influenza A'
[22:47:42] ℹ️    - Diagnosis 2: 'Acute Hypoxia'
[22:47:42] ℹ️    - Diagnosis 3: 'COPD Exacerbation'
[22:47:42] ℹ️    - Diagnosis 4: ''
[22:47:42] ℹ️    - Diagnosis 5: ''
[22:47:42] ℹ️    - Diagnosis 6: ''
[22:47:42] ℹ️  Final extracted MRN: 'C0200218671301'
[22:47:42] ℹ️  Final extracted Sex: ''
[22:47:42] ℹ️  Final extracted Service Line: 'OT'
[22:47:42] ℹ️  Final extracted Payer Source: ''
[22:47:42] ✅ Patient data extraction completed successfully
[22:47:42] ✅    ✅ Patient data extracted successfully
[22:47:42] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:47:42] ✅    ✅ Patient identified: MARY LEBLANC
[22:47:42] ✅    ✅ Patient name validation passed
[22:47:42] 🔄 
🔄 Step 3: Processing patient dates...
[22:47:42] [DOC: 9168162] ℹ️  DOB normalized: 03/02/1943
[22:47:42] [DOC: 9168162] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[22:47:42] [DOC: 9168162] ℹ️  Episode endOfEpisode normalized: 02/18/2025
[22:47:42] [DOC: 9168162] ✅ Patient date processing completed successfully
[22:47:42] ✅    ✅ Date processing completed
[22:47:42] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:47:42] 🔄 
🔄 Step 4: Extracting order data...
[22:47:45] ℹ️  Order extraction - MRN: 'C0200218671301'
[22:47:45] ℹ️  Order extraction - Sex: ''
[22:47:45] ℹ️  Order extraction - Service Line: 'OT'
[22:47:45] ℹ️  Order extraction - Payer Source: ''
[22:47:45] ✅ Order data extraction completed successfully
[22:47:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:47:45] ℹ️  Using MRN from patient data: 'C0200218671301' over 'C0200218671301'
[22:47:45] ℹ️  Inferred sex as FEMALE from name: MARY
[22:47:45] ℹ️  Service line consistent in both sources: 'OT'
[22:47:45] ✅ Patient name cross-validation successful
[22:47:45] ✅    ✅ Data merged successfully
[22:47:46] ✅    ✅ Order data extracted and validated
[22:47:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:47:54] [DOC: 9168162] ℹ️  Patient not found in cache or API: MARY LEBLANC
[22:47:54] [DOC: 9168162] ℹ️  Patient not found, creating new patient via API...
[22:47:54] [DOC: 9168162] ℹ️  Creating patient via API: MARY LEBLANC
[22:47:55] [DOC: 9168162] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:47:55] ❌    ❌ Failed to create patient
[22:47:55] [DOC: 9168162] ℹ️  API push details saved for document 9168162
================================================================================
║                        Processing Document ID: 9168143                         ║
================================================================================
[22:47:55] ℹ️  Agency: Dartmouth HH
[22:47:55] ℹ️  Date: 03/07/2025
[22:47:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:48:03] [DOC: 9168143] ✅ Text extracted using pdfplumber (25185 chars)
[22:48:03] ✅    ✅ Text extracted using pdfplumber (25173 chars)
[22:48:03] 🔄 
🔄 Step 2: Extracting patient data...
[22:48:06] ℹ️  AI extracted raw sex value: 'M'
[22:48:06] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[22:48:06] ℹ️  AI extracted payer source: ''
[22:48:06] ℹ️  AI extracted diagnoses:
[22:48:06] ℹ️    - Diagnosis 1: 'I69.391'
[22:48:06] ℹ️    - Diagnosis 2: 'R13.12'
[22:48:06] ℹ️    - Diagnosis 3: 'Z43.1'
[22:48:06] ℹ️    - Diagnosis 4: 'C15.5'
[22:48:06] ℹ️    - Diagnosis 5: 'I69.328'
[22:48:06] ℹ️    - Diagnosis 6: 'E11.65'
[22:48:06] ℹ️  Final extracted MRN: '227027'
[22:48:06] ℹ️  Final extracted Sex: 'MALE'
[22:48:06] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[22:48:06] ℹ️  Final extracted Payer Source: ''
[22:48:06] ✅ Patient data extraction completed successfully
[22:48:06] ✅    ✅ Patient data extracted successfully
[22:48:06] 📊 Patient Response
     └─ patientFName: Los
     └─ patientLName: Paul R
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': 'I69.391', 'secondDiagnosis': 'R13.12', 'thirdDiagnosis': 'Z43.1', 'fourthDiagnosis': 'C15.5', 'fifthDiagnosis': 'I69.328', 'sixthDiagnosis': 'E11.65'}]
[22:48:06] ✅    ✅ Patient identified: Los Paul R
[22:48:06] ✅    ✅ Patient name validation passed
[22:48:06] 🔄 
🔄 Step 3: Processing patient dates...
[22:48:06] [DOC: 9168143] ℹ️  DOB normalized: 12/28/1944
[22:48:06] [DOC: 9168143] ℹ️  Episode startOfCare normalized: 01/03/2025
[22:48:06] [DOC: 9168143] ℹ️  Episode startOfEpisode normalized: 01/04/2025
[22:48:06] [DOC: 9168143] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[22:48:06] [DOC: 9168143] ✅ Patient date processing completed successfully
[22:48:06] ✅    ✅ Date processing completed
[22:48:06] 📊 Processed Patient Data
     └─ patientFName: Los
     └─ patientLName: Paul R
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': 'I69.391', 'secondDiagnosis': 'R13.12', 'thirdDiagnosis': 'Z43.1', 'fourthDiagnosis': 'C15.5', 'fifthDiagnosis': 'I69.328', 'sixthDiagnosis': 'E11.65'}]
[22:48:06] 🔄 
🔄 Step 4: Extracting order data...
[22:48:08] ℹ️  Order extraction - MRN: '227027'
[22:48:08] ℹ️  Order extraction - Sex: 'MALE'
[22:48:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[22:48:08] ℹ️  Order extraction - Payer Source: ''
[22:48:08] ✅ Order data extraction completed successfully
[22:48:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:48:08] ℹ️  Using MRN from patient data: '227027' over '227027'
[22:48:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[22:48:08] ✅ Patient name cross-validation successful
[22:48:08] ✅    ✅ Data merged successfully
[22:48:10] ✅    ✅ Order data extracted and validated
[22:48:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:48:32] [DOC: 9168143] ℹ️  Patient not found in cache or API: Los Paul R
[22:48:32] [DOC: 9168143] ℹ️  Patient not found, creating new patient via API...
[22:48:32] [DOC: 9168143] ℹ️  Creating patient via API: Los Paul R
[22:48:33] [DOC: 9168143] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:48:33] ❌    ❌ Failed to create patient
[22:48:33] [DOC: 9168143] ℹ️  API push details saved for document 9168143
================================================================================
║                        Processing Document ID: 9168138                         ║
================================================================================
[22:48:33] ℹ️  Agency: Dartmouth HH
[22:48:33] ℹ️  Date: 03/07/2025
[22:48:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:48:35] [DOC: 9168138] ✅ Text extracted using pdfplumber (2538 chars)
[22:48:35] ✅    ✅ Text extracted using pdfplumber (2538 chars)
[22:48:35] 🔄 
🔄 Step 2: Extracting patient data...
[22:48:38] ℹ️  AI extracted raw sex value: 'M'
[22:48:38] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[22:48:38] ℹ️  AI extracted payer source: 'Medicare'
[22:48:38] ℹ️  AI extracted diagnoses:
[22:48:38] ℹ️    - Diagnosis 1: ''
[22:48:38] ℹ️    - Diagnosis 2: ''
[22:48:38] ℹ️    - Diagnosis 3: ''
[22:48:38] ℹ️    - Diagnosis 4: ''
[22:48:38] ℹ️    - Diagnosis 5: ''
[22:48:38] ℹ️    - Diagnosis 6: ''
[22:48:38] ℹ️  Final extracted MRN: '5642015'
[22:48:38] ℹ️  Final extracted Sex: 'MALE'
[22:48:38] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[22:48:38] ℹ️  Final extracted Payer Source: 'Medicare'
[22:48:38] ✅ Patient data extraction completed successfully
[22:48:38] ✅    ✅ Patient data extracted successfully
[22:48:38] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Los
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5642015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:48:38] ✅    ✅ Patient identified: Paul Los
[22:48:38] ✅    ✅ Patient name validation passed
[22:48:38] 🔄 
🔄 Step 3: Processing patient dates...
[22:48:38] [DOC: 9168138] ℹ️  DOB normalized: 12/28/1944
[22:48:38] [DOC: 9168138] ℹ️  Episode startOfCare normalized: 01/04/2025
[22:48:38] [DOC: 9168138] ℹ️  Episode startOfEpisode normalized: 01/04/2025
[22:48:38] [DOC: 9168138] ℹ️  Episode endOfEpisode normalized: 03/04/2025
[22:48:38] [DOC: 9168138] ✅ Patient date processing completed successfully
[22:48:38] ✅    ✅ Date processing completed
[22:48:38] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Los
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5642015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:48:38] 🔄 
🔄 Step 4: Extracting order data...
[22:48:40] ℹ️  Order extraction - MRN: ''
[22:48:40] ℹ️  Order extraction - Sex: 'MALE'
[22:48:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[22:48:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:48:40] ✅ Order data extraction completed successfully
[22:48:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:48:40] ℹ️  Using MRN from patient data: '5642015'
[22:48:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[22:48:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:48:40] ✅ Patient name cross-validation successful
[22:48:40] ✅    ✅ Data merged successfully
[22:48:41] ✅    ✅ Order data extracted and validated
[22:48:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:48:49] [DOC: 9168138] ℹ️  Patient not found in cache or API: Paul Los
[22:48:49] [DOC: 9168138] ℹ️  Patient not found, creating new patient via API...
[22:48:49] [DOC: 9168138] ℹ️  Creating patient via API: Paul Los
[22:48:50] [DOC: 9168138] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:48:50] ❌    ❌ Failed to create patient
[22:48:50] [DOC: 9168138] ℹ️  API push details saved for document 9168138
================================================================================
║                        Processing Document ID: 9168135                         ║
================================================================================
[22:48:50] ℹ️  Agency: Dartmouth HH
[22:48:50] ℹ️  Date: 03/07/2025
[22:48:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:48:52] [DOC: 9168135] ✅ Text extracted using pdfplumber (1119 chars)
[22:48:52] ✅    ✅ Text extracted using pdfplumber (1119 chars)
[22:48:52] 🔄 
🔄 Step 2: Extracting patient data...
[22:48:55] ℹ️  AI extracted raw sex value: 'F'
[22:48:55] ℹ️  AI extracted service line: 'RN, LPN'
[22:48:55] ℹ️  AI extracted payer source: 'Medicare'
[22:48:55] ℹ️  AI extracted diagnoses:
[22:48:55] ℹ️    - Diagnosis 1: ''
[22:48:55] ℹ️    - Diagnosis 2: ''
[22:48:55] ℹ️    - Diagnosis 3: ''
[22:48:55] ℹ️    - Diagnosis 4: ''
[22:48:55] ℹ️    - Diagnosis 5: ''
[22:48:55] ℹ️    - Diagnosis 6: ''
[22:48:55] ℹ️  Final extracted MRN: '5837015'
[22:48:55] ℹ️  Final extracted Sex: 'FEMALE'
[22:48:55] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:48:55] ℹ️  Final extracted Payer Source: 'Medicare'
[22:48:55] ✅ Patient data extraction completed successfully
[22:48:55] ✅    ✅ Patient data extracted successfully
[22:48:55] 📊 Patient Response
     └─ patientFName: Hilda
     └─ patientLName: Correia
     └─ dob: 05/15/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5837015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:48:55] ✅    ✅ Patient identified: Hilda Correia
[22:48:55] ✅    ✅ Patient name validation passed
[22:48:55] 🔄 
🔄 Step 3: Processing patient dates...
[22:48:55] [DOC: 9168135] ℹ️  DOB normalized: 05/15/1939
[22:48:55] [DOC: 9168135] ℹ️  Episode startOfCare normalized: 01/09/2025
[22:48:55] [DOC: 9168135] ℹ️  Episode startOfEpisode normalized: 01/09/2025
[22:48:55] [DOC: 9168135] ℹ️  Episode endOfEpisode normalized: 03/09/2025
[22:48:55] [DOC: 9168135] ✅ Patient date processing completed successfully
[22:48:55] ✅    ✅ Date processing completed
[22:48:55] 📊 Processed Patient Data
     └─ patientFName: Hilda
     └─ patientLName: Correia
     └─ dob: 05/15/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5837015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:48:55] 🔄 
🔄 Step 4: Extracting order data...
[22:48:57] ℹ️  Order extraction - MRN: ''
[22:48:57] ℹ️  Order extraction - Sex: 'FEMALE'
[22:48:57] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:48:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:48:57] ✅ Order data extraction completed successfully
[22:48:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:48:57] ℹ️  Using MRN from patient data: '5837015'
[22:48:57] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:48:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:48:57] ✅ Patient name cross-validation successful
[22:48:57] ✅    ✅ Data merged successfully
[22:48:59] ✅    ✅ Order data extracted and validated
[22:48:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:49:04] [DOC: 9168135] ℹ️  Patient not found in cache or API: Hilda Correia
[22:49:04] [DOC: 9168135] ℹ️  Patient not found, creating new patient via API...
[22:49:04] [DOC: 9168135] ℹ️  Creating patient via API: Hilda Correia
[22:49:05] [DOC: 9168135] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:49:05] ❌    ❌ Failed to create patient
[22:49:05] [DOC: 9168135] ℹ️  API push details saved for document 9168135
================================================================================
║                        Processing Document ID: 9168131                         ║
================================================================================
[22:49:05] ℹ️  Agency: Dartmouth HH
[22:49:05] ℹ️  Date: 03/07/2025
[22:49:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:49:07] [DOC: 9168131] ✅ Text extracted using pdfplumber (1635 chars)
[22:49:07] ✅    ✅ Text extracted using pdfplumber (1635 chars)
[22:49:07] 🔄 
🔄 Step 2: Extracting patient data...
[22:49:10] ℹ️  AI extracted raw sex value: 'F'
[22:49:10] ℹ️  AI extracted service line: 'RN'
[22:49:10] ℹ️  AI extracted payer source: 'Medicare'
[22:49:10] ℹ️  AI extracted diagnoses:
[22:49:10] ℹ️    - Diagnosis 1: 'None'
[22:49:10] ℹ️    - Diagnosis 2: 'None'
[22:49:10] ℹ️    - Diagnosis 3: 'None'
[22:49:10] ℹ️    - Diagnosis 4: 'None'
[22:49:10] ℹ️    - Diagnosis 5: 'None'
[22:49:10] ℹ️    - Diagnosis 6: 'None'
[22:49:10] ℹ️  Final extracted MRN: '3320011'
[22:49:10] ℹ️  Final extracted Sex: 'FEMALE'
[22:49:10] ℹ️  Final extracted Service Line: 'RN'
[22:49:10] ℹ️  Final extracted Payer Source: 'Medicare'
[22:49:10] ✅ Patient data extraction completed successfully
[22:49:10] ✅    ✅ Patient data extracted successfully
[22:49:10] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': None, 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:49:10] ✅    ✅ Patient identified: Bonnie Werly
[22:49:10] ✅    ✅ Patient name validation passed
[22:49:10] 🔄 
🔄 Step 3: Processing patient dates...
[22:49:10] [DOC: 9168131] ℹ️  DOB normalized: 06/16/1939
[22:49:10] [DOC: 9168131] ℹ️  Episode startOfCare normalized: 09/01/2024
[22:49:10] [DOC: 9168131] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[22:49:10] [DOC: 9168131] ✅ Patient date processing completed successfully
[22:49:10] ✅    ✅ Date processing completed
[22:49:10] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'endOfEpisode': '04/28/2025'}]
[22:49:10] 🔄 
🔄 Step 4: Extracting order data...
[22:49:12] ℹ️  Order extraction - MRN: ''
[22:49:12] ℹ️  Order extraction - Sex: 'FEMALE'
[22:49:12] ℹ️  Order extraction - Service Line: 'RN'
[22:49:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:49:12] ✅ Order data extraction completed successfully
[22:49:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:49:12] ℹ️  Using MRN from patient data: '3320011'
[22:49:12] ℹ️  Service line consistent in both sources: 'RN'
[22:49:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:49:12] ✅ Patient name cross-validation successful
[22:49:12] ✅    ✅ Data merged successfully
[22:49:13] ✅    ✅ Order data extracted and validated
[22:49:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:49:13] [DOC: 9168131] ✅ Patient found in local cache: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:49:13] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:49:13] 🔄 
🔄 Step 6: Pushing order to API...
[22:49:13] [DOC: 9168131] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:49:15] [DOC: 9168131] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14422"}
[22:49:15] ❌    ❌ Failed to push order
[22:49:15] 🔄 
🔄 Step 7: Writing to CSV...
[22:49:15] [DOC: 9168131] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[22:49:15] [DOC: 9168131] ℹ️  Service Line extracted: 'RN'
[22:49:15] [DOC: 9168131] ℹ️  Payer Source extracted: 'Medicare'
[22:49:15] [DOC: 9168131] ℹ️  Diagnosis codes being written:
[22:49:15] [DOC: 9168131] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:49:15] [DOC: 9168131] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:49:15] [DOC: 9168131] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:49:15] [DOC: 9168131] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:49:15] [DOC: 9168131] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:49:15] [DOC: 9168131] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:49:15] [DOC: 9168131] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: RN | Payer: Medicare | MRN: 3320011
[22:49:15] ✅    ✅ Document 9168131 processed and saved successfully
[22:49:15] 🔄 
🔄 Step 8: Saving API details...
[22:49:15] [DOC: 9168131] ℹ️  API push details saved for document 9168131
[22:49:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168129                         ║
================================================================================
[22:49:15] ℹ️  Agency: Dartmouth HH
[22:49:15] ℹ️  Date: 03/07/2025
[22:49:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:49:17] [DOC: 9168129] ✅ Text extracted using pdfplumber (2039 chars)
[22:49:17] ✅    ✅ Text extracted using pdfplumber (2039 chars)
[22:49:17] 🔄 
🔄 Step 2: Extracting patient data...
[22:49:19] ℹ️  AI extracted raw sex value: 'M'
[22:49:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:49:19] ℹ️  AI extracted payer source: 'Medicare'
[22:49:19] ℹ️  AI extracted diagnoses:
[22:49:19] ℹ️    - Diagnosis 1: ''
[22:49:19] ℹ️    - Diagnosis 2: ''
[22:49:19] ℹ️    - Diagnosis 3: ''
[22:49:19] ℹ️    - Diagnosis 4: ''
[22:49:19] ℹ️    - Diagnosis 5: ''
[22:49:19] ℹ️    - Diagnosis 6: ''
[22:49:19] ℹ️  Final extracted MRN: '460009'
[22:49:19] ℹ️  Final extracted Sex: 'MALE'
[22:49:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:49:19] ℹ️  Final extracted Payer Source: 'Medicare'
[22:49:19] ✅ Patient data extraction completed successfully
[22:49:19] ✅    ✅ Patient data extracted successfully
[22:49:19] 📊 Patient Response
     └─ patientFName: Brian
     └─ patientLName: Gonsalves
     └─ dob: 05/21/1965
     └─ patientSex: MALE
     └─ medicalRecordNo: 460009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/29/2024', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:49:19] ✅    ✅ Patient identified: Brian Gonsalves
[22:49:19] ✅    ✅ Patient name validation passed
[22:49:19] 🔄 
🔄 Step 3: Processing patient dates...
[22:49:19] [DOC: 9168129] ℹ️  DOB normalized: 05/21/1965
[22:49:19] [DOC: 9168129] ℹ️  Episode startOfCare normalized: 09/29/2024
[22:49:19] [DOC: 9168129] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[22:49:19] [DOC: 9168129] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[22:49:19] [DOC: 9168129] ✅ Patient date processing completed successfully
[22:49:19] ✅    ✅ Date processing completed
[22:49:19] 📊 Processed Patient Data
     └─ patientFName: Brian
     └─ patientLName: Gonsalves
     └─ dob: 05/21/1965
     └─ patientSex: MALE
     └─ medicalRecordNo: 460009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/29/2024', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:49:19] 🔄 
🔄 Step 4: Extracting order data...
[22:49:22] ℹ️  Order extraction - MRN: ''
[22:49:22] ℹ️  Order extraction - Sex: 'MALE'
[22:49:22] ℹ️  Order extraction - Service Line: 'RN'
[22:49:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:49:22] ✅ Order data extraction completed successfully
[22:49:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:49:22] ℹ️  Using MRN from patient data: '460009'
[22:49:22] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[22:49:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:49:22] ✅ Patient name cross-validation successful
[22:49:22] ✅    ✅ Data merged successfully
[22:49:25] ✅    ✅ Order data extracted and validated
[22:49:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:49:45] [DOC: 9168129] ℹ️  Patient not found in cache or API: Brian Gonsalves
[22:49:45] [DOC: 9168129] ℹ️  Patient not found, creating new patient via API...
[22:49:45] [DOC: 9168129] ℹ️  Creating patient via API: Brian Gonsalves
[22:49:47] [DOC: 9168129] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:49:47] ❌    ❌ Failed to create patient
[22:49:47] [DOC: 9168129] ℹ️  API push details saved for document 9168129
================================================================================
║                        Processing Document ID: 9168122                         ║
================================================================================
[22:49:47] ℹ️  Agency: Dartmouth HH
[22:49:47] ℹ️  Date: 03/07/2025
[22:49:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:49:50] [DOC: 9168122] ✅ Text extracted using pdfplumber (15817 chars)
[22:49:50] ✅    ✅ Text extracted using pdfplumber (15817 chars)
[22:49:50] 🔄 
🔄 Step 2: Extracting patient data...
[22:49:53] ℹ️  AI extracted raw sex value: 'F'
[22:49:53] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[22:49:53] ℹ️  AI extracted payer source: 'Private Pay'
[22:49:53] ℹ️  AI extracted diagnoses:
[22:49:53] ℹ️    - Diagnosis 1: 'G30.9'
[22:49:53] ℹ️    - Diagnosis 2: 'F02.80'
[22:49:53] ℹ️    - Diagnosis 3: 'I10'
[22:49:53] ℹ️    - Diagnosis 4: 'H81.11'
[22:49:53] ℹ️    - Diagnosis 5: 'I95.1'
[22:49:53] ℹ️    - Diagnosis 6: 'M19.90'
[22:49:53] ℹ️  Final extracted MRN: '305011'
[22:49:53] ℹ️  Final extracted Sex: 'FEMALE'
[22:49:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[22:49:53] ℹ️  Final extracted Payer Source: 'Private Pay'
[22:49:53] ✅ Patient data extraction completed successfully
[22:49:53] ✅    ✅ Patient data extracted successfully
[22:49:53] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 06/03/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 305011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '03/03/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'H81.11', 'fifthDiagnosis': 'I95.1', 'sixthDiagnosis': 'M19.90'}]
[22:49:53] ✅    ✅ Patient identified: Gloria Medeiros
[22:49:53] ✅    ✅ Patient name validation passed
[22:49:53] 🔄 
🔄 Step 3: Processing patient dates...
[22:49:53] [DOC: 9168122] ℹ️  DOB normalized: 06/03/1936
[22:49:53] [DOC: 9168122] ℹ️  Episode startOfCare normalized: 03/03/2025
[22:49:53] [DOC: 9168122] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[22:49:53] [DOC: 9168122] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[22:49:53] [DOC: 9168122] ✅ Patient date processing completed successfully
[22:49:53] ✅    ✅ Date processing completed
[22:49:53] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 06/03/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 305011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '03/03/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'H81.11', 'fifthDiagnosis': 'I95.1', 'sixthDiagnosis': 'M19.90'}]
[22:49:53] 🔄 
🔄 Step 4: Extracting order data...
[22:49:56] ℹ️  Order extraction - MRN: '305011'
[22:49:56] ℹ️  Order extraction - Sex: 'FEMALE'
[22:49:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[22:49:56] ℹ️  Order extraction - Payer Source: 'Private Pay'
[22:49:56] ✅ Order data extraction completed successfully
[22:49:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:49:56] ℹ️  Using MRN from patient data: '305011' over '305011'
[22:49:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[22:49:56] ℹ️  Payer source consistent in both sources: 'Private Pay'
[22:49:56] ✅ Patient name cross-validation successful
[22:49:56] ✅    ✅ Data merged successfully
[22:49:57] ✅    ✅ Order data extracted and validated
[22:49:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:50:03] [DOC: 9168122] ℹ️  Patient not found in cache or API: Gloria Medeiros
[22:50:03] [DOC: 9168122] ℹ️  Patient not found, creating new patient via API...
[22:50:03] [DOC: 9168122] ℹ️  Creating patient via API: Gloria Medeiros
[22:50:04] [DOC: 9168122] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:50:04] ❌    ❌ Failed to create patient
[22:50:04] [DOC: 9168122] ℹ️  API push details saved for document 9168122
================================================================================
║                        Processing Document ID: 9168110                         ║
================================================================================
[22:50:04] ℹ️  Agency: Dartmouth HH
[22:50:04] ℹ️  Date: 03/07/2025
[22:50:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:50:06] [DOC: 9168110] ✅ Text extracted using pdfplumber (1481 chars)
[22:50:06] ✅    ✅ Text extracted using pdfplumber (1481 chars)
[22:50:06] 🔄 
🔄 Step 2: Extracting patient data...
[22:50:09] ℹ️  AI extracted raw sex value: 'F'
[22:50:09] ℹ️  AI extracted service line: 'RN, LPN'
[22:50:09] ℹ️  AI extracted payer source: 'Medicare'
[22:50:09] ℹ️  AI extracted diagnoses:
[22:50:09] ℹ️    - Diagnosis 1: 'None'
[22:50:09] ℹ️    - Diagnosis 2: 'None'
[22:50:09] ℹ️    - Diagnosis 3: 'None'
[22:50:09] ℹ️    - Diagnosis 4: 'None'
[22:50:09] ℹ️    - Diagnosis 5: 'None'
[22:50:09] ℹ️    - Diagnosis 6: 'None'
[22:50:09] ℹ️  Final extracted MRN: '323014'
[22:50:09] ℹ️  Final extracted Sex: 'FEMALE'
[22:50:09] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:50:09] ℹ️  Final extracted Payer Source: 'Medicare'
[22:50:09] ✅ Patient data extraction completed successfully
[22:50:09] ✅    ✅ Patient data extracted successfully
[22:50:09] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:50:09] ✅    ✅ Patient identified: Sandra Plissey
[22:50:09] ✅    ✅ Patient name validation passed
[22:50:09] 🔄 
🔄 Step 3: Processing patient dates...
[22:50:09] [DOC: 9168110] ℹ️  DOB normalized: 11/19/1943
[22:50:09] [DOC: 9168110] ℹ️  Episode startOfCare normalized: 10/07/2024
[22:50:09] [DOC: 9168110] ℹ️  Episode startOfEpisode normalized: 02/04/2025
[22:50:09] [DOC: 9168110] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[22:50:09] [DOC: 9168110] ✅ Patient date processing completed successfully
[22:50:09] ✅    ✅ Date processing completed
[22:50:09] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025'}]
[22:50:09] 🔄 
🔄 Step 4: Extracting order data...
[22:50:11] ℹ️  Order extraction - MRN: ''
[22:50:11] ℹ️  Order extraction - Sex: 'FEMALE'
[22:50:11] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:50:11] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:50:11] ✅ Order data extraction completed successfully
[22:50:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:50:11] ℹ️  Using MRN from patient data: '323014'
[22:50:11] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:50:11] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:50:11] ✅ Patient name cross-validation successful
[22:50:11] ✅    ✅ Data merged successfully
[22:50:12] ✅    ✅ Order data extracted and validated
[22:50:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:50:12] [DOC: 9168110] ✅ Patient found in local cache: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[22:50:12] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[22:50:12] 🔄 
🔄 Step 6: Pushing order to API...
[22:50:12] [DOC: 9168110] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[22:50:14] [DOC: 9168110] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13081"}
[22:50:14] ❌    ❌ Failed to push order
[22:50:14] 🔄 
🔄 Step 7: Writing to CSV...
[22:50:14] [DOC: 9168110] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[22:50:14] [DOC: 9168110] ℹ️  Service Line extracted: 'RN, LPN'
[22:50:14] [DOC: 9168110] ℹ️  Payer Source extracted: 'Medicare'
[22:50:14] [DOC: 9168110] ℹ️  Diagnosis codes being written:
[22:50:14] [DOC: 9168110] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:50:14] [DOC: 9168110] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:50:14] [DOC: 9168110] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:50:14] [DOC: 9168110] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:50:14] [DOC: 9168110] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:50:14] [DOC: 9168110] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:50:14] [DOC: 9168110] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: RN, LPN | Payer: Medicare | MRN: 323014
[22:50:14] ✅    ✅ Document 9168110 processed and saved successfully
[22:50:14] 🔄 
🔄 Step 8: Saving API details...
[22:50:14] [DOC: 9168110] ℹ️  API push details saved for document 9168110
[22:50:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168106                         ║
================================================================================
[22:50:14] ℹ️  Agency: Dartmouth HH
[22:50:14] ℹ️  Date: 03/07/2025
[22:50:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:50:17] [DOC: 9168106] ✅ Text extracted using pdfplumber (18279 chars)
[22:50:17] ✅    ✅ Text extracted using pdfplumber (18267 chars)
[22:50:17] 🔄 
🔄 Step 2: Extracting patient data...
[22:50:20] ℹ️  AI extracted raw sex value: 'F'
[22:50:20] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[22:50:20] ℹ️  AI extracted payer source: ''
[22:50:20] ℹ️  AI extracted diagnoses:
[22:50:20] ℹ️    - Diagnosis 1: 'E10.65'
[22:50:20] ℹ️    - Diagnosis 2: 'I10'
[22:50:20] ℹ️    - Diagnosis 3: 'E10.40'
[22:50:20] ℹ️    - Diagnosis 4: 'E83.52'
[22:50:20] ℹ️    - Diagnosis 5: 'N39.41'
[22:50:20] ℹ️    - Diagnosis 6: 'M41.86'
[22:50:20] ℹ️  Final extracted MRN: '3320011'
[22:50:20] ℹ️  Final extracted Sex: 'FEMALE'
[22:50:20] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[22:50:20] ℹ️  Final extracted Payer Source: ''
[22:50:20] ✅ Patient data extraction completed successfully
[22:50:20] ✅    ✅ Patient data extracted successfully
[22:50:20] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'E10.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E10.40', 'fourthDiagnosis': 'E83.52', 'fifthDiagnosis': 'N39.41', 'sixthDiagnosis': 'M41.86'}]
[22:50:20] ✅    ✅ Patient identified: Bonnie Werly
[22:50:20] ✅    ✅ Patient name validation passed
[22:50:20] 🔄 
🔄 Step 3: Processing patient dates...
[22:50:20] [DOC: 9168106] ℹ️  DOB normalized: 06/16/1939
[22:50:20] [DOC: 9168106] ℹ️  Episode startOfCare normalized: 09/01/2024
[22:50:20] [DOC: 9168106] ℹ️  Episode startOfEpisode normalized: 09/01/2024
[22:50:20] [DOC: 9168106] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[22:50:20] [DOC: 9168106] ✅ Patient date processing completed successfully
[22:50:20] ✅    ✅ Date processing completed
[22:50:20] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'E10.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E10.40', 'fourthDiagnosis': 'E83.52', 'fifthDiagnosis': 'N39.41', 'sixthDiagnosis': 'M41.86'}]
[22:50:20] 🔄 
🔄 Step 4: Extracting order data...
[22:50:23] ℹ️  Order extraction - MRN: '3320011'
[22:50:23] ℹ️  Order extraction - Sex: 'FEMALE'
[22:50:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[22:50:23] ℹ️  Order extraction - Payer Source: ''
[22:50:23] ✅ Order data extraction completed successfully
[22:50:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:50:23] ℹ️  Using MRN from patient data: '3320011' over '3320011'
[22:50:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[22:50:23] ✅ Patient name cross-validation successful
[22:50:23] ✅    ✅ Data merged successfully
[22:50:24] ✅    ✅ Order data extracted and validated
[22:50:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:50:24] [DOC: 9168106] ✅ Patient found in local cache: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:50:24] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:50:24] 🔄 
🔄 Step 6: Pushing order to API...
[22:50:24] [DOC: 9168106] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:50:25] [DOC: 9168106] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:50:25] ❌    ❌ Failed to push order
[22:50:25] 🔄 
🔄 Step 7: Writing to CSV...
[22:50:25] [DOC: 9168106] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[22:50:25] [DOC: 9168106] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[22:50:25] [DOC: 9168106] ℹ️  Payer Source extracted: ''
[22:50:25] [DOC: 9168106] ℹ️  Diagnosis codes being written:
[22:50:25] [DOC: 9168106] ℹ️    - Latest_Episode_Firstdiagnosis: 'E10.65'
[22:50:25] [DOC: 9168106] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[22:50:25] [DOC: 9168106] ℹ️    - Latest_Episode_Thirddiagnosis: 'E10.40'
[22:50:25] [DOC: 9168106] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E83.52'
[22:50:25] [DOC: 9168106] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N39.41'
[22:50:25] [DOC: 9168106] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M41.86'
[22:50:25] [DOC: 9168106] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 3320011
[22:50:25] ✅    ✅ Document 9168106 processed and saved successfully
[22:50:25] 🔄 
🔄 Step 8: Saving API details...
[22:50:25] [DOC: 9168106] ℹ️  API push details saved for document 9168106
[22:50:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168101                         ║
================================================================================
[22:50:25] ℹ️  Agency: Dartmouth HH
[22:50:25] ℹ️  Date: 03/07/2025
[22:50:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:50:27] [DOC: 9168101] ✅ Text extracted using pdfplumber (1906 chars)
[22:50:27] ✅    ✅ Text extracted using pdfplumber (1906 chars)
[22:50:27] 🔄 
🔄 Step 2: Extracting patient data...
[22:50:30] ℹ️  AI extracted raw sex value: 'F'
[22:50:30] ℹ️  AI extracted service line: 'RN, PT'
[22:50:30] ℹ️  AI extracted payer source: 'Medicare'
[22:50:30] ℹ️  AI extracted diagnoses:
[22:50:30] ℹ️    - Diagnosis 1: ''
[22:50:30] ℹ️    - Diagnosis 2: ''
[22:50:30] ℹ️    - Diagnosis 3: ''
[22:50:30] ℹ️    - Diagnosis 4: ''
[22:50:30] ℹ️    - Diagnosis 5: ''
[22:50:30] ℹ️    - Diagnosis 6: ''
[22:50:30] ℹ️  Final extracted MRN: '3320011'
[22:50:30] ℹ️  Final extracted Sex: 'FEMALE'
[22:50:30] ℹ️  Final extracted Service Line: 'RN, PT'
[22:50:30] ℹ️  Final extracted Payer Source: 'Medicare'
[22:50:30] ✅ Patient data extraction completed successfully
[22:50:30] ✅    ✅ Patient data extracted successfully
[22:50:30] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '02/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:50:30] ✅    ✅ Patient identified: Bonnie Werly
[22:50:30] ✅    ✅ Patient name validation passed
[22:50:30] 🔄 
🔄 Step 3: Processing patient dates...
[22:50:30] [DOC: 9168101] ℹ️  DOB normalized: 06/16/1939
[22:50:30] [DOC: 9168101] ℹ️  Episode startOfCare normalized: 09/01/2024
[22:50:30] [DOC: 9168101] ℹ️  Episode startOfEpisode normalized: 09/01/2024
[22:50:30] [DOC: 9168101] ℹ️  Episode endOfEpisode normalized: 02/27/2025
[22:50:30] [DOC: 9168101] ✅ Patient date processing completed successfully
[22:50:30] ✅    ✅ Date processing completed
[22:50:30] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '02/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:50:30] 🔄 
🔄 Step 4: Extracting order data...
[22:50:32] ℹ️  Order extraction - MRN: ''
[22:50:32] ℹ️  Order extraction - Sex: 'FEMALE'
[22:50:32] ℹ️  Order extraction - Service Line: 'PT, RN'
[22:50:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:50:32] ✅ Order data extraction completed successfully
[22:50:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:50:32] ℹ️  Using MRN from patient data: '3320011'
[22:50:32] ℹ️  Combined service lines: Patient='RN, PT' + Order='PT, RN' = 'PT, RN'
[22:50:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:50:32] ✅ Patient name cross-validation successful
[22:50:32] ✅    ✅ Data merged successfully
[22:50:33] ✅    ✅ Order data extracted and validated
[22:50:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:50:33] [DOC: 9168101] ✅ Patient found in local cache: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:50:33] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:50:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:50:33] [DOC: 9168101] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[22:50:35] [DOC: 9168101] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14422"}
[22:50:35] ❌    ❌ Failed to push order
[22:50:35] 🔄 
🔄 Step 7: Writing to CSV...
[22:50:35] [DOC: 9168101] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[22:50:35] [DOC: 9168101] ℹ️  Service Line extracted: 'PT, RN'
[22:50:35] [DOC: 9168101] ℹ️  Payer Source extracted: 'Medicare'
[22:50:35] [DOC: 9168101] ℹ️  Diagnosis codes being written:
[22:50:35] [DOC: 9168101] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:50:35] [DOC: 9168101] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:50:35] [DOC: 9168101] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:50:35] [DOC: 9168101] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:50:35] [DOC: 9168101] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:50:35] [DOC: 9168101] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:50:35] [DOC: 9168101] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: PT, RN | Payer: Medicare | MRN: 3320011
[22:50:35] ✅    ✅ Document 9168101 processed and saved successfully
[22:50:35] 🔄 
🔄 Step 8: Saving API details...
[22:50:35] [DOC: 9168101] ℹ️  API push details saved for document 9168101
[22:50:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168099                         ║
================================================================================
[22:50:35] ℹ️  Agency: Dartmouth HH
[22:50:35] ℹ️  Date: 03/07/2025
[22:50:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:50:37] [DOC: 9168099] ✅ Text extracted using pdfplumber (1382 chars)
[22:50:37] ✅    ✅ Text extracted using pdfplumber (1382 chars)
[22:50:37] 🔄 
🔄 Step 2: Extracting patient data...
[22:50:39] ℹ️  AI extracted raw sex value: 'M'
[22:50:39] ℹ️  AI extracted service line: 'OT, RN'
[22:50:39] ℹ️  AI extracted payer source: 'Medicare'
[22:50:39] ℹ️  AI extracted diagnoses:
[22:50:39] ℹ️    - Diagnosis 1: ''
[22:50:39] ℹ️    - Diagnosis 2: ''
[22:50:39] ℹ️    - Diagnosis 3: ''
[22:50:39] ℹ️    - Diagnosis 4: ''
[22:50:39] ℹ️    - Diagnosis 5: ''
[22:50:39] ℹ️    - Diagnosis 6: ''
[22:50:39] ℹ️  Final extracted MRN: '1021015'
[22:50:39] ℹ️  Final extracted Sex: 'MALE'
[22:50:39] ℹ️  Final extracted Service Line: 'OT, RN'
[22:50:39] ℹ️  Final extracted Payer Source: 'Medicare'
[22:50:39] ✅ Patient data extraction completed successfully
[22:50:39] ✅    ✅ Patient data extracted successfully
[22:50:39] 📊 Patient Response
     └─ patientFName: Charles
     └─ patientLName: McKenna
     └─ dob: 11/21/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 1021015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 30 Bullock St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/23/2024', 'startOfEpisode': '10/23/2024', 'endOfEpisode': '02/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:50:39] ✅    ✅ Patient identified: Charles McKenna
[22:50:39] ✅    ✅ Patient name validation passed
[22:50:39] 🔄 
🔄 Step 3: Processing patient dates...
[22:50:39] [DOC: 9168099] ℹ️  DOB normalized: 11/21/1942
[22:50:39] [DOC: 9168099] ℹ️  Episode startOfCare normalized: 10/23/2024
[22:50:39] [DOC: 9168099] ℹ️  Episode startOfEpisode normalized: 10/23/2024
[22:50:39] [DOC: 9168099] ℹ️  Episode endOfEpisode normalized: 02/19/2025
[22:50:39] [DOC: 9168099] ✅ Patient date processing completed successfully
[22:50:39] ✅    ✅ Date processing completed
[22:50:39] 📊 Processed Patient Data
     └─ patientFName: Charles
     └─ patientLName: McKenna
     └─ dob: 11/21/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 1021015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 30 Bullock St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/23/2024', 'startOfEpisode': '10/23/2024', 'endOfEpisode': '02/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:50:39] 🔄 
🔄 Step 4: Extracting order data...
[22:50:42] ℹ️  Order extraction - MRN: ''
[22:50:42] ℹ️  Order extraction - Sex: 'MALE'
[22:50:42] ℹ️  Order extraction - Service Line: 'OT,HHA'
[22:50:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:50:42] ✅ Order data extraction completed successfully
[22:50:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:50:42] ℹ️  Using MRN from patient data: '1021015'
[22:50:42] ℹ️  Combined service lines: Patient='OT, RN' + Order='OT,HHA' = 'HHA, OT, RN'
[22:50:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:50:42] ✅ Patient name cross-validation successful
[22:50:42] ✅    ✅ Data merged successfully
[22:50:43] ✅    ✅ Order data extracted and validated
[22:50:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:50:48] [DOC: 9168099] ✅ Patient exists in API: Charles McKenna, ID: 84bef157-e69d-4d59-9c65-8f16a73fa26f
[22:50:48] ✅    ✅ Existing patient found with ID: 84bef157-e69d-4d59-9c65-8f16a73fa26f
[22:50:48] 🔄 
🔄 Step 6: Pushing order to API...
[22:50:48] [DOC: 9168099] ℹ️  Pushing order via API for patient ID: 84bef157-e69d-4d59-9c65-8f16a73fa26f
[22:50:50] [DOC: 9168099] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14056"}
[22:50:50] ❌    ❌ Failed to push order
[22:50:50] 🔄 
🔄 Step 7: Writing to CSV...
[22:50:50] [DOC: 9168099] ℹ️  Calculated age: 82 from DOB: 11/21/1942
[22:50:50] [DOC: 9168099] ℹ️  Service Line extracted: 'HHA, OT, RN'
[22:50:50] [DOC: 9168099] ℹ️  Payer Source extracted: 'Medicare'
[22:50:50] [DOC: 9168099] ℹ️  Diagnosis codes being written:
[22:50:50] [DOC: 9168099] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:50:50] [DOC: 9168099] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:50:50] [DOC: 9168099] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:50:50] [DOC: 9168099] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:50:50] [DOC: 9168099] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:50:50] [DOC: 9168099] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:50:50] [DOC: 9168099] ✅ Patient data written to CSV: Charles McKenna | Sex: MALE | Age: 82 | Service: HHA, OT, RN | Payer: Medicare | MRN: 1021015
[22:50:50] ✅    ✅ Document 9168099 processed and saved successfully
[22:50:50] 🔄 
🔄 Step 8: Saving API details...
[22:50:50] [DOC: 9168099] ℹ️  API push details saved for document 9168099
[22:50:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168096                         ║
================================================================================
[22:50:50] ℹ️  Agency: Dartmouth HH
[22:50:50] ℹ️  Date: 03/07/2025
[22:50:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:50:51] [DOC: 9168096] ✅ Text extracted using pdfplumber (1184 chars)
[22:50:51] ✅    ✅ Text extracted using pdfplumber (1184 chars)
[22:50:51] 🔄 
🔄 Step 2: Extracting patient data...
[22:50:54] ℹ️  AI extracted raw sex value: 'F'
[22:50:54] ℹ️  AI extracted service line: 'RN'
[22:50:54] ℹ️  AI extracted payer source: 'Medicare'
[22:50:54] ℹ️  AI extracted diagnoses:
[22:50:54] ℹ️    - Diagnosis 1: ''
[22:50:54] ℹ️    - Diagnosis 2: ''
[22:50:54] ℹ️    - Diagnosis 3: ''
[22:50:54] ℹ️    - Diagnosis 4: ''
[22:50:54] ℹ️    - Diagnosis 5: ''
[22:50:54] ℹ️    - Diagnosis 6: ''
[22:50:54] ℹ️  Final extracted MRN: '5094015'
[22:50:54] ℹ️  Final extracted Sex: 'FEMALE'
[22:50:54] ℹ️  Final extracted Service Line: 'RN'
[22:50:54] ℹ️  Final extracted Payer Source: 'Medicare'
[22:50:54] ✅ Patient data extraction completed successfully
[22:50:54] ✅    ✅ Patient data extracted successfully
[22:50:54] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '08/26/2024', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:50:54] ✅    ✅ Patient identified: Laura Gregoire
[22:50:54] ✅    ✅ Patient name validation passed
[22:50:54] 🔄 
🔄 Step 3: Processing patient dates...
[22:50:54] [DOC: 9168096] ℹ️  DOB normalized: 12/06/1944
[22:50:54] [DOC: 9168096] ℹ️  Episode startOfCare normalized: 08/26/2024
[22:50:54] [DOC: 9168096] ℹ️  Episode startOfEpisode normalized: 08/26/2024
[22:50:54] [DOC: 9168096] ℹ️  Episode endOfEpisode normalized: 02/21/2025
[22:50:54] [DOC: 9168096] ✅ Patient date processing completed successfully
[22:50:54] ✅    ✅ Date processing completed
[22:50:54] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '08/26/2024', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:50:54] 🔄 
🔄 Step 4: Extracting order data...
[22:50:56] ℹ️  Order extraction - MRN: ''
[22:50:56] ℹ️  Order extraction - Sex: 'FEMALE'
[22:50:56] ℹ️  Order extraction - Service Line: 'RN'
[22:50:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:50:56] ✅ Order data extraction completed successfully
[22:50:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:50:56] ℹ️  Using MRN from patient data: '5094015'
[22:50:56] ℹ️  Service line consistent in both sources: 'RN'
[22:50:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:50:56] ✅ Patient name cross-validation successful
[22:50:56] ✅    ✅ Data merged successfully
[22:50:58] ✅    ✅ Order data extracted and validated
[22:50:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:50:58] [DOC: 9168096] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[22:50:58] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[22:50:58] 🔄 
🔄 Step 6: Pushing order to API...
[22:50:58] [DOC: 9168096] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[22:50:59] [DOC: 9168096] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13825"}
[22:50:59] ❌    ❌ Failed to push order
[22:50:59] 🔄 
🔄 Step 7: Writing to CSV...
[22:50:59] [DOC: 9168096] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[22:50:59] [DOC: 9168096] ℹ️  Service Line extracted: 'RN'
[22:50:59] [DOC: 9168096] ℹ️  Payer Source extracted: 'Medicare'
[22:50:59] [DOC: 9168096] ℹ️  Diagnosis codes being written:
[22:50:59] [DOC: 9168096] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:50:59] [DOC: 9168096] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:50:59] [DOC: 9168096] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:50:59] [DOC: 9168096] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:50:59] [DOC: 9168096] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:50:59] [DOC: 9168096] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:50:59] [DOC: 9168096] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: RN | Payer: Medicare | MRN: 5094015
[22:50:59] ✅    ✅ Document 9168096 processed and saved successfully
[22:50:59] 🔄 
🔄 Step 8: Saving API details...
[22:50:59] [DOC: 9168096] ℹ️  API push details saved for document 9168096
[22:50:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168092                         ║
================================================================================
[22:50:59] ℹ️  Agency: Dartmouth HH
[22:50:59] ℹ️  Date: 03/07/2025
[22:50:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:51:02] [DOC: 9168092] ✅ Text extracted using pdfplumber (11185 chars)
[22:51:02] ✅    ✅ Text extracted using pdfplumber (11185 chars)
[22:51:02] 🔄 
🔄 Step 2: Extracting patient data...
[22:51:05] ℹ️  AI extracted raw sex value: 'F'
[22:51:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:51:05] ℹ️  AI extracted payer source: ''
[22:51:05] ℹ️  AI extracted diagnoses:
[22:51:05] ℹ️    - Diagnosis 1: 'I11.0'
[22:51:05] ℹ️    - Diagnosis 2: 'I50.30'
[22:51:05] ℹ️    - Diagnosis 3: 'R55'
[22:51:05] ℹ️    - Diagnosis 4: 'R30.0'
[22:51:05] ℹ️    - Diagnosis 5: 'E03.9'
[22:51:05] ℹ️    - Diagnosis 6: 'G89.29'
[22:51:05] ℹ️  Final extracted MRN: '227027'
[22:51:05] ℹ️  Final extracted Sex: 'FEMALE'
[22:51:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:51:05] ℹ️  Final extracted Payer Source: ''
[22:51:05] ✅ Patient data extraction completed successfully
[22:51:05] ✅    ✅ Patient data extracted successfully
[22:51:05] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '01/08/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'R55', 'fourthDiagnosis': 'R30.0', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G89.29'}]
[22:51:05] ✅    ✅ Patient identified: Joan E Swift
[22:51:05] ✅    ✅ Patient name validation passed
[22:51:05] 🔄 
🔄 Step 3: Processing patient dates...
[22:51:05] [DOC: 9168092] ℹ️  DOB normalized: 05/05/1943
[22:51:05] [DOC: 9168092] ℹ️  Episode startOfCare normalized: 01/08/2025
[22:51:05] [DOC: 9168092] ℹ️  Episode startOfEpisode normalized: 01/08/2025
[22:51:05] [DOC: 9168092] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[22:51:05] [DOC: 9168092] ✅ Patient date processing completed successfully
[22:51:05] ✅    ✅ Date processing completed
[22:51:05] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '01/08/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'R55', 'fourthDiagnosis': 'R30.0', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G89.29'}]
[22:51:05] 🔄 
🔄 Step 4: Extracting order data...
[22:51:07] ℹ️  Order extraction - MRN: '4034011'
[22:51:07] ℹ️  Order extraction - Sex: 'FEMALE'
[22:51:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:51:07] ℹ️  Order extraction - Payer Source: ''
[22:51:07] ✅ Order data extraction completed successfully
[22:51:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:51:07] ℹ️  Using longer MRN from order data: '4034011' over '227027'
[22:51:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:51:07] ✅ Patient name cross-validation successful
[22:51:07] ✅    ✅ Data merged successfully
[22:51:08] ✅    ✅ Order data extracted and validated
[22:51:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:51:19] [DOC: 9168092] ℹ️  Patient not found in cache or API: Joan E Swift
[22:51:19] [DOC: 9168092] ℹ️  Patient not found, creating new patient via API...
[22:51:19] [DOC: 9168092] ℹ️  Creating patient via API: Joan E Swift
[22:51:20] [DOC: 9168092] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:51:20] ❌    ❌ Failed to create patient
[22:51:20] [DOC: 9168092] ℹ️  API push details saved for document 9168092
================================================================================
║                        Processing Document ID: 9168087                         ║
================================================================================
[22:51:20] ℹ️  Agency: Dartmouth HH
[22:51:20] ℹ️  Date: 03/07/2025
[22:51:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:51:22] [DOC: 9168087] ✅ Text extracted using pdfplumber (1056 chars)
[22:51:22] ✅    ✅ Text extracted using pdfplumber (1056 chars)
[22:51:22] 🔄 
🔄 Step 2: Extracting patient data...
[22:51:25] ℹ️  AI extracted raw sex value: 'F'
[22:51:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:51:25] ℹ️  AI extracted payer source: 'Fallon Health'
[22:51:25] ℹ️  AI extracted diagnoses:
[22:51:25] ℹ️    - Diagnosis 1: ''
[22:51:25] ℹ️    - Diagnosis 2: ''
[22:51:25] ℹ️    - Diagnosis 3: ''
[22:51:25] ℹ️    - Diagnosis 4: ''
[22:51:25] ℹ️    - Diagnosis 5: ''
[22:51:25] ℹ️    - Diagnosis 6: ''
[22:51:25] ℹ️  Final extracted MRN: '4034011'
[22:51:25] ℹ️  Final extracted Sex: 'FEMALE'
[22:51:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:51:25] ℹ️  Final extracted Payer Source: 'Fallon Health'
[22:51:25] ✅ Patient data extraction completed successfully
[22:51:25] ✅    ✅ Patient data extracted successfully
[22:51:25] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '01/08/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:51:25] ✅    ✅ Patient identified: Joan E Swift
[22:51:25] ✅    ✅ Patient name validation passed
[22:51:25] 🔄 
🔄 Step 3: Processing patient dates...
[22:51:25] [DOC: 9168087] ℹ️  DOB normalized: 05/05/1943
[22:51:25] [DOC: 9168087] ℹ️  Episode startOfCare normalized: 01/08/2025
[22:51:25] [DOC: 9168087] ℹ️  Episode startOfEpisode normalized: 01/08/2025
[22:51:25] [DOC: 9168087] ℹ️  Episode endOfEpisode normalized: 03/08/2025
[22:51:25] [DOC: 9168087] ✅ Patient date processing completed successfully
[22:51:25] ✅    ✅ Date processing completed
[22:51:25] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '01/08/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:51:25] 🔄 
🔄 Step 4: Extracting order data...
[22:51:27] ℹ️  Order extraction - MRN: '4034011'
[22:51:27] ℹ️  Order extraction - Sex: 'FEMALE'
[22:51:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:51:27] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[22:51:27] ✅ Order data extraction completed successfully
[22:51:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:51:27] ℹ️  Using MRN from patient data: '4034011' over '4034011'
[22:51:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:51:27] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[22:51:27] ✅ Patient name cross-validation successful
[22:51:27] ✅    ✅ Data merged successfully
[22:51:28] ✅    ✅ Order data extracted and validated
[22:51:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:51:42] [DOC: 9168087] ℹ️  Patient not found in cache or API: Joan E Swift
[22:51:42] [DOC: 9168087] ℹ️  Patient not found, creating new patient via API...
[22:51:42] [DOC: 9168087] ℹ️  Creating patient via API: Joan E Swift
[22:51:44] [DOC: 9168087] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:51:44] ❌    ❌ Failed to create patient
[22:51:44] [DOC: 9168087] ℹ️  API push details saved for document 9168087
================================================================================
║                        Processing Document ID: 9168083                         ║
================================================================================
[22:51:44] ℹ️  Agency: Dartmouth HH
[22:51:44] ℹ️  Date: 03/07/2025
[22:51:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:51:46] [DOC: 9168083] ✅ Text extracted using pdfplumber (1327 chars)
[22:51:46] ✅    ✅ Text extracted using pdfplumber (1327 chars)
[22:51:46] 🔄 
🔄 Step 2: Extracting patient data...
[22:51:48] ℹ️  AI extracted raw sex value: 'F'
[22:51:48] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[22:51:48] ℹ️  AI extracted payer source: 'Medicare'
[22:51:48] ℹ️  AI extracted diagnoses:
[22:51:48] ℹ️    - Diagnosis 1: ''
[22:51:48] ℹ️    - Diagnosis 2: ''
[22:51:48] ℹ️    - Diagnosis 3: ''
[22:51:48] ℹ️    - Diagnosis 4: ''
[22:51:48] ℹ️    - Diagnosis 5: ''
[22:51:48] ℹ️    - Diagnosis 6: ''
[22:51:48] ℹ️  Final extracted MRN: '5071015'
[22:51:48] ℹ️  Final extracted Sex: 'FEMALE'
[22:51:48] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[22:51:48] ℹ️  Final extracted Payer Source: 'Medicare'
[22:51:48] ✅ Patient data extraction completed successfully
[22:51:48] ✅    ✅ Patient data extracted successfully
[22:51:48] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Desilva
     └─ dob: 08/23/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5071015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/14/2024', 'startOfEpisode': '02/10/2025', 'endOfEpisode': '04/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:51:48] ✅    ✅ Patient identified: Irene Desilva
[22:51:48] ✅    ✅ Patient name validation passed
[22:51:48] 🔄 
🔄 Step 3: Processing patient dates...
[22:51:48] [DOC: 9168083] ℹ️  DOB normalized: 08/23/1923
[22:51:48] [DOC: 9168083] ℹ️  Episode startOfCare normalized: 08/14/2024
[22:51:48] [DOC: 9168083] ℹ️  Episode startOfEpisode normalized: 02/10/2025
[22:51:48] [DOC: 9168083] ℹ️  Episode endOfEpisode normalized: 04/10/2025
[22:51:48] [DOC: 9168083] ✅ Patient date processing completed successfully
[22:51:48] ✅    ✅ Date processing completed
[22:51:48] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Desilva
     └─ dob: 08/23/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5071015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/14/2024', 'startOfEpisode': '02/10/2025', 'endOfEpisode': '04/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:51:48] 🔄 
🔄 Step 4: Extracting order data...
[22:51:51] ℹ️  Order extraction - MRN: '5071015'
[22:51:51] ℹ️  Order extraction - Sex: 'FEMALE'
[22:51:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing, HHA'
[22:51:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:51:51] ✅ Order data extraction completed successfully
[22:51:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:51:51] ℹ️  Using MRN from patient data: '5071015' over '5071015'
[22:51:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing, HHA'
[22:51:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:51:51] ✅ Patient name cross-validation successful
[22:51:51] ✅    ✅ Data merged successfully
[22:51:52] ✅    ✅ Order data extracted and validated
[22:51:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:52:00] [DOC: 9168083] ✅ Patient exists in API: Irene Desilva, ID: 66c4b5d9-c5f2-4d84-a52d-42eeac96e878
[22:52:00] ✅    ✅ Existing patient found with ID: 66c4b5d9-c5f2-4d84-a52d-42eeac96e878
[22:52:00] 🔄 
🔄 Step 6: Pushing order to API...
[22:52:00] [DOC: 9168083] ℹ️  Pushing order via API for patient ID: 66c4b5d9-c5f2-4d84-a52d-42eeac96e878
[22:52:01] [DOC: 9168083] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:52:01] ❌    ❌ Failed to push order
[22:52:01] 🔄 
🔄 Step 7: Writing to CSV...
[22:52:01] [DOC: 9168083] ℹ️  Calculated age: 101 from DOB: 08/23/1923
[22:52:01] [DOC: 9168083] ℹ️  Service Line extracted: 'Skilled Nursing, HHA'
[22:52:01] [DOC: 9168083] ℹ️  Payer Source extracted: 'Medicare'
[22:52:01] [DOC: 9168083] ℹ️  Diagnosis codes being written:
[22:52:01] [DOC: 9168083] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:52:01] [DOC: 9168083] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:52:01] [DOC: 9168083] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:52:01] [DOC: 9168083] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:52:01] [DOC: 9168083] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:52:01] [DOC: 9168083] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:52:01] [DOC: 9168083] ✅ Patient data written to CSV: Irene Desilva | Sex: FEMALE | Age: 101 | Service: Skilled Nursing, HHA | Payer: Medicare | MRN: 5071015
[22:52:01] ✅    ✅ Document 9168083 processed and saved successfully
[22:52:01] 🔄 
🔄 Step 8: Saving API details...
[22:52:01] [DOC: 9168083] ℹ️  API push details saved for document 9168083
[22:52:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168078                         ║
================================================================================
[22:52:01] ℹ️  Agency: Dartmouth HH
[22:52:01] ℹ️  Date: 03/07/2025
[22:52:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:52:03] [DOC: 9168078] ✅ Text extracted using pdfplumber (1072 chars)
[22:52:03] ✅    ✅ Text extracted using pdfplumber (1072 chars)
[22:52:03] 🔄 
🔄 Step 2: Extracting patient data...
[22:52:06] ℹ️  AI extracted raw sex value: 'F'
[22:52:06] ℹ️  AI extracted service line: 'Physical Therapy, HHA'
[22:52:06] ℹ️  AI extracted payer source: 'Medicare'
[22:52:06] ℹ️  AI extracted diagnoses:
[22:52:06] ℹ️    - Diagnosis 1: 'None'
[22:52:06] ℹ️    - Diagnosis 2: 'None'
[22:52:06] ℹ️    - Diagnosis 3: 'None'
[22:52:06] ℹ️    - Diagnosis 4: 'None'
[22:52:06] ℹ️    - Diagnosis 5: 'None'
[22:52:06] ℹ️    - Diagnosis 6: 'None'
[22:52:06] ℹ️  Final extracted MRN: '5280015'
[22:52:06] ℹ️  Final extracted Sex: 'FEMALE'
[22:52:06] ℹ️  Final extracted Service Line: 'Physical Therapy, HHA'
[22:52:06] ℹ️  Final extracted Payer Source: 'Medicare'
[22:52:06] ✅ Patient data extraction completed successfully
[22:52:06] ✅    ✅ Patient data extracted successfully
[22:52:06] 📊 Patient Response
     └─ patientFName: Sheila
     └─ patientLName: Couto
     └─ dob: 03/07/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5280015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 37 West St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:52:06] ✅    ✅ Patient identified: Sheila Couto
[22:52:06] ✅    ✅ Patient name validation passed
[22:52:06] 🔄 
🔄 Step 3: Processing patient dates...
[22:52:06] [DOC: 9168078] ℹ️  DOB normalized: 03/07/1943
[22:52:06] [DOC: 9168078] ℹ️  Episode startOfCare normalized: 01/22/2025
[22:52:06] [DOC: 9168078] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[22:52:06] [DOC: 9168078] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[22:52:06] [DOC: 9168078] ✅ Patient date processing completed successfully
[22:52:06] ✅    ✅ Date processing completed
[22:52:06] 📊 Processed Patient Data
     └─ patientFName: Sheila
     └─ patientLName: Couto
     └─ dob: 03/07/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5280015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 37 West St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/22/2025'}]
[22:52:06] 🔄 
🔄 Step 4: Extracting order data...
[22:52:08] ℹ️  Order extraction - MRN: '5280015'
[22:52:08] ℹ️  Order extraction - Sex: 'FEMALE'
[22:52:08] ℹ️  Order extraction - Service Line: 'HHA, PT'
[22:52:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:52:08] ✅ Order data extraction completed successfully
[22:52:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:52:08] ℹ️  Using MRN from patient data: '5280015' over '5280015'
[22:52:08] ℹ️  Combined service lines: Patient='Physical Therapy, HHA' + Order='HHA, PT' = 'HHA, PT, Physical Therapy'
[22:52:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:52:08] ✅ Patient name cross-validation successful
[22:52:08] ✅    ✅ Data merged successfully
[22:52:09] ✅    ✅ Order data extracted and validated
[22:52:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:52:24] [DOC: 9168078] ℹ️  Patient not found in cache or API: Sheila Couto
[22:52:24] [DOC: 9168078] ℹ️  Patient not found, creating new patient via API...
[22:52:24] [DOC: 9168078] ℹ️  Creating patient via API: Sheila Couto
[22:52:25] [DOC: 9168078] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:52:25] ❌    ❌ Failed to create patient
[22:52:25] [DOC: 9168078] ℹ️  API push details saved for document 9168078
================================================================================
║                        Processing Document ID: 9168073                         ║
================================================================================
[22:52:25] ℹ️  Agency: Dartmouth HH
[22:52:25] ℹ️  Date: 03/07/2025
[22:52:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:52:27] [DOC: 9168073] ✅ Text extracted using pdfplumber (2726 chars)
[22:52:27] ✅    ✅ Text extracted using pdfplumber (2726 chars)
[22:52:27] 🔄 
🔄 Step 2: Extracting patient data...
[22:52:30] ℹ️  AI extracted raw sex value: 'F'
[22:52:30] ℹ️  AI extracted service line: 'SN, PT'
[22:52:30] ℹ️  AI extracted payer source: 'Medicare'
[22:52:30] ℹ️  AI extracted diagnoses:
[22:52:30] ℹ️    - Diagnosis 1: ''
[22:52:30] ℹ️    - Diagnosis 2: ''
[22:52:30] ℹ️    - Diagnosis 3: ''
[22:52:30] ℹ️    - Diagnosis 4: ''
[22:52:30] ℹ️    - Diagnosis 5: ''
[22:52:30] ℹ️    - Diagnosis 6: ''
[22:52:30] ℹ️  Final extracted MRN: '2892015'
[22:52:30] ℹ️  Final extracted Sex: 'FEMALE'
[22:52:30] ℹ️  Final extracted Service Line: 'SN, PT'
[22:52:30] ℹ️  Final extracted Payer Source: 'Medicare'
[22:52:30] ✅ Patient data extraction completed successfully
[22:52:30] ✅    ✅ Patient data extracted successfully
[22:52:30] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Garrant
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 35 Lucy little Rd
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: SN, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:52:30] ✅    ✅ Patient identified: Beverly Garrant
[22:52:30] ✅    ✅ Patient name validation passed
[22:52:30] 🔄 
🔄 Step 3: Processing patient dates...
[22:52:30] [DOC: 9168073] ℹ️  DOB normalized: 01/24/1939
[22:52:30] [DOC: 9168073] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:52:30] [DOC: 9168073] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[22:52:30] [DOC: 9168073] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[22:52:30] [DOC: 9168073] ✅ Patient date processing completed successfully
[22:52:30] ✅    ✅ Date processing completed
[22:52:30] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Garrant
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 35 Lucy little Rd
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: SN, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:52:30] 🔄 
🔄 Step 4: Extracting order data...
[22:52:32] ℹ️  Order extraction - MRN: ''
[22:52:32] ℹ️  Order extraction - Sex: 'FEMALE'
[22:52:32] ℹ️  Order extraction - Service Line: 'SN, PT'
[22:52:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:52:32] ✅ Order data extraction completed successfully
[22:52:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:52:32] ℹ️  Using MRN from patient data: '2892015'
[22:52:32] ℹ️  Service line consistent in both sources: 'SN, PT'
[22:52:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:52:32] ✅ Patient name cross-validation successful
[22:52:32] ✅    ✅ Data merged successfully
[22:52:33] ✅    ✅ Order data extracted and validated
[22:52:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:52:33] [DOC: 9168073] ✅ Patient found in local cache: Beverly Garrant, ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[22:52:33] ✅    ✅ Existing patient found with ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[22:52:33] 🔄 
🔄 Step 6: Pushing order to API...
[22:52:33] [DOC: 9168073] ℹ️  Pushing order via API for patient ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[22:52:35] [DOC: 9168073] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:52:35] ❌    ❌ Failed to push order
[22:52:35] 🔄 
🔄 Step 7: Writing to CSV...
[22:52:35] [DOC: 9168073] ℹ️  Calculated age: 86 from DOB: 01/24/1939
[22:52:35] [DOC: 9168073] ℹ️  Service Line extracted: 'SN, PT'
[22:52:35] [DOC: 9168073] ℹ️  Payer Source extracted: 'Medicare'
[22:52:35] [DOC: 9168073] ℹ️  Diagnosis codes being written:
[22:52:35] [DOC: 9168073] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:52:35] [DOC: 9168073] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:52:35] [DOC: 9168073] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:52:35] [DOC: 9168073] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:52:35] [DOC: 9168073] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:52:35] [DOC: 9168073] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:52:35] [DOC: 9168073] ✅ Patient data written to CSV: Beverly Garrant | Sex: FEMALE | Age: 86 | Service: SN, PT | Payer: Medicare | MRN: 2892015
[22:52:35] ✅    ✅ Document 9168073 processed and saved successfully
[22:52:35] 🔄 
🔄 Step 8: Saving API details...
[22:52:35] [DOC: 9168073] ℹ️  API push details saved for document 9168073
[22:52:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168067                         ║
================================================================================
[22:52:35] ℹ️  Agency: Dartmouth HH
[22:52:35] ℹ️  Date: 03/07/2025
[22:52:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:52:38] [DOC: 9168067] ✅ Text extracted using pdfplumber (14421 chars)
[22:52:38] ✅    ✅ Text extracted using pdfplumber (14409 chars)
[22:52:38] 🔄 
🔄 Step 2: Extracting patient data...
[22:52:41] ℹ️  AI extracted raw sex value: 'F'
[22:52:41] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[22:52:41] ℹ️  AI extracted payer source: ''
[22:52:41] ℹ️  AI extracted diagnoses:
[22:52:41] ℹ️    - Diagnosis 1: 'D62'
[22:52:41] ℹ️    - Diagnosis 2: 'J96.01'
[22:52:41] ℹ️    - Diagnosis 3: 'I13.0'
[22:52:41] ℹ️    - Diagnosis 4: 'I50.33'
[22:52:41] ℹ️    - Diagnosis 5: 'N18.31'
[22:52:41] ℹ️    - Diagnosis 6: 'J10.1'
[22:52:41] ℹ️  Final extracted MRN: '2892015'
[22:52:41] ℹ️  Final extracted Sex: 'FEMALE'
[22:52:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[22:52:41] ℹ️  Final extracted Payer Source: ''
[22:52:41] ✅ Patient data extraction completed successfully
[22:52:41] ✅    ✅ Patient data extracted successfully
[22:52:41] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Garrant
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'D62', 'secondDiagnosis': 'J96.01', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.33', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'J10.1'}]
[22:52:41] ✅    ✅ Patient identified: Beverly Garrant
[22:52:41] ✅    ✅ Patient name validation passed
[22:52:41] 🔄 
🔄 Step 3: Processing patient dates...
[22:52:41] [DOC: 9168067] ℹ️  DOB normalized: 01/24/1939
[22:52:41] [DOC: 9168067] ℹ️  Episode startOfCare normalized: 02/14/2025
[22:52:41] [DOC: 9168067] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[22:52:41] [DOC: 9168067] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[22:52:41] [DOC: 9168067] ✅ Patient date processing completed successfully
[22:52:41] ✅    ✅ Date processing completed
[22:52:41] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Garrant
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'D62', 'secondDiagnosis': 'J96.01', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.33', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'J10.1'}]
[22:52:41] 🔄 
🔄 Step 4: Extracting order data...
[22:52:43] ℹ️  Order extraction - MRN: '2892015'
[22:52:43] ℹ️  Order extraction - Sex: 'FEMALE'
[22:52:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[22:52:43] ℹ️  Order extraction - Payer Source: ''
[22:52:43] ✅ Order data extraction completed successfully
[22:52:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:52:43] ℹ️  Using MRN from patient data: '2892015' over '2892015'
[22:52:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[22:52:43] ✅ Patient name cross-validation successful
[22:52:43] ✅    ✅ Data merged successfully
[22:52:44] ✅    ✅ Order data extracted and validated
[22:52:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:52:44] [DOC: 9168067] ✅ Patient found in local cache: Beverly Garrant, ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[22:52:44] ✅    ✅ Existing patient found with ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[22:52:44] 🔄 
🔄 Step 6: Pushing order to API...
[22:52:44] [DOC: 9168067] ℹ️  Pushing order via API for patient ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[22:52:45] [DOC: 9168067] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:52:45] ❌    ❌ Failed to push order
[22:52:45] 🔄 
🔄 Step 7: Writing to CSV...
[22:52:45] [DOC: 9168067] ℹ️  Calculated age: 86 from DOB: 01/24/1939
[22:52:45] [DOC: 9168067] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[22:52:45] [DOC: 9168067] ℹ️  Payer Source extracted: ''
[22:52:45] [DOC: 9168067] ℹ️  Diagnosis codes being written:
[22:52:45] [DOC: 9168067] ℹ️    - Latest_Episode_Firstdiagnosis: 'D62'
[22:52:45] [DOC: 9168067] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.01'
[22:52:45] [DOC: 9168067] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[22:52:45] [DOC: 9168067] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.33'
[22:52:45] [DOC: 9168067] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.31'
[22:52:45] [DOC: 9168067] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J10.1'
[22:52:45] [DOC: 9168067] ✅ Patient data written to CSV: Beverly Garrant | Sex: FEMALE | Age: 86 | Service: Skilled Nursing, PT | Payer:  | MRN: 2892015
[22:52:45] ✅    ✅ Document 9168067 processed and saved successfully
[22:52:45] 🔄 
🔄 Step 8: Saving API details...
[22:52:45] [DOC: 9168067] ℹ️  API push details saved for document 9168067
[22:52:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168058                         ║
================================================================================
[22:52:45] ℹ️  Agency: Dartmouth HH
[22:52:45] ℹ️  Date: 03/07/2025
[22:52:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:52:50] [DOC: 9168058] ✅ Text extracted using pdfplumber (16282 chars)
[22:52:50] ✅    ✅ Text extracted using pdfplumber (16282 chars)
[22:52:50] 🔄 
🔄 Step 2: Extracting patient data...
[22:52:53] ℹ️  AI extracted raw sex value: 'F'
[22:52:53] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[22:52:53] ℹ️  AI extracted payer source: 'Senior Whole Health'
[22:52:53] ℹ️  AI extracted diagnoses:
[22:52:53] ℹ️    - Diagnosis 1: 'I21.09'
[22:52:53] ℹ️    - Diagnosis 2: 'Z95.5'
[22:52:53] ℹ️    - Diagnosis 3: 'I25.5'
[22:52:53] ℹ️    - Diagnosis 4: 'I11.0'
[22:52:53] ℹ️    - Diagnosis 5: 'I50.21'
[22:52:53] ℹ️    - Diagnosis 6: 'C34.92'
[22:52:53] ℹ️  Final extracted MRN: '928015'
[22:52:53] ℹ️  Final extracted Sex: 'FEMALE'
[22:52:53] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[22:52:53] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[22:52:53] ✅ Patient data extraction completed successfully
[22:52:53] ✅    ✅ Patient data extracted successfully
[22:52:53] 📊 Patient Response
     └─ patientFName: Erconida
     └─ patientLName: Graciani
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '03/01/2025', 'firstDiagnosis': 'I21.09', 'secondDiagnosis': 'Z95.5', 'thirdDiagnosis': 'I25.5', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.21', 'sixthDiagnosis': 'C34.92'}]
[22:52:53] ✅    ✅ Patient identified: Erconida Graciani
[22:52:53] ✅    ✅ Patient name validation passed
[22:52:53] 🔄 
🔄 Step 3: Processing patient dates...
[22:52:53] [DOC: 9168058] ℹ️  DOB normalized: 07/07/1940
[22:52:53] [DOC: 9168058] ℹ️  Episode startOfCare normalized: 01/10/2025
[22:52:53] [DOC: 9168058] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[22:52:53] [DOC: 9168058] ℹ️  Episode endOfEpisode normalized: 03/01/2025
[22:52:53] [DOC: 9168058] ✅ Patient date processing completed successfully
[22:52:53] ✅    ✅ Date processing completed
[22:52:53] 📊 Processed Patient Data
     └─ patientFName: Erconida
     └─ patientLName: Graciani
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '03/01/2025', 'firstDiagnosis': 'I21.09', 'secondDiagnosis': 'Z95.5', 'thirdDiagnosis': 'I25.5', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.21', 'sixthDiagnosis': 'C34.92'}]
[22:52:53] 🔄 
🔄 Step 4: Extracting order data...
[22:52:56] ℹ️  Order extraction - MRN: '928015'
[22:52:56] ℹ️  Order extraction - Sex: 'FEMALE'
[22:52:56] ℹ️  Order extraction - Service Line: 'PT, SN'
[22:52:56] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[22:52:56] ✅ Order data extraction completed successfully
[22:52:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:52:56] ℹ️  Using MRN from patient data: '928015' over '928015'
[22:52:56] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT, SN' = 'PT, Physical Therapy, SN, Skilled Nursing'
[22:52:56] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[22:52:56] ✅ Patient name cross-validation successful
[22:52:56] ✅    ✅ Data merged successfully
[22:52:57] ✅    ✅ Order data extracted and validated
[22:52:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:52:57] [DOC: 9168058] ✅ Patient found in local cache: Erconida Graciani, ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[22:52:57] ✅    ✅ Existing patient found with ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[22:52:57] 🔄 
🔄 Step 6: Pushing order to API...
[22:52:57] [DOC: 9168058] ℹ️  Pushing order via API for patient ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[22:52:58] [DOC: 9168058] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:52:58] ❌    ❌ Failed to push order
[22:52:58] 🔄 
🔄 Step 7: Writing to CSV...
[22:52:58] [DOC: 9168058] ℹ️  Calculated age: 84 from DOB: 07/07/1940
[22:52:58] [DOC: 9168058] ℹ️  Service Line extracted: 'PT, Physical Therapy, SN, Skilled Nursing'
[22:52:58] [DOC: 9168058] ℹ️  Payer Source extracted: 'Senior Whole Health'
[22:52:58] [DOC: 9168058] ℹ️  Diagnosis codes being written:
[22:52:58] [DOC: 9168058] ℹ️    - Latest_Episode_Firstdiagnosis: 'I21.09'
[22:52:58] [DOC: 9168058] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z95.5'
[22:52:58] [DOC: 9168058] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.5'
[22:52:58] [DOC: 9168058] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[22:52:58] [DOC: 9168058] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.21'
[22:52:58] [DOC: 9168058] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C34.92'
[22:52:58] [DOC: 9168058] ✅ Patient data written to CSV: Erconida Graciani | Sex: FEMALE | Age: 84 | Service: PT, Physical Therapy, SN, Skilled Nursing | Payer: Senior Whole Health | MRN: 928015
[22:52:58] ✅    ✅ Document 9168058 processed and saved successfully
[22:52:58] 🔄 
🔄 Step 8: Saving API details...
[22:52:58] [DOC: 9168058] ℹ️  API push details saved for document 9168058
[22:52:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168049                         ║
================================================================================
[22:52:58] ℹ️  Agency: Dartmouth HH
[22:52:58] ℹ️  Date: 03/07/2025
[22:52:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:53:02] [DOC: 9168049] ✅ Text extracted using pdfplumber (13522 chars)
[22:53:02] ✅    ✅ Text extracted using pdfplumber (13510 chars)
[22:53:02] 🔄 
🔄 Step 2: Extracting patient data...
[22:53:05] ℹ️  AI extracted raw sex value: 'F'
[22:53:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:53:05] ℹ️  AI extracted payer source: 'None'
[22:53:05] ℹ️  AI extracted diagnoses:
[22:53:05] ℹ️    - Diagnosis 1: 'C25.0'
[22:53:05] ℹ️    - Diagnosis 2: 'E11.65'
[22:53:05] ℹ️    - Diagnosis 3: 'D63.0'
[22:53:05] ℹ️    - Diagnosis 4: 'G89.3'
[22:53:05] ℹ️    - Diagnosis 5: 'R53.1'
[22:53:05] ℹ️    - Diagnosis 6: 'K59.00'
[22:53:05] ℹ️  Final extracted MRN: '2429011'
[22:53:05] ℹ️  Final extracted Sex: 'FEMALE'
[22:53:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:53:05] ℹ️  Final extracted Payer Source: ''
[22:53:05] ✅ Patient data extraction completed successfully
[22:53:05] ✅    ✅ Patient data extracted successfully
[22:53:05] 📊 Patient Response
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2024', 'startOfEpisode': '11/04/2024', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'C25.0', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'D63.0', 'fourthDiagnosis': 'G89.3', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'K59.00'}]
[22:53:05] ✅    ✅ Patient identified: Eduarda Demello
[22:53:05] ✅    ✅ Patient name validation passed
[22:53:05] 🔄 
🔄 Step 3: Processing patient dates...
[22:53:05] [DOC: 9168049] ℹ️  DOB normalized: 09/29/1942
[22:53:05] [DOC: 9168049] ℹ️  Episode startOfCare normalized: 11/03/2024
[22:53:05] [DOC: 9168049] ℹ️  Episode startOfEpisode normalized: 11/04/2024
[22:53:05] [DOC: 9168049] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[22:53:05] [DOC: 9168049] ✅ Patient date processing completed successfully
[22:53:05] ✅    ✅ Date processing completed
[22:53:05] 📊 Processed Patient Data
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2024', 'startOfEpisode': '11/04/2024', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'C25.0', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'D63.0', 'fourthDiagnosis': 'G89.3', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'K59.00'}]
[22:53:05] 🔄 
🔄 Step 4: Extracting order data...
[22:53:07] ℹ️  Order extraction - MRN: '2429011'
[22:53:07] ℹ️  Order extraction - Sex: 'FEMALE'
[22:53:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:53:07] ℹ️  Order extraction - Payer Source: ''
[22:53:07] ✅ Order data extraction completed successfully
[22:53:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:53:07] ℹ️  Using MRN from patient data: '2429011' over '2429011'
[22:53:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:53:07] ✅ Patient name cross-validation successful
[22:53:07] ✅    ✅ Data merged successfully
[22:53:08] ✅    ✅ Order data extracted and validated
[22:53:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:53:08] [DOC: 9168049] ✅ Patient found in local cache: Eduarda Demello, ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[22:53:08] ✅    ✅ Existing patient found with ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[22:53:08] 🔄 
🔄 Step 6: Pushing order to API...
[22:53:08] [DOC: 9168049] ℹ️  Pushing order via API for patient ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[22:53:09] [DOC: 9168049] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:53:09] ❌    ❌ Failed to push order
[22:53:09] 🔄 
🔄 Step 7: Writing to CSV...
[22:53:09] [DOC: 9168049] ℹ️  Calculated age: 82 from DOB: 09/29/1942
[22:53:09] [DOC: 9168049] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:53:09] [DOC: 9168049] ℹ️  Payer Source extracted: ''
[22:53:09] [DOC: 9168049] ℹ️  Diagnosis codes being written:
[22:53:09] [DOC: 9168049] ℹ️    - Latest_Episode_Firstdiagnosis: 'C25.0'
[22:53:09] [DOC: 9168049] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[22:53:09] [DOC: 9168049] ℹ️    - Latest_Episode_Thirddiagnosis: 'D63.0'
[22:53:09] [DOC: 9168049] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G89.3'
[22:53:09] [DOC: 9168049] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R53.1'
[22:53:09] [DOC: 9168049] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.00'
[22:53:09] [DOC: 9168049] ✅ Patient data written to CSV: Eduarda Demello | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 2429011
[22:53:09] ✅    ✅ Document 9168049 processed and saved successfully
[22:53:09] 🔄 
🔄 Step 8: Saving API details...
[22:53:09] [DOC: 9168049] ℹ️  API push details saved for document 9168049
[22:53:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168033                         ║
================================================================================
[22:53:09] ℹ️  Agency: Dartmouth HH
[22:53:09] ℹ️  Date: 03/07/2025
[22:53:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:53:12] [DOC: 9168033] ✅ Text extracted using pdfplumber (2973 chars)
[22:53:12] ✅    ✅ Text extracted using pdfplumber (2973 chars)
[22:53:12] 🔄 
🔄 Step 2: Extracting patient data...
[22:53:15] ℹ️  AI extracted raw sex value: 'M'
[22:53:15] ℹ️  AI extracted service line: 'PT'
[22:53:15] ℹ️  AI extracted payer source: 'Medicare'
[22:53:15] ℹ️  AI extracted diagnoses:
[22:53:15] ℹ️    - Diagnosis 1: ''
[22:53:15] ℹ️    - Diagnosis 2: ''
[22:53:15] ℹ️    - Diagnosis 3: ''
[22:53:15] ℹ️    - Diagnosis 4: ''
[22:53:15] ℹ️    - Diagnosis 5: ''
[22:53:15] ℹ️    - Diagnosis 6: ''
[22:53:15] ℹ️  Final extracted MRN: '4937015'
[22:53:15] ℹ️  Final extracted Sex: 'MALE'
[22:53:15] ℹ️  Final extracted Service Line: 'PT'
[22:53:15] ℹ️  Final extracted Payer Source: 'Medicare'
[22:53:15] ✅ Patient data extraction completed successfully
[22:53:15] ✅    ✅ Patient data extracted successfully
[22:53:15] 📊 Patient Response
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:53:15] ✅    ✅ Patient identified: Harvey Lewis
[22:53:15] ✅    ✅ Patient name validation passed
[22:53:15] 🔄 
🔄 Step 3: Processing patient dates...
[22:53:15] [DOC: 9168033] ℹ️  DOB normalized: 05/02/1949
[22:53:15] [DOC: 9168033] ℹ️  Episode startOfCare normalized: 12/18/2024
[22:53:15] [DOC: 9168033] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:53:15] [DOC: 9168033] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:53:15] [DOC: 9168033] ✅ Patient date processing completed successfully
[22:53:15] ✅    ✅ Date processing completed
[22:53:15] 📊 Processed Patient Data
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:53:15] 🔄 
🔄 Step 4: Extracting order data...
[22:53:17] ℹ️  Order extraction - MRN: '4937015'
[22:53:17] ℹ️  Order extraction - Sex: 'MALE'
[22:53:17] ℹ️  Order extraction - Service Line: 'PT'
[22:53:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:53:17] ✅ Order data extraction completed successfully
[22:53:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:53:17] ℹ️  Using MRN from patient data: '4937015' over '4937015'
[22:53:17] ℹ️  Service line consistent in both sources: 'PT'
[22:53:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:53:17] ✅ Patient name cross-validation successful
[22:53:17] ✅    ✅ Data merged successfully
[22:53:18] ✅    ✅ Order data extracted and validated
[22:53:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:53:18] [DOC: 9168033] ✅ Patient found in local cache: Harvey Lewis, ID: 173f09ed-5f3d-4120-a940-63a4db422257
[22:53:18] ✅    ✅ Existing patient found with ID: 173f09ed-5f3d-4120-a940-63a4db422257
[22:53:18] 🔄 
🔄 Step 6: Pushing order to API...
[22:53:18] [DOC: 9168033] ℹ️  Pushing order via API for patient ID: 173f09ed-5f3d-4120-a940-63a4db422257
[22:53:20] [DOC: 9168033] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:53:20] ❌    ❌ Failed to push order
[22:53:20] 🔄 
🔄 Step 7: Writing to CSV...
[22:53:20] [DOC: 9168033] ℹ️  Calculated age: 76 from DOB: 05/02/1949
[22:53:20] [DOC: 9168033] ℹ️  Service Line extracted: 'PT'
[22:53:20] [DOC: 9168033] ℹ️  Payer Source extracted: 'Medicare'
[22:53:20] [DOC: 9168033] ℹ️  Diagnosis codes being written:
[22:53:20] [DOC: 9168033] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:53:20] [DOC: 9168033] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:53:20] [DOC: 9168033] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:53:20] [DOC: 9168033] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:53:20] [DOC: 9168033] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:53:20] [DOC: 9168033] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:53:20] [DOC: 9168033] ✅ Patient data written to CSV: Harvey Lewis | Sex: MALE | Age: 76 | Service: PT | Payer: Medicare | MRN: 4937015
[22:53:20] ✅    ✅ Document 9168033 processed and saved successfully
[22:53:20] 🔄 
🔄 Step 8: Saving API details...
[22:53:20] [DOC: 9168033] ℹ️  API push details saved for document 9168033
[22:53:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168029                         ║
================================================================================
[22:53:20] ℹ️  Agency: Dartmouth HH
[22:53:20] ℹ️  Date: 03/07/2025
[22:53:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:53:22] [DOC: 9168029] ✅ Text extracted using pdfplumber (1873 chars)
[22:53:22] ✅    ✅ Text extracted using pdfplumber (1873 chars)
[22:53:22] 🔄 
🔄 Step 2: Extracting patient data...
[22:53:24] ℹ️  AI extracted raw sex value: 'M'
[22:53:24] ℹ️  AI extracted service line: 'RN, LPN'
[22:53:24] ℹ️  AI extracted payer source: 'Medicare'
[22:53:24] ℹ️  AI extracted diagnoses:
[22:53:24] ℹ️    - Diagnosis 1: 'None'
[22:53:24] ℹ️    - Diagnosis 2: 'None'
[22:53:24] ℹ️    - Diagnosis 3: 'None'
[22:53:24] ℹ️    - Diagnosis 4: 'None'
[22:53:24] ℹ️    - Diagnosis 5: 'None'
[22:53:24] ℹ️    - Diagnosis 6: 'None'
[22:53:24] ℹ️  Final extracted MRN: '5965015'
[22:53:24] ℹ️  Final extracted Sex: 'MALE'
[22:53:24] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:53:24] ℹ️  Final extracted Payer Source: 'Medicare'
[22:53:24] ✅ Patient data extraction completed successfully
[22:53:24] ✅    ✅ Patient data extracted successfully
[22:53:24] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Duarte Jr,
     └─ dob: 09/10/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 5965015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:53:24] ✅    ✅ Patient identified: John Duarte Jr,
[22:53:24] ✅    ✅ Patient name validation passed
[22:53:24] 🔄 
🔄 Step 3: Processing patient dates...
[22:53:24] [DOC: 9168029] ℹ️  DOB normalized: 09/10/1936
[22:53:24] [DOC: 9168029] ℹ️  Episode startOfCare normalized: 02/02/2025
[22:53:24] [DOC: 9168029] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[22:53:24] [DOC: 9168029] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[22:53:24] [DOC: 9168029] ✅ Patient date processing completed successfully
[22:53:24] ✅    ✅ Date processing completed
[22:53:24] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Duarte Jr,
     └─ dob: 09/10/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 5965015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025'}]
[22:53:24] 🔄 
🔄 Step 4: Extracting order data...
[22:53:27] ℹ️  Order extraction - MRN: '5965015'
[22:53:27] ℹ️  Order extraction - Sex: 'MALE'
[22:53:27] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:53:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:53:27] ✅ Order data extraction completed successfully
[22:53:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:53:27] ℹ️  Using MRN from patient data: '5965015' over '5965015'
[22:53:27] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:53:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:53:27] ✅ Patient name cross-validation successful
[22:53:27] ✅    ✅ Data merged successfully
[22:53:28] ✅    ✅ Order data extracted and validated
[22:53:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:53:49] [DOC: 9168029] ✅ Patient exists in API: John Duarte Jr,, ID: 3b6db977-9807-4bed-853c-78bccadb738f
[22:53:49] ✅    ✅ Existing patient found with ID: 3b6db977-9807-4bed-853c-78bccadb738f
[22:53:49] 🔄 
🔄 Step 6: Pushing order to API...
[22:53:49] [DOC: 9168029] ℹ️  Pushing order via API for patient ID: 3b6db977-9807-4bed-853c-78bccadb738f
[22:53:50] [DOC: 9168029] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:53:50] ❌    ❌ Failed to push order
[22:53:50] 🔄 
🔄 Step 7: Writing to CSV...
[22:53:50] [DOC: 9168029] ℹ️  Calculated age: 88 from DOB: 09/10/1936
[22:53:50] [DOC: 9168029] ℹ️  Service Line extracted: 'RN, LPN'
[22:53:50] [DOC: 9168029] ℹ️  Payer Source extracted: 'Medicare'
[22:53:50] [DOC: 9168029] ℹ️  Diagnosis codes being written:
[22:53:50] [DOC: 9168029] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:53:50] [DOC: 9168029] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:53:50] [DOC: 9168029] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:53:50] [DOC: 9168029] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:53:50] [DOC: 9168029] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:53:50] [DOC: 9168029] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:53:50] [DOC: 9168029] ✅ Patient data written to CSV: John Duarte Jr, | Sex: MALE | Age: 88 | Service: RN, LPN | Payer: Medicare | MRN: 5965015
[22:53:50] ✅    ✅ Document 9168029 processed and saved successfully
[22:53:50] 🔄 
🔄 Step 8: Saving API details...
[22:53:50] [DOC: 9168029] ℹ️  API push details saved for document 9168029
[22:53:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168026                         ║
================================================================================
[22:53:50] ℹ️  Agency: Dartmouth HH
[22:53:50] ℹ️  Date: 03/07/2025
[22:53:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:53:52] [DOC: 9168026] ✅ Text extracted using pdfplumber (1296 chars)
[22:53:52] ✅    ✅ Text extracted using pdfplumber (1296 chars)
[22:53:52] 🔄 
🔄 Step 2: Extracting patient data...
[22:53:54] ℹ️  AI extracted raw sex value: 'M'
[22:53:54] ℹ️  AI extracted service line: 'RN'
[22:53:54] ℹ️  AI extracted payer source: 'Medicare'
[22:53:54] ℹ️  AI extracted diagnoses:
[22:53:54] ℹ️    - Diagnosis 1: 'None'
[22:53:54] ℹ️    - Diagnosis 2: 'None'
[22:53:54] ℹ️    - Diagnosis 3: 'None'
[22:53:54] ℹ️    - Diagnosis 4: 'None'
[22:53:54] ℹ️    - Diagnosis 5: 'None'
[22:53:54] ℹ️    - Diagnosis 6: 'None'
[22:53:54] ℹ️  Final extracted MRN: '3621015'
[22:53:54] ℹ️  Final extracted Sex: 'MALE'
[22:53:54] ℹ️  Final extracted Service Line: 'RN'
[22:53:54] ℹ️  Final extracted Payer Source: 'Medicare'
[22:53:54] ✅ Patient data extraction completed successfully
[22:53:54] ✅    ✅ Patient data extracted successfully
[22:53:54] 📊 Patient Response
     └─ patientFName: Jonathan
     └─ patientLName: Pina
     └─ dob: 12/19/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 3621015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2025', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:53:54] ✅    ✅ Patient identified: Jonathan Pina
[22:53:54] ✅    ✅ Patient name validation passed
[22:53:54] 🔄 
🔄 Step 3: Processing patient dates...
[22:53:54] [DOC: 9168026] ℹ️  DOB normalized: 12/19/1954
[22:53:54] [DOC: 9168026] ℹ️  Episode startOfCare normalized: 02/07/2025
[22:53:54] [DOC: 9168026] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[22:53:54] [DOC: 9168026] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[22:53:54] [DOC: 9168026] ✅ Patient date processing completed successfully
[22:53:54] ✅    ✅ Date processing completed
[22:53:54] 📊 Processed Patient Data
     └─ patientFName: Jonathan
     └─ patientLName: Pina
     └─ dob: 12/19/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 3621015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2025', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025'}]
[22:53:54] 🔄 
🔄 Step 4: Extracting order data...
[22:53:57] ℹ️  Order extraction - MRN: ''
[22:53:57] ℹ️  Order extraction - Sex: 'MALE'
[22:53:57] ℹ️  Order extraction - Service Line: 'RN'
[22:53:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:53:57] ✅ Order data extraction completed successfully
[22:53:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:53:57] ℹ️  Using MRN from patient data: '3621015'
[22:53:57] ℹ️  Service line consistent in both sources: 'RN'
[22:53:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:53:57] ✅ Patient name cross-validation successful
[22:53:57] ✅    ✅ Data merged successfully
[22:53:58] ✅    ✅ Order data extracted and validated
[22:53:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:54:09] [DOC: 9168026] ✅ Patient exists in API: Jonathan Pina, ID: cf54597a-6690-4483-b05d-e10ac58a02dc
[22:54:09] ✅    ✅ Existing patient found with ID: cf54597a-6690-4483-b05d-e10ac58a02dc
[22:54:09] 🔄 
🔄 Step 6: Pushing order to API...
[22:54:09] [DOC: 9168026] ℹ️  Pushing order via API for patient ID: cf54597a-6690-4483-b05d-e10ac58a02dc
[22:54:10] [DOC: 9168026] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13073"}
[22:54:10] ❌    ❌ Failed to push order
[22:54:10] 🔄 
🔄 Step 7: Writing to CSV...
[22:54:10] [DOC: 9168026] ℹ️  Calculated age: 70 from DOB: 12/19/1954
[22:54:10] [DOC: 9168026] ℹ️  Service Line extracted: 'RN'
[22:54:10] [DOC: 9168026] ℹ️  Payer Source extracted: 'Medicare'
[22:54:10] [DOC: 9168026] ℹ️  Diagnosis codes being written:
[22:54:10] [DOC: 9168026] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:54:10] [DOC: 9168026] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:54:10] [DOC: 9168026] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:54:10] [DOC: 9168026] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:54:10] [DOC: 9168026] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:54:10] [DOC: 9168026] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:54:10] [DOC: 9168026] ✅ Patient data written to CSV: Jonathan Pina | Sex: MALE | Age: 70 | Service: RN | Payer: Medicare | MRN: 3621015
[22:54:10] ✅    ✅ Document 9168026 processed and saved successfully
[22:54:10] 🔄 
🔄 Step 8: Saving API details...
[22:54:10] [DOC: 9168026] ℹ️  API push details saved for document 9168026
[22:54:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168024                         ║
================================================================================
[22:54:10] ℹ️  Agency: Dartmouth HH
[22:54:10] ℹ️  Date: 03/07/2025
[22:54:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:54:12] [DOC: 9168024] ✅ Text extracted using pdfplumber (1190 chars)
[22:54:12] ✅    ✅ Text extracted using pdfplumber (1190 chars)
[22:54:12] 🔄 
🔄 Step 2: Extracting patient data...
[22:54:15] ℹ️  AI extracted raw sex value: 'F'
[22:54:15] ℹ️  AI extracted service line: 'RN'
[22:54:15] ℹ️  AI extracted payer source: 'Medicare'
[22:54:15] ℹ️  AI extracted diagnoses:
[22:54:15] ℹ️    - Diagnosis 1: 'None'
[22:54:15] ℹ️    - Diagnosis 2: 'None'
[22:54:15] ℹ️    - Diagnosis 3: 'None'
[22:54:15] ℹ️    - Diagnosis 4: 'None'
[22:54:15] ℹ️    - Diagnosis 5: 'None'
[22:54:15] ℹ️    - Diagnosis 6: 'None'
[22:54:15] ℹ️  Final extracted MRN: '5662015'
[22:54:15] ℹ️  Final extracted Sex: 'FEMALE'
[22:54:15] ℹ️  Final extracted Service Line: 'RN'
[22:54:15] ℹ️  Final extracted Payer Source: 'Medicare'
[22:54:15] ✅ Patient data extraction completed successfully
[22:54:15] ✅    ✅ Patient data extracted successfully
[22:54:15] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:54:15] ✅    ✅ Patient identified: Betty Mendonca
[22:54:15] ✅    ✅ Patient name validation passed
[22:54:15] 🔄 
🔄 Step 3: Processing patient dates...
[22:54:15] [DOC: 9168024] ℹ️  DOB normalized: 04/08/1948
[22:54:15] [DOC: 9168024] ℹ️  Episode startOfCare normalized: 12/08/2024
[22:54:15] [DOC: 9168024] ℹ️  Episode startOfEpisode normalized: 02/06/2025
[22:54:15] [DOC: 9168024] ℹ️  Episode endOfEpisode normalized: 04/06/2025
[22:54:15] [DOC: 9168024] ✅ Patient date processing completed successfully
[22:54:15] ✅    ✅ Date processing completed
[22:54:15] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025'}]
[22:54:15] 🔄 
🔄 Step 4: Extracting order data...
[22:54:17] ℹ️  Order extraction - MRN: ''
[22:54:17] ℹ️  Order extraction - Sex: 'FEMALE'
[22:54:17] ℹ️  Order extraction - Service Line: 'RN'
[22:54:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:54:17] ✅ Order data extraction completed successfully
[22:54:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:54:17] ℹ️  Using MRN from patient data: '5662015'
[22:54:17] ℹ️  Service line consistent in both sources: 'RN'
[22:54:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:54:17] ✅ Patient name cross-validation successful
[22:54:17] ✅    ✅ Data merged successfully
[22:54:18] ✅    ✅ Order data extracted and validated
[22:54:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:54:18] [DOC: 9168024] ✅ Patient found in local cache: Betty Mendonca, ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[22:54:18] ✅    ✅ Existing patient found with ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[22:54:18] 🔄 
🔄 Step 6: Pushing order to API...
[22:54:18] [DOC: 9168024] ℹ️  Pushing order via API for patient ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[22:54:19] [DOC: 9168024] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:54:19] ❌    ❌ Failed to push order
[22:54:19] 🔄 
🔄 Step 7: Writing to CSV...
[22:54:19] [DOC: 9168024] ℹ️  Calculated age: 77 from DOB: 04/08/1948
[22:54:19] [DOC: 9168024] ℹ️  Service Line extracted: 'RN'
[22:54:19] [DOC: 9168024] ℹ️  Payer Source extracted: 'Medicare'
[22:54:19] [DOC: 9168024] ℹ️  Diagnosis codes being written:
[22:54:19] [DOC: 9168024] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:54:19] [DOC: 9168024] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:54:19] [DOC: 9168024] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:54:19] [DOC: 9168024] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:54:19] [DOC: 9168024] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:54:19] [DOC: 9168024] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:54:19] [DOC: 9168024] ✅ Patient data written to CSV: Betty Mendonca | Sex: FEMALE | Age: 77 | Service: RN | Payer: Medicare | MRN: 5662015
[22:54:19] ✅    ✅ Document 9168024 processed and saved successfully
[22:54:19] 🔄 
🔄 Step 8: Saving API details...
[22:54:19] [DOC: 9168024] ℹ️  API push details saved for document 9168024
[22:54:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9168007                         ║
================================================================================
[22:54:19] ℹ️  Agency: Dartmouth HH
[22:54:19] ℹ️  Date: 03/07/2025
[22:54:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:54:22] [DOC: 9168007] ✅ Text extracted using pdfplumber (11429 chars)
[22:54:22] ✅    ✅ Text extracted using pdfplumber (11429 chars)
[22:54:22] 🔄 
🔄 Step 2: Extracting patient data...
[22:54:25] ℹ️  AI extracted raw sex value: 'F'
[22:54:25] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[22:54:25] ℹ️  AI extracted payer source: 'Private pay'
[22:54:25] ℹ️  AI extracted diagnoses:
[22:54:25] ℹ️    - Diagnosis 1: 'S72.042D'
[22:54:25] ℹ️    - Diagnosis 2: 'S52.022D'
[22:54:25] ℹ️    - Diagnosis 3: 'I89.0'
[22:54:25] ℹ️    - Diagnosis 4: 'I87.2'
[22:54:25] ℹ️    - Diagnosis 5: 'F41.9'
[22:54:25] ℹ️    - Diagnosis 6: 'I10'
[22:54:25] ℹ️  Final extracted MRN: '2989001'
[22:54:25] ℹ️  Final extracted Sex: 'FEMALE'
[22:54:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[22:54:25] ℹ️  Final extracted Payer Source: 'Private pay'
[22:54:25] ✅ Patient data extraction completed successfully
[22:54:25] ✅    ✅ Patient data extracted successfully
[22:54:25] 📊 Patient Response
     └─ patientFName: Angelique
     └─ patientLName: Smith
     └─ dob: 11/05/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2989001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Private pay
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'S72.042D', 'secondDiagnosis': 'S52.022D', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'I87.2', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[22:54:25] ✅    ✅ Patient identified: Angelique Smith
[22:54:25] ✅    ✅ Patient name validation passed
[22:54:25] 🔄 
🔄 Step 3: Processing patient dates...
[22:54:25] [DOC: 9168007] ℹ️  DOB normalized: 11/05/1932
[22:54:25] [DOC: 9168007] ℹ️  Episode startOfCare normalized: 02/16/2025
[22:54:25] [DOC: 9168007] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:54:25] [DOC: 9168007] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:54:25] [DOC: 9168007] ✅ Patient date processing completed successfully
[22:54:25] ✅    ✅ Date processing completed
[22:54:25] 📊 Processed Patient Data
     └─ patientFName: Angelique
     └─ patientLName: Smith
     └─ dob: 11/05/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2989001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Private pay
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'S72.042D', 'secondDiagnosis': 'S52.022D', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'I87.2', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[22:54:25] 🔄 
🔄 Step 4: Extracting order data...
[22:54:28] ℹ️  Order extraction - MRN: '2989001'
[22:54:28] ℹ️  Order extraction - Sex: 'FEMALE'
[22:54:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[22:54:28] ℹ️  Order extraction - Payer Source: 'Private Pay'
[22:54:28] ✅ Order data extraction completed successfully
[22:54:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:54:28] ℹ️  Using MRN from patient data: '2989001' over '2989001'
[22:54:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[22:54:28] ℹ️  Payer source consistent in both sources: 'Private pay'
[22:54:28] ✅ Patient name cross-validation successful
[22:54:28] ✅    ✅ Data merged successfully
[22:54:29] ✅    ✅ Order data extracted and validated
[22:54:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:54:48] [DOC: 9168007] ℹ️  Patient not found in cache or API: Angelique Smith
[22:54:48] [DOC: 9168007] ℹ️  Patient not found, creating new patient via API...
[22:54:48] [DOC: 9168007] ℹ️  Creating patient via API: Angelique Smith
[22:54:49] [DOC: 9168007] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:54:49] ❌    ❌ Failed to create patient
[22:54:49] [DOC: 9168007] ℹ️  API push details saved for document 9168007
================================================================================
║                        Processing Document ID: 9167999                         ║
================================================================================
[22:54:49] ℹ️  Agency: Dartmouth HH
[22:54:49] ℹ️  Date: 03/07/2025
[22:54:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:54:52] [DOC: 9167999] ✅ Text extracted using pdfplumber (13653 chars)
[22:54:52] ✅    ✅ Text extracted using pdfplumber (13653 chars)
[22:54:52] 🔄 
🔄 Step 2: Extracting patient data...
[22:54:54] ℹ️  AI extracted raw sex value: 'F'
[22:54:54] ℹ️  AI extracted service line: 'PT, OT, RN, LPN'
[22:54:54] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[22:54:54] ℹ️  AI extracted diagnoses:
[22:54:54] ℹ️    - Diagnosis 1: 'None'
[22:54:54] ℹ️    - Diagnosis 2: 'None'
[22:54:54] ℹ️    - Diagnosis 3: 'None'
[22:54:54] ℹ️    - Diagnosis 4: 'None'
[22:54:54] ℹ️    - Diagnosis 5: 'None'
[22:54:54] ℹ️    - Diagnosis 6: 'None'
[22:54:54] ℹ️  Final extracted MRN: '2989001'
[22:54:54] ℹ️  Final extracted Sex: 'FEMALE'
[22:54:54] ℹ️  Final extracted Service Line: 'PT, OT, RN, LPN'
[22:54:54] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:54:54] ✅ Patient data extraction completed successfully
[22:54:54] ✅    ✅ Patient data extracted successfully
[22:54:54] 📊 Patient Response
     └─ patientFName: Orize
     └─ patientLName: Bourgeois
     └─ dob: 11/05/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2989001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:54:54] ✅    ✅ Patient identified: Orize Bourgeois
[22:54:54] ✅    ✅ Patient name validation passed
[22:54:54] 🔄 
🔄 Step 3: Processing patient dates...
[22:54:54] [DOC: 9167999] ℹ️  DOB normalized: 11/05/1932
[22:54:54] [DOC: 9167999] ℹ️  Episode startOfCare normalized: 02/16/2025
[22:54:54] [DOC: 9167999] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:54:54] [DOC: 9167999] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:54:54] [DOC: 9167999] ✅ Patient date processing completed successfully
[22:54:54] ✅    ✅ Date processing completed
[22:54:54] 📊 Processed Patient Data
     └─ patientFName: Orize
     └─ patientLName: Bourgeois
     └─ dob: 11/05/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2989001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025'}]
[22:54:54] 🔄 
🔄 Step 4: Extracting order data...
[22:54:57] ℹ️  Order extraction - MRN: ''
[22:54:57] ℹ️  Order extraction - Sex: 'FEMALE'
[22:54:57] ℹ️  Order extraction - Service Line: 'PT, OT, RN'
[22:54:57] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:54:57] ✅ Order data extraction completed successfully
[22:54:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:54:57] ℹ️  Using MRN from patient data: '2989001'
[22:54:57] ℹ️  Combined service lines: Patient='PT, OT, RN, LPN' + Order='PT, OT, RN' = 'LPN, OT, PT, RN'
[22:54:57] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[22:54:57] ✅ Patient name cross-validation successful
[22:54:57] ✅    ✅ Data merged successfully
[22:54:58] ✅    ✅ Order data extracted and validated
[22:54:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:54:58] [DOC: 9167999] ✅ Patient found in local cache: Orize Bourgeois, ID: 535e4a0d-1cc7-4dac-85e9-971f6ab5e5af
[22:54:58] ✅    ✅ Existing patient found with ID: 535e4a0d-1cc7-4dac-85e9-971f6ab5e5af
[22:54:58] 🔄 
🔄 Step 6: Pushing order to API...
[22:54:58] [DOC: 9167999] ℹ️  Pushing order via API for patient ID: 535e4a0d-1cc7-4dac-85e9-971f6ab5e5af
[22:54:59] [DOC: 9167999] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:54:59] ❌    ❌ Failed to push order
[22:54:59] 🔄 
🔄 Step 7: Writing to CSV...
[22:54:59] [DOC: 9167999] ℹ️  Calculated age: 92 from DOB: 11/05/1932
[22:54:59] [DOC: 9167999] ℹ️  Service Line extracted: 'LPN, OT, PT, RN'
[22:54:59] [DOC: 9167999] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[22:54:59] [DOC: 9167999] ℹ️  Diagnosis codes being written:
[22:54:59] [DOC: 9167999] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:54:59] [DOC: 9167999] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:54:59] [DOC: 9167999] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:54:59] [DOC: 9167999] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:54:59] [DOC: 9167999] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:54:59] [DOC: 9167999] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:54:59] [DOC: 9167999] ✅ Patient data written to CSV: Orize Bourgeois | Sex: FEMALE | Age: 92 | Service: LPN, OT, PT, RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 2989001
[22:54:59] ✅    ✅ Document 9167999 processed and saved successfully
[22:54:59] 🔄 
🔄 Step 8: Saving API details...
[22:54:59] [DOC: 9167999] ℹ️  API push details saved for document 9167999
[22:54:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167977                         ║
================================================================================
[22:54:59] ℹ️  Agency: Dartmouth HH
[22:54:59] ℹ️  Date: 03/07/2025
[22:54:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:55:01] [DOC: 9167977] ✅ Text extracted using pdfplumber (1786 chars)
[22:55:01] ✅    ✅ Text extracted using pdfplumber (1786 chars)
[22:55:01] 🔄 
🔄 Step 2: Extracting patient data...
[22:55:04] ℹ️  AI extracted raw sex value: 'F'
[22:55:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:55:04] ℹ️  AI extracted payer source: 'Medicare'
[22:55:04] ℹ️  AI extracted diagnoses:
[22:55:04] ℹ️    - Diagnosis 1: 'None'
[22:55:04] ℹ️    - Diagnosis 2: 'None'
[22:55:04] ℹ️    - Diagnosis 3: 'None'
[22:55:04] ℹ️    - Diagnosis 4: 'None'
[22:55:04] ℹ️    - Diagnosis 5: 'None'
[22:55:04] ℹ️    - Diagnosis 6: 'None'
[22:55:04] ℹ️  Final extracted MRN: '1033009'
[22:55:04] ℹ️  Final extracted Sex: 'FEMALE'
[22:55:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:55:04] ℹ️  Final extracted Payer Source: 'Medicare'
[22:55:04] ✅ Patient data extraction completed successfully
[22:55:04] ✅    ✅ Patient data extracted successfully
[22:55:04] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:55:04] ✅    ✅ Patient identified: Irene Gauthier
[22:55:04] ✅    ✅ Patient name validation passed
[22:55:04] 🔄 
🔄 Step 3: Processing patient dates...
[22:55:04] [DOC: 9167977] ℹ️  DOB normalized: 05/12/1942
[22:55:04] [DOC: 9167977] ℹ️  Episode startOfCare normalized: 08/20/2024
[22:55:04] [DOC: 9167977] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[22:55:04] [DOC: 9167977] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[22:55:04] [DOC: 9167977] ✅ Patient date processing completed successfully
[22:55:04] ✅    ✅ Date processing completed
[22:55:04] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025'}]
[22:55:04] 🔄 
🔄 Step 4: Extracting order data...
[22:55:06] ℹ️  Order extraction - MRN: '1033009'
[22:55:06] ℹ️  Order extraction - Sex: 'FEMALE'
[22:55:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:55:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:55:06] ✅ Order data extraction completed successfully
[22:55:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:55:06] ℹ️  Using MRN from patient data: '1033009' over '1033009'
[22:55:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:55:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:55:06] ✅ Patient name cross-validation successful
[22:55:06] ✅    ✅ Data merged successfully
[22:55:07] ✅    ✅ Order data extracted and validated
[22:55:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:55:07] [DOC: 9167977] ✅ Patient found in local cache: Irene Gauthier, ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[22:55:07] ✅    ✅ Existing patient found with ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[22:55:07] 🔄 
🔄 Step 6: Pushing order to API...
[22:55:07] [DOC: 9167977] ℹ️  Pushing order via API for patient ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[22:55:08] [DOC: 9167977] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:55:08] ❌    ❌ Failed to push order
[22:55:08] 🔄 
🔄 Step 7: Writing to CSV...
[22:55:08] [DOC: 9167977] ℹ️  Calculated age: 83 from DOB: 05/12/1942
[22:55:08] [DOC: 9167977] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:55:08] [DOC: 9167977] ℹ️  Payer Source extracted: 'Medicare'
[22:55:08] [DOC: 9167977] ℹ️  Diagnosis codes being written:
[22:55:08] [DOC: 9167977] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:55:08] [DOC: 9167977] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:55:08] [DOC: 9167977] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:55:08] [DOC: 9167977] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:55:08] [DOC: 9167977] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:55:08] [DOC: 9167977] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:55:08] [DOC: 9167977] ✅ Patient data written to CSV: Irene Gauthier | Sex: FEMALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 1033009
[22:55:08] ✅    ✅ Document 9167977 processed and saved successfully
[22:55:08] 🔄 
🔄 Step 8: Saving API details...
[22:55:08] [DOC: 9167977] ℹ️  API push details saved for document 9167977
[22:55:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167974                         ║
================================================================================
[22:55:08] ℹ️  Agency: Dartmouth HH
[22:55:08] ℹ️  Date: 03/07/2025
[22:55:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:55:11] [DOC: 9167974] ✅ Text extracted using pdfplumber (4344 chars)
[22:55:11] ✅    ✅ Text extracted using pdfplumber (4344 chars)
[22:55:11] 🔄 
🔄 Step 2: Extracting patient data...
[22:55:13] ℹ️  AI extracted raw sex value: 'F'
[22:55:13] ℹ️  AI extracted service line: 'Physical Therapy'
[22:55:13] ℹ️  AI extracted payer source: 'Medicare'
[22:55:13] ℹ️  AI extracted diagnoses:
[22:55:13] ℹ️    - Diagnosis 1: 'None'
[22:55:13] ℹ️    - Diagnosis 2: 'None'
[22:55:13] ℹ️    - Diagnosis 3: 'None'
[22:55:13] ℹ️    - Diagnosis 4: 'None'
[22:55:13] ℹ️    - Diagnosis 5: 'None'
[22:55:13] ℹ️    - Diagnosis 6: 'None'
[22:55:13] ℹ️  Final extracted MRN: '5862015'
[22:55:13] ℹ️  Final extracted Sex: 'FEMALE'
[22:55:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:55:13] ℹ️  Final extracted Payer Source: 'Medicare'
[22:55:13] ✅ Patient data extraction completed successfully
[22:55:13] ✅    ✅ Patient data extracted successfully
[22:55:13] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:55:13] ✅    ✅ Patient identified: Janice Arruda
[22:55:13] ✅    ✅ Patient name validation passed
[22:55:13] 🔄 
🔄 Step 3: Processing patient dates...
[22:55:13] [DOC: 9167974] ℹ️  DOB normalized: 01/24/1950
[22:55:13] [DOC: 9167974] ℹ️  Episode startOfCare normalized: 02/08/2025
[22:55:13] [DOC: 9167974] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[22:55:13] [DOC: 9167974] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[22:55:13] [DOC: 9167974] ✅ Patient date processing completed successfully
[22:55:13] ✅    ✅ Date processing completed
[22:55:13] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025'}]
[22:55:13] 🔄 
🔄 Step 4: Extracting order data...
[22:55:16] ℹ️  Order extraction - MRN: '5862015'
[22:55:16] ℹ️  Order extraction - Sex: 'FEMALE'
[22:55:16] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[22:55:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:55:16] ✅ Order data extraction completed successfully
[22:55:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:55:16] ℹ️  Using MRN from patient data: '5862015' over '5862015'
[22:55:16] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[22:55:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:55:16] ✅ Patient name cross-validation successful
[22:55:16] ✅    ✅ Data merged successfully
[22:55:17] ✅    ✅ Order data extracted and validated
[22:55:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:55:17] [DOC: 9167974] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[22:55:17] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[22:55:17] 🔄 
🔄 Step 6: Pushing order to API...
[22:55:17] [DOC: 9167974] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[22:55:18] [DOC: 9167974] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:55:18] ❌    ❌ Failed to push order
[22:55:18] 🔄 
🔄 Step 7: Writing to CSV...
[22:55:18] [DOC: 9167974] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[22:55:18] [DOC: 9167974] ℹ️  Service Line extracted: 'Physical Therapy'
[22:55:18] [DOC: 9167974] ℹ️  Payer Source extracted: 'Medicare'
[22:55:18] [DOC: 9167974] ℹ️  Diagnosis codes being written:
[22:55:18] [DOC: 9167974] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:55:18] [DOC: 9167974] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:55:18] [DOC: 9167974] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:55:18] [DOC: 9167974] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:55:18] [DOC: 9167974] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:55:18] [DOC: 9167974] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:55:18] [DOC: 9167974] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: Physical Therapy | Payer: Medicare | MRN: 5862015
[22:55:18] ✅    ✅ Document 9167974 processed and saved successfully
[22:55:18] 🔄 
🔄 Step 8: Saving API details...
[22:55:18] [DOC: 9167974] ℹ️  API push details saved for document 9167974
[22:55:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167973                         ║
================================================================================
[22:55:18] ℹ️  Agency: Dartmouth HH
[22:55:18] ℹ️  Date: 03/07/2025
[22:55:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:55:20] [DOC: 9167973] ✅ Text extracted using pdfplumber (3321 chars)
[22:55:20] ✅    ✅ Text extracted using pdfplumber (3321 chars)
[22:55:20] 🔄 
🔄 Step 2: Extracting patient data...
[22:55:23] ℹ️  AI extracted raw sex value: 'F'
[22:55:23] ℹ️  AI extracted service line: 'PT'
[22:55:23] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[22:55:23] ℹ️  AI extracted diagnoses:
[22:55:23] ℹ️    - Diagnosis 1: ''
[22:55:23] ℹ️    - Diagnosis 2: ''
[22:55:23] ℹ️    - Diagnosis 3: ''
[22:55:23] ℹ️    - Diagnosis 4: ''
[22:55:23] ℹ️    - Diagnosis 5: ''
[22:55:23] ℹ️    - Diagnosis 6: ''
[22:55:23] ℹ️  Final extracted MRN: '1107015'
[22:55:23] ℹ️  Final extracted Sex: 'FEMALE'
[22:55:23] ℹ️  Final extracted Service Line: 'PT'
[22:55:23] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[22:55:23] ✅ Patient data extraction completed successfully
[22:55:23] ✅    ✅ Patient data extracted successfully
[22:55:23] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Lemelin
     └─ dob: 11/30/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1107015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:55:23] ✅    ✅ Patient identified: Shirley Lemelin
[22:55:23] ✅    ✅ Patient name validation passed
[22:55:23] 🔄 
🔄 Step 3: Processing patient dates...
[22:55:23] [DOC: 9167973] ℹ️  DOB normalized: 11/30/1929
[22:55:23] [DOC: 9167973] ℹ️  Episode startOfCare normalized: 02/03/2025
[22:55:23] [DOC: 9167973] ℹ️  Episode startOfEpisode normalized: 02/03/2025
[22:55:23] [DOC: 9167973] ℹ️  Episode endOfEpisode normalized: 04/03/2025
[22:55:23] [DOC: 9167973] ✅ Patient date processing completed successfully
[22:55:23] ✅    ✅ Date processing completed
[22:55:23] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Lemelin
     └─ dob: 11/30/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1107015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:55:23] 🔄 
🔄 Step 4: Extracting order data...
[22:55:25] ℹ️  Order extraction - MRN: ''
[22:55:25] ℹ️  Order extraction - Sex: 'FEMALE'
[22:55:25] ℹ️  Order extraction - Service Line: 'PT'
[22:55:25] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[22:55:25] ✅ Order data extraction completed successfully
[22:55:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:55:25] ℹ️  Using MRN from patient data: '1107015'
[22:55:25] ℹ️  Service line consistent in both sources: 'PT'
[22:55:25] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[22:55:25] ✅ Patient name cross-validation successful
[22:55:25] ✅    ✅ Data merged successfully
[22:55:27] ✅    ✅ Order data extracted and validated
[22:55:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:55:35] [DOC: 9167973] ℹ️  Patient not found in cache or API: Shirley Lemelin
[22:55:35] [DOC: 9167973] ℹ️  Patient not found, creating new patient via API...
[22:55:35] [DOC: 9167973] ℹ️  Creating patient via API: Shirley Lemelin
[22:55:36] [DOC: 9167973] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:55:36] ❌    ❌ Failed to create patient
[22:55:36] [DOC: 9167973] ℹ️  API push details saved for document 9167973
================================================================================
║                        Processing Document ID: 9167970                         ║
================================================================================
[22:55:36] ℹ️  Agency: Dartmouth HH
[22:55:36] ℹ️  Date: 03/07/2025
[22:55:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:55:38] [DOC: 9167970] ✅ Text extracted using pdfplumber (1266 chars)
[22:55:38] ✅    ✅ Text extracted using pdfplumber (1266 chars)
[22:55:38] 🔄 
🔄 Step 2: Extracting patient data...
[22:55:40] ℹ️  AI extracted raw sex value: 'F'
[22:55:40] ℹ️  AI extracted service line: 'RN'
[22:55:40] ℹ️  AI extracted payer source: 'Medicare'
[22:55:40] ℹ️  AI extracted diagnoses:
[22:55:40] ℹ️    - Diagnosis 1: ''
[22:55:40] ℹ️    - Diagnosis 2: ''
[22:55:40] ℹ️    - Diagnosis 3: ''
[22:55:40] ℹ️    - Diagnosis 4: ''
[22:55:40] ℹ️    - Diagnosis 5: ''
[22:55:40] ℹ️    - Diagnosis 6: ''
[22:55:40] ℹ️  Final extracted MRN: '6479009'
[22:55:40] ℹ️  Final extracted Sex: 'FEMALE'
[22:55:40] ℹ️  Final extracted Service Line: 'RN'
[22:55:40] ℹ️  Final extracted Payer Source: 'Medicare'
[22:55:40] ✅ Patient data extraction completed successfully
[22:55:40] ✅    ✅ Patient data extracted successfully
[22:55:40] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Lheureux
     └─ dob: 07/01/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6479009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/13/2025', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:55:40] ✅    ✅ Patient identified: Joyce Lheureux
[22:55:40] ✅    ✅ Patient name validation passed
[22:55:40] 🔄 
🔄 Step 3: Processing patient dates...
[22:55:40] [DOC: 9167970] ℹ️  DOB normalized: 07/01/1943
[22:55:40] [DOC: 9167970] ℹ️  Episode startOfCare normalized: 02/13/2025
[22:55:40] [DOC: 9167970] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[22:55:40] [DOC: 9167970] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[22:55:40] [DOC: 9167970] ✅ Patient date processing completed successfully
[22:55:40] ✅    ✅ Date processing completed
[22:55:40] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Lheureux
     └─ dob: 07/01/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6479009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/13/2025', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:55:40] 🔄 
🔄 Step 4: Extracting order data...
[22:55:43] ℹ️  Order extraction - MRN: ''
[22:55:43] ℹ️  Order extraction - Sex: 'FEMALE'
[22:55:43] ℹ️  Order extraction - Service Line: 'RN'
[22:55:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:55:43] ✅ Order data extraction completed successfully
[22:55:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:55:43] ℹ️  Using MRN from patient data: '6479009'
[22:55:43] ℹ️  Service line consistent in both sources: 'RN'
[22:55:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:55:43] ✅ Patient name cross-validation successful
[22:55:43] ✅    ✅ Data merged successfully
[22:55:44] ✅    ✅ Order data extracted and validated
[22:55:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:55:55] [DOC: 9167970] ✅ Patient exists in API: Joyce Lheureux, ID: cd82e82b-7cb7-4d2d-a283-912cc10fe12e
[22:55:55] ✅    ✅ Existing patient found with ID: cd82e82b-7cb7-4d2d-a283-912cc10fe12e
[22:55:55] 🔄 
🔄 Step 6: Pushing order to API...
[22:55:55] [DOC: 9167970] ℹ️  Pushing order via API for patient ID: cd82e82b-7cb7-4d2d-a283-912cc10fe12e
[22:55:56] [DOC: 9167970] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:55:56] ❌    ❌ Failed to push order
[22:55:56] 🔄 
🔄 Step 7: Writing to CSV...
[22:55:56] [DOC: 9167970] ℹ️  Calculated age: 81 from DOB: 07/01/1943
[22:55:56] [DOC: 9167970] ℹ️  Service Line extracted: 'RN'
[22:55:56] [DOC: 9167970] ℹ️  Payer Source extracted: 'Medicare'
[22:55:56] [DOC: 9167970] ℹ️  Diagnosis codes being written:
[22:55:56] [DOC: 9167970] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:55:56] [DOC: 9167970] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:55:56] [DOC: 9167970] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:55:56] [DOC: 9167970] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:55:56] [DOC: 9167970] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:55:56] [DOC: 9167970] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:55:56] [DOC: 9167970] ✅ Patient data written to CSV: Joyce Lheureux | Sex: FEMALE | Age: 81 | Service: RN | Payer: Medicare | MRN: 6479009
[22:55:56] ✅    ✅ Document 9167970 processed and saved successfully
[22:55:56] 🔄 
🔄 Step 8: Saving API details...
[22:55:56] [DOC: 9167970] ℹ️  API push details saved for document 9167970
[22:55:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167967                         ║
================================================================================
[22:55:56] ℹ️  Agency: Dartmouth HH
[22:55:56] ℹ️  Date: 03/07/2025
[22:55:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:55:59] [DOC: 9167967] ✅ Text extracted using pdfplumber (21509 chars)
[22:55:59] ✅    ✅ Text extracted using pdfplumber (21497 chars)
[22:55:59] 🔄 
🔄 Step 2: Extracting patient data...
[22:56:03] ℹ️  AI extracted raw sex value: 'F'
[22:56:03] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[22:56:03] ℹ️  AI extracted payer source: 'None'
[22:56:03] ℹ️  AI extracted diagnoses:
[22:56:03] ℹ️    - Diagnosis 1: 'S81.812D'
[22:56:03] ℹ️    - Diagnosis 2: 'S72.141S'
[22:56:03] ℹ️    - Diagnosis 3: 'I48.20'
[22:56:03] ℹ️    - Diagnosis 4: 'I13.0'
[22:56:03] ℹ️    - Diagnosis 5: 'I50.32'
[22:56:03] ℹ️    - Diagnosis 6: 'N18.32'
[22:56:03] ℹ️  Final extracted MRN: '227027'
[22:56:03] ℹ️  Final extracted Sex: 'FEMALE'
[22:56:03] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[22:56:03] ℹ️  Final extracted Payer Source: ''
[22:56:03] ✅ Patient data extraction completed successfully
[22:56:03] ✅    ✅ Patient data extracted successfully
[22:56:03] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Lheureux
     └─ dob: 07/01/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'S72.141S', 'thirdDiagnosis': 'I48.20', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'N18.32'}]
[22:56:03] ✅    ✅ Patient identified: Joyce Lheureux
[22:56:03] ✅    ✅ Patient name validation passed
[22:56:03] 🔄 
🔄 Step 3: Processing patient dates...
[22:56:03] [DOC: 9167967] ℹ️  DOB normalized: 07/01/1943
[22:56:03] [DOC: 9167967] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[22:56:03] [DOC: 9167967] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[22:56:03] [DOC: 9167967] ✅ Patient date processing completed successfully
[22:56:03] ✅    ✅ Date processing completed
[22:56:03] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Lheureux
     └─ dob: 07/01/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'S72.141S', 'thirdDiagnosis': 'I48.20', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'N18.32'}]
[22:56:03] 🔄 
🔄 Step 4: Extracting order data...
[22:56:05] ℹ️  Order extraction - MRN: '6479009'
[22:56:05] ℹ️  Order extraction - Sex: 'FEMALE'
[22:56:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[22:56:05] ℹ️  Order extraction - Payer Source: ''
[22:56:05] ✅ Order data extraction completed successfully
[22:56:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:56:05] ℹ️  Using longer MRN from order data: '6479009' over '227027'
[22:56:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[22:56:05] ✅ Patient name cross-validation successful
[22:56:05] ✅    ✅ Data merged successfully
[22:56:06] ✅    ✅ Order data extracted and validated
[22:56:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:56:06] [DOC: 9167967] ✅ Patient found in local cache: Joyce Lheureux, ID: cd82e82b-7cb7-4d2d-a283-912cc10fe12e
[22:56:06] ✅    ✅ Existing patient found with ID: cd82e82b-7cb7-4d2d-a283-912cc10fe12e
[22:56:06] 🔄 
🔄 Step 6: Pushing order to API...
[22:56:06] [DOC: 9167967] ℹ️  Pushing order via API for patient ID: cd82e82b-7cb7-4d2d-a283-912cc10fe12e
[22:56:08] [DOC: 9167967] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:56:08] ❌    ❌ Failed to push order
[22:56:08] 🔄 
🔄 Step 7: Writing to CSV...
[22:56:08] [DOC: 9167967] ℹ️  Calculated age: 81 from DOB: 07/01/1943
[22:56:08] [DOC: 9167967] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[22:56:08] [DOC: 9167967] ℹ️  Payer Source extracted: ''
[22:56:08] [DOC: 9167967] ℹ️  Diagnosis codes being written:
[22:56:08] [DOC: 9167967] ℹ️    - Latest_Episode_Firstdiagnosis: 'S81.812D'
[22:56:08] [DOC: 9167967] ℹ️    - Latest_Episode_Seconddiagnosis: 'S72.141S'
[22:56:08] [DOC: 9167967] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.20'
[22:56:08] [DOC: 9167967] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I13.0'
[22:56:08] [DOC: 9167967] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[22:56:08] [DOC: 9167967] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.32'
[22:56:08] [DOC: 9167967] ✅ Patient data written to CSV: Joyce Lheureux | Sex: FEMALE | Age: 81 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 6479009
[22:56:08] ✅    ✅ Document 9167967 processed and saved successfully
[22:56:08] 🔄 
🔄 Step 8: Saving API details...
[22:56:08] [DOC: 9167967] ℹ️  API push details saved for document 9167967
[22:56:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167955                         ║
================================================================================
[22:56:08] ℹ️  Agency: Dartmouth HH
[22:56:08] ℹ️  Date: 03/07/2025
[22:56:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:56:10] [DOC: 9167955] ✅ Text extracted using pdfplumber (3075 chars)
[22:56:10] ✅    ✅ Text extracted using pdfplumber (3075 chars)
[22:56:10] 🔄 
🔄 Step 2: Extracting patient data...
[22:56:13] ℹ️  AI extracted raw sex value: 'F'
[22:56:13] ℹ️  AI extracted service line: 'PT'
[22:56:13] ℹ️  AI extracted payer source: 'Medicare'
[22:56:13] ℹ️  AI extracted diagnoses:
[22:56:13] ℹ️    - Diagnosis 1: 'None'
[22:56:13] ℹ️    - Diagnosis 2: 'None'
[22:56:13] ℹ️    - Diagnosis 3: 'None'
[22:56:13] ℹ️    - Diagnosis 4: 'None'
[22:56:13] ℹ️    - Diagnosis 5: 'None'
[22:56:13] ℹ️    - Diagnosis 6: 'None'
[22:56:13] ℹ️  Final extracted MRN: '7141009'
[22:56:13] ℹ️  Final extracted Sex: 'FEMALE'
[22:56:13] ℹ️  Final extracted Service Line: 'PT'
[22:56:13] ℹ️  Final extracted Payer Source: 'Medicare'
[22:56:13] ✅ Patient data extraction completed successfully
[22:56:13] ✅    ✅ Patient data extracted successfully
[22:56:13] 📊 Patient Response
     └─ patientFName: Alice
     └─ patientLName: Almeida
     └─ dob: 04/04/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7141009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:56:13] ✅    ✅ Patient identified: Alice Almeida
[22:56:13] ✅    ✅ Patient name validation passed
[22:56:13] 🔄 
🔄 Step 3: Processing patient dates...
[22:56:13] [DOC: 9167955] ℹ️  DOB normalized: 04/04/1944
[22:56:13] [DOC: 9167955] ℹ️  Episode startOfCare normalized: 02/01/2025
[22:56:13] [DOC: 9167955] ℹ️  Episode startOfEpisode normalized: 02/01/2025
[22:56:13] [DOC: 9167955] ℹ️  Episode endOfEpisode normalized: 04/01/2025
[22:56:13] [DOC: 9167955] ✅ Patient date processing completed successfully
[22:56:13] ✅    ✅ Date processing completed
[22:56:13] 📊 Processed Patient Data
     └─ patientFName: Alice
     └─ patientLName: Almeida
     └─ dob: 04/04/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7141009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025'}]
[22:56:13] 🔄 
🔄 Step 4: Extracting order data...
[22:56:15] ℹ️  Order extraction - MRN: ''
[22:56:15] ℹ️  Order extraction - Sex: 'FEMALE'
[22:56:15] ℹ️  Order extraction - Service Line: 'PT'
[22:56:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:56:15] ✅ Order data extraction completed successfully
[22:56:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:56:15] ℹ️  Using MRN from patient data: '7141009'
[22:56:15] ℹ️  Service line consistent in both sources: 'PT'
[22:56:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:56:15] ✅ Patient name cross-validation successful
[22:56:15] ✅    ✅ Data merged successfully
[22:56:16] ✅    ✅ Order data extracted and validated
[22:56:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:56:16] [DOC: 9167955] ✅ Patient found in local cache: Alice Almeida, ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[22:56:16] ✅    ✅ Existing patient found with ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[22:56:16] 🔄 
🔄 Step 6: Pushing order to API...
[22:56:16] [DOC: 9167955] ℹ️  Pushing order via API for patient ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[22:56:18] [DOC: 9167955] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:56:18] ❌    ❌ Failed to push order
[22:56:18] 🔄 
🔄 Step 7: Writing to CSV...
[22:56:18] [DOC: 9167955] ℹ️  Calculated age: 81 from DOB: 04/04/1944
[22:56:18] [DOC: 9167955] ℹ️  Service Line extracted: 'PT'
[22:56:18] [DOC: 9167955] ℹ️  Payer Source extracted: 'Medicare'
[22:56:18] [DOC: 9167955] ℹ️  Diagnosis codes being written:
[22:56:18] [DOC: 9167955] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:56:18] [DOC: 9167955] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:56:18] [DOC: 9167955] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:56:18] [DOC: 9167955] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:56:18] [DOC: 9167955] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:56:18] [DOC: 9167955] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:56:18] [DOC: 9167955] ✅ Patient data written to CSV: Alice Almeida | Sex: FEMALE | Age: 81 | Service: PT | Payer: Medicare | MRN: 7141009
[22:56:18] ✅    ✅ Document 9167955 processed and saved successfully
[22:56:18] 🔄 
🔄 Step 8: Saving API details...
[22:56:18] [DOC: 9167955] ℹ️  API push details saved for document 9167955
[22:56:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167951                         ║
================================================================================
[22:56:18] ℹ️  Agency: Dartmouth HH
[22:56:18] ℹ️  Date: 03/07/2025
[22:56:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:56:20] [DOC: 9167951] ✅ Text extracted using pdfplumber (1180 chars)
[22:56:20] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[22:56:20] 🔄 
🔄 Step 2: Extracting patient data...
[22:56:22] ℹ️  AI extracted raw sex value: 'F'
[22:56:22] ℹ️  AI extracted service line: 'Physical Therapy'
[22:56:22] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[22:56:22] ℹ️  AI extracted diagnoses:
[22:56:22] ℹ️    - Diagnosis 1: 'None'
[22:56:22] ℹ️    - Diagnosis 2: 'None'
[22:56:22] ℹ️    - Diagnosis 3: 'None'
[22:56:22] ℹ️    - Diagnosis 4: 'None'
[22:56:22] ℹ️    - Diagnosis 5: 'None'
[22:56:22] ℹ️    - Diagnosis 6: 'None'
[22:56:22] ℹ️  Final extracted MRN: '5625015'
[22:56:22] ℹ️  Final extracted Sex: 'FEMALE'
[22:56:22] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:56:22] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[22:56:22] ✅ Patient data extraction completed successfully
[22:56:22] ✅    ✅ Patient data extracted successfully
[22:56:22] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Potter
     └─ dob: 07/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5625015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 87 Clifford Street Apt 1-A 1W
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2025', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:56:22] ✅    ✅ Patient identified: Cheryl Potter
[22:56:22] ✅    ✅ Patient name validation passed
[22:56:22] 🔄 
🔄 Step 3: Processing patient dates...
[22:56:22] [DOC: 9167951] ℹ️  DOB normalized: 07/15/1955
[22:56:22] [DOC: 9167951] ℹ️  Episode startOfCare normalized: 01/22/2025
[22:56:22] [DOC: 9167951] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[22:56:22] [DOC: 9167951] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[22:56:22] [DOC: 9167951] ✅ Patient date processing completed successfully
[22:56:22] ✅    ✅ Date processing completed
[22:56:22] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Potter
     └─ dob: 07/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5625015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 87 Clifford Street Apt 1-A 1W
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2025', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025'}]
[22:56:22] 🔄 
🔄 Step 4: Extracting order data...
[22:56:25] ℹ️  Order extraction - MRN: ''
[22:56:25] ℹ️  Order extraction - Sex: 'FEMALE'
[22:56:25] ℹ️  Order extraction - Service Line: 'PT'
[22:56:25] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[22:56:25] ✅ Order data extraction completed successfully
[22:56:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:56:25] ℹ️  Using MRN from patient data: '5625015'
[22:56:25] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[22:56:25] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[22:56:25] ✅ Patient name cross-validation successful
[22:56:25] ✅    ✅ Data merged successfully
[22:56:26] ✅    ✅ Order data extracted and validated
[22:56:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:56:35] [DOC: 9167951] ✅ Patient exists in API: Cheryl Potter, ID: 29c2fc6e-bb5e-4b23-8e46-b089ca2cbe22
[22:56:35] ✅    ✅ Existing patient found with ID: 29c2fc6e-bb5e-4b23-8e46-b089ca2cbe22
[22:56:35] 🔄 
🔄 Step 6: Pushing order to API...
[22:56:35] [DOC: 9167951] ℹ️  Pushing order via API for patient ID: 29c2fc6e-bb5e-4b23-8e46-b089ca2cbe22
[22:56:36] [DOC: 9167951] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13086"}
[22:56:36] ❌    ❌ Failed to push order
[22:56:36] 🔄 
🔄 Step 7: Writing to CSV...
[22:56:36] [DOC: 9167951] ℹ️  Calculated age: 69 from DOB: 07/15/1955
[22:56:36] [DOC: 9167951] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[22:56:36] [DOC: 9167951] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[22:56:36] [DOC: 9167951] ℹ️  Diagnosis codes being written:
[22:56:36] [DOC: 9167951] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:56:36] [DOC: 9167951] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:56:36] [DOC: 9167951] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:56:36] [DOC: 9167951] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:56:36] [DOC: 9167951] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:56:36] [DOC: 9167951] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:56:36] [DOC: 9167951] ✅ Patient data written to CSV: Cheryl Potter | Sex: FEMALE | Age: 69 | Service: PT, Physical Therapy | Payer: Aetna- Mcare | MRN: 5625015
[22:56:36] ✅    ✅ Document 9167951 processed and saved successfully
[22:56:36] 🔄 
🔄 Step 8: Saving API details...
[22:56:36] [DOC: 9167951] ℹ️  API push details saved for document 9167951
[22:56:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167949                         ║
================================================================================
[22:56:36] ℹ️  Agency: Dartmouth HH
[22:56:36] ℹ️  Date: 03/07/2025
[22:56:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:56:38] [DOC: 9167949] ✅ Text extracted using pdfplumber (2831 chars)
[22:56:38] ✅    ✅ Text extracted using pdfplumber (2831 chars)
[22:56:38] 🔄 
🔄 Step 2: Extracting patient data...
[22:56:41] ℹ️  AI extracted raw sex value: 'M'
[22:56:41] ℹ️  AI extracted service line: 'RN, LPN'
[22:56:41] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[22:56:41] ℹ️  AI extracted diagnoses:
[22:56:41] ℹ️    - Diagnosis 1: 'None'
[22:56:41] ℹ️    - Diagnosis 2: 'None'
[22:56:41] ℹ️    - Diagnosis 3: 'None'
[22:56:41] ℹ️    - Diagnosis 4: 'None'
[22:56:41] ℹ️    - Diagnosis 5: 'None'
[22:56:41] ℹ️    - Diagnosis 6: 'None'
[22:56:41] ℹ️  Final extracted MRN: '5879015'
[22:56:41] ℹ️  Final extracted Sex: 'MALE'
[22:56:41] ℹ️  Final extracted Service Line: 'RN, LPN'
[22:56:41] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:56:41] ✅ Patient data extraction completed successfully
[22:56:41] ✅    ✅ Patient data extracted successfully
[22:56:41] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:56:41] ✅    ✅ Patient identified: Roger Alves
[22:56:41] ✅    ✅ Patient name validation passed
[22:56:41] 🔄 
🔄 Step 3: Processing patient dates...
[22:56:41] [DOC: 9167949] ℹ️  DOB normalized: 11/12/1943
[22:56:41] [DOC: 9167949] ℹ️  Episode startOfCare normalized: 01/20/2025
[22:56:41] [DOC: 9167949] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[22:56:41] [DOC: 9167949] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[22:56:41] [DOC: 9167949] ✅ Patient date processing completed successfully
[22:56:41] ✅    ✅ Date processing completed
[22:56:41] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025'}]
[22:56:41] 🔄 
🔄 Step 4: Extracting order data...
[22:56:43] ℹ️  Order extraction - MRN: ''
[22:56:43] ℹ️  Order extraction - Sex: 'MALE'
[22:56:43] ℹ️  Order extraction - Service Line: 'RN, LPN'
[22:56:43] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[22:56:43] ✅ Order data extraction completed successfully
[22:56:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:56:43] ℹ️  Using MRN from patient data: '5879015'
[22:56:43] ℹ️  Service line consistent in both sources: 'RN, LPN'
[22:56:43] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[22:56:43] ✅ Patient name cross-validation successful
[22:56:43] ✅    ✅ Data merged successfully
[22:56:44] ✅    ✅ Order data extracted and validated
[22:56:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:56:44] [DOC: 9167949] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[22:56:44] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[22:56:44] 🔄 
🔄 Step 6: Pushing order to API...
[22:56:44] [DOC: 9167949] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[22:56:46] [DOC: 9167949] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:56:46] ❌    ❌ Failed to push order
[22:56:46] 🔄 
🔄 Step 7: Writing to CSV...
[22:56:46] [DOC: 9167949] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[22:56:46] [DOC: 9167949] ℹ️  Service Line extracted: 'RN, LPN'
[22:56:46] [DOC: 9167949] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[22:56:46] [DOC: 9167949] ℹ️  Diagnosis codes being written:
[22:56:46] [DOC: 9167949] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:56:46] [DOC: 9167949] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:56:46] [DOC: 9167949] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:56:46] [DOC: 9167949] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:56:46] [DOC: 9167949] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:56:46] [DOC: 9167949] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:56:46] [DOC: 9167949] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: RN, LPN | Payer: Tufts Health Plan Medicare Preferred | MRN: 5879015
[22:56:46] ✅    ✅ Document 9167949 processed and saved successfully
[22:56:46] 🔄 
🔄 Step 8: Saving API details...
[22:56:46] [DOC: 9167949] ℹ️  API push details saved for document 9167949
[22:56:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167945                         ║
================================================================================
[22:56:46] ℹ️  Agency: Dartmouth HH
[22:56:46] ℹ️  Date: 03/07/2025
[22:56:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:56:48] [DOC: 9167945] ✅ Text extracted using pdfplumber (3041 chars)
[22:56:48] ✅    ✅ Text extracted using pdfplumber (3041 chars)
[22:56:48] 🔄 
🔄 Step 2: Extracting patient data...
[22:56:51] ℹ️  AI extracted raw sex value: 'M'
[22:56:51] ℹ️  AI extracted service line: 'OT'
[22:56:51] ℹ️  AI extracted payer source: 'Medicare'
[22:56:51] ℹ️  AI extracted diagnoses:
[22:56:51] ℹ️    - Diagnosis 1: 'None'
[22:56:51] ℹ️    - Diagnosis 2: 'None'
[22:56:51] ℹ️    - Diagnosis 3: 'None'
[22:56:51] ℹ️    - Diagnosis 4: 'None'
[22:56:51] ℹ️    - Diagnosis 5: 'None'
[22:56:51] ℹ️    - Diagnosis 6: 'None'
[22:56:51] ℹ️  Final extracted MRN: '1396009'
[22:56:51] ℹ️  Final extracted Sex: 'MALE'
[22:56:51] ℹ️  Final extracted Service Line: 'OT'
[22:56:51] ℹ️  Final extracted Payer Source: 'Medicare'
[22:56:51] ✅ Patient data extraction completed successfully
[22:56:51] ✅    ✅ Patient data extracted successfully
[22:56:51] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[22:56:51] ✅    ✅ Patient identified: Elias Ramos
[22:56:51] ✅    ✅ Patient name validation passed
[22:56:51] 🔄 
🔄 Step 3: Processing patient dates...
[22:56:51] [DOC: 9167945] ℹ️  DOB normalized: 08/28/1938
[22:56:51] [DOC: 9167945] ℹ️  Episode startOfCare normalized: 12/31/2024
[22:56:51] [DOC: 9167945] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[22:56:51] [DOC: 9167945] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[22:56:51] [DOC: 9167945] ✅ Patient date processing completed successfully
[22:56:51] ✅    ✅ Date processing completed
[22:56:51] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025'}]
[22:56:51] 🔄 
🔄 Step 4: Extracting order data...
[22:56:53] ℹ️  Order extraction - MRN: ''
[22:56:53] ℹ️  Order extraction - Sex: 'MALE'
[22:56:53] ℹ️  Order extraction - Service Line: 'OT'
[22:56:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:56:53] ✅ Order data extraction completed successfully
[22:56:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:56:53] ℹ️  Using MRN from patient data: '1396009'
[22:56:53] ℹ️  Service line consistent in both sources: 'OT'
[22:56:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:56:53] ✅ Patient name cross-validation successful
[22:56:53] ✅    ✅ Data merged successfully
[22:56:54] ✅    ✅ Order data extracted and validated
[22:56:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:56:54] [DOC: 9167945] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:56:54] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:56:54] 🔄 
🔄 Step 6: Pushing order to API...
[22:56:54] [DOC: 9167945] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:56:55] [DOC: 9167945] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13134"}
[22:56:55] ❌    ❌ Failed to push order
[22:56:55] 🔄 
🔄 Step 7: Writing to CSV...
[22:56:55] [DOC: 9167945] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[22:56:55] [DOC: 9167945] ℹ️  Service Line extracted: 'OT'
[22:56:55] [DOC: 9167945] ℹ️  Payer Source extracted: 'Medicare'
[22:56:55] [DOC: 9167945] ℹ️  Diagnosis codes being written:
[22:56:55] [DOC: 9167945] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:56:55] [DOC: 9167945] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:56:55] [DOC: 9167945] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:56:55] [DOC: 9167945] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:56:55] [DOC: 9167945] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:56:55] [DOC: 9167945] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:56:55] [DOC: 9167945] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: OT | Payer: Medicare | MRN: 1396009
[22:56:55] ✅    ✅ Document 9167945 processed and saved successfully
[22:56:55] 🔄 
🔄 Step 8: Saving API details...
[22:56:55] [DOC: 9167945] ℹ️  API push details saved for document 9167945
[22:56:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167944                         ║
================================================================================
[22:56:55] ℹ️  Agency: Dartmouth HH
[22:56:55] ℹ️  Date: 03/07/2025
[22:56:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:56:58] [DOC: 9167944] ✅ Text extracted using pdfplumber (4746 chars)
[22:56:58] ✅    ✅ Text extracted using pdfplumber (4746 chars)
[22:56:58] 🔄 
🔄 Step 2: Extracting patient data...
[22:57:00] ℹ️  AI extracted raw sex value: 'M'
[22:57:00] ℹ️  AI extracted service line: 'PT, ST'
[22:57:00] ℹ️  AI extracted payer source: 'Medicare'
[22:57:00] ℹ️  AI extracted diagnoses:
[22:57:00] ℹ️    - Diagnosis 1: ''
[22:57:00] ℹ️    - Diagnosis 2: ''
[22:57:00] ℹ️    - Diagnosis 3: ''
[22:57:00] ℹ️    - Diagnosis 4: ''
[22:57:00] ℹ️    - Diagnosis 5: ''
[22:57:00] ℹ️    - Diagnosis 6: ''
[22:57:00] ℹ️  Final extracted MRN: '1396009'
[22:57:00] ℹ️  Final extracted Sex: 'MALE'
[22:57:00] ℹ️  Final extracted Service Line: 'PT, ST'
[22:57:00] ℹ️  Final extracted Payer Source: 'Medicare'
[22:57:00] ✅ Patient data extraction completed successfully
[22:57:00] ✅    ✅ Patient data extracted successfully
[22:57:00] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, ST
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:57:00] ✅    ✅ Patient identified: Elias Ramos
[22:57:00] ✅    ✅ Patient name validation passed
[22:57:00] 🔄 
🔄 Step 3: Processing patient dates...
[22:57:00] [DOC: 9167944] ℹ️  DOB normalized: 08/28/1938
[22:57:00] [DOC: 9167944] ℹ️  Episode startOfCare normalized: 12/31/2024
[22:57:00] [DOC: 9167944] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[22:57:00] [DOC: 9167944] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[22:57:00] [DOC: 9167944] ✅ Patient date processing completed successfully
[22:57:00] ✅    ✅ Date processing completed
[22:57:00] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, ST
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:57:00] 🔄 
🔄 Step 4: Extracting order data...
[22:57:03] ℹ️  Order extraction - MRN: '1396009'
[22:57:03] ℹ️  Order extraction - Sex: 'MALE'
[22:57:03] ℹ️  Order extraction - Service Line: 'ST, PT'
[22:57:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:57:03] ✅ Order data extraction completed successfully
[22:57:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:57:03] ℹ️  Using MRN from patient data: '1396009' over '1396009'
[22:57:03] ℹ️  Combined service lines: Patient='PT, ST' + Order='ST, PT' = 'PT, ST'
[22:57:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:57:03] ✅ Patient name cross-validation successful
[22:57:03] ✅    ✅ Data merged successfully
[22:57:04] ✅    ✅ Order data extracted and validated
[22:57:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:57:04] [DOC: 9167944] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:57:04] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:57:04] 🔄 
🔄 Step 6: Pushing order to API...
[22:57:04] [DOC: 9167944] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:57:05] [DOC: 9167944] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:57:05] ❌    ❌ Failed to push order
[22:57:05] 🔄 
🔄 Step 7: Writing to CSV...
[22:57:05] [DOC: 9167944] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[22:57:05] [DOC: 9167944] ℹ️  Service Line extracted: 'PT, ST'
[22:57:05] [DOC: 9167944] ℹ️  Payer Source extracted: 'Medicare'
[22:57:05] [DOC: 9167944] ℹ️  Diagnosis codes being written:
[22:57:05] [DOC: 9167944] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:57:05] [DOC: 9167944] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:57:05] [DOC: 9167944] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:57:05] [DOC: 9167944] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:57:05] [DOC: 9167944] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:57:05] [DOC: 9167944] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:57:05] [DOC: 9167944] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: PT, ST | Payer: Medicare | MRN: 1396009
[22:57:05] ✅    ✅ Document 9167944 processed and saved successfully
[22:57:05] 🔄 
🔄 Step 8: Saving API details...
[22:57:05] [DOC: 9167944] ℹ️  API push details saved for document 9167944
[22:57:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167942                         ║
================================================================================
[22:57:05] ℹ️  Agency: Dartmouth HH
[22:57:05] ℹ️  Date: 03/07/2025
[22:57:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:57:09] [DOC: 9167942] ✅ Text extracted using pdfplumber (23026 chars)
[22:57:09] ✅    ✅ Text extracted using pdfplumber (23014 chars)
[22:57:09] 🔄 
🔄 Step 2: Extracting patient data...
[22:57:12] ℹ️  AI extracted raw sex value: 'M'
[22:57:12] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy'
[22:57:12] ℹ️  AI extracted payer source: ''
[22:57:12] ℹ️  AI extracted diagnoses:
[22:57:12] ℹ️    - Diagnosis 1: 'G20.A1'
[22:57:12] ℹ️    - Diagnosis 2: 'L89.153'
[22:57:12] ℹ️    - Diagnosis 3: 'L89.613'
[22:57:12] ℹ️    - Diagnosis 4: 'L89.623'
[22:57:12] ℹ️    - Diagnosis 5: 'L89.522'
[22:57:12] ℹ️    - Diagnosis 6: 'L89.511'
[22:57:12] ℹ️  Final extracted MRN: '1396009'
[22:57:12] ℹ️  Final extracted Sex: 'MALE'
[22:57:12] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy'
[22:57:12] ℹ️  Final extracted Payer Source: ''
[22:57:12] ✅ Patient data extraction completed successfully
[22:57:12] ✅    ✅ Patient data extracted successfully
[22:57:12] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'L89.153', 'thirdDiagnosis': 'L89.613', 'fourthDiagnosis': 'L89.623', 'fifthDiagnosis': 'L89.522', 'sixthDiagnosis': 'L89.511'}]
[22:57:12] ✅    ✅ Patient identified: Elias Ramos
[22:57:12] ✅    ✅ Patient name validation passed
[22:57:12] 🔄 
🔄 Step 3: Processing patient dates...
[22:57:12] [DOC: 9167942] ℹ️  DOB normalized: 08/28/1938
[22:57:12] [DOC: 9167942] ℹ️  Episode startOfCare normalized: 12/31/2024
[22:57:12] [DOC: 9167942] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[22:57:12] [DOC: 9167942] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[22:57:12] [DOC: 9167942] ✅ Patient date processing completed successfully
[22:57:12] ✅    ✅ Date processing completed
[22:57:12] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'L89.153', 'thirdDiagnosis': 'L89.613', 'fourthDiagnosis': 'L89.623', 'fifthDiagnosis': 'L89.522', 'sixthDiagnosis': 'L89.511'}]
[22:57:12] 🔄 
🔄 Step 4: Extracting order data...
[22:57:15] ℹ️  Order extraction - MRN: '1396009'
[22:57:15] ℹ️  Order extraction - Sex: 'MALE'
[22:57:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing,PT,OT,Speech Therapy'
[22:57:15] ℹ️  Order extraction - Payer Source: ''
[22:57:15] ✅ Order data extraction completed successfully
[22:57:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:57:15] ℹ️  Using MRN from patient data: '1396009' over '1396009'
[22:57:15] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy' + Order='Skilled Nursing,PT,OT,Speech Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing, Speech Therapy'
[22:57:15] ✅ Patient name cross-validation successful
[22:57:15] ✅    ✅ Data merged successfully
[22:57:16] ✅    ✅ Order data extracted and validated
[22:57:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:57:16] [DOC: 9167942] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:57:16] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:57:16] 🔄 
🔄 Step 6: Pushing order to API...
[22:57:16] [DOC: 9167942] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[22:57:18] [DOC: 9167942] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:57:18] ❌    ❌ Failed to push order
[22:57:18] 🔄 
🔄 Step 7: Writing to CSV...
[22:57:18] [DOC: 9167942] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[22:57:18] [DOC: 9167942] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing, Speech Therapy'
[22:57:18] [DOC: 9167942] ℹ️  Payer Source extracted: ''
[22:57:18] [DOC: 9167942] ℹ️  Diagnosis codes being written:
[22:57:18] [DOC: 9167942] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[22:57:18] [DOC: 9167942] ℹ️    - Latest_Episode_Seconddiagnosis: 'L89.153'
[22:57:18] [DOC: 9167942] ℹ️    - Latest_Episode_Thirddiagnosis: 'L89.613'
[22:57:18] [DOC: 9167942] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L89.623'
[22:57:18] [DOC: 9167942] ℹ️    - Latest_Episode_Fifthdiagnosis: 'L89.522'
[22:57:18] [DOC: 9167942] ℹ️    - Latest_Episode_Sixthdiagnosis: 'L89.511'
[22:57:18] [DOC: 9167942] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing, Speech Therapy | Payer:  | MRN: 1396009
[22:57:18] ✅    ✅ Document 9167942 processed and saved successfully
[22:57:18] 🔄 
🔄 Step 8: Saving API details...
[22:57:18] [DOC: 9167942] ℹ️  API push details saved for document 9167942
[22:57:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9167934                         ║
================================================================================
[22:57:18] ℹ️  Agency: Nizhoni Health-Fall River
[22:57:18] ℹ️  Date: 03/07/2025
[22:57:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:57:21] [DOC: 9167934] ✅ Text extracted using pdfplumber (14355 chars)
[22:57:21] ✅    ✅ Text extracted using pdfplumber (14355 chars)
[22:57:21] 🔄 
🔄 Step 2: Extracting patient data...
[22:57:25] ℹ️  AI extracted raw sex value: 'M'
[22:57:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:57:25] ℹ️  AI extracted payer source: 'None'
[22:57:25] ℹ️  AI extracted diagnoses:
[22:57:25] ℹ️    - Diagnosis 1: 'E11.9'
[22:57:25] ℹ️    - Diagnosis 2: 'S01.80XA'
[22:57:25] ℹ️    - Diagnosis 3: 'E78.5'
[22:57:25] ℹ️    - Diagnosis 4: 'E66.09'
[22:57:25] ℹ️    - Diagnosis 5: 'R41.3'
[22:57:25] ℹ️    - Diagnosis 6: 'R03.0'
[22:57:25] ℹ️  Final extracted MRN: '3934020'
[22:57:25] ℹ️  Final extracted Sex: 'MALE'
[22:57:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:57:25] ℹ️  Final extracted Payer Source: ''
[22:57:25] ✅ Patient data extraction completed successfully
[22:57:25] ✅    ✅ Patient data extracted successfully
[22:57:25] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Maker
     └─ dob: 03/26/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 3934020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100048246291
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA services
     └─ address: 12 Ruth Street Apt 403
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/05/2023', 'startOfEpisode': '01/18/2023', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'S01.80XA', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'E66.09', 'fifthDiagnosis': 'R41.3', 'sixthDiagnosis': 'R03.0'}]
[22:57:25] ✅    ✅ Patient identified: Robert Maker
[22:57:25] ✅    ✅ Patient name validation passed
[22:57:25] 🔄 
🔄 Step 3: Processing patient dates...
[22:57:25] [DOC: 9167934] ℹ️  DOB normalized: 03/26/1951
[22:57:25] [DOC: 9167934] ℹ️  Episode startOfCare normalized: 01/05/2023
[22:57:25] [DOC: 9167934] ℹ️  Episode startOfEpisode normalized: 01/18/2023
[22:57:25] [DOC: 9167934] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[22:57:25] [DOC: 9167934] ✅ Patient date processing completed successfully
[22:57:25] ✅    ✅ Date processing completed
[22:57:25] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Maker
     └─ dob: 03/26/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 3934020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100048246291
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA services
     └─ address: 12 Ruth Street Apt 403
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/05/2023', 'startOfEpisode': '01/18/2023', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'S01.80XA', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'E66.09', 'fifthDiagnosis': 'R41.3', 'sixthDiagnosis': 'R03.0'}]
[22:57:25] 🔄 
🔄 Step 4: Extracting order data...
[22:57:27] ℹ️  Order extraction - MRN: '3934020'
[22:57:27] ℹ️  Order extraction - Sex: 'MALE'
[22:57:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:57:27] ℹ️  Order extraction - Payer Source: ''
[22:57:27] ✅ Order data extraction completed successfully
[22:57:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:57:27] ℹ️  Using MRN from patient data: '3934020' over '3934020'
[22:57:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:57:27] ✅ Patient name cross-validation successful
[22:57:27] ✅    ✅ Data merged successfully
[22:57:28] ✅    ✅ Order data extracted and validated
[22:57:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:57:54] [DOC: 9167934] ℹ️  Patient not found in cache or API: Robert Maker
[22:57:54] [DOC: 9167934] ℹ️  Patient not found, creating new patient via API...
[22:57:54] [DOC: 9167934] ℹ️  Creating patient via API: Robert Maker
[22:57:55] [DOC: 9167934] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[22:57:55] ❌    ❌ Failed to create patient
[22:57:55] [DOC: 9167934] ℹ️  API push details saved for document 9167934
================================================================================
║                        Processing Document ID: 9167905                         ║
================================================================================
[22:57:55] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:57:55] ℹ️  Date: 03/07/2025
[22:57:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:57:57] [DOC: 9167905] ✅ Text extracted using pdfplumber (4550 chars)
[22:57:57] ✅    ✅ Text extracted using pdfplumber (4550 chars)
[22:57:57] 🔄 
🔄 Step 2: Extracting patient data...
[22:57:59] ℹ️  AI extracted raw sex value: 'None'
[22:57:59] ℹ️  AI extracted service line: 'None'
[22:57:59] ℹ️  AI extracted payer source: 'None'
[22:57:59] ℹ️  AI extracted diagnoses:
[22:57:59] ℹ️    - Diagnosis 1: ''
[22:57:59] ℹ️    - Diagnosis 2: ''
[22:57:59] ℹ️    - Diagnosis 3: ''
[22:57:59] ℹ️    - Diagnosis 4: ''
[22:57:59] ℹ️    - Diagnosis 5: ''
[22:57:59] ℹ️    - Diagnosis 6: ''
[22:57:59] ℹ️  Final extracted MRN: ''
[22:57:59] ℹ️  Final extracted Sex: ''
[22:57:59] ℹ️  Final extracted Service Line: ''
[22:57:59] ℹ️  Final extracted Payer Source: ''
[22:57:59] ✅ Patient data extraction completed successfully
[22:57:59] ✅    ✅ Patient data extracted successfully
[22:57:59] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:57:59] ⚠️     ❌ Insufficient patient data extracted
[22:57:59] [DOC: 9167905] ℹ️  API push details saved for document 9167905
================================================================================
║                        Processing Document ID: 9167902                         ║
================================================================================
[22:57:59] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:57:59] ℹ️  Date: 03/07/2025
[22:57:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:06] [DOC: 9167902] ✅ Text extracted using pdfplumber (44965 chars)
[22:58:06] ✅    ✅ Text extracted using pdfplumber (44965 chars)
[22:58:06] 🔄 
🔄 Step 2: Extracting patient data...
[22:58:11] ℹ️  AI extracted raw sex value: ''
[22:58:11] ℹ️  AI extracted service line: ''
[22:58:11] ℹ️  AI extracted payer source: ''
[22:58:11] ℹ️  AI extracted diagnoses:
[22:58:11] ℹ️    - Diagnosis 1: ''
[22:58:11] ℹ️    - Diagnosis 2: ''
[22:58:11] ℹ️    - Diagnosis 3: ''
[22:58:11] ℹ️    - Diagnosis 4: ''
[22:58:11] ℹ️    - Diagnosis 5: ''
[22:58:11] ℹ️    - Diagnosis 6: ''
[22:58:11] ℹ️  Final extracted MRN: ''
[22:58:11] ℹ️  Final extracted Sex: ''
[22:58:11] ℹ️  Final extracted Service Line: ''
[22:58:11] ℹ️  Final extracted Payer Source: ''
[22:58:11] ✅ Patient data extraction completed successfully
[22:58:11] ✅    ✅ Patient data extracted successfully
[22:58:11] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:58:11] ⚠️     ❌ Insufficient patient data extracted
[22:58:11] [DOC: 9167902] ℹ️  API push details saved for document 9167902
================================================================================
║                        Processing Document ID: 9167901                         ║
================================================================================
[22:58:11] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:58:11] ℹ️  Date: 03/07/2025
[22:58:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:14] [DOC: 9167901] ✅ Text extracted using pdfplumber (44097 chars)
[22:58:14] ✅    ✅ Text extracted using pdfplumber (44097 chars)
[22:58:14] 🔄 
🔄 Step 2: Extracting patient data...
[22:58:17] ℹ️  AI extracted raw sex value: 'None'
[22:58:17] ℹ️  AI extracted service line: 'None'
[22:58:17] ℹ️  AI extracted payer source: 'None'
[22:58:17] ℹ️  AI extracted diagnoses:
[22:58:17] ℹ️    - Diagnosis 1: ''
[22:58:17] ℹ️    - Diagnosis 2: ''
[22:58:17] ℹ️    - Diagnosis 3: ''
[22:58:17] ℹ️    - Diagnosis 4: ''
[22:58:17] ℹ️    - Diagnosis 5: ''
[22:58:17] ℹ️    - Diagnosis 6: ''
[22:58:17] ℹ️  Final extracted MRN: ''
[22:58:17] ℹ️  Final extracted Sex: ''
[22:58:17] ℹ️  Final extracted Service Line: ''
[22:58:17] ℹ️  Final extracted Payer Source: ''
[22:58:17] ✅ Patient data extraction completed successfully
[22:58:17] ✅    ✅ Patient data extracted successfully
[22:58:17] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[22:58:17] ⚠️     ❌ Insufficient patient data extracted
[22:58:17] [DOC: 9167901] ℹ️  API push details saved for document 9167901
================================================================================
║                        Processing Document ID: 9167057                         ║
================================================================================
[22:58:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:58:17] ℹ️  Date: 03/06/2025
[22:58:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:20] [DOC: 9167057] ✅ Text extracted using pdfplumber (13503 chars)
[22:58:20] ✅    ✅ Text extracted using pdfplumber (13503 chars)
[22:58:20] 🔄 
🔄 Step 2: Extracting patient data...
[22:58:23] ℹ️  AI extracted raw sex value: 'F'
[22:58:23] ℹ️  AI extracted service line: 'OT'
[22:58:23] ℹ️  AI extracted payer source: 'None'
[22:58:23] ℹ️  AI extracted diagnoses:
[22:58:23] ℹ️    - Diagnosis 1: 'Fx R pubis'
[22:58:23] ℹ️    - Diagnosis 2: 'Fx L olecranon process'
[22:58:23] ℹ️    - Diagnosis 3: 'COPD'
[22:58:23] ℹ️    - Diagnosis 4: 'anemia'
[22:58:23] ℹ️    - Diagnosis 5: 'adrenal mass'
[22:58:23] ℹ️    - Diagnosis 6: 'mood d/o'
[22:58:23] ℹ️  Final extracted MRN: 'MA221116116005'
[22:58:23] ℹ️  Final extracted Sex: 'FEMALE'
[22:58:23] ℹ️  Final extracted Service Line: 'OT'
[22:58:23] ℹ️  Final extracted Payer Source: ''
[22:58:23] ✅ Patient data extraction completed successfully
[22:58:23] ✅    ✅ Patient data extracted successfully
[22:58:23] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'Fx R pubis', 'secondDiagnosis': 'Fx L olecranon process', 'thirdDiagnosis': 'COPD', 'fourthDiagnosis': 'anemia', 'fifthDiagnosis': 'adrenal mass', 'sixthDiagnosis': 'mood d/o'}]
[22:58:23] ✅    ✅ Patient identified: Kelly Medeiros
[22:58:23] ✅    ✅ Patient name validation passed
[22:58:23] 🔄 
🔄 Step 3: Processing patient dates...
[22:58:23] [DOC: 9167057] ℹ️  DOB normalized: 11/23/1960
[22:58:23] [DOC: 9167057] ✅ Patient date processing completed successfully
[22:58:23] ✅    ✅ Date processing completed
[22:58:23] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'Fx R pubis', 'secondDiagnosis': 'Fx L olecranon process', 'thirdDiagnosis': 'COPD', 'fourthDiagnosis': 'anemia', 'fifthDiagnosis': 'adrenal mass', 'sixthDiagnosis': 'mood d/o'}]
[22:58:23] 🔄 
🔄 Step 4: Extracting order data...
[22:58:25] ℹ️  Order extraction - MRN: 'MA221116116005'
[22:58:25] ℹ️  Order extraction - Sex: 'FEMALE'
[22:58:25] ℹ️  Order extraction - Service Line: 'OT'
[22:58:25] ℹ️  Order extraction - Payer Source: ''
[22:58:25] ✅ Order data extraction completed successfully
[22:58:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:58:25] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[22:58:25] ℹ️  Service line consistent in both sources: 'OT'
[22:58:25] ✅ Patient name cross-validation successful
[22:58:25] ✅    ✅ Data merged successfully
[22:58:27] ⚠️     ❌ Skipping - missing episode start date
[22:58:27] [DOC: 9167057] ℹ️  API push details saved for document 9167057
================================================================================
║                        Processing Document ID: 9166919                         ║
================================================================================
[22:58:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:58:27] ℹ️  Date: 03/06/2025
[22:58:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:30] [DOC: 9166919] ✅ Text extracted using pdfplumber (15947 chars)
[22:58:30] ✅    ✅ Text extracted using pdfplumber (15935 chars)
[22:58:30] 🔄 
🔄 Step 2: Extracting patient data...
[22:58:33] ℹ️  AI extracted raw sex value: 'F'
[22:58:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:58:33] ℹ️  AI extracted payer source: 'Medicare'
[22:58:33] ℹ️  AI extracted diagnoses:
[22:58:33] ℹ️    - Diagnosis 1: 'L89.512'
[22:58:33] ℹ️    - Diagnosis 2: 'L98.9'
[22:58:33] ℹ️    - Diagnosis 3: 'E22.1'
[22:58:33] ℹ️    - Diagnosis 4: 'M81.0'
[22:58:33] ℹ️    - Diagnosis 5: 'I50.9'
[22:58:33] ℹ️    - Diagnosis 6: 'B35.3'
[22:58:33] ℹ️  Final extracted MRN: 'MA240222117304'
[22:58:33] ℹ️  Final extracted Sex: 'FEMALE'
[22:58:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:58:33] ℹ️  Final extracted Payer Source: 'Medicare'
[22:58:33] ✅ Patient data extraction completed successfully
[22:58:33] ✅    ✅ Patient data extracted successfully
[22:58:33] 📊 Patient Response
     └─ patientFName: Danielle
     └─ patientLName: Austin
     └─ dob: 11/10/1973
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240222117304
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 3 Jordan Ln
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 993-0222
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2025', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'L89.512', 'secondDiagnosis': 'L98.9', 'thirdDiagnosis': 'E22.1', 'fourthDiagnosis': 'M81.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'B35.3'}]
[22:58:33] ✅    ✅ Patient identified: Danielle Austin
[22:58:33] ✅    ✅ Patient name validation passed
[22:58:33] 🔄 
🔄 Step 3: Processing patient dates...
[22:58:33] [DOC: 9166919] ℹ️  DOB normalized: 11/10/1973
[22:58:33] [DOC: 9166919] ℹ️  Episode startOfCare normalized: 02/24/2025
[22:58:33] [DOC: 9166919] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[22:58:33] [DOC: 9166919] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[22:58:33] [DOC: 9166919] ✅ Patient date processing completed successfully
[22:58:33] ✅    ✅ Date processing completed
[22:58:33] 📊 Processed Patient Data
     └─ patientFName: Danielle
     └─ patientLName: Austin
     └─ dob: 11/10/1973
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240222117304
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 3 Jordan Ln
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 993-0222
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2025', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'L89.512', 'secondDiagnosis': 'L98.9', 'thirdDiagnosis': 'E22.1', 'fourthDiagnosis': 'M81.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'B35.3'}]
[22:58:33] 🔄 
🔄 Step 4: Extracting order data...
[22:58:35] ℹ️  Order extraction - MRN: 'MA240222117304'
[22:58:35] ℹ️  Order extraction - Sex: 'FEMALE'
[22:58:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:58:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[22:58:35] ✅ Order data extraction completed successfully
[22:58:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:58:35] ℹ️  Using MRN from patient data: 'MA240222117304' over 'MA240222117304'
[22:58:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:58:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[22:58:35] ✅ Patient name cross-validation successful
[22:58:35] ✅    ✅ Data merged successfully
[22:58:37] ✅    ✅ Order data extracted and validated
[22:58:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:58:43] [DOC: 9166919] ✅ Patient exists in API: Danielle Austin, ID: ca7e766a-416f-4e8d-b1f3-d83a4bc5d39d
[22:58:43] ✅    ✅ Existing patient found with ID: ca7e766a-416f-4e8d-b1f3-d83a4bc5d39d
[22:58:43] 🔄 
🔄 Step 6: Pushing order to API...
[22:58:43] [DOC: 9166919] ℹ️  Pushing order via API for patient ID: ca7e766a-416f-4e8d-b1f3-d83a4bc5d39d
[22:58:44] [DOC: 9166919] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12970"}
[22:58:44] ❌    ❌ Failed to push order
[22:58:44] 🔄 
🔄 Step 7: Writing to CSV...
[22:58:44] [DOC: 9166919] ℹ️  Calculated age: 51 from DOB: 11/10/1973
[22:58:44] [DOC: 9166919] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:58:44] [DOC: 9166919] ℹ️  Payer Source extracted: 'Medicare'
[22:58:44] [DOC: 9166919] ℹ️  Diagnosis codes being written:
[22:58:44] [DOC: 9166919] ℹ️    - Latest_Episode_Firstdiagnosis: 'L89.512'
[22:58:44] [DOC: 9166919] ℹ️    - Latest_Episode_Seconddiagnosis: 'L98.9'
[22:58:44] [DOC: 9166919] ℹ️    - Latest_Episode_Thirddiagnosis: 'E22.1'
[22:58:44] [DOC: 9166919] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M81.0'
[22:58:44] [DOC: 9166919] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.9'
[22:58:44] [DOC: 9166919] ℹ️    - Latest_Episode_Sixthdiagnosis: 'B35.3'
[22:58:44] [DOC: 9166919] ✅ Patient data written to CSV: Danielle Austin | Sex: FEMALE | Age: 51 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240222117304
[22:58:44] ✅    ✅ Document 9166919 processed and saved successfully
[22:58:44] 🔄 
🔄 Step 8: Saving API details...
[22:58:44] [DOC: 9166919] ℹ️  API push details saved for document 9166919
[22:58:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9165753                         ║
================================================================================
[22:58:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[22:58:44] ℹ️  Date: 03/06/2025
[22:58:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:47] [DOC: 9165753] ✅ Text extracted using pdfplumber (11372 chars)
[22:58:47] ✅    ✅ Text extracted using pdfplumber (11372 chars)
[22:58:47] 🔄 
🔄 Step 2: Extracting patient data...
[22:58:50] ℹ️  AI extracted raw sex value: 'F'
[22:58:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:58:50] ℹ️  AI extracted payer source: 'SWH insurance'
[22:58:50] ℹ️  AI extracted diagnoses:
[22:58:50] ℹ️    - Diagnosis 1: 'E11.21'
[22:58:50] ℹ️    - Diagnosis 2: 'J44.9'
[22:58:50] ℹ️    - Diagnosis 3: 'I10'
[22:58:50] ℹ️    - Diagnosis 4: 'D50.9'
[22:58:50] ℹ️    - Diagnosis 5: 'F41.9'
[22:58:50] ℹ️    - Diagnosis 6: 'F33.8'
[22:58:50] ℹ️  Final extracted MRN: '100990266'
[22:58:50] ℹ️  Final extracted Sex: 'FEMALE'
[22:58:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:58:50] ℹ️  Final extracted Payer Source: 'SWH insurance'
[22:58:50] ✅ Patient data extraction completed successfully
[22:58:50] ✅    ✅ Patient data extracted successfully
[22:58:50] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[22:58:50] ✅    ✅ Patient identified: Maria Antunes
[22:58:50] ✅    ✅ Patient name validation passed
[22:58:50] 🔄 
🔄 Step 3: Processing patient dates...
[22:58:50] [DOC: 9165753] ℹ️  DOB normalized: 11/22/1934
[22:58:50] [DOC: 9165753] ℹ️  Episode startOfCare normalized: 09/05/2023
[22:58:50] [DOC: 9165753] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[22:58:50] [DOC: 9165753] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[22:58:50] [DOC: 9165753] ✅ Patient date processing completed successfully
[22:58:50] ✅    ✅ Date processing completed
[22:58:50] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[22:58:50] 🔄 
🔄 Step 4: Extracting order data...
[22:58:53] ℹ️  Order extraction - MRN: '100990266'
[22:58:53] ℹ️  Order extraction - Sex: 'FEMALE'
[22:58:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:58:53] ℹ️  Order extraction - Payer Source: 'SWH insurance'
[22:58:53] ✅ Order data extraction completed successfully
[22:58:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:58:53] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[22:58:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:58:53] ℹ️  Payer source consistent in both sources: 'SWH insurance'
[22:58:53] ✅ Patient name cross-validation successful
[22:58:53] ✅    ✅ Data merged successfully
[22:58:54] ✅    ✅ Order data extracted and validated
[22:58:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:58:54] [DOC: 9165753] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:58:54] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:58:54] 🔄 
🔄 Step 6: Pushing order to API...
[22:58:54] [DOC: 9165753] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[22:58:55] [DOC: 9165753] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12950"}
[22:58:55] ❌    ❌ Failed to push order
[22:58:55] 🔄 
🔄 Step 7: Writing to CSV...
[22:58:55] [DOC: 9165753] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[22:58:55] [DOC: 9165753] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:58:55] [DOC: 9165753] ℹ️  Payer Source extracted: 'SWH insurance'
[22:58:55] [DOC: 9165753] ℹ️  Diagnosis codes being written:
[22:58:55] [DOC: 9165753] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.21'
[22:58:55] [DOC: 9165753] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[22:58:55] [DOC: 9165753] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[22:58:55] [DOC: 9165753] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[22:58:55] [DOC: 9165753] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[22:58:55] [DOC: 9165753] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[22:58:55] [DOC: 9165753] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: SWH insurance | MRN: 100990266
[22:58:55] ✅    ✅ Document 9165753 processed and saved successfully
[22:58:55] 🔄 
🔄 Step 8: Saving API details...
[22:58:55] [DOC: 9165753] ℹ️  API push details saved for document 9165753
[22:58:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2161108                         ║
================================================================================
[22:58:55] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:58:55] ℹ️  Date: 03/05/2025
[22:58:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:57] [DOC: 2161108] ❌ Critical failure in get_pdf_text: Invalid response format
[22:58:57] ❌ Failed to extract text for Doc ID 2161108
[22:58:57] [DOC: 2161108] ℹ️  API push details saved for document 2161108
================================================================================
║                        Processing Document ID: 2161102                         ║
================================================================================
[22:58:57] ℹ️  Agency: Visiting Rehab & Nursing Services
[22:58:57] ℹ️  Date: 03/05/2025
[22:58:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:58:58] [DOC: 2161102] ❌ Critical failure in get_pdf_text: Invalid response format
[22:58:58] ❌ Failed to extract text for Doc ID 2161102
[22:58:58] [DOC: 2161102] ℹ️  API push details saved for document 2161102
================================================================================
║                        Processing Document ID: 9163755                         ║
================================================================================
[22:58:58] ℹ️  Agency: Fox Rehabilitation Cherry Hill
[22:58:58] ℹ️  Date: 03/05/2025
[22:58:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:59:08] [DOC: 9163755] ✅ Text extracted using pdfplumber (175 chars)
[22:59:08] ✅    ✅ Text extracted using pdfplumber (175 chars)
[22:59:08] 🔄 
🔄 Step 2: Extracting patient data...
[22:59:10] ℹ️  AI extracted raw sex value: ''
[22:59:10] ℹ️  AI extracted service line: ''
[22:59:10] ℹ️  AI extracted payer source: ''
[22:59:10] ℹ️  AI extracted diagnoses:
[22:59:10] ℹ️    - Diagnosis 1: ''
[22:59:10] ℹ️    - Diagnosis 2: ''
[22:59:10] ℹ️    - Diagnosis 3: ''
[22:59:10] ℹ️    - Diagnosis 4: ''
[22:59:10] ℹ️    - Diagnosis 5: ''
[22:59:10] ℹ️    - Diagnosis 6: ''
[22:59:10] ℹ️  Final extracted MRN: ''
[22:59:10] ℹ️  Final extracted Sex: ''
[22:59:10] ℹ️  Final extracted Service Line: ''
[22:59:10] ℹ️  Final extracted Payer Source: ''
[22:59:10] ✅ Patient data extraction completed successfully
[22:59:10] ✅    ✅ Patient data extracted successfully
[22:59:10] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:10] ⚠️     ❌ Insufficient patient data extracted
[22:59:10] [DOC: 9163755] ℹ️  API push details saved for document 9163755
================================================================================
║                        Processing Document ID: 9162621                         ║
================================================================================
[22:59:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:59:10] ℹ️  Date: 03/05/2025
[22:59:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:59:11] [DOC: 9162621] ✅ Text extracted using pdfplumber (961 chars)
[22:59:11] ✅    ✅ Text extracted using pdfplumber (961 chars)
[22:59:11] 🔄 
🔄 Step 2: Extracting patient data...
[22:59:14] ℹ️  AI extracted raw sex value: 'F'
[22:59:14] ℹ️  AI extracted service line: 'PT'
[22:59:14] ℹ️  AI extracted payer source: ''
[22:59:14] ℹ️  AI extracted diagnoses:
[22:59:14] ℹ️    - Diagnosis 1: ''
[22:59:14] ℹ️    - Diagnosis 2: ''
[22:59:14] ℹ️    - Diagnosis 3: ''
[22:59:14] ℹ️    - Diagnosis 4: ''
[22:59:14] ℹ️    - Diagnosis 5: ''
[22:59:14] ℹ️    - Diagnosis 6: ''
[22:59:14] ℹ️  Final extracted MRN: '2773739'
[22:59:14] ℹ️  Final extracted Sex: 'FEMALE'
[22:59:14] ℹ️  Final extracted Service Line: 'PT'
[22:59:14] ℹ️  Final extracted Payer Source: ''
[22:59:14] ✅ Patient data extraction completed successfully
[22:59:14] ✅    ✅ Patient data extracted successfully
[22:59:14] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Mota
     └─ dob: 04/20/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773739
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:14] ✅    ✅ Patient identified: Leonor Mota
[22:59:14] ✅    ✅ Patient name validation passed
[22:59:14] 🔄 
🔄 Step 3: Processing patient dates...
[22:59:14] [DOC: 9162621] ℹ️  DOB normalized: 04/20/1952
[22:59:14] [DOC: 9162621] ✅ Patient date processing completed successfully
[22:59:14] ✅    ✅ Date processing completed
[22:59:14] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Mota
     └─ dob: 04/20/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773739
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:14] 🔄 
🔄 Step 4: Extracting order data...
[22:59:16] ℹ️  Order extraction - MRN: '2773739'
[22:59:16] ℹ️  Order extraction - Sex: 'FEMALE'
[22:59:16] ℹ️  Order extraction - Service Line: ''
[22:59:16] ℹ️  Order extraction - Payer Source: ''
[22:59:16] ✅ Order data extraction completed successfully
[22:59:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:59:16] ℹ️  Using MRN from patient data: '2773739' over '2773739'
[22:59:16] ℹ️  Using service line from patient data: 'PT'
[22:59:16] ✅ Patient name cross-validation successful
[22:59:16] ✅    ✅ Data merged successfully
[22:59:17] ⚠️     ❌ Skipping - missing episode start date
[22:59:17] [DOC: 9162621] ℹ️  API push details saved for document 9162621
================================================================================
║                        Processing Document ID: 9160115                         ║
================================================================================
[22:59:17] ℹ️  Agency: AccentCare Fall River
[22:59:17] ℹ️  Date: 03/04/2025
[22:59:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:59:22] [DOC: 9160115] ✅ Text extracted using pdfplumber (1076 chars)
[22:59:22] ✅    ✅ Text extracted using pdfplumber (1076 chars)
[22:59:22] 🔄 
🔄 Step 2: Extracting patient data...
[22:59:25] ℹ️  AI extracted raw sex value: ''
[22:59:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:59:25] ℹ️  AI extracted payer source: ''
[22:59:25] ℹ️  AI extracted diagnoses:
[22:59:25] ℹ️    - Diagnosis 1: ''
[22:59:25] ℹ️    - Diagnosis 2: ''
[22:59:25] ℹ️    - Diagnosis 3: ''
[22:59:25] ℹ️    - Diagnosis 4: ''
[22:59:25] ℹ️    - Diagnosis 5: ''
[22:59:25] ℹ️    - Diagnosis 6: ''
[22:59:25] ℹ️  Final extracted MRN: 'C0200155388301'
[22:59:25] ℹ️  Final extracted Sex: ''
[22:59:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:59:25] ℹ️  Final extracted Payer Source: ''
[22:59:25] ✅ Patient data extraction completed successfully
[22:59:25] ✅    ✅ Patient data extracted successfully
[22:59:25] 📊 Patient Response
     └─ patientFName: MARIE
     └─ patientLName: MONDELLO
     └─ dob: 09/23/1939
     └─ patientSex: 
     └─ medicalRecordNo: C0200155388301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:25] ✅    ✅ Patient identified: MARIE MONDELLO
[22:59:25] ✅    ✅ Patient name validation passed
[22:59:25] 🔄 
🔄 Step 3: Processing patient dates...
[22:59:25] [DOC: 9160115] ℹ️  DOB normalized: 09/23/1939
[22:59:25] [DOC: 9160115] ✅ Patient date processing completed successfully
[22:59:25] ✅    ✅ Date processing completed
[22:59:25] 📊 Processed Patient Data
     └─ patientFName: MARIE
     └─ patientLName: MONDELLO
     └─ dob: 09/23/1939
     └─ patientSex: 
     └─ medicalRecordNo: C0200155388301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:25] 🔄 
🔄 Step 4: Extracting order data...
[22:59:27] ℹ️  Order extraction - MRN: 'C0200155388301'
[22:59:27] ℹ️  Order extraction - Sex: ''
[22:59:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:59:27] ℹ️  Order extraction - Payer Source: ''
[22:59:27] ✅ Order data extraction completed successfully
[22:59:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:59:27] ℹ️  Using MRN from patient data: 'C0200155388301' over 'C0200155388301'
[22:59:27] ℹ️  Inferred sex as FEMALE from name: MARIE
[22:59:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:59:27] ⚠️  Patient name mismatch: Order='MONDEL LO, MARIE' vs Patient='MARIE MONDELLO'
[22:59:27] ✅    ✅ Data merged successfully
[22:59:28] ✅    ✅ Order data extracted and validated
[22:59:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:59:28] [DOC: 9160115] ✅ Patient found in local cache: MARIE MONDELLO, ID: 9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4
[22:59:28] ✅    ✅ Existing patient found with ID: 9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4
[22:59:28] 🔄 
🔄 Step 6: Pushing order to API...
[22:59:28] [DOC: 9160115] ℹ️  Pushing order via API for patient ID: 9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4
[22:59:29] [DOC: 9160115] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14135"}
[22:59:29] ❌    ❌ Failed to push order
[22:59:29] 🔄 
🔄 Step 7: Writing to CSV...
[22:59:29] [DOC: 9160115] ℹ️  Calculated age: 85 from DOB: 09/23/1939
[22:59:29] [DOC: 9160115] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:59:29] [DOC: 9160115] ℹ️  Payer Source extracted: ''
[22:59:29] [DOC: 9160115] ℹ️  Diagnosis codes being written:
[22:59:29] [DOC: 9160115] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[22:59:29] [DOC: 9160115] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[22:59:29] [DOC: 9160115] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[22:59:29] [DOC: 9160115] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[22:59:29] [DOC: 9160115] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[22:59:29] [DOC: 9160115] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[22:59:29] [DOC: 9160115] ✅ Patient data written to CSV: MARIE MONDELLO | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer:  | MRN: C0200155388301
[22:59:29] ✅    ✅ Document 9160115 processed and saved successfully
[22:59:29] 🔄 
🔄 Step 8: Saving API details...
[22:59:29] [DOC: 9160115] ℹ️  API push details saved for document 9160115
[22:59:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9161207                         ║
================================================================================
[22:59:29] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[22:59:29] ℹ️  Date: 03/04/2025
[22:59:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:59:32] [DOC: 9161207] ✅ Text extracted using pdfplumber (10333 chars)
[22:59:32] ✅    ✅ Text extracted using pdfplumber (10333 chars)
[22:59:32] 🔄 
🔄 Step 2: Extracting patient data...
[22:59:35] ℹ️  AI extracted raw sex value: 'M'
[22:59:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[22:59:35] ℹ️  AI extracted payer source: 'None'
[22:59:35] ℹ️  AI extracted diagnoses:
[22:59:35] ℹ️    - Diagnosis 1: 'E11.43'
[22:59:35] ℹ️    - Diagnosis 2: 'K31.84'
[22:59:35] ℹ️    - Diagnosis 3: 'K59.89'
[22:59:35] ℹ️    - Diagnosis 4: 'F20.0'
[22:59:35] ℹ️    - Diagnosis 5: 'I10'
[22:59:35] ℹ️    - Diagnosis 6: 'E66.01'
[22:59:35] ℹ️  Final extracted MRN: '457'
[22:59:35] ℹ️  Final extracted Sex: 'MALE'
[22:59:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[22:59:35] ℹ️  Final extracted Payer Source: ''
[22:59:35] ✅ Patient data extraction completed successfully
[22:59:35] ✅    ✅ Patient data extracted successfully
[22:59:35] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[22:59:35] ✅    ✅ Patient identified: Manuel Varela
[22:59:35] ✅    ✅ Patient name validation passed
[22:59:35] 🔄 
🔄 Step 3: Processing patient dates...
[22:59:35] [DOC: 9161207] ℹ️  DOB normalized: 02/08/1969
[22:59:35] [DOC: 9161207] ℹ️  Episode startOfCare normalized: 11/07/2024
[22:59:35] [DOC: 9161207] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[22:59:35] [DOC: 9161207] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[22:59:35] [DOC: 9161207] ✅ Patient date processing completed successfully
[22:59:35] ✅    ✅ Date processing completed
[22:59:35] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[22:59:35] 🔄 
🔄 Step 4: Extracting order data...
[22:59:38] ℹ️  Order extraction - MRN: '457'
[22:59:38] ℹ️  Order extraction - Sex: 'MALE'
[22:59:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[22:59:38] ℹ️  Order extraction - Payer Source: ''
[22:59:38] ✅ Order data extraction completed successfully
[22:59:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:59:38] ℹ️  Using MRN from patient data: '457' over '457'
[22:59:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[22:59:38] ✅ Patient name cross-validation successful
[22:59:38] ✅    ✅ Data merged successfully
[22:59:39] ✅    ✅ Order data extracted and validated
[22:59:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[22:59:39] [DOC: 9161207] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[22:59:39] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[22:59:39] 🔄 
🔄 Step 6: Pushing order to API...
[22:59:39] [DOC: 9161207] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[22:59:40] [DOC: 9161207] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[22:59:40] ❌    ❌ Failed to push order
[22:59:40] 🔄 
🔄 Step 7: Writing to CSV...
[22:59:40] [DOC: 9161207] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[22:59:40] [DOC: 9161207] ℹ️  Service Line extracted: 'Skilled Nursing'
[22:59:40] [DOC: 9161207] ℹ️  Payer Source extracted: ''
[22:59:40] [DOC: 9161207] ℹ️  Diagnosis codes being written:
[22:59:40] [DOC: 9161207] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.43'
[22:59:40] [DOC: 9161207] ℹ️    - Latest_Episode_Seconddiagnosis: 'K31.84'
[22:59:40] [DOC: 9161207] ℹ️    - Latest_Episode_Thirddiagnosis: 'K59.89'
[22:59:40] [DOC: 9161207] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F20.0'
[22:59:40] [DOC: 9161207] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[22:59:40] [DOC: 9161207] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[22:59:40] [DOC: 9161207] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: Skilled Nursing | Payer:  | MRN: 457
[22:59:40] ✅    ✅ Document 9161207 processed and saved successfully
[22:59:40] 🔄 
🔄 Step 8: Saving API details...
[22:59:40] [DOC: 9161207] ℹ️  API push details saved for document 9161207
[22:59:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9160925                         ║
================================================================================
[22:59:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[22:59:40] ℹ️  Date: 03/04/2025
[22:59:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:59:42] [DOC: 9160925] ✅ Text extracted using pdfplumber (995 chars)
[22:59:42] ✅    ✅ Text extracted using pdfplumber (995 chars)
[22:59:42] 🔄 
🔄 Step 2: Extracting patient data...
[22:59:44] ℹ️  AI extracted raw sex value: 'F'
[22:59:44] ℹ️  AI extracted service line: 'Physical Therapy'
[22:59:44] ℹ️  AI extracted payer source: ''
[22:59:44] ℹ️  AI extracted diagnoses:
[22:59:44] ℹ️    - Diagnosis 1: ''
[22:59:44] ℹ️    - Diagnosis 2: ''
[22:59:44] ℹ️    - Diagnosis 3: ''
[22:59:44] ℹ️    - Diagnosis 4: ''
[22:59:44] ℹ️    - Diagnosis 5: ''
[22:59:44] ℹ️    - Diagnosis 6: ''
[22:59:44] ℹ️  Final extracted MRN: '2120086'
[22:59:44] ℹ️  Final extracted Sex: 'FEMALE'
[22:59:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[22:59:44] ℹ️  Final extracted Payer Source: ''
[22:59:44] ✅ Patient data extraction completed successfully
[22:59:44] ✅    ✅ Patient data extracted successfully
[22:59:44] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:44] ✅    ✅ Patient identified: Elaine Dupont
[22:59:44] ✅    ✅ Patient name validation passed
[22:59:44] 🔄 
🔄 Step 3: Processing patient dates...
[22:59:44] [DOC: 9160925] ℹ️  DOB normalized: 09/06/1942
[22:59:44] [DOC: 9160925] ✅ Patient date processing completed successfully
[22:59:44] ✅    ✅ Date processing completed
[22:59:44] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:44] 🔄 
🔄 Step 4: Extracting order data...
[22:59:46] ℹ️  Order extraction - MRN: '2120086'
[22:59:46] ℹ️  Order extraction - Sex: 'FEMALE'
[22:59:46] ℹ️  Order extraction - Service Line: ''
[22:59:46] ℹ️  Order extraction - Payer Source: ''
[22:59:46] ✅ Order data extraction completed successfully
[22:59:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:59:46] ℹ️  Using MRN from patient data: '2120086' over '2120086'
[22:59:46] ℹ️  Using service line from patient data: 'Physical Therapy'
[22:59:46] ✅ Patient name cross-validation successful
[22:59:46] ✅    ✅ Data merged successfully
[22:59:48] ⚠️     ❌ Skipping - missing episode start date
[22:59:48] [DOC: 9160925] ℹ️  API push details saved for document 9160925
================================================================================
║                        Processing Document ID: 9160363                         ║
================================================================================
[22:59:48] ℹ️  Agency: Elmwood Home Care
[22:59:48] ℹ️  Date: 03/04/2025
[22:59:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[22:59:51] [DOC: 9160363] ✅ Text extracted using pdfplumber (2344 chars)
[22:59:51] ✅    ✅ Text extracted using pdfplumber (2344 chars)
[22:59:51] 🔄 
🔄 Step 2: Extracting patient data...
[22:59:54] ℹ️  AI extracted raw sex value: ''
[22:59:54] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Home-Health Aide'
[22:59:54] ℹ️  AI extracted payer source: ''
[22:59:54] ℹ️  AI extracted diagnoses:
[22:59:54] ℹ️    - Diagnosis 1: 'Unilateral primary osteoarthritis, right hip'
[22:59:54] ℹ️    - Diagnosis 2: ''
[22:59:54] ℹ️    - Diagnosis 3: ''
[22:59:54] ℹ️    - Diagnosis 4: ''
[22:59:54] ℹ️    - Diagnosis 5: ''
[22:59:54] ℹ️    - Diagnosis 6: ''
[22:59:54] ℹ️  Final extracted MRN: ''
[22:59:54] ℹ️  Final extracted Sex: ''
[22:59:54] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Home-Health Aide'
[22:59:54] ℹ️  Final extracted Payer Source: ''
[22:59:54] ✅ Patient data extraction completed successfully
[22:59:54] ✅    ✅ Patient data extracted successfully
[22:59:54] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: TABOR
     └─ dob: 10/12/1954
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Mccarthy, Colm MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ELMWOOD HOME CARE
     └─ address: 75 JOANNE LN
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 401-374-9722
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Home-Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Unilateral primary osteoarthritis, right hip', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:54] ✅    ✅ Patient identified: MARY TABOR
[22:59:54] ✅    ✅ Patient name validation passed
[22:59:54] 🔄 
🔄 Step 3: Processing patient dates...
[22:59:54] [DOC: 9160363] ℹ️  DOB normalized: 10/12/1954
[22:59:54] [DOC: 9160363] ✅ Patient date processing completed successfully
[22:59:54] ✅    ✅ Date processing completed
[22:59:54] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: TABOR
     └─ dob: 10/12/1954
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Mccarthy, Colm MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ELMWOOD HOME CARE
     └─ address: 75 JOANNE LN
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 401-374-9722
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Home-Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Unilateral primary osteoarthritis, right hip', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[22:59:54] 🔄 
🔄 Step 4: Extracting order data...
[22:59:56] ℹ️  Order extraction - MRN: ''
[22:59:56] ℹ️  Order extraction - Sex: ''
[22:59:56] ℹ️  Order extraction - Service Line: 'HHA'
[22:59:56] ℹ️  Order extraction - Payer Source: ''
[22:59:56] ✅ Order data extraction completed successfully
[22:59:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[22:59:56] ⚠️  No MRN found in either patient or order data
[22:59:56] ℹ️  Inferred sex as FEMALE from name: MARY
[22:59:56] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Home-Health Aide' + Order='HHA' = 'HHA, Home-Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[22:59:56] ✅ Patient name cross-validation successful
[22:59:56] ✅    ✅ Data merged successfully
[22:59:57] ⚠️     ❌ Skipping - missing episode start date
[22:59:57] [DOC: 9160363] ℹ️  API push details saved for document 9160363
================================================================================
║                        Processing Document ID: 9160213                         ║
================================================================================
[22:59:57] ℹ️  Agency: Dartmouth HH
[22:59:57] ℹ️  Date: 03/04/2025
[22:59:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:00:00] [DOC: 9160213] ✅ Text extracted using pdfplumber (4618 chars)
[23:00:00] ✅    ✅ Text extracted using pdfplumber (4618 chars)
[23:00:00] 🔄 
🔄 Step 2: Extracting patient data...
[23:00:03] ℹ️  AI extracted raw sex value: 'F'
[23:00:03] ℹ️  AI extracted service line: 'PT'
[23:00:03] ℹ️  AI extracted payer source: 'Medicare'
[23:00:03] ℹ️  AI extracted diagnoses:
[23:00:03] ℹ️    - Diagnosis 1: ''
[23:00:03] ℹ️    - Diagnosis 2: ''
[23:00:03] ℹ️    - Diagnosis 3: ''
[23:00:03] ℹ️    - Diagnosis 4: ''
[23:00:03] ℹ️    - Diagnosis 5: ''
[23:00:03] ℹ️    - Diagnosis 6: ''
[23:00:03] ℹ️  Final extracted MRN: '1861011'
[23:00:03] ℹ️  Final extracted Sex: 'FEMALE'
[23:00:03] ℹ️  Final extracted Service Line: 'PT'
[23:00:03] ℹ️  Final extracted Payer Source: 'Medicare'
[23:00:03] ✅ Patient data extraction completed successfully
[23:00:03] ✅    ✅ Patient data extracted successfully
[23:00:03] 📊 Patient Response
     └─ patientFName: Helen
     └─ patientLName: Costa
     └─ dob: 06/08/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1861011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:00:03] ✅    ✅ Patient identified: Helen Costa
[23:00:03] ✅    ✅ Patient name validation passed
[23:00:03] 🔄 
🔄 Step 3: Processing patient dates...
[23:00:03] [DOC: 9160213] ℹ️  DOB normalized: 06/08/1944
[23:00:03] [DOC: 9160213] ℹ️  Episode startOfCare normalized: 01/14/2025
[23:00:03] [DOC: 9160213] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[23:00:03] [DOC: 9160213] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[23:00:03] [DOC: 9160213] ✅ Patient date processing completed successfully
[23:00:03] ✅    ✅ Date processing completed
[23:00:03] 📊 Processed Patient Data
     └─ patientFName: Helen
     └─ patientLName: Costa
     └─ dob: 06/08/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1861011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:00:03] 🔄 
🔄 Step 4: Extracting order data...
[23:00:05] ℹ️  Order extraction - MRN: ''
[23:00:05] ℹ️  Order extraction - Sex: 'FEMALE'
[23:00:05] ℹ️  Order extraction - Service Line: 'PT'
[23:00:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[23:00:05] ✅ Order data extraction completed successfully
[23:00:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:00:05] ℹ️  Using MRN from patient data: '1861011'
[23:00:05] ℹ️  Service line consistent in both sources: 'PT'
[23:00:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[23:00:05] ✅ Patient name cross-validation successful
[23:00:05] ✅    ✅ Data merged successfully
[23:00:06] ✅    ✅ Order data extracted and validated
[23:00:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:00:21] [DOC: 9160213] ✅ Patient exists in API: Helen Costa, ID: 637d265d-8588-4207-a2d1-fba98bb948e5
[23:00:21] ✅    ✅ Existing patient found with ID: 637d265d-8588-4207-a2d1-fba98bb948e5
[23:00:21] 🔄 
🔄 Step 6: Pushing order to API...
[23:00:21] [DOC: 9160213] ℹ️  Pushing order via API for patient ID: 637d265d-8588-4207-a2d1-fba98bb948e5
[23:00:22] [DOC: 9160213] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:00:22] ❌    ❌ Failed to push order
[23:00:22] 🔄 
🔄 Step 7: Writing to CSV...
[23:00:22] [DOC: 9160213] ℹ️  Calculated age: 81 from DOB: 06/08/1944
[23:00:22] [DOC: 9160213] ℹ️  Service Line extracted: 'PT'
[23:00:22] [DOC: 9160213] ℹ️  Payer Source extracted: 'Medicare'
[23:00:22] [DOC: 9160213] ℹ️  Diagnosis codes being written:
[23:00:22] [DOC: 9160213] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[23:00:22] [DOC: 9160213] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[23:00:22] [DOC: 9160213] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[23:00:22] [DOC: 9160213] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:00:22] [DOC: 9160213] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:00:22] [DOC: 9160213] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:00:22] [DOC: 9160213] ✅ Patient data written to CSV: Helen Costa | Sex: FEMALE | Age: 81 | Service: PT | Payer: Medicare | MRN: 1861011
[23:00:22] ✅    ✅ Document 9160213 processed and saved successfully
[23:00:22] 🔄 
🔄 Step 8: Saving API details...
[23:00:22] [DOC: 9160213] ℹ️  API push details saved for document 9160213
[23:00:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9160148                         ║
================================================================================
[23:00:22] ℹ️  Agency: Dartmouth HH
[23:00:22] ℹ️  Date: 03/04/2025
[23:00:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:00:25] [DOC: 9160148] ✅ Text extracted using pdfplumber (10027 chars)
[23:00:25] ✅    ✅ Text extracted using pdfplumber (10027 chars)
[23:00:25] 🔄 
🔄 Step 2: Extracting patient data...
[23:00:28] ℹ️  AI extracted raw sex value: 'M'
[23:00:28] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[23:00:28] ℹ️  AI extracted payer source: 'United Health Care'
[23:00:28] ℹ️  AI extracted diagnoses:
[23:00:28] ℹ️    - Diagnosis 1: 'A04.72'
[23:00:28] ℹ️    - Diagnosis 2: 'I48.0'
[23:00:28] ℹ️    - Diagnosis 3: 'I11.0'
[23:00:28] ℹ️    - Diagnosis 4: 'I50.30'
[23:00:28] ℹ️    - Diagnosis 5: 'E11.42'
[23:00:28] ℹ️    - Diagnosis 6: 'I25.10'
[23:00:28] ℹ️  Final extracted MRN: '926015'
[23:00:28] ℹ️  Final extracted Sex: 'MALE'
[23:00:28] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[23:00:28] ℹ️  Final extracted Payer Source: 'United Health Care'
[23:00:28] ✅ Patient data extraction completed successfully
[23:00:28] ✅    ✅ Patient data extracted successfully
[23:00:28] 📊 Patient Response
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.30', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'I25.10'}]
[23:00:28] ✅    ✅ Patient identified: Clinton Sowle
[23:00:28] ✅    ✅ Patient name validation passed
[23:00:28] 🔄 
🔄 Step 3: Processing patient dates...
[23:00:28] [DOC: 9160148] ℹ️  DOB normalized: 12/01/1943
[23:00:28] [DOC: 9160148] ℹ️  Episode startOfCare normalized: 02/14/2025
[23:00:28] [DOC: 9160148] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[23:00:28] [DOC: 9160148] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[23:00:28] [DOC: 9160148] ✅ Patient date processing completed successfully
[23:00:28] ✅    ✅ Date processing completed
[23:00:28] 📊 Processed Patient Data
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.30', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'I25.10'}]
[23:00:28] 🔄 
🔄 Step 4: Extracting order data...
[23:00:31] ℹ️  Order extraction - MRN: '926015'
[23:00:31] ℹ️  Order extraction - Sex: 'MALE'
[23:00:31] ℹ️  Order extraction - Service Line: 'RN, PT, OT, ST'
[23:00:31] ℹ️  Order extraction - Payer Source: 'United Health Care'
[23:00:31] ✅ Order data extraction completed successfully
[23:00:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:00:31] ℹ️  Using MRN from patient data: '926015' over '926015'
[23:00:31] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='RN, PT, OT, ST' = 'OT, PT, RN, ST, Skilled Nursing'
[23:00:31] ℹ️  Payer source consistent in both sources: 'United Health Care'
[23:00:31] ✅ Patient name cross-validation successful
[23:00:31] ✅    ✅ Data merged successfully
[23:00:32] ✅    ✅ Order data extracted and validated
[23:00:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:00:32] [DOC: 9160148] ✅ Patient found in local cache: Clinton Sowle, ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[23:00:32] ✅    ✅ Existing patient found with ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[23:00:32] 🔄 
🔄 Step 6: Pushing order to API...
[23:00:32] [DOC: 9160148] ℹ️  Pushing order via API for patient ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[23:00:33] [DOC: 9160148] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:00:33] ❌    ❌ Failed to push order
[23:00:33] 🔄 
🔄 Step 7: Writing to CSV...
[23:00:33] [DOC: 9160148] ℹ️  Calculated age: 81 from DOB: 12/01/1943
[23:00:33] [DOC: 9160148] ℹ️  Service Line extracted: 'OT, PT, RN, ST, Skilled Nursing'
[23:00:33] [DOC: 9160148] ℹ️  Payer Source extracted: 'United Health Care'
[23:00:33] [DOC: 9160148] ℹ️  Diagnosis codes being written:
[23:00:33] [DOC: 9160148] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[23:00:33] [DOC: 9160148] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.0'
[23:00:33] [DOC: 9160148] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[23:00:33] [DOC: 9160148] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.30'
[23:00:33] [DOC: 9160148] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.42'
[23:00:33] [DOC: 9160148] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[23:00:33] [DOC: 9160148] ✅ Patient data written to CSV: Clinton Sowle | Sex: MALE | Age: 81 | Service: OT, PT, RN, ST, Skilled Nursing | Payer: United Health Care | MRN: 926015
[23:00:33] ✅    ✅ Document 9160148 processed and saved successfully
[23:00:33] 🔄 
🔄 Step 8: Saving API details...
[23:00:33] [DOC: 9160148] ℹ️  API push details saved for document 9160148
[23:00:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9160125                         ║
================================================================================
[23:00:33] ℹ️  Agency: Dartmouth HH
[23:00:33] ℹ️  Date: 03/04/2025
[23:00:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:00:35] [DOC: 9160125] ✅ Text extracted using pdfplumber (5698 chars)
[23:00:35] ✅    ✅ Text extracted using pdfplumber (5698 chars)
[23:00:35] 🔄 
🔄 Step 2: Extracting patient data...
[23:00:38] ℹ️  AI extracted raw sex value: 'F'
[23:00:38] ℹ️  AI extracted service line: 'OT'
[23:00:38] ℹ️  AI extracted payer source: 'Medicare'
[23:00:38] ℹ️  AI extracted diagnoses:
[23:00:38] ℹ️    - Diagnosis 1: ''
[23:00:38] ℹ️    - Diagnosis 2: ''
[23:00:38] ℹ️    - Diagnosis 3: ''
[23:00:38] ℹ️    - Diagnosis 4: ''
[23:00:38] ℹ️    - Diagnosis 5: ''
[23:00:38] ℹ️    - Diagnosis 6: ''
[23:00:38] ℹ️  Final extracted MRN: '5862015'
[23:00:38] ℹ️  Final extracted Sex: 'FEMALE'
[23:00:38] ℹ️  Final extracted Service Line: 'OT'
[23:00:38] ℹ️  Final extracted Payer Source: 'Medicare'
[23:00:38] ✅ Patient data extraction completed successfully
[23:00:38] ✅    ✅ Patient data extracted successfully
[23:00:38] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '01/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:00:38] ✅    ✅ Patient identified: Janice Arruda
[23:00:38] ✅    ✅ Patient name validation passed
[23:00:38] 🔄 
🔄 Step 3: Processing patient dates...
[23:00:38] [DOC: 9160125] ℹ️  DOB normalized: 01/24/1950
[23:00:38] [DOC: 9160125] ℹ️  Episode startOfCare normalized: 02/08/2025
[23:00:38] [DOC: 9160125] ℹ️  Episode startOfEpisode normalized: 01/04/2025
[23:00:38] [DOC: 9160125] ℹ️  Episode endOfEpisode normalized: 01/17/2025
[23:00:38] [DOC: 9160125] ✅ Patient date processing completed successfully
[23:00:38] ✅    ✅ Date processing completed
[23:00:38] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '01/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:00:38] 🔄 
🔄 Step 4: Extracting order data...
[23:00:40] ℹ️  Order extraction - MRN: ''
[23:00:40] ℹ️  Order extraction - Sex: 'FEMALE'
[23:00:40] ℹ️  Order extraction - Service Line: 'OT'
[23:00:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[23:00:40] ✅ Order data extraction completed successfully
[23:00:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:00:40] ℹ️  Using MRN from patient data: '5862015'
[23:00:40] ℹ️  Service line consistent in both sources: 'OT'
[23:00:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[23:00:40] ✅ Patient name cross-validation successful
[23:00:40] ✅    ✅ Data merged successfully
[23:00:41] ✅    ✅ Order data extracted and validated
[23:00:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:00:41] [DOC: 9160125] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[23:00:41] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[23:00:41] 🔄 
🔄 Step 6: Pushing order to API...
[23:00:41] [DOC: 9160125] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[23:00:43] [DOC: 9160125] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:00:43] ❌    ❌ Failed to push order
[23:00:43] 🔄 
🔄 Step 7: Writing to CSV...
[23:00:43] [DOC: 9160125] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[23:00:43] [DOC: 9160125] ℹ️  Service Line extracted: 'OT'
[23:00:43] [DOC: 9160125] ℹ️  Payer Source extracted: 'Medicare'
[23:00:43] [DOC: 9160125] ℹ️  Diagnosis codes being written:
[23:00:43] [DOC: 9160125] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[23:00:43] [DOC: 9160125] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[23:00:43] [DOC: 9160125] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[23:00:43] [DOC: 9160125] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:00:43] [DOC: 9160125] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:00:43] [DOC: 9160125] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:00:43] [DOC: 9160125] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: OT | Payer: Medicare | MRN: 5862015
[23:00:43] ✅    ✅ Document 9160125 processed and saved successfully
[23:00:43] 🔄 
🔄 Step 8: Saving API details...
[23:00:43] [DOC: 9160125] ℹ️  API push details saved for document 9160125
[23:00:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9160118                         ║
================================================================================
[23:00:43] ℹ️  Agency: Dartmouth HH
[23:00:43] ℹ️  Date: 03/04/2025
[23:00:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:00:46] [DOC: 9160118] ✅ Text extracted using pdfplumber (18834 chars)
[23:00:46] ✅    ✅ Text extracted using pdfplumber (18822 chars)
[23:00:46] 🔄 
🔄 Step 2: Extracting patient data...
[23:00:49] ℹ️  AI extracted raw sex value: 'F'
[23:00:49] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, Diet'
[23:00:49] ℹ️  AI extracted payer source: ''
[23:00:49] ℹ️  AI extracted diagnoses:
[23:00:49] ℹ️    - Diagnosis 1: 'S06.6XAD'
[23:00:49] ℹ️    - Diagnosis 2: 'N13.2'
[23:00:49] ℹ️    - Diagnosis 3: 'N12'
[23:00:49] ℹ️    - Diagnosis 4: 'I13.0'
[23:00:49] ℹ️    - Diagnosis 5: 'I50.33'
[23:00:49] ℹ️    - Diagnosis 6: 'N18.31'
[23:00:49] ℹ️  Final extracted MRN: '5862015'
[23:00:49] ℹ️  Final extracted Sex: 'FEMALE'
[23:00:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, Diet'
[23:00:49] ℹ️  Final extracted Payer Source: ''
[23:00:49] ✅ Patient data extraction completed successfully
[23:00:49] ✅    ✅ Patient data extracted successfully
[23:00:49] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': 'S06.6XAD', 'secondDiagnosis': 'N13.2', 'thirdDiagnosis': 'N12', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.31'}]
[23:00:49] ✅    ✅ Patient identified: Janice Arruda
[23:00:49] ✅    ✅ Patient name validation passed
[23:00:49] 🔄 
🔄 Step 3: Processing patient dates...
[23:00:49] [DOC: 9160118] ℹ️  DOB normalized: 01/24/1950
[23:00:49] [DOC: 9160118] ℹ️  Episode startOfCare normalized: 02/08/2025
[23:00:49] [DOC: 9160118] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[23:00:49] [DOC: 9160118] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[23:00:49] [DOC: 9160118] ✅ Patient date processing completed successfully
[23:00:49] ✅    ✅ Date processing completed
[23:00:49] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': 'S06.6XAD', 'secondDiagnosis': 'N13.2', 'thirdDiagnosis': 'N12', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.31'}]
[23:00:49] 🔄 
🔄 Step 4: Extracting order data...
[23:00:52] ℹ️  Order extraction - MRN: '5862015'
[23:00:52] ℹ️  Order extraction - Sex: 'FEMALE'
[23:00:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT, Diet'
[23:00:52] ℹ️  Order extraction - Payer Source: ''
[23:00:52] ✅ Order data extraction completed successfully
[23:00:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:00:52] ℹ️  Using MRN from patient data: '5862015' over '5862015'
[23:00:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT, Diet'
[23:00:52] ✅ Patient name cross-validation successful
[23:00:52] ✅    ✅ Data merged successfully
[23:00:53] ✅    ✅ Order data extracted and validated
[23:00:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:00:53] [DOC: 9160118] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[23:00:53] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[23:00:53] 🔄 
🔄 Step 6: Pushing order to API...
[23:00:53] [DOC: 9160118] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[23:00:54] [DOC: 9160118] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:00:54] ❌    ❌ Failed to push order
[23:00:54] 🔄 
🔄 Step 7: Writing to CSV...
[23:00:54] [DOC: 9160118] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[23:00:54] [DOC: 9160118] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT, Diet'
[23:00:54] [DOC: 9160118] ℹ️  Payer Source extracted: ''
[23:00:54] [DOC: 9160118] ℹ️  Diagnosis codes being written:
[23:00:54] [DOC: 9160118] ℹ️    - Latest_Episode_Firstdiagnosis: 'S06.6XAD'
[23:00:54] [DOC: 9160118] ℹ️    - Latest_Episode_Seconddiagnosis: 'N13.2'
[23:00:54] [DOC: 9160118] ℹ️    - Latest_Episode_Thirddiagnosis: 'N12'
[23:00:54] [DOC: 9160118] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I13.0'
[23:00:54] [DOC: 9160118] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.33'
[23:00:54] [DOC: 9160118] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.31'
[23:00:54] [DOC: 9160118] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: Skilled Nursing, PT, OT, Diet | Payer:  | MRN: 5862015
[23:00:54] ✅    ✅ Document 9160118 processed and saved successfully
[23:00:54] 🔄 
🔄 Step 8: Saving API details...
[23:00:54] [DOC: 9160118] ℹ️  API push details saved for document 9160118
[23:00:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9157875                         ║
================================================================================
[23:00:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[23:00:54] ℹ️  Date: 03/03/2025
[23:00:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:00:57] [DOC: 9157875] ✅ Text extracted using pdfplumber (1407 chars)
[23:00:57] ✅    ✅ Text extracted using pdfplumber (1407 chars)
[23:00:57] 🔄 
🔄 Step 2: Extracting patient data...
[23:01:00] ℹ️  AI extracted raw sex value: ''
[23:01:00] ℹ️  AI extracted service line: 'Physical Therapy'
[23:01:00] ℹ️  AI extracted payer source: ''
[23:01:00] ℹ️  AI extracted diagnoses:
[23:01:00] ℹ️    - Diagnosis 1: 'M54.32'
[23:01:00] ℹ️    - Diagnosis 2: 'I12.9'
[23:01:00] ℹ️    - Diagnosis 3: 'E11.22'
[23:01:00] ℹ️    - Diagnosis 4: 'None'
[23:01:00] ℹ️    - Diagnosis 5: 'None'
[23:01:00] ℹ️    - Diagnosis 6: 'None'
[23:01:00] ℹ️  Final extracted MRN: 'MA220126074307'
[23:01:00] ℹ️  Final extracted Sex: ''
[23:01:00] ℹ️  Final extracted Service Line: 'Physical Therapy'
[23:01:00] ℹ️  Final extracted Payer Source: ''
[23:01:00] ✅ Patient data extraction completed successfully
[23:01:00] ✅    ✅ Patient data extracted successfully
[23:01:00] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 1487641502
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:01:00] ✅    ✅ Patient identified: Manuel Furtado
[23:01:00] ✅    ✅ Patient name validation passed
[23:01:00] 🔄 
🔄 Step 3: Processing patient dates...
[23:01:00] [DOC: 9157875] ℹ️  DOB normalized: 07/13/1943
[23:01:00] [DOC: 9157875] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[23:01:00] [DOC: 9157875] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[23:01:00] [DOC: 9157875] ✅ Patient date processing completed successfully
[23:01:00] ✅    ✅ Date processing completed
[23:01:00] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 1487641502
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22'}]
[23:01:00] 🔄 
🔄 Step 4: Extracting order data...
[23:01:03] ℹ️  Order extraction - MRN: 'MA220126074307'
[23:01:03] ℹ️  Order extraction - Sex: ''
[23:01:03] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[23:01:03] ℹ️  Order extraction - Payer Source: ''
[23:01:03] ✅ Order data extraction completed successfully
[23:01:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:01:03] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[23:01:03] ⚠️  Could not determine sex using any available method
[23:01:03] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[23:01:03] ✅ Patient name cross-validation successful
[23:01:03] ✅    ✅ Data merged successfully
[23:01:04] ✅    ✅ Order data extracted and validated
[23:01:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:01:04] [DOC: 9157875] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[23:01:04] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[23:01:04] 🔄 
🔄 Step 6: Pushing order to API...
[23:01:04] [DOC: 9157875] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[23:01:05] [DOC: 9157875] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13017"}
[23:01:05] ❌    ❌ Failed to push order
[23:01:05] 🔄 
🔄 Step 7: Writing to CSV...
[23:01:05] [DOC: 9157875] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[23:01:05] [DOC: 9157875] ℹ️  Service Line extracted: 'Physical Therapy'
[23:01:05] [DOC: 9157875] ℹ️  Payer Source extracted: ''
[23:01:05] [DOC: 9157875] ℹ️  Diagnosis codes being written:
[23:01:05] [DOC: 9157875] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.32'
[23:01:05] [DOC: 9157875] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[23:01:05] [DOC: 9157875] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[23:01:05] [DOC: 9157875] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:01:05] [DOC: 9157875] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:01:05] [DOC: 9157875] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:01:05] [DOC: 9157875] ✅ Patient data written to CSV: Manuel Furtado | Sex:  | Age: 81 | Service: Physical Therapy | Payer:  | MRN: MA220126074307
[23:01:05] ✅    ✅ Document 9157875 processed and saved successfully
[23:01:05] 🔄 
🔄 Step 8: Saving API details...
[23:01:05] [DOC: 9157875] ℹ️  API push details saved for document 9157875
[23:01:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9157874                         ║
================================================================================
[23:01:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[23:01:05] ℹ️  Date: 03/03/2025
[23:01:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:01:09] [DOC: 9157874] ✅ Text extracted using pdfplumber (20416 chars)
[23:01:09] ✅    ✅ Text extracted using pdfplumber (20416 chars)
[23:01:09] 🔄 
🔄 Step 2: Extracting patient data...
[23:01:12] ℹ️  AI extracted raw sex value: 'M'
[23:01:12] ℹ️  AI extracted service line: 'PT'
[23:01:12] ℹ️  AI extracted payer source: ''
[23:01:12] ℹ️  AI extracted diagnoses:
[23:01:12] ℹ️    - Diagnosis 1: 'M54.5'
[23:01:12] ℹ️    - Diagnosis 2: 'C67.9'
[23:01:12] ℹ️    - Diagnosis 3: 'K62.9'
[23:01:12] ℹ️    - Diagnosis 4: 'D11.9'
[23:01:12] ℹ️    - Diagnosis 5: 'E11.9'
[23:01:12] ℹ️    - Diagnosis 6: 'I25.10'
[23:01:12] ℹ️  Final extracted MRN: 'MA220126074307'
[23:01:12] ℹ️  Final extracted Sex: 'MALE'
[23:01:12] ℹ️  Final extracted Service Line: 'PT'
[23:01:12] ℹ️  Final extracted Payer Source: ''
[23:01:12] ✅ Patient data extraction completed successfully
[23:01:12] ✅    ✅ Patient data extracted successfully
[23:01:12] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'M54.5', 'secondDiagnosis': 'C67.9', 'thirdDiagnosis': 'K62.9', 'fourthDiagnosis': 'D11.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'I25.10'}]
[23:01:12] ✅    ✅ Patient identified: Manuel Furtado
[23:01:12] ✅    ✅ Patient name validation passed
[23:01:12] 🔄 
🔄 Step 3: Processing patient dates...
[23:01:12] [DOC: 9157874] ℹ️  DOB normalized: 07/13/1943
[23:01:12] [DOC: 9157874] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[23:01:12] [DOC: 9157874] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[23:01:12] [DOC: 9157874] ✅ Patient date processing completed successfully
[23:01:12] ✅    ✅ Date processing completed
[23:01:12] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'M54.5', 'secondDiagnosis': 'C67.9', 'thirdDiagnosis': 'K62.9', 'fourthDiagnosis': 'D11.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'I25.10'}]
[23:01:12] 🔄 
🔄 Step 4: Extracting order data...
[23:01:15] ℹ️  Order extraction - MRN: 'MA220126074307'
[23:01:15] ℹ️  Order extraction - Sex: 'MALE'
[23:01:15] ℹ️  Order extraction - Service Line: 'PT'
[23:01:15] ℹ️  Order extraction - Payer Source: ''
[23:01:15] ✅ Order data extraction completed successfully
[23:01:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:01:15] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[23:01:15] ℹ️  Service line consistent in both sources: 'PT'
[23:01:15] ✅ Patient name cross-validation successful
[23:01:15] ✅    ✅ Data merged successfully
[23:01:16] ✅    ✅ Order data extracted and validated
[23:01:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:01:16] [DOC: 9157874] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[23:01:16] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[23:01:16] 🔄 
🔄 Step 6: Pushing order to API...
[23:01:16] [DOC: 9157874] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[23:01:17] [DOC: 9157874] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:01:17] ❌    ❌ Failed to push order
[23:01:17] 🔄 
🔄 Step 7: Writing to CSV...
[23:01:17] [DOC: 9157874] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[23:01:17] [DOC: 9157874] ℹ️  Service Line extracted: 'PT'
[23:01:17] [DOC: 9157874] ℹ️  Payer Source extracted: ''
[23:01:17] [DOC: 9157874] ℹ️  Diagnosis codes being written:
[23:01:17] [DOC: 9157874] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.5'
[23:01:17] [DOC: 9157874] ℹ️    - Latest_Episode_Seconddiagnosis: 'C67.9'
[23:01:17] [DOC: 9157874] ℹ️    - Latest_Episode_Thirddiagnosis: 'K62.9'
[23:01:17] [DOC: 9157874] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D11.9'
[23:01:17] [DOC: 9157874] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.9'
[23:01:17] [DOC: 9157874] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[23:01:17] [DOC: 9157874] ✅ Patient data written to CSV: Manuel Furtado | Sex: MALE | Age: 81 | Service: PT | Payer:  | MRN: MA220126074307
[23:01:17] ✅    ✅ Document 9157874 processed and saved successfully
[23:01:17] 🔄 
🔄 Step 8: Saving API details...
[23:01:17] [DOC: 9157874] ℹ️  API push details saved for document 9157874
[23:01:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9157776                         ║
================================================================================
[23:01:17] ℹ️  Agency: Nizhoni Health-Fall River
[23:01:17] ℹ️  Date: 03/03/2025
[23:01:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:01:23] [DOC: 9157776] ✅ Text extracted using pdfplumber (1249 chars)
[23:01:23] ✅    ✅ Text extracted using pdfplumber (1249 chars)
[23:01:23] 🔄 
🔄 Step 2: Extracting patient data...
[23:01:25] ℹ️  AI extracted raw sex value: 'F'
[23:01:25] ℹ️  AI extracted service line: 'HHA'
[23:01:25] ℹ️  AI extracted payer source: 'Medicaid/MA'
[23:01:25] ℹ️  AI extracted diagnoses:
[23:01:25] ℹ️    - Diagnosis 1: ''
[23:01:25] ℹ️    - Diagnosis 2: ''
[23:01:25] ℹ️    - Diagnosis 3: ''
[23:01:25] ℹ️    - Diagnosis 4: ''
[23:01:25] ℹ️    - Diagnosis 5: ''
[23:01:25] ℹ️    - Diagnosis 6: ''
[23:01:25] ℹ️  Final extracted MRN: '25598'
[23:01:25] ℹ️  Final extracted Sex: 'FEMALE'
[23:01:25] ℹ️  Final extracted Service Line: 'HHA'
[23:01:25] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[23:01:25] ✅ Patient data extraction completed successfully
[23:01:25] ✅    ✅ Patient data extracted successfully
[23:01:25] 📊 Patient Response
     └─ patientFName: Helena
     └─ patientLName: Brooks
     └─ dob: 05/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25598
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 60 S 2nd St APT 5F
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2018', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:01:25] ✅    ✅ Patient identified: Helena Brooks
[23:01:25] ✅    ✅ Patient name validation passed
[23:01:25] 🔄 
🔄 Step 3: Processing patient dates...
[23:01:25] [DOC: 9157776] ℹ️  DOB normalized: 05/27/1958
[23:01:25] [DOC: 9157776] ℹ️  Episode startOfCare normalized: 07/15/2018
[23:01:25] [DOC: 9157776] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[23:01:25] [DOC: 9157776] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[23:01:25] [DOC: 9157776] ✅ Patient date processing completed successfully
[23:01:25] ✅    ✅ Date processing completed
[23:01:25] 📊 Processed Patient Data
     └─ patientFName: Helena
     └─ patientLName: Brooks
     └─ dob: 05/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25598
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 60 S 2nd St APT 5F
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2018', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:01:25] 🔄 
🔄 Step 4: Extracting order data...
[23:01:28] ℹ️  Order extraction - MRN: '25598'
[23:01:28] ℹ️  Order extraction - Sex: 'FEMALE'
[23:01:28] ℹ️  Order extraction - Service Line: ''
[23:01:28] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[23:01:28] ✅ Order data extraction completed successfully
[23:01:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:01:28] ℹ️  Using MRN from patient data: '25598' over '25598'
[23:01:28] ℹ️  Using service line from patient data: 'HHA'
[23:01:28] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[23:01:28] ✅ Patient name cross-validation successful
[23:01:28] ✅    ✅ Data merged successfully
[23:01:29] ✅    ✅ Order data extracted and validated
[23:01:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:01:29] [DOC: 9157776] ✅ Patient found in local cache: Helena Brooks, ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[23:01:29] ✅    ✅ Existing patient found with ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[23:01:29] 🔄 
🔄 Step 6: Pushing order to API...
[23:01:29] [DOC: 9157776] ℹ️  Pushing order via API for patient ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[23:01:31] [DOC: 9157776] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:01:31] ❌    ❌ Failed to push order
[23:01:31] 🔄 
🔄 Step 7: Writing to CSV...
[23:01:31] [DOC: 9157776] ℹ️  Calculated age: 67 from DOB: 05/27/1958
[23:01:31] [DOC: 9157776] ℹ️  Service Line extracted: 'HHA'
[23:01:31] [DOC: 9157776] ℹ️  Payer Source extracted: 'Medicaid/MA'
[23:01:31] [DOC: 9157776] ℹ️  Diagnosis codes being written:
[23:01:31] [DOC: 9157776] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[23:01:31] [DOC: 9157776] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[23:01:31] [DOC: 9157776] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[23:01:31] [DOC: 9157776] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:01:31] [DOC: 9157776] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:01:31] [DOC: 9157776] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:01:31] [DOC: 9157776] ✅ Patient data written to CSV: Helena Brooks | Sex: FEMALE | Age: 67 | Service: HHA | Payer: Medicaid/MA | MRN: 25598
[23:01:31] ✅    ✅ Document 9157776 processed and saved successfully
[23:01:31] 🔄 
🔄 Step 8: Saving API details...
[23:01:31] [DOC: 9157776] ℹ️  API push details saved for document 9157776
[23:01:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9159964                         ║
================================================================================
[23:01:31] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[23:01:31] ℹ️  Date: 03/03/2025
[23:01:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:01:34] [DOC: 9159964] ✅ Text extracted using pdfplumber (31236 chars)
[23:01:34] ✅    ✅ Text extracted using pdfplumber (31140 chars)
[23:01:34] 🔄 
🔄 Step 2: Extracting patient data...
[23:01:38] ℹ️  AI extracted raw sex value: 'F'
[23:01:38] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[23:01:38] ℹ️  AI extracted payer source: 'Medicare'
[23:01:38] ℹ️  AI extracted diagnoses:
[23:01:38] ℹ️    - Diagnosis 1: 'I26.02'
[23:01:38] ℹ️    - Diagnosis 2: 'Z48.812'
[23:01:38] ℹ️    - Diagnosis 3: 'S22.41XD'
[23:01:38] ℹ️    - Diagnosis 4: 'M34.9'
[23:01:38] ℹ️    - Diagnosis 5: 'I47.20'
[23:01:38] ℹ️    - Diagnosis 6: 'I10'
[23:01:38] ℹ️  Final extracted MRN: '28700164317501'
[23:01:38] ℹ️  Final extracted Sex: 'FEMALE'
[23:01:38] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[23:01:38] ℹ️  Final extracted Payer Source: 'Medicare'
[23:01:38] ✅ Patient data extraction completed successfully
[23:01:38] ✅    ✅ Patient data extracted successfully
[23:01:38] 📊 Patient Response
     └─ patientFName: MARIE
     └─ patientLName: STRAWN
     └─ dob: 10/24/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700164317501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 42 HIGHLAND AVE
     └─ city: ONSET
     └─ state: MA
     └─ zip: 02558
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I26.02', 'secondDiagnosis': 'Z48.812', 'thirdDiagnosis': 'S22.41XD', 'fourthDiagnosis': 'M34.9', 'fifthDiagnosis': 'I47.20', 'sixthDiagnosis': 'I10'}]
[23:01:38] ✅    ✅ Patient identified: MARIE STRAWN
[23:01:38] ✅    ✅ Patient name validation passed
[23:01:38] 🔄 
🔄 Step 3: Processing patient dates...
[23:01:38] [DOC: 9159964] ℹ️  DOB normalized: 10/24/1935
[23:01:38] [DOC: 9159964] ℹ️  Episode startOfCare normalized: 02/17/2025
[23:01:38] [DOC: 9159964] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[23:01:38] [DOC: 9159964] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[23:01:38] [DOC: 9159964] ✅ Patient date processing completed successfully
[23:01:38] ✅    ✅ Date processing completed
[23:01:38] 📊 Processed Patient Data
     └─ patientFName: MARIE
     └─ patientLName: STRAWN
     └─ dob: 10/24/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700164317501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 42 HIGHLAND AVE
     └─ city: ONSET
     └─ state: MA
     └─ zip: 02558
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I26.02', 'secondDiagnosis': 'Z48.812', 'thirdDiagnosis': 'S22.41XD', 'fourthDiagnosis': 'M34.9', 'fifthDiagnosis': 'I47.20', 'sixthDiagnosis': 'I10'}]
[23:01:38] 🔄 
🔄 Step 4: Extracting order data...
[23:01:41] ℹ️  Order extraction - MRN: '28700164317501'
[23:01:41] ℹ️  Order extraction - Sex: 'FEMALE'
[23:01:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[23:01:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[23:01:41] ✅ Order data extraction completed successfully
[23:01:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:01:41] ℹ️  Using MRN from patient data: '28700164317501' over '28700164317501'
[23:01:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[23:01:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[23:01:41] ✅ Patient name cross-validation successful
[23:01:41] ✅    ✅ Data merged successfully
[23:01:42] ✅    ✅ Order data extracted and validated
[23:01:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:01:52] [DOC: 9159964] ℹ️  Patient not found in cache or API: MARIE STRAWN
[23:01:52] [DOC: 9159964] ℹ️  Patient not found, creating new patient via API...
[23:01:52] [DOC: 9159964] ℹ️  Creating patient via API: MARIE STRAWN
[23:01:53] [DOC: 9159964] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[23:01:53] ❌    ❌ Failed to create patient
[23:01:53] [DOC: 9159964] ℹ️  API push details saved for document 9159964
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[23:01:53] ℹ️  Total Processed: 501
[23:01:53] ℹ️  CSV Success: 287
[23:01:53] ℹ️  CSV Errors: 80
[23:01:53] ℹ️  API Success: 0
[23:01:53] ℹ️  API Errors: 421
[23:01:53] ℹ️  CSV Success Rate: 57.3%
[23:01:53] ℹ️  API Success Rate: 0.0%
[23:01:53] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_203440.csv
[23:01:53] ℹ️  API Details File: api_outputs/api_push_details_20250608_203440.csv
================================================================================
║          ============================================================          ║
================================================================================
