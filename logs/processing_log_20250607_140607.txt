================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[14:06:07] ℹ️  CSV Data Extraction & API Push Tool
[14:06:07] ℹ️  
[14:06:07] ℹ️  Features:
[14:06:07] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[14:06:07] ℹ️  - AI-powered patient and order data extraction
[14:06:07] ℹ️  - Enhanced error handling and logging
[14:06:07] ℹ️  - Full API integration (patient creation + order pushing)
[14:06:07] ℹ️  - CSV output with comprehensive patient data
[14:06:07] ℹ️  - Detailed API tracking with remarks for every document
[14:06:07] ℹ️  - Complete audit trail of all processing attempts
[14:06:07] ℹ️  
[14:06:07] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[14:06:07] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_140607.csv
[14:06:07] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_140607.csv
================================================================================
║                        Processing Document ID: 9305816                         ║
================================================================================
[14:06:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:06:07] ℹ️  Date: 05/21/2025
[14:06:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:09] [DOC: 9305816] ✅ Text extracted using pdfplumber (1582 chars)
[14:06:09] ✅    ✅ Text extracted using pdfplumber (1570 chars)
[14:06:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:06:13] ℹ️  AI extracted raw sex value: ''
[14:06:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:06:13] ℹ️  AI extracted payer source: ''
[14:06:13] ℹ️  AI extracted diagnoses:
[14:06:13] ℹ️    - Diagnosis 1: 'F20.9'
[14:06:13] ℹ️    - Diagnosis 2: 'E11.69'
[14:06:13] ℹ️    - Diagnosis 3: 'I10'
[14:06:13] ℹ️    - Diagnosis 4: ''
[14:06:13] ℹ️    - Diagnosis 5: ''
[14:06:13] ℹ️    - Diagnosis 6: ''
[14:06:13] ℹ️  Final extracted MRN: 'MA210924045601'
[14:06:13] ℹ️  Final extracted Sex: ''
[14:06:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:06:13] ℹ️  Final extracted Payer Source: ''
[14:06:13] ✅ Patient data extraction completed successfully
[14:06:13] ✅    ✅ Patient data extracted successfully
[14:06:13] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:06:13] ✅    ✅ Patient identified: Richard Rocheleau
[14:06:13] ✅    ✅ Patient name validation passed
[14:06:13] 🔄 
🔄 Step 3: Processing patient dates...
[14:06:13] [DOC: 9305816] ℹ️  DOB normalized: 04/08/1956
[14:06:13] [DOC: 9305816] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:06:13] [DOC: 9305816] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:06:13] [DOC: 9305816] ✅ Patient date processing completed successfully
[14:06:13] ✅    ✅ Date processing completed
[14:06:13] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:06:13] 🔄 
🔄 Step 4: Extracting order data...
[14:06:15] ℹ️  Order extraction - MRN: 'MA210924045601'
[14:06:15] ℹ️  Order extraction - Sex: ''
[14:06:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:06:15] ℹ️  Order extraction - Payer Source: ''
[14:06:15] ✅ Order data extraction completed successfully
[14:06:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:06:15] ℹ️  Using MRN from patient data: 'MA210924045601' over 'MA210924045601'
[14:06:15] ℹ️  Inferred sex as MALE from name: Richard
[14:06:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:06:15] ✅ Patient name cross-validation successful
[14:06:15] ✅    ✅ Data merged successfully
[14:06:16] ✅    ✅ Order data extracted and validated
[14:06:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:06:39] [DOC: 9305816] ✅ Patient exists in API: Richard Rocheleau, ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[14:06:39] ✅    ✅ Existing patient found with ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[14:06:39] 🔄 
🔄 Step 6: Pushing order to API...
[14:06:39] [DOC: 9305816] ℹ️  Pushing order via API for patient ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[14:06:41] [DOC: 9305816] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19032"}
[14:06:41] ❌    ❌ Failed to push order
[14:06:41] 🔄 
🔄 Step 7: Writing to CSV...
[14:06:41] [DOC: 9305816] ℹ️  Calculated age: 69 from DOB: 04/08/1956
[14:06:41] [DOC: 9305816] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:06:41] [DOC: 9305816] ℹ️  Payer Source extracted: ''
[14:06:41] [DOC: 9305816] ℹ️  Diagnosis codes being written:
[14:06:41] [DOC: 9305816] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[14:06:41] [DOC: 9305816] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.69'
[14:06:41] [DOC: 9305816] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[14:06:41] [DOC: 9305816] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:06:41] [DOC: 9305816] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:06:41] [DOC: 9305816] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:06:41] [DOC: 9305816] ✅ Patient data written to CSV: Richard Rocheleau | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer:  | MRN: MA210924045601
[14:06:41] ✅    ✅ Document 9305816 processed and saved successfully
[14:06:41] 🔄 
🔄 Step 8: Saving API details...
[14:06:41] [DOC: 9305816] ℹ️  API push details saved for document 9305816
[14:06:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305814                         ║
================================================================================
[14:06:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:06:41] ℹ️  Date: 05/21/2025
[14:06:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:45] [DOC: 9305814] ✅ Text extracted using pdfplumber (13443 chars)
[14:06:45] ✅    ✅ Text extracted using pdfplumber (13443 chars)
[14:06:45] 🔄 
🔄 Step 2: Extracting patient data...
[14:06:48] ℹ️  AI extracted raw sex value: 'F'
[14:06:48] ℹ️  AI extracted service line: 'OT'
[14:06:48] ℹ️  AI extracted payer source: 'None'
[14:06:48] ℹ️  AI extracted diagnoses:
[14:06:48] ℹ️    - Diagnosis 1: 'vertigo'
[14:06:48] ℹ️    - Diagnosis 2: 'muscle weakness'
[14:06:48] ℹ️    - Diagnosis 3: 'None'
[14:06:48] ℹ️    - Diagnosis 4: 'None'
[14:06:48] ℹ️    - Diagnosis 5: 'None'
[14:06:48] ℹ️    - Diagnosis 6: 'None'
[14:06:48] ℹ️  Final extracted MRN: '101002392'
[14:06:48] ℹ️  Final extracted Sex: 'FEMALE'
[14:06:48] ℹ️  Final extracted Service Line: 'OT'
[14:06:48] ℹ️  Final extracted Payer Source: ''
[14:06:48] ✅ Patient data extraction completed successfully
[14:06:48] ✅    ✅ Patient data extracted successfully
[14:06:48] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': None, 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:06:48] ✅    ✅ Patient identified: Virginia Brunton
[14:06:48] ✅    ✅ Patient name validation passed
[14:06:48] 🔄 
🔄 Step 3: Processing patient dates...
[14:06:48] [DOC: 9305814] ℹ️  DOB normalized: 06/05/1940
[14:06:48] [DOC: 9305814] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[14:06:48] [DOC: 9305814] ✅ Patient date processing completed successfully
[14:06:48] ✅    ✅ Date processing completed
[14:06:48] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness'}]
[14:06:48] 🔄 
🔄 Step 4: Extracting order data...
[14:06:51] ℹ️  Order extraction - MRN: '101002392'
[14:06:51] ℹ️  Order extraction - Sex: 'FEMALE'
[14:06:51] ℹ️  Order extraction - Service Line: 'OT'
[14:06:51] ℹ️  Order extraction - Payer Source: ''
[14:06:51] ✅ Order data extraction completed successfully
[14:06:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:06:51] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[14:06:51] ℹ️  Service line consistent in both sources: 'OT'
[14:06:51] ✅ Patient name cross-validation successful
[14:06:51] ✅    ✅ Data merged successfully
[14:06:52] ✅    ✅ Order data extracted and validated
[14:06:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:06:52] [DOC: 9305814] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[14:06:52] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[14:06:52] 🔄 
🔄 Step 6: Pushing order to API...
[14:06:52] [DOC: 9305814] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[14:06:53] [DOC: 9305814] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:06:53] ❌    ❌ Failed to push order
[14:06:53] 🔄 
🔄 Step 7: Writing to CSV...
[14:06:53] [DOC: 9305814] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[14:06:53] [DOC: 9305814] ℹ️  Service Line extracted: 'OT'
[14:06:53] [DOC: 9305814] ℹ️  Payer Source extracted: ''
[14:06:53] [DOC: 9305814] ℹ️  Diagnosis codes being written:
[14:06:53] [DOC: 9305814] ℹ️    - Latest_Episode_Firstdiagnosis: 'vertigo'
[14:06:53] [DOC: 9305814] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[14:06:53] [DOC: 9305814] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:06:53] [DOC: 9305814] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:06:53] [DOC: 9305814] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:06:53] [DOC: 9305814] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:06:53] [DOC: 9305814] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: OT | Payer:  | MRN: 101002392
[14:06:53] ✅    ✅ Document 9305814 processed and saved successfully
[14:06:53] 🔄 
🔄 Step 8: Saving API details...
[14:06:53] [DOC: 9305814] ℹ️  API push details saved for document 9305814
[14:06:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305809                         ║
================================================================================
[14:06:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:06:53] ℹ️  Date: 05/21/2025
[14:06:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:59] [DOC: 9305809] ✅ Text extracted using pdfplumber (18552 chars)
[14:06:59] ✅    ✅ Text extracted using pdfplumber (18552 chars)
[14:06:59] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:02] ℹ️  AI extracted raw sex value: ''
[14:07:02] ℹ️  AI extracted service line: 'OT'
[14:07:02] ℹ️  AI extracted payer source: ''
[14:07:02] ℹ️  AI extracted diagnoses:
[14:07:02] ℹ️    - Diagnosis 1: ''
[14:07:02] ℹ️    - Diagnosis 2: ''
[14:07:02] ℹ️    - Diagnosis 3: ''
[14:07:02] ℹ️    - Diagnosis 4: ''
[14:07:02] ℹ️    - Diagnosis 5: ''
[14:07:02] ℹ️    - Diagnosis 6: ''
[14:07:02] ℹ️  Final extracted MRN: 'MA241126016807'
[14:07:02] ℹ️  Final extracted Sex: ''
[14:07:02] ℹ️  Final extracted Service Line: 'OT'
[14:07:02] ℹ️  Final extracted Payer Source: ''
[14:07:02] ✅ Patient data extraction completed successfully
[14:07:02] ✅    ✅ Patient data extracted successfully
[14:07:02] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:02] ✅    ✅ Patient identified: Frank Ferreira
[14:07:02] ✅    ✅ Patient name validation passed
[14:07:02] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:02] [DOC: 9305809] ℹ️  DOB normalized: 01/07/1968
[14:07:02] [DOC: 9305809] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[14:07:02] [DOC: 9305809] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[14:07:02] [DOC: 9305809] ✅ Patient date processing completed successfully
[14:07:02] ✅    ✅ Date processing completed
[14:07:02] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:02] 🔄 
🔄 Step 4: Extracting order data...
[14:07:05] ℹ️  Order extraction - MRN: 'MA241126016807'
[14:07:05] ℹ️  Order extraction - Sex: 'MALE'
[14:07:05] ℹ️  Order extraction - Service Line: 'OT'
[14:07:05] ℹ️  Order extraction - Payer Source: ''
[14:07:05] ✅ Order data extraction completed successfully
[14:07:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:05] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[14:07:05] ℹ️  Service line consistent in both sources: 'OT'
[14:07:05] ✅ Patient name cross-validation successful
[14:07:05] ✅    ✅ Data merged successfully
[14:07:06] ✅    ✅ Order data extracted and validated
[14:07:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:13] [DOC: 9305809] ℹ️  Patient not found in cache or API: Frank Ferreira
[14:07:13] [DOC: 9305809] ℹ️  Patient not found, creating new patient via API...
[14:07:13] [DOC: 9305809] ℹ️  Creating patient via API: Frank Ferreira
[14:07:14] [DOC: 9305809] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:07:14] ❌    ❌ Failed to create patient
[14:07:14] [DOC: 9305809] ℹ️  API push details saved for document 9305809
================================================================================
║                        Processing Document ID: 9305393                         ║
================================================================================
[14:07:14] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:14] ℹ️  Date: 05/21/2025
[14:07:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:15] [DOC: 9305393] ✅ Text extracted using pdfplumber (1042 chars)
[14:07:15] ✅    ✅ Text extracted using pdfplumber (1042 chars)
[14:07:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:18] ℹ️  AI extracted raw sex value: 'F'
[14:07:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:07:18] ℹ️  AI extracted payer source: ''
[14:07:18] ℹ️  AI extracted diagnoses:
[14:07:18] ℹ️    - Diagnosis 1: 'None'
[14:07:18] ℹ️    - Diagnosis 2: 'None'
[14:07:18] ℹ️    - Diagnosis 3: 'None'
[14:07:18] ℹ️    - Diagnosis 4: 'None'
[14:07:18] ℹ️    - Diagnosis 5: 'None'
[14:07:18] ℹ️    - Diagnosis 6: 'None'
[14:07:18] ℹ️  Final extracted MRN: '2577119'
[14:07:18] ℹ️  Final extracted Sex: 'FEMALE'
[14:07:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:07:18] ℹ️  Final extracted Payer Source: ''
[14:07:18] ✅ Patient data extraction completed successfully
[14:07:18] ✅    ✅ Patient data extracted successfully
[14:07:18] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:07:18] ✅    ✅ Patient identified: Marilyn Hood
[14:07:18] ✅    ✅ Patient name validation passed
[14:07:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:18] [DOC: 9305393] ℹ️  DOB normalized: 10/23/1941
[14:07:18] [DOC: 9305393] ✅ Patient date processing completed successfully
[14:07:18] ✅    ✅ Date processing completed
[14:07:18] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:07:18] 🔄 
🔄 Step 4: Extracting order data...
[14:07:20] ℹ️  Order extraction - MRN: '2577119'
[14:07:20] ℹ️  Order extraction - Sex: 'FEMALE'
[14:07:20] ℹ️  Order extraction - Service Line: ''
[14:07:20] ℹ️  Order extraction - Payer Source: ''
[14:07:20] ✅ Order data extraction completed successfully
[14:07:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:20] ℹ️  Using MRN from patient data: '2577119' over '2577119'
[14:07:20] ℹ️  Using service line from patient data: 'Skilled Nursing'
[14:07:20] ✅ Patient name cross-validation successful
[14:07:20] ✅    ✅ Data merged successfully
[14:07:22] ✅    ✅ Order data extracted and validated
[14:07:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:22] [DOC: 9305393] ✅ Patient found in local cache: Marilyn Hood, ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[14:07:22] ✅    ✅ Existing patient found with ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[14:07:22] 🔄 
🔄 Step 6: Pushing order to API...
[14:07:22] [DOC: 9305393] ℹ️  Pushing order via API for patient ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[14:07:23] [DOC: 9305393] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19035"}
[14:07:23] ❌    ❌ Failed to push order
[14:07:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:07:23] [DOC: 9305393] ℹ️  Calculated age: 83 from DOB: 10/23/1941
[14:07:23] [DOC: 9305393] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:07:23] [DOC: 9305393] ℹ️  Payer Source extracted: ''
[14:07:23] [DOC: 9305393] ℹ️  Diagnosis codes being written:
[14:07:23] [DOC: 9305393] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:07:23] [DOC: 9305393] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:07:23] [DOC: 9305393] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:07:23] [DOC: 9305393] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:07:23] [DOC: 9305393] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:07:23] [DOC: 9305393] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:07:23] [DOC: 9305393] ✅ Patient data written to CSV: Marilyn Hood | Sex: FEMALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: 2577119
[14:07:23] ✅    ✅ Document 9305393 processed and saved successfully
[14:07:23] 🔄 
🔄 Step 8: Saving API details...
[14:07:23] [DOC: 9305393] ℹ️  API push details saved for document 9305393
[14:07:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305391                         ║
================================================================================
[14:07:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:23] ℹ️  Date: 05/21/2025
[14:07:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:24] [DOC: 9305391] ✅ Text extracted using pdfplumber (1262 chars)
[14:07:24] ✅    ✅ Text extracted using pdfplumber (1262 chars)
[14:07:24] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:27] ℹ️  AI extracted raw sex value: 'F'
[14:07:27] ℹ️  AI extracted service line: 'Physical Therapy'
[14:07:27] ℹ️  AI extracted payer source: ''
[14:07:27] ℹ️  AI extracted diagnoses:
[14:07:27] ℹ️    - Diagnosis 1: ''
[14:07:27] ℹ️    - Diagnosis 2: ''
[14:07:27] ℹ️    - Diagnosis 3: ''
[14:07:27] ℹ️    - Diagnosis 4: ''
[14:07:27] ℹ️    - Diagnosis 5: ''
[14:07:27] ℹ️    - Diagnosis 6: ''
[14:07:27] ℹ️  Final extracted MRN: '2537464'
[14:07:27] ℹ️  Final extracted Sex: 'FEMALE'
[14:07:27] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:07:27] ℹ️  Final extracted Payer Source: ''
[14:07:27] ✅ Patient data extraction completed successfully
[14:07:27] ✅    ✅ Patient data extracted successfully
[14:07:27] 📊 Patient Response
     └─ patientFName: Pamela
     └─ patientLName: Greene
     └─ dob: 10/25/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2537464
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:27] ✅    ✅ Patient identified: Pamela Greene
[14:07:27] ✅    ✅ Patient name validation passed
[14:07:27] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:27] [DOC: 9305391] ℹ️  DOB normalized: 10/25/1945
[14:07:27] [DOC: 9305391] ✅ Patient date processing completed successfully
[14:07:27] ✅    ✅ Date processing completed
[14:07:27] 📊 Processed Patient Data
     └─ patientFName: Pamela
     └─ patientLName: Greene
     └─ dob: 10/25/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2537464
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:27] 🔄 
🔄 Step 4: Extracting order data...
[14:07:29] ℹ️  Order extraction - MRN: '2537464'
[14:07:29] ℹ️  Order extraction - Sex: 'FEMALE'
[14:07:29] ℹ️  Order extraction - Service Line: ''
[14:07:29] ℹ️  Order extraction - Payer Source: ''
[14:07:29] ✅ Order data extraction completed successfully
[14:07:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:29] ℹ️  Using MRN from patient data: '2537464' over '2537464'
[14:07:29] ℹ️  Using service line from patient data: 'Physical Therapy'
[14:07:29] ✅ Patient name cross-validation successful
[14:07:29] ✅    ✅ Data merged successfully
[14:07:30] ⚠️     ❌ Skipping - missing episode start date
[14:07:30] [DOC: 9305391] ℹ️  API push details saved for document 9305391
================================================================================
║                        Processing Document ID: 9305384                         ║
================================================================================
[14:07:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:30] ℹ️  Date: 05/21/2025
[14:07:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:31] [DOC: 9305384] ✅ Text extracted using pdfplumber (1190 chars)
[14:07:31] ✅    ✅ Text extracted using pdfplumber (1190 chars)
[14:07:31] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:34] ℹ️  AI extracted raw sex value: 'M'
[14:07:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:07:34] ℹ️  AI extracted payer source: ''
[14:07:34] ℹ️  AI extracted diagnoses:
[14:07:34] ℹ️    - Diagnosis 1: ''
[14:07:34] ℹ️    - Diagnosis 2: ''
[14:07:34] ℹ️    - Diagnosis 3: ''
[14:07:34] ℹ️    - Diagnosis 4: ''
[14:07:34] ℹ️    - Diagnosis 5: ''
[14:07:34] ℹ️    - Diagnosis 6: ''
[14:07:34] ℹ️  Final extracted MRN: '3451044'
[14:07:34] ℹ️  Final extracted Sex: 'MALE'
[14:07:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:07:34] ℹ️  Final extracted Payer Source: ''
[14:07:34] ✅ Patient data extraction completed successfully
[14:07:34] ✅    ✅ Patient data extracted successfully
[14:07:34] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Breese
     └─ dob: 10/30/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 3451044
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:34] ✅    ✅ Patient identified: David Breese
[14:07:34] ✅    ✅ Patient name validation passed
[14:07:34] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:34] [DOC: 9305384] ℹ️  DOB normalized: 10/30/1947
[14:07:34] [DOC: 9305384] ✅ Patient date processing completed successfully
[14:07:34] ✅    ✅ Date processing completed
[14:07:34] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Breese
     └─ dob: 10/30/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 3451044
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:34] 🔄 
🔄 Step 4: Extracting order data...
[14:07:36] ℹ️  Order extraction - MRN: '3451044'
[14:07:36] ℹ️  Order extraction - Sex: 'MALE'
[14:07:36] ℹ️  Order extraction - Service Line: ''
[14:07:36] ℹ️  Order extraction - Payer Source: ''
[14:07:36] ✅ Order data extraction completed successfully
[14:07:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:36] ℹ️  Using MRN from patient data: '3451044' over '3451044'
[14:07:36] ℹ️  Using service line from patient data: 'Skilled Nursing'
[14:07:36] ✅ Patient name cross-validation successful
[14:07:36] ✅    ✅ Data merged successfully
[14:07:37] ✅    ✅ Order data extracted and validated
[14:07:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:37] [DOC: 9305384] ✅ Patient found in local cache: David Breese, ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[14:07:37] ✅    ✅ Existing patient found with ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[14:07:37] 🔄 
🔄 Step 6: Pushing order to API...
[14:07:37] [DOC: 9305384] ℹ️  Pushing order via API for patient ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[14:07:39] [DOC: 9305384] ❌ Order push failed with status 201: {"id":"84ab728f-50ec-4f57-89f9-1295519ea538","orderWAVId":"ORD19946","orderNo":"1093923, 1093924","orderDate":"05/20/2025","startOfCare":"05/20/2025","episodeStartDate":"05/20/2025","episodeEndDate":"07/18/2025","documentID":"9305384","mrn":"3451044","patientName":"Breese,David","sentToPhysicianDate":"05/21/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"49bdf5d7-829c-4215-90b5-9ddd891dce52","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:07:39] ❌    ❌ Failed to push order
[14:07:39] 🔄 
🔄 Step 7: Writing to CSV...
[14:07:39] [DOC: 9305384] ℹ️  Calculated age: 77 from DOB: 10/30/1947
[14:07:39] [DOC: 9305384] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:07:39] [DOC: 9305384] ℹ️  Payer Source extracted: ''
[14:07:39] [DOC: 9305384] ℹ️  Diagnosis codes being written:
[14:07:39] [DOC: 9305384] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:07:39] [DOC: 9305384] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:07:39] [DOC: 9305384] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:07:39] [DOC: 9305384] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:07:39] [DOC: 9305384] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:07:39] [DOC: 9305384] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:07:39] [DOC: 9305384] ✅ Patient data written to CSV: David Breese | Sex: MALE | Age: 77 | Service: Skilled Nursing | Payer:  | MRN: 3451044
[14:07:39] ✅    ✅ Document 9305384 processed and saved successfully
[14:07:39] 🔄 
🔄 Step 8: Saving API details...
[14:07:39] [DOC: 9305384] ℹ️  API push details saved for document 9305384
[14:07:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305201                         ║
================================================================================
[14:07:39] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:07:39] ℹ️  Date: 05/21/2025
[14:07:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:41] [DOC: 9305201] ✅ Text extracted using pdfplumber (1348 chars)
[14:07:41] ✅    ✅ Text extracted using pdfplumber (1348 chars)
[14:07:41] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:44] ℹ️  AI extracted raw sex value: 'M'
[14:07:44] ℹ️  AI extracted service line: 'HHA'
[14:07:44] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:07:44] ℹ️  AI extracted diagnoses:
[14:07:44] ℹ️    - Diagnosis 1: ''
[14:07:44] ℹ️    - Diagnosis 2: ''
[14:07:44] ℹ️    - Diagnosis 3: ''
[14:07:44] ℹ️    - Diagnosis 4: ''
[14:07:44] ℹ️    - Diagnosis 5: ''
[14:07:44] ℹ️    - Diagnosis 6: ''
[14:07:44] ℹ️  Final extracted MRN: '879'
[14:07:44] ℹ️  Final extracted Sex: 'MALE'
[14:07:44] ℹ️  Final extracted Service Line: 'HHA'
[14:07:44] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:07:44] ✅ Patient data extraction completed successfully
[14:07:44] ✅    ✅ Patient data extracted successfully
[14:07:44] 📊 Patient Response
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:44] ✅    ✅ Patient identified: Sean McCarthy
[14:07:44] ✅    ✅ Patient name validation passed
[14:07:44] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:44] [DOC: 9305201] ℹ️  DOB normalized: 09/16/1969
[14:07:44] [DOC: 9305201] ℹ️  Episode startOfCare normalized: 03/30/2024
[14:07:44] [DOC: 9305201] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:07:44] [DOC: 9305201] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:07:44] [DOC: 9305201] ✅ Patient date processing completed successfully
[14:07:44] ✅    ✅ Date processing completed
[14:07:44] 📊 Processed Patient Data
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:44] 🔄 
🔄 Step 4: Extracting order data...
[14:07:47] ℹ️  Order extraction - MRN: '879'
[14:07:47] ℹ️  Order extraction - Sex: 'MALE'
[14:07:47] ℹ️  Order extraction - Service Line: 'HHA'
[14:07:47] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:07:47] ✅ Order data extraction completed successfully
[14:07:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:47] ℹ️  Using MRN from patient data: '879' over '879'
[14:07:47] ℹ️  Service line consistent in both sources: 'HHA'
[14:07:47] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:07:47] ✅ Patient name cross-validation successful
[14:07:47] ✅    ✅ Data merged successfully
[14:07:48] ✅    ✅ Order data extracted and validated
[14:07:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:48] [DOC: 9305201] ✅ Patient found in local cache: Sean McCarthy, ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[14:07:48] ✅    ✅ Existing patient found with ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[14:07:48] 🔄 
🔄 Step 6: Pushing order to API...
[14:07:48] [DOC: 9305201] ℹ️  Pushing order via API for patient ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[14:07:49] [DOC: 9305201] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[14:07:49] ❌    ❌ Failed to push order
[14:07:49] 🔄 
🔄 Step 7: Writing to CSV...
[14:07:49] [DOC: 9305201] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[14:07:49] [DOC: 9305201] ℹ️  Service Line extracted: 'HHA'
[14:07:49] [DOC: 9305201] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:07:49] [DOC: 9305201] ℹ️  Diagnosis codes being written:
[14:07:49] [DOC: 9305201] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:07:49] [DOC: 9305201] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:07:49] [DOC: 9305201] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:07:49] [DOC: 9305201] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:07:49] [DOC: 9305201] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:07:49] [DOC: 9305201] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:07:49] [DOC: 9305201] ✅ Patient data written to CSV: Sean McCarthy | Sex: MALE | Age: 55 | Service: HHA | Payer: Medicaid/MA | MRN: 879
[14:07:49] ✅    ✅ Document 9305201 processed and saved successfully
[14:07:49] 🔄 
🔄 Step 8: Saving API details...
[14:07:49] [DOC: 9305201] ℹ️  API push details saved for document 9305201
[14:07:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305147                         ║
================================================================================
[14:07:49] ℹ️  Agency: Dartmouth HH
[14:07:49] ℹ️  Date: 05/21/2025
[14:07:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:52] [DOC: 9305147] ✅ Text extracted using pdfplumber (12525 chars)
[14:07:52] ✅    ✅ Text extracted using pdfplumber (12513 chars)
[14:07:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:56] ℹ️  AI extracted raw sex value: 'M'
[14:07:56] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[14:07:56] ℹ️  AI extracted payer source: 'None'
[14:07:56] ℹ️  AI extracted diagnoses:
[14:07:56] ℹ️    - Diagnosis 1: 'I12.9'
[14:07:56] ℹ️    - Diagnosis 2: 'E11.22'
[14:07:56] ℹ️    - Diagnosis 3: 'N18.30'
[14:07:56] ℹ️    - Diagnosis 4: 'I73.9'
[14:07:56] ℹ️    - Diagnosis 5: 'I70.213'
[14:07:56] ℹ️    - Diagnosis 6: 'I48.20'
[14:07:56] ℹ️  Final extracted MRN: '227027'
[14:07:56] ℹ️  Final extracted Sex: 'MALE'
[14:07:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[14:07:56] ℹ️  Final extracted Payer Source: ''
[14:07:56] ✅ Patient data extraction completed successfully
[14:07:56] ✅    ✅ Patient data extracted successfully
[14:07:56] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/15/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'N18.30', 'fourthDiagnosis': 'I73.9', 'fifthDiagnosis': 'I70.213', 'sixthDiagnosis': 'I48.20'}]
[14:07:56] ✅    ✅ Patient identified: Stephen Hanna Jr,
[14:07:56] ✅    ✅ Patient name validation passed
[14:07:56] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:56] [DOC: 9305147] ℹ️  DOB normalized: 03/11/1936
[14:07:56] [DOC: 9305147] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:07:56] [DOC: 9305147] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[14:07:56] [DOC: 9305147] ✅ Patient date processing completed successfully
[14:07:56] ✅    ✅ Date processing completed
[14:07:56] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'N18.30', 'fourthDiagnosis': 'I73.9', 'fifthDiagnosis': 'I70.213', 'sixthDiagnosis': 'I48.20'}]
[14:07:56] 🔄 
🔄 Step 4: Extracting order data...
[14:07:58] ℹ️  Order extraction - MRN: '227027'
[14:07:58] ℹ️  Order extraction - Sex: 'MALE'
[14:07:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:07:58] ℹ️  Order extraction - Payer Source: ''
[14:07:58] ✅ Order data extraction completed successfully
[14:07:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:58] ℹ️  Using MRN from patient data: '227027' over '227027'
[14:07:58] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[14:07:58] ✅ Patient name cross-validation successful
[14:07:58] ✅    ✅ Data merged successfully
[14:07:59] ✅    ✅ Order data extracted and validated
[14:07:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:59] [DOC: 9305147] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:07:59] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:07:59] 🔄 
🔄 Step 6: Pushing order to API...
[14:07:59] [DOC: 9305147] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:01] [DOC: 9305147] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:08:01] ❌    ❌ Failed to push order
[14:08:01] 🔄 
🔄 Step 7: Writing to CSV...
[14:08:01] [DOC: 9305147] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[14:08:01] [DOC: 9305147] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[14:08:01] [DOC: 9305147] ℹ️  Payer Source extracted: ''
[14:08:01] [DOC: 9305147] ℹ️  Diagnosis codes being written:
[14:08:01] [DOC: 9305147] ℹ️    - Latest_Episode_Firstdiagnosis: 'I12.9'
[14:08:01] [DOC: 9305147] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[14:08:01] [DOC: 9305147] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.30'
[14:08:01] [DOC: 9305147] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I73.9'
[14:08:01] [DOC: 9305147] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I70.213'
[14:08:01] [DOC: 9305147] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.20'
[14:08:01] [DOC: 9305147] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 227027
[14:08:01] ✅    ✅ Document 9305147 processed and saved successfully
[14:08:01] 🔄 
🔄 Step 8: Saving API details...
[14:08:01] [DOC: 9305147] ℹ️  API push details saved for document 9305147
[14:08:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305142                         ║
================================================================================
[14:08:01] ℹ️  Agency: Dartmouth HH
[14:08:01] ℹ️  Date: 05/21/2025
[14:08:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:05] [DOC: 9305142] ✅ Text extracted using pdfplumber (1145 chars)
[14:08:05] ✅    ✅ Text extracted using pdfplumber (1145 chars)
[14:08:05] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:08] ℹ️  AI extracted raw sex value: 'M'
[14:08:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:08:08] ℹ️  AI extracted payer source: 'Medicare'
[14:08:08] ℹ️  AI extracted diagnoses:
[14:08:08] ℹ️    - Diagnosis 1: 'None'
[14:08:08] ℹ️    - Diagnosis 2: 'None'
[14:08:08] ℹ️    - Diagnosis 3: 'None'
[14:08:08] ℹ️    - Diagnosis 4: 'None'
[14:08:08] ℹ️    - Diagnosis 5: 'None'
[14:08:08] ℹ️    - Diagnosis 6: 'None'
[14:08:08] ℹ️  Final extracted MRN: '6208015'
[14:08:08] ℹ️  Final extracted Sex: 'MALE'
[14:08:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:08:08] ℹ️  Final extracted Payer Source: 'Medicare'
[14:08:08] ✅ Patient data extraction completed successfully
[14:08:08] ✅    ✅ Patient data extracted successfully
[14:08:08] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:08:08] ✅    ✅ Patient identified: Stephen Hanna Jr,
[14:08:08] ✅    ✅ Patient name validation passed
[14:08:08] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:08] [DOC: 9305142] ℹ️  DOB normalized: 03/11/1936
[14:08:08] [DOC: 9305142] ℹ️  Episode startOfCare normalized: 03/15/2025
[14:08:08] [DOC: 9305142] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:08:08] [DOC: 9305142] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[14:08:08] [DOC: 9305142] ✅ Patient date processing completed successfully
[14:08:08] ✅    ✅ Date processing completed
[14:08:08] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025'}]
[14:08:08] 🔄 
🔄 Step 4: Extracting order data...
[14:08:10] ℹ️  Order extraction - MRN: ''
[14:08:10] ℹ️  Order extraction - Sex: 'MALE'
[14:08:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:08:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:08:10] ✅ Order data extraction completed successfully
[14:08:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:10] ℹ️  Using MRN from patient data: '6208015'
[14:08:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:08:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:08:10] ✅ Patient name cross-validation successful
[14:08:10] ✅    ✅ Data merged successfully
[14:08:12] ✅    ✅ Order data extracted and validated
[14:08:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:08:12] [DOC: 9305142] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:12] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:08:12] [DOC: 9305142] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:13] [DOC: 9305142] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13829"}
[14:08:13] ❌    ❌ Failed to push order
[14:08:13] 🔄 
🔄 Step 7: Writing to CSV...
[14:08:13] [DOC: 9305142] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[14:08:13] [DOC: 9305142] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:08:13] [DOC: 9305142] ℹ️  Payer Source extracted: 'Medicare'
[14:08:13] [DOC: 9305142] ℹ️  Diagnosis codes being written:
[14:08:13] [DOC: 9305142] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:08:13] [DOC: 9305142] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:08:13] [DOC: 9305142] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:08:13] [DOC: 9305142] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:08:13] [DOC: 9305142] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:08:13] [DOC: 9305142] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:08:13] [DOC: 9305142] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: Skilled Nursing | Payer: Medicare | MRN: 6208015
[14:08:13] ✅    ✅ Document 9305142 processed and saved successfully
[14:08:13] 🔄 
🔄 Step 8: Saving API details...
[14:08:13] [DOC: 9305142] ℹ️  API push details saved for document 9305142
[14:08:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305138                         ║
================================================================================
[14:08:13] ℹ️  Agency: Dartmouth HH
[14:08:13] ℹ️  Date: 05/21/2025
[14:08:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:15] [DOC: 9305138] ✅ Text extracted using pdfplumber (1445 chars)
[14:08:15] ✅    ✅ Text extracted using pdfplumber (1445 chars)
[14:08:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:18] ℹ️  AI extracted raw sex value: 'M'
[14:08:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:08:18] ℹ️  AI extracted payer source: 'Medicare'
[14:08:18] ℹ️  AI extracted diagnoses:
[14:08:18] ℹ️    - Diagnosis 1: ''
[14:08:18] ℹ️    - Diagnosis 2: ''
[14:08:18] ℹ️    - Diagnosis 3: ''
[14:08:18] ℹ️    - Diagnosis 4: ''
[14:08:18] ℹ️    - Diagnosis 5: ''
[14:08:18] ℹ️    - Diagnosis 6: ''
[14:08:18] ℹ️  Final extracted MRN: '6208015'
[14:08:18] ℹ️  Final extracted Sex: 'MALE'
[14:08:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:08:18] ℹ️  Final extracted Payer Source: 'Medicare'
[14:08:18] ✅ Patient data extraction completed successfully
[14:08:18] ✅    ✅ Patient data extracted successfully
[14:08:18] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:08:18] ✅    ✅ Patient identified: Stephen Hanna Jr,
[14:08:18] ✅    ✅ Patient name validation passed
[14:08:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:18] [DOC: 9305138] ℹ️  DOB normalized: 03/11/1936
[14:08:18] [DOC: 9305138] ℹ️  Episode startOfCare normalized: 03/15/2025
[14:08:18] [DOC: 9305138] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[14:08:18] [DOC: 9305138] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[14:08:18] [DOC: 9305138] ✅ Patient date processing completed successfully
[14:08:18] ✅    ✅ Date processing completed
[14:08:18] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:08:18] 🔄 
🔄 Step 4: Extracting order data...
[14:08:20] ℹ️  Order extraction - MRN: ''
[14:08:20] ℹ️  Order extraction - Sex: 'MALE'
[14:08:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:08:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:08:20] ✅ Order data extraction completed successfully
[14:08:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:20] ℹ️  Using MRN from patient data: '6208015'
[14:08:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:08:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:08:20] ✅ Patient name cross-validation successful
[14:08:20] ✅    ✅ Data merged successfully
[14:08:21] ✅    ✅ Order data extracted and validated
[14:08:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:08:21] [DOC: 9305138] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:21] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:21] 🔄 
🔄 Step 6: Pushing order to API...
[14:08:21] [DOC: 9305138] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:08:23] [DOC: 9305138] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:08:23] ❌    ❌ Failed to push order
[14:08:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:08:23] [DOC: 9305138] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[14:08:23] [DOC: 9305138] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:08:23] [DOC: 9305138] ℹ️  Payer Source extracted: 'Medicare'
[14:08:23] [DOC: 9305138] ℹ️  Diagnosis codes being written:
[14:08:23] [DOC: 9305138] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:08:23] [DOC: 9305138] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:08:23] [DOC: 9305138] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:08:23] [DOC: 9305138] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:08:23] [DOC: 9305138] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:08:23] [DOC: 9305138] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:08:23] [DOC: 9305138] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: Skilled Nursing | Payer: Medicare | MRN: 6208015
[14:08:23] ✅    ✅ Document 9305138 processed and saved successfully
[14:08:23] 🔄 
🔄 Step 8: Saving API details...
[14:08:23] [DOC: 9305138] ℹ️  API push details saved for document 9305138
[14:08:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305134                         ║
================================================================================
[14:08:23] ℹ️  Agency: Dartmouth HH
[14:08:23] ℹ️  Date: 05/21/2025
[14:08:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:26] [DOC: 9305134] ✅ Text extracted using pdfplumber (12909 chars)
[14:08:26] ✅    ✅ Text extracted using pdfplumber (12909 chars)
[14:08:26] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:29] ℹ️  AI extracted raw sex value: 'F'
[14:08:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:08:29] ℹ️  AI extracted payer source: 'None'
[14:08:29] ℹ️  AI extracted diagnoses:
[14:08:29] ℹ️    - Diagnosis 1: 'C34.92'
[14:08:29] ℹ️    - Diagnosis 2: 'C34.91'
[14:08:29] ℹ️    - Diagnosis 3: 'I11.0'
[14:08:29] ℹ️    - Diagnosis 4: 'I50.23'
[14:08:29] ℹ️    - Diagnosis 5: 'I25.5'
[14:08:29] ℹ️    - Diagnosis 6: 'I47.10'
[14:08:29] ℹ️  Final extracted MRN: '928015'
[14:08:29] ℹ️  Final extracted Sex: 'FEMALE'
[14:08:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:08:29] ℹ️  Final extracted Payer Source: ''
[14:08:29] ✅ Patient data extraction completed successfully
[14:08:29] ✅    ✅ Patient data extracted successfully
[14:08:29] 📊 Patient Response
     └─ patientFName: Graciani
     └─ patientLName: Erconida
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100015057845
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'C34.92', 'secondDiagnosis': 'C34.91', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.23', 'fifthDiagnosis': 'I25.5', 'sixthDiagnosis': 'I47.10'}]
[14:08:29] ✅    ✅ Patient identified: Graciani Erconida
[14:08:29] ✅    ✅ Patient name validation passed
[14:08:29] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:29] [DOC: 9305134] ℹ️  DOB normalized: 07/07/1940
[14:08:29] [DOC: 9305134] ℹ️  Episode startOfCare normalized: 01/09/2025
[14:08:29] [DOC: 9305134] ℹ️  Episode startOfEpisode normalized: 01/10/2025
[14:08:29] [DOC: 9305134] ℹ️  Episode endOfEpisode normalized: 07/08/2025
[14:08:29] [DOC: 9305134] ✅ Patient date processing completed successfully
[14:08:29] ✅    ✅ Date processing completed
[14:08:29] 📊 Processed Patient Data
     └─ patientFName: Graciani
     └─ patientLName: Erconida
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100015057845
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'C34.92', 'secondDiagnosis': 'C34.91', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.23', 'fifthDiagnosis': 'I25.5', 'sixthDiagnosis': 'I47.10'}]
[14:08:29] 🔄 
🔄 Step 4: Extracting order data...
[14:08:32] ℹ️  Order extraction - MRN: '928015'
[14:08:32] ℹ️  Order extraction - Sex: 'FEMALE'
[14:08:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[14:08:32] ℹ️  Order extraction - Payer Source: ''
[14:08:32] ✅ Order data extraction completed successfully
[14:08:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:32] ℹ️  Using MRN from patient data: '928015' over '928015'
[14:08:32] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[14:08:32] ✅ Patient name cross-validation successful
[14:08:32] ✅    ✅ Data merged successfully
[14:08:39] ✅    ✅ Order data extracted and validated
[14:08:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:08:46] [DOC: 9305134] ℹ️  Patient not found in cache or API: Graciani Erconida
[14:08:46] [DOC: 9305134] ℹ️  Patient not found, creating new patient via API...
[14:08:46] [DOC: 9305134] ℹ️  Creating patient via API: Graciani Erconida
[14:08:48] [DOC: 9305134] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:08:48] ❌    ❌ Failed to create patient
[14:08:48] [DOC: 9305134] ℹ️  API push details saved for document 9305134
================================================================================
║                        Processing Document ID: 9304177                         ║
================================================================================
[14:08:48] ℹ️  Agency: Dartmouth HH
[14:08:48] ℹ️  Date: 05/21/2025
[14:08:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:50] [DOC: 9304177] ✅ Text extracted using pdfplumber (1140 chars)
[14:08:50] ✅    ✅ Text extracted using pdfplumber (1140 chars)
[14:08:50] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:52] ℹ️  AI extracted raw sex value: 'M'
[14:08:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:08:52] ℹ️  AI extracted payer source: 'Medicare'
[14:08:52] ℹ️  AI extracted diagnoses:
[14:08:52] ℹ️    - Diagnosis 1: ''
[14:08:52] ℹ️    - Diagnosis 2: ''
[14:08:52] ℹ️    - Diagnosis 3: ''
[14:08:52] ℹ️    - Diagnosis 4: ''
[14:08:52] ℹ️    - Diagnosis 5: ''
[14:08:52] ℹ️    - Diagnosis 6: ''
[14:08:52] ℹ️  Final extracted MRN: '3745015'
[14:08:52] ℹ️  Final extracted Sex: 'MALE'
[14:08:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:08:52] ℹ️  Final extracted Payer Source: 'Medicare'
[14:08:52] ✅ Patient data extraction completed successfully
[14:08:52] ✅    ✅ Patient data extracted successfully
[14:08:52] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:08:52] ✅    ✅ Patient identified: Stanley Waters
[14:08:52] ✅    ✅ Patient name validation passed
[14:08:52] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:52] [DOC: 9304177] ℹ️  DOB normalized: 08/19/1941
[14:08:52] [DOC: 9304177] ℹ️  Episode startOfCare normalized: 03/13/2025
[14:08:52] [DOC: 9304177] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[14:08:52] [DOC: 9304177] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[14:08:52] [DOC: 9304177] ✅ Patient date processing completed successfully
[14:08:52] ✅    ✅ Date processing completed
[14:08:52] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:08:52] 🔄 
🔄 Step 4: Extracting order data...
[14:08:55] ℹ️  Order extraction - MRN: ''
[14:08:55] ℹ️  Order extraction - Sex: 'MALE'
[14:08:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:08:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:08:55] ✅ Order data extraction completed successfully
[14:08:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:55] ℹ️  Using MRN from patient data: '3745015'
[14:08:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:08:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:08:55] ✅ Patient name cross-validation successful
[14:08:55] ✅    ✅ Data merged successfully
[14:08:56] ✅    ✅ Order data extracted and validated
[14:08:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:09:04] [DOC: 9304177] ✅ Patient exists in API: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:09:04] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:09:04] 🔄 
🔄 Step 6: Pushing order to API...
[14:09:04] [DOC: 9304177] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:09:05] [DOC: 9304177] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:09:05] ❌    ❌ Failed to push order
[14:09:05] 🔄 
🔄 Step 7: Writing to CSV...
[14:09:05] [DOC: 9304177] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[14:09:05] [DOC: 9304177] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:09:05] [DOC: 9304177] ℹ️  Payer Source extracted: 'Medicare'
[14:09:05] [DOC: 9304177] ℹ️  Diagnosis codes being written:
[14:09:05] [DOC: 9304177] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:09:05] [DOC: 9304177] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:09:05] [DOC: 9304177] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:09:05] [DOC: 9304177] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:09:05] [DOC: 9304177] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:09:05] [DOC: 9304177] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:09:05] [DOC: 9304177] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 3745015
[14:09:05] ✅    ✅ Document 9304177 processed and saved successfully
[14:09:05] 🔄 
🔄 Step 8: Saving API details...
[14:09:05] [DOC: 9304177] ℹ️  API push details saved for document 9304177
[14:09:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9304176                         ║
================================================================================
[14:09:05] ℹ️  Agency: Dartmouth HH
[14:09:05] ℹ️  Date: 05/21/2025
[14:09:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:09:08] [DOC: 9304176] ✅ Text extracted using pdfplumber (13614 chars)
[14:09:08] ✅    ✅ Text extracted using pdfplumber (13602 chars)
[14:09:08] 🔄 
🔄 Step 2: Extracting patient data...
[14:09:12] ℹ️  AI extracted raw sex value: 'F'
[14:09:12] ℹ️  AI extracted service line: 'PT, OT'
[14:09:12] ℹ️  AI extracted payer source: ''
[14:09:12] ℹ️  AI extracted diagnoses:
[14:09:12] ℹ️    - Diagnosis 1: 'M79.10'
[14:09:12] ℹ️    - Diagnosis 2: 'G89.11'
[14:09:12] ℹ️    - Diagnosis 3: 'R29.6'
[14:09:12] ℹ️    - Diagnosis 4: 'J47.9'
[14:09:12] ℹ️    - Diagnosis 5: 'R91.1'
[14:09:12] ℹ️    - Diagnosis 6: 'M81.0'
[14:09:12] ℹ️  Final extracted MRN: '1259001'
[14:09:12] ℹ️  Final extracted Sex: 'FEMALE'
[14:09:12] ℹ️  Final extracted Service Line: 'PT, OT'
[14:09:12] ℹ️  Final extracted Payer Source: ''
[14:09:12] ✅ Patient data extraction completed successfully
[14:09:12] ✅    ✅ Patient data extracted successfully
[14:09:12] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Lombardo
     └─ dob: 02/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1259001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/12/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'M79.10', 'secondDiagnosis': 'G89.11', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'J47.9', 'fifthDiagnosis': 'R91.1', 'sixthDiagnosis': 'M81.0'}]
[14:09:12] ✅    ✅ Patient identified: Barbara Lombardo
[14:09:12] ✅    ✅ Patient name validation passed
[14:09:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:09:12] [DOC: 9304176] ℹ️  DOB normalized: 02/21/1941
[14:09:12] [DOC: 9304176] ℹ️  Episode startOfCare normalized: 05/12/2025
[14:09:12] [DOC: 9304176] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[14:09:12] [DOC: 9304176] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[14:09:12] [DOC: 9304176] ✅ Patient date processing completed successfully
[14:09:12] ✅    ✅ Date processing completed
[14:09:12] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Lombardo
     └─ dob: 02/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1259001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/12/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'M79.10', 'secondDiagnosis': 'G89.11', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'J47.9', 'fifthDiagnosis': 'R91.1', 'sixthDiagnosis': 'M81.0'}]
[14:09:12] 🔄 
🔄 Step 4: Extracting order data...
[14:09:14] ℹ️  Order extraction - MRN: '1259001'
[14:09:14] ℹ️  Order extraction - Sex: 'FEMALE'
[14:09:14] ℹ️  Order extraction - Service Line: 'PT, OT'
[14:09:14] ℹ️  Order extraction - Payer Source: ''
[14:09:14] ✅ Order data extraction completed successfully
[14:09:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:09:14] ℹ️  Using MRN from patient data: '1259001' over '1259001'
[14:09:14] ℹ️  Service line consistent in both sources: 'PT, OT'
[14:09:14] ✅ Patient name cross-validation successful
[14:09:14] ✅    ✅ Data merged successfully
[14:09:16] ✅    ✅ Order data extracted and validated
[14:09:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:09:16] [DOC: 9304176] ✅ Patient found in local cache: Barbara Lombardo, ID: e8867258-532b-4def-bc9b-3913c67672c2
[14:09:16] ✅    ✅ Existing patient found with ID: e8867258-532b-4def-bc9b-3913c67672c2
[14:09:16] 🔄 
🔄 Step 6: Pushing order to API...
[14:09:16] [DOC: 9304176] ℹ️  Pushing order via API for patient ID: e8867258-532b-4def-bc9b-3913c67672c2
[14:09:17] [DOC: 9304176] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:09:17] ❌    ❌ Failed to push order
[14:09:17] 🔄 
🔄 Step 7: Writing to CSV...
[14:09:17] [DOC: 9304176] ℹ️  Calculated age: 84 from DOB: 02/21/1941
[14:09:17] [DOC: 9304176] ℹ️  Service Line extracted: 'PT, OT'
[14:09:17] [DOC: 9304176] ℹ️  Payer Source extracted: ''
[14:09:17] [DOC: 9304176] ℹ️  Diagnosis codes being written:
[14:09:17] [DOC: 9304176] ℹ️    - Latest_Episode_Firstdiagnosis: 'M79.10'
[14:09:17] [DOC: 9304176] ℹ️    - Latest_Episode_Seconddiagnosis: 'G89.11'
[14:09:17] [DOC: 9304176] ℹ️    - Latest_Episode_Thirddiagnosis: 'R29.6'
[14:09:17] [DOC: 9304176] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J47.9'
[14:09:17] [DOC: 9304176] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R91.1'
[14:09:17] [DOC: 9304176] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M81.0'
[14:09:17] [DOC: 9304176] ✅ Patient data written to CSV: Barbara Lombardo | Sex: FEMALE | Age: 84 | Service: PT, OT | Payer:  | MRN: 1259001
[14:09:17] ✅    ✅ Document 9304176 processed and saved successfully
[14:09:17] 🔄 
🔄 Step 8: Saving API details...
[14:09:17] [DOC: 9304176] ℹ️  API push details saved for document 9304176
[14:09:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9304169                         ║
================================================================================
[14:09:17] ℹ️  Agency: Dartmouth HH
[14:09:17] ℹ️  Date: 05/21/2025
[14:09:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:09:22] [DOC: 9304169] ✅ Text extracted using pdfplumber (14471 chars)
[14:09:22] ✅    ✅ Text extracted using pdfplumber (14459 chars)
[14:09:22] 🔄 
🔄 Step 2: Extracting patient data...
[14:09:25] ℹ️  AI extracted raw sex value: 'M'
[14:09:25] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:09:25] ℹ️  AI extracted payer source: 'None'
[14:09:25] ℹ️  AI extracted diagnoses:
[14:09:25] ℹ️    - Diagnosis 1: 'L89.150'
[14:09:25] ℹ️    - Diagnosis 2: 'J44.9'
[14:09:25] ℹ️    - Diagnosis 3: 'L98.9'
[14:09:25] ℹ️    - Diagnosis 4: 'D64.9'
[14:09:25] ℹ️    - Diagnosis 5: 'R49.0'
[14:09:25] ℹ️    - Diagnosis 6: 'G90.09'
[14:09:25] ℹ️  Final extracted MRN: '3745015'
[14:09:25] ℹ️  Final extracted Sex: 'MALE'
[14:09:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:09:25] ℹ️  Final extracted Payer Source: ''
[14:09:25] ✅ Patient data extraction completed successfully
[14:09:25] ✅    ✅ Patient data extracted successfully
[14:09:25] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'L89.150', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'L98.9', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'R49.0', 'sixthDiagnosis': 'G90.09'}]
[14:09:25] ✅    ✅ Patient identified: Stanley Waters
[14:09:25] ✅    ✅ Patient name validation passed
[14:09:25] 🔄 
🔄 Step 3: Processing patient dates...
[14:09:25] [DOC: 9304169] ℹ️  DOB normalized: 08/19/1941
[14:09:25] [DOC: 9304169] ℹ️  Episode startOfCare normalized: 03/10/2025
[14:09:25] [DOC: 9304169] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[14:09:25] [DOC: 9304169] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[14:09:25] [DOC: 9304169] ✅ Patient date processing completed successfully
[14:09:25] ✅    ✅ Date processing completed
[14:09:25] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'L89.150', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'L98.9', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'R49.0', 'sixthDiagnosis': 'G90.09'}]
[14:09:25] 🔄 
🔄 Step 4: Extracting order data...
[14:09:28] ℹ️  Order extraction - MRN: '3745015'
[14:09:28] ℹ️  Order extraction - Sex: 'MALE'
[14:09:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Speech Therapy'
[14:09:28] ℹ️  Order extraction - Payer Source: ''
[14:09:28] ✅ Order data extraction completed successfully
[14:09:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:09:28] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[14:09:28] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Speech Therapy' + Order='Skilled Nursing,Speech Therapy' = 'Physical Therapy, Skilled Nursing, Speech Therapy'
[14:09:28] ✅ Patient name cross-validation successful
[14:09:28] ✅    ✅ Data merged successfully
[14:09:29] ✅    ✅ Order data extracted and validated
[14:09:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:09:29] [DOC: 9304169] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:09:29] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:09:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:09:29] [DOC: 9304169] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:09:30] [DOC: 9304169] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:09:30] ❌    ❌ Failed to push order
[14:09:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:09:30] [DOC: 9304169] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[14:09:30] [DOC: 9304169] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing, Speech Therapy'
[14:09:30] [DOC: 9304169] ℹ️  Payer Source extracted: ''
[14:09:30] [DOC: 9304169] ℹ️  Diagnosis codes being written:
[14:09:30] [DOC: 9304169] ℹ️    - Latest_Episode_Firstdiagnosis: 'L89.150'
[14:09:30] [DOC: 9304169] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[14:09:30] [DOC: 9304169] ℹ️    - Latest_Episode_Thirddiagnosis: 'L98.9'
[14:09:30] [DOC: 9304169] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D64.9'
[14:09:30] [DOC: 9304169] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R49.0'
[14:09:30] [DOC: 9304169] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G90.09'
[14:09:30] [DOC: 9304169] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Physical Therapy, Skilled Nursing, Speech Therapy | Payer:  | MRN: 3745015
[14:09:30] ✅    ✅ Document 9304169 processed and saved successfully
[14:09:30] 🔄 
🔄 Step 8: Saving API details...
[14:09:30] [DOC: 9304169] ℹ️  API push details saved for document 9304169
[14:09:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9304160                         ║
================================================================================
[14:09:30] ℹ️  Agency: Relief Home Health Services
[14:09:30] ℹ️  Date: 05/21/2025
[14:09:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:09:34] [DOC: 9304160] ✅ Text extracted using pdfplumber (2227 chars)
[14:09:34] ✅    ✅ Text extracted using pdfplumber (2227 chars)
[14:09:34] 🔄 
🔄 Step 2: Extracting patient data...
[14:09:37] ℹ️  AI extracted raw sex value: ''
[14:09:37] ℹ️  AI extracted service line: 'SNV'
[14:09:37] ℹ️  AI extracted payer source: ''
[14:09:37] ℹ️  AI extracted diagnoses:
[14:09:37] ℹ️    - Diagnosis 1: 'None'
[14:09:37] ℹ️    - Diagnosis 2: 'None'
[14:09:37] ℹ️    - Diagnosis 3: 'None'
[14:09:37] ℹ️    - Diagnosis 4: 'None'
[14:09:37] ℹ️    - Diagnosis 5: 'None'
[14:09:37] ℹ️    - Diagnosis 6: 'None'
[14:09:37] ℹ️  Final extracted MRN: ''
[14:09:37] ℹ️  Final extracted Sex: ''
[14:09:37] ℹ️  Final extracted Service Line: 'SNV'
[14:09:37] ℹ️  Final extracted Payer Source: ''
[14:09:37] ✅ Patient data extraction completed successfully
[14:09:37] ✅    ✅ Patient data extracted successfully
[14:09:37] 📊 Patient Response
     └─ patientFName: SUSAN
     └─ patientLName: RAMOS
     └─ dob: 11/03/1957
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: KARINE MAALOUF KALESHIAN, MD
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 531 Faunce Corner Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: SNV
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/20/2022', 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:09:37] ✅    ✅ Patient identified: SUSAN RAMOS
[14:09:37] ✅    ✅ Patient name validation passed
[14:09:37] 🔄 
🔄 Step 3: Processing patient dates...
[14:09:37] [DOC: 9304160] ℹ️  DOB normalized: 11/03/1957
[14:09:37] [DOC: 9304160] ℹ️  Episode startOfCare normalized: 09/20/2022
[14:09:37] [DOC: 9304160] ✅ Patient date processing completed successfully
[14:09:37] ✅    ✅ Date processing completed
[14:09:37] 📊 Processed Patient Data
     └─ patientFName: SUSAN
     └─ patientLName: RAMOS
     └─ dob: 11/03/1957
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: KARINE MAALOUF KALESHIAN, MD
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 531 Faunce Corner Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: SNV
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/20/2022'}]
[14:09:37] 🔄 
🔄 Step 4: Extracting order data...
[14:09:39] ℹ️  Order extraction - MRN: ''
[14:09:39] ℹ️  Order extraction - Sex: ''
[14:09:39] ℹ️  Order extraction - Service Line: 'SNV'
[14:09:39] ℹ️  Order extraction - Payer Source: ''
[14:09:39] ✅ Order data extraction completed successfully
[14:09:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:09:39] ⚠️  No MRN found in either patient or order data
[14:09:39] ℹ️  Inferred sex as FEMALE from name: SUSAN
[14:09:39] ℹ️  Service line consistent in both sources: 'SNV'
[14:09:39] ✅ Patient name cross-validation successful
[14:09:39] ✅    ✅ Data merged successfully
[14:09:40] ✅    ✅ Order data extracted and validated
[14:09:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:09:48] [DOC: 9304160] ℹ️  Patient not found in cache or API: SUSAN RAMOS
[14:09:48] [DOC: 9304160] ℹ️  Patient not found, creating new patient via API...
[14:09:48] [DOC: 9304160] ℹ️  Creating patient via API: SUSAN RAMOS
[14:09:49] [DOC: 9304160] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:09:49] ❌    ❌ Failed to create patient
[14:09:49] [DOC: 9304160] ℹ️  API push details saved for document 9304160
================================================================================
║                        Processing Document ID: 9304088                         ║
================================================================================
[14:09:49] ℹ️  Agency: Visiting Rehab & Nursing Services
[14:09:49] ℹ️  Date: 05/21/2025
[14:09:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:09:52] [DOC: 9304088] ✅ Text extracted using pdfplumber (1368 chars)
[14:09:52] ✅    ✅ Text extracted using pdfplumber (1356 chars)
[14:09:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:09:55] ℹ️  AI extracted raw sex value: ''
[14:09:55] ℹ️  AI extracted service line: 'Home health services'
[14:09:55] ℹ️  AI extracted payer source: ''
[14:09:55] ℹ️  AI extracted diagnoses:
[14:09:55] ℹ️    - Diagnosis 1: 'M51.16'
[14:09:55] ℹ️    - Diagnosis 2: 'G89.4'
[14:09:55] ℹ️    - Diagnosis 3: 'M51.14'
[14:09:55] ℹ️    - Diagnosis 4: 'None'
[14:09:55] ℹ️    - Diagnosis 5: 'None'
[14:09:55] ℹ️    - Diagnosis 6: 'None'
[14:09:55] ℹ️  Final extracted MRN: 'brSWH003'
[14:09:55] ℹ️  Final extracted Sex: ''
[14:09:55] ℹ️  Final extracted Service Line: 'Home health services'
[14:09:55] ℹ️  Final extracted Payer Source: ''
[14:09:55] ✅ Patient data extraction completed successfully
[14:09:55] ✅    ✅ Patient data extracted successfully
[14:09:55] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: St. Jacques
     └─ dob: 07/18/1941
     └─ patientSex: 
     └─ medicalRecordNo: brSWH003
     └─ billingProvider: June Rodrigues NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: 
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (508) 994-2106
     └─ serviceLine: Home health services
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'M51.16', 'secondDiagnosis': 'G89.4', 'thirdDiagnosis': 'M51.14', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:09:55] ✅    ✅ Patient identified: Elizabeth St. Jacques
[14:09:55] ✅    ✅ Patient name validation passed
[14:09:55] 🔄 
🔄 Step 3: Processing patient dates...
[14:09:55] [DOC: 9304088] ℹ️  DOB normalized: 07/18/1941
[14:09:55] [DOC: 9304088] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[14:09:55] [DOC: 9304088] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[14:09:55] [DOC: 9304088] ✅ Patient date processing completed successfully
[14:09:55] ✅    ✅ Date processing completed
[14:09:55] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: St. Jacques
     └─ dob: 07/18/1941
     └─ patientSex: 
     └─ medicalRecordNo: brSWH003
     └─ billingProvider: June Rodrigues NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: 
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (508) 994-2106
     └─ serviceLine: Home health services
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'M51.16', 'secondDiagnosis': 'G89.4', 'thirdDiagnosis': 'M51.14'}]
[14:09:55] 🔄 
🔄 Step 4: Extracting order data...
[14:09:57] ℹ️  Order extraction - MRN: 'brSWH003'
[14:09:57] ℹ️  Order extraction - Sex: ''
[14:09:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:09:57] ℹ️  Order extraction - Payer Source: ''
[14:09:57] ✅ Order data extraction completed successfully
[14:09:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:09:57] ℹ️  Using MRN from patient data: 'brSWH003' over 'brSWH003'
[14:09:57] ℹ️  Inferred sex as FEMALE from name: Elizabeth
[14:09:57] ℹ️  Combined service lines: Patient='Home health services' + Order='Skilled Nursing' = 'Home health services, Skilled Nursing'
[14:09:57] ✅ Patient name cross-validation successful
[14:09:57] ✅    ✅ Data merged successfully
[14:09:58] ✅    ✅ Order data extracted and validated
[14:09:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:10:09] [DOC: 9304088] ℹ️  Patient not found in cache or API: Elizabeth St. Jacques
[14:10:09] [DOC: 9304088] ℹ️  Patient not found, creating new patient via API...
[14:10:09] [DOC: 9304088] ℹ️  Creating patient via API: Elizabeth St. Jacques
[14:10:10] [DOC: 9304088] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:10:10] ❌    ❌ Failed to create patient
[14:10:10] [DOC: 9304088] ℹ️  API push details saved for document 9304088
================================================================================
║                        Processing Document ID: 9304087                         ║
================================================================================
[14:10:10] ℹ️  Agency: Visiting Rehab & Nursing Services
[14:10:10] ℹ️  Date: 05/21/2025
[14:10:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:10:14] [DOC: 9304087] ✅ Text extracted using pdfplumber (1024 chars)
[14:10:14] ✅    ✅ Text extracted using pdfplumber (1012 chars)
[14:10:14] 🔄 
🔄 Step 2: Extracting patient data...
[14:10:16] ℹ️  AI extracted raw sex value: ''
[14:10:16] ℹ️  AI extracted service line: 'Rehab'
[14:10:16] ℹ️  AI extracted payer source: ''
[14:10:16] ℹ️  AI extracted diagnoses:
[14:10:16] ℹ️    - Diagnosis 1: 'M51.16'
[14:10:16] ℹ️    - Diagnosis 2: 'G89.4'
[14:10:16] ℹ️    - Diagnosis 3: 'M51.14'
[14:10:16] ℹ️    - Diagnosis 4: ''
[14:10:16] ℹ️    - Diagnosis 5: ''
[14:10:16] ℹ️    - Diagnosis 6: ''
[14:10:16] ℹ️  Final extracted MRN: 'brSWH003'
[14:10:16] ℹ️  Final extracted Sex: ''
[14:10:16] ℹ️  Final extracted Service Line: 'Rehab'
[14:10:16] ℹ️  Final extracted Payer Source: ''
[14:10:16] ✅ Patient data extraction completed successfully
[14:10:16] ✅    ✅ Patient data extracted successfully
[14:10:16] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: St. Jacques
     └─ dob: 07/18/1941
     └─ patientSex: 
     └─ medicalRecordNo: brSWH003
     └─ billingProvider: June Rodrigues NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: Rehab
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'M51.16', 'secondDiagnosis': 'G89.4', 'thirdDiagnosis': 'M51.14', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:10:16] ✅    ✅ Patient identified: Elizabeth St. Jacques
[14:10:16] ✅    ✅ Patient name validation passed
[14:10:16] 🔄 
🔄 Step 3: Processing patient dates...
[14:10:16] [DOC: 9304087] ℹ️  DOB normalized: 07/18/1941
[14:10:16] [DOC: 9304087] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[14:10:16] [DOC: 9304087] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[14:10:16] [DOC: 9304087] ✅ Patient date processing completed successfully
[14:10:16] ✅    ✅ Date processing completed
[14:10:16] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: St. Jacques
     └─ dob: 07/18/1941
     └─ patientSex: 
     └─ medicalRecordNo: brSWH003
     └─ billingProvider: June Rodrigues NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: Rehab
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'M51.16', 'secondDiagnosis': 'G89.4', 'thirdDiagnosis': 'M51.14', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:10:16] 🔄 
🔄 Step 4: Extracting order data...
[14:10:19] ℹ️  Order extraction - MRN: 'brSWH003'
[14:10:19] ℹ️  Order extraction - Sex: ''
[14:10:19] ℹ️  Order extraction - Service Line: 'Rehab and Nursing'
[14:10:19] ℹ️  Order extraction - Payer Source: ''
[14:10:19] ✅ Order data extraction completed successfully
[14:10:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:10:19] ℹ️  Using MRN from patient data: 'brSWH003' over 'brSWH003'
[14:10:19] ℹ️  Inferred sex as FEMALE from name: Elizabeth
[14:10:19] ℹ️  Combined service lines: Patient='Rehab' + Order='Rehab and Nursing' = 'Rehab, Rehab and Nursing'
[14:10:19] ✅ Patient name cross-validation successful
[14:10:19] ✅    ✅ Data merged successfully
[14:10:20] ✅    ✅ Order data extracted and validated
[14:10:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:11:00] [DOC: 9304087] ℹ️  Patient not found in cache or API: Elizabeth St. Jacques
[14:11:00] [DOC: 9304087] ℹ️  Patient not found, creating new patient via API...
[14:11:00] [DOC: 9304087] ℹ️  Creating patient via API: Elizabeth St. Jacques
[14:11:02] [DOC: 9304087] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:11:02] ❌    ❌ Failed to create patient
[14:11:02] [DOC: 9304087] ℹ️  API push details saved for document 9304087
================================================================================
║                        Processing Document ID: 2178125                         ║
================================================================================
[14:11:02] ℹ️  Agency: Visiting Rehab & Nursing Services
[14:11:02] ℹ️  Date: 05/20/2025
[14:11:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:03] [DOC: 2178125] ❌ Critical failure in get_pdf_text: Invalid response format
[14:11:03] ❌ Failed to extract text for Doc ID 2178125
[14:11:03] [DOC: 2178125] ℹ️  API push details saved for document 2178125
================================================================================
║                        Processing Document ID: 9303106                         ║
================================================================================
[14:11:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:11:03] ℹ️  Date: 05/20/2025
[14:11:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:09] [DOC: 9303106] ✅ Text extracted using pdfplumber (33391 chars)
[14:11:09] ✅    ✅ Text extracted using pdfplumber (33381 chars)
[14:11:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:11:12] ℹ️  AI extracted raw sex value: 'F'
[14:11:12] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[14:11:12] ℹ️  AI extracted payer source: ''
[14:11:12] ℹ️  AI extracted diagnoses:
[14:11:12] ℹ️    - Diagnosis 1: 'I69.354'
[14:11:12] ℹ️    - Diagnosis 2: 'I69.322'
[14:11:12] ℹ️    - Diagnosis 3: 'M24.542'
[14:11:12] ℹ️    - Diagnosis 4: 'E11.42'
[14:11:12] ℹ️    - Diagnosis 5: 'I10'
[14:11:12] ℹ️    - Diagnosis 6: 'F32.A'
[14:11:12] ℹ️  Final extracted MRN: '2476336'
[14:11:12] ℹ️  Final extracted Sex: 'FEMALE'
[14:11:12] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[14:11:12] ℹ️  Final extracted Payer Source: ''
[14:11:12] ✅ Patient data extraction completed successfully
[14:11:12] ✅    ✅ Patient data extracted successfully
[14:11:12] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Fletcher
     └─ dob: 03/28/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2476336
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'I69.322', 'thirdDiagnosis': 'M24.542', 'fourthDiagnosis': 'E11.42', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F32.A'}]
[14:11:12] ✅    ✅ Patient identified: Kathleen Fletcher
[14:11:12] ✅    ✅ Patient name validation passed
[14:11:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:11:12] [DOC: 9303106] ℹ️  DOB normalized: 03/28/1945
[14:11:12] [DOC: 9303106] ℹ️  Episode startOfCare normalized: 05/02/2025
[14:11:12] [DOC: 9303106] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[14:11:12] [DOC: 9303106] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[14:11:12] [DOC: 9303106] ✅ Patient date processing completed successfully
[14:11:12] ✅    ✅ Date processing completed
[14:11:12] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Fletcher
     └─ dob: 03/28/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2476336
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'I69.322', 'thirdDiagnosis': 'M24.542', 'fourthDiagnosis': 'E11.42', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F32.A'}]
[14:11:12] 🔄 
🔄 Step 4: Extracting order data...
[14:11:15] ℹ️  Order extraction - MRN: '2476336'
[14:11:15] ℹ️  Order extraction - Sex: 'FEMALE'
[14:11:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[14:11:15] ℹ️  Order extraction - Payer Source: ''
[14:11:15] ✅ Order data extraction completed successfully
[14:11:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:11:15] ℹ️  Using MRN from patient data: '2476336' over '2476336'
[14:11:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[14:11:15] ✅ Patient name cross-validation successful
[14:11:15] ✅    ✅ Data merged successfully
[14:11:17] ✅    ✅ Order data extracted and validated
[14:11:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:11:17] [DOC: 9303106] ✅ Patient found in local cache: Kathleen Fletcher, ID: 8d503e74-0fe5-45d3-8f98-cb96855a3cd5
[14:11:17] ✅    ✅ Existing patient found with ID: 8d503e74-0fe5-45d3-8f98-cb96855a3cd5
[14:11:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:11:17] [DOC: 9303106] ℹ️  Pushing order via API for patient ID: 8d503e74-0fe5-45d3-8f98-cb96855a3cd5
[14:11:19] [DOC: 9303106] ❌ Order push failed with status 201: {"id":"2cb8f2bf-3e81-4977-b059-bbd05a7335c7","orderWAVId":"ORD19947","orderNo":"1093210","orderDate":"05/19/2025","startOfCare":"05/02/2025","episodeStartDate":"05/03/2025","episodeEndDate":"07/01/2025","documentID":"9303106","mrn":"2476336","patientName":"Fletcher,Kathleen","sentToPhysicianDate":"05/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"8d503e74-0fe5-45d3-8f98-cb96855a3cd5","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:11:19] ❌    ❌ Failed to push order
[14:11:19] 🔄 
🔄 Step 7: Writing to CSV...
[14:11:19] [DOC: 9303106] ℹ️  Calculated age: 80 from DOB: 03/28/1945
[14:11:19] [DOC: 9303106] ℹ️  Service Line extracted: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology'
[14:11:19] [DOC: 9303106] ℹ️  Payer Source extracted: ''
[14:11:19] [DOC: 9303106] ℹ️  Diagnosis codes being written:
[14:11:19] [DOC: 9303106] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[14:11:19] [DOC: 9303106] ℹ️    - Latest_Episode_Seconddiagnosis: 'I69.322'
[14:11:19] [DOC: 9303106] ℹ️    - Latest_Episode_Thirddiagnosis: 'M24.542'
[14:11:19] [DOC: 9303106] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.42'
[14:11:19] [DOC: 9303106] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[14:11:19] [DOC: 9303106] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.A'
[14:11:19] [DOC: 9303106] ✅ Patient data written to CSV: Kathleen Fletcher | Sex: FEMALE | Age: 80 | Service: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology | Payer:  | MRN: 2476336
[14:11:19] ✅    ✅ Document 9303106 processed and saved successfully
[14:11:19] 🔄 
🔄 Step 8: Saving API details...
[14:11:19] [DOC: 9303106] ℹ️  API push details saved for document 9303106
[14:11:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9302028                         ║
================================================================================
[14:11:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:11:19] ℹ️  Date: 05/20/2025
[14:11:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:23] [DOC: 9302028] ✅ Text extracted using pdfplumber (15216 chars)
[14:11:23] ✅    ✅ Text extracted using pdfplumber (15216 chars)
[14:11:23] 🔄 
🔄 Step 2: Extracting patient data...
[14:11:26] ℹ️  AI extracted raw sex value: 'F'
[14:11:26] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[14:11:26] ℹ️  AI extracted payer source: 'Medicare'
[14:11:26] ℹ️  AI extracted diagnoses:
[14:11:26] ℹ️    - Diagnosis 1: 'N39.0'
[14:11:26] ℹ️    - Diagnosis 2: 'G93.41'
[14:11:26] ℹ️    - Diagnosis 3: 'R44.3'
[14:11:26] ℹ️    - Diagnosis 4: 'R33.8'
[14:11:26] ℹ️    - Diagnosis 5: 'R41.89'
[14:11:26] ℹ️    - Diagnosis 6: 'N40.1'
[14:11:26] ℹ️  Final extracted MRN: 'MA220425084103'
[14:11:26] ℹ️  Final extracted Sex: 'FEMALE'
[14:11:26] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[14:11:26] ℹ️  Final extracted Payer Source: 'Medicare'
[14:11:26] ✅ Patient data extraction completed successfully
[14:11:26] ✅    ✅ Patient data extracted successfully
[14:11:26] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 1881923936
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': 'R33.8', 'fifthDiagnosis': 'R41.89', 'sixthDiagnosis': 'N40.1'}]
[14:11:26] ✅    ✅ Patient identified: Carlos Camara
[14:11:26] ✅    ✅ Patient name validation passed
[14:11:26] 🔄 
🔄 Step 3: Processing patient dates...
[14:11:26] [DOC: 9302028] ℹ️  DOB normalized: 08/08/1941
[14:11:26] [DOC: 9302028] ℹ️  Episode startOfCare normalized: 11/07/2024
[14:11:26] [DOC: 9302028] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:11:26] [DOC: 9302028] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:11:26] [DOC: 9302028] ✅ Patient date processing completed successfully
[14:11:26] ✅    ✅ Date processing completed
[14:11:26] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 1881923936
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': 'R33.8', 'fifthDiagnosis': 'R41.89', 'sixthDiagnosis': 'N40.1'}]
[14:11:26] 🔄 
🔄 Step 4: Extracting order data...
[14:11:29] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:11:29] ℹ️  Order extraction - Sex: 'FEMALE'
[14:11:29] ℹ️  Order extraction - Service Line: 'PT, OT'
[14:11:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:11:29] ✅ Order data extraction completed successfully
[14:11:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:11:29] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:11:29] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[14:11:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:11:29] ✅ Patient name cross-validation successful
[14:11:29] ✅    ✅ Data merged successfully
[14:11:31] ✅    ✅ Order data extracted and validated
[14:11:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:11:38] [DOC: 9302028] ✅ Patient exists in API: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:11:38] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:11:38] 🔄 
🔄 Step 6: Pushing order to API...
[14:11:38] [DOC: 9302028] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:11:40] [DOC: 9302028] ❌ Order push failed with status 201: {"id":"5c9bfa75-d6b2-4863-a7fe-d24fdfb4b18b","orderWAVId":"ORD19948","orderNo":"1281200747","orderDate":"06/04/2025","startOfCare":"11/07/2024","episodeStartDate":"05/06/2025","episodeEndDate":"07/04/2025","documentID":"9302028","mrn":"MA220425084103","patientName":"Camara, Carlos","sentToPhysicianDate":"05/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/04/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Home Health Certification and Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"16e2744a-5e38-4445-8968-fe8ad953d698","companyId":"b2d6c486-d448-45bc-91ac-8e3e898a1620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:11:40] ❌    ❌ Failed to push order
[14:11:40] 🔄 
🔄 Step 7: Writing to CSV...
[14:11:40] [DOC: 9302028] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:11:40] [DOC: 9302028] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[14:11:40] [DOC: 9302028] ℹ️  Payer Source extracted: 'Medicare'
[14:11:40] [DOC: 9302028] ℹ️  Diagnosis codes being written:
[14:11:40] [DOC: 9302028] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[14:11:40] [DOC: 9302028] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[14:11:40] [DOC: 9302028] ℹ️    - Latest_Episode_Thirddiagnosis: 'R44.3'
[14:11:40] [DOC: 9302028] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R33.8'
[14:11:40] [DOC: 9302028] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R41.89'
[14:11:40] [DOC: 9302028] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[14:11:40] [DOC: 9302028] ✅ Patient data written to CSV: Carlos Camara | Sex: FEMALE | Age: 83 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: MA220425084103
[14:11:40] ✅    ✅ Document 9302028 processed and saved successfully
[14:11:40] 🔄 
🔄 Step 8: Saving API details...
[14:11:40] [DOC: 9302028] ℹ️  API push details saved for document 9302028
[14:11:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9301992                         ║
================================================================================
[14:11:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:11:40] ℹ️  Date: 05/20/2025
[14:11:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:45] [DOC: 9301992] ✅ Text extracted using pdfplumber (16289 chars)
[14:11:45] ✅    ✅ Text extracted using pdfplumber (16277 chars)
[14:11:45] 🔄 
🔄 Step 2: Extracting patient data...
[14:11:48] ℹ️  AI extracted raw sex value: 'F'
[14:11:48] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[14:11:48] ℹ️  AI extracted payer source: 'Medicare'
[14:11:48] ℹ️  AI extracted diagnoses:
[14:11:48] ℹ️    - Diagnosis 1: 'S42.201'
[14:11:48] ℹ️    - Diagnosis 2: 'M19.011'
[14:11:48] ℹ️    - Diagnosis 3: 'E03.9'
[14:11:48] ℹ️    - Diagnosis 4: 'E78.5'
[14:11:48] ℹ️    - Diagnosis 5: 'J84.10'
[14:11:48] ℹ️    - Diagnosis 6: 'I10'
[14:11:48] ℹ️  Final extracted MRN: 'MA250311063603'
[14:11:48] ℹ️  Final extracted Sex: 'FEMALE'
[14:11:48] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[14:11:48] ℹ️  Final extracted Payer Source: 'Medicare'
[14:11:48] ✅ Patient data extraction completed successfully
[14:11:48] ✅    ✅ Patient data extracted successfully
[14:11:48] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 789-4352
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'S42.201', 'secondDiagnosis': 'M19.011', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'J84.10', 'sixthDiagnosis': 'I10'}]
[14:11:48] ✅    ✅ Patient identified: Maria Demelo
[14:11:48] ✅    ✅ Patient name validation passed
[14:11:48] 🔄 
🔄 Step 3: Processing patient dates...
[14:11:48] [DOC: 9301992] ℹ️  DOB normalized: 06/13/1936
[14:11:48] [DOC: 9301992] ℹ️  Episode startOfCare normalized: 03/13/2025
[14:11:48] [DOC: 9301992] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[14:11:48] [DOC: 9301992] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[14:11:48] [DOC: 9301992] ✅ Patient date processing completed successfully
[14:11:48] ✅    ✅ Date processing completed
[14:11:48] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 789-4352
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'S42.201', 'secondDiagnosis': 'M19.011', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'J84.10', 'sixthDiagnosis': 'I10'}]
[14:11:48] 🔄 
🔄 Step 4: Extracting order data...
[14:11:51] ℹ️  Order extraction - MRN: 'MA250311063603'
[14:11:51] ℹ️  Order extraction - Sex: 'FEMALE'
[14:11:51] ℹ️  Order extraction - Service Line: 'PT, OT'
[14:11:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:11:51] ✅ Order data extraction completed successfully
[14:11:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:11:51] ℹ️  Using MRN from patient data: 'MA250311063603' over 'MA250311063603'
[14:11:51] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[14:11:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:11:51] ✅ Patient name cross-validation successful
[14:11:51] ✅    ✅ Data merged successfully
[14:11:53] ✅    ✅ Order data extracted and validated
[14:11:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:35] [DOC: 9301992] ℹ️  Patient not found in cache or API: Maria Demelo
[14:12:35] [DOC: 9301992] ℹ️  Patient not found, creating new patient via API...
[14:12:35] [DOC: 9301992] ℹ️  Creating patient via API: Maria Demelo
[14:12:37] [DOC: 9301992] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:12:37] ❌    ❌ Failed to create patient
[14:12:37] [DOC: 9301992] ℹ️  API push details saved for document 9301992
================================================================================
║                        Processing Document ID: 9301667                         ║
================================================================================
[14:12:37] ℹ️  Agency: Fairhaven HH&H
[14:12:37] ℹ️  Date: 05/20/2025
[14:12:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:39] [DOC: 9301667] ✅ Text extracted using pdfplumber (1166 chars)
[14:12:39] ✅    ✅ Text extracted using pdfplumber (1166 chars)
[14:12:39] 🔄 
🔄 Step 2: Extracting patient data...
[14:12:42] ℹ️  AI extracted raw sex value: 'F'
[14:12:42] ℹ️  AI extracted service line: 'Hospice'
[14:12:42] ℹ️  AI extracted payer source: 'Medicare'
[14:12:42] ℹ️  AI extracted diagnoses:
[14:12:42] ℹ️    - Diagnosis 1: ''
[14:12:42] ℹ️    - Diagnosis 2: ''
[14:12:42] ℹ️    - Diagnosis 3: ''
[14:12:42] ℹ️    - Diagnosis 4: ''
[14:12:42] ℹ️    - Diagnosis 5: ''
[14:12:42] ℹ️    - Diagnosis 6: ''
[14:12:42] ℹ️  Final extracted MRN: '2406002'
[14:12:42] ℹ️  Final extracted Sex: 'FEMALE'
[14:12:42] ℹ️  Final extracted Service Line: 'Hospice'
[14:12:42] ℹ️  Final extracted Payer Source: 'Medicare'
[14:12:42] ✅ Patient data extraction completed successfully
[14:12:42] ✅    ✅ Patient data extracted successfully
[14:12:42] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:42] ✅    ✅ Patient identified: Patricia Lobo
[14:12:42] ✅    ✅ Patient name validation passed
[14:12:42] 🔄 
🔄 Step 3: Processing patient dates...
[14:12:42] [DOC: 9301667] ℹ️  DOB normalized: 02/06/1938
[14:12:42] [DOC: 9301667] ℹ️  Episode startOfCare normalized: 06/05/2024
[14:12:42] [DOC: 9301667] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[14:12:42] [DOC: 9301667] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[14:12:42] [DOC: 9301667] ✅ Patient date processing completed successfully
[14:12:42] ✅    ✅ Date processing completed
[14:12:42] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:42] 🔄 
🔄 Step 4: Extracting order data...
[14:12:44] ℹ️  Order extraction - MRN: ''
[14:12:44] ℹ️  Order extraction - Sex: 'FEMALE'
[14:12:44] ℹ️  Order extraction - Service Line: 'Hospice'
[14:12:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:12:44] ✅ Order data extraction completed successfully
[14:12:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:44] ℹ️  Using MRN from patient data: '2406002'
[14:12:44] ℹ️  Service line consistent in both sources: 'Hospice'
[14:12:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:12:44] ✅ Patient name cross-validation successful
[14:12:44] ✅    ✅ Data merged successfully
[14:12:46] ✅    ✅ Order data extracted and validated
[14:12:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:13:13] [DOC: 9301667] ✅ Patient exists in API: Patricia Lobo, ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[14:13:13] ✅    ✅ Existing patient found with ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[14:13:13] 🔄 
🔄 Step 6: Pushing order to API...
[14:13:13] [DOC: 9301667] ℹ️  Pushing order via API for patient ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[14:13:14] [DOC: 9301667] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13949"}
[14:13:14] ❌    ❌ Failed to push order
[14:13:14] 🔄 
🔄 Step 7: Writing to CSV...
[14:13:14] [DOC: 9301667] ℹ️  Calculated age: 87 from DOB: 02/06/1938
[14:13:14] [DOC: 9301667] ℹ️  Service Line extracted: 'Hospice'
[14:13:14] [DOC: 9301667] ℹ️  Payer Source extracted: 'Medicare'
[14:13:14] [DOC: 9301667] ℹ️  Diagnosis codes being written:
[14:13:14] [DOC: 9301667] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:13:14] [DOC: 9301667] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:13:14] [DOC: 9301667] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:13:14] [DOC: 9301667] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:13:14] [DOC: 9301667] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:13:14] [DOC: 9301667] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:13:14] [DOC: 9301667] ✅ Patient data written to CSV: Patricia Lobo | Sex: FEMALE | Age: 87 | Service: Hospice | Payer: Medicare | MRN: 2406002
[14:13:14] ✅    ✅ Document 9301667 processed and saved successfully
[14:13:14] 🔄 
🔄 Step 8: Saving API details...
[14:13:14] [DOC: 9301667] ℹ️  API push details saved for document 9301667
[14:13:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9301620                         ║
================================================================================
[14:13:14] ℹ️  Agency: Dartmouth HH
[14:13:14] ℹ️  Date: 05/20/2025
[14:13:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:13:18] [DOC: 9301620] ✅ Text extracted using pdfplumber (7752 chars)
[14:13:18] ✅    ✅ Text extracted using pdfplumber (7752 chars)
[14:13:18] 🔄 
🔄 Step 2: Extracting patient data...
[14:13:20] ℹ️  AI extracted raw sex value: 'F'
[14:13:20] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:13:20] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:13:20] ℹ️  AI extracted diagnoses:
[14:13:20] ℹ️    - Diagnosis 1: ''
[14:13:20] ℹ️    - Diagnosis 2: ''
[14:13:20] ℹ️    - Diagnosis 3: ''
[14:13:20] ℹ️    - Diagnosis 4: ''
[14:13:20] ℹ️    - Diagnosis 5: ''
[14:13:20] ℹ️    - Diagnosis 6: ''
[14:13:20] ℹ️  Final extracted MRN: '1508015'
[14:13:20] ℹ️  Final extracted Sex: 'FEMALE'
[14:13:20] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:13:20] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:13:20] ✅ Patient data extraction completed successfully
[14:13:20] ✅    ✅ Patient data extracted successfully
[14:13:20] 📊 Patient Response
     └─ patientFName: Paula
     └─ patientLName: Hatch
     └─ dob: 06/22/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1508015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2024', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:13:20] ✅    ✅ Patient identified: Paula Hatch
[14:13:20] ✅    ✅ Patient name validation passed
[14:13:20] 🔄 
🔄 Step 3: Processing patient dates...
[14:13:20] [DOC: 9301620] ℹ️  DOB normalized: 06/22/1940
[14:13:20] [DOC: 9301620] ℹ️  Episode startOfCare normalized: 03/23/2024
[14:13:20] [DOC: 9301620] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[14:13:20] [DOC: 9301620] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[14:13:20] [DOC: 9301620] ✅ Patient date processing completed successfully
[14:13:20] ✅    ✅ Date processing completed
[14:13:20] 📊 Processed Patient Data
     └─ patientFName: Paula
     └─ patientLName: Hatch
     └─ dob: 06/22/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1508015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2024', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:13:20] 🔄 
🔄 Step 4: Extracting order data...
[14:13:23] ℹ️  Order extraction - MRN: ''
[14:13:23] ℹ️  Order extraction - Sex: 'FEMALE'
[14:13:23] ℹ️  Order extraction - Service Line: 'OT'
[14:13:23] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:13:23] ✅ Order data extraction completed successfully
[14:13:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:13:23] ℹ️  Using MRN from patient data: '1508015'
[14:13:23] ℹ️  Combined service lines: Patient='Occupational Therapy' + Order='OT' = 'OT, Occupational Therapy'
[14:13:23] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:13:23] ✅ Patient name cross-validation successful
[14:13:23] ✅    ✅ Data merged successfully
[14:13:24] ✅    ✅ Order data extracted and validated
[14:13:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:14:19] [DOC: 9301620] ✅ Patient exists in API: Paula Hatch, ID: 7e9f0551-7213-4bc8-8b8b-ae0e8ddfecc3
[14:14:19] ✅    ✅ Existing patient found with ID: 7e9f0551-7213-4bc8-8b8b-ae0e8ddfecc3
[14:14:19] 🔄 
🔄 Step 6: Pushing order to API...
[14:14:19] [DOC: 9301620] ℹ️  Pushing order via API for patient ID: 7e9f0551-7213-4bc8-8b8b-ae0e8ddfecc3
[14:14:20] [DOC: 9301620] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13832"}
[14:14:20] ❌    ❌ Failed to push order
[14:14:20] 🔄 
🔄 Step 7: Writing to CSV...
[14:14:20] [DOC: 9301620] ℹ️  Calculated age: 84 from DOB: 06/22/1940
[14:14:20] [DOC: 9301620] ℹ️  Service Line extracted: 'OT, Occupational Therapy'
[14:14:20] [DOC: 9301620] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:14:20] [DOC: 9301620] ℹ️  Diagnosis codes being written:
[14:14:20] [DOC: 9301620] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:14:20] [DOC: 9301620] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:14:20] [DOC: 9301620] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:14:20] [DOC: 9301620] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:14:20] [DOC: 9301620] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:14:20] [DOC: 9301620] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:14:20] [DOC: 9301620] ✅ Patient data written to CSV: Paula Hatch | Sex: FEMALE | Age: 84 | Service: OT, Occupational Therapy | Payer: Senior Whole Health | MRN: 1508015
[14:14:20] ✅    ✅ Document 9301620 processed and saved successfully
[14:14:20] 🔄 
🔄 Step 8: Saving API details...
[14:14:20] [DOC: 9301620] ℹ️  API push details saved for document 9301620
[14:14:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9301619                         ║
================================================================================
[14:14:20] ℹ️  Agency: Dartmouth HH
[14:14:20] ℹ️  Date: 05/20/2025
[14:14:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:14:22] [DOC: 9301619] ✅ Text extracted using pdfplumber (1080 chars)
[14:14:22] ✅    ✅ Text extracted using pdfplumber (1080 chars)
[14:14:22] 🔄 
🔄 Step 2: Extracting patient data...
[14:14:25] ℹ️  AI extracted raw sex value: 'M'
[14:14:25] ℹ️  AI extracted service line: 'HHA'
[14:14:25] ℹ️  AI extracted payer source: 'Medicare'
[14:14:25] ℹ️  AI extracted diagnoses:
[14:14:25] ℹ️    - Diagnosis 1: ''
[14:14:25] ℹ️    - Diagnosis 2: ''
[14:14:25] ℹ️    - Diagnosis 3: ''
[14:14:25] ℹ️    - Diagnosis 4: ''
[14:14:25] ℹ️    - Diagnosis 5: ''
[14:14:25] ℹ️    - Diagnosis 6: ''
[14:14:25] ℹ️  Final extracted MRN: '1547002'
[14:14:25] ℹ️  Final extracted Sex: 'MALE'
[14:14:25] ℹ️  Final extracted Service Line: 'HHA'
[14:14:25] ℹ️  Final extracted Payer Source: 'Medicare'
[14:14:25] ✅ Patient data extraction completed successfully
[14:14:25] ✅    ✅ Patient data extracted successfully
[14:14:25] 📊 Patient Response
     └─ patientFName: Henry
     └─ patientLName: Pina
     └─ dob: 09/11/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 1547002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:14:25] ✅    ✅ Patient identified: Henry Pina
[14:14:25] ✅    ✅ Patient name validation passed
[14:14:25] 🔄 
🔄 Step 3: Processing patient dates...
[14:14:25] [DOC: 9301619] ℹ️  DOB normalized: 09/11/1943
[14:14:25] [DOC: 9301619] ℹ️  Episode startOfCare normalized: 04/25/2025
[14:14:25] [DOC: 9301619] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[14:14:25] [DOC: 9301619] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[14:14:25] [DOC: 9301619] ✅ Patient date processing completed successfully
[14:14:25] ✅    ✅ Date processing completed
[14:14:25] 📊 Processed Patient Data
     └─ patientFName: Henry
     └─ patientLName: Pina
     └─ dob: 09/11/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 1547002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:14:25] 🔄 
🔄 Step 4: Extracting order data...
[14:14:28] ℹ️  Order extraction - MRN: ''
[14:14:28] ℹ️  Order extraction - Sex: 'MALE'
[14:14:28] ℹ️  Order extraction - Service Line: ''
[14:14:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:14:28] ✅ Order data extraction completed successfully
[14:14:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:14:28] ℹ️  Using MRN from patient data: '1547002'
[14:14:28] ℹ️  Using service line from patient data: 'HHA'
[14:14:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:14:28] ✅ Patient name cross-validation successful
[14:14:28] ✅    ✅ Data merged successfully
[14:14:29] ✅    ✅ Order data extracted and validated
[14:14:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:14:59] [DOC: 9301619] ✅ Patient exists in API: Henry Pina, ID: 08ab05c1-ef08-4bd0-b345-2991f29c5e55
[14:14:59] ✅    ✅ Existing patient found with ID: 08ab05c1-ef08-4bd0-b345-2991f29c5e55
[14:14:59] 🔄 
🔄 Step 6: Pushing order to API...
[14:14:59] [DOC: 9301619] ℹ️  Pushing order via API for patient ID: 08ab05c1-ef08-4bd0-b345-2991f29c5e55
[14:15:01] [DOC: 9301619] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13072"}
[14:15:01] ❌    ❌ Failed to push order
[14:15:01] 🔄 
🔄 Step 7: Writing to CSV...
[14:15:01] [DOC: 9301619] ℹ️  Calculated age: 81 from DOB: 09/11/1943
[14:15:01] [DOC: 9301619] ℹ️  Service Line extracted: 'HHA'
[14:15:01] [DOC: 9301619] ℹ️  Payer Source extracted: 'Medicare'
[14:15:01] [DOC: 9301619] ℹ️  Diagnosis codes being written:
[14:15:01] [DOC: 9301619] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:15:01] [DOC: 9301619] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:15:01] [DOC: 9301619] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:15:01] [DOC: 9301619] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:15:01] [DOC: 9301619] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:15:01] [DOC: 9301619] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:15:01] [DOC: 9301619] ✅ Patient data written to CSV: Henry Pina | Sex: MALE | Age: 81 | Service: HHA | Payer: Medicare | MRN: 1547002
[14:15:01] ✅    ✅ Document 9301619 processed and saved successfully
[14:15:01] 🔄 
🔄 Step 8: Saving API details...
[14:15:01] [DOC: 9301619] ℹ️  API push details saved for document 9301619
[14:15:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9301609                         ║
================================================================================
[14:15:01] ℹ️  Agency: Dartmouth HH
[14:15:01] ℹ️  Date: 05/20/2025
[14:15:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:03] [DOC: 9301609] ✅ Text extracted using pdfplumber (5109 chars)
[14:15:03] ✅    ✅ Text extracted using pdfplumber (5109 chars)
[14:15:03] 🔄 
🔄 Step 2: Extracting patient data...
[14:15:06] ℹ️  AI extracted raw sex value: 'M'
[14:15:06] ℹ️  AI extracted service line: 'Physical Therapy'
[14:15:06] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[14:15:06] ℹ️  AI extracted diagnoses:
[14:15:06] ℹ️    - Diagnosis 1: ''
[14:15:06] ℹ️    - Diagnosis 2: ''
[14:15:06] ℹ️    - Diagnosis 3: ''
[14:15:06] ℹ️    - Diagnosis 4: ''
[14:15:06] ℹ️    - Diagnosis 5: ''
[14:15:06] ℹ️    - Diagnosis 6: ''
[14:15:06] ℹ️  Final extracted MRN: '6348015'
[14:15:06] ℹ️  Final extracted Sex: 'MALE'
[14:15:06] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:15:06] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[14:15:06] ✅ Patient data extraction completed successfully
[14:15:06] ✅    ✅ Patient data extracted successfully
[14:15:06] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:15:06] ✅    ✅ Patient identified: David Teixeira
[14:15:06] ✅    ✅ Patient name validation passed
[14:15:06] 🔄 
🔄 Step 3: Processing patient dates...
[14:15:06] [DOC: 9301609] ℹ️  DOB normalized: 12/29/1956
[14:15:06] [DOC: 9301609] ℹ️  Episode startOfCare normalized: 04/08/2025
[14:15:06] [DOC: 9301609] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[14:15:06] [DOC: 9301609] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[14:15:06] [DOC: 9301609] ✅ Patient date processing completed successfully
[14:15:06] ✅    ✅ Date processing completed
[14:15:06] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:15:06] 🔄 
🔄 Step 4: Extracting order data...
[14:15:09] ℹ️  Order extraction - MRN: '6348015'
[14:15:09] ℹ️  Order extraction - Sex: 'MALE'
[14:15:09] ℹ️  Order extraction - Service Line: 'PT'
[14:15:09] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[14:15:09] ✅ Order data extraction completed successfully
[14:15:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:15:09] ℹ️  Using MRN from patient data: '6348015' over '6348015'
[14:15:09] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[14:15:09] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[14:15:09] ✅ Patient name cross-validation successful
[14:15:09] ✅    ✅ Data merged successfully
[14:15:10] ✅    ✅ Order data extracted and validated
[14:15:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:15:10] [DOC: 9301609] ✅ Patient found in local cache: David Teixeira, ID: 92d56142-8dce-415a-ac6f-6020de943b51
[14:15:10] ✅    ✅ Existing patient found with ID: 92d56142-8dce-415a-ac6f-6020de943b51
[14:15:10] 🔄 
🔄 Step 6: Pushing order to API...
[14:15:10] [DOC: 9301609] ℹ️  Pushing order via API for patient ID: 92d56142-8dce-415a-ac6f-6020de943b51
[14:15:11] [DOC: 9301609] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:15:11] ❌    ❌ Failed to push order
[14:15:11] 🔄 
🔄 Step 7: Writing to CSV...
[14:15:11] [DOC: 9301609] ℹ️  Calculated age: 68 from DOB: 12/29/1956
[14:15:11] [DOC: 9301609] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[14:15:11] [DOC: 9301609] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[14:15:11] [DOC: 9301609] ℹ️  Diagnosis codes being written:
[14:15:11] [DOC: 9301609] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:15:11] [DOC: 9301609] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:15:11] [DOC: 9301609] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:15:11] [DOC: 9301609] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:15:11] [DOC: 9301609] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:15:11] [DOC: 9301609] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:15:11] [DOC: 9301609] ✅ Patient data written to CSV: David Teixeira | Sex: MALE | Age: 68 | Service: PT, Physical Therapy | Payer: Blue Cross Blue Shield | MRN: 6348015
[14:15:11] ✅    ✅ Document 9301609 processed and saved successfully
[14:15:11] 🔄 
🔄 Step 8: Saving API details...
[14:15:11] [DOC: 9301609] ℹ️  API push details saved for document 9301609
[14:15:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9299133                         ║
================================================================================
[14:15:11] ℹ️  Agency: Visiting Rehab & Nursing Services
[14:15:11] ℹ️  Date: 05/19/2025
[14:15:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:15] [DOC: 9299133] ✅ Text extracted using pdfplumber (23669 chars)
[14:15:15] ✅    ✅ Text extracted using pdfplumber (23657 chars)
[14:15:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:15:19] ℹ️  AI extracted raw sex value: 'F'
[14:15:19] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:15:19] ℹ️  AI extracted payer source: 'Medicare'
[14:15:19] ℹ️  AI extracted diagnoses:
[14:15:19] ℹ️    - Diagnosis 1: 'M51.16'
[14:15:19] ℹ️    - Diagnosis 2: 'G89.4'
[14:15:19] ℹ️    - Diagnosis 3: 'M51.14'
[14:15:19] ℹ️    - Diagnosis 4: 'I73.89'
[14:15:19] ℹ️    - Diagnosis 5: 'F32.A'
[14:15:19] ℹ️    - Diagnosis 6: 'F41.9'
[14:15:19] ℹ️  Final extracted MRN: 'hcbrSWH003'
[14:15:19] ℹ️  Final extracted Sex: 'FEMALE'
[14:15:19] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:15:19] ℹ️  Final extracted Payer Source: 'Medicare'
[14:15:19] ✅ Patient data extraction completed successfully
[14:15:19] ✅    ✅ Patient data extracted successfully
[14:15:19] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: St Jacques
     └─ dob: 07/18/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: hcbrSWH003
     └─ billingProvider: Rodrigues, June NP
     └─ npi: 1821065913
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 276 Cottage Street
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 994-2106
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/11/2022', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'M51.16', 'secondDiagnosis': 'G89.4', 'thirdDiagnosis': 'M51.14', 'fourthDiagnosis': 'I73.89', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'F41.9'}]
[14:15:19] ✅    ✅ Patient identified: Elizabeth St Jacques
[14:15:19] ✅    ✅ Patient name validation passed
[14:15:19] 🔄 
🔄 Step 3: Processing patient dates...
[14:15:19] [DOC: 9299133] ℹ️  DOB normalized: 07/18/1941
[14:15:19] [DOC: 9299133] ℹ️  Episode startOfCare normalized: 01/11/2022
[14:15:19] [DOC: 9299133] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[14:15:19] [DOC: 9299133] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[14:15:19] [DOC: 9299133] ✅ Patient date processing completed successfully
[14:15:19] ✅    ✅ Date processing completed
[14:15:19] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: St Jacques
     └─ dob: 07/18/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: hcbrSWH003
     └─ billingProvider: Rodrigues, June NP
     └─ npi: 1821065913
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 276 Cottage Street
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 994-2106
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/11/2022', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'M51.16', 'secondDiagnosis': 'G89.4', 'thirdDiagnosis': 'M51.14', 'fourthDiagnosis': 'I73.89', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'F41.9'}]
[14:15:19] 🔄 
🔄 Step 4: Extracting order data...
[14:15:22] ℹ️  Order extraction - MRN: 'hcbrSWH003'
[14:15:22] ℹ️  Order extraction - Sex: 'FEMALE'
[14:15:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:15:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:15:22] ✅ Order data extraction completed successfully
[14:15:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:15:22] ℹ️  Using MRN from patient data: 'hcbrSWH003' over 'hcbrSWH003'
[14:15:22] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing' = 'Physical Therapy, Skilled Nursing'
[14:15:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:15:22] ✅ Patient name cross-validation successful
[14:15:22] ✅    ✅ Data merged successfully
[14:15:23] ✅    ✅ Order data extracted and validated
[14:15:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:15:34] [DOC: 9299133] ℹ️  Patient not found in cache or API: Elizabeth St Jacques
[14:15:34] [DOC: 9299133] ℹ️  Patient not found, creating new patient via API...
[14:15:34] [DOC: 9299133] ℹ️  Creating patient via API: Elizabeth St Jacques
[14:15:35] [DOC: 9299133] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:15:35] ❌    ❌ Failed to create patient
[14:15:35] [DOC: 9299133] ℹ️  API push details saved for document 9299133
================================================================================
║                        Processing Document ID: 9296924                         ║
================================================================================
[14:15:35] ℹ️  Agency: Dartmouth HH
[14:15:35] ℹ️  Date: 05/16/2025
[14:15:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:37] [DOC: 9296924] ✅ Text extracted using pdfplumber (12297 chars)
[14:15:37] ✅    ✅ Text extracted using pdfplumber (12297 chars)
[14:15:37] 🔄 
🔄 Step 2: Extracting patient data...
[14:15:41] ℹ️  AI extracted raw sex value: 'M'
[14:15:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:15:41] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[14:15:41] ℹ️  AI extracted diagnoses:
[14:15:41] ℹ️    - Diagnosis 1: 'K50.918'
[14:15:41] ℹ️    - Diagnosis 2: 'E83.42'
[14:15:41] ℹ️    - Diagnosis 3: 'N30.01'
[14:15:41] ℹ️    - Diagnosis 4: 'N13.8'
[14:15:41] ℹ️    - Diagnosis 5: 'R53.83'
[14:15:41] ℹ️    - Diagnosis 6: 'I12.9'
[14:15:41] ℹ️  Final extracted MRN: '6348015'
[14:15:41] ℹ️  Final extracted Sex: 'MALE'
[14:15:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:15:41] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[14:15:41] ✅ Patient data extraction completed successfully
[14:15:41] ✅    ✅ Patient data extracted successfully
[14:15:41] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'K50.918', 'secondDiagnosis': 'E83.42', 'thirdDiagnosis': 'N30.01', 'fourthDiagnosis': 'N13.8', 'fifthDiagnosis': 'R53.83', 'sixthDiagnosis': 'I12.9'}]
[14:15:41] ✅    ✅ Patient identified: David Teixeira
[14:15:41] ✅    ✅ Patient name validation passed
[14:15:41] 🔄 
🔄 Step 3: Processing patient dates...
[14:15:41] [DOC: 9296924] ℹ️  DOB normalized: 12/29/1956
[14:15:41] [DOC: 9296924] ℹ️  Episode startOfCare normalized: 04/08/2025
[14:15:41] [DOC: 9296924] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[14:15:41] [DOC: 9296924] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[14:15:41] [DOC: 9296924] ✅ Patient date processing completed successfully
[14:15:41] ✅    ✅ Date processing completed
[14:15:41] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'K50.918', 'secondDiagnosis': 'E83.42', 'thirdDiagnosis': 'N30.01', 'fourthDiagnosis': 'N13.8', 'fifthDiagnosis': 'R53.83', 'sixthDiagnosis': 'I12.9'}]
[14:15:41] 🔄 
🔄 Step 4: Extracting order data...
[14:15:43] ℹ️  Order extraction - MRN: '6348015'
[14:15:43] ℹ️  Order extraction - Sex: 'MALE'
[14:15:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:15:43] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[14:15:43] ✅ Order data extraction completed successfully
[14:15:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:15:43] ℹ️  Using MRN from patient data: '6348015' over '6348015'
[14:15:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:15:43] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[14:15:43] ✅ Patient name cross-validation successful
[14:15:43] ✅    ✅ Data merged successfully
[14:15:44] ✅    ✅ Order data extracted and validated
[14:15:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:15:44] [DOC: 9296924] ✅ Patient found in local cache: David Teixeira, ID: 92d56142-8dce-415a-ac6f-6020de943b51
[14:15:44] ✅    ✅ Existing patient found with ID: 92d56142-8dce-415a-ac6f-6020de943b51
[14:15:44] 🔄 
🔄 Step 6: Pushing order to API...
[14:15:44] [DOC: 9296924] ℹ️  Pushing order via API for patient ID: 92d56142-8dce-415a-ac6f-6020de943b51
[14:15:46] [DOC: 9296924] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:15:46] ❌    ❌ Failed to push order
[14:15:46] 🔄 
🔄 Step 7: Writing to CSV...
[14:15:46] [DOC: 9296924] ℹ️  Calculated age: 68 from DOB: 12/29/1956
[14:15:46] [DOC: 9296924] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:15:46] [DOC: 9296924] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[14:15:46] [DOC: 9296924] ℹ️  Diagnosis codes being written:
[14:15:46] [DOC: 9296924] ℹ️    - Latest_Episode_Firstdiagnosis: 'K50.918'
[14:15:46] [DOC: 9296924] ℹ️    - Latest_Episode_Seconddiagnosis: 'E83.42'
[14:15:46] [DOC: 9296924] ℹ️    - Latest_Episode_Thirddiagnosis: 'N30.01'
[14:15:46] [DOC: 9296924] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N13.8'
[14:15:46] [DOC: 9296924] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R53.83'
[14:15:46] [DOC: 9296924] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[14:15:46] [DOC: 9296924] ✅ Patient data written to CSV: David Teixeira | Sex: MALE | Age: 68 | Service: Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 6348015
[14:15:46] ✅    ✅ Document 9296924 processed and saved successfully
[14:15:46] 🔄 
🔄 Step 8: Saving API details...
[14:15:46] [DOC: 9296924] ℹ️  API push details saved for document 9296924
[14:15:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9296471                         ║
================================================================================
[14:15:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:15:46] ℹ️  Date: 05/16/2025
[14:15:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:48] [DOC: 9296471] ✅ Text extracted using pdfplumber (1354 chars)
[14:15:48] ✅    ✅ Text extracted using pdfplumber (1354 chars)
[14:15:48] 🔄 
🔄 Step 2: Extracting patient data...
[14:15:51] ℹ️  AI extracted raw sex value: ''
[14:15:51] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:15:51] ℹ️  AI extracted payer source: ''
[14:15:51] ℹ️  AI extracted diagnoses:
[14:15:51] ℹ️    - Diagnosis 1: 'I13.0'
[14:15:51] ℹ️    - Diagnosis 2: 'I50.42'
[14:15:51] ℹ️    - Diagnosis 3: 'E11.22'
[14:15:51] ℹ️    - Diagnosis 4: 'None'
[14:15:51] ℹ️    - Diagnosis 5: 'None'
[14:15:51] ℹ️    - Diagnosis 6: 'None'
[14:15:51] ℹ️  Final extracted MRN: 'MA250206063603'
[14:15:51] ℹ️  Final extracted Sex: ''
[14:15:51] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:15:51] ℹ️  Final extracted Payer Source: ''
[14:15:51] ✅ Patient data extraction completed successfully
[14:15:51] ✅    ✅ Patient data extracted successfully
[14:15:51] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:15:51] ✅    ✅ Patient identified: Maria Lopes
[14:15:51] ✅    ✅ Patient name validation passed
[14:15:51] 🔄 
🔄 Step 3: Processing patient dates...
[14:15:51] [DOC: 9296471] ℹ️  DOB normalized: 06/25/1936
[14:15:51] [DOC: 9296471] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[14:15:51] [DOC: 9296471] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[14:15:51] [DOC: 9296471] ✅ Patient date processing completed successfully
[14:15:51] ✅    ✅ Date processing completed
[14:15:51] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22'}]
[14:15:51] 🔄 
🔄 Step 4: Extracting order data...
[14:15:53] ℹ️  Order extraction - MRN: 'MA250206063603'
[14:15:53] ℹ️  Order extraction - Sex: ''
[14:15:53] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:15:53] ℹ️  Order extraction - Payer Source: ''
[14:15:53] ✅ Order data extraction completed successfully
[14:15:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:15:53] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[14:15:53] ℹ️  Inferred sex as FEMALE from name: Maria
[14:15:53] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:15:53] ✅ Patient name cross-validation successful
[14:15:53] ✅    ✅ Data merged successfully
[14:15:54] ✅    ✅ Order data extracted and validated
[14:15:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:16:02] [DOC: 9296471] ℹ️  Patient not found in cache or API: Maria Lopes
[14:16:02] [DOC: 9296471] ℹ️  Patient not found, creating new patient via API...
[14:16:02] [DOC: 9296471] ℹ️  Creating patient via API: Maria Lopes
[14:16:03] [DOC: 9296471] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:16:03] ❌    ❌ Failed to create patient
[14:16:03] [DOC: 9296471] ℹ️  API push details saved for document 9296471
================================================================================
║                        Processing Document ID: 9296456                         ║
================================================================================
[14:16:03] ℹ️  Agency: Dartmouth HH
[14:16:03] ℹ️  Date: 05/16/2025
[14:16:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:05] [DOC: 9296456] ✅ Text extracted using pdfplumber (6255 chars)
[14:16:05] ✅    ✅ Text extracted using pdfplumber (6255 chars)
[14:16:05] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:08] ℹ️  AI extracted raw sex value: 'F'
[14:16:08] ℹ️  AI extracted service line: 'PT, OT'
[14:16:08] ℹ️  AI extracted payer source: 'Medicare'
[14:16:08] ℹ️  AI extracted diagnoses:
[14:16:08] ℹ️    - Diagnosis 1: 'None'
[14:16:08] ℹ️    - Diagnosis 2: 'None'
[14:16:08] ℹ️    - Diagnosis 3: 'None'
[14:16:08] ℹ️    - Diagnosis 4: 'None'
[14:16:08] ℹ️    - Diagnosis 5: 'None'
[14:16:08] ℹ️    - Diagnosis 6: 'None'
[14:16:08] ℹ️  Final extracted MRN: '1252008'
[14:16:08] ℹ️  Final extracted Sex: 'FEMALE'
[14:16:08] ℹ️  Final extracted Service Line: 'PT, OT'
[14:16:08] ℹ️  Final extracted Payer Source: 'Medicare'
[14:16:08] ✅ Patient data extraction completed successfully
[14:16:08] ✅    ✅ Patient data extracted successfully
[14:16:08] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Sykes
     └─ dob: 09/19/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1252008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:16:08] ✅    ✅ Patient identified: Linda Sykes
[14:16:08] ✅    ✅ Patient name validation passed
[14:16:08] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:08] [DOC: 9296456] ℹ️  DOB normalized: 09/19/1947
[14:16:08] [DOC: 9296456] ℹ️  Episode startOfCare normalized: 04/13/2025
[14:16:08] [DOC: 9296456] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[14:16:08] [DOC: 9296456] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[14:16:08] [DOC: 9296456] ✅ Patient date processing completed successfully
[14:16:08] ✅    ✅ Date processing completed
[14:16:08] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Sykes
     └─ dob: 09/19/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1252008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025'}]
[14:16:08] 🔄 
🔄 Step 4: Extracting order data...
[14:16:10] ℹ️  Order extraction - MRN: ''
[14:16:10] ℹ️  Order extraction - Sex: 'FEMALE'
[14:16:10] ℹ️  Order extraction - Service Line: 'PT, OT'
[14:16:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:16:10] ✅ Order data extraction completed successfully
[14:16:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:10] ℹ️  Using MRN from patient data: '1252008'
[14:16:10] ℹ️  Service line consistent in both sources: 'PT, OT'
[14:16:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:16:10] ✅ Patient name cross-validation successful
[14:16:10] ✅    ✅ Data merged successfully
[14:16:11] ✅    ✅ Order data extracted and validated
[14:16:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:16:11] [DOC: 9296456] ✅ Patient found in local cache: Linda Sykes, ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[14:16:11] ✅    ✅ Existing patient found with ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[14:16:11] 🔄 
🔄 Step 6: Pushing order to API...
[14:16:11] [DOC: 9296456] ℹ️  Pushing order via API for patient ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[14:16:12] [DOC: 9296456] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14469"}
[14:16:12] ❌    ❌ Failed to push order
[14:16:12] 🔄 
🔄 Step 7: Writing to CSV...
[14:16:12] [DOC: 9296456] ℹ️  Calculated age: 77 from DOB: 09/19/1947
[14:16:12] [DOC: 9296456] ℹ️  Service Line extracted: 'PT, OT'
[14:16:12] [DOC: 9296456] ℹ️  Payer Source extracted: 'Medicare'
[14:16:12] [DOC: 9296456] ℹ️  Diagnosis codes being written:
[14:16:12] [DOC: 9296456] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:16:12] [DOC: 9296456] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:16:12] [DOC: 9296456] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:16:12] [DOC: 9296456] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:16:12] [DOC: 9296456] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:16:12] [DOC: 9296456] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:16:12] [DOC: 9296456] ✅ Patient data written to CSV: Linda Sykes | Sex: FEMALE | Age: 77 | Service: PT, OT | Payer: Medicare | MRN: 1252008
[14:16:12] ✅    ✅ Document 9296456 processed and saved successfully
[14:16:12] 🔄 
🔄 Step 8: Saving API details...
[14:16:12] [DOC: 9296456] ℹ️  API push details saved for document 9296456
[14:16:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9294524                         ║
================================================================================
[14:16:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:16:12] ℹ️  Date: 05/15/2025
[14:16:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:16] [DOC: 9294524] ✅ Text extracted using pdfplumber (13566 chars)
[14:16:16] ✅    ✅ Text extracted using pdfplumber (13566 chars)
[14:16:16] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:19] ℹ️  AI extracted raw sex value: ''
[14:16:19] ℹ️  AI extracted service line: 'OT'
[14:16:19] ℹ️  AI extracted payer source: ''
[14:16:19] ℹ️  AI extracted diagnoses:
[14:16:19] ℹ️    - Diagnosis 1: 'osteoporosis'
[14:16:19] ℹ️    - Diagnosis 2: 'L2-L3 Fracture'
[14:16:19] ℹ️    - Diagnosis 3: 'muscle weakness'
[14:16:19] ℹ️    - Diagnosis 4: 'None'
[14:16:19] ℹ️    - Diagnosis 5: 'None'
[14:16:19] ℹ️    - Diagnosis 6: 'None'
[14:16:19] ℹ️  Final extracted MRN: 'MA220425084103'
[14:16:19] ℹ️  Final extracted Sex: ''
[14:16:19] ℹ️  Final extracted Service Line: 'OT'
[14:16:19] ℹ️  Final extracted Payer Source: ''
[14:16:19] ✅ Patient data extraction completed successfully
[14:16:19] ✅    ✅ Patient data extracted successfully
[14:16:19] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: Dr. Alcaraz, Achilles Romualdo E.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/12/2024', 'endOfEpisode': None, 'firstDiagnosis': 'osteoporosis', 'secondDiagnosis': 'L2-L3 Fracture', 'thirdDiagnosis': 'muscle weakness', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:16:19] ✅    ✅ Patient identified: Carlos Camara
[14:16:19] ✅    ✅ Patient name validation passed
[14:16:19] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:19] [DOC: 9294524] ℹ️  DOB normalized: 08/08/1941
[14:16:19] [DOC: 9294524] ℹ️  Episode startOfEpisode normalized: 11/12/2024
[14:16:19] [DOC: 9294524] ✅ Patient date processing completed successfully
[14:16:19] ✅    ✅ Date processing completed
[14:16:19] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: Dr. Alcaraz, Achilles Romualdo E.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/12/2024', 'firstDiagnosis': 'osteoporosis', 'secondDiagnosis': 'L2-L3 Fracture', 'thirdDiagnosis': 'muscle weakness'}]
[14:16:19] 🔄 
🔄 Step 4: Extracting order data...
[14:16:21] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:16:21] ℹ️  Order extraction - Sex: 'MALE'
[14:16:21] ℹ️  Order extraction - Service Line: 'OT'
[14:16:21] ℹ️  Order extraction - Payer Source: ''
[14:16:21] ✅ Order data extraction completed successfully
[14:16:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:21] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:16:21] ℹ️  Service line consistent in both sources: 'OT'
[14:16:21] ✅ Patient name cross-validation successful
[14:16:21] ✅    ✅ Data merged successfully
[14:16:23] ✅    ✅ Order data extracted and validated
[14:16:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:16:23] [DOC: 9294524] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:16:23] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:16:23] 🔄 
🔄 Step 6: Pushing order to API...
[14:16:23] [DOC: 9294524] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:16:24] [DOC: 9294524] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:16:24] ❌    ❌ Failed to push order
[14:16:24] 🔄 
🔄 Step 7: Writing to CSV...
[14:16:24] [DOC: 9294524] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:16:24] [DOC: 9294524] ℹ️  Service Line extracted: 'OT'
[14:16:24] [DOC: 9294524] ℹ️  Payer Source extracted: ''
[14:16:24] [DOC: 9294524] ℹ️  Diagnosis codes being written:
[14:16:24] [DOC: 9294524] ℹ️    - Latest_Episode_Firstdiagnosis: 'osteoporosis'
[14:16:24] [DOC: 9294524] ℹ️    - Latest_Episode_Seconddiagnosis: 'L2-L3 Fracture'
[14:16:24] [DOC: 9294524] ℹ️    - Latest_Episode_Thirddiagnosis: 'muscle weakness'
[14:16:24] [DOC: 9294524] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:16:24] [DOC: 9294524] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:16:24] [DOC: 9294524] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:16:24] [DOC: 9294524] ✅ Patient data written to CSV: Carlos Camara | Sex: MALE | Age: 83 | Service: OT | Payer:  | MRN: MA220425084103
[14:16:24] ✅    ✅ Document 9294524 processed and saved successfully
[14:16:24] 🔄 
🔄 Step 8: Saving API details...
[14:16:24] [DOC: 9294524] ℹ️  API push details saved for document 9294524
[14:16:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9294522                         ║
================================================================================
[14:16:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:16:24] ℹ️  Date: 05/15/2025
[14:16:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:27] [DOC: 9294522] ✅ Text extracted using pdfplumber (14886 chars)
[14:16:27] ✅    ✅ Text extracted using pdfplumber (14886 chars)
[14:16:27] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:30] ℹ️  AI extracted raw sex value: 'M'
[14:16:30] ℹ️  AI extracted service line: 'OT'
[14:16:30] ℹ️  AI extracted payer source: ''
[14:16:30] ℹ️  AI extracted diagnoses:
[14:16:30] ℹ️    - Diagnosis 1: 'osteoporosis'
[14:16:30] ℹ️    - Diagnosis 2: 'L2- L3 Fracture'
[14:16:30] ℹ️    - Diagnosis 3: 'muscle weakness'
[14:16:30] ℹ️    - Diagnosis 4: ''
[14:16:30] ℹ️    - Diagnosis 5: ''
[14:16:30] ℹ️    - Diagnosis 6: ''
[14:16:30] ℹ️  Final extracted MRN: 'MA220425084103'
[14:16:30] ℹ️  Final extracted Sex: 'MALE'
[14:16:30] ℹ️  Final extracted Service Line: 'OT'
[14:16:30] ℹ️  Final extracted Payer Source: ''
[14:16:30] ✅ Patient data extraction completed successfully
[14:16:30] ✅    ✅ Patient data extracted successfully
[14:16:30] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/12/2024', 'endOfEpisode': '', 'firstDiagnosis': 'osteoporosis', 'secondDiagnosis': 'L2- L3 Fracture', 'thirdDiagnosis': 'muscle weakness', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:30] ✅    ✅ Patient identified: Carlos Camara
[14:16:30] ✅    ✅ Patient name validation passed
[14:16:30] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:30] [DOC: 9294522] ℹ️  DOB normalized: 08/08/1941
[14:16:30] [DOC: 9294522] ℹ️  Episode startOfEpisode normalized: 11/12/2024
[14:16:30] [DOC: 9294522] ✅ Patient date processing completed successfully
[14:16:30] ✅    ✅ Date processing completed
[14:16:30] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/12/2024', 'endOfEpisode': '', 'firstDiagnosis': 'osteoporosis', 'secondDiagnosis': 'L2- L3 Fracture', 'thirdDiagnosis': 'muscle weakness', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:30] 🔄 
🔄 Step 4: Extracting order data...
[14:16:33] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:16:33] ℹ️  Order extraction - Sex: 'MALE'
[14:16:33] ℹ️  Order extraction - Service Line: 'OT'
[14:16:33] ℹ️  Order extraction - Payer Source: ''
[14:16:33] ✅ Order data extraction completed successfully
[14:16:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:33] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:16:33] ℹ️  Service line consistent in both sources: 'OT'
[14:16:33] ✅ Patient name cross-validation successful
[14:16:33] ✅    ✅ Data merged successfully
[14:16:34] ✅    ✅ Order data extracted and validated
[14:16:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:16:34] [DOC: 9294522] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:16:34] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:16:34] 🔄 
🔄 Step 6: Pushing order to API...
[14:16:34] [DOC: 9294522] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:16:35] [DOC: 9294522] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:16:35] ❌    ❌ Failed to push order
[14:16:35] 🔄 
🔄 Step 7: Writing to CSV...
[14:16:35] [DOC: 9294522] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:16:35] [DOC: 9294522] ℹ️  Service Line extracted: 'OT'
[14:16:35] [DOC: 9294522] ℹ️  Payer Source extracted: ''
[14:16:35] [DOC: 9294522] ℹ️  Diagnosis codes being written:
[14:16:35] [DOC: 9294522] ℹ️    - Latest_Episode_Firstdiagnosis: 'osteoporosis'
[14:16:35] [DOC: 9294522] ℹ️    - Latest_Episode_Seconddiagnosis: 'L2- L3 Fracture'
[14:16:35] [DOC: 9294522] ℹ️    - Latest_Episode_Thirddiagnosis: 'muscle weakness'
[14:16:35] [DOC: 9294522] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:16:35] [DOC: 9294522] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:16:35] [DOC: 9294522] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:16:35] [DOC: 9294522] ✅ Patient data written to CSV: Carlos Camara | Sex: MALE | Age: 83 | Service: OT | Payer:  | MRN: MA220425084103
[14:16:35] ✅    ✅ Document 9294522 processed and saved successfully
[14:16:35] 🔄 
🔄 Step 8: Saving API details...
[14:16:35] [DOC: 9294522] ℹ️  API push details saved for document 9294522
[14:16:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2176923                         ║
================================================================================
[14:16:35] ℹ️  Agency: Visiting Rehab & Nursing Services
[14:16:35] ℹ️  Date: 05/14/2025
[14:16:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:37] [DOC: 2176923] ❌ Critical failure in get_pdf_text: Invalid response format
[14:16:37] ❌ Failed to extract text for Doc ID 2176923
[14:16:37] [DOC: 2176923] ℹ️  API push details saved for document 2176923
================================================================================
║                        Processing Document ID: 9293320                         ║
================================================================================
[14:16:37] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:16:37] ℹ️  Date: 05/14/2025
[14:16:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:38] [DOC: 9293320] ✅ Text extracted using pdfplumber (1463 chars)
[14:16:38] ✅    ✅ Text extracted using pdfplumber (1463 chars)
[14:16:38] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:41] ℹ️  AI extracted raw sex value: 'M'
[14:16:41] ℹ️  AI extracted service line: 'RN, PT'
[14:16:41] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:16:41] ℹ️  AI extracted diagnoses:
[14:16:41] ℹ️    - Diagnosis 1: ''
[14:16:41] ℹ️    - Diagnosis 2: ''
[14:16:41] ℹ️    - Diagnosis 3: ''
[14:16:41] ℹ️    - Diagnosis 4: ''
[14:16:41] ℹ️    - Diagnosis 5: ''
[14:16:41] ℹ️    - Diagnosis 6: ''
[14:16:41] ℹ️  Final extracted MRN: '648005'
[14:16:41] ℹ️  Final extracted Sex: 'MALE'
[14:16:41] ℹ️  Final extracted Service Line: 'RN, PT'
[14:16:41] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:16:41] ✅ Patient data extraction completed successfully
[14:16:41] ✅    ✅ Patient data extracted successfully
[14:16:41] 📊 Patient Response
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Theophilus Addo, MD
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN, PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:41] ✅    ✅ Patient identified: Pedro Sousa
[14:16:41] ✅    ✅ Patient name validation passed
[14:16:41] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:41] [DOC: 9293320] ℹ️  DOB normalized: 03/29/1964
[14:16:41] [DOC: 9293320] ℹ️  Episode startOfCare normalized: 03/25/2025
[14:16:41] [DOC: 9293320] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:16:41] [DOC: 9293320] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:16:41] [DOC: 9293320] ✅ Patient date processing completed successfully
[14:16:41] ✅    ✅ Date processing completed
[14:16:41] 📊 Processed Patient Data
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Theophilus Addo, MD
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN, PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:41] 🔄 
🔄 Step 4: Extracting order data...
[14:16:43] ℹ️  Order extraction - MRN: '648005'
[14:16:43] ℹ️  Order extraction - Sex: 'MALE'
[14:16:43] ℹ️  Order extraction - Service Line: 'RN, PT'
[14:16:43] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:16:43] ✅ Order data extraction completed successfully
[14:16:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:43] ℹ️  Using MRN from patient data: '648005' over '648005'
[14:16:43] ℹ️  Service line consistent in both sources: 'RN, PT'
[14:16:43] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:16:43] ✅ Patient name cross-validation successful
[14:16:43] ✅    ✅ Data merged successfully
[14:16:45] ✅    ✅ Order data extracted and validated
[14:16:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:16:45] [DOC: 9293320] ✅ Patient found in local cache: Pedro Sousa, ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:16:45] ✅    ✅ Existing patient found with ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:16:45] 🔄 
🔄 Step 6: Pushing order to API...
[14:16:45] [DOC: 9293320] ℹ️  Pushing order via API for patient ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:16:46] [DOC: 9293320] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:16:46] ❌    ❌ Failed to push order
[14:16:46] 🔄 
🔄 Step 7: Writing to CSV...
[14:16:46] [DOC: 9293320] ℹ️  Calculated age: 61 from DOB: 03/29/1964
[14:16:46] [DOC: 9293320] ℹ️  Service Line extracted: 'RN, PT'
[14:16:46] [DOC: 9293320] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:16:46] [DOC: 9293320] ℹ️  Diagnosis codes being written:
[14:16:46] [DOC: 9293320] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:16:46] [DOC: 9293320] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:16:46] [DOC: 9293320] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:16:46] [DOC: 9293320] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:16:46] [DOC: 9293320] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:16:46] [DOC: 9293320] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:16:46] [DOC: 9293320] ✅ Patient data written to CSV: Pedro Sousa | Sex: MALE | Age: 61 | Service: RN, PT | Payer: Medicaid/MA | MRN: 648005
[14:16:46] ✅    ✅ Document 9293320 processed and saved successfully
[14:16:46] 🔄 
🔄 Step 8: Saving API details...
[14:16:46] [DOC: 9293320] ℹ️  API push details saved for document 9293320
[14:16:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2176795                         ║
================================================================================
[14:16:46] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:16:46] ℹ️  Date: 05/14/2025
[14:16:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:47] [DOC: 2176795] ❌ Critical failure in get_pdf_text: Invalid response format
[14:16:47] ❌ Failed to extract text for Doc ID 2176795
[14:16:47] [DOC: 2176795] ℹ️  API push details saved for document 2176795
================================================================================
║                        Processing Document ID: 9291946                         ║
================================================================================
[14:16:47] ℹ️  Agency: COMFORT HOME CARE LLC-METHUEN
[14:16:47] ℹ️  Date: 05/14/2025
[14:16:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:49] [DOC: 9291946] ✅ Text extracted using pdfplumber (10460 chars)
[14:16:49] ✅    ✅ Text extracted using pdfplumber (10460 chars)
[14:16:49] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:52] ℹ️  AI extracted raw sex value: 'F'
[14:16:52] ℹ️  AI extracted service line: 'Skilled Nursing, Medication Administration'
[14:16:52] ℹ️  AI extracted payer source: 'Medicare'
[14:16:52] ℹ️  AI extracted diagnoses:
[14:16:52] ℹ️    - Diagnosis 1: 'F31.9'
[14:16:52] ℹ️    - Diagnosis 2: 'F41.1'
[14:16:52] ℹ️    - Diagnosis 3: 'F11.20'
[14:16:52] ℹ️    - Diagnosis 4: 'F12.20'
[14:16:52] ℹ️    - Diagnosis 5: 'I10'
[14:16:52] ℹ️    - Diagnosis 6: 'J43.9'
[14:16:52] ℹ️  Final extracted MRN: '8155001'
[14:16:52] ℹ️  Final extracted Sex: 'FEMALE'
[14:16:52] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medication Administration'
[14:16:52] ℹ️  Final extracted Payer Source: 'Medicare'
[14:16:52] ✅ Patient data extraction completed successfully
[14:16:52] ✅    ✅ Patient data extracted successfully
[14:16:52] 📊 Patient Response
     └─ patientFName: Dayna
     └─ patientLName: Reynolds
     └─ dob: 08/07/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 8155001
     └─ billingProvider: Comfort Home Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Comfort Home Care, LLC
     └─ address: 147 Pelham Street
     └─ city: Methuen
     └─ state: MA
     └─ zip: 01844
     └─ email: 
     └─ phoneNumber: (617) 242-1000
     └─ serviceLine: Skilled Nursing, Medication Administration
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/28/2020', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F11.20', 'fourthDiagnosis': 'F12.20', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'J43.9'}]
[14:16:52] ✅    ✅ Patient identified: Dayna Reynolds
[14:16:52] ✅    ✅ Patient name validation passed
[14:16:52] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:52] [DOC: 9291946] ℹ️  DOB normalized: 08/07/1962
[14:16:52] [DOC: 9291946] ℹ️  Episode startOfCare normalized: 11/28/2020
[14:16:52] [DOC: 9291946] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:16:52] [DOC: 9291946] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:16:52] [DOC: 9291946] ✅ Patient date processing completed successfully
[14:16:52] ✅    ✅ Date processing completed
[14:16:52] 📊 Processed Patient Data
     └─ patientFName: Dayna
     └─ patientLName: Reynolds
     └─ dob: 08/07/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 8155001
     └─ billingProvider: Comfort Home Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Comfort Home Care, LLC
     └─ address: 147 Pelham Street
     └─ city: Methuen
     └─ state: MA
     └─ zip: 01844
     └─ email: 
     └─ phoneNumber: (617) 242-1000
     └─ serviceLine: Skilled Nursing, Medication Administration
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/28/2020', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F11.20', 'fourthDiagnosis': 'F12.20', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'J43.9'}]
[14:16:52] 🔄 
🔄 Step 4: Extracting order data...
[14:16:55] ℹ️  Order extraction - MRN: '100011627302'
[14:16:55] ℹ️  Order extraction - Sex: 'FEMALE'
[14:16:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing,  Medication Administration'
[14:16:55] ℹ️  Order extraction - Payer Source: ''
[14:16:55] ✅ Order data extraction completed successfully
[14:16:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:55] ℹ️  Using longer MRN from order data: '100011627302' over '8155001'
[14:16:55] ℹ️  Combined service lines: Patient='Skilled Nursing, Medication Administration' + Order='Skilled Nursing,  Medication Administration' = 'Medication Administration, Skilled Nursing'
[14:16:55] ℹ️  Using payer source from patient data: 'Medicare'
[14:16:55] ✅ Patient name cross-validation successful
[14:16:55] ✅    ✅ Data merged successfully
[14:16:56] ✅    ✅ Order data extracted and validated
[14:16:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:17:01] [DOC: 9291946] ✅ Patient exists in API: Dayna Reynolds, ID: 0c5f3109-b478-4705-9088-358811944271
[14:17:01] ✅    ✅ Existing patient found with ID: 0c5f3109-b478-4705-9088-358811944271
[14:17:01] 🔄 
🔄 Step 6: Pushing order to API...
[14:17:01] [DOC: 9291946] ℹ️  Pushing order via API for patient ID: 0c5f3109-b478-4705-9088-358811944271
[14:17:02] [DOC: 9291946] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:17:02] ❌    ❌ Failed to push order
[14:17:02] 🔄 
🔄 Step 7: Writing to CSV...
[14:17:02] [DOC: 9291946] ℹ️  Calculated age: 62 from DOB: 08/07/1962
[14:17:02] [DOC: 9291946] ℹ️  Service Line extracted: 'Medication Administration, Skilled Nursing'
[14:17:02] [DOC: 9291946] ℹ️  Payer Source extracted: 'Medicare'
[14:17:02] [DOC: 9291946] ℹ️  Diagnosis codes being written:
[14:17:02] [DOC: 9291946] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.9'
[14:17:02] [DOC: 9291946] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[14:17:02] [DOC: 9291946] ℹ️    - Latest_Episode_Thirddiagnosis: 'F11.20'
[14:17:02] [DOC: 9291946] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F12.20'
[14:17:02] [DOC: 9291946] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[14:17:02] [DOC: 9291946] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J43.9'
[14:17:02] [DOC: 9291946] ✅ Patient data written to CSV: Dayna Reynolds | Sex: FEMALE | Age: 62 | Service: Medication Administration, Skilled Nursing | Payer: Medicare | MRN: 100011627302
[14:17:02] ✅    ✅ Document 9291946 processed and saved successfully
[14:17:02] 🔄 
🔄 Step 8: Saving API details...
[14:17:02] [DOC: 9291946] ℹ️  API push details saved for document 9291946
[14:17:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9291478                         ║
================================================================================
[14:17:02] ℹ️  Agency: All At Home Health Care-Allston
[14:17:02] ℹ️  Date: 05/13/2025
[14:17:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:17:04] [DOC: 9291478] ✅ Text extracted using pdfplumber (2137 chars)
[14:17:04] ✅    ✅ Text extracted using pdfplumber (2137 chars)
[14:17:04] 🔄 
🔄 Step 2: Extracting patient data...
[14:17:07] ℹ️  AI extracted raw sex value: ''
[14:17:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:17:07] ℹ️  AI extracted payer source: ''
[14:17:07] ℹ️  AI extracted diagnoses:
[14:17:07] ℹ️    - Diagnosis 1: ''
[14:17:07] ℹ️    - Diagnosis 2: ''
[14:17:07] ℹ️    - Diagnosis 3: ''
[14:17:07] ℹ️    - Diagnosis 4: ''
[14:17:07] ℹ️    - Diagnosis 5: ''
[14:17:07] ℹ️    - Diagnosis 6: ''
[14:17:07] ℹ️  Final extracted MRN: ''
[14:17:07] ℹ️  Final extracted Sex: ''
[14:17:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:17:07] ℹ️  Final extracted Payer Source: ''
[14:17:07] ✅ Patient data extraction completed successfully
[14:17:07] ✅    ✅ Patient data extracted successfully
[14:17:07] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Desousa
     └─ dob: 12/31/1944
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Achilles Romualdo Alcaraz, MD
     └─ npi: 1720386378
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Rd
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (508) 496-8539
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:17:07] ✅    ✅ Patient identified: Jose Desousa
[14:17:07] ✅    ✅ Patient name validation passed
[14:17:07] 🔄 
🔄 Step 3: Processing patient dates...
[14:17:07] [DOC: 9291478] ℹ️  DOB normalized: 12/31/1944
[14:17:07] [DOC: 9291478] ℹ️  Episode startOfCare normalized: 05/01/2025
[14:17:07] [DOC: 9291478] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[14:17:07] [DOC: 9291478] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[14:17:07] [DOC: 9291478] ✅ Patient date processing completed successfully
[14:17:07] ✅    ✅ Date processing completed
[14:17:07] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Desousa
     └─ dob: 12/31/1944
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Achilles Romualdo Alcaraz, MD
     └─ npi: 1720386378
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Rd
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (508) 496-8539
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:17:07] 🔄 
🔄 Step 4: Extracting order data...
[14:17:09] ℹ️  Order extraction - MRN: ''
[14:17:09] ℹ️  Order extraction - Sex: ''
[14:17:09] ℹ️  Order extraction - Service Line: 'SN'
[14:17:09] ℹ️  Order extraction - Payer Source: ''
[14:17:09] ✅ Order data extraction completed successfully
[14:17:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:17:09] ⚠️  No MRN found in either patient or order data
[14:17:09] ⚠️  Could not determine sex using any available method
[14:17:09] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[14:17:09] ✅ Patient name cross-validation successful
[14:17:09] ✅    ✅ Data merged successfully
[14:17:11] ✅    ✅ Order data extracted and validated
[14:17:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:17:17] [DOC: 9291478] ✅ Patient exists in API: Jose Desousa, ID: 71ef55b4-d5f6-40f1-a38f-328b2eae1b43
[14:17:17] ✅    ✅ Existing patient found with ID: 71ef55b4-d5f6-40f1-a38f-328b2eae1b43
[14:17:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:17:17] [DOC: 9291478] ℹ️  Pushing order via API for patient ID: 71ef55b4-d5f6-40f1-a38f-328b2eae1b43
[14:17:18] [DOC: 9291478] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:17:18] ❌    ❌ Failed to push order
[14:17:18] 🔄 
🔄 Step 7: Writing to CSV...
[14:17:18] [DOC: 9291478] ℹ️  Calculated age: 80 from DOB: 12/31/1944
[14:17:18] [DOC: 9291478] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[14:17:18] [DOC: 9291478] ℹ️  Payer Source extracted: ''
[14:17:18] [DOC: 9291478] ℹ️  Diagnosis codes being written:
[14:17:18] [DOC: 9291478] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:17:18] [DOC: 9291478] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:17:18] [DOC: 9291478] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:17:18] [DOC: 9291478] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:17:18] [DOC: 9291478] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:17:18] [DOC: 9291478] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:17:18] [DOC: 9291478] ✅ Patient data written to CSV: Jose Desousa | Sex:  | Age: 80 | Service: SN, Skilled Nursing | Payer:  | MRN: 
[14:17:18] ✅    ✅ Document 9291478 processed and saved successfully
[14:17:18] 🔄 
🔄 Step 8: Saving API details...
[14:17:18] [DOC: 9291478] ℹ️  API push details saved for document 9291478
[14:17:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9291474                         ║
================================================================================
[14:17:18] ℹ️  Agency: All At Home Health Care-Allston
[14:17:18] ℹ️  Date: 05/13/2025
[14:17:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:17:22] [DOC: 9291474] ✅ Text extracted using pdfplumber (16437 chars)
[14:17:22] ✅    ✅ Text extracted using pdfplumber (16437 chars)
[14:17:22] 🔄 
🔄 Step 2: Extracting patient data...
[14:17:26] ℹ️  AI extracted raw sex value: 'M'
[14:17:26] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:17:26] ℹ️  AI extracted payer source: ''
[14:17:26] ℹ️  AI extracted diagnoses:
[14:17:26] ℹ️    - Diagnosis 1: 'G20.B1'
[14:17:26] ℹ️    - Diagnosis 2: 'I95.1'
[14:17:26] ℹ️    - Diagnosis 3: 'I12.9'
[14:17:26] ℹ️    - Diagnosis 4: 'N18.31'
[14:17:26] ℹ️    - Diagnosis 5: 'G70.00'
[14:17:26] ℹ️    - Diagnosis 6: 'K59.04'
[14:17:26] ℹ️  Final extracted MRN: '1827'
[14:17:26] ℹ️  Final extracted Sex: 'MALE'
[14:17:26] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:17:26] ℹ️  Final extracted Payer Source: ''
[14:17:26] ✅ Patient data extraction completed successfully
[14:17:26] ✅    ✅ Patient data extracted successfully
[14:17:26] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Desousa
     └─ dob: 12/31/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 1827
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: All At Home Health Care
     └─ address: 371 Earle St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 496-8539
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'G20.B1', 'secondDiagnosis': 'I95.1', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'G70.00', 'sixthDiagnosis': 'K59.04'}]
[14:17:26] ✅    ✅ Patient identified: Jose Desousa
[14:17:26] ✅    ✅ Patient name validation passed
[14:17:26] 🔄 
🔄 Step 3: Processing patient dates...
[14:17:26] [DOC: 9291474] ℹ️  DOB normalized: 12/31/1944
[14:17:26] [DOC: 9291474] ℹ️  Episode startOfCare normalized: 05/01/2025
[14:17:26] [DOC: 9291474] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[14:17:26] [DOC: 9291474] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[14:17:26] [DOC: 9291474] ✅ Patient date processing completed successfully
[14:17:26] ✅    ✅ Date processing completed
[14:17:26] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Desousa
     └─ dob: 12/31/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 1827
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: All At Home Health Care
     └─ address: 371 Earle St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 496-8539
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'G20.B1', 'secondDiagnosis': 'I95.1', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'G70.00', 'sixthDiagnosis': 'K59.04'}]
[14:17:26] 🔄 
🔄 Step 4: Extracting order data...
[14:17:28] ℹ️  Order extraction - MRN: '1827'
[14:17:28] ℹ️  Order extraction - Sex: 'MALE'
[14:17:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[14:17:28] ℹ️  Order extraction - Payer Source: ''
[14:17:28] ✅ Order data extraction completed successfully
[14:17:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:17:28] ℹ️  Using MRN from patient data: '1827' over '1827'
[14:17:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[14:17:28] ✅ Patient name cross-validation successful
[14:17:28] ✅    ✅ Data merged successfully
[14:17:30] ✅    ✅ Order data extracted and validated
[14:17:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:17:30] [DOC: 9291474] ✅ Patient found in local cache: Jose Desousa, ID: 71ef55b4-d5f6-40f1-a38f-328b2eae1b43
[14:17:30] ✅    ✅ Existing patient found with ID: 71ef55b4-d5f6-40f1-a38f-328b2eae1b43
[14:17:30] 🔄 
🔄 Step 6: Pushing order to API...
[14:17:30] [DOC: 9291474] ℹ️  Pushing order via API for patient ID: 71ef55b4-d5f6-40f1-a38f-328b2eae1b43
[14:17:31] [DOC: 9291474] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:17:31] ❌    ❌ Failed to push order
[14:17:31] 🔄 
🔄 Step 7: Writing to CSV...
[14:17:31] [DOC: 9291474] ℹ️  Calculated age: 80 from DOB: 12/31/1944
[14:17:31] [DOC: 9291474] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[14:17:31] [DOC: 9291474] ℹ️  Payer Source extracted: ''
[14:17:31] [DOC: 9291474] ℹ️  Diagnosis codes being written:
[14:17:31] [DOC: 9291474] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.B1'
[14:17:31] [DOC: 9291474] ℹ️    - Latest_Episode_Seconddiagnosis: 'I95.1'
[14:17:31] [DOC: 9291474] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[14:17:31] [DOC: 9291474] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[14:17:31] [DOC: 9291474] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G70.00'
[14:17:31] [DOC: 9291474] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.04'
[14:17:31] [DOC: 9291474] ✅ Patient data written to CSV: Jose Desousa | Sex: MALE | Age: 80 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 1827
[14:17:31] ✅    ✅ Document 9291474 processed and saved successfully
[14:17:31] 🔄 
🔄 Step 8: Saving API details...
[14:17:31] [DOC: 9291474] ℹ️  API push details saved for document 9291474
[14:17:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9289670                         ║
================================================================================
[14:17:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:17:31] ℹ️  Date: 05/13/2025
[14:17:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:17:34] [DOC: 9289670] ✅ Text extracted using pdfplumber (16372 chars)
[14:17:34] ✅    ✅ Text extracted using pdfplumber (16360 chars)
[14:17:34] 🔄 
🔄 Step 2: Extracting patient data...
[14:17:38] ℹ️  AI extracted raw sex value: 'M'
[14:17:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:17:38] ℹ️  AI extracted payer source: 'Private Pay'
[14:17:38] ℹ️  AI extracted diagnoses:
[14:17:38] ℹ️    - Diagnosis 1: 'I13.0'
[14:17:38] ℹ️    - Diagnosis 2: 'I50.32'
[14:17:38] ℹ️    - Diagnosis 3: 'N18.31'
[14:17:38] ℹ️    - Diagnosis 4: 'D63.1'
[14:17:38] ℹ️    - Diagnosis 5: 'L89.312'
[14:17:38] ℹ️    - Diagnosis 6: 'M47.26'
[14:17:38] ℹ️  Final extracted MRN: 'MA240214024201'
[14:17:38] ℹ️  Final extracted Sex: 'MALE'
[14:17:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:17:38] ℹ️  Final extracted Payer Source: 'Private Pay'
[14:17:38] ✅ Patient data extraction completed successfully
[14:17:38] ✅    ✅ Patient data extracted successfully
[14:17:38] 📊 Patient Response
     └─ patientFName: Charles
     └─ patientLName: Gaspar
     └─ dob: 02/28/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240214024201
     └─ billingProvider: Marshman, Dannielle
     └─ npi: 1881923936
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 237 Ryan St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 991-2172
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '09/13/2024', 'startOfEpisode': '05/11/2025', 'endOfEpisode': '07/09/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'D63.1', 'fifthDiagnosis': 'L89.312', 'sixthDiagnosis': 'M47.26'}]
[14:17:38] ✅    ✅ Patient identified: Charles Gaspar
[14:17:38] ✅    ✅ Patient name validation passed
[14:17:38] 🔄 
🔄 Step 3: Processing patient dates...
[14:17:38] [DOC: 9289670] ℹ️  DOB normalized: 02/28/1942
[14:17:38] [DOC: 9289670] ℹ️  Episode startOfCare normalized: 09/13/2024
[14:17:38] [DOC: 9289670] ℹ️  Episode startOfEpisode normalized: 05/11/2025
[14:17:38] [DOC: 9289670] ℹ️  Episode endOfEpisode normalized: 07/09/2025
[14:17:38] [DOC: 9289670] ✅ Patient date processing completed successfully
[14:17:38] ✅    ✅ Date processing completed
[14:17:38] 📊 Processed Patient Data
     └─ patientFName: Charles
     └─ patientLName: Gaspar
     └─ dob: 02/28/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240214024201
     └─ billingProvider: Marshman, Dannielle
     └─ npi: 1881923936
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 237 Ryan St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 991-2172
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '09/13/2024', 'startOfEpisode': '05/11/2025', 'endOfEpisode': '07/09/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'D63.1', 'fifthDiagnosis': 'L89.312', 'sixthDiagnosis': 'M47.26'}]
[14:17:38] 🔄 
🔄 Step 4: Extracting order data...
[14:17:40] ℹ️  Order extraction - MRN: 'MA240214024201'
[14:17:40] ℹ️  Order extraction - Sex: 'MALE'
[14:17:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:17:40] ℹ️  Order extraction - Payer Source: 'Private Pay'
[14:17:40] ✅ Order data extraction completed successfully
[14:17:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:17:40] ℹ️  Using MRN from patient data: 'MA240214024201' over 'MA240214024201'
[14:17:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:17:40] ℹ️  Payer source consistent in both sources: 'Private Pay'
[14:17:40] ✅ Patient name cross-validation successful
[14:17:40] ✅    ✅ Data merged successfully
[14:17:42] ✅    ✅ Order data extracted and validated
[14:17:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:17:54] [DOC: 9289670] ✅ Patient exists in API: Charles Gaspar, ID: 876abdb3-5fa6-4c38-a4b6-a838b1d703e7
[14:17:54] ✅    ✅ Existing patient found with ID: 876abdb3-5fa6-4c38-a4b6-a838b1d703e7
[14:17:54] 🔄 
🔄 Step 6: Pushing order to API...
[14:17:54] [DOC: 9289670] ℹ️  Pushing order via API for patient ID: 876abdb3-5fa6-4c38-a4b6-a838b1d703e7
[14:17:55] [DOC: 9289670] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13771"}
[14:17:55] ❌    ❌ Failed to push order
[14:17:55] 🔄 
🔄 Step 7: Writing to CSV...
[14:17:55] [DOC: 9289670] ℹ️  Calculated age: 83 from DOB: 02/28/1942
[14:17:55] [DOC: 9289670] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:17:55] [DOC: 9289670] ℹ️  Payer Source extracted: 'Private Pay'
[14:17:55] [DOC: 9289670] ℹ️  Diagnosis codes being written:
[14:17:55] [DOC: 9289670] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[14:17:55] [DOC: 9289670] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[14:17:55] [DOC: 9289670] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[14:17:55] [DOC: 9289670] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D63.1'
[14:17:55] [DOC: 9289670] ℹ️    - Latest_Episode_Fifthdiagnosis: 'L89.312'
[14:17:55] [DOC: 9289670] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M47.26'
[14:17:55] [DOC: 9289670] ✅ Patient data written to CSV: Charles Gaspar | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Private Pay | MRN: MA240214024201
[14:17:55] ✅    ✅ Document 9289670 processed and saved successfully
[14:17:55] 🔄 
🔄 Step 8: Saving API details...
[14:17:55] [DOC: 9289670] ℹ️  API push details saved for document 9289670
[14:17:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9289776                         ║
================================================================================
[14:17:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:17:55] ℹ️  Date: 05/13/2025
[14:17:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:17:57] [DOC: 9289776] ✅ Text extracted using pdfplumber (9427 chars)
[14:17:57] ✅    ✅ Text extracted using pdfplumber (9415 chars)
[14:17:57] 🔄 
🔄 Step 2: Extracting patient data...
[14:18:01] ℹ️  AI extracted raw sex value: 'F'
[14:18:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:18:01] ℹ️  AI extracted payer source: 'Medicare'
[14:18:01] ℹ️  AI extracted diagnoses:
[14:18:01] ℹ️    - Diagnosis 1: 'F32.A'
[14:18:01] ℹ️    - Diagnosis 2: 'F41.9'
[14:18:01] ℹ️    - Diagnosis 3: 'J44.9'
[14:18:01] ℹ️    - Diagnosis 4: 'I10'
[14:18:01] ℹ️    - Diagnosis 5: 'M47.816'
[14:18:01] ℹ️    - Diagnosis 6: 'M81.0'
[14:18:01] ℹ️  Final extracted MRN: 'MA230315023303'
[14:18:01] ℹ️  Final extracted Sex: 'FEMALE'
[14:18:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:18:01] ℹ️  Final extracted Payer Source: 'Medicare'
[14:18:01] ✅ Patient data extraction completed successfully
[14:18:01] ✅    ✅ Patient data extracted successfully
[14:18:01] 📊 Patient Response
     └─ patientFName: Alice
     └─ patientLName: Frates
     └─ dob: 02/13/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230315023303
     └─ billingProvider: POTHIER, JAHN MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 108 Coggeshall St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 995-4755
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/08/2023', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'M81.0'}]
[14:18:01] ✅    ✅ Patient identified: Alice Frates
[14:18:01] ✅    ✅ Patient name validation passed
[14:18:01] 🔄 
🔄 Step 3: Processing patient dates...
[14:18:01] [DOC: 9289776] ℹ️  DOB normalized: 02/13/1933
[14:18:01] [DOC: 9289776] ℹ️  Episode startOfCare normalized: 07/08/2023
[14:18:01] [DOC: 9289776] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[14:18:01] [DOC: 9289776] ℹ️  Episode endOfEpisode normalized: 06/26/2025
[14:18:01] [DOC: 9289776] ✅ Patient date processing completed successfully
[14:18:01] ✅    ✅ Date processing completed
[14:18:01] 📊 Processed Patient Data
     └─ patientFName: Alice
     └─ patientLName: Frates
     └─ dob: 02/13/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230315023303
     └─ billingProvider: POTHIER, JAHN MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 108 Coggeshall St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 995-4755
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/08/2023', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'M81.0'}]
[14:18:01] 🔄 
🔄 Step 4: Extracting order data...
[14:18:03] ℹ️  Order extraction - MRN: 'MA230315023303'
[14:18:03] ℹ️  Order extraction - Sex: 'FEMALE'
[14:18:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:18:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:18:03] ✅ Order data extraction completed successfully
[14:18:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:18:03] ℹ️  Using MRN from patient data: 'MA230315023303' over 'MA230315023303'
[14:18:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:18:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:18:03] ✅ Patient name cross-validation successful
[14:18:03] ✅    ✅ Data merged successfully
[14:18:05] ✅    ✅ Order data extracted and validated
[14:18:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:18:29] [DOC: 9289776] ✅ Patient exists in API: Alice Frates, ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[14:18:29] ✅    ✅ Existing patient found with ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[14:18:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:18:29] [DOC: 9289776] ℹ️  Pushing order via API for patient ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[14:18:30] [DOC: 9289776] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12907"}
[14:18:30] ❌    ❌ Failed to push order
[14:18:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:18:30] [DOC: 9289776] ℹ️  Calculated age: 92 from DOB: 02/13/1933
[14:18:30] [DOC: 9289776] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:18:30] [DOC: 9289776] ℹ️  Payer Source extracted: 'Medicare'
[14:18:30] [DOC: 9289776] ℹ️  Diagnosis codes being written:
[14:18:30] [DOC: 9289776] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.A'
[14:18:30] [DOC: 9289776] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[14:18:30] [DOC: 9289776] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[14:18:30] [DOC: 9289776] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[14:18:30] [DOC: 9289776] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M47.816'
[14:18:30] [DOC: 9289776] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M81.0'
[14:18:30] [DOC: 9289776] ✅ Patient data written to CSV: Alice Frates | Sex: FEMALE | Age: 92 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230315023303
[14:18:30] ✅    ✅ Document 9289776 processed and saved successfully
[14:18:30] 🔄 
🔄 Step 8: Saving API details...
[14:18:30] [DOC: 9289776] ℹ️  API push details saved for document 9289776
[14:18:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9287259                         ║
================================================================================
[14:18:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:18:30] ℹ️  Date: 05/12/2025
[14:18:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:18:32] [DOC: 9287259] ✅ Text extracted using pdfplumber (1280 chars)
[14:18:32] ✅    ✅ Text extracted using pdfplumber (1268 chars)
[14:18:32] 🔄 
🔄 Step 2: Extracting patient data...
[14:18:35] ℹ️  AI extracted raw sex value: ''
[14:18:35] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:18:35] ℹ️  AI extracted payer source: ''
[14:18:35] ℹ️  AI extracted diagnoses:
[14:18:35] ℹ️    - Diagnosis 1: 'M17.0'
[14:18:35] ℹ️    - Diagnosis 2: 'L29.89'
[14:18:35] ℹ️    - Diagnosis 3: 'H54.3'
[14:18:35] ℹ️    - Diagnosis 4: 'None'
[14:18:35] ℹ️    - Diagnosis 5: 'None'
[14:18:35] ℹ️    - Diagnosis 6: 'None'
[14:18:35] ℹ️  Final extracted MRN: 'MA230914084702'
[14:18:35] ℹ️  Final extracted Sex: ''
[14:18:35] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:18:35] ℹ️  Final extracted Payer Source: ''
[14:18:35] ✅ Patient data extraction completed successfully
[14:18:35] ✅    ✅ Patient data extracted successfully
[14:18:35] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Starr
     └─ dob: 08/22/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA230914084702
     └─ billingProvider: Ahmet Dirican MD
     └─ npi: 1396723813
     └─ physicianNPI: 1396723813
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/05/2025', 'endOfEpisode': '07/03/2025', 'firstDiagnosis': 'M17.0', 'secondDiagnosis': 'L29.89', 'thirdDiagnosis': 'H54.3', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:18:35] ✅    ✅ Patient identified: Nancy Starr
[14:18:35] ✅    ✅ Patient name validation passed
[14:18:35] 🔄 
🔄 Step 3: Processing patient dates...
[14:18:35] [DOC: 9287259] ℹ️  DOB normalized: 08/22/1947
[14:18:35] [DOC: 9287259] ℹ️  Episode startOfEpisode normalized: 05/05/2025
[14:18:35] [DOC: 9287259] ℹ️  Episode endOfEpisode normalized: 07/03/2025
[14:18:35] [DOC: 9287259] ✅ Patient date processing completed successfully
[14:18:35] ✅    ✅ Date processing completed
[14:18:35] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Starr
     └─ dob: 08/22/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA230914084702
     └─ billingProvider: Ahmet Dirican MD
     └─ npi: 1396723813
     └─ physicianNPI: 1396723813
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '07/03/2025', 'firstDiagnosis': 'M17.0', 'secondDiagnosis': 'L29.89', 'thirdDiagnosis': 'H54.3'}]
[14:18:35] 🔄 
🔄 Step 4: Extracting order data...
[14:18:38] ℹ️  Order extraction - MRN: 'MA230914084702'
[14:18:38] ℹ️  Order extraction - Sex: ''
[14:18:38] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:18:38] ℹ️  Order extraction - Payer Source: ''
[14:18:38] ✅ Order data extraction completed successfully
[14:18:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:18:38] ℹ️  Using MRN from patient data: 'MA230914084702' over 'MA230914084702'
[14:18:38] ℹ️  Inferred sex as FEMALE from name: Nancy
[14:18:38] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:18:38] ✅ Patient name cross-validation successful
[14:18:38] ✅    ✅ Data merged successfully
[14:18:39] ✅    ✅ Order data extracted and validated
[14:18:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:18:48] [DOC: 9287259] ✅ Patient exists in API: Nancy Starr, ID: 18cbbb2e-3dff-4e63-b1de-1aae171650c1
[14:18:48] ✅    ✅ Existing patient found with ID: 18cbbb2e-3dff-4e63-b1de-1aae171650c1
[14:18:48] 🔄 
🔄 Step 6: Pushing order to API...
[14:18:48] [DOC: 9287259] ℹ️  Pushing order via API for patient ID: 18cbbb2e-3dff-4e63-b1de-1aae171650c1
[14:18:49] [DOC: 9287259] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14449"}
[14:18:49] ❌    ❌ Failed to push order
[14:18:49] 🔄 
🔄 Step 7: Writing to CSV...
[14:18:49] [DOC: 9287259] ℹ️  Calculated age: 77 from DOB: 08/22/1947
[14:18:49] [DOC: 9287259] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:18:49] [DOC: 9287259] ℹ️  Payer Source extracted: ''
[14:18:49] [DOC: 9287259] ℹ️  Diagnosis codes being written:
[14:18:49] [DOC: 9287259] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.0'
[14:18:49] [DOC: 9287259] ℹ️    - Latest_Episode_Seconddiagnosis: 'L29.89'
[14:18:49] [DOC: 9287259] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.3'
[14:18:49] [DOC: 9287259] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:18:49] [DOC: 9287259] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:18:49] [DOC: 9287259] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:18:49] [DOC: 9287259] ✅ Patient data written to CSV: Nancy Starr | Sex: FEMALE | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA230914084702
[14:18:49] ✅    ✅ Document 9287259 processed and saved successfully
[14:18:49] 🔄 
🔄 Step 8: Saving API details...
[14:18:49] [DOC: 9287259] ℹ️  API push details saved for document 9287259
[14:18:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9287159                         ║
================================================================================
[14:18:49] ℹ️  Agency: Dartmouth HH
[14:18:49] ℹ️  Date: 05/12/2025
[14:18:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:18:52] [DOC: 9287159] ✅ Text extracted using pdfplumber (12592 chars)
[14:18:52] ✅    ✅ Text extracted using pdfplumber (12592 chars)
[14:18:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:18:55] ℹ️  AI extracted raw sex value: 'F'
[14:18:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:18:55] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:18:55] ℹ️  AI extracted diagnoses:
[14:18:55] ℹ️    - Diagnosis 1: 'M79.605'
[14:18:55] ℹ️    - Diagnosis 2: 'C49.21'
[14:18:55] ℹ️    - Diagnosis 3: 'T45.1X5D'
[14:18:55] ℹ️    - Diagnosis 4: 'K12.31'
[14:18:55] ℹ️    - Diagnosis 5: 'K92.81'
[14:18:55] ℹ️    - Diagnosis 6: 'N76.81'
[14:18:55] ℹ️  Final extracted MRN: '5391015'
[14:18:55] ℹ️  Final extracted Sex: 'FEMALE'
[14:18:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:18:55] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:18:55] ✅ Patient data extraction completed successfully
[14:18:55] ✅    ✅ Patient data extracted successfully
[14:18:55] 📊 Patient Response
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M79.605', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'T45.1X5D', 'fourthDiagnosis': 'K12.31', 'fifthDiagnosis': 'K92.81', 'sixthDiagnosis': 'N76.81'}]
[14:18:55] ✅    ✅ Patient identified: Maribel Pena
[14:18:55] ✅    ✅ Patient name validation passed
[14:18:55] 🔄 
🔄 Step 3: Processing patient dates...
[14:18:55] [DOC: 9287159] ℹ️  DOB normalized: 09/16/1994
[14:18:55] [DOC: 9287159] ℹ️  Episode startOfCare normalized: 10/17/2024
[14:18:55] [DOC: 9287159] ℹ️  Episode startOfEpisode normalized: 10/17/2024
[14:18:55] [DOC: 9287159] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[14:18:55] [DOC: 9287159] ✅ Patient date processing completed successfully
[14:18:55] ✅    ✅ Date processing completed
[14:18:55] 📊 Processed Patient Data
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M79.605', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'T45.1X5D', 'fourthDiagnosis': 'K12.31', 'fifthDiagnosis': 'K92.81', 'sixthDiagnosis': 'N76.81'}]
[14:18:55] 🔄 
🔄 Step 4: Extracting order data...
[14:18:58] ℹ️  Order extraction - MRN: ''
[14:18:58] ℹ️  Order extraction - Sex: 'FEMALE'
[14:18:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:18:58] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:18:58] ✅ Order data extraction completed successfully
[14:18:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:18:58] ℹ️  Using MRN from patient data: '5391015'
[14:18:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:18:58] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:18:58] ✅ Patient name cross-validation successful
[14:18:58] ✅    ✅ Data merged successfully
[14:18:59] ✅    ✅ Order data extracted and validated
[14:18:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:18:59] [DOC: 9287159] ✅ Patient found in local cache: Maribel Pena, ID: 21aca991-bba7-4f19-828f-34b178408fd4
[14:18:59] ✅    ✅ Existing patient found with ID: 21aca991-bba7-4f19-828f-34b178408fd4
[14:18:59] 🔄 
🔄 Step 6: Pushing order to API...
[14:18:59] [DOC: 9287159] ℹ️  Pushing order via API for patient ID: 21aca991-bba7-4f19-828f-34b178408fd4
[14:19:00] [DOC: 9287159] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13008"}
[14:19:00] ❌    ❌ Failed to push order
[14:19:00] 🔄 
🔄 Step 7: Writing to CSV...
[14:19:00] [DOC: 9287159] ℹ️  Calculated age: 30 from DOB: 09/16/1994
[14:19:00] [DOC: 9287159] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:19:00] [DOC: 9287159] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:19:00] [DOC: 9287159] ℹ️  Diagnosis codes being written:
[14:19:00] [DOC: 9287159] ℹ️    - Latest_Episode_Firstdiagnosis: 'M79.605'
[14:19:00] [DOC: 9287159] ℹ️    - Latest_Episode_Seconddiagnosis: 'C49.21'
[14:19:00] [DOC: 9287159] ℹ️    - Latest_Episode_Thirddiagnosis: 'T45.1X5D'
[14:19:00] [DOC: 9287159] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K12.31'
[14:19:00] [DOC: 9287159] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K92.81'
[14:19:00] [DOC: 9287159] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N76.81'
[14:19:00] [DOC: 9287159] ✅ Patient data written to CSV: Maribel Pena | Sex: FEMALE | Age: 30 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 5391015
[14:19:00] ✅    ✅ Document 9287159 processed and saved successfully
[14:19:00] 🔄 
🔄 Step 8: Saving API details...
[14:19:00] [DOC: 9287159] ℹ️  API push details saved for document 9287159
[14:19:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9286019                         ║
================================================================================
[14:19:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:19:00] ℹ️  Date: 05/09/2025
[14:19:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:19:06] [DOC: 9286019] ✅ Text extracted using pdfplumber (1454 chars)
[14:19:06] ✅    ✅ Text extracted using pdfplumber (1454 chars)
[14:19:06] 🔄 
🔄 Step 2: Extracting patient data...
[14:19:09] ℹ️  AI extracted raw sex value: ''
[14:19:09] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:19:09] ℹ️  AI extracted payer source: ''
[14:19:09] ℹ️  AI extracted diagnoses:
[14:19:09] ℹ️    - Diagnosis 1: 'I13.0'
[14:19:09] ℹ️    - Diagnosis 2: 'I50.33'
[14:19:09] ℹ️    - Diagnosis 3: 'N18.31'
[14:19:09] ℹ️    - Diagnosis 4: 'None'
[14:19:09] ℹ️    - Diagnosis 5: 'None'
[14:19:09] ℹ️    - Diagnosis 6: 'None'
[14:19:09] ℹ️  Final extracted MRN: 'MA250331114803'
[14:19:09] ℹ️  Final extracted Sex: ''
[14:19:09] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:19:09] ℹ️  Final extracted Payer Source: ''
[14:19:09] ✅ Patient data extraction completed successfully
[14:19:09] ✅    ✅ Patient data extracted successfully
[14:19:09] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:19:09] ✅    ✅ Patient identified: David Sturgeon
[14:19:09] ✅    ✅ Patient name validation passed
[14:19:09] 🔄 
🔄 Step 3: Processing patient dates...
[14:19:09] [DOC: 9286019] ℹ️  DOB normalized: 11/14/1948
[14:19:09] [DOC: 9286019] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:19:09] [DOC: 9286019] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:19:09] [DOC: 9286019] ✅ Patient date processing completed successfully
[14:19:09] ✅    ✅ Date processing completed
[14:19:09] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31'}]
[14:19:09] 🔄 
🔄 Step 4: Extracting order data...
[14:19:11] ℹ️  Order extraction - MRN: 'MA250331114803'
[14:19:11] ℹ️  Order extraction - Sex: ''
[14:19:11] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:19:11] ℹ️  Order extraction - Payer Source: ''
[14:19:11] ✅ Order data extraction completed successfully
[14:19:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:19:11] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[14:19:11] ℹ️  Inferred sex as MALE from name: David
[14:19:11] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:19:11] ✅ Patient name cross-validation successful
[14:19:11] ✅    ✅ Data merged successfully
[14:19:12] ✅    ✅ Order data extracted and validated
[14:19:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:19:12] [DOC: 9286019] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[14:19:12] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[14:19:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:19:12] [DOC: 9286019] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[14:19:14] [DOC: 9286019] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14456"}
[14:19:14] ❌    ❌ Failed to push order
[14:19:14] 🔄 
🔄 Step 7: Writing to CSV...
[14:19:14] [DOC: 9286019] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[14:19:14] [DOC: 9286019] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:19:14] [DOC: 9286019] ℹ️  Payer Source extracted: ''
[14:19:14] [DOC: 9286019] ℹ️  Diagnosis codes being written:
[14:19:14] [DOC: 9286019] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[14:19:14] [DOC: 9286019] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[14:19:14] [DOC: 9286019] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[14:19:14] [DOC: 9286019] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:19:14] [DOC: 9286019] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:19:14] [DOC: 9286019] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:19:14] [DOC: 9286019] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: MA250331114803
[14:19:14] ✅    ✅ Document 9286019 processed and saved successfully
[14:19:14] 🔄 
🔄 Step 8: Saving API details...
[14:19:14] [DOC: 9286019] ℹ️  API push details saved for document 9286019
[14:19:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9286016                         ║
================================================================================
[14:19:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:19:14] ℹ️  Date: 05/09/2025
[14:19:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:19:17] [DOC: 9286016] ✅ Text extracted using pdfplumber (1643 chars)
[14:19:17] ✅    ✅ Text extracted using pdfplumber (1643 chars)
[14:19:17] 🔄 
🔄 Step 2: Extracting patient data...
[14:19:20] ℹ️  AI extracted raw sex value: ''
[14:19:20] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:19:20] ℹ️  AI extracted payer source: ''
[14:19:20] ℹ️  AI extracted diagnoses:
[14:19:20] ℹ️    - Diagnosis 1: 'I13.0'
[14:19:20] ℹ️    - Diagnosis 2: 'I50.33'
[14:19:20] ℹ️    - Diagnosis 3: 'N18.31'
[14:19:20] ℹ️    - Diagnosis 4: 'None'
[14:19:20] ℹ️    - Diagnosis 5: 'None'
[14:19:20] ℹ️    - Diagnosis 6: 'None'
[14:19:20] ℹ️  Final extracted MRN: 'MA250331114803'
[14:19:20] ℹ️  Final extracted Sex: ''
[14:19:20] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:19:20] ℹ️  Final extracted Payer Source: ''
[14:19:20] ✅ Patient data extraction completed successfully
[14:19:20] ✅    ✅ Patient data extracted successfully
[14:19:20] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:19:20] ✅    ✅ Patient identified: David Sturgeon
[14:19:20] ✅    ✅ Patient name validation passed
[14:19:20] 🔄 
🔄 Step 3: Processing patient dates...
[14:19:20] [DOC: 9286016] ℹ️  DOB normalized: 11/14/1948
[14:19:20] [DOC: 9286016] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:19:20] [DOC: 9286016] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:19:20] [DOC: 9286016] ✅ Patient date processing completed successfully
[14:19:20] ✅    ✅ Date processing completed
[14:19:20] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31'}]
[14:19:20] 🔄 
🔄 Step 4: Extracting order data...
[14:19:23] ℹ️  Order extraction - MRN: 'MA250331114803'
[14:19:23] ℹ️  Order extraction - Sex: ''
[14:19:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:19:23] ℹ️  Order extraction - Payer Source: ''
[14:19:23] ✅ Order data extraction completed successfully
[14:19:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:19:23] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[14:19:23] ℹ️  Inferred sex as MALE from name: David
[14:19:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:19:23] ✅ Patient name cross-validation successful
[14:19:23] ✅    ✅ Data merged successfully
[14:19:24] ✅    ✅ Order data extracted and validated
[14:19:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:19:24] [DOC: 9286016] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[14:19:24] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[14:19:24] 🔄 
🔄 Step 6: Pushing order to API...
[14:19:24] [DOC: 9286016] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[14:19:26] [DOC: 9286016] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14457"}
[14:19:26] ❌    ❌ Failed to push order
[14:19:26] 🔄 
🔄 Step 7: Writing to CSV...
[14:19:26] [DOC: 9286016] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[14:19:26] [DOC: 9286016] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:19:26] [DOC: 9286016] ℹ️  Payer Source extracted: ''
[14:19:26] [DOC: 9286016] ℹ️  Diagnosis codes being written:
[14:19:26] [DOC: 9286016] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[14:19:26] [DOC: 9286016] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[14:19:26] [DOC: 9286016] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[14:19:26] [DOC: 9286016] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:19:26] [DOC: 9286016] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:19:26] [DOC: 9286016] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:19:26] [DOC: 9286016] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: MA250331114803
[14:19:26] ✅    ✅ Document 9286016 processed and saved successfully
[14:19:26] 🔄 
🔄 Step 8: Saving API details...
[14:19:26] [DOC: 9286016] ℹ️  API push details saved for document 9286016
[14:19:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9286000                         ║
================================================================================
[14:19:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:19:26] ℹ️  Date: 05/09/2025
[14:19:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:19:28] [DOC: 9286000] ✅ Text extracted using pdfplumber (1429 chars)
[14:19:28] ✅    ✅ Text extracted using pdfplumber (1429 chars)
[14:19:28] 🔄 
🔄 Step 2: Extracting patient data...
[14:19:31] ℹ️  AI extracted raw sex value: ''
[14:19:31] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:19:31] ℹ️  AI extracted payer source: ''
[14:19:31] ℹ️  AI extracted diagnoses:
[14:19:31] ℹ️    - Diagnosis 1: 'N39.0'
[14:19:31] ℹ️    - Diagnosis 2: 'G93.41'
[14:19:31] ℹ️    - Diagnosis 3: 'R44.3'
[14:19:31] ℹ️    - Diagnosis 4: ''
[14:19:31] ℹ️    - Diagnosis 5: ''
[14:19:31] ℹ️    - Diagnosis 6: ''
[14:19:31] ℹ️  Final extracted MRN: 'MA220425084103'
[14:19:31] ℹ️  Final extracted Sex: ''
[14:19:31] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:19:31] ℹ️  Final extracted Payer Source: ''
[14:19:31] ✅ Patient data extraction completed successfully
[14:19:31] ✅    ✅ Patient data extracted successfully
[14:19:31] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:19:31] ✅    ✅ Patient identified: Carlos Camara
[14:19:31] ✅    ✅ Patient name validation passed
[14:19:31] 🔄 
🔄 Step 3: Processing patient dates...
[14:19:31] [DOC: 9286000] ℹ️  DOB normalized: 08/08/1941
[14:19:31] [DOC: 9286000] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:19:31] [DOC: 9286000] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:19:31] [DOC: 9286000] ✅ Patient date processing completed successfully
[14:19:31] ✅    ✅ Date processing completed
[14:19:31] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:19:31] 🔄 
🔄 Step 4: Extracting order data...
[14:19:34] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:19:34] ℹ️  Order extraction - Sex: ''
[14:19:34] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:19:34] ℹ️  Order extraction - Payer Source: ''
[14:19:34] ✅ Order data extraction completed successfully
[14:19:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:19:34] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:19:34] ⚠️  Could not determine sex using any available method
[14:19:34] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:19:34] ✅ Patient name cross-validation successful
[14:19:34] ✅    ✅ Data merged successfully
[14:19:35] ✅    ✅ Order data extracted and validated
[14:19:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:19:35] [DOC: 9286000] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:35] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:35] 🔄 
🔄 Step 6: Pushing order to API...
[14:19:35] [DOC: 9286000] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:36] [DOC: 9286000] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13430"}
[14:19:36] ❌    ❌ Failed to push order
[14:19:36] 🔄 
🔄 Step 7: Writing to CSV...
[14:19:36] [DOC: 9286000] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:19:36] [DOC: 9286000] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:19:36] [DOC: 9286000] ℹ️  Payer Source extracted: ''
[14:19:36] [DOC: 9286000] ℹ️  Diagnosis codes being written:
[14:19:36] [DOC: 9286000] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[14:19:36] [DOC: 9286000] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[14:19:36] [DOC: 9286000] ℹ️    - Latest_Episode_Thirddiagnosis: 'R44.3'
[14:19:36] [DOC: 9286000] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:19:36] [DOC: 9286000] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:19:36] [DOC: 9286000] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:19:36] [DOC: 9286000] ✅ Patient data written to CSV: Carlos Camara | Sex:  | Age: 83 | Service: Occupational Therapy | Payer:  | MRN: MA220425084103
[14:19:36] ✅    ✅ Document 9286000 processed and saved successfully
[14:19:36] 🔄 
🔄 Step 8: Saving API details...
[14:19:36] [DOC: 9286000] ℹ️  API push details saved for document 9286000
[14:19:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9285997                         ║
================================================================================
[14:19:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:19:36] ℹ️  Date: 05/09/2025
[14:19:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:19:38] [DOC: 9285997] ✅ Text extracted using pdfplumber (1779 chars)
[14:19:38] ✅    ✅ Text extracted using pdfplumber (1779 chars)
[14:19:38] 🔄 
🔄 Step 2: Extracting patient data...
[14:19:41] ℹ️  AI extracted raw sex value: ''
[14:19:41] ℹ️  AI extracted service line: 'Physical Therapy'
[14:19:41] ℹ️  AI extracted payer source: ''
[14:19:41] ℹ️  AI extracted diagnoses:
[14:19:41] ℹ️    - Diagnosis 1: 'N39.0'
[14:19:41] ℹ️    - Diagnosis 2: 'G93.41'
[14:19:41] ℹ️    - Diagnosis 3: 'R44.3'
[14:19:41] ℹ️    - Diagnosis 4: ''
[14:19:41] ℹ️    - Diagnosis 5: ''
[14:19:41] ℹ️    - Diagnosis 6: ''
[14:19:41] ℹ️  Final extracted MRN: 'MA220425084103'
[14:19:41] ℹ️  Final extracted Sex: ''
[14:19:41] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:19:41] ℹ️  Final extracted Payer Source: ''
[14:19:41] ✅ Patient data extraction completed successfully
[14:19:41] ✅    ✅ Patient data extracted successfully
[14:19:41] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:19:41] ✅    ✅ Patient identified: Carlos Camara
[14:19:41] ✅    ✅ Patient name validation passed
[14:19:41] 🔄 
🔄 Step 3: Processing patient dates...
[14:19:41] [DOC: 9285997] ℹ️  DOB normalized: 08/08/1941
[14:19:41] [DOC: 9285997] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:19:41] [DOC: 9285997] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:19:41] [DOC: 9285997] ✅ Patient date processing completed successfully
[14:19:41] ✅    ✅ Date processing completed
[14:19:41] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:19:41] 🔄 
🔄 Step 4: Extracting order data...
[14:19:45] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:19:45] ℹ️  Order extraction - Sex: ''
[14:19:45] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:19:45] ℹ️  Order extraction - Payer Source: ''
[14:19:45] ✅ Order data extraction completed successfully
[14:19:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:19:45] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:19:45] ⚠️  Could not determine sex using any available method
[14:19:45] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:19:45] ✅ Patient name cross-validation successful
[14:19:45] ✅    ✅ Data merged successfully
[14:19:46] ✅    ✅ Order data extracted and validated
[14:19:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:19:46] [DOC: 9285997] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:46] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:46] 🔄 
🔄 Step 6: Pushing order to API...
[14:19:46] [DOC: 9285997] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:47] [DOC: 9285997] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13432"}
[14:19:47] ❌    ❌ Failed to push order
[14:19:47] 🔄 
🔄 Step 7: Writing to CSV...
[14:19:47] [DOC: 9285997] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:19:47] [DOC: 9285997] ℹ️  Service Line extracted: 'Physical Therapy'
[14:19:47] [DOC: 9285997] ℹ️  Payer Source extracted: ''
[14:19:47] [DOC: 9285997] ℹ️  Diagnosis codes being written:
[14:19:47] [DOC: 9285997] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[14:19:47] [DOC: 9285997] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[14:19:47] [DOC: 9285997] ℹ️    - Latest_Episode_Thirddiagnosis: 'R44.3'
[14:19:47] [DOC: 9285997] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:19:47] [DOC: 9285997] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:19:47] [DOC: 9285997] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:19:47] [DOC: 9285997] ✅ Patient data written to CSV: Carlos Camara | Sex:  | Age: 83 | Service: Physical Therapy | Payer:  | MRN: MA220425084103
[14:19:47] ✅    ✅ Document 9285997 processed and saved successfully
[14:19:47] 🔄 
🔄 Step 8: Saving API details...
[14:19:47] [DOC: 9285997] ℹ️  API push details saved for document 9285997
[14:19:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9285996                         ║
================================================================================
[14:19:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:19:47] ℹ️  Date: 05/09/2025
[14:19:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:19:49] [DOC: 9285996] ✅ Text extracted using pdfplumber (1837 chars)
[14:19:49] ✅    ✅ Text extracted using pdfplumber (1837 chars)
[14:19:49] 🔄 
🔄 Step 2: Extracting patient data...
[14:19:52] ℹ️  AI extracted raw sex value: ''
[14:19:52] ℹ️  AI extracted service line: 'Physical Therapy'
[14:19:52] ℹ️  AI extracted payer source: ''
[14:19:52] ℹ️  AI extracted diagnoses:
[14:19:52] ℹ️    - Diagnosis 1: 'N39.0'
[14:19:52] ℹ️    - Diagnosis 2: 'G93.41'
[14:19:52] ℹ️    - Diagnosis 3: 'R44.3'
[14:19:52] ℹ️    - Diagnosis 4: ''
[14:19:52] ℹ️    - Diagnosis 5: ''
[14:19:52] ℹ️    - Diagnosis 6: ''
[14:19:52] ℹ️  Final extracted MRN: 'MA220425084103'
[14:19:52] ℹ️  Final extracted Sex: ''
[14:19:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:19:52] ℹ️  Final extracted Payer Source: ''
[14:19:52] ✅ Patient data extraction completed successfully
[14:19:52] ✅    ✅ Patient data extracted successfully
[14:19:52] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:19:52] ✅    ✅ Patient identified: Carlos Camara
[14:19:52] ✅    ✅ Patient name validation passed
[14:19:52] 🔄 
🔄 Step 3: Processing patient dates...
[14:19:52] [DOC: 9285996] ℹ️  DOB normalized: 08/08/1941
[14:19:52] [DOC: 9285996] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:19:52] [DOC: 9285996] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:19:52] [DOC: 9285996] ✅ Patient date processing completed successfully
[14:19:52] ✅    ✅ Date processing completed
[14:19:52] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:19:52] 🔄 
🔄 Step 4: Extracting order data...
[14:19:55] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:19:55] ℹ️  Order extraction - Sex: ''
[14:19:55] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:19:55] ℹ️  Order extraction - Payer Source: ''
[14:19:55] ✅ Order data extraction completed successfully
[14:19:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:19:55] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:19:55] ⚠️  Could not determine sex using any available method
[14:19:55] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:19:55] ✅ Patient name cross-validation successful
[14:19:55] ✅    ✅ Data merged successfully
[14:19:56] ✅    ✅ Order data extracted and validated
[14:19:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:19:56] [DOC: 9285996] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:56] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:56] 🔄 
🔄 Step 6: Pushing order to API...
[14:19:56] [DOC: 9285996] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:19:57] [DOC: 9285996] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13433"}
[14:19:57] ❌    ❌ Failed to push order
[14:19:57] 🔄 
🔄 Step 7: Writing to CSV...
[14:19:57] [DOC: 9285996] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:19:57] [DOC: 9285996] ℹ️  Service Line extracted: 'Physical Therapy'
[14:19:57] [DOC: 9285996] ℹ️  Payer Source extracted: ''
[14:19:57] [DOC: 9285996] ℹ️  Diagnosis codes being written:
[14:19:57] [DOC: 9285996] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[14:19:57] [DOC: 9285996] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[14:19:57] [DOC: 9285996] ℹ️    - Latest_Episode_Thirddiagnosis: 'R44.3'
[14:19:57] [DOC: 9285996] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:19:57] [DOC: 9285996] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:19:57] [DOC: 9285996] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:19:57] [DOC: 9285996] ✅ Patient data written to CSV: Carlos Camara | Sex:  | Age: 83 | Service: Physical Therapy | Payer:  | MRN: MA220425084103
[14:19:57] ✅    ✅ Document 9285996 processed and saved successfully
[14:19:57] 🔄 
🔄 Step 8: Saving API details...
[14:19:57] [DOC: 9285996] ℹ️  API push details saved for document 9285996
[14:19:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9285995                         ║
================================================================================
[14:19:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:19:57] ℹ️  Date: 05/09/2025
[14:19:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:20:00] [DOC: 9285995] ✅ Text extracted using pdfplumber (1837 chars)
[14:20:00] ✅    ✅ Text extracted using pdfplumber (1837 chars)
[14:20:00] 🔄 
🔄 Step 2: Extracting patient data...
[14:20:03] ℹ️  AI extracted raw sex value: ''
[14:20:03] ℹ️  AI extracted service line: 'Physical Therapy'
[14:20:03] ℹ️  AI extracted payer source: ''
[14:20:03] ℹ️  AI extracted diagnoses:
[14:20:03] ℹ️    - Diagnosis 1: 'N39.0'
[14:20:03] ℹ️    - Diagnosis 2: 'G93.41'
[14:20:03] ℹ️    - Diagnosis 3: 'R44.3'
[14:20:03] ℹ️    - Diagnosis 4: ''
[14:20:03] ℹ️    - Diagnosis 5: ''
[14:20:03] ℹ️    - Diagnosis 6: ''
[14:20:03] ℹ️  Final extracted MRN: 'MA220425084103'
[14:20:03] ℹ️  Final extracted Sex: ''
[14:20:03] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:20:03] ℹ️  Final extracted Payer Source: ''
[14:20:03] ✅ Patient data extraction completed successfully
[14:20:03] ✅    ✅ Patient data extracted successfully
[14:20:03] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:20:03] ✅    ✅ Patient identified: Carlos Camara
[14:20:03] ✅    ✅ Patient name validation passed
[14:20:03] 🔄 
🔄 Step 3: Processing patient dates...
[14:20:03] [DOC: 9285995] ℹ️  DOB normalized: 08/08/1941
[14:20:03] [DOC: 9285995] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:20:03] [DOC: 9285995] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:20:03] [DOC: 9285995] ✅ Patient date processing completed successfully
[14:20:03] ✅    ✅ Date processing completed
[14:20:03] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:20:03] 🔄 
🔄 Step 4: Extracting order data...
[14:20:06] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:20:06] ℹ️  Order extraction - Sex: ''
[14:20:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:20:06] ℹ️  Order extraction - Payer Source: ''
[14:20:06] ✅ Order data extraction completed successfully
[14:20:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:20:06] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:20:06] ⚠️  Could not determine sex using any available method
[14:20:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:20:06] ✅ Patient name cross-validation successful
[14:20:06] ✅    ✅ Data merged successfully
[14:20:07] ✅    ✅ Order data extracted and validated
[14:20:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:20:07] [DOC: 9285995] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:20:07] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:20:07] 🔄 
🔄 Step 6: Pushing order to API...
[14:20:07] [DOC: 9285995] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:20:08] [DOC: 9285995] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13433"}
[14:20:08] ❌    ❌ Failed to push order
[14:20:08] 🔄 
🔄 Step 7: Writing to CSV...
[14:20:08] [DOC: 9285995] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:20:08] [DOC: 9285995] ℹ️  Service Line extracted: 'Physical Therapy'
[14:20:08] [DOC: 9285995] ℹ️  Payer Source extracted: ''
[14:20:08] [DOC: 9285995] ℹ️  Diagnosis codes being written:
[14:20:08] [DOC: 9285995] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[14:20:08] [DOC: 9285995] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[14:20:08] [DOC: 9285995] ℹ️    - Latest_Episode_Thirddiagnosis: 'R44.3'
[14:20:08] [DOC: 9285995] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:20:08] [DOC: 9285995] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:20:08] [DOC: 9285995] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:20:08] [DOC: 9285995] ✅ Patient data written to CSV: Carlos Camara | Sex:  | Age: 83 | Service: Physical Therapy | Payer:  | MRN: MA220425084103
[14:20:08] ✅    ✅ Document 9285995 processed and saved successfully
[14:20:08] 🔄 
🔄 Step 8: Saving API details...
[14:20:08] [DOC: 9285995] ℹ️  API push details saved for document 9285995
[14:20:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9285993                         ║
================================================================================
[14:20:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:20:08] ℹ️  Date: 05/09/2025
[14:20:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:20:10] [DOC: 9285993] ✅ Text extracted using pdfplumber (1640 chars)
[14:20:10] ✅    ✅ Text extracted using pdfplumber (1640 chars)
[14:20:10] 🔄 
🔄 Step 2: Extracting patient data...
[14:20:13] ℹ️  AI extracted raw sex value: ''
[14:20:13] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[14:20:13] ℹ️  AI extracted payer source: ''
[14:20:13] ℹ️  AI extracted diagnoses:
[14:20:13] ℹ️    - Diagnosis 1: 'N39.0'
[14:20:13] ℹ️    - Diagnosis 2: 'G93.41'
[14:20:13] ℹ️    - Diagnosis 3: 'R44.3'
[14:20:13] ℹ️    - Diagnosis 4: ''
[14:20:13] ℹ️    - Diagnosis 5: ''
[14:20:13] ℹ️    - Diagnosis 6: ''
[14:20:13] ℹ️  Final extracted MRN: 'MA220425084103'
[14:20:13] ℹ️  Final extracted Sex: ''
[14:20:13] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[14:20:13] ℹ️  Final extracted Payer Source: ''
[14:20:13] ✅ Patient data extraction completed successfully
[14:20:13] ✅    ✅ Patient data extracted successfully
[14:20:13] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:20:13] ✅    ✅ Patient identified: Carlos Camara
[14:20:13] ✅    ✅ Patient name validation passed
[14:20:13] 🔄 
🔄 Step 3: Processing patient dates...
[14:20:13] [DOC: 9285993] ℹ️  DOB normalized: 08/08/1941
[14:20:13] [DOC: 9285993] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[14:20:13] [DOC: 9285993] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[14:20:13] [DOC: 9285993] ✅ Patient date processing completed successfully
[14:20:13] ✅    ✅ Date processing completed
[14:20:13] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Camara
     └─ dob: 08/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA220425084103
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'R44.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:20:13] 🔄 
🔄 Step 4: Extracting order data...
[14:20:16] ℹ️  Order extraction - MRN: 'MA220425084103'
[14:20:16] ℹ️  Order extraction - Sex: ''
[14:20:16] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[14:20:16] ℹ️  Order extraction - Payer Source: ''
[14:20:16] ✅ Order data extraction completed successfully
[14:20:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:20:16] ℹ️  Using MRN from patient data: 'MA220425084103' over 'MA220425084103'
[14:20:16] ⚠️  Could not determine sex using any available method
[14:20:16] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[14:20:16] ✅ Patient name cross-validation successful
[14:20:16] ✅    ✅ Data merged successfully
[14:20:17] ✅    ✅ Order data extracted and validated
[14:20:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:20:17] [DOC: 9285993] ✅ Patient found in local cache: Carlos Camara, ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:20:17] ✅    ✅ Existing patient found with ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:20:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:20:17] [DOC: 9285993] ℹ️  Pushing order via API for patient ID: 16e2744a-5e38-4445-8968-fe8ad953d698
[14:20:19] [DOC: 9285993] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13434"}
[14:20:19] ❌    ❌ Failed to push order
[14:20:19] 🔄 
🔄 Step 7: Writing to CSV...
[14:20:19] [DOC: 9285993] ℹ️  Calculated age: 83 from DOB: 08/08/1941
[14:20:19] [DOC: 9285993] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[14:20:19] [DOC: 9285993] ℹ️  Payer Source extracted: ''
[14:20:19] [DOC: 9285993] ℹ️  Diagnosis codes being written:
[14:20:19] [DOC: 9285993] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[14:20:19] [DOC: 9285993] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[14:20:19] [DOC: 9285993] ℹ️    - Latest_Episode_Thirddiagnosis: 'R44.3'
[14:20:19] [DOC: 9285993] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:20:19] [DOC: 9285993] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:20:19] [DOC: 9285993] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:20:19] [DOC: 9285993] ✅ Patient data written to CSV: Carlos Camara | Sex:  | Age: 83 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: MA220425084103
[14:20:19] ✅    ✅ Document 9285993 processed and saved successfully
[14:20:19] 🔄 
🔄 Step 8: Saving API details...
[14:20:19] [DOC: 9285993] ℹ️  API push details saved for document 9285993
[14:20:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2175968                         ║
================================================================================
[14:20:19] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:20:19] ℹ️  Date: 05/09/2025
[14:20:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:20:20] [DOC: 2175968] ❌ Critical failure in get_pdf_text: Invalid response format
[14:20:20] ❌ Failed to extract text for Doc ID 2175968
[14:20:20] [DOC: 2175968] ℹ️  API push details saved for document 2175968
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[14:20:20] ℹ️  Total Processed: 49
[14:20:20] ℹ️  CSV Success: 36
[14:20:20] ℹ️  CSV Errors: 5
[14:20:20] ℹ️  API Success: 0
[14:20:20] ℹ️  API Errors: 44
[14:20:20] ℹ️  CSV Success Rate: 73.5%
[14:20:20] ℹ️  API Success Rate: 0.0%
[14:20:20] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_140607.csv
[14:20:20] ℹ️  API Details File: api_outputs/api_push_details_20250607_140607.csv
================================================================================
║          ============================================================          ║
================================================================================
