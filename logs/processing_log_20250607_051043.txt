================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[05:10:43] ℹ️  CSV Data Extraction & API Push Tool
[05:10:43] ℹ️  
[05:10:43] ℹ️  Features:
[05:10:43] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[05:10:43] ℹ️  - AI-powered patient and order data extraction
[05:10:43] ℹ️  - Enhanced error handling and logging
[05:10:43] ℹ️  - Full API integration (patient creation + order pushing)
[05:10:43] ℹ️  - CSV output with comprehensive patient data
[05:10:43] ℹ️  - Detailed API tracking with remarks for every document
[05:10:43] ℹ️  - Complete audit trail of all processing attempts
[05:10:43] ℹ️  
[05:10:43] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[05:10:43] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_051043.csv
[05:10:43] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_051043.csv
================================================================================
║                        Processing Document ID: 9320629                         ║
================================================================================
[05:10:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:10:43] ℹ️  Date: 05/30/2025
[05:10:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:10:46] [DOC: 9320629] ✅ Text extracted using pdfplumber (1489 chars)
[05:10:46] ✅    ✅ Text extracted using pdfplumber (1489 chars)
[05:10:46] 🔄 
🔄 Step 2: Extracting patient data...
[05:10:51] ℹ️  AI extracted raw sex value: ''
[05:10:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:10:51] ℹ️  AI extracted payer source: ''
[05:10:51] ℹ️  AI extracted diagnoses:
[05:10:51] ℹ️    - Diagnosis 1: 'I26.99'
[05:10:51] ℹ️    - Diagnosis 2: 'M48.56X'
[05:10:51] ℹ️    - Diagnosis 3: 'I11.0'
[05:10:51] ℹ️    - Diagnosis 4: ''
[05:10:51] ℹ️    - Diagnosis 5: ''
[05:10:51] ℹ️    - Diagnosis 6: ''
[05:10:51] ℹ️  Final extracted MRN: 'MA200528053701'
[05:10:51] ℹ️  Final extracted Sex: ''
[05:10:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:10:51] ℹ️  Final extracted Payer Source: ''
[05:10:51] ✅ Patient data extraction completed successfully
[05:10:51] ✅    ✅ Patient data extracted successfully
[05:10:51] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'M48.56X', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:10:51] ✅    ✅ Patient identified: Roderick Lopez
[05:10:51] ✅    ✅ Patient name validation passed
[05:10:51] 🔄 
🔄 Step 3: Processing patient dates...
[05:10:51] [DOC: 9320629] ℹ️  DOB normalized: 05/21/1937
[05:10:51] [DOC: 9320629] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[05:10:51] [DOC: 9320629] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[05:10:51] [DOC: 9320629] ✅ Patient date processing completed successfully
[05:10:51] ✅    ✅ Date processing completed
[05:10:51] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'M48.56X', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:10:51] 🔄 
🔄 Step 4: Extracting order data...
[05:10:54] ℹ️  Order extraction - MRN: 'MA200528053701'
[05:10:54] ℹ️  Order extraction - Sex: ''
[05:10:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:10:54] ℹ️  Order extraction - Payer Source: ''
[05:10:54] ✅ Order data extraction completed successfully
[05:10:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:10:54] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[05:10:54] ℹ️  Inferred sex as MALE from name: Roderick
[05:10:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:10:54] ✅ Patient name cross-validation successful
[05:10:54] ✅    ✅ Data merged successfully
[05:10:55] ✅    ✅ Order data extracted and validated
[05:10:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:11:02] [DOC: 9320629] ℹ️  Patient not found in cache or API: Roderick Lopez
[05:11:02] [DOC: 9320629] ℹ️  Patient not found, creating new patient via API...
[05:11:02] [DOC: 9320629] ℹ️  Creating patient via API: Roderick Lopez
[05:11:03] [DOC: 9320629] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:11:03] ❌    ❌ Failed to create patient
[05:11:03] [DOC: 9320629] ℹ️  API push details saved for document 9320629
================================================================================
║                        Processing Document ID: 9320628                         ║
================================================================================
[05:11:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:11:03] ℹ️  Date: 05/30/2025
[05:11:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:11:10] [DOC: 9320628] ✅ Text extracted using pdfplumber (12205 chars)
[05:11:10] ✅    ✅ Text extracted using pdfplumber (12205 chars)
[05:11:10] 🔄 
🔄 Step 2: Extracting patient data...
[05:11:13] ℹ️  AI extracted raw sex value: ''
[05:11:13] ℹ️  AI extracted service line: 'OT'
[05:11:13] ℹ️  AI extracted payer source: ''
[05:11:13] ℹ️  AI extracted diagnoses:
[05:11:13] ℹ️    - Diagnosis 1: 'J44.1'
[05:11:13] ℹ️    - Diagnosis 2: 'I50.9'
[05:11:13] ℹ️    - Diagnosis 3: ''
[05:11:13] ℹ️    - Diagnosis 4: ''
[05:11:13] ℹ️    - Diagnosis 5: ''
[05:11:13] ℹ️    - Diagnosis 6: ''
[05:11:13] ℹ️  Final extracted MRN: 'MA200528053701'
[05:11:13] ℹ️  Final extracted Sex: ''
[05:11:13] ℹ️  Final extracted Service Line: 'OT'
[05:11:13] ℹ️  Final extracted Payer Source: ''
[05:11:13] ✅ Patient data extraction completed successfully
[05:11:13] ✅    ✅ Patient data extracted successfully
[05:11:13] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:11:13] ✅    ✅ Patient identified: Roderick Lopez
[05:11:13] ✅    ✅ Patient name validation passed
[05:11:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:11:13] [DOC: 9320628] ℹ️  DOB normalized: 05/21/1937
[05:11:13] [DOC: 9320628] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[05:11:13] [DOC: 9320628] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[05:11:13] [DOC: 9320628] ✅ Patient date processing completed successfully
[05:11:13] ✅    ✅ Date processing completed
[05:11:13] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:11:13] 🔄 
🔄 Step 4: Extracting order data...
[05:11:16] ℹ️  Order extraction - MRN: 'MA200528053701'
[05:11:16] ℹ️  Order extraction - Sex: 'MALE'
[05:11:16] ℹ️  Order extraction - Service Line: 'OT'
[05:11:16] ℹ️  Order extraction - Payer Source: ''
[05:11:16] ✅ Order data extraction completed successfully
[05:11:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:11:16] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[05:11:16] ℹ️  Service line consistent in both sources: 'OT'
[05:11:16] ✅ Patient name cross-validation successful
[05:11:16] ✅    ✅ Data merged successfully
[05:11:17] ✅    ✅ Order data extracted and validated
[05:11:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:11:40] [DOC: 9320628] ℹ️  Patient not found in cache or API: Roderick Lopez
[05:11:40] [DOC: 9320628] ℹ️  Patient not found, creating new patient via API...
[05:11:40] [DOC: 9320628] ℹ️  Creating patient via API: Roderick Lopez
[05:11:41] [DOC: 9320628] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:11:41] ❌    ❌ Failed to create patient
[05:11:41] [DOC: 9320628] ℹ️  API push details saved for document 9320628
================================================================================
║                        Processing Document ID: 9320626                         ║
================================================================================
[05:11:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:11:41] ℹ️  Date: 05/30/2025
[05:11:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:11:44] [DOC: 9320626] ✅ Text extracted using pdfplumber (17363 chars)
[05:11:44] ✅    ✅ Text extracted using pdfplumber (17363 chars)
[05:11:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:11:48] ℹ️  AI extracted raw sex value: 'F'
[05:11:48] ℹ️  AI extracted service line: 'PT'
[05:11:48] ℹ️  AI extracted payer source: 'None'
[05:11:48] ℹ️  AI extracted diagnoses:
[05:11:48] ℹ️    - Diagnosis 1: 'UTI'
[05:11:48] ℹ️    - Diagnosis 2: 'Vertigo'
[05:11:48] ℹ️    - Diagnosis 3: 'Generalized weakness'
[05:11:48] ℹ️    - Diagnosis 4: 'None'
[05:11:48] ℹ️    - Diagnosis 5: 'None'
[05:11:48] ℹ️    - Diagnosis 6: 'None'
[05:11:48] ℹ️  Final extracted MRN: '101002392'
[05:11:48] ℹ️  Final extracted Sex: 'FEMALE'
[05:11:48] ℹ️  Final extracted Service Line: 'PT'
[05:11:48] ℹ️  Final extracted Payer Source: ''
[05:11:48] ✅ Patient data extraction completed successfully
[05:11:48] ✅    ✅ Patient data extracted successfully
[05:11:48] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/17/2025', 'endOfEpisode': None, 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': 'Generalized weakness', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:11:48] ✅    ✅ Patient identified: Virginia Brunton
[05:11:48] ✅    ✅ Patient name validation passed
[05:11:48] 🔄 
🔄 Step 3: Processing patient dates...
[05:11:48] [DOC: 9320626] ℹ️  DOB normalized: 06/05/1940
[05:11:48] [DOC: 9320626] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[05:11:48] [DOC: 9320626] ✅ Patient date processing completed successfully
[05:11:48] ✅    ✅ Date processing completed
[05:11:48] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/17/2025', 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': 'Generalized weakness'}]
[05:11:48] 🔄 
🔄 Step 4: Extracting order data...
[05:11:50] ℹ️  Order extraction - MRN: '101002392'
[05:11:50] ℹ️  Order extraction - Sex: 'FEMALE'
[05:11:50] ℹ️  Order extraction - Service Line: 'PT'
[05:11:50] ℹ️  Order extraction - Payer Source: ''
[05:11:50] ✅ Order data extraction completed successfully
[05:11:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:11:50] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[05:11:50] ℹ️  Service line consistent in both sources: 'PT'
[05:11:50] ✅ Patient name cross-validation successful
[05:11:50] ✅    ✅ Data merged successfully
[05:11:52] ⚠️     ❌ Skipping - missing episode start date
[05:11:52] [DOC: 9320626] ℹ️  API push details saved for document 9320626
================================================================================
║                        Processing Document ID: 9320620                         ║
================================================================================
[05:11:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:11:52] ℹ️  Date: 05/30/2025
[05:11:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:11:55] [DOC: 9320620] ✅ Text extracted using pdfplumber (15735 chars)
[05:11:55] ✅    ✅ Text extracted using pdfplumber (15735 chars)
[05:11:55] 🔄 
🔄 Step 2: Extracting patient data...
[05:11:58] ℹ️  AI extracted raw sex value: 'F'
[05:11:58] ℹ️  AI extracted service line: 'PT'
[05:11:58] ℹ️  AI extracted payer source: 'None'
[05:11:58] ℹ️  AI extracted diagnoses:
[05:11:58] ℹ️    - Diagnosis 1: 'None'
[05:11:58] ℹ️    - Diagnosis 2: 'None'
[05:11:58] ℹ️    - Diagnosis 3: 'None'
[05:11:58] ℹ️    - Diagnosis 4: 'None'
[05:11:58] ℹ️    - Diagnosis 5: 'None'
[05:11:58] ℹ️    - Diagnosis 6: 'None'
[05:11:58] ℹ️  Final extracted MRN: 'MA250110074701'
[05:11:58] ℹ️  Final extracted Sex: 'FEMALE'
[05:11:58] ℹ️  Final extracted Service Line: 'PT'
[05:11:58] ℹ️  Final extracted Payer Source: ''
[05:11:58] ✅ Patient data extraction completed successfully
[05:11:58] ✅    ✅ Patient data extracted successfully
[05:11:58] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/12/25', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:11:58] ✅    ✅ Patient identified: Gloria Couto
[05:11:58] ✅    ✅ Patient name validation passed
[05:11:58] 🔄 
🔄 Step 3: Processing patient dates...
[05:11:58] [DOC: 9320620] ℹ️  DOB normalized: 07/30/1947
[05:11:58] [DOC: 9320620] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[05:11:58] [DOC: 9320620] ⚠️  Invalid endOfEpisode format: 07/12/25
[05:11:58] [DOC: 9320620] ✅ Patient date processing completed successfully
[05:11:58] ✅    ✅ Date processing completed
[05:11:58] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/12/25'}]
[05:11:58] 🔄 
🔄 Step 4: Extracting order data...
[05:12:00] ℹ️  Order extraction - MRN: 'MA250110074701'
[05:12:00] ℹ️  Order extraction - Sex: 'FEMALE'
[05:12:00] ℹ️  Order extraction - Service Line: 'PT'
[05:12:00] ℹ️  Order extraction - Payer Source: ''
[05:12:00] ✅ Order data extraction completed successfully
[05:12:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:12:00] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[05:12:00] ℹ️  Service line consistent in both sources: 'PT'
[05:12:00] ✅ Patient name cross-validation successful
[05:12:00] ✅    ✅ Data merged successfully
[05:12:01] ⚠️     ❌ Skipping - missing episode start date
[05:12:01] [DOC: 9320620] ℹ️  API push details saved for document 9320620
================================================================================
║                        Processing Document ID: 9320617                         ║
================================================================================
[05:12:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:12:01] ℹ️  Date: 05/30/2025
[05:12:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:12:05] [DOC: 9320617] ✅ Text extracted using pdfplumber (11878 chars)
[05:12:05] ✅    ✅ Text extracted using pdfplumber (11878 chars)
[05:12:05] 🔄 
🔄 Step 2: Extracting patient data...
[05:12:08] ℹ️  AI extracted raw sex value: 'F'
[05:12:08] ℹ️  AI extracted service line: 'OT'
[05:12:08] ℹ️  AI extracted payer source: 'None'
[05:12:08] ℹ️  AI extracted diagnoses:
[05:12:08] ℹ️    - Diagnosis 1: 'None'
[05:12:08] ℹ️    - Diagnosis 2: 'None'
[05:12:08] ℹ️    - Diagnosis 3: 'None'
[05:12:08] ℹ️    - Diagnosis 4: 'None'
[05:12:08] ℹ️    - Diagnosis 5: 'None'
[05:12:08] ℹ️    - Diagnosis 6: 'None'
[05:12:08] ℹ️  Final extracted MRN: 'MA250110074701'
[05:12:08] ℹ️  Final extracted Sex: 'FEMALE'
[05:12:08] ℹ️  Final extracted Service Line: 'OT'
[05:12:08] ℹ️  Final extracted Payer Source: ''
[05:12:08] ✅ Patient data extraction completed successfully
[05:12:08] ✅    ✅ Patient data extracted successfully
[05:12:08] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:12:08] ✅    ✅ Patient identified: Gloria Couto
[05:12:08] ✅    ✅ Patient name validation passed
[05:12:08] 🔄 
🔄 Step 3: Processing patient dates...
[05:12:08] [DOC: 9320617] ℹ️  DOB normalized: 07/30/1947
[05:12:08] [DOC: 9320617] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[05:12:08] [DOC: 9320617] ℹ️  Episode endOfEpisode normalized: 02/26/2025
[05:12:08] [DOC: 9320617] ✅ Patient date processing completed successfully
[05:12:08] ✅    ✅ Date processing completed
[05:12:08] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025'}]
[05:12:08] 🔄 
🔄 Step 4: Extracting order data...
[05:12:10] ℹ️  Order extraction - MRN: 'MA250110074701'
[05:12:10] ℹ️  Order extraction - Sex: 'FEMALE'
[05:12:10] ℹ️  Order extraction - Service Line: 'OT'
[05:12:10] ℹ️  Order extraction - Payer Source: ''
[05:12:10] ✅ Order data extraction completed successfully
[05:12:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:12:10] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[05:12:10] ℹ️  Service line consistent in both sources: 'OT'
[05:12:10] ✅ Patient name cross-validation successful
[05:12:10] ✅    ✅ Data merged successfully
[05:12:11] ⚠️     ❌ Skipping - missing episode start date
[05:12:11] [DOC: 9320617] ℹ️  API push details saved for document 9320617
================================================================================
║                        Processing Document ID: 9320613                         ║
================================================================================
[05:12:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:12:11] ℹ️  Date: 05/30/2025
[05:12:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:12:16] [DOC: 9320613] ✅ Text extracted using pdfplumber (1108 chars)
[05:12:16] ✅    ✅ Text extracted using pdfplumber (1108 chars)
[05:12:16] 🔄 
🔄 Step 2: Extracting patient data...
[05:12:19] ℹ️  AI extracted raw sex value: ''
[05:12:19] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:12:19] ℹ️  AI extracted payer source: ''
[05:12:19] ℹ️  AI extracted diagnoses:
[05:12:19] ℹ️    - Diagnosis 1: 'E11.59'
[05:12:19] ℹ️    - Diagnosis 2: 'I15.2'
[05:12:19] ℹ️    - Diagnosis 3: 'N30.00'
[05:12:19] ℹ️    - Diagnosis 4: ''
[05:12:19] ℹ️    - Diagnosis 5: ''
[05:12:19] ℹ️    - Diagnosis 6: ''
[05:12:19] ℹ️  Final extracted MRN: 'MA250110074701'
[05:12:19] ℹ️  Final extracted Sex: ''
[05:12:19] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:12:19] ℹ️  Final extracted Payer Source: ''
[05:12:19] ✅ Patient data extraction completed successfully
[05:12:19] ✅    ✅ Patient data extracted successfully
[05:12:19] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:12:19] ✅    ✅ Patient identified: Gloria Couto
[05:12:19] ✅    ✅ Patient name validation passed
[05:12:19] 🔄 
🔄 Step 3: Processing patient dates...
[05:12:19] [DOC: 9320613] ℹ️  DOB normalized: 07/30/1947
[05:12:19] [DOC: 9320613] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[05:12:19] [DOC: 9320613] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[05:12:19] [DOC: 9320613] ✅ Patient date processing completed successfully
[05:12:19] ✅    ✅ Date processing completed
[05:12:19] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:12:19] 🔄 
🔄 Step 4: Extracting order data...
[05:12:22] ℹ️  Order extraction - MRN: 'MA250110074701'
[05:12:22] ℹ️  Order extraction - Sex: ''
[05:12:22] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:12:22] ℹ️  Order extraction - Payer Source: ''
[05:12:22] ✅ Order data extraction completed successfully
[05:12:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:12:22] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[05:12:22] ⚠️  Could not determine sex using any available method
[05:12:22] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:12:22] ✅ Patient name cross-validation successful
[05:12:22] ✅    ✅ Data merged successfully
[05:12:23] ✅    ✅ Order data extracted and validated
[05:12:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:12:41] [DOC: 9320613] ✅ Patient exists in API: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[05:12:41] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[05:12:41] 🔄 
🔄 Step 6: Pushing order to API...
[05:12:41] [DOC: 9320613] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[05:12:42] [DOC: 9320613] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18805"}
[05:12:42] ❌    ❌ Failed to push order
[05:12:42] 🔄 
🔄 Step 7: Writing to CSV...
[05:12:42] [DOC: 9320613] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[05:12:42] [DOC: 9320613] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:12:42] [DOC: 9320613] ℹ️  Payer Source extracted: ''
[05:12:42] [DOC: 9320613] ℹ️  Diagnosis codes being written:
[05:12:42] [DOC: 9320613] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.59'
[05:12:42] [DOC: 9320613] ℹ️    - Latest_Episode_Seconddiagnosis: 'I15.2'
[05:12:42] [DOC: 9320613] ℹ️    - Latest_Episode_Thirddiagnosis: 'N30.00'
[05:12:42] [DOC: 9320613] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:12:42] [DOC: 9320613] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:12:42] [DOC: 9320613] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:12:42] [DOC: 9320613] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[05:12:42] ✅    ✅ Document 9320613 processed and saved successfully
[05:12:42] 🔄 
🔄 Step 8: Saving API details...
[05:12:42] [DOC: 9320613] ℹ️  API push details saved for document 9320613
[05:12:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320611                         ║
================================================================================
[05:12:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:12:42] ℹ️  Date: 05/30/2025
[05:12:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:12:44] [DOC: 9320611] ✅ Text extracted using pdfplumber (1234 chars)
[05:12:44] ✅    ✅ Text extracted using pdfplumber (1234 chars)
[05:12:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:12:47] ℹ️  AI extracted raw sex value: ''
[05:12:47] ℹ️  AI extracted service line: 'Physical Therapy'
[05:12:47] ℹ️  AI extracted payer source: ''
[05:12:47] ℹ️  AI extracted diagnoses:
[05:12:47] ℹ️    - Diagnosis 1: 'E11.59'
[05:12:47] ℹ️    - Diagnosis 2: 'I15.2'
[05:12:47] ℹ️    - Diagnosis 3: 'N30.00'
[05:12:47] ℹ️    - Diagnosis 4: ''
[05:12:47] ℹ️    - Diagnosis 5: ''
[05:12:47] ℹ️    - Diagnosis 6: ''
[05:12:47] ℹ️  Final extracted MRN: 'MA250110074701'
[05:12:47] ℹ️  Final extracted Sex: ''
[05:12:47] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:12:47] ℹ️  Final extracted Payer Source: ''
[05:12:47] ✅ Patient data extraction completed successfully
[05:12:47] ✅    ✅ Patient data extracted successfully
[05:12:47] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:12:47] ✅    ✅ Patient identified: Gloria Couto
[05:12:47] ✅    ✅ Patient name validation passed
[05:12:47] 🔄 
🔄 Step 3: Processing patient dates...
[05:12:47] [DOC: 9320611] ℹ️  DOB normalized: 07/30/1947
[05:12:47] [DOC: 9320611] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[05:12:47] [DOC: 9320611] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[05:12:47] [DOC: 9320611] ✅ Patient date processing completed successfully
[05:12:47] ✅    ✅ Date processing completed
[05:12:47] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:12:47] 🔄 
🔄 Step 4: Extracting order data...
[05:12:50] ℹ️  Order extraction - MRN: 'MA250110074701'
[05:12:50] ℹ️  Order extraction - Sex: ''
[05:12:50] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:12:50] ℹ️  Order extraction - Payer Source: ''
[05:12:50] ✅ Order data extraction completed successfully
[05:12:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:12:50] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[05:12:50] ⚠️  Could not determine sex using any available method
[05:12:50] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:12:50] ✅ Patient name cross-validation successful
[05:12:50] ✅    ✅ Data merged successfully
[05:12:51] ✅    ✅ Order data extracted and validated
[05:12:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:12:51] [DOC: 9320611] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[05:12:51] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[05:12:51] 🔄 
🔄 Step 6: Pushing order to API...
[05:12:51] [DOC: 9320611] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[05:12:52] [DOC: 9320611] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18806"}
[05:12:52] ❌    ❌ Failed to push order
[05:12:52] 🔄 
🔄 Step 7: Writing to CSV...
[05:12:52] [DOC: 9320611] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[05:12:52] [DOC: 9320611] ℹ️  Service Line extracted: 'Physical Therapy'
[05:12:52] [DOC: 9320611] ℹ️  Payer Source extracted: ''
[05:12:52] [DOC: 9320611] ℹ️  Diagnosis codes being written:
[05:12:52] [DOC: 9320611] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.59'
[05:12:52] [DOC: 9320611] ℹ️    - Latest_Episode_Seconddiagnosis: 'I15.2'
[05:12:52] [DOC: 9320611] ℹ️    - Latest_Episode_Thirddiagnosis: 'N30.00'
[05:12:52] [DOC: 9320611] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:12:52] [DOC: 9320611] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:12:52] [DOC: 9320611] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:12:52] [DOC: 9320611] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy | Payer:  | MRN: MA250110074701
[05:12:52] ✅    ✅ Document 9320611 processed and saved successfully
[05:12:52] 🔄 
🔄 Step 8: Saving API details...
[05:12:52] [DOC: 9320611] ℹ️  API push details saved for document 9320611
[05:12:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320453                         ║
================================================================================
[05:12:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:12:52] ℹ️  Date: 05/30/2025
[05:12:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:01] [DOC: 9320453] ✅ Text extracted using pdfplumber (12787 chars)
[05:13:01] ✅    ✅ Text extracted using pdfplumber (12787 chars)
[05:13:01] 🔄 
🔄 Step 2: Extracting patient data...
[05:13:04] ℹ️  AI extracted raw sex value: 'M'
[05:13:04] ℹ️  AI extracted service line: 'PT'
[05:13:04] ℹ️  AI extracted payer source: ''
[05:13:04] ℹ️  AI extracted diagnoses:
[05:13:04] ℹ️    - Diagnosis 1: 'Q90.9'
[05:13:04] ℹ️    - Diagnosis 2: 'R53.81'
[05:13:04] ℹ️    - Diagnosis 3: 'J45.909'
[05:13:04] ℹ️    - Diagnosis 4: 'I27.89'
[05:13:04] ℹ️    - Diagnosis 5: 'E03.9'
[05:13:04] ℹ️    - Diagnosis 6: 'G47.33'
[05:13:04] ℹ️  Final extracted MRN: 'MA240808027001'
[05:13:04] ℹ️  Final extracted Sex: 'MALE'
[05:13:04] ℹ️  Final extracted Service Line: 'PT'
[05:13:04] ℹ️  Final extracted Payer Source: ''
[05:13:04] ✅ Patient data extraction completed successfully
[05:13:04] ✅    ✅ Patient data extracted successfully
[05:13:04] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Q90.9', 'secondDiagnosis': 'R53.81', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I27.89', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[05:13:04] ✅    ✅ Patient identified: Rafael Talavera
[05:13:04] ✅    ✅ Patient name validation passed
[05:13:04] 🔄 
🔄 Step 3: Processing patient dates...
[05:13:04] [DOC: 9320453] ℹ️  DOB normalized: 02/10/1970
[05:13:04] [DOC: 9320453] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[05:13:04] [DOC: 9320453] ✅ Patient date processing completed successfully
[05:13:04] ✅    ✅ Date processing completed
[05:13:04] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Q90.9', 'secondDiagnosis': 'R53.81', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I27.89', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[05:13:04] 🔄 
🔄 Step 4: Extracting order data...
[05:13:06] ℹ️  Order extraction - MRN: 'MA240808027001'
[05:13:06] ℹ️  Order extraction - Sex: 'MALE'
[05:13:06] ℹ️  Order extraction - Service Line: 'PT'
[05:13:06] ℹ️  Order extraction - Payer Source: ''
[05:13:06] ✅ Order data extraction completed successfully
[05:13:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:13:06] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[05:13:06] ℹ️  Service line consistent in both sources: 'PT'
[05:13:06] ✅ Patient name cross-validation successful
[05:13:06] ✅    ✅ Data merged successfully
[05:13:07] ⚠️     ❌ Skipping - missing episode start date
[05:13:07] [DOC: 9320453] ℹ️  API push details saved for document 9320453
================================================================================
║                        Processing Document ID: 9320447                         ║
================================================================================
[05:13:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:13:07] ℹ️  Date: 05/30/2025
[05:13:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:10] [DOC: 9320447] ✅ Text extracted using pdfplumber (1077 chars)
[05:13:10] ✅    ✅ Text extracted using pdfplumber (1077 chars)
[05:13:10] 🔄 
🔄 Step 2: Extracting patient data...
[05:13:13] ℹ️  AI extracted raw sex value: ''
[05:13:13] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:13:13] ℹ️  AI extracted payer source: ''
[05:13:13] ℹ️  AI extracted diagnoses:
[05:13:13] ℹ️    - Diagnosis 1: 'J96.01'
[05:13:13] ℹ️    - Diagnosis 2: 'Q90.9'
[05:13:13] ℹ️    - Diagnosis 3: 'E66.01'
[05:13:13] ℹ️    - Diagnosis 4: 'None'
[05:13:13] ℹ️    - Diagnosis 5: 'None'
[05:13:13] ℹ️    - Diagnosis 6: 'None'
[05:13:13] ℹ️  Final extracted MRN: 'MA240808027001'
[05:13:13] ℹ️  Final extracted Sex: ''
[05:13:13] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:13:13] ℹ️  Final extracted Payer Source: ''
[05:13:13] ✅ Patient data extraction completed successfully
[05:13:13] ✅    ✅ Patient data extracted successfully
[05:13:13] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: 
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:13:13] ✅    ✅ Patient identified: Rafael Talavera
[05:13:13] ✅    ✅ Patient name validation passed
[05:13:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:13:13] [DOC: 9320447] ℹ️  DOB normalized: 02/10/1970
[05:13:13] [DOC: 9320447] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:13:13] [DOC: 9320447] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:13:13] [DOC: 9320447] ✅ Patient date processing completed successfully
[05:13:13] ✅    ✅ Date processing completed
[05:13:13] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: 
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01'}]
[05:13:13] 🔄 
🔄 Step 4: Extracting order data...
[05:13:15] ℹ️  Order extraction - MRN: 'MA240808027001'
[05:13:15] ℹ️  Order extraction - Sex: ''
[05:13:15] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:13:15] ℹ️  Order extraction - Payer Source: ''
[05:13:15] ✅ Order data extraction completed successfully
[05:13:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:13:15] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[05:13:15] ⚠️  Could not determine sex using any available method
[05:13:15] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:13:15] ✅ Patient name cross-validation successful
[05:13:15] ✅    ✅ Data merged successfully
[05:13:17] ✅    ✅ Order data extracted and validated
[05:13:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:13:24] [DOC: 9320447] ✅ Patient exists in API: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:13:24] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:13:24] 🔄 
🔄 Step 6: Pushing order to API...
[05:13:24] [DOC: 9320447] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:13:25] [DOC: 9320447] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18809"}
[05:13:25] ❌    ❌ Failed to push order
[05:13:25] 🔄 
🔄 Step 7: Writing to CSV...
[05:13:25] [DOC: 9320447] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[05:13:25] [DOC: 9320447] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:13:25] [DOC: 9320447] ℹ️  Payer Source extracted: ''
[05:13:25] [DOC: 9320447] ℹ️  Diagnosis codes being written:
[05:13:25] [DOC: 9320447] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.01'
[05:13:25] [DOC: 9320447] ℹ️    - Latest_Episode_Seconddiagnosis: 'Q90.9'
[05:13:25] [DOC: 9320447] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.01'
[05:13:25] [DOC: 9320447] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:13:25] [DOC: 9320447] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:13:25] [DOC: 9320447] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:13:25] [DOC: 9320447] ✅ Patient data written to CSV: Rafael Talavera | Sex:  | Age: 55 | Service: Occupational Therapy | Payer:  | MRN: MA240808027001
[05:13:25] ✅    ✅ Document 9320447 processed and saved successfully
[05:13:25] 🔄 
🔄 Step 8: Saving API details...
[05:13:25] [DOC: 9320447] ℹ️  API push details saved for document 9320447
[05:13:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320443                         ║
================================================================================
[05:13:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:13:25] ℹ️  Date: 05/30/2025
[05:13:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:27] [DOC: 9320443] ✅ Text extracted using pdfplumber (1388 chars)
[05:13:27] ✅    ✅ Text extracted using pdfplumber (1376 chars)
[05:13:27] 🔄 
🔄 Step 2: Extracting patient data...
[05:13:30] ℹ️  AI extracted raw sex value: ''
[05:13:30] ℹ️  AI extracted service line: 'Physical Therapy'
[05:13:30] ℹ️  AI extracted payer source: ''
[05:13:30] ℹ️  AI extracted diagnoses:
[05:13:30] ℹ️    - Diagnosis 1: 'S22.42X'
[05:13:30] ℹ️    - Diagnosis 2: 'S06.5X0'
[05:13:30] ℹ️    - Diagnosis 3: 'S80.211'
[05:13:30] ℹ️    - Diagnosis 4: ''
[05:13:30] ℹ️    - Diagnosis 5: ''
[05:13:30] ℹ️    - Diagnosis 6: ''
[05:13:30] ℹ️  Final extracted MRN: 'MA250505025302'
[05:13:30] ℹ️  Final extracted Sex: ''
[05:13:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:13:30] ℹ️  Final extracted Payer Source: ''
[05:13:30] ✅ Patient data extraction completed successfully
[05:13:30] ✅    ✅ Patient data extracted successfully
[05:13:30] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Smigel
     └─ dob: 02/15/1953
     └─ patientSex: 
     └─ medicalRecordNo: MA250505025302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'S22.42X', 'secondDiagnosis': 'S06.5X0', 'thirdDiagnosis': 'S80.211', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:13:30] ✅    ✅ Patient identified: Kathleen Smigel
[05:13:30] ✅    ✅ Patient name validation passed
[05:13:30] 🔄 
🔄 Step 3: Processing patient dates...
[05:13:30] [DOC: 9320443] ℹ️  DOB normalized: 02/15/1953
[05:13:30] [DOC: 9320443] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[05:13:30] [DOC: 9320443] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[05:13:30] [DOC: 9320443] ✅ Patient date processing completed successfully
[05:13:30] ✅    ✅ Date processing completed
[05:13:30] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Smigel
     └─ dob: 02/15/1953
     └─ patientSex: 
     └─ medicalRecordNo: MA250505025302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'S22.42X', 'secondDiagnosis': 'S06.5X0', 'thirdDiagnosis': 'S80.211', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:13:30] 🔄 
🔄 Step 4: Extracting order data...
[05:13:33] ℹ️  Order extraction - MRN: 'MA250505025302'
[05:13:33] ℹ️  Order extraction - Sex: ''
[05:13:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:13:33] ℹ️  Order extraction - Payer Source: ''
[05:13:33] ✅ Order data extraction completed successfully
[05:13:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:13:33] ℹ️  Using MRN from patient data: 'MA250505025302' over 'MA250505025302'
[05:13:33] ⚠️  Could not determine sex using any available method
[05:13:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:13:33] ✅ Patient name cross-validation successful
[05:13:33] ✅    ✅ Data merged successfully
[05:13:34] ✅    ✅ Order data extracted and validated
[05:13:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:13:51] [DOC: 9320443] ℹ️  Patient not found in cache or API: Kathleen Smigel
[05:13:51] [DOC: 9320443] ℹ️  Patient not found, creating new patient via API...
[05:13:51] [DOC: 9320443] ℹ️  Creating patient via API: Kathleen Smigel
[05:13:53] [DOC: 9320443] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:13:53] ❌    ❌ Failed to create patient
[05:13:53] [DOC: 9320443] ℹ️  API push details saved for document 9320443
================================================================================
║                        Processing Document ID: 9320434                         ║
================================================================================
[05:13:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:13:53] ℹ️  Date: 05/30/2025
[05:13:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:55] [DOC: 9320434] ✅ Text extracted using pdfplumber (1100 chars)
[05:13:55] ✅    ✅ Text extracted using pdfplumber (1100 chars)
[05:13:55] 🔄 
🔄 Step 2: Extracting patient data...
[05:13:58] ℹ️  AI extracted raw sex value: ''
[05:13:58] ℹ️  AI extracted service line: 'Physical Therapy'
[05:13:58] ℹ️  AI extracted payer source: ''
[05:13:58] ℹ️  AI extracted diagnoses:
[05:13:58] ℹ️    - Diagnosis 1: 'M67.813'
[05:13:58] ℹ️    - Diagnosis 2: 'M67.814'
[05:13:58] ℹ️    - Diagnosis 3: 'M15.9'
[05:13:58] ℹ️    - Diagnosis 4: 'None'
[05:13:58] ℹ️    - Diagnosis 5: 'None'
[05:13:58] ℹ️    - Diagnosis 6: 'None'
[05:13:58] ℹ️  Final extracted MRN: 'MA230420103801'
[05:13:58] ℹ️  Final extracted Sex: ''
[05:13:58] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:13:58] ℹ️  Final extracted Payer Source: ''
[05:13:58] ✅ Patient data extraction completed successfully
[05:13:58] ✅    ✅ Patient data extracted successfully
[05:13:58] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:13:58] ✅    ✅ Patient identified: Alfredo Santos
[05:13:58] ✅    ✅ Patient name validation passed
[05:13:58] 🔄 
🔄 Step 3: Processing patient dates...
[05:13:58] [DOC: 9320434] ℹ️  DOB normalized: 10/24/1938
[05:13:58] [DOC: 9320434] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[05:13:58] [DOC: 9320434] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[05:13:58] [DOC: 9320434] ✅ Patient date processing completed successfully
[05:13:58] ✅    ✅ Date processing completed
[05:13:58] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9'}]
[05:13:58] 🔄 
🔄 Step 4: Extracting order data...
[05:14:01] ℹ️  Order extraction - MRN: 'MA230420103801'
[05:14:01] ℹ️  Order extraction - Sex: ''
[05:14:01] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:14:01] ℹ️  Order extraction - Payer Source: ''
[05:14:01] ✅ Order data extraction completed successfully
[05:14:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:01] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[05:14:01] ⚠️  Could not determine sex using any available method
[05:14:01] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:14:01] ✅ Patient name cross-validation successful
[05:14:01] ✅    ✅ Data merged successfully
[05:14:02] ✅    ✅ Order data extracted and validated
[05:14:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:21] [DOC: 9320434] ✅ Patient exists in API: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:14:21] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:14:21] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:21] [DOC: 9320434] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:14:22] [DOC: 9320434] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18811"}
[05:14:22] ❌    ❌ Failed to push order
[05:14:22] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:22] [DOC: 9320434] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[05:14:22] [DOC: 9320434] ℹ️  Service Line extracted: 'Physical Therapy'
[05:14:22] [DOC: 9320434] ℹ️  Payer Source extracted: ''
[05:14:22] [DOC: 9320434] ℹ️  Diagnosis codes being written:
[05:14:22] [DOC: 9320434] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[05:14:22] [DOC: 9320434] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[05:14:22] [DOC: 9320434] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[05:14:22] [DOC: 9320434] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:14:22] [DOC: 9320434] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:14:22] [DOC: 9320434] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:14:22] [DOC: 9320434] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Physical Therapy | Payer:  | MRN: MA230420103801
[05:14:22] ✅    ✅ Document 9320434 processed and saved successfully
[05:14:22] 🔄 
🔄 Step 8: Saving API details...
[05:14:22] [DOC: 9320434] ℹ️  API push details saved for document 9320434
[05:14:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320431                         ║
================================================================================
[05:14:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:14:22] ℹ️  Date: 05/30/2025
[05:14:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:25] [DOC: 9320431] ✅ Text extracted using pdfplumber (1162 chars)
[05:14:25] ✅    ✅ Text extracted using pdfplumber (1162 chars)
[05:14:25] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:28] ℹ️  AI extracted raw sex value: ''
[05:14:28] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:14:28] ℹ️  AI extracted payer source: ''
[05:14:28] ℹ️  AI extracted diagnoses:
[05:14:28] ℹ️    - Diagnosis 1: 'M67.813'
[05:14:28] ℹ️    - Diagnosis 2: 'M67.814'
[05:14:28] ℹ️    - Diagnosis 3: 'M15.9'
[05:14:28] ℹ️    - Diagnosis 4: 'None'
[05:14:28] ℹ️    - Diagnosis 5: 'None'
[05:14:28] ℹ️    - Diagnosis 6: 'None'
[05:14:28] ℹ️  Final extracted MRN: 'MA230420103801'
[05:14:28] ℹ️  Final extracted Sex: ''
[05:14:28] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:14:28] ℹ️  Final extracted Payer Source: ''
[05:14:28] ✅ Patient data extraction completed successfully
[05:14:28] ✅    ✅ Patient data extracted successfully
[05:14:28] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:14:28] ✅    ✅ Patient identified: Alfredo Santos
[05:14:28] ✅    ✅ Patient name validation passed
[05:14:28] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:28] [DOC: 9320431] ℹ️  DOB normalized: 10/24/1938
[05:14:28] [DOC: 9320431] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[05:14:28] [DOC: 9320431] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[05:14:28] [DOC: 9320431] ✅ Patient date processing completed successfully
[05:14:28] ✅    ✅ Date processing completed
[05:14:28] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9'}]
[05:14:28] 🔄 
🔄 Step 4: Extracting order data...
[05:14:30] ℹ️  Order extraction - MRN: 'MA230420103801'
[05:14:30] ℹ️  Order extraction - Sex: ''
[05:14:30] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:14:30] ℹ️  Order extraction - Payer Source: ''
[05:14:30] ✅ Order data extraction completed successfully
[05:14:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:30] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[05:14:30] ⚠️  Could not determine sex using any available method
[05:14:30] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:14:30] ✅ Patient name cross-validation successful
[05:14:30] ✅    ✅ Data merged successfully
[05:14:31] ✅    ✅ Order data extracted and validated
[05:14:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:31] [DOC: 9320431] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:14:31] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:14:31] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:31] [DOC: 9320431] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:14:32] [DOC: 9320431] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18812"}
[05:14:32] ❌    ❌ Failed to push order
[05:14:32] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:32] [DOC: 9320431] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[05:14:32] [DOC: 9320431] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:14:32] [DOC: 9320431] ℹ️  Payer Source extracted: ''
[05:14:32] [DOC: 9320431] ℹ️  Diagnosis codes being written:
[05:14:32] [DOC: 9320431] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[05:14:32] [DOC: 9320431] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[05:14:32] [DOC: 9320431] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[05:14:32] [DOC: 9320431] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:14:32] [DOC: 9320431] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:14:32] [DOC: 9320431] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:14:32] [DOC: 9320431] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Occupational Therapy | Payer:  | MRN: MA230420103801
[05:14:32] ✅    ✅ Document 9320431 processed and saved successfully
[05:14:32] 🔄 
🔄 Step 8: Saving API details...
[05:14:32] [DOC: 9320431] ℹ️  API push details saved for document 9320431
[05:14:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320425                         ║
================================================================================
[05:14:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:14:32] ℹ️  Date: 05/30/2025
[05:14:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:38] [DOC: 9320425] ✅ Text extracted using pdfplumber (1287 chars)
[05:14:38] ✅    ✅ Text extracted using pdfplumber (1275 chars)
[05:14:38] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:41] ℹ️  AI extracted raw sex value: ''
[05:14:41] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:14:41] ℹ️  AI extracted payer source: ''
[05:14:41] ℹ️  AI extracted diagnoses:
[05:14:41] ℹ️    - Diagnosis 1: 'I11.0'
[05:14:41] ℹ️    - Diagnosis 2: 'I50.9'
[05:14:41] ℹ️    - Diagnosis 3: 'E11.9'
[05:14:41] ℹ️    - Diagnosis 4: ''
[05:14:41] ℹ️    - Diagnosis 5: ''
[05:14:41] ℹ️    - Diagnosis 6: ''
[05:14:41] ℹ️  Final extracted MRN: 'MA200210084304'
[05:14:41] ℹ️  Final extracted Sex: ''
[05:14:41] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:14:41] ℹ️  Final extracted Payer Source: ''
[05:14:41] ✅ Patient data extraction completed successfully
[05:14:41] ✅    ✅ Patient data extracted successfully
[05:14:41] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:41] ✅    ✅ Patient identified: Mary Lima
[05:14:41] ✅    ✅ Patient name validation passed
[05:14:41] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:41] [DOC: 9320425] ℹ️  DOB normalized: 08/18/1943
[05:14:41] [DOC: 9320425] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:14:41] [DOC: 9320425] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:14:41] [DOC: 9320425] ✅ Patient date processing completed successfully
[05:14:41] ✅    ✅ Date processing completed
[05:14:41] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:41] 🔄 
🔄 Step 4: Extracting order data...
[05:14:44] ℹ️  Order extraction - MRN: 'MA200210084304'
[05:14:44] ℹ️  Order extraction - Sex: ''
[05:14:44] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:14:44] ℹ️  Order extraction - Payer Source: ''
[05:14:44] ✅ Order data extraction completed successfully
[05:14:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:44] ℹ️  Using MRN from patient data: 'MA200210084304' over 'MA200210084304'
[05:14:44] ℹ️  Inferred sex as FEMALE from name: Mary
[05:14:44] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:14:44] ✅ Patient name cross-validation successful
[05:14:44] ✅    ✅ Data merged successfully
[05:14:45] ✅    ✅ Order data extracted and validated
[05:14:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:50] [DOC: 9320425] ✅ Patient exists in API: Mary Lima, ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:14:50] ✅    ✅ Existing patient found with ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:14:50] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:50] [DOC: 9320425] ℹ️  Pushing order via API for patient ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:14:51] [DOC: 9320425] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18813"}
[05:14:51] ❌    ❌ Failed to push order
[05:14:51] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:51] [DOC: 9320425] ℹ️  Calculated age: 81 from DOB: 08/18/1943
[05:14:51] [DOC: 9320425] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:14:51] [DOC: 9320425] ℹ️  Payer Source extracted: ''
[05:14:51] [DOC: 9320425] ℹ️  Diagnosis codes being written:
[05:14:51] [DOC: 9320425] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:14:51] [DOC: 9320425] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[05:14:51] [DOC: 9320425] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[05:14:51] [DOC: 9320425] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:14:51] [DOC: 9320425] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:14:51] [DOC: 9320425] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:14:51] [DOC: 9320425] ✅ Patient data written to CSV: Mary Lima | Sex: FEMALE | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: MA200210084304
[05:14:51] ✅    ✅ Document 9320425 processed and saved successfully
[05:14:51] 🔄 
🔄 Step 8: Saving API details...
[05:14:51] [DOC: 9320425] ℹ️  API push details saved for document 9320425
[05:14:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320174                         ║
================================================================================
[05:14:51] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:14:51] ℹ️  Date: 05/30/2025
[05:14:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:53] [DOC: 9320174] ✅ Text extracted using pdfplumber (1416 chars)
[05:14:53] ✅    ✅ Text extracted using pdfplumber (1404 chars)
[05:14:53] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:56] ℹ️  AI extracted raw sex value: ''
[05:14:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:14:56] ℹ️  AI extracted payer source: 'Medicare'
[05:14:56] ℹ️  AI extracted diagnoses:
[05:14:56] ℹ️    - Diagnosis 1: ''
[05:14:56] ℹ️    - Diagnosis 2: ''
[05:14:56] ℹ️    - Diagnosis 3: ''
[05:14:56] ℹ️    - Diagnosis 4: ''
[05:14:56] ℹ️    - Diagnosis 5: ''
[05:14:56] ℹ️    - Diagnosis 6: ''
[05:14:56] ℹ️  Final extracted MRN: '28700203358401'
[05:14:56] ℹ️  Final extracted Sex: ''
[05:14:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:14:56] ℹ️  Final extracted Payer Source: 'Medicare'
[05:14:56] ✅ Patient data extraction completed successfully
[05:14:56] ✅    ✅ Patient data extracted successfully
[05:14:56] 📊 Patient Response
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:56] ✅    ✅ Patient identified: JEANNE ARSENAULT
[05:14:56] ✅    ✅ Patient name validation passed
[05:14:56] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:56] [DOC: 9320174] ℹ️  DOB normalized: 06/24/1945
[05:14:56] [DOC: 9320174] ℹ️  Episode startOfEpisode normalized: 01/19/2025
[05:14:56] [DOC: 9320174] ℹ️  Episode endOfEpisode normalized: 01/22/2025
[05:14:56] [DOC: 9320174] ✅ Patient date processing completed successfully
[05:14:56] ✅    ✅ Date processing completed
[05:14:56] 📊 Processed Patient Data
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:56] 🔄 
🔄 Step 4: Extracting order data...
[05:14:59] ℹ️  Order extraction - MRN: '28700203358401'
[05:14:59] ℹ️  Order extraction - Sex: ''
[05:14:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:14:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:14:59] ✅ Order data extraction completed successfully
[05:14:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:59] ℹ️  Using MRN from patient data: '28700203358401' over '28700203358401'
[05:14:59] ⚠️  Could not determine sex using any available method
[05:14:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:14:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:14:59] ✅ Patient name cross-validation successful
[05:14:59] ✅    ✅ Data merged successfully
[05:15:00] ✅    ✅ Order data extracted and validated
[05:15:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:15:08] [DOC: 9320174] ℹ️  Patient not found in cache or API: JEANNE ARSENAULT
[05:15:08] [DOC: 9320174] ℹ️  Patient not found, creating new patient via API...
[05:15:08] [DOC: 9320174] ℹ️  Creating patient via API: JEANNE ARSENAULT
[05:15:09] [DOC: 9320174] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:15:09] ❌    ❌ Failed to create patient
[05:15:09] [DOC: 9320174] ℹ️  API push details saved for document 9320174
================================================================================
║                        Processing Document ID: 9320422                         ║
================================================================================
[05:15:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:15:09] ℹ️  Date: 05/30/2025
[05:15:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:15:11] [DOC: 9320422] ✅ Text extracted using pdfplumber (1302 chars)
[05:15:11] ✅    ✅ Text extracted using pdfplumber (1290 chars)
[05:15:11] 🔄 
🔄 Step 2: Extracting patient data...
[05:15:14] ℹ️  AI extracted raw sex value: ''
[05:15:14] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[05:15:14] ℹ️  AI extracted payer source: ''
[05:15:14] ℹ️  AI extracted diagnoses:
[05:15:14] ℹ️    - Diagnosis 1: 'I11.0'
[05:15:14] ℹ️    - Diagnosis 2: 'I50.9'
[05:15:14] ℹ️    - Diagnosis 3: 'E11.9'
[05:15:14] ℹ️    - Diagnosis 4: ''
[05:15:14] ℹ️    - Diagnosis 5: ''
[05:15:14] ℹ️    - Diagnosis 6: ''
[05:15:14] ℹ️  Final extracted MRN: 'MA200210084304'
[05:15:14] ℹ️  Final extracted Sex: ''
[05:15:14] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[05:15:14] ℹ️  Final extracted Payer Source: ''
[05:15:14] ✅ Patient data extraction completed successfully
[05:15:14] ✅    ✅ Patient data extracted successfully
[05:15:14] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:15:14] ✅    ✅ Patient identified: Mary Lima
[05:15:14] ✅    ✅ Patient name validation passed
[05:15:14] 🔄 
🔄 Step 3: Processing patient dates...
[05:15:14] [DOC: 9320422] ℹ️  DOB normalized: 08/18/1943
[05:15:14] [DOC: 9320422] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:15:14] [DOC: 9320422] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:15:14] [DOC: 9320422] ✅ Patient date processing completed successfully
[05:15:14] ✅    ✅ Date processing completed
[05:15:14] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:15:14] 🔄 
🔄 Step 4: Extracting order data...
[05:15:17] ℹ️  Order extraction - MRN: 'MA200210084304'
[05:15:17] ℹ️  Order extraction - Sex: ''
[05:15:17] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[05:15:17] ℹ️  Order extraction - Payer Source: ''
[05:15:17] ✅ Order data extraction completed successfully
[05:15:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:15:17] ℹ️  Using MRN from patient data: 'MA200210084304' over 'MA200210084304'
[05:15:17] ℹ️  Inferred sex as FEMALE from name: Mary
[05:15:17] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[05:15:17] ✅ Patient name cross-validation successful
[05:15:17] ✅    ✅ Data merged successfully
[05:15:18] ✅    ✅ Order data extracted and validated
[05:15:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:15:18] [DOC: 9320422] ✅ Patient found in local cache: Mary Lima, ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:15:18] ✅    ✅ Existing patient found with ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:15:18] 🔄 
🔄 Step 6: Pushing order to API...
[05:15:18] [DOC: 9320422] ℹ️  Pushing order via API for patient ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:15:19] [DOC: 9320422] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18816"}
[05:15:19] ❌    ❌ Failed to push order
[05:15:19] 🔄 
🔄 Step 7: Writing to CSV...
[05:15:19] [DOC: 9320422] ℹ️  Calculated age: 81 from DOB: 08/18/1943
[05:15:19] [DOC: 9320422] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[05:15:19] [DOC: 9320422] ℹ️  Payer Source extracted: ''
[05:15:19] [DOC: 9320422] ℹ️  Diagnosis codes being written:
[05:15:19] [DOC: 9320422] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:15:19] [DOC: 9320422] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[05:15:19] [DOC: 9320422] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[05:15:19] [DOC: 9320422] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:15:19] [DOC: 9320422] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:15:19] [DOC: 9320422] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:15:19] [DOC: 9320422] ✅ Patient data written to CSV: Mary Lima | Sex: FEMALE | Age: 81 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: MA200210084304
[05:15:19] ✅    ✅ Document 9320422 processed and saved successfully
[05:15:19] 🔄 
🔄 Step 8: Saving API details...
[05:15:19] [DOC: 9320422] ℹ️  API push details saved for document 9320422
[05:15:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320418                         ║
================================================================================
[05:15:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:15:19] ℹ️  Date: 05/30/2025
[05:15:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:15:21] [DOC: 9320418] ✅ Text extracted using pdfplumber (1265 chars)
[05:15:21] ✅    ✅ Text extracted using pdfplumber (1265 chars)
[05:15:21] 🔄 
🔄 Step 2: Extracting patient data...
[05:15:24] ℹ️  AI extracted raw sex value: ''
[05:15:24] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:15:24] ℹ️  AI extracted payer source: ''
[05:15:24] ℹ️  AI extracted diagnoses:
[05:15:24] ℹ️    - Diagnosis 1: 'I13.0'
[05:15:24] ℹ️    - Diagnosis 2: 'I50.33'
[05:15:24] ℹ️    - Diagnosis 3: 'E11.22'
[05:15:24] ℹ️    - Diagnosis 4: 'None'
[05:15:24] ℹ️    - Diagnosis 5: 'None'
[05:15:24] ℹ️    - Diagnosis 6: 'None'
[05:15:24] ℹ️  Final extracted MRN: '100994168'
[05:15:24] ℹ️  Final extracted Sex: ''
[05:15:24] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:15:24] ℹ️  Final extracted Payer Source: ''
[05:15:24] ✅ Patient data extraction completed successfully
[05:15:24] ✅    ✅ Patient data extracted successfully
[05:15:24] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Brilhante
     └─ dob: 03/13/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100994168
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:15:24] ✅    ✅ Patient identified: John Brilhante
[05:15:24] ✅    ✅ Patient name validation passed
[05:15:24] 🔄 
🔄 Step 3: Processing patient dates...
[05:15:24] [DOC: 9320418] ℹ️  DOB normalized: 03/13/1944
[05:15:24] [DOC: 9320418] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[05:15:24] [DOC: 9320418] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[05:15:24] [DOC: 9320418] ✅ Patient date processing completed successfully
[05:15:24] ✅    ✅ Date processing completed
[05:15:24] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Brilhante
     └─ dob: 03/13/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100994168
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22'}]
[05:15:24] 🔄 
🔄 Step 4: Extracting order data...
[05:15:27] ℹ️  Order extraction - MRN: '100994168'
[05:15:27] ℹ️  Order extraction - Sex: ''
[05:15:27] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:15:27] ℹ️  Order extraction - Payer Source: ''
[05:15:27] ✅ Order data extraction completed successfully
[05:15:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:15:27] ℹ️  Using MRN from patient data: '100994168' over '100994168'
[05:15:27] ℹ️  Inferred sex as MALE from name: John
[05:15:27] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:15:27] ✅ Patient name cross-validation successful
[05:15:27] ✅    ✅ Data merged successfully
[05:15:28] ✅    ✅ Order data extracted and validated
[05:15:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:15:49] [DOC: 9320418] ✅ Patient exists in API: John Brilhante, ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[05:15:49] ✅    ✅ Existing patient found with ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[05:15:49] 🔄 
🔄 Step 6: Pushing order to API...
[05:15:49] [DOC: 9320418] ℹ️  Pushing order via API for patient ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[05:15:50] [DOC: 9320418] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18817"}
[05:15:50] ❌    ❌ Failed to push order
[05:15:50] 🔄 
🔄 Step 7: Writing to CSV...
[05:15:50] [DOC: 9320418] ℹ️  Calculated age: 81 from DOB: 03/13/1944
[05:15:50] [DOC: 9320418] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:15:50] [DOC: 9320418] ℹ️  Payer Source extracted: ''
[05:15:50] [DOC: 9320418] ℹ️  Diagnosis codes being written:
[05:15:50] [DOC: 9320418] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[05:15:50] [DOC: 9320418] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[05:15:50] [DOC: 9320418] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[05:15:50] [DOC: 9320418] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:15:50] [DOC: 9320418] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:15:50] [DOC: 9320418] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:15:50] [DOC: 9320418] ✅ Patient data written to CSV: John Brilhante | Sex: MALE | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: 100994168
[05:15:50] ✅    ✅ Document 9320418 processed and saved successfully
[05:15:50] 🔄 
🔄 Step 8: Saving API details...
[05:15:50] [DOC: 9320418] ℹ️  API push details saved for document 9320418
[05:15:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320252                         ║
================================================================================
[05:15:50] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:15:50] ℹ️  Date: 05/30/2025
[05:15:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:15:55] [DOC: 9320252] ✅ Text extracted using pdfplumber (1823 chars)
[05:15:55] ✅    ✅ Text extracted using pdfplumber (1811 chars)
[05:15:55] 🔄 
🔄 Step 2: Extracting patient data...
[05:15:58] ℹ️  AI extracted raw sex value: 'F'
[05:15:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:15:58] ℹ️  AI extracted payer source: 'Medicare'
[05:15:58] ℹ️  AI extracted diagnoses:
[05:15:58] ℹ️    - Diagnosis 1: 'None'
[05:15:58] ℹ️    - Diagnosis 2: 'None'
[05:15:58] ℹ️    - Diagnosis 3: 'None'
[05:15:58] ℹ️    - Diagnosis 4: 'None'
[05:15:58] ℹ️    - Diagnosis 5: 'None'
[05:15:58] ℹ️    - Diagnosis 6: 'None'
[05:15:58] ℹ️  Final extracted MRN: '28700203358401'
[05:15:58] ℹ️  Final extracted Sex: 'FEMALE'
[05:15:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:15:58] ℹ️  Final extracted Payer Source: 'Medicare'
[05:15:58] ✅ Patient data extraction completed successfully
[05:15:58] ✅    ✅ Patient data extracted successfully
[05:15:58] 📊 Patient Response
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:15:58] ✅    ✅ Patient identified: JEANNE ARSENAULT
[05:15:58] ✅    ✅ Patient name validation passed
[05:15:58] 🔄 
🔄 Step 3: Processing patient dates...
[05:15:58] [DOC: 9320252] ℹ️  DOB normalized: 06/24/1945
[05:15:58] [DOC: 9320252] ℹ️  Episode startOfEpisode normalized: 01/19/2025
[05:15:58] [DOC: 9320252] ℹ️  Episode endOfEpisode normalized: 01/22/2025
[05:15:58] [DOC: 9320252] ✅ Patient date processing completed successfully
[05:15:58] ✅    ✅ Date processing completed
[05:15:58] 📊 Processed Patient Data
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025'}]
[05:15:58] 🔄 
🔄 Step 4: Extracting order data...
[05:16:00] ℹ️  Order extraction - MRN: '28700203358401'
[05:16:00] ℹ️  Order extraction - Sex: ''
[05:16:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:16:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:16:00] ✅ Order data extraction completed successfully
[05:16:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:16:00] ℹ️  Using MRN from patient data: '28700203358401' over '28700203358401'
[05:16:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:16:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:16:00] ✅ Patient name cross-validation successful
[05:16:00] ✅    ✅ Data merged successfully
[05:16:01] ✅    ✅ Order data extracted and validated
[05:16:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:16:21] [DOC: 9320252] ℹ️  Patient not found in cache or API: JEANNE ARSENAULT
[05:16:21] [DOC: 9320252] ℹ️  Patient not found, creating new patient via API...
[05:16:21] [DOC: 9320252] ℹ️  Creating patient via API: JEANNE ARSENAULT
[05:16:22] [DOC: 9320252] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:16:22] ❌    ❌ Failed to create patient
[05:16:22] [DOC: 9320252] ℹ️  API push details saved for document 9320252
================================================================================
║                        Processing Document ID: 9320271                         ║
================================================================================
[05:16:22] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:16:22] ℹ️  Date: 05/30/2025
[05:16:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:16:30] [DOC: 9320271] ✅ Text extracted using pdfplumber (27702 chars)
[05:16:30] ✅    ✅ Text extracted using pdfplumber (27606 chars)
[05:16:30] 🔄 
🔄 Step 2: Extracting patient data...
[05:16:33] ℹ️  AI extracted raw sex value: 'F'
[05:16:33] ℹ️  AI extracted service line: 'Home Health Aide,Physical Therapy,Occupational Therapy,Skilled Nurse'
[05:16:33] ℹ️  AI extracted payer source: 'Medicare'
[05:16:33] ℹ️  AI extracted diagnoses:
[05:16:33] ℹ️    - Diagnosis 1: 'S82.842D'
[05:16:33] ℹ️    - Diagnosis 2: 'I10'
[05:16:33] ℹ️    - Diagnosis 3: 'F41.9'
[05:16:33] ℹ️    - Diagnosis 4: 'F39'
[05:16:33] ℹ️    - Diagnosis 5: 'E78.5'
[05:16:33] ℹ️    - Diagnosis 6: 'K21.9'
[05:16:33] ℹ️  Final extracted MRN: '28700203358401'
[05:16:33] ℹ️  Final extracted Sex: 'FEMALE'
[05:16:33] ℹ️  Final extracted Service Line: 'Home Health Aide,Physical Therapy,Occupational Therapy,Skilled Nurse'
[05:16:33] ℹ️  Final extracted Payer Source: 'Medicare'
[05:16:33] ✅ Patient data extraction completed successfully
[05:16:33] ✅    ✅ Patient data extracted successfully
[05:16:33] 📊 Patient Response
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 37B SUN AND SEA DRIVE
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Home Health Aide,Physical Therapy,Occupational Therapy,Skilled Nurse
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/23/2025', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'S82.842D', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F39', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[05:16:33] ✅    ✅ Patient identified: JEANNE ARSENAULT
[05:16:33] ✅    ✅ Patient name validation passed
[05:16:33] 🔄 
🔄 Step 3: Processing patient dates...
[05:16:33] [DOC: 9320271] ℹ️  DOB normalized: 06/24/1945
[05:16:33] [DOC: 9320271] ℹ️  Episode startOfCare normalized: 01/23/2025
[05:16:33] [DOC: 9320271] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[05:16:33] [DOC: 9320271] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[05:16:33] [DOC: 9320271] ✅ Patient date processing completed successfully
[05:16:33] ✅    ✅ Date processing completed
[05:16:33] 📊 Processed Patient Data
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 37B SUN AND SEA DRIVE
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Home Health Aide,Physical Therapy,Occupational Therapy,Skilled Nurse
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/23/2025', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'S82.842D', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F39', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[05:16:33] 🔄 
🔄 Step 4: Extracting order data...
[05:16:36] ℹ️  Order extraction - MRN: '28700203358401'
[05:16:36] ℹ️  Order extraction - Sex: 'FEMALE'
[05:16:36] ℹ️  Order extraction - Service Line: 'HHA, PT, OT, Skilled Nurse'
[05:16:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:16:36] ✅ Order data extraction completed successfully
[05:16:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:16:36] ℹ️  Using MRN from patient data: '28700203358401' over '28700203358401'
[05:16:36] ℹ️  Combined service lines: Patient='Home Health Aide,Physical Therapy,Occupational Therapy,Skilled Nurse' + Order='HHA, PT, OT, Skilled Nurse' = 'HHA, Home Health Aide, OT, Occupational Therapy, PT, Physical Therapy, Skilled Nurse'
[05:16:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:16:36] ✅ Patient name cross-validation successful
[05:16:36] ✅    ✅ Data merged successfully
[05:16:38] ✅    ✅ Order data extracted and validated
[05:16:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:17:10] [DOC: 9320271] ℹ️  Patient not found in cache or API: JEANNE ARSENAULT
[05:17:10] [DOC: 9320271] ℹ️  Patient not found, creating new patient via API...
[05:17:10] [DOC: 9320271] ℹ️  Creating patient via API: JEANNE ARSENAULT
[05:17:11] [DOC: 9320271] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:17:11] ❌    ❌ Failed to create patient
[05:17:11] [DOC: 9320271] ℹ️  API push details saved for document 9320271
================================================================================
║                        Processing Document ID: 9320382                         ║
================================================================================
[05:17:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:17:11] ℹ️  Date: 05/30/2025
[05:17:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:17:14] [DOC: 9320382] ✅ Text extracted using pdfplumber (1498 chars)
[05:17:14] ✅    ✅ Text extracted using pdfplumber (1498 chars)
[05:17:14] 🔄 
🔄 Step 2: Extracting patient data...
[05:17:17] ℹ️  AI extracted raw sex value: ''
[05:17:17] ℹ️  AI extracted service line: 'Skilled Nursing, LPN'
[05:17:17] ℹ️  AI extracted payer source: ''
[05:17:17] ℹ️  AI extracted diagnoses:
[05:17:17] ℹ️    - Diagnosis 1: 'E11.65'
[05:17:17] ℹ️    - Diagnosis 2: 'I10'
[05:17:17] ℹ️    - Diagnosis 3: 'F20.9'
[05:17:17] ℹ️    - Diagnosis 4: 'None'
[05:17:17] ℹ️    - Diagnosis 5: 'None'
[05:17:17] ℹ️    - Diagnosis 6: 'None'
[05:17:17] ℹ️  Final extracted MRN: 'MA230222024501'
[05:17:17] ℹ️  Final extracted Sex: ''
[05:17:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN'
[05:17:17] ℹ️  Final extracted Payer Source: ''
[05:17:17] ✅ Patient data extraction completed successfully
[05:17:17] ✅    ✅ Patient data extracted successfully
[05:17:17] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:17:17] ✅    ✅ Patient identified: Pauline Bergeron
[05:17:17] ✅    ✅ Patient name validation passed
[05:17:17] 🔄 
🔄 Step 3: Processing patient dates...
[05:17:17] [DOC: 9320382] ℹ️  DOB normalized: 02/22/1945
[05:17:17] [DOC: 9320382] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[05:17:17] [DOC: 9320382] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[05:17:17] [DOC: 9320382] ✅ Patient date processing completed successfully
[05:17:17] ✅    ✅ Date processing completed
[05:17:17] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9'}]
[05:17:17] 🔄 
🔄 Step 4: Extracting order data...
[05:17:19] ℹ️  Order extraction - MRN: 'MA230222024501'
[05:17:19] ℹ️  Order extraction - Sex: ''
[05:17:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:17:19] ℹ️  Order extraction - Payer Source: ''
[05:17:19] ✅ Order data extraction completed successfully
[05:17:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:17:19] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[05:17:19] ⚠️  Could not determine sex using any available method
[05:17:19] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[05:17:19] ✅ Patient name cross-validation successful
[05:17:19] ✅    ✅ Data merged successfully
[05:17:21] ✅    ✅ Order data extracted and validated
[05:17:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:17:48] [DOC: 9320382] ✅ Patient exists in API: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:17:48] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:17:48] 🔄 
🔄 Step 6: Pushing order to API...
[05:17:48] [DOC: 9320382] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:17:50] [DOC: 9320382] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18820"}
[05:17:50] ❌    ❌ Failed to push order
[05:17:50] 🔄 
🔄 Step 7: Writing to CSV...
[05:17:50] [DOC: 9320382] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[05:17:50] [DOC: 9320382] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[05:17:50] [DOC: 9320382] ℹ️  Payer Source extracted: ''
[05:17:50] [DOC: 9320382] ℹ️  Diagnosis codes being written:
[05:17:50] [DOC: 9320382] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[05:17:50] [DOC: 9320382] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[05:17:50] [DOC: 9320382] ℹ️    - Latest_Episode_Thirddiagnosis: 'F20.9'
[05:17:50] [DOC: 9320382] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:17:50] [DOC: 9320382] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:17:50] [DOC: 9320382] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:17:50] [DOC: 9320382] ✅ Patient data written to CSV: Pauline Bergeron | Sex:  | Age: 80 | Service: LPN, Skilled Nursing | Payer:  | MRN: MA230222024501
[05:17:50] ✅    ✅ Document 9320382 processed and saved successfully
[05:17:50] 🔄 
🔄 Step 8: Saving API details...
[05:17:50] [DOC: 9320382] ℹ️  API push details saved for document 9320382
[05:17:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320372                         ║
================================================================================
[05:17:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:17:50] ℹ️  Date: 05/30/2025
[05:17:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:17:57] [DOC: 9320372] ✅ Text extracted using pdfplumber (14271 chars)
[05:17:57] ✅    ✅ Text extracted using pdfplumber (14271 chars)
[05:17:57] 🔄 
🔄 Step 2: Extracting patient data...
[05:17:59] ℹ️  AI extracted raw sex value: 'F'
[05:17:59] ℹ️  AI extracted service line: 'PT'
[05:17:59] ℹ️  AI extracted payer source: 'None'
[05:17:59] ℹ️  AI extracted diagnoses:
[05:17:59] ℹ️    - Diagnosis 1: 'None'
[05:17:59] ℹ️    - Diagnosis 2: 'None'
[05:17:59] ℹ️    - Diagnosis 3: 'None'
[05:17:59] ℹ️    - Diagnosis 4: 'None'
[05:17:59] ℹ️    - Diagnosis 5: 'None'
[05:17:59] ℹ️    - Diagnosis 6: 'None'
[05:17:59] ℹ️  Final extracted MRN: 'MA220701015501'
[05:17:59] ℹ️  Final extracted Sex: 'FEMALE'
[05:17:59] ℹ️  Final extracted Service Line: 'PT'
[05:17:59] ℹ️  Final extracted Payer Source: ''
[05:17:59] ✅ Patient data extraction completed successfully
[05:17:59] ✅    ✅ Patient data extracted successfully
[05:17:59] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:17:59] ✅    ✅ Patient identified: Ada Burns
[05:17:59] ✅    ✅ Patient name validation passed
[05:17:59] 🔄 
🔄 Step 3: Processing patient dates...
[05:17:59] [DOC: 9320372] ℹ️  DOB normalized: 01/15/1955
[05:17:59] [DOC: 9320372] ✅ Patient date processing completed successfully
[05:17:59] ✅    ✅ Date processing completed
[05:17:59] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[05:17:59] 🔄 
🔄 Step 4: Extracting order data...
[05:18:02] ℹ️  Order extraction - MRN: 'MA220701015501'
[05:18:02] ℹ️  Order extraction - Sex: 'FEMALE'
[05:18:02] ℹ️  Order extraction - Service Line: 'PT'
[05:18:02] ℹ️  Order extraction - Payer Source: ''
[05:18:02] ✅ Order data extraction completed successfully
[05:18:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:02] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[05:18:02] ℹ️  Service line consistent in both sources: 'PT'
[05:18:02] ✅ Patient name cross-validation successful
[05:18:02] ✅    ✅ Data merged successfully
[05:18:03] ✅    ✅ Order data extracted and validated
[05:18:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:18:09] [DOC: 9320372] ✅ Patient exists in API: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:18:10] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:18:10] 🔄 
🔄 Step 6: Pushing order to API...
[05:18:10] [DOC: 9320372] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:18:11] [DOC: 9320372] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:18:11] ❌    ❌ Failed to push order
[05:18:11] 🔄 
🔄 Step 7: Writing to CSV...
[05:18:11] [DOC: 9320372] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[05:18:11] [DOC: 9320372] ℹ️  Service Line extracted: 'PT'
[05:18:11] [DOC: 9320372] ℹ️  Payer Source extracted: ''
[05:18:11] [DOC: 9320372] ℹ️  Diagnosis codes being written:
[05:18:11] [DOC: 9320372] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:18:11] [DOC: 9320372] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:18:11] [DOC: 9320372] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:18:11] [DOC: 9320372] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:18:11] [DOC: 9320372] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:18:11] [DOC: 9320372] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:18:11] [DOC: 9320372] ✅ Patient data written to CSV: Ada Burns | Sex: FEMALE | Age: 70 | Service: PT | Payer:  | MRN: MA220701015501
[05:18:11] ✅    ✅ Document 9320372 processed and saved successfully
[05:18:11] 🔄 
🔄 Step 8: Saving API details...
[05:18:11] [DOC: 9320372] ℹ️  API push details saved for document 9320372
[05:18:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320352                         ║
================================================================================
[05:18:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:18:11] ℹ️  Date: 05/30/2025
[05:18:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:18:13] [DOC: 9320352] ✅ Text extracted using pdfplumber (970 chars)
[05:18:13] ✅    ✅ Text extracted using pdfplumber (970 chars)
[05:18:13] 🔄 
🔄 Step 2: Extracting patient data...
[05:18:16] ℹ️  AI extracted raw sex value: ''
[05:18:16] ℹ️  AI extracted service line: 'OT'
[05:18:16] ℹ️  AI extracted payer source: ''
[05:18:16] ℹ️  AI extracted diagnoses:
[05:18:16] ℹ️    - Diagnosis 1: 'E87.6'
[05:18:16] ℹ️    - Diagnosis 2: 'N30.90'
[05:18:16] ℹ️    - Diagnosis 3: 'G35'
[05:18:16] ℹ️    - Diagnosis 4: 'None'
[05:18:16] ℹ️    - Diagnosis 5: 'None'
[05:18:16] ℹ️    - Diagnosis 6: 'None'
[05:18:16] ℹ️  Final extracted MRN: 'MA250310104802'
[05:18:16] ℹ️  Final extracted Sex: ''
[05:18:16] ℹ️  Final extracted Service Line: 'OT'
[05:18:16] ℹ️  Final extracted Payer Source: ''
[05:18:16] ✅ Patient data extraction completed successfully
[05:18:16] ✅    ✅ Patient data extracted successfully
[05:18:16] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:18:16] ✅    ✅ Patient identified: Barbara Murach
[05:18:16] ✅    ✅ Patient name validation passed
[05:18:16] 🔄 
🔄 Step 3: Processing patient dates...
[05:18:16] [DOC: 9320352] ℹ️  DOB normalized: 10/30/1948
[05:18:16] [DOC: 9320352] ℹ️  Episode startOfEpisode normalized: 05/18/2025
[05:18:16] [DOC: 9320352] ℹ️  Episode endOfEpisode normalized: 07/16/2025
[05:18:16] [DOC: 9320352] ✅ Patient date processing completed successfully
[05:18:16] ✅    ✅ Date processing completed
[05:18:16] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35'}]
[05:18:16] 🔄 
🔄 Step 4: Extracting order data...
[05:18:19] ℹ️  Order extraction - MRN: 'MA250310104802'
[05:18:19] ℹ️  Order extraction - Sex: ''
[05:18:19] ℹ️  Order extraction - Service Line: 'OT'
[05:18:19] ℹ️  Order extraction - Payer Source: ''
[05:18:19] ✅ Order data extraction completed successfully
[05:18:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:19] ℹ️  Using MRN from patient data: 'MA250310104802' over 'MA250310104802'
[05:18:19] ℹ️  Inferred sex as FEMALE from name: Barbara
[05:18:19] ℹ️  Service line consistent in both sources: 'OT'
[05:18:19] ✅ Patient name cross-validation successful
[05:18:19] ✅    ✅ Data merged successfully
[05:18:20] ✅    ✅ Order data extracted and validated
[05:18:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:18:26] [DOC: 9320352] ✅ Patient exists in API: Barbara Murach, ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[05:18:26] ✅    ✅ Existing patient found with ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[05:18:26] 🔄 
🔄 Step 6: Pushing order to API...
[05:18:26] [DOC: 9320352] ℹ️  Pushing order via API for patient ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[05:18:27] [DOC: 9320352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18823"}
[05:18:27] ❌    ❌ Failed to push order
[05:18:27] 🔄 
🔄 Step 7: Writing to CSV...
[05:18:27] [DOC: 9320352] ℹ️  Calculated age: 76 from DOB: 10/30/1948
[05:18:27] [DOC: 9320352] ℹ️  Service Line extracted: 'OT'
[05:18:27] [DOC: 9320352] ℹ️  Payer Source extracted: ''
[05:18:27] [DOC: 9320352] ℹ️  Diagnosis codes being written:
[05:18:27] [DOC: 9320352] ℹ️    - Latest_Episode_Firstdiagnosis: 'E87.6'
[05:18:27] [DOC: 9320352] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.90'
[05:18:27] [DOC: 9320352] ℹ️    - Latest_Episode_Thirddiagnosis: 'G35'
[05:18:27] [DOC: 9320352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:18:27] [DOC: 9320352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:18:27] [DOC: 9320352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:18:27] [DOC: 9320352] ✅ Patient data written to CSV: Barbara Murach | Sex: FEMALE | Age: 76 | Service: OT | Payer:  | MRN: MA250310104802
[05:18:27] ✅    ✅ Document 9320352 processed and saved successfully
[05:18:27] 🔄 
🔄 Step 8: Saving API details...
[05:18:27] [DOC: 9320352] ℹ️  API push details saved for document 9320352
[05:18:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320349                         ║
================================================================================
[05:18:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:18:27] ℹ️  Date: 05/30/2025
[05:18:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:18:30] [DOC: 9320349] ✅ Text extracted using pdfplumber (1159 chars)
[05:18:30] ✅    ✅ Text extracted using pdfplumber (1159 chars)
[05:18:30] 🔄 
🔄 Step 2: Extracting patient data...
[05:18:33] ℹ️  AI extracted raw sex value: ''
[05:18:33] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:18:33] ℹ️  AI extracted payer source: ''
[05:18:33] ℹ️  AI extracted diagnoses:
[05:18:33] ℹ️    - Diagnosis 1: 'E87.6'
[05:18:33] ℹ️    - Diagnosis 2: 'N30.90'
[05:18:33] ℹ️    - Diagnosis 3: 'G35'
[05:18:33] ℹ️    - Diagnosis 4: ''
[05:18:33] ℹ️    - Diagnosis 5: ''
[05:18:33] ℹ️    - Diagnosis 6: ''
[05:18:33] ℹ️  Final extracted MRN: 'MA250310104802'
[05:18:33] ℹ️  Final extracted Sex: ''
[05:18:33] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:18:33] ℹ️  Final extracted Payer Source: ''
[05:18:33] ✅ Patient data extraction completed successfully
[05:18:33] ✅    ✅ Patient data extracted successfully
[05:18:33] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:18:33] ✅    ✅ Patient identified: Barbara Murach
[05:18:33] ✅    ✅ Patient name validation passed
[05:18:33] 🔄 
🔄 Step 3: Processing patient dates...
[05:18:33] [DOC: 9320349] ℹ️  DOB normalized: 10/30/1948
[05:18:33] [DOC: 9320349] ℹ️  Episode startOfEpisode normalized: 05/18/2025
[05:18:33] [DOC: 9320349] ℹ️  Episode endOfEpisode normalized: 07/16/2025
[05:18:33] [DOC: 9320349] ✅ Patient date processing completed successfully
[05:18:33] ✅    ✅ Date processing completed
[05:18:33] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:18:33] 🔄 
🔄 Step 4: Extracting order data...
[05:18:36] ℹ️  Order extraction - MRN: 'MA250310104802'
[05:18:36] ℹ️  Order extraction - Sex: ''
[05:18:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:18:36] ℹ️  Order extraction - Payer Source: ''
[05:18:36] ✅ Order data extraction completed successfully
[05:18:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:36] ℹ️  Using MRN from patient data: 'MA250310104802' over 'MA250310104802'
[05:18:36] ℹ️  Inferred sex as FEMALE from name: Barbara
[05:18:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:18:36] ✅ Patient name cross-validation successful
[05:18:36] ✅    ✅ Data merged successfully
[05:18:37] ✅    ✅ Order data extracted and validated
[05:18:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:18:37] [DOC: 9320349] ✅ Patient found in local cache: Barbara Murach, ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[05:18:37] ✅    ✅ Existing patient found with ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[05:18:37] 🔄 
🔄 Step 6: Pushing order to API...
[05:18:37] [DOC: 9320349] ℹ️  Pushing order via API for patient ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[05:18:38] [DOC: 9320349] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18824"}
[05:18:38] ❌    ❌ Failed to push order
[05:18:38] 🔄 
🔄 Step 7: Writing to CSV...
[05:18:38] [DOC: 9320349] ℹ️  Calculated age: 76 from DOB: 10/30/1948
[05:18:38] [DOC: 9320349] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:18:38] [DOC: 9320349] ℹ️  Payer Source extracted: ''
[05:18:38] [DOC: 9320349] ℹ️  Diagnosis codes being written:
[05:18:38] [DOC: 9320349] ℹ️    - Latest_Episode_Firstdiagnosis: 'E87.6'
[05:18:38] [DOC: 9320349] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.90'
[05:18:38] [DOC: 9320349] ℹ️    - Latest_Episode_Thirddiagnosis: 'G35'
[05:18:38] [DOC: 9320349] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:18:38] [DOC: 9320349] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:18:38] [DOC: 9320349] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:18:38] [DOC: 9320349] ✅ Patient data written to CSV: Barbara Murach | Sex: FEMALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: MA250310104802
[05:18:38] ✅    ✅ Document 9320349 processed and saved successfully
[05:18:38] 🔄 
🔄 Step 8: Saving API details...
[05:18:38] [DOC: 9320349] ℹ️  API push details saved for document 9320349
[05:18:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320278                         ║
================================================================================
[05:18:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:18:38] ℹ️  Date: 05/30/2025
[05:18:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:18:42] [DOC: 9320278] ✅ Text extracted using pdfplumber (13642 chars)
[05:18:42] ✅    ✅ Text extracted using pdfplumber (13642 chars)
[05:18:42] 🔄 
🔄 Step 2: Extracting patient data...
[05:18:46] ℹ️  AI extracted raw sex value: 'M'
[05:18:46] ℹ️  AI extracted service line: 'PT'
[05:18:46] ℹ️  AI extracted payer source: ''
[05:18:46] ℹ️  AI extracted diagnoses:
[05:18:46] ℹ️    - Diagnosis 1: 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA'
[05:18:46] ℹ️    - Diagnosis 2: 'SYNCOPE'
[05:18:46] ℹ️    - Diagnosis 3: 'MORBID OBESITY'
[05:18:46] ℹ️    - Diagnosis 4: 'A FIB ON XARELTO'
[05:18:46] ℹ️    - Diagnosis 5: 'CHRONIC OSTEOMYELITIS RIGHT ANKLE'
[05:18:46] ℹ️    - Diagnosis 6: 'OPEN RIGHT ANKLE FRACTURE'
[05:18:46] ℹ️  Final extracted MRN: 'MA250331114803'
[05:18:46] ℹ️  Final extracted Sex: 'MALE'
[05:18:46] ℹ️  Final extracted Service Line: 'PT'
[05:18:46] ℹ️  Final extracted Payer Source: ''
[05:18:46] ✅ Patient data extraction completed successfully
[05:18:46] ✅    ✅ Patient data extracted successfully
[05:18:46] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '', 'firstDiagnosis': 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA', 'secondDiagnosis': 'SYNCOPE', 'thirdDiagnosis': 'MORBID OBESITY', 'fourthDiagnosis': 'A FIB ON XARELTO', 'fifthDiagnosis': 'CHRONIC OSTEOMYELITIS RIGHT ANKLE', 'sixthDiagnosis': 'OPEN RIGHT ANKLE FRACTURE'}]
[05:18:46] ✅    ✅ Patient identified: David Sturgeon
[05:18:46] ✅    ✅ Patient name validation passed
[05:18:46] 🔄 
🔄 Step 3: Processing patient dates...
[05:18:46] [DOC: 9320278] ℹ️  DOB normalized: 11/14/1948
[05:18:46] [DOC: 9320278] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:18:46] [DOC: 9320278] ✅ Patient date processing completed successfully
[05:18:46] ✅    ✅ Date processing completed
[05:18:46] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '', 'firstDiagnosis': 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA', 'secondDiagnosis': 'SYNCOPE', 'thirdDiagnosis': 'MORBID OBESITY', 'fourthDiagnosis': 'A FIB ON XARELTO', 'fifthDiagnosis': 'CHRONIC OSTEOMYELITIS RIGHT ANKLE', 'sixthDiagnosis': 'OPEN RIGHT ANKLE FRACTURE'}]
[05:18:46] 🔄 
🔄 Step 4: Extracting order data...
[05:18:48] ℹ️  Order extraction - MRN: 'MA250331114803'
[05:18:48] ℹ️  Order extraction - Sex: 'MALE'
[05:18:48] ℹ️  Order extraction - Service Line: 'PT'
[05:18:48] ℹ️  Order extraction - Payer Source: ''
[05:18:48] ✅ Order data extraction completed successfully
[05:18:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:48] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[05:18:48] ℹ️  Service line consistent in both sources: 'PT'
[05:18:48] ✅ Patient name cross-validation successful
[05:18:48] ✅    ✅ Data merged successfully
[05:18:49] ⚠️     ❌ Skipping - missing episode start date
[05:18:49] [DOC: 9320278] ℹ️  API push details saved for document 9320278
================================================================================
║                        Processing Document ID: 9320269                         ║
================================================================================
[05:18:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:18:49] ℹ️  Date: 05/30/2025
[05:18:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:18:52] [DOC: 9320269] ✅ Text extracted using pdfplumber (14308 chars)
[05:18:52] ✅    ✅ Text extracted using pdfplumber (14308 chars)
[05:18:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:18:55] ℹ️  AI extracted raw sex value: 'F'
[05:18:55] ℹ️  AI extracted service line: 'PT'
[05:18:55] ℹ️  AI extracted payer source: 'None'
[05:18:55] ℹ️  AI extracted diagnoses:
[05:18:55] ℹ️    - Diagnosis 1: 'None'
[05:18:55] ℹ️    - Diagnosis 2: 'None'
[05:18:55] ℹ️    - Diagnosis 3: 'None'
[05:18:55] ℹ️    - Diagnosis 4: 'None'
[05:18:55] ℹ️    - Diagnosis 5: 'None'
[05:18:55] ℹ️    - Diagnosis 6: 'None'
[05:18:55] ℹ️  Final extracted MRN: 'MA210121015502'
[05:18:55] ℹ️  Final extracted Sex: 'FEMALE'
[05:18:55] ℹ️  Final extracted Service Line: 'PT'
[05:18:55] ℹ️  Final extracted Payer Source: ''
[05:18:55] ✅ Patient data extraction completed successfully
[05:18:55] ✅    ✅ Patient data extracted successfully
[05:18:55] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:18:55] ✅    ✅ Patient identified: Louise Rivard
[05:18:55] ✅    ✅ Patient name validation passed
[05:18:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:18:55] [DOC: 9320269] ℹ️  DOB normalized: 01/26/1955
[05:18:55] [DOC: 9320269] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[05:18:55] [DOC: 9320269] ✅ Patient date processing completed successfully
[05:18:55] ✅    ✅ Date processing completed
[05:18:55] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025'}]
[05:18:55] 🔄 
🔄 Step 4: Extracting order data...
[05:18:58] ℹ️  Order extraction - MRN: 'MA210121015502'
[05:18:58] ℹ️  Order extraction - Sex: 'FEMALE'
[05:18:58] ℹ️  Order extraction - Service Line: 'PT'
[05:18:58] ℹ️  Order extraction - Payer Source: ''
[05:18:58] ✅ Order data extraction completed successfully
[05:18:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:58] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[05:18:58] ℹ️  Service line consistent in both sources: 'PT'
[05:18:58] ✅ Patient name cross-validation successful
[05:18:58] ✅    ✅ Data merged successfully
[05:18:59] ⚠️     ❌ Skipping - missing episode start date
[05:18:59] [DOC: 9320269] ℹ️  API push details saved for document 9320269
================================================================================
║                        Processing Document ID: 9320265                         ║
================================================================================
[05:18:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:18:59] ℹ️  Date: 05/30/2025
[05:18:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:01] [DOC: 9320265] ✅ Text extracted using pdfplumber (983 chars)
[05:19:01] ✅    ✅ Text extracted using pdfplumber (983 chars)
[05:19:01] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:04] ℹ️  AI extracted raw sex value: ''
[05:19:04] ℹ️  AI extracted service line: 'Nursing'
[05:19:04] ℹ️  AI extracted payer source: ''
[05:19:04] ℹ️  AI extracted diagnoses:
[05:19:04] ℹ️    - Diagnosis 1: 'F03.918'
[05:19:04] ℹ️    - Diagnosis 2: 'F33.1'
[05:19:04] ℹ️    - Diagnosis 3: 'I10'
[05:19:04] ℹ️    - Diagnosis 4: ''
[05:19:04] ℹ️    - Diagnosis 5: ''
[05:19:04] ℹ️    - Diagnosis 6: ''
[05:19:04] ℹ️  Final extracted MRN: 'MA200723054001'
[05:19:04] ℹ️  Final extracted Sex: ''
[05:19:04] ℹ️  Final extracted Service Line: 'Nursing'
[05:19:04] ℹ️  Final extracted Payer Source: ''
[05:19:04] ✅ Patient data extraction completed successfully
[05:19:04] ✅    ✅ Patient data extracted successfully
[05:19:04] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Pimentel
     └─ dob: 05/19/1940
     └─ patientSex: 
     └─ medicalRecordNo: MA200723054001
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F03.918', 'secondDiagnosis': 'F33.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:04] ✅    ✅ Patient identified: Maria Pimentel
[05:19:04] ✅    ✅ Patient name validation passed
[05:19:04] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:04] [DOC: 9320265] ℹ️  DOB normalized: 05/19/1940
[05:19:04] [DOC: 9320265] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[05:19:04] [DOC: 9320265] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[05:19:04] [DOC: 9320265] ✅ Patient date processing completed successfully
[05:19:04] ✅    ✅ Date processing completed
[05:19:04] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Pimentel
     └─ dob: 05/19/1940
     └─ patientSex: 
     └─ medicalRecordNo: MA200723054001
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F03.918', 'secondDiagnosis': 'F33.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:04] 🔄 
🔄 Step 4: Extracting order data...
[05:19:07] ℹ️  Order extraction - MRN: 'MA200723054001'
[05:19:07] ℹ️  Order extraction - Sex: ''
[05:19:07] ℹ️  Order extraction - Service Line: 'Nursing'
[05:19:07] ℹ️  Order extraction - Payer Source: ''
[05:19:07] ✅ Order data extraction completed successfully
[05:19:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:07] ℹ️  Using MRN from patient data: 'MA200723054001' over 'MA200723054001'
[05:19:07] ℹ️  Inferred sex as FEMALE from name: Maria
[05:19:07] ℹ️  Service line consistent in both sources: 'Nursing'
[05:19:07] ✅ Patient name cross-validation successful
[05:19:07] ✅    ✅ Data merged successfully
[05:19:08] ✅    ✅ Order data extracted and validated
[05:19:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:19:14] [DOC: 9320265] ✅ Patient exists in API: Maria Pimentel, ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[05:19:14] ✅    ✅ Existing patient found with ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[05:19:14] 🔄 
🔄 Step 6: Pushing order to API...
[05:19:14] [DOC: 9320265] ℹ️  Pushing order via API for patient ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[05:19:15] [DOC: 9320265] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18827"}
[05:19:15] ❌    ❌ Failed to push order
[05:19:15] 🔄 
🔄 Step 7: Writing to CSV...
[05:19:15] [DOC: 9320265] ℹ️  Calculated age: 85 from DOB: 05/19/1940
[05:19:15] [DOC: 9320265] ℹ️  Service Line extracted: 'Nursing'
[05:19:15] [DOC: 9320265] ℹ️  Payer Source extracted: ''
[05:19:15] [DOC: 9320265] ℹ️  Diagnosis codes being written:
[05:19:15] [DOC: 9320265] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.918'
[05:19:15] [DOC: 9320265] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.1'
[05:19:15] [DOC: 9320265] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[05:19:15] [DOC: 9320265] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:19:15] [DOC: 9320265] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:19:15] [DOC: 9320265] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:19:15] [DOC: 9320265] ✅ Patient data written to CSV: Maria Pimentel | Sex: FEMALE | Age: 85 | Service: Nursing | Payer:  | MRN: MA200723054001
[05:19:15] ✅    ✅ Document 9320265 processed and saved successfully
[05:19:15] 🔄 
🔄 Step 8: Saving API details...
[05:19:15] [DOC: 9320265] ℹ️  API push details saved for document 9320265
[05:19:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320261                         ║
================================================================================
[05:19:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:19:15] ℹ️  Date: 05/30/2025
[05:19:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:18] [DOC: 9320261] ✅ Text extracted using pdfplumber (3631 chars)
[05:19:18] ✅    ✅ Text extracted using pdfplumber (3631 chars)
[05:19:18] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:21] ℹ️  AI extracted raw sex value: ''
[05:19:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:19:21] ℹ️  AI extracted payer source: ''
[05:19:21] ℹ️  AI extracted diagnoses:
[05:19:21] ℹ️    - Diagnosis 1: 'I10'
[05:19:21] ℹ️    - Diagnosis 2: 'J45.909'
[05:19:21] ℹ️    - Diagnosis 3: 'M19.90'
[05:19:21] ℹ️    - Diagnosis 4: ''
[05:19:21] ℹ️    - Diagnosis 5: ''
[05:19:21] ℹ️    - Diagnosis 6: ''
[05:19:21] ℹ️  Final extracted MRN: 'MA210617063801'
[05:19:21] ℹ️  Final extracted Sex: ''
[05:19:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:19:21] ℹ️  Final extracted Payer Source: ''
[05:19:21] ✅ Patient data extraction completed successfully
[05:19:21] ✅    ✅ Patient data extracted successfully
[05:19:21] 📊 Patient Response
     └─ patientFName: Jeanne
     └─ patientLName: Borges
     └─ dob: 06/28/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA210617063801
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:21] ✅    ✅ Patient identified: Jeanne Borges
[05:19:21] ✅    ✅ Patient name validation passed
[05:19:21] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:21] [DOC: 9320261] ℹ️  DOB normalized: 06/28/1938
[05:19:21] [DOC: 9320261] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[05:19:21] [DOC: 9320261] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[05:19:21] [DOC: 9320261] ✅ Patient date processing completed successfully
[05:19:21] ✅    ✅ Date processing completed
[05:19:21] 📊 Processed Patient Data
     └─ patientFName: Jeanne
     └─ patientLName: Borges
     └─ dob: 06/28/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA210617063801
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:21] 🔄 
🔄 Step 4: Extracting order data...
[05:19:23] ℹ️  Order extraction - MRN: 'MA210617063801'
[05:19:23] ℹ️  Order extraction - Sex: ''
[05:19:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:19:23] ℹ️  Order extraction - Payer Source: ''
[05:19:23] ✅ Order data extraction completed successfully
[05:19:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:23] ℹ️  Using MRN from patient data: 'MA210617063801' over 'MA210617063801'
[05:19:23] ⚠️  Could not determine sex using any available method
[05:19:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:19:23] ✅ Patient name cross-validation successful
[05:19:23] ✅    ✅ Data merged successfully
[05:19:24] ✅    ✅ Order data extracted and validated
[05:19:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:19:29] [DOC: 9320261] ✅ Patient exists in API: Jeanne Borges, ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[05:19:29] ✅    ✅ Existing patient found with ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[05:19:29] 🔄 
🔄 Step 6: Pushing order to API...
[05:19:29] [DOC: 9320261] ℹ️  Pushing order via API for patient ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[05:19:30] [DOC: 9320261] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18829"}
[05:19:30] ❌    ❌ Failed to push order
[05:19:30] 🔄 
🔄 Step 7: Writing to CSV...
[05:19:30] [DOC: 9320261] ℹ️  Calculated age: 86 from DOB: 06/28/1938
[05:19:30] [DOC: 9320261] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:19:30] [DOC: 9320261] ℹ️  Payer Source extracted: ''
[05:19:30] [DOC: 9320261] ℹ️  Diagnosis codes being written:
[05:19:30] [DOC: 9320261] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[05:19:30] [DOC: 9320261] ℹ️    - Latest_Episode_Seconddiagnosis: 'J45.909'
[05:19:30] [DOC: 9320261] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.90'
[05:19:30] [DOC: 9320261] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:19:30] [DOC: 9320261] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:19:30] [DOC: 9320261] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:19:30] [DOC: 9320261] ✅ Patient data written to CSV: Jeanne Borges | Sex:  | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: MA210617063801
[05:19:30] ✅    ✅ Document 9320261 processed and saved successfully
[05:19:30] 🔄 
🔄 Step 8: Saving API details...
[05:19:30] [DOC: 9320261] ℹ️  API push details saved for document 9320261
[05:19:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320152                         ║
================================================================================
[05:19:30] ℹ️  Agency: AccentCare Fall River
[05:19:30] ℹ️  Date: 05/30/2025
[05:19:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:49] [DOC: 9320152] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[05:19:58] [DOC: 9320152] ✅ Text extracted using tesseract_ocr (15232 chars)
[05:19:58] ✅    ✅ Text extracted using tesseract_ocr (15215 chars)
[05:19:58] 🔄 
🔄 Step 2: Extracting patient data...
[05:20:01] ℹ️  AI extracted raw sex value: 'F'
[05:20:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:20:01] ℹ️  AI extracted payer source: ''
[05:20:01] ℹ️  AI extracted diagnoses:
[05:20:01] ℹ️    - Diagnosis 1: 'N39.0'
[05:20:01] ℹ️    - Diagnosis 2: 'B26.5'
[05:20:01] ℹ️    - Diagnosis 3: 'F03.011'
[05:20:01] ℹ️    - Diagnosis 4: 'I11.9'
[05:20:01] ℹ️    - Diagnosis 5: 'E11.65'
[05:20:01] ℹ️    - Diagnosis 6: 'T38.0X5D'
[05:20:01] ℹ️  Final extracted MRN: 'C0200225049201'
[05:20:01] ℹ️  Final extracted Sex: 'FEMALE'
[05:20:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:20:01] ℹ️  Final extracted Payer Source: ''
[05:20:01] ✅ Patient data extraction completed successfully
[05:20:01] ✅    ✅ Patient data extracted successfully
[05:20:01] 📊 Patient Response
     └─ patientFName: Brunilda
     └─ patientLName: Jorge
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/21/2025', 'endOfEpisode': None, 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B26.5', 'thirdDiagnosis': 'F03.011', 'fourthDiagnosis': 'I11.9', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'T38.0X5D'}]
[05:20:01] ✅    ✅ Patient identified: Brunilda Jorge
[05:20:01] ✅    ✅ Patient name validation passed
[05:20:01] 🔄 
🔄 Step 3: Processing patient dates...
[05:20:01] [DOC: 9320152] ℹ️  DOB normalized: 11/15/1938
[05:20:01] [DOC: 9320152] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[05:20:01] [DOC: 9320152] ✅ Patient date processing completed successfully
[05:20:01] ✅    ✅ Date processing completed
[05:20:01] 📊 Processed Patient Data
     └─ patientFName: Brunilda
     └─ patientLName: Jorge
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/21/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B26.5', 'thirdDiagnosis': 'F03.011', 'fourthDiagnosis': 'I11.9', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'T38.0X5D'}]
[05:20:01] 🔄 
🔄 Step 4: Extracting order data...
[05:20:04] ℹ️  Order extraction - MRN: 'C0200225049201'
[05:20:04] ℹ️  Order extraction - Sex: 'FEMALE'
[05:20:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:20:04] ℹ️  Order extraction - Payer Source: ''
[05:20:04] ✅ Order data extraction completed successfully
[05:20:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:20:04] ℹ️  Using MRN from patient data: 'C0200225049201' over 'C0200225049201'
[05:20:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:20:04] ✅ Patient name cross-validation successful
[05:20:04] ✅    ✅ Data merged successfully
[05:20:05] ✅    ✅ Order data extracted and validated
[05:20:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:20:13] [DOC: 9320152] ✅ Patient exists in API: Brunilda Jorge, ID: be097701-4784-41f4-8780-f2f69c6e2485
[05:20:13] ✅    ✅ Existing patient found with ID: be097701-4784-41f4-8780-f2f69c6e2485
[05:20:13] 🔄 
🔄 Step 6: Pushing order to API...
[05:20:13] [DOC: 9320152] ℹ️  Pushing order via API for patient ID: be097701-4784-41f4-8780-f2f69c6e2485
[05:20:15] [DOC: 9320152] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18830"}
[05:20:15] ❌    ❌ Failed to push order
[05:20:15] 🔄 
🔄 Step 7: Writing to CSV...
[05:20:15] [DOC: 9320152] ℹ️  Calculated age: 86 from DOB: 11/15/1938
[05:20:15] [DOC: 9320152] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:20:15] [DOC: 9320152] ℹ️  Payer Source extracted: ''
[05:20:15] [DOC: 9320152] ℹ️  Diagnosis codes being written:
[05:20:15] [DOC: 9320152] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[05:20:15] [DOC: 9320152] ℹ️    - Latest_Episode_Seconddiagnosis: 'B26.5'
[05:20:15] [DOC: 9320152] ℹ️    - Latest_Episode_Thirddiagnosis: 'F03.011'
[05:20:15] [DOC: 9320152] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.9'
[05:20:15] [DOC: 9320152] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.65'
[05:20:15] [DOC: 9320152] ℹ️    - Latest_Episode_Sixthdiagnosis: 'T38.0X5D'
[05:20:15] [DOC: 9320152] ✅ Patient data written to CSV: Brunilda Jorge | Sex: FEMALE | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: C0200225049201
[05:20:15] ✅    ✅ Document 9320152 processed and saved successfully
[05:20:15] 🔄 
🔄 Step 8: Saving API details...
[05:20:15] [DOC: 9320152] ℹ️  API push details saved for document 9320152
[05:20:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320147                         ║
================================================================================
[05:20:15] ℹ️  Agency: Alphacare Home Health Agency
[05:20:15] ℹ️  Date: 05/30/2025
[05:20:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:20:19] [DOC: 9320147] ✅ Text extracted using pdfplumber (17122 chars)
[05:20:19] ✅    ✅ Text extracted using pdfplumber (17122 chars)
[05:20:19] 🔄 
🔄 Step 2: Extracting patient data...
[05:20:23] ℹ️  AI extracted raw sex value: 'F'
[05:20:23] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:20:23] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[05:20:23] ℹ️  AI extracted diagnoses:
[05:20:23] ℹ️    - Diagnosis 1: 'F31.81'
[05:20:23] ℹ️    - Diagnosis 2: 'F33.9'
[05:20:23] ℹ️    - Diagnosis 3: 'F41.1'
[05:20:23] ℹ️    - Diagnosis 4: 'M79.7'
[05:20:23] ℹ️    - Diagnosis 5: 'E66.9'
[05:20:23] ℹ️    - Diagnosis 6: 'M50.90'
[05:20:23] ℹ️  Final extracted MRN: '000001761'
[05:20:23] ℹ️  Final extracted Sex: 'FEMALE'
[05:20:23] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:20:23] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[05:20:23] ✅ Patient data extraction completed successfully
[05:20:23] ✅    ✅ Patient data extracted successfully
[05:20:23] 📊 Patient Response
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[05:20:23] ✅    ✅ Patient identified: Melissa Edwards
[05:20:23] ✅    ✅ Patient name validation passed
[05:20:23] 🔄 
🔄 Step 3: Processing patient dates...
[05:20:23] [DOC: 9320147] ℹ️  DOB normalized: 07/10/1978
[05:20:23] [DOC: 9320147] ℹ️  Episode startOfCare normalized: 05/21/2021
[05:20:23] [DOC: 9320147] ℹ️  Episode startOfEpisode normalized: 04/30/2025
[05:20:23] [DOC: 9320147] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[05:20:23] [DOC: 9320147] ✅ Patient date processing completed successfully
[05:20:23] ✅    ✅ Date processing completed
[05:20:23] 📊 Processed Patient Data
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[05:20:23] 🔄 
🔄 Step 4: Extracting order data...
[05:20:26] ℹ️  Order extraction - MRN: '000001761'
[05:20:26] ℹ️  Order extraction - Sex: 'FEMALE'
[05:20:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:20:26] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[05:20:26] ✅ Order data extraction completed successfully
[05:20:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:20:26] ℹ️  Using MRN from patient data: '000001761' over '000001761'
[05:20:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[05:20:26] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[05:20:26] ✅ Patient name cross-validation successful
[05:20:26] ✅    ✅ Data merged successfully
[05:20:27] ✅    ✅ Order data extracted and validated
[05:20:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:20:34] [DOC: 9320147] ✅ Patient exists in API: Melissa Edwards, ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[05:20:34] ✅    ✅ Existing patient found with ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[05:20:34] 🔄 
🔄 Step 6: Pushing order to API...
[05:20:34] [DOC: 9320147] ℹ️  Pushing order via API for patient ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[05:20:35] [DOC: 9320147] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:20:35] ❌    ❌ Failed to push order
[05:20:35] 🔄 
🔄 Step 7: Writing to CSV...
[05:20:35] [DOC: 9320147] ℹ️  Calculated age: 46 from DOB: 07/10/1978
[05:20:35] [DOC: 9320147] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[05:20:35] [DOC: 9320147] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[05:20:35] [DOC: 9320147] ℹ️  Diagnosis codes being written:
[05:20:35] [DOC: 9320147] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.81'
[05:20:35] [DOC: 9320147] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.9'
[05:20:35] [DOC: 9320147] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[05:20:35] [DOC: 9320147] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M79.7'
[05:20:35] [DOC: 9320147] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.9'
[05:20:35] [DOC: 9320147] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M50.90'
[05:20:35] [DOC: 9320147] ✅ Patient data written to CSV: Melissa Edwards | Sex: FEMALE | Age: 46 | Service: Skilled Nursing, Physical Therapy | Payer: MassHealth (Medicaid) | MRN: 000001761
[05:20:35] ✅    ✅ Document 9320147 processed and saved successfully
[05:20:35] 🔄 
🔄 Step 8: Saving API details...
[05:20:35] [DOC: 9320147] ℹ️  API push details saved for document 9320147
[05:20:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319870                         ║
================================================================================
[05:20:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:20:35] ℹ️  Date: 05/30/2025
[05:20:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:20:38] [DOC: 9319870] ✅ Text extracted using pdfplumber (3290 chars)
[05:20:38] ✅    ✅ Text extracted using pdfplumber (3278 chars)
[05:20:38] 🔄 
🔄 Step 2: Extracting patient data...
[05:20:40] ℹ️  AI extracted raw sex value: ''
[05:20:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:20:40] ℹ️  AI extracted payer source: ''
[05:20:40] ℹ️  AI extracted diagnoses:
[05:20:40] ℹ️    - Diagnosis 1: 'K55.9'
[05:20:40] ℹ️    - Diagnosis 2: 'E11.42'
[05:20:40] ℹ️    - Diagnosis 3: 'H81.13'
[05:20:40] ℹ️    - Diagnosis 4: ''
[05:20:40] ℹ️    - Diagnosis 5: ''
[05:20:40] ℹ️    - Diagnosis 6: ''
[05:20:40] ℹ️  Final extracted MRN: 'MA22129014501'
[05:20:40] ℹ️  Final extracted Sex: ''
[05:20:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:20:40] ℹ️  Final extracted Payer Source: ''
[05:20:40] ✅ Patient data extraction completed successfully
[05:20:40] ✅    ✅ Patient data extracted successfully
[05:20:40] 📊 Patient Response
     └─ patientFName: Eunice
     └─ patientLName: Rosa
     └─ dob: 01/17/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA22129014501
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'K55.9', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'H81.13', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:20:40] ✅    ✅ Patient identified: Eunice Rosa
[05:20:40] ✅    ✅ Patient name validation passed
[05:20:40] 🔄 
🔄 Step 3: Processing patient dates...
[05:20:40] [DOC: 9319870] ℹ️  DOB normalized: 01/17/1945
[05:20:40] [DOC: 9319870] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[05:20:40] [DOC: 9319870] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[05:20:40] [DOC: 9319870] ✅ Patient date processing completed successfully
[05:20:40] ✅    ✅ Date processing completed
[05:20:40] 📊 Processed Patient Data
     └─ patientFName: Eunice
     └─ patientLName: Rosa
     └─ dob: 01/17/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA22129014501
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'K55.9', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'H81.13', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:20:40] 🔄 
🔄 Step 4: Extracting order data...
[05:20:43] ℹ️  Order extraction - MRN: 'MA22129014501'
[05:20:43] ℹ️  Order extraction - Sex: ''
[05:20:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:20:43] ℹ️  Order extraction - Payer Source: ''
[05:20:43] ✅ Order data extraction completed successfully
[05:20:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:20:43] ℹ️  Using MRN from patient data: 'MA22129014501' over 'MA22129014501'
[05:20:43] ⚠️  Could not determine sex using any available method
[05:20:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:20:43] ✅ Patient name cross-validation successful
[05:20:43] ✅    ✅ Data merged successfully
[05:20:44] ✅    ✅ Order data extracted and validated
[05:20:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:20:54] [DOC: 9319870] ℹ️  Patient not found in cache or API: Eunice Rosa
[05:20:54] [DOC: 9319870] ℹ️  Patient not found, creating new patient via API...
[05:20:54] [DOC: 9319870] ℹ️  Creating patient via API: Eunice Rosa
[05:20:55] [DOC: 9319870] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:20:55] ❌    ❌ Failed to create patient
[05:20:55] [DOC: 9319870] ℹ️  API push details saved for document 9319870
================================================================================
║                        Processing Document ID: 9319860                         ║
================================================================================
[05:20:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:20:55] ℹ️  Date: 05/30/2025
[05:20:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:20:58] [DOC: 9319860] ✅ Text extracted using pdfplumber (17583 chars)
[05:20:58] ✅    ✅ Text extracted using pdfplumber (17583 chars)
[05:20:58] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:01] ℹ️  AI extracted raw sex value: 'M'
[05:21:01] ℹ️  AI extracted service line: 'PT'
[05:21:01] ℹ️  AI extracted payer source: ''
[05:21:01] ℹ️  AI extracted diagnoses:
[05:21:01] ℹ️    - Diagnosis 1: ''
[05:21:01] ℹ️    - Diagnosis 2: ''
[05:21:01] ℹ️    - Diagnosis 3: ''
[05:21:01] ℹ️    - Diagnosis 4: ''
[05:21:01] ℹ️    - Diagnosis 5: ''
[05:21:01] ℹ️    - Diagnosis 6: ''
[05:21:01] ℹ️  Final extracted MRN: '100999559'
[05:21:01] ℹ️  Final extracted Sex: 'MALE'
[05:21:01] ℹ️  Final extracted Service Line: 'PT'
[05:21:01] ℹ️  Final extracted Payer Source: ''
[05:21:01] ✅ Patient data extraction completed successfully
[05:21:01] ✅    ✅ Patient data extracted successfully
[05:21:01] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:21:01] ✅    ✅ Patient identified: Joseph Rodgers
[05:21:01] ✅    ✅ Patient name validation passed
[05:21:01] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:01] [DOC: 9319860] ℹ️  DOB normalized: 05/10/1942
[05:21:01] [DOC: 9319860] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[05:21:01] [DOC: 9319860] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[05:21:01] [DOC: 9319860] ✅ Patient date processing completed successfully
[05:21:01] ✅    ✅ Date processing completed
[05:21:01] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:21:01] 🔄 
🔄 Step 4: Extracting order data...
[05:21:04] ℹ️  Order extraction - MRN: '100999559'
[05:21:04] ℹ️  Order extraction - Sex: 'MALE'
[05:21:04] ℹ️  Order extraction - Service Line: 'PT'
[05:21:04] ℹ️  Order extraction - Payer Source: ''
[05:21:04] ✅ Order data extraction completed successfully
[05:21:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:04] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[05:21:04] ℹ️  Service line consistent in both sources: 'PT'
[05:21:04] ✅ Patient name cross-validation successful
[05:21:04] ✅    ✅ Data merged successfully
[05:21:06] ✅    ✅ Order data extracted and validated
[05:21:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:12] [DOC: 9319860] ✅ Patient exists in API: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[05:21:12] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[05:21:12] 🔄 
🔄 Step 6: Pushing order to API...
[05:21:12] [DOC: 9319860] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[05:21:13] [DOC: 9319860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:21:13] ❌    ❌ Failed to push order
[05:21:13] 🔄 
🔄 Step 7: Writing to CSV...
[05:21:13] [DOC: 9319860] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[05:21:13] [DOC: 9319860] ℹ️  Service Line extracted: 'PT'
[05:21:13] [DOC: 9319860] ℹ️  Payer Source extracted: ''
[05:21:13] [DOC: 9319860] ℹ️  Diagnosis codes being written:
[05:21:13] [DOC: 9319860] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:21:13] [DOC: 9319860] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:21:13] [DOC: 9319860] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:21:13] [DOC: 9319860] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:21:13] [DOC: 9319860] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:21:13] [DOC: 9319860] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:21:13] [DOC: 9319860] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: PT | Payer:  | MRN: 100999559
[05:21:13] ✅    ✅ Document 9319860 processed and saved successfully
[05:21:13] 🔄 
🔄 Step 8: Saving API details...
[05:21:13] [DOC: 9319860] ℹ️  API push details saved for document 9319860
[05:21:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319856                         ║
================================================================================
[05:21:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:21:13] ℹ️  Date: 05/30/2025
[05:21:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:21:20] [DOC: 9319856] ✅ Text extracted using pdfplumber (15267 chars)
[05:21:20] ✅    ✅ Text extracted using pdfplumber (15267 chars)
[05:21:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:23] ℹ️  AI extracted raw sex value: 'M'
[05:21:23] ℹ️  AI extracted service line: 'PT'
[05:21:23] ℹ️  AI extracted payer source: 'None'
[05:21:23] ℹ️  AI extracted diagnoses:
[05:21:23] ℹ️    - Diagnosis 1: 'Atypical atrial flutter'
[05:21:23] ℹ️    - Diagnosis 2: 'Muscle weakness'
[05:21:23] ℹ️    - Diagnosis 3: 'None'
[05:21:23] ℹ️    - Diagnosis 4: 'None'
[05:21:23] ℹ️    - Diagnosis 5: 'None'
[05:21:23] ℹ️    - Diagnosis 6: 'None'
[05:21:23] ℹ️  Final extracted MRN: 'MA240226073801'
[05:21:23] ℹ️  Final extracted Sex: 'MALE'
[05:21:23] ℹ️  Final extracted Service Line: 'PT'
[05:21:23] ℹ️  Final extracted Payer Source: ''
[05:21:23] ✅ Patient data extraction completed successfully
[05:21:23] ✅    ✅ Patient data extracted successfully
[05:21:23] 📊 Patient Response
     └─ patientFName: Gonzalo
     └─ patientLName: Morales
     └─ dob: 07/05/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240226073801
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/26/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Atypical atrial flutter', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:21:23] ✅    ✅ Patient identified: Gonzalo Morales
[05:21:23] ✅    ✅ Patient name validation passed
[05:21:23] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:23] [DOC: 9319856] ℹ️  DOB normalized: 07/05/1938
[05:21:23] [DOC: 9319856] ℹ️  Episode startOfEpisode normalized: 04/26/2025
[05:21:23] [DOC: 9319856] ✅ Patient date processing completed successfully
[05:21:23] ✅    ✅ Date processing completed
[05:21:23] 📊 Processed Patient Data
     └─ patientFName: Gonzalo
     └─ patientLName: Morales
     └─ dob: 07/05/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240226073801
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/26/2025', 'firstDiagnosis': 'Atypical atrial flutter', 'secondDiagnosis': 'Muscle weakness'}]
[05:21:23] 🔄 
🔄 Step 4: Extracting order data...
[05:21:26] ℹ️  Order extraction - MRN: 'MA240226073801'
[05:21:26] ℹ️  Order extraction - Sex: 'MALE'
[05:21:26] ℹ️  Order extraction - Service Line: 'PT'
[05:21:26] ℹ️  Order extraction - Payer Source: ''
[05:21:26] ✅ Order data extraction completed successfully
[05:21:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:26] ℹ️  Using MRN from patient data: 'MA240226073801' over 'MA240226073801'
[05:21:26] ℹ️  Service line consistent in both sources: 'PT'
[05:21:26] ✅ Patient name cross-validation successful
[05:21:26] ✅    ✅ Data merged successfully
[05:21:27] ✅    ✅ Order data extracted and validated
[05:21:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:33] [DOC: 9319856] ✅ Patient exists in API: Gonzalo Morales, ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[05:21:33] ✅    ✅ Existing patient found with ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[05:21:33] 🔄 
🔄 Step 6: Pushing order to API...
[05:21:33] [DOC: 9319856] ℹ️  Pushing order via API for patient ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[05:21:35] [DOC: 9319856] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:21:35] ❌    ❌ Failed to push order
[05:21:35] 🔄 
🔄 Step 7: Writing to CSV...
[05:21:35] [DOC: 9319856] ℹ️  Calculated age: 86 from DOB: 07/05/1938
[05:21:35] [DOC: 9319856] ℹ️  Service Line extracted: 'PT'
[05:21:35] [DOC: 9319856] ℹ️  Payer Source extracted: ''
[05:21:35] [DOC: 9319856] ℹ️  Diagnosis codes being written:
[05:21:35] [DOC: 9319856] ℹ️    - Latest_Episode_Firstdiagnosis: 'Atypical atrial flutter'
[05:21:35] [DOC: 9319856] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[05:21:35] [DOC: 9319856] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:21:35] [DOC: 9319856] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:21:35] [DOC: 9319856] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:21:35] [DOC: 9319856] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:21:35] [DOC: 9319856] ✅ Patient data written to CSV: Gonzalo Morales | Sex: MALE | Age: 86 | Service: PT | Payer:  | MRN: MA240226073801
[05:21:35] ✅    ✅ Document 9319856 processed and saved successfully
[05:21:35] 🔄 
🔄 Step 8: Saving API details...
[05:21:35] [DOC: 9319856] ℹ️  API push details saved for document 9319856
[05:21:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319674                         ║
================================================================================
[05:21:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:21:35] ℹ️  Date: 05/30/2025
[05:21:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:21:38] [DOC: 9319674] ✅ Text extracted using pdfplumber (14184 chars)
[05:21:38] ✅    ✅ Text extracted using pdfplumber (14184 chars)
[05:21:38] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:41] ℹ️  AI extracted raw sex value: 'F'
[05:21:41] ℹ️  AI extracted service line: 'OT'
[05:21:41] ℹ️  AI extracted payer source: ''
[05:21:41] ℹ️  AI extracted diagnoses:
[05:21:41] ℹ️    - Diagnosis 1: 'Z48.812'
[05:21:41] ℹ️    - Diagnosis 2: 'I25.10'
[05:21:41] ℹ️    - Diagnosis 3: 'I20.0'
[05:21:41] ℹ️    - Diagnosis 4: 'I25.1'
[05:21:41] ℹ️    - Diagnosis 5: 'J96.90'
[05:21:41] ℹ️    - Diagnosis 6: 'E87.6'
[05:21:41] ℹ️  Final extracted MRN: 'MA250507034403'
[05:21:41] ℹ️  Final extracted Sex: 'FEMALE'
[05:21:41] ℹ️  Final extracted Service Line: 'OT'
[05:21:41] ℹ️  Final extracted Payer Source: ''
[05:21:41] ✅ Patient data extraction completed successfully
[05:21:41] ✅    ✅ Patient data extracted successfully
[05:21:41] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Teixeira
     └─ dob: 03/03/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250507034403
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I20.0', 'fourthDiagnosis': 'I25.1', 'fifthDiagnosis': 'J96.90', 'sixthDiagnosis': 'E87.6'}]
[05:21:41] ✅    ✅ Patient identified: Maria Teixeira
[05:21:41] ✅    ✅ Patient name validation passed
[05:21:41] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:41] [DOC: 9319674] ℹ️  DOB normalized: 03/03/1944
[05:21:41] [DOC: 9319674] ✅ Patient date processing completed successfully
[05:21:41] ✅    ✅ Date processing completed
[05:21:41] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Teixeira
     └─ dob: 03/03/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250507034403
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I20.0', 'fourthDiagnosis': 'I25.1', 'fifthDiagnosis': 'J96.90', 'sixthDiagnosis': 'E87.6'}]
[05:21:41] 🔄 
🔄 Step 4: Extracting order data...
[05:21:44] ℹ️  Order extraction - MRN: 'MA250507034403'
[05:21:44] ℹ️  Order extraction - Sex: 'FEMALE'
[05:21:44] ℹ️  Order extraction - Service Line: 'OT'
[05:21:44] ℹ️  Order extraction - Payer Source: ''
[05:21:44] ✅ Order data extraction completed successfully
[05:21:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:44] ℹ️  Using MRN from patient data: 'MA250507034403' over 'MA250507034403'
[05:21:44] ℹ️  Service line consistent in both sources: 'OT'
[05:21:44] ✅ Patient name cross-validation successful
[05:21:44] ✅    ✅ Data merged successfully
[05:21:45] ✅    ✅ Order data extracted and validated
[05:21:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:57] [DOC: 9319674] ✅ Patient exists in API: Maria Teixeira, ID: 28dfa46f-3202-44f3-959a-6a0a90355e47
[05:21:57] ✅    ✅ Existing patient found with ID: 28dfa46f-3202-44f3-959a-6a0a90355e47
[05:21:57] 🔄 
🔄 Step 6: Pushing order to API...
[05:21:57] [DOC: 9319674] ℹ️  Pushing order via API for patient ID: 28dfa46f-3202-44f3-959a-6a0a90355e47
[05:21:58] [DOC: 9319674] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:21:58] ❌    ❌ Failed to push order
[05:21:58] 🔄 
🔄 Step 7: Writing to CSV...
[05:21:58] [DOC: 9319674] ℹ️  Calculated age: 81 from DOB: 03/03/1944
[05:21:58] [DOC: 9319674] ℹ️  Service Line extracted: 'OT'
[05:21:58] [DOC: 9319674] ℹ️  Payer Source extracted: ''
[05:21:58] [DOC: 9319674] ℹ️  Diagnosis codes being written:
[05:21:58] [DOC: 9319674] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.812'
[05:21:58] [DOC: 9319674] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[05:21:58] [DOC: 9319674] ℹ️    - Latest_Episode_Thirddiagnosis: 'I20.0'
[05:21:58] [DOC: 9319674] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.1'
[05:21:58] [DOC: 9319674] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J96.90'
[05:21:58] [DOC: 9319674] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.6'
[05:21:58] [DOC: 9319674] ✅ Patient data written to CSV: Maria Teixeira | Sex: FEMALE | Age: 81 | Service: OT | Payer:  | MRN: MA250507034403
[05:21:58] ✅    ✅ Document 9319674 processed and saved successfully
[05:21:58] 🔄 
🔄 Step 8: Saving API details...
[05:21:58] [DOC: 9319674] ℹ️  API push details saved for document 9319674
[05:21:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319648                         ║
================================================================================
[05:21:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:21:58] ℹ️  Date: 05/30/2025
[05:21:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:22:02] [DOC: 9319648] ✅ Text extracted using pdfplumber (12405 chars)
[05:22:02] ✅    ✅ Text extracted using pdfplumber (12405 chars)
[05:22:02] 🔄 
🔄 Step 2: Extracting patient data...
[05:22:05] ℹ️  AI extracted raw sex value: 'M'
[05:22:05] ℹ️  AI extracted service line: 'OT'
[05:22:05] ℹ️  AI extracted payer source: 'None'
[05:22:05] ℹ️  AI extracted diagnoses:
[05:22:05] ℹ️    - Diagnosis 1: 'None'
[05:22:05] ℹ️    - Diagnosis 2: 'None'
[05:22:05] ℹ️    - Diagnosis 3: 'None'
[05:22:05] ℹ️    - Diagnosis 4: 'None'
[05:22:05] ℹ️    - Diagnosis 5: 'None'
[05:22:05] ℹ️    - Diagnosis 6: 'None'
[05:22:05] ℹ️  Final extracted MRN: '101002230'
[05:22:05] ℹ️  Final extracted Sex: 'MALE'
[05:22:05] ℹ️  Final extracted Service Line: 'OT'
[05:22:05] ℹ️  Final extracted Payer Source: ''
[05:22:05] ✅ Patient data extraction completed successfully
[05:22:05] ✅    ✅ Patient data extracted successfully
[05:22:05] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Tonetto
     └─ dob: 08/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 101002230
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/23/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:22:05] ✅    ✅ Patient identified: John Tonetto
[05:22:05] ✅    ✅ Patient name validation passed
[05:22:05] 🔄 
🔄 Step 3: Processing patient dates...
[05:22:05] [DOC: 9319648] ℹ️  DOB normalized: 08/08/1933
[05:22:05] [DOC: 9319648] ℹ️  Episode startOfEpisode normalized: 05/23/2025
[05:22:05] [DOC: 9319648] ✅ Patient date processing completed successfully
[05:22:05] ✅    ✅ Date processing completed
[05:22:05] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Tonetto
     └─ dob: 08/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 101002230
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/23/2025'}]
[05:22:05] 🔄 
🔄 Step 4: Extracting order data...
[05:22:08] ℹ️  Order extraction - MRN: '101002230'
[05:22:08] ℹ️  Order extraction - Sex: 'MALE'
[05:22:08] ℹ️  Order extraction - Service Line: 'OT'
[05:22:08] ℹ️  Order extraction - Payer Source: ''
[05:22:08] ✅ Order data extraction completed successfully
[05:22:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:22:08] ℹ️  Using MRN from patient data: '101002230' over '101002230'
[05:22:08] ℹ️  Service line consistent in both sources: 'OT'
[05:22:08] ✅ Patient name cross-validation successful
[05:22:08] ✅    ✅ Data merged successfully
[05:22:09] ✅    ✅ Order data extracted and validated
[05:22:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:22:17] [DOC: 9319648] ✅ Patient exists in API: John Tonetto, ID: 276dab0d-c709-4df6-835a-f07135610c4e
[05:22:17] ✅    ✅ Existing patient found with ID: 276dab0d-c709-4df6-835a-f07135610c4e
[05:22:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:22:17] [DOC: 9319648] ℹ️  Pushing order via API for patient ID: 276dab0d-c709-4df6-835a-f07135610c4e
[05:22:18] [DOC: 9319648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:22:18] ❌    ❌ Failed to push order
[05:22:18] 🔄 
🔄 Step 7: Writing to CSV...
[05:22:18] [DOC: 9319648] ℹ️  Calculated age: 91 from DOB: 08/08/1933
[05:22:18] [DOC: 9319648] ℹ️  Service Line extracted: 'OT'
[05:22:18] [DOC: 9319648] ℹ️  Payer Source extracted: ''
[05:22:18] [DOC: 9319648] ℹ️  Diagnosis codes being written:
[05:22:18] [DOC: 9319648] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:22:18] [DOC: 9319648] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:22:18] [DOC: 9319648] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:22:18] [DOC: 9319648] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:22:18] [DOC: 9319648] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:22:18] [DOC: 9319648] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:22:18] [DOC: 9319648] ✅ Patient data written to CSV: John Tonetto | Sex: MALE | Age: 91 | Service: OT | Payer:  | MRN: 101002230
[05:22:18] ✅    ✅ Document 9319648 processed and saved successfully
[05:22:18] 🔄 
🔄 Step 8: Saving API details...
[05:22:18] [DOC: 9319648] ℹ️  API push details saved for document 9319648
[05:22:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319603                         ║
================================================================================
[05:22:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:22:18] ℹ️  Date: 05/30/2025
[05:22:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:22:20] [DOC: 9319603] ✅ Text extracted using pdfplumber (9990 chars)
[05:22:20] ✅    ✅ Text extracted using pdfplumber (9990 chars)
[05:22:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:22:24] ℹ️  AI extracted raw sex value: 'F'
[05:22:24] ℹ️  AI extracted service line: 'Physical Therapy'
[05:22:24] ℹ️  AI extracted payer source: ''
[05:22:24] ℹ️  AI extracted diagnoses:
[05:22:24] ℹ️    - Diagnosis 1: 'S06.300D'
[05:22:24] ℹ️    - Diagnosis 2: 'W19.XXXD'
[05:22:24] ℹ️    - Diagnosis 3: 'I10'
[05:22:24] ℹ️    - Diagnosis 4: 'I25.10'
[05:22:24] ℹ️    - Diagnosis 5: 'E78.5'
[05:22:24] ℹ️    - Diagnosis 6: 'K21.9'
[05:22:24] ℹ️  Final extracted MRN: '3092653'
[05:22:24] ℹ️  Final extracted Sex: 'FEMALE'
[05:22:24] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:22:24] ℹ️  Final extracted Payer Source: ''
[05:22:24] ✅ Patient data extraction completed successfully
[05:22:24] ✅    ✅ Patient data extracted successfully
[05:22:24] 📊 Patient Response
     └─ patientFName: Jeannette
     └─ patientLName: Whitlock
     └─ dob: 09/12/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3092653
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'S06.300D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[05:22:24] ✅    ✅ Patient identified: Jeannette Whitlock
[05:22:24] ✅    ✅ Patient name validation passed
[05:22:24] 🔄 
🔄 Step 3: Processing patient dates...
[05:22:24] [DOC: 9319603] ℹ️  DOB normalized: 09/12/1936
[05:22:24] [DOC: 9319603] ℹ️  Episode startOfCare normalized: 05/07/2025
[05:22:24] [DOC: 9319603] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[05:22:24] [DOC: 9319603] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[05:22:24] [DOC: 9319603] ✅ Patient date processing completed successfully
[05:22:24] ✅    ✅ Date processing completed
[05:22:24] 📊 Processed Patient Data
     └─ patientFName: Jeannette
     └─ patientLName: Whitlock
     └─ dob: 09/12/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3092653
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'S06.300D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[05:22:24] 🔄 
🔄 Step 4: Extracting order data...
[05:22:26] ℹ️  Order extraction - MRN: '3092653'
[05:22:26] ℹ️  Order extraction - Sex: 'FEMALE'
[05:22:26] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:22:26] ℹ️  Order extraction - Payer Source: ''
[05:22:26] ✅ Order data extraction completed successfully
[05:22:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:22:26] ℹ️  Using MRN from patient data: '3092653' over '3092653'
[05:22:26] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:22:26] ✅ Patient name cross-validation successful
[05:22:26] ✅    ✅ Data merged successfully
[05:22:28] ✅    ✅ Order data extracted and validated
[05:22:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:22:35] [DOC: 9319603] ✅ Patient exists in API: Jeannette Whitlock, ID: 483b8a68-8aef-46ad-8283-865c2089343b
[05:22:35] ✅    ✅ Existing patient found with ID: 483b8a68-8aef-46ad-8283-865c2089343b
[05:22:35] 🔄 
🔄 Step 6: Pushing order to API...
[05:22:35] [DOC: 9319603] ℹ️  Pushing order via API for patient ID: 483b8a68-8aef-46ad-8283-865c2089343b
[05:22:36] [DOC: 9319603] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18839"}
[05:22:36] ❌    ❌ Failed to push order
[05:22:36] 🔄 
🔄 Step 7: Writing to CSV...
[05:22:36] [DOC: 9319603] ℹ️  Calculated age: 88 from DOB: 09/12/1936
[05:22:36] [DOC: 9319603] ℹ️  Service Line extracted: 'Physical Therapy'
[05:22:36] [DOC: 9319603] ℹ️  Payer Source extracted: ''
[05:22:36] [DOC: 9319603] ℹ️  Diagnosis codes being written:
[05:22:36] [DOC: 9319603] ℹ️    - Latest_Episode_Firstdiagnosis: 'S06.300D'
[05:22:36] [DOC: 9319603] ℹ️    - Latest_Episode_Seconddiagnosis: 'W19.XXXD'
[05:22:36] [DOC: 9319603] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[05:22:36] [DOC: 9319603] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.10'
[05:22:36] [DOC: 9319603] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[05:22:36] [DOC: 9319603] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[05:22:36] [DOC: 9319603] ✅ Patient data written to CSV: Jeannette Whitlock | Sex: FEMALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: 3092653
[05:22:36] ✅    ✅ Document 9319603 processed and saved successfully
[05:22:36] 🔄 
🔄 Step 8: Saving API details...
[05:22:36] [DOC: 9319603] ℹ️  API push details saved for document 9319603
[05:22:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319596                         ║
================================================================================
[05:22:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:22:36] ℹ️  Date: 05/30/2025
[05:22:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:22:40] [DOC: 9319596] ✅ Text extracted using pdfplumber (17320 chars)
[05:22:40] ✅    ✅ Text extracted using pdfplumber (17320 chars)
[05:22:40] 🔄 
🔄 Step 2: Extracting patient data...
[05:22:48] ℹ️  AI extracted raw sex value: 'F'
[05:22:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:22:48] ℹ️  AI extracted payer source: ''
[05:22:48] ℹ️  AI extracted diagnoses:
[05:22:48] ℹ️    - Diagnosis 1: 'S81.811D'
[05:22:48] ℹ️    - Diagnosis 2: 'I87.2'
[05:22:48] ℹ️    - Diagnosis 3: 'I89.0'
[05:22:48] ℹ️    - Diagnosis 4: 'I10'
[05:22:48] ℹ️    - Diagnosis 5: 'E03.9'
[05:22:48] ℹ️    - Diagnosis 6: 'G47.33'
[05:22:48] ℹ️  Final extracted MRN: '3052261'
[05:22:48] ℹ️  Final extracted Sex: 'FEMALE'
[05:22:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:22:48] ℹ️  Final extracted Payer Source: ''
[05:22:48] ✅ Patient data extraction completed successfully
[05:22:48] ✅    ✅ Patient data extracted successfully
[05:22:48] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'S81.811D', 'secondDiagnosis': 'I87.2', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[05:22:48] ✅    ✅ Patient identified: Donna Trott
[05:22:48] ✅    ✅ Patient name validation passed
[05:22:48] 🔄 
🔄 Step 3: Processing patient dates...
[05:22:48] [DOC: 9319596] ℹ️  DOB normalized: 04/22/1943
[05:22:48] [DOC: 9319596] ℹ️  Episode startOfCare normalized: 05/09/2025
[05:22:48] [DOC: 9319596] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[05:22:48] [DOC: 9319596] ℹ️  Episode endOfEpisode normalized: 07/08/2025
[05:22:48] [DOC: 9319596] ✅ Patient date processing completed successfully
[05:22:48] ✅    ✅ Date processing completed
[05:22:48] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'S81.811D', 'secondDiagnosis': 'I87.2', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[05:22:48] 🔄 
🔄 Step 4: Extracting order data...
[05:22:51] ℹ️  Order extraction - MRN: '3052261'
[05:22:51] ℹ️  Order extraction - Sex: 'FEMALE'
[05:22:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:22:51] ℹ️  Order extraction - Payer Source: ''
[05:22:51] ✅ Order data extraction completed successfully
[05:22:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:22:51] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[05:22:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:22:51] ✅ Patient name cross-validation successful
[05:22:51] ✅    ✅ Data merged successfully
[05:22:52] ✅    ✅ Order data extracted and validated
[05:22:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:22:59] [DOC: 9319596] ✅ Patient exists in API: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[05:22:59] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[05:22:59] 🔄 
🔄 Step 6: Pushing order to API...
[05:22:59] [DOC: 9319596] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[05:23:00] [DOC: 9319596] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18904"}
[05:23:00] ❌    ❌ Failed to push order
[05:23:00] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:00] [DOC: 9319596] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[05:23:00] [DOC: 9319596] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:23:00] [DOC: 9319596] ℹ️  Payer Source extracted: ''
[05:23:00] [DOC: 9319596] ℹ️  Diagnosis codes being written:
[05:23:00] [DOC: 9319596] ℹ️    - Latest_Episode_Firstdiagnosis: 'S81.811D'
[05:23:00] [DOC: 9319596] ℹ️    - Latest_Episode_Seconddiagnosis: 'I87.2'
[05:23:00] [DOC: 9319596] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[05:23:00] [DOC: 9319596] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[05:23:00] [DOC: 9319596] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E03.9'
[05:23:00] [DOC: 9319596] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[05:23:00] [DOC: 9319596] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 3052261
[05:23:00] ✅    ✅ Document 9319596 processed and saved successfully
[05:23:00] 🔄 
🔄 Step 8: Saving API details...
[05:23:00] [DOC: 9319596] ℹ️  API push details saved for document 9319596
[05:23:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319586                         ║
================================================================================
[05:23:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:23:00] ℹ️  Date: 05/30/2025
[05:23:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:02] [DOC: 9319586] ✅ Text extracted using pdfplumber (804 chars)
[05:23:02] ✅    ✅ Text extracted using pdfplumber (804 chars)
[05:23:02] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:05] ℹ️  AI extracted raw sex value: 'F'
[05:23:05] ℹ️  AI extracted service line: ''
[05:23:05] ℹ️  AI extracted payer source: ''
[05:23:05] ℹ️  AI extracted diagnoses:
[05:23:05] ℹ️    - Diagnosis 1: ''
[05:23:05] ℹ️    - Diagnosis 2: ''
[05:23:05] ℹ️    - Diagnosis 3: ''
[05:23:05] ℹ️    - Diagnosis 4: ''
[05:23:05] ℹ️    - Diagnosis 5: ''
[05:23:05] ℹ️    - Diagnosis 6: ''
[05:23:05] ℹ️  Final extracted MRN: '3436729'
[05:23:05] ℹ️  Final extracted Sex: 'FEMALE'
[05:23:05] ℹ️  Final extracted Service Line: ''
[05:23:05] ℹ️  Final extracted Payer Source: ''
[05:23:05] ✅ Patient data extraction completed successfully
[05:23:05] ✅    ✅ Patient data extracted successfully
[05:23:05] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:05] ✅    ✅ Patient identified: Margaret Rudy
[05:23:05] ✅    ✅ Patient name validation passed
[05:23:05] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:05] [DOC: 9319586] ℹ️  DOB normalized: 04/23/1952
[05:23:05] [DOC: 9319586] ✅ Patient date processing completed successfully
[05:23:05] ✅    ✅ Date processing completed
[05:23:05] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:05] 🔄 
🔄 Step 4: Extracting order data...
[05:23:07] ℹ️  Order extraction - MRN: '3436729'
[05:23:07] ℹ️  Order extraction - Sex: 'FEMALE'
[05:23:07] ℹ️  Order extraction - Service Line: ''
[05:23:07] ℹ️  Order extraction - Payer Source: ''
[05:23:07] ✅ Order data extraction completed successfully
[05:23:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:07] ℹ️  Using MRN from patient data: '3436729' over '3436729'
[05:23:07] ✅ Patient name cross-validation successful
[05:23:07] ✅    ✅ Data merged successfully
[05:23:08] ⚠️     ❌ Skipping - missing episode start date
[05:23:08] [DOC: 9319586] ℹ️  API push details saved for document 9319586
================================================================================
║                        Processing Document ID: 9319584                         ║
================================================================================
[05:23:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:23:08] ℹ️  Date: 05/30/2025
[05:23:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:11] [DOC: 9319584] ✅ Text extracted using pdfplumber (16197 chars)
[05:23:11] ✅    ✅ Text extracted using pdfplumber (16197 chars)
[05:23:11] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:14] ℹ️  AI extracted raw sex value: 'F'
[05:23:14] ℹ️  AI extracted service line: 'Skilled Nursing, Medical Social Work, Clergy, Home Health Aide'
[05:23:14] ℹ️  AI extracted payer source: ''
[05:23:14] ℹ️  AI extracted diagnoses:
[05:23:14] ℹ️    - Diagnosis 1: 'G30.9'
[05:23:14] ℹ️    - Diagnosis 2: 'E03.9'
[05:23:14] ℹ️    - Diagnosis 3: 'E78.5'
[05:23:14] ℹ️    - Diagnosis 4: 'M48.00'
[05:23:14] ℹ️    - Diagnosis 5: 'F32.9'
[05:23:14] ℹ️    - Diagnosis 6: ''
[05:23:14] ℹ️  Final extracted MRN: '3436729'
[05:23:14] ℹ️  Final extracted Sex: 'FEMALE'
[05:23:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medical Social Work, Clergy, Home Health Aide'
[05:23:14] ℹ️  Final extracted Payer Source: ''
[05:23:14] ✅ Patient data extraction completed successfully
[05:23:14] ✅    ✅ Patient data extracted successfully
[05:23:14] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'M48.00', 'fifthDiagnosis': 'F32.9', 'sixthDiagnosis': ''}]
[05:23:14] ✅    ✅ Patient identified: Margaret Rudy
[05:23:14] ✅    ✅ Patient name validation passed
[05:23:14] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:14] [DOC: 9319584] ℹ️  DOB normalized: 04/23/1952
[05:23:14] [DOC: 9319584] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[05:23:14] [DOC: 9319584] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[05:23:14] [DOC: 9319584] ✅ Patient date processing completed successfully
[05:23:14] ✅    ✅ Date processing completed
[05:23:14] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'M48.00', 'fifthDiagnosis': 'F32.9', 'sixthDiagnosis': ''}]
[05:23:14] 🔄 
🔄 Step 4: Extracting order data...
[05:23:17] ℹ️  Order extraction - MRN: '3436729'
[05:23:17] ℹ️  Order extraction - Sex: 'FEMALE'
[05:23:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[05:23:17] ℹ️  Order extraction - Payer Source: ''
[05:23:17] ✅ Order data extraction completed successfully
[05:23:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:17] ℹ️  Using MRN from patient data: '3436729' over '3436729'
[05:23:17] ℹ️  Combined service lines: Patient='Skilled Nursing, Medical Social Work, Clergy, Home Health Aide' + Order='Skilled Nursing, MSW, HHA' = 'Clergy, HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing'
[05:23:17] ✅ Patient name cross-validation successful
[05:23:17] ✅    ✅ Data merged successfully
[05:23:18] ✅    ✅ Order data extracted and validated
[05:23:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:24] [DOC: 9319584] ✅ Patient exists in API: Margaret Rudy, ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[05:23:24] ✅    ✅ Existing patient found with ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[05:23:24] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:24] [DOC: 9319584] ℹ️  Pushing order via API for patient ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[05:23:25] [DOC: 9319584] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18842"}
[05:23:25] ❌    ❌ Failed to push order
[05:23:25] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:25] [DOC: 9319584] ℹ️  Calculated age: 73 from DOB: 04/23/1952
[05:23:25] [DOC: 9319584] ℹ️  Service Line extracted: 'Clergy, HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing'
[05:23:25] [DOC: 9319584] ℹ️  Payer Source extracted: ''
[05:23:25] [DOC: 9319584] ℹ️  Diagnosis codes being written:
[05:23:25] [DOC: 9319584] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[05:23:25] [DOC: 9319584] ℹ️    - Latest_Episode_Seconddiagnosis: 'E03.9'
[05:23:25] [DOC: 9319584] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[05:23:25] [DOC: 9319584] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M48.00'
[05:23:25] [DOC: 9319584] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.9'
[05:23:25] [DOC: 9319584] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:23:25] [DOC: 9319584] ✅ Patient data written to CSV: Margaret Rudy | Sex: FEMALE | Age: 73 | Service: Clergy, HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing | Payer:  | MRN: 3436729
[05:23:25] ✅    ✅ Document 9319584 processed and saved successfully
[05:23:25] 🔄 
🔄 Step 8: Saving API details...
[05:23:25] [DOC: 9319584] ℹ️  API push details saved for document 9319584
[05:23:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319581                         ║
================================================================================
[05:23:25] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:23:25] ℹ️  Date: 05/30/2025
[05:23:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:27] [DOC: 9319581] ✅ Text extracted using pdfplumber (6840 chars)
[05:23:27] ✅    ✅ Text extracted using pdfplumber (6840 chars)
[05:23:27] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:30] ℹ️  AI extracted raw sex value: 'F'
[05:23:30] ℹ️  AI extracted service line: 'RN'
[05:23:30] ℹ️  AI extracted payer source: ''
[05:23:30] ℹ️  AI extracted diagnoses:
[05:23:30] ℹ️    - Diagnosis 1: 'G30.9'
[05:23:30] ℹ️    - Diagnosis 2: 'F02.80'
[05:23:30] ℹ️    - Diagnosis 3: 'E03.9'
[05:23:30] ℹ️    - Diagnosis 4: 'E78.5'
[05:23:30] ℹ️    - Diagnosis 5: 'M48.00'
[05:23:30] ℹ️    - Diagnosis 6: 'F32.9'
[05:23:30] ℹ️  Final extracted MRN: '3436729'
[05:23:30] ℹ️  Final extracted Sex: 'FEMALE'
[05:23:30] ℹ️  Final extracted Service Line: 'RN'
[05:23:30] ℹ️  Final extracted Payer Source: ''
[05:23:30] ✅ Patient data extraction completed successfully
[05:23:30] ✅    ✅ Patient data extracted successfully
[05:23:30] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'F32.9'}]
[05:23:30] ✅    ✅ Patient identified: Margaret Rudy
[05:23:30] ✅    ✅ Patient name validation passed
[05:23:30] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:30] [DOC: 9319581] ℹ️  DOB normalized: 04/23/1952
[05:23:30] [DOC: 9319581] ℹ️  Episode startOfCare normalized: 05/28/2025
[05:23:30] [DOC: 9319581] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[05:23:30] [DOC: 9319581] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[05:23:30] [DOC: 9319581] ✅ Patient date processing completed successfully
[05:23:30] ✅    ✅ Date processing completed
[05:23:30] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'F32.9'}]
[05:23:30] 🔄 
🔄 Step 4: Extracting order data...
[05:23:33] ℹ️  Order extraction - MRN: '3436729'
[05:23:33] ℹ️  Order extraction - Sex: 'FEMALE'
[05:23:33] ℹ️  Order extraction - Service Line: 'RN'
[05:23:33] ℹ️  Order extraction - Payer Source: ''
[05:23:33] ✅ Order data extraction completed successfully
[05:23:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:33] ℹ️  Using MRN from patient data: '3436729' over '3436729'
[05:23:33] ℹ️  Service line consistent in both sources: 'RN'
[05:23:33] ✅ Patient name cross-validation successful
[05:23:33] ✅    ✅ Data merged successfully
[05:23:34] ✅    ✅ Order data extracted and validated
[05:23:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:34] [DOC: 9319581] ✅ Patient found in local cache: Margaret Rudy, ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[05:23:34] ✅    ✅ Existing patient found with ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[05:23:34] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:34] [DOC: 9319581] ℹ️  Pushing order via API for patient ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[05:23:37] [DOC: 9319581] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18843"}
[05:23:37] ❌    ❌ Failed to push order
[05:23:37] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:37] [DOC: 9319581] ℹ️  Calculated age: 73 from DOB: 04/23/1952
[05:23:37] [DOC: 9319581] ℹ️  Service Line extracted: 'RN'
[05:23:37] [DOC: 9319581] ℹ️  Payer Source extracted: ''
[05:23:37] [DOC: 9319581] ℹ️  Diagnosis codes being written:
[05:23:37] [DOC: 9319581] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[05:23:37] [DOC: 9319581] ℹ️    - Latest_Episode_Seconddiagnosis: 'F02.80'
[05:23:37] [DOC: 9319581] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[05:23:37] [DOC: 9319581] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[05:23:37] [DOC: 9319581] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M48.00'
[05:23:37] [DOC: 9319581] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.9'
[05:23:37] [DOC: 9319581] ✅ Patient data written to CSV: Margaret Rudy | Sex: FEMALE | Age: 73 | Service: RN | Payer:  | MRN: 3436729
[05:23:37] ✅    ✅ Document 9319581 processed and saved successfully
[05:23:37] 🔄 
🔄 Step 8: Saving API details...
[05:23:37] [DOC: 9319581] ℹ️  API push details saved for document 9319581
[05:23:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319556                         ║
================================================================================
[05:23:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:23:37] ℹ️  Date: 05/30/2025
[05:23:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:38] [DOC: 9319556] ✅ Text extracted using pdfplumber (1107 chars)
[05:23:38] ✅    ✅ Text extracted using pdfplumber (1107 chars)
[05:23:38] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:40] ℹ️  AI extracted raw sex value: 'M'
[05:23:40] ℹ️  AI extracted service line: 'Physical Therapy'
[05:23:40] ℹ️  AI extracted payer source: ''
[05:23:40] ℹ️  AI extracted diagnoses:
[05:23:40] ℹ️    - Diagnosis 1: ''
[05:23:40] ℹ️    - Diagnosis 2: ''
[05:23:40] ℹ️    - Diagnosis 3: ''
[05:23:40] ℹ️    - Diagnosis 4: ''
[05:23:40] ℹ️    - Diagnosis 5: ''
[05:23:40] ℹ️    - Diagnosis 6: ''
[05:23:40] ℹ️  Final extracted MRN: '2644347'
[05:23:40] ℹ️  Final extracted Sex: 'MALE'
[05:23:40] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:23:40] ℹ️  Final extracted Payer Source: ''
[05:23:40] ✅ Patient data extraction completed successfully
[05:23:40] ✅    ✅ Patient data extracted successfully
[05:23:40] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Lawrence
     └─ dob: 07/03/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2644347
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:40] ✅    ✅ Patient identified: Richard Lawrence
[05:23:40] ✅    ✅ Patient name validation passed
[05:23:40] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:40] [DOC: 9319556] ℹ️  DOB normalized: 07/03/1934
[05:23:40] [DOC: 9319556] ✅ Patient date processing completed successfully
[05:23:40] ✅    ✅ Date processing completed
[05:23:40] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Lawrence
     └─ dob: 07/03/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2644347
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:40] 🔄 
🔄 Step 4: Extracting order data...
[05:23:42] ℹ️  Order extraction - MRN: '2644347'
[05:23:42] ℹ️  Order extraction - Sex: 'MALE'
[05:23:42] ℹ️  Order extraction - Service Line: 'PT'
[05:23:42] ℹ️  Order extraction - Payer Source: ''
[05:23:42] ✅ Order data extraction completed successfully
[05:23:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:42] ℹ️  Using MRN from patient data: '2644347' over '2644347'
[05:23:42] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[05:23:42] ✅ Patient name cross-validation successful
[05:23:42] ✅    ✅ Data merged successfully
[05:23:44] ⚠️     ❌ Skipping - missing episode start date
[05:23:44] [DOC: 9319556] ℹ️  API push details saved for document 9319556
================================================================================
║                        Processing Document ID: 9319551                         ║
================================================================================
[05:23:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:23:44] ℹ️  Date: 05/30/2025
[05:23:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:46] [DOC: 9319551] ✅ Text extracted using pdfplumber (2652 chars)
[05:23:46] ✅    ✅ Text extracted using pdfplumber (2652 chars)
[05:23:46] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:48] ℹ️  AI extracted raw sex value: 'M'
[05:23:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:23:48] ℹ️  AI extracted payer source: ''
[05:23:48] ℹ️  AI extracted diagnoses:
[05:23:48] ℹ️    - Diagnosis 1: 'None'
[05:23:48] ℹ️    - Diagnosis 2: 'None'
[05:23:48] ℹ️    - Diagnosis 3: 'None'
[05:23:48] ℹ️    - Diagnosis 4: 'None'
[05:23:48] ℹ️    - Diagnosis 5: 'None'
[05:23:48] ℹ️    - Diagnosis 6: 'None'
[05:23:48] ℹ️  Final extracted MRN: '2643854'
[05:23:48] ℹ️  Final extracted Sex: 'MALE'
[05:23:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:23:48] ℹ️  Final extracted Payer Source: ''
[05:23:48] ✅ Patient data extraction completed successfully
[05:23:48] ✅    ✅ Patient data extracted successfully
[05:23:48] 📊 Patient Response
     └─ patientFName: Anthony
     └─ patientLName: Lawrence
     └─ dob: 04/04/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2643854
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/22/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:23:48] ✅    ✅ Patient identified: Anthony Lawrence
[05:23:48] ✅    ✅ Patient name validation passed
[05:23:48] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:48] [DOC: 9319551] ℹ️  DOB normalized: 04/04/1957
[05:23:48] [DOC: 9319551] ℹ️  Episode startOfEpisode normalized: 05/22/2025
[05:23:48] [DOC: 9319551] ✅ Patient date processing completed successfully
[05:23:48] ✅    ✅ Date processing completed
[05:23:48] 📊 Processed Patient Data
     └─ patientFName: Anthony
     └─ patientLName: Lawrence
     └─ dob: 04/04/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2643854
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/22/2025'}]
[05:23:48] 🔄 
🔄 Step 4: Extracting order data...
[05:23:51] ℹ️  Order extraction - MRN: '2643854'
[05:23:51] ℹ️  Order extraction - Sex: 'MALE'
[05:23:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:23:51] ℹ️  Order extraction - Payer Source: ''
[05:23:51] ✅ Order data extraction completed successfully
[05:23:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:51] ℹ️  Using MRN from patient data: '2643854' over '2643854'
[05:23:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:23:51] ✅ Patient name cross-validation successful
[05:23:51] ✅    ✅ Data merged successfully
[05:23:52] ✅    ✅ Order data extracted and validated
[05:23:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:58] [DOC: 9319551] ✅ Patient exists in API: Anthony Lawrence, ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[05:23:58] ✅    ✅ Existing patient found with ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[05:23:58] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:58] [DOC: 9319551] ℹ️  Pushing order via API for patient ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[05:23:59] [DOC: 9319551] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18845"}
[05:23:59] ❌    ❌ Failed to push order
[05:23:59] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:59] [DOC: 9319551] ℹ️  Calculated age: 68 from DOB: 04/04/1957
[05:23:59] [DOC: 9319551] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:23:59] [DOC: 9319551] ℹ️  Payer Source extracted: ''
[05:23:59] [DOC: 9319551] ℹ️  Diagnosis codes being written:
[05:23:59] [DOC: 9319551] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:23:59] [DOC: 9319551] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:23:59] [DOC: 9319551] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:23:59] [DOC: 9319551] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:23:59] [DOC: 9319551] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:23:59] [DOC: 9319551] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:23:59] [DOC: 9319551] ✅ Patient data written to CSV: Anthony Lawrence | Sex: MALE | Age: 68 | Service: Skilled Nursing | Payer:  | MRN: 2643854
[05:23:59] ✅    ✅ Document 9319551 processed and saved successfully
[05:23:59] 🔄 
🔄 Step 8: Saving API details...
[05:23:59] [DOC: 9319551] ℹ️  API push details saved for document 9319551
[05:23:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319547                         ║
================================================================================
[05:23:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:23:59] ℹ️  Date: 05/30/2025
[05:23:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:24:00] [DOC: 9319547] ✅ Text extracted using pdfplumber (1231 chars)
[05:24:00] ✅    ✅ Text extracted using pdfplumber (1231 chars)
[05:24:00] 🔄 
🔄 Step 2: Extracting patient data...
[05:24:03] ℹ️  AI extracted raw sex value: 'F'
[05:24:03] ℹ️  AI extracted service line: 'PT'
[05:24:03] ℹ️  AI extracted payer source: ''
[05:24:03] ℹ️  AI extracted diagnoses:
[05:24:03] ℹ️    - Diagnosis 1: ''
[05:24:03] ℹ️    - Diagnosis 2: ''
[05:24:03] ℹ️    - Diagnosis 3: ''
[05:24:03] ℹ️    - Diagnosis 4: ''
[05:24:03] ℹ️    - Diagnosis 5: ''
[05:24:03] ℹ️    - Diagnosis 6: ''
[05:24:03] ℹ️  Final extracted MRN: '2534454'
[05:24:03] ℹ️  Final extracted Sex: 'FEMALE'
[05:24:03] ℹ️  Final extracted Service Line: 'PT'
[05:24:03] ℹ️  Final extracted Payer Source: ''
[05:24:03] ✅ Patient data extraction completed successfully
[05:24:03] ✅    ✅ Patient data extracted successfully
[05:24:03] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Grant
     └─ dob: 05/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2534454
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:24:03] ✅    ✅ Patient identified: Elaine Grant
[05:24:03] ✅    ✅ Patient name validation passed
[05:24:03] 🔄 
🔄 Step 3: Processing patient dates...
[05:24:03] [DOC: 9319547] ℹ️  DOB normalized: 05/13/1938
[05:24:03] [DOC: 9319547] ✅ Patient date processing completed successfully
[05:24:03] ✅    ✅ Date processing completed
[05:24:03] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Grant
     └─ dob: 05/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2534454
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:24:03] 🔄 
🔄 Step 4: Extracting order data...
[05:24:05] ℹ️  Order extraction - MRN: '2534454'
[05:24:05] ℹ️  Order extraction - Sex: 'FEMALE'
[05:24:05] ℹ️  Order extraction - Service Line: ''
[05:24:05] ℹ️  Order extraction - Payer Source: ''
[05:24:05] ✅ Order data extraction completed successfully
[05:24:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:24:05] ℹ️  Using MRN from patient data: '2534454' over '2534454'
[05:24:05] ℹ️  Using service line from patient data: 'PT'
[05:24:05] ✅ Patient name cross-validation successful
[05:24:05] ✅    ✅ Data merged successfully
[05:24:06] ✅    ✅ Order data extracted and validated
[05:24:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:24:38] [DOC: 9319547] ✅ Patient exists in API: Elaine Grant, ID: f9d639b0-20d2-43f6-92ad-76378de59ddd
[05:24:38] ✅    ✅ Existing patient found with ID: f9d639b0-20d2-43f6-92ad-76378de59ddd
[05:24:38] 🔄 
🔄 Step 6: Pushing order to API...
[05:24:38] [DOC: 9319547] ℹ️  Pushing order via API for patient ID: f9d639b0-20d2-43f6-92ad-76378de59ddd
[05:24:40] [DOC: 9319547] ❌ Order push failed with status 201: {"id":"2ee2598f-4e40-47b6-8f74-baf4c4eed541","orderWAVId":"ORD19936","orderNo":"1096717, 1096718","orderDate":"05/29/2025","startOfCare":"04/28/2025","episodeStartDate":"04/28/2025","episodeEndDate":"05/28/2025","documentID":"9319547","mrn":"2534454","patientName":"Grant, Elaine M.","sentToPhysicianDate":"05/30/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"f9d639b0-20d2-43f6-92ad-76378de59ddd","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:24:40] ❌    ❌ Failed to push order
[05:24:40] 🔄 
🔄 Step 7: Writing to CSV...
[05:24:40] [DOC: 9319547] ℹ️  Calculated age: 87 from DOB: 05/13/1938
[05:24:40] [DOC: 9319547] ℹ️  Service Line extracted: 'PT'
[05:24:40] [DOC: 9319547] ℹ️  Payer Source extracted: ''
[05:24:40] [DOC: 9319547] ℹ️  Diagnosis codes being written:
[05:24:40] [DOC: 9319547] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:24:40] [DOC: 9319547] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:24:40] [DOC: 9319547] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:24:40] [DOC: 9319547] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:24:40] [DOC: 9319547] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:24:40] [DOC: 9319547] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:24:40] [DOC: 9319547] ✅ Patient data written to CSV: Elaine Grant | Sex: FEMALE | Age: 87 | Service: PT | Payer:  | MRN: 2534454
[05:24:40] ✅    ✅ Document 9319547 processed and saved successfully
[05:24:40] 🔄 
🔄 Step 8: Saving API details...
[05:24:40] [DOC: 9319547] ℹ️  API push details saved for document 9319547
[05:24:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319544                         ║
================================================================================
[05:24:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:24:40] ℹ️  Date: 05/30/2025
[05:24:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:24:45] [DOC: 9319544] ✅ Text extracted using pdfplumber (24166 chars)
[05:24:45] ✅    ✅ Text extracted using pdfplumber (24166 chars)
[05:24:45] 🔄 
🔄 Step 2: Extracting patient data...
[05:24:48] ℹ️  AI extracted raw sex value: 'F'
[05:24:48] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:24:48] ℹ️  AI extracted payer source: ''
[05:24:48] ℹ️  AI extracted diagnoses:
[05:24:48] ℹ️    - Diagnosis 1: 'K94.23'
[05:24:48] ℹ️    - Diagnosis 2: 'J44.9'
[05:24:48] ℹ️    - Diagnosis 3: 'Z93.0'
[05:24:48] ℹ️    - Diagnosis 4: 'Z85.21'
[05:24:48] ℹ️    - Diagnosis 5: 'Z90.02'
[05:24:48] ℹ️    - Diagnosis 6: 'I73.9'
[05:24:48] ℹ️  Final extracted MRN: '2520839'
[05:24:48] ℹ️  Final extracted Sex: 'FEMALE'
[05:24:48] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:24:48] ℹ️  Final extracted Payer Source: ''
[05:24:48] ✅ Patient data extraction completed successfully
[05:24:48] ✅    ✅ Patient data extracted successfully
[05:24:48] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: Gomes
     └─ dob: 09/10/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520839
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': 'K94.23', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'Z93.0', 'fourthDiagnosis': 'Z85.21', 'fifthDiagnosis': 'Z90.02', 'sixthDiagnosis': 'I73.9'}]
[05:24:48] ✅    ✅ Patient identified: Brenda Gomes
[05:24:48] ✅    ✅ Patient name validation passed
[05:24:48] 🔄 
🔄 Step 3: Processing patient dates...
[05:24:48] [DOC: 9319544] ℹ️  DOB normalized: 09/10/1958
[05:24:48] [DOC: 9319544] ℹ️  Episode startOfCare normalized: 05/08/2025
[05:24:48] [DOC: 9319544] ℹ️  Episode startOfEpisode normalized: 05/09/2025
[05:24:48] [DOC: 9319544] ℹ️  Episode endOfEpisode normalized: 07/07/2025
[05:24:48] [DOC: 9319544] ✅ Patient date processing completed successfully
[05:24:48] ✅    ✅ Date processing completed
[05:24:48] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: Gomes
     └─ dob: 09/10/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520839
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': 'K94.23', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'Z93.0', 'fourthDiagnosis': 'Z85.21', 'fifthDiagnosis': 'Z90.02', 'sixthDiagnosis': 'I73.9'}]
[05:24:48] 🔄 
🔄 Step 4: Extracting order data...
[05:24:51] ℹ️  Order extraction - MRN: '2520839'
[05:24:51] ℹ️  Order extraction - Sex: 'FEMALE'
[05:24:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:24:51] ℹ️  Order extraction - Payer Source: ''
[05:24:51] ✅ Order data extraction completed successfully
[05:24:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:24:51] ℹ️  Using MRN from patient data: '2520839' over '2520839'
[05:24:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[05:24:51] ✅ Patient name cross-validation successful
[05:24:51] ✅    ✅ Data merged successfully
[05:24:52] ✅    ✅ Order data extracted and validated
[05:24:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:25:02] [DOC: 9319544] ✅ Patient exists in API: Brenda Gomes, ID: 1b327d68-e1d7-497d-a470-a605c85cc1ab
[05:25:02] ✅    ✅ Existing patient found with ID: 1b327d68-e1d7-497d-a470-a605c85cc1ab
[05:25:02] 🔄 
🔄 Step 6: Pushing order to API...
[05:25:02] [DOC: 9319544] ℹ️  Pushing order via API for patient ID: 1b327d68-e1d7-497d-a470-a605c85cc1ab
[05:25:03] [DOC: 9319544] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18847"}
[05:25:03] ❌    ❌ Failed to push order
[05:25:03] 🔄 
🔄 Step 7: Writing to CSV...
[05:25:03] [DOC: 9319544] ℹ️  Calculated age: 66 from DOB: 09/10/1958
[05:25:03] [DOC: 9319544] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[05:25:03] [DOC: 9319544] ℹ️  Payer Source extracted: ''
[05:25:03] [DOC: 9319544] ℹ️  Diagnosis codes being written:
[05:25:03] [DOC: 9319544] ℹ️    - Latest_Episode_Firstdiagnosis: 'K94.23'
[05:25:03] [DOC: 9319544] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[05:25:03] [DOC: 9319544] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z93.0'
[05:25:03] [DOC: 9319544] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z85.21'
[05:25:03] [DOC: 9319544] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z90.02'
[05:25:03] [DOC: 9319544] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I73.9'
[05:25:03] [DOC: 9319544] ✅ Patient data written to CSV: Brenda Gomes | Sex: FEMALE | Age: 66 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2520839
[05:25:03] ✅    ✅ Document 9319544 processed and saved successfully
[05:25:03] 🔄 
🔄 Step 8: Saving API details...
[05:25:03] [DOC: 9319544] ℹ️  API push details saved for document 9319544
[05:25:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319528                         ║
================================================================================
[05:25:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:25:03] ℹ️  Date: 05/30/2025
[05:25:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:25:05] [DOC: 9319528] ✅ Text extracted using pdfplumber (954 chars)
[05:25:05] ✅    ✅ Text extracted using pdfplumber (954 chars)
[05:25:05] 🔄 
🔄 Step 2: Extracting patient data...
[05:25:07] ℹ️  AI extracted raw sex value: 'M'
[05:25:07] ℹ️  AI extracted service line: ''
[05:25:07] ℹ️  AI extracted payer source: ''
[05:25:07] ℹ️  AI extracted diagnoses:
[05:25:07] ℹ️    - Diagnosis 1: 'None'
[05:25:07] ℹ️    - Diagnosis 2: 'None'
[05:25:07] ℹ️    - Diagnosis 3: 'None'
[05:25:07] ℹ️    - Diagnosis 4: 'None'
[05:25:07] ℹ️    - Diagnosis 5: 'None'
[05:25:07] ℹ️    - Diagnosis 6: 'None'
[05:25:07] ℹ️  Final extracted MRN: '3171842'
[05:25:07] ℹ️  Final extracted Sex: 'MALE'
[05:25:07] ℹ️  Final extracted Service Line: ''
[05:25:07] ℹ️  Final extracted Payer Source: ''
[05:25:07] ✅ Patient data extraction completed successfully
[05:25:07] ✅    ✅ Patient data extracted successfully
[05:25:07] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Chaples
     └─ dob: 05/05/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 3171842
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:25:07] ✅    ✅ Patient identified: Robert Chaples
[05:25:07] ✅    ✅ Patient name validation passed
[05:25:07] 🔄 
🔄 Step 3: Processing patient dates...
[05:25:07] [DOC: 9319528] ℹ️  DOB normalized: 05/05/1932
[05:25:07] [DOC: 9319528] ✅ Patient date processing completed successfully
[05:25:07] ✅    ✅ Date processing completed
[05:25:07] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Chaples
     └─ dob: 05/05/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 3171842
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[05:25:07] 🔄 
🔄 Step 4: Extracting order data...
[05:25:10] ℹ️  Order extraction - MRN: '3171842'
[05:25:10] ℹ️  Order extraction - Sex: 'MALE'
[05:25:10] ℹ️  Order extraction - Service Line: ''
[05:25:10] ℹ️  Order extraction - Payer Source: ''
[05:25:10] ✅ Order data extraction completed successfully
[05:25:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:25:10] ℹ️  Using MRN from patient data: '3171842' over '3171842'
[05:25:10] ✅ Patient name cross-validation successful
[05:25:10] ✅    ✅ Data merged successfully
[05:25:11] ✅    ✅ Order data extracted and validated
[05:25:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:25:30] [DOC: 9319528] ✅ Patient exists in API: Robert Chaples, ID: 12741552-a5c8-46db-8caf-43870c507abb
[05:25:30] ✅    ✅ Existing patient found with ID: 12741552-a5c8-46db-8caf-43870c507abb
[05:25:30] 🔄 
🔄 Step 6: Pushing order to API...
[05:25:30] [DOC: 9319528] ℹ️  Pushing order via API for patient ID: 12741552-a5c8-46db-8caf-43870c507abb
[05:25:31] [DOC: 9319528] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18848"}
[05:25:31] ❌    ❌ Failed to push order
[05:25:31] 🔄 
🔄 Step 7: Writing to CSV...
[05:25:31] [DOC: 9319528] ℹ️  Calculated age: 93 from DOB: 05/05/1932
[05:25:31] [DOC: 9319528] ℹ️  Service Line extracted: ''
[05:25:31] [DOC: 9319528] ℹ️  Payer Source extracted: ''
[05:25:31] [DOC: 9319528] ℹ️  Diagnosis codes being written:
[05:25:31] [DOC: 9319528] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:25:31] [DOC: 9319528] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:25:31] [DOC: 9319528] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:25:31] [DOC: 9319528] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:25:31] [DOC: 9319528] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:25:31] [DOC: 9319528] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:25:31] [DOC: 9319528] ✅ Patient data written to CSV: Robert Chaples | Sex: MALE | Age: 93 | Service:  | Payer:  | MRN: 3171842
[05:25:31] ✅    ✅ Document 9319528 processed and saved successfully
[05:25:31] 🔄 
🔄 Step 8: Saving API details...
[05:25:31] [DOC: 9319528] ℹ️  API push details saved for document 9319528
[05:25:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319521                         ║
================================================================================
[05:25:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:25:31] ℹ️  Date: 05/30/2025
[05:25:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:25:32] [DOC: 9319521] ✅ Text extracted using pdfplumber (2282 chars)
[05:25:32] ✅    ✅ Text extracted using pdfplumber (2282 chars)
[05:25:32] 🔄 
🔄 Step 2: Extracting patient data...
[05:25:35] ℹ️  AI extracted raw sex value: 'F'
[05:25:35] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[05:25:35] ℹ️  AI extracted payer source: ''
[05:25:35] ℹ️  AI extracted diagnoses:
[05:25:35] ℹ️    - Diagnosis 1: ''
[05:25:35] ℹ️    - Diagnosis 2: ''
[05:25:35] ℹ️    - Diagnosis 3: ''
[05:25:35] ℹ️    - Diagnosis 4: ''
[05:25:35] ℹ️    - Diagnosis 5: ''
[05:25:35] ℹ️    - Diagnosis 6: ''
[05:25:35] ℹ️  Final extracted MRN: '2208958'
[05:25:35] ℹ️  Final extracted Sex: 'FEMALE'
[05:25:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[05:25:35] ℹ️  Final extracted Payer Source: ''
[05:25:35] ✅ Patient data extraction completed successfully
[05:25:35] ✅    ✅ Patient data extracted successfully
[05:25:35] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:25:35] ✅    ✅ Patient identified: Carol Baden
[05:25:35] ✅    ✅ Patient name validation passed
[05:25:35] 🔄 
🔄 Step 3: Processing patient dates...
[05:25:35] [DOC: 9319521] ℹ️  DOB normalized: 07/19/1940
[05:25:35] [DOC: 9319521] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[05:25:35] [DOC: 9319521] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[05:25:35] [DOC: 9319521] ✅ Patient date processing completed successfully
[05:25:35] ✅    ✅ Date processing completed
[05:25:35] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:25:35] 🔄 
🔄 Step 4: Extracting order data...
[05:25:38] ℹ️  Order extraction - MRN: '2208958'
[05:25:38] ℹ️  Order extraction - Sex: 'FEMALE'
[05:25:38] ℹ️  Order extraction - Service Line: 'SN, HHA'
[05:25:38] ℹ️  Order extraction - Payer Source: ''
[05:25:38] ✅ Order data extraction completed successfully
[05:25:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:25:38] ℹ️  Using MRN from patient data: '2208958' over '2208958'
[05:25:38] ℹ️  Combined service lines: Patient='Skilled Nursing, HHA' + Order='SN, HHA' = 'HHA, SN, Skilled Nursing'
[05:25:38] ✅ Patient name cross-validation successful
[05:25:38] ✅    ✅ Data merged successfully
[05:25:39] ✅    ✅ Order data extracted and validated
[05:25:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:25:39] [DOC: 9319521] ✅ Patient found in local cache: Carol Baden, ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:25:39] ✅    ✅ Existing patient found with ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:25:39] 🔄 
🔄 Step 6: Pushing order to API...
[05:25:39] [DOC: 9319521] ℹ️  Pushing order via API for patient ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:25:41] [DOC: 9319521] ❌ Order push failed with status 201: {"id":"8548d794-78d8-4c18-a81e-73fb688032a1","orderWAVId":"ORD19937","orderNo":"1096477, 1096478, 1096479","orderDate":"05/28/2025","startOfCare":"05/28/2025","episodeStartDate":"05/28/2025","episodeEndDate":"08/25/2025","documentID":"9319521","mrn":"2208958","patientName":"Baden,Carol J","sentToPhysicianDate":"05/30/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"b21bad59-ac67-44df-a4c9-722195632f90","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:25:41] ❌    ❌ Failed to push order
[05:25:41] 🔄 
🔄 Step 7: Writing to CSV...
[05:25:41] [DOC: 9319521] ℹ️  Calculated age: 84 from DOB: 07/19/1940
[05:25:41] [DOC: 9319521] ℹ️  Service Line extracted: 'HHA, SN, Skilled Nursing'
[05:25:41] [DOC: 9319521] ℹ️  Payer Source extracted: ''
[05:25:41] [DOC: 9319521] ℹ️  Diagnosis codes being written:
[05:25:41] [DOC: 9319521] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:25:41] [DOC: 9319521] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:25:41] [DOC: 9319521] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:25:41] [DOC: 9319521] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:25:41] [DOC: 9319521] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:25:41] [DOC: 9319521] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:25:41] [DOC: 9319521] ✅ Patient data written to CSV: Carol Baden | Sex: FEMALE | Age: 84 | Service: HHA, SN, Skilled Nursing | Payer:  | MRN: 2208958
[05:25:41] ✅    ✅ Document 9319521 processed and saved successfully
[05:25:41] 🔄 
🔄 Step 8: Saving API details...
[05:25:41] [DOC: 9319521] ℹ️  API push details saved for document 9319521
[05:25:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319519                         ║
================================================================================
[05:25:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:25:41] ℹ️  Date: 05/30/2025
[05:25:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:25:44] [DOC: 9319519] ✅ Text extracted using pdfplumber (8427 chars)
[05:25:44] ✅    ✅ Text extracted using pdfplumber (8427 chars)
[05:25:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:25:47] ℹ️  AI extracted raw sex value: 'F'
[05:25:47] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:25:47] ℹ️  AI extracted payer source: ''
[05:25:47] ℹ️  AI extracted diagnoses:
[05:25:47] ℹ️    - Diagnosis 1: 'I69.90'
[05:25:47] ℹ️    - Diagnosis 2: 'E44.0'
[05:25:47] ℹ️    - Diagnosis 3: 'R13.10'
[05:25:47] ℹ️    - Diagnosis 4: 'F01.50'
[05:25:47] ℹ️    - Diagnosis 5: 'I25.10'
[05:25:47] ℹ️    - Diagnosis 6: 'I50.9'
[05:25:47] ℹ️  Final extracted MRN: '2208958'
[05:25:47] ℹ️  Final extracted Sex: 'FEMALE'
[05:25:47] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:25:47] ℹ️  Final extracted Payer Source: ''
[05:25:47] ✅ Patient data extraction completed successfully
[05:25:47] ✅    ✅ Patient data extracted successfully
[05:25:47] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'F01.50', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I50.9'}]
[05:25:47] ✅    ✅ Patient identified: Carol Baden
[05:25:47] ✅    ✅ Patient name validation passed
[05:25:47] 🔄 
🔄 Step 3: Processing patient dates...
[05:25:47] [DOC: 9319519] ℹ️  DOB normalized: 07/19/1940
[05:25:47] [DOC: 9319519] ℹ️  Episode startOfCare normalized: 05/28/2025
[05:25:47] [DOC: 9319519] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[05:25:47] [DOC: 9319519] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[05:25:47] [DOC: 9319519] ✅ Patient date processing completed successfully
[05:25:47] ✅    ✅ Date processing completed
[05:25:47] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'F01.50', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I50.9'}]
[05:25:47] 🔄 
🔄 Step 4: Extracting order data...
[05:25:49] ℹ️  Order extraction - MRN: '2208958'
[05:25:49] ℹ️  Order extraction - Sex: 'FEMALE'
[05:25:49] ℹ️  Order extraction - Service Line: 'RN'
[05:25:49] ℹ️  Order extraction - Payer Source: ''
[05:25:49] ✅ Order data extraction completed successfully
[05:25:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:25:49] ℹ️  Using MRN from patient data: '2208958' over '2208958'
[05:25:49] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[05:25:49] ✅ Patient name cross-validation successful
[05:25:49] ✅    ✅ Data merged successfully
[05:25:51] ✅    ✅ Order data extracted and validated
[05:25:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:25:51] [DOC: 9319519] ✅ Patient found in local cache: Carol Baden, ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:25:51] ✅    ✅ Existing patient found with ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:25:51] 🔄 
🔄 Step 6: Pushing order to API...
[05:25:51] [DOC: 9319519] ℹ️  Pushing order via API for patient ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:25:52] [DOC: 9319519] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18905"}
[05:25:52] ❌    ❌ Failed to push order
[05:25:52] 🔄 
🔄 Step 7: Writing to CSV...
[05:25:52] [DOC: 9319519] ℹ️  Calculated age: 84 from DOB: 07/19/1940
[05:25:52] [DOC: 9319519] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[05:25:52] [DOC: 9319519] ℹ️  Payer Source extracted: ''
[05:25:52] [DOC: 9319519] ℹ️  Diagnosis codes being written:
[05:25:52] [DOC: 9319519] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.90'
[05:25:52] [DOC: 9319519] ℹ️    - Latest_Episode_Seconddiagnosis: 'E44.0'
[05:25:52] [DOC: 9319519] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.10'
[05:25:52] [DOC: 9319519] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F01.50'
[05:25:52] [DOC: 9319519] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[05:25:52] [DOC: 9319519] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.9'
[05:25:52] [DOC: 9319519] ✅ Patient data written to CSV: Carol Baden | Sex: FEMALE | Age: 84 | Service: RN, Skilled Nursing | Payer:  | MRN: 2208958
[05:25:52] ✅    ✅ Document 9319519 processed and saved successfully
[05:25:52] 🔄 
🔄 Step 8: Saving API details...
[05:25:52] [DOC: 9319519] ℹ️  API push details saved for document 9319519
[05:25:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319504                         ║
================================================================================
[05:25:52] ℹ️  Agency: Dartmouth HH
[05:25:52] ℹ️  Date: 05/30/2025
[05:25:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:25:57] [DOC: 9319504] ✅ Text extracted using pdfplumber (12146 chars)
[05:25:57] ✅    ✅ Text extracted using pdfplumber (12134 chars)
[05:25:57] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:00] ℹ️  AI extracted raw sex value: 'F'
[05:26:00] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[05:26:00] ℹ️  AI extracted payer source: ''
[05:26:00] ℹ️  AI extracted diagnoses:
[05:26:00] ℹ️    - Diagnosis 1: 'I10'
[05:26:00] ℹ️    - Diagnosis 2: 'G30.9'
[05:26:00] ℹ️    - Diagnosis 3: 'F02.83'
[05:26:00] ℹ️    - Diagnosis 4: 'F02.84'
[05:26:00] ℹ️    - Diagnosis 5: 'F41.1'
[05:26:00] ℹ️    - Diagnosis 6: 'R26.89'
[05:26:00] ℹ️  Final extracted MRN: '6339015'
[05:26:00] ℹ️  Final extracted Sex: 'FEMALE'
[05:26:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[05:26:00] ℹ️  Final extracted Payer Source: ''
[05:26:00] ✅ Patient data extraction completed successfully
[05:26:00] ✅    ✅ Patient data extracted successfully
[05:26:00] 📊 Patient Response
     └─ patientFName: Helen E
     └─ patientLName: Wade
     └─ dob: 06/10/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6339015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G30.9', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': 'F02.84', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'R26.89'}]
[05:26:00] ✅    ✅ Patient identified: Helen E Wade
[05:26:00] ✅    ✅ Patient name validation passed
[05:26:00] 🔄 
🔄 Step 3: Processing patient dates...
[05:26:00] [DOC: 9319504] ℹ️  DOB normalized: 06/10/1946
[05:26:00] [DOC: 9319504] ℹ️  Episode startOfCare normalized: 05/07/2025
[05:26:00] [DOC: 9319504] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[05:26:00] [DOC: 9319504] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[05:26:00] [DOC: 9319504] ✅ Patient date processing completed successfully
[05:26:00] ✅    ✅ Date processing completed
[05:26:00] 📊 Processed Patient Data
     └─ patientFName: Helen E
     └─ patientLName: Wade
     └─ dob: 06/10/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6339015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G30.9', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': 'F02.84', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'R26.89'}]
[05:26:00] 🔄 
🔄 Step 4: Extracting order data...
[05:26:02] ℹ️  Order extraction - MRN: '6339015'
[05:26:02] ℹ️  Order extraction - Sex: 'FEMALE'
[05:26:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[05:26:02] ℹ️  Order extraction - Payer Source: ''
[05:26:02] ✅ Order data extraction completed successfully
[05:26:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:26:02] ℹ️  Using MRN from patient data: '6339015' over '6339015'
[05:26:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[05:26:02] ✅ Patient name cross-validation successful
[05:26:02] ✅    ✅ Data merged successfully
[05:26:03] ✅    ✅ Order data extracted and validated
[05:26:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:26:09] [DOC: 9319504] ℹ️  Patient not found in cache or API: Helen E Wade
[05:26:09] [DOC: 9319504] ℹ️  Patient not found, creating new patient via API...
[05:26:09] [DOC: 9319504] ℹ️  Creating patient via API: Helen E Wade
[05:26:10] [DOC: 9319504] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:26:10] ❌    ❌ Failed to create patient
[05:26:10] [DOC: 9319504] ℹ️  API push details saved for document 9319504
================================================================================
║                        Processing Document ID: 9319493                         ║
================================================================================
[05:26:10] ℹ️  Agency: Dartmouth HH
[05:26:10] ℹ️  Date: 05/30/2025
[05:26:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:26:12] [DOC: 9319493] ✅ Text extracted using pdfplumber (1492 chars)
[05:26:12] ✅    ✅ Text extracted using pdfplumber (1492 chars)
[05:26:12] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:14] ℹ️  AI extracted raw sex value: 'F'
[05:26:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:26:14] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[05:26:14] ℹ️  AI extracted diagnoses:
[05:26:14] ℹ️    - Diagnosis 1: ''
[05:26:14] ℹ️    - Diagnosis 2: ''
[05:26:14] ℹ️    - Diagnosis 3: ''
[05:26:14] ℹ️    - Diagnosis 4: ''
[05:26:14] ℹ️    - Diagnosis 5: ''
[05:26:14] ℹ️    - Diagnosis 6: ''
[05:26:14] ℹ️  Final extracted MRN: '6545015'
[05:26:14] ℹ️  Final extracted Sex: 'FEMALE'
[05:26:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:26:14] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[05:26:14] ✅ Patient data extraction completed successfully
[05:26:14] ✅    ✅ Patient data extracted successfully
[05:26:14] 📊 Patient Response
     └─ patientFName: Sharon
     └─ patientLName: Costa
     └─ dob: 06/14/1965
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6545015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1197 Phillips Road Apt 5
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:26:14] ✅    ✅ Patient identified: Sharon Costa
[05:26:14] ✅    ✅ Patient name validation passed
[05:26:14] 🔄 
🔄 Step 3: Processing patient dates...
[05:26:14] [DOC: 9319493] ℹ️  DOB normalized: 06/14/1965
[05:26:14] [DOC: 9319493] ℹ️  Episode startOfCare normalized: 05/20/2025
[05:26:14] [DOC: 9319493] ℹ️  Episode startOfEpisode normalized: 05/20/2025
[05:26:14] [DOC: 9319493] ℹ️  Episode endOfEpisode normalized: 07/18/2025
[05:26:14] [DOC: 9319493] ✅ Patient date processing completed successfully
[05:26:14] ✅    ✅ Date processing completed
[05:26:14] 📊 Processed Patient Data
     └─ patientFName: Sharon
     └─ patientLName: Costa
     └─ dob: 06/14/1965
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6545015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1197 Phillips Road Apt 5
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:26:14] 🔄 
🔄 Step 4: Extracting order data...
[05:26:17] ℹ️  Order extraction - MRN: ''
[05:26:17] ℹ️  Order extraction - Sex: 'FEMALE'
[05:26:17] ℹ️  Order extraction - Service Line: 'SN, PRN'
[05:26:17] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[05:26:17] ✅ Order data extraction completed successfully
[05:26:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:26:17] ℹ️  Using MRN from patient data: '6545015'
[05:26:17] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN, PRN' = 'PRN, SN, Skilled Nursing'
[05:26:17] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[05:26:17] ✅ Patient name cross-validation successful
[05:26:17] ✅    ✅ Data merged successfully
[05:26:18] ✅    ✅ Order data extracted and validated
[05:26:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:26:42] [DOC: 9319493] ✅ Patient exists in API: Sharon Costa, ID: 0b73e07b-10a3-49cd-88d2-08f192402ec4
[05:26:42] ✅    ✅ Existing patient found with ID: 0b73e07b-10a3-49cd-88d2-08f192402ec4
[05:26:42] 🔄 
🔄 Step 6: Pushing order to API...
[05:26:42] [DOC: 9319493] ℹ️  Pushing order via API for patient ID: 0b73e07b-10a3-49cd-88d2-08f192402ec4
[05:26:44] [DOC: 9319493] ❌ Order push failed with status 201: {"id":"c91d72cc-137c-485c-9c65-f1a051db0d0e","orderWAVId":"ORD19938","orderNo":"6545015","orderDate":"05/23/2025","startOfCare":"05/20/2025","episodeStartDate":"05/20/2025","episodeEndDate":"07/18/2025","documentID":"9319493","mrn":"","patientName":"Costa, Sharon S","sentToPhysicianDate":"05/30/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"INTERIM ORDERS","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"0b73e07b-10a3-49cd-88d2-08f192402ec4","companyId":"d404757d-5027-45d2-a235-24a1fe763c9a","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:26:44] ❌    ❌ Failed to push order
[05:26:44] 🔄 
🔄 Step 7: Writing to CSV...
[05:26:44] [DOC: 9319493] ℹ️  Calculated age: 59 from DOB: 06/14/1965
[05:26:44] [DOC: 9319493] ℹ️  Service Line extracted: 'PRN, SN, Skilled Nursing'
[05:26:44] [DOC: 9319493] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[05:26:44] [DOC: 9319493] ℹ️  Diagnosis codes being written:
[05:26:44] [DOC: 9319493] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:26:44] [DOC: 9319493] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:26:44] [DOC: 9319493] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:26:44] [DOC: 9319493] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:26:44] [DOC: 9319493] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:26:44] [DOC: 9319493] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:26:44] [DOC: 9319493] ✅ Patient data written to CSV: Sharon Costa | Sex: FEMALE | Age: 59 | Service: PRN, SN, Skilled Nursing | Payer: Aetna- Mcare | MRN: 6545015
[05:26:44] ✅    ✅ Document 9319493 processed and saved successfully
[05:26:44] 🔄 
🔄 Step 8: Saving API details...
[05:26:44] [DOC: 9319493] ℹ️  API push details saved for document 9319493
[05:26:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319481                         ║
================================================================================
[05:26:44] ℹ️  Agency: Dartmouth HH
[05:26:44] ℹ️  Date: 05/30/2025
[05:26:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:26:46] [DOC: 9319481] ✅ Text extracted using pdfplumber (1708 chars)
[05:26:46] ✅    ✅ Text extracted using pdfplumber (1708 chars)
[05:26:46] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:49] ℹ️  AI extracted raw sex value: 'F'
[05:26:49] ℹ️  AI extracted service line: 'Skilled Nursing, Telehealth'
[05:26:49] ℹ️  AI extracted payer source: 'Medicare'
[05:26:49] ℹ️  AI extracted diagnoses:
[05:26:49] ℹ️    - Diagnosis 1: 'None'
[05:26:49] ℹ️    - Diagnosis 2: 'None'
[05:26:49] ℹ️    - Diagnosis 3: 'None'
[05:26:49] ℹ️    - Diagnosis 4: 'None'
[05:26:49] ℹ️    - Diagnosis 5: 'None'
[05:26:49] ℹ️    - Diagnosis 6: 'None'
[05:26:49] ℹ️  Final extracted MRN: '6523015'
[05:26:49] ℹ️  Final extracted Sex: 'FEMALE'
[05:26:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, Telehealth'
[05:26:49] ℹ️  Final extracted Payer Source: 'Medicare'
[05:26:49] ✅ Patient data extraction completed successfully
[05:26:49] ✅    ✅ Patient data extracted successfully
[05:26:49] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Telehealth
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:26:49] ✅    ✅ Patient identified: Dolores Hanson
[05:26:49] ✅    ✅ Patient name validation passed
[05:26:49] 🔄 
🔄 Step 3: Processing patient dates...
[05:26:49] [DOC: 9319481] ℹ️  DOB normalized: 11/26/1931
[05:26:49] [DOC: 9319481] ℹ️  Episode startOfCare normalized: 05/21/2025
[05:26:49] [DOC: 9319481] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[05:26:49] [DOC: 9319481] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[05:26:49] [DOC: 9319481] ✅ Patient date processing completed successfully
[05:26:49] ✅    ✅ Date processing completed
[05:26:49] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Telehealth
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025'}]
[05:26:49] 🔄 
🔄 Step 4: Extracting order data...
[05:26:52] ℹ️  Order extraction - MRN: ''
[05:26:52] ℹ️  Order extraction - Sex: 'FEMALE'
[05:26:52] ℹ️  Order extraction - Service Line: 'RN, LPN'
[05:26:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:26:52] ✅ Order data extraction completed successfully
[05:26:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:26:52] ℹ️  Using MRN from patient data: '6523015'
[05:26:52] ℹ️  Combined service lines: Patient='Skilled Nursing, Telehealth' + Order='RN, LPN' = 'LPN, RN, Skilled Nursing, Telehealth'
[05:26:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:26:52] ✅ Patient name cross-validation successful
[05:26:52] ✅    ✅ Data merged successfully
[05:26:53] ✅    ✅ Order data extracted and validated
[05:26:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:26:58] [DOC: 9319481] ✅ Patient exists in API: Dolores Hanson, ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[05:26:58] ✅    ✅ Existing patient found with ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[05:26:58] 🔄 
🔄 Step 6: Pushing order to API...
[05:26:58] [DOC: 9319481] ℹ️  Pushing order via API for patient ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[05:26:59] [DOC: 9319481] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:26:59] ❌    ❌ Failed to push order
[05:26:59] 🔄 
🔄 Step 7: Writing to CSV...
[05:26:59] [DOC: 9319481] ℹ️  Calculated age: 93 from DOB: 11/26/1931
[05:26:59] [DOC: 9319481] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing, Telehealth'
[05:26:59] [DOC: 9319481] ℹ️  Payer Source extracted: 'Medicare'
[05:26:59] [DOC: 9319481] ℹ️  Diagnosis codes being written:
[05:26:59] [DOC: 9319481] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:26:59] [DOC: 9319481] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:26:59] [DOC: 9319481] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:26:59] [DOC: 9319481] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:26:59] [DOC: 9319481] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:26:59] [DOC: 9319481] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:26:59] [DOC: 9319481] ✅ Patient data written to CSV: Dolores Hanson | Sex: FEMALE | Age: 93 | Service: LPN, RN, Skilled Nursing, Telehealth | Payer: Medicare | MRN: 6523015
[05:26:59] ✅    ✅ Document 9319481 processed and saved successfully
[05:26:59] 🔄 
🔄 Step 8: Saving API details...
[05:26:59] [DOC: 9319481] ℹ️  API push details saved for document 9319481
[05:26:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319471                         ║
================================================================================
[05:26:59] ℹ️  Agency: Dartmouth HH
[05:26:59] ℹ️  Date: 05/30/2025
[05:26:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:27:01] [DOC: 9319471] ✅ Text extracted using pdfplumber (1325 chars)
[05:27:01] ✅    ✅ Text extracted using pdfplumber (1325 chars)
[05:27:01] 🔄 
🔄 Step 2: Extracting patient data...
[05:27:04] ℹ️  AI extracted raw sex value: 'F'
[05:27:04] ℹ️  AI extracted service line: 'RN, LPN'
[05:27:04] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[05:27:04] ℹ️  AI extracted diagnoses:
[05:27:04] ℹ️    - Diagnosis 1: ''
[05:27:04] ℹ️    - Diagnosis 2: ''
[05:27:04] ℹ️    - Diagnosis 3: ''
[05:27:04] ℹ️    - Diagnosis 4: ''
[05:27:04] ℹ️    - Diagnosis 5: ''
[05:27:04] ℹ️    - Diagnosis 6: ''
[05:27:04] ℹ️  Final extracted MRN: '6427015'
[05:27:04] ℹ️  Final extracted Sex: 'FEMALE'
[05:27:04] ℹ️  Final extracted Service Line: 'RN, LPN'
[05:27:04] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[05:27:04] ✅ Patient data extraction completed successfully
[05:27:04] ✅    ✅ Patient data extracted successfully
[05:27:04] 📊 Patient Response
     └─ patientFName: Diana
     └─ patientLName: Harlfinger
     └─ dob: 09/30/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6427015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:27:04] ✅    ✅ Patient identified: Diana Harlfinger
[05:27:04] ✅    ✅ Patient name validation passed
[05:27:04] 🔄 
🔄 Step 3: Processing patient dates...
[05:27:04] [DOC: 9319471] ℹ️  DOB normalized: 09/30/1953
[05:27:04] [DOC: 9319471] ℹ️  Episode startOfCare normalized: 04/25/2025
[05:27:04] [DOC: 9319471] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[05:27:04] [DOC: 9319471] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[05:27:04] [DOC: 9319471] ✅ Patient date processing completed successfully
[05:27:04] ✅    ✅ Date processing completed
[05:27:04] 📊 Processed Patient Data
     └─ patientFName: Diana
     └─ patientLName: Harlfinger
     └─ dob: 09/30/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6427015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:27:04] 🔄 
🔄 Step 4: Extracting order data...
[05:27:06] ℹ️  Order extraction - MRN: ''
[05:27:06] ℹ️  Order extraction - Sex: 'FEMALE'
[05:27:06] ℹ️  Order extraction - Service Line: 'RN, LPN'
[05:27:06] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[05:27:06] ✅ Order data extraction completed successfully
[05:27:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:27:06] ℹ️  Using MRN from patient data: '6427015'
[05:27:06] ℹ️  Service line consistent in both sources: 'RN, LPN'
[05:27:06] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[05:27:06] ✅ Patient name cross-validation successful
[05:27:06] ✅    ✅ Data merged successfully
[05:27:08] ✅    ✅ Order data extracted and validated
[05:27:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:27:14] [DOC: 9319471] ℹ️  Patient not found in cache or API: Diana Harlfinger
[05:27:14] [DOC: 9319471] ℹ️  Patient not found, creating new patient via API...
[05:27:14] [DOC: 9319471] ℹ️  Creating patient via API: Diana Harlfinger
[05:27:15] [DOC: 9319471] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:27:15] ❌    ❌ Failed to create patient
[05:27:15] [DOC: 9319471] ℹ️  API push details saved for document 9319471
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[05:27:15] ℹ️  Total Processed: 49
[05:27:15] ℹ️  CSV Success: 32
[05:27:15] ℹ️  CSV Errors: 8
[05:27:15] ℹ️  API Success: 0
[05:27:15] ℹ️  API Errors: 41
[05:27:15] ℹ️  CSV Success Rate: 65.3%
[05:27:15] ℹ️  API Success Rate: 0.0%
[05:27:15] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_051043.csv
[05:27:15] ℹ️  API Details File: api_outputs/api_push_details_20250607_051043.csv
================================================================================
║          ============================================================          ║
================================================================================
