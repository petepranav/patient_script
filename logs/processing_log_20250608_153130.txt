================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[15:31:30] ℹ️  CSV Data Extraction & API Push Tool
[15:31:30] ℹ️  
[15:31:30] ℹ️  Features:
[15:31:30] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[15:31:30] ℹ️  - AI-powered patient and order data extraction
[15:31:30] ℹ️  - Enhanced error handling and logging
[15:31:30] ℹ️  - Full API integration (patient creation + order pushing)
[15:31:30] ℹ️  - CSV output with comprehensive patient data
[15:31:30] ℹ️  - Detailed API tracking with remarks for every document
[15:31:30] ℹ️  - Complete audit trail of all processing attempts
[15:31:30] ℹ️  
[15:31:30] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[15:31:30] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_153130.csv
[15:31:30] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_153130.csv
================================================================================
║                        Processing Document ID: 9227230                         ║
================================================================================
[15:31:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:31:30] ℹ️  Date: 04/08/2025
[15:31:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:31:40] [DOC: 9227230] ✅ Text extracted using pdfplumber (1909 chars)
[15:31:40] ✅    ✅ Text extracted using pdfplumber (1909 chars)
[15:31:40] 🔄 
🔄 Step 2: Extracting patient data...
[15:31:43] ℹ️  AI extracted raw sex value: 'F'
[15:31:43] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[15:31:43] ℹ️  AI extracted payer source: ''
[15:31:43] ℹ️  AI extracted diagnoses:
[15:31:43] ℹ️    - Diagnosis 1: 'None'
[15:31:43] ℹ️    - Diagnosis 2: 'None'
[15:31:43] ℹ️    - Diagnosis 3: 'None'
[15:31:43] ℹ️    - Diagnosis 4: 'None'
[15:31:43] ℹ️    - Diagnosis 5: 'None'
[15:31:43] ℹ️    - Diagnosis 6: 'None'
[15:31:43] ℹ️  Final extracted MRN: '2037361'
[15:31:43] ℹ️  Final extracted Sex: 'FEMALE'
[15:31:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[15:31:43] ℹ️  Final extracted Payer Source: ''
[15:31:43] ✅ Patient data extraction completed successfully
[15:31:43] ✅    ✅ Patient data extracted successfully
[15:31:43] 📊 Patient Response
     └─ patientFName: Euridice
     └─ patientLName: Caldas
     └─ dob: 10/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2037361
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:31:43] ✅    ✅ Patient identified: Euridice Caldas
[15:31:43] ✅    ✅ Patient name validation passed
[15:31:43] 🔄 
🔄 Step 3: Processing patient dates...
[15:31:43] [DOC: 9227230] ℹ️  DOB normalized: 10/13/1934
[15:31:43] [DOC: 9227230] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[15:31:43] [DOC: 9227230] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[15:31:43] [DOC: 9227230] ✅ Patient date processing completed successfully
[15:31:43] ✅    ✅ Date processing completed
[15:31:43] 📊 Processed Patient Data
     └─ patientFName: Euridice
     └─ patientLName: Caldas
     └─ dob: 10/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2037361
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025'}]
[15:31:43] 🔄 
🔄 Step 4: Extracting order data...
[15:31:45] ℹ️  Order extraction - MRN: '2037361'
[15:31:45] ℹ️  Order extraction - Sex: 'FEMALE'
[15:31:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[15:31:45] ℹ️  Order extraction - Payer Source: ''
[15:31:45] ✅ Order data extraction completed successfully
[15:31:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:31:45] ℹ️  Using MRN from patient data: '2037361' over '2037361'
[15:31:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide'
[15:31:45] ✅ Patient name cross-validation successful
[15:31:45] ✅    ✅ Data merged successfully
[15:31:46] ✅    ✅ Order data extracted and validated
[15:31:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:31:46] [DOC: 9227230] ✅ Patient found in local cache: Euridice Caldas, ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[15:31:46] ✅    ✅ Existing patient found with ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[15:31:46] 🔄 
🔄 Step 6: Pushing order to API...
[15:31:46] [DOC: 9227230] ℹ️  Pushing order via API for patient ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[15:31:48] [DOC: 9227230] ❌ Order push failed with status 201: {"id":"995f8e82-a92d-413e-8ad2-e2dde8e05d62","orderWAVId":"ORD20052","orderNo":"1079541, 1079542, 1079571","orderDate":"04/07/2025","startOfCare":"04/10/2025","episodeStartDate":"04/10/2025","episodeEndDate":"06/08/2025","documentID":"9227230","mrn":"2037361","patientName":"Caldas,Euridice S","sentToPhysicianDate":"04/08/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"1e054717-d198-4bd4-bb3b-44e39f78739e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:31:48] ❌    ❌ Failed to push order
[15:31:48] 🔄 
🔄 Step 7: Writing to CSV...
[15:31:48] [DOC: 9227230] ℹ️  Calculated age: 90 from DOB: 10/13/1934
[15:31:48] [DOC: 9227230] ℹ️  Service Line extracted: 'Skilled Nursing, Home Health Aide'
[15:31:48] [DOC: 9227230] ℹ️  Payer Source extracted: ''
[15:31:48] [DOC: 9227230] ℹ️  Diagnosis codes being written:
[15:31:48] [DOC: 9227230] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:31:48] [DOC: 9227230] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:31:48] [DOC: 9227230] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:31:48] [DOC: 9227230] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:31:48] [DOC: 9227230] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:31:48] [DOC: 9227230] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:31:48] [DOC: 9227230] ✅ Patient data written to CSV: Euridice Caldas | Sex: FEMALE | Age: 90 | Service: Skilled Nursing, Home Health Aide | Payer:  | MRN: 2037361
[15:31:48] ✅    ✅ Document 9227230 processed and saved successfully
[15:31:48] 🔄 
🔄 Step 8: Saving API details...
[15:31:48] [DOC: 9227230] ℹ️  API push details saved for document 9227230
[15:31:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227229                         ║
================================================================================
[15:31:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:31:48] ℹ️  Date: 04/08/2025
[15:31:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:31:50] [DOC: 9227229] ✅ Text extracted using pdfplumber (1292 chars)
[15:31:50] ✅    ✅ Text extracted using pdfplumber (1292 chars)
[15:31:50] 🔄 
🔄 Step 2: Extracting patient data...
[15:31:52] ℹ️  AI extracted raw sex value: 'F'
[15:31:52] ℹ️  AI extracted service line: 'Physical Therapy'
[15:31:52] ℹ️  AI extracted payer source: ''
[15:31:52] ℹ️  AI extracted diagnoses:
[15:31:52] ℹ️    - Diagnosis 1: ''
[15:31:52] ℹ️    - Diagnosis 2: ''
[15:31:52] ℹ️    - Diagnosis 3: ''
[15:31:52] ℹ️    - Diagnosis 4: ''
[15:31:52] ℹ️    - Diagnosis 5: ''
[15:31:52] ℹ️    - Diagnosis 6: ''
[15:31:52] ℹ️  Final extracted MRN: '2153963'
[15:31:52] ℹ️  Final extracted Sex: 'FEMALE'
[15:31:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:31:52] ℹ️  Final extracted Payer Source: ''
[15:31:52] ✅ Patient data extraction completed successfully
[15:31:52] ✅    ✅ Patient data extracted successfully
[15:31:52] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: Tapper
     └─ dob: 02/15/1982
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2153963
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: []
[15:31:52] ✅    ✅ Patient identified: Elizabeth Tapper
[15:31:52] ✅    ✅ Patient name validation passed
[15:31:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:31:52] [DOC: 9227229] ℹ️  DOB normalized: 02/15/1982
[15:31:52] [DOC: 9227229] ✅ Patient date processing completed successfully
[15:31:52] ✅    ✅ Date processing completed
[15:31:52] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: Tapper
     └─ dob: 02/15/1982
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2153963
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: []
[15:31:52] 🔄 
🔄 Step 4: Extracting order data...
[15:31:54] ℹ️  Order extraction - MRN: '2153963'
[15:31:54] ℹ️  Order extraction - Sex: 'FEMALE'
[15:31:54] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:31:54] ℹ️  Order extraction - Payer Source: ''
[15:31:54] ✅ Order data extraction completed successfully
[15:31:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:31:54] ℹ️  Using MRN from patient data: '2153963' over '2153963'
[15:31:54] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:31:54] ✅ Patient name cross-validation successful
[15:31:54] ✅    ✅ Data merged successfully
[15:31:55] ✅    ✅ Order data extracted and validated
[15:31:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:10] [DOC: 9227229] ℹ️  Patient not found in cache or API: Elizabeth Tapper
[15:32:10] [DOC: 9227229] ℹ️  Patient not found, creating new patient via API...
[15:32:10] [DOC: 9227229] ℹ️  Creating patient via API: Elizabeth Tapper
[15:32:11] [DOC: 9227229] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:32:11] ❌    ❌ Failed to create patient
[15:32:11] [DOC: 9227229] ℹ️  API push details saved for document 9227229
================================================================================
║                        Processing Document ID: 9225806                         ║
================================================================================
[15:32:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:32:11] ℹ️  Date: 04/07/2025
[15:32:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:13] [DOC: 9225806] ✅ Text extracted using pdfplumber (1180 chars)
[15:32:13] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[15:32:13] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:16] ℹ️  AI extracted raw sex value: ''
[15:32:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:32:16] ℹ️  AI extracted payer source: ''
[15:32:16] ℹ️  AI extracted diagnoses:
[15:32:16] ℹ️    - Diagnosis 1: 'K57.30'
[15:32:16] ℹ️    - Diagnosis 2: 'K52.9'
[15:32:16] ℹ️    - Diagnosis 3: 'R53.1'
[15:32:16] ℹ️    - Diagnosis 4: ''
[15:32:16] ℹ️    - Diagnosis 5: ''
[15:32:16] ℹ️    - Diagnosis 6: ''
[15:32:16] ℹ️  Final extracted MRN: 'MA231109053505'
[15:32:16] ℹ️  Final extracted Sex: ''
[15:32:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:32:16] ℹ️  Final extracted Payer Source: ''
[15:32:16] ✅ Patient data extraction completed successfully
[15:32:16] ✅    ✅ Patient data extracted successfully
[15:32:16] 📊 Patient Response
     └─ patientFName: Hilda
     └─ patientLName: Pine
     └─ dob: 05/08/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA231109053505
     └─ billingProvider: JUDITH MIESNER MD
     └─ npi: 1669448635
     └─ physicianNPI: 1669448635
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'K57.30', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:16] ✅    ✅ Patient identified: Hilda Pine
[15:32:16] ✅    ✅ Patient name validation passed
[15:32:16] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:16] [DOC: 9225806] ℹ️  DOB normalized: 05/08/1935
[15:32:16] [DOC: 9225806] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[15:32:16] [DOC: 9225806] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[15:32:16] [DOC: 9225806] ✅ Patient date processing completed successfully
[15:32:16] ✅    ✅ Date processing completed
[15:32:16] 📊 Processed Patient Data
     └─ patientFName: Hilda
     └─ patientLName: Pine
     └─ dob: 05/08/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA231109053505
     └─ billingProvider: JUDITH MIESNER MD
     └─ npi: 1669448635
     └─ physicianNPI: 1669448635
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'K57.30', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:16] 🔄 
🔄 Step 4: Extracting order data...
[15:32:18] ℹ️  Order extraction - MRN: 'MA231109053505'
[15:32:18] ℹ️  Order extraction - Sex: ''
[15:32:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:32:18] ℹ️  Order extraction - Payer Source: ''
[15:32:18] ✅ Order data extraction completed successfully
[15:32:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:18] ℹ️  Using MRN from patient data: 'MA231109053505' over 'MA231109053505'
[15:32:18] ⚠️  Could not determine sex using any available method
[15:32:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:32:18] ✅ Patient name cross-validation successful
[15:32:18] ✅    ✅ Data merged successfully
[15:32:19] ✅    ✅ Order data extracted and validated
[15:32:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:19] [DOC: 9225806] ✅ Patient found in local cache: Hilda Pine, ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[15:32:19] ✅    ✅ Existing patient found with ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[15:32:19] 🔄 
🔄 Step 6: Pushing order to API...
[15:32:19] [DOC: 9225806] ℹ️  Pushing order via API for patient ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[15:32:20] [DOC: 9225806] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13075"}
[15:32:20] ❌    ❌ Failed to push order
[15:32:20] 🔄 
🔄 Step 7: Writing to CSV...
[15:32:20] [DOC: 9225806] ℹ️  Calculated age: 90 from DOB: 05/08/1935
[15:32:20] [DOC: 9225806] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:32:20] [DOC: 9225806] ℹ️  Payer Source extracted: ''
[15:32:20] [DOC: 9225806] ℹ️  Diagnosis codes being written:
[15:32:20] [DOC: 9225806] ℹ️    - Latest_Episode_Firstdiagnosis: 'K57.30'
[15:32:20] [DOC: 9225806] ℹ️    - Latest_Episode_Seconddiagnosis: 'K52.9'
[15:32:20] [DOC: 9225806] ℹ️    - Latest_Episode_Thirddiagnosis: 'R53.1'
[15:32:20] [DOC: 9225806] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:32:20] [DOC: 9225806] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:32:20] [DOC: 9225806] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:32:20] [DOC: 9225806] ✅ Patient data written to CSV: Hilda Pine | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA231109053505
[15:32:20] ✅    ✅ Document 9225806 processed and saved successfully
[15:32:20] 🔄 
🔄 Step 8: Saving API details...
[15:32:20] [DOC: 9225806] ℹ️  API push details saved for document 9225806
[15:32:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9225800                         ║
================================================================================
[15:32:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:32:20] ℹ️  Date: 04/07/2025
[15:32:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:23] [DOC: 9225800] ✅ Text extracted using pdfplumber (13287 chars)
[15:32:23] ✅    ✅ Text extracted using pdfplumber (13287 chars)
[15:32:23] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:26] ℹ️  AI extracted raw sex value: ''
[15:32:26] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[15:32:26] ℹ️  AI extracted payer source: ''
[15:32:26] ℹ️  AI extracted diagnoses:
[15:32:26] ℹ️    - Diagnosis 1: 'J189'
[15:32:26] ℹ️    - Diagnosis 2: 'J440'
[15:32:26] ℹ️    - Diagnosis 3: 'J441'
[15:32:26] ℹ️    - Diagnosis 4: 'J210'
[15:32:26] ℹ️    - Diagnosis 5: 'G9341'
[15:32:26] ℹ️    - Diagnosis 6: 'E871'
[15:32:26] ℹ️  Final extracted MRN: '100992997'
[15:32:26] ℹ️  Final extracted Sex: ''
[15:32:26] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[15:32:26] ℹ️  Final extracted Payer Source: ''
[15:32:26] ✅ Patient data extraction completed successfully
[15:32:26] ✅    ✅ Patient data extracted successfully
[15:32:26] 📊 Patient Response
     └─ patientFName: Rosa
     └─ patientLName: Fidalgo
     └─ dob: 06/14/1940
     └─ patientSex: 
     └─ medicalRecordNo: 100992997
     └─ billingProvider: MIESNER, JUDITH
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/28/2025', 'firstDiagnosis': 'J189', 'secondDiagnosis': 'J440', 'thirdDiagnosis': 'J441', 'fourthDiagnosis': 'J210', 'fifthDiagnosis': 'G9341', 'sixthDiagnosis': 'E871'}]
[15:32:26] ✅    ✅ Patient identified: Rosa Fidalgo
[15:32:26] ✅    ✅ Patient name validation passed
[15:32:26] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:26] [DOC: 9225800] ℹ️  DOB normalized: 06/14/1940
[15:32:26] [DOC: 9225800] ℹ️  Episode startOfCare normalized: 10/29/2024
[15:32:26] [DOC: 9225800] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[15:32:26] [DOC: 9225800] ℹ️  Episode endOfEpisode normalized: 03/28/2025
[15:32:26] [DOC: 9225800] ✅ Patient date processing completed successfully
[15:32:26] ✅    ✅ Date processing completed
[15:32:26] 📊 Processed Patient Data
     └─ patientFName: Rosa
     └─ patientLName: Fidalgo
     └─ dob: 06/14/1940
     └─ patientSex: 
     └─ medicalRecordNo: 100992997
     └─ billingProvider: MIESNER, JUDITH
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/28/2025', 'firstDiagnosis': 'J189', 'secondDiagnosis': 'J440', 'thirdDiagnosis': 'J441', 'fourthDiagnosis': 'J210', 'fifthDiagnosis': 'G9341', 'sixthDiagnosis': 'E871'}]
[15:32:26] 🔄 
🔄 Step 4: Extracting order data...
[15:32:29] ℹ️  Order extraction - MRN: '100992997'
[15:32:29] ℹ️  Order extraction - Sex: ''
[15:32:29] ℹ️  Order extraction - Service Line: 'PT'
[15:32:29] ℹ️  Order extraction - Payer Source: ''
[15:32:29] ✅ Order data extraction completed successfully
[15:32:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:29] ℹ️  Using MRN from patient data: '100992997' over '100992997'
[15:32:29] ⚠️  Could not determine sex using any available method
[15:32:29] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='PT' = 'PT, Skilled Nursing'
[15:32:29] ✅ Patient name cross-validation successful
[15:32:29] ✅    ✅ Data merged successfully
[15:32:31] ✅    ✅ Order data extracted and validated
[15:32:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:49] [DOC: 9225800] ℹ️  Patient not found in cache or API: Rosa Fidalgo
[15:32:49] [DOC: 9225800] ℹ️  Patient not found, creating new patient via API...
[15:32:49] [DOC: 9225800] ℹ️  Creating patient via API: Rosa Fidalgo
[15:32:50] [DOC: 9225800] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:32:50] ❌    ❌ Failed to create patient
[15:32:50] [DOC: 9225800] ℹ️  API push details saved for document 9225800
================================================================================
║                        Processing Document ID: 9227124                         ║
================================================================================
[15:32:50] ℹ️  Agency: Bayada Home Health Care Inc-Plymouth
[15:32:50] ℹ️  Date: 04/07/2025
[15:32:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:57] [DOC: 9227124] ✅ Text extracted using pdfplumber (19342 chars)
[15:32:57] ✅    ✅ Text extracted using pdfplumber (19342 chars)
[15:32:57] 🔄 
🔄 Step 2: Extracting patient data...
[15:33:00] ℹ️  AI extracted raw sex value: 'M'
[15:33:00] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[15:33:00] ℹ️  AI extracted payer source: 'Medicare'
[15:33:00] ℹ️  AI extracted diagnoses:
[15:33:00] ℹ️    - Diagnosis 1: 'I26.09'
[15:33:00] ℹ️    - Diagnosis 2: 'J44.9'
[15:33:00] ℹ️    - Diagnosis 3: 'J96.11'
[15:33:00] ℹ️    - Diagnosis 4: 'I21.4'
[15:33:00] ℹ️    - Diagnosis 5: 'I25.10'
[15:33:00] ℹ️    - Diagnosis 6: 'I77.819'
[15:33:00] ℹ️  Final extracted MRN: '13900210495401'
[15:33:00] ℹ️  Final extracted Sex: 'MALE'
[15:33:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[15:33:00] ℹ️  Final extracted Payer Source: 'Medicare'
[15:33:00] ✅ Patient data extraction completed successfully
[15:33:00] ✅    ✅ Patient data extracted successfully
[15:33:00] 📊 Patient Response
     └─ patientFName: JOSEPH
     └─ patientLName: SULLIVAN
     └─ dob: 10/08/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 13900210495401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227537
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 128 COURT ST APT C20
     └─ city: PLYMOUTH
     └─ state: MA
     └─ zip: 02360
     └─ email: 
     └─ phoneNumber: (508) 830-0999
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'I26.09', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'J96.11', 'fourthDiagnosis': 'I21.4', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I77.819'}]
[15:33:00] ✅    ✅ Patient identified: JOSEPH SULLIVAN
[15:33:00] ✅    ✅ Patient name validation passed
[15:33:00] 🔄 
🔄 Step 3: Processing patient dates...
[15:33:00] [DOC: 9227124] ℹ️  DOB normalized: 10/08/1955
[15:33:00] [DOC: 9227124] ℹ️  Episode startOfCare normalized: 03/27/2025
[15:33:00] [DOC: 9227124] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[15:33:00] [DOC: 9227124] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[15:33:00] [DOC: 9227124] ✅ Patient date processing completed successfully
[15:33:00] ✅    ✅ Date processing completed
[15:33:00] 📊 Processed Patient Data
     └─ patientFName: JOSEPH
     └─ patientLName: SULLIVAN
     └─ dob: 10/08/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 13900210495401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227537
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 128 COURT ST APT C20
     └─ city: PLYMOUTH
     └─ state: MA
     └─ zip: 02360
     └─ email: 
     └─ phoneNumber: (508) 830-0999
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'I26.09', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'J96.11', 'fourthDiagnosis': 'I21.4', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I77.819'}]
[15:33:00] 🔄 
🔄 Step 4: Extracting order data...
[15:33:03] ℹ️  Order extraction - MRN: '13900210495401'
[15:33:03] ℹ️  Order extraction - Sex: 'MALE'
[15:33:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[15:33:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:33:03] ✅ Order data extraction completed successfully
[15:33:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:33:03] ℹ️  Using MRN from patient data: '13900210495401' over '13900210495401'
[15:33:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[15:33:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:33:03] ✅ Patient name cross-validation successful
[15:33:03] ✅    ✅ Data merged successfully
[15:33:05] ✅    ✅ Order data extracted and validated
[15:33:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:33:10] [DOC: 9227124] ℹ️  Patient not found in cache or API: JOSEPH SULLIVAN
[15:33:10] [DOC: 9227124] ℹ️  Patient not found, creating new patient via API...
[15:33:10] [DOC: 9227124] ℹ️  Creating patient via API: JOSEPH SULLIVAN
[15:33:11] [DOC: 9227124] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:33:11] ❌    ❌ Failed to create patient
[15:33:11] [DOC: 9227124] ℹ️  API push details saved for document 9227124
================================================================================
║                        Processing Document ID: 9226752                         ║
================================================================================
[15:33:11] ℹ️  Agency: AccentCare Fall River
[15:33:11] ℹ️  Date: 04/07/2025
[15:33:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:33:24] [DOC: 9226752] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[15:33:35] [DOC: 9226752] ✅ Text extracted using tesseract_ocr (22029 chars)
[15:33:35] ✅    ✅ Text extracted using tesseract_ocr (22009 chars)
[15:33:35] 🔄 
🔄 Step 2: Extracting patient data...
[15:33:39] ℹ️  AI extracted raw sex value: 'F'
[15:33:39] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[15:33:39] ℹ️  AI extracted payer source: 'Medicare'
[15:33:39] ℹ️  AI extracted diagnoses:
[15:33:39] ℹ️    - Diagnosis 1: '2471'
[15:33:39] ℹ️    - Diagnosis 2: 'I10'
[15:33:39] ℹ️    - Diagnosis 3: 'E785'
[15:33:39] ℹ️    - Diagnosis 4: 'G47.33'
[15:33:39] ℹ️    - Diagnosis 5: '779.82'
[15:33:39] ℹ️    - Diagnosis 6: '296.651'
[15:33:39] ℹ️  Final extracted MRN: '0200235550301'
[15:33:39] ℹ️  Final extracted Sex: 'FEMALE'
[15:33:39] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[15:33:39] ℹ️  Final extracted Payer Source: 'Medicare'
[15:33:39] ✅ Patient data extraction completed successfully
[15:33:39] ✅    ✅ Patient data extracted successfully
[15:33:39] 📊 Patient Response
     └─ patientFName: DENISE
     └─ patientLName: PLASKON
     └─ dob: 07/20/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200235550301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 37 PINE GROVE ST
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '2471', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E785', 'fourthDiagnosis': 'G47.33', 'fifthDiagnosis': '779.82', 'sixthDiagnosis': '296.651'}]
[15:33:39] ✅    ✅ Patient identified: DENISE PLASKON
[15:33:39] ✅    ✅ Patient name validation passed
[15:33:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:33:39] [DOC: 9226752] ℹ️  DOB normalized: 07/20/1956
[15:33:39] [DOC: 9226752] ℹ️  Episode startOfCare normalized: 03/27/2025
[15:33:39] [DOC: 9226752] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[15:33:39] [DOC: 9226752] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[15:33:39] [DOC: 9226752] ✅ Patient date processing completed successfully
[15:33:39] ✅    ✅ Date processing completed
[15:33:39] 📊 Processed Patient Data
     └─ patientFName: DENISE
     └─ patientLName: PLASKON
     └─ dob: 07/20/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200235550301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 37 PINE GROVE ST
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '2471', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E785', 'fourthDiagnosis': 'G47.33', 'fifthDiagnosis': '779.82', 'sixthDiagnosis': '296.651'}]
[15:33:39] 🔄 
🔄 Step 4: Extracting order data...
[15:33:42] ℹ️  Order extraction - MRN: '312712025'
[15:33:42] ℹ️  Order extraction - Sex: 'FEMALE'
[15:33:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[15:33:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:33:42] ✅ Order data extraction completed successfully
[15:33:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:33:42] ℹ️  Using MRN from patient data: '0200235550301' over '312712025'
[15:33:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[15:33:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:33:42] ✅ Patient name cross-validation successful
[15:33:42] ✅    ✅ Data merged successfully
[15:33:43] ✅    ✅ Order data extracted and validated
[15:33:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:33:59] [DOC: 9226752] ℹ️  Patient not found in cache or API: DENISE PLASKON
[15:33:59] [DOC: 9226752] ℹ️  Patient not found, creating new patient via API...
[15:33:59] [DOC: 9226752] ℹ️  Creating patient via API: DENISE PLASKON
[15:34:00] [DOC: 9226752] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:34:00] ❌    ❌ Failed to create patient
[15:34:00] [DOC: 9226752] ℹ️  API push details saved for document 9226752
================================================================================
║                        Processing Document ID: 9226366                         ║
================================================================================
[15:34:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:34:00] ℹ️  Date: 04/07/2025
[15:34:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:03] [DOC: 9226366] ✅ Text extracted using pdfplumber (2461 chars)
[15:34:03] ✅    ✅ Text extracted using pdfplumber (2461 chars)
[15:34:03] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:05] ℹ️  AI extracted raw sex value: 'M'
[15:34:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:34:05] ℹ️  AI extracted payer source: ''
[15:34:05] ℹ️  AI extracted diagnoses:
[15:34:05] ℹ️    - Diagnosis 1: 'None'
[15:34:05] ℹ️    - Diagnosis 2: 'None'
[15:34:05] ℹ️    - Diagnosis 3: 'None'
[15:34:05] ℹ️    - Diagnosis 4: 'None'
[15:34:05] ℹ️    - Diagnosis 5: 'None'
[15:34:05] ℹ️    - Diagnosis 6: 'None'
[15:34:05] ℹ️  Final extracted MRN: '2998670'
[15:34:05] ℹ️  Final extracted Sex: 'MALE'
[15:34:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:34:05] ℹ️  Final extracted Payer Source: ''
[15:34:05] ✅ Patient data extraction completed successfully
[15:34:05] ✅    ✅ Patient data extracted successfully
[15:34:05] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:34:05] ✅    ✅ Patient identified: Raymond Souza
[15:34:05] ✅    ✅ Patient name validation passed
[15:34:05] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:05] [DOC: 9226366] ℹ️  DOB normalized: 06/18/1927
[15:34:05] [DOC: 9226366] ✅ Patient date processing completed successfully
[15:34:05] ✅    ✅ Date processing completed
[15:34:05] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:34:05] 🔄 
🔄 Step 4: Extracting order data...
[15:34:08] ℹ️  Order extraction - MRN: '2998670'
[15:34:08] ℹ️  Order extraction - Sex: 'MALE'
[15:34:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:34:08] ℹ️  Order extraction - Payer Source: ''
[15:34:08] ✅ Order data extraction completed successfully
[15:34:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:08] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[15:34:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:34:08] ✅ Patient name cross-validation successful
[15:34:08] ✅    ✅ Data merged successfully
[15:34:09] ✅    ✅ Order data extracted and validated
[15:34:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:34:09] [DOC: 9226366] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[15:34:09] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[15:34:09] 🔄 
🔄 Step 6: Pushing order to API...
[15:34:09] [DOC: 9226366] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[15:34:11] [DOC: 9226366] ❌ Order push failed with status 201: {"id":"a886080b-3898-488d-84c4-7a80369fc80d","orderWAVId":"ORD20053","orderNo":"1078961, 1078962, 1078963, 1078964","orderDate":"04/05/2025","startOfCare":"04/04/2025","episodeStartDate":"04/04/2025","episodeEndDate":"06/02/2025","documentID":"9226366","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/11/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:34:11] ❌    ❌ Failed to push order
[15:34:11] 🔄 
🔄 Step 7: Writing to CSV...
[15:34:11] [DOC: 9226366] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[15:34:11] [DOC: 9226366] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:34:11] [DOC: 9226366] ℹ️  Payer Source extracted: ''
[15:34:11] [DOC: 9226366] ℹ️  Diagnosis codes being written:
[15:34:11] [DOC: 9226366] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:34:11] [DOC: 9226366] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:34:11] [DOC: 9226366] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:34:11] [DOC: 9226366] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:34:11] [DOC: 9226366] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:34:11] [DOC: 9226366] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:34:11] [DOC: 9226366] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: Skilled Nursing | Payer:  | MRN: 2998670
[15:34:11] ✅    ✅ Document 9226366 processed and saved successfully
[15:34:11] 🔄 
🔄 Step 8: Saving API details...
[15:34:11] [DOC: 9226366] ℹ️  API push details saved for document 9226366
[15:34:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9226360                         ║
================================================================================
[15:34:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:34:11] ℹ️  Date: 04/07/2025
[15:34:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:12] [DOC: 9226360] ✅ Text extracted using pdfplumber (1006 chars)
[15:34:12] ✅    ✅ Text extracted using pdfplumber (1006 chars)
[15:34:12] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:15] ℹ️  AI extracted raw sex value: 'F'
[15:34:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:34:15] ℹ️  AI extracted payer source: ''
[15:34:15] ℹ️  AI extracted diagnoses:
[15:34:15] ℹ️    - Diagnosis 1: 'I50.33'
[15:34:15] ℹ️    - Diagnosis 2: ''
[15:34:15] ℹ️    - Diagnosis 3: ''
[15:34:15] ℹ️    - Diagnosis 4: ''
[15:34:15] ℹ️    - Diagnosis 5: ''
[15:34:15] ℹ️    - Diagnosis 6: ''
[15:34:15] ℹ️  Final extracted MRN: '2936720'
[15:34:15] ℹ️  Final extracted Sex: 'FEMALE'
[15:34:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:34:15] ℹ️  Final extracted Payer Source: ''
[15:34:15] ✅ Patient data extraction completed successfully
[15:34:15] ✅    ✅ Patient data extracted successfully
[15:34:15] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/05/2025', 'endOfEpisode': None, 'firstDiagnosis': 'I50.33', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:15] ✅    ✅ Patient identified: Stella Saint
[15:34:15] ✅    ✅ Patient name validation passed
[15:34:15] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:15] [DOC: 9226360] ℹ️  DOB normalized: 07/02/1928
[15:34:15] [DOC: 9226360] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[15:34:15] [DOC: 9226360] ✅ Patient date processing completed successfully
[15:34:15] ✅    ✅ Date processing completed
[15:34:15] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'firstDiagnosis': 'I50.33', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:15] 🔄 
🔄 Step 4: Extracting order data...
[15:34:17] ℹ️  Order extraction - MRN: '2936720'
[15:34:17] ℹ️  Order extraction - Sex: 'FEMALE'
[15:34:17] ℹ️  Order extraction - Service Line: 'SN'
[15:34:17] ℹ️  Order extraction - Payer Source: ''
[15:34:17] ✅ Order data extraction completed successfully
[15:34:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:17] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[15:34:17] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[15:34:17] ✅ Patient name cross-validation successful
[15:34:17] ✅    ✅ Data merged successfully
[15:34:19] ⚠️     ❌ Skipping - missing episode start date
[15:34:19] [DOC: 9226360] ℹ️  API push details saved for document 9226360
================================================================================
║                        Processing Document ID: 9226354                         ║
================================================================================
[15:34:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:34:19] ℹ️  Date: 04/07/2025
[15:34:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:20] [DOC: 9226354] ✅ Text extracted using pdfplumber (1179 chars)
[15:34:20] ✅    ✅ Text extracted using pdfplumber (1179 chars)
[15:34:20] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:23] ℹ️  AI extracted raw sex value: 'M'
[15:34:23] ℹ️  AI extracted service line: 'PT'
[15:34:23] ℹ️  AI extracted payer source: ''
[15:34:23] ℹ️  AI extracted diagnoses:
[15:34:23] ℹ️    - Diagnosis 1: ''
[15:34:23] ℹ️    - Diagnosis 2: ''
[15:34:23] ℹ️    - Diagnosis 3: ''
[15:34:23] ℹ️    - Diagnosis 4: ''
[15:34:23] ℹ️    - Diagnosis 5: ''
[15:34:23] ℹ️    - Diagnosis 6: ''
[15:34:23] ℹ️  Final extracted MRN: '2013354'
[15:34:23] ℹ️  Final extracted Sex: 'MALE'
[15:34:23] ℹ️  Final extracted Service Line: 'PT'
[15:34:23] ℹ️  Final extracted Payer Source: ''
[15:34:23] ✅ Patient data extraction completed successfully
[15:34:23] ✅    ✅ Patient data extracted successfully
[15:34:23] 📊 Patient Response
     └─ patientFName: Calvin
     └─ patientLName: Perkins
     └─ dob: 04/14/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2013354
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:23] ✅    ✅ Patient identified: Calvin Perkins
[15:34:23] ✅    ✅ Patient name validation passed
[15:34:23] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:23] [DOC: 9226354] ℹ️  DOB normalized: 04/14/1936
[15:34:23] [DOC: 9226354] ✅ Patient date processing completed successfully
[15:34:23] ✅    ✅ Date processing completed
[15:34:23] 📊 Processed Patient Data
     └─ patientFName: Calvin
     └─ patientLName: Perkins
     └─ dob: 04/14/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2013354
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:23] 🔄 
🔄 Step 4: Extracting order data...
[15:34:25] ℹ️  Order extraction - MRN: '2013354'
[15:34:25] ℹ️  Order extraction - Sex: 'MALE'
[15:34:25] ℹ️  Order extraction - Service Line: ''
[15:34:25] ℹ️  Order extraction - Payer Source: ''
[15:34:25] ✅ Order data extraction completed successfully
[15:34:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:25] ℹ️  Using MRN from patient data: '2013354' over '2013354'
[15:34:25] ℹ️  Using service line from patient data: 'PT'
[15:34:25] ✅ Patient name cross-validation successful
[15:34:25] ✅    ✅ Data merged successfully
[15:34:26] ✅    ✅ Order data extracted and validated
[15:34:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:34:36] [DOC: 9226354] ℹ️  Patient not found in cache or API: Calvin Perkins
[15:34:36] [DOC: 9226354] ℹ️  Patient not found, creating new patient via API...
[15:34:36] [DOC: 9226354] ℹ️  Creating patient via API: Calvin Perkins
[15:34:37] [DOC: 9226354] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:34:37] ❌    ❌ Failed to create patient
[15:34:37] [DOC: 9226354] ℹ️  API push details saved for document 9226354
================================================================================
║                        Processing Document ID: 9226352                         ║
================================================================================
[15:34:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:34:37] ℹ️  Date: 04/07/2025
[15:34:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:38] [DOC: 9226352] ✅ Text extracted using pdfplumber (1020 chars)
[15:34:38] ✅    ✅ Text extracted using pdfplumber (1020 chars)
[15:34:38] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:41] ℹ️  AI extracted raw sex value: 'F'
[15:34:41] ℹ️  AI extracted service line: 'Nursing'
[15:34:41] ℹ️  AI extracted payer source: ''
[15:34:41] ℹ️  AI extracted diagnoses:
[15:34:41] ℹ️    - Diagnosis 1: ''
[15:34:41] ℹ️    - Diagnosis 2: ''
[15:34:41] ℹ️    - Diagnosis 3: ''
[15:34:41] ℹ️    - Diagnosis 4: ''
[15:34:41] ℹ️    - Diagnosis 5: ''
[15:34:41] ℹ️    - Diagnosis 6: ''
[15:34:41] ℹ️  Final extracted MRN: '2794259'
[15:34:41] ℹ️  Final extracted Sex: 'FEMALE'
[15:34:41] ℹ️  Final extracted Service Line: 'Nursing'
[15:34:41] ℹ️  Final extracted Payer Source: ''
[15:34:41] ✅ Patient data extraction completed successfully
[15:34:41] ✅    ✅ Patient data extracted successfully
[15:34:41] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:41] ✅    ✅ Patient identified: Joyce Normandin
[15:34:41] ✅    ✅ Patient name validation passed
[15:34:41] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:41] [DOC: 9226352] ℹ️  DOB normalized: 09/26/1950
[15:34:41] [DOC: 9226352] ✅ Patient date processing completed successfully
[15:34:41] ✅    ✅ Date processing completed
[15:34:41] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:41] 🔄 
🔄 Step 4: Extracting order data...
[15:34:43] ℹ️  Order extraction - MRN: '2794259'
[15:34:43] ℹ️  Order extraction - Sex: 'FEMALE'
[15:34:43] ℹ️  Order extraction - Service Line: ''
[15:34:43] ℹ️  Order extraction - Payer Source: ''
[15:34:43] ✅ Order data extraction completed successfully
[15:34:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:43] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[15:34:43] ℹ️  Using service line from patient data: 'Nursing'
[15:34:43] ✅ Patient name cross-validation successful
[15:34:43] ✅    ✅ Data merged successfully
[15:34:44] ✅    ✅ Order data extracted and validated
[15:34:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:34:44] [DOC: 9226352] ✅ Patient found in local cache: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[15:34:44] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[15:34:44] 🔄 
🔄 Step 6: Pushing order to API...
[15:34:44] [DOC: 9226352] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[15:34:46] [DOC: 9226352] ❌ Order push failed with status 201: {"id":"7990447d-4a6b-4e5f-9cca-09bad88a1309","orderWAVId":"ORD20054","orderNo":"1079027","orderDate":"04/05/2025","startOfCare":"03/08/2025","episodeStartDate":"03/08/2025","episodeEndDate":"04/07/2025","documentID":"9226352","mrn":"2794259","patientName":"Normandin, Joyce M","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"9720bbd6-f59e-4773-80f0-6ac1827545d7","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:34:46] ❌    ❌ Failed to push order
[15:34:46] 🔄 
🔄 Step 7: Writing to CSV...
[15:34:46] [DOC: 9226352] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[15:34:46] [DOC: 9226352] ℹ️  Service Line extracted: 'Nursing'
[15:34:46] [DOC: 9226352] ℹ️  Payer Source extracted: ''
[15:34:46] [DOC: 9226352] ℹ️  Diagnosis codes being written:
[15:34:46] [DOC: 9226352] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:34:46] [DOC: 9226352] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:34:46] [DOC: 9226352] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:34:46] [DOC: 9226352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:34:46] [DOC: 9226352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:34:46] [DOC: 9226352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:34:46] [DOC: 9226352] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Nursing | Payer:  | MRN: 2794259
[15:34:46] ✅    ✅ Document 9226352 processed and saved successfully
[15:34:46] 🔄 
🔄 Step 8: Saving API details...
[15:34:46] [DOC: 9226352] ℹ️  API push details saved for document 9226352
[15:34:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9226350                         ║
================================================================================
[15:34:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:34:46] ℹ️  Date: 04/07/2025
[15:34:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:48] [DOC: 9226350] ✅ Text extracted using pdfplumber (1489 chars)
[15:34:48] ✅    ✅ Text extracted using pdfplumber (1489 chars)
[15:34:48] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:50] ℹ️  AI extracted raw sex value: 'M'
[15:34:50] ℹ️  AI extracted service line: ''
[15:34:50] ℹ️  AI extracted payer source: ''
[15:34:50] ℹ️  AI extracted diagnoses:
[15:34:50] ℹ️    - Diagnosis 1: ''
[15:34:50] ℹ️    - Diagnosis 2: ''
[15:34:50] ℹ️    - Diagnosis 3: ''
[15:34:50] ℹ️    - Diagnosis 4: ''
[15:34:50] ℹ️    - Diagnosis 5: ''
[15:34:50] ℹ️    - Diagnosis 6: ''
[15:34:50] ℹ️  Final extracted MRN: '2773750'
[15:34:50] ℹ️  Final extracted Sex: 'MALE'
[15:34:50] ℹ️  Final extracted Service Line: ''
[15:34:50] ℹ️  Final extracted Payer Source: ''
[15:34:50] ✅ Patient data extraction completed successfully
[15:34:50] ✅    ✅ Patient data extracted successfully
[15:34:50] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:50] ✅    ✅ Patient identified: Luis Mota
[15:34:50] ✅    ✅ Patient name validation passed
[15:34:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:50] [DOC: 9226350] ℹ️  DOB normalized: 12/02/1942
[15:34:50] [DOC: 9226350] ✅ Patient date processing completed successfully
[15:34:50] ✅    ✅ Date processing completed
[15:34:50] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:50] 🔄 
🔄 Step 4: Extracting order data...
[15:34:53] ℹ️  Order extraction - MRN: '2773750'
[15:34:53] ℹ️  Order extraction - Sex: 'MALE'
[15:34:53] ℹ️  Order extraction - Service Line: ''
[15:34:53] ℹ️  Order extraction - Payer Source: ''
[15:34:53] ✅ Order data extraction completed successfully
[15:34:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:53] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[15:34:53] ✅ Patient name cross-validation successful
[15:34:53] ✅    ✅ Data merged successfully
[15:34:54] ⚠️     ❌ Skipping - missing episode start date
[15:34:54] [DOC: 9226350] ℹ️  API push details saved for document 9226350
================================================================================
║                        Processing Document ID: 9226347                         ║
================================================================================
[15:34:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:34:54] ℹ️  Date: 04/07/2025
[15:34:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:55] [DOC: 9226347] ✅ Text extracted using pdfplumber (1045 chars)
[15:34:55] ✅    ✅ Text extracted using pdfplumber (1045 chars)
[15:34:55] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:58] ℹ️  AI extracted raw sex value: 'F'
[15:34:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:34:58] ℹ️  AI extracted payer source: ''
[15:34:58] ℹ️  AI extracted diagnoses:
[15:34:58] ℹ️    - Diagnosis 1: 'None'
[15:34:58] ℹ️    - Diagnosis 2: 'None'
[15:34:58] ℹ️    - Diagnosis 3: 'None'
[15:34:58] ℹ️    - Diagnosis 4: 'None'
[15:34:58] ℹ️    - Diagnosis 5: 'None'
[15:34:58] ℹ️    - Diagnosis 6: 'None'
[15:34:58] ℹ️  Final extracted MRN: '2750591'
[15:34:58] ℹ️  Final extracted Sex: 'FEMALE'
[15:34:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:34:58] ℹ️  Final extracted Payer Source: ''
[15:34:58] ✅ Patient data extraction completed successfully
[15:34:58] ✅    ✅ Patient data extracted successfully
[15:34:58] 📊 Patient Response
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:34:58] ✅    ✅ Patient identified: Valentina Miguel
[15:34:58] ✅    ✅ Patient name validation passed
[15:34:58] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:58] [DOC: 9226347] ℹ️  DOB normalized: 11/24/1951
[15:34:58] [DOC: 9226347] ✅ Patient date processing completed successfully
[15:34:58] ✅    ✅ Date processing completed
[15:34:58] 📊 Processed Patient Data
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:34:58] 🔄 
🔄 Step 4: Extracting order data...
[15:35:00] ℹ️  Order extraction - MRN: '2750591'
[15:35:00] ℹ️  Order extraction - Sex: 'FEMALE'
[15:35:00] ℹ️  Order extraction - Service Line: ''
[15:35:00] ℹ️  Order extraction - Payer Source: ''
[15:35:00] ✅ Order data extraction completed successfully
[15:35:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:00] ℹ️  Using MRN from patient data: '2750591' over '2750591'
[15:35:00] ℹ️  Using service line from patient data: 'Skilled Nursing'
[15:35:00] ✅ Patient name cross-validation successful
[15:35:00] ✅    ✅ Data merged successfully
[15:35:01] ✅    ✅ Order data extracted and validated
[15:35:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:01] [DOC: 9226347] ✅ Patient found in local cache: Valentina Miguel, ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[15:35:01] ✅    ✅ Existing patient found with ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[15:35:01] 🔄 
🔄 Step 6: Pushing order to API...
[15:35:01] [DOC: 9226347] ℹ️  Pushing order via API for patient ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[15:35:03] [DOC: 9226347] ❌ Order push failed with status 201: {"id":"43d83f68-1c16-4ba1-a4ee-12b4f83b554f","orderWAVId":"ORD20055","orderNo":"1079054","orderDate":"04/05/2025","startOfCare":"03/23/2022","episodeStartDate":"03/23/2022","episodeEndDate":"05/21/2022","documentID":"9226347","mrn":"2750591","patientName":"Miguel,Valentina B","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6ab7401d-5ff1-4b54-9813-ac77ababb99e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:35:03] ❌    ❌ Failed to push order
[15:35:03] 🔄 
🔄 Step 7: Writing to CSV...
[15:35:03] [DOC: 9226347] ℹ️  Calculated age: 73 from DOB: 11/24/1951
[15:35:03] [DOC: 9226347] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:35:03] [DOC: 9226347] ℹ️  Payer Source extracted: ''
[15:35:03] [DOC: 9226347] ℹ️  Diagnosis codes being written:
[15:35:03] [DOC: 9226347] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:35:03] [DOC: 9226347] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:35:03] [DOC: 9226347] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:35:03] [DOC: 9226347] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:35:03] [DOC: 9226347] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:35:03] [DOC: 9226347] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:35:03] [DOC: 9226347] ✅ Patient data written to CSV: Valentina Miguel | Sex: FEMALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2750591
[15:35:03] ✅    ✅ Document 9226347 processed and saved successfully
[15:35:03] 🔄 
🔄 Step 8: Saving API details...
[15:35:03] [DOC: 9226347] ℹ️  API push details saved for document 9226347
[15:35:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9226330                         ║
================================================================================
[15:35:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:03] ℹ️  Date: 04/07/2025
[15:35:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:05] [DOC: 9226330] ✅ Text extracted using pdfplumber (962 chars)
[15:35:05] ✅    ✅ Text extracted using pdfplumber (962 chars)
[15:35:05] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:08] ℹ️  AI extracted raw sex value: 'F'
[15:35:08] ℹ️  AI extracted service line: 'Physical Therapy'
[15:35:08] ℹ️  AI extracted payer source: ''
[15:35:08] ℹ️  AI extracted diagnoses:
[15:35:08] ℹ️    - Diagnosis 1: ''
[15:35:08] ℹ️    - Diagnosis 2: ''
[15:35:08] ℹ️    - Diagnosis 3: ''
[15:35:08] ℹ️    - Diagnosis 4: ''
[15:35:08] ℹ️    - Diagnosis 5: ''
[15:35:08] ℹ️    - Diagnosis 6: ''
[15:35:08] ℹ️  Final extracted MRN: '2689758'
[15:35:08] ℹ️  Final extracted Sex: 'FEMALE'
[15:35:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:35:08] ℹ️  Final extracted Payer Source: ''
[15:35:08] ✅ Patient data extraction completed successfully
[15:35:08] ✅    ✅ Patient data extracted successfully
[15:35:08] 📊 Patient Response
     └─ patientFName: Darlene
     └─ patientLName: Mallen
     └─ dob: 07/06/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2689758
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:08] ✅    ✅ Patient identified: Darlene Mallen
[15:35:08] ✅    ✅ Patient name validation passed
[15:35:08] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:08] [DOC: 9226330] ℹ️  DOB normalized: 07/06/1967
[15:35:08] [DOC: 9226330] ✅ Patient date processing completed successfully
[15:35:08] ✅    ✅ Date processing completed
[15:35:08] 📊 Processed Patient Data
     └─ patientFName: Darlene
     └─ patientLName: Mallen
     └─ dob: 07/06/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2689758
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:08] 🔄 
🔄 Step 4: Extracting order data...
[15:35:10] ℹ️  Order extraction - MRN: '2689758'
[15:35:10] ℹ️  Order extraction - Sex: 'FEMALE'
[15:35:10] ℹ️  Order extraction - Service Line: ''
[15:35:10] ℹ️  Order extraction - Payer Source: ''
[15:35:10] ✅ Order data extraction completed successfully
[15:35:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:10] ℹ️  Using MRN from patient data: '2689758' over '2689758'
[15:35:10] ℹ️  Using service line from patient data: 'Physical Therapy'
[15:35:10] ✅ Patient name cross-validation successful
[15:35:10] ✅    ✅ Data merged successfully
[15:35:11] ⚠️     ❌ Skipping - missing episode start date
[15:35:11] [DOC: 9226330] ℹ️  API push details saved for document 9226330
================================================================================
║                        Processing Document ID: 9226327                         ║
================================================================================
[15:35:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:11] ℹ️  Date: 04/07/2025
[15:35:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:13] [DOC: 9226327] ✅ Text extracted using pdfplumber (3997 chars)
[15:35:13] ✅    ✅ Text extracted using pdfplumber (3997 chars)
[15:35:13] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:16] ℹ️  AI extracted raw sex value: 'F'
[15:35:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:35:16] ℹ️  AI extracted payer source: ''
[15:35:16] ℹ️  AI extracted diagnoses:
[15:35:16] ℹ️    - Diagnosis 1: 'None'
[15:35:16] ℹ️    - Diagnosis 2: 'None'
[15:35:16] ℹ️    - Diagnosis 3: 'None'
[15:35:16] ℹ️    - Diagnosis 4: 'None'
[15:35:16] ℹ️    - Diagnosis 5: 'None'
[15:35:16] ℹ️    - Diagnosis 6: 'None'
[15:35:16] ℹ️  Final extracted MRN: '2687695'
[15:35:16] ℹ️  Final extracted Sex: 'FEMALE'
[15:35:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:35:16] ℹ️  Final extracted Payer Source: ''
[15:35:16] ✅ Patient data extraction completed successfully
[15:35:16] ✅    ✅ Patient data extracted successfully
[15:35:16] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:35:16] ✅    ✅ Patient identified: Maria Maiato
[15:35:16] ✅    ✅ Patient name validation passed
[15:35:16] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:16] [DOC: 9226327] ℹ️  DOB normalized: 03/29/1952
[15:35:16] [DOC: 9226327] ✅ Patient date processing completed successfully
[15:35:16] ✅    ✅ Date processing completed
[15:35:16] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:35:16] 🔄 
🔄 Step 4: Extracting order data...
[15:35:19] ℹ️  Order extraction - MRN: '2687695'
[15:35:19] ℹ️  Order extraction - Sex: 'FEMALE'
[15:35:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:35:19] ℹ️  Order extraction - Payer Source: ''
[15:35:19] ✅ Order data extraction completed successfully
[15:35:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:19] ℹ️  Using MRN from patient data: '2687695' over '2687695'
[15:35:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:35:19] ✅ Patient name cross-validation successful
[15:35:19] ✅    ✅ Data merged successfully
[15:35:20] ✅    ✅ Order data extracted and validated
[15:35:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:20] [DOC: 9226327] ✅ Patient found in local cache: Maria Maiato, ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[15:35:20] ✅    ✅ Existing patient found with ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[15:35:20] 🔄 
🔄 Step 6: Pushing order to API...
[15:35:20] [DOC: 9226327] ℹ️  Pushing order via API for patient ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[15:35:22] [DOC: 9226327] ❌ Order push failed with status 201: {"id":"32f8c64c-fdc2-4905-ac71-fd68fa0e2455","orderWAVId":"ORD20056","orderNo":"1079174, 1079175, 1079176, 1079177, 1079178, 1079179, 1079180, 1079181, 1079204, 1079205, 1079206, 1079207","orderDate":"04/06/2025","startOfCare":"04/04/2025","episodeStartDate":"04/04/2025","episodeEndDate":"04/06/2025","documentID":"9226327","mrn":"2687695","patientName":"Maiato,Maria A.","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/15/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"a92d350b-6287-4f07-a2c9-09b4c329691a","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:35:22] ❌    ❌ Failed to push order
[15:35:22] 🔄 
🔄 Step 7: Writing to CSV...
[15:35:22] [DOC: 9226327] ℹ️  Calculated age: 73 from DOB: 03/29/1952
[15:35:22] [DOC: 9226327] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:35:22] [DOC: 9226327] ℹ️  Payer Source extracted: ''
[15:35:22] [DOC: 9226327] ℹ️  Diagnosis codes being written:
[15:35:22] [DOC: 9226327] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:35:22] [DOC: 9226327] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:35:22] [DOC: 9226327] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:35:22] [DOC: 9226327] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:35:22] [DOC: 9226327] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:35:22] [DOC: 9226327] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:35:22] [DOC: 9226327] ✅ Patient data written to CSV: Maria Maiato | Sex: FEMALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2687695
[15:35:22] ✅    ✅ Document 9226327 processed and saved successfully
[15:35:22] 🔄 
🔄 Step 8: Saving API details...
[15:35:22] [DOC: 9226327] ℹ️  API push details saved for document 9226327
[15:35:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9226325                         ║
================================================================================
[15:35:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:22] ℹ️  Date: 04/07/2025
[15:35:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:23] [DOC: 9226325] ✅ Text extracted using pdfplumber (1284 chars)
[15:35:23] ✅    ✅ Text extracted using pdfplumber (1284 chars)
[15:35:23] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:26] ℹ️  AI extracted raw sex value: 'M'
[15:35:26] ℹ️  AI extracted service line: ''
[15:35:26] ℹ️  AI extracted payer source: ''
[15:35:26] ℹ️  AI extracted diagnoses:
[15:35:26] ℹ️    - Diagnosis 1: ''
[15:35:26] ℹ️    - Diagnosis 2: ''
[15:35:26] ℹ️    - Diagnosis 3: ''
[15:35:26] ℹ️    - Diagnosis 4: ''
[15:35:26] ℹ️    - Diagnosis 5: ''
[15:35:26] ℹ️    - Diagnosis 6: ''
[15:35:26] ℹ️  Final extracted MRN: '3170225'
[15:35:26] ℹ️  Final extracted Sex: 'MALE'
[15:35:26] ℹ️  Final extracted Service Line: ''
[15:35:26] ℹ️  Final extracted Payer Source: ''
[15:35:26] ✅ Patient data extraction completed successfully
[15:35:26] ✅    ✅ Patient data extracted successfully
[15:35:26] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:26] ✅    ✅ Patient identified: Donald Maceachern
[15:35:26] ✅    ✅ Patient name validation passed
[15:35:26] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:26] [DOC: 9226325] ℹ️  DOB normalized: 11/18/1939
[15:35:26] [DOC: 9226325] ✅ Patient date processing completed successfully
[15:35:26] ✅    ✅ Date processing completed
[15:35:26] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:26] 🔄 
🔄 Step 4: Extracting order data...
[15:35:28] ℹ️  Order extraction - MRN: '3170225'
[15:35:28] ℹ️  Order extraction - Sex: 'MALE'
[15:35:28] ℹ️  Order extraction - Service Line: ''
[15:35:28] ℹ️  Order extraction - Payer Source: ''
[15:35:28] ✅ Order data extraction completed successfully
[15:35:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:28] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[15:35:28] ✅ Patient name cross-validation successful
[15:35:28] ✅    ✅ Data merged successfully
[15:35:29] ✅    ✅ Order data extracted and validated
[15:35:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:29] [DOC: 9226325] ✅ Patient found in local cache: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[15:35:29] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[15:35:29] 🔄 
🔄 Step 6: Pushing order to API...
[15:35:29] [DOC: 9226325] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[15:35:31] [DOC: 9226325] ❌ Order push failed with status 201: {"id":"407c1d83-acc6-419e-bc1e-52cf69917a43","orderWAVId":"ORD20057","orderNo":"1079229, 1079230","orderDate":"04/06/2025","startOfCare":"02/24/2025","episodeStartDate":"02/24/2025","episodeEndDate":"04/25/2025","documentID":"9226325","mrn":"3170225","patientName":"Maceachern,Donald L","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"7af7c208-09d9-45bc-a97b-f457df90d626","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:35:31] ❌    ❌ Failed to push order
[15:35:31] 🔄 
🔄 Step 7: Writing to CSV...
[15:35:31] [DOC: 9226325] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[15:35:31] [DOC: 9226325] ℹ️  Service Line extracted: ''
[15:35:31] [DOC: 9226325] ℹ️  Payer Source extracted: ''
[15:35:31] [DOC: 9226325] ℹ️  Diagnosis codes being written:
[15:35:31] [DOC: 9226325] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:35:31] [DOC: 9226325] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:35:31] [DOC: 9226325] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:35:31] [DOC: 9226325] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:35:31] [DOC: 9226325] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:35:31] [DOC: 9226325] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:35:31] [DOC: 9226325] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service:  | Payer:  | MRN: 3170225
[15:35:31] ✅    ✅ Document 9226325 processed and saved successfully
[15:35:31] 🔄 
🔄 Step 8: Saving API details...
[15:35:31] [DOC: 9226325] ℹ️  API push details saved for document 9226325
[15:35:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9226323                         ║
================================================================================
[15:35:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:31] ℹ️  Date: 04/07/2025
[15:35:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:34] [DOC: 9226323] ✅ Text extracted using pdfplumber (25858 chars)
[15:35:34] ✅    ✅ Text extracted using pdfplumber (25858 chars)
[15:35:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:37] ℹ️  AI extracted raw sex value: 'M'
[15:35:37] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA, Volunteer'
[15:35:37] ℹ️  AI extracted payer source: ''
[15:35:37] ℹ️  AI extracted diagnoses:
[15:35:37] ℹ️    - Diagnosis 1: 'C92.10'
[15:35:37] ℹ️    - Diagnosis 2: 'A41.9'
[15:35:37] ℹ️    - Diagnosis 3: 'D75.839'
[15:35:37] ℹ️    - Diagnosis 4: 'I50.9'
[15:35:37] ℹ️    - Diagnosis 5: 'E11.9'
[15:35:37] ℹ️    - Diagnosis 6: 'I48.92'
[15:35:37] ℹ️  Final extracted MRN: '3170225'
[15:35:37] ℹ️  Final extracted Sex: 'MALE'
[15:35:37] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA, Volunteer'
[15:35:37] ℹ️  Final extracted Payer Source: ''
[15:35:37] ✅ Patient data extraction completed successfully
[15:35:37] ✅    ✅ Patient data extracted successfully
[15:35:37] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'C92.10', 'secondDiagnosis': 'A41.9', 'thirdDiagnosis': 'D75.839', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'I48.92'}]
[15:35:37] ✅    ✅ Patient identified: Donald Maceachern
[15:35:37] ✅    ✅ Patient name validation passed
[15:35:37] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:37] [DOC: 9226323] ℹ️  DOB normalized: 11/18/1939
[15:35:37] [DOC: 9226323] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[15:35:37] [DOC: 9226323] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[15:35:37] [DOC: 9226323] ✅ Patient date processing completed successfully
[15:35:37] ✅    ✅ Date processing completed
[15:35:37] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'C92.10', 'secondDiagnosis': 'A41.9', 'thirdDiagnosis': 'D75.839', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'I48.92'}]
[15:35:37] 🔄 
🔄 Step 4: Extracting order data...
[15:35:40] ℹ️  Order extraction - MRN: '3170225'
[15:35:40] ℹ️  Order extraction - Sex: 'MALE'
[15:35:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[15:35:40] ℹ️  Order extraction - Payer Source: ''
[15:35:40] ✅ Order data extraction completed successfully
[15:35:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:40] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[15:35:40] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, HHA, Volunteer' + Order='Skilled Nursing, MSW, Clergy, HHA' = 'Clergy, HHA, MSW, Skilled Nursing, Volunteer'
[15:35:40] ✅ Patient name cross-validation successful
[15:35:40] ✅    ✅ Data merged successfully
[15:35:45] ✅    ✅ Order data extracted and validated
[15:35:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:45] [DOC: 9226323] ✅ Patient found in local cache: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[15:35:45] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[15:35:45] 🔄 
🔄 Step 6: Pushing order to API...
[15:35:45] [DOC: 9226323] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[15:35:46] [DOC: 9226323] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13302"}
[15:35:46] ❌    ❌ Failed to push order
[15:35:46] 🔄 
🔄 Step 7: Writing to CSV...
[15:35:46] [DOC: 9226323] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[15:35:46] [DOC: 9226323] ℹ️  Service Line extracted: 'Clergy, HHA, MSW, Skilled Nursing, Volunteer'
[15:35:46] [DOC: 9226323] ℹ️  Payer Source extracted: ''
[15:35:46] [DOC: 9226323] ℹ️  Diagnosis codes being written:
[15:35:46] [DOC: 9226323] ℹ️    - Latest_Episode_Firstdiagnosis: 'C92.10'
[15:35:46] [DOC: 9226323] ℹ️    - Latest_Episode_Seconddiagnosis: 'A41.9'
[15:35:46] [DOC: 9226323] ℹ️    - Latest_Episode_Thirddiagnosis: 'D75.839'
[15:35:46] [DOC: 9226323] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.9'
[15:35:46] [DOC: 9226323] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.9'
[15:35:46] [DOC: 9226323] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.92'
[15:35:46] [DOC: 9226323] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service: Clergy, HHA, MSW, Skilled Nursing, Volunteer | Payer:  | MRN: 3170225
[15:35:46] ✅    ✅ Document 9226323 processed and saved successfully
[15:35:46] 🔄 
🔄 Step 8: Saving API details...
[15:35:46] [DOC: 9226323] ℹ️  API push details saved for document 9226323
[15:35:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9226320                         ║
================================================================================
[15:35:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:46] ℹ️  Date: 04/07/2025
[15:35:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:47] [DOC: 9226320] ✅ Text extracted using pdfplumber (1177 chars)
[15:35:47] ✅    ✅ Text extracted using pdfplumber (1177 chars)
[15:35:47] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:50] ℹ️  AI extracted raw sex value: 'M'
[15:35:50] ℹ️  AI extracted service line: ''
[15:35:50] ℹ️  AI extracted payer source: ''
[15:35:50] ℹ️  AI extracted diagnoses:
[15:35:50] ℹ️    - Diagnosis 1: ''
[15:35:50] ℹ️    - Diagnosis 2: ''
[15:35:50] ℹ️    - Diagnosis 3: ''
[15:35:50] ℹ️    - Diagnosis 4: ''
[15:35:50] ℹ️    - Diagnosis 5: ''
[15:35:50] ℹ️    - Diagnosis 6: ''
[15:35:50] ℹ️  Final extracted MRN: '2611249'
[15:35:50] ℹ️  Final extracted Sex: 'MALE'
[15:35:50] ℹ️  Final extracted Service Line: ''
[15:35:50] ℹ️  Final extracted Payer Source: ''
[15:35:50] ✅ Patient data extraction completed successfully
[15:35:50] ✅    ✅ Patient data extracted successfully
[15:35:50] 📊 Patient Response
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:50] ✅    ✅ Patient identified: Kelada Sobhy
[15:35:50] ✅    ✅ Patient name validation passed
[15:35:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:50] [DOC: 9226320] ℹ️  DOB normalized: 10/02/1947
[15:35:50] [DOC: 9226320] ✅ Patient date processing completed successfully
[15:35:50] ✅    ✅ Date processing completed
[15:35:50] 📊 Processed Patient Data
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:50] 🔄 
🔄 Step 4: Extracting order data...
[15:35:52] ℹ️  Order extraction - MRN: '2611249'
[15:35:52] ℹ️  Order extraction - Sex: 'MALE'
[15:35:52] ℹ️  Order extraction - Service Line: ''
[15:35:52] ℹ️  Order extraction - Payer Source: ''
[15:35:52] ✅ Order data extraction completed successfully
[15:35:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:52] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[15:35:52] ✅ Patient name cross-validation successful
[15:35:52] ✅    ✅ Data merged successfully
[15:35:53] ⚠️     ❌ Skipping - missing episode start date
[15:35:53] [DOC: 9226320] ℹ️  API push details saved for document 9226320
================================================================================
║                        Processing Document ID: 9226309                         ║
================================================================================
[15:35:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:53] ℹ️  Date: 04/07/2025
[15:35:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:55] [DOC: 9226309] ✅ Text extracted using pdfplumber (789 chars)
[15:35:55] ✅    ✅ Text extracted using pdfplumber (789 chars)
[15:35:55] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:57] ℹ️  AI extracted raw sex value: 'F'
[15:35:57] ℹ️  AI extracted service line: ''
[15:35:57] ℹ️  AI extracted payer source: ''
[15:35:57] ℹ️  AI extracted diagnoses:
[15:35:57] ℹ️    - Diagnosis 1: ''
[15:35:57] ℹ️    - Diagnosis 2: ''
[15:35:57] ℹ️    - Diagnosis 3: ''
[15:35:57] ℹ️    - Diagnosis 4: ''
[15:35:57] ℹ️    - Diagnosis 5: ''
[15:35:57] ℹ️    - Diagnosis 6: ''
[15:35:57] ℹ️  Final extracted MRN: '2234420'
[15:35:57] ℹ️  Final extracted Sex: 'FEMALE'
[15:35:57] ℹ️  Final extracted Service Line: ''
[15:35:57] ℹ️  Final extracted Payer Source: ''
[15:35:57] ✅ Patient data extraction completed successfully
[15:35:57] ✅    ✅ Patient data extracted successfully
[15:35:57] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Bento
     └─ dob: 12/20/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2234420
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:57] ✅    ✅ Patient identified: Maria Bento
[15:35:57] ✅    ✅ Patient name validation passed
[15:35:57] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:57] [DOC: 9226309] ℹ️  DOB normalized: 12/20/1941
[15:35:57] [DOC: 9226309] ✅ Patient date processing completed successfully
[15:35:57] ✅    ✅ Date processing completed
[15:35:57] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Bento
     └─ dob: 12/20/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2234420
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:57] 🔄 
🔄 Step 4: Extracting order data...
[15:35:59] ℹ️  Order extraction - MRN: '2234420'
[15:35:59] ℹ️  Order extraction - Sex: 'FEMALE'
[15:35:59] ℹ️  Order extraction - Service Line: ''
[15:35:59] ℹ️  Order extraction - Payer Source: ''
[15:35:59] ✅ Order data extraction completed successfully
[15:35:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:59] ℹ️  Using MRN from patient data: '2234420' over '2234420'
[15:35:59] ✅ Patient name cross-validation successful
[15:35:59] ✅    ✅ Data merged successfully
[15:36:00] ⚠️     ❌ Skipping - missing episode start date
[15:36:00] [DOC: 9226309] ℹ️  API push details saved for document 9226309
================================================================================
║                        Processing Document ID: 9226307                         ║
================================================================================
[15:36:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:36:00] ℹ️  Date: 04/07/2025
[15:36:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:36:07] [DOC: 9226307] ✅ Text extracted using pdfplumber (8000 chars)
[15:36:07] ✅    ✅ Text extracted using pdfplumber (8000 chars)
[15:36:07] 🔄 
🔄 Step 2: Extracting patient data...
[15:36:10] ℹ️  AI extracted raw sex value: 'F'
[15:36:10] ℹ️  AI extracted service line: 'Nursing'
[15:36:10] ℹ️  AI extracted payer source: 'Medicaid'
[15:36:10] ℹ️  AI extracted diagnoses:
[15:36:10] ℹ️    - Diagnosis 1: 'N32.89'
[15:36:10] ℹ️    - Diagnosis 2: 'N30.01'
[15:36:10] ℹ️    - Diagnosis 3: 'F03.90'
[15:36:10] ℹ️    - Diagnosis 4: 'G91.2'
[15:36:10] ℹ️    - Diagnosis 5: 'R29.6'
[15:36:10] ℹ️    - Diagnosis 6: 'I48.20'
[15:36:10] ℹ️  Final extracted MRN: '2234420'
[15:36:10] ℹ️  Final extracted Sex: 'FEMALE'
[15:36:10] ℹ️  Final extracted Service Line: 'Nursing'
[15:36:10] ℹ️  Final extracted Payer Source: 'Medicaid'
[15:36:10] ✅ Patient data extraction completed successfully
[15:36:10] ✅    ✅ Patient data extracted successfully
[15:36:10] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Bento
     └─ dob: 12/20/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2234420
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: Medicaid
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'N32.89', 'secondDiagnosis': 'N30.01', 'thirdDiagnosis': 'F03.90', 'fourthDiagnosis': 'G91.2', 'fifthDiagnosis': 'R29.6', 'sixthDiagnosis': 'I48.20'}]
[15:36:10] ✅    ✅ Patient identified: Maria Bento
[15:36:10] ✅    ✅ Patient name validation passed
[15:36:10] 🔄 
🔄 Step 3: Processing patient dates...
[15:36:10] [DOC: 9226307] ℹ️  DOB normalized: 12/20/1941
[15:36:10] [DOC: 9226307] ℹ️  Episode startOfCare normalized: 04/04/2025
[15:36:10] [DOC: 9226307] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[15:36:10] [DOC: 9226307] ℹ️  Episode endOfEpisode normalized: 07/02/2025
[15:36:10] [DOC: 9226307] ✅ Patient date processing completed successfully
[15:36:10] ✅    ✅ Date processing completed
[15:36:10] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Bento
     └─ dob: 12/20/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2234420
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: Medicaid
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'N32.89', 'secondDiagnosis': 'N30.01', 'thirdDiagnosis': 'F03.90', 'fourthDiagnosis': 'G91.2', 'fifthDiagnosis': 'R29.6', 'sixthDiagnosis': 'I48.20'}]
[15:36:10] 🔄 
🔄 Step 4: Extracting order data...
[15:36:12] ℹ️  Order extraction - MRN: '2234420'
[15:36:12] ℹ️  Order extraction - Sex: 'FEMALE'
[15:36:12] ℹ️  Order extraction - Service Line: 'Hospice'
[15:36:12] ℹ️  Order extraction - Payer Source: 'Medicaid'
[15:36:12] ✅ Order data extraction completed successfully
[15:36:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:36:12] ℹ️  Using MRN from patient data: '2234420' over '2234420'
[15:36:12] ℹ️  Combined service lines: Patient='Nursing' + Order='Hospice' = 'Hospice, Nursing'
[15:36:12] ℹ️  Payer source consistent in both sources: 'Medicaid'
[15:36:12] ✅ Patient name cross-validation successful
[15:36:12] ✅    ✅ Data merged successfully
[15:36:13] ✅    ✅ Order data extracted and validated
[15:36:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:36:13] [DOC: 9226307] ✅ Patient found in local cache: Maria Bento, ID: d4a1a1eb-aab3-4fbd-9217-ee0d0bad9907
[15:36:13] ✅    ✅ Existing patient found with ID: d4a1a1eb-aab3-4fbd-9217-ee0d0bad9907
[15:36:13] 🔄 
🔄 Step 6: Pushing order to API...
[15:36:13] [DOC: 9226307] ℹ️  Pushing order via API for patient ID: d4a1a1eb-aab3-4fbd-9217-ee0d0bad9907
[15:36:15] [DOC: 9226307] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13094"}
[15:36:15] ❌    ❌ Failed to push order
[15:36:15] 🔄 
🔄 Step 7: Writing to CSV...
[15:36:15] [DOC: 9226307] ℹ️  Calculated age: 83 from DOB: 12/20/1941
[15:36:15] [DOC: 9226307] ℹ️  Service Line extracted: 'Hospice, Nursing'
[15:36:15] [DOC: 9226307] ℹ️  Payer Source extracted: 'Medicaid'
[15:36:15] [DOC: 9226307] ℹ️  Diagnosis codes being written:
[15:36:15] [DOC: 9226307] ℹ️    - Latest_Episode_Firstdiagnosis: 'N32.89'
[15:36:15] [DOC: 9226307] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.01'
[15:36:15] [DOC: 9226307] ℹ️    - Latest_Episode_Thirddiagnosis: 'F03.90'
[15:36:15] [DOC: 9226307] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G91.2'
[15:36:15] [DOC: 9226307] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R29.6'
[15:36:15] [DOC: 9226307] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.20'
[15:36:15] [DOC: 9226307] ✅ Patient data written to CSV: Maria Bento | Sex: FEMALE | Age: 83 | Service: Hospice, Nursing | Payer: Medicaid | MRN: 2234420
[15:36:15] ✅    ✅ Document 9226307 processed and saved successfully
[15:36:15] 🔄 
🔄 Step 8: Saving API details...
[15:36:15] [DOC: 9226307] ℹ️  API push details saved for document 9226307
[15:36:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224623                         ║
================================================================================
[15:36:15] ℹ️  Agency: Nizhoni Health-Fall River
[15:36:15] ℹ️  Date: 04/07/2025
[15:36:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:36:29] [DOC: 9224623] ✅ Text extracted using pdfplumber (12747 chars)
[15:36:29] ✅    ✅ Text extracted using pdfplumber (12747 chars)
[15:36:29] 🔄 
🔄 Step 2: Extracting patient data...
[15:36:32] ℹ️  AI extracted raw sex value: 'M'
[15:36:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:36:32] ℹ️  AI extracted payer source: ''
[15:36:32] ℹ️  AI extracted diagnoses:
[15:36:32] ℹ️    - Diagnosis 1: 'F20.9'
[15:36:32] ℹ️    - Diagnosis 2: 'F41.1'
[15:36:32] ℹ️    - Diagnosis 3: 'F31.9'
[15:36:32] ℹ️    - Diagnosis 4: 'I11.0'
[15:36:32] ℹ️    - Diagnosis 5: 'I50.32'
[15:36:32] ℹ️    - Diagnosis 6: 'J44.9'
[15:36:32] ℹ️  Final extracted MRN: '6598012'
[15:36:32] ℹ️  Final extracted Sex: 'MALE'
[15:36:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:36:32] ℹ️  Final extracted Payer Source: ''
[15:36:32] ✅ Patient data extraction completed successfully
[15:36:32] ✅    ✅ Patient data extracted successfully
[15:36:32] 📊 Patient Response
     └─ patientFName: Everett
     └─ patientLName: Thompson
     └─ dob: 05/15/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: 6598012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100016338848
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/09/2023', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F31.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'J44.9'}]
[15:36:32] ✅    ✅ Patient identified: Everett Thompson
[15:36:32] ✅    ✅ Patient name validation passed
[15:36:32] 🔄 
🔄 Step 3: Processing patient dates...
[15:36:32] [DOC: 9224623] ℹ️  DOB normalized: 05/15/1970
[15:36:32] [DOC: 9224623] ℹ️  Episode startOfCare normalized: 12/09/2023
[15:36:32] [DOC: 9224623] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[15:36:32] [DOC: 9224623] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[15:36:32] [DOC: 9224623] ✅ Patient date processing completed successfully
[15:36:32] ✅    ✅ Date processing completed
[15:36:32] 📊 Processed Patient Data
     └─ patientFName: Everett
     └─ patientLName: Thompson
     └─ dob: 05/15/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: 6598012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100016338848
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/09/2023', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F31.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'J44.9'}]
[15:36:32] 🔄 
🔄 Step 4: Extracting order data...
[15:36:34] ℹ️  Order extraction - MRN: '6598012'
[15:36:34] ℹ️  Order extraction - Sex: 'MALE'
[15:36:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:36:34] ℹ️  Order extraction - Payer Source: ''
[15:36:34] ✅ Order data extraction completed successfully
[15:36:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:36:34] ℹ️  Using MRN from patient data: '6598012' over '6598012'
[15:36:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:36:34] ✅ Patient name cross-validation successful
[15:36:34] ✅    ✅ Data merged successfully
[15:36:35] ✅    ✅ Order data extracted and validated
[15:36:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:36:44] [DOC: 9224623] ✅ Patient exists in API: Everett Thompson, ID: 12d3cb46-1e1c-49ca-b25b-db3061cabcdb
[15:36:44] ✅    ✅ Existing patient found with ID: 12d3cb46-1e1c-49ca-b25b-db3061cabcdb
[15:36:44] 🔄 
🔄 Step 6: Pushing order to API...
[15:36:44] [DOC: 9224623] ℹ️  Pushing order via API for patient ID: 12d3cb46-1e1c-49ca-b25b-db3061cabcdb
[15:36:45] [DOC: 9224623] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:36:45] ❌    ❌ Failed to push order
[15:36:45] 🔄 
🔄 Step 7: Writing to CSV...
[15:36:45] [DOC: 9224623] ℹ️  Calculated age: 55 from DOB: 05/15/1970
[15:36:45] [DOC: 9224623] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:36:45] [DOC: 9224623] ℹ️  Payer Source extracted: ''
[15:36:45] [DOC: 9224623] ℹ️  Diagnosis codes being written:
[15:36:45] [DOC: 9224623] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[15:36:45] [DOC: 9224623] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[15:36:45] [DOC: 9224623] ℹ️    - Latest_Episode_Thirddiagnosis: 'F31.9'
[15:36:45] [DOC: 9224623] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[15:36:45] [DOC: 9224623] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[15:36:45] [DOC: 9224623] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J44.9'
[15:36:45] [DOC: 9224623] ✅ Patient data written to CSV: Everett Thompson | Sex: MALE | Age: 55 | Service: Skilled Nursing | Payer:  | MRN: 6598012
[15:36:45] ✅    ✅ Document 9224623 processed and saved successfully
[15:36:45] 🔄 
🔄 Step 8: Saving API details...
[15:36:45] [DOC: 9224623] ℹ️  API push details saved for document 9224623
[15:36:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224595                         ║
================================================================================
[15:36:45] ℹ️  Agency: AccentCare Fall River
[15:36:45] ℹ️  Date: 04/07/2025
[15:36:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:36:48] [DOC: 9224595] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[15:36:49] [DOC: 9224595] ✅ Text extracted using tesseract_ocr (1447 chars)
[15:36:49] ✅    ✅ Text extracted using tesseract_ocr (1439 chars)
[15:36:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:36:52] ℹ️  AI extracted raw sex value: ''
[15:36:52] ℹ️  AI extracted service line: ''
[15:36:52] ℹ️  AI extracted payer source: ''
[15:36:52] ℹ️  AI extracted diagnoses:
[15:36:52] ℹ️    - Diagnosis 1: ''
[15:36:52] ℹ️    - Diagnosis 2: ''
[15:36:52] ℹ️    - Diagnosis 3: ''
[15:36:52] ℹ️    - Diagnosis 4: ''
[15:36:52] ℹ️    - Diagnosis 5: ''
[15:36:52] ℹ️    - Diagnosis 6: ''
[15:36:52] ℹ️  Final extracted MRN: 'C0200235550301'
[15:36:52] ℹ️  Final extracted Sex: ''
[15:36:52] ℹ️  Final extracted Service Line: ''
[15:36:52] ℹ️  Final extracted Payer Source: ''
[15:36:52] ✅ Patient data extraction completed successfully
[15:36:52] ✅    ✅ Patient data extracted successfully
[15:36:52] 📊 Patient Response
     └─ patientFName: DENISE
     └─ patientLName: PLASKON
     └─ dob: 07/20/1956
     └─ patientSex: 
     └─ medicalRecordNo: C0200235550301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:36:52] ✅    ✅ Patient identified: DENISE PLASKON
[15:36:52] ✅    ✅ Patient name validation passed
[15:36:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:36:52] [DOC: 9224595] ℹ️  DOB normalized: 07/20/1956
[15:36:52] [DOC: 9224595] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:36:52] [DOC: 9224595] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[15:36:52] [DOC: 9224595] ✅ Patient date processing completed successfully
[15:36:52] ✅    ✅ Date processing completed
[15:36:52] 📊 Processed Patient Data
     └─ patientFName: DENISE
     └─ patientLName: PLASKON
     └─ dob: 07/20/1956
     └─ patientSex: 
     └─ medicalRecordNo: C0200235550301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:36:52] 🔄 
🔄 Step 4: Extracting order data...
[15:36:54] ℹ️  Order extraction - MRN: 'C0200235550301'
[15:36:54] ℹ️  Order extraction - Sex: 'FEMALE'
[15:36:54] ℹ️  Order extraction - Service Line: ''
[15:36:54] ℹ️  Order extraction - Payer Source: ''
[15:36:54] ✅ Order data extraction completed successfully
[15:36:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:36:54] ℹ️  Using MRN from patient data: 'C0200235550301' over 'C0200235550301'
[15:36:54] ✅ Patient name cross-validation successful
[15:36:54] ✅    ✅ Data merged successfully
[15:36:56] ✅    ✅ Order data extracted and validated
[15:36:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:16] [DOC: 9224595] ℹ️  Patient not found in cache or API: DENISE PLASKON
[15:37:16] [DOC: 9224595] ℹ️  Patient not found, creating new patient via API...
[15:37:16] [DOC: 9224595] ℹ️  Creating patient via API: DENISE PLASKON
[15:37:17] [DOC: 9224595] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:37:17] ❌    ❌ Failed to create patient
[15:37:17] [DOC: 9224595] ℹ️  API push details saved for document 9224595
================================================================================
║                        Processing Document ID: 9224517                         ║
================================================================================
[15:37:17] ℹ️  Agency: Relief Home Health Services
[15:37:17] ℹ️  Date: 04/07/2025
[15:37:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:19] [DOC: 9224517] ✅ Text extracted using pdfplumber (2751 chars)
[15:37:19] ✅    ✅ Text extracted using pdfplumber (2751 chars)
[15:37:19] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:22] ℹ️  AI extracted raw sex value: ''
[15:37:22] ℹ️  AI extracted service line: 'LPVN'
[15:37:22] ℹ️  AI extracted payer source: ''
[15:37:22] ℹ️  AI extracted diagnoses:
[15:37:22] ℹ️    - Diagnosis 1: 'F25.9'
[15:37:22] ℹ️    - Diagnosis 2: ''
[15:37:22] ℹ️    - Diagnosis 3: ''
[15:37:22] ℹ️    - Diagnosis 4: ''
[15:37:22] ℹ️    - Diagnosis 5: ''
[15:37:22] ℹ️    - Diagnosis 6: ''
[15:37:22] ℹ️  Final extracted MRN: ''
[15:37:22] ℹ️  Final extracted Sex: ''
[15:37:22] ℹ️  Final extracted Service Line: 'LPVN'
[15:37:22] ℹ️  Final extracted Payer Source: ''
[15:37:22] ✅ Patient data extraction completed successfully
[15:37:22] ✅    ✅ Patient data extracted successfully
[15:37:22] 📊 Patient Response
     └─ patientFName: PAUL
     └─ patientLName: RODRIGUES
     └─ dob: 07/07/1972
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: KARINE MAALOUF KALESHIAN, MD
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 531 Faunce Corner Rd
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: LPVN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': 'F25.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:22] ✅    ✅ Patient identified: PAUL RODRIGUES
[15:37:22] ✅    ✅ Patient name validation passed
[15:37:22] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:22] [DOC: 9224517] ℹ️  DOB normalized: 07/07/1972
[15:37:22] [DOC: 9224517] ℹ️  Episode startOfCare normalized: 04/14/2024
[15:37:22] [DOC: 9224517] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:37:22] [DOC: 9224517] ℹ️  Episode endOfEpisode normalized: 03/25/2025
[15:37:22] [DOC: 9224517] ✅ Patient date processing completed successfully
[15:37:22] ✅    ✅ Date processing completed
[15:37:22] 📊 Processed Patient Data
     └─ patientFName: PAUL
     └─ patientLName: RODRIGUES
     └─ dob: 07/07/1972
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: KARINE MAALOUF KALESHIAN, MD
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 531 Faunce Corner Rd
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: LPVN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': 'F25.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:22] 🔄 
🔄 Step 4: Extracting order data...
[15:37:24] ℹ️  Order extraction - MRN: ''
[15:37:24] ℹ️  Order extraction - Sex: ''
[15:37:24] ℹ️  Order extraction - Service Line: ''
[15:37:24] ℹ️  Order extraction - Payer Source: ''
[15:37:24] ✅ Order data extraction completed successfully
[15:37:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:24] ⚠️  No MRN found in either patient or order data
[15:37:24] ℹ️  Inferred sex as MALE from name: PAUL
[15:37:24] ℹ️  Using service line from patient data: 'LPVN'
[15:37:24] ✅ Patient name cross-validation successful
[15:37:24] ✅    ✅ Data merged successfully
[15:37:26] ✅    ✅ Order data extracted and validated
[15:37:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:31] [DOC: 9224517] ✅ Patient exists in API: PAUL RODRIGUES, ID: cf10227e-9394-488a-a3a8-eecaf0edecf2
[15:37:31] ✅    ✅ Existing patient found with ID: cf10227e-9394-488a-a3a8-eecaf0edecf2
[15:37:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:37:31] [DOC: 9224517] ℹ️  Pushing order via API for patient ID: cf10227e-9394-488a-a3a8-eecaf0edecf2
[15:37:32] [DOC: 9224517] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:37:32] ❌    ❌ Failed to push order
[15:37:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:37:32] [DOC: 9224517] ℹ️  Calculated age: 52 from DOB: 07/07/1972
[15:37:32] [DOC: 9224517] ℹ️  Service Line extracted: 'LPVN'
[15:37:32] [DOC: 9224517] ℹ️  Payer Source extracted: ''
[15:37:32] [DOC: 9224517] ℹ️  Diagnosis codes being written:
[15:37:32] [DOC: 9224517] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.9'
[15:37:32] [DOC: 9224517] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:37:32] [DOC: 9224517] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:37:32] [DOC: 9224517] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:37:32] [DOC: 9224517] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:37:32] [DOC: 9224517] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:37:32] [DOC: 9224517] ✅ Patient data written to CSV: PAUL RODRIGUES | Sex: MALE | Age: 52 | Service: LPVN | Payer:  | MRN: 
[15:37:32] ✅    ✅ Document 9224517 processed and saved successfully
[15:37:32] 🔄 
🔄 Step 8: Saving API details...
[15:37:32] [DOC: 9224517] ℹ️  API push details saved for document 9224517
[15:37:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224505                         ║
================================================================================
[15:37:32] ℹ️  Agency: Relief Home Health Services
[15:37:32] ℹ️  Date: 04/07/2025
[15:37:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:35] [DOC: 9224505] ✅ Text extracted using pdfplumber (20434 chars)
[15:37:35] ✅    ✅ Text extracted using pdfplumber (20434 chars)
[15:37:35] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:39] ℹ️  AI extracted raw sex value: 'M'
[15:37:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:37:39] ℹ️  AI extracted payer source: ''
[15:37:39] ℹ️  AI extracted diagnoses:
[15:37:39] ℹ️    - Diagnosis 1: 'F25.9'
[15:37:39] ℹ️    - Diagnosis 2: 'F41.0'
[15:37:39] ℹ️    - Diagnosis 3: 'J96.22'
[15:37:39] ℹ️    - Diagnosis 4: 'J96.21'
[15:37:39] ℹ️    - Diagnosis 5: 'I10'
[15:37:39] ℹ️    - Diagnosis 6: 'F41.9'
[15:37:39] ℹ️  Final extracted MRN: 'NB0062'
[15:37:39] ℹ️  Final extracted Sex: 'MALE'
[15:37:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:37:39] ℹ️  Final extracted Payer Source: ''
[15:37:39] ✅ Patient data extraction completed successfully
[15:37:39] ✅    ✅ Patient data extracted successfully
[15:37:39] 📊 Patient Response
     └─ patientFName: PAUL
     └─ patientLName: RODRIGUES
     └─ dob: 07/07/1972
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0062
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 1 ACUSHNET RD APT 23
     └─ city: MATTAPOISETT
     └─ state: MA
     └─ zip: 02739
     └─ email: 
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F25.9', 'secondDiagnosis': 'F41.0', 'thirdDiagnosis': 'J96.22', 'fourthDiagnosis': 'J96.21', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F41.9'}]
[15:37:39] ✅    ✅ Patient identified: PAUL RODRIGUES
[15:37:39] ✅    ✅ Patient name validation passed
[15:37:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:39] [DOC: 9224505] ℹ️  DOB normalized: 07/07/1972
[15:37:39] [DOC: 9224505] ℹ️  Episode startOfCare normalized: 04/14/2024
[15:37:39] [DOC: 9224505] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[15:37:39] [DOC: 9224505] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[15:37:39] [DOC: 9224505] ✅ Patient date processing completed successfully
[15:37:39] ✅    ✅ Date processing completed
[15:37:39] 📊 Processed Patient Data
     └─ patientFName: PAUL
     └─ patientLName: RODRIGUES
     └─ dob: 07/07/1972
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0062
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 1 ACUSHNET RD APT 23
     └─ city: MATTAPOISETT
     └─ state: MA
     └─ zip: 02739
     └─ email: 
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F25.9', 'secondDiagnosis': 'F41.0', 'thirdDiagnosis': 'J96.22', 'fourthDiagnosis': 'J96.21', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F41.9'}]
[15:37:39] 🔄 
🔄 Step 4: Extracting order data...
[15:37:42] ℹ️  Order extraction - MRN: 'NB0062'
[15:37:42] ℹ️  Order extraction - Sex: 'MALE'
[15:37:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:37:42] ℹ️  Order extraction - Payer Source: ''
[15:37:42] ✅ Order data extraction completed successfully
[15:37:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:42] ℹ️  Using MRN from patient data: 'NB0062' over 'NB0062'
[15:37:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:37:42] ✅ Patient name cross-validation successful
[15:37:42] ✅    ✅ Data merged successfully
[15:37:43] ✅    ✅ Order data extracted and validated
[15:37:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:43] [DOC: 9224505] ✅ Patient found in local cache: PAUL RODRIGUES, ID: cf10227e-9394-488a-a3a8-eecaf0edecf2
[15:37:43] ✅    ✅ Existing patient found with ID: cf10227e-9394-488a-a3a8-eecaf0edecf2
[15:37:43] 🔄 
🔄 Step 6: Pushing order to API...
[15:37:43] [DOC: 9224505] ℹ️  Pushing order via API for patient ID: cf10227e-9394-488a-a3a8-eecaf0edecf2
[15:37:44] [DOC: 9224505] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:37:44] ❌    ❌ Failed to push order
[15:37:44] 🔄 
🔄 Step 7: Writing to CSV...
[15:37:44] [DOC: 9224505] ℹ️  Calculated age: 52 from DOB: 07/07/1972
[15:37:44] [DOC: 9224505] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:37:44] [DOC: 9224505] ℹ️  Payer Source extracted: ''
[15:37:44] [DOC: 9224505] ℹ️  Diagnosis codes being written:
[15:37:44] [DOC: 9224505] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.9'
[15:37:44] [DOC: 9224505] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.0'
[15:37:44] [DOC: 9224505] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.22'
[15:37:44] [DOC: 9224505] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.21'
[15:37:44] [DOC: 9224505] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:37:44] [DOC: 9224505] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[15:37:44] [DOC: 9224505] ✅ Patient data written to CSV: PAUL RODRIGUES | Sex: MALE | Age: 52 | Service: Skilled Nursing | Payer:  | MRN: NB0062
[15:37:44] ✅    ✅ Document 9224505 processed and saved successfully
[15:37:44] 🔄 
🔄 Step 8: Saving API details...
[15:37:44] [DOC: 9224505] ℹ️  API push details saved for document 9224505
[15:37:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224476                         ║
================================================================================
[15:37:44] ℹ️  Agency: Nizhoni Health-Fall River
[15:37:44] ℹ️  Date: 04/07/2025
[15:37:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:48] [DOC: 9224476] ✅ Text extracted using pdfplumber (1061 chars)
[15:37:48] ✅    ✅ Text extracted using pdfplumber (1061 chars)
[15:37:48] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:51] ℹ️  AI extracted raw sex value: 'F'
[15:37:51] ℹ️  AI extracted service line: 'HHA'
[15:37:51] ℹ️  AI extracted payer source: 'Medicaid/MA'
[15:37:51] ℹ️  AI extracted diagnoses:
[15:37:51] ℹ️    - Diagnosis 1: ''
[15:37:51] ℹ️    - Diagnosis 2: ''
[15:37:51] ℹ️    - Diagnosis 3: ''
[15:37:51] ℹ️    - Diagnosis 4: ''
[15:37:51] ℹ️    - Diagnosis 5: ''
[15:37:51] ℹ️    - Diagnosis 6: ''
[15:37:51] ℹ️  Final extracted MRN: '14458020'
[15:37:51] ℹ️  Final extracted Sex: 'FEMALE'
[15:37:51] ℹ️  Final extracted Service Line: 'HHA'
[15:37:51] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[15:37:51] ✅ Patient data extraction completed successfully
[15:37:51] ✅    ✅ Patient data extracted successfully
[15:37:51] 📊 Patient Response
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 28 Harrison Street
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:51] ✅    ✅ Patient identified: Gina Reich
[15:37:51] ✅    ✅ Patient name validation passed
[15:37:51] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:51] [DOC: 9224476] ℹ️  DOB normalized: 12/30/1962
[15:37:51] [DOC: 9224476] ℹ️  Episode startOfCare normalized: 10/22/2024
[15:37:51] [DOC: 9224476] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[15:37:51] [DOC: 9224476] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[15:37:51] [DOC: 9224476] ✅ Patient date processing completed successfully
[15:37:51] ✅    ✅ Date processing completed
[15:37:51] 📊 Processed Patient Data
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 28 Harrison Street
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:51] 🔄 
🔄 Step 4: Extracting order data...
[15:37:53] ℹ️  Order extraction - MRN: '14458020'
[15:37:53] ℹ️  Order extraction - Sex: 'FEMALE'
[15:37:53] ℹ️  Order extraction - Service Line: ''
[15:37:53] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[15:37:53] ✅ Order data extraction completed successfully
[15:37:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:53] ℹ️  Using MRN from patient data: '14458020' over '14458020'
[15:37:53] ℹ️  Using service line from patient data: 'HHA'
[15:37:53] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[15:37:53] ✅ Patient name cross-validation successful
[15:37:53] ✅    ✅ Data merged successfully
[15:37:54] ✅    ✅ Order data extracted and validated
[15:37:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:54] [DOC: 9224476] ✅ Patient found in local cache: Gina Reich, ID: d58989e3-7402-4034-9b32-9290658d7724
[15:37:54] ✅    ✅ Existing patient found with ID: d58989e3-7402-4034-9b32-9290658d7724
[15:37:54] 🔄 
🔄 Step 6: Pushing order to API...
[15:37:54] [DOC: 9224476] ℹ️  Pushing order via API for patient ID: d58989e3-7402-4034-9b32-9290658d7724
[15:37:55] [DOC: 9224476] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:37:55] ❌    ❌ Failed to push order
[15:37:55] 🔄 
🔄 Step 7: Writing to CSV...
[15:37:55] [DOC: 9224476] ℹ️  Calculated age: 62 from DOB: 12/30/1962
[15:37:55] [DOC: 9224476] ℹ️  Service Line extracted: 'HHA'
[15:37:55] [DOC: 9224476] ℹ️  Payer Source extracted: 'Medicaid/MA'
[15:37:55] [DOC: 9224476] ℹ️  Diagnosis codes being written:
[15:37:55] [DOC: 9224476] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:37:55] [DOC: 9224476] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:37:55] [DOC: 9224476] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:37:55] [DOC: 9224476] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:37:55] [DOC: 9224476] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:37:55] [DOC: 9224476] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:37:55] [DOC: 9224476] ✅ Patient data written to CSV: Gina Reich | Sex: FEMALE | Age: 62 | Service: HHA | Payer: Medicaid/MA | MRN: 14458020
[15:37:55] ✅    ✅ Document 9224476 processed and saved successfully
[15:37:55] 🔄 
🔄 Step 8: Saving API details...
[15:37:55] [DOC: 9224476] ℹ️  API push details saved for document 9224476
[15:37:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224461                         ║
================================================================================
[15:37:55] ℹ️  Agency: Nizhoni Health-Fall River
[15:37:55] ℹ️  Date: 04/07/2025
[15:37:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:59] [DOC: 9224461] ✅ Text extracted using pdfplumber (1994 chars)
[15:37:59] ✅    ✅ Text extracted using pdfplumber (1994 chars)
[15:37:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:38:02] ℹ️  AI extracted raw sex value: 'M'
[15:38:02] ℹ️  AI extracted service line: 'HHA'
[15:38:02] ℹ️  AI extracted payer source: 'Medicaid/MA'
[15:38:02] ℹ️  AI extracted diagnoses:
[15:38:02] ℹ️    - Diagnosis 1: ''
[15:38:02] ℹ️    - Diagnosis 2: ''
[15:38:02] ℹ️    - Diagnosis 3: ''
[15:38:02] ℹ️    - Diagnosis 4: ''
[15:38:02] ℹ️    - Diagnosis 5: ''
[15:38:02] ℹ️    - Diagnosis 6: ''
[15:38:02] ℹ️  Final extracted MRN: '3934020'
[15:38:02] ℹ️  Final extracted Sex: 'MALE'
[15:38:02] ℹ️  Final extracted Service Line: 'HHA'
[15:38:02] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[15:38:02] ✅ Patient data extraction completed successfully
[15:38:02] ✅    ✅ Patient data extracted successfully
[15:38:02] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Maker
     └─ dob: 03/26/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 3934020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 12 Ruth Street Apt 403
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2023', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:38:02] ✅    ✅ Patient identified: Robert Maker
[15:38:02] ✅    ✅ Patient name validation passed
[15:38:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:38:02] [DOC: 9224461] ℹ️  DOB normalized: 03/26/1951
[15:38:02] [DOC: 9224461] ℹ️  Episode startOfCare normalized: 01/18/2023
[15:38:02] [DOC: 9224461] ℹ️  Episode startOfEpisode normalized: 03/08/2025
[15:38:02] [DOC: 9224461] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[15:38:02] [DOC: 9224461] ✅ Patient date processing completed successfully
[15:38:02] ✅    ✅ Date processing completed
[15:38:02] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Maker
     └─ dob: 03/26/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 3934020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 12 Ruth Street Apt 403
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2023', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:38:02] 🔄 
🔄 Step 4: Extracting order data...
[15:38:04] ℹ️  Order extraction - MRN: '3934020'
[15:38:04] ℹ️  Order extraction - Sex: 'MALE'
[15:38:04] ℹ️  Order extraction - Service Line: ''
[15:38:04] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[15:38:04] ✅ Order data extraction completed successfully
[15:38:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:38:04] ℹ️  Using MRN from patient data: '3934020' over '3934020'
[15:38:04] ℹ️  Using service line from patient data: 'HHA'
[15:38:04] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[15:38:04] ✅ Patient name cross-validation successful
[15:38:04] ✅    ✅ Data merged successfully
[15:38:06] ✅    ✅ Order data extracted and validated
[15:38:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:13] [DOC: 9224461] ℹ️  Patient not found in cache or API: Robert Maker
[15:38:13] [DOC: 9224461] ℹ️  Patient not found, creating new patient via API...
[15:38:13] [DOC: 9224461] ℹ️  Creating patient via API: Robert Maker
[15:38:14] [DOC: 9224461] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:38:14] ❌    ❌ Failed to create patient
[15:38:14] [DOC: 9224461] ℹ️  API push details saved for document 9224461
================================================================================
║                        Processing Document ID: 9224454                         ║
================================================================================
[15:38:14] ℹ️  Agency: Nizhoni Health-Fall River
[15:38:14] ℹ️  Date: 04/07/2025
[15:38:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:18] [DOC: 9224454] ✅ Text extracted using pdfplumber (12796 chars)
[15:38:18] ✅    ✅ Text extracted using pdfplumber (12796 chars)
[15:38:18] 🔄 
🔄 Step 2: Extracting patient data...
[15:38:21] ℹ️  AI extracted raw sex value: 'M'
[15:38:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:38:21] ℹ️  AI extracted payer source: 'None'
[15:38:21] ℹ️  AI extracted diagnoses:
[15:38:21] ℹ️    - Diagnosis 1: 'F20.0'
[15:38:21] ℹ️    - Diagnosis 2: 'F17.210'
[15:38:21] ℹ️    - Diagnosis 3: 'E78.5'
[15:38:21] ℹ️    - Diagnosis 4: 'N18.30'
[15:38:21] ℹ️    - Diagnosis 5: 'G47.00'
[15:38:21] ℹ️    - Diagnosis 6: 'H91.93'
[15:38:21] ℹ️  Final extracted MRN: '2748020'
[15:38:21] ℹ️  Final extracted Sex: 'MALE'
[15:38:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:38:21] ℹ️  Final extracted Payer Source: ''
[15:38:21] ✅ Patient data extraction completed successfully
[15:38:21] ✅    ✅ Patient data extracted successfully
[15:38:21] 📊 Patient Response
     └─ patientFName: Anthony
     └─ patientLName: Lawson
     └─ dob: 12/07/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2748020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100011177563
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/14/2022', 'startOfEpisode': '10/19/2022', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': 'F17.210', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'G47.00', 'sixthDiagnosis': 'H91.93'}]
[15:38:21] ✅    ✅ Patient identified: Anthony Lawson
[15:38:21] ✅    ✅ Patient name validation passed
[15:38:21] 🔄 
🔄 Step 3: Processing patient dates...
[15:38:21] [DOC: 9224454] ℹ️  DOB normalized: 12/07/1960
[15:38:21] [DOC: 9224454] ℹ️  Episode startOfCare normalized: 10/14/2022
[15:38:21] [DOC: 9224454] ℹ️  Episode startOfEpisode normalized: 10/19/2022
[15:38:21] [DOC: 9224454] ℹ️  Episode endOfEpisode normalized: 06/04/2025
[15:38:21] [DOC: 9224454] ✅ Patient date processing completed successfully
[15:38:21] ✅    ✅ Date processing completed
[15:38:21] 📊 Processed Patient Data
     └─ patientFName: Anthony
     └─ patientLName: Lawson
     └─ dob: 12/07/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2748020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100011177563
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/14/2022', 'startOfEpisode': '10/19/2022', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': 'F17.210', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'G47.00', 'sixthDiagnosis': 'H91.93'}]
[15:38:21] 🔄 
🔄 Step 4: Extracting order data...
[15:38:23] ℹ️  Order extraction - MRN: '2748020'
[15:38:23] ℹ️  Order extraction - Sex: 'MALE'
[15:38:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:38:23] ℹ️  Order extraction - Payer Source: ''
[15:38:23] ✅ Order data extraction completed successfully
[15:38:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:38:23] ℹ️  Using MRN from patient data: '2748020' over '2748020'
[15:38:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:38:23] ✅ Patient name cross-validation successful
[15:38:23] ✅    ✅ Data merged successfully
[15:38:25] ✅    ✅ Order data extracted and validated
[15:38:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:32] [DOC: 9224454] ✅ Patient exists in API: Anthony Lawson, ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[15:38:32] ✅    ✅ Existing patient found with ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[15:38:32] 🔄 
🔄 Step 6: Pushing order to API...
[15:38:32] [DOC: 9224454] ℹ️  Pushing order via API for patient ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[15:38:34] [DOC: 9224454] ❌ Order push failed with status 201: {"id":"194466b0-e7d9-4886-a3a3-385a491e02d3","orderWAVId":"ORD20058","orderNo":"2748020","orderDate":"04/06/2025","startOfCare":"10/19/2022","episodeStartDate":"04/06/2025","episodeEndDate":"06/04/2025","documentID":"9224454","mrn":"2748020","patientName":"Lawson, Anthony","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/08/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"55749ca9-f117-4f51-95ea-dca838c39c2c","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:38:34] ❌    ❌ Failed to push order
[15:38:34] 🔄 
🔄 Step 7: Writing to CSV...
[15:38:34] [DOC: 9224454] ℹ️  Calculated age: 64 from DOB: 12/07/1960
[15:38:34] [DOC: 9224454] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:38:34] [DOC: 9224454] ℹ️  Payer Source extracted: ''
[15:38:34] [DOC: 9224454] ℹ️  Diagnosis codes being written:
[15:38:34] [DOC: 9224454] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.0'
[15:38:34] [DOC: 9224454] ℹ️    - Latest_Episode_Seconddiagnosis: 'F17.210'
[15:38:34] [DOC: 9224454] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[15:38:34] [DOC: 9224454] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[15:38:34] [DOC: 9224454] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G47.00'
[15:38:34] [DOC: 9224454] ℹ️    - Latest_Episode_Sixthdiagnosis: 'H91.93'
[15:38:34] [DOC: 9224454] ✅ Patient data written to CSV: Anthony Lawson | Sex: MALE | Age: 64 | Service: Skilled Nursing | Payer:  | MRN: 2748020
[15:38:34] ✅    ✅ Document 9224454 processed and saved successfully
[15:38:34] 🔄 
🔄 Step 8: Saving API details...
[15:38:34] [DOC: 9224454] ℹ️  API push details saved for document 9224454
[15:38:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224426                         ║
================================================================================
[15:38:34] ℹ️  Agency: Dartmouth HH
[15:38:34] ℹ️  Date: 04/07/2025
[15:38:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:37] [DOC: 9224426] ✅ Text extracted using pdfplumber (22798 chars)
[15:38:37] ✅    ✅ Text extracted using pdfplumber (22798 chars)
[15:38:37] 🔄 
🔄 Step 2: Extracting patient data...
[15:38:40] ℹ️  AI extracted raw sex value: 'M'
[15:38:40] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:38:40] ℹ️  AI extracted payer source: 'None'
[15:38:40] ℹ️  AI extracted diagnoses:
[15:38:40] ℹ️    - Diagnosis 1: 'Z47.1'
[15:38:40] ℹ️    - Diagnosis 2: 'Z96.612'
[15:38:40] ℹ️    - Diagnosis 3: 'I25.10'
[15:38:40] ℹ️    - Diagnosis 4: 'E11.29'
[15:38:40] ℹ️    - Diagnosis 5: 'I10'
[15:38:40] ℹ️    - Diagnosis 6: 'I35.0'
[15:38:40] ℹ️  Final extracted MRN: '227027'
[15:38:40] ℹ️  Final extracted Sex: 'MALE'
[15:38:40] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:38:40] ℹ️  Final extracted Payer Source: ''
[15:38:40] ✅ Patient data extraction completed successfully
[15:38:40] ✅    ✅ Patient data extracted successfully
[15:38:40] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.612', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'E11.29', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'I35.0'}]
[15:38:40] ✅    ✅ Patient identified: James Travers
[15:38:40] ✅    ✅ Patient name validation passed
[15:38:40] 🔄 
🔄 Step 3: Processing patient dates...
[15:38:40] [DOC: 9224426] ℹ️  DOB normalized: 07/02/1944
[15:38:40] [DOC: 9224426] ℹ️  Episode startOfCare normalized: 03/23/2025
[15:38:40] [DOC: 9224426] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:38:40] [DOC: 9224426] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:38:40] [DOC: 9224426] ✅ Patient date processing completed successfully
[15:38:40] ✅    ✅ Date processing completed
[15:38:40] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.612', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'E11.29', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'I35.0'}]
[15:38:40] 🔄 
🔄 Step 4: Extracting order data...
[15:38:42] ℹ️  Order extraction - MRN: '551011'
[15:38:42] ℹ️  Order extraction - Sex: 'MALE'
[15:38:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing,PT,OT'
[15:38:42] ℹ️  Order extraction - Payer Source: ''
[15:38:42] ✅ Order data extraction completed successfully
[15:38:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:38:42] ℹ️  Using MRN from patient data: '227027' over '551011'
[15:38:42] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing,PT,OT' = 'OT, PT, Skilled Nursing'
[15:38:42] ✅ Patient name cross-validation successful
[15:38:42] ✅    ✅ Data merged successfully
[15:38:44] ✅    ✅ Order data extracted and validated
[15:38:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:44] [DOC: 9224426] ✅ Patient found in local cache: James Travers, ID: c5103623-be0f-42b5-97de-217d9f008d54
[15:38:44] ✅    ✅ Existing patient found with ID: c5103623-be0f-42b5-97de-217d9f008d54
[15:38:44] 🔄 
🔄 Step 6: Pushing order to API...
[15:38:44] [DOC: 9224426] ℹ️  Pushing order via API for patient ID: c5103623-be0f-42b5-97de-217d9f008d54
[15:38:45] [DOC: 9224426] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:38:45] ❌    ❌ Failed to push order
[15:38:45] 🔄 
🔄 Step 7: Writing to CSV...
[15:38:45] [DOC: 9224426] ℹ️  Calculated age: 80 from DOB: 07/02/1944
[15:38:45] [DOC: 9224426] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[15:38:45] [DOC: 9224426] ℹ️  Payer Source extracted: ''
[15:38:45] [DOC: 9224426] ℹ️  Diagnosis codes being written:
[15:38:45] [DOC: 9224426] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[15:38:45] [DOC: 9224426] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.612'
[15:38:45] [DOC: 9224426] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[15:38:45] [DOC: 9224426] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.29'
[15:38:45] [DOC: 9224426] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:38:45] [DOC: 9224426] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I35.0'
[15:38:45] [DOC: 9224426] ✅ Patient data written to CSV: James Travers | Sex: MALE | Age: 80 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 227027
[15:38:45] ✅    ✅ Document 9224426 processed and saved successfully
[15:38:45] 🔄 
🔄 Step 8: Saving API details...
[15:38:45] [DOC: 9224426] ℹ️  API push details saved for document 9224426
[15:38:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224418                         ║
================================================================================
[15:38:45] ℹ️  Agency: Dartmouth HH
[15:38:45] ℹ️  Date: 04/07/2025
[15:38:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:49] [DOC: 9224418] ✅ Text extracted using pdfplumber (15721 chars)
[15:38:49] ✅    ✅ Text extracted using pdfplumber (15721 chars)
[15:38:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:38:52] ℹ️  AI extracted raw sex value: 'F'
[15:38:52] ℹ️  AI extracted service line: 'PT'
[15:38:52] ℹ️  AI extracted payer source: ''
[15:38:52] ℹ️  AI extracted diagnoses:
[15:38:52] ℹ️    - Diagnosis 1: 'Z47.1'
[15:38:52] ℹ️    - Diagnosis 2: 'M96.661'
[15:38:52] ℹ️    - Diagnosis 3: 'M97.01XD'
[15:38:52] ℹ️    - Diagnosis 4: 'E66.9'
[15:38:52] ℹ️    - Diagnosis 5: 'Z68.31'
[15:38:52] ℹ️    - Diagnosis 6: 'E87.1'
[15:38:52] ℹ️  Final extracted MRN: '6133015'
[15:38:52] ℹ️  Final extracted Sex: 'FEMALE'
[15:38:52] ℹ️  Final extracted Service Line: 'PT'
[15:38:52] ℹ️  Final extracted Payer Source: ''
[15:38:52] ✅ Patient data extraction completed successfully
[15:38:52] ✅    ✅ Patient data extracted successfully
[15:38:52] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M96.661', 'thirdDiagnosis': 'M97.01XD', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'E87.1'}]
[15:38:52] ✅    ✅ Patient identified: Jacqueline DeTerra
[15:38:52] ✅    ✅ Patient name validation passed
[15:38:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:38:52] [DOC: 9224418] ℹ️  DOB normalized: 11/04/1976
[15:38:52] [DOC: 9224418] ℹ️  Episode startOfCare normalized: 04/03/2025
[15:38:52] [DOC: 9224418] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[15:38:52] [DOC: 9224418] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[15:38:52] [DOC: 9224418] ✅ Patient date processing completed successfully
[15:38:52] ✅    ✅ Date processing completed
[15:38:52] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M96.661', 'thirdDiagnosis': 'M97.01XD', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'E87.1'}]
[15:38:52] 🔄 
🔄 Step 4: Extracting order data...
[15:38:55] ℹ️  Order extraction - MRN: '6133015'
[15:38:55] ℹ️  Order extraction - Sex: 'FEMALE'
[15:38:55] ℹ️  Order extraction - Service Line: 'PT'
[15:38:55] ℹ️  Order extraction - Payer Source: ''
[15:38:55] ✅ Order data extraction completed successfully
[15:38:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:38:55] ℹ️  Using MRN from patient data: '6133015' over '6133015'
[15:38:55] ℹ️  Service line consistent in both sources: 'PT'
[15:38:55] ✅ Patient name cross-validation successful
[15:38:55] ✅    ✅ Data merged successfully
[15:38:56] ✅    ✅ Order data extracted and validated
[15:38:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:56] [DOC: 9224418] ✅ Patient found in local cache: Jacqueline DeTerra, ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[15:38:56] ✅    ✅ Existing patient found with ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[15:38:56] 🔄 
🔄 Step 6: Pushing order to API...
[15:38:56] [DOC: 9224418] ℹ️  Pushing order via API for patient ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[15:38:57] [DOC: 9224418] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:38:57] ❌    ❌ Failed to push order
[15:38:57] 🔄 
🔄 Step 7: Writing to CSV...
[15:38:57] [DOC: 9224418] ℹ️  Calculated age: 48 from DOB: 11/04/1976
[15:38:57] [DOC: 9224418] ℹ️  Service Line extracted: 'PT'
[15:38:57] [DOC: 9224418] ℹ️  Payer Source extracted: ''
[15:38:57] [DOC: 9224418] ℹ️  Diagnosis codes being written:
[15:38:57] [DOC: 9224418] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[15:38:57] [DOC: 9224418] ℹ️    - Latest_Episode_Seconddiagnosis: 'M96.661'
[15:38:57] [DOC: 9224418] ℹ️    - Latest_Episode_Thirddiagnosis: 'M97.01XD'
[15:38:57] [DOC: 9224418] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.9'
[15:38:57] [DOC: 9224418] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.31'
[15:38:57] [DOC: 9224418] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.1'
[15:38:57] [DOC: 9224418] ✅ Patient data written to CSV: Jacqueline DeTerra | Sex: FEMALE | Age: 48 | Service: PT | Payer:  | MRN: 6133015
[15:38:57] ✅    ✅ Document 9224418 processed and saved successfully
[15:38:57] 🔄 
🔄 Step 8: Saving API details...
[15:38:57] [DOC: 9224418] ℹ️  API push details saved for document 9224418
[15:38:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224413                         ║
================================================================================
[15:38:57] ℹ️  Agency: Dartmouth HH
[15:38:57] ℹ️  Date: 04/07/2025
[15:38:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:59] [DOC: 9224413] ✅ Text extracted using pdfplumber (3878 chars)
[15:38:59] ✅    ✅ Text extracted using pdfplumber (3878 chars)
[15:38:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:03] ℹ️  AI extracted raw sex value: 'F'
[15:39:03] ℹ️  AI extracted service line: 'OT, RN, LPN'
[15:39:03] ℹ️  AI extracted payer source: 'Medicare'
[15:39:03] ℹ️  AI extracted diagnoses:
[15:39:03] ℹ️    - Diagnosis 1: 'RSV'
[15:39:03] ℹ️    - Diagnosis 2: ''
[15:39:03] ℹ️    - Diagnosis 3: ''
[15:39:03] ℹ️    - Diagnosis 4: ''
[15:39:03] ℹ️    - Diagnosis 5: ''
[15:39:03] ℹ️    - Diagnosis 6: ''
[15:39:03] ℹ️  Final extracted MRN: '5915015'
[15:39:03] ℹ️  Final extracted Sex: 'FEMALE'
[15:39:03] ℹ️  Final extracted Service Line: 'OT, RN, LPN'
[15:39:03] ℹ️  Final extracted Payer Source: 'Medicare'
[15:39:03] ✅ Patient data extraction completed successfully
[15:39:03] ✅    ✅ Patient data extracted successfully
[15:39:03] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'a-fib', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:39:03] ✅    ✅ Patient identified: Suzanne Fawcett
[15:39:03] ✅    ✅ Patient name validation passed
[15:39:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:03] [DOC: 9224413] ℹ️  DOB normalized: 12/08/1939
[15:39:03] [DOC: 9224413] ℹ️  Episode startOfCare normalized: 01/26/2025
[15:39:03] [DOC: 9224413] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[15:39:03] [DOC: 9224413] ℹ️  Episode endOfEpisode normalized: 01/25/2025
[15:39:03] [DOC: 9224413] ✅ Patient date processing completed successfully
[15:39:03] ✅    ✅ Date processing completed
[15:39:03] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'a-fib', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:39:03] 🔄 
🔄 Step 4: Extracting order data...
[15:39:06] ℹ️  Order extraction - MRN: ''
[15:39:06] ℹ️  Order extraction - Sex: 'FEMALE'
[15:39:06] ℹ️  Order extraction - Service Line: 'OT, Skilled Nursing'
[15:39:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:39:06] ✅ Order data extraction completed successfully
[15:39:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:06] ℹ️  Using MRN from patient data: '5915015'
[15:39:06] ℹ️  Combined service lines: Patient='OT, RN, LPN' + Order='OT, Skilled Nursing' = 'LPN, OT, RN, Skilled Nursing'
[15:39:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:39:06] ✅ Patient name cross-validation successful
[15:39:06] ✅    ✅ Data merged successfully
[15:39:07] ✅    ✅ Order data extracted and validated
[15:39:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:39:13] [DOC: 9224413] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[15:39:13] [DOC: 9224413] ℹ️  Patient not found, creating new patient via API...
[15:39:13] [DOC: 9224413] ℹ️  Creating patient via API: Suzanne Fawcett
[15:39:15] [DOC: 9224413] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:39:15] ❌    ❌ Failed to create patient
[15:39:15] [DOC: 9224413] ℹ️  API push details saved for document 9224413
================================================================================
║                        Processing Document ID: 9224407                         ║
================================================================================
[15:39:15] ℹ️  Agency: Dartmouth HH
[15:39:15] ℹ️  Date: 04/07/2025
[15:39:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:17] [DOC: 9224407] ✅ Text extracted using pdfplumber (1217 chars)
[15:39:17] ✅    ✅ Text extracted using pdfplumber (1217 chars)
[15:39:17] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:20] ℹ️  AI extracted raw sex value: 'F'
[15:39:20] ℹ️  AI extracted service line: 'HHA'
[15:39:20] ℹ️  AI extracted payer source: 'Fallon Navicare'
[15:39:20] ℹ️  AI extracted diagnoses:
[15:39:20] ℹ️    - Diagnosis 1: ''
[15:39:20] ℹ️    - Diagnosis 2: ''
[15:39:20] ℹ️    - Diagnosis 3: ''
[15:39:20] ℹ️    - Diagnosis 4: ''
[15:39:20] ℹ️    - Diagnosis 5: ''
[15:39:20] ℹ️    - Diagnosis 6: ''
[15:39:20] ℹ️  Final extracted MRN: '6046015'
[15:39:20] ℹ️  Final extracted Sex: 'FEMALE'
[15:39:20] ℹ️  Final extracted Service Line: 'HHA'
[15:39:20] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[15:39:20] ✅ Patient data extraction completed successfully
[15:39:20] ✅    ✅ Patient data extracted successfully
[15:39:20] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:39:20] ✅    ✅ Patient identified: Joan Marion
[15:39:20] ✅    ✅ Patient name validation passed
[15:39:20] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:20] [DOC: 9224407] ℹ️  DOB normalized: 01/04/1955
[15:39:20] [DOC: 9224407] ℹ️  Episode startOfCare normalized: 03/25/2025
[15:39:20] [DOC: 9224407] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:39:20] [DOC: 9224407] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:39:20] [DOC: 9224407] ✅ Patient date processing completed successfully
[15:39:20] ✅    ✅ Date processing completed
[15:39:20] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:39:20] 🔄 
🔄 Step 4: Extracting order data...
[15:39:22] ℹ️  Order extraction - MRN: ''
[15:39:22] ℹ️  Order extraction - Sex: 'FEMALE'
[15:39:22] ℹ️  Order extraction - Service Line: 'RN'
[15:39:22] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[15:39:22] ✅ Order data extraction completed successfully
[15:39:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:22] ℹ️  Using MRN from patient data: '6046015'
[15:39:22] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[15:39:22] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[15:39:22] ✅ Patient name cross-validation successful
[15:39:22] ✅    ✅ Data merged successfully
[15:39:23] ✅    ✅ Order data extracted and validated
[15:39:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:39:42] [DOC: 9224407] ℹ️  Patient not found in cache or API: Joan Marion
[15:39:42] [DOC: 9224407] ℹ️  Patient not found, creating new patient via API...
[15:39:42] [DOC: 9224407] ℹ️  Creating patient via API: Joan Marion
[15:39:44] [DOC: 9224407] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:39:44] ❌    ❌ Failed to create patient
[15:39:44] [DOC: 9224407] ℹ️  API push details saved for document 9224407
================================================================================
║                        Processing Document ID: 9224406                         ║
================================================================================
[15:39:44] ℹ️  Agency: Dartmouth HH
[15:39:44] ℹ️  Date: 04/07/2025
[15:39:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:47] [DOC: 9224406] ✅ Text extracted using pdfplumber (21010 chars)
[15:39:47] ✅    ✅ Text extracted using pdfplumber (21010 chars)
[15:39:47] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:50] ℹ️  AI extracted raw sex value: 'F'
[15:39:50] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[15:39:50] ℹ️  AI extracted payer source: 'None'
[15:39:50] ℹ️  AI extracted diagnoses:
[15:39:50] ℹ️    - Diagnosis 1: 'Z47.1'
[15:39:50] ℹ️    - Diagnosis 2: 'Z96.642'
[15:39:50] ℹ️    - Diagnosis 3: 'M06.9'
[15:39:50] ℹ️    - Diagnosis 4: 'M79.7'
[15:39:50] ℹ️    - Diagnosis 5: 'G89.29'
[15:39:50] ℹ️    - Diagnosis 6: 'M47.896'
[15:39:50] ℹ️  Final extracted MRN: '6046015'
[15:39:50] ℹ️  Final extracted Sex: 'FEMALE'
[15:39:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[15:39:50] ℹ️  Final extracted Payer Source: ''
[15:39:50] ✅ Patient data extraction completed successfully
[15:39:50] ✅    ✅ Patient data extracted successfully
[15:39:50] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Julie Community Nurse Inc
     └─ npi: 100010318804
     └─ physicianNPI: 
     └─ nameOfAgency: Julie Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.642', 'thirdDiagnosis': 'M06.9', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M47.896'}]
[15:39:50] ✅    ✅ Patient identified: Joan Marion
[15:39:50] ✅    ✅ Patient name validation passed
[15:39:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:50] [DOC: 9224406] ℹ️  DOB normalized: 01/04/1955
[15:39:50] [DOC: 9224406] ℹ️  Episode startOfCare normalized: 03/25/2025
[15:39:50] [DOC: 9224406] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:39:50] [DOC: 9224406] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:39:50] [DOC: 9224406] ✅ Patient date processing completed successfully
[15:39:50] ✅    ✅ Date processing completed
[15:39:50] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Julie Community Nurse Inc
     └─ npi: 100010318804
     └─ physicianNPI: 
     └─ nameOfAgency: Julie Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.642', 'thirdDiagnosis': 'M06.9', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M47.896'}]
[15:39:50] 🔄 
🔄 Step 4: Extracting order data...
[15:39:53] ℹ️  Order extraction - MRN: '6046015'
[15:39:53] ℹ️  Order extraction - Sex: 'FEMALE'
[15:39:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[15:39:53] ℹ️  Order extraction - Payer Source: ''
[15:39:53] ✅ Order data extraction completed successfully
[15:39:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:53] ℹ️  Using MRN from patient data: '6046015' over '6046015'
[15:39:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[15:39:53] ✅ Patient name cross-validation successful
[15:39:53] ✅    ✅ Data merged successfully
[15:39:54] ✅    ✅ Order data extracted and validated
[15:39:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:02] [DOC: 9224406] ℹ️  Patient not found in cache or API: Joan Marion
[15:40:02] [DOC: 9224406] ℹ️  Patient not found, creating new patient via API...
[15:40:02] [DOC: 9224406] ℹ️  Creating patient via API: Joan Marion
[15:40:03] [DOC: 9224406] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:40:03] ❌    ❌ Failed to create patient
[15:40:03] [DOC: 9224406] ℹ️  API push details saved for document 9224406
================================================================================
║                        Processing Document ID: 9224404                         ║
================================================================================
[15:40:03] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[15:40:03] ℹ️  Date: 04/07/2025
[15:40:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:06] [DOC: 9224404] ✅ Text extracted using pdfplumber (23041 chars)
[15:40:06] ✅    ✅ Text extracted using pdfplumber (23041 chars)
[15:40:06] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:10] ℹ️  AI extracted raw sex value: 'M'
[15:40:10] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:10] ℹ️  AI extracted payer source: 'Medicare'
[15:40:10] ℹ️  AI extracted diagnoses:
[15:40:10] ℹ️    - Diagnosis 1: 'J44.1'
[15:40:10] ℹ️    - Diagnosis 2: 'U07.1'
[15:40:10] ℹ️    - Diagnosis 3: 'J12.82'
[15:40:10] ℹ️    - Diagnosis 4: 'J44.0'
[15:40:10] ℹ️    - Diagnosis 5: 'J45.901'
[15:40:10] ℹ️    - Diagnosis 6: 'J96.01'
[15:40:10] ℹ️  Final extracted MRN: '28700194813801'
[15:40:10] ℹ️  Final extracted Sex: 'MALE'
[15:40:10] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:10] ℹ️  Final extracted Payer Source: 'Medicare'
[15:40:10] ✅ Patient data extraction completed successfully
[15:40:10] ✅    ✅ Patient data extracted successfully
[15:40:10] 📊 Patient Response
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 21 BONNEY ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740-
     └─ email: None
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'J12.82', 'fourthDiagnosis': 'J44.0', 'fifthDiagnosis': 'J45.901', 'sixthDiagnosis': 'J96.01'}]
[15:40:10] ✅    ✅ Patient identified: MANUEL DEMELLO
[15:40:10] ✅    ✅ Patient name validation passed
[15:40:10] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:10] [DOC: 9224404] ℹ️  DOB normalized: 03/22/1945
[15:40:10] [DOC: 9224404] ℹ️  Episode startOfCare normalized: 03/24/2025
[15:40:10] [DOC: 9224404] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[15:40:10] [DOC: 9224404] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[15:40:10] [DOC: 9224404] ✅ Patient date processing completed successfully
[15:40:10] ✅    ✅ Date processing completed
[15:40:10] 📊 Processed Patient Data
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 21 BONNEY ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740-
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'J12.82', 'fourthDiagnosis': 'J44.0', 'fifthDiagnosis': 'J45.901', 'sixthDiagnosis': 'J96.01'}]
[15:40:10] 🔄 
🔄 Step 4: Extracting order data...
[15:40:13] ℹ️  Order extraction - MRN: '28700194813801'
[15:40:13] ℹ️  Order extraction - Sex: 'MALE'
[15:40:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:40:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:40:13] ✅ Order data extraction completed successfully
[15:40:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:13] ℹ️  Using MRN from patient data: '28700194813801' over '28700194813801'
[15:40:13] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[15:40:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:40:13] ✅ Patient name cross-validation successful
[15:40:13] ✅    ✅ Data merged successfully
[15:40:14] ✅    ✅ Order data extracted and validated
[15:40:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:14] [DOC: 9224404] ✅ Patient found in local cache: MANUEL DEMELLO, ID: 54784569-a65e-445e-be68-20a38f0b9a63
[15:40:14] ✅    ✅ Existing patient found with ID: 54784569-a65e-445e-be68-20a38f0b9a63
[15:40:14] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:14] [DOC: 9224404] ℹ️  Pushing order via API for patient ID: 54784569-a65e-445e-be68-20a38f0b9a63
[15:40:16] [DOC: 9224404] ❌ Order push failed with status 201: {"id":"1e4773a9-6941-4b75-84ce-ca79a8384cc9","orderWAVId":"ORD20059","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 12296117","orderDate":"03/24/2025","startOfCare":"03/24/2025","episodeStartDate":"03/24/2025","episodeEndDate":"05/22/2025","documentID":"9224404","mrn":"28700194813801","patientName":"MANUEL DEMELLO","sentToPhysicianDate":"04/07/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/24/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"54784569-a65e-445e-be68-20a38f0b9a63","companyId":"532ae690-17f2-4fb0-b9ec-e3ef8634f57d","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:40:16] ❌    ❌ Failed to push order
[15:40:16] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:16] [DOC: 9224404] ℹ️  Calculated age: 80 from DOB: 03/22/1945
[15:40:16] [DOC: 9224404] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[15:40:16] [DOC: 9224404] ℹ️  Payer Source extracted: 'Medicare'
[15:40:16] [DOC: 9224404] ℹ️  Diagnosis codes being written:
[15:40:16] [DOC: 9224404] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:40:16] [DOC: 9224404] ℹ️    - Latest_Episode_Seconddiagnosis: 'U07.1'
[15:40:16] [DOC: 9224404] ℹ️    - Latest_Episode_Thirddiagnosis: 'J12.82'
[15:40:16] [DOC: 9224404] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.0'
[15:40:16] [DOC: 9224404] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J45.901'
[15:40:16] [DOC: 9224404] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J96.01'
[15:40:16] [DOC: 9224404] ✅ Patient data written to CSV: MANUEL DEMELLO | Sex: MALE | Age: 80 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer: Medicare | MRN: 28700194813801
[15:40:16] ✅    ✅ Document 9224404 processed and saved successfully
[15:40:16] 🔄 
🔄 Step 8: Saving API details...
[15:40:16] [DOC: 9224404] ℹ️  API push details saved for document 9224404
[15:40:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224403                         ║
================================================================================
[15:40:16] ℹ️  Agency: Dartmouth HH
[15:40:16] ℹ️  Date: 04/07/2025
[15:40:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:22] [DOC: 9224403] ✅ Text extracted using pdfplumber (1297 chars)
[15:40:22] ✅    ✅ Text extracted using pdfplumber (1297 chars)
[15:40:22] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:25] ℹ️  AI extracted raw sex value: 'F'
[15:40:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:40:25] ℹ️  AI extracted payer source: 'Medicare'
[15:40:25] ℹ️  AI extracted diagnoses:
[15:40:25] ℹ️    - Diagnosis 1: ''
[15:40:25] ℹ️    - Diagnosis 2: ''
[15:40:25] ℹ️    - Diagnosis 3: ''
[15:40:25] ℹ️    - Diagnosis 4: ''
[15:40:25] ℹ️    - Diagnosis 5: ''
[15:40:25] ℹ️    - Diagnosis 6: ''
[15:40:25] ℹ️  Final extracted MRN: '919015'
[15:40:25] ℹ️  Final extracted Sex: 'FEMALE'
[15:40:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:40:25] ℹ️  Final extracted Payer Source: 'Medicare'
[15:40:25] ✅ Patient data extraction completed successfully
[15:40:25] ✅    ✅ Patient data extracted successfully
[15:40:25] 📊 Patient Response
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:40:25] ✅    ✅ Patient identified: Julieta Pereira
[15:40:25] ✅    ✅ Patient name validation passed
[15:40:25] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:25] [DOC: 9224403] ℹ️  DOB normalized: 03/23/1941
[15:40:25] [DOC: 9224403] ℹ️  Episode startOfCare normalized: 11/26/2024
[15:40:25] [DOC: 9224403] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[15:40:25] [DOC: 9224403] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[15:40:25] [DOC: 9224403] ✅ Patient date processing completed successfully
[15:40:25] ✅    ✅ Date processing completed
[15:40:25] 📊 Processed Patient Data
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:40:25] 🔄 
🔄 Step 4: Extracting order data...
[15:40:27] ℹ️  Order extraction - MRN: '919015'
[15:40:27] ℹ️  Order extraction - Sex: 'FEMALE'
[15:40:27] ℹ️  Order extraction - Service Line: 'RN, LPN'
[15:40:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:40:27] ✅ Order data extraction completed successfully
[15:40:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:27] ℹ️  Using MRN from patient data: '919015' over '919015'
[15:40:27] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN, LPN' = 'LPN, RN, Skilled Nursing'
[15:40:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:40:27] ✅ Patient name cross-validation successful
[15:40:27] ✅    ✅ Data merged successfully
[15:40:28] ✅    ✅ Order data extracted and validated
[15:40:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:28] [DOC: 9224403] ✅ Patient found in local cache: Julieta Pereira, ID: c2e7114d-362f-4392-9923-06c73f2eab17
[15:40:28] ✅    ✅ Existing patient found with ID: c2e7114d-362f-4392-9923-06c73f2eab17
[15:40:28] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:28] [DOC: 9224403] ℹ️  Pushing order via API for patient ID: c2e7114d-362f-4392-9923-06c73f2eab17
[15:40:29] [DOC: 9224403] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:40:29] ❌    ❌ Failed to push order
[15:40:29] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:29] [DOC: 9224403] ℹ️  Calculated age: 84 from DOB: 03/23/1941
[15:40:29] [DOC: 9224403] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing'
[15:40:29] [DOC: 9224403] ℹ️  Payer Source extracted: 'Medicare'
[15:40:29] [DOC: 9224403] ℹ️  Diagnosis codes being written:
[15:40:29] [DOC: 9224403] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:40:29] [DOC: 9224403] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:40:29] [DOC: 9224403] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:40:29] [DOC: 9224403] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:40:29] [DOC: 9224403] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:40:29] [DOC: 9224403] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:40:29] [DOC: 9224403] ✅ Patient data written to CSV: Julieta Pereira | Sex: FEMALE | Age: 84 | Service: LPN, RN, Skilled Nursing | Payer: Medicare | MRN: 919015
[15:40:29] ✅    ✅ Document 9224403 processed and saved successfully
[15:40:29] 🔄 
🔄 Step 8: Saving API details...
[15:40:29] [DOC: 9224403] ℹ️  API push details saved for document 9224403
[15:40:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224401                         ║
================================================================================
[15:40:29] ℹ️  Agency: Dartmouth HH
[15:40:29] ℹ️  Date: 04/07/2025
[15:40:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:32] [DOC: 9224401] ✅ Text extracted using pdfplumber (12104 chars)
[15:40:32] ✅    ✅ Text extracted using pdfplumber (12092 chars)
[15:40:32] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:35] ℹ️  AI extracted raw sex value: 'M'
[15:40:35] ℹ️  AI extracted service line: 'PT'
[15:40:35] ℹ️  AI extracted payer source: ''
[15:40:35] ℹ️  AI extracted diagnoses:
[15:40:35] ℹ️    - Diagnosis 1: 'Z47.1'
[15:40:35] ℹ️    - Diagnosis 2: 'M19.90'
[15:40:35] ℹ️    - Diagnosis 3: 'E66.3'
[15:40:35] ℹ️    - Diagnosis 4: 'Z68.29'
[15:40:35] ℹ️    - Diagnosis 5: 'I12.9'
[15:40:35] ℹ️    - Diagnosis 6: 'N18.2'
[15:40:35] ℹ️  Final extracted MRN: '1775015'
[15:40:35] ℹ️  Final extracted Sex: 'MALE'
[15:40:35] ℹ️  Final extracted Service Line: 'PT'
[15:40:35] ℹ️  Final extracted Payer Source: ''
[15:40:35] ✅ Patient data extraction completed successfully
[15:40:35] ✅    ✅ Patient data extracted successfully
[15:40:35] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Cote
     └─ dob: 01/24/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1775015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M19.90', 'thirdDiagnosis': 'E66.3', 'fourthDiagnosis': 'Z68.29', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.2'}]
[15:40:35] ✅    ✅ Patient identified: Paul Cote
[15:40:35] ✅    ✅ Patient name validation passed
[15:40:35] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:35] [DOC: 9224401] ℹ️  DOB normalized: 01/24/1935
[15:40:35] [DOC: 9224401] ℹ️  Episode startOfCare normalized: 04/03/2025
[15:40:35] [DOC: 9224401] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[15:40:35] [DOC: 9224401] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[15:40:35] [DOC: 9224401] ✅ Patient date processing completed successfully
[15:40:35] ✅    ✅ Date processing completed
[15:40:35] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Cote
     └─ dob: 01/24/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1775015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M19.90', 'thirdDiagnosis': 'E66.3', 'fourthDiagnosis': 'Z68.29', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.2'}]
[15:40:35] 🔄 
🔄 Step 4: Extracting order data...
[15:40:38] ℹ️  Order extraction - MRN: '1775015'
[15:40:38] ℹ️  Order extraction - Sex: 'MALE'
[15:40:38] ℹ️  Order extraction - Service Line: 'PT'
[15:40:38] ℹ️  Order extraction - Payer Source: ''
[15:40:38] ✅ Order data extraction completed successfully
[15:40:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:38] ℹ️  Using MRN from patient data: '1775015' over '1775015'
[15:40:38] ℹ️  Service line consistent in both sources: 'PT'
[15:40:38] ✅ Patient name cross-validation successful
[15:40:38] ✅    ✅ Data merged successfully
[15:40:39] ✅    ✅ Order data extracted and validated
[15:40:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:39] [DOC: 9224401] ✅ Patient found in local cache: Paul Cote, ID: 79769d1b-a5bb-4355-bb8f-c1df91dbcc27
[15:40:39] ✅    ✅ Existing patient found with ID: 79769d1b-a5bb-4355-bb8f-c1df91dbcc27
[15:40:39] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:39] [DOC: 9224401] ℹ️  Pushing order via API for patient ID: 79769d1b-a5bb-4355-bb8f-c1df91dbcc27
[15:40:40] [DOC: 9224401] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:40:40] ❌    ❌ Failed to push order
[15:40:40] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:40] [DOC: 9224401] ℹ️  Calculated age: 90 from DOB: 01/24/1935
[15:40:40] [DOC: 9224401] ℹ️  Service Line extracted: 'PT'
[15:40:40] [DOC: 9224401] ℹ️  Payer Source extracted: ''
[15:40:40] [DOC: 9224401] ℹ️  Diagnosis codes being written:
[15:40:40] [DOC: 9224401] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[15:40:40] [DOC: 9224401] ℹ️    - Latest_Episode_Seconddiagnosis: 'M19.90'
[15:40:40] [DOC: 9224401] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.3'
[15:40:40] [DOC: 9224401] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z68.29'
[15:40:40] [DOC: 9224401] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[15:40:40] [DOC: 9224401] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.2'
[15:40:40] [DOC: 9224401] ✅ Patient data written to CSV: Paul Cote | Sex: MALE | Age: 90 | Service: PT | Payer:  | MRN: 1775015
[15:40:40] ✅    ✅ Document 9224401 processed and saved successfully
[15:40:40] 🔄 
🔄 Step 8: Saving API details...
[15:40:40] [DOC: 9224401] ℹ️  API push details saved for document 9224401
[15:40:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224396                         ║
================================================================================
[15:40:40] ℹ️  Agency: Dartmouth HH
[15:40:40] ℹ️  Date: 04/07/2025
[15:40:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:44] [DOC: 9224396] ✅ Text extracted using pdfplumber (18819 chars)
[15:40:44] ✅    ✅ Text extracted using pdfplumber (18819 chars)
[15:40:44] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:47] ℹ️  AI extracted raw sex value: 'F'
[15:40:47] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:40:47] ℹ️  AI extracted payer source: ''
[15:40:47] ℹ️  AI extracted diagnoses:
[15:40:47] ℹ️    - Diagnosis 1: 'Z48.812'
[15:40:47] ℹ️    - Diagnosis 2: 'I45.10'
[15:40:47] ℹ️    - Diagnosis 3: 'I25.10'
[15:40:47] ℹ️    - Diagnosis 4: 'R06.00'
[15:40:47] ℹ️    - Diagnosis 5: 'M12.511'
[15:40:47] ℹ️    - Diagnosis 6: 'E11.9'
[15:40:47] ℹ️  Final extracted MRN: '6435011'
[15:40:47] ℹ️  Final extracted Sex: 'FEMALE'
[15:40:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:40:47] ℹ️  Final extracted Payer Source: ''
[15:40:47] ✅ Patient data extraction completed successfully
[15:40:47] ✅    ✅ Patient data extracted successfully
[15:40:47] 📊 Patient Response
     └─ patientFName: Alma
     └─ patientLName: Fernandes
     └─ dob: 02/26/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6435011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I45.10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'R06.00', 'fifthDiagnosis': 'M12.511', 'sixthDiagnosis': 'E11.9'}]
[15:40:47] ✅    ✅ Patient identified: Alma Fernandes
[15:40:47] ✅    ✅ Patient name validation passed
[15:40:47] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:47] [DOC: 9224396] ℹ️  DOB normalized: 02/26/1936
[15:40:47] [DOC: 9224396] ℹ️  Episode startOfCare normalized: 03/17/2025
[15:40:47] [DOC: 9224396] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:40:47] [DOC: 9224396] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:40:47] [DOC: 9224396] ✅ Patient date processing completed successfully
[15:40:47] ✅    ✅ Date processing completed
[15:40:47] 📊 Processed Patient Data
     └─ patientFName: Alma
     └─ patientLName: Fernandes
     └─ dob: 02/26/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6435011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I45.10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'R06.00', 'fifthDiagnosis': 'M12.511', 'sixthDiagnosis': 'E11.9'}]
[15:40:47] 🔄 
🔄 Step 4: Extracting order data...
[15:40:50] ℹ️  Order extraction - MRN: '6435011'
[15:40:50] ℹ️  Order extraction - Sex: 'FEMALE'
[15:40:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:40:50] ℹ️  Order extraction - Payer Source: ''
[15:40:50] ✅ Order data extraction completed successfully
[15:40:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:50] ℹ️  Using MRN from patient data: '6435011' over '6435011'
[15:40:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:40:50] ✅ Patient name cross-validation successful
[15:40:50] ✅    ✅ Data merged successfully
[15:40:51] ✅    ✅ Order data extracted and validated
[15:40:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:58] [DOC: 9224396] ℹ️  Patient not found in cache or API: Alma Fernandes
[15:40:58] [DOC: 9224396] ℹ️  Patient not found, creating new patient via API...
[15:40:58] [DOC: 9224396] ℹ️  Creating patient via API: Alma Fernandes
[15:40:59] [DOC: 9224396] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:40:59] ❌    ❌ Failed to create patient
[15:40:59] [DOC: 9224396] ℹ️  API push details saved for document 9224396
================================================================================
║                        Processing Document ID: 9224394                         ║
================================================================================
[15:40:59] ℹ️  Agency: Dartmouth HH
[15:40:59] ℹ️  Date: 04/07/2025
[15:40:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:01] [DOC: 9224394] ✅ Text extracted using pdfplumber (4294 chars)
[15:41:01] ✅    ✅ Text extracted using pdfplumber (4294 chars)
[15:41:01] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:04] ℹ️  AI extracted raw sex value: 'M'
[15:41:04] ℹ️  AI extracted service line: 'Skilled Nursing, OT'
[15:41:04] ℹ️  AI extracted payer source: 'United Health Care'
[15:41:04] ℹ️  AI extracted diagnoses:
[15:41:04] ℹ️    - Diagnosis 1: ''
[15:41:04] ℹ️    - Diagnosis 2: ''
[15:41:04] ℹ️    - Diagnosis 3: ''
[15:41:04] ℹ️    - Diagnosis 4: ''
[15:41:04] ℹ️    - Diagnosis 5: ''
[15:41:04] ℹ️    - Diagnosis 6: ''
[15:41:04] ℹ️  Final extracted MRN: '7046009'
[15:41:04] ℹ️  Final extracted Sex: 'MALE'
[15:41:04] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT'
[15:41:04] ℹ️  Final extracted Payer Source: 'United Health Care'
[15:41:04] ✅ Patient data extraction completed successfully
[15:41:04] ✅    ✅ Patient data extracted successfully
[15:41:04] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:04] ✅    ✅ Patient identified: Julio Demelo
[15:41:04] ✅    ✅ Patient name validation passed
[15:41:04] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:04] [DOC: 9224394] ℹ️  DOB normalized: 02/23/1950
[15:41:04] [DOC: 9224394] ℹ️  Episode startOfCare normalized: 10/31/2024
[15:41:04] [DOC: 9224394] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:41:04] [DOC: 9224394] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:41:04] [DOC: 9224394] ✅ Patient date processing completed successfully
[15:41:04] ✅    ✅ Date processing completed
[15:41:04] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:04] 🔄 
🔄 Step 4: Extracting order data...
[15:41:06] ℹ️  Order extraction - MRN: '7046009'
[15:41:06] ℹ️  Order extraction - Sex: 'MALE'
[15:41:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing, OT'
[15:41:06] ℹ️  Order extraction - Payer Source: 'United Health Care'
[15:41:06] ✅ Order data extraction completed successfully
[15:41:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:06] ℹ️  Using MRN from patient data: '7046009' over '7046009'
[15:41:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing, OT'
[15:41:06] ℹ️  Payer source consistent in both sources: 'United Health Care'
[15:41:06] ✅ Patient name cross-validation successful
[15:41:06] ✅    ✅ Data merged successfully
[15:41:08] ✅    ✅ Order data extracted and validated
[15:41:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:41:14] [DOC: 9224394] ℹ️  Patient not found in cache or API: Julio Demelo
[15:41:14] [DOC: 9224394] ℹ️  Patient not found, creating new patient via API...
[15:41:14] [DOC: 9224394] ℹ️  Creating patient via API: Julio Demelo
[15:41:15] [DOC: 9224394] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:41:15] ❌    ❌ Failed to create patient
[15:41:15] [DOC: 9224394] ℹ️  API push details saved for document 9224394
================================================================================
║                        Processing Document ID: 9224393                         ║
================================================================================
[15:41:15] ℹ️  Agency: Dartmouth HH
[15:41:15] ℹ️  Date: 04/07/2025
[15:41:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:18] [DOC: 9224393] ✅ Text extracted using pdfplumber (12666 chars)
[15:41:18] ✅    ✅ Text extracted using pdfplumber (12654 chars)
[15:41:18] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:21] ℹ️  AI extracted raw sex value: 'F'
[15:41:21] ℹ️  AI extracted service line: 'PT'
[15:41:21] ℹ️  AI extracted payer source: 'None'
[15:41:21] ℹ️  AI extracted diagnoses:
[15:41:21] ℹ️    - Diagnosis 1: 'M17.0'
[15:41:21] ℹ️    - Diagnosis 2: 'I12.9'
[15:41:21] ℹ️    - Diagnosis 3: 'E11.22'
[15:41:21] ℹ️    - Diagnosis 4: 'N18.30'
[15:41:21] ℹ️    - Diagnosis 5: 'E11.65'
[15:41:21] ℹ️    - Diagnosis 6: 'R25.2'
[15:41:21] ℹ️  Final extracted MRN: '4009015'
[15:41:21] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:21] ℹ️  Final extracted Service Line: 'PT'
[15:41:21] ℹ️  Final extracted Payer Source: ''
[15:41:21] ✅ Patient data extraction completed successfully
[15:41:21] ✅    ✅ Patient data extracted successfully
[15:41:21] 📊 Patient Response
     └─ patientFName: Rosa
     └─ patientLName: Batista
     └─ dob: 08/18/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4009015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'M17.0', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'R25.2'}]
[15:41:21] ✅    ✅ Patient identified: Rosa Batista
[15:41:21] ✅    ✅ Patient name validation passed
[15:41:21] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:21] [DOC: 9224393] ℹ️  DOB normalized: 08/18/1942
[15:41:21] [DOC: 9224393] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[15:41:21] [DOC: 9224393] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[15:41:21] [DOC: 9224393] ✅ Patient date processing completed successfully
[15:41:21] ✅    ✅ Date processing completed
[15:41:21] 📊 Processed Patient Data
     └─ patientFName: Rosa
     └─ patientLName: Batista
     └─ dob: 08/18/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4009015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'M17.0', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'R25.2'}]
[15:41:21] 🔄 
🔄 Step 4: Extracting order data...
[15:41:23] ℹ️  Order extraction - MRN: '4009015'
[15:41:23] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:23] ℹ️  Order extraction - Service Line: 'PT'
[15:41:23] ℹ️  Order extraction - Payer Source: ''
[15:41:23] ✅ Order data extraction completed successfully
[15:41:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:23] ℹ️  Using MRN from patient data: '4009015' over '4009015'
[15:41:23] ℹ️  Service line consistent in both sources: 'PT'
[15:41:23] ✅ Patient name cross-validation successful
[15:41:23] ✅    ✅ Data merged successfully
[15:41:25] ✅    ✅ Order data extracted and validated
[15:41:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:41:30] [DOC: 9224393] ℹ️  Patient not found in cache or API: Rosa Batista
[15:41:30] [DOC: 9224393] ℹ️  Patient not found, creating new patient via API...
[15:41:30] [DOC: 9224393] ℹ️  Creating patient via API: Rosa Batista
[15:41:32] [DOC: 9224393] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:41:32] ❌    ❌ Failed to create patient
[15:41:32] [DOC: 9224393] ℹ️  API push details saved for document 9224393
================================================================================
║                        Processing Document ID: 9224345                         ║
================================================================================
[15:41:32] ℹ️  Agency: Visiting Rehab & Nursing Services
[15:41:32] ℹ️  Date: 04/07/2025
[15:41:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:34] [DOC: 9224345] ✅ Text extracted using pdfplumber (5111 chars)
[15:41:34] ✅    ✅ Text extracted using pdfplumber (5111 chars)
[15:41:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:36] ℹ️  AI extracted raw sex value: 'None'
[15:41:36] ℹ️  AI extracted service line: 'None'
[15:41:36] ℹ️  AI extracted payer source: 'None'
[15:41:36] ℹ️  AI extracted diagnoses:
[15:41:36] ℹ️    - Diagnosis 1: ''
[15:41:36] ℹ️    - Diagnosis 2: ''
[15:41:36] ℹ️    - Diagnosis 3: ''
[15:41:36] ℹ️    - Diagnosis 4: ''
[15:41:36] ℹ️    - Diagnosis 5: ''
[15:41:36] ℹ️    - Diagnosis 6: ''
[15:41:36] ℹ️  Final extracted MRN: ''
[15:41:36] ℹ️  Final extracted Sex: ''
[15:41:36] ℹ️  Final extracted Service Line: ''
[15:41:36] ℹ️  Final extracted Payer Source: ''
[15:41:36] ✅ Patient data extraction completed successfully
[15:41:36] ✅    ✅ Patient data extracted successfully
[15:41:36] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[15:41:36] ⚠️     ❌ Insufficient patient data extracted
[15:41:36] [DOC: 9224345] ℹ️  API push details saved for document 9224345
================================================================================
║                        Processing Document ID: 9223469                         ║
================================================================================
[15:41:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:41:36] ℹ️  Date: 04/04/2025
[15:41:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:37] [DOC: 9223469] ✅ Text extracted using pdfplumber (1323 chars)
[15:41:37] ✅    ✅ Text extracted using pdfplumber (1323 chars)
[15:41:37] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:39] ℹ️  AI extracted raw sex value: 'F'
[15:41:39] ℹ️  AI extracted service line: 'Nursing, PT'
[15:41:39] ℹ️  AI extracted payer source: ''
[15:41:39] ℹ️  AI extracted diagnoses:
[15:41:39] ℹ️    - Diagnosis 1: 'None'
[15:41:39] ℹ️    - Diagnosis 2: 'None'
[15:41:39] ℹ️    - Diagnosis 3: 'None'
[15:41:39] ℹ️    - Diagnosis 4: 'None'
[15:41:39] ℹ️    - Diagnosis 5: 'None'
[15:41:39] ℹ️    - Diagnosis 6: 'None'
[15:41:39] ℹ️  Final extracted MRN: '2936720'
[15:41:39] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:39] ℹ️  Final extracted Service Line: 'Nursing, PT'
[15:41:39] ℹ️  Final extracted Payer Source: ''
[15:41:39] ✅ Patient data extraction completed successfully
[15:41:39] ✅    ✅ Patient data extracted successfully
[15:41:39] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:41:39] ✅    ✅ Patient identified: Stella Saint
[15:41:39] ✅    ✅ Patient name validation passed
[15:41:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:39] [DOC: 9223469] ℹ️  DOB normalized: 07/02/1928
[15:41:39] [DOC: 9223469] ✅ Patient date processing completed successfully
[15:41:39] ✅    ✅ Date processing completed
[15:41:39] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:41:39] 🔄 
🔄 Step 4: Extracting order data...
[15:41:42] ℹ️  Order extraction - MRN: '2936720'
[15:41:42] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:42] ℹ️  Order extraction - Service Line: ''
[15:41:42] ℹ️  Order extraction - Payer Source: ''
[15:41:42] ✅ Order data extraction completed successfully
[15:41:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:42] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[15:41:42] ℹ️  Using service line from patient data: 'Nursing, PT'
[15:41:42] ✅ Patient name cross-validation successful
[15:41:42] ✅    ✅ Data merged successfully
[15:41:43] ✅    ✅ Order data extracted and validated
[15:41:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:41:43] [DOC: 9223469] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[15:41:43] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[15:41:43] 🔄 
🔄 Step 6: Pushing order to API...
[15:41:43] [DOC: 9223469] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[15:41:45] [DOC: 9223469] ❌ Order push failed with status 201: {"id":"f59c28df-3ec5-4c87-9de8-54203026e51c","orderWAVId":"ORD20060","orderNo":"1078536, 1078325","orderDate":"04/03/2025","startOfCare":"04/03/2025","episodeStartDate":"04/03/2025","episodeEndDate":"04/07/2025","documentID":"9223469","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"04/04/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:41:45] ❌    ❌ Failed to push order
[15:41:45] 🔄 
🔄 Step 7: Writing to CSV...
[15:41:45] [DOC: 9223469] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[15:41:45] [DOC: 9223469] ℹ️  Service Line extracted: 'Nursing, PT'
[15:41:45] [DOC: 9223469] ℹ️  Payer Source extracted: ''
[15:41:45] [DOC: 9223469] ℹ️  Diagnosis codes being written:
[15:41:45] [DOC: 9223469] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:41:45] [DOC: 9223469] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:41:45] [DOC: 9223469] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:41:45] [DOC: 9223469] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:41:45] [DOC: 9223469] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:41:45] [DOC: 9223469] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:41:45] [DOC: 9223469] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Nursing, PT | Payer:  | MRN: 2936720
[15:41:45] ✅    ✅ Document 9223469 processed and saved successfully
[15:41:45] 🔄 
🔄 Step 8: Saving API details...
[15:41:45] [DOC: 9223469] ℹ️  API push details saved for document 9223469
[15:41:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223466                         ║
================================================================================
[15:41:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:41:45] ℹ️  Date: 04/04/2025
[15:41:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:48] [DOC: 9223466] ✅ Text extracted using pdfplumber (15985 chars)
[15:41:48] ✅    ✅ Text extracted using pdfplumber (15975 chars)
[15:41:48] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:51] ℹ️  AI extracted raw sex value: 'Female'
[15:41:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:41:51] ℹ️  AI extracted payer source: ''
[15:41:51] ℹ️  AI extracted diagnoses:
[15:41:51] ℹ️    - Diagnosis 1: 'I21.11'
[15:41:51] ℹ️    - Diagnosis 2: 'Z95.5'
[15:41:51] ℹ️    - Diagnosis 3: 'I25.10'
[15:41:51] ℹ️    - Diagnosis 4: 'I48.91'
[15:41:51] ℹ️    - Diagnosis 5: 'I10'
[15:41:51] ℹ️    - Diagnosis 6: 'E78.5'
[15:41:51] ℹ️  Final extracted MRN: '2901289'
[15:41:51] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:41:51] ℹ️  Final extracted Payer Source: ''
[15:41:51] ✅ Patient data extraction completed successfully
[15:41:51] ✅    ✅ Patient data extracted successfully
[15:41:51] 📊 Patient Response
     └─ patientFName: Ann
     └─ patientLName: Richmond
     └─ dob: 01/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2901289
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I21.11', 'secondDiagnosis': 'Z95.5', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[15:41:51] ✅    ✅ Patient identified: Ann Richmond
[15:41:51] ✅    ✅ Patient name validation passed
[15:41:51] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:51] [DOC: 9223466] ℹ️  DOB normalized: 01/23/1941
[15:41:51] [DOC: 9223466] ℹ️  Episode startOfCare normalized: 03/21/2025
[15:41:51] [DOC: 9223466] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:41:51] [DOC: 9223466] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:41:51] [DOC: 9223466] ✅ Patient date processing completed successfully
[15:41:51] ✅    ✅ Date processing completed
[15:41:51] 📊 Processed Patient Data
     └─ patientFName: Ann
     └─ patientLName: Richmond
     └─ dob: 01/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2901289
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I21.11', 'secondDiagnosis': 'Z95.5', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[15:41:51] 🔄 
🔄 Step 4: Extracting order data...
[15:41:54] ℹ️  Order extraction - MRN: '2901289'
[15:41:54] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:41:54] ℹ️  Order extraction - Payer Source: ''
[15:41:54] ✅ Order data extraction completed successfully
[15:41:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:54] ℹ️  Using MRN from patient data: '2901289' over '2901289'
[15:41:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:41:54] ✅ Patient name cross-validation successful
[15:41:54] ✅    ✅ Data merged successfully
[15:41:55] ✅    ✅ Order data extracted and validated
[15:41:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:02] [DOC: 9223466] ✅ Patient exists in API: Ann Richmond, ID: e29683c5-cc1e-46c8-8c7a-e0e5da04c793
[15:42:02] ✅    ✅ Existing patient found with ID: e29683c5-cc1e-46c8-8c7a-e0e5da04c793
[15:42:02] 🔄 
🔄 Step 6: Pushing order to API...
[15:42:02] [DOC: 9223466] ℹ️  Pushing order via API for patient ID: e29683c5-cc1e-46c8-8c7a-e0e5da04c793
[15:42:03] [DOC: 9223466] ❌ Order push failed with status 201: {"id":"e64afcd5-781a-4b23-b9db-ae7fa570bdce","orderWAVId":"ORD20061","orderNo":"1078454","orderDate":"04/03/2025","startOfCare":"03/21/2025","episodeStartDate":"03/23/2025","episodeEndDate":"05/21/2025","documentID":"9223466","mrn":"2901289","patientName":"Richmond, Ann","sentToPhysicianDate":"04/04/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/11/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"e29683c5-cc1e-46c8-8c7a-e0e5da04c793","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:42:03] ❌    ❌ Failed to push order
[15:42:03] 🔄 
🔄 Step 7: Writing to CSV...
[15:42:03] [DOC: 9223466] ℹ️  Calculated age: 84 from DOB: 01/23/1941
[15:42:03] [DOC: 9223466] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:42:03] [DOC: 9223466] ℹ️  Payer Source extracted: ''
[15:42:03] [DOC: 9223466] ℹ️  Diagnosis codes being written:
[15:42:03] [DOC: 9223466] ℹ️    - Latest_Episode_Firstdiagnosis: 'I21.11'
[15:42:03] [DOC: 9223466] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z95.5'
[15:42:03] [DOC: 9223466] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[15:42:03] [DOC: 9223466] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.91'
[15:42:03] [DOC: 9223466] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:42:03] [DOC: 9223466] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[15:42:03] [DOC: 9223466] ✅ Patient data written to CSV: Ann Richmond | Sex: FEMALE | Age: 84 | Service: Skilled Nursing | Payer:  | MRN: 2901289
[15:42:03] ✅    ✅ Document 9223466 processed and saved successfully
[15:42:03] 🔄 
🔄 Step 8: Saving API details...
[15:42:03] [DOC: 9223466] ℹ️  API push details saved for document 9223466
[15:42:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223456                         ║
================================================================================
[15:42:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:42:03] ℹ️  Date: 04/04/2025
[15:42:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:07] [DOC: 9223456] ✅ Text extracted using pdfplumber (26261 chars)
[15:42:07] ✅    ✅ Text extracted using pdfplumber (26261 chars)
[15:42:07] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:11] ℹ️  AI extracted raw sex value: 'F'
[15:42:11] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work'
[15:42:11] ℹ️  AI extracted payer source: ''
[15:42:11] ℹ️  AI extracted diagnoses:
[15:42:11] ℹ️    - Diagnosis 1: 'I69.398'
[15:42:11] ℹ️    - Diagnosis 2: 'R26.89'
[15:42:11] ℹ️    - Diagnosis 3: 'I69.320'
[15:42:11] ℹ️    - Diagnosis 4: 'I48.0'
[15:42:11] ℹ️    - Diagnosis 5: 'I10'
[15:42:11] ℹ️    - Diagnosis 6: 'E78.5'
[15:42:11] ℹ️  Final extracted MRN: '2795248'
[15:42:11] ℹ️  Final extracted Sex: 'FEMALE'
[15:42:11] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work'
[15:42:11] ℹ️  Final extracted Payer Source: ''
[15:42:11] ✅ Patient data extraction completed successfully
[15:42:11] ✅    ✅ Patient data extracted successfully
[15:42:11] 📊 Patient Response
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'I69.320', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[15:42:11] ✅    ✅ Patient identified: Meryl Novek
[15:42:11] ✅    ✅ Patient name validation passed
[15:42:11] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:11] [DOC: 9223456] ℹ️  DOB normalized: 02/08/1941
[15:42:11] [DOC: 9223456] ℹ️  Episode startOfCare normalized: 03/20/2025
[15:42:11] [DOC: 9223456] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[15:42:11] [DOC: 9223456] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[15:42:11] [DOC: 9223456] ✅ Patient date processing completed successfully
[15:42:11] ✅    ✅ Date processing completed
[15:42:11] 📊 Processed Patient Data
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'I69.320', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[15:42:11] 🔄 
🔄 Step 4: Extracting order data...
[15:42:14] ℹ️  Order extraction - MRN: '2795248'
[15:42:14] ℹ️  Order extraction - Sex: 'FEMALE'
[15:42:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work'
[15:42:14] ℹ️  Order extraction - Payer Source: ''
[15:42:14] ✅ Order data extraction completed successfully
[15:42:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:14] ℹ️  Using MRN from patient data: '2795248' over '2795248'
[15:42:14] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work' = 'Medical Social Work, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[15:42:14] ✅ Patient name cross-validation successful
[15:42:14] ✅    ✅ Data merged successfully
[15:42:15] ✅    ✅ Order data extracted and validated
[15:42:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:22] [DOC: 9223456] ℹ️  Patient not found in cache or API: Meryl Novek
[15:42:22] [DOC: 9223456] ℹ️  Patient not found, creating new patient via API...
[15:42:22] [DOC: 9223456] ℹ️  Creating patient via API: Meryl Novek
[15:42:23] [DOC: 9223456] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:42:23] ❌    ❌ Failed to create patient
[15:42:23] [DOC: 9223456] ℹ️  API push details saved for document 9223456
================================================================================
║                        Processing Document ID: 9223453                         ║
================================================================================
[15:42:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:42:23] ℹ️  Date: 04/04/2025
[15:42:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:26] [DOC: 9223453] ✅ Text extracted using pdfplumber (14817 chars)
[15:42:26] ✅    ✅ Text extracted using pdfplumber (14817 chars)
[15:42:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:30] ℹ️  AI extracted raw sex value: 'Male'
[15:42:30] ℹ️  AI extracted service line: 'Physical Therapy'
[15:42:30] ℹ️  AI extracted payer source: ''
[15:42:30] ℹ️  AI extracted diagnoses:
[15:42:30] ℹ️    - Diagnosis 1: 'S06.330D'
[15:42:30] ℹ️    - Diagnosis 2: 'S30.0XXD'
[15:42:30] ℹ️    - Diagnosis 3: 'S01.81XD'
[15:42:30] ℹ️    - Diagnosis 4: 'R26.81'
[15:42:30] ℹ️    - Diagnosis 5: 'I25.10'
[15:42:30] ℹ️    - Diagnosis 6: 'I25.5'
[15:42:30] ℹ️  Final extracted MRN: '2096815'
[15:42:30] ℹ️  Final extracted Sex: 'MALE'
[15:42:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:42:30] ℹ️  Final extracted Payer Source: ''
[15:42:30] ✅ Patient data extraction completed successfully
[15:42:30] ✅    ✅ Patient data extracted successfully
[15:42:30] 📊 Patient Response
     └─ patientFName: Brian
     └─ patientLName: McMahon
     └─ dob: 03/02/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2096815
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'S06.330D', 'secondDiagnosis': 'S30.0XXD', 'thirdDiagnosis': 'S01.81XD', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I25.5'}]
[15:42:30] ✅    ✅ Patient identified: Brian McMahon
[15:42:30] ✅    ✅ Patient name validation passed
[15:42:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:30] [DOC: 9223453] ℹ️  DOB normalized: 03/02/1946
[15:42:30] [DOC: 9223453] ℹ️  Episode startOfCare normalized: 03/24/2025
[15:42:30] [DOC: 9223453] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:42:30] [DOC: 9223453] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:42:30] [DOC: 9223453] ✅ Patient date processing completed successfully
[15:42:30] ✅    ✅ Date processing completed
[15:42:30] 📊 Processed Patient Data
     └─ patientFName: Brian
     └─ patientLName: McMahon
     └─ dob: 03/02/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2096815
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'S06.330D', 'secondDiagnosis': 'S30.0XXD', 'thirdDiagnosis': 'S01.81XD', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I25.5'}]
[15:42:30] 🔄 
🔄 Step 4: Extracting order data...
[15:42:32] ℹ️  Order extraction - MRN: '2096815'
[15:42:32] ℹ️  Order extraction - Sex: 'MALE'
[15:42:32] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:42:32] ℹ️  Order extraction - Payer Source: ''
[15:42:32] ✅ Order data extraction completed successfully
[15:42:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:32] ℹ️  Using MRN from patient data: '2096815' over '2096815'
[15:42:32] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:42:32] ✅ Patient name cross-validation successful
[15:42:32] ✅    ✅ Data merged successfully
[15:42:34] ✅    ✅ Order data extracted and validated
[15:42:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:39] [DOC: 9223453] ℹ️  Patient not found in cache or API: Brian McMahon
[15:42:39] [DOC: 9223453] ℹ️  Patient not found, creating new patient via API...
[15:42:39] [DOC: 9223453] ℹ️  Creating patient via API: Brian McMahon
[15:42:40] [DOC: 9223453] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:42:40] ❌    ❌ Failed to create patient
[15:42:40] [DOC: 9223453] ℹ️  API push details saved for document 9223453
================================================================================
║                        Processing Document ID: 9223447                         ║
================================================================================
[15:42:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:42:40] ℹ️  Date: 04/04/2025
[15:42:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:42] [DOC: 9223447] ✅ Text extracted using pdfplumber (1002 chars)
[15:42:42] ✅    ✅ Text extracted using pdfplumber (1002 chars)
[15:42:42] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:45] ℹ️  AI extracted raw sex value: 'M'
[15:42:45] ℹ️  AI extracted service line: ''
[15:42:45] ℹ️  AI extracted payer source: ''
[15:42:45] ℹ️  AI extracted diagnoses:
[15:42:45] ℹ️    - Diagnosis 1: ''
[15:42:45] ℹ️    - Diagnosis 2: ''
[15:42:45] ℹ️    - Diagnosis 3: ''
[15:42:45] ℹ️    - Diagnosis 4: ''
[15:42:45] ℹ️    - Diagnosis 5: ''
[15:42:45] ℹ️    - Diagnosis 6: ''
[15:42:45] ℹ️  Final extracted MRN: '2611249'
[15:42:45] ℹ️  Final extracted Sex: 'MALE'
[15:42:45] ℹ️  Final extracted Service Line: ''
[15:42:45] ℹ️  Final extracted Payer Source: ''
[15:42:45] ✅ Patient data extraction completed successfully
[15:42:45] ✅    ✅ Patient data extracted successfully
[15:42:45] 📊 Patient Response
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:42:45] ✅    ✅ Patient identified: Kelada Sobhy
[15:42:45] ✅    ✅ Patient name validation passed
[15:42:45] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:45] [DOC: 9223447] ℹ️  DOB normalized: 10/02/1947
[15:42:45] [DOC: 9223447] ✅ Patient date processing completed successfully
[15:42:45] ✅    ✅ Date processing completed
[15:42:45] 📊 Processed Patient Data
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:42:45] 🔄 
🔄 Step 4: Extracting order data...
[15:42:47] ℹ️  Order extraction - MRN: '2611249'
[15:42:47] ℹ️  Order extraction - Sex: 'MALE'
[15:42:47] ℹ️  Order extraction - Service Line: ''
[15:42:47] ℹ️  Order extraction - Payer Source: ''
[15:42:47] ✅ Order data extraction completed successfully
[15:42:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:47] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[15:42:47] ✅ Patient name cross-validation successful
[15:42:47] ✅    ✅ Data merged successfully
[15:42:48] ⚠️     ❌ Skipping - missing episode start date
[15:42:48] [DOC: 9223447] ℹ️  API push details saved for document 9223447
================================================================================
║                        Processing Document ID: 9223446                         ║
================================================================================
[15:42:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:42:48] ℹ️  Date: 04/04/2025
[15:42:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:52] [DOC: 9223446] ✅ Text extracted using pdfplumber (30779 chars)
[15:42:52] ✅    ✅ Text extracted using pdfplumber (30779 chars)
[15:42:52] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:55] ℹ️  AI extracted raw sex value: 'M'
[15:42:55] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy'
[15:42:55] ℹ️  AI extracted payer source: ''
[15:42:55] ℹ️  AI extracted diagnoses:
[15:42:55] ℹ️    - Diagnosis 1: 'C67.9'
[15:42:55] ℹ️    - Diagnosis 2: 'C79.51'
[15:42:55] ℹ️    - Diagnosis 3: 'N13.39'
[15:42:55] ℹ️    - Diagnosis 4: 'E87.6'
[15:42:55] ℹ️    - Diagnosis 5: 'I10'
[15:42:55] ℹ️    - Diagnosis 6: 'N18.31'
[15:42:55] ℹ️  Final extracted MRN: '2532405'
[15:42:55] ℹ️  Final extracted Sex: 'MALE'
[15:42:55] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy'
[15:42:55] ℹ️  Final extracted Payer Source: ''
[15:42:55] ✅ Patient data extraction completed successfully
[15:42:55] ✅    ✅ Patient data extracted successfully
[15:42:55] 📊 Patient Response
     └─ patientFName: Rene
     └─ patientLName: Goyette
     └─ dob: 09/30/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2532405
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'N13.39', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'N18.31'}]
[15:42:55] ✅    ✅ Patient identified: Rene Goyette
[15:42:55] ✅    ✅ Patient name validation passed
[15:42:55] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:55] [DOC: 9223446] ℹ️  DOB normalized: 09/30/1933
[15:42:55] [DOC: 9223446] ℹ️  Episode startOfCare normalized: 03/28/2025
[15:42:55] [DOC: 9223446] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[15:42:55] [DOC: 9223446] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[15:42:55] [DOC: 9223446] ✅ Patient date processing completed successfully
[15:42:55] ✅    ✅ Date processing completed
[15:42:55] 📊 Processed Patient Data
     └─ patientFName: Rene
     └─ patientLName: Goyette
     └─ dob: 09/30/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2532405
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'N13.39', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'N18.31'}]
[15:42:55] 🔄 
🔄 Step 4: Extracting order data...
[15:42:58] ℹ️  Order extraction - MRN: '2532405'
[15:42:58] ℹ️  Order extraction - Sex: 'MALE'
[15:42:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Medical Social Work, Clergy'
[15:42:58] ℹ️  Order extraction - Payer Source: ''
[15:42:58] ✅ Order data extraction completed successfully
[15:42:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:58] ℹ️  Using MRN from patient data: '2532405' over '2532405'
[15:42:58] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy' + Order='Skilled Nursing, Medical Social Work, Clergy' = 'Clergy, MSW, Medical Social Work, Skilled Nursing'
[15:42:58] ✅ Patient name cross-validation successful
[15:42:58] ✅    ✅ Data merged successfully
[15:42:59] ✅    ✅ Order data extracted and validated
[15:42:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:05] [DOC: 9223446] ℹ️  Patient not found in cache or API: Rene Goyette
[15:43:05] [DOC: 9223446] ℹ️  Patient not found, creating new patient via API...
[15:43:05] [DOC: 9223446] ℹ️  Creating patient via API: Rene Goyette
[15:43:06] [DOC: 9223446] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:43:06] ❌    ❌ Failed to create patient
[15:43:06] [DOC: 9223446] ℹ️  API push details saved for document 9223446
================================================================================
║                        Processing Document ID: 9223443                         ║
================================================================================
[15:43:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:43:06] ℹ️  Date: 04/04/2025
[15:43:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:43:09] [DOC: 9223443] ✅ Text extracted using pdfplumber (14735 chars)
[15:43:09] ✅    ✅ Text extracted using pdfplumber (14735 chars)
[15:43:09] 🔄 
🔄 Step 2: Extracting patient data...
[15:43:12] ℹ️  AI extracted raw sex value: 'Female'
[15:43:12] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[15:43:12] ℹ️  AI extracted payer source: ''
[15:43:12] ℹ️  AI extracted diagnoses:
[15:43:12] ℹ️    - Diagnosis 1: 'G89.29'
[15:43:12] ℹ️    - Diagnosis 2: 'M54.50'
[15:43:12] ℹ️    - Diagnosis 3: 'I12.9'
[15:43:12] ℹ️    - Diagnosis 4: 'E11.22'
[15:43:12] ℹ️    - Diagnosis 5: 'N18.32'
[15:43:12] ℹ️    - Diagnosis 6: 'K74.69'
[15:43:12] ℹ️  Final extracted MRN: '2495449'
[15:43:12] ℹ️  Final extracted Sex: 'FEMALE'
[15:43:12] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[15:43:12] ℹ️  Final extracted Payer Source: ''
[15:43:12] ✅ Patient data extraction completed successfully
[15:43:12] ✅    ✅ Patient data extracted successfully
[15:43:12] 📊 Patient Response
     └─ patientFName: Fatima
     └─ patientLName: Furtado
     └─ dob: 08/28/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2495449
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'M54.50', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'K74.69'}]
[15:43:12] ✅    ✅ Patient identified: Fatima Furtado
[15:43:12] ✅    ✅ Patient name validation passed
[15:43:12] 🔄 
🔄 Step 3: Processing patient dates...
[15:43:12] [DOC: 9223443] ℹ️  DOB normalized: 08/28/1948
[15:43:12] [DOC: 9223443] ℹ️  Episode startOfCare normalized: 03/24/2025
[15:43:12] [DOC: 9223443] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:43:12] [DOC: 9223443] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:43:12] [DOC: 9223443] ✅ Patient date processing completed successfully
[15:43:12] ✅    ✅ Date processing completed
[15:43:12] 📊 Processed Patient Data
     └─ patientFName: Fatima
     └─ patientLName: Furtado
     └─ dob: 08/28/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2495449
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'M54.50', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'K74.69'}]
[15:43:12] 🔄 
🔄 Step 4: Extracting order data...
[15:43:15] ℹ️  Order extraction - MRN: '2495449'
[15:43:15] ℹ️  Order extraction - Sex: 'FEMALE'
[15:43:15] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[15:43:15] ℹ️  Order extraction - Payer Source: ''
[15:43:15] ✅ Order data extraction completed successfully
[15:43:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:43:15] ℹ️  Using MRN from patient data: '2495449' over '2495449'
[15:43:15] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing'
[15:43:15] ✅ Patient name cross-validation successful
[15:43:15] ✅    ✅ Data merged successfully
[15:43:16] ✅    ✅ Order data extracted and validated
[15:43:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:31] [DOC: 9223443] ✅ Patient exists in API: Fatima Furtado, ID: c86ef54c-53c2-47b1-bee8-d0e3da39f902
[15:43:31] ✅    ✅ Existing patient found with ID: c86ef54c-53c2-47b1-bee8-d0e3da39f902
[15:43:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:43:31] [DOC: 9223443] ℹ️  Pushing order via API for patient ID: c86ef54c-53c2-47b1-bee8-d0e3da39f902
[15:43:32] [DOC: 9223443] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13028"}
[15:43:32] ❌    ❌ Failed to push order
[15:43:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:43:32] [DOC: 9223443] ℹ️  Calculated age: 76 from DOB: 08/28/1948
[15:43:32] [DOC: 9223443] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[15:43:32] [DOC: 9223443] ℹ️  Payer Source extracted: ''
[15:43:32] [DOC: 9223443] ℹ️  Diagnosis codes being written:
[15:43:32] [DOC: 9223443] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.29'
[15:43:32] [DOC: 9223443] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.50'
[15:43:32] [DOC: 9223443] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[15:43:32] [DOC: 9223443] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[15:43:32] [DOC: 9223443] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.32'
[15:43:32] [DOC: 9223443] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K74.69'
[15:43:32] [DOC: 9223443] ✅ Patient data written to CSV: Fatima Furtado | Sex: FEMALE | Age: 76 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 2495449
[15:43:32] ✅    ✅ Document 9223443 processed and saved successfully
[15:43:32] 🔄 
🔄 Step 8: Saving API details...
[15:43:32] [DOC: 9223443] ℹ️  API push details saved for document 9223443
[15:43:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223436                         ║
================================================================================
[15:43:32] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:43:32] ℹ️  Date: 04/04/2025
[15:43:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:43:35] [DOC: 9223436] ✅ Text extracted using pdfplumber (18633 chars)
[15:43:35] ✅    ✅ Text extracted using pdfplumber (18633 chars)
[15:43:35] 🔄 
🔄 Step 2: Extracting patient data...
[15:43:39] ℹ️  AI extracted raw sex value: 'F'
[15:43:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:43:39] ℹ️  AI extracted payer source: ''
[15:43:39] ℹ️  AI extracted diagnoses:
[15:43:39] ℹ️    - Diagnosis 1: 'I21.4'
[15:43:39] ℹ️    - Diagnosis 2: 'I25.5'
[15:43:39] ℹ️    - Diagnosis 3: 'I11.0'
[15:43:39] ℹ️    - Diagnosis 4: 'I50.21'
[15:43:39] ℹ️    - Diagnosis 5: 'I48.0'
[15:43:39] ℹ️    - Diagnosis 6: 'M81.0'
[15:43:39] ℹ️  Final extracted MRN: '2489378'
[15:43:39] ℹ️  Final extracted Sex: 'FEMALE'
[15:43:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:43:39] ℹ️  Final extracted Payer Source: ''
[15:43:39] ✅ Patient data extraction completed successfully
[15:43:39] ✅    ✅ Patient data extracted successfully
[15:43:39] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Fredette
     └─ dob: 11/12/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2489378
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'I25.5', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.21', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'M81.0'}]
[15:43:39] ✅    ✅ Patient identified: Norma Fredette
[15:43:39] ✅    ✅ Patient name validation passed
[15:43:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:43:39] [DOC: 9223436] ℹ️  DOB normalized: 11/12/1947
[15:43:39] [DOC: 9223436] ℹ️  Episode startOfCare normalized: 03/14/2025
[15:43:39] [DOC: 9223436] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:43:39] [DOC: 9223436] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:43:39] [DOC: 9223436] ✅ Patient date processing completed successfully
[15:43:39] ✅    ✅ Date processing completed
[15:43:39] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Fredette
     └─ dob: 11/12/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2489378
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'I25.5', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.21', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'M81.0'}]
[15:43:39] 🔄 
🔄 Step 4: Extracting order data...
[15:43:42] ℹ️  Order extraction - MRN: '2489378'
[15:43:42] ℹ️  Order extraction - Sex: 'FEMALE'
[15:43:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:43:42] ℹ️  Order extraction - Payer Source: ''
[15:43:42] ✅ Order data extraction completed successfully
[15:43:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:43:42] ℹ️  Using MRN from patient data: '2489378' over '2489378'
[15:43:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:43:42] ✅ Patient name cross-validation successful
[15:43:42] ✅    ✅ Data merged successfully
[15:43:43] ✅    ✅ Order data extracted and validated
[15:43:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:43] [DOC: 9223436] ✅ Patient found in local cache: Norma Fredette, ID: 4bd0828a-689c-48a3-ac25-fe03dabda005
[15:43:43] ✅    ✅ Existing patient found with ID: 4bd0828a-689c-48a3-ac25-fe03dabda005
[15:43:43] 🔄 
🔄 Step 6: Pushing order to API...
[15:43:43] [DOC: 9223436] ℹ️  Pushing order via API for patient ID: 4bd0828a-689c-48a3-ac25-fe03dabda005
[15:43:44] [DOC: 9223436] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13027"}
[15:43:44] ❌    ❌ Failed to push order
[15:43:44] 🔄 
🔄 Step 7: Writing to CSV...
[15:43:44] [DOC: 9223436] ℹ️  Calculated age: 77 from DOB: 11/12/1947
[15:43:44] [DOC: 9223436] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:43:44] [DOC: 9223436] ℹ️  Payer Source extracted: ''
[15:43:44] [DOC: 9223436] ℹ️  Diagnosis codes being written:
[15:43:44] [DOC: 9223436] ℹ️    - Latest_Episode_Firstdiagnosis: 'I21.4'
[15:43:44] [DOC: 9223436] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.5'
[15:43:44] [DOC: 9223436] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[15:43:44] [DOC: 9223436] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.21'
[15:43:44] [DOC: 9223436] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.0'
[15:43:44] [DOC: 9223436] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M81.0'
[15:43:44] [DOC: 9223436] ✅ Patient data written to CSV: Norma Fredette | Sex: FEMALE | Age: 77 | Service: Skilled Nursing | Payer:  | MRN: 2489378
[15:43:44] ✅    ✅ Document 9223436 processed and saved successfully
[15:43:44] 🔄 
🔄 Step 8: Saving API details...
[15:43:44] [DOC: 9223436] ℹ️  API push details saved for document 9223436
[15:43:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223426                         ║
================================================================================
[15:43:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:43:44] ℹ️  Date: 04/04/2025
[15:43:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:43:46] [DOC: 9223426] ✅ Text extracted using pdfplumber (990 chars)
[15:43:46] ✅    ✅ Text extracted using pdfplumber (990 chars)
[15:43:46] 🔄 
🔄 Step 2: Extracting patient data...
[15:43:49] ℹ️  AI extracted raw sex value: 'F'
[15:43:49] ℹ️  AI extracted service line: 'Nursing'
[15:43:49] ℹ️  AI extracted payer source: ''
[15:43:49] ℹ️  AI extracted diagnoses:
[15:43:49] ℹ️    - Diagnosis 1: 'None'
[15:43:49] ℹ️    - Diagnosis 2: 'None'
[15:43:49] ℹ️    - Diagnosis 3: 'None'
[15:43:49] ℹ️    - Diagnosis 4: 'None'
[15:43:49] ℹ️    - Diagnosis 5: 'None'
[15:43:49] ℹ️    - Diagnosis 6: 'None'
[15:43:49] ℹ️  Final extracted MRN: '2467466'
[15:43:49] ℹ️  Final extracted Sex: 'FEMALE'
[15:43:49] ℹ️  Final extracted Service Line: 'Nursing'
[15:43:49] ℹ️  Final extracted Payer Source: ''
[15:43:49] ✅ Patient data extraction completed successfully
[15:43:49] ✅    ✅ Patient data extracted successfully
[15:43:49] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:43:49] ✅    ✅ Patient identified: Maria Ferreira
[15:43:49] ✅    ✅ Patient name validation passed
[15:43:49] 🔄 
🔄 Step 3: Processing patient dates...
[15:43:49] [DOC: 9223426] ℹ️  DOB normalized: 07/12/1938
[15:43:49] [DOC: 9223426] ✅ Patient date processing completed successfully
[15:43:49] ✅    ✅ Date processing completed
[15:43:49] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:43:49] 🔄 
🔄 Step 4: Extracting order data...
[15:43:51] ℹ️  Order extraction - MRN: '2467466'
[15:43:51] ℹ️  Order extraction - Sex: 'FEMALE'
[15:43:51] ℹ️  Order extraction - Service Line: ''
[15:43:51] ℹ️  Order extraction - Payer Source: ''
[15:43:51] ✅ Order data extraction completed successfully
[15:43:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:43:51] ℹ️  Using MRN from patient data: '2467466' over '2467466'
[15:43:51] ℹ️  Using service line from patient data: 'Nursing'
[15:43:51] ✅ Patient name cross-validation successful
[15:43:51] ✅    ✅ Data merged successfully
[15:43:52] ✅    ✅ Order data extracted and validated
[15:43:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:58] [DOC: 9223426] ℹ️  Patient not found in cache or API: Maria Ferreira
[15:43:58] [DOC: 9223426] ℹ️  Patient not found, creating new patient via API...
[15:43:58] [DOC: 9223426] ℹ️  Creating patient via API: Maria Ferreira
[15:43:59] [DOC: 9223426] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:43:59] ❌    ❌ Failed to create patient
[15:43:59] [DOC: 9223426] ℹ️  API push details saved for document 9223426
================================================================================
║                        Processing Document ID: 9223420                         ║
================================================================================
[15:43:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:43:59] ℹ️  Date: 04/04/2025
[15:43:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:00] [DOC: 9223420] ✅ Text extracted using pdfplumber (1667 chars)
[15:44:00] ✅    ✅ Text extracted using pdfplumber (1667 chars)
[15:44:00] 🔄 
🔄 Step 2: Extracting patient data...
[15:44:03] ℹ️  AI extracted raw sex value: 'F'
[15:44:03] ℹ️  AI extracted service line: 'Nursing'
[15:44:03] ℹ️  AI extracted payer source: ''
[15:44:03] ℹ️  AI extracted diagnoses:
[15:44:03] ℹ️    - Diagnosis 1: ''
[15:44:03] ℹ️    - Diagnosis 2: ''
[15:44:03] ℹ️    - Diagnosis 3: ''
[15:44:03] ℹ️    - Diagnosis 4: ''
[15:44:03] ℹ️    - Diagnosis 5: ''
[15:44:03] ℹ️    - Diagnosis 6: ''
[15:44:03] ℹ️  Final extracted MRN: '2467466'
[15:44:03] ℹ️  Final extracted Sex: 'FEMALE'
[15:44:03] ℹ️  Final extracted Service Line: 'Nursing'
[15:44:03] ℹ️  Final extracted Payer Source: ''
[15:44:03] ✅ Patient data extraction completed successfully
[15:44:03] ✅    ✅ Patient data extracted successfully
[15:44:03] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:44:03] ✅    ✅ Patient identified: Maria Ferreira
[15:44:03] ✅    ✅ Patient name validation passed
[15:44:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:44:03] [DOC: 9223420] ℹ️  DOB normalized: 07/12/1938
[15:44:03] [DOC: 9223420] ✅ Patient date processing completed successfully
[15:44:03] ✅    ✅ Date processing completed
[15:44:03] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:44:03] 🔄 
🔄 Step 4: Extracting order data...
[15:44:05] ℹ️  Order extraction - MRN: '2467466'
[15:44:05] ℹ️  Order extraction - Sex: 'FEMALE'
[15:44:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:44:05] ℹ️  Order extraction - Payer Source: ''
[15:44:05] ✅ Order data extraction completed successfully
[15:44:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:44:05] ℹ️  Using MRN from patient data: '2467466' over '2467466'
[15:44:05] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[15:44:05] ✅ Patient name cross-validation successful
[15:44:05] ✅    ✅ Data merged successfully
[15:44:06] ✅    ✅ Order data extracted and validated
[15:44:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:44:15] [DOC: 9223420] ℹ️  Patient not found in cache or API: Maria Ferreira
[15:44:15] [DOC: 9223420] ℹ️  Patient not found, creating new patient via API...
[15:44:15] [DOC: 9223420] ℹ️  Creating patient via API: Maria Ferreira
[15:44:16] [DOC: 9223420] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:44:16] ❌    ❌ Failed to create patient
[15:44:16] [DOC: 9223420] ℹ️  API push details saved for document 9223420
================================================================================
║                        Processing Document ID: 9223416                         ║
================================================================================
[15:44:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:44:16] ℹ️  Date: 04/04/2025
[15:44:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:17] [DOC: 9223416] ✅ Text extracted using pdfplumber (956 chars)
[15:44:17] ✅    ✅ Text extracted using pdfplumber (956 chars)
[15:44:17] 🔄 
🔄 Step 2: Extracting patient data...
[15:44:20] ℹ️  AI extracted raw sex value: 'F'
[15:44:20] ℹ️  AI extracted service line: 'RN'
[15:44:20] ℹ️  AI extracted payer source: ''
[15:44:20] ℹ️  AI extracted diagnoses:
[15:44:20] ℹ️    - Diagnosis 1: 'None'
[15:44:20] ℹ️    - Diagnosis 2: 'None'
[15:44:20] ℹ️    - Diagnosis 3: 'None'
[15:44:20] ℹ️    - Diagnosis 4: 'None'
[15:44:20] ℹ️    - Diagnosis 5: 'None'
[15:44:20] ℹ️    - Diagnosis 6: 'None'
[15:44:20] ℹ️  Final extracted MRN: '2455123'
[15:44:20] ℹ️  Final extracted Sex: 'FEMALE'
[15:44:20] ℹ️  Final extracted Service Line: 'RN'
[15:44:20] ℹ️  Final extracted Payer Source: ''
[15:44:20] ✅ Patient data extraction completed successfully
[15:44:20] ✅    ✅ Patient data extracted successfully
[15:44:20] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:44:20] ✅    ✅ Patient identified: Donna Faria
[15:44:20] ✅    ✅ Patient name validation passed
[15:44:20] 🔄 
🔄 Step 3: Processing patient dates...
[15:44:20] [DOC: 9223416] ℹ️  DOB normalized: 04/27/1958
[15:44:20] [DOC: 9223416] ✅ Patient date processing completed successfully
[15:44:20] ✅    ✅ Date processing completed
[15:44:20] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:44:20] 🔄 
🔄 Step 4: Extracting order data...
[15:44:22] ℹ️  Order extraction - MRN: '2455123'
[15:44:22] ℹ️  Order extraction - Sex: 'FEMALE'
[15:44:22] ℹ️  Order extraction - Service Line: ''
[15:44:22] ℹ️  Order extraction - Payer Source: ''
[15:44:22] ✅ Order data extraction completed successfully
[15:44:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:44:22] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[15:44:22] ℹ️  Using service line from patient data: 'RN'
[15:44:22] ✅ Patient name cross-validation successful
[15:44:22] ✅    ✅ Data merged successfully
[15:44:23] ⚠️     ❌ Skipping - missing episode start date
[15:44:23] [DOC: 9223416] ℹ️  API push details saved for document 9223416
================================================================================
║                        Processing Document ID: 9223413                         ║
================================================================================
[15:44:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:44:23] ℹ️  Date: 04/04/2025
[15:44:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:25] [DOC: 9223413] ✅ Text extracted using pdfplumber (882 chars)
[15:44:25] ✅    ✅ Text extracted using pdfplumber (882 chars)
[15:44:25] 🔄 
🔄 Step 2: Extracting patient data...
[15:44:27] ℹ️  AI extracted raw sex value: 'M'
[15:44:27] ℹ️  AI extracted service line: 'Nursing'
[15:44:27] ℹ️  AI extracted payer source: ''
[15:44:27] ℹ️  AI extracted diagnoses:
[15:44:27] ℹ️    - Diagnosis 1: ''
[15:44:27] ℹ️    - Diagnosis 2: ''
[15:44:27] ℹ️    - Diagnosis 3: ''
[15:44:27] ℹ️    - Diagnosis 4: ''
[15:44:27] ℹ️    - Diagnosis 5: ''
[15:44:27] ℹ️    - Diagnosis 6: ''
[15:44:27] ℹ️  Final extracted MRN: '2447688'
[15:44:27] ℹ️  Final extracted Sex: 'MALE'
[15:44:27] ℹ️  Final extracted Service Line: 'Nursing'
[15:44:27] ℹ️  Final extracted Payer Source: ''
[15:44:27] ✅ Patient data extraction completed successfully
[15:44:27] ✅    ✅ Patient data extracted successfully
[15:44:27] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:44:27] ✅    ✅ Patient identified: George England
[15:44:27] ✅    ✅ Patient name validation passed
[15:44:27] 🔄 
🔄 Step 3: Processing patient dates...
[15:44:27] [DOC: 9223413] ℹ️  DOB normalized: 08/26/1924
[15:44:27] [DOC: 9223413] ✅ Patient date processing completed successfully
[15:44:27] ✅    ✅ Date processing completed
[15:44:27] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:44:27] 🔄 
🔄 Step 4: Extracting order data...
[15:44:29] ℹ️  Order extraction - MRN: '2447688'
[15:44:29] ℹ️  Order extraction - Sex: 'MALE'
[15:44:29] ℹ️  Order extraction - Service Line: ''
[15:44:29] ℹ️  Order extraction - Payer Source: ''
[15:44:29] ✅ Order data extraction completed successfully
[15:44:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:44:29] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[15:44:29] ℹ️  Using service line from patient data: 'Nursing'
[15:44:29] ✅ Patient name cross-validation successful
[15:44:29] ✅    ✅ Data merged successfully
[15:44:31] ✅    ✅ Order data extracted and validated
[15:44:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:44:31] [DOC: 9223413] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[15:44:31] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[15:44:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:44:31] [DOC: 9223413] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[15:44:33] [DOC: 9223413] ❌ Order push failed with status 201: {"id":"b6ac6bf4-d6c4-4910-b88b-933b841dd6e6","orderWAVId":"ORD20062","orderNo":"1078452","orderDate":"04/03/2025","startOfCare":"03/30/2025","episodeStartDate":"03/30/2025","episodeEndDate":"05/28/2025","documentID":"9223413","mrn":"2447688","patientName":"England,George N.","sentToPhysicianDate":"04/04/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/10/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"9e630b2a-6bbf-4ea5-b7c5-596174a81f4a","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:44:33] ❌    ❌ Failed to push order
[15:44:33] 🔄 
🔄 Step 7: Writing to CSV...
[15:44:33] [DOC: 9223413] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[15:44:33] [DOC: 9223413] ℹ️  Service Line extracted: 'Nursing'
[15:44:33] [DOC: 9223413] ℹ️  Payer Source extracted: ''
[15:44:33] [DOC: 9223413] ℹ️  Diagnosis codes being written:
[15:44:33] [DOC: 9223413] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:44:33] [DOC: 9223413] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:44:33] [DOC: 9223413] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:44:33] [DOC: 9223413] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:44:33] [DOC: 9223413] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:44:33] [DOC: 9223413] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:44:33] [DOC: 9223413] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Nursing | Payer:  | MRN: 2447688
[15:44:33] ✅    ✅ Document 9223413 processed and saved successfully
[15:44:33] 🔄 
🔄 Step 8: Saving API details...
[15:44:33] [DOC: 9223413] ℹ️  API push details saved for document 9223413
[15:44:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223412                         ║
================================================================================
[15:44:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:44:33] ℹ️  Date: 04/04/2025
[15:44:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:34] [DOC: 9223412] ✅ Text extracted using pdfplumber (1987 chars)
[15:44:34] ✅    ✅ Text extracted using pdfplumber (1987 chars)
[15:44:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:44:37] ℹ️  AI extracted raw sex value: 'F'
[15:44:37] ℹ️  AI extracted service line: 'PT'
[15:44:37] ℹ️  AI extracted payer source: ''
[15:44:37] ℹ️  AI extracted diagnoses:
[15:44:37] ℹ️    - Diagnosis 1: 'None'
[15:44:37] ℹ️    - Diagnosis 2: 'None'
[15:44:37] ℹ️    - Diagnosis 3: 'None'
[15:44:37] ℹ️    - Diagnosis 4: 'None'
[15:44:37] ℹ️    - Diagnosis 5: 'None'
[15:44:37] ℹ️    - Diagnosis 6: 'None'
[15:44:37] ℹ️  Final extracted MRN: '2102046'
[15:44:37] ℹ️  Final extracted Sex: 'FEMALE'
[15:44:37] ℹ️  Final extracted Service Line: 'PT'
[15:44:37] ℹ️  Final extracted Payer Source: ''
[15:44:37] ✅ Patient data extraction completed successfully
[15:44:37] ✅    ✅ Patient data extracted successfully
[15:44:37] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:44:37] ✅    ✅ Patient identified: Maria Cunha
[15:44:37] ✅    ✅ Patient name validation passed
[15:44:37] 🔄 
🔄 Step 3: Processing patient dates...
[15:44:37] [DOC: 9223412] ℹ️  DOB normalized: 06/04/1930
[15:44:37] [DOC: 9223412] ✅ Patient date processing completed successfully
[15:44:37] ✅    ✅ Date processing completed
[15:44:37] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:44:37] 🔄 
🔄 Step 4: Extracting order data...
[15:44:39] ℹ️  Order extraction - MRN: '2102046'
[15:44:39] ℹ️  Order extraction - Sex: 'FEMALE'
[15:44:39] ℹ️  Order extraction - Service Line: 'PT'
[15:44:39] ℹ️  Order extraction - Payer Source: ''
[15:44:39] ✅ Order data extraction completed successfully
[15:44:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:44:39] ℹ️  Using MRN from patient data: '2102046' over '2102046'
[15:44:39] ℹ️  Service line consistent in both sources: 'PT'
[15:44:39] ✅ Patient name cross-validation successful
[15:44:39] ✅    ✅ Data merged successfully
[15:44:40] ⚠️     ❌ Skipping - missing episode start date
[15:44:40] [DOC: 9223412] ℹ️  API push details saved for document 9223412
================================================================================
║                        Processing Document ID: 9223410                         ║
================================================================================
[15:44:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:44:40] ℹ️  Date: 04/04/2025
[15:44:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:42] [DOC: 9223410] ✅ Text extracted using pdfplumber (9870 chars)
[15:44:42] ✅    ✅ Text extracted using pdfplumber (9870 chars)
[15:44:42] 🔄 
🔄 Step 2: Extracting patient data...
[15:44:45] ℹ️  AI extracted raw sex value: 'F'
[15:44:45] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[15:44:45] ℹ️  AI extracted payer source: ''
[15:44:45] ℹ️  AI extracted diagnoses:
[15:44:45] ℹ️    - Diagnosis 1: 'U07.1'
[15:44:45] ℹ️    - Diagnosis 2: 'E11.65'
[15:44:45] ℹ️    - Diagnosis 3: 'I10'
[15:44:45] ℹ️    - Diagnosis 4: 'E78.5'
[15:44:45] ℹ️    - Diagnosis 5: 'E66.812'
[15:44:45] ℹ️    - Diagnosis 6: 'Z68.31'
[15:44:45] ℹ️  Final extracted MRN: '2366224'
[15:44:45] ℹ️  Final extracted Sex: 'FEMALE'
[15:44:45] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[15:44:45] ℹ️  Final extracted Payer Source: ''
[15:44:45] ✅ Patient data extraction completed successfully
[15:44:45] ✅    ✅ Patient data extracted successfully
[15:44:45] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Couto
     └─ dob: 05/03/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2366224
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'E66.812', 'sixthDiagnosis': 'Z68.31'}]
[15:44:45] ✅    ✅ Patient identified: Maria Couto
[15:44:45] ✅    ✅ Patient name validation passed
[15:44:45] 🔄 
🔄 Step 3: Processing patient dates...
[15:44:45] [DOC: 9223410] ℹ️  DOB normalized: 05/03/1950
[15:44:45] [DOC: 9223410] ℹ️  Episode startOfCare normalized: 03/23/2025
[15:44:45] [DOC: 9223410] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[15:44:45] [DOC: 9223410] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[15:44:45] [DOC: 9223410] ✅ Patient date processing completed successfully
[15:44:45] ✅    ✅ Date processing completed
[15:44:45] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Couto
     └─ dob: 05/03/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2366224
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'E66.812', 'sixthDiagnosis': 'Z68.31'}]
[15:44:45] 🔄 
🔄 Step 4: Extracting order data...
[15:44:48] ℹ️  Order extraction - MRN: '2366224'
[15:44:48] ℹ️  Order extraction - Sex: 'FEMALE'
[15:44:48] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[15:44:48] ℹ️  Order extraction - Payer Source: ''
[15:44:48] ✅ Order data extraction completed successfully
[15:44:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:44:48] ℹ️  Using MRN from patient data: '2366224' over '2366224'
[15:44:48] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing'
[15:44:48] ✅ Patient name cross-validation successful
[15:44:48] ✅    ✅ Data merged successfully
[15:44:49] ✅    ✅ Order data extracted and validated
[15:44:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:44:55] [DOC: 9223410] ℹ️  Patient not found in cache or API: Maria Couto
[15:44:55] [DOC: 9223410] ℹ️  Patient not found, creating new patient via API...
[15:44:55] [DOC: 9223410] ℹ️  Creating patient via API: Maria Couto
[15:44:56] [DOC: 9223410] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:44:56] ❌    ❌ Failed to create patient
[15:44:56] [DOC: 9223410] ℹ️  API push details saved for document 9223410
================================================================================
║                        Processing Document ID: 9223398                         ║
================================================================================
[15:44:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:44:56] ℹ️  Date: 04/04/2025
[15:44:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:59] [DOC: 9223398] ✅ Text extracted using pdfplumber (19674 chars)
[15:44:59] ✅    ✅ Text extracted using pdfplumber (19674 chars)
[15:44:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:03] ℹ️  AI extracted raw sex value: 'M'
[15:45:03] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[15:45:03] ℹ️  AI extracted payer source: ''
[15:45:03] ℹ️  AI extracted diagnoses:
[15:45:03] ℹ️    - Diagnosis 1: 'M1A.3610'
[15:45:03] ℹ️    - Diagnosis 2: 'M17.11'
[15:45:03] ℹ️    - Diagnosis 3: 'M62.81'
[15:45:03] ℹ️    - Diagnosis 4: 'Z48.3'
[15:45:03] ℹ️    - Diagnosis 5: 'C25.0'
[15:45:03] ℹ️    - Diagnosis 6: 'C61'
[15:45:03] ℹ️  Final extracted MRN: '2094562'
[15:45:03] ℹ️  Final extracted Sex: 'MALE'
[15:45:03] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[15:45:03] ℹ️  Final extracted Payer Source: ''
[15:45:03] ✅ Patient data extraction completed successfully
[15:45:03] ✅    ✅ Patient data extracted successfully
[15:45:03] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'M1A.3610', 'secondDiagnosis': 'M17.11', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': 'Z48.3', 'fifthDiagnosis': 'C25.0', 'sixthDiagnosis': 'C61'}]
[15:45:03] ✅    ✅ Patient identified: Edward Correia
[15:45:03] ✅    ✅ Patient name validation passed
[15:45:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:03] [DOC: 9223398] ℹ️  DOB normalized: 07/27/1950
[15:45:03] [DOC: 9223398] ℹ️  Episode startOfCare normalized: 03/24/2025
[15:45:03] [DOC: 9223398] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:45:03] [DOC: 9223398] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:45:03] [DOC: 9223398] ✅ Patient date processing completed successfully
[15:45:03] ✅    ✅ Date processing completed
[15:45:03] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'M1A.3610', 'secondDiagnosis': 'M17.11', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': 'Z48.3', 'fifthDiagnosis': 'C25.0', 'sixthDiagnosis': 'C61'}]
[15:45:03] 🔄 
🔄 Step 4: Extracting order data...
[15:45:06] ℹ️  Order extraction - MRN: '2094562'
[15:45:06] ℹ️  Order extraction - Sex: 'MALE'
[15:45:06] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[15:45:06] ℹ️  Order extraction - Payer Source: ''
[15:45:06] ✅ Order data extraction completed successfully
[15:45:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:06] ℹ️  Using MRN from patient data: '2094562' over '2094562'
[15:45:06] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing'
[15:45:06] ✅ Patient name cross-validation successful
[15:45:06] ✅    ✅ Data merged successfully
[15:45:07] ✅    ✅ Order data extracted and validated
[15:45:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:45:15] [DOC: 9223398] ✅ Patient exists in API: Edward Correia, ID: 174a95e3-e9ae-40af-b8f1-5384f2c0957c
[15:45:15] ✅    ✅ Existing patient found with ID: 174a95e3-e9ae-40af-b8f1-5384f2c0957c
[15:45:15] 🔄 
🔄 Step 6: Pushing order to API...
[15:45:15] [DOC: 9223398] ℹ️  Pushing order via API for patient ID: 174a95e3-e9ae-40af-b8f1-5384f2c0957c
[15:45:16] [DOC: 9223398] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12851"}
[15:45:16] ❌    ❌ Failed to push order
[15:45:16] 🔄 
🔄 Step 7: Writing to CSV...
[15:45:16] [DOC: 9223398] ℹ️  Calculated age: 74 from DOB: 07/27/1950
[15:45:16] [DOC: 9223398] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[15:45:16] [DOC: 9223398] ℹ️  Payer Source extracted: ''
[15:45:16] [DOC: 9223398] ℹ️  Diagnosis codes being written:
[15:45:16] [DOC: 9223398] ℹ️    - Latest_Episode_Firstdiagnosis: 'M1A.3610'
[15:45:16] [DOC: 9223398] ℹ️    - Latest_Episode_Seconddiagnosis: 'M17.11'
[15:45:16] [DOC: 9223398] ℹ️    - Latest_Episode_Thirddiagnosis: 'M62.81'
[15:45:16] [DOC: 9223398] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z48.3'
[15:45:16] [DOC: 9223398] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C25.0'
[15:45:16] [DOC: 9223398] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C61'
[15:45:16] [DOC: 9223398] ✅ Patient data written to CSV: Edward Correia | Sex: MALE | Age: 74 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 2094562
[15:45:16] ✅    ✅ Document 9223398 processed and saved successfully
[15:45:16] 🔄 
🔄 Step 8: Saving API details...
[15:45:16] [DOC: 9223398] ℹ️  API push details saved for document 9223398
[15:45:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223384                         ║
================================================================================
[15:45:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:45:16] ℹ️  Date: 04/04/2025
[15:45:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:17] [DOC: 9223384] ✅ Text extracted using pdfplumber (933 chars)
[15:45:17] ✅    ✅ Text extracted using pdfplumber (933 chars)
[15:45:17] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:20] ℹ️  AI extracted raw sex value: 'F'
[15:45:20] ℹ️  AI extracted service line: ''
[15:45:20] ℹ️  AI extracted payer source: ''
[15:45:20] ℹ️  AI extracted diagnoses:
[15:45:20] ℹ️    - Diagnosis 1: ''
[15:45:20] ℹ️    - Diagnosis 2: ''
[15:45:20] ℹ️    - Diagnosis 3: ''
[15:45:20] ℹ️    - Diagnosis 4: ''
[15:45:20] ℹ️    - Diagnosis 5: ''
[15:45:20] ℹ️    - Diagnosis 6: ''
[15:45:20] ℹ️  Final extracted MRN: '2219947'
[15:45:20] ℹ️  Final extracted Sex: 'FEMALE'
[15:45:20] ℹ️  Final extracted Service Line: ''
[15:45:20] ℹ️  Final extracted Payer Source: ''
[15:45:20] ✅ Patient data extraction completed successfully
[15:45:20] ✅    ✅ Patient data extracted successfully
[15:45:20] 📊 Patient Response
     └─ patientFName: Ashley
     └─ patientLName: Barrett
     └─ dob: 12/30/1987
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2219947
     └─ billingProvider: Mary R Dias-Regus, NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:45:20] ✅    ✅ Patient identified: Ashley Barrett
[15:45:20] ✅    ✅ Patient name validation passed
[15:45:20] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:20] [DOC: 9223384] ℹ️  DOB normalized: 12/30/1987
[15:45:20] [DOC: 9223384] ✅ Patient date processing completed successfully
[15:45:20] ✅    ✅ Date processing completed
[15:45:20] 📊 Processed Patient Data
     └─ patientFName: Ashley
     └─ patientLName: Barrett
     └─ dob: 12/30/1987
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2219947
     └─ billingProvider: Mary R Dias-Regus, NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:45:20] 🔄 
🔄 Step 4: Extracting order data...
[15:45:22] ℹ️  Order extraction - MRN: '2219947'
[15:45:22] ℹ️  Order extraction - Sex: 'FEMALE'
[15:45:22] ℹ️  Order extraction - Service Line: ''
[15:45:22] ℹ️  Order extraction - Payer Source: ''
[15:45:22] ✅ Order data extraction completed successfully
[15:45:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:22] ℹ️  Using MRN from patient data: '2219947' over '2219947'
[15:45:22] ✅ Patient name cross-validation successful
[15:45:22] ✅    ✅ Data merged successfully
[15:45:23] ⚠️     ❌ Skipping - missing episode start date
[15:45:23] [DOC: 9223384] ℹ️  API push details saved for document 9223384
================================================================================
║                        Processing Document ID: 9223296                         ║
================================================================================
[15:45:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:45:23] ℹ️  Date: 04/04/2025
[15:45:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:26] [DOC: 9223296] ✅ Text extracted using pdfplumber (15414 chars)
[15:45:26] ✅    ✅ Text extracted using pdfplumber (15414 chars)
[15:45:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:29] ℹ️  AI extracted raw sex value: 'M'
[15:45:29] ℹ️  AI extracted service line: 'PT, OT'
[15:45:29] ℹ️  AI extracted payer source: 'Medicare'
[15:45:29] ℹ️  AI extracted diagnoses:
[15:45:29] ℹ️    - Diagnosis 1: 'J11.1'
[15:45:29] ℹ️    - Diagnosis 2: 'G30.1'
[15:45:29] ℹ️    - Diagnosis 3: 'F02.C0'
[15:45:29] ℹ️    - Diagnosis 4: 'E11.9'
[15:45:29] ℹ️    - Diagnosis 5: 'I10'
[15:45:29] ℹ️    - Diagnosis 6: 'D50.9'
[15:45:29] ℹ️  Final extracted MRN: 'MA240712093601'
[15:45:29] ℹ️  Final extracted Sex: 'MALE'
[15:45:29] ℹ️  Final extracted Service Line: 'PT, OT'
[15:45:29] ℹ️  Final extracted Payer Source: 'Medicare'
[15:45:29] ✅ Patient data extraction completed successfully
[15:45:29] ✅    ✅ Patient data extracted successfully
[15:45:29] 📊 Patient Response
     └─ patientFName: Lachlan
     └─ patientLName: Mackenzie
     └─ dob: 09/19/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240712093601
     └─ billingProvider: MASKEY, SACHIN MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'J11.1', 'secondDiagnosis': 'G30.1', 'thirdDiagnosis': 'F02.C0', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D50.9'}]
[15:45:29] ✅    ✅ Patient identified: Lachlan Mackenzie
[15:45:29] ✅    ✅ Patient name validation passed
[15:45:29] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:29] [DOC: 9223296] ℹ️  DOB normalized: 09/19/1936
[15:45:29] [DOC: 9223296] ℹ️  Episode startOfCare normalized: 03/10/2025
[15:45:29] [DOC: 9223296] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[15:45:29] [DOC: 9223296] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[15:45:29] [DOC: 9223296] ✅ Patient date processing completed successfully
[15:45:29] ✅    ✅ Date processing completed
[15:45:29] 📊 Processed Patient Data
     └─ patientFName: Lachlan
     └─ patientLName: Mackenzie
     └─ dob: 09/19/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240712093601
     └─ billingProvider: MASKEY, SACHIN MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'J11.1', 'secondDiagnosis': 'G30.1', 'thirdDiagnosis': 'F02.C0', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D50.9'}]
[15:45:29] 🔄 
🔄 Step 4: Extracting order data...
[15:45:32] ℹ️  Order extraction - MRN: 'MA240712093601'
[15:45:32] ℹ️  Order extraction - Sex: 'MALE'
[15:45:32] ℹ️  Order extraction - Service Line: 'PT, OT'
[15:45:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:45:32] ✅ Order data extraction completed successfully
[15:45:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:32] ℹ️  Using MRN from patient data: 'MA240712093601' over 'MA240712093601'
[15:45:32] ℹ️  Service line consistent in both sources: 'PT, OT'
[15:45:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:45:32] ✅ Patient name cross-validation successful
[15:45:32] ✅    ✅ Data merged successfully
[15:45:33] ✅    ✅ Order data extracted and validated
[15:45:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:45:39] [DOC: 9223296] ✅ Patient exists in API: Lachlan Mackenzie, ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:45:39] ✅    ✅ Existing patient found with ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:45:39] 🔄 
🔄 Step 6: Pushing order to API...
[15:45:39] [DOC: 9223296] ℹ️  Pushing order via API for patient ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:45:40] [DOC: 9223296] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14003"}
[15:45:40] ❌    ❌ Failed to push order
[15:45:40] 🔄 
🔄 Step 7: Writing to CSV...
[15:45:40] [DOC: 9223296] ℹ️  Calculated age: 88 from DOB: 09/19/1936
[15:45:40] [DOC: 9223296] ℹ️  Service Line extracted: 'PT, OT'
[15:45:40] [DOC: 9223296] ℹ️  Payer Source extracted: 'Medicare'
[15:45:40] [DOC: 9223296] ℹ️  Diagnosis codes being written:
[15:45:40] [DOC: 9223296] ℹ️    - Latest_Episode_Firstdiagnosis: 'J11.1'
[15:45:40] [DOC: 9223296] ℹ️    - Latest_Episode_Seconddiagnosis: 'G30.1'
[15:45:40] [DOC: 9223296] ℹ️    - Latest_Episode_Thirddiagnosis: 'F02.C0'
[15:45:40] [DOC: 9223296] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[15:45:40] [DOC: 9223296] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:45:40] [DOC: 9223296] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D50.9'
[15:45:40] [DOC: 9223296] ✅ Patient data written to CSV: Lachlan Mackenzie | Sex: MALE | Age: 88 | Service: PT, OT | Payer: Medicare | MRN: MA240712093601
[15:45:40] ✅    ✅ Document 9223296 processed and saved successfully
[15:45:40] 🔄 
🔄 Step 8: Saving API details...
[15:45:40] [DOC: 9223296] ℹ️  API push details saved for document 9223296
[15:45:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223278                         ║
================================================================================
[15:45:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:45:40] ℹ️  Date: 04/04/2025
[15:45:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:42] [DOC: 9223278] ✅ Text extracted using pdfplumber (1553 chars)
[15:45:42] ✅    ✅ Text extracted using pdfplumber (1553 chars)
[15:45:42] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:45] ℹ️  AI extracted raw sex value: ''
[15:45:45] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:45:45] ℹ️  AI extracted payer source: ''
[15:45:45] ℹ️  AI extracted diagnoses:
[15:45:45] ℹ️    - Diagnosis 1: 'J11.1'
[15:45:45] ℹ️    - Diagnosis 2: 'G30.1'
[15:45:45] ℹ️    - Diagnosis 3: 'F02.C0'
[15:45:45] ℹ️    - Diagnosis 4: ''
[15:45:45] ℹ️    - Diagnosis 5: ''
[15:45:45] ℹ️    - Diagnosis 6: ''
[15:45:45] ℹ️  Final extracted MRN: 'MA240712093601'
[15:45:45] ℹ️  Final extracted Sex: ''
[15:45:45] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:45:45] ℹ️  Final extracted Payer Source: ''
[15:45:45] ✅ Patient data extraction completed successfully
[15:45:45] ✅    ✅ Patient data extracted successfully
[15:45:45] 📊 Patient Response
     └─ patientFName: Lachlan
     └─ patientLName: Mackenzie
     └─ dob: 09/19/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA240712093601
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'J11.1', 'secondDiagnosis': 'G30.1', 'thirdDiagnosis': 'F02.C0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:45:45] ✅    ✅ Patient identified: Lachlan Mackenzie
[15:45:45] ✅    ✅ Patient name validation passed
[15:45:45] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:45] [DOC: 9223278] ℹ️  DOB normalized: 09/19/1936
[15:45:45] [DOC: 9223278] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[15:45:45] [DOC: 9223278] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[15:45:45] [DOC: 9223278] ✅ Patient date processing completed successfully
[15:45:45] ✅    ✅ Date processing completed
[15:45:45] 📊 Processed Patient Data
     └─ patientFName: Lachlan
     └─ patientLName: Mackenzie
     └─ dob: 09/19/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA240712093601
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'J11.1', 'secondDiagnosis': 'G30.1', 'thirdDiagnosis': 'F02.C0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:45:45] 🔄 
🔄 Step 4: Extracting order data...
[15:45:48] ℹ️  Order extraction - MRN: 'MA240712093601'
[15:45:48] ℹ️  Order extraction - Sex: ''
[15:45:48] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:45:48] ℹ️  Order extraction - Payer Source: ''
[15:45:48] ✅ Order data extraction completed successfully
[15:45:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:48] ℹ️  Using MRN from patient data: 'MA240712093601' over 'MA240712093601'
[15:45:48] ⚠️  Could not determine sex using any available method
[15:45:48] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:45:48] ✅ Patient name cross-validation successful
[15:45:48] ✅    ✅ Data merged successfully
[15:45:49] ✅    ✅ Order data extracted and validated
[15:45:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:45:49] [DOC: 9223278] ✅ Patient found in local cache: Lachlan Mackenzie, ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:45:49] ✅    ✅ Existing patient found with ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:45:49] 🔄 
🔄 Step 6: Pushing order to API...
[15:45:49] [DOC: 9223278] ℹ️  Pushing order via API for patient ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:45:51] [DOC: 9223278] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14006"}
[15:45:51] ❌    ❌ Failed to push order
[15:45:51] 🔄 
🔄 Step 7: Writing to CSV...
[15:45:51] [DOC: 9223278] ℹ️  Calculated age: 88 from DOB: 09/19/1936
[15:45:51] [DOC: 9223278] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:45:51] [DOC: 9223278] ℹ️  Payer Source extracted: ''
[15:45:51] [DOC: 9223278] ℹ️  Diagnosis codes being written:
[15:45:51] [DOC: 9223278] ℹ️    - Latest_Episode_Firstdiagnosis: 'J11.1'
[15:45:51] [DOC: 9223278] ℹ️    - Latest_Episode_Seconddiagnosis: 'G30.1'
[15:45:51] [DOC: 9223278] ℹ️    - Latest_Episode_Thirddiagnosis: 'F02.C0'
[15:45:51] [DOC: 9223278] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:45:51] [DOC: 9223278] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:45:51] [DOC: 9223278] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:45:51] [DOC: 9223278] ✅ Patient data written to CSV: Lachlan Mackenzie | Sex:  | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA240712093601
[15:45:51] ✅    ✅ Document 9223278 processed and saved successfully
[15:45:51] 🔄 
🔄 Step 8: Saving API details...
[15:45:51] [DOC: 9223278] ℹ️  API push details saved for document 9223278
[15:45:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223270                         ║
================================================================================
[15:45:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:45:51] ℹ️  Date: 04/04/2025
[15:45:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:54] [DOC: 9223270] ✅ Text extracted using pdfplumber (16699 chars)
[15:45:54] ✅    ✅ Text extracted using pdfplumber (16699 chars)
[15:45:54] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:56] ℹ️  AI extracted raw sex value: 'M'
[15:45:56] ℹ️  AI extracted service line: 'OT'
[15:45:56] ℹ️  AI extracted payer source: ''
[15:45:56] ℹ️  AI extracted diagnoses:
[15:45:56] ℹ️    - Diagnosis 1: 'influenza'
[15:45:56] ℹ️    - Diagnosis 2: 'Alzheimer's disease'
[15:45:56] ℹ️    - Diagnosis 3: 'weakness'
[15:45:56] ℹ️    - Diagnosis 4: 'leukocytosis'
[15:45:56] ℹ️    - Diagnosis 5: 'HTN'
[15:45:56] ℹ️    - Diagnosis 6: 'hypothyroidism'
[15:45:56] ℹ️  Final extracted MRN: 'MA240712093601'
[15:45:56] ℹ️  Final extracted Sex: 'MALE'
[15:45:56] ℹ️  Final extracted Service Line: 'OT'
[15:45:56] ℹ️  Final extracted Payer Source: ''
[15:45:56] ✅ Patient data extraction completed successfully
[15:45:56] ✅    ✅ Patient data extracted successfully
[15:45:56] 📊 Patient Response
     └─ patientFName: Lachlan
     └─ patientLName: Mackenzie
     └─ dob: 09/19/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240712093601
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '', 'firstDiagnosis': 'influenza', 'secondDiagnosis': "Alzheimer's disease", 'thirdDiagnosis': 'weakness', 'fourthDiagnosis': 'leukocytosis', 'fifthDiagnosis': 'HTN', 'sixthDiagnosis': 'hypothyroidism'}]
[15:45:56] ✅    ✅ Patient identified: Lachlan Mackenzie
[15:45:56] ✅    ✅ Patient name validation passed
[15:45:56] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:56] [DOC: 9223270] ℹ️  DOB normalized: 09/19/1936
[15:45:56] [DOC: 9223270] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[15:45:56] [DOC: 9223270] ✅ Patient date processing completed successfully
[15:45:56] ✅    ✅ Date processing completed
[15:45:56] 📊 Processed Patient Data
     └─ patientFName: Lachlan
     └─ patientLName: Mackenzie
     └─ dob: 09/19/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240712093601
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '', 'firstDiagnosis': 'influenza', 'secondDiagnosis': "Alzheimer's disease", 'thirdDiagnosis': 'weakness', 'fourthDiagnosis': 'leukocytosis', 'fifthDiagnosis': 'HTN', 'sixthDiagnosis': 'hypothyroidism'}]
[15:45:56] 🔄 
🔄 Step 4: Extracting order data...
[15:45:59] ℹ️  Order extraction - MRN: 'MA240712093601'
[15:45:59] ℹ️  Order extraction - Sex: 'MALE'
[15:45:59] ℹ️  Order extraction - Service Line: 'OT'
[15:45:59] ℹ️  Order extraction - Payer Source: ''
[15:45:59] ✅ Order data extraction completed successfully
[15:45:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:59] ℹ️  Using MRN from patient data: 'MA240712093601' over 'MA240712093601'
[15:45:59] ℹ️  Service line consistent in both sources: 'OT'
[15:45:59] ✅ Patient name cross-validation successful
[15:45:59] ✅    ✅ Data merged successfully
[15:46:00] ✅    ✅ Order data extracted and validated
[15:46:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:00] [DOC: 9223270] ✅ Patient found in local cache: Lachlan Mackenzie, ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:46:00] ✅    ✅ Existing patient found with ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:46:00] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:00] [DOC: 9223270] ℹ️  Pushing order via API for patient ID: 99f1e8f2-48f0-4475-aa4c-6f71413822df
[15:46:02] [DOC: 9223270] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:46:02] ❌    ❌ Failed to push order
[15:46:02] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:02] [DOC: 9223270] ℹ️  Calculated age: 88 from DOB: 09/19/1936
[15:46:02] [DOC: 9223270] ℹ️  Service Line extracted: 'OT'
[15:46:02] [DOC: 9223270] ℹ️  Payer Source extracted: ''
[15:46:02] [DOC: 9223270] ℹ️  Diagnosis codes being written:
[15:46:02] [DOC: 9223270] ℹ️    - Latest_Episode_Firstdiagnosis: 'influenza'
[15:46:02] [DOC: 9223270] ℹ️    - Latest_Episode_Seconddiagnosis: 'Alzheimer's disease'
[15:46:02] [DOC: 9223270] ℹ️    - Latest_Episode_Thirddiagnosis: 'weakness'
[15:46:02] [DOC: 9223270] ℹ️    - Latest_Episode_Fourthdiagnosis: 'leukocytosis'
[15:46:02] [DOC: 9223270] ℹ️    - Latest_Episode_Fifthdiagnosis: 'HTN'
[15:46:02] [DOC: 9223270] ℹ️    - Latest_Episode_Sixthdiagnosis: 'hypothyroidism'
[15:46:02] [DOC: 9223270] ✅ Patient data written to CSV: Lachlan Mackenzie | Sex: MALE | Age: 88 | Service: OT | Payer:  | MRN: MA240712093601
[15:46:02] ✅    ✅ Document 9223270 processed and saved successfully
[15:46:02] 🔄 
🔄 Step 8: Saving API details...
[15:46:02] [DOC: 9223270] ℹ️  API push details saved for document 9223270
[15:46:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223251                         ║
================================================================================
[15:46:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:46:02] ℹ️  Date: 04/04/2025
[15:46:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:04] [DOC: 9223251] ✅ Text extracted using pdfplumber (1469 chars)
[15:46:04] ✅    ✅ Text extracted using pdfplumber (1469 chars)
[15:46:04] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:07] ℹ️  AI extracted raw sex value: ''
[15:46:07] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:46:07] ℹ️  AI extracted payer source: ''
[15:46:07] ℹ️  AI extracted diagnoses:
[15:46:07] ℹ️    - Diagnosis 1: 'J44.1'
[15:46:07] ℹ️    - Diagnosis 2: 'J18.9'
[15:46:07] ℹ️    - Diagnosis 3: 'J44.0'
[15:46:07] ℹ️    - Diagnosis 4: ''
[15:46:07] ℹ️    - Diagnosis 5: ''
[15:46:07] ℹ️    - Diagnosis 6: ''
[15:46:07] ℹ️  Final extracted MRN: 'MA250130025704'
[15:46:07] ℹ️  Final extracted Sex: ''
[15:46:07] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:46:07] ℹ️  Final extracted Payer Source: ''
[15:46:07] ✅ Patient data extraction completed successfully
[15:46:07] ✅    ✅ Patient data extracted successfully
[15:46:07] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:46:07] ✅    ✅ Patient identified: Theresa Racine
[15:46:07] ✅    ✅ Patient name validation passed
[15:46:07] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:07] [DOC: 9223251] ℹ️  DOB normalized: 02/10/1957
[15:46:07] [DOC: 9223251] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:46:07] [DOC: 9223251] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:46:07] [DOC: 9223251] ✅ Patient date processing completed successfully
[15:46:07] ✅    ✅ Date processing completed
[15:46:07] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:46:07] 🔄 
🔄 Step 4: Extracting order data...
[15:46:10] ℹ️  Order extraction - MRN: 'MA250130025704'
[15:46:10] ℹ️  Order extraction - Sex: ''
[15:46:10] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:46:10] ℹ️  Order extraction - Payer Source: ''
[15:46:10] ✅ Order data extraction completed successfully
[15:46:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:10] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[15:46:10] ⚠️  Could not determine sex using any available method
[15:46:10] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:46:10] ✅ Patient name cross-validation successful
[15:46:10] ✅    ✅ Data merged successfully
[15:46:11] ✅    ✅ Order data extracted and validated
[15:46:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:11] [DOC: 9223251] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:11] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:11] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:11] [DOC: 9223251] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:12] [DOC: 9223251] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13125"}
[15:46:12] ❌    ❌ Failed to push order
[15:46:12] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:12] [DOC: 9223251] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[15:46:12] [DOC: 9223251] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:46:12] [DOC: 9223251] ℹ️  Payer Source extracted: ''
[15:46:12] [DOC: 9223251] ℹ️  Diagnosis codes being written:
[15:46:12] [DOC: 9223251] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:46:12] [DOC: 9223251] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[15:46:12] [DOC: 9223251] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.0'
[15:46:12] [DOC: 9223251] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:46:12] [DOC: 9223251] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:46:12] [DOC: 9223251] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:46:12] [DOC: 9223251] ✅ Patient data written to CSV: Theresa Racine | Sex:  | Age: 68 | Service: Occupational Therapy | Payer:  | MRN: MA250130025704
[15:46:12] ✅    ✅ Document 9223251 processed and saved successfully
[15:46:12] 🔄 
🔄 Step 8: Saving API details...
[15:46:12] [DOC: 9223251] ℹ️  API push details saved for document 9223251
[15:46:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223249                         ║
================================================================================
[15:46:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:46:12] ℹ️  Date: 04/04/2025
[15:46:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:15] [DOC: 9223249] ✅ Text extracted using pdfplumber (1529 chars)
[15:46:15] ✅    ✅ Text extracted using pdfplumber (1529 chars)
[15:46:15] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:18] ℹ️  AI extracted raw sex value: ''
[15:46:18] ℹ️  AI extracted service line: 'Physical Therapy'
[15:46:18] ℹ️  AI extracted payer source: ''
[15:46:18] ℹ️  AI extracted diagnoses:
[15:46:18] ℹ️    - Diagnosis 1: 'J44.1'
[15:46:18] ℹ️    - Diagnosis 2: 'J18.9'
[15:46:18] ℹ️    - Diagnosis 3: 'J44.0'
[15:46:18] ℹ️    - Diagnosis 4: 'None'
[15:46:18] ℹ️    - Diagnosis 5: 'None'
[15:46:18] ℹ️    - Diagnosis 6: 'None'
[15:46:18] ℹ️  Final extracted MRN: 'MA250130025704'
[15:46:18] ℹ️  Final extracted Sex: ''
[15:46:18] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:46:18] ℹ️  Final extracted Payer Source: ''
[15:46:18] ✅ Patient data extraction completed successfully
[15:46:18] ✅    ✅ Patient data extracted successfully
[15:46:18] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:46:18] ✅    ✅ Patient identified: Theresa Racine
[15:46:18] ✅    ✅ Patient name validation passed
[15:46:18] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:18] [DOC: 9223249] ℹ️  DOB normalized: 02/10/1957
[15:46:18] [DOC: 9223249] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:46:18] [DOC: 9223249] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:46:18] [DOC: 9223249] ✅ Patient date processing completed successfully
[15:46:18] ✅    ✅ Date processing completed
[15:46:18] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0'}]
[15:46:18] 🔄 
🔄 Step 4: Extracting order data...
[15:46:20] ℹ️  Order extraction - MRN: 'MA250130025704'
[15:46:20] ℹ️  Order extraction - Sex: ''
[15:46:20] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:46:20] ℹ️  Order extraction - Payer Source: ''
[15:46:20] ✅ Order data extraction completed successfully
[15:46:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:20] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[15:46:20] ⚠️  Could not determine sex using any available method
[15:46:20] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:46:20] ✅ Patient name cross-validation successful
[15:46:20] ✅    ✅ Data merged successfully
[15:46:21] ✅    ✅ Order data extracted and validated
[15:46:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:21] [DOC: 9223249] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:21] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:21] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:21] [DOC: 9223249] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:22] [DOC: 9223249] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13126"}
[15:46:22] ❌    ❌ Failed to push order
[15:46:22] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:22] [DOC: 9223249] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[15:46:22] [DOC: 9223249] ℹ️  Service Line extracted: 'Physical Therapy'
[15:46:22] [DOC: 9223249] ℹ️  Payer Source extracted: ''
[15:46:22] [DOC: 9223249] ℹ️  Diagnosis codes being written:
[15:46:22] [DOC: 9223249] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:46:22] [DOC: 9223249] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[15:46:22] [DOC: 9223249] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.0'
[15:46:22] [DOC: 9223249] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:46:22] [DOC: 9223249] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:46:22] [DOC: 9223249] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:46:22] [DOC: 9223249] ✅ Patient data written to CSV: Theresa Racine | Sex:  | Age: 68 | Service: Physical Therapy | Payer:  | MRN: MA250130025704
[15:46:22] ✅    ✅ Document 9223249 processed and saved successfully
[15:46:22] 🔄 
🔄 Step 8: Saving API details...
[15:46:22] [DOC: 9223249] ℹ️  API push details saved for document 9223249
[15:46:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223244                         ║
================================================================================
[15:46:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:46:22] ℹ️  Date: 04/04/2025
[15:46:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:25] [DOC: 9223244] ✅ Text extracted using pdfplumber (13532 chars)
[15:46:25] ✅    ✅ Text extracted using pdfplumber (13532 chars)
[15:46:25] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:28] ℹ️  AI extracted raw sex value: 'F'
[15:46:28] ℹ️  AI extracted service line: 'OT'
[15:46:28] ℹ️  AI extracted payer source: 'None'
[15:46:28] ℹ️  AI extracted diagnoses:
[15:46:28] ℹ️    - Diagnosis 1: 'None'
[15:46:28] ℹ️    - Diagnosis 2: 'None'
[15:46:28] ℹ️    - Diagnosis 3: 'None'
[15:46:28] ℹ️    - Diagnosis 4: 'None'
[15:46:28] ℹ️    - Diagnosis 5: 'None'
[15:46:28] ℹ️    - Diagnosis 6: 'None'
[15:46:28] ℹ️  Final extracted MRN: 'MA250130025704'
[15:46:28] ℹ️  Final extracted Sex: 'FEMALE'
[15:46:28] ℹ️  Final extracted Service Line: 'OT'
[15:46:28] ℹ️  Final extracted Payer Source: ''
[15:46:28] ✅ Patient data extraction completed successfully
[15:46:28] ✅    ✅ Patient data extracted successfully
[15:46:28] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/05/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:46:28] ✅    ✅ Patient identified: Theresa Racine
[15:46:28] ✅    ✅ Patient name validation passed
[15:46:28] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:28] [DOC: 9223244] ℹ️  DOB normalized: 02/10/1957
[15:46:28] [DOC: 9223244] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[15:46:28] [DOC: 9223244] ✅ Patient date processing completed successfully
[15:46:28] ✅    ✅ Date processing completed
[15:46:28] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025'}]
[15:46:28] 🔄 
🔄 Step 4: Extracting order data...
[15:46:31] ℹ️  Order extraction - MRN: 'MA250130025704'
[15:46:31] ℹ️  Order extraction - Sex: 'FEMALE'
[15:46:31] ℹ️  Order extraction - Service Line: 'OT'
[15:46:31] ℹ️  Order extraction - Payer Source: ''
[15:46:31] ✅ Order data extraction completed successfully
[15:46:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:31] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[15:46:31] ℹ️  Service line consistent in both sources: 'OT'
[15:46:31] ✅ Patient name cross-validation successful
[15:46:31] ✅    ✅ Data merged successfully
[15:46:32] ✅    ✅ Order data extracted and validated
[15:46:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:32] [DOC: 9223244] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:32] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:32] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:32] [DOC: 9223244] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:33] [DOC: 9223244] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:46:33] ❌    ❌ Failed to push order
[15:46:33] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:33] [DOC: 9223244] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[15:46:33] [DOC: 9223244] ℹ️  Service Line extracted: 'OT'
[15:46:33] [DOC: 9223244] ℹ️  Payer Source extracted: ''
[15:46:33] [DOC: 9223244] ℹ️  Diagnosis codes being written:
[15:46:33] [DOC: 9223244] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:46:33] [DOC: 9223244] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:46:33] [DOC: 9223244] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:46:33] [DOC: 9223244] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:46:33] [DOC: 9223244] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:46:33] [DOC: 9223244] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:46:33] [DOC: 9223244] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: OT | Payer:  | MRN: MA250130025704
[15:46:33] ✅    ✅ Document 9223244 processed and saved successfully
[15:46:33] 🔄 
🔄 Step 8: Saving API details...
[15:46:33] [DOC: 9223244] ℹ️  API push details saved for document 9223244
[15:46:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223240                         ║
================================================================================
[15:46:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:46:33] ℹ️  Date: 04/04/2025
[15:46:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:36] [DOC: 9223240] ✅ Text extracted using pdfplumber (19111 chars)
[15:46:36] ✅    ✅ Text extracted using pdfplumber (19111 chars)
[15:46:36] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:39] ℹ️  AI extracted raw sex value: 'F'
[15:46:39] ℹ️  AI extracted service line: 'PT'
[15:46:39] ℹ️  AI extracted payer source: 'None'
[15:46:39] ℹ️  AI extracted diagnoses:
[15:46:39] ℹ️    - Diagnosis 1: 'None'
[15:46:39] ℹ️    - Diagnosis 2: 'None'
[15:46:39] ℹ️    - Diagnosis 3: 'None'
[15:46:39] ℹ️    - Diagnosis 4: 'None'
[15:46:39] ℹ️    - Diagnosis 5: 'None'
[15:46:39] ℹ️    - Diagnosis 6: 'None'
[15:46:39] ℹ️  Final extracted MRN: 'MA250130025704'
[15:46:39] ℹ️  Final extracted Sex: 'FEMALE'
[15:46:39] ℹ️  Final extracted Service Line: 'PT'
[15:46:39] ℹ️  Final extracted Payer Source: ''
[15:46:39] ✅ Patient data extraction completed successfully
[15:46:39] ✅    ✅ Patient data extracted successfully
[15:46:39] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/05/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:46:39] ✅    ✅ Patient identified: Theresa Racine
[15:46:39] ✅    ✅ Patient name validation passed
[15:46:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:39] [DOC: 9223240] ℹ️  DOB normalized: 02/10/1957
[15:46:39] [DOC: 9223240] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[15:46:39] [DOC: 9223240] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:46:39] [DOC: 9223240] ✅ Patient date processing completed successfully
[15:46:39] ✅    ✅ Date processing completed
[15:46:39] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '04/28/2025'}]
[15:46:39] 🔄 
🔄 Step 4: Extracting order data...
[15:46:42] ℹ️  Order extraction - MRN: 'MA250130025704'
[15:46:42] ℹ️  Order extraction - Sex: 'FEMALE'
[15:46:42] ℹ️  Order extraction - Service Line: 'PT'
[15:46:42] ℹ️  Order extraction - Payer Source: ''
[15:46:42] ✅ Order data extraction completed successfully
[15:46:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:42] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[15:46:42] ℹ️  Service line consistent in both sources: 'PT'
[15:46:42] ✅ Patient name cross-validation successful
[15:46:42] ✅    ✅ Data merged successfully
[15:46:44] ✅    ✅ Order data extracted and validated
[15:46:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:44] [DOC: 9223240] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:44] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:44] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:44] [DOC: 9223240] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:45] [DOC: 9223240] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:46:45] ❌    ❌ Failed to push order
[15:46:45] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:45] [DOC: 9223240] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[15:46:45] [DOC: 9223240] ℹ️  Service Line extracted: 'PT'
[15:46:45] [DOC: 9223240] ℹ️  Payer Source extracted: ''
[15:46:45] [DOC: 9223240] ℹ️  Diagnosis codes being written:
[15:46:45] [DOC: 9223240] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:46:45] [DOC: 9223240] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:46:45] [DOC: 9223240] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:46:45] [DOC: 9223240] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:46:45] [DOC: 9223240] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:46:45] [DOC: 9223240] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:46:45] [DOC: 9223240] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: PT | Payer:  | MRN: MA250130025704
[15:46:45] ✅    ✅ Document 9223240 processed and saved successfully
[15:46:45] 🔄 
🔄 Step 8: Saving API details...
[15:46:45] [DOC: 9223240] ℹ️  API push details saved for document 9223240
[15:46:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223238                         ║
================================================================================
[15:46:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:46:45] ℹ️  Date: 04/04/2025
[15:46:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:47] [DOC: 9223238] ✅ Text extracted using pdfplumber (1209 chars)
[15:46:47] ✅    ✅ Text extracted using pdfplumber (1209 chars)
[15:46:47] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:50] ℹ️  AI extracted raw sex value: ''
[15:46:50] ℹ️  AI extracted service line: 'PT, OT, Skilled Nursing'
[15:46:50] ℹ️  AI extracted payer source: ''
[15:46:50] ℹ️  AI extracted diagnoses:
[15:46:50] ℹ️    - Diagnosis 1: 'J44.1'
[15:46:50] ℹ️    - Diagnosis 2: 'J18.9'
[15:46:50] ℹ️    - Diagnosis 3: 'J44.0'
[15:46:50] ℹ️    - Diagnosis 4: ''
[15:46:50] ℹ️    - Diagnosis 5: ''
[15:46:50] ℹ️    - Diagnosis 6: ''
[15:46:50] ℹ️  Final extracted MRN: 'MA250130025704'
[15:46:50] ℹ️  Final extracted Sex: ''
[15:46:50] ℹ️  Final extracted Service Line: 'PT, OT, Skilled Nursing'
[15:46:50] ℹ️  Final extracted Payer Source: ''
[15:46:50] ✅ Patient data extraction completed successfully
[15:46:50] ✅    ✅ Patient data extracted successfully
[15:46:50] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:46:50] ✅    ✅ Patient identified: Theresa Racine
[15:46:50] ✅    ✅ Patient name validation passed
[15:46:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:50] [DOC: 9223238] ℹ️  DOB normalized: 02/10/1957
[15:46:50] [DOC: 9223238] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:46:50] [DOC: 9223238] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:46:50] [DOC: 9223238] ✅ Patient date processing completed successfully
[15:46:50] ✅    ✅ Date processing completed
[15:46:50] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:46:50] 🔄 
🔄 Step 4: Extracting order data...
[15:46:53] ℹ️  Order extraction - MRN: 'MA250130025704'
[15:46:53] ℹ️  Order extraction - Sex: ''
[15:46:53] ℹ️  Order extraction - Service Line: 'SN, PT, OT'
[15:46:53] ℹ️  Order extraction - Payer Source: ''
[15:46:53] ✅ Order data extraction completed successfully
[15:46:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:53] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[15:46:53] ⚠️  Could not determine sex using any available method
[15:46:53] ℹ️  Combined service lines: Patient='PT, OT, Skilled Nursing' + Order='SN, PT, OT' = 'OT, PT, SN, Skilled Nursing'
[15:46:53] ✅ Patient name cross-validation successful
[15:46:53] ✅    ✅ Data merged successfully
[15:46:54] ✅    ✅ Order data extracted and validated
[15:46:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:54] [DOC: 9223238] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:54] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:54] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:54] [DOC: 9223238] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[15:46:55] [DOC: 9223238] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13128"}
[15:46:55] ❌    ❌ Failed to push order
[15:46:55] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:55] [DOC: 9223238] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[15:46:55] [DOC: 9223238] ℹ️  Service Line extracted: 'OT, PT, SN, Skilled Nursing'
[15:46:55] [DOC: 9223238] ℹ️  Payer Source extracted: ''
[15:46:55] [DOC: 9223238] ℹ️  Diagnosis codes being written:
[15:46:55] [DOC: 9223238] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:46:55] [DOC: 9223238] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[15:46:55] [DOC: 9223238] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.0'
[15:46:55] [DOC: 9223238] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:46:55] [DOC: 9223238] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:46:55] [DOC: 9223238] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:46:55] [DOC: 9223238] ✅ Patient data written to CSV: Theresa Racine | Sex:  | Age: 68 | Service: OT, PT, SN, Skilled Nursing | Payer:  | MRN: MA250130025704
[15:46:55] ✅    ✅ Document 9223238 processed and saved successfully
[15:46:55] 🔄 
🔄 Step 8: Saving API details...
[15:46:55] [DOC: 9223238] ℹ️  API push details saved for document 9223238
[15:46:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223182                         ║
================================================================================
[15:46:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:46:55] ℹ️  Date: 04/04/2025
[15:46:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:57] [DOC: 9223182] ✅ Text extracted using pdfplumber (1316 chars)
[15:46:57] ✅    ✅ Text extracted using pdfplumber (1316 chars)
[15:46:57] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:00] ℹ️  AI extracted raw sex value: ''
[15:47:00] ℹ️  AI extracted service line: 'Speech Therapy'
[15:47:00] ℹ️  AI extracted payer source: ''
[15:47:00] ℹ️  AI extracted diagnoses:
[15:47:00] ℹ️    - Diagnosis 1: 'E11.65'
[15:47:00] ℹ️    - Diagnosis 2: 'I10'
[15:47:00] ℹ️    - Diagnosis 3: 'H54.8'
[15:47:00] ℹ️    - Diagnosis 4: 'None'
[15:47:00] ℹ️    - Diagnosis 5: 'None'
[15:47:00] ℹ️    - Diagnosis 6: 'None'
[15:47:00] ℹ️  Final extracted MRN: 'MA210907053505'
[15:47:00] ℹ️  Final extracted Sex: ''
[15:47:00] ℹ️  Final extracted Service Line: 'Speech Therapy'
[15:47:00] ℹ️  Final extracted Payer Source: ''
[15:47:00] ✅ Patient data extraction completed successfully
[15:47:00] ✅    ✅ Patient data extracted successfully
[15:47:00] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:00] ✅    ✅ Patient identified: Rolande Morrell
[15:47:00] ✅    ✅ Patient name validation passed
[15:47:00] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:00] [DOC: 9223182] ℹ️  DOB normalized: 05/15/1935
[15:47:00] [DOC: 9223182] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:47:00] [DOC: 9223182] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:47:00] [DOC: 9223182] ✅ Patient date processing completed successfully
[15:47:00] ✅    ✅ Date processing completed
[15:47:00] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[15:47:00] 🔄 
🔄 Step 4: Extracting order data...
[15:47:03] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:47:03] ℹ️  Order extraction - Sex: ''
[15:47:03] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[15:47:03] ℹ️  Order extraction - Payer Source: ''
[15:47:03] ✅ Order data extraction completed successfully
[15:47:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:03] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:47:03] ⚠️  Could not determine sex using any available method
[15:47:03] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[15:47:03] ✅ Patient name cross-validation successful
[15:47:03] ✅    ✅ Data merged successfully
[15:47:04] ✅    ✅ Order data extracted and validated
[15:47:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:04] [DOC: 9223182] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:04] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:04] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:04] [DOC: 9223182] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:05] [DOC: 9223182] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14151"}
[15:47:05] ❌    ❌ Failed to push order
[15:47:05] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:05] [DOC: 9223182] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:47:05] [DOC: 9223182] ℹ️  Service Line extracted: 'Speech Therapy'
[15:47:05] [DOC: 9223182] ℹ️  Payer Source extracted: ''
[15:47:05] [DOC: 9223182] ℹ️  Diagnosis codes being written:
[15:47:05] [DOC: 9223182] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:47:05] [DOC: 9223182] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:47:05] [DOC: 9223182] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:47:05] [DOC: 9223182] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:05] [DOC: 9223182] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:05] [DOC: 9223182] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:05] [DOC: 9223182] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Speech Therapy | Payer:  | MRN: MA210907053505
[15:47:05] ✅    ✅ Document 9223182 processed and saved successfully
[15:47:05] 🔄 
🔄 Step 8: Saving API details...
[15:47:05] [DOC: 9223182] ℹ️  API push details saved for document 9223182
[15:47:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223179                         ║
================================================================================
[15:47:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:47:05] ℹ️  Date: 04/04/2025
[15:47:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:07] [DOC: 9223179] ✅ Text extracted using pdfplumber (1417 chars)
[15:47:07] ✅    ✅ Text extracted using pdfplumber (1417 chars)
[15:47:07] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:10] ℹ️  AI extracted raw sex value: ''
[15:47:10] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:47:10] ℹ️  AI extracted payer source: ''
[15:47:10] ℹ️  AI extracted diagnoses:
[15:47:10] ℹ️    - Diagnosis 1: 'E11.65'
[15:47:10] ℹ️    - Diagnosis 2: 'I10'
[15:47:10] ℹ️    - Diagnosis 3: 'H54.8'
[15:47:10] ℹ️    - Diagnosis 4: 'None'
[15:47:10] ℹ️    - Diagnosis 5: 'None'
[15:47:10] ℹ️    - Diagnosis 6: 'None'
[15:47:10] ℹ️  Final extracted MRN: 'MA210907053505'
[15:47:10] ℹ️  Final extracted Sex: ''
[15:47:10] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:47:10] ℹ️  Final extracted Payer Source: ''
[15:47:10] ✅ Patient data extraction completed successfully
[15:47:10] ✅    ✅ Patient data extracted successfully
[15:47:10] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:10] ✅    ✅ Patient identified: Rolande Morrell
[15:47:10] ✅    ✅ Patient name validation passed
[15:47:10] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:10] [DOC: 9223179] ℹ️  DOB normalized: 05/15/1935
[15:47:10] [DOC: 9223179] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:47:10] [DOC: 9223179] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:47:10] [DOC: 9223179] ✅ Patient date processing completed successfully
[15:47:10] ✅    ✅ Date processing completed
[15:47:10] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[15:47:10] 🔄 
🔄 Step 4: Extracting order data...
[15:47:13] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:47:13] ℹ️  Order extraction - Sex: ''
[15:47:13] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:47:13] ℹ️  Order extraction - Payer Source: ''
[15:47:13] ✅ Order data extraction completed successfully
[15:47:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:13] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:47:13] ⚠️  Could not determine sex using any available method
[15:47:13] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:47:13] ✅ Patient name cross-validation successful
[15:47:13] ✅    ✅ Data merged successfully
[15:47:14] ✅    ✅ Order data extracted and validated
[15:47:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:14] [DOC: 9223179] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:14] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:14] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:14] [DOC: 9223179] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:15] [DOC: 9223179] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14156"}
[15:47:15] ❌    ❌ Failed to push order
[15:47:15] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:15] [DOC: 9223179] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:47:15] [DOC: 9223179] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:47:15] [DOC: 9223179] ℹ️  Payer Source extracted: ''
[15:47:15] [DOC: 9223179] ℹ️  Diagnosis codes being written:
[15:47:15] [DOC: 9223179] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:47:15] [DOC: 9223179] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:47:15] [DOC: 9223179] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:47:15] [DOC: 9223179] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:15] [DOC: 9223179] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:15] [DOC: 9223179] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:15] [DOC: 9223179] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Occupational Therapy | Payer:  | MRN: MA210907053505
[15:47:15] ✅    ✅ Document 9223179 processed and saved successfully
[15:47:15] 🔄 
🔄 Step 8: Saving API details...
[15:47:15] [DOC: 9223179] ℹ️  API push details saved for document 9223179
[15:47:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223177                         ║
================================================================================
[15:47:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:47:15] ℹ️  Date: 04/04/2025
[15:47:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:17] [DOC: 9223177] ✅ Text extracted using pdfplumber (1350 chars)
[15:47:17] ✅    ✅ Text extracted using pdfplumber (1350 chars)
[15:47:17] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:20] ℹ️  AI extracted raw sex value: ''
[15:47:20] ℹ️  AI extracted service line: 'Speech Therapy'
[15:47:20] ℹ️  AI extracted payer source: ''
[15:47:20] ℹ️  AI extracted diagnoses:
[15:47:20] ℹ️    - Diagnosis 1: 'E11.65'
[15:47:20] ℹ️    - Diagnosis 2: 'I10'
[15:47:20] ℹ️    - Diagnosis 3: 'H54.8'
[15:47:20] ℹ️    - Diagnosis 4: 'None'
[15:47:20] ℹ️    - Diagnosis 5: 'None'
[15:47:20] ℹ️    - Diagnosis 6: 'None'
[15:47:20] ℹ️  Final extracted MRN: 'MA210907053505'
[15:47:20] ℹ️  Final extracted Sex: ''
[15:47:20] ℹ️  Final extracted Service Line: 'Speech Therapy'
[15:47:20] ℹ️  Final extracted Payer Source: ''
[15:47:20] ✅ Patient data extraction completed successfully
[15:47:20] ✅    ✅ Patient data extracted successfully
[15:47:20] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:20] ✅    ✅ Patient identified: Rolande Morrell
[15:47:20] ✅    ✅ Patient name validation passed
[15:47:20] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:20] [DOC: 9223177] ℹ️  DOB normalized: 05/15/1935
[15:47:20] [DOC: 9223177] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:47:20] [DOC: 9223177] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:47:20] [DOC: 9223177] ✅ Patient date processing completed successfully
[15:47:20] ✅    ✅ Date processing completed
[15:47:20] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[15:47:20] 🔄 
🔄 Step 4: Extracting order data...
[15:47:23] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:47:23] ℹ️  Order extraction - Sex: ''
[15:47:23] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[15:47:23] ℹ️  Order extraction - Payer Source: ''
[15:47:23] ✅ Order data extraction completed successfully
[15:47:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:23] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:47:23] ⚠️  Could not determine sex using any available method
[15:47:23] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[15:47:23] ✅ Patient name cross-validation successful
[15:47:23] ✅    ✅ Data merged successfully
[15:47:24] ✅    ✅ Order data extracted and validated
[15:47:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:24] [DOC: 9223177] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:24] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:24] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:24] [DOC: 9223177] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:25] [DOC: 9223177] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14157"}
[15:47:25] ❌    ❌ Failed to push order
[15:47:25] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:25] [DOC: 9223177] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:47:25] [DOC: 9223177] ℹ️  Service Line extracted: 'Speech Therapy'
[15:47:25] [DOC: 9223177] ℹ️  Payer Source extracted: ''
[15:47:25] [DOC: 9223177] ℹ️  Diagnosis codes being written:
[15:47:25] [DOC: 9223177] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:47:25] [DOC: 9223177] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:47:25] [DOC: 9223177] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:47:25] [DOC: 9223177] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:25] [DOC: 9223177] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:25] [DOC: 9223177] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:25] [DOC: 9223177] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Speech Therapy | Payer:  | MRN: MA210907053505
[15:47:25] ✅    ✅ Document 9223177 processed and saved successfully
[15:47:25] 🔄 
🔄 Step 8: Saving API details...
[15:47:25] [DOC: 9223177] ℹ️  API push details saved for document 9223177
[15:47:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223174                         ║
================================================================================
[15:47:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:47:25] ℹ️  Date: 04/04/2025
[15:47:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:28] [DOC: 9223174] ✅ Text extracted using pdfplumber (11855 chars)
[15:47:28] ✅    ✅ Text extracted using pdfplumber (11855 chars)
[15:47:28] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:31] ℹ️  AI extracted raw sex value: ''
[15:47:31] ℹ️  AI extracted service line: 'OT'
[15:47:31] ℹ️  AI extracted payer source: ''
[15:47:31] ℹ️  AI extracted diagnoses:
[15:47:31] ℹ️    - Diagnosis 1: 'Diabetes'
[15:47:31] ℹ️    - Diagnosis 2: 'Fall'
[15:47:31] ℹ️    - Diagnosis 3: 'influenza a'
[15:47:31] ℹ️    - Diagnosis 4: 'None'
[15:47:31] ℹ️    - Diagnosis 5: 'None'
[15:47:31] ℹ️    - Diagnosis 6: 'None'
[15:47:31] ℹ️  Final extracted MRN: 'MA210907053505'
[15:47:31] ℹ️  Final extracted Sex: ''
[15:47:31] ℹ️  Final extracted Service Line: 'OT'
[15:47:31] ℹ️  Final extracted Payer Source: ''
[15:47:31] ✅ Patient data extraction completed successfully
[15:47:31] ✅    ✅ Patient data extracted successfully
[15:47:31] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/15/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Diabetes', 'secondDiagnosis': 'Fall', 'thirdDiagnosis': 'influenza a', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:31] ✅    ✅ Patient identified: Rolande Morrell
[15:47:31] ✅    ✅ Patient name validation passed
[15:47:31] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:31] [DOC: 9223174] ℹ️  DOB normalized: 05/15/1935
[15:47:31] [DOC: 9223174] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[15:47:31] [DOC: 9223174] ✅ Patient date processing completed successfully
[15:47:31] ✅    ✅ Date processing completed
[15:47:31] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/15/2025', 'firstDiagnosis': 'Diabetes', 'secondDiagnosis': 'Fall', 'thirdDiagnosis': 'influenza a'}]
[15:47:31] 🔄 
🔄 Step 4: Extracting order data...
[15:47:34] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:47:34] ℹ️  Order extraction - Sex: ''
[15:47:34] ℹ️  Order extraction - Service Line: 'OT'
[15:47:34] ℹ️  Order extraction - Payer Source: ''
[15:47:34] ✅ Order data extraction completed successfully
[15:47:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:34] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:47:34] ⚠️  Could not determine sex using any available method
[15:47:34] ℹ️  Service line consistent in both sources: 'OT'
[15:47:34] ✅ Patient name cross-validation successful
[15:47:34] ✅    ✅ Data merged successfully
[15:47:35] ✅    ✅ Order data extracted and validated
[15:47:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:35] [DOC: 9223174] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:35] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:35] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:35] [DOC: 9223174] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:36] [DOC: 9223174] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:47:36] ❌    ❌ Failed to push order
[15:47:36] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:36] [DOC: 9223174] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:47:36] [DOC: 9223174] ℹ️  Service Line extracted: 'OT'
[15:47:36] [DOC: 9223174] ℹ️  Payer Source extracted: ''
[15:47:36] [DOC: 9223174] ℹ️  Diagnosis codes being written:
[15:47:36] [DOC: 9223174] ℹ️    - Latest_Episode_Firstdiagnosis: 'Diabetes'
[15:47:36] [DOC: 9223174] ℹ️    - Latest_Episode_Seconddiagnosis: 'Fall'
[15:47:36] [DOC: 9223174] ℹ️    - Latest_Episode_Thirddiagnosis: 'influenza a'
[15:47:36] [DOC: 9223174] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:36] [DOC: 9223174] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:36] [DOC: 9223174] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:36] [DOC: 9223174] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: OT | Payer:  | MRN: MA210907053505
[15:47:36] ✅    ✅ Document 9223174 processed and saved successfully
[15:47:36] 🔄 
🔄 Step 8: Saving API details...
[15:47:36] [DOC: 9223174] ℹ️  API push details saved for document 9223174
[15:47:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223172                         ║
================================================================================
[15:47:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:47:36] ℹ️  Date: 04/04/2025
[15:47:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:38] [DOC: 9223172] ✅ Text extracted using pdfplumber (1480 chars)
[15:47:38] ✅    ✅ Text extracted using pdfplumber (1480 chars)
[15:47:38] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:41] ℹ️  AI extracted raw sex value: ''
[15:47:41] ℹ️  AI extracted service line: 'Physical Therapy'
[15:47:41] ℹ️  AI extracted payer source: ''
[15:47:41] ℹ️  AI extracted diagnoses:
[15:47:41] ℹ️    - Diagnosis 1: 'E11.65'
[15:47:41] ℹ️    - Diagnosis 2: 'I10'
[15:47:41] ℹ️    - Diagnosis 3: 'H54.8'
[15:47:41] ℹ️    - Diagnosis 4: 'None'
[15:47:41] ℹ️    - Diagnosis 5: 'None'
[15:47:41] ℹ️    - Diagnosis 6: 'None'
[15:47:41] ℹ️  Final extracted MRN: 'MA210907053505'
[15:47:41] ℹ️  Final extracted Sex: ''
[15:47:41] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:47:41] ℹ️  Final extracted Payer Source: ''
[15:47:41] ✅ Patient data extraction completed successfully
[15:47:41] ✅    ✅ Patient data extracted successfully
[15:47:41] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:41] ✅    ✅ Patient identified: Rolande Morrell
[15:47:41] ✅    ✅ Patient name validation passed
[15:47:41] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:41] [DOC: 9223172] ℹ️  DOB normalized: 05/15/1935
[15:47:41] [DOC: 9223172] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:47:41] [DOC: 9223172] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:47:41] [DOC: 9223172] ✅ Patient date processing completed successfully
[15:47:41] ✅    ✅ Date processing completed
[15:47:41] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[15:47:41] 🔄 
🔄 Step 4: Extracting order data...
[15:47:44] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:47:44] ℹ️  Order extraction - Sex: ''
[15:47:44] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:47:44] ℹ️  Order extraction - Payer Source: ''
[15:47:44] ✅ Order data extraction completed successfully
[15:47:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:44] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:47:44] ⚠️  Could not determine sex using any available method
[15:47:44] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:47:44] ✅ Patient name cross-validation successful
[15:47:44] ✅    ✅ Data merged successfully
[15:47:46] ✅    ✅ Order data extracted and validated
[15:47:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:46] [DOC: 9223172] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:46] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:46] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:46] [DOC: 9223172] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:47] [DOC: 9223172] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14159"}
[15:47:47] ❌    ❌ Failed to push order
[15:47:47] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:47] [DOC: 9223172] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:47:47] [DOC: 9223172] ℹ️  Service Line extracted: 'Physical Therapy'
[15:47:47] [DOC: 9223172] ℹ️  Payer Source extracted: ''
[15:47:47] [DOC: 9223172] ℹ️  Diagnosis codes being written:
[15:47:47] [DOC: 9223172] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:47:47] [DOC: 9223172] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:47:47] [DOC: 9223172] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:47:47] [DOC: 9223172] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:47] [DOC: 9223172] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:47] [DOC: 9223172] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:47] [DOC: 9223172] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Physical Therapy | Payer:  | MRN: MA210907053505
[15:47:47] ✅    ✅ Document 9223172 processed and saved successfully
[15:47:47] 🔄 
🔄 Step 8: Saving API details...
[15:47:47] [DOC: 9223172] ℹ️  API push details saved for document 9223172
[15:47:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223171                         ║
================================================================================
[15:47:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:47:47] ℹ️  Date: 04/04/2025
[15:47:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:49] [DOC: 9223171] ✅ Text extracted using pdfplumber (1487 chars)
[15:47:49] ✅    ✅ Text extracted using pdfplumber (1487 chars)
[15:47:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:52] ℹ️  AI extracted raw sex value: ''
[15:47:52] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[15:47:52] ℹ️  AI extracted payer source: ''
[15:47:52] ℹ️  AI extracted diagnoses:
[15:47:52] ℹ️    - Diagnosis 1: 'E11.65'
[15:47:52] ℹ️    - Diagnosis 2: 'I10'
[15:47:52] ℹ️    - Diagnosis 3: 'H54.8'
[15:47:52] ℹ️    - Diagnosis 4: ''
[15:47:52] ℹ️    - Diagnosis 5: ''
[15:47:52] ℹ️    - Diagnosis 6: ''
[15:47:52] ℹ️  Final extracted MRN: 'MA210907053505'
[15:47:52] ℹ️  Final extracted Sex: ''
[15:47:52] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[15:47:52] ℹ️  Final extracted Payer Source: ''
[15:47:52] ✅ Patient data extraction completed successfully
[15:47:52] ✅    ✅ Patient data extracted successfully
[15:47:52] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:47:52] ✅    ✅ Patient identified: Rolande Morrell
[15:47:52] ✅    ✅ Patient name validation passed
[15:47:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:52] [DOC: 9223171] ℹ️  DOB normalized: 05/15/1935
[15:47:52] [DOC: 9223171] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:47:52] [DOC: 9223171] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:47:52] [DOC: 9223171] ✅ Patient date processing completed successfully
[15:47:52] ✅    ✅ Date processing completed
[15:47:52] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:47:52] 🔄 
🔄 Step 4: Extracting order data...
[15:47:55] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:47:55] ℹ️  Order extraction - Sex: ''
[15:47:55] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[15:47:55] ℹ️  Order extraction - Payer Source: ''
[15:47:55] ✅ Order data extraction completed successfully
[15:47:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:55] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:47:55] ⚠️  Could not determine sex using any available method
[15:47:55] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[15:47:55] ✅ Patient name cross-validation successful
[15:47:55] ✅    ✅ Data merged successfully
[15:47:56] ✅    ✅ Order data extracted and validated
[15:47:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:56] [DOC: 9223171] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:56] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:56] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:56] [DOC: 9223171] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:47:58] [DOC: 9223171] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14160"}
[15:47:58] ❌    ❌ Failed to push order
[15:47:58] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:58] [DOC: 9223171] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:47:58] [DOC: 9223171] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[15:47:58] [DOC: 9223171] ℹ️  Payer Source extracted: ''
[15:47:58] [DOC: 9223171] ℹ️  Diagnosis codes being written:
[15:47:58] [DOC: 9223171] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:47:58] [DOC: 9223171] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:47:58] [DOC: 9223171] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:47:58] [DOC: 9223171] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:58] [DOC: 9223171] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:58] [DOC: 9223171] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:58] [DOC: 9223171] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: MA210907053505
[15:47:58] ✅    ✅ Document 9223171 processed and saved successfully
[15:47:58] 🔄 
🔄 Step 8: Saving API details...
[15:47:58] [DOC: 9223171] ℹ️  API push details saved for document 9223171
[15:47:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223170                         ║
================================================================================
[15:47:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:47:58] ℹ️  Date: 04/04/2025
[15:47:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:00] [DOC: 9223170] ✅ Text extracted using pdfplumber (10496 chars)
[15:48:00] ✅    ✅ Text extracted using pdfplumber (10496 chars)
[15:48:00] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:03] ℹ️  AI extracted raw sex value: 'F'
[15:48:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:48:03] ℹ️  AI extracted payer source: 'Medicare'
[15:48:03] ℹ️  AI extracted diagnoses:
[15:48:03] ℹ️    - Diagnosis 1: 'E11.65'
[15:48:03] ℹ️    - Diagnosis 2: 'I10'
[15:48:03] ℹ️    - Diagnosis 3: 'H54.8'
[15:48:03] ℹ️    - Diagnosis 4: 'H40.9'
[15:48:03] ℹ️    - Diagnosis 5: 'F32.A'
[15:48:03] ℹ️    - Diagnosis 6: 'E03.9'
[15:48:03] ℹ️  Final extracted MRN: 'MA210907053505'
[15:48:03] ℹ️  Final extracted Sex: 'FEMALE'
[15:48:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:48:03] ℹ️  Final extracted Payer Source: 'Medicare'
[15:48:03] ✅ Patient data extraction completed successfully
[15:48:03] ✅    ✅ Patient data extracted successfully
[15:48:03] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 996-8943
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/01/2021', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': 'H40.9', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'E03.9'}]
[15:48:03] ✅    ✅ Patient identified: Rolande Morrell
[15:48:03] ✅    ✅ Patient name validation passed
[15:48:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:03] [DOC: 9223170] ℹ️  DOB normalized: 05/15/1935
[15:48:03] [DOC: 9223170] ℹ️  Episode startOfCare normalized: 10/01/2021
[15:48:03] [DOC: 9223170] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:48:03] [DOC: 9223170] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:48:03] [DOC: 9223170] ✅ Patient date processing completed successfully
[15:48:03] ✅    ✅ Date processing completed
[15:48:03] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 996-8943
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/01/2021', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': 'H40.9', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'E03.9'}]
[15:48:03] 🔄 
🔄 Step 4: Extracting order data...
[15:48:06] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:48:06] ℹ️  Order extraction - Sex: 'FEMALE'
[15:48:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:48:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:48:06] ✅ Order data extraction completed successfully
[15:48:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:06] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:48:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:48:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:48:06] ✅ Patient name cross-validation successful
[15:48:06] ✅    ✅ Data merged successfully
[15:48:08] ✅    ✅ Order data extracted and validated
[15:48:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:08] [DOC: 9223170] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:48:08] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:48:08] 🔄 
🔄 Step 6: Pushing order to API...
[15:48:08] [DOC: 9223170] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:48:09] [DOC: 9223170] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14161"}
[15:48:09] ❌    ❌ Failed to push order
[15:48:09] 🔄 
🔄 Step 7: Writing to CSV...
[15:48:09] [DOC: 9223170] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:48:09] [DOC: 9223170] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:48:09] [DOC: 9223170] ℹ️  Payer Source extracted: 'Medicare'
[15:48:09] [DOC: 9223170] ℹ️  Diagnosis codes being written:
[15:48:09] [DOC: 9223170] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:48:09] [DOC: 9223170] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:48:09] [DOC: 9223170] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:48:09] [DOC: 9223170] ℹ️    - Latest_Episode_Fourthdiagnosis: 'H40.9'
[15:48:09] [DOC: 9223170] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.A'
[15:48:09] [DOC: 9223170] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E03.9'
[15:48:09] [DOC: 9223170] ✅ Patient data written to CSV: Rolande Morrell | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: MA210907053505
[15:48:09] ✅    ✅ Document 9223170 processed and saved successfully
[15:48:09] 🔄 
🔄 Step 8: Saving API details...
[15:48:09] [DOC: 9223170] ℹ️  API push details saved for document 9223170
[15:48:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223168                         ║
================================================================================
[15:48:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:48:09] ℹ️  Date: 04/04/2025
[15:48:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:11] [DOC: 9223168] ✅ Text extracted using pdfplumber (1239 chars)
[15:48:11] ✅    ✅ Text extracted using pdfplumber (1239 chars)
[15:48:11] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:14] ℹ️  AI extracted raw sex value: ''
[15:48:14] ℹ️  AI extracted service line: 'LPN'
[15:48:14] ℹ️  AI extracted payer source: ''
[15:48:14] ℹ️  AI extracted diagnoses:
[15:48:14] ℹ️    - Diagnosis 1: 'E11.65'
[15:48:14] ℹ️    - Diagnosis 2: 'I10'
[15:48:14] ℹ️    - Diagnosis 3: 'H54.8'
[15:48:14] ℹ️    - Diagnosis 4: 'None'
[15:48:14] ℹ️    - Diagnosis 5: 'None'
[15:48:14] ℹ️    - Diagnosis 6: 'None'
[15:48:14] ℹ️  Final extracted MRN: 'MA210907053505'
[15:48:14] ℹ️  Final extracted Sex: ''
[15:48:14] ℹ️  Final extracted Service Line: 'LPN'
[15:48:14] ℹ️  Final extracted Payer Source: ''
[15:48:14] ✅ Patient data extraction completed successfully
[15:48:14] ✅    ✅ Patient data extracted successfully
[15:48:14] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/13/2025', 'endOfEpisode': '03/13/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:48:14] ✅    ✅ Patient identified: Rolande Morrell
[15:48:14] ✅    ✅ Patient name validation passed
[15:48:14] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:14] [DOC: 9223168] ℹ️  DOB normalized: 05/15/1935
[15:48:14] [DOC: 9223168] ℹ️  Episode startOfEpisode normalized: 01/13/2025
[15:48:14] [DOC: 9223168] ℹ️  Episode endOfEpisode normalized: 03/13/2025
[15:48:14] [DOC: 9223168] ✅ Patient date processing completed successfully
[15:48:14] ✅    ✅ Date processing completed
[15:48:14] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/13/2025', 'endOfEpisode': '03/13/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[15:48:14] 🔄 
🔄 Step 4: Extracting order data...
[15:48:16] ℹ️  Order extraction - MRN: 'MA210907053505'
[15:48:16] ℹ️  Order extraction - Sex: ''
[15:48:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:48:16] ℹ️  Order extraction - Payer Source: ''
[15:48:16] ✅ Order data extraction completed successfully
[15:48:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:16] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[15:48:16] ⚠️  Could not determine sex using any available method
[15:48:16] ℹ️  Combined service lines: Patient='LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[15:48:16] ✅ Patient name cross-validation successful
[15:48:16] ✅    ✅ Data merged successfully
[15:48:18] ✅    ✅ Order data extracted and validated
[15:48:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:18] [DOC: 9223168] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:48:18] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:48:18] 🔄 
🔄 Step 6: Pushing order to API...
[15:48:18] [DOC: 9223168] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[15:48:19] [DOC: 9223168] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14162"}
[15:48:19] ❌    ❌ Failed to push order
[15:48:19] 🔄 
🔄 Step 7: Writing to CSV...
[15:48:19] [DOC: 9223168] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[15:48:19] [DOC: 9223168] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[15:48:19] [DOC: 9223168] ℹ️  Payer Source extracted: ''
[15:48:19] [DOC: 9223168] ℹ️  Diagnosis codes being written:
[15:48:19] [DOC: 9223168] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:48:19] [DOC: 9223168] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:48:19] [DOC: 9223168] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[15:48:19] [DOC: 9223168] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:48:19] [DOC: 9223168] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:48:19] [DOC: 9223168] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:48:19] [DOC: 9223168] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: LPN, Skilled Nursing | Payer:  | MRN: MA210907053505
[15:48:19] ✅    ✅ Document 9223168 processed and saved successfully
[15:48:19] 🔄 
🔄 Step 8: Saving API details...
[15:48:19] [DOC: 9223168] ℹ️  API push details saved for document 9223168
[15:48:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223139                         ║
================================================================================
[15:48:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:48:19] ℹ️  Date: 04/04/2025
[15:48:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:23] [DOC: 9223139] ✅ Text extracted using pdfplumber (19705 chars)
[15:48:23] ✅    ✅ Text extracted using pdfplumber (19705 chars)
[15:48:23] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:26] ℹ️  AI extracted raw sex value: 'M'
[15:48:26] ℹ️  AI extracted service line: 'PT'
[15:48:26] ℹ️  AI extracted payer source: ''
[15:48:26] ℹ️  AI extracted diagnoses:
[15:48:26] ℹ️    - Diagnosis 1: 'Q90.9'
[15:48:26] ℹ️    - Diagnosis 2: 'M62.84'
[15:48:26] ℹ️    - Diagnosis 3: 'J45.909'
[15:48:26] ℹ️    - Diagnosis 4: 'I27.81'
[15:48:26] ℹ️    - Diagnosis 5: 'E03.9'
[15:48:26] ℹ️    - Diagnosis 6: 'G47.33'
[15:48:26] ℹ️  Final extracted MRN: 'MA240808027001'
[15:48:26] ℹ️  Final extracted Sex: 'MALE'
[15:48:26] ℹ️  Final extracted Service Line: 'PT'
[15:48:26] ℹ️  Final extracted Payer Source: ''
[15:48:26] ✅ Patient data extraction completed successfully
[15:48:26] ✅    ✅ Patient data extracted successfully
[15:48:26] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Q90.9', 'secondDiagnosis': 'M62.84', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I27.81', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[15:48:26] ✅    ✅ Patient identified: Rafael Talavera
[15:48:26] ✅    ✅ Patient name validation passed
[15:48:26] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:26] [DOC: 9223139] ℹ️  DOB normalized: 02/10/1970
[15:48:26] [DOC: 9223139] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[15:48:26] [DOC: 9223139] ✅ Patient date processing completed successfully
[15:48:26] ✅    ✅ Date processing completed
[15:48:26] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Q90.9', 'secondDiagnosis': 'M62.84', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I27.81', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[15:48:26] 🔄 
🔄 Step 4: Extracting order data...
[15:48:30] ℹ️  Order extraction - MRN: 'MA240808027001'
[15:48:30] ℹ️  Order extraction - Sex: 'MALE'
[15:48:30] ℹ️  Order extraction - Service Line: 'PT'
[15:48:30] ℹ️  Order extraction - Payer Source: ''
[15:48:30] ✅ Order data extraction completed successfully
[15:48:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:30] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[15:48:30] ℹ️  Service line consistent in both sources: 'PT'
[15:48:30] ✅ Patient name cross-validation successful
[15:48:30] ✅    ✅ Data merged successfully
[15:48:32] ✅    ✅ Order data extracted and validated
[15:48:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:32] [DOC: 9223139] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[15:48:32] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[15:48:32] 🔄 
🔄 Step 6: Pushing order to API...
[15:48:32] [DOC: 9223139] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[15:48:33] [DOC: 9223139] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:48:33] ❌    ❌ Failed to push order
[15:48:33] 🔄 
🔄 Step 7: Writing to CSV...
[15:48:33] [DOC: 9223139] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[15:48:33] [DOC: 9223139] ℹ️  Service Line extracted: 'PT'
[15:48:33] [DOC: 9223139] ℹ️  Payer Source extracted: ''
[15:48:33] [DOC: 9223139] ℹ️  Diagnosis codes being written:
[15:48:33] [DOC: 9223139] ℹ️    - Latest_Episode_Firstdiagnosis: 'Q90.9'
[15:48:33] [DOC: 9223139] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.84'
[15:48:33] [DOC: 9223139] ℹ️    - Latest_Episode_Thirddiagnosis: 'J45.909'
[15:48:33] [DOC: 9223139] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I27.81'
[15:48:33] [DOC: 9223139] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E03.9'
[15:48:33] [DOC: 9223139] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[15:48:33] [DOC: 9223139] ✅ Patient data written to CSV: Rafael Talavera | Sex: MALE | Age: 55 | Service: PT | Payer:  | MRN: MA240808027001
[15:48:33] ✅    ✅ Document 9223139 processed and saved successfully
[15:48:33] 🔄 
🔄 Step 8: Saving API details...
[15:48:33] [DOC: 9223139] ℹ️  API push details saved for document 9223139
[15:48:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223111                         ║
================================================================================
[15:48:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:48:33] ℹ️  Date: 04/04/2025
[15:48:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:45] [DOC: 9223111] ✅ Text extracted using pdfplumber (12828 chars)
[15:48:45] ✅    ✅ Text extracted using pdfplumber (12828 chars)
[15:48:45] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:48] ℹ️  AI extracted raw sex value: 'F'
[15:48:48] ℹ️  AI extracted service line: 'OT'
[15:48:48] ℹ️  AI extracted payer source: ''
[15:48:48] ℹ️  AI extracted diagnoses:
[15:48:48] ℹ️    - Diagnosis 1: 'COPD'
[15:48:48] ℹ️    - Diagnosis 2: 'Parkinsons Exacerbation'
[15:48:48] ℹ️    - Diagnosis 3: ''
[15:48:48] ℹ️    - Diagnosis 4: ''
[15:48:48] ℹ️    - Diagnosis 5: ''
[15:48:48] ℹ️    - Diagnosis 6: ''
[15:48:48] ℹ️  Final extracted MRN: 'MA221012094404'
[15:48:48] ℹ️  Final extracted Sex: 'FEMALE'
[15:48:48] ℹ️  Final extracted Service Line: 'OT'
[15:48:48] ℹ️  Final extracted Payer Source: ''
[15:48:48] ✅ Patient data extraction completed successfully
[15:48:48] ✅    ✅ Patient data extracted successfully
[15:48:48] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'Parkinsons Exacerbation', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:48:48] ✅    ✅ Patient identified: Maria Ferreira
[15:48:48] ✅    ✅ Patient name validation passed
[15:48:48] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:48] [DOC: 9223111] ℹ️  DOB normalized: 09/29/1944
[15:48:48] [DOC: 9223111] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[15:48:48] [DOC: 9223111] ✅ Patient date processing completed successfully
[15:48:48] ✅    ✅ Date processing completed
[15:48:48] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'Parkinsons Exacerbation', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:48:48] 🔄 
🔄 Step 4: Extracting order data...
[15:48:50] ℹ️  Order extraction - MRN: 'MA221012094404'
[15:48:50] ℹ️  Order extraction - Sex: 'FEMALE'
[15:48:50] ℹ️  Order extraction - Service Line: 'OT'
[15:48:50] ℹ️  Order extraction - Payer Source: ''
[15:48:50] ✅ Order data extraction completed successfully
[15:48:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:50] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[15:48:50] ℹ️  Service line consistent in both sources: 'OT'
[15:48:50] ✅ Patient name cross-validation successful
[15:48:50] ✅    ✅ Data merged successfully
[15:48:55] ✅    ✅ Order data extracted and validated
[15:48:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:55] [DOC: 9223111] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:48:55] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:48:55] 🔄 
🔄 Step 6: Pushing order to API...
[15:48:55] [DOC: 9223111] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:48:56] [DOC: 9223111] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:48:56] ❌    ❌ Failed to push order
[15:48:56] 🔄 
🔄 Step 7: Writing to CSV...
[15:48:56] [DOC: 9223111] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[15:48:56] [DOC: 9223111] ℹ️  Service Line extracted: 'OT'
[15:48:56] [DOC: 9223111] ℹ️  Payer Source extracted: ''
[15:48:56] [DOC: 9223111] ℹ️  Diagnosis codes being written:
[15:48:56] [DOC: 9223111] ℹ️    - Latest_Episode_Firstdiagnosis: 'COPD'
[15:48:56] [DOC: 9223111] ℹ️    - Latest_Episode_Seconddiagnosis: 'Parkinsons Exacerbation'
[15:48:56] [DOC: 9223111] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:48:56] [DOC: 9223111] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:48:56] [DOC: 9223111] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:48:56] [DOC: 9223111] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:48:56] [DOC: 9223111] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: OT | Payer:  | MRN: MA221012094404
[15:48:56] ✅    ✅ Document 9223111 processed and saved successfully
[15:48:56] 🔄 
🔄 Step 8: Saving API details...
[15:48:56] [DOC: 9223111] ℹ️  API push details saved for document 9223111
[15:48:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222326                         ║
================================================================================
[15:48:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:48:56] ℹ️  Date: 04/04/2025
[15:48:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:58] [DOC: 9222326] ✅ Text extracted using pdfplumber (1358 chars)
[15:48:58] ✅    ✅ Text extracted using pdfplumber (1358 chars)
[15:48:58] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:01] ℹ️  AI extracted raw sex value: ''
[15:49:01] ℹ️  AI extracted service line: 'Physical Therapy'
[15:49:01] ℹ️  AI extracted payer source: ''
[15:49:01] ℹ️  AI extracted diagnoses:
[15:49:01] ℹ️    - Diagnosis 1: 'E11.65'
[15:49:01] ℹ️    - Diagnosis 2: 'I10'
[15:49:01] ℹ️    - Diagnosis 3: 'F20.9'
[15:49:01] ℹ️    - Diagnosis 4: 'None'
[15:49:01] ℹ️    - Diagnosis 5: 'None'
[15:49:01] ℹ️    - Diagnosis 6: 'None'
[15:49:01] ℹ️  Final extracted MRN: 'MA230222024501'
[15:49:01] ℹ️  Final extracted Sex: ''
[15:49:01] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:49:01] ℹ️  Final extracted Payer Source: ''
[15:49:01] ✅ Patient data extraction completed successfully
[15:49:01] ✅    ✅ Patient data extracted successfully
[15:49:01] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:49:01] ✅    ✅ Patient identified: Pauline Bergeron
[15:49:01] ✅    ✅ Patient name validation passed
[15:49:01] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:01] [DOC: 9222326] ℹ️  DOB normalized: 02/22/1945
[15:49:01] [DOC: 9222326] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:49:01] [DOC: 9222326] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[15:49:01] [DOC: 9222326] ✅ Patient date processing completed successfully
[15:49:01] ✅    ✅ Date processing completed
[15:49:01] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9'}]
[15:49:01] 🔄 
🔄 Step 4: Extracting order data...
[15:49:04] ℹ️  Order extraction - MRN: 'MA230222024501'
[15:49:04] ℹ️  Order extraction - Sex: ''
[15:49:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:49:04] ℹ️  Order extraction - Payer Source: ''
[15:49:04] ✅ Order data extraction completed successfully
[15:49:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:04] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[15:49:04] ⚠️  Could not determine sex using any available method
[15:49:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:49:04] ✅ Patient name cross-validation successful
[15:49:04] ✅    ✅ Data merged successfully
[15:49:05] ✅    ✅ Order data extracted and validated
[15:49:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:05] [DOC: 9222326] ✅ Patient found in local cache: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[15:49:05] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[15:49:05] 🔄 
🔄 Step 6: Pushing order to API...
[15:49:05] [DOC: 9222326] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[15:49:08] [DOC: 9222326] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13115"}
[15:49:08] ❌    ❌ Failed to push order
[15:49:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:49:08] [DOC: 9222326] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[15:49:08] [DOC: 9222326] ℹ️  Service Line extracted: 'Physical Therapy'
[15:49:08] [DOC: 9222326] ℹ️  Payer Source extracted: ''
[15:49:08] [DOC: 9222326] ℹ️  Diagnosis codes being written:
[15:49:08] [DOC: 9222326] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:49:08] [DOC: 9222326] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:49:08] [DOC: 9222326] ℹ️    - Latest_Episode_Thirddiagnosis: 'F20.9'
[15:49:08] [DOC: 9222326] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:49:08] [DOC: 9222326] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:49:08] [DOC: 9222326] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:49:08] [DOC: 9222326] ✅ Patient data written to CSV: Pauline Bergeron | Sex:  | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA230222024501
[15:49:08] ✅    ✅ Document 9222326 processed and saved successfully
[15:49:08] 🔄 
🔄 Step 8: Saving API details...
[15:49:08] [DOC: 9222326] ℹ️  API push details saved for document 9222326
[15:49:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222323                         ║
================================================================================
[15:49:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:49:08] ℹ️  Date: 04/04/2025
[15:49:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:49:11] [DOC: 9222323] ✅ Text extracted using pdfplumber (11779 chars)
[15:49:11] ✅    ✅ Text extracted using pdfplumber (11779 chars)
[15:49:11] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:14] ℹ️  AI extracted raw sex value: 'F'
[15:49:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:49:14] ℹ️  AI extracted payer source: 'Medicare'
[15:49:14] ℹ️  AI extracted diagnoses:
[15:49:14] ℹ️    - Diagnosis 1: 'E11.65'
[15:49:14] ℹ️    - Diagnosis 2: 'I10'
[15:49:14] ℹ️    - Diagnosis 3: 'F20.9'
[15:49:14] ℹ️    - Diagnosis 4: 'R13.10'
[15:49:14] ℹ️    - Diagnosis 5: 'E78.5'
[15:49:14] ℹ️    - Diagnosis 6: 'K21.9'
[15:49:14] ℹ️  Final extracted MRN: 'MA230222024501'
[15:49:14] ℹ️  Final extracted Sex: 'FEMALE'
[15:49:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:49:14] ℹ️  Final extracted Payer Source: 'Medicare'
[15:49:14] ✅ Patient data extraction completed successfully
[15:49:14] ✅    ✅ Patient data extracted successfully
[15:49:14] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 1881923936
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave, Apt 124
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 995-5866
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/19/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[15:49:14] ✅    ✅ Patient identified: Pauline Bergeron
[15:49:14] ✅    ✅ Patient name validation passed
[15:49:14] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:14] [DOC: 9222323] ℹ️  DOB normalized: 02/22/1945
[15:49:14] [DOC: 9222323] ℹ️  Episode startOfCare normalized: 11/19/2024
[15:49:14] [DOC: 9222323] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:49:14] [DOC: 9222323] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[15:49:14] [DOC: 9222323] ✅ Patient date processing completed successfully
[15:49:14] ✅    ✅ Date processing completed
[15:49:14] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 1881923936
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave, Apt 124
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 995-5866
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/19/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[15:49:14] 🔄 
🔄 Step 4: Extracting order data...
[15:49:17] ℹ️  Order extraction - MRN: 'MA230222024501'
[15:49:17] ℹ️  Order extraction - Sex: 'FEMALE'
[15:49:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:49:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:49:17] ✅ Order data extraction completed successfully
[15:49:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:17] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[15:49:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:49:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:49:17] ✅ Patient name cross-validation successful
[15:49:17] ✅    ✅ Data merged successfully
[15:49:19] ✅    ✅ Order data extracted and validated
[15:49:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:19] [DOC: 9222323] ✅ Patient found in local cache: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[15:49:19] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[15:49:19] 🔄 
🔄 Step 6: Pushing order to API...
[15:49:19] [DOC: 9222323] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[15:49:21] [DOC: 9222323] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13116"}
[15:49:21] ❌    ❌ Failed to push order
[15:49:21] 🔄 
🔄 Step 7: Writing to CSV...
[15:49:21] [DOC: 9222323] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[15:49:21] [DOC: 9222323] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:49:21] [DOC: 9222323] ℹ️  Payer Source extracted: 'Medicare'
[15:49:21] [DOC: 9222323] ℹ️  Diagnosis codes being written:
[15:49:21] [DOC: 9222323] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[15:49:21] [DOC: 9222323] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:49:21] [DOC: 9222323] ℹ️    - Latest_Episode_Thirddiagnosis: 'F20.9'
[15:49:21] [DOC: 9222323] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R13.10'
[15:49:21] [DOC: 9222323] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[15:49:21] [DOC: 9222323] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[15:49:21] [DOC: 9222323] ✅ Patient data written to CSV: Pauline Bergeron | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230222024501
[15:49:21] ✅    ✅ Document 9222323 processed and saved successfully
[15:49:21] 🔄 
🔄 Step 8: Saving API details...
[15:49:21] [DOC: 9222323] ℹ️  API push details saved for document 9222323
[15:49:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222313                         ║
================================================================================
[15:49:21] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:49:21] ℹ️  Date: 04/04/2025
[15:49:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:49:25] [DOC: 9222313] ✅ Text extracted using pdfplumber (11796 chars)
[15:49:25] ✅    ✅ Text extracted using pdfplumber (11796 chars)
[15:49:25] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:28] ℹ️  AI extracted raw sex value: 'F'
[15:49:28] ℹ️  AI extracted service line: 'OT'
[15:49:28] ℹ️  AI extracted payer source: 'None'
[15:49:28] ℹ️  AI extracted diagnoses:
[15:49:28] ℹ️    - Diagnosis 1: 'None'
[15:49:28] ℹ️    - Diagnosis 2: 'None'
[15:49:28] ℹ️    - Diagnosis 3: 'None'
[15:49:28] ℹ️    - Diagnosis 4: 'None'
[15:49:28] ℹ️    - Diagnosis 5: 'None'
[15:49:28] ℹ️    - Diagnosis 6: 'None'
[15:49:28] ℹ️  Final extracted MRN: 'MA231024053804'
[15:49:28] ℹ️  Final extracted Sex: 'FEMALE'
[15:49:28] ℹ️  Final extracted Service Line: 'OT'
[15:49:28] ℹ️  Final extracted Payer Source: ''
[15:49:28] ✅ Patient data extraction completed successfully
[15:49:28] ✅    ✅ Patient data extracted successfully
[15:49:28] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:49:28] ✅    ✅ Patient identified: Sylvia Rosalie
[15:49:28] ✅    ✅ Patient name validation passed
[15:49:28] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:28] [DOC: 9222313] ℹ️  DOB normalized: 05/22/1938
[15:49:28] [DOC: 9222313] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[15:49:28] [DOC: 9222313] ℹ️  Episode endOfEpisode normalized: 02/21/2025
[15:49:28] [DOC: 9222313] ✅ Patient date processing completed successfully
[15:49:28] ✅    ✅ Date processing completed
[15:49:28] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '02/21/2025'}]
[15:49:28] 🔄 
🔄 Step 4: Extracting order data...
[15:49:31] ℹ️  Order extraction - MRN: 'MA231024053804'
[15:49:31] ℹ️  Order extraction - Sex: 'FEMALE'
[15:49:31] ℹ️  Order extraction - Service Line: 'OT'
[15:49:31] ℹ️  Order extraction - Payer Source: ''
[15:49:31] ✅ Order data extraction completed successfully
[15:49:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:31] ℹ️  Using MRN from patient data: 'MA231024053804' over 'MA231024053804'
[15:49:31] ℹ️  Service line consistent in both sources: 'OT'
[15:49:31] ✅ Patient name cross-validation successful
[15:49:31] ✅    ✅ Data merged successfully
[15:49:32] ✅    ✅ Order data extracted and validated
[15:49:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:39] [DOC: 9222313] ✅ Patient exists in API: Sylvia Rosalie, ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[15:49:39] ✅    ✅ Existing patient found with ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[15:49:39] 🔄 
🔄 Step 6: Pushing order to API...
[15:49:39] [DOC: 9222313] ℹ️  Pushing order via API for patient ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[15:49:40] [DOC: 9222313] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:49:40] ❌    ❌ Failed to push order
[15:49:40] 🔄 
🔄 Step 7: Writing to CSV...
[15:49:40] [DOC: 9222313] ℹ️  Calculated age: 87 from DOB: 05/22/1938
[15:49:40] [DOC: 9222313] ℹ️  Service Line extracted: 'OT'
[15:49:40] [DOC: 9222313] ℹ️  Payer Source extracted: ''
[15:49:40] [DOC: 9222313] ℹ️  Diagnosis codes being written:
[15:49:40] [DOC: 9222313] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:49:40] [DOC: 9222313] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:49:40] [DOC: 9222313] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:49:40] [DOC: 9222313] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:49:40] [DOC: 9222313] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:49:40] [DOC: 9222313] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:49:40] [DOC: 9222313] ✅ Patient data written to CSV: Sylvia Rosalie | Sex: FEMALE | Age: 87 | Service: OT | Payer:  | MRN: MA231024053804
[15:49:40] ✅    ✅ Document 9222313 processed and saved successfully
[15:49:40] 🔄 
🔄 Step 8: Saving API details...
[15:49:40] [DOC: 9222313] ℹ️  API push details saved for document 9222313
[15:49:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222303                         ║
================================================================================
[15:49:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:49:40] ℹ️  Date: 04/04/2025
[15:49:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:49:43] [DOC: 9222303] ✅ Text extracted using pdfplumber (14154 chars)
[15:49:43] ✅    ✅ Text extracted using pdfplumber (14154 chars)
[15:49:43] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:46] ℹ️  AI extracted raw sex value: 'F'
[15:49:46] ℹ️  AI extracted service line: 'PT'
[15:49:46] ℹ️  AI extracted payer source: ''
[15:49:46] ℹ️  AI extracted diagnoses:
[15:49:46] ℹ️    - Diagnosis 1: 'J44.1'
[15:49:46] ℹ️    - Diagnosis 2: 'M62.81'
[15:49:46] ℹ️    - Diagnosis 3: 'I25.10'
[15:49:46] ℹ️    - Diagnosis 4: 'G30'
[15:49:46] ℹ️    - Diagnosis 5: 'A41.9'
[15:49:46] ℹ️    - Diagnosis 6: 'K56.9'
[15:49:46] ℹ️  Final extracted MRN: 'MA231024053804'
[15:49:46] ℹ️  Final extracted Sex: 'FEMALE'
[15:49:46] ℹ️  Final extracted Service Line: 'PT'
[15:49:46] ℹ️  Final extracted Payer Source: ''
[15:49:46] ✅ Patient data extraction completed successfully
[15:49:46] ✅    ✅ Patient data extracted successfully
[15:49:46] 📊 Patient Response
     └─ patientFName: Rosalie
     └─ patientLName: Sylvia
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'G30', 'fifthDiagnosis': 'A41.9', 'sixthDiagnosis': 'K56.9'}]
[15:49:46] ✅    ✅ Patient identified: Rosalie Sylvia
[15:49:46] ✅    ✅ Patient name validation passed
[15:49:46] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:46] [DOC: 9222303] ℹ️  DOB normalized: 05/22/1938
[15:49:46] [DOC: 9222303] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[15:49:46] [DOC: 9222303] ✅ Patient date processing completed successfully
[15:49:46] ✅    ✅ Date processing completed
[15:49:46] 📊 Processed Patient Data
     └─ patientFName: Rosalie
     └─ patientLName: Sylvia
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'G30', 'fifthDiagnosis': 'A41.9', 'sixthDiagnosis': 'K56.9'}]
[15:49:46] 🔄 
🔄 Step 4: Extracting order data...
[15:49:49] ℹ️  Order extraction - MRN: 'MA231024053804'
[15:49:49] ℹ️  Order extraction - Sex: 'FEMALE'
[15:49:49] ℹ️  Order extraction - Service Line: 'PT'
[15:49:49] ℹ️  Order extraction - Payer Source: ''
[15:49:49] ✅ Order data extraction completed successfully
[15:49:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:49] ℹ️  Using MRN from patient data: 'MA231024053804' over 'MA231024053804'
[15:49:49] ℹ️  Service line consistent in both sources: 'PT'
[15:49:49] ✅ Patient name cross-validation successful
[15:49:49] ✅    ✅ Data merged successfully
[15:49:50] ✅    ✅ Order data extracted and validated
[15:49:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:58] [DOC: 9222303] ℹ️  Patient not found in cache or API: Rosalie Sylvia
[15:49:58] [DOC: 9222303] ℹ️  Patient not found, creating new patient via API...
[15:49:58] [DOC: 9222303] ℹ️  Creating patient via API: Rosalie Sylvia
[15:49:59] [DOC: 9222303] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:49:59] ❌    ❌ Failed to create patient
[15:49:59] [DOC: 9222303] ℹ️  API push details saved for document 9222303
================================================================================
║                        Processing Document ID: 9222300                         ║
================================================================================
[15:49:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:49:59] ℹ️  Date: 04/04/2025
[15:49:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:02] [DOC: 9222300] ✅ Text extracted using pdfplumber (14821 chars)
[15:50:02] ✅    ✅ Text extracted using pdfplumber (14821 chars)
[15:50:02] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:05] ℹ️  AI extracted raw sex value: 'F'
[15:50:05] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:50:05] ℹ️  AI extracted payer source: 'Medicare'
[15:50:05] ℹ️  AI extracted diagnoses:
[15:50:05] ℹ️    - Diagnosis 1: 'J44.1'
[15:50:05] ℹ️    - Diagnosis 2: 'J96.20'
[15:50:05] ℹ️    - Diagnosis 3: 'I83.893'
[15:50:05] ℹ️    - Diagnosis 4: 'I10'
[15:50:05] ℹ️    - Diagnosis 5: 'R41.9'
[15:50:05] ℹ️    - Diagnosis 6: 'I25.10'
[15:50:05] ℹ️  Final extracted MRN: 'MA231024053804'
[15:50:05] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:05] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:50:05] ℹ️  Final extracted Payer Source: 'Medicare'
[15:50:05] ✅ Patient data extraction completed successfully
[15:50:05] ✅    ✅ Patient data extracted successfully
[15:50:05] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: MACKLER, STEPHEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 30 Sheridan St
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: None
     └─ phoneNumber: (508) 993-8005
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'R41.9', 'sixthDiagnosis': 'I25.10'}]
[15:50:05] ✅    ✅ Patient identified: Sylvia Rosalie
[15:50:05] ✅    ✅ Patient name validation passed
[15:50:05] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:05] [DOC: 9222300] ℹ️  DOB normalized: 05/22/1938
[15:50:05] [DOC: 9222300] ℹ️  Episode startOfCare normalized: 02/22/2025
[15:50:05] [DOC: 9222300] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[15:50:05] [DOC: 9222300] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[15:50:05] [DOC: 9222300] ✅ Patient date processing completed successfully
[15:50:05] ✅    ✅ Date processing completed
[15:50:05] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Rosalie
     └─ dob: 05/22/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA231024053804
     └─ billingProvider: MACKLER, STEPHEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 30 Sheridan St
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ phoneNumber: (508) 993-8005
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J96.20', 'thirdDiagnosis': 'I83.893', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'R41.9', 'sixthDiagnosis': 'I25.10'}]
[15:50:05] 🔄 
🔄 Step 4: Extracting order data...
[15:50:07] ℹ️  Order extraction - MRN: 'MA231024053804'
[15:50:07] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:50:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:50:07] ✅ Order data extraction completed successfully
[15:50:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:07] ℹ️  Using MRN from patient data: 'MA231024053804' over 'MA231024053804'
[15:50:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:50:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:50:07] ✅ Patient name cross-validation successful
[15:50:07] ✅    ✅ Data merged successfully
[15:50:09] ✅    ✅ Order data extracted and validated
[15:50:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:09] [DOC: 9222300] ✅ Patient found in local cache: Sylvia Rosalie, ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[15:50:09] ✅    ✅ Existing patient found with ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[15:50:09] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:09] [DOC: 9222300] ℹ️  Pushing order via API for patient ID: cb681f2f-c6e8-4466-8325-d4cd7104d07d
[15:50:10] [DOC: 9222300] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14475"}
[15:50:10] ❌    ❌ Failed to push order
[15:50:10] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:10] [DOC: 9222300] ℹ️  Calculated age: 87 from DOB: 05/22/1938
[15:50:10] [DOC: 9222300] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:50:10] [DOC: 9222300] ℹ️  Payer Source extracted: 'Medicare'
[15:50:10] [DOC: 9222300] ℹ️  Diagnosis codes being written:
[15:50:10] [DOC: 9222300] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:50:10] [DOC: 9222300] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.20'
[15:50:10] [DOC: 9222300] ℹ️    - Latest_Episode_Thirddiagnosis: 'I83.893'
[15:50:10] [DOC: 9222300] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[15:50:10] [DOC: 9222300] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R41.9'
[15:50:10] [DOC: 9222300] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[15:50:10] [DOC: 9222300] ✅ Patient data written to CSV: Sylvia Rosalie | Sex: FEMALE | Age: 87 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA231024053804
[15:50:10] ✅    ✅ Document 9222300 processed and saved successfully
[15:50:10] 🔄 
🔄 Step 8: Saving API details...
[15:50:10] [DOC: 9222300] ℹ️  API push details saved for document 9222300
[15:50:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222255                         ║
================================================================================
[15:50:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:50:10] ℹ️  Date: 04/04/2025
[15:50:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:13] [DOC: 9222255] ✅ Text extracted using pdfplumber (12287 chars)
[15:50:13] ✅    ✅ Text extracted using pdfplumber (12287 chars)
[15:50:13] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:16] ℹ️  AI extracted raw sex value: 'F'
[15:50:16] ℹ️  AI extracted service line: 'OT'
[15:50:16] ℹ️  AI extracted payer source: ''
[15:50:16] ℹ️  AI extracted diagnoses:
[15:50:16] ℹ️    - Diagnosis 1: 'MS'
[15:50:16] ℹ️    - Diagnosis 2: 'Left Shoulder Athroplasty'
[15:50:16] ℹ️    - Diagnosis 3: 'CVA Exacerbation'
[15:50:16] ℹ️    - Diagnosis 4: ''
[15:50:16] ℹ️    - Diagnosis 5: ''
[15:50:16] ℹ️    - Diagnosis 6: ''
[15:50:16] ℹ️  Final extracted MRN: 'MA220701015501'
[15:50:16] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:16] ℹ️  Final extracted Service Line: 'OT'
[15:50:16] ℹ️  Final extracted Payer Source: ''
[15:50:16] ✅ Patient data extraction completed successfully
[15:50:16] ✅    ✅ Patient data extracted successfully
[15:50:16] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'MS', 'secondDiagnosis': 'Left Shoulder Athroplasty', 'thirdDiagnosis': 'CVA Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:16] ✅    ✅ Patient identified: Ada Burns
[15:50:16] ✅    ✅ Patient name validation passed
[15:50:16] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:16] [DOC: 9222255] ℹ️  DOB normalized: 01/15/1955
[15:50:16] [DOC: 9222255] ✅ Patient date processing completed successfully
[15:50:16] ✅    ✅ Date processing completed
[15:50:16] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'MS', 'secondDiagnosis': 'Left Shoulder Athroplasty', 'thirdDiagnosis': 'CVA Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:16] 🔄 
🔄 Step 4: Extracting order data...
[15:50:19] ℹ️  Order extraction - MRN: 'MA220701015501'
[15:50:19] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:19] ℹ️  Order extraction - Service Line: 'OT'
[15:50:19] ℹ️  Order extraction - Payer Source: ''
[15:50:19] ✅ Order data extraction completed successfully
[15:50:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:19] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[15:50:19] ℹ️  Service line consistent in both sources: 'OT'
[15:50:19] ✅ Patient name cross-validation successful
[15:50:19] ✅    ✅ Data merged successfully
[15:50:20] ✅    ✅ Order data extracted and validated
[15:50:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:20] [DOC: 9222255] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[15:50:20] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[15:50:20] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:20] [DOC: 9222255] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[15:50:22] [DOC: 9222255] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:50:22] ❌    ❌ Failed to push order
[15:50:22] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:22] [DOC: 9222255] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[15:50:22] [DOC: 9222255] ℹ️  Service Line extracted: 'OT'
[15:50:22] [DOC: 9222255] ℹ️  Payer Source extracted: ''
[15:50:22] [DOC: 9222255] ℹ️  Diagnosis codes being written:
[15:50:22] [DOC: 9222255] ℹ️    - Latest_Episode_Firstdiagnosis: 'MS'
[15:50:22] [DOC: 9222255] ℹ️    - Latest_Episode_Seconddiagnosis: 'Left Shoulder Athroplasty'
[15:50:22] [DOC: 9222255] ℹ️    - Latest_Episode_Thirddiagnosis: 'CVA Exacerbation'
[15:50:22] [DOC: 9222255] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:50:22] [DOC: 9222255] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:50:22] [DOC: 9222255] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:50:22] [DOC: 9222255] ✅ Patient data written to CSV: Ada Burns | Sex: FEMALE | Age: 70 | Service: OT | Payer:  | MRN: MA220701015501
[15:50:22] ✅    ✅ Document 9222255 processed and saved successfully
[15:50:22] 🔄 
🔄 Step 8: Saving API details...
[15:50:22] [DOC: 9222255] ℹ️  API push details saved for document 9222255
[15:50:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222246                         ║
================================================================================
[15:50:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:50:22] ℹ️  Date: 04/04/2025
[15:50:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:25] [DOC: 9222246] ✅ Text extracted using pdfplumber (14317 chars)
[15:50:25] ✅    ✅ Text extracted using pdfplumber (14317 chars)
[15:50:25] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:28] ℹ️  AI extracted raw sex value: 'F'
[15:50:28] ℹ️  AI extracted service line: 'OT'
[15:50:28] ℹ️  AI extracted payer source: 'None'
[15:50:28] ℹ️  AI extracted diagnoses:
[15:50:28] ℹ️    - Diagnosis 1: 'MS Exacerbation'
[15:50:28] ℹ️    - Diagnosis 2: 'muscle weakness'
[15:50:28] ℹ️    - Diagnosis 3: 'LLE cellulitis'
[15:50:28] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[15:50:28] ℹ️    - Diagnosis 5: 'GERD'
[15:50:28] ℹ️    - Diagnosis 6: 'DM type 2 with hyperglycemia'
[15:50:28] ℹ️  Final extracted MRN: 'MA240822115704'
[15:50:28] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:28] ℹ️  Final extracted Service Line: 'OT'
[15:50:28] ℹ️  Final extracted Payer Source: ''
[15:50:28] ✅ Patient data extraction completed successfully
[15:50:28] ✅    ✅ Patient data extracted successfully
[15:50:28] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': None, 'firstDiagnosis': 'MS Exacerbation', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': 'LLE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[15:50:28] ✅    ✅ Patient identified: Charlene Couto
[15:50:28] ✅    ✅ Patient name validation passed
[15:50:28] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:28] [DOC: 9222246] ℹ️  DOB normalized: 11/01/1957
[15:50:28] [DOC: 9222246] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[15:50:28] [DOC: 9222246] ✅ Patient date processing completed successfully
[15:50:28] ✅    ✅ Date processing completed
[15:50:28] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'firstDiagnosis': 'MS Exacerbation', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': 'LLE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[15:50:28] 🔄 
🔄 Step 4: Extracting order data...
[15:50:31] ℹ️  Order extraction - MRN: 'MA240822115704'
[15:50:31] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:31] ℹ️  Order extraction - Service Line: 'OT'
[15:50:31] ℹ️  Order extraction - Payer Source: ''
[15:50:31] ✅ Order data extraction completed successfully
[15:50:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:31] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[15:50:31] ℹ️  Service line consistent in both sources: 'OT'
[15:50:31] ✅ Patient name cross-validation successful
[15:50:31] ✅    ✅ Data merged successfully
[15:50:32] ✅    ✅ Order data extracted and validated
[15:50:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:32] [DOC: 9222246] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[15:50:32] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[15:50:32] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:32] [DOC: 9222246] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[15:50:34] [DOC: 9222246] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:50:34] ❌    ❌ Failed to push order
[15:50:34] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:34] [DOC: 9222246] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[15:50:34] [DOC: 9222246] ℹ️  Service Line extracted: 'OT'
[15:50:34] [DOC: 9222246] ℹ️  Payer Source extracted: ''
[15:50:34] [DOC: 9222246] ℹ️  Diagnosis codes being written:
[15:50:34] [DOC: 9222246] ℹ️    - Latest_Episode_Firstdiagnosis: 'MS Exacerbation'
[15:50:34] [DOC: 9222246] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[15:50:34] [DOC: 9222246] ℹ️    - Latest_Episode_Thirddiagnosis: 'LLE cellulitis'
[15:50:34] [DOC: 9222246] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Multiple sclerosis'
[15:50:34] [DOC: 9222246] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GERD'
[15:50:34] [DOC: 9222246] ℹ️    - Latest_Episode_Sixthdiagnosis: 'DM type 2 with hyperglycemia'
[15:50:34] [DOC: 9222246] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: OT | Payer:  | MRN: MA240822115704
[15:50:34] ✅    ✅ Document 9222246 processed and saved successfully
[15:50:34] 🔄 
🔄 Step 8: Saving API details...
[15:50:34] [DOC: 9222246] ℹ️  API push details saved for document 9222246
[15:50:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222240                         ║
================================================================================
[15:50:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:50:34] ℹ️  Date: 04/04/2025
[15:50:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:37] [DOC: 9222240] ✅ Text extracted using pdfplumber (1395 chars)
[15:50:37] ✅    ✅ Text extracted using pdfplumber (1383 chars)
[15:50:37] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:40] ℹ️  AI extracted raw sex value: ''
[15:50:40] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:50:40] ℹ️  AI extracted payer source: ''
[15:50:40] ℹ️  AI extracted diagnoses:
[15:50:40] ℹ️    - Diagnosis 1: 'None'
[15:50:40] ℹ️    - Diagnosis 2: 'None'
[15:50:40] ℹ️    - Diagnosis 3: 'None'
[15:50:40] ℹ️    - Diagnosis 4: 'None'
[15:50:40] ℹ️    - Diagnosis 5: 'None'
[15:50:40] ℹ️    - Diagnosis 6: 'None'
[15:50:40] ℹ️  Final extracted MRN: 'MA221012094404'
[15:50:40] ℹ️  Final extracted Sex: ''
[15:50:40] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:50:40] ℹ️  Final extracted Payer Source: ''
[15:50:40] ✅ Patient data extraction completed successfully
[15:50:40] ✅    ✅ Patient data extracted successfully
[15:50:40] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:50:40] ✅    ✅ Patient identified: Maria Ferreira
[15:50:40] ✅    ✅ Patient name validation passed
[15:50:40] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:40] [DOC: 9222240] ℹ️  DOB normalized: 09/29/1944
[15:50:40] [DOC: 9222240] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[15:50:40] [DOC: 9222240] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[15:50:40] [DOC: 9222240] ✅ Patient date processing completed successfully
[15:50:40] ✅    ✅ Date processing completed
[15:50:40] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025'}]
[15:50:40] 🔄 
🔄 Step 4: Extracting order data...
[15:50:42] ℹ️  Order extraction - MRN: 'MA221012094404'
[15:50:42] ℹ️  Order extraction - Sex: ''
[15:50:42] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:50:42] ℹ️  Order extraction - Payer Source: ''
[15:50:42] ✅ Order data extraction completed successfully
[15:50:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:42] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[15:50:42] ℹ️  Inferred sex as FEMALE from name: Maria
[15:50:42] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:50:42] ✅ Patient name cross-validation successful
[15:50:42] ✅    ✅ Data merged successfully
[15:50:44] ✅    ✅ Order data extracted and validated
[15:50:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:44] [DOC: 9222240] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:50:44] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:50:44] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:44] [DOC: 9222240] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:50:45] [DOC: 9222240] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13991"}
[15:50:45] ❌    ❌ Failed to push order
[15:50:45] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:45] [DOC: 9222240] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[15:50:45] [DOC: 9222240] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:50:45] [DOC: 9222240] ℹ️  Payer Source extracted: ''
[15:50:45] [DOC: 9222240] ℹ️  Diagnosis codes being written:
[15:50:45] [DOC: 9222240] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:50:45] [DOC: 9222240] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:50:45] [DOC: 9222240] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:50:45] [DOC: 9222240] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:50:45] [DOC: 9222240] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:50:45] [DOC: 9222240] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:50:45] [DOC: 9222240] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[15:50:45] ✅    ✅ Document 9222240 processed and saved successfully
[15:50:45] 🔄 
🔄 Step 8: Saving API details...
[15:50:45] [DOC: 9222240] ℹ️  API push details saved for document 9222240
[15:50:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222237                         ║
================================================================================
[15:50:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:50:45] ℹ️  Date: 04/04/2025
[15:50:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:47] [DOC: 9222237] ✅ Text extracted using pdfplumber (1565 chars)
[15:50:47] ✅    ✅ Text extracted using pdfplumber (1553 chars)
[15:50:47] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:50] ℹ️  AI extracted raw sex value: ''
[15:50:50] ℹ️  AI extracted service line: 'Physical Therapy'
[15:50:50] ℹ️  AI extracted payer source: ''
[15:50:50] ℹ️  AI extracted diagnoses:
[15:50:50] ℹ️    - Diagnosis 1: 'I11.0'
[15:50:50] ℹ️    - Diagnosis 2: 'I50.32'
[15:50:50] ℹ️    - Diagnosis 3: 'None'
[15:50:50] ℹ️    - Diagnosis 4: 'None'
[15:50:50] ℹ️    - Diagnosis 5: 'None'
[15:50:50] ℹ️    - Diagnosis 6: 'None'
[15:50:50] ℹ️  Final extracted MRN: 'MA221012094404'
[15:50:50] ℹ️  Final extracted Sex: ''
[15:50:50] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:50:50] ℹ️  Final extracted Payer Source: ''
[15:50:50] ✅ Patient data extraction completed successfully
[15:50:50] ✅    ✅ Patient data extracted successfully
[15:50:50] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:50:50] ✅    ✅ Patient identified: Maria Ferreira
[15:50:50] ✅    ✅ Patient name validation passed
[15:50:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:50] [DOC: 9222237] ℹ️  DOB normalized: 09/29/1944
[15:50:50] [DOC: 9222237] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[15:50:50] [DOC: 9222237] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[15:50:50] [DOC: 9222237] ✅ Patient date processing completed successfully
[15:50:50] ✅    ✅ Date processing completed
[15:50:50] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32'}]
[15:50:50] 🔄 
🔄 Step 4: Extracting order data...
[15:50:53] ℹ️  Order extraction - MRN: 'MA221012094404'
[15:50:53] ℹ️  Order extraction - Sex: ''
[15:50:53] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:50:53] ℹ️  Order extraction - Payer Source: ''
[15:50:53] ✅ Order data extraction completed successfully
[15:50:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:53] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[15:50:53] ℹ️  Inferred sex as FEMALE from name: Maria
[15:50:53] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:50:53] ✅ Patient name cross-validation successful
[15:50:53] ✅    ✅ Data merged successfully
[15:50:54] ✅    ✅ Order data extracted and validated
[15:50:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:54] [DOC: 9222237] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:50:54] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:50:54] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:54] [DOC: 9222237] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:50:56] [DOC: 9222237] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13992"}
[15:50:56] ❌    ❌ Failed to push order
[15:50:56] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:56] [DOC: 9222237] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[15:50:56] [DOC: 9222237] ℹ️  Service Line extracted: 'Physical Therapy'
[15:50:56] [DOC: 9222237] ℹ️  Payer Source extracted: ''
[15:50:56] [DOC: 9222237] ℹ️  Diagnosis codes being written:
[15:50:56] [DOC: 9222237] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[15:50:56] [DOC: 9222237] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[15:50:56] [DOC: 9222237] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:50:56] [DOC: 9222237] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:50:56] [DOC: 9222237] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:50:56] [DOC: 9222237] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:50:56] [DOC: 9222237] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA221012094404
[15:50:56] ✅    ✅ Document 9222237 processed and saved successfully
[15:50:56] 🔄 
🔄 Step 8: Saving API details...
[15:50:56] [DOC: 9222237] ℹ️  API push details saved for document 9222237
[15:50:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222235                         ║
================================================================================
[15:50:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:50:56] ℹ️  Date: 04/04/2025
[15:50:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:59] [DOC: 9222235] ✅ Text extracted using pdfplumber (18935 chars)
[15:50:59] ✅    ✅ Text extracted using pdfplumber (18935 chars)
[15:50:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:03] ℹ️  AI extracted raw sex value: 'F'
[15:51:03] ℹ️  AI extracted service line: 'PT'
[15:51:03] ℹ️  AI extracted payer source: ''
[15:51:03] ℹ️  AI extracted diagnoses:
[15:51:03] ℹ️    - Diagnosis 1: 'I50.9'
[15:51:03] ℹ️    - Diagnosis 2: 'I27.89'
[15:51:03] ℹ️    - Diagnosis 3: 'I69.391'
[15:51:03] ℹ️    - Diagnosis 4: 'G20'
[15:51:03] ℹ️    - Diagnosis 5: 'F41.9'
[15:51:03] ℹ️    - Diagnosis 6: 'F32.9'
[15:51:03] ℹ️  Final extracted MRN: 'MA221012094404'
[15:51:03] ℹ️  Final extracted Sex: 'FEMALE'
[15:51:03] ℹ️  Final extracted Service Line: 'PT'
[15:51:03] ℹ️  Final extracted Payer Source: ''
[15:51:03] ✅ Patient data extraction completed successfully
[15:51:03] ✅    ✅ Patient data extracted successfully
[15:51:03] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': 'G20', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.9'}]
[15:51:03] ✅    ✅ Patient identified: Maria Ferreira
[15:51:03] ✅    ✅ Patient name validation passed
[15:51:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:03] [DOC: 9222235] ℹ️  DOB normalized: 09/29/1944
[15:51:03] [DOC: 9222235] ℹ️  Episode startOfCare normalized: 02/19/2025
[15:51:03] [DOC: 9222235] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[15:51:03] [DOC: 9222235] ✅ Patient date processing completed successfully
[15:51:03] ✅    ✅ Date processing completed
[15:51:03] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': 'G20', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.9'}]
[15:51:03] 🔄 
🔄 Step 4: Extracting order data...
[15:51:05] ℹ️  Order extraction - MRN: 'MA221012094404'
[15:51:05] ℹ️  Order extraction - Sex: 'FEMALE'
[15:51:05] ℹ️  Order extraction - Service Line: 'PT'
[15:51:05] ℹ️  Order extraction - Payer Source: ''
[15:51:05] ✅ Order data extraction completed successfully
[15:51:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:05] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[15:51:05] ℹ️  Service line consistent in both sources: 'PT'
[15:51:05] ✅ Patient name cross-validation successful
[15:51:05] ✅    ✅ Data merged successfully
[15:51:07] ✅    ✅ Order data extracted and validated
[15:51:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:07] [DOC: 9222235] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:51:07] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:51:07] 🔄 
🔄 Step 6: Pushing order to API...
[15:51:07] [DOC: 9222235] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:51:09] [DOC: 9222235] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:51:09] ❌    ❌ Failed to push order
[15:51:09] 🔄 
🔄 Step 7: Writing to CSV...
[15:51:09] [DOC: 9222235] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[15:51:09] [DOC: 9222235] ℹ️  Service Line extracted: 'PT'
[15:51:09] [DOC: 9222235] ℹ️  Payer Source extracted: ''
[15:51:09] [DOC: 9222235] ℹ️  Diagnosis codes being written:
[15:51:09] [DOC: 9222235] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.9'
[15:51:09] [DOC: 9222235] ℹ️    - Latest_Episode_Seconddiagnosis: 'I27.89'
[15:51:09] [DOC: 9222235] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.391'
[15:51:09] [DOC: 9222235] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G20'
[15:51:09] [DOC: 9222235] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[15:51:09] [DOC: 9222235] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.9'
[15:51:09] [DOC: 9222235] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA221012094404
[15:51:09] ✅    ✅ Document 9222235 processed and saved successfully
[15:51:09] 🔄 
🔄 Step 8: Saving API details...
[15:51:09] [DOC: 9222235] ℹ️  API push details saved for document 9222235
[15:51:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222221                         ║
================================================================================
[15:51:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:51:09] ℹ️  Date: 04/04/2025
[15:51:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:51:16] [DOC: 9222221] ✅ Text extracted using pdfplumber (18935 chars)
[15:51:16] ✅    ✅ Text extracted using pdfplumber (18935 chars)
[15:51:16] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:19] ℹ️  AI extracted raw sex value: 'F'
[15:51:19] ℹ️  AI extracted service line: 'PT'
[15:51:19] ℹ️  AI extracted payer source: ''
[15:51:19] ℹ️  AI extracted diagnoses:
[15:51:19] ℹ️    - Diagnosis 1: 'I50.9'
[15:51:19] ℹ️    - Diagnosis 2: 'I27.89'
[15:51:19] ℹ️    - Diagnosis 3: ''
[15:51:19] ℹ️    - Diagnosis 4: ''
[15:51:19] ℹ️    - Diagnosis 5: ''
[15:51:19] ℹ️    - Diagnosis 6: ''
[15:51:19] ℹ️  Final extracted MRN: 'MA221012094404'
[15:51:19] ℹ️  Final extracted Sex: 'FEMALE'
[15:51:19] ℹ️  Final extracted Service Line: 'PT'
[15:51:19] ℹ️  Final extracted Payer Source: ''
[15:51:19] ✅ Patient data extraction completed successfully
[15:51:19] ✅    ✅ Patient data extracted successfully
[15:51:19] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:51:19] ✅    ✅ Patient identified: Maria Ferreira
[15:51:19] ✅    ✅ Patient name validation passed
[15:51:19] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:19] [DOC: 9222221] ℹ️  DOB normalized: 09/29/1944
[15:51:19] [DOC: 9222221] ℹ️  Episode startOfCare normalized: 02/19/2025
[15:51:19] [DOC: 9222221] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[15:51:19] [DOC: 9222221] ✅ Patient date processing completed successfully
[15:51:19] ✅    ✅ Date processing completed
[15:51:19] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'I27.89', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:51:19] 🔄 
🔄 Step 4: Extracting order data...
[15:51:22] ℹ️  Order extraction - MRN: 'MA221012094404'
[15:51:22] ℹ️  Order extraction - Sex: 'FEMALE'
[15:51:22] ℹ️  Order extraction - Service Line: 'PT'
[15:51:22] ℹ️  Order extraction - Payer Source: ''
[15:51:22] ✅ Order data extraction completed successfully
[15:51:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:22] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[15:51:22] ℹ️  Service line consistent in both sources: 'PT'
[15:51:22] ✅ Patient name cross-validation successful
[15:51:22] ✅    ✅ Data merged successfully
[15:51:23] ✅    ✅ Order data extracted and validated
[15:51:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:23] [DOC: 9222221] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:51:23] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:51:23] 🔄 
🔄 Step 6: Pushing order to API...
[15:51:23] [DOC: 9222221] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[15:51:24] [DOC: 9222221] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:51:24] ❌    ❌ Failed to push order
[15:51:24] 🔄 
🔄 Step 7: Writing to CSV...
[15:51:24] [DOC: 9222221] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[15:51:24] [DOC: 9222221] ℹ️  Service Line extracted: 'PT'
[15:51:24] [DOC: 9222221] ℹ️  Payer Source extracted: ''
[15:51:24] [DOC: 9222221] ℹ️  Diagnosis codes being written:
[15:51:24] [DOC: 9222221] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.9'
[15:51:24] [DOC: 9222221] ℹ️    - Latest_Episode_Seconddiagnosis: 'I27.89'
[15:51:24] [DOC: 9222221] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:51:24] [DOC: 9222221] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:51:24] [DOC: 9222221] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:51:24] [DOC: 9222221] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:51:24] [DOC: 9222221] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA221012094404
[15:51:24] ✅    ✅ Document 9222221 processed and saved successfully
[15:51:24] 🔄 
🔄 Step 8: Saving API details...
[15:51:24] [DOC: 9222221] ℹ️  API push details saved for document 9222221
[15:51:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222205                         ║
================================================================================
[15:51:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:51:24] ℹ️  Date: 04/04/2025
[15:51:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:51:27] [DOC: 9222205] ✅ Text extracted using pdfplumber (1598 chars)
[15:51:27] ✅    ✅ Text extracted using pdfplumber (1598 chars)
[15:51:27] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:30] ℹ️  AI extracted raw sex value: ''
[15:51:30] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:51:30] ℹ️  AI extracted payer source: ''
[15:51:30] ℹ️  AI extracted diagnoses:
[15:51:30] ℹ️    - Diagnosis 1: 'G40.909'
[15:51:30] ℹ️    - Diagnosis 2: 'F51.04'
[15:51:30] ℹ️    - Diagnosis 3: 'G81.94'
[15:51:30] ℹ️    - Diagnosis 4: 'None'
[15:51:30] ℹ️    - Diagnosis 5: 'None'
[15:51:30] ℹ️    - Diagnosis 6: 'None'
[15:51:30] ℹ️  Final extracted MRN: 'MA240318025203'
[15:51:30] ℹ️  Final extracted Sex: ''
[15:51:30] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:51:30] ℹ️  Final extracted Payer Source: ''
[15:51:30] ✅ Patient data extraction completed successfully
[15:51:30] ✅    ✅ Patient data extracted successfully
[15:51:30] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:51:30] ✅    ✅ Patient identified: Dale Brooks
[15:51:30] ✅    ✅ Patient name validation passed
[15:51:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:30] [DOC: 9222205] ℹ️  DOB normalized: 02/24/1952
[15:51:30] [DOC: 9222205] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[15:51:30] [DOC: 9222205] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[15:51:30] [DOC: 9222205] ✅ Patient date processing completed successfully
[15:51:30] ✅    ✅ Date processing completed
[15:51:30] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94'}]
[15:51:30] 🔄 
🔄 Step 4: Extracting order data...
[15:51:32] ℹ️  Order extraction - MRN: 'MA240318025203'
[15:51:32] ℹ️  Order extraction - Sex: ''
[15:51:32] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:51:32] ℹ️  Order extraction - Payer Source: ''
[15:51:32] ✅ Order data extraction completed successfully
[15:51:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:32] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[15:51:32] ⚠️  Could not determine sex using any available method
[15:51:32] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:51:32] ✅ Patient name cross-validation successful
[15:51:32] ✅    ✅ Data merged successfully
[15:51:33] ✅    ✅ Order data extracted and validated
[15:51:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:33] [DOC: 9222205] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:33] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:33] 🔄 
🔄 Step 6: Pushing order to API...
[15:51:33] [DOC: 9222205] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:34] [DOC: 9222205] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13363"}
[15:51:34] ❌    ❌ Failed to push order
[15:51:34] 🔄 
🔄 Step 7: Writing to CSV...
[15:51:34] [DOC: 9222205] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[15:51:34] [DOC: 9222205] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:51:34] [DOC: 9222205] ℹ️  Payer Source extracted: ''
[15:51:34] [DOC: 9222205] ℹ️  Diagnosis codes being written:
[15:51:34] [DOC: 9222205] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[15:51:34] [DOC: 9222205] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[15:51:34] [DOC: 9222205] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[15:51:34] [DOC: 9222205] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:51:34] [DOC: 9222205] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:51:34] [DOC: 9222205] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:51:34] [DOC: 9222205] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Occupational Therapy | Payer:  | MRN: MA240318025203
[15:51:34] ✅    ✅ Document 9222205 processed and saved successfully
[15:51:34] 🔄 
🔄 Step 8: Saving API details...
[15:51:34] [DOC: 9222205] ℹ️  API push details saved for document 9222205
[15:51:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222203                         ║
================================================================================
[15:51:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:51:34] ℹ️  Date: 04/04/2025
[15:51:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:51:38] [DOC: 9222203] ✅ Text extracted using pdfplumber (17369 chars)
[15:51:38] ✅    ✅ Text extracted using pdfplumber (17369 chars)
[15:51:38] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:41] ℹ️  AI extracted raw sex value: 'F'
[15:51:41] ℹ️  AI extracted service line: 'OT'
[15:51:41] ℹ️  AI extracted payer source: ''
[15:51:41] ℹ️  AI extracted diagnoses:
[15:51:41] ℹ️    - Diagnosis 1: 'weakness'
[15:51:41] ℹ️    - Diagnosis 2: 'weakness/gait abnormality'
[15:51:41] ℹ️    - Diagnosis 3: 'chronic renal failure'
[15:51:41] ℹ️    - Diagnosis 4: 'phlebitis'
[15:51:41] ℹ️    - Diagnosis 5: 'thrombophlebitis'
[15:51:41] ℹ️    - Diagnosis 6: 'peripheral venous insufficiency'
[15:51:41] ℹ️  Final extracted MRN: 'MA240318025203'
[15:51:41] ℹ️  Final extracted Sex: 'FEMALE'
[15:51:41] ℹ️  Final extracted Service Line: 'OT'
[15:51:41] ℹ️  Final extracted Payer Source: ''
[15:51:41] ✅ Patient data extraction completed successfully
[15:51:41] ✅    ✅ Patient data extracted successfully
[15:51:41] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'weakness', 'secondDiagnosis': 'weakness/gait abnormality', 'thirdDiagnosis': 'chronic renal failure', 'fourthDiagnosis': 'phlebitis', 'fifthDiagnosis': 'thrombophlebitis', 'sixthDiagnosis': 'peripheral venous insufficiency'}]
[15:51:41] ✅    ✅ Patient identified: Dale Brooks
[15:51:41] ✅    ✅ Patient name validation passed
[15:51:41] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:41] [DOC: 9222203] ℹ️  DOB normalized: 02/24/1952
[15:51:41] [DOC: 9222203] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[15:51:41] [DOC: 9222203] ✅ Patient date processing completed successfully
[15:51:41] ✅    ✅ Date processing completed
[15:51:41] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'weakness', 'secondDiagnosis': 'weakness/gait abnormality', 'thirdDiagnosis': 'chronic renal failure', 'fourthDiagnosis': 'phlebitis', 'fifthDiagnosis': 'thrombophlebitis', 'sixthDiagnosis': 'peripheral venous insufficiency'}]
[15:51:41] 🔄 
🔄 Step 4: Extracting order data...
[15:51:44] ℹ️  Order extraction - MRN: 'MA240318025203'
[15:51:44] ℹ️  Order extraction - Sex: 'FEMALE'
[15:51:44] ℹ️  Order extraction - Service Line: 'OT'
[15:51:44] ℹ️  Order extraction - Payer Source: ''
[15:51:44] ✅ Order data extraction completed successfully
[15:51:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:44] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[15:51:44] ℹ️  Service line consistent in both sources: 'OT'
[15:51:44] ✅ Patient name cross-validation successful
[15:51:44] ✅    ✅ Data merged successfully
[15:51:45] ✅    ✅ Order data extracted and validated
[15:51:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:45] [DOC: 9222203] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:45] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:45] 🔄 
🔄 Step 6: Pushing order to API...
[15:51:45] [DOC: 9222203] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:47] [DOC: 9222203] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:51:47] ❌    ❌ Failed to push order
[15:51:47] 🔄 
🔄 Step 7: Writing to CSV...
[15:51:47] [DOC: 9222203] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[15:51:47] [DOC: 9222203] ℹ️  Service Line extracted: 'OT'
[15:51:47] [DOC: 9222203] ℹ️  Payer Source extracted: ''
[15:51:47] [DOC: 9222203] ℹ️  Diagnosis codes being written:
[15:51:47] [DOC: 9222203] ℹ️    - Latest_Episode_Firstdiagnosis: 'weakness'
[15:51:47] [DOC: 9222203] ℹ️    - Latest_Episode_Seconddiagnosis: 'weakness/gait abnormality'
[15:51:47] [DOC: 9222203] ℹ️    - Latest_Episode_Thirddiagnosis: 'chronic renal failure'
[15:51:47] [DOC: 9222203] ℹ️    - Latest_Episode_Fourthdiagnosis: 'phlebitis'
[15:51:47] [DOC: 9222203] ℹ️    - Latest_Episode_Fifthdiagnosis: 'thrombophlebitis'
[15:51:47] [DOC: 9222203] ℹ️    - Latest_Episode_Sixthdiagnosis: 'peripheral venous insufficiency'
[15:51:47] [DOC: 9222203] ✅ Patient data written to CSV: Dale Brooks | Sex: FEMALE | Age: 73 | Service: OT | Payer:  | MRN: MA240318025203
[15:51:47] ✅    ✅ Document 9222203 processed and saved successfully
[15:51:47] 🔄 
🔄 Step 8: Saving API details...
[15:51:47] [DOC: 9222203] ℹ️  API push details saved for document 9222203
[15:51:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222201                         ║
================================================================================
[15:51:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:51:47] ℹ️  Date: 04/04/2025
[15:51:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:51:49] [DOC: 9222201] ✅ Text extracted using pdfplumber (14523 chars)
[15:51:49] ✅    ✅ Text extracted using pdfplumber (14523 chars)
[15:51:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:52] ℹ️  AI extracted raw sex value: 'F'
[15:51:52] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing, Occupational Therapy'
[15:51:52] ℹ️  AI extracted payer source: 'Medicare'
[15:51:52] ℹ️  AI extracted diagnoses:
[15:51:52] ℹ️    - Diagnosis 1: 'G40.909'
[15:51:52] ℹ️    - Diagnosis 2: 'F51.04'
[15:51:52] ℹ️    - Diagnosis 3: 'G81.94'
[15:51:52] ℹ️    - Diagnosis 4: 'E44.0'
[15:51:52] ℹ️    - Diagnosis 5: 'I48.91'
[15:51:52] ℹ️    - Diagnosis 6: 'I12.9'
[15:51:52] ℹ️  Final extracted MRN: 'MA240318025203'
[15:51:52] ℹ️  Final extracted Sex: 'FEMALE'
[15:51:52] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing, Occupational Therapy'
[15:51:52] ℹ️  Final extracted Payer Source: 'Medicare'
[15:51:52] ✅ Patient data extraction completed successfully
[15:51:52] ✅    ✅ Patient data extracted successfully
[15:51:52] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 276 Cottage St, Apt 205
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 520-7048
     └─ serviceLine: Physical Therapy, Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/12/2024', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': 'E44.0', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I12.9'}]
[15:51:52] ✅    ✅ Patient identified: Dale Brooks
[15:51:52] ✅    ✅ Patient name validation passed
[15:51:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:52] [DOC: 9222201] ℹ️  DOB normalized: 02/24/1952
[15:51:52] [DOC: 9222201] ℹ️  Episode startOfCare normalized: 11/12/2024
[15:51:52] [DOC: 9222201] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[15:51:52] [DOC: 9222201] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[15:51:52] [DOC: 9222201] ✅ Patient date processing completed successfully
[15:51:52] ✅    ✅ Date processing completed
[15:51:52] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 276 Cottage St, Apt 205
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 520-7048
     └─ serviceLine: Physical Therapy, Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/12/2024', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': 'E44.0', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I12.9'}]
[15:51:52] 🔄 
🔄 Step 4: Extracting order data...
[15:51:55] ℹ️  Order extraction - MRN: 'MA240318025203'
[15:51:55] ℹ️  Order extraction - Sex: 'FEMALE'
[15:51:55] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing, Occupational Therapy'
[15:51:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:51:55] ✅ Order data extraction completed successfully
[15:51:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:55] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[15:51:55] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing, Occupational Therapy'
[15:51:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:51:55] ✅ Patient name cross-validation successful
[15:51:55] ✅    ✅ Data merged successfully
[15:51:56] ✅    ✅ Order data extracted and validated
[15:51:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:56] [DOC: 9222201] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:56] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:56] 🔄 
🔄 Step 6: Pushing order to API...
[15:51:56] [DOC: 9222201] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[15:51:58] [DOC: 9222201] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13366"}
[15:51:58] ❌    ❌ Failed to push order
[15:51:58] 🔄 
🔄 Step 7: Writing to CSV...
[15:51:58] [DOC: 9222201] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[15:51:58] [DOC: 9222201] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing, Occupational Therapy'
[15:51:58] [DOC: 9222201] ℹ️  Payer Source extracted: 'Medicare'
[15:51:58] [DOC: 9222201] ℹ️  Diagnosis codes being written:
[15:51:58] [DOC: 9222201] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[15:51:58] [DOC: 9222201] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[15:51:58] [DOC: 9222201] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[15:51:58] [DOC: 9222201] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E44.0'
[15:51:58] [DOC: 9222201] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[15:51:58] [DOC: 9222201] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[15:51:58] [DOC: 9222201] ✅ Patient data written to CSV: Dale Brooks | Sex: FEMALE | Age: 73 | Service: Physical Therapy, Skilled Nursing, Occupational Therapy | Payer: Medicare | MRN: MA240318025203
[15:51:58] ✅    ✅ Document 9222201 processed and saved successfully
[15:51:58] 🔄 
🔄 Step 8: Saving API details...
[15:51:58] [DOC: 9222201] ℹ️  API push details saved for document 9222201
[15:51:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9222190                         ║
================================================================================
[15:51:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:51:58] ℹ️  Date: 04/04/2025
[15:51:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:00] [DOC: 9222190] ✅ Text extracted using pdfplumber (1573 chars)
[15:52:00] ✅    ✅ Text extracted using pdfplumber (1561 chars)
[15:52:00] 🔄 
🔄 Step 2: Extracting patient data...
[15:52:03] ℹ️  AI extracted raw sex value: ''
[15:52:03] ℹ️  AI extracted service line: 'Physical Therapy'
[15:52:03] ℹ️  AI extracted payer source: ''
[15:52:03] ℹ️  AI extracted diagnoses:
[15:52:03] ℹ️    - Diagnosis 1: 'G89.4'
[15:52:03] ℹ️    - Diagnosis 2: 'M54.9'
[15:52:03] ℹ️    - Diagnosis 3: 'J44.89'
[15:52:03] ℹ️    - Diagnosis 4: 'None'
[15:52:03] ℹ️    - Diagnosis 5: 'None'
[15:52:03] ℹ️    - Diagnosis 6: 'None'
[15:52:03] ℹ️  Final extracted MRN: 'MA241122026006'
[15:52:03] ℹ️  Final extracted Sex: ''
[15:52:03] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:52:03] ℹ️  Final extracted Payer Source: ''
[15:52:03] ✅ Patient data extraction completed successfully
[15:52:03] ✅    ✅ Patient data extracted successfully
[15:52:03] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:52:03] ✅    ✅ Patient identified: Elba Rivera
[15:52:03] ✅    ✅ Patient name validation passed
[15:52:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:52:03] [DOC: 9222190] ℹ️  DOB normalized: 02/14/1960
[15:52:03] [DOC: 9222190] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:52:03] [DOC: 9222190] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:52:03] [DOC: 9222190] ✅ Patient date processing completed successfully
[15:52:03] ✅    ✅ Date processing completed
[15:52:03] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89'}]
[15:52:03] 🔄 
🔄 Step 4: Extracting order data...
[15:52:06] ℹ️  Order extraction - MRN: 'MA241122026006'
[15:52:06] ℹ️  Order extraction - Sex: ''
[15:52:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:52:06] ℹ️  Order extraction - Payer Source: ''
[15:52:06] ✅ Order data extraction completed successfully
[15:52:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:52:06] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[15:52:06] ⚠️  Could not determine sex using any available method
[15:52:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:52:06] ✅ Patient name cross-validation successful
[15:52:06] ✅    ✅ Data merged successfully
[15:52:07] ✅    ✅ Order data extracted and validated
[15:52:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:52:14] [DOC: 9222190] ℹ️  Patient not found in cache or API: Elba Rivera
[15:52:14] [DOC: 9222190] ℹ️  Patient not found, creating new patient via API...
[15:52:14] [DOC: 9222190] ℹ️  Creating patient via API: Elba Rivera
[15:52:15] [DOC: 9222190] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:52:15] ❌    ❌ Failed to create patient
[15:52:15] [DOC: 9222190] ℹ️  API push details saved for document 9222190
================================================================================
║                        Processing Document ID: 9222189                         ║
================================================================================
[15:52:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:52:15] ℹ️  Date: 04/04/2025
[15:52:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:18] [DOC: 9222189] ✅ Text extracted using pdfplumber (19090 chars)
[15:52:18] ✅    ✅ Text extracted using pdfplumber (19090 chars)
[15:52:18] 🔄 
🔄 Step 2: Extracting patient data...
[15:52:21] ℹ️  AI extracted raw sex value: 'F'
[15:52:21] ℹ️  AI extracted service line: 'PT'
[15:52:21] ℹ️  AI extracted payer source: ''
[15:52:21] ℹ️  AI extracted diagnoses:
[15:52:21] ℹ️    - Diagnosis 1: 'Chronic pain syndrome'
[15:52:21] ℹ️    - Diagnosis 2: 'Muscle weakness'
[15:52:21] ℹ️    - Diagnosis 3: 'Old NSTEMI'
[15:52:21] ℹ️    - Diagnosis 4: 'COPD'
[15:52:21] ℹ️    - Diagnosis 5: 'HIV'
[15:52:21] ℹ️    - Diagnosis 6: 'HTN'
[15:52:21] ℹ️  Final extracted MRN: 'MA241122026006'
[15:52:21] ℹ️  Final extracted Sex: 'FEMALE'
[15:52:21] ℹ️  Final extracted Service Line: 'PT'
[15:52:21] ℹ️  Final extracted Payer Source: ''
[15:52:21] ✅ Patient data extraction completed successfully
[15:52:21] ✅    ✅ Patient data extracted successfully
[15:52:21] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/25', 'firstDiagnosis': 'Chronic pain syndrome', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'Old NSTEMI', 'fourthDiagnosis': 'COPD', 'fifthDiagnosis': 'HIV', 'sixthDiagnosis': 'HTN'}]
[15:52:21] ✅    ✅ Patient identified: Elba Rivera
[15:52:21] ✅    ✅ Patient name validation passed
[15:52:21] 🔄 
🔄 Step 3: Processing patient dates...
[15:52:21] [DOC: 9222189] ℹ️  DOB normalized: 02/14/1960
[15:52:21] [DOC: 9222189] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:52:21] [DOC: 9222189] ⚠️  Invalid endOfEpisode format: 05/12/25
[15:52:21] [DOC: 9222189] ✅ Patient date processing completed successfully
[15:52:21] ✅    ✅ Date processing completed
[15:52:21] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/25', 'firstDiagnosis': 'Chronic pain syndrome', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'Old NSTEMI', 'fourthDiagnosis': 'COPD', 'fifthDiagnosis': 'HIV', 'sixthDiagnosis': 'HTN'}]
[15:52:21] 🔄 
🔄 Step 4: Extracting order data...
[15:52:24] ℹ️  Order extraction - MRN: 'MA241122026006'
[15:52:24] ℹ️  Order extraction - Sex: 'FEMALE'
[15:52:24] ℹ️  Order extraction - Service Line: 'PT'
[15:52:24] ℹ️  Order extraction - Payer Source: ''
[15:52:24] ✅ Order data extraction completed successfully
[15:52:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:52:24] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[15:52:24] ℹ️  Service line consistent in both sources: 'PT'
[15:52:24] ✅ Patient name cross-validation successful
[15:52:24] ✅    ✅ Data merged successfully
[15:52:25] ✅    ✅ Order data extracted and validated
[15:52:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:52:29] [DOC: 9222189] ℹ️  Patient not found in cache or API: Elba Rivera
[15:52:29] [DOC: 9222189] ℹ️  Patient not found, creating new patient via API...
[15:52:29] [DOC: 9222189] ℹ️  Creating patient via API: Elba Rivera
[15:52:30] [DOC: 9222189] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:52:30] ❌    ❌ Failed to create patient
[15:52:30] [DOC: 9222189] ℹ️  API push details saved for document 9222189
================================================================================
║                        Processing Document ID: 9222186                         ║
================================================================================
[15:52:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:52:30] ℹ️  Date: 04/04/2025
[15:52:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:32] [DOC: 9222186] ✅ Text extracted using pdfplumber (1434 chars)
[15:52:32] ✅    ✅ Text extracted using pdfplumber (1422 chars)
[15:52:32] 🔄 
🔄 Step 2: Extracting patient data...
[15:52:35] ℹ️  AI extracted raw sex value: ''
[15:52:35] ℹ️  AI extracted service line: 'Physical Therapy'
[15:52:35] ℹ️  AI extracted payer source: ''
[15:52:35] ℹ️  AI extracted diagnoses:
[15:52:35] ℹ️    - Diagnosis 1: 'G89.4'
[15:52:35] ℹ️    - Diagnosis 2: 'M54.9'
[15:52:35] ℹ️    - Diagnosis 3: 'J44.89'
[15:52:35] ℹ️    - Diagnosis 4: 'None'
[15:52:35] ℹ️    - Diagnosis 5: 'None'
[15:52:35] ℹ️    - Diagnosis 6: 'None'
[15:52:35] ℹ️  Final extracted MRN: 'MA241122026006'
[15:52:35] ℹ️  Final extracted Sex: ''
[15:52:35] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:52:35] ℹ️  Final extracted Payer Source: ''
[15:52:35] ✅ Patient data extraction completed successfully
[15:52:35] ✅    ✅ Patient data extracted successfully
[15:52:35] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:52:35] ✅    ✅ Patient identified: Elba Rivera
[15:52:35] ✅    ✅ Patient name validation passed
[15:52:35] 🔄 
🔄 Step 3: Processing patient dates...
[15:52:35] [DOC: 9222186] ℹ️  DOB normalized: 02/14/1960
[15:52:35] [DOC: 9222186] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:52:35] [DOC: 9222186] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:52:35] [DOC: 9222186] ✅ Patient date processing completed successfully
[15:52:35] ✅    ✅ Date processing completed
[15:52:35] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89'}]
[15:52:35] 🔄 
🔄 Step 4: Extracting order data...
[15:52:38] ℹ️  Order extraction - MRN: 'MA241122026006'
[15:52:38] ℹ️  Order extraction - Sex: ''
[15:52:38] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:52:38] ℹ️  Order extraction - Payer Source: ''
[15:52:38] ✅ Order data extraction completed successfully
[15:52:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:52:38] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[15:52:38] ⚠️  Could not determine sex using any available method
[15:52:38] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:52:38] ✅ Patient name cross-validation successful
[15:52:38] ✅    ✅ Data merged successfully
[15:52:39] ✅    ✅ Order data extracted and validated
[15:52:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:53:09] [DOC: 9222186] ℹ️  Patient not found in cache or API: Elba Rivera
[15:53:09] [DOC: 9222186] ℹ️  Patient not found, creating new patient via API...
[15:53:09] [DOC: 9222186] ℹ️  Creating patient via API: Elba Rivera
[15:53:10] [DOC: 9222186] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:53:10] ❌    ❌ Failed to create patient
[15:53:10] [DOC: 9222186] ℹ️  API push details saved for document 9222186
================================================================================
║                        Processing Document ID: 9222184                         ║
================================================================================
[15:53:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:53:10] ℹ️  Date: 04/04/2025
[15:53:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:53:13] [DOC: 9222184] ✅ Text extracted using pdfplumber (13064 chars)
[15:53:13] ✅    ✅ Text extracted using pdfplumber (13064 chars)
[15:53:13] 🔄 
🔄 Step 2: Extracting patient data...
[15:53:15] ℹ️  AI extracted raw sex value: 'F'
[15:53:15] ℹ️  AI extracted service line: 'OT'
[15:53:15] ℹ️  AI extracted payer source: ''
[15:53:15] ℹ️  AI extracted diagnoses:
[15:53:15] ℹ️    - Diagnosis 1: 'J44.1'
[15:53:15] ℹ️    - Diagnosis 2: 'J18.9'
[15:53:15] ℹ️    - Diagnosis 3: ''
[15:53:15] ℹ️    - Diagnosis 4: ''
[15:53:15] ℹ️    - Diagnosis 5: ''
[15:53:15] ℹ️    - Diagnosis 6: ''
[15:53:15] ℹ️  Final extracted MRN: 'MA241122026006'
[15:53:15] ℹ️  Final extracted Sex: 'FEMALE'
[15:53:15] ℹ️  Final extracted Service Line: 'OT'
[15:53:15] ℹ️  Final extracted Payer Source: ''
[15:53:15] ✅ Patient data extraction completed successfully
[15:53:15] ✅    ✅ Patient data extracted successfully
[15:53:15] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:53:15] ✅    ✅ Patient identified: Elba Rivera
[15:53:15] ✅    ✅ Patient name validation passed
[15:53:15] 🔄 
🔄 Step 3: Processing patient dates...
[15:53:15] [DOC: 9222184] ℹ️  DOB normalized: 02/14/1960
[15:53:15] [DOC: 9222184] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[15:53:15] [DOC: 9222184] ✅ Patient date processing completed successfully
[15:53:15] ✅    ✅ Date processing completed
[15:53:15] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:53:15] 🔄 
🔄 Step 4: Extracting order data...
[15:53:18] ℹ️  Order extraction - MRN: 'MA241122026006'
[15:53:18] ℹ️  Order extraction - Sex: 'FEMALE'
[15:53:18] ℹ️  Order extraction - Service Line: 'OT'
[15:53:18] ℹ️  Order extraction - Payer Source: ''
[15:53:18] ✅ Order data extraction completed successfully
[15:53:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:53:18] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[15:53:18] ℹ️  Service line consistent in both sources: 'OT'
[15:53:18] ✅ Patient name cross-validation successful
[15:53:18] ✅    ✅ Data merged successfully
[15:53:19] ✅    ✅ Order data extracted and validated
[15:53:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:53:25] [DOC: 9222184] ℹ️  Patient not found in cache or API: Elba Rivera
[15:53:25] [DOC: 9222184] ℹ️  Patient not found, creating new patient via API...
[15:53:25] [DOC: 9222184] ℹ️  Creating patient via API: Elba Rivera
[15:53:26] [DOC: 9222184] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:53:26] ❌    ❌ Failed to create patient
[15:53:26] [DOC: 9222184] ℹ️  API push details saved for document 9222184
================================================================================
║                        Processing Document ID: 9222182                         ║
================================================================================
[15:53:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:53:26] ℹ️  Date: 04/04/2025
[15:53:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:53:28] [DOC: 9222182] ✅ Text extracted using pdfplumber (1238 chars)
[15:53:28] ✅    ✅ Text extracted using pdfplumber (1226 chars)
[15:53:28] 🔄 
🔄 Step 2: Extracting patient data...
[15:53:31] ℹ️  AI extracted raw sex value: ''
[15:53:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:53:31] ℹ️  AI extracted payer source: ''
[15:53:31] ℹ️  AI extracted diagnoses:
[15:53:31] ℹ️    - Diagnosis 1: 'G89.4'
[15:53:31] ℹ️    - Diagnosis 2: 'M54.9'
[15:53:31] ℹ️    - Diagnosis 3: 'J44.89'
[15:53:31] ℹ️    - Diagnosis 4: 'None'
[15:53:31] ℹ️    - Diagnosis 5: 'None'
[15:53:31] ℹ️    - Diagnosis 6: 'None'
[15:53:31] ℹ️  Final extracted MRN: 'MA241122026006'
[15:53:31] ℹ️  Final extracted Sex: ''
[15:53:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:53:31] ℹ️  Final extracted Payer Source: ''
[15:53:31] ✅ Patient data extraction completed successfully
[15:53:31] ✅    ✅ Patient data extracted successfully
[15:53:31] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:53:31] ✅    ✅ Patient identified: Elba Rivera
[15:53:31] ✅    ✅ Patient name validation passed
[15:53:31] 🔄 
🔄 Step 3: Processing patient dates...
[15:53:31] [DOC: 9222182] ℹ️  DOB normalized: 02/14/1960
[15:53:31] [DOC: 9222182] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:53:31] [DOC: 9222182] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:53:31] [DOC: 9222182] ✅ Patient date processing completed successfully
[15:53:31] ✅    ✅ Date processing completed
[15:53:31] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89'}]
[15:53:31] 🔄 
🔄 Step 4: Extracting order data...
[15:53:34] ℹ️  Order extraction - MRN: 'MA241122026006'
[15:53:34] ℹ️  Order extraction - Sex: ''
[15:53:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:53:34] ℹ️  Order extraction - Payer Source: ''
[15:53:34] ✅ Order data extraction completed successfully
[15:53:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:53:34] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[15:53:34] ⚠️  Could not determine sex using any available method
[15:53:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:53:34] ✅ Patient name cross-validation successful
[15:53:34] ✅    ✅ Data merged successfully
[15:53:35] ✅    ✅ Order data extracted and validated
[15:53:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:53:40] [DOC: 9222182] ℹ️  Patient not found in cache or API: Elba Rivera
[15:53:40] [DOC: 9222182] ℹ️  Patient not found, creating new patient via API...
[15:53:40] [DOC: 9222182] ℹ️  Creating patient via API: Elba Rivera
[15:53:44] [DOC: 9222182] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:53:44] ❌    ❌ Failed to create patient
[15:53:44] [DOC: 9222182] ℹ️  API push details saved for document 9222182
================================================================================
║                        Processing Document ID: 9222180                         ║
================================================================================
[15:53:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:53:44] ℹ️  Date: 04/04/2025
[15:53:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:53:47] [DOC: 9222180] ✅ Text extracted using pdfplumber (15462 chars)
[15:53:47] ✅    ✅ Text extracted using pdfplumber (15450 chars)
[15:53:47] 🔄 
🔄 Step 2: Extracting patient data...
[15:53:50] ℹ️  AI extracted raw sex value: 'F'
[15:53:50] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:53:50] ℹ️  AI extracted payer source: 'SWH'
[15:53:50] ℹ️  AI extracted diagnoses:
[15:53:50] ℹ️    - Diagnosis 1: 'G89.4'
[15:53:50] ℹ️    - Diagnosis 2: 'M54.9'
[15:53:50] ℹ️    - Diagnosis 3: 'J44.89'
[15:53:50] ℹ️    - Diagnosis 4: 'R21'
[15:53:50] ℹ️    - Diagnosis 5: 'M81.0'
[15:53:50] ℹ️    - Diagnosis 6: 'I10'
[15:53:50] ℹ️  Final extracted MRN: 'MA241122026006'
[15:53:50] ℹ️  Final extracted Sex: 'FEMALE'
[15:53:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:53:50] ℹ️  Final extracted Payer Source: 'SWH'
[15:53:50] ✅ Patient data extraction completed successfully
[15:53:50] ✅    ✅ Patient data extracted successfully
[15:53:50] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 2 Felton St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (774) 930-5839
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': 'R21', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'I10'}]
[15:53:50] ✅    ✅ Patient identified: Elba Rivera
[15:53:50] ✅    ✅ Patient name validation passed
[15:53:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:53:50] [DOC: 9222180] ℹ️  DOB normalized: 02/14/1960
[15:53:50] [DOC: 9222180] ℹ️  Episode startOfCare normalized: 03/14/2025
[15:53:50] [DOC: 9222180] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:53:50] [DOC: 9222180] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:53:50] [DOC: 9222180] ✅ Patient date processing completed successfully
[15:53:50] ✅    ✅ Date processing completed
[15:53:50] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 2 Felton St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (774) 930-5839
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': 'R21', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'I10'}]
[15:53:50] 🔄 
🔄 Step 4: Extracting order data...
[15:53:52] ℹ️  Order extraction - MRN: 'MA241122026006'
[15:53:52] ℹ️  Order extraction - Sex: 'FEMALE'
[15:53:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:53:52] ℹ️  Order extraction - Payer Source: 'SWH'
[15:53:52] ✅ Order data extraction completed successfully
[15:53:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:53:52] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[15:53:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:53:52] ℹ️  Payer source consistent in both sources: 'SWH'
[15:53:52] ✅ Patient name cross-validation successful
[15:53:52] ✅    ✅ Data merged successfully
[15:53:54] ✅    ✅ Order data extracted and validated
[15:53:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:54:21] [DOC: 9222180] ℹ️  Patient not found in cache or API: Elba Rivera
[15:54:21] [DOC: 9222180] ℹ️  Patient not found, creating new patient via API...
[15:54:21] [DOC: 9222180] ℹ️  Creating patient via API: Elba Rivera
[15:54:22] [DOC: 9222180] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:54:22] ❌    ❌ Failed to create patient
[15:54:22] [DOC: 9222180] ℹ️  API push details saved for document 9222180
================================================================================
║                        Processing Document ID: 9221976                         ║
================================================================================
[15:54:22] ℹ️  Agency: Fairhaven HH&H
[15:54:22] ℹ️  Date: 04/04/2025
[15:54:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:54:24] [DOC: 9221976] ✅ Text extracted using pdfplumber (1853 chars)
[15:54:24] ✅    ✅ Text extracted using pdfplumber (1853 chars)
[15:54:24] 🔄 
🔄 Step 2: Extracting patient data...
[15:54:27] ℹ️  AI extracted raw sex value: 'F'
[15:54:27] ℹ️  AI extracted service line: 'Hospice'
[15:54:27] ℹ️  AI extracted payer source: 'Medicare'
[15:54:27] ℹ️  AI extracted diagnoses:
[15:54:27] ℹ️    - Diagnosis 1: 'None'
[15:54:27] ℹ️    - Diagnosis 2: 'None'
[15:54:27] ℹ️    - Diagnosis 3: 'None'
[15:54:27] ℹ️    - Diagnosis 4: 'None'
[15:54:27] ℹ️    - Diagnosis 5: 'None'
[15:54:27] ℹ️    - Diagnosis 6: 'None'
[15:54:27] ℹ️  Final extracted MRN: '5782009'
[15:54:27] ℹ️  Final extracted Sex: 'FEMALE'
[15:54:27] ℹ️  Final extracted Service Line: 'Hospice'
[15:54:27] ℹ️  Final extracted Payer Source: 'Medicare'
[15:54:27] ✅ Patient data extraction completed successfully
[15:54:27] ✅    ✅ Patient data extracted successfully
[15:54:27] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'startOfEpisode': None, 'endOfEpisode': '04/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:54:27] ✅    ✅ Patient identified: Patricia Foster
[15:54:27] ✅    ✅ Patient name validation passed
[15:54:27] 🔄 
🔄 Step 3: Processing patient dates...
[15:54:27] [DOC: 9221976] ℹ️  DOB normalized: 06/16/1931
[15:54:27] [DOC: 9221976] ℹ️  Episode startOfCare normalized: 12/23/2022
[15:54:27] [DOC: 9221976] ℹ️  Episode endOfEpisode normalized: 04/10/2025
[15:54:27] [DOC: 9221976] ✅ Patient date processing completed successfully
[15:54:27] ✅    ✅ Date processing completed
[15:54:27] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'endOfEpisode': '04/10/2025'}]
[15:54:27] 🔄 
🔄 Step 4: Extracting order data...
[15:54:29] ℹ️  Order extraction - MRN: '5782009'
[15:54:29] ℹ️  Order extraction - Sex: 'FEMALE'
[15:54:29] ℹ️  Order extraction - Service Line: 'HHA'
[15:54:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:54:29] ✅ Order data extraction completed successfully
[15:54:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:54:29] ℹ️  Using MRN from patient data: '5782009' over '5782009'
[15:54:29] ℹ️  Combined service lines: Patient='Hospice' + Order='HHA' = 'HHA, Hospice'
[15:54:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:54:29] ✅ Patient name cross-validation successful
[15:54:29] ✅    ✅ Data merged successfully
[15:54:30] ✅    ✅ Order data extracted and validated
[15:54:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:54:30] [DOC: 9221976] ✅ Patient found in local cache: Patricia Foster, ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[15:54:30] ✅    ✅ Existing patient found with ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[15:54:30] 🔄 
🔄 Step 6: Pushing order to API...
[15:54:30] [DOC: 9221976] ℹ️  Pushing order via API for patient ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[15:54:31] [DOC: 9221976] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:54:31] ❌    ❌ Failed to push order
[15:54:31] 🔄 
🔄 Step 7: Writing to CSV...
[15:54:31] [DOC: 9221976] ℹ️  Calculated age: 93 from DOB: 06/16/1931
[15:54:31] [DOC: 9221976] ℹ️  Service Line extracted: 'HHA, Hospice'
[15:54:31] [DOC: 9221976] ℹ️  Payer Source extracted: 'Medicare'
[15:54:31] [DOC: 9221976] ℹ️  Diagnosis codes being written:
[15:54:31] [DOC: 9221976] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:54:31] [DOC: 9221976] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:54:31] [DOC: 9221976] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:54:31] [DOC: 9221976] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:54:31] [DOC: 9221976] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:54:31] [DOC: 9221976] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:54:31] [DOC: 9221976] ✅ Patient data written to CSV: Patricia Foster | Sex: FEMALE | Age: 93 | Service: HHA, Hospice | Payer: Medicare | MRN: 5782009
[15:54:31] ✅    ✅ Document 9221976 processed and saved successfully
[15:54:31] 🔄 
🔄 Step 8: Saving API details...
[15:54:31] [DOC: 9221976] ℹ️  API push details saved for document 9221976
[15:54:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221969                         ║
================================================================================
[15:54:31] ℹ️  Agency: Dartmouth HH
[15:54:31] ℹ️  Date: 04/04/2025
[15:54:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:54:38] [DOC: 9221969] ✅ Text extracted using pdfplumber (12796 chars)
[15:54:38] ✅    ✅ Text extracted using pdfplumber (12796 chars)
[15:54:38] 🔄 
🔄 Step 2: Extracting patient data...
[15:54:41] ℹ️  AI extracted raw sex value: 'M'
[15:54:41] ℹ️  AI extracted service line: 'PT, RN'
[15:54:41] ℹ️  AI extracted payer source: 'Medicare'
[15:54:41] ℹ️  AI extracted diagnoses:
[15:54:41] ℹ️    - Diagnosis 1: 'I13.0'
[15:54:41] ℹ️    - Diagnosis 2: 'I50.33'
[15:54:41] ℹ️    - Diagnosis 3: 'N18.32'
[15:54:41] ℹ️    - Diagnosis 4: 'R13.12'
[15:54:41] ℹ️    - Diagnosis 5: 'J44.89'
[15:54:41] ℹ️    - Diagnosis 6: 'J45.20'
[15:54:41] ℹ️  Final extracted MRN: '1654009'
[15:54:41] ℹ️  Final extracted Sex: 'MALE'
[15:54:41] ℹ️  Final extracted Service Line: 'PT, RN'
[15:54:41] ℹ️  Final extracted Payer Source: 'Medicare'
[15:54:41] ✅ Patient data extraction completed successfully
[15:54:41] ✅    ✅ Patient data extracted successfully
[15:54:41] 📊 Patient Response
     └─ patientFName: Wesley
     └─ patientLName: Lake
     └─ dob: 01/02/1928
     └─ patientSex: MALE
     └─ medicalRecordNo: 1654009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'R13.12', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'J45.20'}]
[15:54:41] ✅    ✅ Patient identified: Wesley Lake
[15:54:41] ✅    ✅ Patient name validation passed
[15:54:41] 🔄 
🔄 Step 3: Processing patient dates...
[15:54:41] [DOC: 9221969] ℹ️  DOB normalized: 01/02/1928
[15:54:41] [DOC: 9221969] ℹ️  Episode startOfCare normalized: 03/07/2025
[15:54:41] [DOC: 9221969] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:54:41] [DOC: 9221969] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[15:54:41] [DOC: 9221969] ✅ Patient date processing completed successfully
[15:54:41] ✅    ✅ Date processing completed
[15:54:41] 📊 Processed Patient Data
     └─ patientFName: Wesley
     └─ patientLName: Lake
     └─ dob: 01/02/1928
     └─ patientSex: MALE
     └─ medicalRecordNo: 1654009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'R13.12', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'J45.20'}]
[15:54:41] 🔄 
🔄 Step 4: Extracting order data...
[15:54:44] ℹ️  Order extraction - MRN: ''
[15:54:44] ℹ️  Order extraction - Sex: 'MALE'
[15:54:44] ℹ️  Order extraction - Service Line: 'PT, RN'
[15:54:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:54:44] ✅ Order data extraction completed successfully
[15:54:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:54:44] ℹ️  Using MRN from patient data: '1654009'
[15:54:44] ℹ️  Service line consistent in both sources: 'PT, RN'
[15:54:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:54:44] ✅ Patient name cross-validation successful
[15:54:44] ✅    ✅ Data merged successfully
[15:54:45] ✅    ✅ Order data extracted and validated
[15:54:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:54:51] [DOC: 9221969] ✅ Patient exists in API: Wesley Lake, ID: e5574fb1-4681-46d4-9dcf-a399c80abea5
[15:54:51] ✅    ✅ Existing patient found with ID: e5574fb1-4681-46d4-9dcf-a399c80abea5
[15:54:51] 🔄 
🔄 Step 6: Pushing order to API...
[15:54:51] [DOC: 9221969] ℹ️  Pushing order via API for patient ID: e5574fb1-4681-46d4-9dcf-a399c80abea5
[15:54:52] [DOC: 9221969] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:54:52] ❌    ❌ Failed to push order
[15:54:52] 🔄 
🔄 Step 7: Writing to CSV...
[15:54:52] [DOC: 9221969] ℹ️  Calculated age: 97 from DOB: 01/02/1928
[15:54:52] [DOC: 9221969] ℹ️  Service Line extracted: 'PT, RN'
[15:54:52] [DOC: 9221969] ℹ️  Payer Source extracted: 'Medicare'
[15:54:52] [DOC: 9221969] ℹ️  Diagnosis codes being written:
[15:54:52] [DOC: 9221969] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[15:54:52] [DOC: 9221969] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[15:54:52] [DOC: 9221969] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.32'
[15:54:52] [DOC: 9221969] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R13.12'
[15:54:52] [DOC: 9221969] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.89'
[15:54:52] [DOC: 9221969] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J45.20'
[15:54:52] [DOC: 9221969] ✅ Patient data written to CSV: Wesley Lake | Sex: MALE | Age: 97 | Service: PT, RN | Payer: Medicare | MRN: 1654009
[15:54:52] ✅    ✅ Document 9221969 processed and saved successfully
[15:54:52] 🔄 
🔄 Step 8: Saving API details...
[15:54:52] [DOC: 9221969] ℹ️  API push details saved for document 9221969
[15:54:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221967                         ║
================================================================================
[15:54:52] ℹ️  Agency: Dartmouth HH
[15:54:52] ℹ️  Date: 04/04/2025
[15:54:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:54:54] [DOC: 9221967] ✅ Text extracted using pdfplumber (1050 chars)
[15:54:54] ✅    ✅ Text extracted using pdfplumber (1050 chars)
[15:54:54] 🔄 
🔄 Step 2: Extracting patient data...
[15:54:57] ℹ️  AI extracted raw sex value: 'F'
[15:54:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:54:57] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[15:54:57] ℹ️  AI extracted diagnoses:
[15:54:57] ℹ️    - Diagnosis 1: 'None'
[15:54:57] ℹ️    - Diagnosis 2: 'None'
[15:54:57] ℹ️    - Diagnosis 3: 'None'
[15:54:57] ℹ️    - Diagnosis 4: 'None'
[15:54:57] ℹ️    - Diagnosis 5: 'None'
[15:54:57] ℹ️    - Diagnosis 6: 'None'
[15:54:57] ℹ️  Final extracted MRN: '651015'
[15:54:57] ℹ️  Final extracted Sex: 'FEMALE'
[15:54:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:54:57] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[15:54:57] ✅ Patient data extraction completed successfully
[15:54:57] ✅    ✅ Patient data extracted successfully
[15:54:57] 📊 Patient Response
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:54:57] ✅    ✅ Patient identified: A Shirley Jadlowe
[15:54:57] ✅    ✅ Patient name validation passed
[15:54:57] 🔄 
🔄 Step 3: Processing patient dates...
[15:54:57] [DOC: 9221967] ℹ️  DOB normalized: 01/19/1935
[15:54:57] [DOC: 9221967] ℹ️  Episode startOfCare normalized: 05/23/2024
[15:54:57] [DOC: 9221967] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:54:57] [DOC: 9221967] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[15:54:57] [DOC: 9221967] ✅ Patient date processing completed successfully
[15:54:57] ✅    ✅ Date processing completed
[15:54:57] 📊 Processed Patient Data
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025'}]
[15:54:57] 🔄 
🔄 Step 4: Extracting order data...
[15:54:59] ℹ️  Order extraction - MRN: ''
[15:54:59] ℹ️  Order extraction - Sex: 'FEMALE'
[15:54:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:54:59] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[15:54:59] ✅ Order data extraction completed successfully
[15:54:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:54:59] ℹ️  Using MRN from patient data: '651015'
[15:54:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:54:59] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[15:54:59] ✅ Patient name cross-validation successful
[15:54:59] ✅    ✅ Data merged successfully
[15:55:00] ✅    ✅ Order data extracted and validated
[15:55:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:00] [DOC: 9221967] ✅ Patient found in local cache: A Shirley Jadlowe, ID: f434f7e2-b2e3-4187-b677-c68e57142970
[15:55:00] ✅    ✅ Existing patient found with ID: f434f7e2-b2e3-4187-b677-c68e57142970
[15:55:00] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:00] [DOC: 9221967] ℹ️  Pushing order via API for patient ID: f434f7e2-b2e3-4187-b677-c68e57142970
[15:55:02] [DOC: 9221967] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13843"}
[15:55:02] ❌    ❌ Failed to push order
[15:55:02] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:02] [DOC: 9221967] ℹ️  Calculated age: 90 from DOB: 01/19/1935
[15:55:02] [DOC: 9221967] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:55:02] [DOC: 9221967] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[15:55:02] [DOC: 9221967] ℹ️  Diagnosis codes being written:
[15:55:02] [DOC: 9221967] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:55:02] [DOC: 9221967] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:55:02] [DOC: 9221967] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:55:02] [DOC: 9221967] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:55:02] [DOC: 9221967] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:55:02] [DOC: 9221967] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:55:02] [DOC: 9221967] ✅ Patient data written to CSV: A Shirley Jadlowe | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 651015
[15:55:02] ✅    ✅ Document 9221967 processed and saved successfully
[15:55:02] 🔄 
🔄 Step 8: Saving API details...
[15:55:02] [DOC: 9221967] ℹ️  API push details saved for document 9221967
[15:55:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221962                         ║
================================================================================
[15:55:02] ℹ️  Agency: Dartmouth HH
[15:55:02] ℹ️  Date: 04/04/2025
[15:55:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:04] [DOC: 9221962] ✅ Text extracted using pdfplumber (1707 chars)
[15:55:04] ✅    ✅ Text extracted using pdfplumber (1707 chars)
[15:55:04] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:06] ℹ️  AI extracted raw sex value: 'F'
[15:55:06] ℹ️  AI extracted service line: 'RN'
[15:55:06] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[15:55:06] ℹ️  AI extracted diagnoses:
[15:55:06] ℹ️    - Diagnosis 1: ''
[15:55:06] ℹ️    - Diagnosis 2: ''
[15:55:06] ℹ️    - Diagnosis 3: ''
[15:55:06] ℹ️    - Diagnosis 4: ''
[15:55:06] ℹ️    - Diagnosis 5: ''
[15:55:06] ℹ️    - Diagnosis 6: ''
[15:55:06] ℹ️  Final extracted MRN: '6201015'
[15:55:06] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:06] ℹ️  Final extracted Service Line: 'RN'
[15:55:06] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:55:06] ✅ Patient data extraction completed successfully
[15:55:06] ✅    ✅ Patient data extracted successfully
[15:55:06] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:55:06] ✅    ✅ Patient identified: Maria Laborinho
[15:55:06] ✅    ✅ Patient name validation passed
[15:55:06] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:06] [DOC: 9221962] ℹ️  DOB normalized: 02/08/1951
[15:55:06] [DOC: 9221962] ℹ️  Episode startOfCare normalized: 03/13/2025
[15:55:06] [DOC: 9221962] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[15:55:06] [DOC: 9221962] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[15:55:06] [DOC: 9221962] ✅ Patient date processing completed successfully
[15:55:06] ✅    ✅ Date processing completed
[15:55:06] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:55:06] 🔄 
🔄 Step 4: Extracting order data...
[15:55:09] ℹ️  Order extraction - MRN: ''
[15:55:09] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:09] ℹ️  Order extraction - Service Line: 'RN'
[15:55:09] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:55:09] ✅ Order data extraction completed successfully
[15:55:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:09] ℹ️  Using MRN from patient data: '6201015'
[15:55:09] ℹ️  Service line consistent in both sources: 'RN'
[15:55:09] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[15:55:09] ✅ Patient name cross-validation successful
[15:55:09] ✅    ✅ Data merged successfully
[15:55:10] ✅    ✅ Order data extracted and validated
[15:55:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:18] [DOC: 9221962] ℹ️  Patient not found in cache or API: Maria Laborinho
[15:55:18] [DOC: 9221962] ℹ️  Patient not found, creating new patient via API...
[15:55:18] [DOC: 9221962] ℹ️  Creating patient via API: Maria Laborinho
[15:55:19] [DOC: 9221962] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:55:19] ❌    ❌ Failed to create patient
[15:55:19] [DOC: 9221962] ℹ️  API push details saved for document 9221962
================================================================================
║                        Processing Document ID: 9221954                         ║
================================================================================
[15:55:19] ℹ️  Agency: Dartmouth HH
[15:55:19] ℹ️  Date: 04/04/2025
[15:55:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:21] [DOC: 9221954] ✅ Text extracted using pdfplumber (5647 chars)
[15:55:21] ✅    ✅ Text extracted using pdfplumber (5647 chars)
[15:55:21] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:24] ℹ️  AI extracted raw sex value: 'F'
[15:55:24] ℹ️  AI extracted service line: 'PT'
[15:55:24] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[15:55:24] ℹ️  AI extracted diagnoses:
[15:55:24] ℹ️    - Diagnosis 1: ''
[15:55:24] ℹ️    - Diagnosis 2: ''
[15:55:24] ℹ️    - Diagnosis 3: ''
[15:55:24] ℹ️    - Diagnosis 4: ''
[15:55:24] ℹ️    - Diagnosis 5: ''
[15:55:24] ℹ️    - Diagnosis 6: ''
[15:55:24] ℹ️  Final extracted MRN: '6122015'
[15:55:24] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:24] ℹ️  Final extracted Service Line: 'PT'
[15:55:24] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[15:55:24] ✅ Patient data extraction completed successfully
[15:55:24] ✅    ✅ Patient data extracted successfully
[15:55:24] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: Pichaske
     └─ dob: 12/09/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6122015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:55:24] ✅    ✅ Patient identified: Brenda Pichaske
[15:55:24] ✅    ✅ Patient name validation passed
[15:55:24] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:24] [DOC: 9221954] ℹ️  DOB normalized: 12/09/1950
[15:55:24] [DOC: 9221954] ℹ️  Episode startOfCare normalized: 03/06/2025
[15:55:24] [DOC: 9221954] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[15:55:24] [DOC: 9221954] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[15:55:24] [DOC: 9221954] ✅ Patient date processing completed successfully
[15:55:24] ✅    ✅ Date processing completed
[15:55:24] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: Pichaske
     └─ dob: 12/09/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6122015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:55:24] 🔄 
🔄 Step 4: Extracting order data...
[15:55:27] ℹ️  Order extraction - MRN: ''
[15:55:27] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:27] ℹ️  Order extraction - Service Line: 'PT'
[15:55:27] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[15:55:27] ✅ Order data extraction completed successfully
[15:55:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:27] ℹ️  Using MRN from patient data: '6122015'
[15:55:27] ℹ️  Service line consistent in both sources: 'PT'
[15:55:27] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[15:55:27] ✅ Patient name cross-validation successful
[15:55:27] ✅    ✅ Data merged successfully
[15:55:28] ✅    ✅ Order data extracted and validated
[15:55:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:50] [DOC: 9221954] ✅ Patient exists in API: Brenda Pichaske, ID: 8a3e3e7e-be8c-4861-ba77-a392276b937e
[15:55:50] ✅    ✅ Existing patient found with ID: 8a3e3e7e-be8c-4861-ba77-a392276b937e
[15:55:50] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:50] [DOC: 9221954] ℹ️  Pushing order via API for patient ID: 8a3e3e7e-be8c-4861-ba77-a392276b937e
[15:55:51] [DOC: 9221954] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:55:51] ❌    ❌ Failed to push order
[15:55:51] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:51] [DOC: 9221954] ℹ️  Calculated age: 74 from DOB: 12/09/1950
[15:55:51] [DOC: 9221954] ℹ️  Service Line extracted: 'PT'
[15:55:51] [DOC: 9221954] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[15:55:51] [DOC: 9221954] ℹ️  Diagnosis codes being written:
[15:55:51] [DOC: 9221954] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:55:51] [DOC: 9221954] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:55:51] [DOC: 9221954] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:55:51] [DOC: 9221954] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:55:51] [DOC: 9221954] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:55:51] [DOC: 9221954] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:55:51] [DOC: 9221954] ✅ Patient data written to CSV: Brenda Pichaske | Sex: FEMALE | Age: 74 | Service: PT | Payer: Blue Cross Blue Shield | MRN: 6122015
[15:55:51] ✅    ✅ Document 9221954 processed and saved successfully
[15:55:51] 🔄 
🔄 Step 8: Saving API details...
[15:55:51] [DOC: 9221954] ℹ️  API push details saved for document 9221954
[15:55:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221951                         ║
================================================================================
[15:55:51] ℹ️  Agency: Dartmouth HH
[15:55:51] ℹ️  Date: 04/04/2025
[15:55:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:53] [DOC: 9221951] ✅ Text extracted using pdfplumber (1505 chars)
[15:55:53] ✅    ✅ Text extracted using pdfplumber (1505 chars)
[15:55:53] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:56] ℹ️  AI extracted raw sex value: 'F'
[15:55:56] ℹ️  AI extracted service line: 'RN'
[15:55:56] ℹ️  AI extracted payer source: 'Medicare'
[15:55:56] ℹ️  AI extracted diagnoses:
[15:55:56] ℹ️    - Diagnosis 1: 'None'
[15:55:56] ℹ️    - Diagnosis 2: 'None'
[15:55:56] ℹ️    - Diagnosis 3: 'None'
[15:55:56] ℹ️    - Diagnosis 4: 'None'
[15:55:56] ℹ️    - Diagnosis 5: 'None'
[15:55:56] ℹ️    - Diagnosis 6: 'None'
[15:55:56] ℹ️  Final extracted MRN: '338008'
[15:55:56] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:56] ℹ️  Final extracted Service Line: 'RN'
[15:55:56] ℹ️  Final extracted Payer Source: 'Medicare'
[15:55:56] ✅ Patient data extraction completed successfully
[15:55:56] ✅    ✅ Patient data extracted successfully
[15:55:56] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Kelly
     └─ dob: 04/18/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 338008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 50A Oesting Street Apt A
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:55:56] ✅    ✅ Patient identified: Louise Kelly
[15:55:56] ✅    ✅ Patient name validation passed
[15:55:56] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:56] [DOC: 9221951] ℹ️  DOB normalized: 04/18/1952
[15:55:56] [DOC: 9221951] ℹ️  Episode startOfCare normalized: 03/07/2025
[15:55:56] [DOC: 9221951] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[15:55:56] [DOC: 9221951] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[15:55:56] [DOC: 9221951] ✅ Patient date processing completed successfully
[15:55:56] ✅    ✅ Date processing completed
[15:55:56] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Kelly
     └─ dob: 04/18/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 338008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 50A Oesting Street Apt A
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025'}]
[15:55:56] 🔄 
🔄 Step 4: Extracting order data...
[15:55:58] ℹ️  Order extraction - MRN: ''
[15:55:58] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:58] ℹ️  Order extraction - Service Line: 'RN'
[15:55:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:55:58] ✅ Order data extraction completed successfully
[15:55:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:58] ℹ️  Using MRN from patient data: '338008'
[15:55:58] ℹ️  Service line consistent in both sources: 'RN'
[15:55:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:55:58] ✅ Patient name cross-validation successful
[15:55:58] ✅    ✅ Data merged successfully
[15:55:59] ✅    ✅ Order data extracted and validated
[15:55:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:05] [DOC: 9221951] ℹ️  Patient not found in cache or API: Louise Kelly
[15:56:05] [DOC: 9221951] ℹ️  Patient not found, creating new patient via API...
[15:56:05] [DOC: 9221951] ℹ️  Creating patient via API: Louise Kelly
[15:56:06] [DOC: 9221951] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:56:06] ❌    ❌ Failed to create patient
[15:56:06] [DOC: 9221951] ℹ️  API push details saved for document 9221951
================================================================================
║                        Processing Document ID: 9221947                         ║
================================================================================
[15:56:06] ℹ️  Agency: Dartmouth HH
[15:56:06] ℹ️  Date: 04/04/2025
[15:56:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:09] [DOC: 9221947] ✅ Text extracted using pdfplumber (11498 chars)
[15:56:09] ✅    ✅ Text extracted using pdfplumber (11498 chars)
[15:56:09] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:11] ℹ️  AI extracted raw sex value: 'F'
[15:56:11] ℹ️  AI extracted service line: 'OT, PT, RN'
[15:56:11] ℹ️  AI extracted payer source: 'Medicare'
[15:56:11] ℹ️  AI extracted diagnoses:
[15:56:11] ℹ️    - Diagnosis 1: ''
[15:56:11] ℹ️    - Diagnosis 2: ''
[15:56:11] ℹ️    - Diagnosis 3: ''
[15:56:11] ℹ️    - Diagnosis 4: ''
[15:56:11] ℹ️    - Diagnosis 5: ''
[15:56:11] ℹ️    - Diagnosis 6: ''
[15:56:11] ℹ️  Final extracted MRN: '382011'
[15:56:11] ℹ️  Final extracted Sex: 'FEMALE'
[15:56:11] ℹ️  Final extracted Service Line: 'OT, PT, RN'
[15:56:11] ℹ️  Final extracted Payer Source: 'Medicare'
[15:56:11] ✅ Patient data extraction completed successfully
[15:56:11] ✅    ✅ Patient data extracted successfully
[15:56:11] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Saint Aubin
     └─ dob: 08/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 382011
     └─ billingProvider: Christine A Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:11] ✅    ✅ Patient identified: Marilyn Saint Aubin
[15:56:11] ✅    ✅ Patient name validation passed
[15:56:11] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:11] [DOC: 9221947] ℹ️  DOB normalized: 08/11/1940
[15:56:11] [DOC: 9221947] ℹ️  Episode startOfCare normalized: 03/19/2025
[15:56:11] [DOC: 9221947] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:56:11] [DOC: 9221947] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[15:56:11] [DOC: 9221947] ✅ Patient date processing completed successfully
[15:56:11] ✅    ✅ Date processing completed
[15:56:11] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Saint Aubin
     └─ dob: 08/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 382011
     └─ billingProvider: Christine A Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:11] 🔄 
🔄 Step 4: Extracting order data...
[15:56:14] ℹ️  Order extraction - MRN: ''
[15:56:14] ℹ️  Order extraction - Sex: 'FEMALE'
[15:56:14] ℹ️  Order extraction - Service Line: 'OT, PT, RN'
[15:56:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:56:14] ✅ Order data extraction completed successfully
[15:56:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:14] ℹ️  Using MRN from patient data: '382011'
[15:56:14] ℹ️  Service line consistent in both sources: 'OT, PT, RN'
[15:56:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:56:14] ✅ Patient name cross-validation successful
[15:56:14] ✅    ✅ Data merged successfully
[15:56:15] ✅    ✅ Order data extracted and validated
[15:56:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:22] [DOC: 9221947] ℹ️  Patient not found in cache or API: Marilyn Saint Aubin
[15:56:22] [DOC: 9221947] ℹ️  Patient not found, creating new patient via API...
[15:56:22] [DOC: 9221947] ℹ️  Creating patient via API: Marilyn Saint Aubin
[15:56:23] [DOC: 9221947] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:56:23] ❌    ❌ Failed to create patient
[15:56:23] [DOC: 9221947] ℹ️  API push details saved for document 9221947
================================================================================
║                        Processing Document ID: 9221921                         ║
================================================================================
[15:56:23] ℹ️  Agency: Dartmouth HH
[15:56:23] ℹ️  Date: 04/04/2025
[15:56:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:27] [DOC: 9221921] ✅ Text extracted using pdfplumber (22096 chars)
[15:56:27] ✅    ✅ Text extracted using pdfplumber (22084 chars)
[15:56:27] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:30] ℹ️  AI extracted raw sex value: 'F'
[15:56:30] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:56:30] ℹ️  AI extracted payer source: ''
[15:56:30] ℹ️  AI extracted diagnoses:
[15:56:30] ℹ️    - Diagnosis 1: 'G35'
[15:56:30] ℹ️    - Diagnosis 2: 'R53.1'
[15:56:30] ℹ️    - Diagnosis 3: 'F33.9'
[15:56:30] ℹ️    - Diagnosis 4: 'I10'
[15:56:30] ℹ️    - Diagnosis 5: 'N31.9'
[15:56:30] ℹ️    - Diagnosis 6: 'G91.2'
[15:56:30] ℹ️  Final extracted MRN: '338008'
[15:56:30] ℹ️  Final extracted Sex: 'FEMALE'
[15:56:30] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:56:30] ℹ️  Final extracted Payer Source: ''
[15:56:30] ✅ Patient data extraction completed successfully
[15:56:30] ✅    ✅ Patient data extracted successfully
[15:56:30] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Kelly
     └─ dob: 04/18/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 338008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G35', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'F33.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'G91.2'}]
[15:56:30] ✅    ✅ Patient identified: Louise Kelly
[15:56:30] ✅    ✅ Patient name validation passed
[15:56:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:30] [DOC: 9221921] ℹ️  DOB normalized: 04/18/1952
[15:56:30] [DOC: 9221921] ℹ️  Episode startOfCare normalized: 03/07/2025
[15:56:30] [DOC: 9221921] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[15:56:30] [DOC: 9221921] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[15:56:30] [DOC: 9221921] ✅ Patient date processing completed successfully
[15:56:30] ✅    ✅ Date processing completed
[15:56:30] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Kelly
     └─ dob: 04/18/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 338008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G35', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'F33.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'G91.2'}]
[15:56:30] 🔄 
🔄 Step 4: Extracting order data...
[15:56:32] ℹ️  Order extraction - MRN: '338008'
[15:56:32] ℹ️  Order extraction - Sex: 'FEMALE'
[15:56:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:56:32] ℹ️  Order extraction - Payer Source: ''
[15:56:32] ✅ Order data extraction completed successfully
[15:56:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:32] ℹ️  Using MRN from patient data: '338008' over '338008'
[15:56:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:56:32] ✅ Patient name cross-validation successful
[15:56:32] ✅    ✅ Data merged successfully
[15:56:34] ✅    ✅ Order data extracted and validated
[15:56:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:45] [DOC: 9221921] ℹ️  Patient not found in cache or API: Louise Kelly
[15:56:45] [DOC: 9221921] ℹ️  Patient not found, creating new patient via API...
[15:56:45] [DOC: 9221921] ℹ️  Creating patient via API: Louise Kelly
[15:56:46] [DOC: 9221921] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:56:46] ❌    ❌ Failed to create patient
[15:56:46] [DOC: 9221921] ℹ️  API push details saved for document 9221921
================================================================================
║                        Processing Document ID: 9221901                         ║
================================================================================
[15:56:46] ℹ️  Agency: Dartmouth HH
[15:56:46] ℹ️  Date: 04/04/2025
[15:56:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:48] [DOC: 9221901] ✅ Text extracted using pdfplumber (3471 chars)
[15:56:48] ✅    ✅ Text extracted using pdfplumber (3471 chars)
[15:56:48] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:51] ℹ️  AI extracted raw sex value: 'F'
[15:56:51] ℹ️  AI extracted service line: 'OT, RN'
[15:56:51] ℹ️  AI extracted payer source: 'Medicare'
[15:56:51] ℹ️  AI extracted diagnoses:
[15:56:51] ℹ️    - Diagnosis 1: ''
[15:56:51] ℹ️    - Diagnosis 2: ''
[15:56:51] ℹ️    - Diagnosis 3: ''
[15:56:51] ℹ️    - Diagnosis 4: ''
[15:56:51] ℹ️    - Diagnosis 5: ''
[15:56:51] ℹ️    - Diagnosis 6: ''
[15:56:51] ℹ️  Final extracted MRN: '6115015'
[15:56:51] ℹ️  Final extracted Sex: 'FEMALE'
[15:56:51] ℹ️  Final extracted Service Line: 'OT, RN'
[15:56:51] ℹ️  Final extracted Payer Source: 'Medicare'
[15:56:51] ✅ Patient data extraction completed successfully
[15:56:51] ✅    ✅ Patient data extracted successfully
[15:56:51] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:51] ✅    ✅ Patient identified: Nancy Silva
[15:56:51] ✅    ✅ Patient name validation passed
[15:56:51] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:51] [DOC: 9221901] ℹ️  DOB normalized: 11/18/1936
[15:56:51] [DOC: 9221901] ℹ️  Episode startOfCare normalized: 03/01/2025
[15:56:51] [DOC: 9221901] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[15:56:51] [DOC: 9221901] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[15:56:51] [DOC: 9221901] ✅ Patient date processing completed successfully
[15:56:51] ✅    ✅ Date processing completed
[15:56:51] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:51] 🔄 
🔄 Step 4: Extracting order data...
[15:56:53] ℹ️  Order extraction - MRN: '6115015'
[15:56:53] ℹ️  Order extraction - Sex: 'FEMALE'
[15:56:53] ℹ️  Order extraction - Service Line: 'OT, RN'
[15:56:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:56:53] ✅ Order data extraction completed successfully
[15:56:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:53] ℹ️  Using MRN from patient data: '6115015' over '6115015'
[15:56:53] ℹ️  Service line consistent in both sources: 'OT, RN'
[15:56:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:56:53] ✅ Patient name cross-validation successful
[15:56:53] ✅    ✅ Data merged successfully
[15:56:54] ✅    ✅ Order data extracted and validated
[15:56:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:54] [DOC: 9221901] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[15:56:54] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[15:56:54] 🔄 
🔄 Step 6: Pushing order to API...
[15:56:54] [DOC: 9221901] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[15:56:55] [DOC: 9221901] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:56:55] ❌    ❌ Failed to push order
[15:56:55] 🔄 
🔄 Step 7: Writing to CSV...
[15:56:55] [DOC: 9221901] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[15:56:55] [DOC: 9221901] ℹ️  Service Line extracted: 'OT, RN'
[15:56:55] [DOC: 9221901] ℹ️  Payer Source extracted: 'Medicare'
[15:56:55] [DOC: 9221901] ℹ️  Diagnosis codes being written:
[15:56:55] [DOC: 9221901] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:56:55] [DOC: 9221901] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:56:55] [DOC: 9221901] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:56:55] [DOC: 9221901] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:56:55] [DOC: 9221901] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:56:55] [DOC: 9221901] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:56:55] [DOC: 9221901] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: OT, RN | Payer: Medicare | MRN: 6115015
[15:56:55] ✅    ✅ Document 9221901 processed and saved successfully
[15:56:55] 🔄 
🔄 Step 8: Saving API details...
[15:56:55] [DOC: 9221901] ℹ️  API push details saved for document 9221901
[15:56:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221892                         ║
================================================================================
[15:56:55] ℹ️  Agency: Dartmouth HH
[15:56:55] ℹ️  Date: 04/04/2025
[15:56:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:57] [DOC: 9221892] ✅ Text extracted using pdfplumber (3615 chars)
[15:56:57] ✅    ✅ Text extracted using pdfplumber (3615 chars)
[15:56:57] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:00] ℹ️  AI extracted raw sex value: 'M'
[15:57:00] ℹ️  AI extracted service line: 'PT, RN'
[15:57:00] ℹ️  AI extracted payer source: 'Medicare'
[15:57:00] ℹ️  AI extracted diagnoses:
[15:57:00] ℹ️    - Diagnosis 1: ''
[15:57:00] ℹ️    - Diagnosis 2: ''
[15:57:00] ℹ️    - Diagnosis 3: ''
[15:57:00] ℹ️    - Diagnosis 4: ''
[15:57:00] ℹ️    - Diagnosis 5: ''
[15:57:00] ℹ️    - Diagnosis 6: ''
[15:57:00] ℹ️  Final extracted MRN: '2496015'
[15:57:00] ℹ️  Final extracted Sex: 'MALE'
[15:57:00] ℹ️  Final extracted Service Line: 'PT, RN'
[15:57:00] ℹ️  Final extracted Payer Source: 'Medicare'
[15:57:00] ✅ Patient data extraction completed successfully
[15:57:00] ✅    ✅ Patient data extracted successfully
[15:57:00] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:00] ✅    ✅ Patient identified: Dana Theodore
[15:57:00] ✅    ✅ Patient name validation passed
[15:57:00] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:00] [DOC: 9221892] ℹ️  DOB normalized: 03/16/1954
[15:57:00] [DOC: 9221892] ℹ️  Episode startOfCare normalized: 03/02/2025
[15:57:00] [DOC: 9221892] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[15:57:00] [DOC: 9221892] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[15:57:00] [DOC: 9221892] ✅ Patient date processing completed successfully
[15:57:00] ✅    ✅ Date processing completed
[15:57:00] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:00] 🔄 
🔄 Step 4: Extracting order data...
[15:57:02] ℹ️  Order extraction - MRN: ''
[15:57:02] ℹ️  Order extraction - Sex: 'FEMALE'
[15:57:02] ℹ️  Order extraction - Service Line: 'PT, RN'
[15:57:02] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:57:02] ✅ Order data extraction completed successfully
[15:57:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:02] ℹ️  Using MRN from patient data: '2496015'
[15:57:02] ⚠️  Sex mismatch: Patient='MALE' vs Order='FEMALE', using patient data
[15:57:02] ℹ️  Service line consistent in both sources: 'PT, RN'
[15:57:02] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:57:02] ✅ Patient name cross-validation successful
[15:57:02] ✅    ✅ Data merged successfully
[15:57:04] ✅    ✅ Order data extracted and validated
[15:57:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:04] [DOC: 9221892] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[15:57:04] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[15:57:04] 🔄 
🔄 Step 6: Pushing order to API...
[15:57:04] [DOC: 9221892] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[15:57:05] [DOC: 9221892] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14277"}
[15:57:05] ❌    ❌ Failed to push order
[15:57:05] 🔄 
🔄 Step 7: Writing to CSV...
[15:57:05] [DOC: 9221892] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[15:57:05] [DOC: 9221892] ℹ️  Service Line extracted: 'PT, RN'
[15:57:05] [DOC: 9221892] ℹ️  Payer Source extracted: 'Medicare'
[15:57:05] [DOC: 9221892] ℹ️  Diagnosis codes being written:
[15:57:05] [DOC: 9221892] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:57:05] [DOC: 9221892] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:57:05] [DOC: 9221892] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:57:05] [DOC: 9221892] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:57:05] [DOC: 9221892] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:57:05] [DOC: 9221892] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:57:05] [DOC: 9221892] ✅ Patient data written to CSV: Dana Theodore | Sex: MALE | Age: 71 | Service: PT, RN | Payer: Medicare | MRN: 2496015
[15:57:05] ✅    ✅ Document 9221892 processed and saved successfully
[15:57:05] 🔄 
🔄 Step 8: Saving API details...
[15:57:05] [DOC: 9221892] ℹ️  API push details saved for document 9221892
[15:57:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221883                         ║
================================================================================
[15:57:05] ℹ️  Agency: Dartmouth HH
[15:57:05] ℹ️  Date: 04/04/2025
[15:57:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:57:07] [DOC: 9221883] ✅ Text extracted using pdfplumber (1022 chars)
[15:57:07] ✅    ✅ Text extracted using pdfplumber (1022 chars)
[15:57:07] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:10] ℹ️  AI extracted raw sex value: 'F'
[15:57:10] ℹ️  AI extracted service line: 'RN'
[15:57:10] ℹ️  AI extracted payer source: 'Medicare'
[15:57:10] ℹ️  AI extracted diagnoses:
[15:57:10] ℹ️    - Diagnosis 1: ''
[15:57:10] ℹ️    - Diagnosis 2: ''
[15:57:10] ℹ️    - Diagnosis 3: ''
[15:57:10] ℹ️    - Diagnosis 4: ''
[15:57:10] ℹ️    - Diagnosis 5: ''
[15:57:10] ℹ️    - Diagnosis 6: ''
[15:57:10] ℹ️  Final extracted MRN: '5915015'
[15:57:10] ℹ️  Final extracted Sex: 'FEMALE'
[15:57:10] ℹ️  Final extracted Service Line: 'RN'
[15:57:10] ℹ️  Final extracted Payer Source: 'Medicare'
[15:57:10] ✅ Patient data extraction completed successfully
[15:57:10] ✅    ✅ Patient data extracted successfully
[15:57:10] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:10] ✅    ✅ Patient identified: Suzanne Fawcett
[15:57:10] ✅    ✅ Patient name validation passed
[15:57:10] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:10] [DOC: 9221883] ℹ️  DOB normalized: 12/08/1939
[15:57:10] [DOC: 9221883] ℹ️  Episode startOfCare normalized: 01/26/2025
[15:57:10] [DOC: 9221883] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[15:57:10] [DOC: 9221883] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[15:57:10] [DOC: 9221883] ✅ Patient date processing completed successfully
[15:57:10] ✅    ✅ Date processing completed
[15:57:10] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:10] 🔄 
🔄 Step 4: Extracting order data...
[15:57:12] ℹ️  Order extraction - MRN: ''
[15:57:12] ℹ️  Order extraction - Sex: 'FEMALE'
[15:57:12] ℹ️  Order extraction - Service Line: 'RN'
[15:57:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:57:12] ✅ Order data extraction completed successfully
[15:57:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:12] ℹ️  Using MRN from patient data: '5915015'
[15:57:12] ℹ️  Service line consistent in both sources: 'RN'
[15:57:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:57:12] ✅ Patient name cross-validation successful
[15:57:12] ✅    ✅ Data merged successfully
[15:57:14] ✅    ✅ Order data extracted and validated
[15:57:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:21] [DOC: 9221883] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[15:57:21] [DOC: 9221883] ℹ️  Patient not found, creating new patient via API...
[15:57:21] [DOC: 9221883] ℹ️  Creating patient via API: Suzanne Fawcett
[15:57:22] [DOC: 9221883] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:57:22] ❌    ❌ Failed to create patient
[15:57:22] [DOC: 9221883] ℹ️  API push details saved for document 9221883
================================================================================
║                        Processing Document ID: 9221876                         ║
================================================================================
[15:57:22] ℹ️  Agency: Dartmouth HH
[15:57:22] ℹ️  Date: 04/04/2025
[15:57:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:57:24] [DOC: 9221876] ✅ Text extracted using pdfplumber (1208 chars)
[15:57:24] ✅    ✅ Text extracted using pdfplumber (1208 chars)
[15:57:24] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:27] ℹ️  AI extracted raw sex value: 'M'
[15:57:27] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[15:57:27] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[15:57:27] ℹ️  AI extracted diagnoses:
[15:57:27] ℹ️    - Diagnosis 1: 'None'
[15:57:27] ℹ️    - Diagnosis 2: 'None'
[15:57:27] ℹ️    - Diagnosis 3: 'None'
[15:57:27] ℹ️    - Diagnosis 4: 'None'
[15:57:27] ℹ️    - Diagnosis 5: 'None'
[15:57:27] ℹ️    - Diagnosis 6: 'None'
[15:57:27] ℹ️  Final extracted MRN: '2804015'
[15:57:27] ℹ️  Final extracted Sex: 'MALE'
[15:57:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[15:57:27] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:57:27] ✅ Patient data extraction completed successfully
[15:57:27] ✅    ✅ Patient data extracted successfully
[15:57:27] 📊 Patient Response
     └─ patientFName: Jonathan
     └─ patientLName: Sterns
     └─ dob: 11/03/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2804015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 274 Slocum Road Dogwood Apt 412 The Cottages of Dartmouth Village
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:57:27] ✅    ✅ Patient identified: Jonathan Sterns
[15:57:27] ✅    ✅ Patient name validation passed
[15:57:27] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:27] [DOC: 9221876] ℹ️  DOB normalized: 11/03/1957
[15:57:27] [DOC: 9221876] ℹ️  Episode startOfCare normalized: 02/28/2025
[15:57:27] [DOC: 9221876] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:57:27] [DOC: 9221876] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:57:27] [DOC: 9221876] ✅ Patient date processing completed successfully
[15:57:27] ✅    ✅ Date processing completed
[15:57:27] 📊 Processed Patient Data
     └─ patientFName: Jonathan
     └─ patientLName: Sterns
     └─ dob: 11/03/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2804015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 274 Slocum Road Dogwood Apt 412 The Cottages of Dartmouth Village
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025'}]
[15:57:27] 🔄 
🔄 Step 4: Extracting order data...
[15:57:30] ℹ️  Order extraction - MRN: ''
[15:57:30] ℹ️  Order extraction - Sex: 'MALE'
[15:57:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[15:57:30] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:57:30] ✅ Order data extraction completed successfully
[15:57:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:30] ℹ️  Using MRN from patient data: '2804015'
[15:57:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[15:57:30] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[15:57:30] ✅ Patient name cross-validation successful
[15:57:30] ✅    ✅ Data merged successfully
[15:57:31] ✅    ✅ Order data extracted and validated
[15:57:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:31] [DOC: 9221876] ✅ Patient found in local cache: Jonathan Sterns, ID: 3091bab5-713d-40c1-a4a4-e374fcc1ce53
[15:57:31] ✅    ✅ Existing patient found with ID: 3091bab5-713d-40c1-a4a4-e374fcc1ce53
[15:57:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:57:31] [DOC: 9221876] ℹ️  Pushing order via API for patient ID: 3091bab5-713d-40c1-a4a4-e374fcc1ce53
[15:57:32] [DOC: 9221876] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:57:32] ❌    ❌ Failed to push order
[15:57:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:57:32] [DOC: 9221876] ℹ️  Calculated age: 67 from DOB: 11/03/1957
[15:57:32] [DOC: 9221876] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[15:57:32] [DOC: 9221876] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[15:57:32] [DOC: 9221876] ℹ️  Diagnosis codes being written:
[15:57:32] [DOC: 9221876] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:57:32] [DOC: 9221876] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:57:32] [DOC: 9221876] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:57:32] [DOC: 9221876] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:57:32] [DOC: 9221876] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:57:32] [DOC: 9221876] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:57:32] [DOC: 9221876] ✅ Patient data written to CSV: Jonathan Sterns | Sex: MALE | Age: 67 | Service: Skilled Nursing, Physical Therapy, Speech Therapy | Payer: Tufts Health Plan Medicare Preferred | MRN: 2804015
[15:57:32] ✅    ✅ Document 9221876 processed and saved successfully
[15:57:32] 🔄 
🔄 Step 8: Saving API details...
[15:57:32] [DOC: 9221876] ℹ️  API push details saved for document 9221876
[15:57:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221873                         ║
================================================================================
[15:57:32] ℹ️  Agency: Dartmouth HH
[15:57:32] ℹ️  Date: 04/04/2025
[15:57:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:57:36] [DOC: 9221873] ✅ Text extracted using pdfplumber (22810 chars)
[15:57:36] ✅    ✅ Text extracted using pdfplumber (22798 chars)
[15:57:36] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:39] ℹ️  AI extracted raw sex value: 'F'
[15:57:39] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:57:39] ℹ️  AI extracted payer source: ''
[15:57:39] ℹ️  AI extracted diagnoses:
[15:57:39] ℹ️    - Diagnosis 1: 'S82.832D'
[15:57:39] ℹ️    - Diagnosis 2: 'G89.29'
[15:57:39] ℹ️    - Diagnosis 3: 'M25.562'
[15:57:39] ℹ️    - Diagnosis 4: 'G47.00'
[15:57:39] ℹ️    - Diagnosis 5: 'I12.9'
[15:57:39] ℹ️    - Diagnosis 6: 'N18.31'
[15:57:39] ℹ️  Final extracted MRN: '227027'
[15:57:39] ℹ️  Final extracted Sex: 'FEMALE'
[15:57:39] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:57:39] ℹ️  Final extracted Payer Source: ''
[15:57:39] ✅ Patient data extraction completed successfully
[15:57:39] ✅    ✅ Patient data extracted successfully
[15:57:39] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Wester
     └─ dob: 09/10/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'S82.832D', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.31'}]
[15:57:39] ✅    ✅ Patient identified: Carol Wester
[15:57:39] ✅    ✅ Patient name validation passed
[15:57:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:39] [DOC: 9221873] ℹ️  DOB normalized: 09/10/1954
[15:57:39] [DOC: 9221873] ℹ️  Episode startOfCare normalized: 03/24/2025
[15:57:39] [DOC: 9221873] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[15:57:39] [DOC: 9221873] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[15:57:39] [DOC: 9221873] ✅ Patient date processing completed successfully
[15:57:39] ✅    ✅ Date processing completed
[15:57:39] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Wester
     └─ dob: 09/10/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'S82.832D', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.31'}]
[15:57:39] 🔄 
🔄 Step 4: Extracting order data...
[15:57:41] ℹ️  Order extraction - MRN: '6176015'
[15:57:41] ℹ️  Order extraction - Sex: 'FEMALE'
[15:57:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:57:41] ℹ️  Order extraction - Payer Source: ''
[15:57:41] ✅ Order data extraction completed successfully
[15:57:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:41] ℹ️  Using longer MRN from order data: '6176015' over '227027'
[15:57:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:57:41] ✅ Patient name cross-validation successful
[15:57:41] ✅    ✅ Data merged successfully
[15:57:42] ✅    ✅ Order data extracted and validated
[15:57:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:42] [DOC: 9221873] ✅ Patient found in local cache: Carol Wester, ID: b763e805-3270-49ff-8d1f-3bc7befacc58
[15:57:42] ✅    ✅ Existing patient found with ID: b763e805-3270-49ff-8d1f-3bc7befacc58
[15:57:42] 🔄 
🔄 Step 6: Pushing order to API...
[15:57:42] [DOC: 9221873] ℹ️  Pushing order via API for patient ID: b763e805-3270-49ff-8d1f-3bc7befacc58
[15:57:43] [DOC: 9221873] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:57:43] ❌    ❌ Failed to push order
[15:57:43] 🔄 
🔄 Step 7: Writing to CSV...
[15:57:43] [DOC: 9221873] ℹ️  Calculated age: 70 from DOB: 09/10/1954
[15:57:43] [DOC: 9221873] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[15:57:43] [DOC: 9221873] ℹ️  Payer Source extracted: ''
[15:57:43] [DOC: 9221873] ℹ️  Diagnosis codes being written:
[15:57:43] [DOC: 9221873] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.832D'
[15:57:43] [DOC: 9221873] ℹ️    - Latest_Episode_Seconddiagnosis: 'G89.29'
[15:57:43] [DOC: 9221873] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[15:57:43] [DOC: 9221873] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G47.00'
[15:57:43] [DOC: 9221873] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[15:57:43] [DOC: 9221873] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.31'
[15:57:43] [DOC: 9221873] ✅ Patient data written to CSV: Carol Wester | Sex: FEMALE | Age: 70 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 6176015
[15:57:43] ✅    ✅ Document 9221873 processed and saved successfully
[15:57:43] 🔄 
🔄 Step 8: Saving API details...
[15:57:43] [DOC: 9221873] ℹ️  API push details saved for document 9221873
[15:57:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221867                         ║
================================================================================
[15:57:43] ℹ️  Agency: Dartmouth HH
[15:57:43] ℹ️  Date: 04/04/2025
[15:57:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:57:46] [DOC: 9221867] ✅ Text extracted using pdfplumber (5892 chars)
[15:57:46] ✅    ✅ Text extracted using pdfplumber (5892 chars)
[15:57:46] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:49] ℹ️  AI extracted raw sex value: 'M'
[15:57:49] ℹ️  AI extracted service line: 'PT, RN, LPN'
[15:57:49] ℹ️  AI extracted payer source: 'Medicare'
[15:57:49] ℹ️  AI extracted diagnoses:
[15:57:49] ℹ️    - Diagnosis 1: ''
[15:57:49] ℹ️    - Diagnosis 2: ''
[15:57:49] ℹ️    - Diagnosis 3: ''
[15:57:49] ℹ️    - Diagnosis 4: ''
[15:57:49] ℹ️    - Diagnosis 5: ''
[15:57:49] ℹ️    - Diagnosis 6: ''
[15:57:49] ℹ️  Final extracted MRN: '5671015'
[15:57:49] ℹ️  Final extracted Sex: 'MALE'
[15:57:49] ℹ️  Final extracted Service Line: 'PT, RN, LPN'
[15:57:49] ℹ️  Final extracted Payer Source: 'Medicare'
[15:57:49] ✅ Patient data extraction completed successfully
[15:57:49] ✅    ✅ Patient data extracted successfully
[15:57:49] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:49] ✅    ✅ Patient identified: James Osborne
[15:57:49] ✅    ✅ Patient name validation passed
[15:57:49] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:49] [DOC: 9221867] ℹ️  DOB normalized: 10/21/1940
[15:57:49] [DOC: 9221867] ℹ️  Episode startOfCare normalized: 03/27/2025
[15:57:49] [DOC: 9221867] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[15:57:49] [DOC: 9221867] ℹ️  Episode endOfEpisode normalized: 03/08/2025
[15:57:49] [DOC: 9221867] ✅ Patient date processing completed successfully
[15:57:49] ✅    ✅ Date processing completed
[15:57:49] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:49] 🔄 
🔄 Step 4: Extracting order data...
[15:57:51] ℹ️  Order extraction - MRN: ''
[15:57:51] ℹ️  Order extraction - Sex: 'MALE'
[15:57:51] ℹ️  Order extraction - Service Line: 'PT'
[15:57:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:57:51] ✅ Order data extraction completed successfully
[15:57:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:51] ℹ️  Using MRN from patient data: '5671015'
[15:57:51] ℹ️  Combined service lines: Patient='PT, RN, LPN' + Order='PT' = 'LPN, PT, RN'
[15:57:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:57:51] ✅ Patient name cross-validation successful
[15:57:51] ✅    ✅ Data merged successfully
[15:57:53] ✅    ✅ Order data extracted and validated
[15:57:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:53] [DOC: 9221867] ✅ Patient found in local cache: James Osborne, ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[15:57:53] ✅    ✅ Existing patient found with ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[15:57:53] 🔄 
🔄 Step 6: Pushing order to API...
[15:57:53] [DOC: 9221867] ℹ️  Pushing order via API for patient ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[15:57:54] [DOC: 9221867] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:57:54] ❌    ❌ Failed to push order
[15:57:54] 🔄 
🔄 Step 7: Writing to CSV...
[15:57:54] [DOC: 9221867] ℹ️  Calculated age: 84 from DOB: 10/21/1940
[15:57:54] [DOC: 9221867] ℹ️  Service Line extracted: 'LPN, PT, RN'
[15:57:54] [DOC: 9221867] ℹ️  Payer Source extracted: 'Medicare'
[15:57:54] [DOC: 9221867] ℹ️  Diagnosis codes being written:
[15:57:54] [DOC: 9221867] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:57:54] [DOC: 9221867] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:57:54] [DOC: 9221867] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:57:54] [DOC: 9221867] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:57:54] [DOC: 9221867] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:57:54] [DOC: 9221867] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:57:54] [DOC: 9221867] ✅ Patient data written to CSV: James Osborne | Sex: MALE | Age: 84 | Service: LPN, PT, RN | Payer: Medicare | MRN: 5671015
[15:57:54] ✅    ✅ Document 9221867 processed and saved successfully
[15:57:54] 🔄 
🔄 Step 8: Saving API details...
[15:57:54] [DOC: 9221867] ℹ️  API push details saved for document 9221867
[15:57:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221863                         ║
================================================================================
[15:57:54] ℹ️  Agency: Dartmouth HH
[15:57:54] ℹ️  Date: 04/04/2025
[15:57:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:58:03] [DOC: 9221863] ✅ Text extracted using pdfplumber (1278 chars)
[15:58:03] ✅    ✅ Text extracted using pdfplumber (1278 chars)
[15:58:03] 🔄 
🔄 Step 2: Extracting patient data...
[15:58:06] ℹ️  AI extracted raw sex value: 'M'
[15:58:06] ℹ️  AI extracted service line: 'RN'
[15:58:06] ℹ️  AI extracted payer source: 'Harvard Pilgrim Health Care'
[15:58:06] ℹ️  AI extracted diagnoses:
[15:58:06] ℹ️    - Diagnosis 1: ''
[15:58:06] ℹ️    - Diagnosis 2: ''
[15:58:06] ℹ️    - Diagnosis 3: ''
[15:58:06] ℹ️    - Diagnosis 4: ''
[15:58:06] ℹ️    - Diagnosis 5: ''
[15:58:06] ℹ️    - Diagnosis 6: ''
[15:58:06] ℹ️  Final extracted MRN: '4146009'
[15:58:06] ℹ️  Final extracted Sex: 'MALE'
[15:58:06] ℹ️  Final extracted Service Line: 'RN'
[15:58:06] ℹ️  Final extracted Payer Source: 'Harvard Pilgrim Health Care'
[15:58:06] ✅ Patient data extraction completed successfully
[15:58:06] ✅    ✅ Patient data extracted successfully
[15:58:06] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Johnson
     └─ dob: 05/19/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 4146009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Harvard Pilgrim Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/06/2025', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:58:06] ✅    ✅ Patient identified: William Johnson
[15:58:06] ✅    ✅ Patient name validation passed
[15:58:06] 🔄 
🔄 Step 3: Processing patient dates...
[15:58:06] [DOC: 9221863] ℹ️  DOB normalized: 05/19/1962
[15:58:06] [DOC: 9221863] ℹ️  Episode startOfCare normalized: 02/06/2025
[15:58:06] [DOC: 9221863] ℹ️  Episode startOfEpisode normalized: 02/06/2025
[15:58:06] [DOC: 9221863] ℹ️  Episode endOfEpisode normalized: 04/06/2025
[15:58:06] [DOC: 9221863] ✅ Patient date processing completed successfully
[15:58:06] ✅    ✅ Date processing completed
[15:58:06] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Johnson
     └─ dob: 05/19/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 4146009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Harvard Pilgrim Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/06/2025', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:58:06] 🔄 
🔄 Step 4: Extracting order data...
[15:58:08] ℹ️  Order extraction - MRN: '4146009'
[15:58:08] ℹ️  Order extraction - Sex: 'MALE'
[15:58:08] ℹ️  Order extraction - Service Line: ''
[15:58:08] ℹ️  Order extraction - Payer Source: 'Harvard Pilgrim Health Care'
[15:58:08] ✅ Order data extraction completed successfully
[15:58:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:58:08] ℹ️  Using MRN from patient data: '4146009' over '4146009'
[15:58:08] ℹ️  Using service line from patient data: 'RN'
[15:58:08] ℹ️  Payer source consistent in both sources: 'Harvard Pilgrim Health Care'
[15:58:08] ✅ Patient name cross-validation successful
[15:58:08] ✅    ✅ Data merged successfully
[15:58:10] ✅    ✅ Order data extracted and validated
[15:58:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:58:58] [DOC: 9221863] ✅ Patient exists in API: William Johnson, ID: f964ca3a-4577-4408-bdeb-1570288325dd
[15:58:58] ✅    ✅ Existing patient found with ID: f964ca3a-4577-4408-bdeb-1570288325dd
[15:58:58] 🔄 
🔄 Step 6: Pushing order to API...
[15:58:58] [DOC: 9221863] ℹ️  Pushing order via API for patient ID: f964ca3a-4577-4408-bdeb-1570288325dd
[15:58:59] [DOC: 9221863] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:58:59] ❌    ❌ Failed to push order
[15:58:59] 🔄 
🔄 Step 7: Writing to CSV...
[15:58:59] [DOC: 9221863] ℹ️  Calculated age: 63 from DOB: 05/19/1962
[15:58:59] [DOC: 9221863] ℹ️  Service Line extracted: 'RN'
[15:58:59] [DOC: 9221863] ℹ️  Payer Source extracted: 'Harvard Pilgrim Health Care'
[15:58:59] [DOC: 9221863] ℹ️  Diagnosis codes being written:
[15:58:59] [DOC: 9221863] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:58:59] [DOC: 9221863] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:58:59] [DOC: 9221863] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:58:59] [DOC: 9221863] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:58:59] [DOC: 9221863] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:58:59] [DOC: 9221863] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:58:59] [DOC: 9221863] ✅ Patient data written to CSV: William Johnson | Sex: MALE | Age: 63 | Service: RN | Payer: Harvard Pilgrim Health Care | MRN: 4146009
[15:58:59] ✅    ✅ Document 9221863 processed and saved successfully
[15:58:59] 🔄 
🔄 Step 8: Saving API details...
[15:58:59] [DOC: 9221863] ℹ️  API push details saved for document 9221863
[15:58:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221860                         ║
================================================================================
[15:58:59] ℹ️  Agency: Dartmouth HH
[15:58:59] ℹ️  Date: 04/04/2025
[15:58:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:59:02] [DOC: 9221860] ✅ Text extracted using pdfplumber (4591 chars)
[15:59:02] ✅    ✅ Text extracted using pdfplumber (4591 chars)
[15:59:02] 🔄 
🔄 Step 2: Extracting patient data...
[15:59:05] ℹ️  AI extracted raw sex value: 'F'
[15:59:05] ℹ️  AI extracted service line: 'PT'
[15:59:05] ℹ️  AI extracted payer source: 'Medicare'
[15:59:05] ℹ️  AI extracted diagnoses:
[15:59:05] ℹ️    - Diagnosis 1: ''
[15:59:05] ℹ️    - Diagnosis 2: ''
[15:59:05] ℹ️    - Diagnosis 3: ''
[15:59:05] ℹ️    - Diagnosis 4: ''
[15:59:05] ℹ️    - Diagnosis 5: ''
[15:59:05] ℹ️    - Diagnosis 6: ''
[15:59:05] ℹ️  Final extracted MRN: '804015'
[15:59:05] ℹ️  Final extracted Sex: 'FEMALE'
[15:59:05] ℹ️  Final extracted Service Line: 'PT'
[15:59:05] ℹ️  Final extracted Payer Source: 'Medicare'
[15:59:05] ✅ Patient data extraction completed successfully
[15:59:05] ✅    ✅ Patient data extracted successfully
[15:59:05] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 804015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:59:05] ✅    ✅ Patient identified: Joan Harb
[15:59:05] ✅    ✅ Patient name validation passed
[15:59:05] 🔄 
🔄 Step 3: Processing patient dates...
[15:59:05] [DOC: 9221860] ℹ️  DOB normalized: 12/27/1945
[15:59:05] [DOC: 9221860] ℹ️  Episode startOfCare normalized: 01/15/2025
[15:59:05] [DOC: 9221860] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[15:59:05] [DOC: 9221860] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[15:59:05] [DOC: 9221860] ✅ Patient date processing completed successfully
[15:59:05] ✅    ✅ Date processing completed
[15:59:05] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 804015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:59:05] 🔄 
🔄 Step 4: Extracting order data...
[15:59:07] ℹ️  Order extraction - MRN: ''
[15:59:07] ℹ️  Order extraction - Sex: 'FEMALE'
[15:59:07] ℹ️  Order extraction - Service Line: 'PT'
[15:59:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:59:07] ✅ Order data extraction completed successfully
[15:59:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:59:07] ℹ️  Using MRN from patient data: '804015'
[15:59:07] ℹ️  Service line consistent in both sources: 'PT'
[15:59:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:59:07] ✅ Patient name cross-validation successful
[15:59:07] ✅    ✅ Data merged successfully
[15:59:08] ✅    ✅ Order data extracted and validated
[15:59:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:59:08] [DOC: 9221860] ✅ Patient found in local cache: Joan Harb, ID: e6448657-0278-414c-9f62-37332e5b561b
[15:59:08] ✅    ✅ Existing patient found with ID: e6448657-0278-414c-9f62-37332e5b561b
[15:59:08] 🔄 
🔄 Step 6: Pushing order to API...
[15:59:08] [DOC: 9221860] ℹ️  Pushing order via API for patient ID: e6448657-0278-414c-9f62-37332e5b561b
[15:59:10] [DOC: 9221860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:59:10] ❌    ❌ Failed to push order
[15:59:10] 🔄 
🔄 Step 7: Writing to CSV...
[15:59:10] [DOC: 9221860] ℹ️  Calculated age: 79 from DOB: 12/27/1945
[15:59:10] [DOC: 9221860] ℹ️  Service Line extracted: 'PT'
[15:59:10] [DOC: 9221860] ℹ️  Payer Source extracted: 'Medicare'
[15:59:10] [DOC: 9221860] ℹ️  Diagnosis codes being written:
[15:59:10] [DOC: 9221860] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:59:10] [DOC: 9221860] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:59:10] [DOC: 9221860] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:59:10] [DOC: 9221860] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:59:10] [DOC: 9221860] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:59:10] [DOC: 9221860] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:59:10] [DOC: 9221860] ✅ Patient data written to CSV: Joan Harb | Sex: FEMALE | Age: 79 | Service: PT | Payer: Medicare | MRN: 804015
[15:59:10] ✅    ✅ Document 9221860 processed and saved successfully
[15:59:10] 🔄 
🔄 Step 8: Saving API details...
[15:59:10] [DOC: 9221860] ℹ️  API push details saved for document 9221860
[15:59:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221859                         ║
================================================================================
[15:59:10] ℹ️  Agency: Dartmouth HH
[15:59:10] ℹ️  Date: 04/04/2025
[15:59:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:59:16] [DOC: 9221859] ✅ Text extracted using pdfplumber (12241 chars)
[15:59:16] ✅    ✅ Text extracted using pdfplumber (12229 chars)
[15:59:16] 🔄 
🔄 Step 2: Extracting patient data...
[15:59:19] ℹ️  AI extracted raw sex value: 'F'
[15:59:19] ℹ️  AI extracted service line: 'PT, RN'
[15:59:19] ℹ️  AI extracted payer source: 'None'
[15:59:19] ℹ️  AI extracted diagnoses:
[15:59:19] ℹ️    - Diagnosis 1: 'Z47.1'
[15:59:19] ℹ️    - Diagnosis 2: 'D62'
[15:59:19] ℹ️    - Diagnosis 3: 'M19.90'
[15:59:19] ℹ️    - Diagnosis 4: 'G56.01'
[15:59:19] ℹ️    - Diagnosis 5: 'M77.10'
[15:59:19] ℹ️    - Diagnosis 6: 'Z79.82'
[15:59:19] ℹ️  Final extracted MRN: '5681015'
[15:59:19] ℹ️  Final extracted Sex: 'FEMALE'
[15:59:19] ℹ️  Final extracted Service Line: 'PT, RN'
[15:59:19] ℹ️  Final extracted Payer Source: ''
[15:59:19] ✅ Patient data extraction completed successfully
[15:59:19] ✅    ✅ Patient data extracted successfully
[15:59:19] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Almeida
     └─ dob: 11/01/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5681015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'G56.01', 'fifthDiagnosis': 'M77.10', 'sixthDiagnosis': 'Z79.82'}]
[15:59:19] ✅    ✅ Patient identified: Janice Almeida
[15:59:19] ✅    ✅ Patient name validation passed
[15:59:19] 🔄 
🔄 Step 3: Processing patient dates...
[15:59:19] [DOC: 9221859] ℹ️  DOB normalized: 11/01/1950
[15:59:19] [DOC: 9221859] ℹ️  Episode startOfCare normalized: 03/29/2025
[15:59:19] [DOC: 9221859] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[15:59:19] [DOC: 9221859] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[15:59:19] [DOC: 9221859] ✅ Patient date processing completed successfully
[15:59:19] ✅    ✅ Date processing completed
[15:59:19] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Almeida
     └─ dob: 11/01/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5681015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'G56.01', 'fifthDiagnosis': 'M77.10', 'sixthDiagnosis': 'Z79.82'}]
[15:59:19] 🔄 
🔄 Step 4: Extracting order data...
[15:59:21] ℹ️  Order extraction - MRN: '5681015'
[15:59:21] ℹ️  Order extraction - Sex: 'FEMALE'
[15:59:21] ℹ️  Order extraction - Service Line: 'PT, RN'
[15:59:21] ℹ️  Order extraction - Payer Source: ''
[15:59:21] ✅ Order data extraction completed successfully
[15:59:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:59:21] ℹ️  Using MRN from patient data: '5681015' over '5681015'
[15:59:21] ℹ️  Service line consistent in both sources: 'PT, RN'
[15:59:21] ✅ Patient name cross-validation successful
[15:59:21] ✅    ✅ Data merged successfully
[15:59:22] ✅    ✅ Order data extracted and validated
[15:59:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:59:59] [DOC: 9221859] ℹ️  Patient not found in cache or API: Janice Almeida
[15:59:59] [DOC: 9221859] ℹ️  Patient not found, creating new patient via API...
[15:59:59] [DOC: 9221859] ℹ️  Creating patient via API: Janice Almeida
[16:00:00] [DOC: 9221859] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:00:00] ❌    ❌ Failed to create patient
[16:00:00] [DOC: 9221859] ℹ️  API push details saved for document 9221859
================================================================================
║                        Processing Document ID: 9221853                         ║
================================================================================
[16:00:00] ℹ️  Agency: Dartmouth HH
[16:00:00] ℹ️  Date: 04/04/2025
[16:00:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:00:04] [DOC: 9221853] ✅ Text extracted using pdfplumber (11237 chars)
[16:00:04] ✅    ✅ Text extracted using pdfplumber (11237 chars)
[16:00:04] 🔄 
🔄 Step 2: Extracting patient data...
[16:00:07] ℹ️  AI extracted raw sex value: 'M'
[16:00:07] ℹ️  AI extracted service line: 'PT, OT'
[16:00:07] ℹ️  AI extracted payer source: 'Medicare'
[16:00:07] ℹ️  AI extracted diagnoses:
[16:00:07] ℹ️    - Diagnosis 1: 'CAD'
[16:00:07] ℹ️    - Diagnosis 2: 'DM'
[16:00:07] ℹ️    - Diagnosis 3: 'TIA'
[16:00:07] ℹ️    - Diagnosis 4: 'None'
[16:00:07] ℹ️    - Diagnosis 5: 'None'
[16:00:07] ℹ️    - Diagnosis 6: 'None'
[16:00:07] ℹ️  Final extracted MRN: '6129015'
[16:00:07] ℹ️  Final extracted Sex: 'MALE'
[16:00:07] ℹ️  Final extracted Service Line: 'PT, OT'
[16:00:07] ℹ️  Final extracted Payer Source: 'Medicare'
[16:00:07] ✅ Patient data extraction completed successfully
[16:00:07] ✅    ✅ Patient data extracted successfully
[16:00:07] 📊 Patient Response
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'CAD', 'secondDiagnosis': 'DM', 'thirdDiagnosis': 'TIA', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:00:07] ✅    ✅ Patient identified: Theodore Small
[16:00:07] ✅    ✅ Patient name validation passed
[16:00:07] 🔄 
🔄 Step 3: Processing patient dates...
[16:00:07] [DOC: 9221853] ℹ️  DOB normalized: 09/25/1931
[16:00:07] [DOC: 9221853] ℹ️  Episode startOfCare normalized: 02/28/2025
[16:00:07] [DOC: 9221853] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[16:00:07] [DOC: 9221853] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[16:00:07] [DOC: 9221853] ✅ Patient date processing completed successfully
[16:00:07] ✅    ✅ Date processing completed
[16:00:07] 📊 Processed Patient Data
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'CAD', 'secondDiagnosis': 'DM', 'thirdDiagnosis': 'TIA'}]
[16:00:07] 🔄 
🔄 Step 4: Extracting order data...
[16:00:10] ℹ️  Order extraction - MRN: ''
[16:00:10] ℹ️  Order extraction - Sex: 'MALE'
[16:00:10] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:00:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:00:10] ✅ Order data extraction completed successfully
[16:00:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:00:10] ℹ️  Using MRN from patient data: '6129015'
[16:00:10] ℹ️  Service line consistent in both sources: 'PT, OT'
[16:00:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:00:10] ✅ Patient name cross-validation successful
[16:00:10] ✅    ✅ Data merged successfully
[16:00:11] ✅    ✅ Order data extracted and validated
[16:00:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:00:11] [DOC: 9221853] ✅ Patient found in local cache: Theodore Small, ID: 8c849805-1775-4653-aa7c-ce211697fc95
[16:00:11] ✅    ✅ Existing patient found with ID: 8c849805-1775-4653-aa7c-ce211697fc95
[16:00:11] 🔄 
🔄 Step 6: Pushing order to API...
[16:00:11] [DOC: 9221853] ℹ️  Pushing order via API for patient ID: 8c849805-1775-4653-aa7c-ce211697fc95
[16:00:12] [DOC: 9221853] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:00:12] ❌    ❌ Failed to push order
[16:00:12] 🔄 
🔄 Step 7: Writing to CSV...
[16:00:12] [DOC: 9221853] ℹ️  Calculated age: 93 from DOB: 09/25/1931
[16:00:12] [DOC: 9221853] ℹ️  Service Line extracted: 'PT, OT'
[16:00:12] [DOC: 9221853] ℹ️  Payer Source extracted: 'Medicare'
[16:00:12] [DOC: 9221853] ℹ️  Diagnosis codes being written:
[16:00:12] [DOC: 9221853] ℹ️    - Latest_Episode_Firstdiagnosis: 'CAD'
[16:00:12] [DOC: 9221853] ℹ️    - Latest_Episode_Seconddiagnosis: 'DM'
[16:00:12] [DOC: 9221853] ℹ️    - Latest_Episode_Thirddiagnosis: 'TIA'
[16:00:12] [DOC: 9221853] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:00:12] [DOC: 9221853] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:00:12] [DOC: 9221853] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:00:12] [DOC: 9221853] ✅ Patient data written to CSV: Theodore Small | Sex: MALE | Age: 93 | Service: PT, OT | Payer: Medicare | MRN: 6129015
[16:00:12] ✅    ✅ Document 9221853 processed and saved successfully
[16:00:12] 🔄 
🔄 Step 8: Saving API details...
[16:00:12] [DOC: 9221853] ℹ️  API push details saved for document 9221853
[16:00:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221852                         ║
================================================================================
[16:00:12] ℹ️  Agency: Dartmouth HH
[16:00:12] ℹ️  Date: 04/04/2025
[16:00:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:00:14] [DOC: 9221852] ✅ Text extracted using pdfplumber (1065 chars)
[16:00:14] ✅    ✅ Text extracted using pdfplumber (1065 chars)
[16:00:14] 🔄 
🔄 Step 2: Extracting patient data...
[16:00:17] ℹ️  AI extracted raw sex value: 'F'
[16:00:17] ℹ️  AI extracted service line: 'RN'
[16:00:17] ℹ️  AI extracted payer source: 'Medicare'
[16:00:17] ℹ️  AI extracted diagnoses:
[16:00:17] ℹ️    - Diagnosis 1: ''
[16:00:17] ℹ️    - Diagnosis 2: ''
[16:00:17] ℹ️    - Diagnosis 3: ''
[16:00:17] ℹ️    - Diagnosis 4: ''
[16:00:17] ℹ️    - Diagnosis 5: ''
[16:00:17] ℹ️    - Diagnosis 6: ''
[16:00:17] ℹ️  Final extracted MRN: '5662015'
[16:00:17] ℹ️  Final extracted Sex: 'FEMALE'
[16:00:17] ℹ️  Final extracted Service Line: 'RN'
[16:00:17] ℹ️  Final extracted Payer Source: 'Medicare'
[16:00:17] ✅ Patient data extraction completed successfully
[16:00:17] ✅    ✅ Patient data extracted successfully
[16:00:17] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:00:17] ✅    ✅ Patient identified: Betty Mendonca
[16:00:17] ✅    ✅ Patient name validation passed
[16:00:17] 🔄 
🔄 Step 3: Processing patient dates...
[16:00:17] [DOC: 9221852] ℹ️  DOB normalized: 04/08/1948
[16:00:17] [DOC: 9221852] ℹ️  Episode startOfCare normalized: 12/08/2024
[16:00:17] [DOC: 9221852] ℹ️  Episode startOfEpisode normalized: 02/06/2025
[16:00:17] [DOC: 9221852] ℹ️  Episode endOfEpisode normalized: 04/06/2025
[16:00:17] [DOC: 9221852] ✅ Patient date processing completed successfully
[16:00:17] ✅    ✅ Date processing completed
[16:00:17] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '02/06/2025', 'endOfEpisode': '04/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:00:17] 🔄 
🔄 Step 4: Extracting order data...
[16:00:19] ℹ️  Order extraction - MRN: ''
[16:00:19] ℹ️  Order extraction - Sex: 'FEMALE'
[16:00:19] ℹ️  Order extraction - Service Line: 'RN'
[16:00:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:00:19] ✅ Order data extraction completed successfully
[16:00:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:00:19] ℹ️  Using MRN from patient data: '5662015'
[16:00:19] ℹ️  Service line consistent in both sources: 'RN'
[16:00:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:00:19] ✅ Patient name cross-validation successful
[16:00:19] ✅    ✅ Data merged successfully
[16:00:21] ✅    ✅ Order data extracted and validated
[16:00:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:00:21] [DOC: 9221852] ✅ Patient found in local cache: Betty Mendonca, ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[16:00:21] ✅    ✅ Existing patient found with ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[16:00:21] 🔄 
🔄 Step 6: Pushing order to API...
[16:00:21] [DOC: 9221852] ℹ️  Pushing order via API for patient ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[16:00:25] [DOC: 9221852] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14093"}
[16:00:25] ❌    ❌ Failed to push order
[16:00:25] 🔄 
🔄 Step 7: Writing to CSV...
[16:00:25] [DOC: 9221852] ℹ️  Calculated age: 77 from DOB: 04/08/1948
[16:00:25] [DOC: 9221852] ℹ️  Service Line extracted: 'RN'
[16:00:25] [DOC: 9221852] ℹ️  Payer Source extracted: 'Medicare'
[16:00:25] [DOC: 9221852] ℹ️  Diagnosis codes being written:
[16:00:25] [DOC: 9221852] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:00:25] [DOC: 9221852] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:00:25] [DOC: 9221852] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:00:25] [DOC: 9221852] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:00:25] [DOC: 9221852] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:00:25] [DOC: 9221852] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:00:25] [DOC: 9221852] ✅ Patient data written to CSV: Betty Mendonca | Sex: FEMALE | Age: 77 | Service: RN | Payer: Medicare | MRN: 5662015
[16:00:25] ✅    ✅ Document 9221852 processed and saved successfully
[16:00:25] 🔄 
🔄 Step 8: Saving API details...
[16:00:25] [DOC: 9221852] ℹ️  API push details saved for document 9221852
[16:00:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221848                         ║
================================================================================
[16:00:25] ℹ️  Agency: Dartmouth HH
[16:00:25] ℹ️  Date: 04/04/2025
[16:00:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:00:27] [DOC: 9221848] ✅ Text extracted using pdfplumber (5251 chars)
[16:00:27] ✅    ✅ Text extracted using pdfplumber (5251 chars)
[16:00:27] 🔄 
🔄 Step 2: Extracting patient data...
[16:00:30] ℹ️  AI extracted raw sex value: 'F'
[16:00:30] ℹ️  AI extracted service line: 'PT'
[16:00:30] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[16:00:30] ℹ️  AI extracted diagnoses:
[16:00:30] ℹ️    - Diagnosis 1: 'epigastric pain'
[16:00:30] ℹ️    - Diagnosis 2: 'elevated troponin'
[16:00:30] ℹ️    - Diagnosis 3: 'probably demand ischemia'
[16:00:30] ℹ️    - Diagnosis 4: 'DM with hyperglycemia'
[16:00:30] ℹ️    - Diagnosis 5: ''
[16:00:30] ℹ️    - Diagnosis 6: ''
[16:00:30] ℹ️  Final extracted MRN: '4929009'
[16:00:30] ℹ️  Final extracted Sex: 'FEMALE'
[16:00:30] ℹ️  Final extracted Service Line: 'PT'
[16:00:30] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[16:00:30] ✅ Patient data extraction completed successfully
[16:00:30] ✅    ✅ Patient data extracted successfully
[16:00:30] 📊 Patient Response
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': 'epigastric pain', 'secondDiagnosis': 'elevated troponin', 'thirdDiagnosis': 'probably demand ischemia', 'fourthDiagnosis': 'DM with hyperglycemia', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:00:30] ✅    ✅ Patient identified: Katherine Ferreira
[16:00:30] ✅    ✅ Patient name validation passed
[16:00:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:00:30] [DOC: 9221848] ℹ️  DOB normalized: 02/26/1929
[16:00:30] [DOC: 9221848] ℹ️  Episode startOfCare normalized: 03/10/2025
[16:00:30] [DOC: 9221848] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[16:00:30] [DOC: 9221848] ℹ️  Episode endOfEpisode normalized: 03/09/2025
[16:00:30] [DOC: 9221848] ✅ Patient date processing completed successfully
[16:00:30] ✅    ✅ Date processing completed
[16:00:30] 📊 Processed Patient Data
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/09/2025', 'firstDiagnosis': 'epigastric pain', 'secondDiagnosis': 'elevated troponin', 'thirdDiagnosis': 'probably demand ischemia', 'fourthDiagnosis': 'DM with hyperglycemia', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:00:30] 🔄 
🔄 Step 4: Extracting order data...
[16:00:33] ℹ️  Order extraction - MRN: '4929009'
[16:00:33] ℹ️  Order extraction - Sex: 'FEMALE'
[16:00:33] ℹ️  Order extraction - Service Line: 'PT'
[16:00:33] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[16:00:33] ✅ Order data extraction completed successfully
[16:00:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:00:33] ℹ️  Using MRN from patient data: '4929009' over '4929009'
[16:00:33] ℹ️  Service line consistent in both sources: 'PT'
[16:00:33] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[16:00:33] ✅ Patient name cross-validation successful
[16:00:33] ✅    ✅ Data merged successfully
[16:00:34] ✅    ✅ Order data extracted and validated
[16:00:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:00:53] [DOC: 9221848] ✅ Patient exists in API: Katherine Ferreira, ID: a91e06c9-4785-41d3-ae13-67be5545d837
[16:00:53] ✅    ✅ Existing patient found with ID: a91e06c9-4785-41d3-ae13-67be5545d837
[16:00:53] 🔄 
🔄 Step 6: Pushing order to API...
[16:00:53] [DOC: 9221848] ℹ️  Pushing order via API for patient ID: a91e06c9-4785-41d3-ae13-67be5545d837
[16:00:54] [DOC: 9221848] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:00:54] ❌    ❌ Failed to push order
[16:00:54] 🔄 
🔄 Step 7: Writing to CSV...
[16:00:54] [DOC: 9221848] ℹ️  Calculated age: 96 from DOB: 02/26/1929
[16:00:54] [DOC: 9221848] ℹ️  Service Line extracted: 'PT'
[16:00:54] [DOC: 9221848] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[16:00:54] [DOC: 9221848] ℹ️  Diagnosis codes being written:
[16:00:54] [DOC: 9221848] ℹ️    - Latest_Episode_Firstdiagnosis: 'epigastric pain'
[16:00:54] [DOC: 9221848] ℹ️    - Latest_Episode_Seconddiagnosis: 'elevated troponin'
[16:00:54] [DOC: 9221848] ℹ️    - Latest_Episode_Thirddiagnosis: 'probably demand ischemia'
[16:00:54] [DOC: 9221848] ℹ️    - Latest_Episode_Fourthdiagnosis: 'DM with hyperglycemia'
[16:00:54] [DOC: 9221848] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:00:54] [DOC: 9221848] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:00:54] [DOC: 9221848] ✅ Patient data written to CSV: Katherine Ferreira | Sex: FEMALE | Age: 96 | Service: PT | Payer: Tufts Health Plan Senior Care Options | MRN: 4929009
[16:00:54] ✅    ✅ Document 9221848 processed and saved successfully
[16:00:54] 🔄 
🔄 Step 8: Saving API details...
[16:00:54] [DOC: 9221848] ℹ️  API push details saved for document 9221848
[16:00:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221846                         ║
================================================================================
[16:00:54] ℹ️  Agency: Dartmouth HH
[16:00:54] ℹ️  Date: 04/04/2025
[16:00:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:00:56] [DOC: 9221846] ✅ Text extracted using pdfplumber (3576 chars)
[16:00:56] ✅    ✅ Text extracted using pdfplumber (3576 chars)
[16:00:56] 🔄 
🔄 Step 2: Extracting patient data...
[16:00:59] ℹ️  AI extracted raw sex value: 'M'
[16:00:59] ℹ️  AI extracted service line: 'OT, RN'
[16:00:59] ℹ️  AI extracted payer source: 'Fallon Health'
[16:00:59] ℹ️  AI extracted diagnoses:
[16:00:59] ℹ️    - Diagnosis 1: ''
[16:00:59] ℹ️    - Diagnosis 2: ''
[16:00:59] ℹ️    - Diagnosis 3: ''
[16:00:59] ℹ️    - Diagnosis 4: ''
[16:00:59] ℹ️    - Diagnosis 5: ''
[16:00:59] ℹ️    - Diagnosis 6: ''
[16:00:59] ℹ️  Final extracted MRN: '6057015'
[16:00:59] ℹ️  Final extracted Sex: 'MALE'
[16:00:59] ℹ️  Final extracted Service Line: 'OT, RN'
[16:00:59] ℹ️  Final extracted Payer Source: 'Fallon Health'
[16:00:59] ✅ Patient data extraction completed successfully
[16:00:59] ✅    ✅ Patient data extracted successfully
[16:00:59] 📊 Patient Response
     └─ patientFName: Edgar
     └─ patientLName: Fonseca
     └─ dob: 02/02/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6057015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:00:59] ✅    ✅ Patient identified: Edgar Fonseca
[16:00:59] ✅    ✅ Patient name validation passed
[16:00:59] 🔄 
🔄 Step 3: Processing patient dates...
[16:00:59] [DOC: 9221846] ℹ️  DOB normalized: 02/02/1952
[16:00:59] [DOC: 9221846] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:00:59] [DOC: 9221846] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:00:59] [DOC: 9221846] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:00:59] [DOC: 9221846] ✅ Patient date processing completed successfully
[16:00:59] ✅    ✅ Date processing completed
[16:00:59] 📊 Processed Patient Data
     └─ patientFName: Edgar
     └─ patientLName: Fonseca
     └─ dob: 02/02/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6057015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:00:59] 🔄 
🔄 Step 4: Extracting order data...
[16:01:02] ℹ️  Order extraction - MRN: '6057015'
[16:01:02] ℹ️  Order extraction - Sex: 'MALE'
[16:01:02] ℹ️  Order extraction - Service Line: 'OT, RN'
[16:01:02] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[16:01:02] ✅ Order data extraction completed successfully
[16:01:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:01:02] ℹ️  Using MRN from patient data: '6057015' over '6057015'
[16:01:02] ℹ️  Service line consistent in both sources: 'OT, RN'
[16:01:02] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[16:01:02] ✅ Patient name cross-validation successful
[16:01:02] ✅    ✅ Data merged successfully
[16:01:03] ✅    ✅ Order data extracted and validated
[16:01:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:01:03] [DOC: 9221846] ✅ Patient found in local cache: Edgar Fonseca, ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[16:01:03] ✅    ✅ Existing patient found with ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[16:01:03] 🔄 
🔄 Step 6: Pushing order to API...
[16:01:03] [DOC: 9221846] ℹ️  Pushing order via API for patient ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[16:01:04] [DOC: 9221846] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:01:04] ❌    ❌ Failed to push order
[16:01:04] 🔄 
🔄 Step 7: Writing to CSV...
[16:01:04] [DOC: 9221846] ℹ️  Calculated age: 73 from DOB: 02/02/1952
[16:01:04] [DOC: 9221846] ℹ️  Service Line extracted: 'OT, RN'
[16:01:04] [DOC: 9221846] ℹ️  Payer Source extracted: 'Fallon Health'
[16:01:04] [DOC: 9221846] ℹ️  Diagnosis codes being written:
[16:01:04] [DOC: 9221846] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:01:04] [DOC: 9221846] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:01:04] [DOC: 9221846] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:01:04] [DOC: 9221846] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:01:04] [DOC: 9221846] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:01:04] [DOC: 9221846] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:01:04] [DOC: 9221846] ✅ Patient data written to CSV: Edgar Fonseca | Sex: MALE | Age: 73 | Service: OT, RN | Payer: Fallon Health | MRN: 6057015
[16:01:04] ✅    ✅ Document 9221846 processed and saved successfully
[16:01:04] 🔄 
🔄 Step 8: Saving API details...
[16:01:04] [DOC: 9221846] ℹ️  API push details saved for document 9221846
[16:01:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221845                         ║
================================================================================
[16:01:04] ℹ️  Agency: Dartmouth HH
[16:01:04] ℹ️  Date: 04/04/2025
[16:01:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:01:11] [DOC: 9221845] ✅ Text extracted using pdfplumber (19456 chars)
[16:01:11] ✅    ✅ Text extracted using pdfplumber (19456 chars)
[16:01:11] 🔄 
🔄 Step 2: Extracting patient data...
[16:01:14] ℹ️  AI extracted raw sex value: 'M'
[16:01:14] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[16:01:14] ℹ️  AI extracted payer source: ''
[16:01:14] ℹ️  AI extracted diagnoses:
[16:01:14] ℹ️    - Diagnosis 1: 'Z47.1'
[16:01:14] ℹ️    - Diagnosis 2: 'Z96.611'
[16:01:14] ℹ️    - Diagnosis 3: 'I13.0'
[16:01:14] ℹ️    - Diagnosis 4: 'I50.9'
[16:01:14] ℹ️    - Diagnosis 5: 'E11.22'
[16:01:14] ℹ️    - Diagnosis 6: 'N18.31'
[16:01:14] ℹ️  Final extracted MRN: '6057015'
[16:01:14] ℹ️  Final extracted Sex: 'MALE'
[16:01:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[16:01:14] ℹ️  Final extracted Payer Source: ''
[16:01:14] ✅ Patient data extraction completed successfully
[16:01:14] ✅    ✅ Patient data extracted successfully
[16:01:14] 📊 Patient Response
     └─ patientFName: Edgar
     └─ patientLName: Fonseca
     └─ dob: 02/02/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6057015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.31'}]
[16:01:14] ✅    ✅ Patient identified: Edgar Fonseca
[16:01:14] ✅    ✅ Patient name validation passed
[16:01:14] 🔄 
🔄 Step 3: Processing patient dates...
[16:01:14] [DOC: 9221845] ℹ️  DOB normalized: 02/02/1952
[16:01:14] [DOC: 9221845] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:01:14] [DOC: 9221845] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:01:14] [DOC: 9221845] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:01:14] [DOC: 9221845] ✅ Patient date processing completed successfully
[16:01:14] ✅    ✅ Date processing completed
[16:01:14] 📊 Processed Patient Data
     └─ patientFName: Edgar
     └─ patientLName: Fonseca
     └─ dob: 02/02/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6057015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.31'}]
[16:01:14] 🔄 
🔄 Step 4: Extracting order data...
[16:01:16] ℹ️  Order extraction - MRN: '6057015'
[16:01:16] ℹ️  Order extraction - Sex: 'MALE'
[16:01:16] ℹ️  Order extraction - Service Line: 'RN, PT, OT'
[16:01:16] ℹ️  Order extraction - Payer Source: ''
[16:01:16] ✅ Order data extraction completed successfully
[16:01:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:01:16] ℹ️  Using MRN from patient data: '6057015' over '6057015'
[16:01:16] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='RN, PT, OT' = 'OT, PT, RN, Skilled Nursing'
[16:01:16] ✅ Patient name cross-validation successful
[16:01:16] ✅    ✅ Data merged successfully
[16:01:18] ✅    ✅ Order data extracted and validated
[16:01:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:01:18] [DOC: 9221845] ✅ Patient found in local cache: Edgar Fonseca, ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[16:01:18] ✅    ✅ Existing patient found with ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[16:01:18] 🔄 
🔄 Step 6: Pushing order to API...
[16:01:18] [DOC: 9221845] ℹ️  Pushing order via API for patient ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[16:01:19] [DOC: 9221845] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:01:19] ❌    ❌ Failed to push order
[16:01:19] 🔄 
🔄 Step 7: Writing to CSV...
[16:01:19] [DOC: 9221845] ℹ️  Calculated age: 73 from DOB: 02/02/1952
[16:01:19] [DOC: 9221845] ℹ️  Service Line extracted: 'OT, PT, RN, Skilled Nursing'
[16:01:19] [DOC: 9221845] ℹ️  Payer Source extracted: ''
[16:01:19] [DOC: 9221845] ℹ️  Diagnosis codes being written:
[16:01:19] [DOC: 9221845] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[16:01:19] [DOC: 9221845] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.611'
[16:01:19] [DOC: 9221845] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[16:01:19] [DOC: 9221845] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.9'
[16:01:19] [DOC: 9221845] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[16:01:19] [DOC: 9221845] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.31'
[16:01:19] [DOC: 9221845] ✅ Patient data written to CSV: Edgar Fonseca | Sex: MALE | Age: 73 | Service: OT, PT, RN, Skilled Nursing | Payer:  | MRN: 6057015
[16:01:19] ✅    ✅ Document 9221845 processed and saved successfully
[16:01:19] 🔄 
🔄 Step 8: Saving API details...
[16:01:19] [DOC: 9221845] ℹ️  API push details saved for document 9221845
[16:01:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221822                         ║
================================================================================
[16:01:19] ℹ️  Agency: Dartmouth HH
[16:01:19] ℹ️  Date: 04/04/2025
[16:01:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:01:23] [DOC: 9221822] ✅ Text extracted using pdfplumber (2617 chars)
[16:01:23] ✅    ✅ Text extracted using pdfplumber (2617 chars)
[16:01:23] 🔄 
🔄 Step 2: Extracting patient data...
[16:01:26] ℹ️  AI extracted raw sex value: 'F'
[16:01:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:01:26] ℹ️  AI extracted payer source: 'Medicare'
[16:01:26] ℹ️  AI extracted diagnoses:
[16:01:26] ℹ️    - Diagnosis 1: 'None'
[16:01:26] ℹ️    - Diagnosis 2: 'None'
[16:01:26] ℹ️    - Diagnosis 3: 'None'
[16:01:26] ℹ️    - Diagnosis 4: 'None'
[16:01:26] ℹ️    - Diagnosis 5: 'None'
[16:01:26] ℹ️    - Diagnosis 6: 'None'
[16:01:26] ℹ️  Final extracted MRN: '1033009'
[16:01:26] ℹ️  Final extracted Sex: 'FEMALE'
[16:01:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:01:26] ℹ️  Final extracted Payer Source: 'Medicare'
[16:01:26] ✅ Patient data extraction completed successfully
[16:01:26] ✅    ✅ Patient data extracted successfully
[16:01:26] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:01:26] ✅    ✅ Patient identified: Irene Gauthier
[16:01:26] ✅    ✅ Patient name validation passed
[16:01:26] 🔄 
🔄 Step 3: Processing patient dates...
[16:01:26] [DOC: 9221822] ℹ️  DOB normalized: 05/12/1942
[16:01:26] [DOC: 9221822] ℹ️  Episode startOfCare normalized: 08/20/2024
[16:01:26] [DOC: 9221822] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[16:01:26] [DOC: 9221822] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[16:01:26] [DOC: 9221822] ✅ Patient date processing completed successfully
[16:01:26] ✅    ✅ Date processing completed
[16:01:26] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025'}]
[16:01:26] 🔄 
🔄 Step 4: Extracting order data...
[16:01:28] ℹ️  Order extraction - MRN: ''
[16:01:28] ℹ️  Order extraction - Sex: 'FEMALE'
[16:01:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:01:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:01:28] ✅ Order data extraction completed successfully
[16:01:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:01:28] ℹ️  Using MRN from patient data: '1033009'
[16:01:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:01:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:01:28] ✅ Patient name cross-validation successful
[16:01:28] ✅    ✅ Data merged successfully
[16:01:30] ✅    ✅ Order data extracted and validated
[16:01:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:01:30] [DOC: 9221822] ✅ Patient found in local cache: Irene Gauthier, ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:01:30] ✅    ✅ Existing patient found with ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:01:30] 🔄 
🔄 Step 6: Pushing order to API...
[16:01:30] [DOC: 9221822] ℹ️  Pushing order via API for patient ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:01:31] [DOC: 9221822] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13776"}
[16:01:31] ❌    ❌ Failed to push order
[16:01:31] 🔄 
🔄 Step 7: Writing to CSV...
[16:01:31] [DOC: 9221822] ℹ️  Calculated age: 83 from DOB: 05/12/1942
[16:01:31] [DOC: 9221822] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:01:31] [DOC: 9221822] ℹ️  Payer Source extracted: 'Medicare'
[16:01:31] [DOC: 9221822] ℹ️  Diagnosis codes being written:
[16:01:31] [DOC: 9221822] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:01:31] [DOC: 9221822] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:01:31] [DOC: 9221822] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:01:31] [DOC: 9221822] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:01:31] [DOC: 9221822] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:01:31] [DOC: 9221822] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:01:31] [DOC: 9221822] ✅ Patient data written to CSV: Irene Gauthier | Sex: FEMALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 1033009
[16:01:31] ✅    ✅ Document 9221822 processed and saved successfully
[16:01:31] 🔄 
🔄 Step 8: Saving API details...
[16:01:31] [DOC: 9221822] ℹ️  API push details saved for document 9221822
[16:01:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221818                         ║
================================================================================
[16:01:31] ℹ️  Agency: Dartmouth HH
[16:01:31] ℹ️  Date: 04/04/2025
[16:01:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:01:33] [DOC: 9221818] ✅ Text extracted using pdfplumber (4126 chars)
[16:01:33] ✅    ✅ Text extracted using pdfplumber (4126 chars)
[16:01:33] 🔄 
🔄 Step 2: Extracting patient data...
[16:01:36] ℹ️  AI extracted raw sex value: 'F'
[16:01:36] ℹ️  AI extracted service line: 'PT'
[16:01:36] ℹ️  AI extracted payer source: 'Fallon Navicare'
[16:01:36] ℹ️  AI extracted diagnoses:
[16:01:36] ℹ️    - Diagnosis 1: ''
[16:01:36] ℹ️    - Diagnosis 2: ''
[16:01:36] ℹ️    - Diagnosis 3: ''
[16:01:36] ℹ️    - Diagnosis 4: ''
[16:01:36] ℹ️    - Diagnosis 5: ''
[16:01:36] ℹ️    - Diagnosis 6: ''
[16:01:36] ℹ️  Final extracted MRN: '6149015'
[16:01:36] ℹ️  Final extracted Sex: 'FEMALE'
[16:01:36] ℹ️  Final extracted Service Line: 'PT'
[16:01:36] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[16:01:36] ✅ Patient data extraction completed successfully
[16:01:36] ✅    ✅ Patient data extracted successfully
[16:01:36] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:01:36] ✅    ✅ Patient identified: Margaret Rapoza
[16:01:36] ✅    ✅ Patient name validation passed
[16:01:36] 🔄 
🔄 Step 3: Processing patient dates...
[16:01:36] [DOC: 9221818] ℹ️  DOB normalized: 05/05/1936
[16:01:36] [DOC: 9221818] ℹ️  Episode startOfCare normalized: 03/06/2025
[16:01:36] [DOC: 9221818] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[16:01:36] [DOC: 9221818] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[16:01:36] [DOC: 9221818] ✅ Patient date processing completed successfully
[16:01:36] ✅    ✅ Date processing completed
[16:01:36] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:01:36] 🔄 
🔄 Step 4: Extracting order data...
[16:01:38] ℹ️  Order extraction - MRN: '6149015'
[16:01:38] ℹ️  Order extraction - Sex: 'FEMALE'
[16:01:38] ℹ️  Order extraction - Service Line: 'PT'
[16:01:38] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[16:01:38] ✅ Order data extraction completed successfully
[16:01:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:01:38] ℹ️  Using MRN from patient data: '6149015' over '6149015'
[16:01:38] ℹ️  Service line consistent in both sources: 'PT'
[16:01:38] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[16:01:38] ✅ Patient name cross-validation successful
[16:01:38] ✅    ✅ Data merged successfully
[16:01:40] ✅    ✅ Order data extracted and validated
[16:01:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:01:40] [DOC: 9221818] ✅ Patient found in local cache: Margaret Rapoza, ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[16:01:40] ✅    ✅ Existing patient found with ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[16:01:40] 🔄 
🔄 Step 6: Pushing order to API...
[16:01:40] [DOC: 9221818] ℹ️  Pushing order via API for patient ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[16:01:41] [DOC: 9221818] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:01:41] ❌    ❌ Failed to push order
[16:01:41] 🔄 
🔄 Step 7: Writing to CSV...
[16:01:41] [DOC: 9221818] ℹ️  Calculated age: 89 from DOB: 05/05/1936
[16:01:41] [DOC: 9221818] ℹ️  Service Line extracted: 'PT'
[16:01:41] [DOC: 9221818] ℹ️  Payer Source extracted: 'Fallon Navicare'
[16:01:41] [DOC: 9221818] ℹ️  Diagnosis codes being written:
[16:01:41] [DOC: 9221818] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:01:41] [DOC: 9221818] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:01:41] [DOC: 9221818] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:01:41] [DOC: 9221818] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:01:41] [DOC: 9221818] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:01:41] [DOC: 9221818] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:01:41] [DOC: 9221818] ✅ Patient data written to CSV: Margaret Rapoza | Sex: FEMALE | Age: 89 | Service: PT | Payer: Fallon Navicare | MRN: 6149015
[16:01:41] ✅    ✅ Document 9221818 processed and saved successfully
[16:01:41] 🔄 
🔄 Step 8: Saving API details...
[16:01:41] [DOC: 9221818] ℹ️  API push details saved for document 9221818
[16:01:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221814                         ║
================================================================================
[16:01:41] ℹ️  Agency: Dartmouth HH
[16:01:41] ℹ️  Date: 04/04/2025
[16:01:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:01:45] [DOC: 9221814] ✅ Text extracted using pdfplumber (7235 chars)
[16:01:45] ✅    ✅ Text extracted using pdfplumber (7235 chars)
[16:01:45] 🔄 
🔄 Step 2: Extracting patient data...
[16:01:48] ℹ️  AI extracted raw sex value: 'F'
[16:01:48] ℹ️  AI extracted service line: 'PT, OT'
[16:01:48] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[16:01:48] ℹ️  AI extracted diagnoses:
[16:01:48] ℹ️    - Diagnosis 1: ''
[16:01:48] ℹ️    - Diagnosis 2: ''
[16:01:48] ℹ️    - Diagnosis 3: ''
[16:01:48] ℹ️    - Diagnosis 4: ''
[16:01:48] ℹ️    - Diagnosis 5: ''
[16:01:48] ℹ️    - Diagnosis 6: ''
[16:01:48] ℹ️  Final extracted MRN: '1079011'
[16:01:48] ℹ️  Final extracted Sex: 'FEMALE'
[16:01:48] ℹ️  Final extracted Service Line: 'PT, OT'
[16:01:48] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[16:01:48] ✅ Patient data extraction completed successfully
[16:01:48] ✅    ✅ Patient data extracted successfully
[16:01:48] 📊 Patient Response
     └─ patientFName: Rosie
     └─ patientLName: Brown
     └─ dob: 08/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1079011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:01:48] ✅    ✅ Patient identified: Rosie Brown
[16:01:48] ✅    ✅ Patient name validation passed
[16:01:48] 🔄 
🔄 Step 3: Processing patient dates...
[16:01:48] [DOC: 9221814] ℹ️  DOB normalized: 08/27/1941
[16:01:48] [DOC: 9221814] ℹ️  Episode startOfCare normalized: 03/21/2025
[16:01:48] [DOC: 9221814] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:01:48] [DOC: 9221814] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:01:48] [DOC: 9221814] ✅ Patient date processing completed successfully
[16:01:48] ✅    ✅ Date processing completed
[16:01:48] 📊 Processed Patient Data
     └─ patientFName: Rosie
     └─ patientLName: Brown
     └─ dob: 08/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1079011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:01:48] 🔄 
🔄 Step 4: Extracting order data...
[16:01:50] ℹ️  Order extraction - MRN: ''
[16:01:50] ℹ️  Order extraction - Sex: 'FEMALE'
[16:01:50] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:01:50] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[16:01:50] ✅ Order data extraction completed successfully
[16:01:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:01:50] ℹ️  Using MRN from patient data: '1079011'
[16:01:50] ℹ️  Service line consistent in both sources: 'PT, OT'
[16:01:50] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[16:01:50] ✅ Patient name cross-validation successful
[16:01:50] ✅    ✅ Data merged successfully
[16:01:51] ✅    ✅ Order data extracted and validated
[16:01:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:01:58] [DOC: 9221814] ✅ Patient exists in API: Rosie Brown, ID: cd071c7f-5ce7-416e-a360-189960a49508
[16:01:58] ✅    ✅ Existing patient found with ID: cd071c7f-5ce7-416e-a360-189960a49508
[16:01:58] 🔄 
🔄 Step 6: Pushing order to API...
[16:01:58] [DOC: 9221814] ℹ️  Pushing order via API for patient ID: cd071c7f-5ce7-416e-a360-189960a49508
[16:01:59] [DOC: 9221814] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:01:59] ❌    ❌ Failed to push order
[16:01:59] 🔄 
🔄 Step 7: Writing to CSV...
[16:01:59] [DOC: 9221814] ℹ️  Calculated age: 83 from DOB: 08/27/1941
[16:01:59] [DOC: 9221814] ℹ️  Service Line extracted: 'PT, OT'
[16:01:59] [DOC: 9221814] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[16:01:59] [DOC: 9221814] ℹ️  Diagnosis codes being written:
[16:01:59] [DOC: 9221814] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:01:59] [DOC: 9221814] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:01:59] [DOC: 9221814] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:01:59] [DOC: 9221814] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:01:59] [DOC: 9221814] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:01:59] [DOC: 9221814] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:01:59] [DOC: 9221814] ✅ Patient data written to CSV: Rosie Brown | Sex: FEMALE | Age: 83 | Service: PT, OT | Payer: Tufts Health Plan Senior Care Options | MRN: 1079011
[16:01:59] ✅    ✅ Document 9221814 processed and saved successfully
[16:01:59] 🔄 
🔄 Step 8: Saving API details...
[16:01:59] [DOC: 9221814] ℹ️  API push details saved for document 9221814
[16:01:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221812                         ║
================================================================================
[16:01:59] ℹ️  Agency: Dartmouth HH
[16:01:59] ℹ️  Date: 04/04/2025
[16:01:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:02:01] [DOC: 9221812] ✅ Text extracted using pdfplumber (4226 chars)
[16:02:01] ✅    ✅ Text extracted using pdfplumber (4226 chars)
[16:02:01] 🔄 
🔄 Step 2: Extracting patient data...
[16:02:04] ℹ️  AI extracted raw sex value: 'F'
[16:02:04] ℹ️  AI extracted service line: 'Physical Therapy'
[16:02:04] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[16:02:04] ℹ️  AI extracted diagnoses:
[16:02:04] ℹ️    - Diagnosis 1: ''
[16:02:04] ℹ️    - Diagnosis 2: ''
[16:02:04] ℹ️    - Diagnosis 3: ''
[16:02:04] ℹ️    - Diagnosis 4: ''
[16:02:04] ℹ️    - Diagnosis 5: ''
[16:02:04] ℹ️    - Diagnosis 6: ''
[16:02:04] ℹ️  Final extracted MRN: '9472'
[16:02:04] ℹ️  Final extracted Sex: 'FEMALE'
[16:02:04] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:02:04] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[16:02:04] ✅ Patient data extraction completed successfully
[16:02:04] ✅    ✅ Patient data extracted successfully
[16:02:04] 📊 Patient Response
     └─ patientFName: Carmen
     └─ patientLName: Castro
     └─ dob: 07/24/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 9472
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 568 Coggeshall St 1st Floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:02:04] ✅    ✅ Patient identified: Carmen Castro
[16:02:04] ✅    ✅ Patient name validation passed
[16:02:04] 🔄 
🔄 Step 3: Processing patient dates...
[16:02:04] [DOC: 9221812] ℹ️  DOB normalized: 07/24/1958
[16:02:04] [DOC: 9221812] ℹ️  Episode startOfCare normalized: 03/04/2025
[16:02:04] [DOC: 9221812] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[16:02:04] [DOC: 9221812] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[16:02:04] [DOC: 9221812] ✅ Patient date processing completed successfully
[16:02:04] ✅    ✅ Date processing completed
[16:02:04] 📊 Processed Patient Data
     └─ patientFName: Carmen
     └─ patientLName: Castro
     └─ dob: 07/24/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 9472
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 568 Coggeshall St 1st Floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:02:04] 🔄 
🔄 Step 4: Extracting order data...
[16:02:07] ℹ️  Order extraction - MRN: ''
[16:02:07] ℹ️  Order extraction - Sex: 'FEMALE'
[16:02:07] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:02:07] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[16:02:07] ✅ Order data extraction completed successfully
[16:02:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:02:07] ℹ️  Using MRN from patient data: '9472'
[16:02:07] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:02:07] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[16:02:07] ✅ Patient name cross-validation successful
[16:02:07] ✅    ✅ Data merged successfully
[16:02:08] ✅    ✅ Order data extracted and validated
[16:02:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:02:15] [DOC: 9221812] ✅ Patient exists in API: Carmen Castro, ID: e9aa89db-5f97-46d3-9a32-247093e10a28
[16:02:15] ✅    ✅ Existing patient found with ID: e9aa89db-5f97-46d3-9a32-247093e10a28
[16:02:15] 🔄 
🔄 Step 6: Pushing order to API...
[16:02:15] [DOC: 9221812] ℹ️  Pushing order via API for patient ID: e9aa89db-5f97-46d3-9a32-247093e10a28
[16:02:16] [DOC: 9221812] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13462"}
[16:02:16] ❌    ❌ Failed to push order
[16:02:16] 🔄 
🔄 Step 7: Writing to CSV...
[16:02:16] [DOC: 9221812] ℹ️  Calculated age: 66 from DOB: 07/24/1958
[16:02:16] [DOC: 9221812] ℹ️  Service Line extracted: 'Physical Therapy'
[16:02:16] [DOC: 9221812] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[16:02:16] [DOC: 9221812] ℹ️  Diagnosis codes being written:
[16:02:16] [DOC: 9221812] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:02:16] [DOC: 9221812] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:02:16] [DOC: 9221812] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:02:16] [DOC: 9221812] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:02:16] [DOC: 9221812] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:02:16] [DOC: 9221812] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:02:16] [DOC: 9221812] ✅ Patient data written to CSV: Carmen Castro | Sex: FEMALE | Age: 66 | Service: Physical Therapy | Payer: Tufts Health Plan Senior Care Options | MRN: 9472
[16:02:16] ✅    ✅ Document 9221812 processed and saved successfully
[16:02:16] 🔄 
🔄 Step 8: Saving API details...
[16:02:16] [DOC: 9221812] ℹ️  API push details saved for document 9221812
[16:02:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221808                         ║
================================================================================
[16:02:16] ℹ️  Agency: Dartmouth HH
[16:02:16] ℹ️  Date: 04/04/2025
[16:02:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:02:18] [DOC: 9221808] ✅ Text extracted using pdfplumber (3209 chars)
[16:02:18] ✅    ✅ Text extracted using pdfplumber (3209 chars)
[16:02:18] 🔄 
🔄 Step 2: Extracting patient data...
[16:02:21] ℹ️  AI extracted raw sex value: 'F'
[16:02:21] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[16:02:21] ℹ️  AI extracted payer source: 'Medicare'
[16:02:21] ℹ️  AI extracted diagnoses:
[16:02:21] ℹ️    - Diagnosis 1: ''
[16:02:21] ℹ️    - Diagnosis 2: ''
[16:02:21] ℹ️    - Diagnosis 3: ''
[16:02:21] ℹ️    - Diagnosis 4: ''
[16:02:21] ℹ️    - Diagnosis 5: ''
[16:02:21] ℹ️    - Diagnosis 6: ''
[16:02:21] ℹ️  Final extracted MRN: '2083015'
[16:02:21] ℹ️  Final extracted Sex: 'FEMALE'
[16:02:21] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[16:02:21] ℹ️  Final extracted Payer Source: 'Medicare'
[16:02:21] ✅ Patient data extraction completed successfully
[16:02:21] ✅    ✅ Patient data extracted successfully
[16:02:21] 📊 Patient Response
     └─ patientFName: Doris
     └─ patientLName: Debarros
     └─ dob: 08/19/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2083015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:02:21] ✅    ✅ Patient identified: Doris Debarros
[16:02:21] ✅    ✅ Patient name validation passed
[16:02:21] 🔄 
🔄 Step 3: Processing patient dates...
[16:02:21] [DOC: 9221808] ℹ️  DOB normalized: 08/19/1932
[16:02:21] [DOC: 9221808] ℹ️  Episode startOfCare normalized: 02/28/2025
[16:02:21] [DOC: 9221808] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[16:02:21] [DOC: 9221808] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[16:02:21] [DOC: 9221808] ✅ Patient date processing completed successfully
[16:02:21] ✅    ✅ Date processing completed
[16:02:21] 📊 Processed Patient Data
     └─ patientFName: Doris
     └─ patientLName: Debarros
     └─ dob: 08/19/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2083015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:02:21] 🔄 
🔄 Step 4: Extracting order data...
[16:02:23] ℹ️  Order extraction - MRN: ''
[16:02:23] ℹ️  Order extraction - Sex: 'FEMALE'
[16:02:23] ℹ️  Order extraction - Service Line: 'PT'
[16:02:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:02:23] ✅ Order data extraction completed successfully
[16:02:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:02:23] ℹ️  Using MRN from patient data: '2083015'
[16:02:23] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT' = 'PT, Physical Therapy, Skilled Nursing'
[16:02:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:02:23] ✅ Patient name cross-validation successful
[16:02:23] ✅    ✅ Data merged successfully
[16:02:24] ✅    ✅ Order data extracted and validated
[16:02:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:02:30] [DOC: 9221808] ✅ Patient exists in API: Doris Debarros, ID: b2bd03c5-78c0-4413-9c40-06ce6e792f08
[16:02:30] ✅    ✅ Existing patient found with ID: b2bd03c5-78c0-4413-9c40-06ce6e792f08
[16:02:30] 🔄 
🔄 Step 6: Pushing order to API...
[16:02:30] [DOC: 9221808] ℹ️  Pushing order via API for patient ID: b2bd03c5-78c0-4413-9c40-06ce6e792f08
[16:02:31] [DOC: 9221808] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13763"}
[16:02:31] ❌    ❌ Failed to push order
[16:02:31] 🔄 
🔄 Step 7: Writing to CSV...
[16:02:31] [DOC: 9221808] ℹ️  Calculated age: 92 from DOB: 08/19/1932
[16:02:31] [DOC: 9221808] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[16:02:31] [DOC: 9221808] ℹ️  Payer Source extracted: 'Medicare'
[16:02:31] [DOC: 9221808] ℹ️  Diagnosis codes being written:
[16:02:31] [DOC: 9221808] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:02:31] [DOC: 9221808] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:02:31] [DOC: 9221808] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:02:31] [DOC: 9221808] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:02:31] [DOC: 9221808] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:02:31] [DOC: 9221808] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:02:31] [DOC: 9221808] ✅ Patient data written to CSV: Doris Debarros | Sex: FEMALE | Age: 92 | Service: PT, Physical Therapy, Skilled Nursing | Payer: Medicare | MRN: 2083015
[16:02:31] ✅    ✅ Document 9221808 processed and saved successfully
[16:02:31] 🔄 
🔄 Step 8: Saving API details...
[16:02:31] [DOC: 9221808] ℹ️  API push details saved for document 9221808
[16:02:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221804                         ║
================================================================================
[16:02:31] ℹ️  Agency: Dartmouth HH
[16:02:31] ℹ️  Date: 04/04/2025
[16:02:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:02:33] [DOC: 9221804] ✅ Text extracted using pdfplumber (1117 chars)
[16:02:33] ✅    ✅ Text extracted using pdfplumber (1117 chars)
[16:02:33] 🔄 
🔄 Step 2: Extracting patient data...
[16:02:36] ℹ️  AI extracted raw sex value: 'F'
[16:02:36] ℹ️  AI extracted service line: 'PT'
[16:02:36] ℹ️  AI extracted payer source: 'Health Plans Inc.'
[16:02:36] ℹ️  AI extracted diagnoses:
[16:02:36] ℹ️    - Diagnosis 1: 'None'
[16:02:36] ℹ️    - Diagnosis 2: 'None'
[16:02:36] ℹ️    - Diagnosis 3: 'None'
[16:02:36] ℹ️    - Diagnosis 4: 'None'
[16:02:36] ℹ️    - Diagnosis 5: 'None'
[16:02:36] ℹ️    - Diagnosis 6: 'None'
[16:02:36] ℹ️  Final extracted MRN: '5289015'
[16:02:36] ℹ️  Final extracted Sex: 'FEMALE'
[16:02:36] ℹ️  Final extracted Service Line: 'PT'
[16:02:36] ℹ️  Final extracted Payer Source: 'Health Plans Inc.'
[16:02:36] ✅ Patient data extraction completed successfully
[16:02:36] ✅    ✅ Patient data extracted successfully
[16:02:36] 📊 Patient Response
     └─ patientFName: Tammy
     └─ patientLName: Neves
     └─ dob: 05/30/1969
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5289015
     └─ billingProvider: Health Plans Inc.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Health Plans Inc.
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:02:36] ✅    ✅ Patient identified: Tammy Neves
[16:02:36] ✅    ✅ Patient name validation passed
[16:02:36] 🔄 
🔄 Step 3: Processing patient dates...
[16:02:36] [DOC: 9221804] ℹ️  DOB normalized: 05/30/1969
[16:02:36] [DOC: 9221804] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:02:36] [DOC: 9221804] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:02:36] [DOC: 9221804] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:02:36] [DOC: 9221804] ✅ Patient date processing completed successfully
[16:02:36] ✅    ✅ Date processing completed
[16:02:36] 📊 Processed Patient Data
     └─ patientFName: Tammy
     └─ patientLName: Neves
     └─ dob: 05/30/1969
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5289015
     └─ billingProvider: Health Plans Inc.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Health Plans Inc.
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025'}]
[16:02:36] 🔄 
🔄 Step 4: Extracting order data...
[16:02:38] ℹ️  Order extraction - MRN: ''
[16:02:38] ℹ️  Order extraction - Sex: 'FEMALE'
[16:02:38] ℹ️  Order extraction - Service Line: 'PT'
[16:02:38] ℹ️  Order extraction - Payer Source: 'Health Plans Inc.'
[16:02:38] ✅ Order data extraction completed successfully
[16:02:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:02:38] ℹ️  Using MRN from patient data: '5289015'
[16:02:38] ℹ️  Service line consistent in both sources: 'PT'
[16:02:38] ℹ️  Payer source consistent in both sources: 'Health Plans Inc.'
[16:02:38] ✅ Patient name cross-validation successful
[16:02:38] ✅    ✅ Data merged successfully
[16:02:39] ✅    ✅ Order data extracted and validated
[16:02:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:03:03] [DOC: 9221804] ✅ Patient exists in API: Tammy Neves, ID: 1a5e7d87-b479-42bc-afc6-18736631890d
[16:03:03] ✅    ✅ Existing patient found with ID: 1a5e7d87-b479-42bc-afc6-18736631890d
[16:03:03] 🔄 
🔄 Step 6: Pushing order to API...
[16:03:03] [DOC: 9221804] ℹ️  Pushing order via API for patient ID: 1a5e7d87-b479-42bc-afc6-18736631890d
[16:03:04] [DOC: 9221804] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14175"}
[16:03:04] ❌    ❌ Failed to push order
[16:03:04] 🔄 
🔄 Step 7: Writing to CSV...
[16:03:04] [DOC: 9221804] ℹ️  Calculated age: 56 from DOB: 05/30/1969
[16:03:04] [DOC: 9221804] ℹ️  Service Line extracted: 'PT'
[16:03:04] [DOC: 9221804] ℹ️  Payer Source extracted: 'Health Plans Inc.'
[16:03:04] [DOC: 9221804] ℹ️  Diagnosis codes being written:
[16:03:04] [DOC: 9221804] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:03:04] [DOC: 9221804] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:03:04] [DOC: 9221804] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:03:04] [DOC: 9221804] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:03:04] [DOC: 9221804] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:03:04] [DOC: 9221804] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:03:04] [DOC: 9221804] ✅ Patient data written to CSV: Tammy Neves | Sex: FEMALE | Age: 56 | Service: PT | Payer: Health Plans Inc. | MRN: 5289015
[16:03:04] ✅    ✅ Document 9221804 processed and saved successfully
[16:03:04] 🔄 
🔄 Step 8: Saving API details...
[16:03:04] [DOC: 9221804] ℹ️  API push details saved for document 9221804
[16:03:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221801                         ║
================================================================================
[16:03:04] ℹ️  Agency: Dartmouth HH
[16:03:04] ℹ️  Date: 04/04/2025
[16:03:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:03:06] [DOC: 9221801] ✅ Text extracted using pdfplumber (1062 chars)
[16:03:06] ✅    ✅ Text extracted using pdfplumber (1062 chars)
[16:03:06] 🔄 
🔄 Step 2: Extracting patient data...
[16:03:09] ℹ️  AI extracted raw sex value: 'M'
[16:03:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:03:09] ℹ️  AI extracted payer source: 'Medicare'
[16:03:09] ℹ️  AI extracted diagnoses:
[16:03:09] ℹ️    - Diagnosis 1: ''
[16:03:09] ℹ️    - Diagnosis 2: ''
[16:03:09] ℹ️    - Diagnosis 3: ''
[16:03:09] ℹ️    - Diagnosis 4: ''
[16:03:09] ℹ️    - Diagnosis 5: ''
[16:03:09] ℹ️    - Diagnosis 6: ''
[16:03:09] ℹ️  Final extracted MRN: '6140015'
[16:03:09] ℹ️  Final extracted Sex: 'MALE'
[16:03:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:03:09] ℹ️  Final extracted Payer Source: 'Medicare'
[16:03:09] ✅ Patient data extraction completed successfully
[16:03:09] ✅    ✅ Patient data extracted successfully
[16:03:09] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Pamela L Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:03:09] ✅    ✅ Patient identified: Ernest Barboza
[16:03:09] ✅    ✅ Patient name validation passed
[16:03:09] 🔄 
🔄 Step 3: Processing patient dates...
[16:03:09] [DOC: 9221801] ℹ️  DOB normalized: 02/22/1937
[16:03:09] [DOC: 9221801] ℹ️  Episode startOfCare normalized: 03/06/2025
[16:03:09] [DOC: 9221801] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[16:03:09] [DOC: 9221801] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[16:03:09] [DOC: 9221801] ✅ Patient date processing completed successfully
[16:03:09] ✅    ✅ Date processing completed
[16:03:09] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Pamela L Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:03:09] 🔄 
🔄 Step 4: Extracting order data...
[16:03:11] ℹ️  Order extraction - MRN: ''
[16:03:11] ℹ️  Order extraction - Sex: 'MALE'
[16:03:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:03:11] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:03:11] ✅ Order data extraction completed successfully
[16:03:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:03:11] ℹ️  Using MRN from patient data: '6140015'
[16:03:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:03:11] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:03:11] ✅ Patient name cross-validation successful
[16:03:11] ✅    ✅ Data merged successfully
[16:03:13] ✅    ✅ Order data extracted and validated
[16:03:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:03:13] [DOC: 9221801] ✅ Patient found in local cache: Ernest Barboza, ID: adb22793-6127-48ac-9c27-184ca9af82cc
[16:03:13] ✅    ✅ Existing patient found with ID: adb22793-6127-48ac-9c27-184ca9af82cc
[16:03:13] 🔄 
🔄 Step 6: Pushing order to API...
[16:03:13] [DOC: 9221801] ℹ️  Pushing order via API for patient ID: adb22793-6127-48ac-9c27-184ca9af82cc
[16:03:14] [DOC: 9221801] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:03:14] ❌    ❌ Failed to push order
[16:03:14] 🔄 
🔄 Step 7: Writing to CSV...
[16:03:14] [DOC: 9221801] ℹ️  Calculated age: 88 from DOB: 02/22/1937
[16:03:14] [DOC: 9221801] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:03:14] [DOC: 9221801] ℹ️  Payer Source extracted: 'Medicare'
[16:03:14] [DOC: 9221801] ℹ️  Diagnosis codes being written:
[16:03:14] [DOC: 9221801] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:03:14] [DOC: 9221801] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:03:14] [DOC: 9221801] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:03:14] [DOC: 9221801] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:03:14] [DOC: 9221801] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:03:14] [DOC: 9221801] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:03:14] [DOC: 9221801] ✅ Patient data written to CSV: Ernest Barboza | Sex: MALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6140015
[16:03:14] ✅    ✅ Document 9221801 processed and saved successfully
[16:03:14] 🔄 
🔄 Step 8: Saving API details...
[16:03:14] [DOC: 9221801] ℹ️  API push details saved for document 9221801
[16:03:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221797                         ║
================================================================================
[16:03:14] ℹ️  Agency: Dartmouth HH
[16:03:14] ℹ️  Date: 04/04/2025
[16:03:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:03:17] [DOC: 9221797] ✅ Text extracted using pdfplumber (11340 chars)
[16:03:17] ✅    ✅ Text extracted using pdfplumber (11340 chars)
[16:03:17] 🔄 
🔄 Step 2: Extracting patient data...
[16:03:20] ℹ️  AI extracted raw sex value: 'M'
[16:03:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:03:20] ℹ️  AI extracted payer source: ''
[16:03:20] ℹ️  AI extracted diagnoses:
[16:03:20] ℹ️    - Diagnosis 1: 'E11.65'
[16:03:20] ℹ️    - Diagnosis 2: 'G80.9'
[16:03:20] ℹ️    - Diagnosis 3: 'H55.01'
[16:03:20] ℹ️    - Diagnosis 4: 'I11.0'
[16:03:20] ℹ️    - Diagnosis 5: 'I50.32'
[16:03:20] ℹ️    - Diagnosis 6: 'G31.84'
[16:03:20] ℹ️  Final extracted MRN: '2833015'
[16:03:20] ℹ️  Final extracted Sex: 'MALE'
[16:03:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:03:20] ℹ️  Final extracted Payer Source: ''
[16:03:20] ✅ Patient data extraction completed successfully
[16:03:20] ✅    ✅ Patient data extracted successfully
[16:03:20] 📊 Patient Response
     └─ patientFName: Barrett
     └─ patientLName: Jr, Paul
     └─ dob: 12/28/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2833015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2024', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'G80.9', 'thirdDiagnosis': 'H55.01', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'G31.84'}]
[16:03:20] ✅    ✅ Patient identified: Barrett Jr, Paul
[16:03:20] ✅    ✅ Patient name validation passed
[16:03:20] 🔄 
🔄 Step 3: Processing patient dates...
[16:03:20] [DOC: 9221797] ℹ️  DOB normalized: 12/28/1947
[16:03:20] [DOC: 9221797] ℹ️  Episode startOfCare normalized: 04/09/2024
[16:03:20] [DOC: 9221797] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[16:03:20] [DOC: 9221797] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[16:03:20] [DOC: 9221797] ✅ Patient date processing completed successfully
[16:03:20] ✅    ✅ Date processing completed
[16:03:20] 📊 Processed Patient Data
     └─ patientFName: Barrett
     └─ patientLName: Jr, Paul
     └─ dob: 12/28/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2833015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2024', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'G80.9', 'thirdDiagnosis': 'H55.01', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'G31.84'}]
[16:03:20] 🔄 
🔄 Step 4: Extracting order data...
[16:03:22] ℹ️  Order extraction - MRN: '2833015'
[16:03:22] ℹ️  Order extraction - Sex: 'MALE'
[16:03:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:03:22] ℹ️  Order extraction - Payer Source: ''
[16:03:22] ✅ Order data extraction completed successfully
[16:03:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:03:22] ℹ️  Using MRN from patient data: '2833015' over '2833015'
[16:03:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:03:22] ✅ Patient name cross-validation successful
[16:03:22] ✅    ✅ Data merged successfully
[16:03:24] ✅    ✅ Order data extracted and validated
[16:03:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:04:03] [DOC: 9221797] ℹ️  Patient not found in cache or API: Barrett Jr, Paul
[16:04:03] [DOC: 9221797] ℹ️  Patient not found, creating new patient via API...
[16:04:03] [DOC: 9221797] ℹ️  Creating patient via API: Barrett Jr, Paul
[16:04:05] [DOC: 9221797] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:04:05] ❌    ❌ Failed to create patient
[16:04:05] [DOC: 9221797] ℹ️  API push details saved for document 9221797
================================================================================
║                        Processing Document ID: 9221784                         ║
================================================================================
[16:04:05] ℹ️  Agency: Dartmouth HH
[16:04:05] ℹ️  Date: 04/04/2025
[16:04:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:04:07] [DOC: 9221784] ✅ Text extracted using pdfplumber (1317 chars)
[16:04:07] ✅    ✅ Text extracted using pdfplumber (1317 chars)
[16:04:07] 🔄 
🔄 Step 2: Extracting patient data...
[16:04:10] ℹ️  AI extracted raw sex value: 'F'
[16:04:10] ℹ️  AI extracted service line: 'RN'
[16:04:10] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:04:10] ℹ️  AI extracted diagnoses:
[16:04:10] ℹ️    - Diagnosis 1: 'None'
[16:04:10] ℹ️    - Diagnosis 2: 'None'
[16:04:10] ℹ️    - Diagnosis 3: 'None'
[16:04:10] ℹ️    - Diagnosis 4: 'None'
[16:04:10] ℹ️    - Diagnosis 5: 'None'
[16:04:10] ℹ️    - Diagnosis 6: 'None'
[16:04:10] ℹ️  Final extracted MRN: '6204015'
[16:04:10] ℹ️  Final extracted Sex: 'FEMALE'
[16:04:10] ℹ️  Final extracted Service Line: 'RN'
[16:04:10] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:04:10] ✅ Patient data extraction completed successfully
[16:04:10] ✅    ✅ Patient data extracted successfully
[16:04:10] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:04:10] ✅    ✅ Patient identified: Rita Costa
[16:04:10] ✅    ✅ Patient name validation passed
[16:04:10] 🔄 
🔄 Step 3: Processing patient dates...
[16:04:10] [DOC: 9221784] ℹ️  DOB normalized: 10/16/1930
[16:04:10] [DOC: 9221784] ℹ️  Episode startOfCare normalized: 03/17/2025
[16:04:10] [DOC: 9221784] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:04:10] [DOC: 9221784] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:04:10] [DOC: 9221784] ✅ Patient date processing completed successfully
[16:04:10] ✅    ✅ Date processing completed
[16:04:10] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025'}]
[16:04:10] 🔄 
🔄 Step 4: Extracting order data...
[16:04:12] ℹ️  Order extraction - MRN: ''
[16:04:12] ℹ️  Order extraction - Sex: 'FEMALE'
[16:04:12] ℹ️  Order extraction - Service Line: 'RN'
[16:04:12] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:04:12] ✅ Order data extraction completed successfully
[16:04:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:04:12] ℹ️  Using MRN from patient data: '6204015'
[16:04:12] ℹ️  Service line consistent in both sources: 'RN'
[16:04:12] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:04:12] ✅ Patient name cross-validation successful
[16:04:12] ✅    ✅ Data merged successfully
[16:04:14] ✅    ✅ Order data extracted and validated
[16:04:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:04:14] [DOC: 9221784] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[16:04:14] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[16:04:14] 🔄 
🔄 Step 6: Pushing order to API...
[16:04:14] [DOC: 9221784] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[16:04:18] [DOC: 9221784] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12877"}
[16:04:18] ❌    ❌ Failed to push order
[16:04:18] 🔄 
🔄 Step 7: Writing to CSV...
[16:04:18] [DOC: 9221784] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[16:04:18] [DOC: 9221784] ℹ️  Service Line extracted: 'RN'
[16:04:18] [DOC: 9221784] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[16:04:18] [DOC: 9221784] ℹ️  Diagnosis codes being written:
[16:04:18] [DOC: 9221784] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:04:18] [DOC: 9221784] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:04:18] [DOC: 9221784] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:04:18] [DOC: 9221784] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:04:18] [DOC: 9221784] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:04:18] [DOC: 9221784] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:04:18] [DOC: 9221784] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: RN | Payer: Aetna- Mcare | MRN: 6204015
[16:04:18] ✅    ✅ Document 9221784 processed and saved successfully
[16:04:18] 🔄 
🔄 Step 8: Saving API details...
[16:04:18] [DOC: 9221784] ℹ️  API push details saved for document 9221784
[16:04:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221780                         ║
================================================================================
[16:04:18] ℹ️  Agency: Dartmouth HH
[16:04:18] ℹ️  Date: 04/04/2025
[16:04:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:04:20] [DOC: 9221780] ✅ Text extracted using pdfplumber (3337 chars)
[16:04:20] ✅    ✅ Text extracted using pdfplumber (3337 chars)
[16:04:20] 🔄 
🔄 Step 2: Extracting patient data...
[16:04:23] ℹ️  AI extracted raw sex value: 'M'
[16:04:23] ℹ️  AI extracted service line: 'Speech Therapy, Skilled Nursing'
[16:04:23] ℹ️  AI extracted payer source: 'Medicare'
[16:04:23] ℹ️  AI extracted diagnoses:
[16:04:23] ℹ️    - Diagnosis 1: ''
[16:04:23] ℹ️    - Diagnosis 2: ''
[16:04:23] ℹ️    - Diagnosis 3: ''
[16:04:23] ℹ️    - Diagnosis 4: ''
[16:04:23] ℹ️    - Diagnosis 5: ''
[16:04:23] ℹ️    - Diagnosis 6: ''
[16:04:23] ℹ️  Final extracted MRN: '1742011'
[16:04:23] ℹ️  Final extracted Sex: 'MALE'
[16:04:23] ℹ️  Final extracted Service Line: 'Speech Therapy, Skilled Nursing'
[16:04:23] ℹ️  Final extracted Payer Source: 'Medicare'
[16:04:23] ✅ Patient data extraction completed successfully
[16:04:23] ✅    ✅ Patient data extracted successfully
[16:04:23] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Macdonald
     └─ dob: 09/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 1742011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:04:23] ✅    ✅ Patient identified: George Macdonald
[16:04:23] ✅    ✅ Patient name validation passed
[16:04:23] 🔄 
🔄 Step 3: Processing patient dates...
[16:04:23] [DOC: 9221780] ℹ️  DOB normalized: 09/17/1941
[16:04:23] [DOC: 9221780] ℹ️  Episode startOfCare normalized: 03/01/2025
[16:04:23] [DOC: 9221780] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:04:23] [DOC: 9221780] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:04:23] [DOC: 9221780] ✅ Patient date processing completed successfully
[16:04:23] ✅    ✅ Date processing completed
[16:04:23] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Macdonald
     └─ dob: 09/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 1742011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:04:23] 🔄 
🔄 Step 4: Extracting order data...
[16:04:25] ℹ️  Order extraction - MRN: ''
[16:04:25] ℹ️  Order extraction - Sex: 'MALE'
[16:04:25] ℹ️  Order extraction - Service Line: 'SLP, RN'
[16:04:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:04:25] ✅ Order data extraction completed successfully
[16:04:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:04:25] ℹ️  Using MRN from patient data: '1742011'
[16:04:25] ℹ️  Combined service lines: Patient='Speech Therapy, Skilled Nursing' + Order='SLP, RN' = 'RN, SLP, Skilled Nursing, Speech Therapy'
[16:04:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:04:25] ✅ Patient name cross-validation successful
[16:04:25] ✅    ✅ Data merged successfully
[16:04:26] ✅    ✅ Order data extracted and validated
[16:04:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:05:11] [DOC: 9221780] ℹ️  Patient not found in cache or API: George Macdonald
[16:05:11] [DOC: 9221780] ℹ️  Patient not found, creating new patient via API...
[16:05:11] [DOC: 9221780] ℹ️  Creating patient via API: George Macdonald
[16:05:12] [DOC: 9221780] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:05:12] ❌    ❌ Failed to create patient
[16:05:12] [DOC: 9221780] ℹ️  API push details saved for document 9221780
================================================================================
║                        Processing Document ID: 9221775                         ║
================================================================================
[16:05:12] ℹ️  Agency: Dartmouth HH
[16:05:12] ℹ️  Date: 04/04/2025
[16:05:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:05:15] [DOC: 9221775] ✅ Text extracted using pdfplumber (11694 chars)
[16:05:15] ✅    ✅ Text extracted using pdfplumber (11682 chars)
[16:05:15] 🔄 
🔄 Step 2: Extracting patient data...
[16:05:18] ℹ️  AI extracted raw sex value: 'F'
[16:05:18] ℹ️  AI extracted service line: 'Skilled Nursing, Speech Therapy'
[16:05:18] ℹ️  AI extracted payer source: ''
[16:05:18] ℹ️  AI extracted diagnoses:
[16:05:18] ℹ️    - Diagnosis 1: 'B37.2'
[16:05:18] ℹ️    - Diagnosis 2: 'L30.4'
[16:05:18] ℹ️    - Diagnosis 3: 'S21.001D'
[16:05:18] ℹ️    - Diagnosis 4: 'S21.002D'
[16:05:18] ℹ️    - Diagnosis 5: 'R13.10'
[16:05:18] ℹ️    - Diagnosis 6: 'E83.51'
[16:05:18] ℹ️  Final extracted MRN: '6222015'
[16:05:18] ℹ️  Final extracted Sex: 'FEMALE'
[16:05:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, Speech Therapy'
[16:05:18] ℹ️  Final extracted Payer Source: ''
[16:05:18] ✅ Patient data extraction completed successfully
[16:05:18] ✅    ✅ Patient data extracted successfully
[16:05:18] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Vieira
     └─ dob: 10/23/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6222015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'B37.2', 'secondDiagnosis': 'L30.4', 'thirdDiagnosis': 'S21.001D', 'fourthDiagnosis': 'S21.002D', 'fifthDiagnosis': 'R13.10', 'sixthDiagnosis': 'E83.51'}]
[16:05:18] ✅    ✅ Patient identified: Theresa Vieira
[16:05:18] ✅    ✅ Patient name validation passed
[16:05:18] 🔄 
🔄 Step 3: Processing patient dates...
[16:05:18] [DOC: 9221775] ℹ️  DOB normalized: 10/23/1953
[16:05:18] [DOC: 9221775] ℹ️  Episode startOfCare normalized: 03/20/2025
[16:05:18] [DOC: 9221775] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[16:05:18] [DOC: 9221775] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[16:05:18] [DOC: 9221775] ✅ Patient date processing completed successfully
[16:05:18] ✅    ✅ Date processing completed
[16:05:18] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Vieira
     └─ dob: 10/23/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6222015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'B37.2', 'secondDiagnosis': 'L30.4', 'thirdDiagnosis': 'S21.001D', 'fourthDiagnosis': 'S21.002D', 'fifthDiagnosis': 'R13.10', 'sixthDiagnosis': 'E83.51'}]
[16:05:18] 🔄 
🔄 Step 4: Extracting order data...
[16:05:21] ℹ️  Order extraction - MRN: '6222015'
[16:05:21] ℹ️  Order extraction - Sex: 'FEMALE'
[16:05:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Speech Therapy'
[16:05:21] ℹ️  Order extraction - Payer Source: ''
[16:05:21] ✅ Order data extraction completed successfully
[16:05:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:05:21] ℹ️  Using MRN from patient data: '6222015' over '6222015'
[16:05:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Speech Therapy'
[16:05:21] ✅ Patient name cross-validation successful
[16:05:21] ✅    ✅ Data merged successfully
[16:05:22] ✅    ✅ Order data extracted and validated
[16:05:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:05:22] [DOC: 9221775] ✅ Patient found in local cache: Theresa Vieira, ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[16:05:22] ✅    ✅ Existing patient found with ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[16:05:22] 🔄 
🔄 Step 6: Pushing order to API...
[16:05:22] [DOC: 9221775] ℹ️  Pushing order via API for patient ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[16:05:23] [DOC: 9221775] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:05:23] ❌    ❌ Failed to push order
[16:05:23] 🔄 
🔄 Step 7: Writing to CSV...
[16:05:23] [DOC: 9221775] ℹ️  Calculated age: 71 from DOB: 10/23/1953
[16:05:23] [DOC: 9221775] ℹ️  Service Line extracted: 'Skilled Nursing, Speech Therapy'
[16:05:23] [DOC: 9221775] ℹ️  Payer Source extracted: ''
[16:05:23] [DOC: 9221775] ℹ️  Diagnosis codes being written:
[16:05:23] [DOC: 9221775] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.2'
[16:05:23] [DOC: 9221775] ℹ️    - Latest_Episode_Seconddiagnosis: 'L30.4'
[16:05:23] [DOC: 9221775] ℹ️    - Latest_Episode_Thirddiagnosis: 'S21.001D'
[16:05:23] [DOC: 9221775] ℹ️    - Latest_Episode_Fourthdiagnosis: 'S21.002D'
[16:05:23] [DOC: 9221775] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R13.10'
[16:05:23] [DOC: 9221775] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E83.51'
[16:05:23] [DOC: 9221775] ✅ Patient data written to CSV: Theresa Vieira | Sex: FEMALE | Age: 71 | Service: Skilled Nursing, Speech Therapy | Payer:  | MRN: 6222015
[16:05:23] ✅    ✅ Document 9221775 processed and saved successfully
[16:05:23] 🔄 
🔄 Step 8: Saving API details...
[16:05:23] [DOC: 9221775] ℹ️  API push details saved for document 9221775
[16:05:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221772                         ║
================================================================================
[16:05:23] ℹ️  Agency: Dartmouth HH
[16:05:23] ℹ️  Date: 04/04/2025
[16:05:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:05:28] [DOC: 9221772] ✅ Text extracted using pdfplumber (15641 chars)
[16:05:28] ✅    ✅ Text extracted using pdfplumber (15641 chars)
[16:05:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:05:30] ℹ️  AI extracted raw sex value: 'F'
[16:05:30] ℹ️  AI extracted service line: 'PT, SN'
[16:05:30] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:05:30] ℹ️  AI extracted diagnoses:
[16:05:30] ℹ️    - Diagnosis 1: ''
[16:05:30] ℹ️    - Diagnosis 2: ''
[16:05:30] ℹ️    - Diagnosis 3: ''
[16:05:30] ℹ️    - Diagnosis 4: ''
[16:05:30] ℹ️    - Diagnosis 5: ''
[16:05:30] ℹ️    - Diagnosis 6: ''
[16:05:30] ℹ️  Final extracted MRN: '5843015'
[16:05:30] ℹ️  Final extracted Sex: 'FEMALE'
[16:05:30] ℹ️  Final extracted Service Line: 'PT, SN'
[16:05:30] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:05:30] ✅ Patient data extraction completed successfully
[16:05:30] ✅    ✅ Patient data extracted successfully
[16:05:30] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, SN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:05:30] ✅    ✅ Patient identified: Joanne Medeiros
[16:05:30] ✅    ✅ Patient name validation passed
[16:05:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:05:30] [DOC: 9221772] ℹ️  DOB normalized: 12/09/1952
[16:05:30] [DOC: 9221772] ℹ️  Episode startOfCare normalized: 01/15/2025
[16:05:30] [DOC: 9221772] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[16:05:30] [DOC: 9221772] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[16:05:30] [DOC: 9221772] ✅ Patient date processing completed successfully
[16:05:30] ✅    ✅ Date processing completed
[16:05:30] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, SN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:05:30] 🔄 
🔄 Step 4: Extracting order data...
[16:05:33] ℹ️  Order extraction - MRN: ''
[16:05:33] ℹ️  Order extraction - Sex: 'FEMALE'
[16:05:33] ℹ️  Order extraction - Service Line: 'PT, SN'
[16:05:33] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:05:33] ✅ Order data extraction completed successfully
[16:05:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:05:33] ℹ️  Using MRN from patient data: '5843015'
[16:05:33] ℹ️  Service line consistent in both sources: 'PT, SN'
[16:05:33] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:05:33] ✅ Patient name cross-validation successful
[16:05:33] ✅    ✅ Data merged successfully
[16:05:34] ✅    ✅ Order data extracted and validated
[16:05:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:06:04] [DOC: 9221772] ℹ️  Patient not found in cache or API: Joanne Medeiros
[16:06:04] [DOC: 9221772] ℹ️  Patient not found, creating new patient via API...
[16:06:04] [DOC: 9221772] ℹ️  Creating patient via API: Joanne Medeiros
[16:06:06] [DOC: 9221772] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:06:06] ❌    ❌ Failed to create patient
[16:06:06] [DOC: 9221772] ℹ️  API push details saved for document 9221772
================================================================================
║                        Processing Document ID: 9221770                         ║
================================================================================
[16:06:06] ℹ️  Agency: Dartmouth HH
[16:06:06] ℹ️  Date: 04/04/2025
[16:06:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:06:09] [DOC: 9221770] ✅ Text extracted using pdfplumber (13713 chars)
[16:06:09] ✅    ✅ Text extracted using pdfplumber (13713 chars)
[16:06:09] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:13] ℹ️  AI extracted raw sex value: 'F'
[16:06:13] ℹ️  AI extracted service line: 'PT, RN'
[16:06:13] ℹ️  AI extracted payer source: ''
[16:06:13] ℹ️  AI extracted diagnoses:
[16:06:13] ℹ️    - Diagnosis 1: 'Z47.1'
[16:06:13] ℹ️    - Diagnosis 2: 'M15.0'
[16:06:13] ℹ️    - Diagnosis 3: 'M25.551'
[16:06:13] ℹ️    - Diagnosis 4: 'E66.9'
[16:06:13] ℹ️    - Diagnosis 5: 'Z68.34'
[16:06:13] ℹ️    - Diagnosis 6: 'I73.9'
[16:06:13] ℹ️  Final extracted MRN: '5711015'
[16:06:13] ℹ️  Final extracted Sex: 'FEMALE'
[16:06:13] ℹ️  Final extracted Service Line: 'PT, RN'
[16:06:13] ℹ️  Final extracted Payer Source: ''
[16:06:13] ✅ Patient data extraction completed successfully
[16:06:13] ✅    ✅ Patient data extracted successfully
[16:06:13] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ascensao
     └─ dob: 11/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M15.0', 'thirdDiagnosis': 'M25.551', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.34', 'sixthDiagnosis': 'I73.9'}]
[16:06:13] ✅    ✅ Patient identified: Maria Ascensao
[16:06:13] ✅    ✅ Patient name validation passed
[16:06:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:13] [DOC: 9221770] ℹ️  DOB normalized: 11/21/1941
[16:06:13] [DOC: 9221770] ℹ️  Episode startOfCare normalized: 03/28/2025
[16:06:13] [DOC: 9221770] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[16:06:13] [DOC: 9221770] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[16:06:13] [DOC: 9221770] ✅ Patient date processing completed successfully
[16:06:13] ✅    ✅ Date processing completed
[16:06:13] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ascensao
     └─ dob: 11/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M15.0', 'thirdDiagnosis': 'M25.551', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.34', 'sixthDiagnosis': 'I73.9'}]
[16:06:13] 🔄 
🔄 Step 4: Extracting order data...
[16:06:15] ℹ️  Order extraction - MRN: '5711015'
[16:06:15] ℹ️  Order extraction - Sex: 'FEMALE'
[16:06:15] ℹ️  Order extraction - Service Line: 'PT, RN'
[16:06:15] ℹ️  Order extraction - Payer Source: ''
[16:06:15] ✅ Order data extraction completed successfully
[16:06:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:06:15] ℹ️  Using MRN from patient data: '5711015' over '5711015'
[16:06:15] ℹ️  Service line consistent in both sources: 'PT, RN'
[16:06:15] ✅ Patient name cross-validation successful
[16:06:15] ✅    ✅ Data merged successfully
[16:06:16] ✅    ✅ Order data extracted and validated
[16:06:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:06:16] [DOC: 9221770] ✅ Patient found in local cache: Maria Ascensao, ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[16:06:16] ✅    ✅ Existing patient found with ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[16:06:16] 🔄 
🔄 Step 6: Pushing order to API...
[16:06:16] [DOC: 9221770] ℹ️  Pushing order via API for patient ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[16:06:18] [DOC: 9221770] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:06:18] ❌    ❌ Failed to push order
[16:06:18] 🔄 
🔄 Step 7: Writing to CSV...
[16:06:18] [DOC: 9221770] ℹ️  Calculated age: 83 from DOB: 11/21/1941
[16:06:18] [DOC: 9221770] ℹ️  Service Line extracted: 'PT, RN'
[16:06:18] [DOC: 9221770] ℹ️  Payer Source extracted: ''
[16:06:18] [DOC: 9221770] ℹ️  Diagnosis codes being written:
[16:06:18] [DOC: 9221770] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[16:06:18] [DOC: 9221770] ℹ️    - Latest_Episode_Seconddiagnosis: 'M15.0'
[16:06:18] [DOC: 9221770] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.551'
[16:06:18] [DOC: 9221770] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.9'
[16:06:18] [DOC: 9221770] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.34'
[16:06:18] [DOC: 9221770] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I73.9'
[16:06:18] [DOC: 9221770] ✅ Patient data written to CSV: Maria Ascensao | Sex: FEMALE | Age: 83 | Service: PT, RN | Payer:  | MRN: 5711015
[16:06:18] ✅    ✅ Document 9221770 processed and saved successfully
[16:06:18] 🔄 
🔄 Step 8: Saving API details...
[16:06:18] [DOC: 9221770] ℹ️  API push details saved for document 9221770
[16:06:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221763                         ║
================================================================================
[16:06:18] ℹ️  Agency: Dartmouth HH
[16:06:18] ℹ️  Date: 04/04/2025
[16:06:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:06:20] [DOC: 9221763] ✅ Text extracted using pdfplumber (1223 chars)
[16:06:20] ✅    ✅ Text extracted using pdfplumber (1223 chars)
[16:06:20] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:22] ℹ️  AI extracted raw sex value: 'M'
[16:06:22] ℹ️  AI extracted service line: 'PT'
[16:06:22] ℹ️  AI extracted payer source: 'Medicare'
[16:06:22] ℹ️  AI extracted diagnoses:
[16:06:22] ℹ️    - Diagnosis 1: ''
[16:06:22] ℹ️    - Diagnosis 2: ''
[16:06:22] ℹ️    - Diagnosis 3: ''
[16:06:22] ℹ️    - Diagnosis 4: ''
[16:06:22] ℹ️    - Diagnosis 5: ''
[16:06:22] ℹ️    - Diagnosis 6: ''
[16:06:22] ℹ️  Final extracted MRN: '3076011'
[16:06:22] ℹ️  Final extracted Sex: 'MALE'
[16:06:22] ℹ️  Final extracted Service Line: 'PT'
[16:06:22] ℹ️  Final extracted Payer Source: 'Medicare'
[16:06:22] ✅ Patient data extraction completed successfully
[16:06:22] ✅    ✅ Patient data extracted successfully
[16:06:22] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Fairbanks
     └─ dob: 03/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 3076011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:06:22] ✅    ✅ Patient identified: Paul Fairbanks
[16:06:22] ✅    ✅ Patient name validation passed
[16:06:22] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:22] [DOC: 9221763] ℹ️  DOB normalized: 03/25/1943
[16:06:22] [DOC: 9221763] ℹ️  Episode startOfCare normalized: 12/19/2024
[16:06:22] [DOC: 9221763] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[16:06:22] [DOC: 9221763] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[16:06:22] [DOC: 9221763] ✅ Patient date processing completed successfully
[16:06:22] ✅    ✅ Date processing completed
[16:06:22] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Fairbanks
     └─ dob: 03/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 3076011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:06:22] 🔄 
🔄 Step 4: Extracting order data...
[16:06:25] ℹ️  Order extraction - MRN: ''
[16:06:25] ℹ️  Order extraction - Sex: 'MALE'
[16:06:25] ℹ️  Order extraction - Service Line: 'PT'
[16:06:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:06:25] ✅ Order data extraction completed successfully
[16:06:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:06:25] ℹ️  Using MRN from patient data: '3076011'
[16:06:25] ℹ️  Service line consistent in both sources: 'PT'
[16:06:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:06:25] ✅ Patient name cross-validation successful
[16:06:25] ✅    ✅ Data merged successfully
[16:06:26] ✅    ✅ Order data extracted and validated
[16:06:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:06:45] [DOC: 9221763] ℹ️  Patient not found in cache or API: Paul Fairbanks
[16:06:45] [DOC: 9221763] ℹ️  Patient not found, creating new patient via API...
[16:06:45] [DOC: 9221763] ℹ️  Creating patient via API: Paul Fairbanks
[16:06:47] [DOC: 9221763] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:06:47] ❌    ❌ Failed to create patient
[16:06:47] [DOC: 9221763] ℹ️  API push details saved for document 9221763
================================================================================
║                        Processing Document ID: 9221761                         ║
================================================================================
[16:06:47] ℹ️  Agency: Dartmouth HH
[16:06:47] ℹ️  Date: 04/04/2025
[16:06:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:06:49] [DOC: 9221761] ✅ Text extracted using pdfplumber (2318 chars)
[16:06:49] ✅    ✅ Text extracted using pdfplumber (2318 chars)
[16:06:49] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:51] ℹ️  AI extracted raw sex value: 'M'
[16:06:51] ℹ️  AI extracted service line: 'OT'
[16:06:51] ℹ️  AI extracted payer source: 'Medicare'
[16:06:51] ℹ️  AI extracted diagnoses:
[16:06:51] ℹ️    - Diagnosis 1: ''
[16:06:51] ℹ️    - Diagnosis 2: ''
[16:06:51] ℹ️    - Diagnosis 3: ''
[16:06:51] ℹ️    - Diagnosis 4: ''
[16:06:51] ℹ️    - Diagnosis 5: ''
[16:06:51] ℹ️    - Diagnosis 6: ''
[16:06:51] ℹ️  Final extracted MRN: '6047015'
[16:06:51] ℹ️  Final extracted Sex: 'MALE'
[16:06:51] ℹ️  Final extracted Service Line: 'OT'
[16:06:51] ℹ️  Final extracted Payer Source: 'Medicare'
[16:06:51] ✅ Patient data extraction completed successfully
[16:06:51] ✅    ✅ Patient data extracted successfully
[16:06:51] 📊 Patient Response
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:06:51] ✅    ✅ Patient identified: Keith Boling
[16:06:51] ✅    ✅ Patient name validation passed
[16:06:51] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:51] [DOC: 9221761] ℹ️  DOB normalized: 04/09/1950
[16:06:51] [DOC: 9221761] ℹ️  Episode startOfCare normalized: 03/14/2025
[16:06:51] [DOC: 9221761] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[16:06:51] [DOC: 9221761] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[16:06:51] [DOC: 9221761] ✅ Patient date processing completed successfully
[16:06:51] ✅    ✅ Date processing completed
[16:06:51] 📊 Processed Patient Data
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:06:51] 🔄 
🔄 Step 4: Extracting order data...
[16:06:54] ℹ️  Order extraction - MRN: '6047015'
[16:06:54] ℹ️  Order extraction - Sex: 'MALE'
[16:06:54] ℹ️  Order extraction - Service Line: 'OT'
[16:06:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:06:54] ✅ Order data extraction completed successfully
[16:06:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:06:54] ℹ️  Using MRN from patient data: '6047015' over '6047015'
[16:06:54] ℹ️  Service line consistent in both sources: 'OT'
[16:06:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:06:54] ✅ Patient name cross-validation successful
[16:06:54] ✅    ✅ Data merged successfully
[16:06:55] ✅    ✅ Order data extracted and validated
[16:06:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:08] [DOC: 9221761] ✅ Patient exists in API: Keith Boling, ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[16:07:08] ✅    ✅ Existing patient found with ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[16:07:08] 🔄 
🔄 Step 6: Pushing order to API...
[16:07:08] [DOC: 9221761] ℹ️  Pushing order via API for patient ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[16:07:10] [DOC: 9221761] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:07:10] ❌    ❌ Failed to push order
[16:07:10] 🔄 
🔄 Step 7: Writing to CSV...
[16:07:10] [DOC: 9221761] ℹ️  Calculated age: 75 from DOB: 04/09/1950
[16:07:10] [DOC: 9221761] ℹ️  Service Line extracted: 'OT'
[16:07:10] [DOC: 9221761] ℹ️  Payer Source extracted: 'Medicare'
[16:07:10] [DOC: 9221761] ℹ️  Diagnosis codes being written:
[16:07:10] [DOC: 9221761] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:07:10] [DOC: 9221761] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:07:10] [DOC: 9221761] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:07:10] [DOC: 9221761] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:07:10] [DOC: 9221761] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:07:10] [DOC: 9221761] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:07:10] [DOC: 9221761] ✅ Patient data written to CSV: Keith Boling | Sex: MALE | Age: 75 | Service: OT | Payer: Medicare | MRN: 6047015
[16:07:10] ✅    ✅ Document 9221761 processed and saved successfully
[16:07:10] 🔄 
🔄 Step 8: Saving API details...
[16:07:10] [DOC: 9221761] ℹ️  API push details saved for document 9221761
[16:07:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221696                         ║
================================================================================
[16:07:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:07:10] ℹ️  Date: 04/04/2025
[16:07:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:12] [DOC: 9221696] ✅ Text extracted using pdfplumber (1449 chars)
[16:07:12] ✅    ✅ Text extracted using pdfplumber (1449 chars)
[16:07:12] 🔄 
🔄 Step 2: Extracting patient data...
[16:07:15] ℹ️  AI extracted raw sex value: ''
[16:07:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:07:15] ℹ️  AI extracted payer source: ''
[16:07:15] ℹ️  AI extracted diagnoses:
[16:07:15] ℹ️    - Diagnosis 1: 'I11.9'
[16:07:15] ℹ️    - Diagnosis 2: 'M13.861'
[16:07:15] ℹ️    - Diagnosis 3: 'E78.5'
[16:07:15] ℹ️    - Diagnosis 4: 'None'
[16:07:15] ℹ️    - Diagnosis 5: 'None'
[16:07:15] ℹ️    - Diagnosis 6: 'None'
[16:07:15] ℹ️  Final extracted MRN: 'MA230405053003'
[16:07:15] ℹ️  Final extracted Sex: ''
[16:07:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:07:15] ℹ️  Final extracted Payer Source: ''
[16:07:15] ✅ Patient data extraction completed successfully
[16:07:15] ✅    ✅ Patient data extracted successfully
[16:07:15] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Santos
     └─ dob: 05/01/1930
     └─ patientSex: 
     └─ medicalRecordNo: MA230405053003
     └─ billingProvider: CHRISTOPHER JONCAS MD
     └─ npi: 1336136456
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I11.9', 'secondDiagnosis': 'M13.861', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:07:15] ✅    ✅ Patient identified: Maria Santos
[16:07:15] ✅    ✅ Patient name validation passed
[16:07:15] 🔄 
🔄 Step 3: Processing patient dates...
[16:07:15] [DOC: 9221696] ℹ️  DOB normalized: 05/01/1930
[16:07:15] [DOC: 9221696] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[16:07:15] [DOC: 9221696] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[16:07:15] [DOC: 9221696] ✅ Patient date processing completed successfully
[16:07:15] ✅    ✅ Date processing completed
[16:07:15] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Santos
     └─ dob: 05/01/1930
     └─ patientSex: 
     └─ medicalRecordNo: MA230405053003
     └─ billingProvider: CHRISTOPHER JONCAS MD
     └─ npi: 1336136456
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I11.9', 'secondDiagnosis': 'M13.861', 'thirdDiagnosis': 'E78.5'}]
[16:07:15] 🔄 
🔄 Step 4: Extracting order data...
[16:07:18] ℹ️  Order extraction - MRN: 'MA230405053003'
[16:07:18] ℹ️  Order extraction - Sex: ''
[16:07:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:07:18] ℹ️  Order extraction - Payer Source: ''
[16:07:18] ✅ Order data extraction completed successfully
[16:07:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:07:18] ℹ️  Using MRN from patient data: 'MA230405053003' over 'MA230405053003'
[16:07:18] ℹ️  Inferred sex as FEMALE from name: Maria
[16:07:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:07:18] ✅ Patient name cross-validation successful
[16:07:18] ✅    ✅ Data merged successfully
[16:07:19] ✅    ✅ Order data extracted and validated
[16:07:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:19] [DOC: 9221696] ✅ Patient found in local cache: Maria Santos, ID: 7eccab12-fbe5-4ad4-869c-e0763de0840a
[16:07:19] ✅    ✅ Existing patient found with ID: 7eccab12-fbe5-4ad4-869c-e0763de0840a
[16:07:19] 🔄 
🔄 Step 6: Pushing order to API...
[16:07:19] [DOC: 9221696] ℹ️  Pushing order via API for patient ID: 7eccab12-fbe5-4ad4-869c-e0763de0840a
[16:07:20] [DOC: 9221696] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14380"}
[16:07:20] ❌    ❌ Failed to push order
[16:07:20] 🔄 
🔄 Step 7: Writing to CSV...
[16:07:20] [DOC: 9221696] ℹ️  Calculated age: 95 from DOB: 05/01/1930
[16:07:20] [DOC: 9221696] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:07:20] [DOC: 9221696] ℹ️  Payer Source extracted: ''
[16:07:20] [DOC: 9221696] ℹ️  Diagnosis codes being written:
[16:07:20] [DOC: 9221696] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.9'
[16:07:20] [DOC: 9221696] ℹ️    - Latest_Episode_Seconddiagnosis: 'M13.861'
[16:07:20] [DOC: 9221696] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[16:07:20] [DOC: 9221696] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:07:20] [DOC: 9221696] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:07:20] [DOC: 9221696] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:07:20] [DOC: 9221696] ✅ Patient data written to CSV: Maria Santos | Sex: FEMALE | Age: 95 | Service: Skilled Nursing | Payer:  | MRN: MA230405053003
[16:07:20] ✅    ✅ Document 9221696 processed and saved successfully
[16:07:20] 🔄 
🔄 Step 8: Saving API details...
[16:07:20] [DOC: 9221696] ℹ️  API push details saved for document 9221696
[16:07:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221647                         ║
================================================================================
[16:07:20] ℹ️  Agency: AccentCare Fall River
[16:07:20] ℹ️  Date: 04/04/2025
[16:07:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:24] [DOC: 9221647] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[16:07:25] [DOC: 9221647] ✅ Text extracted using tesseract_ocr (1307 chars)
[16:07:25] ✅    ✅ Text extracted using tesseract_ocr (1298 chars)
[16:07:25] 🔄 
🔄 Step 2: Extracting patient data...
[16:07:28] ℹ️  AI extracted raw sex value: ''
[16:07:28] ℹ️  AI extracted service line: 'OT'
[16:07:28] ℹ️  AI extracted payer source: ''
[16:07:28] ℹ️  AI extracted diagnoses:
[16:07:28] ℹ️    - Diagnosis 1: ''
[16:07:28] ℹ️    - Diagnosis 2: ''
[16:07:28] ℹ️    - Diagnosis 3: ''
[16:07:28] ℹ️    - Diagnosis 4: ''
[16:07:28] ℹ️    - Diagnosis 5: ''
[16:07:28] ℹ️    - Diagnosis 6: ''
[16:07:28] ℹ️  Final extracted MRN: 'C0200231525501'
[16:07:28] ℹ️  Final extracted Sex: ''
[16:07:28] ℹ️  Final extracted Service Line: 'OT'
[16:07:28] ℹ️  Final extracted Payer Source: ''
[16:07:28] ✅ Patient data extraction completed successfully
[16:07:28] ✅    ✅ Patient data extracted successfully
[16:07:28] 📊 Patient Response
     └─ patientFName: KAREN
     └─ patientLName: AGUIAR
     └─ dob: 12/18/1970
     └─ patientSex: 
     └─ medicalRecordNo: C0200231525501
     └─ billingProvider: KARINE MAALOUF-KALESHIAN, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:28] ✅    ✅ Patient identified: KAREN AGUIAR
[16:07:28] ✅    ✅ Patient name validation passed
[16:07:28] 🔄 
🔄 Step 3: Processing patient dates...
[16:07:28] [DOC: 9221647] ℹ️  DOB normalized: 12/18/1970
[16:07:28] [DOC: 9221647] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[16:07:28] [DOC: 9221647] ℹ️  Episode endOfEpisode normalized: 02/25/2025
[16:07:28] [DOC: 9221647] ✅ Patient date processing completed successfully
[16:07:28] ✅    ✅ Date processing completed
[16:07:28] 📊 Processed Patient Data
     └─ patientFName: KAREN
     └─ patientLName: AGUIAR
     └─ dob: 12/18/1970
     └─ patientSex: 
     └─ medicalRecordNo: C0200231525501
     └─ billingProvider: KARINE MAALOUF-KALESHIAN, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:28] 🔄 
🔄 Step 4: Extracting order data...
[16:07:30] ℹ️  Order extraction - MRN: 'C0200231525501'
[16:07:30] ℹ️  Order extraction - Sex: ''
[16:07:30] ℹ️  Order extraction - Service Line: 'OT'
[16:07:30] ℹ️  Order extraction - Payer Source: ''
[16:07:30] ✅ Order data extraction completed successfully
[16:07:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:07:30] ℹ️  Using MRN from patient data: 'C0200231525501' over 'C0200231525501'
[16:07:30] ℹ️  Inferred sex as FEMALE from name: KAREN
[16:07:30] ℹ️  Service line consistent in both sources: 'OT'
[16:07:30] ✅ Patient name cross-validation successful
[16:07:30] ✅    ✅ Data merged successfully
[16:07:31] ✅    ✅ Order data extracted and validated
[16:07:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:54] [DOC: 9221647] ℹ️  Patient not found in cache or API: KAREN AGUIAR
[16:07:54] [DOC: 9221647] ℹ️  Patient not found, creating new patient via API...
[16:07:54] [DOC: 9221647] ℹ️  Creating patient via API: KAREN AGUIAR
[16:07:56] [DOC: 9221647] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:07:56] ❌    ❌ Failed to create patient
[16:07:56] [DOC: 9221647] ℹ️  API push details saved for document 9221647
================================================================================
║                        Processing Document ID: 9221643                         ║
================================================================================
[16:07:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:07:56] ℹ️  Date: 04/04/2025
[16:07:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:57] [DOC: 9221643] ✅ Text extracted using pdfplumber (1003 chars)
[16:07:57] ✅    ✅ Text extracted using pdfplumber (1003 chars)
[16:07:57] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:00] ℹ️  AI extracted raw sex value: 'F'
[16:08:00] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:08:00] ℹ️  AI extracted payer source: ''
[16:08:00] ℹ️  AI extracted diagnoses:
[16:08:00] ℹ️    - Diagnosis 1: ''
[16:08:00] ℹ️    - Diagnosis 2: ''
[16:08:00] ℹ️    - Diagnosis 3: ''
[16:08:00] ℹ️    - Diagnosis 4: ''
[16:08:00] ℹ️    - Diagnosis 5: ''
[16:08:00] ℹ️    - Diagnosis 6: ''
[16:08:00] ℹ️  Final extracted MRN: '3071654'
[16:08:00] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:00] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:08:00] ℹ️  Final extracted Payer Source: ''
[16:08:00] ✅ Patient data extraction completed successfully
[16:08:00] ✅    ✅ Patient data extracted successfully
[16:08:00] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:00] ✅    ✅ Patient identified: Tina Viera
[16:08:00] ✅    ✅ Patient name validation passed
[16:08:00] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:00] [DOC: 9221643] ℹ️  DOB normalized: 08/17/1964
[16:08:00] [DOC: 9221643] ✅ Patient date processing completed successfully
[16:08:00] ✅    ✅ Date processing completed
[16:08:00] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:00] 🔄 
🔄 Step 4: Extracting order data...
[16:08:02] ℹ️  Order extraction - MRN: '3071654'
[16:08:02] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:02] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:08:02] ℹ️  Order extraction - Payer Source: ''
[16:08:02] ✅ Order data extraction completed successfully
[16:08:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:02] ℹ️  Using MRN from patient data: '3071654' over '3071654'
[16:08:02] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:08:02] ✅ Patient name cross-validation successful
[16:08:02] ✅    ✅ Data merged successfully
[16:08:03] ✅    ✅ Order data extracted and validated
[16:08:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:09] [DOC: 9221643] ℹ️  Patient not found in cache or API: Tina Viera
[16:08:09] [DOC: 9221643] ℹ️  Patient not found, creating new patient via API...
[16:08:09] [DOC: 9221643] ℹ️  Creating patient via API: Tina Viera
[16:08:10] [DOC: 9221643] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:08:10] ❌    ❌ Failed to create patient
[16:08:10] [DOC: 9221643] ℹ️  API push details saved for document 9221643
================================================================================
║                        Processing Document ID: 9221642                         ║
================================================================================
[16:08:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:08:10] ℹ️  Date: 04/04/2025
[16:08:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:12] [DOC: 9221642] ✅ Text extracted using pdfplumber (1173 chars)
[16:08:12] ✅    ✅ Text extracted using pdfplumber (1173 chars)
[16:08:12] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:15] ℹ️  AI extracted raw sex value: 'M'
[16:08:15] ℹ️  AI extracted service line: 'Medical Social Work'
[16:08:15] ℹ️  AI extracted payer source: ''
[16:08:15] ℹ️  AI extracted diagnoses:
[16:08:15] ℹ️    - Diagnosis 1: ''
[16:08:15] ℹ️    - Diagnosis 2: ''
[16:08:15] ℹ️    - Diagnosis 3: ''
[16:08:15] ℹ️    - Diagnosis 4: ''
[16:08:15] ℹ️    - Diagnosis 5: ''
[16:08:15] ℹ️    - Diagnosis 6: ''
[16:08:15] ℹ️  Final extracted MRN: '2998670'
[16:08:15] ℹ️  Final extracted Sex: 'MALE'
[16:08:15] ℹ️  Final extracted Service Line: 'Medical Social Work'
[16:08:15] ℹ️  Final extracted Payer Source: ''
[16:08:15] ✅ Patient data extraction completed successfully
[16:08:15] ✅    ✅ Patient data extracted successfully
[16:08:15] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:15] ✅    ✅ Patient identified: Raymond Souza
[16:08:15] ✅    ✅ Patient name validation passed
[16:08:15] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:15] [DOC: 9221642] ℹ️  DOB normalized: 06/18/1927
[16:08:15] [DOC: 9221642] ✅ Patient date processing completed successfully
[16:08:15] ✅    ✅ Date processing completed
[16:08:15] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:15] 🔄 
🔄 Step 4: Extracting order data...
[16:08:17] ℹ️  Order extraction - MRN: '2998670'
[16:08:17] ℹ️  Order extraction - Sex: 'MALE'
[16:08:17] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[16:08:17] ℹ️  Order extraction - Payer Source: ''
[16:08:17] ✅ Order data extraction completed successfully
[16:08:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:17] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[16:08:17] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[16:08:17] ✅ Patient name cross-validation successful
[16:08:17] ✅    ✅ Data merged successfully
[16:08:18] ✅    ✅ Order data extracted and validated
[16:08:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:18] [DOC: 9221642] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:08:18] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:08:18] 🔄 
🔄 Step 6: Pushing order to API...
[16:08:18] [DOC: 9221642] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:08:20] [DOC: 9221642] ❌ Order push failed with status 201: {"id":"24c80856-e8f2-4b1f-9842-bb868bd53095","orderWAVId":"ORD20063","orderNo":"1078288","orderDate":"04/03/2025","startOfCare":"04/04/2025","episodeStartDate":"04/04/2025","episodeEndDate":"06/28/2025","documentID":"9221642","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/04/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/04/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:08:20] ❌    ❌ Failed to push order
[16:08:20] 🔄 
🔄 Step 7: Writing to CSV...
[16:08:20] [DOC: 9221642] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[16:08:20] [DOC: 9221642] ℹ️  Service Line extracted: 'Medical Social Work'
[16:08:20] [DOC: 9221642] ℹ️  Payer Source extracted: ''
[16:08:20] [DOC: 9221642] ℹ️  Diagnosis codes being written:
[16:08:20] [DOC: 9221642] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:08:20] [DOC: 9221642] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:08:20] [DOC: 9221642] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:08:20] [DOC: 9221642] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:08:20] [DOC: 9221642] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:08:20] [DOC: 9221642] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:08:20] [DOC: 9221642] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: Medical Social Work | Payer:  | MRN: 2998670
[16:08:20] ✅    ✅ Document 9221642 processed and saved successfully
[16:08:20] 🔄 
🔄 Step 8: Saving API details...
[16:08:20] [DOC: 9221642] ℹ️  API push details saved for document 9221642
[16:08:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221639                         ║
================================================================================
[16:08:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:08:20] ℹ️  Date: 04/04/2025
[16:08:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:22] [DOC: 9221639] ✅ Text extracted using pdfplumber (1110 chars)
[16:08:22] ✅    ✅ Text extracted using pdfplumber (1110 chars)
[16:08:22] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:25] ℹ️  AI extracted raw sex value: 'F'
[16:08:25] ℹ️  AI extracted service line: 'Physical Therapy'
[16:08:25] ℹ️  AI extracted payer source: ''
[16:08:25] ℹ️  AI extracted diagnoses:
[16:08:25] ℹ️    - Diagnosis 1: 'CHF'
[16:08:25] ℹ️    - Diagnosis 2: 'PAF'
[16:08:25] ℹ️    - Diagnosis 3: 'LLE cellulitis'
[16:08:25] ℹ️    - Diagnosis 4: ''
[16:08:25] ℹ️    - Diagnosis 5: ''
[16:08:25] ℹ️    - Diagnosis 6: ''
[16:08:25] ℹ️  Final extracted MRN: '2936720'
[16:08:25] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:25] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:08:25] ℹ️  Final extracted Payer Source: ''
[16:08:25] ✅ Patient data extraction completed successfully
[16:08:25] ✅    ✅ Patient data extracted successfully
[16:08:25] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'PAF', 'thirdDiagnosis': 'LLE cellulitis', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:25] ✅    ✅ Patient identified: Stella Saint
[16:08:25] ✅    ✅ Patient name validation passed
[16:08:25] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:25] [DOC: 9221639] ℹ️  DOB normalized: 07/02/1928
[16:08:25] [DOC: 9221639] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[16:08:25] [DOC: 9221639] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[16:08:25] [DOC: 9221639] ✅ Patient date processing completed successfully
[16:08:25] ✅    ✅ Date processing completed
[16:08:25] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'PAF', 'thirdDiagnosis': 'LLE cellulitis', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:25] 🔄 
🔄 Step 4: Extracting order data...
[16:08:27] ℹ️  Order extraction - MRN: '2936720'
[16:08:27] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:27] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:08:27] ℹ️  Order extraction - Payer Source: ''
[16:08:27] ✅ Order data extraction completed successfully
[16:08:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:27] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[16:08:27] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:08:27] ✅ Patient name cross-validation successful
[16:08:27] ✅    ✅ Data merged successfully
[16:08:28] ✅    ✅ Order data extracted and validated
[16:08:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:28] [DOC: 9221639] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[16:08:28] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[16:08:28] 🔄 
🔄 Step 6: Pushing order to API...
[16:08:28] [DOC: 9221639] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[16:08:30] [DOC: 9221639] ❌ Order push failed with status 201: {"id":"334eeb15-e842-42a1-87b3-912c03556ac6","orderWAVId":"ORD20064","orderNo":"1078326","orderDate":"04/03/2025","startOfCare":"04/06/2025","episodeStartDate":"04/06/2025","episodeEndDate":"04/23/2025","documentID":"9221639","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"04/04/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:08:30] ❌    ❌ Failed to push order
[16:08:30] 🔄 
🔄 Step 7: Writing to CSV...
[16:08:30] [DOC: 9221639] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[16:08:30] [DOC: 9221639] ℹ️  Service Line extracted: 'Physical Therapy'
[16:08:30] [DOC: 9221639] ℹ️  Payer Source extracted: ''
[16:08:30] [DOC: 9221639] ℹ️  Diagnosis codes being written:
[16:08:30] [DOC: 9221639] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[16:08:30] [DOC: 9221639] ℹ️    - Latest_Episode_Seconddiagnosis: 'PAF'
[16:08:30] [DOC: 9221639] ℹ️    - Latest_Episode_Thirddiagnosis: 'LLE cellulitis'
[16:08:30] [DOC: 9221639] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:08:30] [DOC: 9221639] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:08:30] [DOC: 9221639] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:08:30] [DOC: 9221639] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Physical Therapy | Payer:  | MRN: 2936720
[16:08:30] ✅    ✅ Document 9221639 processed and saved successfully
[16:08:30] 🔄 
🔄 Step 8: Saving API details...
[16:08:30] [DOC: 9221639] ℹ️  API push details saved for document 9221639
[16:08:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221637                         ║
================================================================================
[16:08:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:08:30] ℹ️  Date: 04/04/2025
[16:08:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:32] [DOC: 9221637] ✅ Text extracted using pdfplumber (1220 chars)
[16:08:32] ✅    ✅ Text extracted using pdfplumber (1220 chars)
[16:08:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:34] ℹ️  AI extracted raw sex value: 'F'
[16:08:34] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:08:34] ℹ️  AI extracted payer source: ''
[16:08:34] ℹ️  AI extracted diagnoses:
[16:08:34] ℹ️    - Diagnosis 1: ''
[16:08:34] ℹ️    - Diagnosis 2: ''
[16:08:34] ℹ️    - Diagnosis 3: ''
[16:08:34] ℹ️    - Diagnosis 4: ''
[16:08:34] ℹ️    - Diagnosis 5: ''
[16:08:34] ℹ️    - Diagnosis 6: ''
[16:08:34] ℹ️  Final extracted MRN: '2115099'
[16:08:34] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:34] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:08:34] ℹ️  Final extracted Payer Source: ''
[16:08:34] ✅ Patient data extraction completed successfully
[16:08:34] ✅    ✅ Patient data extracted successfully
[16:08:34] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Pegg
     └─ dob: 09/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2115099
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:34] ✅    ✅ Patient identified: Jean Pegg
[16:08:34] ✅    ✅ Patient name validation passed
[16:08:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:34] [DOC: 9221637] ℹ️  DOB normalized: 09/26/1940
[16:08:34] [DOC: 9221637] ✅ Patient date processing completed successfully
[16:08:34] ✅    ✅ Date processing completed
[16:08:34] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Pegg
     └─ dob: 09/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2115099
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:34] 🔄 
🔄 Step 4: Extracting order data...
[16:08:37] ℹ️  Order extraction - MRN: '2115099'
[16:08:37] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:37] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:08:37] ℹ️  Order extraction - Payer Source: ''
[16:08:37] ✅ Order data extraction completed successfully
[16:08:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:37] ℹ️  Using MRN from patient data: '2115099' over '2115099'
[16:08:37] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:08:37] ✅ Patient name cross-validation successful
[16:08:37] ✅    ✅ Data merged successfully
[16:08:38] ✅    ✅ Order data extracted and validated
[16:08:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:04] [DOC: 9221637] ℹ️  Patient not found in cache or API: Jean Pegg
[16:09:04] [DOC: 9221637] ℹ️  Patient not found, creating new patient via API...
[16:09:04] [DOC: 9221637] ℹ️  Creating patient via API: Jean Pegg
[16:09:06] [DOC: 9221637] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:09:06] ❌    ❌ Failed to create patient
[16:09:06] [DOC: 9221637] ℹ️  API push details saved for document 9221637
================================================================================
║                        Processing Document ID: 9221636                         ║
================================================================================
[16:09:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:09:06] ℹ️  Date: 04/04/2025
[16:09:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:07] [DOC: 9221636] ✅ Text extracted using pdfplumber (1016 chars)
[16:09:07] ✅    ✅ Text extracted using pdfplumber (1016 chars)
[16:09:07] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:10] ℹ️  AI extracted raw sex value: 'F'
[16:09:10] ℹ️  AI extracted service line: 'Speech Language Pathology'
[16:09:10] ℹ️  AI extracted payer source: ''
[16:09:10] ℹ️  AI extracted diagnoses:
[16:09:10] ℹ️    - Diagnosis 1: ''
[16:09:10] ℹ️    - Diagnosis 2: ''
[16:09:10] ℹ️    - Diagnosis 3: ''
[16:09:10] ℹ️    - Diagnosis 4: ''
[16:09:10] ℹ️    - Diagnosis 5: ''
[16:09:10] ℹ️    - Diagnosis 6: ''
[16:09:10] ℹ️  Final extracted MRN: '2795248'
[16:09:10] ℹ️  Final extracted Sex: 'FEMALE'
[16:09:10] ℹ️  Final extracted Service Line: 'Speech Language Pathology'
[16:09:10] ℹ️  Final extracted Payer Source: ''
[16:09:10] ✅ Patient data extraction completed successfully
[16:09:10] ✅    ✅ Patient data extracted successfully
[16:09:10] 📊 Patient Response
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:10] ✅    ✅ Patient identified: Meryl Novek
[16:09:10] ✅    ✅ Patient name validation passed
[16:09:10] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:10] [DOC: 9221636] ℹ️  DOB normalized: 02/08/1941
[16:09:10] [DOC: 9221636] ✅ Patient date processing completed successfully
[16:09:10] ✅    ✅ Date processing completed
[16:09:10] 📊 Processed Patient Data
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:10] 🔄 
🔄 Step 4: Extracting order data...
[16:09:12] ℹ️  Order extraction - MRN: '2795248'
[16:09:12] ℹ️  Order extraction - Sex: 'FEMALE'
[16:09:12] ℹ️  Order extraction - Service Line: 'Speech Language Pathology'
[16:09:12] ℹ️  Order extraction - Payer Source: ''
[16:09:12] ✅ Order data extraction completed successfully
[16:09:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:12] ℹ️  Using MRN from patient data: '2795248' over '2795248'
[16:09:12] ℹ️  Service line consistent in both sources: 'Speech Language Pathology'
[16:09:12] ✅ Patient name cross-validation successful
[16:09:12] ✅    ✅ Data merged successfully
[16:09:14] ✅    ✅ Order data extracted and validated
[16:09:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:19] [DOC: 9221636] ℹ️  Patient not found in cache or API: Meryl Novek
[16:09:19] [DOC: 9221636] ℹ️  Patient not found, creating new patient via API...
[16:09:19] [DOC: 9221636] ℹ️  Creating patient via API: Meryl Novek
[16:09:20] [DOC: 9221636] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:09:20] ❌    ❌ Failed to create patient
[16:09:20] [DOC: 9221636] ℹ️  API push details saved for document 9221636
================================================================================
║                        Processing Document ID: 9221635                         ║
================================================================================
[16:09:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:09:20] ℹ️  Date: 04/04/2025
[16:09:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:21] [DOC: 9221635] ✅ Text extracted using pdfplumber (2814 chars)
[16:09:21] ✅    ✅ Text extracted using pdfplumber (2814 chars)
[16:09:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:24] ℹ️  AI extracted raw sex value: 'F'
[16:09:24] ℹ️  AI extracted service line: 'Medical Social Work'
[16:09:24] ℹ️  AI extracted payer source: ''
[16:09:24] ℹ️  AI extracted diagnoses:
[16:09:24] ℹ️    - Diagnosis 1: ''
[16:09:24] ℹ️    - Diagnosis 2: ''
[16:09:24] ℹ️    - Diagnosis 3: ''
[16:09:24] ℹ️    - Diagnosis 4: ''
[16:09:24] ℹ️    - Diagnosis 5: ''
[16:09:24] ℹ️    - Diagnosis 6: ''
[16:09:24] ℹ️  Final extracted MRN: '3495983'
[16:09:24] ℹ️  Final extracted Sex: 'FEMALE'
[16:09:24] ℹ️  Final extracted Service Line: 'Medical Social Work'
[16:09:24] ℹ️  Final extracted Payer Source: ''
[16:09:24] ✅ Patient data extraction completed successfully
[16:09:24] ✅    ✅ Patient data extracted successfully
[16:09:24] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: McGoldrick
     └─ dob: 10/27/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3495983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:24] ✅    ✅ Patient identified: Janice McGoldrick
[16:09:24] ✅    ✅ Patient name validation passed
[16:09:24] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:24] [DOC: 9221635] ℹ️  DOB normalized: 10/27/1931
[16:09:24] [DOC: 9221635] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[16:09:24] [DOC: 9221635] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[16:09:24] [DOC: 9221635] ✅ Patient date processing completed successfully
[16:09:24] ✅    ✅ Date processing completed
[16:09:24] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: McGoldrick
     └─ dob: 10/27/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3495983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:24] 🔄 
🔄 Step 4: Extracting order data...
[16:09:27] ℹ️  Order extraction - MRN: '3495983'
[16:09:27] ℹ️  Order extraction - Sex: 'FEMALE'
[16:09:27] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[16:09:27] ℹ️  Order extraction - Payer Source: ''
[16:09:27] ✅ Order data extraction completed successfully
[16:09:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:27] ℹ️  Using MRN from patient data: '3495983' over '3495983'
[16:09:27] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[16:09:27] ✅ Patient name cross-validation successful
[16:09:27] ✅    ✅ Data merged successfully
[16:09:28] ✅    ✅ Order data extracted and validated
[16:09:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:28] [DOC: 9221635] ✅ Patient found in local cache: Janice McGoldrick, ID: aa0feeb0-ee9f-4c3e-a1da-571cf80975b2
[16:09:28] ✅    ✅ Existing patient found with ID: aa0feeb0-ee9f-4c3e-a1da-571cf80975b2
[16:09:28] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:28] [DOC: 9221635] ℹ️  Pushing order via API for patient ID: aa0feeb0-ee9f-4c3e-a1da-571cf80975b2
[16:09:29] [DOC: 9221635] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13340"}
[16:09:29] ❌    ❌ Failed to push order
[16:09:29] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:29] [DOC: 9221635] ℹ️  Calculated age: 93 from DOB: 10/27/1931
[16:09:29] [DOC: 9221635] ℹ️  Service Line extracted: 'Medical Social Work'
[16:09:29] [DOC: 9221635] ℹ️  Payer Source extracted: ''
[16:09:29] [DOC: 9221635] ℹ️  Diagnosis codes being written:
[16:09:29] [DOC: 9221635] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:29] [DOC: 9221635] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:29] [DOC: 9221635] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:29] [DOC: 9221635] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:29] [DOC: 9221635] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:29] [DOC: 9221635] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:29] [DOC: 9221635] ✅ Patient data written to CSV: Janice McGoldrick | Sex: FEMALE | Age: 93 | Service: Medical Social Work | Payer:  | MRN: 3495983
[16:09:29] ✅    ✅ Document 9221635 processed and saved successfully
[16:09:29] 🔄 
🔄 Step 8: Saving API details...
[16:09:29] [DOC: 9221635] ℹ️  API push details saved for document 9221635
[16:09:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221633                         ║
================================================================================
[16:09:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:09:29] ℹ️  Date: 04/04/2025
[16:09:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:31] [DOC: 9221633] ✅ Text extracted using pdfplumber (1099 chars)
[16:09:31] ✅    ✅ Text extracted using pdfplumber (1099 chars)
[16:09:31] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:34] ℹ️  AI extracted raw sex value: 'M'
[16:09:34] ℹ️  AI extracted service line: 'Medical Social Work'
[16:09:34] ℹ️  AI extracted payer source: ''
[16:09:34] ℹ️  AI extracted diagnoses:
[16:09:34] ℹ️    - Diagnosis 1: ''
[16:09:34] ℹ️    - Diagnosis 2: ''
[16:09:34] ℹ️    - Diagnosis 3: ''
[16:09:34] ℹ️    - Diagnosis 4: ''
[16:09:34] ℹ️    - Diagnosis 5: ''
[16:09:34] ℹ️    - Diagnosis 6: ''
[16:09:34] ℹ️  Final extracted MRN: '3170225'
[16:09:34] ℹ️  Final extracted Sex: 'MALE'
[16:09:34] ℹ️  Final extracted Service Line: 'Medical Social Work'
[16:09:34] ℹ️  Final extracted Payer Source: ''
[16:09:34] ✅ Patient data extraction completed successfully
[16:09:34] ✅    ✅ Patient data extracted successfully
[16:09:34] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:34] ✅    ✅ Patient identified: Donald Maceachern
[16:09:34] ✅    ✅ Patient name validation passed
[16:09:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:34] [DOC: 9221633] ℹ️  DOB normalized: 11/18/1939
[16:09:34] [DOC: 9221633] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[16:09:34] [DOC: 9221633] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[16:09:34] [DOC: 9221633] ✅ Patient date processing completed successfully
[16:09:34] ✅    ✅ Date processing completed
[16:09:34] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:34] 🔄 
🔄 Step 4: Extracting order data...
[16:09:36] ℹ️  Order extraction - MRN: '3170225'
[16:09:36] ℹ️  Order extraction - Sex: 'MALE'
[16:09:36] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[16:09:36] ℹ️  Order extraction - Payer Source: ''
[16:09:36] ✅ Order data extraction completed successfully
[16:09:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:36] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[16:09:36] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[16:09:36] ✅ Patient name cross-validation successful
[16:09:36] ✅    ✅ Data merged successfully
[16:09:38] ✅    ✅ Order data extracted and validated
[16:09:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:38] [DOC: 9221633] ✅ Patient found in local cache: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:09:38] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:09:38] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:38] [DOC: 9221633] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:09:39] [DOC: 9221633] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13303"}
[16:09:39] ❌    ❌ Failed to push order
[16:09:39] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:39] [DOC: 9221633] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[16:09:39] [DOC: 9221633] ℹ️  Service Line extracted: 'Medical Social Work'
[16:09:39] [DOC: 9221633] ℹ️  Payer Source extracted: ''
[16:09:39] [DOC: 9221633] ℹ️  Diagnosis codes being written:
[16:09:39] [DOC: 9221633] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:39] [DOC: 9221633] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:39] [DOC: 9221633] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:39] [DOC: 9221633] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:39] [DOC: 9221633] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:39] [DOC: 9221633] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:39] [DOC: 9221633] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service: Medical Social Work | Payer:  | MRN: 3170225
[16:09:39] ✅    ✅ Document 9221633 processed and saved successfully
[16:09:39] 🔄 
🔄 Step 8: Saving API details...
[16:09:39] [DOC: 9221633] ℹ️  API push details saved for document 9221633
[16:09:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221629                         ║
================================================================================
[16:09:39] ℹ️  Agency: Nizhoni Health-Fall River
[16:09:39] ℹ️  Date: 04/04/2025
[16:09:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:42] [DOC: 9221629] ✅ Text extracted using pdfplumber (12292 chars)
[16:09:42] ✅    ✅ Text extracted using pdfplumber (12292 chars)
[16:09:42] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:45] ℹ️  AI extracted raw sex value: 'F'
[16:09:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:09:45] ℹ️  AI extracted payer source: 'None'
[16:09:45] ℹ️  AI extracted diagnoses:
[16:09:45] ℹ️    - Diagnosis 1: 'F25.0'
[16:09:45] ℹ️    - Diagnosis 2: 'M17.9'
[16:09:45] ℹ️    - Diagnosis 3: 'E78.5'
[16:09:45] ℹ️    - Diagnosis 4: 'G47.00'
[16:09:45] ℹ️    - Diagnosis 5: 'G89.29'
[16:09:45] ℹ️    - Diagnosis 6: 'F17.200'
[16:09:45] ℹ️  Final extracted MRN: '23511'
[16:09:45] ℹ️  Final extracted Sex: 'FEMALE'
[16:09:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:09:45] ℹ️  Final extracted Payer Source: ''
[16:09:45] ✅ Patient data extraction completed successfully
[16:09:45] ✅    ✅ Patient data extracted successfully
[16:09:45] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Trayner
     └─ dob: 12/04/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 23511
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nizhoni Health Systems DBA Innovive Health
     └─ address: 560 Cottage St Apt 2S
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/18/2018', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'M17.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'F17.200'}]
[16:09:45] ✅    ✅ Patient identified: Kim Trayner
[16:09:45] ✅    ✅ Patient name validation passed
[16:09:45] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:45] [DOC: 9221629] ℹ️  DOB normalized: 12/04/1964
[16:09:45] [DOC: 9221629] ℹ️  Episode startOfCare normalized: 06/18/2018
[16:09:45] [DOC: 9221629] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:09:45] [DOC: 9221629] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:09:45] [DOC: 9221629] ✅ Patient date processing completed successfully
[16:09:45] ✅    ✅ Date processing completed
[16:09:45] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Trayner
     └─ dob: 12/04/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 23511
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nizhoni Health Systems DBA Innovive Health
     └─ address: 560 Cottage St Apt 2S
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/18/2018', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'M17.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'F17.200'}]
[16:09:45] 🔄 
🔄 Step 4: Extracting order data...
[16:09:48] ℹ️  Order extraction - MRN: '23511'
[16:09:48] ℹ️  Order extraction - Sex: 'FEMALE'
[16:09:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:09:48] ℹ️  Order extraction - Payer Source: ''
[16:09:48] ✅ Order data extraction completed successfully
[16:09:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:48] ℹ️  Using MRN from patient data: '23511' over '23511'
[16:09:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:09:48] ✅ Patient name cross-validation successful
[16:09:48] ✅    ✅ Data merged successfully
[16:09:49] ✅    ✅ Order data extracted and validated
[16:09:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:10:20] [DOC: 9221629] ✅ Patient exists in API: Kim Trayner, ID: 643750b1-8cd7-41b8-87c8-3dba6dc4fec3
[16:10:20] ✅    ✅ Existing patient found with ID: 643750b1-8cd7-41b8-87c8-3dba6dc4fec3
[16:10:20] 🔄 
🔄 Step 6: Pushing order to API...
[16:10:20] [DOC: 9221629] ℹ️  Pushing order via API for patient ID: 643750b1-8cd7-41b8-87c8-3dba6dc4fec3
[16:10:22] [DOC: 9221629] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14360"}
[16:10:22] ❌    ❌ Failed to push order
[16:10:22] 🔄 
🔄 Step 7: Writing to CSV...
[16:10:22] [DOC: 9221629] ℹ️  Calculated age: 60 from DOB: 12/04/1964
[16:10:22] [DOC: 9221629] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:10:22] [DOC: 9221629] ℹ️  Payer Source extracted: ''
[16:10:22] [DOC: 9221629] ℹ️  Diagnosis codes being written:
[16:10:22] [DOC: 9221629] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[16:10:22] [DOC: 9221629] ℹ️    - Latest_Episode_Seconddiagnosis: 'M17.9'
[16:10:22] [DOC: 9221629] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[16:10:22] [DOC: 9221629] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G47.00'
[16:10:22] [DOC: 9221629] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G89.29'
[16:10:22] [DOC: 9221629] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F17.200'
[16:10:22] [DOC: 9221629] ✅ Patient data written to CSV: Kim Trayner | Sex: FEMALE | Age: 60 | Service: Skilled Nursing | Payer:  | MRN: 23511
[16:10:22] ✅    ✅ Document 9221629 processed and saved successfully
[16:10:22] 🔄 
🔄 Step 8: Saving API details...
[16:10:22] [DOC: 9221629] ℹ️  API push details saved for document 9221629
[16:10:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9202994                         ║
================================================================================
[16:10:22] ℹ️  Agency: Brigham Home Care Services.Inc
[16:10:22] ℹ️  Date: 04/03/2025
[16:10:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:10:24] [DOC: 9202994] ✅ Text extracted using pdfplumber (1722 chars)
[16:10:24] ✅    ✅ Text extracted using pdfplumber (1722 chars)
[16:10:24] 🔄 
🔄 Step 2: Extracting patient data...
[16:10:26] ℹ️  AI extracted raw sex value: 'M'
[16:10:26] ℹ️  AI extracted service line: 'Nursing'
[16:10:26] ℹ️  AI extracted payer source: ''
[16:10:26] ℹ️  AI extracted diagnoses:
[16:10:26] ℹ️    - Diagnosis 1: 'None'
[16:10:26] ℹ️    - Diagnosis 2: 'None'
[16:10:26] ℹ️    - Diagnosis 3: 'None'
[16:10:26] ℹ️    - Diagnosis 4: 'None'
[16:10:26] ℹ️    - Diagnosis 5: 'None'
[16:10:26] ℹ️    - Diagnosis 6: 'None'
[16:10:26] ℹ️  Final extracted MRN: '3757'
[16:10:26] ℹ️  Final extracted Sex: 'MALE'
[16:10:26] ℹ️  Final extracted Service Line: 'Nursing'
[16:10:26] ℹ️  Final extracted Payer Source: ''
[16:10:26] ✅ Patient data extraction completed successfully
[16:10:26] ✅    ✅ Patient data extracted successfully
[16:10:26] 📊 Patient Response
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc.
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:10:26] ✅    ✅ Patient identified: RYAN MENDONCA
[16:10:26] ✅    ✅ Patient name validation passed
[16:10:26] 🔄 
🔄 Step 3: Processing patient dates...
[16:10:26] [DOC: 9202994] ℹ️  DOB normalized: 04/23/1980
[16:10:26] [DOC: 9202994] ℹ️  Episode startOfEpisode normalized: 01/11/2025
[16:10:26] [DOC: 9202994] ℹ️  Episode endOfEpisode normalized: 03/11/2025
[16:10:26] [DOC: 9202994] ✅ Patient date processing completed successfully
[16:10:26] ✅    ✅ Date processing completed
[16:10:26] 📊 Processed Patient Data
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc.
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/11/2025'}]
[16:10:26] 🔄 
🔄 Step 4: Extracting order data...
[16:10:29] ℹ️  Order extraction - MRN: '3757'
[16:10:29] ℹ️  Order extraction - Sex: 'MALE'
[16:10:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:10:29] ℹ️  Order extraction - Payer Source: ''
[16:10:29] ✅ Order data extraction completed successfully
[16:10:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:10:29] ℹ️  Using MRN from patient data: '3757' over '3757'
[16:10:29] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[16:10:29] ✅ Patient name cross-validation successful
[16:10:29] ✅    ✅ Data merged successfully
[16:10:30] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[16:10:30] [DOC: 9202994] ℹ️  API push details saved for document 9202994
================================================================================
║                        Processing Document ID: 9203009                         ║
================================================================================
[16:10:30] ℹ️  Agency: Brigham Home Care Services.Inc
[16:10:30] ℹ️  Date: 04/03/2025
[16:10:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:10:37] [DOC: 9203009] ✅ Text extracted using pdfplumber (22024 chars)
[16:10:37] ✅    ✅ Text extracted using pdfplumber (22024 chars)
[16:10:37] 🔄 
🔄 Step 2: Extracting patient data...
[16:10:41] ℹ️  AI extracted raw sex value: 'M'
[16:10:41] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Home Health Aide, Occupational Therapy'
[16:10:41] ℹ️  AI extracted payer source: ''
[16:10:41] ℹ️  AI extracted diagnoses:
[16:10:41] ℹ️    - Diagnosis 1: 'E11.22'
[16:10:41] ℹ️    - Diagnosis 2: 'N18.6'
[16:10:41] ℹ️    - Diagnosis 3: 'I10'
[16:10:41] ℹ️    - Diagnosis 4: 'K21.9'
[16:10:41] ℹ️    - Diagnosis 5: 'L97.529'
[16:10:41] ℹ️    - Diagnosis 6: 'E66.8'
[16:10:41] ℹ️  Final extracted MRN: '3757'
[16:10:41] ℹ️  Final extracted Sex: 'MALE'
[16:10:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Home Health Aide, Occupational Therapy'
[16:10:41] ℹ️  Final extracted Payer Source: ''
[16:10:41] ✅ Patient data extraction completed successfully
[16:10:41] ✅    ✅ Patient data extracted successfully
[16:10:41] 📊 Patient Response
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Brigham Home Care Services, Inc
     └─ npi: 227605
     └─ physicianNPI: 1437668241
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343-1171
     └─ email: 
     └─ phoneNumber: 5088570627
     └─ serviceLine: Skilled Nursing, Physical Therapy, Home Health Aide, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/26/2022', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'N18.6', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'L97.529', 'sixthDiagnosis': 'E66.8'}]
[16:10:41] ✅    ✅ Patient identified: RYAN MENDONCA
[16:10:41] ✅    ✅ Patient name validation passed
[16:10:41] 🔄 
🔄 Step 3: Processing patient dates...
[16:10:41] [DOC: 9203009] ℹ️  DOB normalized: 04/23/1980
[16:10:41] [DOC: 9203009] ℹ️  Episode startOfCare normalized: 07/26/2022
[16:10:41] [DOC: 9203009] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[16:10:41] [DOC: 9203009] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[16:10:41] [DOC: 9203009] ✅ Patient date processing completed successfully
[16:10:41] ✅    ✅ Date processing completed
[16:10:41] 📊 Processed Patient Data
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Brigham Home Care Services, Inc
     └─ npi: 227605
     └─ physicianNPI: 1437668241
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343-1171
     └─ email: 
     └─ phoneNumber: 5088570627
     └─ serviceLine: Skilled Nursing, Physical Therapy, Home Health Aide, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/26/2022', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'N18.6', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'L97.529', 'sixthDiagnosis': 'E66.8'}]
[16:10:41] 🔄 
🔄 Step 4: Extracting order data...
[16:10:44] ℹ️  Order extraction - MRN: '3757'
[16:10:44] ℹ️  Order extraction - Sex: 'MALE'
[16:10:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Home Health Aide, Occupational Therapy'
[16:10:44] ℹ️  Order extraction - Payer Source: ''
[16:10:44] ✅ Order data extraction completed successfully
[16:10:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:10:44] ℹ️  Using MRN from patient data: '3757' over '3757'
[16:10:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Home Health Aide, Occupational Therapy'
[16:10:44] ✅ Patient name cross-validation successful
[16:10:44] ✅    ✅ Data merged successfully
[16:10:46] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[16:10:46] [DOC: 9203009] ℹ️  API push details saved for document 9203009
================================================================================
║                        Processing Document ID: 9221037                         ║
================================================================================
[16:10:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:10:46] ℹ️  Date: 04/03/2025
[16:10:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:10:50] [DOC: 9221037] ✅ Text extracted using pdfplumber (10667 chars)
[16:10:50] ✅    ✅ Text extracted using pdfplumber (10667 chars)
[16:10:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:10:53] ℹ️  AI extracted raw sex value: 'F'
[16:10:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:10:53] ℹ️  AI extracted payer source: 'Medicare'
[16:10:53] ℹ️  AI extracted diagnoses:
[16:10:53] ℹ️    - Diagnosis 1: 'F32.3'
[16:10:53] ℹ️    - Diagnosis 2: 'E11.9'
[16:10:53] ℹ️    - Diagnosis 3: 'F06.4'
[16:10:53] ℹ️    - Diagnosis 4: 'I10'
[16:10:53] ℹ️    - Diagnosis 5: 'F20.9'
[16:10:53] ℹ️    - Diagnosis 6: 'E66.9'
[16:10:53] ℹ️  Final extracted MRN: '101000978'
[16:10:53] ℹ️  Final extracted Sex: 'FEMALE'
[16:10:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:10:53] ℹ️  Final extracted Payer Source: 'Medicare'
[16:10:53] ✅ Patient data extraction completed successfully
[16:10:53] ✅    ✅ Patient data extracted successfully
[16:10:53] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Debarros
     └─ dob: 11/29/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101000978
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 120 Crossroads Dr
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 961-9778
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/22/2019', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'F32.3', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F06.4', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F20.9', 'sixthDiagnosis': 'E66.9'}]
[16:10:53] ✅    ✅ Patient identified: Maria Debarros
[16:10:53] ✅    ✅ Patient name validation passed
[16:10:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:10:53] [DOC: 9221037] ℹ️  DOB normalized: 11/29/1941
[16:10:53] [DOC: 9221037] ℹ️  Episode startOfCare normalized: 08/22/2019
[16:10:53] [DOC: 9221037] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[16:10:53] [DOC: 9221037] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[16:10:53] [DOC: 9221037] ✅ Patient date processing completed successfully
[16:10:53] ✅    ✅ Date processing completed
[16:10:53] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Debarros
     └─ dob: 11/29/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101000978
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 120 Crossroads Dr
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 961-9778
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/22/2019', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'F32.3', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F06.4', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F20.9', 'sixthDiagnosis': 'E66.9'}]
[16:10:53] 🔄 
🔄 Step 4: Extracting order data...
[16:10:56] ℹ️  Order extraction - MRN: '101000978'
[16:10:56] ℹ️  Order extraction - Sex: 'FEMALE'
[16:10:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:10:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:10:56] ✅ Order data extraction completed successfully
[16:10:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:10:56] ℹ️  Using MRN from patient data: '101000978' over '101000978'
[16:10:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:10:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:10:56] ✅ Patient name cross-validation successful
[16:10:56] ✅    ✅ Data merged successfully
[16:10:57] ✅    ✅ Order data extracted and validated
[16:10:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:11:20] [DOC: 9221037] ℹ️  Patient not found in cache or API: Maria Debarros
[16:11:20] [DOC: 9221037] ℹ️  Patient not found, creating new patient via API...
[16:11:20] [DOC: 9221037] ℹ️  Creating patient via API: Maria Debarros
[16:11:22] [DOC: 9221037] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:11:22] ❌    ❌ Failed to create patient
[16:11:22] [DOC: 9221037] ℹ️  API push details saved for document 9221037
================================================================================
║                        Processing Document ID: 9221028                         ║
================================================================================
[16:11:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:11:22] ℹ️  Date: 04/03/2025
[16:11:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:11:25] [DOC: 9221028] ✅ Text extracted using pdfplumber (19869 chars)
[16:11:25] ✅    ✅ Text extracted using pdfplumber (19869 chars)
[16:11:25] 🔄 
🔄 Step 2: Extracting patient data...
[16:11:28] ℹ️  AI extracted raw sex value: 'M'
[16:11:28] ℹ️  AI extracted service line: 'PT'
[16:11:28] ℹ️  AI extracted payer source: ''
[16:11:28] ℹ️  AI extracted diagnoses:
[16:11:28] ℹ️    - Diagnosis 1: 'J11.1'
[16:11:28] ℹ️    - Diagnosis 2: 'J18.9'
[16:11:28] ℹ️    - Diagnosis 3: 'J44.1'
[16:11:28] ℹ️    - Diagnosis 4: 'I48.9'
[16:11:28] ℹ️    - Diagnosis 5: 'I69.3'
[16:11:28] ℹ️    - Diagnosis 6: 'U07.1'
[16:11:28] ℹ️  Final extracted MRN: '100999559'
[16:11:28] ℹ️  Final extracted Sex: 'MALE'
[16:11:28] ℹ️  Final extracted Service Line: 'PT'
[16:11:28] ℹ️  Final extracted Payer Source: ''
[16:11:28] ✅ Patient data extraction completed successfully
[16:11:28] ✅    ✅ Patient data extracted successfully
[16:11:28] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': None, 'firstDiagnosis': 'J11.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'I48.9', 'fifthDiagnosis': 'I69.3', 'sixthDiagnosis': 'U07.1'}]
[16:11:28] ✅    ✅ Patient identified: Joseph Rodgers
[16:11:28] ✅    ✅ Patient name validation passed
[16:11:28] 🔄 
🔄 Step 3: Processing patient dates...
[16:11:28] [DOC: 9221028] ℹ️  DOB normalized: 05/10/1942
[16:11:28] [DOC: 9221028] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[16:11:28] [DOC: 9221028] ✅ Patient date processing completed successfully
[16:11:28] ✅    ✅ Date processing completed
[16:11:28] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'firstDiagnosis': 'J11.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'I48.9', 'fifthDiagnosis': 'I69.3', 'sixthDiagnosis': 'U07.1'}]
[16:11:28] 🔄 
🔄 Step 4: Extracting order data...
[16:11:32] ℹ️  Order extraction - MRN: '100999559'
[16:11:32] ℹ️  Order extraction - Sex: 'MALE'
[16:11:32] ℹ️  Order extraction - Service Line: 'PT'
[16:11:32] ℹ️  Order extraction - Payer Source: ''
[16:11:32] ✅ Order data extraction completed successfully
[16:11:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:11:32] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[16:11:32] ℹ️  Service line consistent in both sources: 'PT'
[16:11:32] ✅ Patient name cross-validation successful
[16:11:32] ✅    ✅ Data merged successfully
[16:11:33] ✅    ✅ Order data extracted and validated
[16:11:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:11:33] [DOC: 9221028] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[16:11:33] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[16:11:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:11:33] [DOC: 9221028] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[16:11:34] [DOC: 9221028] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:11:34] ❌    ❌ Failed to push order
[16:11:34] 🔄 
🔄 Step 7: Writing to CSV...
[16:11:34] [DOC: 9221028] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[16:11:34] [DOC: 9221028] ℹ️  Service Line extracted: 'PT'
[16:11:34] [DOC: 9221028] ℹ️  Payer Source extracted: ''
[16:11:34] [DOC: 9221028] ℹ️  Diagnosis codes being written:
[16:11:34] [DOC: 9221028] ℹ️    - Latest_Episode_Firstdiagnosis: 'J11.1'
[16:11:34] [DOC: 9221028] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[16:11:34] [DOC: 9221028] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[16:11:34] [DOC: 9221028] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.9'
[16:11:34] [DOC: 9221028] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I69.3'
[16:11:34] [DOC: 9221028] ℹ️    - Latest_Episode_Sixthdiagnosis: 'U07.1'
[16:11:34] [DOC: 9221028] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: PT | Payer:  | MRN: 100999559
[16:11:34] ✅    ✅ Document 9221028 processed and saved successfully
[16:11:34] 🔄 
🔄 Step 8: Saving API details...
[16:11:34] [DOC: 9221028] ℹ️  API push details saved for document 9221028
[16:11:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221020                         ║
================================================================================
[16:11:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:11:34] ℹ️  Date: 04/03/2025
[16:11:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:11:43] [DOC: 9221020] ✅ Text extracted using pdfplumber (13940 chars)
[16:11:43] ✅    ✅ Text extracted using pdfplumber (13940 chars)
[16:11:43] 🔄 
🔄 Step 2: Extracting patient data...
[16:11:46] ℹ️  AI extracted raw sex value: 'M'
[16:11:46] ℹ️  AI extracted service line: 'OT'
[16:11:46] ℹ️  AI extracted payer source: 'None'
[16:11:46] ℹ️  AI extracted diagnoses:
[16:11:46] ℹ️    - Diagnosis 1: 'None'
[16:11:46] ℹ️    - Diagnosis 2: 'None'
[16:11:46] ℹ️    - Diagnosis 3: 'None'
[16:11:46] ℹ️    - Diagnosis 4: 'None'
[16:11:46] ℹ️    - Diagnosis 5: 'None'
[16:11:46] ℹ️    - Diagnosis 6: 'None'
[16:11:46] ℹ️  Final extracted MRN: 'MA250317035001'
[16:11:46] ℹ️  Final extracted Sex: 'MALE'
[16:11:46] ℹ️  Final extracted Service Line: 'OT'
[16:11:46] ℹ️  Final extracted Payer Source: ''
[16:11:46] ✅ Patient data extraction completed successfully
[16:11:46] ✅    ✅ Patient data extracted successfully
[16:11:46] 📊 Patient Response
     └─ patientFName: Tony
     └─ patientLName: Pereira
     └─ dob: 03/17/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250317035001
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:11:46] ✅    ✅ Patient identified: Tony Pereira
[16:11:46] ✅    ✅ Patient name validation passed
[16:11:46] 🔄 
🔄 Step 3: Processing patient dates...
[16:11:46] [DOC: 9221020] ℹ️  DOB normalized: 03/17/1950
[16:11:46] [DOC: 9221020] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[16:11:46] [DOC: 9221020] ✅ Patient date processing completed successfully
[16:11:46] ✅    ✅ Date processing completed
[16:11:46] 📊 Processed Patient Data
     └─ patientFName: Tony
     └─ patientLName: Pereira
     └─ dob: 03/17/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250317035001
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025'}]
[16:11:46] 🔄 
🔄 Step 4: Extracting order data...
[16:11:48] ℹ️  Order extraction - MRN: 'MA250317035001'
[16:11:48] ℹ️  Order extraction - Sex: 'MALE'
[16:11:48] ℹ️  Order extraction - Service Line: 'OT'
[16:11:48] ℹ️  Order extraction - Payer Source: ''
[16:11:48] ✅ Order data extraction completed successfully
[16:11:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:11:48] ℹ️  Using MRN from patient data: 'MA250317035001' over 'MA250317035001'
[16:11:48] ℹ️  Service line consistent in both sources: 'OT'
[16:11:48] ✅ Patient name cross-validation successful
[16:11:48] ✅    ✅ Data merged successfully
[16:11:50] ✅    ✅ Order data extracted and validated
[16:11:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:35] [DOC: 9221020] ✅ Patient exists in API: Tony Pereira, ID: 01c0eb7a-c04d-4d9a-8cc7-f76783d842e4
[16:12:35] ✅    ✅ Existing patient found with ID: 01c0eb7a-c04d-4d9a-8cc7-f76783d842e4
[16:12:35] 🔄 
🔄 Step 6: Pushing order to API...
[16:12:35] [DOC: 9221020] ℹ️  Pushing order via API for patient ID: 01c0eb7a-c04d-4d9a-8cc7-f76783d842e4
[16:12:36] [DOC: 9221020] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:12:36] ❌    ❌ Failed to push order
[16:12:36] 🔄 
🔄 Step 7: Writing to CSV...
[16:12:36] [DOC: 9221020] ℹ️  Calculated age: 75 from DOB: 03/17/1950
[16:12:36] [DOC: 9221020] ℹ️  Service Line extracted: 'OT'
[16:12:36] [DOC: 9221020] ℹ️  Payer Source extracted: ''
[16:12:36] [DOC: 9221020] ℹ️  Diagnosis codes being written:
[16:12:36] [DOC: 9221020] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:12:36] [DOC: 9221020] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:12:36] [DOC: 9221020] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:12:36] [DOC: 9221020] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:12:36] [DOC: 9221020] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:12:36] [DOC: 9221020] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:12:36] [DOC: 9221020] ✅ Patient data written to CSV: Tony Pereira | Sex: MALE | Age: 75 | Service: OT | Payer:  | MRN: MA250317035001
[16:12:36] ✅    ✅ Document 9221020 processed and saved successfully
[16:12:36] 🔄 
🔄 Step 8: Saving API details...
[16:12:36] [DOC: 9221020] ℹ️  API push details saved for document 9221020
[16:12:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221015                         ║
================================================================================
[16:12:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:12:36] ℹ️  Date: 04/03/2025
[16:12:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:12:39] [DOC: 9221015] ✅ Text extracted using pdfplumber (12930 chars)
[16:12:39] ✅    ✅ Text extracted using pdfplumber (12930 chars)
[16:12:39] 🔄 
🔄 Step 2: Extracting patient data...
[16:12:42] ℹ️  AI extracted raw sex value: 'M'
[16:12:42] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[16:12:42] ℹ️  AI extracted payer source: 'Medicare'
[16:12:42] ℹ️  AI extracted diagnoses:
[16:12:42] ℹ️    - Diagnosis 1: 'I10'
[16:12:42] ℹ️    - Diagnosis 2: 'Z90.5'
[16:12:42] ℹ️    - Diagnosis 3: 'E78.5'
[16:12:42] ℹ️    - Diagnosis 4: 'M48.00'
[16:12:42] ℹ️    - Diagnosis 5: 'K21.00'
[16:12:42] ℹ️    - Diagnosis 6: 'M19.90'
[16:12:42] ℹ️  Final extracted MRN: 'MA250317035001'
[16:12:42] ℹ️  Final extracted Sex: 'MALE'
[16:12:42] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[16:12:42] ℹ️  Final extracted Payer Source: 'Medicare'
[16:12:42] ✅ Patient data extraction completed successfully
[16:12:42] ✅    ✅ Patient data extracted successfully
[16:12:42] 📊 Patient Response
     └─ patientFName: Tony
     └─ patientLName: Pereira
     └─ dob: 03/17/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250317035001
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 772 Shawmut Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (774) 202-4873
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'Z90.5', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'M48.00', 'fifthDiagnosis': 'K21.00', 'sixthDiagnosis': 'M19.90'}]
[16:12:42] ✅    ✅ Patient identified: Tony Pereira
[16:12:42] ✅    ✅ Patient name validation passed
[16:12:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:12:42] [DOC: 9221015] ℹ️  DOB normalized: 03/17/1950
[16:12:42] [DOC: 9221015] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:12:42] [DOC: 9221015] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[16:12:42] [DOC: 9221015] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[16:12:42] [DOC: 9221015] ✅ Patient date processing completed successfully
[16:12:42] ✅    ✅ Date processing completed
[16:12:42] 📊 Processed Patient Data
     └─ patientFName: Tony
     └─ patientLName: Pereira
     └─ dob: 03/17/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250317035001
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 772 Shawmut Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (774) 202-4873
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'Z90.5', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'M48.00', 'fifthDiagnosis': 'K21.00', 'sixthDiagnosis': 'M19.90'}]
[16:12:42] 🔄 
🔄 Step 4: Extracting order data...
[16:12:45] ℹ️  Order extraction - MRN: 'MA250317035001'
[16:12:45] ℹ️  Order extraction - Sex: 'MALE'
[16:12:45] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:12:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:12:45] ✅ Order data extraction completed successfully
[16:12:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:12:45] ℹ️  Using MRN from patient data: 'MA250317035001' over 'MA250317035001'
[16:12:45] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[16:12:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:12:45] ✅ Patient name cross-validation successful
[16:12:45] ✅    ✅ Data merged successfully
[16:12:46] ✅    ✅ Order data extracted and validated
[16:12:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:46] [DOC: 9221015] ✅ Patient found in local cache: Tony Pereira, ID: 01c0eb7a-c04d-4d9a-8cc7-f76783d842e4
[16:12:46] ✅    ✅ Existing patient found with ID: 01c0eb7a-c04d-4d9a-8cc7-f76783d842e4
[16:12:46] 🔄 
🔄 Step 6: Pushing order to API...
[16:12:46] [DOC: 9221015] ℹ️  Pushing order via API for patient ID: 01c0eb7a-c04d-4d9a-8cc7-f76783d842e4
[16:12:48] [DOC: 9221015] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13025"}
[16:12:48] ❌    ❌ Failed to push order
[16:12:48] 🔄 
🔄 Step 7: Writing to CSV...
[16:12:48] [DOC: 9221015] ℹ️  Calculated age: 75 from DOB: 03/17/1950
[16:12:48] [DOC: 9221015] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[16:12:48] [DOC: 9221015] ℹ️  Payer Source extracted: 'Medicare'
[16:12:48] [DOC: 9221015] ℹ️  Diagnosis codes being written:
[16:12:48] [DOC: 9221015] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[16:12:48] [DOC: 9221015] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z90.5'
[16:12:48] [DOC: 9221015] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[16:12:48] [DOC: 9221015] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M48.00'
[16:12:48] [DOC: 9221015] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K21.00'
[16:12:48] [DOC: 9221015] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M19.90'
[16:12:48] [DOC: 9221015] ✅ Patient data written to CSV: Tony Pereira | Sex: MALE | Age: 75 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: MA250317035001
[16:12:48] ✅    ✅ Document 9221015 processed and saved successfully
[16:12:48] 🔄 
🔄 Step 8: Saving API details...
[16:12:48] [DOC: 9221015] ℹ️  API push details saved for document 9221015
[16:12:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220991                         ║
================================================================================
[16:12:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:12:48] ℹ️  Date: 04/03/2025
[16:12:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:12:50] [DOC: 9220991] ✅ Text extracted using pdfplumber (10804 chars)
[16:12:50] ✅    ✅ Text extracted using pdfplumber (10804 chars)
[16:12:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:12:53] ℹ️  AI extracted raw sex value: 'M'
[16:12:53] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[16:12:53] ℹ️  AI extracted payer source: ''
[16:12:53] ℹ️  AI extracted diagnoses:
[16:12:53] ℹ️    - Diagnosis 1: 'I130'
[16:12:53] ℹ️    - Diagnosis 2: 'I5031'
[16:12:53] ℹ️    - Diagnosis 3: ''
[16:12:53] ℹ️    - Diagnosis 4: ''
[16:12:53] ℹ️    - Diagnosis 5: ''
[16:12:53] ℹ️    - Diagnosis 6: ''
[16:12:53] ℹ️  Final extracted MRN: 'MA240226073801'
[16:12:53] ℹ️  Final extracted Sex: 'MALE'
[16:12:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[16:12:53] ℹ️  Final extracted Payer Source: ''
[16:12:53] ✅ Patient data extraction completed successfully
[16:12:53] ✅    ✅ Patient data extracted successfully
[16:12:53] 📊 Patient Response
     └─ patientFName: Gonzalo
     └─ patientLName: Morales
     └─ dob: 07/05/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240226073801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5031', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:53] ✅    ✅ Patient identified: Gonzalo Morales
[16:12:53] ✅    ✅ Patient name validation passed
[16:12:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:12:53] [DOC: 9220991] ℹ️  DOB normalized: 07/05/1938
[16:12:53] [DOC: 9220991] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[16:12:53] [DOC: 9220991] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[16:12:53] [DOC: 9220991] ✅ Patient date processing completed successfully
[16:12:53] ✅    ✅ Date processing completed
[16:12:53] 📊 Processed Patient Data
     └─ patientFName: Gonzalo
     └─ patientLName: Morales
     └─ dob: 07/05/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240226073801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5031', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:53] 🔄 
🔄 Step 4: Extracting order data...
[16:12:56] ℹ️  Order extraction - MRN: 'MA240226073801'
[16:12:56] ℹ️  Order extraction - Sex: 'MALE'
[16:12:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[16:12:56] ℹ️  Order extraction - Payer Source: ''
[16:12:56] ✅ Order data extraction completed successfully
[16:12:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:12:56] ℹ️  Using MRN from patient data: 'MA240226073801' over 'MA240226073801'
[16:12:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[16:12:56] ✅ Patient name cross-validation successful
[16:12:56] ✅    ✅ Data merged successfully
[16:12:58] ✅    ✅ Order data extracted and validated
[16:12:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:58] [DOC: 9220991] ✅ Patient found in local cache: Gonzalo Morales, ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[16:12:58] ✅    ✅ Existing patient found with ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[16:12:58] 🔄 
🔄 Step 6: Pushing order to API...
[16:12:58] [DOC: 9220991] ℹ️  Pushing order via API for patient ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[16:12:59] [DOC: 9220991] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14146"}
[16:12:59] ❌    ❌ Failed to push order
[16:12:59] 🔄 
🔄 Step 7: Writing to CSV...
[16:12:59] [DOC: 9220991] ℹ️  Calculated age: 86 from DOB: 07/05/1938
[16:12:59] [DOC: 9220991] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy'
[16:12:59] [DOC: 9220991] ℹ️  Payer Source extracted: ''
[16:12:59] [DOC: 9220991] ℹ️  Diagnosis codes being written:
[16:12:59] [DOC: 9220991] ℹ️    - Latest_Episode_Firstdiagnosis: 'I130'
[16:12:59] [DOC: 9220991] ℹ️    - Latest_Episode_Seconddiagnosis: 'I5031'
[16:12:59] [DOC: 9220991] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:12:59] [DOC: 9220991] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:12:59] [DOC: 9220991] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:12:59] [DOC: 9220991] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:12:59] [DOC: 9220991] ✅ Patient data written to CSV: Gonzalo Morales | Sex: MALE | Age: 86 | Service: Skilled Nursing, Occupational Therapy | Payer:  | MRN: MA240226073801
[16:12:59] ✅    ✅ Document 9220991 processed and saved successfully
[16:12:59] 🔄 
🔄 Step 8: Saving API details...
[16:12:59] [DOC: 9220991] ℹ️  API push details saved for document 9220991
[16:12:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220982                         ║
================================================================================
[16:12:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:12:59] ℹ️  Date: 04/03/2025
[16:12:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:01] [DOC: 9220982] ✅ Text extracted using pdfplumber (1472 chars)
[16:13:01] ✅    ✅ Text extracted using pdfplumber (1472 chars)
[16:13:01] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:04] ℹ️  AI extracted raw sex value: ''
[16:13:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:13:04] ℹ️  AI extracted payer source: ''
[16:13:04] ℹ️  AI extracted diagnoses:
[16:13:04] ℹ️    - Diagnosis 1: 'E11.65'
[16:13:04] ℹ️    - Diagnosis 2: 'I11.0'
[16:13:04] ℹ️    - Diagnosis 3: 'M48.061'
[16:13:04] ℹ️    - Diagnosis 4: ''
[16:13:04] ℹ️    - Diagnosis 5: ''
[16:13:04] ℹ️    - Diagnosis 6: ''
[16:13:04] ℹ️  Final extracted MRN: 'MA200720115101'
[16:13:04] ℹ️  Final extracted Sex: ''
[16:13:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:13:04] ℹ️  Final extracted Payer Source: ''
[16:13:04] ✅ Patient data extraction completed successfully
[16:13:04] ✅    ✅ Patient data extracted successfully
[16:13:04] 📊 Patient Response
     └─ patientFName: Eugenio
     └─ patientLName: Pontes
     └─ dob: 11/03/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA200720115101
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'M48.061', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:13:04] ✅    ✅ Patient identified: Eugenio Pontes
[16:13:04] ✅    ✅ Patient name validation passed
[16:13:04] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:04] [DOC: 9220982] ℹ️  DOB normalized: 11/03/1951
[16:13:04] [DOC: 9220982] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:13:04] [DOC: 9220982] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:13:04] [DOC: 9220982] ✅ Patient date processing completed successfully
[16:13:04] ✅    ✅ Date processing completed
[16:13:04] 📊 Processed Patient Data
     └─ patientFName: Eugenio
     └─ patientLName: Pontes
     └─ dob: 11/03/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA200720115101
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'M48.061', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:13:04] 🔄 
🔄 Step 4: Extracting order data...
[16:13:07] ℹ️  Order extraction - MRN: 'MA200720115101'
[16:13:07] ℹ️  Order extraction - Sex: ''
[16:13:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:13:07] ℹ️  Order extraction - Payer Source: ''
[16:13:07] ✅ Order data extraction completed successfully
[16:13:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:07] ℹ️  Using MRN from patient data: 'MA200720115101' over 'MA200720115101'
[16:13:07] ⚠️  Could not determine sex using any available method
[16:13:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:13:07] ✅ Patient name cross-validation successful
[16:13:07] ✅    ✅ Data merged successfully
[16:13:08] ✅    ✅ Order data extracted and validated
[16:13:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:16] [DOC: 9220982] ✅ Patient exists in API: Eugenio Pontes, ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:16] ✅    ✅ Existing patient found with ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:16] 🔄 
🔄 Step 6: Pushing order to API...
[16:13:16] [DOC: 9220982] ℹ️  Pushing order via API for patient ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:17] [DOC: 9220982] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13082"}
[16:13:17] ❌    ❌ Failed to push order
[16:13:17] 🔄 
🔄 Step 7: Writing to CSV...
[16:13:17] [DOC: 9220982] ℹ️  Calculated age: 73 from DOB: 11/03/1951
[16:13:17] [DOC: 9220982] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:13:17] [DOC: 9220982] ℹ️  Payer Source extracted: ''
[16:13:17] [DOC: 9220982] ℹ️  Diagnosis codes being written:
[16:13:17] [DOC: 9220982] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[16:13:17] [DOC: 9220982] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[16:13:17] [DOC: 9220982] ℹ️    - Latest_Episode_Thirddiagnosis: 'M48.061'
[16:13:17] [DOC: 9220982] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:13:17] [DOC: 9220982] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:13:17] [DOC: 9220982] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:13:17] [DOC: 9220982] ✅ Patient data written to CSV: Eugenio Pontes | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA200720115101
[16:13:17] ✅    ✅ Document 9220982 processed and saved successfully
[16:13:17] 🔄 
🔄 Step 8: Saving API details...
[16:13:17] [DOC: 9220982] ℹ️  API push details saved for document 9220982
[16:13:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220979                         ║
================================================================================
[16:13:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:13:17] ℹ️  Date: 04/03/2025
[16:13:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:19] [DOC: 9220979] ✅ Text extracted using pdfplumber (1628 chars)
[16:13:19] ✅    ✅ Text extracted using pdfplumber (1628 chars)
[16:13:19] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:22] ℹ️  AI extracted raw sex value: ''
[16:13:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:13:22] ℹ️  AI extracted payer source: ''
[16:13:22] ℹ️  AI extracted diagnoses:
[16:13:22] ℹ️    - Diagnosis 1: 'E11.65'
[16:13:22] ℹ️    - Diagnosis 2: 'I11.0'
[16:13:22] ℹ️    - Diagnosis 3: 'M48.061'
[16:13:22] ℹ️    - Diagnosis 4: 'None'
[16:13:22] ℹ️    - Diagnosis 5: 'None'
[16:13:22] ℹ️    - Diagnosis 6: 'None'
[16:13:22] ℹ️  Final extracted MRN: 'MA200720115101'
[16:13:22] ℹ️  Final extracted Sex: ''
[16:13:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:13:22] ℹ️  Final extracted Payer Source: ''
[16:13:22] ✅ Patient data extraction completed successfully
[16:13:22] ✅    ✅ Patient data extracted successfully
[16:13:22] 📊 Patient Response
     └─ patientFName: Eugenio
     └─ patientLName: Pontes
     └─ dob: 11/03/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA200720115101
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'M48.061', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:13:22] ✅    ✅ Patient identified: Eugenio Pontes
[16:13:22] ✅    ✅ Patient name validation passed
[16:13:22] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:22] [DOC: 9220979] ℹ️  DOB normalized: 11/03/1951
[16:13:22] [DOC: 9220979] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:13:22] [DOC: 9220979] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:13:22] [DOC: 9220979] ✅ Patient date processing completed successfully
[16:13:22] ✅    ✅ Date processing completed
[16:13:22] 📊 Processed Patient Data
     └─ patientFName: Eugenio
     └─ patientLName: Pontes
     └─ dob: 11/03/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA200720115101
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'M48.061'}]
[16:13:22] 🔄 
🔄 Step 4: Extracting order data...
[16:13:25] ℹ️  Order extraction - MRN: 'MA200720115101'
[16:13:25] ℹ️  Order extraction - Sex: ''
[16:13:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:13:25] ℹ️  Order extraction - Payer Source: ''
[16:13:25] ✅ Order data extraction completed successfully
[16:13:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:25] ℹ️  Using MRN from patient data: 'MA200720115101' over 'MA200720115101'
[16:13:25] ⚠️  Could not determine sex using any available method
[16:13:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:13:25] ✅ Patient name cross-validation successful
[16:13:25] ✅    ✅ Data merged successfully
[16:13:26] ✅    ✅ Order data extracted and validated
[16:13:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:26] [DOC: 9220979] ✅ Patient found in local cache: Eugenio Pontes, ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:26] ✅    ✅ Existing patient found with ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:26] 🔄 
🔄 Step 6: Pushing order to API...
[16:13:26] [DOC: 9220979] ℹ️  Pushing order via API for patient ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:28] [DOC: 9220979] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13083"}
[16:13:28] ❌    ❌ Failed to push order
[16:13:28] 🔄 
🔄 Step 7: Writing to CSV...
[16:13:28] [DOC: 9220979] ℹ️  Calculated age: 73 from DOB: 11/03/1951
[16:13:28] [DOC: 9220979] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:13:28] [DOC: 9220979] ℹ️  Payer Source extracted: ''
[16:13:28] [DOC: 9220979] ℹ️  Diagnosis codes being written:
[16:13:28] [DOC: 9220979] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[16:13:28] [DOC: 9220979] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[16:13:28] [DOC: 9220979] ℹ️    - Latest_Episode_Thirddiagnosis: 'M48.061'
[16:13:28] [DOC: 9220979] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:13:28] [DOC: 9220979] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:13:28] [DOC: 9220979] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:13:28] [DOC: 9220979] ✅ Patient data written to CSV: Eugenio Pontes | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA200720115101
[16:13:28] ✅    ✅ Document 9220979 processed and saved successfully
[16:13:28] 🔄 
🔄 Step 8: Saving API details...
[16:13:28] [DOC: 9220979] ℹ️  API push details saved for document 9220979
[16:13:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220978                         ║
================================================================================
[16:13:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:13:28] ℹ️  Date: 04/03/2025
[16:13:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:31] [DOC: 9220978] ✅ Text extracted using pdfplumber (1820 chars)
[16:13:31] ✅    ✅ Text extracted using pdfplumber (1820 chars)
[16:13:31] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:34] ℹ️  AI extracted raw sex value: ''
[16:13:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:13:34] ℹ️  AI extracted payer source: ''
[16:13:34] ℹ️  AI extracted diagnoses:
[16:13:34] ℹ️    - Diagnosis 1: 'E11.65'
[16:13:34] ℹ️    - Diagnosis 2: 'I11.0'
[16:13:34] ℹ️    - Diagnosis 3: 'M48.061'
[16:13:34] ℹ️    - Diagnosis 4: 'None'
[16:13:34] ℹ️    - Diagnosis 5: 'None'
[16:13:34] ℹ️    - Diagnosis 6: 'None'
[16:13:34] ℹ️  Final extracted MRN: 'MA200720115101'
[16:13:34] ℹ️  Final extracted Sex: ''
[16:13:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:13:34] ℹ️  Final extracted Payer Source: ''
[16:13:34] ✅ Patient data extraction completed successfully
[16:13:34] ✅    ✅ Patient data extracted successfully
[16:13:34] 📊 Patient Response
     └─ patientFName: Eugenio
     └─ patientLName: Pontes
     └─ dob: 11/03/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA200720115101
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'M48.061', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:13:34] ✅    ✅ Patient identified: Eugenio Pontes
[16:13:34] ✅    ✅ Patient name validation passed
[16:13:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:34] [DOC: 9220978] ℹ️  DOB normalized: 11/03/1951
[16:13:34] [DOC: 9220978] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:13:34] [DOC: 9220978] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:13:34] [DOC: 9220978] ✅ Patient date processing completed successfully
[16:13:34] ✅    ✅ Date processing completed
[16:13:34] 📊 Processed Patient Data
     └─ patientFName: Eugenio
     └─ patientLName: Pontes
     └─ dob: 11/03/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA200720115101
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'M48.061'}]
[16:13:34] 🔄 
🔄 Step 4: Extracting order data...
[16:13:37] ℹ️  Order extraction - MRN: 'MA200720115101'
[16:13:37] ℹ️  Order extraction - Sex: ''
[16:13:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:13:37] ℹ️  Order extraction - Payer Source: ''
[16:13:37] ✅ Order data extraction completed successfully
[16:13:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:37] ℹ️  Using MRN from patient data: 'MA200720115101' over 'MA200720115101'
[16:13:37] ⚠️  Could not determine sex using any available method
[16:13:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:13:37] ✅ Patient name cross-validation successful
[16:13:37] ✅    ✅ Data merged successfully
[16:13:38] ✅    ✅ Order data extracted and validated
[16:13:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:38] [DOC: 9220978] ✅ Patient found in local cache: Eugenio Pontes, ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:38] ✅    ✅ Existing patient found with ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:38] 🔄 
🔄 Step 6: Pushing order to API...
[16:13:38] [DOC: 9220978] ℹ️  Pushing order via API for patient ID: 3de4874d-d4fc-47de-9a9e-584f9d392c5f
[16:13:39] [DOC: 9220978] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13084"}
[16:13:39] ❌    ❌ Failed to push order
[16:13:39] 🔄 
🔄 Step 7: Writing to CSV...
[16:13:39] [DOC: 9220978] ℹ️  Calculated age: 73 from DOB: 11/03/1951
[16:13:39] [DOC: 9220978] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:13:39] [DOC: 9220978] ℹ️  Payer Source extracted: ''
[16:13:39] [DOC: 9220978] ℹ️  Diagnosis codes being written:
[16:13:39] [DOC: 9220978] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[16:13:39] [DOC: 9220978] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[16:13:39] [DOC: 9220978] ℹ️    - Latest_Episode_Thirddiagnosis: 'M48.061'
[16:13:39] [DOC: 9220978] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:13:39] [DOC: 9220978] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:13:39] [DOC: 9220978] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:13:39] [DOC: 9220978] ✅ Patient data written to CSV: Eugenio Pontes | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA200720115101
[16:13:39] ✅    ✅ Document 9220978 processed and saved successfully
[16:13:39] 🔄 
🔄 Step 8: Saving API details...
[16:13:39] [DOC: 9220978] ℹ️  API push details saved for document 9220978
[16:13:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220556                         ║
================================================================================
[16:13:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:13:39] ℹ️  Date: 04/03/2025
[16:13:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:43] [DOC: 9220556] ✅ Text extracted using pdfplumber (12795 chars)
[16:13:43] ✅    ✅ Text extracted using pdfplumber (12795 chars)
[16:13:43] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:47] ℹ️  AI extracted raw sex value: 'F'
[16:13:47] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:13:47] ℹ️  AI extracted payer source: 'Medicare'
[16:13:47] ℹ️  AI extracted diagnoses:
[16:13:47] ℹ️    - Diagnosis 1: 'I10'
[16:13:47] ℹ️    - Diagnosis 2: 'E11.42'
[16:13:47] ℹ️    - Diagnosis 3: 'M51.369'
[16:13:47] ℹ️    - Diagnosis 4: 'M47.816'
[16:13:47] ℹ️    - Diagnosis 5: 'G47.33'
[16:13:47] ℹ️    - Diagnosis 6: 'S02.2XX'
[16:13:47] ℹ️  Final extracted MRN: 'MA250115023801'
[16:13:47] ℹ️  Final extracted Sex: 'FEMALE'
[16:13:47] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:13:47] ℹ️  Final extracted Payer Source: 'Medicare'
[16:13:47] ✅ Patient data extraction completed successfully
[16:13:47] ✅    ✅ Patient data extracted successfully
[16:13:47] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Vieira
     └─ dob: 02/05/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250115023801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 1881923936
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, Apt 108
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 990-1089
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'M51.369', 'fourthDiagnosis': 'M47.816', 'fifthDiagnosis': 'G47.33', 'sixthDiagnosis': 'S02.2XX'}]
[16:13:47] ✅    ✅ Patient identified: Nancy Vieira
[16:13:47] ✅    ✅ Patient name validation passed
[16:13:47] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:47] [DOC: 9220556] ℹ️  DOB normalized: 02/05/1938
[16:13:47] [DOC: 9220556] ℹ️  Episode startOfCare normalized: 01/20/2025
[16:13:47] [DOC: 9220556] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:13:47] [DOC: 9220556] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:13:47] [DOC: 9220556] ✅ Patient date processing completed successfully
[16:13:47] ✅    ✅ Date processing completed
[16:13:47] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Vieira
     └─ dob: 02/05/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250115023801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 1881923936
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, Apt 108
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 990-1089
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'M51.369', 'fourthDiagnosis': 'M47.816', 'fifthDiagnosis': 'G47.33', 'sixthDiagnosis': 'S02.2XX'}]
[16:13:47] 🔄 
🔄 Step 4: Extracting order data...
[16:13:49] ℹ️  Order extraction - MRN: 'MA250115023801'
[16:13:49] ℹ️  Order extraction - Sex: 'FEMALE'
[16:13:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:13:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:13:49] ✅ Order data extraction completed successfully
[16:13:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:49] ℹ️  Using MRN from patient data: 'MA250115023801' over 'MA250115023801'
[16:13:49] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:13:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:13:49] ✅ Patient name cross-validation successful
[16:13:49] ✅    ✅ Data merged successfully
[16:13:51] ✅    ✅ Order data extracted and validated
[16:13:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:14:12] [DOC: 9220556] ✅ Patient exists in API: Nancy Vieira, ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:14:12] ✅    ✅ Existing patient found with ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:14:12] 🔄 
🔄 Step 6: Pushing order to API...
[16:14:12] [DOC: 9220556] ℹ️  Pushing order via API for patient ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:14:14] [DOC: 9220556] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14390"}
[16:14:14] ❌    ❌ Failed to push order
[16:14:14] 🔄 
🔄 Step 7: Writing to CSV...
[16:14:14] [DOC: 9220556] ℹ️  Calculated age: 87 from DOB: 02/05/1938
[16:14:14] [DOC: 9220556] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:14:14] [DOC: 9220556] ℹ️  Payer Source extracted: 'Medicare'
[16:14:14] [DOC: 9220556] ℹ️  Diagnosis codes being written:
[16:14:14] [DOC: 9220556] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[16:14:14] [DOC: 9220556] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.42'
[16:14:14] [DOC: 9220556] ℹ️    - Latest_Episode_Thirddiagnosis: 'M51.369'
[16:14:14] [DOC: 9220556] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M47.816'
[16:14:14] [DOC: 9220556] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G47.33'
[16:14:14] [DOC: 9220556] ℹ️    - Latest_Episode_Sixthdiagnosis: 'S02.2XX'
[16:14:14] [DOC: 9220556] ✅ Patient data written to CSV: Nancy Vieira | Sex: FEMALE | Age: 87 | Service: Skilled Nursing | Payer: Medicare | MRN: MA250115023801
[16:14:14] ✅    ✅ Document 9220556 processed and saved successfully
[16:14:14] 🔄 
🔄 Step 8: Saving API details...
[16:14:14] [DOC: 9220556] ℹ️  API push details saved for document 9220556
[16:14:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220542                         ║
================================================================================
[16:14:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:14:14] ℹ️  Date: 04/03/2025
[16:14:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:14:16] [DOC: 9220542] ✅ Text extracted using pdfplumber (2426 chars)
[16:14:16] ✅    ✅ Text extracted using pdfplumber (2414 chars)
[16:14:16] 🔄 
🔄 Step 2: Extracting patient data...
[16:14:19] ℹ️  AI extracted raw sex value: ''
[16:14:19] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[16:14:19] ℹ️  AI extracted payer source: ''
[16:14:19] ℹ️  AI extracted diagnoses:
[16:14:19] ℹ️    - Diagnosis 1: 'K76.82'
[16:14:19] ℹ️    - Diagnosis 2: 'N17.9'
[16:14:19] ℹ️    - Diagnosis 3: 'E11.43'
[16:14:19] ℹ️    - Diagnosis 4: ''
[16:14:19] ℹ️    - Diagnosis 5: ''
[16:14:19] ℹ️    - Diagnosis 6: ''
[16:14:19] ℹ️  Final extracted MRN: 'MA250224016702'
[16:14:19] ℹ️  Final extracted Sex: ''
[16:14:19] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[16:14:19] ℹ️  Final extracted Payer Source: ''
[16:14:19] ✅ Patient data extraction completed successfully
[16:14:19] ✅    ✅ Patient data extracted successfully
[16:14:19] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K76.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'E11.43', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:19] ✅    ✅ Patient identified: Judith Souza
[16:14:19] ✅    ✅ Patient name validation passed
[16:14:19] 🔄 
🔄 Step 3: Processing patient dates...
[16:14:19] [DOC: 9220542] ℹ️  DOB normalized: 01/04/1967
[16:14:19] [DOC: 9220542] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:14:19] [DOC: 9220542] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:14:19] [DOC: 9220542] ✅ Patient date processing completed successfully
[16:14:19] ✅    ✅ Date processing completed
[16:14:19] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K76.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'E11.43', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:19] 🔄 
🔄 Step 4: Extracting order data...
[16:14:21] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:14:21] ℹ️  Order extraction - Sex: ''
[16:14:21] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[16:14:21] ℹ️  Order extraction - Payer Source: ''
[16:14:21] ✅ Order data extraction completed successfully
[16:14:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:21] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:14:21] ⚠️  Could not determine sex using any available method
[16:14:21] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[16:14:21] ✅ Patient name cross-validation successful
[16:14:21] ✅    ✅ Data merged successfully
[16:14:23] ✅    ✅ Order data extracted and validated
[16:14:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:14:28] [DOC: 9220542] ℹ️  Patient not found in cache or API: Judith Souza
[16:14:28] [DOC: 9220542] ℹ️  Patient not found, creating new patient via API...
[16:14:28] [DOC: 9220542] ℹ️  Creating patient via API: Judith Souza
[16:14:30] [DOC: 9220542] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:14:30] ❌    ❌ Failed to create patient
[16:14:30] [DOC: 9220542] ℹ️  API push details saved for document 9220542
================================================================================
║                        Processing Document ID: 9220541                         ║
================================================================================
[16:14:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:14:30] ℹ️  Date: 04/03/2025
[16:14:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:14:33] [DOC: 9220541] ✅ Text extracted using pdfplumber (2591 chars)
[16:14:33] ✅    ✅ Text extracted using pdfplumber (2579 chars)
[16:14:33] 🔄 
🔄 Step 2: Extracting patient data...
[16:14:36] ℹ️  AI extracted raw sex value: ''
[16:14:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:14:36] ℹ️  AI extracted payer source: ''
[16:14:36] ℹ️  AI extracted diagnoses:
[16:14:36] ℹ️    - Diagnosis 1: 'K76.82'
[16:14:36] ℹ️    - Diagnosis 2: 'N17.9'
[16:14:36] ℹ️    - Diagnosis 3: 'E11.43'
[16:14:36] ℹ️    - Diagnosis 4: 'None'
[16:14:36] ℹ️    - Diagnosis 5: 'None'
[16:14:36] ℹ️    - Diagnosis 6: 'None'
[16:14:36] ℹ️  Final extracted MRN: 'MA250224016702'
[16:14:36] ℹ️  Final extracted Sex: ''
[16:14:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:14:36] ℹ️  Final extracted Payer Source: ''
[16:14:36] ✅ Patient data extraction completed successfully
[16:14:36] ✅    ✅ Patient data extracted successfully
[16:14:36] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K76.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'E11.43', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:14:36] ✅    ✅ Patient identified: Judith Souza
[16:14:36] ✅    ✅ Patient name validation passed
[16:14:36] 🔄 
🔄 Step 3: Processing patient dates...
[16:14:36] [DOC: 9220541] ℹ️  DOB normalized: 01/04/1967
[16:14:36] [DOC: 9220541] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:14:36] [DOC: 9220541] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:14:36] [DOC: 9220541] ✅ Patient date processing completed successfully
[16:14:36] ✅    ✅ Date processing completed
[16:14:36] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K76.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'E11.43'}]
[16:14:36] 🔄 
🔄 Step 4: Extracting order data...
[16:14:38] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:14:38] ℹ️  Order extraction - Sex: ''
[16:14:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:14:38] ℹ️  Order extraction - Payer Source: ''
[16:14:38] ✅ Order data extraction completed successfully
[16:14:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:38] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:14:38] ⚠️  Could not determine sex using any available method
[16:14:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:14:38] ✅ Patient name cross-validation successful
[16:14:38] ✅    ✅ Data merged successfully
[16:14:40] ✅    ✅ Order data extracted and validated
[16:14:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:14:45] [DOC: 9220541] ℹ️  Patient not found in cache or API: Judith Souza
[16:14:45] [DOC: 9220541] ℹ️  Patient not found, creating new patient via API...
[16:14:45] [DOC: 9220541] ℹ️  Creating patient via API: Judith Souza
[16:14:46] [DOC: 9220541] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:14:46] ❌    ❌ Failed to create patient
[16:14:46] [DOC: 9220541] ℹ️  API push details saved for document 9220541
================================================================================
║                        Processing Document ID: 9220534                         ║
================================================================================
[16:14:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:14:46] ℹ️  Date: 04/03/2025
[16:14:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:14:49] [DOC: 9220534] ✅ Text extracted using pdfplumber (23388 chars)
[16:14:49] ✅    ✅ Text extracted using pdfplumber (23388 chars)
[16:14:49] 🔄 
🔄 Step 2: Extracting patient data...
[16:14:52] ℹ️  AI extracted raw sex value: 'F'
[16:14:52] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:14:52] ℹ️  AI extracted payer source: ''
[16:14:52] ℹ️  AI extracted diagnoses:
[16:14:52] ℹ️    - Diagnosis 1: 'K7682'
[16:14:52] ℹ️    - Diagnosis 2: 'N179'
[16:14:52] ℹ️    - Diagnosis 3: ''
[16:14:52] ℹ️    - Diagnosis 4: ''
[16:14:52] ℹ️    - Diagnosis 5: ''
[16:14:52] ℹ️    - Diagnosis 6: ''
[16:14:52] ℹ️  Final extracted MRN: 'MA250224016702'
[16:14:52] ℹ️  Final extracted Sex: 'FEMALE'
[16:14:52] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:14:52] ℹ️  Final extracted Payer Source: ''
[16:14:52] ✅ Patient data extraction completed successfully
[16:14:52] ✅    ✅ Patient data extracted successfully
[16:14:52] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K7682', 'secondDiagnosis': 'N179', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:52] ✅    ✅ Patient identified: Judith Souza
[16:14:52] ✅    ✅ Patient name validation passed
[16:14:52] 🔄 
🔄 Step 3: Processing patient dates...
[16:14:52] [DOC: 9220534] ℹ️  DOB normalized: 01/04/1967
[16:14:52] [DOC: 9220534] ℹ️  Episode startOfCare normalized: 03/01/2025
[16:14:52] [DOC: 9220534] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:14:52] [DOC: 9220534] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:14:52] [DOC: 9220534] ✅ Patient date processing completed successfully
[16:14:52] ✅    ✅ Date processing completed
[16:14:52] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K7682', 'secondDiagnosis': 'N179', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:52] 🔄 
🔄 Step 4: Extracting order data...
[16:14:55] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:14:55] ℹ️  Order extraction - Sex: 'FEMALE'
[16:14:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:14:55] ℹ️  Order extraction - Payer Source: ''
[16:14:55] ✅ Order data extraction completed successfully
[16:14:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:55] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:14:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:14:55] ✅ Patient name cross-validation successful
[16:14:55] ✅    ✅ Data merged successfully
[16:14:56] ✅    ✅ Order data extracted and validated
[16:14:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:05] [DOC: 9220534] ℹ️  Patient not found in cache or API: Judith Souza
[16:15:05] [DOC: 9220534] ℹ️  Patient not found, creating new patient via API...
[16:15:05] [DOC: 9220534] ℹ️  Creating patient via API: Judith Souza
[16:15:07] [DOC: 9220534] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:15:07] ❌    ❌ Failed to create patient
[16:15:07] [DOC: 9220534] ℹ️  API push details saved for document 9220534
================================================================================
║                        Processing Document ID: 9220462                         ║
================================================================================
[16:15:07] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:15:07] ℹ️  Date: 04/03/2025
[16:15:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:10] [DOC: 9220462] ✅ Text extracted using pdfplumber (15641 chars)
[16:15:10] ✅    ✅ Text extracted using pdfplumber (15631 chars)
[16:15:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:13] ℹ️  AI extracted raw sex value: 'M'
[16:15:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:15:13] ℹ️  AI extracted payer source: ''
[16:15:13] ℹ️  AI extracted diagnoses:
[16:15:13] ℹ️    - Diagnosis 1: 'Z48.01'
[16:15:13] ℹ️    - Diagnosis 2: 'Z47.81'
[16:15:13] ℹ️    - Diagnosis 3: 'E08.621'
[16:15:13] ℹ️    - Diagnosis 4: 'L97.512'
[16:15:13] ℹ️    - Diagnosis 5: 'M86.171'
[16:15:13] ℹ️    - Diagnosis 6: 'E08.51'
[16:15:13] ℹ️  Final extracted MRN: '3091790'
[16:15:13] ℹ️  Final extracted Sex: 'MALE'
[16:15:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:15:13] ℹ️  Final extracted Payer Source: ''
[16:15:13] ✅ Patient data extraction completed successfully
[16:15:13] ✅    ✅ Patient data extracted successfully
[16:15:13] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z48.01', 'secondDiagnosis': 'Z47.81', 'thirdDiagnosis': 'E08.621', 'fourthDiagnosis': 'L97.512', 'fifthDiagnosis': 'M86.171', 'sixthDiagnosis': 'E08.51'}]
[16:15:13] ✅    ✅ Patient identified: Richard White
[16:15:13] ✅    ✅ Patient name validation passed
[16:15:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:13] [DOC: 9220462] ℹ️  DOB normalized: 12/08/1957
[16:15:13] [DOC: 9220462] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:15:13] [DOC: 9220462] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[16:15:13] [DOC: 9220462] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[16:15:13] [DOC: 9220462] ✅ Patient date processing completed successfully
[16:15:13] ✅    ✅ Date processing completed
[16:15:13] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z48.01', 'secondDiagnosis': 'Z47.81', 'thirdDiagnosis': 'E08.621', 'fourthDiagnosis': 'L97.512', 'fifthDiagnosis': 'M86.171', 'sixthDiagnosis': 'E08.51'}]
[16:15:13] 🔄 
🔄 Step 4: Extracting order data...
[16:15:16] ℹ️  Order extraction - MRN: '3091790'
[16:15:16] ℹ️  Order extraction - Sex: 'MALE'
[16:15:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:15:16] ℹ️  Order extraction - Payer Source: ''
[16:15:16] ✅ Order data extraction completed successfully
[16:15:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:16] ℹ️  Using MRN from patient data: '3091790' over '3091790'
[16:15:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:15:16] ✅ Patient name cross-validation successful
[16:15:16] ✅    ✅ Data merged successfully
[16:15:17] ✅    ✅ Order data extracted and validated
[16:15:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:23] [DOC: 9220462] ℹ️  Patient not found in cache or API: Richard White
[16:15:23] [DOC: 9220462] ℹ️  Patient not found, creating new patient via API...
[16:15:23] [DOC: 9220462] ℹ️  Creating patient via API: Richard White
[16:15:24] [DOC: 9220462] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:15:24] ❌    ❌ Failed to create patient
[16:15:24] [DOC: 9220462] ℹ️  API push details saved for document 9220462
================================================================================
║                        Processing Document ID: 9220450                         ║
================================================================================
[16:15:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:15:24] ℹ️  Date: 04/03/2025
[16:15:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:26] [DOC: 9220450] ✅ Text extracted using pdfplumber (1014 chars)
[16:15:26] ✅    ✅ Text extracted using pdfplumber (1014 chars)
[16:15:26] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:29] ℹ️  AI extracted raw sex value: 'M'
[16:15:29] ℹ️  AI extracted service line: ''
[16:15:29] ℹ️  AI extracted payer source: ''
[16:15:29] ℹ️  AI extracted diagnoses:
[16:15:29] ℹ️    - Diagnosis 1: 'None'
[16:15:29] ℹ️    - Diagnosis 2: 'None'
[16:15:29] ℹ️    - Diagnosis 3: 'None'
[16:15:29] ℹ️    - Diagnosis 4: 'None'
[16:15:29] ℹ️    - Diagnosis 5: 'None'
[16:15:29] ℹ️    - Diagnosis 6: 'None'
[16:15:29] ℹ️  Final extracted MRN: '3170225'
[16:15:29] ℹ️  Final extracted Sex: 'MALE'
[16:15:29] ℹ️  Final extracted Service Line: ''
[16:15:29] ℹ️  Final extracted Payer Source: ''
[16:15:29] ✅ Patient data extraction completed successfully
[16:15:29] ✅    ✅ Patient data extracted successfully
[16:15:29] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:15:29] ✅    ✅ Patient identified: Donald Maceachern
[16:15:29] ✅    ✅ Patient name validation passed
[16:15:29] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:29] [DOC: 9220450] ℹ️  DOB normalized: 11/18/1939
[16:15:29] [DOC: 9220450] ✅ Patient date processing completed successfully
[16:15:29] ✅    ✅ Date processing completed
[16:15:29] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[16:15:29] 🔄 
🔄 Step 4: Extracting order data...
[16:15:31] ℹ️  Order extraction - MRN: '3170225'
[16:15:31] ℹ️  Order extraction - Sex: 'MALE'
[16:15:31] ℹ️  Order extraction - Service Line: ''
[16:15:31] ℹ️  Order extraction - Payer Source: ''
[16:15:31] ✅ Order data extraction completed successfully
[16:15:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:31] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[16:15:31] ✅ Patient name cross-validation successful
[16:15:31] ✅    ✅ Data merged successfully
[16:15:32] ✅    ✅ Order data extracted and validated
[16:15:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:32] [DOC: 9220450] ✅ Patient found in local cache: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:15:32] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:15:32] 🔄 
🔄 Step 6: Pushing order to API...
[16:15:32] [DOC: 9220450] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:15:34] [DOC: 9220450] ❌ Order push failed with status 201: {"id":"4424f3cc-c086-454a-9093-b8a3cc686bc5","orderWAVId":"ORD20065","orderNo":"1078060","orderDate":"04/02/2025","startOfCare":"02/24/2025","episodeStartDate":"02/24/2025","episodeEndDate":"02/24/2026","documentID":"9220450","mrn":"3170225","patientName":"Maceachern,Donald L","sentToPhysicianDate":"04/03/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"7af7c208-09d9-45bc-a97b-f457df90d626","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:15:34] ❌    ❌ Failed to push order
[16:15:34] 🔄 
🔄 Step 7: Writing to CSV...
[16:15:34] [DOC: 9220450] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[16:15:34] [DOC: 9220450] ℹ️  Service Line extracted: ''
[16:15:34] [DOC: 9220450] ℹ️  Payer Source extracted: ''
[16:15:34] [DOC: 9220450] ℹ️  Diagnosis codes being written:
[16:15:34] [DOC: 9220450] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:15:34] [DOC: 9220450] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:15:34] [DOC: 9220450] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:15:34] [DOC: 9220450] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:15:34] [DOC: 9220450] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:15:34] [DOC: 9220450] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:15:34] [DOC: 9220450] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service:  | Payer:  | MRN: 3170225
[16:15:34] ✅    ✅ Document 9220450 processed and saved successfully
[16:15:34] 🔄 
🔄 Step 8: Saving API details...
[16:15:34] [DOC: 9220450] ℹ️  API push details saved for document 9220450
[16:15:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220446                         ║
================================================================================
[16:15:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:15:34] ℹ️  Date: 04/03/2025
[16:15:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:36] [DOC: 9220446] ✅ Text extracted using pdfplumber (906 chars)
[16:15:36] ✅    ✅ Text extracted using pdfplumber (906 chars)
[16:15:36] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:38] ℹ️  AI extracted raw sex value: 'F'
[16:15:38] ℹ️  AI extracted service line: 'OT'
[16:15:38] ℹ️  AI extracted payer source: ''
[16:15:38] ℹ️  AI extracted diagnoses:
[16:15:38] ℹ️    - Diagnosis 1: 'None'
[16:15:38] ℹ️    - Diagnosis 2: 'None'
[16:15:38] ℹ️    - Diagnosis 3: 'None'
[16:15:38] ℹ️    - Diagnosis 4: 'None'
[16:15:38] ℹ️    - Diagnosis 5: 'None'
[16:15:38] ℹ️    - Diagnosis 6: 'None'
[16:15:38] ℹ️  Final extracted MRN: '2653383'
[16:15:38] ℹ️  Final extracted Sex: 'FEMALE'
[16:15:38] ℹ️  Final extracted Service Line: 'OT'
[16:15:38] ℹ️  Final extracted Payer Source: ''
[16:15:38] ✅ Patient data extraction completed successfully
[16:15:38] ✅    ✅ Patient data extracted successfully
[16:15:38] 📊 Patient Response
     └─ patientFName: Amy
     └─ patientLName: Leonard
     └─ dob: 10/09/1970
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2653383
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:15:38] ✅    ✅ Patient identified: Amy Leonard
[16:15:38] ✅    ✅ Patient name validation passed
[16:15:38] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:38] [DOC: 9220446] ℹ️  DOB normalized: 10/09/1970
[16:15:38] [DOC: 9220446] ✅ Patient date processing completed successfully
[16:15:38] ✅    ✅ Date processing completed
[16:15:38] 📊 Processed Patient Data
     └─ patientFName: Amy
     └─ patientLName: Leonard
     └─ dob: 10/09/1970
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2653383
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[16:15:38] 🔄 
🔄 Step 4: Extracting order data...
[16:15:40] ℹ️  Order extraction - MRN: '2653383'
[16:15:40] ℹ️  Order extraction - Sex: 'FEMALE'
[16:15:40] ℹ️  Order extraction - Service Line: ''
[16:15:40] ℹ️  Order extraction - Payer Source: ''
[16:15:40] ✅ Order data extraction completed successfully
[16:15:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:40] ℹ️  Using MRN from patient data: '2653383' over '2653383'
[16:15:40] ℹ️  Using service line from patient data: 'OT'
[16:15:40] ✅ Patient name cross-validation successful
[16:15:40] ✅    ✅ Data merged successfully
[16:15:42] ✅    ✅ Order data extracted and validated
[16:15:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:46] [DOC: 9220446] ℹ️  Patient not found in cache or API: Amy Leonard
[16:15:46] [DOC: 9220446] ℹ️  Patient not found, creating new patient via API...
[16:15:46] [DOC: 9220446] ℹ️  Creating patient via API: Amy Leonard
[16:15:48] [DOC: 9220446] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:15:48] ❌    ❌ Failed to create patient
[16:15:48] [DOC: 9220446] ℹ️  API push details saved for document 9220446
================================================================================
║                        Processing Document ID: 9220439                         ║
================================================================================
[16:15:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:15:48] ℹ️  Date: 04/03/2025
[16:15:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:49] [DOC: 9220439] ✅ Text extracted using pdfplumber (1064 chars)
[16:15:49] ✅    ✅ Text extracted using pdfplumber (1064 chars)
[16:15:49] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:52] ℹ️  AI extracted raw sex value: 'F'
[16:15:52] ℹ️  AI extracted service line: 'Nursing'
[16:15:52] ℹ️  AI extracted payer source: ''
[16:15:52] ℹ️  AI extracted diagnoses:
[16:15:52] ℹ️    - Diagnosis 1: 'None'
[16:15:52] ℹ️    - Diagnosis 2: 'None'
[16:15:52] ℹ️    - Diagnosis 3: 'None'
[16:15:52] ℹ️    - Diagnosis 4: 'None'
[16:15:52] ℹ️    - Diagnosis 5: 'None'
[16:15:52] ℹ️    - Diagnosis 6: 'None'
[16:15:52] ℹ️  Final extracted MRN: '2611003'
[16:15:52] ℹ️  Final extracted Sex: 'FEMALE'
[16:15:52] ℹ️  Final extracted Service Line: 'Nursing'
[16:15:52] ℹ️  Final extracted Payer Source: ''
[16:15:52] ✅ Patient data extraction completed successfully
[16:15:52] ✅    ✅ Patient data extracted successfully
[16:15:52] 📊 Patient Response
     └─ patientFName: Johnnie-Ann
     └─ patientLName: Keighley
     └─ dob: 04/04/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2611003
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:15:52] ✅    ✅ Patient identified: Johnnie-Ann Keighley
[16:15:52] ✅    ✅ Patient name validation passed
[16:15:52] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:52] [DOC: 9220439] ℹ️  DOB normalized: 04/04/1945
[16:15:52] [DOC: 9220439] ✅ Patient date processing completed successfully
[16:15:52] ✅    ✅ Date processing completed
[16:15:52] 📊 Processed Patient Data
     └─ patientFName: Johnnie-Ann
     └─ patientLName: Keighley
     └─ dob: 04/04/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2611003
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[16:15:52] 🔄 
🔄 Step 4: Extracting order data...
[16:15:54] ℹ️  Order extraction - MRN: '2611003'
[16:15:54] ℹ️  Order extraction - Sex: 'FEMALE'
[16:15:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:15:54] ℹ️  Order extraction - Payer Source: ''
[16:15:54] ✅ Order data extraction completed successfully
[16:15:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:54] ℹ️  Using MRN from patient data: '2611003' over '2611003'
[16:15:54] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[16:15:54] ✅ Patient name cross-validation successful
[16:15:54] ✅    ✅ Data merged successfully
[16:15:55] ✅    ✅ Order data extracted and validated
[16:15:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:55] [DOC: 9220439] ✅ Patient found in local cache: Johnnie-Ann Keighley, ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[16:15:55] ✅    ✅ Existing patient found with ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[16:15:55] 🔄 
🔄 Step 6: Pushing order to API...
[16:15:55] [DOC: 9220439] ℹ️  Pushing order via API for patient ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[16:15:57] [DOC: 9220439] ❌ Order push failed with status 201: {"id":"a984e3d9-3af6-464a-b5aa-3af1095e9fcf","orderWAVId":"ORD20066","orderNo":"1077967","orderDate":"04/02/2025","startOfCare":"04/06/2018","episodeStartDate":"04/06/2018","episodeEndDate":"06/04/2018","documentID":"9220439","mrn":"2611003","patientName":"Keighley,Johnnie-Ann","sentToPhysicianDate":"04/03/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Updated Patient Reported Medications","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"9a5d9789-6f14-49d5-8385-ec991990de31","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:15:57] ❌    ❌ Failed to push order
[16:15:57] 🔄 
🔄 Step 7: Writing to CSV...
[16:15:57] [DOC: 9220439] ℹ️  Calculated age: 80 from DOB: 04/04/1945
[16:15:57] [DOC: 9220439] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[16:15:57] [DOC: 9220439] ℹ️  Payer Source extracted: ''
[16:15:57] [DOC: 9220439] ℹ️  Diagnosis codes being written:
[16:15:57] [DOC: 9220439] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:15:57] [DOC: 9220439] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:15:57] [DOC: 9220439] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:15:57] [DOC: 9220439] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:15:57] [DOC: 9220439] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:15:57] [DOC: 9220439] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:15:57] [DOC: 9220439] ✅ Patient data written to CSV: Johnnie-Ann Keighley | Sex: FEMALE | Age: 80 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2611003
[16:15:57] ✅    ✅ Document 9220439 processed and saved successfully
[16:15:57] 🔄 
🔄 Step 8: Saving API details...
[16:15:57] [DOC: 9220439] ℹ️  API push details saved for document 9220439
[16:15:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220436                         ║
================================================================================
[16:15:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:15:57] ℹ️  Date: 04/03/2025
[16:15:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:16:08] [DOC: 9220436] ✅ Text extracted using pdfplumber (40721 chars)
[16:16:08] ✅    ✅ Text extracted using pdfplumber (40721 chars)
[16:16:08] 🔄 
🔄 Step 2: Extracting patient data...
[16:16:12] ℹ️  AI extracted raw sex value: 'F'
[16:16:12] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, HHA, Clergy'
[16:16:12] ℹ️  AI extracted payer source: ''
[16:16:12] ℹ️  AI extracted diagnoses:
[16:16:12] ℹ️    - Diagnosis 1: 'C34.91'
[16:16:12] ℹ️    - Diagnosis 2: 'C34.90'
[16:16:12] ℹ️    - Diagnosis 3: 'J90'
[16:16:12] ℹ️    - Diagnosis 4: 'R06.09'
[16:16:12] ℹ️    - Diagnosis 5: 'D63.8'
[16:16:12] ℹ️    - Diagnosis 6: 'E07.81'
[16:16:12] ℹ️  Final extracted MRN: '2075030'
[16:16:12] ℹ️  Final extracted Sex: 'FEMALE'
[16:16:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, HHA, Clergy'
[16:16:12] ℹ️  Final extracted Payer Source: ''
[16:16:12] ✅ Patient data extraction completed successfully
[16:16:12] ✅    ✅ Patient data extracted successfully
[16:16:12] 📊 Patient Response
     └─ patientFName: Victoria
     └─ patientLName: Gintis
     └─ dob: 12/02/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2075030
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, MSW, HHA, Clergy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'C34.91', 'secondDiagnosis': 'C34.90', 'thirdDiagnosis': 'J90', 'fourthDiagnosis': 'R06.09', 'fifthDiagnosis': 'D63.8', 'sixthDiagnosis': 'E07.81'}]
[16:16:12] ✅    ✅ Patient identified: Victoria Gintis
[16:16:12] ✅    ✅ Patient name validation passed
[16:16:12] 🔄 
🔄 Step 3: Processing patient dates...
[16:16:12] [DOC: 9220436] ℹ️  DOB normalized: 12/02/1947
[16:16:12] [DOC: 9220436] ℹ️  Episode startOfCare normalized: 03/28/2025
[16:16:12] [DOC: 9220436] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[16:16:12] [DOC: 9220436] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[16:16:12] [DOC: 9220436] ✅ Patient date processing completed successfully
[16:16:12] ✅    ✅ Date processing completed
[16:16:12] 📊 Processed Patient Data
     └─ patientFName: Victoria
     └─ patientLName: Gintis
     └─ dob: 12/02/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2075030
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, MSW, HHA, Clergy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'C34.91', 'secondDiagnosis': 'C34.90', 'thirdDiagnosis': 'J90', 'fourthDiagnosis': 'R06.09', 'fifthDiagnosis': 'D63.8', 'sixthDiagnosis': 'E07.81'}]
[16:16:12] 🔄 
🔄 Step 4: Extracting order data...
[16:16:15] ℹ️  Order extraction - MRN: '2075030'
[16:16:15] ℹ️  Order extraction - Sex: 'FEMALE'
[16:16:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[16:16:15] ℹ️  Order extraction - Payer Source: ''
[16:16:15] ✅ Order data extraction completed successfully
[16:16:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:16:15] ℹ️  Using MRN from patient data: '2075030' over '2075030'
[16:16:15] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, HHA, Clergy' + Order='Skilled Nursing, MSW, HHA' = 'Clergy, HHA, MSW, Skilled Nursing'
[16:16:15] ✅ Patient name cross-validation successful
[16:16:15] ✅    ✅ Data merged successfully
[16:16:16] ✅    ✅ Order data extracted and validated
[16:16:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:16:38] [DOC: 9220436] ℹ️  Patient not found in cache or API: Victoria Gintis
[16:16:38] [DOC: 9220436] ℹ️  Patient not found, creating new patient via API...
[16:16:38] [DOC: 9220436] ℹ️  Creating patient via API: Victoria Gintis
[16:16:39] [DOC: 9220436] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:16:39] ❌    ❌ Failed to create patient
[16:16:39] [DOC: 9220436] ℹ️  API push details saved for document 9220436
================================================================================
║                        Processing Document ID: 9220434                         ║
================================================================================
[16:16:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:16:39] ℹ️  Date: 04/03/2025
[16:16:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:16:43] [DOC: 9220434] ✅ Text extracted using pdfplumber (24227 chars)
[16:16:43] ✅    ✅ Text extracted using pdfplumber (24217 chars)
[16:16:43] 🔄 
🔄 Step 2: Extracting patient data...
[16:16:46] ℹ️  AI extracted raw sex value: 'F'
[16:16:46] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide'
[16:16:46] ℹ️  AI extracted payer source: ''
[16:16:46] ℹ️  AI extracted diagnoses:
[16:16:46] ℹ️    - Diagnosis 1: 'C34.11'
[16:16:46] ℹ️    - Diagnosis 2: 'C78.02'
[16:16:46] ℹ️    - Diagnosis 3: 'J91.0'
[16:16:46] ℹ️    - Diagnosis 4: 'J93.83'
[16:16:46] ℹ️    - Diagnosis 5: 'Z48.03'
[16:16:46] ℹ️    - Diagnosis 6: 'G89.3'
[16:16:46] ℹ️  Final extracted MRN: '2075030'
[16:16:46] ℹ️  Final extracted Sex: 'FEMALE'
[16:16:46] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide'
[16:16:46] ℹ️  Final extracted Payer Source: ''
[16:16:46] ✅ Patient data extraction completed successfully
[16:16:46] ✅    ✅ Patient data extracted successfully
[16:16:46] 📊 Patient Response
     └─ patientFName: Victoria
     └─ patientLName: Gintis
     └─ dob: 12/02/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2075030
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'C34.11', 'secondDiagnosis': 'C78.02', 'thirdDiagnosis': 'J91.0', 'fourthDiagnosis': 'J93.83', 'fifthDiagnosis': 'Z48.03', 'sixthDiagnosis': 'G89.3'}]
[16:16:46] ✅    ✅ Patient identified: Victoria Gintis
[16:16:46] ✅    ✅ Patient name validation passed
[16:16:46] 🔄 
🔄 Step 3: Processing patient dates...
[16:16:46] [DOC: 9220434] ℹ️  DOB normalized: 12/02/1947
[16:16:46] [DOC: 9220434] ℹ️  Episode startOfCare normalized: 03/20/2025
[16:16:46] [DOC: 9220434] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:16:46] [DOC: 9220434] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:16:46] [DOC: 9220434] ✅ Patient date processing completed successfully
[16:16:46] ✅    ✅ Date processing completed
[16:16:46] 📊 Processed Patient Data
     └─ patientFName: Victoria
     └─ patientLName: Gintis
     └─ dob: 12/02/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2075030
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'C34.11', 'secondDiagnosis': 'C78.02', 'thirdDiagnosis': 'J91.0', 'fourthDiagnosis': 'J93.83', 'fifthDiagnosis': 'Z48.03', 'sixthDiagnosis': 'G89.3'}]
[16:16:46] 🔄 
🔄 Step 4: Extracting order data...
[16:16:49] ℹ️  Order extraction - MRN: '2075030'
[16:16:49] ℹ️  Order extraction - Sex: 'FEMALE'
[16:16:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:16:49] ℹ️  Order extraction - Payer Source: ''
[16:16:49] ✅ Order data extraction completed successfully
[16:16:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:16:49] ℹ️  Using MRN from patient data: '2075030' over '2075030'
[16:16:49] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[16:16:49] ✅ Patient name cross-validation successful
[16:16:49] ✅    ✅ Data merged successfully
[16:16:51] ✅    ✅ Order data extracted and validated
[16:16:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:16:56] [DOC: 9220434] ℹ️  Patient not found in cache or API: Victoria Gintis
[16:16:56] [DOC: 9220434] ℹ️  Patient not found, creating new patient via API...
[16:16:56] [DOC: 9220434] ℹ️  Creating patient via API: Victoria Gintis
[16:16:57] [DOC: 9220434] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:16:57] ❌    ❌ Failed to create patient
[16:16:57] [DOC: 9220434] ℹ️  API push details saved for document 9220434
================================================================================
║                        Processing Document ID: 9220426                         ║
================================================================================
[16:16:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:16:57] ℹ️  Date: 04/03/2025
[16:16:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:00] [DOC: 9220426] ✅ Text extracted using pdfplumber (11039 chars)
[16:17:00] ✅    ✅ Text extracted using pdfplumber (11029 chars)
[16:17:00] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:04] ℹ️  AI extracted raw sex value: 'F'
[16:17:04] ℹ️  AI extracted service line: 'Physical Therapy, Skilled nursing'
[16:17:04] ℹ️  AI extracted payer source: ''
[16:17:04] ℹ️  AI extracted diagnoses:
[16:17:04] ℹ️    - Diagnosis 1: 'G89.29'
[16:17:04] ℹ️    - Diagnosis 2: 'M54.9'
[16:17:04] ℹ️    - Diagnosis 3: 'I10'
[16:17:04] ℹ️    - Diagnosis 4: 'I48.91'
[16:17:04] ℹ️    - Diagnosis 5: 'R25.1'
[16:17:04] ℹ️    - Diagnosis 6: 'G40.909'
[16:17:04] ℹ️  Final extracted MRN: '2478524'
[16:17:04] ℹ️  Final extracted Sex: 'FEMALE'
[16:17:04] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled nursing'
[16:17:04] ℹ️  Final extracted Payer Source: ''
[16:17:04] ✅ Patient data extraction completed successfully
[16:17:04] ✅    ✅ Patient data extracted successfully
[16:17:04] 📊 Patient Response
     └─ patientFName: Madelyn
     └─ patientLName: Fogler
     └─ dob: 11/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2478524
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'R25.1', 'sixthDiagnosis': 'G40.909'}]
[16:17:04] ✅    ✅ Patient identified: Madelyn Fogler
[16:17:04] ✅    ✅ Patient name validation passed
[16:17:04] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:04] [DOC: 9220426] ℹ️  DOB normalized: 11/26/1929
[16:17:04] [DOC: 9220426] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:17:04] [DOC: 9220426] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:17:04] [DOC: 9220426] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:17:04] [DOC: 9220426] ✅ Patient date processing completed successfully
[16:17:04] ✅    ✅ Date processing completed
[16:17:04] 📊 Processed Patient Data
     └─ patientFName: Madelyn
     └─ patientLName: Fogler
     └─ dob: 11/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2478524
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'R25.1', 'sixthDiagnosis': 'G40.909'}]
[16:17:04] 🔄 
🔄 Step 4: Extracting order data...
[16:17:07] ℹ️  Order extraction - MRN: '2478524'
[16:17:07] ℹ️  Order extraction - Sex: 'FEMALE'
[16:17:07] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[16:17:07] ℹ️  Order extraction - Payer Source: ''
[16:17:07] ✅ Order data extraction completed successfully
[16:17:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:07] ℹ️  Using MRN from patient data: '2478524' over '2478524'
[16:17:07] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled nursing'
[16:17:07] ✅ Patient name cross-validation successful
[16:17:07] ✅    ✅ Data merged successfully
[16:17:08] ✅    ✅ Order data extracted and validated
[16:17:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:17:17] [DOC: 9220426] ✅ Patient exists in API: Madelyn Fogler, ID: fd2515dc-47b1-4d44-8514-4cee0548eeec
[16:17:17] ✅    ✅ Existing patient found with ID: fd2515dc-47b1-4d44-8514-4cee0548eeec
[16:17:17] 🔄 
🔄 Step 6: Pushing order to API...
[16:17:17] [DOC: 9220426] ℹ️  Pushing order via API for patient ID: fd2515dc-47b1-4d44-8514-4cee0548eeec
[16:17:19] [DOC: 9220426] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14090"}
[16:17:19] ❌    ❌ Failed to push order
[16:17:19] 🔄 
🔄 Step 7: Writing to CSV...
[16:17:19] [DOC: 9220426] ℹ️  Calculated age: 95 from DOB: 11/26/1929
[16:17:19] [DOC: 9220426] ℹ️  Service Line extracted: 'Physical Therapy, Skilled nursing'
[16:17:19] [DOC: 9220426] ℹ️  Payer Source extracted: ''
[16:17:19] [DOC: 9220426] ℹ️  Diagnosis codes being written:
[16:17:19] [DOC: 9220426] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.29'
[16:17:19] [DOC: 9220426] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.9'
[16:17:19] [DOC: 9220426] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[16:17:19] [DOC: 9220426] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.91'
[16:17:19] [DOC: 9220426] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R25.1'
[16:17:19] [DOC: 9220426] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G40.909'
[16:17:19] [DOC: 9220426] ✅ Patient data written to CSV: Madelyn Fogler | Sex: FEMALE | Age: 95 | Service: Physical Therapy, Skilled nursing | Payer:  | MRN: 2478524
[16:17:19] ✅    ✅ Document 9220426 processed and saved successfully
[16:17:19] 🔄 
🔄 Step 8: Saving API details...
[16:17:19] [DOC: 9220426] ℹ️  API push details saved for document 9220426
[16:17:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9220411                         ║
================================================================================
[16:17:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:17:19] ℹ️  Date: 04/03/2025
[16:17:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:22] [DOC: 9220411] ✅ Text extracted using pdfplumber (21055 chars)
[16:17:22] ✅    ✅ Text extracted using pdfplumber (21055 chars)
[16:17:22] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:26] ℹ️  AI extracted raw sex value: 'M'
[16:17:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:17:26] ℹ️  AI extracted payer source: ''
[16:17:26] ℹ️  AI extracted diagnoses:
[16:17:26] ℹ️    - Diagnosis 1: 'E11.59'
[16:17:26] ℹ️    - Diagnosis 2: 'I13.0'
[16:17:26] ℹ️    - Diagnosis 3: 'I50.33'
[16:17:26] ℹ️    - Diagnosis 4: 'E11.22'
[16:17:26] ℹ️    - Diagnosis 5: 'N18.31'
[16:17:26] ℹ️    - Diagnosis 6: 'J44.1'
[16:17:26] ℹ️  Final extracted MRN: '2365864'
[16:17:26] ℹ️  Final extracted Sex: 'MALE'
[16:17:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:17:26] ℹ️  Final extracted Payer Source: ''
[16:17:26] ✅ Patient data extraction completed successfully
[16:17:26] ✅    ✅ Patient data extracted successfully
[16:17:26] 📊 Patient Response
     └─ patientFName: Gil
     └─ patientLName: Couto
     └─ dob: 11/11/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2365864
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.33', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'J44.1'}]
[16:17:26] ✅    ✅ Patient identified: Gil Couto
[16:17:26] ✅    ✅ Patient name validation passed
[16:17:26] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:26] [DOC: 9220411] ℹ️  DOB normalized: 11/11/1950
[16:17:26] [DOC: 9220411] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:17:26] [DOC: 9220411] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[16:17:26] [DOC: 9220411] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[16:17:26] [DOC: 9220411] ✅ Patient date processing completed successfully
[16:17:26] ✅    ✅ Date processing completed
[16:17:26] 📊 Processed Patient Data
     └─ patientFName: Gil
     └─ patientLName: Couto
     └─ dob: 11/11/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2365864
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.33', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'J44.1'}]
[16:17:26] 🔄 
🔄 Step 4: Extracting order data...
[16:17:28] ℹ️  Order extraction - MRN: '2365864'
[16:17:28] ℹ️  Order extraction - Sex: 'MALE'
[16:17:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:17:28] ℹ️  Order extraction - Payer Source: ''
[16:17:28] ✅ Order data extraction completed successfully
[16:17:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:28] ℹ️  Using MRN from patient data: '2365864' over '2365864'
[16:17:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:17:28] ✅ Patient name cross-validation successful
[16:17:28] ✅    ✅ Data merged successfully
[16:17:30] ✅    ✅ Order data extracted and validated
[16:17:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:17:39] [DOC: 9220411] ℹ️  Patient not found in cache or API: Gil Couto
[16:17:39] [DOC: 9220411] ℹ️  Patient not found, creating new patient via API...
[16:17:39] [DOC: 9220411] ℹ️  Creating patient via API: Gil Couto
[16:17:40] [DOC: 9220411] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:17:40] ❌    ❌ Failed to create patient
[16:17:40] [DOC: 9220411] ℹ️  API push details saved for document 9220411
================================================================================
║                        Processing Document ID: 9220405                         ║
================================================================================
[16:17:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:17:40] ℹ️  Date: 04/03/2025
[16:17:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:41] [DOC: 9220405] ✅ Text extracted using pdfplumber (2007 chars)
[16:17:41] ✅    ✅ Text extracted using pdfplumber (2007 chars)
[16:17:41] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:43] ℹ️  AI extracted raw sex value: 'F'
[16:17:43] ℹ️  AI extracted service line: 'Nursing'
[16:17:43] ℹ️  AI extracted payer source: ''
[16:17:43] ℹ️  AI extracted diagnoses:
[16:17:43] ℹ️    - Diagnosis 1: ''
[16:17:43] ℹ️    - Diagnosis 2: ''
[16:17:43] ℹ️    - Diagnosis 3: ''
[16:17:43] ℹ️    - Diagnosis 4: ''
[16:17:43] ℹ️    - Diagnosis 5: ''
[16:17:43] ℹ️    - Diagnosis 6: ''
[16:17:43] ℹ️  Final extracted MRN: '2183742'
[16:17:43] ℹ️  Final extracted Sex: 'FEMALE'
[16:17:43] ℹ️  Final extracted Service Line: 'Nursing'
[16:17:43] ℹ️  Final extracted Payer Source: ''
[16:17:43] ✅ Patient data extraction completed successfully
[16:17:43] ✅    ✅ Patient data extracted successfully
[16:17:43] 📊 Patient Response
     └─ patientFName: Amelia
     └─ patientLName: Amaral
     └─ dob: 01/07/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2183742
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:43] ✅    ✅ Patient identified: Amelia Amaral
[16:17:43] ✅    ✅ Patient name validation passed
[16:17:43] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:43] [DOC: 9220405] ℹ️  DOB normalized: 01/07/1930
[16:17:43] [DOC: 9220405] ✅ Patient date processing completed successfully
[16:17:43] ✅    ✅ Date processing completed
[16:17:43] 📊 Processed Patient Data
     └─ patientFName: Amelia
     └─ patientLName: Amaral
     └─ dob: 01/07/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2183742
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:43] 🔄 
🔄 Step 4: Extracting order data...
[16:17:46] ℹ️  Order extraction - MRN: '2183742'
[16:17:46] ℹ️  Order extraction - Sex: 'FEMALE'
[16:17:46] ℹ️  Order extraction - Service Line: 'Nursing'
[16:17:46] ℹ️  Order extraction - Payer Source: ''
[16:17:46] ✅ Order data extraction completed successfully
[16:17:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:46] ℹ️  Using MRN from patient data: '2183742' over '2183742'
[16:17:46] ℹ️  Service line consistent in both sources: 'Nursing'
[16:17:46] ✅ Patient name cross-validation successful
[16:17:46] ✅    ✅ Data merged successfully
[16:17:47] ⚠️     ❌ Skipping - missing episode start date
[16:17:47] [DOC: 9220405] ℹ️  API push details saved for document 9220405
================================================================================
║                        Processing Document ID: 9220404                         ║
================================================================================
[16:17:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:17:47] ℹ️  Date: 04/03/2025
[16:17:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:51] [DOC: 9220404] ✅ Text extracted using pdfplumber (23449 chars)
[16:17:51] ✅    ✅ Text extracted using pdfplumber (23449 chars)
[16:17:51] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:54] ℹ️  AI extracted raw sex value: 'F'
[16:17:54] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[16:17:54] ℹ️  AI extracted payer source: ''
[16:17:54] ℹ️  AI extracted diagnoses:
[16:17:54] ℹ️    - Diagnosis 1: 'G31.1'
[16:17:54] ℹ️    - Diagnosis 2: 'R53.81'
[16:17:54] ℹ️    - Diagnosis 3: 'R41.89'
[16:17:54] ℹ️    - Diagnosis 4: 'F41.9, F32.A'
[16:17:54] ℹ️    - Diagnosis 5: 'S52.521S'
[16:17:54] ℹ️    - Diagnosis 6: 'W19.XXXS'
[16:17:54] ℹ️  Final extracted MRN: '2183742'
[16:17:54] ℹ️  Final extracted Sex: 'FEMALE'
[16:17:54] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[16:17:54] ℹ️  Final extracted Payer Source: ''
[16:17:54] ✅ Patient data extraction completed successfully
[16:17:54] ✅    ✅ Patient data extracted successfully
[16:17:54] 📊 Patient Response
     └─ patientFName: Amelia
     └─ patientLName: Amaral
     └─ dob: 01/07/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2183742
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'R53.81', 'thirdDiagnosis': 'R41.89', 'fourthDiagnosis': 'F41.9, F32.A', 'fifthDiagnosis': 'S52.521S', 'sixthDiagnosis': 'W19.XXXS'}]
[16:17:54] ✅    ✅ Patient identified: Amelia Amaral
[16:17:54] ✅    ✅ Patient name validation passed
[16:17:54] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:54] [DOC: 9220404] ℹ️  DOB normalized: 01/07/1930
[16:17:54] [DOC: 9220404] ℹ️  Episode startOfCare normalized: 03/28/2025
[16:17:54] [DOC: 9220404] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[16:17:54] [DOC: 9220404] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[16:17:54] [DOC: 9220404] ✅ Patient date processing completed successfully
[16:17:54] ✅    ✅ Date processing completed
[16:17:54] 📊 Processed Patient Data
     └─ patientFName: Amelia
     └─ patientLName: Amaral
     └─ dob: 01/07/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2183742
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'R53.81', 'thirdDiagnosis': 'R41.89', 'fourthDiagnosis': 'F41.9, F32.A', 'fifthDiagnosis': 'S52.521S', 'sixthDiagnosis': 'W19.XXXS'}]
[16:17:54] 🔄 
🔄 Step 4: Extracting order data...
[16:17:57] ℹ️  Order extraction - MRN: '2183742'
[16:17:57] ℹ️  Order extraction - Sex: 'FEMALE'
[16:17:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[16:17:57] ℹ️  Order extraction - Payer Source: ''
[16:17:57] ✅ Order data extraction completed successfully
[16:17:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:57] ℹ️  Using MRN from patient data: '2183742' over '2183742'
[16:17:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[16:17:57] ✅ Patient name cross-validation successful
[16:17:57] ✅    ✅ Data merged successfully
[16:17:58] ✅    ✅ Order data extracted and validated
[16:17:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:18:26] [DOC: 9220404] ℹ️  Patient not found in cache or API: Amelia Amaral
[16:18:26] [DOC: 9220404] ℹ️  Patient not found, creating new patient via API...
[16:18:26] [DOC: 9220404] ℹ️  Creating patient via API: Amelia Amaral
[16:18:27] [DOC: 9220404] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:18:27] ❌    ❌ Failed to create patient
[16:18:27] [DOC: 9220404] ℹ️  API push details saved for document 9220404
================================================================================
║                        Processing Document ID: 9220300                         ║
================================================================================
[16:18:27] ℹ️  Agency: AccentCare Fall River
[16:18:27] ℹ️  Date: 04/03/2025
[16:18:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:18:31] [DOC: 9220300] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[16:18:32] [DOC: 9220300] ✅ Text extracted using tesseract_ocr (1291 chars)
[16:18:32] ✅    ✅ Text extracted using tesseract_ocr (1282 chars)
[16:18:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:18:35] ℹ️  AI extracted raw sex value: ''
[16:18:35] ℹ️  AI extracted service line: 'PT, OT'
[16:18:35] ℹ️  AI extracted payer source: ''
[16:18:35] ℹ️  AI extracted diagnoses:
[16:18:35] ℹ️    - Diagnosis 1: 'None'
[16:18:35] ℹ️    - Diagnosis 2: 'None'
[16:18:35] ℹ️    - Diagnosis 3: 'None'
[16:18:35] ℹ️    - Diagnosis 4: 'None'
[16:18:35] ℹ️    - Diagnosis 5: 'None'
[16:18:35] ℹ️    - Diagnosis 6: 'None'
[16:18:35] ℹ️  Final extracted MRN: 'C0200231525501'
[16:18:35] ℹ️  Final extracted Sex: ''
[16:18:35] ℹ️  Final extracted Service Line: 'PT, OT'
[16:18:35] ℹ️  Final extracted Payer Source: ''
[16:18:35] ✅ Patient data extraction completed successfully
[16:18:35] ✅    ✅ Patient data extracted successfully
[16:18:35] 📊 Patient Response
     └─ patientFName: KAREN
     └─ patientLName: AGUIAR
     └─ dob: 12/18/1970
     └─ patientSex: 
     └─ medicalRecordNo: C0200231525501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:18:35] ✅    ✅ Patient identified: KAREN AGUIAR
[16:18:35] ✅    ✅ Patient name validation passed
[16:18:35] 🔄 
🔄 Step 3: Processing patient dates...
[16:18:35] [DOC: 9220300] ℹ️  DOB normalized: 12/18/1970
[16:18:35] [DOC: 9220300] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[16:18:35] [DOC: 9220300] ℹ️  Episode endOfEpisode normalized: 02/25/2025
[16:18:35] [DOC: 9220300] ✅ Patient date processing completed successfully
[16:18:35] ✅    ✅ Date processing completed
[16:18:35] 📊 Processed Patient Data
     └─ patientFName: KAREN
     └─ patientLName: AGUIAR
     └─ dob: 12/18/1970
     └─ patientSex: 
     └─ medicalRecordNo: C0200231525501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '02/25/2025'}]
[16:18:35] 🔄 
🔄 Step 4: Extracting order data...
[16:18:38] ℹ️  Order extraction - MRN: 'C0200231525501'
[16:18:38] ℹ️  Order extraction - Sex: ''
[16:18:38] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:18:38] ℹ️  Order extraction - Payer Source: ''
[16:18:38] ✅ Order data extraction completed successfully
[16:18:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:18:38] ℹ️  Using MRN from patient data: 'C0200231525501' over 'C0200231525501'
[16:18:38] ℹ️  Inferred sex as FEMALE from name: KAREN
[16:18:38] ℹ️  Service line consistent in both sources: 'PT, OT'
[16:18:38] ✅ Patient name cross-validation successful
[16:18:38] ✅    ✅ Data merged successfully
[16:18:39] ✅    ✅ Order data extracted and validated
[16:18:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:18:45] [DOC: 9220300] ℹ️  Patient not found in cache or API: KAREN AGUIAR
[16:18:45] [DOC: 9220300] ℹ️  Patient not found, creating new patient via API...
[16:18:45] [DOC: 9220300] ℹ️  Creating patient via API: KAREN AGUIAR
[16:18:47] [DOC: 9220300] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:18:47] ❌    ❌ Failed to create patient
[16:18:47] [DOC: 9220300] ℹ️  API push details saved for document 9220300
================================================================================
║                        Processing Document ID: 9220288                         ║
================================================================================
[16:18:47] ℹ️  Agency: AccentCare Fall River
[16:18:47] ℹ️  Date: 04/03/2025
[16:18:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:18:50] [DOC: 9220288] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[16:18:52] [DOC: 9220288] ✅ Text extracted using tesseract_ocr (1819 chars)
[16:18:52] ✅    ✅ Text extracted using tesseract_ocr (1810 chars)
[16:18:52] 🔄 
🔄 Step 2: Extracting patient data...
[16:18:54] ℹ️  AI extracted raw sex value: ''
[16:18:54] ℹ️  AI extracted service line: 'RN'
[16:18:54] ℹ️  AI extracted payer source: ''
[16:18:54] ℹ️  AI extracted diagnoses:
[16:18:54] ℹ️    - Diagnosis 1: ''
[16:18:54] ℹ️    - Diagnosis 2: ''
[16:18:54] ℹ️    - Diagnosis 3: ''
[16:18:54] ℹ️    - Diagnosis 4: ''
[16:18:54] ℹ️    - Diagnosis 5: ''
[16:18:54] ℹ️    - Diagnosis 6: ''
[16:18:54] ℹ️  Final extracted MRN: 'C0200155388301'
[16:18:54] ℹ️  Final extracted Sex: ''
[16:18:54] ℹ️  Final extracted Service Line: 'RN'
[16:18:54] ℹ️  Final extracted Payer Source: ''
[16:18:54] ✅ Patient data extraction completed successfully
[16:18:54] ✅    ✅ Patient data extracted successfully
[16:18:54] 📊 Patient Response
     └─ patientFName: MARIE
     └─ patientLName: MONDELLO
     └─ dob: 09/23/1939
     └─ patientSex: 
     └─ medicalRecordNo: C0200155388301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:18:54] ✅    ✅ Patient identified: MARIE MONDELLO
[16:18:54] ✅    ✅ Patient name validation passed
[16:18:54] 🔄 
🔄 Step 3: Processing patient dates...
[16:18:54] [DOC: 9220288] ℹ️  DOB normalized: 09/23/1939
[16:18:54] [DOC: 9220288] ✅ Patient date processing completed successfully
[16:18:54] ✅    ✅ Date processing completed
[16:18:54] 📊 Processed Patient Data
     └─ patientFName: MARIE
     └─ patientLName: MONDELLO
     └─ dob: 09/23/1939
     └─ patientSex: 
     └─ medicalRecordNo: C0200155388301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:18:54] 🔄 
🔄 Step 4: Extracting order data...
[16:18:57] ℹ️  Order extraction - MRN: 'C0200155388301'
[16:18:57] ℹ️  Order extraction - Sex: ''
[16:18:57] ℹ️  Order extraction - Service Line: 'RN'
[16:18:57] ℹ️  Order extraction - Payer Source: ''
[16:18:57] ✅ Order data extraction completed successfully
[16:18:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:18:57] ℹ️  Using MRN from patient data: 'C0200155388301' over 'C0200155388301'
[16:18:57] ℹ️  Inferred sex as FEMALE from name: MARIE
[16:18:57] ℹ️  Service line consistent in both sources: 'RN'
[16:18:57] ⚠️  Patient name mismatch: Order='MONDELO, MARIE' vs Patient='MARIE MONDELLO'
[16:18:57] ✅    ✅ Data merged successfully
[16:18:58] ✅    ✅ Order data extracted and validated
[16:18:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:19:04] [DOC: 9220288] ✅ Patient exists in API: MARIE MONDELLO, ID: 9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4
[16:19:04] ✅    ✅ Existing patient found with ID: 9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4
[16:19:04] 🔄 
🔄 Step 6: Pushing order to API...
[16:19:04] [DOC: 9220288] ℹ️  Pushing order via API for patient ID: 9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4
[16:19:06] [DOC: 9220288] ❌ Order push failed with status 201: {"id":"b5e2f6b9-ca4a-40a2-b207-60aa7cece84b","orderWAVId":"ORD20067","orderNo":"11969434","orderDate":"04/03/2025","startOfCare":"02/10/2025","episodeStartDate":"02/10/2025","episodeEndDate":"04/10/2025","documentID":"9220288","mrn":"C0200155388301","patientName":"MONDELO, MARIE","sentToPhysicianDate":"04/03/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"PHYSICIAN ORDER","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"9bfffa27-6feb-46d5-a6a8-c2cb92a1f8c4","companyId":"c7cc6389-e15a-468f-bfbc-bc60ac4d4e81","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:19:06] ❌    ❌ Failed to push order
[16:19:06] 🔄 
🔄 Step 7: Writing to CSV...
[16:19:06] [DOC: 9220288] ℹ️  Calculated age: 85 from DOB: 09/23/1939
[16:19:06] [DOC: 9220288] ℹ️  Service Line extracted: 'RN'
[16:19:06] [DOC: 9220288] ℹ️  Payer Source extracted: ''
[16:19:06] [DOC: 9220288] ℹ️  Diagnosis codes being written:
[16:19:06] [DOC: 9220288] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:19:06] [DOC: 9220288] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:19:06] [DOC: 9220288] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:19:06] [DOC: 9220288] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:19:06] [DOC: 9220288] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:19:06] [DOC: 9220288] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:19:06] [DOC: 9220288] ✅ Patient data written to CSV: MARIE MONDELLO | Sex: FEMALE | Age: 85 | Service: RN | Payer:  | MRN: C0200155388301
[16:19:06] ✅    ✅ Document 9220288 processed and saved successfully
[16:19:06] 🔄 
🔄 Step 8: Saving API details...
[16:19:06] [DOC: 9220288] ℹ️  API push details saved for document 9220288
[16:19:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189416                         ║
================================================================================
[16:19:06] ℹ️  Agency: Brigham Home Care Services.Inc
[16:19:06] ℹ️  Date: 04/03/2025
[16:19:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:19:07] [DOC: 9189416] ✅ Text extracted using pdfplumber (12415 chars)
[16:19:07] ✅    ✅ Text extracted using pdfplumber (12415 chars)
[16:19:07] 🔄 
🔄 Step 2: Extracting patient data...
[16:19:10] ℹ️  AI extracted raw sex value: ''
[16:19:10] ℹ️  AI extracted service line: ''
[16:19:10] ℹ️  AI extracted payer source: ''
[16:19:10] ℹ️  AI extracted diagnoses:
[16:19:10] ℹ️    - Diagnosis 1: ''
[16:19:10] ℹ️    - Diagnosis 2: ''
[16:19:10] ℹ️    - Diagnosis 3: ''
[16:19:10] ℹ️    - Diagnosis 4: ''
[16:19:10] ℹ️    - Diagnosis 5: ''
[16:19:10] ℹ️    - Diagnosis 6: ''
[16:19:10] ℹ️  Final extracted MRN: ''
[16:19:10] ℹ️  Final extracted Sex: ''
[16:19:10] ℹ️  Final extracted Service Line: ''
[16:19:10] ℹ️  Final extracted Payer Source: ''
[16:19:10] ✅ Patient data extraction completed successfully
[16:19:10] ✅    ✅ Patient data extracted successfully
[16:19:10] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:19:10] ⚠️     ❌ Insufficient patient data extracted
[16:19:10] [DOC: 9189416] ℹ️  API push details saved for document 9189416
================================================================================
║                        Processing Document ID: 9219515                         ║
================================================================================
[16:19:10] ℹ️  Agency: Brigham Home Care Services.Inc
[16:19:10] ℹ️  Date: 04/03/2025
[16:19:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:19:11] [DOC: 9219515] ✅ Text extracted using pdfplumber (1880 chars)
[16:19:11] ✅    ✅ Text extracted using pdfplumber (1880 chars)
[16:19:11] 🔄 
🔄 Step 2: Extracting patient data...
[16:19:14] ℹ️  AI extracted raw sex value: 'F'
[16:19:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:19:14] ℹ️  AI extracted payer source: ''
[16:19:14] ℹ️  AI extracted diagnoses:
[16:19:14] ℹ️    - Diagnosis 1: ''
[16:19:14] ℹ️    - Diagnosis 2: ''
[16:19:14] ℹ️    - Diagnosis 3: ''
[16:19:14] ℹ️    - Diagnosis 4: ''
[16:19:14] ℹ️    - Diagnosis 5: ''
[16:19:14] ℹ️    - Diagnosis 6: ''
[16:19:14] ℹ️  Final extracted MRN: '2304'
[16:19:14] ℹ️  Final extracted Sex: 'FEMALE'
[16:19:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:19:14] ℹ️  Final extracted Payer Source: ''
[16:19:14] ✅ Patient data extraction completed successfully
[16:19:14] ✅    ✅ Patient data extracted successfully
[16:19:14] 📊 Patient Response
     └─ patientFName: RASHELL
     └─ patientLName: ARNUM
     └─ dob: 10/23/1973
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2304
     └─ billingProvider: Bautista, Karmina
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:19:14] ✅    ✅ Patient identified: RASHELL ARNUM
[16:19:14] ✅    ✅ Patient name validation passed
[16:19:14] 🔄 
🔄 Step 3: Processing patient dates...
[16:19:14] [DOC: 9219515] ℹ️  DOB normalized: 10/23/1973
[16:19:14] [DOC: 9219515] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[16:19:14] [DOC: 9219515] ℹ️  Episode endOfEpisode normalized: 03/31/2025
[16:19:14] [DOC: 9219515] ✅ Patient date processing completed successfully
[16:19:14] ✅    ✅ Date processing completed
[16:19:14] 📊 Processed Patient Data
     └─ patientFName: RASHELL
     └─ patientLName: ARNUM
     └─ dob: 10/23/1973
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2304
     └─ billingProvider: Bautista, Karmina
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:19:14] 🔄 
🔄 Step 4: Extracting order data...
[16:19:16] ℹ️  Order extraction - MRN: '2304'
[16:19:16] ℹ️  Order extraction - Sex: 'FEMALE'
[16:19:16] ℹ️  Order extraction - Service Line: 'Nursing'
[16:19:16] ℹ️  Order extraction - Payer Source: ''
[16:19:16] ✅ Order data extraction completed successfully
[16:19:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:19:16] ℹ️  Using MRN from patient data: '2304' over '2304'
[16:19:16] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Nursing' = 'Nursing, Skilled Nursing'
[16:19:16] ✅ Patient name cross-validation successful
[16:19:16] ✅    ✅ Data merged successfully
[16:19:18] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[16:19:18] [DOC: 9219515] ℹ️  API push details saved for document 9219515
================================================================================
║                        Processing Document ID: 9219975                         ║
================================================================================
[16:19:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:19:18] ℹ️  Date: 04/03/2025
[16:19:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:19:21] [DOC: 9219975] ✅ Text extracted using pdfplumber (14480 chars)
[16:19:21] ✅    ✅ Text extracted using pdfplumber (14480 chars)
[16:19:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:19:24] ℹ️  AI extracted raw sex value: 'M'
[16:19:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:19:24] ℹ️  AI extracted payer source: 'Medicare'
[16:19:24] ℹ️  AI extracted diagnoses:
[16:19:24] ℹ️    - Diagnosis 1: 'E11.65'
[16:19:24] ℹ️    - Diagnosis 2: 'S32.048'
[16:19:24] ℹ️    - Diagnosis 3: 'T79.6XX'
[16:19:24] ℹ️    - Diagnosis 4: 'E87.6'
[16:19:24] ℹ️    - Diagnosis 5: 'N17.9'
[16:19:24] ℹ️    - Diagnosis 6: 'J96.01'
[16:19:24] ℹ️  Final extracted MRN: '100996161'
[16:19:24] ℹ️  Final extracted Sex: 'MALE'
[16:19:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:19:24] ℹ️  Final extracted Payer Source: 'Medicare'
[16:19:24] ✅ Patient data extraction completed successfully
[16:19:24] ✅    ✅ Patient data extracted successfully
[16:19:24] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 100996161
     └─ billingProvider: Dr. Etter, Justin
     └─ npi: 1881923936
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 3462 Acushnet Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 264-1987
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/03/2023', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'S32.048', 'thirdDiagnosis': 'T79.6XX', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'N17.9', 'sixthDiagnosis': 'J96.01'}]
[16:19:24] ✅    ✅ Patient identified: Stephen Estevez
[16:19:24] ✅    ✅ Patient name validation passed
[16:19:24] 🔄 
🔄 Step 3: Processing patient dates...
[16:19:24] [DOC: 9219975] ℹ️  DOB normalized: 10/21/1945
[16:19:24] [DOC: 9219975] ℹ️  Episode startOfCare normalized: 10/03/2023
[16:19:24] [DOC: 9219975] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[16:19:24] [DOC: 9219975] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[16:19:24] [DOC: 9219975] ✅ Patient date processing completed successfully
[16:19:24] ✅    ✅ Date processing completed
[16:19:24] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 100996161
     └─ billingProvider: Dr. Etter, Justin
     └─ npi: 1881923936
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 3462 Acushnet Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 264-1987
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/03/2023', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'S32.048', 'thirdDiagnosis': 'T79.6XX', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'N17.9', 'sixthDiagnosis': 'J96.01'}]
[16:19:24] 🔄 
🔄 Step 4: Extracting order data...
[16:19:28] ℹ️  Order extraction - MRN: '100996161'
[16:19:28] ℹ️  Order extraction - Sex: 'MALE'
[16:19:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:19:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:19:28] ✅ Order data extraction completed successfully
[16:19:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:19:28] ℹ️  Using MRN from patient data: '100996161' over '100996161'
[16:19:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:19:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:19:28] ✅ Patient name cross-validation successful
[16:19:28] ✅    ✅ Data merged successfully
[16:19:29] ✅    ✅ Order data extracted and validated
[16:19:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:19:36] [DOC: 9219975] ✅ Patient exists in API: Stephen Estevez, ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[16:19:36] ✅    ✅ Existing patient found with ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[16:19:36] 🔄 
🔄 Step 6: Pushing order to API...
[16:19:36] [DOC: 9219975] ℹ️  Pushing order via API for patient ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[16:19:37] [DOC: 9219975] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13928"}
[16:19:37] ❌    ❌ Failed to push order
[16:19:37] 🔄 
🔄 Step 7: Writing to CSV...
[16:19:37] [DOC: 9219975] ℹ️  Calculated age: 79 from DOB: 10/21/1945
[16:19:37] [DOC: 9219975] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:19:37] [DOC: 9219975] ℹ️  Payer Source extracted: 'Medicare'
[16:19:37] [DOC: 9219975] ℹ️  Diagnosis codes being written:
[16:19:37] [DOC: 9219975] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[16:19:37] [DOC: 9219975] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.048'
[16:19:37] [DOC: 9219975] ℹ️    - Latest_Episode_Thirddiagnosis: 'T79.6XX'
[16:19:37] [DOC: 9219975] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E87.6'
[16:19:37] [DOC: 9219975] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N17.9'
[16:19:37] [DOC: 9219975] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J96.01'
[16:19:37] [DOC: 9219975] ✅ Patient data written to CSV: Stephen Estevez | Sex: MALE | Age: 79 | Service: Skilled Nursing | Payer: Medicare | MRN: 100996161
[16:19:37] ✅    ✅ Document 9219975 processed and saved successfully
[16:19:37] 🔄 
🔄 Step 8: Saving API details...
[16:19:37] [DOC: 9219975] ℹ️  API push details saved for document 9219975
[16:19:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219972                         ║
================================================================================
[16:19:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:19:37] ℹ️  Date: 04/03/2025
[16:19:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:19:39] [DOC: 9219972] ✅ Text extracted using pdfplumber (1442 chars)
[16:19:39] ✅    ✅ Text extracted using pdfplumber (1442 chars)
[16:19:39] 🔄 
🔄 Step 2: Extracting patient data...
[16:19:42] ℹ️  AI extracted raw sex value: ''
[16:19:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:19:42] ℹ️  AI extracted payer source: ''
[16:19:42] ℹ️  AI extracted diagnoses:
[16:19:42] ℹ️    - Diagnosis 1: 'E11.65'
[16:19:42] ℹ️    - Diagnosis 2: 'U07.1'
[16:19:42] ℹ️    - Diagnosis 3: 'S32.048'
[16:19:42] ℹ️    - Diagnosis 4: 'None'
[16:19:42] ℹ️    - Diagnosis 5: 'None'
[16:19:42] ℹ️    - Diagnosis 6: 'None'
[16:19:42] ℹ️  Final extracted MRN: '100996161'
[16:19:42] ℹ️  Final extracted Sex: ''
[16:19:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:19:42] ℹ️  Final extracted Payer Source: ''
[16:19:42] ✅ Patient data extraction completed successfully
[16:19:42] ✅    ✅ Patient data extracted successfully
[16:19:42] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100996161
     └─ billingProvider: JUSTIN ETTER MD
     └─ npi: 1699113472
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'S32.048', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:19:42] ✅    ✅ Patient identified: Stephen Estevez
[16:19:42] ✅    ✅ Patient name validation passed
[16:19:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:19:42] [DOC: 9219972] ℹ️  DOB normalized: 10/21/1945
[16:19:42] [DOC: 9219972] ℹ️  Episode startOfEpisode normalized: 01/25/2025
[16:19:42] [DOC: 9219972] ℹ️  Episode endOfEpisode normalized: 03/25/2025
[16:19:42] [DOC: 9219972] ✅ Patient date processing completed successfully
[16:19:42] ✅    ✅ Date processing completed
[16:19:42] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100996161
     └─ billingProvider: JUSTIN ETTER MD
     └─ npi: 1699113472
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'S32.048'}]
[16:19:42] 🔄 
🔄 Step 4: Extracting order data...
[16:19:45] ℹ️  Order extraction - MRN: '100996161'
[16:19:45] ℹ️  Order extraction - Sex: ''
[16:19:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:19:45] ℹ️  Order extraction - Payer Source: ''
[16:19:45] ✅ Order data extraction completed successfully
[16:19:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:19:45] ℹ️  Using MRN from patient data: '100996161' over '100996161'
[16:19:45] ℹ️  Inferred sex as MALE from name: Stephen
[16:19:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:19:45] ✅ Patient name cross-validation successful
[16:19:45] ✅    ✅ Data merged successfully
[16:19:47] ✅    ✅ Order data extracted and validated
[16:19:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:19:47] [DOC: 9219972] ✅ Patient found in local cache: Stephen Estevez, ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[16:19:47] ✅    ✅ Existing patient found with ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[16:19:47] 🔄 
🔄 Step 6: Pushing order to API...
[16:19:47] [DOC: 9219972] ℹ️  Pushing order via API for patient ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[16:19:48] [DOC: 9219972] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13929"}
[16:19:48] ❌    ❌ Failed to push order
[16:19:48] 🔄 
🔄 Step 7: Writing to CSV...
[16:19:48] [DOC: 9219972] ℹ️  Calculated age: 79 from DOB: 10/21/1945
[16:19:48] [DOC: 9219972] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:19:48] [DOC: 9219972] ℹ️  Payer Source extracted: ''
[16:19:48] [DOC: 9219972] ℹ️  Diagnosis codes being written:
[16:19:48] [DOC: 9219972] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[16:19:48] [DOC: 9219972] ℹ️    - Latest_Episode_Seconddiagnosis: 'U07.1'
[16:19:48] [DOC: 9219972] ℹ️    - Latest_Episode_Thirddiagnosis: 'S32.048'
[16:19:48] [DOC: 9219972] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:19:48] [DOC: 9219972] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:19:48] [DOC: 9219972] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:19:48] [DOC: 9219972] ✅ Patient data written to CSV: Stephen Estevez | Sex: MALE | Age: 79 | Service: Skilled Nursing | Payer:  | MRN: 100996161
[16:19:48] ✅    ✅ Document 9219972 processed and saved successfully
[16:19:48] 🔄 
🔄 Step 8: Saving API details...
[16:19:48] [DOC: 9219972] ℹ️  API push details saved for document 9219972
[16:19:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219786                         ║
================================================================================
[16:19:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:19:48] ℹ️  Date: 04/03/2025
[16:19:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:19:50] [DOC: 9219786] ✅ Text extracted using pdfplumber (1498 chars)
[16:19:50] ✅    ✅ Text extracted using pdfplumber (1498 chars)
[16:19:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:19:53] ℹ️  AI extracted raw sex value: ''
[16:19:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:19:53] ℹ️  AI extracted payer source: 'None'
[16:19:53] ℹ️  AI extracted diagnoses:
[16:19:53] ℹ️    - Diagnosis 1: 'E11.65'
[16:19:53] ℹ️    - Diagnosis 2: 'R41.9'
[16:19:53] ℹ️    - Diagnosis 3: 'I10'
[16:19:53] ℹ️    - Diagnosis 4: 'None'
[16:19:53] ℹ️    - Diagnosis 5: 'None'
[16:19:53] ℹ️    - Diagnosis 6: 'None'
[16:19:53] ℹ️  Final extracted MRN: 'MA231221074802'
[16:19:53] ℹ️  Final extracted Sex: ''
[16:19:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:19:53] ℹ️  Final extracted Payer Source: ''
[16:19:53] ✅ Patient data extraction completed successfully
[16:19:53] ✅    ✅ Patient data extracted successfully
[16:19:53] 📊 Patient Response
     └─ patientFName: Diana
     └─ patientLName: Dean
     └─ dob: 07/20/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231221074802
     └─ billingProvider: AHMET DIRICAN
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'R41.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:19:53] ✅    ✅ Patient identified: Diana Dean
[16:19:53] ✅    ✅ Patient name validation passed
[16:19:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:19:53] [DOC: 9219786] ℹ️  DOB normalized: 07/20/1948
[16:19:53] [DOC: 9219786] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[16:19:53] [DOC: 9219786] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[16:19:53] [DOC: 9219786] ✅ Patient date processing completed successfully
[16:19:53] ✅    ✅ Date processing completed
[16:19:53] 📊 Processed Patient Data
     └─ patientFName: Diana
     └─ patientLName: Dean
     └─ dob: 07/20/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231221074802
     └─ billingProvider: AHMET DIRICAN
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'R41.9', 'thirdDiagnosis': 'I10'}]
[16:19:53] 🔄 
🔄 Step 4: Extracting order data...
[16:19:56] ℹ️  Order extraction - MRN: 'MA231221074802'
[16:19:56] ℹ️  Order extraction - Sex: ''
[16:19:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:19:56] ℹ️  Order extraction - Payer Source: ''
[16:19:56] ✅ Order data extraction completed successfully
[16:19:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:19:56] ℹ️  Using MRN from patient data: 'MA231221074802' over 'MA231221074802'
[16:19:56] ⚠️  Could not determine sex using any available method
[16:19:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:19:56] ✅ Patient name cross-validation successful
[16:19:56] ✅    ✅ Data merged successfully
[16:19:57] ✅    ✅ Order data extracted and validated
[16:19:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:20:04] [DOC: 9219786] ℹ️  Patient not found in cache or API: Diana Dean
[16:20:04] [DOC: 9219786] ℹ️  Patient not found, creating new patient via API...
[16:20:04] [DOC: 9219786] ℹ️  Creating patient via API: Diana Dean
[16:20:05] [DOC: 9219786] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:20:05] ❌    ❌ Failed to create patient
[16:20:05] [DOC: 9219786] ℹ️  API push details saved for document 9219786
================================================================================
║                        Processing Document ID: 9219562                         ║
================================================================================
[16:20:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:20:05] ℹ️  Date: 04/03/2025
[16:20:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:20:07] [DOC: 9219562] ✅ Text extracted using pdfplumber (1628 chars)
[16:20:07] ✅    ✅ Text extracted using pdfplumber (1628 chars)
[16:20:07] 🔄 
🔄 Step 2: Extracting patient data...
[16:20:10] ℹ️  AI extracted raw sex value: ''
[16:20:10] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:20:10] ℹ️  AI extracted payer source: ''
[16:20:10] ℹ️  AI extracted diagnoses:
[16:20:10] ℹ️    - Diagnosis 1: 'J44.1'
[16:20:10] ℹ️    - Diagnosis 2: 'I10'
[16:20:10] ℹ️    - Diagnosis 3: 'E11.65'
[16:20:10] ℹ️    - Diagnosis 4: 'None'
[16:20:10] ℹ️    - Diagnosis 5: 'None'
[16:20:10] ℹ️    - Diagnosis 6: 'None'
[16:20:10] ℹ️  Final extracted MRN: '100990744'
[16:20:10] ℹ️  Final extracted Sex: ''
[16:20:10] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:20:10] ℹ️  Final extracted Payer Source: ''
[16:20:10] ✅ Patient data extraction completed successfully
[16:20:10] ✅    ✅ Patient data extracted successfully
[16:20:10] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:20:10] ✅    ✅ Patient identified: Barbara Grace
[16:20:10] ✅    ✅ Patient name validation passed
[16:20:10] 🔄 
🔄 Step 3: Processing patient dates...
[16:20:10] [DOC: 9219562] ℹ️  DOB normalized: 10/21/1948
[16:20:10] [DOC: 9219562] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[16:20:10] [DOC: 9219562] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[16:20:10] [DOC: 9219562] ✅ Patient date processing completed successfully
[16:20:10] ✅    ✅ Date processing completed
[16:20:10] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65'}]
[16:20:10] 🔄 
🔄 Step 4: Extracting order data...
[16:20:13] ℹ️  Order extraction - MRN: '100990744'
[16:20:13] ℹ️  Order extraction - Sex: ''
[16:20:13] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:20:13] ℹ️  Order extraction - Payer Source: ''
[16:20:13] ✅ Order data extraction completed successfully
[16:20:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:20:13] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[16:20:13] ℹ️  Inferred sex as FEMALE from name: Barbara
[16:20:13] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:20:13] ✅ Patient name cross-validation successful
[16:20:13] ✅    ✅ Data merged successfully
[16:20:14] ✅    ✅ Order data extracted and validated
[16:20:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:20:14] [DOC: 9219562] ✅ Patient found in local cache: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[16:20:14] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[16:20:14] 🔄 
🔄 Step 6: Pushing order to API...
[16:20:14] [DOC: 9219562] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[16:20:15] [DOC: 9219562] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13821"}
[16:20:15] ❌    ❌ Failed to push order
[16:20:15] 🔄 
🔄 Step 7: Writing to CSV...
[16:20:15] [DOC: 9219562] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[16:20:15] [DOC: 9219562] ℹ️  Service Line extracted: 'Occupational Therapy'
[16:20:15] [DOC: 9219562] ℹ️  Payer Source extracted: ''
[16:20:15] [DOC: 9219562] ℹ️  Diagnosis codes being written:
[16:20:15] [DOC: 9219562] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[16:20:15] [DOC: 9219562] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[16:20:15] [DOC: 9219562] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[16:20:15] [DOC: 9219562] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:20:15] [DOC: 9219562] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:20:15] [DOC: 9219562] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:20:15] [DOC: 9219562] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: 100990744
[16:20:15] ✅    ✅ Document 9219562 processed and saved successfully
[16:20:15] 🔄 
🔄 Step 8: Saving API details...
[16:20:15] [DOC: 9219562] ℹ️  API push details saved for document 9219562
[16:20:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219552                         ║
================================================================================
[16:20:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:20:15] ℹ️  Date: 04/03/2025
[16:20:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:20:18] [DOC: 9219552] ✅ Text extracted using pdfplumber (1336 chars)
[16:20:18] ✅    ✅ Text extracted using pdfplumber (1336 chars)
[16:20:18] 🔄 
🔄 Step 2: Extracting patient data...
[16:20:21] ℹ️  AI extracted raw sex value: ''
[16:20:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:20:21] ℹ️  AI extracted payer source: ''
[16:20:21] ℹ️  AI extracted diagnoses:
[16:20:21] ℹ️    - Diagnosis 1: 'F41.9'
[16:20:21] ℹ️    - Diagnosis 2: 'I10'
[16:20:21] ℹ️    - Diagnosis 3: 'M54.50'
[16:20:21] ℹ️    - Diagnosis 4: ''
[16:20:21] ℹ️    - Diagnosis 5: ''
[16:20:21] ℹ️    - Diagnosis 6: ''
[16:20:21] ℹ️  Final extracted MRN: '101001422'
[16:20:21] ℹ️  Final extracted Sex: ''
[16:20:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:20:21] ℹ️  Final extracted Payer Source: ''
[16:20:21] ✅ Patient data extraction completed successfully
[16:20:21] ✅    ✅ Patient data extracted successfully
[16:20:21] 📊 Patient Response
     └─ patientFName: Aurelio
     └─ patientLName: Bachiller
     └─ dob: 04/01/1953
     └─ patientSex: 
     └─ medicalRecordNo: 101001422
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'F41.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:20:21] ✅    ✅ Patient identified: Aurelio Bachiller
[16:20:21] ✅    ✅ Patient name validation passed
[16:20:21] 🔄 
🔄 Step 3: Processing patient dates...
[16:20:21] [DOC: 9219552] ℹ️  DOB normalized: 04/01/1953
[16:20:21] [DOC: 9219552] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[16:20:21] [DOC: 9219552] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[16:20:21] [DOC: 9219552] ✅ Patient date processing completed successfully
[16:20:21] ✅    ✅ Date processing completed
[16:20:21] 📊 Processed Patient Data
     └─ patientFName: Aurelio
     └─ patientLName: Bachiller
     └─ dob: 04/01/1953
     └─ patientSex: 
     └─ medicalRecordNo: 101001422
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'F41.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:20:21] 🔄 
🔄 Step 4: Extracting order data...
[16:20:23] ℹ️  Order extraction - MRN: '101001422'
[16:20:23] ℹ️  Order extraction - Sex: ''
[16:20:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:20:23] ℹ️  Order extraction - Payer Source: ''
[16:20:23] ✅ Order data extraction completed successfully
[16:20:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:20:23] ℹ️  Using MRN from patient data: '101001422' over '101001422'
[16:20:23] ⚠️  Could not determine sex using any available method
[16:20:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:20:23] ✅ Patient name cross-validation successful
[16:20:23] ✅    ✅ Data merged successfully
[16:20:24] ✅    ✅ Order data extracted and validated
[16:20:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:20:30] [DOC: 9219552] ✅ Patient exists in API: Aurelio Bachiller, ID: f7dbe95f-7c13-45b9-90ed-ce52f859f57e
[16:20:30] ✅    ✅ Existing patient found with ID: f7dbe95f-7c13-45b9-90ed-ce52f859f57e
[16:20:30] 🔄 
🔄 Step 6: Pushing order to API...
[16:20:30] [DOC: 9219552] ℹ️  Pushing order via API for patient ID: f7dbe95f-7c13-45b9-90ed-ce52f859f57e
[16:20:31] [DOC: 9219552] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12975"}
[16:20:31] ❌    ❌ Failed to push order
[16:20:31] 🔄 
🔄 Step 7: Writing to CSV...
[16:20:31] [DOC: 9219552] ℹ️  Calculated age: 72 from DOB: 04/01/1953
[16:20:31] [DOC: 9219552] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:20:31] [DOC: 9219552] ℹ️  Payer Source extracted: ''
[16:20:31] [DOC: 9219552] ℹ️  Diagnosis codes being written:
[16:20:31] [DOC: 9219552] ℹ️    - Latest_Episode_Firstdiagnosis: 'F41.9'
[16:20:31] [DOC: 9219552] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[16:20:31] [DOC: 9219552] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.50'
[16:20:31] [DOC: 9219552] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:20:31] [DOC: 9219552] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:20:31] [DOC: 9219552] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:20:31] [DOC: 9219552] ✅ Patient data written to CSV: Aurelio Bachiller | Sex:  | Age: 72 | Service: Skilled Nursing | Payer:  | MRN: 101001422
[16:20:31] ✅    ✅ Document 9219552 processed and saved successfully
[16:20:31] 🔄 
🔄 Step 8: Saving API details...
[16:20:31] [DOC: 9219552] ℹ️  API push details saved for document 9219552
[16:20:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219546                         ║
================================================================================
[16:20:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:20:31] ℹ️  Date: 04/03/2025
[16:20:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:20:34] [DOC: 9219546] ✅ Text extracted using pdfplumber (10507 chars)
[16:20:34] ✅    ✅ Text extracted using pdfplumber (10507 chars)
[16:20:34] 🔄 
🔄 Step 2: Extracting patient data...
[16:20:37] ℹ️  AI extracted raw sex value: 'F'
[16:20:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:20:37] ℹ️  AI extracted payer source: 'Medicare'
[16:20:37] ℹ️  AI extracted diagnoses:
[16:20:37] ℹ️    - Diagnosis 1: 'J44.9'
[16:20:37] ℹ️    - Diagnosis 2: 'I10'
[16:20:37] ℹ️    - Diagnosis 3: 'M10.9'
[16:20:37] ℹ️    - Diagnosis 4: 'F41.1'
[16:20:37] ℹ️    - Diagnosis 5: 'F32.89'
[16:20:37] ℹ️    - Diagnosis 6: 'G47.00'
[16:20:37] ℹ️  Final extracted MRN: 'MA220409013903'
[16:20:37] ℹ️  Final extracted Sex: 'FEMALE'
[16:20:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:20:37] ℹ️  Final extracted Payer Source: 'Medicare'
[16:20:37] ✅ Patient data extraction completed successfully
[16:20:37] ✅    ✅ Patient data extracted successfully
[16:20:37] 📊 Patient Response
     └─ patientFName: Joann
     └─ patientLName: Rocha
     └─ dob: 01/11/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220409013903
     └─ billingProvider: DHUNGANA PARAJULI, SIRJANA MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 2062 Phillips Rd, APT 208
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (774) 328-8592
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/06/2022', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M10.9', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'F32.89', 'sixthDiagnosis': 'G47.00'}]
[16:20:37] ✅    ✅ Patient identified: Joann Rocha
[16:20:37] ✅    ✅ Patient name validation passed
[16:20:37] 🔄 
🔄 Step 3: Processing patient dates...
[16:20:37] [DOC: 9219546] ℹ️  DOB normalized: 01/11/1939
[16:20:37] [DOC: 9219546] ℹ️  Episode startOfCare normalized: 08/06/2022
[16:20:37] [DOC: 9219546] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[16:20:37] [DOC: 9219546] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[16:20:37] [DOC: 9219546] ✅ Patient date processing completed successfully
[16:20:37] ✅    ✅ Date processing completed
[16:20:37] 📊 Processed Patient Data
     └─ patientFName: Joann
     └─ patientLName: Rocha
     └─ dob: 01/11/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220409013903
     └─ billingProvider: DHUNGANA PARAJULI, SIRJANA MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 2062 Phillips Rd, APT 208
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (774) 328-8592
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/06/2022', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M10.9', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'F32.89', 'sixthDiagnosis': 'G47.00'}]
[16:20:37] 🔄 
🔄 Step 4: Extracting order data...
[16:20:40] ℹ️  Order extraction - MRN: 'MA220409013903'
[16:20:40] ℹ️  Order extraction - Sex: 'FEMALE'
[16:20:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:20:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:20:40] ✅ Order data extraction completed successfully
[16:20:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:20:40] ℹ️  Using MRN from patient data: 'MA220409013903' over 'MA220409013903'
[16:20:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:20:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:20:40] ✅ Patient name cross-validation successful
[16:20:40] ✅    ✅ Data merged successfully
[16:20:41] ✅    ✅ Order data extracted and validated
[16:20:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:20:47] [DOC: 9219546] ℹ️  Patient not found in cache or API: Joann Rocha
[16:20:47] [DOC: 9219546] ℹ️  Patient not found, creating new patient via API...
[16:20:47] [DOC: 9219546] ℹ️  Creating patient via API: Joann Rocha
[16:20:48] [DOC: 9219546] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:20:48] ❌    ❌ Failed to create patient
[16:20:48] [DOC: 9219546] ℹ️  API push details saved for document 9219546
================================================================================
║                        Processing Document ID: 9219472                         ║
================================================================================
[16:20:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:20:48] ℹ️  Date: 04/03/2025
[16:20:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:20:51] [DOC: 9219472] ✅ Text extracted using pdfplumber (16991 chars)
[16:20:51] ✅    ✅ Text extracted using pdfplumber (16991 chars)
[16:20:51] 🔄 
🔄 Step 2: Extracting patient data...
[16:20:54] ℹ️  AI extracted raw sex value: 'F'
[16:20:54] ℹ️  AI extracted service line: 'PT'
[16:20:54] ℹ️  AI extracted payer source: 'None'
[16:20:54] ℹ️  AI extracted diagnoses:
[16:20:54] ℹ️    - Diagnosis 1: 'I50.9'
[16:20:54] ℹ️    - Diagnosis 2: 'G72.9'
[16:20:54] ℹ️    - Diagnosis 3: 'G63.9'
[16:20:54] ℹ️    - Diagnosis 4: 'J44.9'
[16:20:54] ℹ️    - Diagnosis 5: 'I11.9'
[16:20:54] ℹ️    - Diagnosis 6: 'F32.9'
[16:20:54] ℹ️  Final extracted MRN: 'MA220614074801'
[16:20:54] ℹ️  Final extracted Sex: 'FEMALE'
[16:20:54] ℹ️  Final extracted Service Line: 'PT'
[16:20:54] ℹ️  Final extracted Payer Source: ''
[16:20:54] ✅ Patient data extraction completed successfully
[16:20:54] ✅    ✅ Patient data extracted successfully
[16:20:54] 📊 Patient Response
     └─ patientFName: Deborah
     └─ patientLName: Hoglund
     └─ dob: 07/25/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220614074801
     └─ billingProvider: Dr. DeFusco, Nicholas J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/15/25', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'G72.9', 'thirdDiagnosis': 'G63.9', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'I11.9', 'sixthDiagnosis': 'F32.9'}]
[16:20:54] ✅    ✅ Patient identified: Deborah Hoglund
[16:20:54] ✅    ✅ Patient name validation passed
[16:20:54] 🔄 
🔄 Step 3: Processing patient dates...
[16:20:54] [DOC: 9219472] ℹ️  DOB normalized: 07/25/1948
[16:20:54] [DOC: 9219472] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:20:54] [DOC: 9219472] ⚠️  Invalid endOfEpisode format: 05/15/25
[16:20:54] [DOC: 9219472] ✅ Patient date processing completed successfully
[16:20:54] ✅    ✅ Date processing completed
[16:20:54] 📊 Processed Patient Data
     └─ patientFName: Deborah
     └─ patientLName: Hoglund
     └─ dob: 07/25/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220614074801
     └─ billingProvider: Dr. DeFusco, Nicholas J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/15/25', 'firstDiagnosis': 'I50.9', 'secondDiagnosis': 'G72.9', 'thirdDiagnosis': 'G63.9', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'I11.9', 'sixthDiagnosis': 'F32.9'}]
[16:20:54] 🔄 
🔄 Step 4: Extracting order data...
[16:20:58] ℹ️  Order extraction - MRN: 'MA220614074801'
[16:20:58] ℹ️  Order extraction - Sex: 'FEMALE'
[16:20:58] ℹ️  Order extraction - Service Line: 'PT'
[16:20:58] ℹ️  Order extraction - Payer Source: ''
[16:20:58] ✅ Order data extraction completed successfully
[16:20:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:20:58] ℹ️  Using MRN from patient data: 'MA220614074801' over 'MA220614074801'
[16:20:58] ℹ️  Service line consistent in both sources: 'PT'
[16:20:58] ✅ Patient name cross-validation successful
[16:20:58] ✅    ✅ Data merged successfully
[16:20:59] ✅    ✅ Order data extracted and validated
[16:20:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:21:06] [DOC: 9219472] ✅ Patient exists in API: Deborah Hoglund, ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:06] ✅    ✅ Existing patient found with ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:06] 🔄 
🔄 Step 6: Pushing order to API...
[16:21:06] [DOC: 9219472] ℹ️  Pushing order via API for patient ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:07] [DOC: 9219472] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:21:07] ❌    ❌ Failed to push order
[16:21:07] 🔄 
🔄 Step 7: Writing to CSV...
[16:21:07] [DOC: 9219472] ℹ️  Calculated age: 76 from DOB: 07/25/1948
[16:21:07] [DOC: 9219472] ℹ️  Service Line extracted: 'PT'
[16:21:07] [DOC: 9219472] ℹ️  Payer Source extracted: ''
[16:21:07] [DOC: 9219472] ℹ️  Diagnosis codes being written:
[16:21:07] [DOC: 9219472] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.9'
[16:21:07] [DOC: 9219472] ℹ️    - Latest_Episode_Seconddiagnosis: 'G72.9'
[16:21:07] [DOC: 9219472] ℹ️    - Latest_Episode_Thirddiagnosis: 'G63.9'
[16:21:07] [DOC: 9219472] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[16:21:07] [DOC: 9219472] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I11.9'
[16:21:07] [DOC: 9219472] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.9'
[16:21:07] [DOC: 9219472] ✅ Patient data written to CSV: Deborah Hoglund | Sex: FEMALE | Age: 76 | Service: PT | Payer:  | MRN: MA220614074801
[16:21:07] ✅    ✅ Document 9219472 processed and saved successfully
[16:21:07] 🔄 
🔄 Step 8: Saving API details...
[16:21:07] [DOC: 9219472] ℹ️  API push details saved for document 9219472
[16:21:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219467                         ║
================================================================================
[16:21:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:21:07] ℹ️  Date: 04/03/2025
[16:21:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:21:09] [DOC: 9219467] ✅ Text extracted using pdfplumber (1420 chars)
[16:21:09] ✅    ✅ Text extracted using pdfplumber (1420 chars)
[16:21:09] 🔄 
🔄 Step 2: Extracting patient data...
[16:21:12] ℹ️  AI extracted raw sex value: ''
[16:21:12] ℹ️  AI extracted service line: 'Physical Therapy'
[16:21:12] ℹ️  AI extracted payer source: ''
[16:21:12] ℹ️  AI extracted diagnoses:
[16:21:12] ℹ️    - Diagnosis 1: 'I50.32'
[16:21:12] ℹ️    - Diagnosis 2: 'I11.0'
[16:21:12] ℹ️    - Diagnosis 3: 'J44.9'
[16:21:12] ℹ️    - Diagnosis 4: ''
[16:21:12] ℹ️    - Diagnosis 5: ''
[16:21:12] ℹ️    - Diagnosis 6: ''
[16:21:12] ℹ️  Final extracted MRN: 'MA220614074801'
[16:21:12] ℹ️  Final extracted Sex: ''
[16:21:12] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:21:12] ℹ️  Final extracted Payer Source: ''
[16:21:12] ✅ Patient data extraction completed successfully
[16:21:12] ✅    ✅ Patient data extracted successfully
[16:21:12] 📊 Patient Response
     └─ patientFName: Deborah
     └─ patientLName: Hoglund
     └─ dob: 07/25/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220614074801
     └─ billingProvider: NICHOLAS DEFUSCO MD
     └─ npi: 1730593195
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:21:12] ✅    ✅ Patient identified: Deborah Hoglund
[16:21:12] ✅    ✅ Patient name validation passed
[16:21:12] 🔄 
🔄 Step 3: Processing patient dates...
[16:21:12] [DOC: 9219467] ℹ️  DOB normalized: 07/25/1948
[16:21:12] [DOC: 9219467] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:21:12] [DOC: 9219467] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:21:12] [DOC: 9219467] ✅ Patient date processing completed successfully
[16:21:12] ✅    ✅ Date processing completed
[16:21:12] 📊 Processed Patient Data
     └─ patientFName: Deborah
     └─ patientLName: Hoglund
     └─ dob: 07/25/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220614074801
     └─ billingProvider: NICHOLAS DEFUSCO MD
     └─ npi: 1730593195
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:21:12] 🔄 
🔄 Step 4: Extracting order data...
[16:21:15] ℹ️  Order extraction - MRN: 'MA220614074801'
[16:21:15] ℹ️  Order extraction - Sex: ''
[16:21:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:21:15] ℹ️  Order extraction - Payer Source: ''
[16:21:15] ✅ Order data extraction completed successfully
[16:21:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:21:15] ℹ️  Using MRN from patient data: 'MA220614074801' over 'MA220614074801'
[16:21:15] ℹ️  Inferred sex as FEMALE from name: Deborah
[16:21:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:21:15] ✅ Patient name cross-validation successful
[16:21:15] ✅    ✅ Data merged successfully
[16:21:16] ✅    ✅ Order data extracted and validated
[16:21:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:21:16] [DOC: 9219467] ✅ Patient found in local cache: Deborah Hoglund, ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:16] ✅    ✅ Existing patient found with ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:16] 🔄 
🔄 Step 6: Pushing order to API...
[16:21:16] [DOC: 9219467] ℹ️  Pushing order via API for patient ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:17] [DOC: 9219467] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13839"}
[16:21:17] ❌    ❌ Failed to push order
[16:21:17] 🔄 
🔄 Step 7: Writing to CSV...
[16:21:17] [DOC: 9219467] ℹ️  Calculated age: 76 from DOB: 07/25/1948
[16:21:17] [DOC: 9219467] ℹ️  Service Line extracted: 'Physical Therapy'
[16:21:17] [DOC: 9219467] ℹ️  Payer Source extracted: ''
[16:21:17] [DOC: 9219467] ℹ️  Diagnosis codes being written:
[16:21:17] [DOC: 9219467] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.32'
[16:21:17] [DOC: 9219467] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[16:21:17] [DOC: 9219467] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[16:21:17] [DOC: 9219467] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:21:17] [DOC: 9219467] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:21:17] [DOC: 9219467] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:21:17] [DOC: 9219467] ✅ Patient data written to CSV: Deborah Hoglund | Sex: FEMALE | Age: 76 | Service: Physical Therapy | Payer:  | MRN: MA220614074801
[16:21:17] ✅    ✅ Document 9219467 processed and saved successfully
[16:21:17] 🔄 
🔄 Step 8: Saving API details...
[16:21:17] [DOC: 9219467] ℹ️  API push details saved for document 9219467
[16:21:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219463                         ║
================================================================================
[16:21:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:21:17] ℹ️  Date: 04/03/2025
[16:21:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:21:20] [DOC: 9219463] ✅ Text extracted using pdfplumber (3429 chars)
[16:21:20] ✅    ✅ Text extracted using pdfplumber (3429 chars)
[16:21:20] 🔄 
🔄 Step 2: Extracting patient data...
[16:21:23] ℹ️  AI extracted raw sex value: ''
[16:21:23] ℹ️  AI extracted service line: 'Physical Therapy'
[16:21:23] ℹ️  AI extracted payer source: ''
[16:21:23] ℹ️  AI extracted diagnoses:
[16:21:23] ℹ️    - Diagnosis 1: 'I50.32'
[16:21:23] ℹ️    - Diagnosis 2: 'I11.0'
[16:21:23] ℹ️    - Diagnosis 3: 'J44.9'
[16:21:23] ℹ️    - Diagnosis 4: 'None'
[16:21:23] ℹ️    - Diagnosis 5: 'None'
[16:21:23] ℹ️    - Diagnosis 6: 'None'
[16:21:23] ℹ️  Final extracted MRN: 'MA220614074801'
[16:21:23] ℹ️  Final extracted Sex: ''
[16:21:23] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:21:23] ℹ️  Final extracted Payer Source: ''
[16:21:23] ✅ Patient data extraction completed successfully
[16:21:23] ✅    ✅ Patient data extracted successfully
[16:21:23] 📊 Patient Response
     └─ patientFName: Deborah
     └─ patientLName: Hoglund
     └─ dob: 07/25/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220614074801
     └─ billingProvider: NICHOLAS DEFUSCO MD
     └─ npi: 1730593195
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:21:23] ✅    ✅ Patient identified: Deborah Hoglund
[16:21:23] ✅    ✅ Patient name validation passed
[16:21:23] 🔄 
🔄 Step 3: Processing patient dates...
[16:21:23] [DOC: 9219463] ℹ️  DOB normalized: 07/25/1948
[16:21:23] [DOC: 9219463] ℹ️  Episode startOfEpisode normalized: 01/16/2025
[16:21:23] [DOC: 9219463] ℹ️  Episode endOfEpisode normalized: 03/16/2025
[16:21:23] [DOC: 9219463] ✅ Patient date processing completed successfully
[16:21:23] ✅    ✅ Date processing completed
[16:21:23] 📊 Processed Patient Data
     └─ patientFName: Deborah
     └─ patientLName: Hoglund
     └─ dob: 07/25/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220614074801
     └─ billingProvider: NICHOLAS DEFUSCO MD
     └─ npi: 1730593195
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'J44.9'}]
[16:21:23] 🔄 
🔄 Step 4: Extracting order data...
[16:21:25] ℹ️  Order extraction - MRN: 'MA220614074801'
[16:21:25] ℹ️  Order extraction - Sex: ''
[16:21:25] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:21:25] ℹ️  Order extraction - Payer Source: ''
[16:21:25] ✅ Order data extraction completed successfully
[16:21:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:21:25] ℹ️  Using MRN from patient data: 'MA220614074801' over 'MA220614074801'
[16:21:25] ℹ️  Inferred sex as FEMALE from name: Deborah
[16:21:25] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:21:25] ✅ Patient name cross-validation successful
[16:21:25] ✅    ✅ Data merged successfully
[16:21:26] ✅    ✅ Order data extracted and validated
[16:21:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:21:26] [DOC: 9219463] ✅ Patient found in local cache: Deborah Hoglund, ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:26] ✅    ✅ Existing patient found with ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:26] 🔄 
🔄 Step 6: Pushing order to API...
[16:21:26] [DOC: 9219463] ℹ️  Pushing order via API for patient ID: 4b6a8c09-c8cf-41ac-afc8-fc2843fd2f0a
[16:21:28] [DOC: 9219463] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13840"}
[16:21:28] ❌    ❌ Failed to push order
[16:21:28] 🔄 
🔄 Step 7: Writing to CSV...
[16:21:28] [DOC: 9219463] ℹ️  Calculated age: 76 from DOB: 07/25/1948
[16:21:28] [DOC: 9219463] ℹ️  Service Line extracted: 'Physical Therapy'
[16:21:28] [DOC: 9219463] ℹ️  Payer Source extracted: ''
[16:21:28] [DOC: 9219463] ℹ️  Diagnosis codes being written:
[16:21:28] [DOC: 9219463] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.32'
[16:21:28] [DOC: 9219463] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[16:21:28] [DOC: 9219463] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[16:21:28] [DOC: 9219463] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:21:28] [DOC: 9219463] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:21:28] [DOC: 9219463] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:21:28] [DOC: 9219463] ✅ Patient data written to CSV: Deborah Hoglund | Sex: FEMALE | Age: 76 | Service: Physical Therapy | Payer:  | MRN: MA220614074801
[16:21:28] ✅    ✅ Document 9219463 processed and saved successfully
[16:21:28] 🔄 
🔄 Step 8: Saving API details...
[16:21:28] [DOC: 9219463] ℹ️  API push details saved for document 9219463
[16:21:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219428                         ║
================================================================================
[16:21:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:21:28] ℹ️  Date: 04/03/2025
[16:21:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:21:30] [DOC: 9219428] ✅ Text extracted using pdfplumber (17306 chars)
[16:21:30] ✅    ✅ Text extracted using pdfplumber (17294 chars)
[16:21:30] 🔄 
🔄 Step 2: Extracting patient data...
[16:21:34] ℹ️  AI extracted raw sex value: 'F'
[16:21:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:21:34] ℹ️  AI extracted payer source: 'Medicare'
[16:21:34] ℹ️  AI extracted diagnoses:
[16:21:34] ℹ️    - Diagnosis 1: 'I13.2'
[16:21:34] ℹ️    - Diagnosis 2: 'I50.9'
[16:21:34] ℹ️    - Diagnosis 3: 'E11.22'
[16:21:34] ℹ️    - Diagnosis 4: 'N18.6'
[16:21:34] ℹ️    - Diagnosis 5: 'D63.1'
[16:21:34] ℹ️    - Diagnosis 6: 'E03.9'
[16:21:34] ℹ️  Final extracted MRN: 'MA210804056005'
[16:21:34] ℹ️  Final extracted Sex: 'FEMALE'
[16:21:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:21:34] ℹ️  Final extracted Payer Source: 'Medicare'
[16:21:34] ✅ Patient data extraction completed successfully
[16:21:34] ✅    ✅ Patient data extracted successfully
[16:21:34] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Miranda
     └─ dob: 05/28/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210804056005
     └─ billingProvider: COURY, PAMELA
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 145 Clara St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 992-9739
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/02/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.6', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'E03.9'}]
[16:21:34] ✅    ✅ Patient identified: Maria Miranda
[16:21:34] ✅    ✅ Patient name validation passed
[16:21:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:21:34] [DOC: 9219428] ℹ️  DOB normalized: 05/28/1960
[16:21:34] [DOC: 9219428] ℹ️  Episode startOfCare normalized: 10/02/2024
[16:21:34] [DOC: 9219428] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[16:21:34] [DOC: 9219428] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[16:21:34] [DOC: 9219428] ✅ Patient date processing completed successfully
[16:21:34] ✅    ✅ Date processing completed
[16:21:34] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Miranda
     └─ dob: 05/28/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210804056005
     └─ billingProvider: COURY, PAMELA
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 145 Clara St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 992-9739
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/02/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.6', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'E03.9'}]
[16:21:34] 🔄 
🔄 Step 4: Extracting order data...
[16:21:37] ℹ️  Order extraction - MRN: 'MA210804056005'
[16:21:37] ℹ️  Order extraction - Sex: 'FEMALE'
[16:21:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:21:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:21:37] ✅ Order data extraction completed successfully
[16:21:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:21:37] ℹ️  Using MRN from patient data: 'MA210804056005' over 'MA210804056005'
[16:21:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:21:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:21:37] ✅ Patient name cross-validation successful
[16:21:37] ✅    ✅ Data merged successfully
[16:21:38] ✅    ✅ Order data extracted and validated
[16:21:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:21:46] [DOC: 9219428] ✅ Patient exists in API: Maria Miranda, ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:21:46] ✅    ✅ Existing patient found with ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:21:46] 🔄 
🔄 Step 6: Pushing order to API...
[16:21:46] [DOC: 9219428] ℹ️  Pushing order via API for patient ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:21:47] [DOC: 9219428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14122"}
[16:21:47] ❌    ❌ Failed to push order
[16:21:47] 🔄 
🔄 Step 7: Writing to CSV...
[16:21:47] [DOC: 9219428] ℹ️  Calculated age: 65 from DOB: 05/28/1960
[16:21:47] [DOC: 9219428] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:21:47] [DOC: 9219428] ℹ️  Payer Source extracted: 'Medicare'
[16:21:47] [DOC: 9219428] ℹ️  Diagnosis codes being written:
[16:21:47] [DOC: 9219428] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[16:21:47] [DOC: 9219428] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[16:21:47] [DOC: 9219428] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[16:21:47] [DOC: 9219428] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.6'
[16:21:47] [DOC: 9219428] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[16:21:47] [DOC: 9219428] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E03.9'
[16:21:47] [DOC: 9219428] ✅ Patient data written to CSV: Maria Miranda | Sex: FEMALE | Age: 65 | Service: Skilled Nursing | Payer: Medicare | MRN: MA210804056005
[16:21:47] ✅    ✅ Document 9219428 processed and saved successfully
[16:21:47] 🔄 
🔄 Step 8: Saving API details...
[16:21:47] [DOC: 9219428] ℹ️  API push details saved for document 9219428
[16:21:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219416                         ║
================================================================================
[16:21:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:21:47] ℹ️  Date: 04/03/2025
[16:21:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:21:53] [DOC: 9219416] ✅ Text extracted using pdfplumber (21462 chars)
[16:21:53] ✅    ✅ Text extracted using pdfplumber (21462 chars)
[16:21:53] 🔄 
🔄 Step 2: Extracting patient data...
[16:21:56] ℹ️  AI extracted raw sex value: 'F'
[16:21:56] ℹ️  AI extracted service line: 'OT'
[16:21:56] ℹ️  AI extracted payer source: ''
[16:21:56] ℹ️  AI extracted diagnoses:
[16:21:56] ℹ️    - Diagnosis 1: 'Parkinson's falls'
[16:21:56] ℹ️    - Diagnosis 2: 'weakness/decreased safety'
[16:21:56] ℹ️    - Diagnosis 3: 'vit B-12 deficiency'
[16:21:56] ℹ️    - Diagnosis 4: 'restless legs'
[16:21:56] ℹ️    - Diagnosis 5: 'migraine'
[16:21:56] ℹ️    - Diagnosis 6: 'peripheral neuropathy'
[16:21:56] ℹ️  Final extracted MRN: 'MA250220064201'
[16:21:56] ℹ️  Final extracted Sex: 'FEMALE'
[16:21:56] ℹ️  Final extracted Service Line: 'OT'
[16:21:56] ℹ️  Final extracted Payer Source: ''
[16:21:56] ✅ Patient data extraction completed successfully
[16:21:56] ✅    ✅ Patient data extracted successfully
[16:21:56] 📊 Patient Response
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '', 'firstDiagnosis': "Parkinson's falls", 'secondDiagnosis': 'weakness/decreased safety', 'thirdDiagnosis': 'vit B-12 deficiency', 'fourthDiagnosis': 'restless legs', 'fifthDiagnosis': 'migraine', 'sixthDiagnosis': 'peripheral neuropathy'}]
[16:21:56] ✅    ✅ Patient identified: Lucy Francis
[16:21:56] ✅    ✅ Patient name validation passed
[16:21:56] 🔄 
🔄 Step 3: Processing patient dates...
[16:21:56] [DOC: 9219416] ℹ️  DOB normalized: 06/12/1942
[16:21:56] [DOC: 9219416] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[16:21:56] [DOC: 9219416] ✅ Patient date processing completed successfully
[16:21:56] ✅    ✅ Date processing completed
[16:21:56] 📊 Processed Patient Data
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '', 'firstDiagnosis': "Parkinson's falls", 'secondDiagnosis': 'weakness/decreased safety', 'thirdDiagnosis': 'vit B-12 deficiency', 'fourthDiagnosis': 'restless legs', 'fifthDiagnosis': 'migraine', 'sixthDiagnosis': 'peripheral neuropathy'}]
[16:21:56] 🔄 
🔄 Step 4: Extracting order data...
[16:21:59] ℹ️  Order extraction - MRN: 'MA250220064201'
[16:21:59] ℹ️  Order extraction - Sex: 'FEMALE'
[16:21:59] ℹ️  Order extraction - Service Line: 'OT'
[16:21:59] ℹ️  Order extraction - Payer Source: ''
[16:21:59] ✅ Order data extraction completed successfully
[16:21:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:21:59] ℹ️  Using MRN from patient data: 'MA250220064201' over 'MA250220064201'
[16:21:59] ℹ️  Service line consistent in both sources: 'OT'
[16:21:59] ✅ Patient name cross-validation successful
[16:21:59] ✅    ✅ Data merged successfully
[16:22:01] ✅    ✅ Order data extracted and validated
[16:22:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:22:01] [DOC: 9219416] ✅ Patient found in local cache: Lucy Francis, ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[16:22:01] ✅    ✅ Existing patient found with ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[16:22:01] 🔄 
🔄 Step 6: Pushing order to API...
[16:22:01] [DOC: 9219416] ℹ️  Pushing order via API for patient ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[16:22:02] [DOC: 9219416] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:22:02] ❌    ❌ Failed to push order
[16:22:02] 🔄 
🔄 Step 7: Writing to CSV...
[16:22:02] [DOC: 9219416] ℹ️  Calculated age: 82 from DOB: 06/12/1942
[16:22:02] [DOC: 9219416] ℹ️  Service Line extracted: 'OT'
[16:22:02] [DOC: 9219416] ℹ️  Payer Source extracted: ''
[16:22:02] [DOC: 9219416] ℹ️  Diagnosis codes being written:
[16:22:02] [DOC: 9219416] ℹ️    - Latest_Episode_Firstdiagnosis: 'Parkinson's falls'
[16:22:02] [DOC: 9219416] ℹ️    - Latest_Episode_Seconddiagnosis: 'weakness/decreased safety'
[16:22:02] [DOC: 9219416] ℹ️    - Latest_Episode_Thirddiagnosis: 'vit B-12 deficiency'
[16:22:02] [DOC: 9219416] ℹ️    - Latest_Episode_Fourthdiagnosis: 'restless legs'
[16:22:02] [DOC: 9219416] ℹ️    - Latest_Episode_Fifthdiagnosis: 'migraine'
[16:22:02] [DOC: 9219416] ℹ️    - Latest_Episode_Sixthdiagnosis: 'peripheral neuropathy'
[16:22:02] [DOC: 9219416] ✅ Patient data written to CSV: Lucy Francis | Sex: FEMALE | Age: 82 | Service: OT | Payer:  | MRN: MA250220064201
[16:22:02] ✅    ✅ Document 9219416 processed and saved successfully
[16:22:02] 🔄 
🔄 Step 8: Saving API details...
[16:22:02] [DOC: 9219416] ℹ️  API push details saved for document 9219416
[16:22:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219397                         ║
================================================================================
[16:22:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:22:02] ℹ️  Date: 04/03/2025
[16:22:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:22:06] [DOC: 9219397] ✅ Text extracted using pdfplumber (14905 chars)
[16:22:06] ✅    ✅ Text extracted using pdfplumber (14905 chars)
[16:22:06] 🔄 
🔄 Step 2: Extracting patient data...
[16:22:09] ℹ️  AI extracted raw sex value: 'F'
[16:22:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:22:09] ℹ️  AI extracted payer source: 'Medicare'
[16:22:09] ℹ️  AI extracted diagnoses:
[16:22:09] ℹ️    - Diagnosis 1: 'I10'
[16:22:09] ℹ️    - Diagnosis 2: 'K21.9'
[16:22:09] ℹ️    - Diagnosis 3: 'G30.9'
[16:22:09] ℹ️    - Diagnosis 4: 'E78.5'
[16:22:09] ℹ️    - Diagnosis 5: 'F32.A'
[16:22:09] ℹ️    - Diagnosis 6: 'E11.65'
[16:22:09] ℹ️  Final extracted MRN: 'MA201027114506'
[16:22:09] ℹ️  Final extracted Sex: 'FEMALE'
[16:22:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:22:09] ℹ️  Final extracted Payer Source: 'Medicare'
[16:22:09] ✅ Patient data extraction completed successfully
[16:22:09] ✅    ✅ Patient data extracted successfully
[16:22:09] 📊 Patient Response
     └─ patientFName: Isabel
     └─ patientLName: Azevedo
     └─ dob: 11/19/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA201027114506
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 1881923936
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 825-4022
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/09/2025', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'K21.9', 'thirdDiagnosis': 'G30.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'E11.65'}]
[16:22:09] ✅    ✅ Patient identified: Isabel Azevedo
[16:22:09] ✅    ✅ Patient name validation passed
[16:22:09] 🔄 
🔄 Step 3: Processing patient dates...
[16:22:09] [DOC: 9219397] ℹ️  DOB normalized: 11/19/1945
[16:22:09] [DOC: 9219397] ℹ️  Episode startOfCare normalized: 02/09/2025
[16:22:09] [DOC: 9219397] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[16:22:09] [DOC: 9219397] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[16:22:09] [DOC: 9219397] ✅ Patient date processing completed successfully
[16:22:09] ✅    ✅ Date processing completed
[16:22:09] 📊 Processed Patient Data
     └─ patientFName: Isabel
     └─ patientLName: Azevedo
     └─ dob: 11/19/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA201027114506
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 1881923936
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 825-4022
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/09/2025', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'K21.9', 'thirdDiagnosis': 'G30.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'E11.65'}]
[16:22:09] 🔄 
🔄 Step 4: Extracting order data...
[16:22:11] ℹ️  Order extraction - MRN: 'MA201027114506'
[16:22:11] ℹ️  Order extraction - Sex: 'FEMALE'
[16:22:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:22:11] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:22:11] ✅ Order data extraction completed successfully
[16:22:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:22:11] ℹ️  Using MRN from patient data: 'MA201027114506' over 'MA201027114506'
[16:22:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:22:11] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:22:11] ✅ Patient name cross-validation successful
[16:22:11] ✅    ✅ Data merged successfully
[16:22:13] ✅    ✅ Order data extracted and validated
[16:22:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:22:13] [DOC: 9219397] ✅ Patient found in local cache: Isabel Azevedo, ID: 2d473227-bbda-4e2d-9a7a-a85ebf4e2da7
[16:22:13] ✅    ✅ Existing patient found with ID: 2d473227-bbda-4e2d-9a7a-a85ebf4e2da7
[16:22:13] 🔄 
🔄 Step 6: Pushing order to API...
[16:22:13] [DOC: 9219397] ℹ️  Pushing order via API for patient ID: 2d473227-bbda-4e2d-9a7a-a85ebf4e2da7
[16:22:14] [DOC: 9219397] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12974"}
[16:22:14] ❌    ❌ Failed to push order
[16:22:14] 🔄 
🔄 Step 7: Writing to CSV...
[16:22:14] [DOC: 9219397] ℹ️  Calculated age: 79 from DOB: 11/19/1945
[16:22:14] [DOC: 9219397] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:22:14] [DOC: 9219397] ℹ️  Payer Source extracted: 'Medicare'
[16:22:14] [DOC: 9219397] ℹ️  Diagnosis codes being written:
[16:22:14] [DOC: 9219397] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[16:22:14] [DOC: 9219397] ℹ️    - Latest_Episode_Seconddiagnosis: 'K21.9'
[16:22:14] [DOC: 9219397] ℹ️    - Latest_Episode_Thirddiagnosis: 'G30.9'
[16:22:14] [DOC: 9219397] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[16:22:14] [DOC: 9219397] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.A'
[16:22:14] [DOC: 9219397] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.65'
[16:22:14] [DOC: 9219397] ✅ Patient data written to CSV: Isabel Azevedo | Sex: FEMALE | Age: 79 | Service: Skilled Nursing | Payer: Medicare | MRN: MA201027114506
[16:22:14] ✅    ✅ Document 9219397 processed and saved successfully
[16:22:14] 🔄 
🔄 Step 8: Saving API details...
[16:22:14] [DOC: 9219397] ℹ️  API push details saved for document 9219397
[16:22:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219262                         ║
================================================================================
[16:22:14] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:22:14] ℹ️  Date: 04/03/2025
[16:22:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:22:17] [DOC: 9219262] ✅ Text extracted using pdfplumber (6358 chars)
[16:22:17] ✅    ✅ Text extracted using pdfplumber (6346 chars)
[16:22:17] 🔄 
🔄 Step 2: Extracting patient data...
[16:22:20] ℹ️  AI extracted raw sex value: 'F'
[16:22:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:22:20] ℹ️  AI extracted payer source: ''
[16:22:20] ℹ️  AI extracted diagnoses:
[16:22:20] ℹ️    - Diagnosis 1: 'F31.81'
[16:22:20] ℹ️    - Diagnosis 2: 'F60.3'
[16:22:20] ℹ️    - Diagnosis 3: 'F41.8'
[16:22:20] ℹ️    - Diagnosis 4: 'F43.10'
[16:22:20] ℹ️    - Diagnosis 5: 'R11.15'
[16:22:20] ℹ️    - Diagnosis 6: 'F10.20'
[16:22:20] ℹ️  Final extracted MRN: '93005'
[16:22:20] ℹ️  Final extracted Sex: 'FEMALE'
[16:22:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:22:20] ℹ️  Final extracted Payer Source: ''
[16:22:20] ✅ Patient data extraction completed successfully
[16:22:20] ✅    ✅ Patient data extracted successfully
[16:22:20] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gomes
     └─ dob: 08/04/1993
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 93005
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/27/2020', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F60.3', 'thirdDiagnosis': 'F41.8', 'fourthDiagnosis': 'F43.10', 'fifthDiagnosis': 'R11.15', 'sixthDiagnosis': 'F10.20'}]
[16:22:20] ✅    ✅ Patient identified: Laura Gomes
[16:22:20] ✅    ✅ Patient name validation passed
[16:22:20] 🔄 
🔄 Step 3: Processing patient dates...
[16:22:20] [DOC: 9219262] ℹ️  DOB normalized: 08/04/1993
[16:22:20] [DOC: 9219262] ℹ️  Episode startOfCare normalized: 08/27/2020
[16:22:20] [DOC: 9219262] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[16:22:20] [DOC: 9219262] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[16:22:20] [DOC: 9219262] ✅ Patient date processing completed successfully
[16:22:20] ✅    ✅ Date processing completed
[16:22:20] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gomes
     └─ dob: 08/04/1993
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 93005
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/27/2020', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F60.3', 'thirdDiagnosis': 'F41.8', 'fourthDiagnosis': 'F43.10', 'fifthDiagnosis': 'R11.15', 'sixthDiagnosis': 'F10.20'}]
[16:22:20] 🔄 
🔄 Step 4: Extracting order data...
[16:22:22] ℹ️  Order extraction - MRN: '93005'
[16:22:22] ℹ️  Order extraction - Sex: 'FEMALE'
[16:22:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[16:22:22] ℹ️  Order extraction - Payer Source: ''
[16:22:22] ✅ Order data extraction completed successfully
[16:22:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:22:22] ℹ️  Using MRN from patient data: '93005' over '93005'
[16:22:22] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Occupational Therapy' = 'Occupational Therapy, Skilled Nursing'
[16:22:22] ✅ Patient name cross-validation successful
[16:22:22] ✅    ✅ Data merged successfully
[16:22:23] ✅    ✅ Order data extracted and validated
[16:22:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:22:32] [DOC: 9219262] ✅ Patient exists in API: Laura Gomes, ID: 7f6aecce-ca1f-43fb-bfbb-a05403b98464
[16:22:32] ✅    ✅ Existing patient found with ID: 7f6aecce-ca1f-43fb-bfbb-a05403b98464
[16:22:32] 🔄 
🔄 Step 6: Pushing order to API...
[16:22:32] [DOC: 9219262] ℹ️  Pushing order via API for patient ID: 7f6aecce-ca1f-43fb-bfbb-a05403b98464
[16:22:33] [DOC: 9219262] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:22:33] ❌    ❌ Failed to push order
[16:22:33] 🔄 
🔄 Step 7: Writing to CSV...
[16:22:33] [DOC: 9219262] ℹ️  Calculated age: 31 from DOB: 08/04/1993
[16:22:33] [DOC: 9219262] ℹ️  Service Line extracted: 'Occupational Therapy, Skilled Nursing'
[16:22:33] [DOC: 9219262] ℹ️  Payer Source extracted: ''
[16:22:33] [DOC: 9219262] ℹ️  Diagnosis codes being written:
[16:22:33] [DOC: 9219262] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.81'
[16:22:33] [DOC: 9219262] ℹ️    - Latest_Episode_Seconddiagnosis: 'F60.3'
[16:22:33] [DOC: 9219262] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.8'
[16:22:33] [DOC: 9219262] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F43.10'
[16:22:33] [DOC: 9219262] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R11.15'
[16:22:33] [DOC: 9219262] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F10.20'
[16:22:33] [DOC: 9219262] ✅ Patient data written to CSV: Laura Gomes | Sex: FEMALE | Age: 31 | Service: Occupational Therapy, Skilled Nursing | Payer:  | MRN: 93005
[16:22:33] ✅    ✅ Document 9219262 processed and saved successfully
[16:22:33] 🔄 
🔄 Step 8: Saving API details...
[16:22:33] [DOC: 9219262] ℹ️  API push details saved for document 9219262
[16:22:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219231                         ║
================================================================================
[16:22:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:22:33] ℹ️  Date: 04/03/2025
[16:22:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:22:35] [DOC: 9219231] ✅ Text extracted using pdfplumber (2232 chars)
[16:22:35] ✅    ✅ Text extracted using pdfplumber (2220 chars)
[16:22:35] 🔄 
🔄 Step 2: Extracting patient data...
[16:22:38] ℹ️  AI extracted raw sex value: ''
[16:22:38] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:22:38] ℹ️  AI extracted payer source: ''
[16:22:38] ℹ️  AI extracted diagnoses:
[16:22:38] ℹ️    - Diagnosis 1: 'S32.501'
[16:22:38] ℹ️    - Diagnosis 2: 'S52.022'
[16:22:38] ℹ️    - Diagnosis 3: 'M48.061'
[16:22:38] ℹ️    - Diagnosis 4: 'None'
[16:22:38] ℹ️    - Diagnosis 5: 'None'
[16:22:38] ℹ️    - Diagnosis 6: 'None'
[16:22:38] ℹ️  Final extracted MRN: 'MA221116116005'
[16:22:38] ℹ️  Final extracted Sex: ''
[16:22:38] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:22:38] ℹ️  Final extracted Payer Source: ''
[16:22:38] ✅ Patient data extraction completed successfully
[16:22:38] ✅    ✅ Patient data extracted successfully
[16:22:38] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'S32.501', 'secondDiagnosis': 'S52.022', 'thirdDiagnosis': 'M48.061', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:22:38] ✅    ✅ Patient identified: Kelly Medeiros
[16:22:38] ✅    ✅ Patient name validation passed
[16:22:38] 🔄 
🔄 Step 3: Processing patient dates...
[16:22:38] [DOC: 9219231] ℹ️  DOB normalized: 11/23/1960
[16:22:38] [DOC: 9219231] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[16:22:38] [DOC: 9219231] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[16:22:38] [DOC: 9219231] ✅ Patient date processing completed successfully
[16:22:38] ✅    ✅ Date processing completed
[16:22:38] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'S32.501', 'secondDiagnosis': 'S52.022', 'thirdDiagnosis': 'M48.061'}]
[16:22:38] 🔄 
🔄 Step 4: Extracting order data...
[16:22:41] ℹ️  Order extraction - MRN: 'MA221116116005'
[16:22:41] ℹ️  Order extraction - Sex: ''
[16:22:41] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:22:41] ℹ️  Order extraction - Payer Source: ''
[16:22:41] ✅ Order data extraction completed successfully
[16:22:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:22:41] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[16:22:41] ⚠️  Could not determine sex using any available method
[16:22:41] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:22:41] ✅ Patient name cross-validation successful
[16:22:41] ✅    ✅ Data merged successfully
[16:22:42] ✅    ✅ Order data extracted and validated
[16:22:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:22:57] [DOC: 9219231] ℹ️  Patient not found in cache or API: Kelly Medeiros
[16:22:57] [DOC: 9219231] ℹ️  Patient not found, creating new patient via API...
[16:22:57] [DOC: 9219231] ℹ️  Creating patient via API: Kelly Medeiros
[16:22:58] [DOC: 9219231] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:22:58] ❌    ❌ Failed to create patient
[16:22:58] [DOC: 9219231] ℹ️  API push details saved for document 9219231
================================================================================
║                        Processing Document ID: 9219229                         ║
================================================================================
[16:22:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:22:58] ℹ️  Date: 04/03/2025
[16:22:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:23:10] [DOC: 9219229] ✅ Text extracted using pdfplumber (12452 chars)
[16:23:10] ✅    ✅ Text extracted using pdfplumber (12452 chars)
[16:23:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:23:13] ℹ️  AI extracted raw sex value: 'F'
[16:23:13] ℹ️  AI extracted service line: 'OT'
[16:23:13] ℹ️  AI extracted payer source: ''
[16:23:13] ℹ️  AI extracted diagnoses:
[16:23:13] ℹ️    - Diagnosis 1: ''
[16:23:13] ℹ️    - Diagnosis 2: ''
[16:23:13] ℹ️    - Diagnosis 3: ''
[16:23:13] ℹ️    - Diagnosis 4: ''
[16:23:13] ℹ️    - Diagnosis 5: ''
[16:23:13] ℹ️    - Diagnosis 6: ''
[16:23:13] ℹ️  Final extracted MRN: 'MA221116116005'
[16:23:13] ℹ️  Final extracted Sex: 'FEMALE'
[16:23:13] ℹ️  Final extracted Service Line: 'OT'
[16:23:13] ℹ️  Final extracted Payer Source: ''
[16:23:13] ✅ Patient data extraction completed successfully
[16:23:13] ✅    ✅ Patient data extracted successfully
[16:23:13] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:23:13] ✅    ✅ Patient identified: Kelly Medeiros
[16:23:13] ✅    ✅ Patient name validation passed
[16:23:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:23:13] [DOC: 9219229] ℹ️  DOB normalized: 11/23/1960
[16:23:13] [DOC: 9219229] ✅ Patient date processing completed successfully
[16:23:13] ✅    ✅ Date processing completed
[16:23:13] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:23:13] 🔄 
🔄 Step 4: Extracting order data...
[16:23:15] ℹ️  Order extraction - MRN: 'MA221116116005'
[16:23:15] ℹ️  Order extraction - Sex: 'FEMALE'
[16:23:15] ℹ️  Order extraction - Service Line: 'OT'
[16:23:15] ℹ️  Order extraction - Payer Source: ''
[16:23:15] ✅ Order data extraction completed successfully
[16:23:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:23:15] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[16:23:15] ℹ️  Service line consistent in both sources: 'OT'
[16:23:15] ✅ Patient name cross-validation successful
[16:23:15] ✅    ✅ Data merged successfully
[16:23:17] ⚠️     ❌ Skipping - missing episode start date
[16:23:17] [DOC: 9219229] ℹ️  API push details saved for document 9219229
================================================================================
║                        Processing Document ID: 9219206                         ║
================================================================================
[16:23:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:23:17] ℹ️  Date: 04/03/2025
[16:23:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:23:18] [DOC: 9219206] ✅ Text extracted using pdfplumber (1023 chars)
[16:23:18] ✅    ✅ Text extracted using pdfplumber (1023 chars)
[16:23:18] 🔄 
🔄 Step 2: Extracting patient data...
[16:23:21] ℹ️  AI extracted raw sex value: 'F'
[16:23:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:23:21] ℹ️  AI extracted payer source: ''
[16:23:21] ℹ️  AI extracted diagnoses:
[16:23:21] ℹ️    - Diagnosis 1: 'None'
[16:23:21] ℹ️    - Diagnosis 2: 'None'
[16:23:21] ℹ️    - Diagnosis 3: 'None'
[16:23:21] ℹ️    - Diagnosis 4: 'None'
[16:23:21] ℹ️    - Diagnosis 5: 'None'
[16:23:21] ℹ️    - Diagnosis 6: 'None'
[16:23:21] ℹ️  Final extracted MRN: '3073617'
[16:23:21] ℹ️  Final extracted Sex: 'FEMALE'
[16:23:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:23:21] ℹ️  Final extracted Payer Source: ''
[16:23:21] ✅ Patient data extraction completed successfully
[16:23:21] ✅    ✅ Patient data extracted successfully
[16:23:21] 📊 Patient Response
     └─ patientFName: Ruth
     └─ patientLName: Vital
     └─ dob: 10/11/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3073617
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:23:21] ✅    ✅ Patient identified: Ruth Vital
[16:23:21] ✅    ✅ Patient name validation passed
[16:23:21] 🔄 
🔄 Step 3: Processing patient dates...
[16:23:21] [DOC: 9219206] ℹ️  DOB normalized: 10/11/1936
[16:23:21] [DOC: 9219206] ✅ Patient date processing completed successfully
[16:23:21] ✅    ✅ Date processing completed
[16:23:21] 📊 Processed Patient Data
     └─ patientFName: Ruth
     └─ patientLName: Vital
     └─ dob: 10/11/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3073617
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[16:23:21] 🔄 
🔄 Step 4: Extracting order data...
[16:23:23] ℹ️  Order extraction - MRN: '3073617'
[16:23:23] ℹ️  Order extraction - Sex: 'FEMALE'
[16:23:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:23:23] ℹ️  Order extraction - Payer Source: ''
[16:23:23] ✅ Order data extraction completed successfully
[16:23:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:23:23] ℹ️  Using MRN from patient data: '3073617' over '3073617'
[16:23:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:23:23] ✅ Patient name cross-validation successful
[16:23:23] ✅    ✅ Data merged successfully
[16:23:25] ✅    ✅ Order data extracted and validated
[16:23:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:23:30] [DOC: 9219206] ✅ Patient exists in API: Ruth Vital, ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[16:23:30] ✅    ✅ Existing patient found with ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[16:23:30] 🔄 
🔄 Step 6: Pushing order to API...
[16:23:30] [DOC: 9219206] ℹ️  Pushing order via API for patient ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[16:23:31] [DOC: 9219206] ❌ Order push failed with status 201: {"id":"bc291a73-92a9-4660-8b26-32e8f17ddcbb","orderWAVId":"ORD20068","orderNo":"1077888","orderDate":"04/02/2025","startOfCare":"03/09/2025","episodeStartDate":"03/09/2025","episodeEndDate":"04/12/2025","documentID":"9219206","mrn":"3073617","patientName":"Vital,Ruth J","sentToPhysicianDate":"04/03/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/15/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6b03e825-8391-4922-ab86-fa9a134c2757","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:23:31] ❌    ❌ Failed to push order
[16:23:31] 🔄 
🔄 Step 7: Writing to CSV...
[16:23:31] [DOC: 9219206] ℹ️  Calculated age: 88 from DOB: 10/11/1936
[16:23:31] [DOC: 9219206] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:23:31] [DOC: 9219206] ℹ️  Payer Source extracted: ''
[16:23:31] [DOC: 9219206] ℹ️  Diagnosis codes being written:
[16:23:31] [DOC: 9219206] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:23:31] [DOC: 9219206] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:23:31] [DOC: 9219206] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:23:31] [DOC: 9219206] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:23:31] [DOC: 9219206] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:23:31] [DOC: 9219206] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:23:31] [DOC: 9219206] ✅ Patient data written to CSV: Ruth Vital | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer:  | MRN: 3073617
[16:23:31] ✅    ✅ Document 9219206 processed and saved successfully
[16:23:31] 🔄 
🔄 Step 8: Saving API details...
[16:23:31] [DOC: 9219206] ℹ️  API push details saved for document 9219206
[16:23:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219191                         ║
================================================================================
[16:23:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:23:31] ℹ️  Date: 04/03/2025
[16:23:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:23:33] [DOC: 9219191] ✅ Text extracted using pdfplumber (1631 chars)
[16:23:33] ✅    ✅ Text extracted using pdfplumber (1631 chars)
[16:23:33] 🔄 
🔄 Step 2: Extracting patient data...
[16:23:37] ℹ️  AI extracted raw sex value: 'F'
[16:23:37] ℹ️  AI extracted service line: 'MSW, Medical Social Work'
[16:23:37] ℹ️  AI extracted payer source: ''
[16:23:37] ℹ️  AI extracted diagnoses:
[16:23:37] ℹ️    - Diagnosis 1: ''
[16:23:37] ℹ️    - Diagnosis 2: ''
[16:23:37] ℹ️    - Diagnosis 3: ''
[16:23:37] ℹ️    - Diagnosis 4: ''
[16:23:37] ℹ️    - Diagnosis 5: ''
[16:23:37] ℹ️    - Diagnosis 6: ''
[16:23:37] ℹ️  Final extracted MRN: '3494855'
[16:23:37] ℹ️  Final extracted Sex: 'FEMALE'
[16:23:37] ℹ️  Final extracted Service Line: 'MSW, Medical Social Work'
[16:23:37] ℹ️  Final extracted Payer Source: ''
[16:23:37] ✅ Patient data extraction completed successfully
[16:23:37] ✅    ✅ Patient data extracted successfully
[16:23:37] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Skaza
     └─ dob: 09/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3494855
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: MSW, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '10/4/2024', 'endOfEpisode': '1/1/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '1/2/2025', 'endOfEpisode': '4/1/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '4/2/2025', 'endOfEpisode': '5/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:23:37] ✅    ✅ Patient identified: Patricia Skaza
[16:23:37] ✅    ✅ Patient name validation passed
[16:23:37] 🔄 
🔄 Step 3: Processing patient dates...
[16:23:37] [DOC: 9219191] ℹ️  DOB normalized: 09/23/1947
[16:23:37] [DOC: 9219191] ℹ️  Episode startOfEpisode normalized: 10/04/2024
[16:23:37] [DOC: 9219191] ℹ️  Episode endOfEpisode normalized: 01/01/2025
[16:23:37] [DOC: 9219191] ✅ Patient date processing completed successfully
[16:23:37] ✅    ✅ Date processing completed
[16:23:37] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Skaza
     └─ dob: 09/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3494855
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: MSW, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '10/04/2024', 'endOfEpisode': '01/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '1/2/2025', 'endOfEpisode': '4/1/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '4/2/2025', 'endOfEpisode': '5/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:23:37] 🔄 
🔄 Step 4: Extracting order data...
[16:23:39] ℹ️  Order extraction - MRN: '3494855'
[16:23:39] ℹ️  Order extraction - Sex: 'FEMALE'
[16:23:39] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[16:23:39] ℹ️  Order extraction - Payer Source: ''
[16:23:39] ✅ Order data extraction completed successfully
[16:23:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:23:39] ℹ️  Using MRN from patient data: '3494855' over '3494855'
[16:23:39] ℹ️  Combined service lines: Patient='MSW, Medical Social Work' + Order='Medical Social Work' = 'MSW, Medical Social Work'
[16:23:39] ✅ Patient name cross-validation successful
[16:23:39] ✅    ✅ Data merged successfully
[16:23:40] ✅    ✅ Order data extracted and validated
[16:23:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:23:40] [DOC: 9219191] ✅ Patient found in local cache: Patricia Skaza, ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[16:23:40] ✅    ✅ Existing patient found with ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[16:23:40] 🔄 
🔄 Step 6: Pushing order to API...
[16:23:40] [DOC: 9219191] ℹ️  Pushing order via API for patient ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[16:23:41] [DOC: 9219191] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14602"}
[16:23:41] ❌    ❌ Failed to push order
[16:23:41] 🔄 
🔄 Step 7: Writing to CSV...
[16:23:41] [DOC: 9219191] ℹ️  Calculated age: 77 from DOB: 09/23/1947
[16:23:41] [DOC: 9219191] ℹ️  Service Line extracted: 'MSW, Medical Social Work'
[16:23:41] [DOC: 9219191] ℹ️  Payer Source extracted: ''
[16:23:41] [DOC: 9219191] ℹ️  Diagnosis codes being written:
[16:23:41] [DOC: 9219191] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:23:41] [DOC: 9219191] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:23:41] [DOC: 9219191] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:23:41] [DOC: 9219191] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:23:41] [DOC: 9219191] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:23:41] [DOC: 9219191] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:23:41] [DOC: 9219191] ✅ Patient data written to CSV: Patricia Skaza | Sex: FEMALE | Age: 77 | Service: MSW, Medical Social Work | Payer:  | MRN: 3494855
[16:23:41] ✅    ✅ Document 9219191 processed and saved successfully
[16:23:41] 🔄 
🔄 Step 8: Saving API details...
[16:23:41] [DOC: 9219191] ℹ️  API push details saved for document 9219191
[16:23:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219139                         ║
================================================================================
[16:23:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:23:41] ℹ️  Date: 04/03/2025
[16:23:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:23:43] [DOC: 9219139] ✅ Text extracted using pdfplumber (898 chars)
[16:23:43] ✅    ✅ Text extracted using pdfplumber (898 chars)
[16:23:43] 🔄 
🔄 Step 2: Extracting patient data...
[16:23:46] ℹ️  AI extracted raw sex value: 'M'
[16:23:46] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:23:46] ℹ️  AI extracted payer source: ''
[16:23:46] ℹ️  AI extracted diagnoses:
[16:23:46] ℹ️    - Diagnosis 1: 'None'
[16:23:46] ℹ️    - Diagnosis 2: 'None'
[16:23:46] ℹ️    - Diagnosis 3: 'None'
[16:23:46] ℹ️    - Diagnosis 4: 'None'
[16:23:46] ℹ️    - Diagnosis 5: 'None'
[16:23:46] ℹ️    - Diagnosis 6: 'None'
[16:23:46] ℹ️  Final extracted MRN: '3170225'
[16:23:46] ℹ️  Final extracted Sex: 'MALE'
[16:23:46] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:23:46] ℹ️  Final extracted Payer Source: ''
[16:23:46] ✅ Patient data extraction completed successfully
[16:23:46] ✅    ✅ Patient data extracted successfully
[16:23:46] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:23:46] ✅    ✅ Patient identified: Donald Maceachern
[16:23:46] ✅    ✅ Patient name validation passed
[16:23:46] 🔄 
🔄 Step 3: Processing patient dates...
[16:23:46] [DOC: 9219139] ℹ️  DOB normalized: 11/18/1939
[16:23:46] [DOC: 9219139] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[16:23:46] [DOC: 9219139] ℹ️  Episode endOfEpisode normalized: 04/01/2025
[16:23:46] [DOC: 9219139] ✅ Patient date processing completed successfully
[16:23:46] ✅    ✅ Date processing completed
[16:23:46] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '04/01/2025'}]
[16:23:46] 🔄 
🔄 Step 4: Extracting order data...
[16:23:48] ℹ️  Order extraction - MRN: '3170225'
[16:23:48] ℹ️  Order extraction - Sex: 'MALE'
[16:23:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:23:48] ℹ️  Order extraction - Payer Source: ''
[16:23:48] ✅ Order data extraction completed successfully
[16:23:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:23:48] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[16:23:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:23:48] ✅ Patient name cross-validation successful
[16:23:48] ✅    ✅ Data merged successfully
[16:23:50] ✅    ✅ Order data extracted and validated
[16:23:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:23:50] [DOC: 9219139] ✅ Patient found in local cache: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:23:50] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:23:50] 🔄 
🔄 Step 6: Pushing order to API...
[16:23:50] [DOC: 9219139] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:23:51] [DOC: 9219139] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13304"}
[16:23:51] ❌    ❌ Failed to push order
[16:23:51] 🔄 
🔄 Step 7: Writing to CSV...
[16:23:51] [DOC: 9219139] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[16:23:51] [DOC: 9219139] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:23:51] [DOC: 9219139] ℹ️  Payer Source extracted: ''
[16:23:51] [DOC: 9219139] ℹ️  Diagnosis codes being written:
[16:23:51] [DOC: 9219139] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:23:51] [DOC: 9219139] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:23:51] [DOC: 9219139] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:23:51] [DOC: 9219139] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:23:51] [DOC: 9219139] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:23:51] [DOC: 9219139] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:23:51] [DOC: 9219139] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer:  | MRN: 3170225
[16:23:51] ✅    ✅ Document 9219139 processed and saved successfully
[16:23:51] 🔄 
🔄 Step 8: Saving API details...
[16:23:51] [DOC: 9219139] ℹ️  API push details saved for document 9219139
[16:23:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219127                         ║
================================================================================
[16:23:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:23:51] ℹ️  Date: 04/03/2025
[16:23:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:23:56] [DOC: 9219127] ✅ Text extracted using pdfplumber (18000 chars)
[16:23:56] ✅    ✅ Text extracted using pdfplumber (18000 chars)
[16:23:56] 🔄 
🔄 Step 2: Extracting patient data...
[16:23:59] ℹ️  AI extracted raw sex value: 'F'
[16:23:59] ℹ️  AI extracted service line: 'PT'
[16:23:59] ℹ️  AI extracted payer source: 'None'
[16:23:59] ℹ️  AI extracted diagnoses:
[16:23:59] ℹ️    - Diagnosis 1: 'S82.891D'
[16:23:59] ℹ️    - Diagnosis 2: 'R29.6'
[16:23:59] ℹ️    - Diagnosis 3: 'None'
[16:23:59] ℹ️    - Diagnosis 4: 'None'
[16:23:59] ℹ️    - Diagnosis 5: 'None'
[16:23:59] ℹ️    - Diagnosis 6: 'None'
[16:23:59] ℹ️  Final extracted MRN: 'MA210216076302'
[16:23:59] ℹ️  Final extracted Sex: 'FEMALE'
[16:23:59] ℹ️  Final extracted Service Line: 'PT'
[16:23:59] ℹ️  Final extracted Payer Source: ''
[16:23:59] ✅ Patient data extraction completed successfully
[16:23:59] ✅    ✅ Patient data extracted successfully
[16:23:59] 📊 Patient Response
     └─ patientFName: Jeannine
     └─ patientLName: Lavigne
     └─ dob: 09/27/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210216076302
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'S82.891D', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:23:59] ✅    ✅ Patient identified: Jeannine Lavigne
[16:23:59] ✅    ✅ Patient name validation passed
[16:23:59] 🔄 
🔄 Step 3: Processing patient dates...
[16:23:59] [DOC: 9219127] ℹ️  DOB normalized: 09/27/1963
[16:23:59] [DOC: 9219127] ✅ Patient date processing completed successfully
[16:23:59] ✅    ✅ Date processing completed
[16:23:59] 📊 Processed Patient Data
     └─ patientFName: Jeannine
     └─ patientLName: Lavigne
     └─ dob: 09/27/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210216076302
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'S82.891D', 'secondDiagnosis': 'R29.6'}]
[16:23:59] 🔄 
🔄 Step 4: Extracting order data...
[16:24:02] ℹ️  Order extraction - MRN: 'MA210216076302'
[16:24:02] ℹ️  Order extraction - Sex: 'FEMALE'
[16:24:02] ℹ️  Order extraction - Service Line: 'PT'
[16:24:02] ℹ️  Order extraction - Payer Source: ''
[16:24:02] ✅ Order data extraction completed successfully
[16:24:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:24:02] ℹ️  Using MRN from patient data: 'MA210216076302' over 'MA210216076302'
[16:24:02] ℹ️  Service line consistent in both sources: 'PT'
[16:24:02] ✅ Patient name cross-validation successful
[16:24:02] ✅    ✅ Data merged successfully
[16:24:03] ⚠️     ❌ Skipping - missing episode start date
[16:24:03] [DOC: 9219127] ℹ️  API push details saved for document 9219127
================================================================================
║                        Processing Document ID: 9219106                         ║
================================================================================
[16:24:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:24:03] ℹ️  Date: 04/03/2025
[16:24:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:24:04] [DOC: 9219106] ✅ Text extracted using pdfplumber (1089 chars)
[16:24:04] ✅    ✅ Text extracted using pdfplumber (1089 chars)
[16:24:04] 🔄 
🔄 Step 2: Extracting patient data...
[16:24:07] ℹ️  AI extracted raw sex value: 'F'
[16:24:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:24:07] ℹ️  AI extracted payer source: ''
[16:24:07] ℹ️  AI extracted diagnoses:
[16:24:07] ℹ️    - Diagnosis 1: ''
[16:24:07] ℹ️    - Diagnosis 2: ''
[16:24:07] ℹ️    - Diagnosis 3: ''
[16:24:07] ℹ️    - Diagnosis 4: ''
[16:24:07] ℹ️    - Diagnosis 5: ''
[16:24:07] ℹ️    - Diagnosis 6: ''
[16:24:07] ℹ️  Final extracted MRN: '2455123'
[16:24:07] ℹ️  Final extracted Sex: 'FEMALE'
[16:24:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:24:07] ℹ️  Final extracted Payer Source: ''
[16:24:07] ✅ Patient data extraction completed successfully
[16:24:07] ✅    ✅ Patient data extracted successfully
[16:24:07] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:07] ✅    ✅ Patient identified: Donna Faria
[16:24:07] ✅    ✅ Patient name validation passed
[16:24:07] 🔄 
🔄 Step 3: Processing patient dates...
[16:24:07] [DOC: 9219106] ℹ️  DOB normalized: 04/27/1958
[16:24:07] [DOC: 9219106] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[16:24:07] [DOC: 9219106] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[16:24:07] [DOC: 9219106] ✅ Patient date processing completed successfully
[16:24:07] ✅    ✅ Date processing completed
[16:24:07] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:07] 🔄 
🔄 Step 4: Extracting order data...
[16:24:10] ℹ️  Order extraction - MRN: '2455123'
[16:24:10] ℹ️  Order extraction - Sex: 'FEMALE'
[16:24:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:24:10] ℹ️  Order extraction - Payer Source: ''
[16:24:10] ✅ Order data extraction completed successfully
[16:24:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:24:10] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[16:24:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:24:10] ✅ Patient name cross-validation successful
[16:24:10] ✅    ✅ Data merged successfully
[16:24:11] ✅    ✅ Order data extracted and validated
[16:24:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:24:11] [DOC: 9219106] ✅ Patient found in local cache: Donna Faria, ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[16:24:11] ✅    ✅ Existing patient found with ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[16:24:11] 🔄 
🔄 Step 6: Pushing order to API...
[16:24:11] [DOC: 9219106] ℹ️  Pushing order via API for patient ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[16:24:12] [DOC: 9219106] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14147"}
[16:24:12] ❌    ❌ Failed to push order
[16:24:12] 🔄 
🔄 Step 7: Writing to CSV...
[16:24:12] [DOC: 9219106] ℹ️  Calculated age: 67 from DOB: 04/27/1958
[16:24:12] [DOC: 9219106] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:24:12] [DOC: 9219106] ℹ️  Payer Source extracted: ''
[16:24:12] [DOC: 9219106] ℹ️  Diagnosis codes being written:
[16:24:12] [DOC: 9219106] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:24:12] [DOC: 9219106] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:24:12] [DOC: 9219106] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:24:12] [DOC: 9219106] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:24:12] [DOC: 9219106] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:24:12] [DOC: 9219106] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:24:12] [DOC: 9219106] ✅ Patient data written to CSV: Donna Faria | Sex: FEMALE | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: 2455123
[16:24:12] ✅    ✅ Document 9219106 processed and saved successfully
[16:24:12] 🔄 
🔄 Step 8: Saving API details...
[16:24:12] [DOC: 9219106] ℹ️  API push details saved for document 9219106
[16:24:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219104                         ║
================================================================================
[16:24:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:24:12] ℹ️  Date: 04/03/2025
[16:24:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:24:14] [DOC: 9219104] ✅ Text extracted using pdfplumber (983 chars)
[16:24:14] ✅    ✅ Text extracted using pdfplumber (983 chars)
[16:24:14] 🔄 
🔄 Step 2: Extracting patient data...
[16:24:16] ℹ️  AI extracted raw sex value: 'M'
[16:24:16] ℹ️  AI extracted service line: 'Physical Therapy'
[16:24:16] ℹ️  AI extracted payer source: ''
[16:24:16] ℹ️  AI extracted diagnoses:
[16:24:16] ℹ️    - Diagnosis 1: ''
[16:24:16] ℹ️    - Diagnosis 2: ''
[16:24:16] ℹ️    - Diagnosis 3: ''
[16:24:16] ℹ️    - Diagnosis 4: ''
[16:24:16] ℹ️    - Diagnosis 5: ''
[16:24:16] ℹ️    - Diagnosis 6: ''
[16:24:16] ℹ️  Final extracted MRN: '2447688'
[16:24:16] ℹ️  Final extracted Sex: 'MALE'
[16:24:16] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:24:16] ℹ️  Final extracted Payer Source: ''
[16:24:16] ✅ Patient data extraction completed successfully
[16:24:16] ✅    ✅ Patient data extracted successfully
[16:24:16] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:16] ✅    ✅ Patient identified: George England
[16:24:16] ✅    ✅ Patient name validation passed
[16:24:16] 🔄 
🔄 Step 3: Processing patient dates...
[16:24:16] [DOC: 9219104] ℹ️  DOB normalized: 08/26/1924
[16:24:16] [DOC: 9219104] ✅ Patient date processing completed successfully
[16:24:16] ✅    ✅ Date processing completed
[16:24:16] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:16] 🔄 
🔄 Step 4: Extracting order data...
[16:24:19] ℹ️  Order extraction - MRN: '2447688'
[16:24:19] ℹ️  Order extraction - Sex: 'MALE'
[16:24:19] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:24:19] ℹ️  Order extraction - Payer Source: ''
[16:24:19] ✅ Order data extraction completed successfully
[16:24:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:24:19] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[16:24:19] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:24:19] ✅ Patient name cross-validation successful
[16:24:19] ✅    ✅ Data merged successfully
[16:24:20] ✅    ✅ Order data extracted and validated
[16:24:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:24:20] [DOC: 9219104] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[16:24:20] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[16:24:20] 🔄 
🔄 Step 6: Pushing order to API...
[16:24:20] [DOC: 9219104] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[16:24:21] [DOC: 9219104] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14167"}
[16:24:21] ❌    ❌ Failed to push order
[16:24:21] 🔄 
🔄 Step 7: Writing to CSV...
[16:24:21] [DOC: 9219104] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[16:24:21] [DOC: 9219104] ℹ️  Service Line extracted: 'Physical Therapy'
[16:24:21] [DOC: 9219104] ℹ️  Payer Source extracted: ''
[16:24:21] [DOC: 9219104] ℹ️  Diagnosis codes being written:
[16:24:21] [DOC: 9219104] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:24:21] [DOC: 9219104] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:24:21] [DOC: 9219104] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:24:21] [DOC: 9219104] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:24:21] [DOC: 9219104] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:24:21] [DOC: 9219104] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:24:21] [DOC: 9219104] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Physical Therapy | Payer:  | MRN: 2447688
[16:24:21] ✅    ✅ Document 9219104 processed and saved successfully
[16:24:21] 🔄 
🔄 Step 8: Saving API details...
[16:24:21] [DOC: 9219104] ℹ️  API push details saved for document 9219104
[16:24:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219100                         ║
================================================================================
[16:24:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:24:21] ℹ️  Date: 04/03/2025
[16:24:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:24:22] [DOC: 9219100] ✅ Text extracted using pdfplumber (1652 chars)
[16:24:22] ✅    ✅ Text extracted using pdfplumber (1652 chars)
[16:24:22] 🔄 
🔄 Step 2: Extracting patient data...
[16:24:25] ℹ️  AI extracted raw sex value: 'F'
[16:24:25] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:24:25] ℹ️  AI extracted payer source: ''
[16:24:25] ℹ️  AI extracted diagnoses:
[16:24:25] ℹ️    - Diagnosis 1: ''
[16:24:25] ℹ️    - Diagnosis 2: ''
[16:24:25] ℹ️    - Diagnosis 3: ''
[16:24:25] ℹ️    - Diagnosis 4: ''
[16:24:25] ℹ️    - Diagnosis 5: ''
[16:24:25] ℹ️    - Diagnosis 6: ''
[16:24:25] ℹ️  Final extracted MRN: '2420800'
[16:24:25] ℹ️  Final extracted Sex: 'FEMALE'
[16:24:25] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:24:25] ℹ️  Final extracted Payer Source: ''
[16:24:25] ✅ Patient data extraction completed successfully
[16:24:25] ✅    ✅ Patient data extracted successfully
[16:24:25] 📊 Patient Response
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:25] ✅    ✅ Patient identified: Sally Dobson
[16:24:25] ✅    ✅ Patient name validation passed
[16:24:25] 🔄 
🔄 Step 3: Processing patient dates...
[16:24:25] [DOC: 9219100] ℹ️  DOB normalized: 09/19/1941
[16:24:25] [DOC: 9219100] ✅ Patient date processing completed successfully
[16:24:25] ✅    ✅ Date processing completed
[16:24:25] 📊 Processed Patient Data
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:25] 🔄 
🔄 Step 4: Extracting order data...
[16:24:27] ℹ️  Order extraction - MRN: '2420800'
[16:24:27] ℹ️  Order extraction - Sex: 'FEMALE'
[16:24:27] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:24:27] ℹ️  Order extraction - Payer Source: ''
[16:24:27] ✅ Order data extraction completed successfully
[16:24:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:24:27] ℹ️  Using MRN from patient data: '2420800' over '2420800'
[16:24:27] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:24:27] ✅ Patient name cross-validation successful
[16:24:27] ✅    ✅ Data merged successfully
[16:24:28] ✅    ✅ Order data extracted and validated
[16:24:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:24:37] [DOC: 9219100] ℹ️  Patient not found in cache or API: Sally Dobson
[16:24:37] [DOC: 9219100] ℹ️  Patient not found, creating new patient via API...
[16:24:37] [DOC: 9219100] ℹ️  Creating patient via API: Sally Dobson
[16:24:38] [DOC: 9219100] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:24:38] ❌    ❌ Failed to create patient
[16:24:38] [DOC: 9219100] ℹ️  API push details saved for document 9219100
================================================================================
║                        Processing Document ID: 9219098                         ║
================================================================================
[16:24:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:24:38] ℹ️  Date: 04/03/2025
[16:24:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:24:39] [DOC: 9219098] ✅ Text extracted using pdfplumber (1296 chars)
[16:24:39] ✅    ✅ Text extracted using pdfplumber (1296 chars)
[16:24:39] 🔄 
🔄 Step 2: Extracting patient data...
[16:24:42] ℹ️  AI extracted raw sex value: 'F'
[16:24:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:24:42] ℹ️  AI extracted payer source: ''
[16:24:42] ℹ️  AI extracted diagnoses:
[16:24:42] ℹ️    - Diagnosis 1: ''
[16:24:42] ℹ️    - Diagnosis 2: ''
[16:24:42] ℹ️    - Diagnosis 3: ''
[16:24:42] ℹ️    - Diagnosis 4: ''
[16:24:42] ℹ️    - Diagnosis 5: ''
[16:24:42] ℹ️    - Diagnosis 6: ''
[16:24:42] ℹ️  Final extracted MRN: '2392166'
[16:24:42] ℹ️  Final extracted Sex: 'FEMALE'
[16:24:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:24:42] ℹ️  Final extracted Payer Source: ''
[16:24:42] ✅ Patient data extraction completed successfully
[16:24:42] ✅    ✅ Patient data extracted successfully
[16:24:42] 📊 Patient Response
     └─ patientFName: Angela
     └─ patientLName: Days
     └─ dob: 09/10/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2392166
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:42] ✅    ✅ Patient identified: Angela Days
[16:24:42] ✅    ✅ Patient name validation passed
[16:24:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:24:42] [DOC: 9219098] ℹ️  DOB normalized: 09/10/1950
[16:24:42] [DOC: 9219098] ✅ Patient date processing completed successfully
[16:24:42] ✅    ✅ Date processing completed
[16:24:42] 📊 Processed Patient Data
     └─ patientFName: Angela
     └─ patientLName: Days
     └─ dob: 09/10/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2392166
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:24:42] 🔄 
🔄 Step 4: Extracting order data...
[16:24:44] ℹ️  Order extraction - MRN: '2392166'
[16:24:44] ℹ️  Order extraction - Sex: 'FEMALE'
[16:24:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:24:44] ℹ️  Order extraction - Payer Source: ''
[16:24:44] ✅ Order data extraction completed successfully
[16:24:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:24:44] ℹ️  Using MRN from patient data: '2392166' over '2392166'
[16:24:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:24:44] ✅ Patient name cross-validation successful
[16:24:44] ✅    ✅ Data merged successfully
[16:24:45] ✅    ✅ Order data extracted and validated
[16:24:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:25:07] [DOC: 9219098] ℹ️  Patient not found in cache or API: Angela Days
[16:25:07] [DOC: 9219098] ℹ️  Patient not found, creating new patient via API...
[16:25:07] [DOC: 9219098] ℹ️  Creating patient via API: Angela Days
[16:25:08] [DOC: 9219098] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:25:08] ❌    ❌ Failed to create patient
[16:25:08] [DOC: 9219098] ℹ️  API push details saved for document 9219098
================================================================================
║                        Processing Document ID: 9219090                         ║
================================================================================
[16:25:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:25:08] ℹ️  Date: 04/03/2025
[16:25:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:25:10] [DOC: 9219090] ✅ Text extracted using pdfplumber (1083 chars)
[16:25:10] ✅    ✅ Text extracted using pdfplumber (1083 chars)
[16:25:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:25:13] ℹ️  AI extracted raw sex value: 'M'
[16:25:13] ℹ️  AI extracted service line: 'Physical Therapy'
[16:25:13] ℹ️  AI extracted payer source: ''
[16:25:13] ℹ️  AI extracted diagnoses:
[16:25:13] ℹ️    - Diagnosis 1: ''
[16:25:13] ℹ️    - Diagnosis 2: ''
[16:25:13] ℹ️    - Diagnosis 3: ''
[16:25:13] ℹ️    - Diagnosis 4: ''
[16:25:13] ℹ️    - Diagnosis 5: ''
[16:25:13] ℹ️    - Diagnosis 6: ''
[16:25:13] ℹ️  Final extracted MRN: '2312121'
[16:25:13] ℹ️  Final extracted Sex: 'MALE'
[16:25:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:25:13] ℹ️  Final extracted Payer Source: ''
[16:25:13] ✅ Patient data extraction completed successfully
[16:25:13] ✅    ✅ Patient data extracted successfully
[16:25:13] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:25:13] ✅    ✅ Patient identified: Antonio Carvalho
[16:25:13] ✅    ✅ Patient name validation passed
[16:25:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:25:13] [DOC: 9219090] ℹ️  DOB normalized: 07/01/1933
[16:25:13] [DOC: 9219090] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[16:25:13] [DOC: 9219090] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[16:25:13] [DOC: 9219090] ✅ Patient date processing completed successfully
[16:25:13] ✅    ✅ Date processing completed
[16:25:13] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:25:13] 🔄 
🔄 Step 4: Extracting order data...
[16:25:15] ℹ️  Order extraction - MRN: '2312121'
[16:25:15] ℹ️  Order extraction - Sex: 'MALE'
[16:25:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:25:15] ℹ️  Order extraction - Payer Source: ''
[16:25:15] ✅ Order data extraction completed successfully
[16:25:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:25:15] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[16:25:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:25:15] ✅ Patient name cross-validation successful
[16:25:15] ✅    ✅ Data merged successfully
[16:25:16] ✅    ✅ Order data extracted and validated
[16:25:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:25:21] [DOC: 9219090] ℹ️  Patient not found in cache or API: Antonio Carvalho
[16:25:21] [DOC: 9219090] ℹ️  Patient not found, creating new patient via API...
[16:25:21] [DOC: 9219090] ℹ️  Creating patient via API: Antonio Carvalho
[16:25:23] [DOC: 9219090] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:25:23] ❌    ❌ Failed to create patient
[16:25:23] [DOC: 9219090] ℹ️  API push details saved for document 9219090
================================================================================
║                        Processing Document ID: 9219078                         ║
================================================================================
[16:25:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:25:23] ℹ️  Date: 04/03/2025
[16:25:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:25:25] [DOC: 9219078] ✅ Text extracted using pdfplumber (888 chars)
[16:25:25] ✅    ✅ Text extracted using pdfplumber (888 chars)
[16:25:25] 🔄 
🔄 Step 2: Extracting patient data...
[16:25:28] ℹ️  AI extracted raw sex value: 'F'
[16:25:28] ℹ️  AI extracted service line: 'Physical Therapy'
[16:25:28] ℹ️  AI extracted payer source: ''
[16:25:28] ℹ️  AI extracted diagnoses:
[16:25:28] ℹ️    - Diagnosis 1: ''
[16:25:28] ℹ️    - Diagnosis 2: ''
[16:25:28] ℹ️    - Diagnosis 3: ''
[16:25:28] ℹ️    - Diagnosis 4: ''
[16:25:28] ℹ️    - Diagnosis 5: ''
[16:25:28] ℹ️    - Diagnosis 6: ''
[16:25:28] ℹ️  Final extracted MRN: '3148474'
[16:25:28] ℹ️  Final extracted Sex: 'FEMALE'
[16:25:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:25:28] ℹ️  Final extracted Payer Source: ''
[16:25:28] ✅ Patient data extraction completed successfully
[16:25:28] ✅    ✅ Patient data extracted successfully
[16:25:28] 📊 Patient Response
     └─ patientFName: Simone
     └─ patientLName: Benac
     └─ dob: 08/16/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3148474
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:25:28] ✅    ✅ Patient identified: Simone Benac
[16:25:28] ✅    ✅ Patient name validation passed
[16:25:28] 🔄 
🔄 Step 3: Processing patient dates...
[16:25:28] [DOC: 9219078] ℹ️  DOB normalized: 08/16/1953
[16:25:28] [DOC: 9219078] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[16:25:28] [DOC: 9219078] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[16:25:28] [DOC: 9219078] ✅ Patient date processing completed successfully
[16:25:28] ✅    ✅ Date processing completed
[16:25:28] 📊 Processed Patient Data
     └─ patientFName: Simone
     └─ patientLName: Benac
     └─ dob: 08/16/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3148474
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:25:28] 🔄 
🔄 Step 4: Extracting order data...
[16:25:30] ℹ️  Order extraction - MRN: '3148474'
[16:25:30] ℹ️  Order extraction - Sex: 'FEMALE'
[16:25:30] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:25:30] ℹ️  Order extraction - Payer Source: ''
[16:25:30] ✅ Order data extraction completed successfully
[16:25:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:25:30] ℹ️  Using MRN from patient data: '3148474' over '3148474'
[16:25:30] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:25:30] ✅ Patient name cross-validation successful
[16:25:30] ✅    ✅ Data merged successfully
[16:25:31] ✅    ✅ Order data extracted and validated
[16:25:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:25:31] [DOC: 9219078] ✅ Patient found in local cache: Simone Benac, ID: 6ef2ce76-2671-4a73-84f5-665624eb8e15
[16:25:31] ✅    ✅ Existing patient found with ID: 6ef2ce76-2671-4a73-84f5-665624eb8e15
[16:25:31] 🔄 
🔄 Step 6: Pushing order to API...
[16:25:31] [DOC: 9219078] ℹ️  Pushing order via API for patient ID: 6ef2ce76-2671-4a73-84f5-665624eb8e15
[16:25:33] [DOC: 9219078] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13091"}
[16:25:33] ❌    ❌ Failed to push order
[16:25:33] 🔄 
🔄 Step 7: Writing to CSV...
[16:25:33] [DOC: 9219078] ℹ️  Calculated age: 71 from DOB: 08/16/1953
[16:25:33] [DOC: 9219078] ℹ️  Service Line extracted: 'Physical Therapy'
[16:25:33] [DOC: 9219078] ℹ️  Payer Source extracted: ''
[16:25:33] [DOC: 9219078] ℹ️  Diagnosis codes being written:
[16:25:33] [DOC: 9219078] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:25:33] [DOC: 9219078] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:25:33] [DOC: 9219078] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:25:33] [DOC: 9219078] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:25:33] [DOC: 9219078] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:25:33] [DOC: 9219078] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:25:33] [DOC: 9219078] ✅ Patient data written to CSV: Simone Benac | Sex: FEMALE | Age: 71 | Service: Physical Therapy | Payer:  | MRN: 3148474
[16:25:33] ✅    ✅ Document 9219078 processed and saved successfully
[16:25:33] 🔄 
🔄 Step 8: Saving API details...
[16:25:33] [DOC: 9219078] ℹ️  API push details saved for document 9219078
[16:25:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219074                         ║
================================================================================
[16:25:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:25:33] ℹ️  Date: 04/03/2025
[16:25:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:25:34] [DOC: 9219074] ✅ Text extracted using pdfplumber (1116 chars)
[16:25:34] ✅    ✅ Text extracted using pdfplumber (1116 chars)
[16:25:34] 🔄 
🔄 Step 2: Extracting patient data...
[16:25:37] ℹ️  AI extracted raw sex value: 'F'
[16:25:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:25:37] ℹ️  AI extracted payer source: ''
[16:25:37] ℹ️  AI extracted diagnoses:
[16:25:37] ℹ️    - Diagnosis 1: 'None'
[16:25:37] ℹ️    - Diagnosis 2: 'None'
[16:25:37] ℹ️    - Diagnosis 3: 'None'
[16:25:37] ℹ️    - Diagnosis 4: 'None'
[16:25:37] ℹ️    - Diagnosis 5: 'None'
[16:25:37] ℹ️    - Diagnosis 6: 'None'
[16:25:37] ℹ️  Final extracted MRN: '2183742'
[16:25:37] ℹ️  Final extracted Sex: 'FEMALE'
[16:25:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:25:37] ℹ️  Final extracted Payer Source: ''
[16:25:37] ✅ Patient data extraction completed successfully
[16:25:37] ✅    ✅ Patient data extracted successfully
[16:25:37] 📊 Patient Response
     └─ patientFName: Amelia
     └─ patientLName: Amaral
     └─ dob: 01/07/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2183742
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:25:37] ✅    ✅ Patient identified: Amelia Amaral
[16:25:37] ✅    ✅ Patient name validation passed
[16:25:37] 🔄 
🔄 Step 3: Processing patient dates...
[16:25:37] [DOC: 9219074] ℹ️  DOB normalized: 01/07/1930
[16:25:37] [DOC: 9219074] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[16:25:37] [DOC: 9219074] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[16:25:37] [DOC: 9219074] ✅ Patient date processing completed successfully
[16:25:37] ✅    ✅ Date processing completed
[16:25:37] 📊 Processed Patient Data
     └─ patientFName: Amelia
     └─ patientLName: Amaral
     └─ dob: 01/07/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2183742
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025'}]
[16:25:37] 🔄 
🔄 Step 4: Extracting order data...
[16:25:39] ℹ️  Order extraction - MRN: '2183742'
[16:25:39] ℹ️  Order extraction - Sex: 'FEMALE'
[16:25:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:25:39] ℹ️  Order extraction - Payer Source: ''
[16:25:39] ✅ Order data extraction completed successfully
[16:25:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:25:39] ℹ️  Using MRN from patient data: '2183742' over '2183742'
[16:25:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:25:39] ✅ Patient name cross-validation successful
[16:25:39] ✅    ✅ Data merged successfully
[16:25:40] ✅    ✅ Order data extracted and validated
[16:25:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:25:46] [DOC: 9219074] ℹ️  Patient not found in cache or API: Amelia Amaral
[16:25:46] [DOC: 9219074] ℹ️  Patient not found, creating new patient via API...
[16:25:46] [DOC: 9219074] ℹ️  Creating patient via API: Amelia Amaral
[16:25:47] [DOC: 9219074] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:25:47] ❌    ❌ Failed to create patient
[16:25:47] [DOC: 9219074] ℹ️  API push details saved for document 9219074
================================================================================
║                        Processing Document ID: 9219059                         ║
================================================================================
[16:25:47] ℹ️  Agency: Fairhaven HH&H
[16:25:47] ℹ️  Date: 04/03/2025
[16:25:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:25:48] [DOC: 9219059] ❌ Critical failure in get_pdf_text: Invalid response format
[16:25:48] ❌ Failed to extract text for Doc ID 9219059
[16:25:48] [DOC: 9219059] ℹ️  API push details saved for document 9219059
================================================================================
║                        Processing Document ID: 9219056                         ║
================================================================================
[16:25:48] ℹ️  Agency: Dartmouth HH
[16:25:48] ℹ️  Date: 04/03/2025
[16:25:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:25:50] [DOC: 9219056] ✅ Text extracted using pdfplumber (6574 chars)
[16:25:50] ✅    ✅ Text extracted using pdfplumber (6574 chars)
[16:25:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:25:53] ℹ️  AI extracted raw sex value: 'M'
[16:25:53] ℹ️  AI extracted service line: 'OT, RN'
[16:25:53] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:25:53] ℹ️  AI extracted diagnoses:
[16:25:53] ℹ️    - Diagnosis 1: 'C7 Fracture'
[16:25:53] ℹ️    - Diagnosis 2: 'PE'
[16:25:53] ℹ️    - Diagnosis 3: 'CAD'
[16:25:53] ℹ️    - Diagnosis 4: 'A-FIB'
[16:25:53] ℹ️    - Diagnosis 5: 'Dysphagia'
[16:25:53] ℹ️    - Diagnosis 6: 'BPH'
[16:25:53] ℹ️  Final extracted MRN: '6224015'
[16:25:53] ℹ️  Final extracted Sex: 'MALE'
[16:25:53] ℹ️  Final extracted Service Line: 'OT, RN'
[16:25:53] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:25:53] ✅ Patient data extraction completed successfully
[16:25:53] ✅    ✅ Patient data extracted successfully
[16:25:53] 📊 Patient Response
     └─ patientFName: Leslie
     └─ patientLName: Dole
     └─ dob: 03/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 6224015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'C7 Fracture', 'secondDiagnosis': 'PE', 'thirdDiagnosis': 'CAD', 'fourthDiagnosis': 'A-FIB', 'fifthDiagnosis': 'Dysphagia', 'sixthDiagnosis': 'BPH'}]
[16:25:53] ✅    ✅ Patient identified: Leslie Dole
[16:25:53] ✅    ✅ Patient name validation passed
[16:25:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:25:53] [DOC: 9219056] ℹ️  DOB normalized: 03/17/1941
[16:25:53] [DOC: 9219056] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:25:53] [DOC: 9219056] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[16:25:53] [DOC: 9219056] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[16:25:53] [DOC: 9219056] ✅ Patient date processing completed successfully
[16:25:53] ✅    ✅ Date processing completed
[16:25:53] 📊 Processed Patient Data
     └─ patientFName: Leslie
     └─ patientLName: Dole
     └─ dob: 03/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 6224015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'C7 Fracture', 'secondDiagnosis': 'PE', 'thirdDiagnosis': 'CAD', 'fourthDiagnosis': 'A-FIB', 'fifthDiagnosis': 'Dysphagia', 'sixthDiagnosis': 'BPH'}]
[16:25:53] 🔄 
🔄 Step 4: Extracting order data...
[16:25:56] ℹ️  Order extraction - MRN: '6224015'
[16:25:56] ℹ️  Order extraction - Sex: 'MALE'
[16:25:56] ℹ️  Order extraction - Service Line: 'OT'
[16:25:56] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:25:56] ✅ Order data extraction completed successfully
[16:25:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:25:56] ℹ️  Using MRN from patient data: '6224015' over '6224015'
[16:25:56] ℹ️  Combined service lines: Patient='OT, RN' + Order='OT' = 'OT, RN'
[16:25:56] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:25:56] ✅ Patient name cross-validation successful
[16:25:56] ✅    ✅ Data merged successfully
[16:25:57] ✅    ✅ Order data extracted and validated
[16:25:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:26:39] [DOC: 9219056] ✅ Patient exists in API: Leslie Dole, ID: f5763885-18a9-4daf-9d22-7bd3e5e24814
[16:26:39] ✅    ✅ Existing patient found with ID: f5763885-18a9-4daf-9d22-7bd3e5e24814
[16:26:39] 🔄 
🔄 Step 6: Pushing order to API...
[16:26:39] [DOC: 9219056] ℹ️  Pushing order via API for patient ID: f5763885-18a9-4daf-9d22-7bd3e5e24814
[16:26:40] [DOC: 9219056] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:26:40] ❌    ❌ Failed to push order
[16:26:40] 🔄 
🔄 Step 7: Writing to CSV...
[16:26:40] [DOC: 9219056] ℹ️  Calculated age: 84 from DOB: 03/17/1941
[16:26:40] [DOC: 9219056] ℹ️  Service Line extracted: 'OT, RN'
[16:26:40] [DOC: 9219056] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[16:26:40] [DOC: 9219056] ℹ️  Diagnosis codes being written:
[16:26:40] [DOC: 9219056] ℹ️    - Latest_Episode_Firstdiagnosis: 'C7 Fracture'
[16:26:40] [DOC: 9219056] ℹ️    - Latest_Episode_Seconddiagnosis: 'PE'
[16:26:40] [DOC: 9219056] ℹ️    - Latest_Episode_Thirddiagnosis: 'CAD'
[16:26:40] [DOC: 9219056] ℹ️    - Latest_Episode_Fourthdiagnosis: 'A-FIB'
[16:26:40] [DOC: 9219056] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Dysphagia'
[16:26:40] [DOC: 9219056] ℹ️    - Latest_Episode_Sixthdiagnosis: 'BPH'
[16:26:40] [DOC: 9219056] ✅ Patient data written to CSV: Leslie Dole | Sex: MALE | Age: 84 | Service: OT, RN | Payer: Aetna- Mcare | MRN: 6224015
[16:26:40] ✅    ✅ Document 9219056 processed and saved successfully
[16:26:40] 🔄 
🔄 Step 8: Saving API details...
[16:26:40] [DOC: 9219056] ℹ️  API push details saved for document 9219056
[16:26:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219055                         ║
================================================================================
[16:26:40] ℹ️  Agency: Dartmouth HH
[16:26:40] ℹ️  Date: 04/03/2025
[16:26:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:26:44] [DOC: 9219055] ✅ Text extracted using pdfplumber (18567 chars)
[16:26:44] ✅    ✅ Text extracted using pdfplumber (18567 chars)
[16:26:44] 🔄 
🔄 Step 2: Extracting patient data...
[16:26:48] ℹ️  AI extracted raw sex value: 'M'
[16:26:48] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[16:26:48] ℹ️  AI extracted payer source: ''
[16:26:48] ℹ️  AI extracted diagnoses:
[16:26:48] ℹ️    - Diagnosis 1: 'I26.99'
[16:26:48] ℹ️    - Diagnosis 2: 'S12.690D'
[16:26:48] ℹ️    - Diagnosis 3: 'S06.5XAD'
[16:26:48] ℹ️    - Diagnosis 4: 'I48.91'
[16:26:48] ℹ️    - Diagnosis 5: 'I95.1'
[16:26:48] ℹ️    - Diagnosis 6: 'R13.12'
[16:26:48] ℹ️  Final extracted MRN: '6224015'
[16:26:48] ℹ️  Final extracted Sex: 'MALE'
[16:26:48] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[16:26:48] ℹ️  Final extracted Payer Source: ''
[16:26:48] ✅ Patient data extraction completed successfully
[16:26:48] ✅    ✅ Patient data extracted successfully
[16:26:48] 📊 Patient Response
     └─ patientFName: Dole
     └─ patientLName: Leslie
     └─ dob: 03/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 6224015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'S12.690D', 'thirdDiagnosis': 'S06.5XAD', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I95.1', 'sixthDiagnosis': 'R13.12'}]
[16:26:48] ✅    ✅ Patient identified: Dole Leslie
[16:26:48] ✅    ✅ Patient name validation passed
[16:26:48] 🔄 
🔄 Step 3: Processing patient dates...
[16:26:48] [DOC: 9219055] ℹ️  DOB normalized: 03/17/1941
[16:26:48] [DOC: 9219055] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:26:48] [DOC: 9219055] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[16:26:48] [DOC: 9219055] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[16:26:48] [DOC: 9219055] ✅ Patient date processing completed successfully
[16:26:48] ✅    ✅ Date processing completed
[16:26:48] 📊 Processed Patient Data
     └─ patientFName: Dole
     └─ patientLName: Leslie
     └─ dob: 03/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 6224015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'S12.690D', 'thirdDiagnosis': 'S06.5XAD', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I95.1', 'sixthDiagnosis': 'R13.12'}]
[16:26:48] 🔄 
🔄 Step 4: Extracting order data...
[16:26:50] ℹ️  Order extraction - MRN: '6224015'
[16:26:50] ℹ️  Order extraction - Sex: 'MALE'
[16:26:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, ST'
[16:26:50] ℹ️  Order extraction - Payer Source: ''
[16:26:50] ✅ Order data extraction completed successfully
[16:26:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:26:50] ℹ️  Using MRN from patient data: '6224015' over '6224015'
[16:26:50] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Speech Therapy' + Order='Skilled Nursing, PT, ST' = 'PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy'
[16:26:50] ✅ Patient name cross-validation successful
[16:26:50] ✅    ✅ Data merged successfully
[16:26:51] ✅    ✅ Order data extracted and validated
[16:26:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:27:17] [DOC: 9219055] ℹ️  Patient not found in cache or API: Dole Leslie
[16:27:17] [DOC: 9219055] ℹ️  Patient not found, creating new patient via API...
[16:27:17] [DOC: 9219055] ℹ️  Creating patient via API: Dole Leslie
[16:27:19] [DOC: 9219055] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:27:19] ❌    ❌ Failed to create patient
[16:27:19] [DOC: 9219055] ℹ️  API push details saved for document 9219055
================================================================================
║                        Processing Document ID: 9219052                         ║
================================================================================
[16:27:19] ℹ️  Agency: Dartmouth HH
[16:27:19] ℹ️  Date: 04/03/2025
[16:27:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:27:21] [DOC: 9219052] ✅ Text extracted using pdfplumber (11996 chars)
[16:27:21] ✅    ✅ Text extracted using pdfplumber (11996 chars)
[16:27:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:27:24] ℹ️  AI extracted raw sex value: 'M'
[16:27:24] ℹ️  AI extracted service line: 'PT, OT, SN'
[16:27:24] ℹ️  AI extracted payer source: 'Medicare'
[16:27:24] ℹ️  AI extracted diagnoses:
[16:27:24] ℹ️    - Diagnosis 1: ''
[16:27:24] ℹ️    - Diagnosis 2: ''
[16:27:24] ℹ️    - Diagnosis 3: ''
[16:27:24] ℹ️    - Diagnosis 4: ''
[16:27:24] ℹ️    - Diagnosis 5: ''
[16:27:24] ℹ️    - Diagnosis 6: ''
[16:27:24] ℹ️  Final extracted MRN: '6142015'
[16:27:24] ℹ️  Final extracted Sex: 'MALE'
[16:27:24] ℹ️  Final extracted Service Line: 'PT, OT, SN'
[16:27:24] ℹ️  Final extracted Payer Source: 'Medicare'
[16:27:24] ✅ Patient data extraction completed successfully
[16:27:24] ✅    ✅ Patient data extracted successfully
[16:27:24] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, SN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:27:24] ✅    ✅ Patient identified: Raymond Sleight
[16:27:24] ✅    ✅ Patient name validation passed
[16:27:24] 🔄 
🔄 Step 3: Processing patient dates...
[16:27:24] [DOC: 9219052] ℹ️  DOB normalized: 07/10/1942
[16:27:24] [DOC: 9219052] ℹ️  Episode startOfCare normalized: 03/13/2025
[16:27:24] [DOC: 9219052] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:27:24] [DOC: 9219052] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:27:24] [DOC: 9219052] ✅ Patient date processing completed successfully
[16:27:24] ✅    ✅ Date processing completed
[16:27:24] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, SN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:27:24] 🔄 
🔄 Step 4: Extracting order data...
[16:27:27] ℹ️  Order extraction - MRN: '6142015'
[16:27:27] ℹ️  Order extraction - Sex: 'MALE'
[16:27:27] ℹ️  Order extraction - Service Line: 'PT, OT, SN'
[16:27:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:27:27] ✅ Order data extraction completed successfully
[16:27:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:27:27] ℹ️  Using MRN from patient data: '6142015' over '6142015'
[16:27:27] ℹ️  Service line consistent in both sources: 'PT, OT, SN'
[16:27:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:27:27] ✅ Patient name cross-validation successful
[16:27:27] ✅    ✅ Data merged successfully
[16:27:28] ✅    ✅ Order data extracted and validated
[16:27:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:27:28] [DOC: 9219052] ✅ Patient found in local cache: Raymond Sleight, ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[16:27:28] ✅    ✅ Existing patient found with ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[16:27:28] 🔄 
🔄 Step 6: Pushing order to API...
[16:27:28] [DOC: 9219052] ℹ️  Pushing order via API for patient ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[16:27:29] [DOC: 9219052] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:27:29] ❌    ❌ Failed to push order
[16:27:29] 🔄 
🔄 Step 7: Writing to CSV...
[16:27:29] [DOC: 9219052] ℹ️  Calculated age: 82 from DOB: 07/10/1942
[16:27:29] [DOC: 9219052] ℹ️  Service Line extracted: 'PT, OT, SN'
[16:27:29] [DOC: 9219052] ℹ️  Payer Source extracted: 'Medicare'
[16:27:29] [DOC: 9219052] ℹ️  Diagnosis codes being written:
[16:27:29] [DOC: 9219052] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:27:29] [DOC: 9219052] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:27:29] [DOC: 9219052] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:27:29] [DOC: 9219052] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:27:29] [DOC: 9219052] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:27:29] [DOC: 9219052] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:27:29] [DOC: 9219052] ✅ Patient data written to CSV: Raymond Sleight | Sex: MALE | Age: 82 | Service: PT, OT, SN | Payer: Medicare | MRN: 6142015
[16:27:29] ✅    ✅ Document 9219052 processed and saved successfully
[16:27:29] 🔄 
🔄 Step 8: Saving API details...
[16:27:29] [DOC: 9219052] ℹ️  API push details saved for document 9219052
[16:27:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219050                         ║
================================================================================
[16:27:29] ℹ️  Agency: Dartmouth HH
[16:27:29] ℹ️  Date: 04/03/2025
[16:27:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:27:32] [DOC: 9219050] ✅ Text extracted using pdfplumber (11964 chars)
[16:27:32] ✅    ✅ Text extracted using pdfplumber (11952 chars)
[16:27:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:27:35] ℹ️  AI extracted raw sex value: 'M'
[16:27:35] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[16:27:35] ℹ️  AI extracted payer source: ''
[16:27:35] ℹ️  AI extracted diagnoses:
[16:27:35] ℹ️    - Diagnosis 1: 'I25.810'
[16:27:35] ℹ️    - Diagnosis 2: 'Z95.1'
[16:27:35] ℹ️    - Diagnosis 3: 'I10'
[16:27:35] ℹ️    - Diagnosis 4: 'E78.5'
[16:27:35] ℹ️    - Diagnosis 5: 'I05.9'
[16:27:35] ℹ️    - Diagnosis 6: 'K21.9'
[16:27:35] ℹ️  Final extracted MRN: '6142015'
[16:27:35] ℹ️  Final extracted Sex: 'MALE'
[16:27:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[16:27:35] ℹ️  Final extracted Payer Source: ''
[16:27:35] ✅ Patient data extraction completed successfully
[16:27:35] ✅    ✅ Patient data extracted successfully
[16:27:35] 📊 Patient Response
     └─ patientFName: Sleight
     └─ patientLName: Raymond
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I25.810', 'secondDiagnosis': 'Z95.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'I05.9', 'sixthDiagnosis': 'K21.9'}]
[16:27:35] ✅    ✅ Patient identified: Sleight Raymond
[16:27:35] ✅    ✅ Patient name validation passed
[16:27:35] 🔄 
🔄 Step 3: Processing patient dates...
[16:27:35] [DOC: 9219050] ℹ️  DOB normalized: 07/10/1942
[16:27:35] [DOC: 9219050] ℹ️  Episode startOfCare normalized: 03/13/2025
[16:27:35] [DOC: 9219050] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:27:35] [DOC: 9219050] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:27:35] [DOC: 9219050] ✅ Patient date processing completed successfully
[16:27:35] ✅    ✅ Date processing completed
[16:27:35] 📊 Processed Patient Data
     └─ patientFName: Sleight
     └─ patientLName: Raymond
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I25.810', 'secondDiagnosis': 'Z95.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'I05.9', 'sixthDiagnosis': 'K21.9'}]
[16:27:35] 🔄 
🔄 Step 4: Extracting order data...
[16:27:38] ℹ️  Order extraction - MRN: '6142015'
[16:27:38] ℹ️  Order extraction - Sex: 'MALE'
[16:27:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:27:38] ℹ️  Order extraction - Payer Source: ''
[16:27:38] ✅ Order data extraction completed successfully
[16:27:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:27:38] ℹ️  Using MRN from patient data: '6142015' over '6142015'
[16:27:38] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[16:27:38] ✅ Patient name cross-validation successful
[16:27:38] ✅    ✅ Data merged successfully
[16:27:39] ✅    ✅ Order data extracted and validated
[16:27:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:27:50] [DOC: 9219050] ℹ️  Patient not found in cache or API: Sleight Raymond
[16:27:50] [DOC: 9219050] ℹ️  Patient not found, creating new patient via API...
[16:27:50] [DOC: 9219050] ℹ️  Creating patient via API: Sleight Raymond
[16:27:54] [DOC: 9219050] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:27:54] ❌    ❌ Failed to create patient
[16:27:54] [DOC: 9219050] ℹ️  API push details saved for document 9219050
================================================================================
║                        Processing Document ID: 9219037                         ║
================================================================================
[16:27:54] ℹ️  Agency: Dartmouth HH
[16:27:54] ℹ️  Date: 04/03/2025
[16:27:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:27:57] [DOC: 9219037] ✅ Text extracted using pdfplumber (16708 chars)
[16:27:57] ✅    ✅ Text extracted using pdfplumber (16696 chars)
[16:27:57] 🔄 
🔄 Step 2: Extracting patient data...
[16:28:00] ℹ️  AI extracted raw sex value: 'M'
[16:28:00] ℹ️  AI extracted service line: 'Skilled Nursing, Speech Therapy'
[16:28:00] ℹ️  AI extracted payer source: 'None'
[16:28:00] ℹ️  AI extracted diagnoses:
[16:28:00] ℹ️    - Diagnosis 1: 'K94.09'
[16:28:00] ℹ️    - Diagnosis 2: 'K59.39'
[16:28:00] ℹ️    - Diagnosis 3: 'I10'
[16:28:00] ℹ️    - Diagnosis 4: 'J44.89'
[16:28:00] ℹ️    - Diagnosis 5: 'R13.12'
[16:28:00] ℹ️    - Diagnosis 6: 'I70.91'
[16:28:00] ℹ️  Final extracted MRN: '1742011'
[16:28:00] ℹ️  Final extracted Sex: 'MALE'
[16:28:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Speech Therapy'
[16:28:00] ℹ️  Final extracted Payer Source: ''
[16:28:00] ✅ Patient data extraction completed successfully
[16:28:00] ✅    ✅ Patient data extracted successfully
[16:28:00] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Macdonald
     └─ dob: 09/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 1742011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K94.09', 'secondDiagnosis': 'K59.39', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J44.89', 'fifthDiagnosis': 'R13.12', 'sixthDiagnosis': 'I70.91'}]
[16:28:00] ✅    ✅ Patient identified: George Macdonald
[16:28:00] ✅    ✅ Patient name validation passed
[16:28:00] 🔄 
🔄 Step 3: Processing patient dates...
[16:28:00] [DOC: 9219037] ℹ️  DOB normalized: 09/17/1941
[16:28:00] [DOC: 9219037] ℹ️  Episode startOfCare normalized: 03/01/2025
[16:28:00] [DOC: 9219037] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:28:00] [DOC: 9219037] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:28:00] [DOC: 9219037] ✅ Patient date processing completed successfully
[16:28:00] ✅    ✅ Date processing completed
[16:28:00] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Macdonald
     └─ dob: 09/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 1742011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K94.09', 'secondDiagnosis': 'K59.39', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J44.89', 'fifthDiagnosis': 'R13.12', 'sixthDiagnosis': 'I70.91'}]
[16:28:00] 🔄 
🔄 Step 4: Extracting order data...
[16:28:03] ℹ️  Order extraction - MRN: '1742011'
[16:28:03] ℹ️  Order extraction - Sex: 'MALE'
[16:28:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Speech Therapy'
[16:28:03] ℹ️  Order extraction - Payer Source: ''
[16:28:03] ✅ Order data extraction completed successfully
[16:28:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:28:03] ℹ️  Using MRN from patient data: '1742011' over '1742011'
[16:28:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Speech Therapy'
[16:28:03] ✅ Patient name cross-validation successful
[16:28:03] ✅    ✅ Data merged successfully
[16:28:05] ✅    ✅ Order data extracted and validated
[16:28:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:28:14] [DOC: 9219037] ℹ️  Patient not found in cache or API: George Macdonald
[16:28:14] [DOC: 9219037] ℹ️  Patient not found, creating new patient via API...
[16:28:14] [DOC: 9219037] ℹ️  Creating patient via API: George Macdonald
[16:28:15] [DOC: 9219037] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:28:15] ❌    ❌ Failed to create patient
[16:28:15] [DOC: 9219037] ℹ️  API push details saved for document 9219037
================================================================================
║                        Processing Document ID: 2167620                         ║
================================================================================
[16:28:15] ℹ️  Agency: Visiting Rehab & Nursing Services
[16:28:15] ℹ️  Date: 04/02/2025
[16:28:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:28:16] [DOC: 2167620] ❌ Critical failure in get_pdf_text: Invalid response format
[16:28:16] ❌ Failed to extract text for Doc ID 2167620
[16:28:16] [DOC: 2167620] ℹ️  API push details saved for document 2167620
================================================================================
║                        Processing Document ID: 2167618                         ║
================================================================================
[16:28:16] ℹ️  Agency: Visiting Rehab & Nursing Services
[16:28:16] ℹ️  Date: 04/02/2025
[16:28:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:28:18] [DOC: 2167618] ❌ Critical failure in get_pdf_text: Invalid response format
[16:28:18] ❌ Failed to extract text for Doc ID 2167618
[16:28:18] [DOC: 2167618] ℹ️  API push details saved for document 2167618
================================================================================
║                        Processing Document ID: 2167606                         ║
================================================================================
[16:28:18] ℹ️  Agency: Visiting Rehab & Nursing Services
[16:28:18] ℹ️  Date: 04/02/2025
[16:28:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:28:19] [DOC: 2167606] ❌ Critical failure in get_pdf_text: Invalid response format
[16:28:19] ❌ Failed to extract text for Doc ID 2167606
[16:28:19] [DOC: 2167606] ℹ️  API push details saved for document 2167606
================================================================================
║                        Processing Document ID: 9216933                         ║
================================================================================
[16:28:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:28:19] ℹ️  Date: 04/02/2025
[16:28:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:28:21] [DOC: 9216933] ✅ Text extracted using pdfplumber (1247 chars)
[16:28:21] ✅    ✅ Text extracted using pdfplumber (1247 chars)
[16:28:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:28:24] ℹ️  AI extracted raw sex value: ''
[16:28:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:28:24] ℹ️  AI extracted payer source: ''
[16:28:24] ℹ️  AI extracted diagnoses:
[16:28:24] ℹ️    - Diagnosis 1: 'C67.9'
[16:28:24] ℹ️    - Diagnosis 2: 'Z48.3'
[16:28:24] ℹ️    - Diagnosis 3: 'Z46.6'
[16:28:24] ℹ️    - Diagnosis 4: 'None'
[16:28:24] ℹ️    - Diagnosis 5: 'None'
[16:28:24] ℹ️    - Diagnosis 6: 'None'
[16:28:24] ℹ️  Final extracted MRN: 'MA250206063603'
[16:28:24] ℹ️  Final extracted Sex: ''
[16:28:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:28:24] ℹ️  Final extracted Payer Source: ''
[16:28:24] ✅ Patient data extraction completed successfully
[16:28:24] ✅    ✅ Patient data extracted successfully
[16:28:24] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'Z48.3', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:28:24] ✅    ✅ Patient identified: Maria Lopes
[16:28:24] ✅    ✅ Patient name validation passed
[16:28:24] 🔄 
🔄 Step 3: Processing patient dates...
[16:28:24] [DOC: 9216933] ℹ️  DOB normalized: 06/25/1936
[16:28:24] [DOC: 9216933] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[16:28:24] [DOC: 9216933] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[16:28:24] [DOC: 9216933] ✅ Patient date processing completed successfully
[16:28:24] ✅    ✅ Date processing completed
[16:28:24] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'Z48.3', 'thirdDiagnosis': 'Z46.6'}]
[16:28:24] 🔄 
🔄 Step 4: Extracting order data...
[16:28:27] ℹ️  Order extraction - MRN: 'MA250206063603'
[16:28:27] ℹ️  Order extraction - Sex: ''
[16:28:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:28:27] ℹ️  Order extraction - Payer Source: ''
[16:28:27] ✅ Order data extraction completed successfully
[16:28:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:28:27] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[16:28:27] ℹ️  Inferred sex as FEMALE from name: Maria
[16:28:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:28:27] ✅ Patient name cross-validation successful
[16:28:27] ✅    ✅ Data merged successfully
[16:28:28] ✅    ✅ Order data extracted and validated
[16:28:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:28:53] [DOC: 9216933] ℹ️  Patient not found in cache or API: Maria Lopes
[16:28:53] [DOC: 9216933] ℹ️  Patient not found, creating new patient via API...
[16:28:53] [DOC: 9216933] ℹ️  Creating patient via API: Maria Lopes
[16:28:55] [DOC: 9216933] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:28:55] ❌    ❌ Failed to create patient
[16:28:55] [DOC: 9216933] ℹ️  API push details saved for document 9216933
================================================================================
║                        Processing Document ID: 9218901                         ║
================================================================================
[16:28:55] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[16:28:55] ℹ️  Date: 04/02/2025
[16:28:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:28:57] [DOC: 9218901] ✅ Text extracted using pdfplumber (2244 chars)
[16:28:57] ✅    ✅ Text extracted using pdfplumber (2232 chars)
[16:28:57] 🔄 
🔄 Step 2: Extracting patient data...
[16:29:00] ℹ️  AI extracted raw sex value: ''
[16:29:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:29:00] ℹ️  AI extracted payer source: 'Medicare'
[16:29:00] ℹ️  AI extracted diagnoses:
[16:29:00] ℹ️    - Diagnosis 1: ''
[16:29:00] ℹ️    - Diagnosis 2: ''
[16:29:00] ℹ️    - Diagnosis 3: ''
[16:29:00] ℹ️    - Diagnosis 4: ''
[16:29:00] ℹ️    - Diagnosis 5: ''
[16:29:00] ℹ️    - Diagnosis 6: ''
[16:29:00] ℹ️  Final extracted MRN: '28700207125401'
[16:29:00] ℹ️  Final extracted Sex: ''
[16:29:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:29:00] ℹ️  Final extracted Payer Source: 'Medicare'
[16:29:00] ✅ Patient data extraction completed successfully
[16:29:00] ✅    ✅ Patient data extracted successfully
[16:29:00] 📊 Patient Response
     └─ patientFName: KAREN
     └─ patientLName: CORDERO
     └─ dob: 06/05/1956
     └─ patientSex: 
     └─ medicalRecordNo: 28700207125401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '02/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:29:00] ✅    ✅ Patient identified: KAREN CORDERO
[16:29:00] ✅    ✅ Patient name validation passed
[16:29:00] 🔄 
🔄 Step 3: Processing patient dates...
[16:29:00] [DOC: 9218901] ℹ️  DOB normalized: 06/05/1956
[16:29:00] [DOC: 9218901] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[16:29:00] [DOC: 9218901] ℹ️  Episode endOfEpisode normalized: 02/23/2025
[16:29:00] [DOC: 9218901] ✅ Patient date processing completed successfully
[16:29:00] ✅    ✅ Date processing completed
[16:29:00] 📊 Processed Patient Data
     └─ patientFName: KAREN
     └─ patientLName: CORDERO
     └─ dob: 06/05/1956
     └─ patientSex: 
     └─ medicalRecordNo: 28700207125401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '02/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:29:00] 🔄 
🔄 Step 4: Extracting order data...
[16:29:02] ℹ️  Order extraction - MRN: '28700207125401'
[16:29:02] ℹ️  Order extraction - Sex: ''
[16:29:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:29:02] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:29:02] ✅ Order data extraction completed successfully
[16:29:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:29:02] ℹ️  Using MRN from patient data: '28700207125401' over '28700207125401'
[16:29:02] ℹ️  Inferred sex as FEMALE from name: KAREN
[16:29:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:29:02] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:29:02] ✅ Patient name cross-validation successful
[16:29:02] ✅    ✅ Data merged successfully
[16:29:03] ✅    ✅ Order data extracted and validated
[16:29:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:29:20] [DOC: 9218901] ℹ️  Patient not found in cache or API: KAREN CORDERO
[16:29:20] [DOC: 9218901] ℹ️  Patient not found, creating new patient via API...
[16:29:20] [DOC: 9218901] ℹ️  Creating patient via API: KAREN CORDERO
[16:29:22] [DOC: 9218901] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:29:22] ❌    ❌ Failed to create patient
[16:29:22] [DOC: 9218901] ℹ️  API push details saved for document 9218901
================================================================================
║                        Processing Document ID: 9218653                         ║
================================================================================
[16:29:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:29:22] ℹ️  Date: 04/02/2025
[16:29:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:29:26] [DOC: 9218653] ✅ Text extracted using pdfplumber (1289 chars)
[16:29:26] ✅    ✅ Text extracted using pdfplumber (1289 chars)
[16:29:26] 🔄 
🔄 Step 2: Extracting patient data...
[16:29:29] ℹ️  AI extracted raw sex value: ''
[16:29:29] ℹ️  AI extracted service line: 'Physical Therapy'
[16:29:29] ℹ️  AI extracted payer source: ''
[16:29:29] ℹ️  AI extracted diagnoses:
[16:29:29] ℹ️    - Diagnosis 1: 'I13.0'
[16:29:29] ℹ️    - Diagnosis 2: 'I50.23'
[16:29:29] ℹ️    - Diagnosis 3: 'I50.30'
[16:29:29] ℹ️    - Diagnosis 4: 'None'
[16:29:29] ℹ️    - Diagnosis 5: 'None'
[16:29:29] ℹ️    - Diagnosis 6: 'None'
[16:29:29] ℹ️  Final extracted MRN: 'MA240125124906'
[16:29:29] ℹ️  Final extracted Sex: ''
[16:29:29] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:29:29] ℹ️  Final extracted Payer Source: ''
[16:29:29] ✅ Patient data extraction completed successfully
[16:29:29] ✅    ✅ Patient data extracted successfully
[16:29:29] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: Woodbury
     └─ dob: 12/12/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA240125124906
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'I50.30', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:29:29] ✅    ✅ Patient identified: Brenda Woodbury
[16:29:29] ✅    ✅ Patient name validation passed
[16:29:29] 🔄 
🔄 Step 3: Processing patient dates...
[16:29:29] [DOC: 9218653] ℹ️  DOB normalized: 12/12/1949
[16:29:29] [DOC: 9218653] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[16:29:29] [DOC: 9218653] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[16:29:29] [DOC: 9218653] ✅ Patient date processing completed successfully
[16:29:29] ✅    ✅ Date processing completed
[16:29:29] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: Woodbury
     └─ dob: 12/12/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA240125124906
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'I50.30'}]
[16:29:29] 🔄 
🔄 Step 4: Extracting order data...
[16:29:31] ℹ️  Order extraction - MRN: 'MA240125124906'
[16:29:31] ℹ️  Order extraction - Sex: ''
[16:29:31] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:29:31] ℹ️  Order extraction - Payer Source: ''
[16:29:31] ✅ Order data extraction completed successfully
[16:29:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:29:31] ℹ️  Using MRN from patient data: 'MA240125124906' over 'MA240125124906'
[16:29:31] ℹ️  Inferred sex as FEMALE from name: Brenda
[16:29:31] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:29:31] ✅ Patient name cross-validation successful
[16:29:31] ✅    ✅ Data merged successfully
[16:29:33] ✅    ✅ Order data extracted and validated
[16:29:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:29:55] [DOC: 9218653] ✅ Patient exists in API: Brenda Woodbury, ID: 89928b45-2794-4a96-a5f3-8c006684d0b9
[16:29:55] ✅    ✅ Existing patient found with ID: 89928b45-2794-4a96-a5f3-8c006684d0b9
[16:29:55] 🔄 
🔄 Step 6: Pushing order to API...
[16:29:55] [DOC: 9218653] ℹ️  Pushing order via API for patient ID: 89928b45-2794-4a96-a5f3-8c006684d0b9
[16:29:56] [DOC: 9218653] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14262"}
[16:29:56] ❌    ❌ Failed to push order
[16:29:56] 🔄 
🔄 Step 7: Writing to CSV...
[16:29:56] [DOC: 9218653] ℹ️  Calculated age: 75 from DOB: 12/12/1949
[16:29:56] [DOC: 9218653] ℹ️  Service Line extracted: 'Physical Therapy'
[16:29:56] [DOC: 9218653] ℹ️  Payer Source extracted: ''
[16:29:56] [DOC: 9218653] ℹ️  Diagnosis codes being written:
[16:29:56] [DOC: 9218653] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[16:29:56] [DOC: 9218653] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.23'
[16:29:56] [DOC: 9218653] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.30'
[16:29:56] [DOC: 9218653] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:29:56] [DOC: 9218653] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:29:56] [DOC: 9218653] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:29:56] [DOC: 9218653] ✅ Patient data written to CSV: Brenda Woodbury | Sex: FEMALE | Age: 75 | Service: Physical Therapy | Payer:  | MRN: MA240125124906
[16:29:56] ✅    ✅ Document 9218653 processed and saved successfully
[16:29:56] 🔄 
🔄 Step 8: Saving API details...
[16:29:56] [DOC: 9218653] ℹ️  API push details saved for document 9218653
[16:29:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218638                         ║
================================================================================
[16:29:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:29:56] ℹ️  Date: 04/02/2025
[16:29:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:30:01] [DOC: 9218638] ✅ Text extracted using pdfplumber (1589 chars)
[16:30:01] ✅    ✅ Text extracted using pdfplumber (1589 chars)
[16:30:01] 🔄 
🔄 Step 2: Extracting patient data...
[16:30:04] ℹ️  AI extracted raw sex value: ''
[16:30:04] ℹ️  AI extracted service line: 'Physical Therapy'
[16:30:04] ℹ️  AI extracted payer source: ''
[16:30:04] ℹ️  AI extracted diagnoses:
[16:30:04] ℹ️    - Diagnosis 1: 'I11.0'
[16:30:04] ℹ️    - Diagnosis 2: 'I50.9'
[16:30:04] ℹ️    - Diagnosis 3: 'E11.22'
[16:30:04] ℹ️    - Diagnosis 4: ''
[16:30:04] ℹ️    - Diagnosis 5: ''
[16:30:04] ℹ️    - Diagnosis 6: ''
[16:30:04] ℹ️  Final extracted MRN: 'MA241014032901'
[16:30:04] ℹ️  Final extracted Sex: ''
[16:30:04] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:30:04] ℹ️  Final extracted Payer Source: ''
[16:30:04] ✅ Patient data extraction completed successfully
[16:30:04] ✅    ✅ Patient data extracted successfully
[16:30:04] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/15/2024', 'endOfEpisode': '02/12/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:30:04] ✅    ✅ Patient identified: Manuel Sousa
[16:30:04] ✅    ✅ Patient name validation passed
[16:30:04] 🔄 
🔄 Step 3: Processing patient dates...
[16:30:04] [DOC: 9218638] ℹ️  DOB normalized: 03/10/1929
[16:30:04] [DOC: 9218638] ℹ️  Episode startOfEpisode normalized: 12/15/2024
[16:30:04] [DOC: 9218638] ℹ️  Episode endOfEpisode normalized: 02/12/2025
[16:30:04] [DOC: 9218638] ✅ Patient date processing completed successfully
[16:30:04] ✅    ✅ Date processing completed
[16:30:04] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/15/2024', 'endOfEpisode': '02/12/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:30:04] 🔄 
🔄 Step 4: Extracting order data...
[16:30:07] ℹ️  Order extraction - MRN: 'MA241014032901'
[16:30:07] ℹ️  Order extraction - Sex: ''
[16:30:07] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:30:07] ℹ️  Order extraction - Payer Source: ''
[16:30:07] ✅ Order data extraction completed successfully
[16:30:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:30:07] ℹ️  Using MRN from patient data: 'MA241014032901' over 'MA241014032901'
[16:30:07] ⚠️  Could not determine sex using any available method
[16:30:07] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:30:07] ✅ Patient name cross-validation successful
[16:30:07] ✅    ✅ Data merged successfully
[16:30:08] ✅    ✅ Order data extracted and validated
[16:30:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:30:31] [DOC: 9218638] ℹ️  Patient not found in cache or API: Manuel Sousa
[16:30:31] [DOC: 9218638] ℹ️  Patient not found, creating new patient via API...
[16:30:31] [DOC: 9218638] ℹ️  Creating patient via API: Manuel Sousa
[16:30:32] [DOC: 9218638] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:30:32] ❌    ❌ Failed to create patient
[16:30:32] [DOC: 9218638] ℹ️  API push details saved for document 9218638
================================================================================
║                        Processing Document ID: 9218636                         ║
================================================================================
[16:30:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:30:32] ℹ️  Date: 04/02/2025
[16:30:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:30:35] [DOC: 9218636] ✅ Text extracted using pdfplumber (1375 chars)
[16:30:35] ✅    ✅ Text extracted using pdfplumber (1375 chars)
[16:30:35] 🔄 
🔄 Step 2: Extracting patient data...
[16:30:38] ℹ️  AI extracted raw sex value: ''
[16:30:38] ℹ️  AI extracted service line: 'Physical Therapy'
[16:30:38] ℹ️  AI extracted payer source: ''
[16:30:38] ℹ️  AI extracted diagnoses:
[16:30:38] ℹ️    - Diagnosis 1: 'I11.0'
[16:30:38] ℹ️    - Diagnosis 2: 'I50.9'
[16:30:38] ℹ️    - Diagnosis 3: 'E11.22'
[16:30:38] ℹ️    - Diagnosis 4: ''
[16:30:38] ℹ️    - Diagnosis 5: ''
[16:30:38] ℹ️    - Diagnosis 6: ''
[16:30:38] ℹ️  Final extracted MRN: 'MA241014032901'
[16:30:38] ℹ️  Final extracted Sex: ''
[16:30:38] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:30:38] ℹ️  Final extracted Payer Source: ''
[16:30:38] ✅ Patient data extraction completed successfully
[16:30:38] ✅    ✅ Patient data extracted successfully
[16:30:38] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/15/2024', 'endOfEpisode': '12/24/2024', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:30:38] ✅    ✅ Patient identified: Manuel Sousa
[16:30:38] ✅    ✅ Patient name validation passed
[16:30:38] 🔄 
🔄 Step 3: Processing patient dates...
[16:30:38] [DOC: 9218636] ℹ️  DOB normalized: 03/10/1929
[16:30:38] [DOC: 9218636] ℹ️  Episode startOfEpisode normalized: 12/15/2024
[16:30:38] [DOC: 9218636] ℹ️  Episode endOfEpisode normalized: 12/24/2024
[16:30:38] [DOC: 9218636] ✅ Patient date processing completed successfully
[16:30:38] ✅    ✅ Date processing completed
[16:30:38] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/15/2024', 'endOfEpisode': '12/24/2024', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:30:38] 🔄 
🔄 Step 4: Extracting order data...
[16:30:41] ℹ️  Order extraction - MRN: 'MA241014032901'
[16:30:41] ℹ️  Order extraction - Sex: ''
[16:30:41] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:30:41] ℹ️  Order extraction - Payer Source: ''
[16:30:41] ✅ Order data extraction completed successfully
[16:30:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:30:41] ℹ️  Using MRN from patient data: 'MA241014032901' over 'MA241014032901'
[16:30:41] ⚠️  Could not determine sex using any available method
[16:30:41] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:30:41] ✅ Patient name cross-validation successful
[16:30:41] ✅    ✅ Data merged successfully
[16:30:42] ✅    ✅ Order data extracted and validated
[16:30:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:31:16] [DOC: 9218636] ℹ️  Patient not found in cache or API: Manuel Sousa
[16:31:16] [DOC: 9218636] ℹ️  Patient not found, creating new patient via API...
[16:31:16] [DOC: 9218636] ℹ️  Creating patient via API: Manuel Sousa
[16:31:17] [DOC: 9218636] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:31:17] ❌    ❌ Failed to create patient
[16:31:17] [DOC: 9218636] ℹ️  API push details saved for document 9218636
================================================================================
║                        Processing Document ID: 9218635                         ║
================================================================================
[16:31:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:31:17] ℹ️  Date: 04/02/2025
[16:31:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:31:21] [DOC: 9218635] ✅ Text extracted using pdfplumber (11944 chars)
[16:31:21] ✅    ✅ Text extracted using pdfplumber (11944 chars)
[16:31:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:31:25] ℹ️  AI extracted raw sex value: 'M'
[16:31:25] ℹ️  AI extracted service line: 'Physical Therapy'
[16:31:25] ℹ️  AI extracted payer source: 'Medicare'
[16:31:25] ℹ️  AI extracted diagnoses:
[16:31:25] ℹ️    - Diagnosis 1: 'I11.0'
[16:31:25] ℹ️    - Diagnosis 2: 'I50.9'
[16:31:25] ℹ️    - Diagnosis 3: 'E11.22'
[16:31:25] ℹ️    - Diagnosis 4: 'N18.32'
[16:31:25] ℹ️    - Diagnosis 5: 'None'
[16:31:25] ℹ️    - Diagnosis 6: 'None'
[16:31:25] ℹ️  Final extracted MRN: 'MA241014032901'
[16:31:25] ℹ️  Final extracted Sex: 'MALE'
[16:31:25] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:31:25] ℹ️  Final extracted Payer Source: 'Medicare'
[16:31:25] ✅ Patient data extraction completed successfully
[16:31:25] ✅    ✅ Patient data extracted successfully
[16:31:25] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 1881923936
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 110 Lucy Little Rd
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 971-5613
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/16/2024', 'startOfEpisode': '12/15/2024', 'endOfEpisode': '02/12/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:31:25] ✅    ✅ Patient identified: Manuel Sousa
[16:31:25] ✅    ✅ Patient name validation passed
[16:31:25] 🔄 
🔄 Step 3: Processing patient dates...
[16:31:25] [DOC: 9218635] ℹ️  DOB normalized: 03/10/1929
[16:31:25] [DOC: 9218635] ℹ️  Episode startOfCare normalized: 10/16/2024
[16:31:25] [DOC: 9218635] ℹ️  Episode startOfEpisode normalized: 12/15/2024
[16:31:25] [DOC: 9218635] ℹ️  Episode endOfEpisode normalized: 02/12/2025
[16:31:25] [DOC: 9218635] ✅ Patient date processing completed successfully
[16:31:25] ✅    ✅ Date processing completed
[16:31:25] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 1881923936
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 110 Lucy Little Rd
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 971-5613
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/16/2024', 'startOfEpisode': '12/15/2024', 'endOfEpisode': '02/12/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32'}]
[16:31:25] 🔄 
🔄 Step 4: Extracting order data...
[16:31:28] ℹ️  Order extraction - MRN: 'MA241014032901'
[16:31:28] ℹ️  Order extraction - Sex: 'MALE'
[16:31:28] ℹ️  Order extraction - Service Line: 'PT'
[16:31:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:31:28] ✅ Order data extraction completed successfully
[16:31:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:31:28] ℹ️  Using MRN from patient data: 'MA241014032901' over 'MA241014032901'
[16:31:28] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[16:31:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:31:28] ✅ Patient name cross-validation successful
[16:31:28] ✅    ✅ Data merged successfully
[16:31:30] ✅    ✅ Order data extracted and validated
[16:31:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:31:53] [DOC: 9218635] ℹ️  Patient not found in cache or API: Manuel Sousa
[16:31:53] [DOC: 9218635] ℹ️  Patient not found, creating new patient via API...
[16:31:53] [DOC: 9218635] ℹ️  Creating patient via API: Manuel Sousa
[16:31:54] [DOC: 9218635] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:31:54] ❌    ❌ Failed to create patient
[16:31:54] [DOC: 9218635] ℹ️  API push details saved for document 9218635
================================================================================
║                        Processing Document ID: 9218632                         ║
================================================================================
[16:31:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:31:54] ℹ️  Date: 04/02/2025
[16:31:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:31:59] [DOC: 9218632] ✅ Text extracted using pdfplumber (1385 chars)
[16:31:59] ✅    ✅ Text extracted using pdfplumber (1385 chars)
[16:31:59] 🔄 
🔄 Step 2: Extracting patient data...
[16:32:02] ℹ️  AI extracted raw sex value: ''
[16:32:02] ℹ️  AI extracted service line: 'Physical Therapy'
[16:32:02] ℹ️  AI extracted payer source: ''
[16:32:02] ℹ️  AI extracted diagnoses:
[16:32:02] ℹ️    - Diagnosis 1: 'I11.0'
[16:32:02] ℹ️    - Diagnosis 2: 'I50.9'
[16:32:02] ℹ️    - Diagnosis 3: 'E11.22'
[16:32:02] ℹ️    - Diagnosis 4: ''
[16:32:02] ℹ️    - Diagnosis 5: ''
[16:32:02] ℹ️    - Diagnosis 6: ''
[16:32:02] ℹ️  Final extracted MRN: 'MA241014032901'
[16:32:02] ℹ️  Final extracted Sex: ''
[16:32:02] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:32:02] ℹ️  Final extracted Payer Source: ''
[16:32:02] ✅ Patient data extraction completed successfully
[16:32:02] ✅    ✅ Patient data extracted successfully
[16:32:02] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '10/16/2024', 'endOfEpisode': '12/14/2024', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:32:02] ✅    ✅ Patient identified: Manuel Sousa
[16:32:02] ✅    ✅ Patient name validation passed
[16:32:02] 🔄 
🔄 Step 3: Processing patient dates...
[16:32:02] [DOC: 9218632] ℹ️  DOB normalized: 03/10/1929
[16:32:02] [DOC: 9218632] ℹ️  Episode startOfEpisode normalized: 10/16/2024
[16:32:02] [DOC: 9218632] ℹ️  Episode endOfEpisode normalized: 12/14/2024
[16:32:02] [DOC: 9218632] ✅ Patient date processing completed successfully
[16:32:02] ✅    ✅ Date processing completed
[16:32:02] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Sousa
     └─ dob: 03/10/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA241014032901
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '10/16/2024', 'endOfEpisode': '12/14/2024', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:32:02] 🔄 
🔄 Step 4: Extracting order data...
[16:32:05] ℹ️  Order extraction - MRN: 'MA241014032901'
[16:32:05] ℹ️  Order extraction - Sex: ''
[16:32:05] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:32:05] ℹ️  Order extraction - Payer Source: ''
[16:32:05] ✅ Order data extraction completed successfully
[16:32:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:32:05] ℹ️  Using MRN from patient data: 'MA241014032901' over 'MA241014032901'
[16:32:05] ⚠️  Could not determine sex using any available method
[16:32:05] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:32:05] ✅ Patient name cross-validation successful
[16:32:05] ✅    ✅ Data merged successfully
[16:32:06] ✅    ✅ Order data extracted and validated
[16:32:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:32:12] [DOC: 9218632] ℹ️  Patient not found in cache or API: Manuel Sousa
[16:32:12] [DOC: 9218632] ℹ️  Patient not found, creating new patient via API...
[16:32:12] [DOC: 9218632] ℹ️  Creating patient via API: Manuel Sousa
[16:32:13] [DOC: 9218632] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:32:13] ❌    ❌ Failed to create patient
[16:32:13] [DOC: 9218632] ℹ️  API push details saved for document 9218632
================================================================================
║                        Processing Document ID: 9218622                         ║
================================================================================
[16:32:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:32:13] ℹ️  Date: 04/02/2025
[16:32:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:32:17] [DOC: 9218622] ✅ Text extracted using pdfplumber (15396 chars)
[16:32:17] ✅    ✅ Text extracted using pdfplumber (15396 chars)
[16:32:17] 🔄 
🔄 Step 2: Extracting patient data...
[16:32:20] ℹ️  AI extracted raw sex value: 'M'
[16:32:20] ℹ️  AI extracted service line: 'OT'
[16:32:20] ℹ️  AI extracted payer source: ''
[16:32:20] ℹ️  AI extracted diagnoses:
[16:32:20] ℹ️    - Diagnosis 1: 'acute metabolic encephalopathy'
[16:32:20] ℹ️    - Diagnosis 2: 'Weakness'
[16:32:20] ℹ️    - Diagnosis 3: 'morbid obesity'
[16:32:20] ℹ️    - Diagnosis 4: 'hernia'
[16:32:20] ℹ️    - Diagnosis 5: 'pneumonia'
[16:32:20] ℹ️    - Diagnosis 6: 'acute respiratory failure'
[16:32:20] ℹ️  Final extracted MRN: 'MA240910054401'
[16:32:20] ℹ️  Final extracted Sex: 'MALE'
[16:32:20] ℹ️  Final extracted Service Line: 'OT'
[16:32:20] ℹ️  Final extracted Payer Source: ''
[16:32:20] ✅ Patient data extraction completed successfully
[16:32:20] ✅    ✅ Patient data extracted successfully
[16:32:20] 📊 Patient Response
     └─ patientFName: Val
     └─ patientLName: Cardoso Brito
     └─ dob: 05/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240910054401
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/04/2024', 'endOfEpisode': None, 'firstDiagnosis': 'acute metabolic encephalopathy', 'secondDiagnosis': 'Weakness', 'thirdDiagnosis': 'morbid obesity', 'fourthDiagnosis': 'hernia', 'fifthDiagnosis': 'pneumonia', 'sixthDiagnosis': 'acute respiratory failure'}]
[16:32:20] ✅    ✅ Patient identified: Val Cardoso Brito
[16:32:20] ✅    ✅ Patient name validation passed
[16:32:20] 🔄 
🔄 Step 3: Processing patient dates...
[16:32:20] [DOC: 9218622] ℹ️  DOB normalized: 05/30/1944
[16:32:20] [DOC: 9218622] ℹ️  Episode startOfEpisode normalized: 11/04/2024
[16:32:20] [DOC: 9218622] ✅ Patient date processing completed successfully
[16:32:20] ✅    ✅ Date processing completed
[16:32:20] 📊 Processed Patient Data
     └─ patientFName: Val
     └─ patientLName: Cardoso Brito
     └─ dob: 05/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240910054401
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/04/2024', 'firstDiagnosis': 'acute metabolic encephalopathy', 'secondDiagnosis': 'Weakness', 'thirdDiagnosis': 'morbid obesity', 'fourthDiagnosis': 'hernia', 'fifthDiagnosis': 'pneumonia', 'sixthDiagnosis': 'acute respiratory failure'}]
[16:32:20] 🔄 
🔄 Step 4: Extracting order data...
[16:32:23] ℹ️  Order extraction - MRN: 'MA240910054401'
[16:32:23] ℹ️  Order extraction - Sex: 'MALE'
[16:32:23] ℹ️  Order extraction - Service Line: 'OT'
[16:32:23] ℹ️  Order extraction - Payer Source: ''
[16:32:23] ✅ Order data extraction completed successfully
[16:32:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:32:23] ℹ️  Using MRN from patient data: 'MA240910054401' over 'MA240910054401'
[16:32:23] ℹ️  Service line consistent in both sources: 'OT'
[16:32:23] ✅ Patient name cross-validation successful
[16:32:23] ✅    ✅ Data merged successfully
[16:32:24] ⚠️     ❌ Skipping - missing episode start date
[16:32:24] [DOC: 9218622] ℹ️  API push details saved for document 9218622
================================================================================
║                        Processing Document ID: 9218598                         ║
================================================================================
[16:32:24] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:32:24] ℹ️  Date: 04/02/2025
[16:32:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:32:27] [DOC: 9218598] ✅ Text extracted using pdfplumber (7627 chars)
[16:32:27] ✅    ✅ Text extracted using pdfplumber (7627 chars)
[16:32:27] 🔄 
🔄 Step 2: Extracting patient data...
[16:32:30] ℹ️  AI extracted raw sex value: 'F'
[16:32:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:32:30] ℹ️  AI extracted payer source: 'None'
[16:32:30] ℹ️  AI extracted diagnoses:
[16:32:30] ℹ️    - Diagnosis 1: 'F31.9'
[16:32:30] ℹ️    - Diagnosis 2: 'F41.9'
[16:32:30] ℹ️    - Diagnosis 3: 'F43.10'
[16:32:30] ℹ️    - Diagnosis 4: 'F90.1'
[16:32:30] ℹ️    - Diagnosis 5: 'G40.909'
[16:32:30] ℹ️    - Diagnosis 6: 'M54.50'
[16:32:30] ℹ️  Final extracted MRN: '1005'
[16:32:30] ℹ️  Final extracted Sex: 'FEMALE'
[16:32:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:32:30] ℹ️  Final extracted Payer Source: ''
[16:32:30] ✅ Patient data extraction completed successfully
[16:32:30] ✅    ✅ Patient data extracted successfully
[16:32:30] 📊 Patient Response
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 1114903663
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '08/17/2022', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'F90.1', 'fifthDiagnosis': 'G40.909', 'sixthDiagnosis': 'M54.50'}]
[16:32:30] ✅    ✅ Patient identified: Christina Bosworth
[16:32:30] ✅    ✅ Patient name validation passed
[16:32:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:32:30] [DOC: 9218598] ℹ️  DOB normalized: 07/02/1990
[16:32:30] [DOC: 9218598] ℹ️  Episode startOfCare normalized: 08/17/2022
[16:32:30] [DOC: 9218598] ℹ️  Episode startOfEpisode normalized: 08/17/2022
[16:32:30] [DOC: 9218598] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[16:32:30] [DOC: 9218598] ✅ Patient date processing completed successfully
[16:32:30] ✅    ✅ Date processing completed
[16:32:30] 📊 Processed Patient Data
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 1114903663
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '08/17/2022', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'F90.1', 'fifthDiagnosis': 'G40.909', 'sixthDiagnosis': 'M54.50'}]
[16:32:30] 🔄 
🔄 Step 4: Extracting order data...
[16:32:32] ℹ️  Order extraction - MRN: '1005'
[16:32:32] ℹ️  Order extraction - Sex: 'FEMALE'
[16:32:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:32:32] ℹ️  Order extraction - Payer Source: ''
[16:32:32] ✅ Order data extraction completed successfully
[16:32:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:32:32] ℹ️  Using MRN from patient data: '1005' over '1005'
[16:32:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:32:32] ✅ Patient name cross-validation successful
[16:32:32] ✅    ✅ Data merged successfully
[16:32:33] ✅    ✅ Order data extracted and validated
[16:32:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:32:33] [DOC: 9218598] ✅ Patient found in local cache: Christina Bosworth, ID: 189e87b4-7506-4371-aa11-46e767bb1879
[16:32:33] ✅    ✅ Existing patient found with ID: 189e87b4-7506-4371-aa11-46e767bb1879
[16:32:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:32:33] [DOC: 9218598] ℹ️  Pushing order via API for patient ID: 189e87b4-7506-4371-aa11-46e767bb1879
[16:32:34] [DOC: 9218598] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:32:34] ❌    ❌ Failed to push order
[16:32:34] 🔄 
🔄 Step 7: Writing to CSV...
[16:32:34] [DOC: 9218598] ℹ️  Calculated age: 34 from DOB: 07/02/1990
[16:32:34] [DOC: 9218598] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:32:34] [DOC: 9218598] ℹ️  Payer Source extracted: ''
[16:32:34] [DOC: 9218598] ℹ️  Diagnosis codes being written:
[16:32:34] [DOC: 9218598] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.9'
[16:32:34] [DOC: 9218598] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[16:32:34] [DOC: 9218598] ℹ️    - Latest_Episode_Thirddiagnosis: 'F43.10'
[16:32:34] [DOC: 9218598] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F90.1'
[16:32:34] [DOC: 9218598] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G40.909'
[16:32:34] [DOC: 9218598] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.50'
[16:32:34] [DOC: 9218598] ✅ Patient data written to CSV: Christina Bosworth | Sex: FEMALE | Age: 34 | Service: Skilled Nursing | Payer:  | MRN: 1005
[16:32:34] ✅    ✅ Document 9218598 processed and saved successfully
[16:32:34] 🔄 
🔄 Step 8: Saving API details...
[16:32:34] [DOC: 9218598] ℹ️  API push details saved for document 9218598
[16:32:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218121                         ║
================================================================================
[16:32:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:32:34] ℹ️  Date: 04/02/2025
[16:32:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:32:37] [DOC: 9218121] ✅ Text extracted using pdfplumber (1029 chars)
[16:32:37] ✅    ✅ Text extracted using pdfplumber (1029 chars)
[16:32:37] 🔄 
🔄 Step 2: Extracting patient data...
[16:32:40] ℹ️  AI extracted raw sex value: ''
[16:32:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:32:40] ℹ️  AI extracted payer source: ''
[16:32:40] ℹ️  AI extracted diagnoses:
[16:32:40] ℹ️    - Diagnosis 1: 'I48.20'
[16:32:40] ℹ️    - Diagnosis 2: 'I50.22'
[16:32:40] ℹ️    - Diagnosis 3: 'I10'
[16:32:40] ℹ️    - Diagnosis 4: ''
[16:32:40] ℹ️    - Diagnosis 5: ''
[16:32:40] ℹ️    - Diagnosis 6: ''
[16:32:40] ℹ️  Final extracted MRN: '100995738'
[16:32:40] ℹ️  Final extracted Sex: ''
[16:32:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:32:40] ℹ️  Final extracted Payer Source: ''
[16:32:40] ✅ Patient data extraction completed successfully
[16:32:40] ✅    ✅ Patient data extracted successfully
[16:32:40] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Teixeira
     └─ dob: 05/05/1939
     └─ patientSex: 
     └─ medicalRecordNo: 100995738
     └─ billingProvider: BING LIU MD
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'I48.20', 'secondDiagnosis': 'I50.22', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:32:40] ✅    ✅ Patient identified: Barbara Teixeira
[16:32:40] ✅    ✅ Patient name validation passed
[16:32:40] 🔄 
🔄 Step 3: Processing patient dates...
[16:32:40] [DOC: 9218121] ℹ️  DOB normalized: 05/05/1939
[16:32:40] [DOC: 9218121] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[16:32:40] [DOC: 9218121] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[16:32:40] [DOC: 9218121] ✅ Patient date processing completed successfully
[16:32:40] ✅    ✅ Date processing completed
[16:32:40] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Teixeira
     └─ dob: 05/05/1939
     └─ patientSex: 
     └─ medicalRecordNo: 100995738
     └─ billingProvider: BING LIU MD
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'I48.20', 'secondDiagnosis': 'I50.22', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:32:40] 🔄 
🔄 Step 4: Extracting order data...
[16:32:42] ℹ️  Order extraction - MRN: '100995738'
[16:32:42] ℹ️  Order extraction - Sex: ''
[16:32:42] ℹ️  Order extraction - Service Line: 'SN'
[16:32:42] ℹ️  Order extraction - Payer Source: ''
[16:32:42] ✅ Order data extraction completed successfully
[16:32:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:32:42] ℹ️  Using MRN from patient data: '100995738' over '100995738'
[16:32:42] ℹ️  Inferred sex as FEMALE from name: Barbara
[16:32:42] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[16:32:42] ✅ Patient name cross-validation successful
[16:32:42] ✅    ✅ Data merged successfully
[16:32:44] ✅    ✅ Order data extracted and validated
[16:32:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:32:49] [DOC: 9218121] ✅ Patient exists in API: Barbara Teixeira, ID: 09ed6890-a571-421f-bd0c-09c54a8c1a46
[16:32:49] ✅    ✅ Existing patient found with ID: 09ed6890-a571-421f-bd0c-09c54a8c1a46
[16:32:49] 🔄 
🔄 Step 6: Pushing order to API...
[16:32:49] [DOC: 9218121] ℹ️  Pushing order via API for patient ID: 09ed6890-a571-421f-bd0c-09c54a8c1a46
[16:32:50] [DOC: 9218121] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14268"}
[16:32:50] ❌    ❌ Failed to push order
[16:32:50] 🔄 
🔄 Step 7: Writing to CSV...
[16:32:50] [DOC: 9218121] ℹ️  Calculated age: 86 from DOB: 05/05/1939
[16:32:50] [DOC: 9218121] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[16:32:50] [DOC: 9218121] ℹ️  Payer Source extracted: ''
[16:32:50] [DOC: 9218121] ℹ️  Diagnosis codes being written:
[16:32:50] [DOC: 9218121] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.20'
[16:32:50] [DOC: 9218121] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.22'
[16:32:50] [DOC: 9218121] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[16:32:50] [DOC: 9218121] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:32:50] [DOC: 9218121] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:32:50] [DOC: 9218121] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:32:50] [DOC: 9218121] ✅ Patient data written to CSV: Barbara Teixeira | Sex: FEMALE | Age: 86 | Service: SN, Skilled Nursing | Payer:  | MRN: 100995738
[16:32:50] ✅    ✅ Document 9218121 processed and saved successfully
[16:32:50] 🔄 
🔄 Step 8: Saving API details...
[16:32:50] [DOC: 9218121] ℹ️  API push details saved for document 9218121
[16:32:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218119                         ║
================================================================================
[16:32:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:32:50] ℹ️  Date: 04/02/2025
[16:32:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:32:54] [DOC: 9218119] ✅ Text extracted using pdfplumber (9443 chars)
[16:32:54] ✅    ✅ Text extracted using pdfplumber (9443 chars)
[16:32:54] 🔄 
🔄 Step 2: Extracting patient data...
[16:32:58] ℹ️  AI extracted raw sex value: 'F'
[16:32:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:32:58] ℹ️  AI extracted payer source: 'SWH'
[16:32:58] ℹ️  AI extracted diagnoses:
[16:32:58] ℹ️    - Diagnosis 1: 'I48.20'
[16:32:58] ℹ️    - Diagnosis 2: 'I50.22'
[16:32:58] ℹ️    - Diagnosis 3: 'I10'
[16:32:58] ℹ️    - Diagnosis 4: 'D63.8'
[16:32:58] ℹ️    - Diagnosis 5: 'E03.9'
[16:32:58] ℹ️    - Diagnosis 6: 'M06.9'
[16:32:58] ℹ️  Final extracted MRN: '100995738'
[16:32:58] ℹ️  Final extracted Sex: 'FEMALE'
[16:32:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:32:58] ℹ️  Final extracted Payer Source: 'SWH'
[16:32:58] ✅ Patient data extraction completed successfully
[16:32:58] ✅    ✅ Patient data extracted successfully
[16:32:58] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Teixeira
     └─ dob: 05/05/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100995738
     └─ billingProvider: LIU, BING MD
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 171 Summit St, Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 991-4462
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '08/24/2023', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'I48.20', 'secondDiagnosis': 'I50.22', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D63.8', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'M06.9'}]
[16:32:58] ✅    ✅ Patient identified: Barbara Teixeira
[16:32:58] ✅    ✅ Patient name validation passed
[16:32:58] 🔄 
🔄 Step 3: Processing patient dates...
[16:32:58] [DOC: 9218119] ℹ️  DOB normalized: 05/05/1939
[16:32:58] [DOC: 9218119] ℹ️  Episode startOfCare normalized: 08/24/2023
[16:32:58] [DOC: 9218119] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[16:32:58] [DOC: 9218119] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[16:32:58] [DOC: 9218119] ✅ Patient date processing completed successfully
[16:32:58] ✅    ✅ Date processing completed
[16:32:58] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Teixeira
     └─ dob: 05/05/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100995738
     └─ billingProvider: LIU, BING MD
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 171 Summit St, Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 991-4462
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '08/24/2023', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': 'I48.20', 'secondDiagnosis': 'I50.22', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D63.8', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'M06.9'}]
[16:32:58] 🔄 
🔄 Step 4: Extracting order data...
[16:33:00] ℹ️  Order extraction - MRN: '100995738'
[16:33:00] ℹ️  Order extraction - Sex: 'FEMALE'
[16:33:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:33:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:33:00] ✅ Order data extraction completed successfully
[16:33:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:33:00] ℹ️  Using MRN from patient data: '100995738' over '100995738'
[16:33:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:33:00] ⚠️  Payer source mismatch: Patient='SWH' vs Order='Medicare', using patient data
[16:33:00] ✅ Patient name cross-validation successful
[16:33:00] ✅    ✅ Data merged successfully
[16:33:02] ✅    ✅ Order data extracted and validated
[16:33:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:33:02] [DOC: 9218119] ✅ Patient found in local cache: Barbara Teixeira, ID: 09ed6890-a571-421f-bd0c-09c54a8c1a46
[16:33:02] ✅    ✅ Existing patient found with ID: 09ed6890-a571-421f-bd0c-09c54a8c1a46
[16:33:02] 🔄 
🔄 Step 6: Pushing order to API...
[16:33:02] [DOC: 9218119] ℹ️  Pushing order via API for patient ID: 09ed6890-a571-421f-bd0c-09c54a8c1a46
[16:33:03] [DOC: 9218119] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14269"}
[16:33:03] ❌    ❌ Failed to push order
[16:33:03] 🔄 
🔄 Step 7: Writing to CSV...
[16:33:03] [DOC: 9218119] ℹ️  Calculated age: 86 from DOB: 05/05/1939
[16:33:03] [DOC: 9218119] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:33:03] [DOC: 9218119] ℹ️  Payer Source extracted: 'SWH'
[16:33:03] [DOC: 9218119] ℹ️  Diagnosis codes being written:
[16:33:03] [DOC: 9218119] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.20'
[16:33:03] [DOC: 9218119] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.22'
[16:33:03] [DOC: 9218119] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[16:33:03] [DOC: 9218119] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D63.8'
[16:33:03] [DOC: 9218119] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E03.9'
[16:33:03] [DOC: 9218119] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M06.9'
[16:33:03] [DOC: 9218119] ✅ Patient data written to CSV: Barbara Teixeira | Sex: FEMALE | Age: 86 | Service: Skilled Nursing | Payer: SWH | MRN: 100995738
[16:33:03] ✅    ✅ Document 9218119 processed and saved successfully
[16:33:03] 🔄 
🔄 Step 8: Saving API details...
[16:33:03] [DOC: 9218119] ℹ️  API push details saved for document 9218119
[16:33:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218117                         ║
================================================================================
[16:33:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:33:03] ℹ️  Date: 04/02/2025
[16:33:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:33:09] [DOC: 9218117] ✅ Text extracted using pdfplumber (10769 chars)
[16:33:09] ✅    ✅ Text extracted using pdfplumber (10769 chars)
[16:33:09] 🔄 
🔄 Step 2: Extracting patient data...
[16:33:12] ℹ️  AI extracted raw sex value: 'M'
[16:33:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:33:12] ℹ️  AI extracted payer source: 'Medicare'
[16:33:12] ℹ️  AI extracted diagnoses:
[16:33:12] ℹ️    - Diagnosis 1: 'C20'
[16:33:12] ℹ️    - Diagnosis 2: 'D50.9'
[16:33:12] ℹ️    - Diagnosis 3: 'E11.65'
[16:33:12] ℹ️    - Diagnosis 4: 'E44.0'
[16:33:12] ℹ️    - Diagnosis 5: 'E11.51'
[16:33:12] ℹ️    - Diagnosis 6: 'I10'
[16:33:12] ℹ️  Final extracted MRN: 'MA240205073906'
[16:33:12] ℹ️  Final extracted Sex: 'MALE'
[16:33:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:33:12] ℹ️  Final extracted Payer Source: 'Medicare'
[16:33:12] ✅ Patient data extraction completed successfully
[16:33:12] ✅    ✅ Patient data extracted successfully
[16:33:12] 📊 Patient Response
     └─ patientFName: Albert
     └─ patientLName: Lopes
     └─ dob: 07/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240205073906
     └─ billingProvider: LIU, BING MD
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/21/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'C20', 'secondDiagnosis': 'D50.9', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E44.0', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'I10'}]
[16:33:12] ✅    ✅ Patient identified: Albert Lopes
[16:33:12] ✅    ✅ Patient name validation passed
[16:33:12] 🔄 
🔄 Step 3: Processing patient dates...
[16:33:12] [DOC: 9218117] ℹ️  DOB normalized: 07/20/1939
[16:33:12] [DOC: 9218117] ℹ️  Episode startOfCare normalized: 06/21/2024
[16:33:12] [DOC: 9218117] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[16:33:12] [DOC: 9218117] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[16:33:12] [DOC: 9218117] ✅ Patient date processing completed successfully
[16:33:12] ✅    ✅ Date processing completed
[16:33:12] 📊 Processed Patient Data
     └─ patientFName: Albert
     └─ patientLName: Lopes
     └─ dob: 07/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240205073906
     └─ billingProvider: LIU, BING MD
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/21/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'C20', 'secondDiagnosis': 'D50.9', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E44.0', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'I10'}]
[16:33:12] 🔄 
🔄 Step 4: Extracting order data...
[16:33:15] ℹ️  Order extraction - MRN: 'MA240205073906'
[16:33:15] ℹ️  Order extraction - Sex: 'MALE'
[16:33:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:33:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:33:15] ✅ Order data extraction completed successfully
[16:33:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:33:15] ℹ️  Using MRN from patient data: 'MA240205073906' over 'MA240205073906'
[16:33:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:33:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:33:15] ✅ Patient name cross-validation successful
[16:33:15] ✅    ✅ Data merged successfully
[16:33:17] ✅    ✅ Order data extracted and validated
[16:33:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:33:22] [DOC: 9218117] ✅ Patient exists in API: Albert Lopes, ID: d2471295-ccb9-4bc2-8ba5-b9bc77350c0c
[16:33:22] ✅    ✅ Existing patient found with ID: d2471295-ccb9-4bc2-8ba5-b9bc77350c0c
[16:33:22] 🔄 
🔄 Step 6: Pushing order to API...
[16:33:22] [DOC: 9218117] ℹ️  Pushing order via API for patient ID: d2471295-ccb9-4bc2-8ba5-b9bc77350c0c
[16:33:23] [DOC: 9218117] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13956"}
[16:33:23] ❌    ❌ Failed to push order
[16:33:23] 🔄 
🔄 Step 7: Writing to CSV...
[16:33:23] [DOC: 9218117] ℹ️  Calculated age: 85 from DOB: 07/20/1939
[16:33:23] [DOC: 9218117] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:33:23] [DOC: 9218117] ℹ️  Payer Source extracted: 'Medicare'
[16:33:23] [DOC: 9218117] ℹ️  Diagnosis codes being written:
[16:33:23] [DOC: 9218117] ℹ️    - Latest_Episode_Firstdiagnosis: 'C20'
[16:33:23] [DOC: 9218117] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.9'
[16:33:23] [DOC: 9218117] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[16:33:23] [DOC: 9218117] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E44.0'
[16:33:23] [DOC: 9218117] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.51'
[16:33:23] [DOC: 9218117] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[16:33:23] [DOC: 9218117] ✅ Patient data written to CSV: Albert Lopes | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240205073906
[16:33:23] ✅    ✅ Document 9218117 processed and saved successfully
[16:33:23] 🔄 
🔄 Step 8: Saving API details...
[16:33:23] [DOC: 9218117] ℹ️  API push details saved for document 9218117
[16:33:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218114                         ║
================================================================================
[16:33:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:33:23] ℹ️  Date: 04/02/2025
[16:33:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:33:26] [DOC: 9218114] ✅ Text extracted using pdfplumber (7900 chars)
[16:33:26] ✅    ✅ Text extracted using pdfplumber (7900 chars)
[16:33:26] 🔄 
🔄 Step 2: Extracting patient data...
[16:33:29] ℹ️  AI extracted raw sex value: 'M'
[16:33:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:33:29] ℹ️  AI extracted payer source: 'None'
[16:33:29] ℹ️  AI extracted diagnoses:
[16:33:29] ℹ️    - Diagnosis 1: 'C20'
[16:33:29] ℹ️    - Diagnosis 2: 'D509'
[16:33:29] ℹ️    - Diagnosis 3: 'None'
[16:33:29] ℹ️    - Diagnosis 4: 'None'
[16:33:29] ℹ️    - Diagnosis 5: 'None'
[16:33:29] ℹ️    - Diagnosis 6: 'None'
[16:33:29] ℹ️  Final extracted MRN: 'MA240205073906'
[16:33:29] ℹ️  Final extracted Sex: 'MALE'
[16:33:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:33:29] ℹ️  Final extracted Payer Source: ''
[16:33:29] ✅ Patient data extraction completed successfully
[16:33:29] ✅    ✅ Patient data extracted successfully
[16:33:29] 📊 Patient Response
     └─ patientFName: Albert
     └─ patientLName: Lopes
     └─ dob: 07/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240205073906
     └─ billingProvider: Dr. Liu, Bing
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/18/2024', 'endOfEpisode': '02/15/2025', 'firstDiagnosis': 'C20', 'secondDiagnosis': 'D509', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:33:29] ✅    ✅ Patient identified: Albert Lopes
[16:33:29] ✅    ✅ Patient name validation passed
[16:33:29] 🔄 
🔄 Step 3: Processing patient dates...
[16:33:29] [DOC: 9218114] ℹ️  DOB normalized: 07/20/1939
[16:33:29] [DOC: 9218114] ℹ️  Episode startOfEpisode normalized: 12/18/2024
[16:33:29] [DOC: 9218114] ℹ️  Episode endOfEpisode normalized: 02/15/2025
[16:33:29] [DOC: 9218114] ✅ Patient date processing completed successfully
[16:33:29] ✅    ✅ Date processing completed
[16:33:29] 📊 Processed Patient Data
     └─ patientFName: Albert
     └─ patientLName: Lopes
     └─ dob: 07/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240205073906
     └─ billingProvider: Dr. Liu, Bing
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/18/2024', 'endOfEpisode': '02/15/2025', 'firstDiagnosis': 'C20', 'secondDiagnosis': 'D509'}]
[16:33:29] 🔄 
🔄 Step 4: Extracting order data...
[16:33:32] ℹ️  Order extraction - MRN: 'MA240205073906'
[16:33:32] ℹ️  Order extraction - Sex: 'MALE'
[16:33:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:33:32] ℹ️  Order extraction - Payer Source: ''
[16:33:32] ✅ Order data extraction completed successfully
[16:33:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:33:32] ℹ️  Using MRN from patient data: 'MA240205073906' over 'MA240205073906'
[16:33:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:33:32] ✅ Patient name cross-validation successful
[16:33:32] ✅    ✅ Data merged successfully
[16:33:33] ✅    ✅ Order data extracted and validated
[16:33:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:33:33] [DOC: 9218114] ✅ Patient found in local cache: Albert Lopes, ID: d2471295-ccb9-4bc2-8ba5-b9bc77350c0c
[16:33:33] ✅    ✅ Existing patient found with ID: d2471295-ccb9-4bc2-8ba5-b9bc77350c0c
[16:33:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:33:33] [DOC: 9218114] ℹ️  Pushing order via API for patient ID: d2471295-ccb9-4bc2-8ba5-b9bc77350c0c
[16:33:34] [DOC: 9218114] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13957"}
[16:33:34] ❌    ❌ Failed to push order
[16:33:34] 🔄 
🔄 Step 7: Writing to CSV...
[16:33:34] [DOC: 9218114] ℹ️  Calculated age: 85 from DOB: 07/20/1939
[16:33:34] [DOC: 9218114] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:33:34] [DOC: 9218114] ℹ️  Payer Source extracted: ''
[16:33:34] [DOC: 9218114] ℹ️  Diagnosis codes being written:
[16:33:34] [DOC: 9218114] ℹ️    - Latest_Episode_Firstdiagnosis: 'C20'
[16:33:34] [DOC: 9218114] ℹ️    - Latest_Episode_Seconddiagnosis: 'D509'
[16:33:34] [DOC: 9218114] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:33:34] [DOC: 9218114] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:33:34] [DOC: 9218114] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:33:34] [DOC: 9218114] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:33:34] [DOC: 9218114] ✅ Patient data written to CSV: Albert Lopes | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer:  | MRN: MA240205073906
[16:33:34] ✅    ✅ Document 9218114 processed and saved successfully
[16:33:34] 🔄 
🔄 Step 8: Saving API details...
[16:33:34] [DOC: 9218114] ℹ️  API push details saved for document 9218114
[16:33:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218112                         ║
================================================================================
[16:33:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:33:34] ℹ️  Date: 04/02/2025
[16:33:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:33:48] [DOC: 9218112] ✅ Text extracted using pdfplumber (17949 chars)
[16:33:48] ✅    ✅ Text extracted using pdfplumber (17949 chars)
[16:33:48] 🔄 
🔄 Step 2: Extracting patient data...
[16:33:51] ℹ️  AI extracted raw sex value: 'F'
[16:33:51] ℹ️  AI extracted service line: 'PT'
[16:33:51] ℹ️  AI extracted payer source: ''
[16:33:51] ℹ️  AI extracted diagnoses:
[16:33:51] ℹ️    - Diagnosis 1: 'M54.5'
[16:33:51] ℹ️    - Diagnosis 2: 'I69.39'
[16:33:51] ℹ️    - Diagnosis 3: 'I25.10'
[16:33:51] ℹ️    - Diagnosis 4: 'M10.9'
[16:33:51] ℹ️    - Diagnosis 5: 'K50'
[16:33:51] ℹ️    - Diagnosis 6: 'G30'
[16:33:51] ℹ️  Final extracted MRN: 'MA241018093006'
[16:33:51] ℹ️  Final extracted Sex: 'FEMALE'
[16:33:51] ℹ️  Final extracted Service Line: 'PT'
[16:33:51] ℹ️  Final extracted Payer Source: ''
[16:33:51] ✅ Patient data extraction completed successfully
[16:33:51] ✅    ✅ Patient data extracted successfully
[16:33:51] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Robichaud
     └─ dob: 09/18/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241018093006
     └─ billingProvider: Dr. Liu, Bing
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'M54.5', 'secondDiagnosis': 'I69.39', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'M10.9', 'fifthDiagnosis': 'K50', 'sixthDiagnosis': 'G30'}]
[16:33:51] ✅    ✅ Patient identified: Virginia Robichaud
[16:33:51] ✅    ✅ Patient name validation passed
[16:33:51] 🔄 
🔄 Step 3: Processing patient dates...
[16:33:51] [DOC: 9218112] ℹ️  DOB normalized: 09/18/1930
[16:33:51] [DOC: 9218112] ✅ Patient date processing completed successfully
[16:33:51] ✅    ✅ Date processing completed
[16:33:51] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Robichaud
     └─ dob: 09/18/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241018093006
     └─ billingProvider: Dr. Liu, Bing
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'M54.5', 'secondDiagnosis': 'I69.39', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'M10.9', 'fifthDiagnosis': 'K50', 'sixthDiagnosis': 'G30'}]
[16:33:51] 🔄 
🔄 Step 4: Extracting order data...
[16:33:54] ℹ️  Order extraction - MRN: 'MA241018093006'
[16:33:54] ℹ️  Order extraction - Sex: 'FEMALE'
[16:33:54] ℹ️  Order extraction - Service Line: 'PT'
[16:33:54] ℹ️  Order extraction - Payer Source: ''
[16:33:54] ✅ Order data extraction completed successfully
[16:33:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:33:54] ℹ️  Using MRN from patient data: 'MA241018093006' over 'MA241018093006'
[16:33:54] ℹ️  Service line consistent in both sources: 'PT'
[16:33:54] ✅ Patient name cross-validation successful
[16:33:54] ✅    ✅ Data merged successfully
[16:33:55] ✅    ✅ Order data extracted and validated
[16:33:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:34:29] [DOC: 9218112] ℹ️  Patient not found in cache or API: Virginia Robichaud
[16:34:29] [DOC: 9218112] ℹ️  Patient not found, creating new patient via API...
[16:34:29] [DOC: 9218112] ℹ️  Creating patient via API: Virginia Robichaud
[16:34:30] [DOC: 9218112] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:34:30] ❌    ❌ Failed to create patient
[16:34:30] [DOC: 9218112] ℹ️  API push details saved for document 9218112
================================================================================
║                        Processing Document ID: 9218029                         ║
================================================================================
[16:34:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:34:30] ℹ️  Date: 04/02/2025
[16:34:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:34:32] [DOC: 9218029] ✅ Text extracted using pdfplumber (1364 chars)
[16:34:32] ✅    ✅ Text extracted using pdfplumber (1364 chars)
[16:34:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:34:35] ℹ️  AI extracted raw sex value: ''
[16:34:35] ℹ️  AI extracted service line: 'Physical Therapy'
[16:34:35] ℹ️  AI extracted payer source: ''
[16:34:35] ℹ️  AI extracted diagnoses:
[16:34:35] ℹ️    - Diagnosis 1: 'E11.65'
[16:34:35] ℹ️    - Diagnosis 2: 'L03.115'
[16:34:35] ℹ️    - Diagnosis 3: 'L03.116'
[16:34:35] ℹ️    - Diagnosis 4: 'None'
[16:34:35] ℹ️    - Diagnosis 5: 'None'
[16:34:35] ℹ️    - Diagnosis 6: 'None'
[16:34:35] ℹ️  Final extracted MRN: 'MA220224114804'
[16:34:35] ℹ️  Final extracted Sex: ''
[16:34:35] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:34:35] ℹ️  Final extracted Payer Source: ''
[16:34:35] ✅ Patient data extraction completed successfully
[16:34:35] ✅    ✅ Patient data extracted successfully
[16:34:35] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Minkle
     └─ dob: 11/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220224114804
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'L03.115', 'thirdDiagnosis': 'L03.116', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:34:35] ✅    ✅ Patient identified: Kathleen Minkle
[16:34:35] ✅    ✅ Patient name validation passed
[16:34:35] 🔄 
🔄 Step 3: Processing patient dates...
[16:34:35] [DOC: 9218029] ℹ️  DOB normalized: 11/17/1948
[16:34:35] [DOC: 9218029] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[16:34:35] [DOC: 9218029] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[16:34:35] [DOC: 9218029] ✅ Patient date processing completed successfully
[16:34:35] ✅    ✅ Date processing completed
[16:34:35] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Minkle
     └─ dob: 11/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220224114804
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'L03.115', 'thirdDiagnosis': 'L03.116'}]
[16:34:35] 🔄 
🔄 Step 4: Extracting order data...
[16:34:37] ℹ️  Order extraction - MRN: 'MA220224114804'
[16:34:37] ℹ️  Order extraction - Sex: ''
[16:34:37] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:34:37] ℹ️  Order extraction - Payer Source: ''
[16:34:37] ✅ Order data extraction completed successfully
[16:34:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:34:37] ℹ️  Using MRN from patient data: 'MA220224114804' over 'MA220224114804'
[16:34:37] ⚠️  Could not determine sex using any available method
[16:34:37] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:34:37] ✅ Patient name cross-validation successful
[16:34:37] ✅    ✅ Data merged successfully
[16:34:39] ✅    ✅ Order data extracted and validated
[16:34:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:34:39] [DOC: 9218029] ✅ Patient found in local cache: Kathleen Minkle, ID: b379df60-0af4-4352-bb35-d7b2c726b92c
[16:34:39] ✅    ✅ Existing patient found with ID: b379df60-0af4-4352-bb35-d7b2c726b92c
[16:34:39] 🔄 
🔄 Step 6: Pushing order to API...
[16:34:39] [DOC: 9218029] ℹ️  Pushing order via API for patient ID: b379df60-0af4-4352-bb35-d7b2c726b92c
[16:34:40] [DOC: 9218029] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14111"}
[16:34:40] ❌    ❌ Failed to push order
[16:34:40] 🔄 
🔄 Step 7: Writing to CSV...
[16:34:40] [DOC: 9218029] ℹ️  Calculated age: 76 from DOB: 11/17/1948
[16:34:40] [DOC: 9218029] ℹ️  Service Line extracted: 'Physical Therapy'
[16:34:40] [DOC: 9218029] ℹ️  Payer Source extracted: ''
[16:34:40] [DOC: 9218029] ℹ️  Diagnosis codes being written:
[16:34:40] [DOC: 9218029] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[16:34:40] [DOC: 9218029] ℹ️    - Latest_Episode_Seconddiagnosis: 'L03.115'
[16:34:40] [DOC: 9218029] ℹ️    - Latest_Episode_Thirddiagnosis: 'L03.116'
[16:34:40] [DOC: 9218029] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:34:40] [DOC: 9218029] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:34:40] [DOC: 9218029] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:34:40] [DOC: 9218029] ✅ Patient data written to CSV: Kathleen Minkle | Sex:  | Age: 76 | Service: Physical Therapy | Payer:  | MRN: MA220224114804
[16:34:40] ✅    ✅ Document 9218029 processed and saved successfully
[16:34:40] 🔄 
🔄 Step 8: Saving API details...
[16:34:40] [DOC: 9218029] ℹ️  API push details saved for document 9218029
[16:34:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218026                         ║
================================================================================
[16:34:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:34:40] ℹ️  Date: 04/02/2025
[16:34:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:34:43] [DOC: 9218026] ✅ Text extracted using pdfplumber (9082 chars)
[16:34:43] ✅    ✅ Text extracted using pdfplumber (9082 chars)
[16:34:43] 🔄 
🔄 Step 2: Extracting patient data...
[16:34:46] ℹ️  AI extracted raw sex value: ''
[16:34:46] ℹ️  AI extracted service line: 'OT'
[16:34:46] ℹ️  AI extracted payer source: 'None'
[16:34:46] ℹ️  AI extracted diagnoses:
[16:34:46] ℹ️    - Diagnosis 1: 'None'
[16:34:46] ℹ️    - Diagnosis 2: 'None'
[16:34:46] ℹ️    - Diagnosis 3: 'None'
[16:34:46] ℹ️    - Diagnosis 4: 'None'
[16:34:46] ℹ️    - Diagnosis 5: 'None'
[16:34:46] ℹ️    - Diagnosis 6: 'None'
[16:34:46] ℹ️  Final extracted MRN: 'MA220719045602'
[16:34:46] ℹ️  Final extracted Sex: ''
[16:34:46] ℹ️  Final extracted Service Line: 'OT'
[16:34:46] ℹ️  Final extracted Payer Source: ''
[16:34:46] ✅ Patient data extraction completed successfully
[16:34:46] ✅    ✅ Patient data extracted successfully
[16:34:46] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:34:46] ✅    ✅ Patient identified: Joyce Martin
[16:34:46] ✅    ✅ Patient name validation passed
[16:34:46] 🔄 
🔄 Step 3: Processing patient dates...
[16:34:46] [DOC: 9218026] ℹ️  DOB normalized: 04/24/1956
[16:34:46] [DOC: 9218026] ✅ Patient date processing completed successfully
[16:34:46] ✅    ✅ Date processing completed
[16:34:46] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[16:34:46] 🔄 
🔄 Step 4: Extracting order data...
[16:34:48] ℹ️  Order extraction - MRN: 'MA220719045602'
[16:34:48] ℹ️  Order extraction - Sex: ''
[16:34:48] ℹ️  Order extraction - Service Line: 'OT'
[16:34:48] ℹ️  Order extraction - Payer Source: ''
[16:34:48] ✅ Order data extraction completed successfully
[16:34:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:34:48] ℹ️  Using MRN from patient data: 'MA220719045602' over 'MA220719045602'
[16:34:48] ℹ️  Inferred sex as FEMALE from name: Joyce
[16:34:48] ℹ️  Service line consistent in both sources: 'OT'
[16:34:48] ✅ Patient name cross-validation successful
[16:34:48] ✅    ✅ Data merged successfully
[16:34:50] ⚠️     ❌ Skipping - missing episode start date
[16:34:50] [DOC: 9218026] ℹ️  API push details saved for document 9218026
================================================================================
║                        Processing Document ID: 9218023                         ║
================================================================================
[16:34:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:34:50] ℹ️  Date: 04/02/2025
[16:34:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:34:52] [DOC: 9218023] ✅ Text extracted using pdfplumber (1435 chars)
[16:34:52] ✅    ✅ Text extracted using pdfplumber (1435 chars)
[16:34:52] 🔄 
🔄 Step 2: Extracting patient data...
[16:34:55] ℹ️  AI extracted raw sex value: ''
[16:34:55] ℹ️  AI extracted service line: 'Physical Therapy'
[16:34:55] ℹ️  AI extracted payer source: ''
[16:34:55] ℹ️  AI extracted diagnoses:
[16:34:55] ℹ️    - Diagnosis 1: 'S82.852'
[16:34:55] ℹ️    - Diagnosis 2: 'S92.352'
[16:34:55] ℹ️    - Diagnosis 3: 'M19.072'
[16:34:55] ℹ️    - Diagnosis 4: ''
[16:34:55] ℹ️    - Diagnosis 5: ''
[16:34:55] ℹ️    - Diagnosis 6: ''
[16:34:55] ℹ️  Final extracted MRN: 'MA220719045602'
[16:34:55] ℹ️  Final extracted Sex: ''
[16:34:55] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:34:55] ℹ️  Final extracted Payer Source: ''
[16:34:55] ✅ Patient data extraction completed successfully
[16:34:55] ✅    ✅ Patient data extracted successfully
[16:34:55] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:34:55] ✅    ✅ Patient identified: Joyce Martin
[16:34:55] ✅    ✅ Patient name validation passed
[16:34:55] 🔄 
🔄 Step 3: Processing patient dates...
[16:34:55] [DOC: 9218023] ℹ️  DOB normalized: 04/24/1956
[16:34:55] [DOC: 9218023] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:34:55] [DOC: 9218023] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:34:55] [DOC: 9218023] ✅ Patient date processing completed successfully
[16:34:55] ✅    ✅ Date processing completed
[16:34:55] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:34:55] 🔄 
🔄 Step 4: Extracting order data...
[16:34:58] ℹ️  Order extraction - MRN: 'MA220719045602'
[16:34:58] ℹ️  Order extraction - Sex: ''
[16:34:58] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:34:58] ℹ️  Order extraction - Payer Source: ''
[16:34:58] ✅ Order data extraction completed successfully
[16:34:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:34:58] ℹ️  Using MRN from patient data: 'MA220719045602' over 'MA220719045602'
[16:34:58] ℹ️  Inferred sex as FEMALE from name: Joyce
[16:34:58] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:34:58] ✅ Patient name cross-validation successful
[16:34:58] ✅    ✅ Data merged successfully
[16:34:59] ✅    ✅ Order data extracted and validated
[16:34:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:35:05] [DOC: 9218023] ✅ Patient exists in API: Joyce Martin, ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:05] ✅    ✅ Existing patient found with ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:05] 🔄 
🔄 Step 6: Pushing order to API...
[16:35:05] [DOC: 9218023] ℹ️  Pushing order via API for patient ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:06] [DOC: 9218023] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14038"}
[16:35:06] ❌    ❌ Failed to push order
[16:35:06] 🔄 
🔄 Step 7: Writing to CSV...
[16:35:06] [DOC: 9218023] ℹ️  Calculated age: 69 from DOB: 04/24/1956
[16:35:06] [DOC: 9218023] ℹ️  Service Line extracted: 'Physical Therapy'
[16:35:06] [DOC: 9218023] ℹ️  Payer Source extracted: ''
[16:35:06] [DOC: 9218023] ℹ️  Diagnosis codes being written:
[16:35:06] [DOC: 9218023] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.852'
[16:35:06] [DOC: 9218023] ℹ️    - Latest_Episode_Seconddiagnosis: 'S92.352'
[16:35:06] [DOC: 9218023] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.072'
[16:35:06] [DOC: 9218023] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:35:06] [DOC: 9218023] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:35:06] [DOC: 9218023] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:35:06] [DOC: 9218023] ✅ Patient data written to CSV: Joyce Martin | Sex: FEMALE | Age: 69 | Service: Physical Therapy | Payer:  | MRN: MA220719045602
[16:35:06] ✅    ✅ Document 9218023 processed and saved successfully
[16:35:06] 🔄 
🔄 Step 8: Saving API details...
[16:35:06] [DOC: 9218023] ℹ️  API push details saved for document 9218023
[16:35:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218021                         ║
================================================================================
[16:35:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:35:06] ℹ️  Date: 04/02/2025
[16:35:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:35:08] [DOC: 9218021] ✅ Text extracted using pdfplumber (1355 chars)
[16:35:08] ✅    ✅ Text extracted using pdfplumber (1355 chars)
[16:35:08] 🔄 
🔄 Step 2: Extracting patient data...
[16:35:11] ℹ️  AI extracted raw sex value: ''
[16:35:11] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:35:11] ℹ️  AI extracted payer source: ''
[16:35:11] ℹ️  AI extracted diagnoses:
[16:35:11] ℹ️    - Diagnosis 1: 'S82.852'
[16:35:11] ℹ️    - Diagnosis 2: 'S92.352'
[16:35:11] ℹ️    - Diagnosis 3: 'M19.072'
[16:35:11] ℹ️    - Diagnosis 4: ''
[16:35:11] ℹ️    - Diagnosis 5: ''
[16:35:11] ℹ️    - Diagnosis 6: ''
[16:35:11] ℹ️  Final extracted MRN: 'MA220719045602'
[16:35:11] ℹ️  Final extracted Sex: ''
[16:35:11] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:35:11] ℹ️  Final extracted Payer Source: ''
[16:35:11] ✅ Patient data extraction completed successfully
[16:35:11] ✅    ✅ Patient data extracted successfully
[16:35:11] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:35:11] ✅    ✅ Patient identified: Joyce Martin
[16:35:11] ✅    ✅ Patient name validation passed
[16:35:11] 🔄 
🔄 Step 3: Processing patient dates...
[16:35:11] [DOC: 9218021] ℹ️  DOB normalized: 04/24/1956
[16:35:11] [DOC: 9218021] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:35:11] [DOC: 9218021] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:35:11] [DOC: 9218021] ✅ Patient date processing completed successfully
[16:35:11] ✅    ✅ Date processing completed
[16:35:11] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:35:11] 🔄 
🔄 Step 4: Extracting order data...
[16:35:13] ℹ️  Order extraction - MRN: 'MA220719045602'
[16:35:13] ℹ️  Order extraction - Sex: ''
[16:35:13] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:35:13] ℹ️  Order extraction - Payer Source: ''
[16:35:13] ✅ Order data extraction completed successfully
[16:35:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:35:13] ℹ️  Using MRN from patient data: 'MA220719045602' over 'MA220719045602'
[16:35:13] ℹ️  Inferred sex as FEMALE from name: Joyce
[16:35:13] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:35:13] ✅ Patient name cross-validation successful
[16:35:13] ✅    ✅ Data merged successfully
[16:35:15] ✅    ✅ Order data extracted and validated
[16:35:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:35:15] [DOC: 9218021] ✅ Patient found in local cache: Joyce Martin, ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:15] ✅    ✅ Existing patient found with ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:15] 🔄 
🔄 Step 6: Pushing order to API...
[16:35:15] [DOC: 9218021] ℹ️  Pushing order via API for patient ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:16] [DOC: 9218021] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14039"}
[16:35:16] ❌    ❌ Failed to push order
[16:35:16] 🔄 
🔄 Step 7: Writing to CSV...
[16:35:16] [DOC: 9218021] ℹ️  Calculated age: 69 from DOB: 04/24/1956
[16:35:16] [DOC: 9218021] ℹ️  Service Line extracted: 'Occupational Therapy'
[16:35:16] [DOC: 9218021] ℹ️  Payer Source extracted: ''
[16:35:16] [DOC: 9218021] ℹ️  Diagnosis codes being written:
[16:35:16] [DOC: 9218021] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.852'
[16:35:16] [DOC: 9218021] ℹ️    - Latest_Episode_Seconddiagnosis: 'S92.352'
[16:35:16] [DOC: 9218021] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.072'
[16:35:16] [DOC: 9218021] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:35:16] [DOC: 9218021] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:35:16] [DOC: 9218021] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:35:16] [DOC: 9218021] ✅ Patient data written to CSV: Joyce Martin | Sex: FEMALE | Age: 69 | Service: Occupational Therapy | Payer:  | MRN: MA220719045602
[16:35:16] ✅    ✅ Document 9218021 processed and saved successfully
[16:35:16] 🔄 
🔄 Step 8: Saving API details...
[16:35:16] [DOC: 9218021] ℹ️  API push details saved for document 9218021
[16:35:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218019                         ║
================================================================================
[16:35:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:35:16] ℹ️  Date: 04/02/2025
[16:35:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:35:18] [DOC: 9218019] ✅ Text extracted using pdfplumber (1294 chars)
[16:35:18] ✅    ✅ Text extracted using pdfplumber (1294 chars)
[16:35:18] 🔄 
🔄 Step 2: Extracting patient data...
[16:35:21] ℹ️  AI extracted raw sex value: ''
[16:35:21] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:35:21] ℹ️  AI extracted payer source: ''
[16:35:21] ℹ️  AI extracted diagnoses:
[16:35:21] ℹ️    - Diagnosis 1: 'S82.852'
[16:35:21] ℹ️    - Diagnosis 2: 'S92.352'
[16:35:21] ℹ️    - Diagnosis 3: 'M19.072'
[16:35:21] ℹ️    - Diagnosis 4: 'None'
[16:35:21] ℹ️    - Diagnosis 5: 'None'
[16:35:21] ℹ️    - Diagnosis 6: 'None'
[16:35:21] ℹ️  Final extracted MRN: 'MA220719045602'
[16:35:21] ℹ️  Final extracted Sex: ''
[16:35:21] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:35:21] ℹ️  Final extracted Payer Source: ''
[16:35:21] ✅ Patient data extraction completed successfully
[16:35:21] ✅    ✅ Patient data extracted successfully
[16:35:21] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:35:21] ✅    ✅ Patient identified: Joyce Martin
[16:35:21] ✅    ✅ Patient name validation passed
[16:35:21] 🔄 
🔄 Step 3: Processing patient dates...
[16:35:21] [DOC: 9218019] ℹ️  DOB normalized: 04/24/1956
[16:35:21] [DOC: 9218019] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:35:21] [DOC: 9218019] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:35:21] [DOC: 9218019] ✅ Patient date processing completed successfully
[16:35:21] ✅    ✅ Date processing completed
[16:35:21] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072'}]
[16:35:21] 🔄 
🔄 Step 4: Extracting order data...
[16:35:23] ℹ️  Order extraction - MRN: 'MA220719045602'
[16:35:23] ℹ️  Order extraction - Sex: ''
[16:35:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:35:23] ℹ️  Order extraction - Payer Source: ''
[16:35:23] ✅ Order data extraction completed successfully
[16:35:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:35:23] ℹ️  Using MRN from patient data: 'MA220719045602' over 'MA220719045602'
[16:35:23] ℹ️  Inferred sex as FEMALE from name: Joyce
[16:35:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:35:23] ✅ Patient name cross-validation successful
[16:35:23] ✅    ✅ Data merged successfully
[16:35:25] ✅    ✅ Order data extracted and validated
[16:35:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:35:25] [DOC: 9218019] ✅ Patient found in local cache: Joyce Martin, ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:25] ✅    ✅ Existing patient found with ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:25] 🔄 
🔄 Step 6: Pushing order to API...
[16:35:25] [DOC: 9218019] ℹ️  Pushing order via API for patient ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:26] [DOC: 9218019] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14040"}
[16:35:26] ❌    ❌ Failed to push order
[16:35:26] 🔄 
🔄 Step 7: Writing to CSV...
[16:35:26] [DOC: 9218019] ℹ️  Calculated age: 69 from DOB: 04/24/1956
[16:35:26] [DOC: 9218019] ℹ️  Service Line extracted: 'Occupational Therapy'
[16:35:26] [DOC: 9218019] ℹ️  Payer Source extracted: ''
[16:35:26] [DOC: 9218019] ℹ️  Diagnosis codes being written:
[16:35:26] [DOC: 9218019] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.852'
[16:35:26] [DOC: 9218019] ℹ️    - Latest_Episode_Seconddiagnosis: 'S92.352'
[16:35:26] [DOC: 9218019] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.072'
[16:35:26] [DOC: 9218019] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:35:26] [DOC: 9218019] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:35:26] [DOC: 9218019] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:35:26] [DOC: 9218019] ✅ Patient data written to CSV: Joyce Martin | Sex: FEMALE | Age: 69 | Service: Occupational Therapy | Payer:  | MRN: MA220719045602
[16:35:26] ✅    ✅ Document 9218019 processed and saved successfully
[16:35:26] 🔄 
🔄 Step 8: Saving API details...
[16:35:26] [DOC: 9218019] ℹ️  API push details saved for document 9218019
[16:35:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9218018                         ║
================================================================================
[16:35:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:35:26] ℹ️  Date: 04/02/2025
[16:35:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:35:28] [DOC: 9218018] ✅ Text extracted using pdfplumber (10125 chars)
[16:35:28] ✅    ✅ Text extracted using pdfplumber (10125 chars)
[16:35:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:35:32] ℹ️  AI extracted raw sex value: 'F'
[16:35:32] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:32] ℹ️  AI extracted payer source: 'Medicare'
[16:35:32] ℹ️  AI extracted diagnoses:
[16:35:32] ℹ️    - Diagnosis 1: 'S82.852'
[16:35:32] ℹ️    - Diagnosis 2: 'S92.352'
[16:35:32] ℹ️    - Diagnosis 3: 'M19.072'
[16:35:32] ℹ️    - Diagnosis 4: 'I12.9'
[16:35:32] ℹ️    - Diagnosis 5: 'N18.31'
[16:35:32] ℹ️    - Diagnosis 6: 'F41.1'
[16:35:32] ℹ️  Final extracted MRN: 'MA220719045602'
[16:35:32] ℹ️  Final extracted Sex: 'FEMALE'
[16:35:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:32] ℹ️  Final extracted Payer Source: 'Medicare'
[16:35:32] ✅ Patient data extraction completed successfully
[16:35:32] ✅    ✅ Patient data extracted successfully
[16:35:32] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: WU, ELAINE MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave, Apt 216
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (774) 438-5721
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'F41.1'}]
[16:35:32] ✅    ✅ Patient identified: Joyce Martin
[16:35:32] ✅    ✅ Patient name validation passed
[16:35:32] 🔄 
🔄 Step 3: Processing patient dates...
[16:35:32] [DOC: 9218018] ℹ️  DOB normalized: 04/24/1956
[16:35:32] [DOC: 9218018] ℹ️  Episode startOfCare normalized: 03/01/2025
[16:35:32] [DOC: 9218018] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:35:32] [DOC: 9218018] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:35:32] [DOC: 9218018] ✅ Patient date processing completed successfully
[16:35:32] ✅    ✅ Date processing completed
[16:35:32] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Martin
     └─ dob: 04/24/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220719045602
     └─ billingProvider: WU, ELAINE MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave, Apt 216
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (774) 438-5721
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'S82.852', 'secondDiagnosis': 'S92.352', 'thirdDiagnosis': 'M19.072', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'F41.1'}]
[16:35:32] 🔄 
🔄 Step 4: Extracting order data...
[16:35:34] ℹ️  Order extraction - MRN: 'MA220719045602'
[16:35:34] ℹ️  Order extraction - Sex: 'FEMALE'
[16:35:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:35:34] ✅ Order data extraction completed successfully
[16:35:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:35:34] ℹ️  Using MRN from patient data: 'MA220719045602' over 'MA220719045602'
[16:35:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:35:34] ✅ Patient name cross-validation successful
[16:35:34] ✅    ✅ Data merged successfully
[16:35:36] ✅    ✅ Order data extracted and validated
[16:35:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:35:36] [DOC: 9218018] ✅ Patient found in local cache: Joyce Martin, ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:36] ✅    ✅ Existing patient found with ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:36] 🔄 
🔄 Step 6: Pushing order to API...
[16:35:36] [DOC: 9218018] ℹ️  Pushing order via API for patient ID: 953b27b8-b840-486c-a1b4-889392bf1361
[16:35:37] [DOC: 9218018] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14041"}
[16:35:37] ❌    ❌ Failed to push order
[16:35:37] 🔄 
🔄 Step 7: Writing to CSV...
[16:35:37] [DOC: 9218018] ℹ️  Calculated age: 69 from DOB: 04/24/1956
[16:35:37] [DOC: 9218018] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:37] [DOC: 9218018] ℹ️  Payer Source extracted: 'Medicare'
[16:35:37] [DOC: 9218018] ℹ️  Diagnosis codes being written:
[16:35:37] [DOC: 9218018] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.852'
[16:35:37] [DOC: 9218018] ℹ️    - Latest_Episode_Seconddiagnosis: 'S92.352'
[16:35:37] [DOC: 9218018] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.072'
[16:35:37] [DOC: 9218018] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I12.9'
[16:35:37] [DOC: 9218018] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.31'
[16:35:37] [DOC: 9218018] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.1'
[16:35:37] [DOC: 9218018] ✅ Patient data written to CSV: Joyce Martin | Sex: FEMALE | Age: 69 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA220719045602
[16:35:37] ✅    ✅ Document 9218018 processed and saved successfully
[16:35:37] 🔄 
🔄 Step 8: Saving API details...
[16:35:37] [DOC: 9218018] ℹ️  API push details saved for document 9218018
[16:35:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217847                         ║
================================================================================
[16:35:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:35:37] ℹ️  Date: 04/02/2025
[16:35:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:35:41] [DOC: 9217847] ✅ Text extracted using pdfplumber (22245 chars)
[16:35:41] ✅    ✅ Text extracted using pdfplumber (22245 chars)
[16:35:41] 🔄 
🔄 Step 2: Extracting patient data...
[16:35:44] ℹ️  AI extracted raw sex value: 'F'
[16:35:44] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:44] ℹ️  AI extracted payer source: ''
[16:35:44] ℹ️  AI extracted diagnoses:
[16:35:44] ℹ️    - Diagnosis 1: 'S81.812D'
[16:35:44] ℹ️    - Diagnosis 2: 'I89.0'
[16:35:44] ℹ️    - Diagnosis 3: 'I87.302'
[16:35:44] ℹ️    - Diagnosis 4: 'E03.9'
[16:35:44] ℹ️    - Diagnosis 5: 'K57.90'
[16:35:44] ℹ️    - Diagnosis 6: 'F32.A'
[16:35:44] ℹ️  Final extracted MRN: '3052261'
[16:35:44] ℹ️  Final extracted Sex: 'FEMALE'
[16:35:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:35:44] ℹ️  Final extracted Payer Source: ''
[16:35:44] ✅ Patient data extraction completed successfully
[16:35:44] ✅    ✅ Patient data extracted successfully
[16:35:44] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'I87.302', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'K57.90', 'sixthDiagnosis': 'F32.A'}]
[16:35:44] ✅    ✅ Patient identified: Donna Trott
[16:35:44] ✅    ✅ Patient name validation passed
[16:35:44] 🔄 
🔄 Step 3: Processing patient dates...
[16:35:44] [DOC: 9217847] ℹ️  DOB normalized: 04/22/1943
[16:35:44] [DOC: 9217847] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:35:44] [DOC: 9217847] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[16:35:44] [DOC: 9217847] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[16:35:44] [DOC: 9217847] ✅ Patient date processing completed successfully
[16:35:44] ✅    ✅ Date processing completed
[16:35:44] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'I87.302', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'K57.90', 'sixthDiagnosis': 'F32.A'}]
[16:35:44] 🔄 
🔄 Step 4: Extracting order data...
[16:35:48] ℹ️  Order extraction - MRN: '3052261'
[16:35:48] ℹ️  Order extraction - Sex: 'FEMALE'
[16:35:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[16:35:48] ℹ️  Order extraction - Payer Source: ''
[16:35:48] ✅ Order data extraction completed successfully
[16:35:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:35:48] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[16:35:48] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[16:35:48] ✅ Patient name cross-validation successful
[16:35:48] ✅    ✅ Data merged successfully
[16:35:49] ✅    ✅ Order data extracted and validated
[16:35:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:35:49] [DOC: 9217847] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[16:35:49] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[16:35:49] 🔄 
🔄 Step 6: Pushing order to API...
[16:35:49] [DOC: 9217847] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[16:35:50] [DOC: 9217847] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14597"}
[16:35:50] ❌    ❌ Failed to push order
[16:35:50] 🔄 
🔄 Step 7: Writing to CSV...
[16:35:50] [DOC: 9217847] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[16:35:50] [DOC: 9217847] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[16:35:50] [DOC: 9217847] ℹ️  Payer Source extracted: ''
[16:35:50] [DOC: 9217847] ℹ️  Diagnosis codes being written:
[16:35:50] [DOC: 9217847] ℹ️    - Latest_Episode_Firstdiagnosis: 'S81.812D'
[16:35:50] [DOC: 9217847] ℹ️    - Latest_Episode_Seconddiagnosis: 'I89.0'
[16:35:50] [DOC: 9217847] ℹ️    - Latest_Episode_Thirddiagnosis: 'I87.302'
[16:35:50] [DOC: 9217847] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.9'
[16:35:50] [DOC: 9217847] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K57.90'
[16:35:50] [DOC: 9217847] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.A'
[16:35:50] [DOC: 9217847] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 3052261
[16:35:50] ✅    ✅ Document 9217847 processed and saved successfully
[16:35:50] 🔄 
🔄 Step 8: Saving API details...
[16:35:50] [DOC: 9217847] ℹ️  API push details saved for document 9217847
[16:35:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217842                         ║
================================================================================
[16:35:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:35:50] ℹ️  Date: 04/02/2025
[16:35:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:35:54] [DOC: 9217842] ✅ Text extracted using pdfplumber (16734 chars)
[16:35:54] ✅    ✅ Text extracted using pdfplumber (16722 chars)
[16:35:54] 🔄 
🔄 Step 2: Extracting patient data...
[16:35:57] ℹ️  AI extracted raw sex value: 'F'
[16:35:57] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[16:35:57] ℹ️  AI extracted payer source: ''
[16:35:57] ℹ️  AI extracted diagnoses:
[16:35:57] ℹ️    - Diagnosis 1: 'G89.29'
[16:35:57] ℹ️    - Diagnosis 2: 'E11.51'
[16:35:57] ℹ️    - Diagnosis 3: 'I87.2'
[16:35:57] ℹ️    - Diagnosis 4: 'M25.551'
[16:35:57] ℹ️    - Diagnosis 5: 'M25.552'
[16:35:57] ℹ️    - Diagnosis 6: 'F41.9'
[16:35:57] ℹ️  Final extracted MRN: '3046109'
[16:35:57] ℹ️  Final extracted Sex: 'FEMALE'
[16:35:57] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[16:35:57] ℹ️  Final extracted Payer Source: ''
[16:35:57] ✅ Patient data extraction completed successfully
[16:35:57] ✅    ✅ Patient data extracted successfully
[16:35:57] 📊 Patient Response
     └─ patientFName: Irva
     └─ patientLName: Torres
     └─ dob: 01/28/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3046109
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I87.2', 'fourthDiagnosis': 'M25.551', 'fifthDiagnosis': 'M25.552', 'sixthDiagnosis': 'F41.9'}]
[16:35:57] ✅    ✅ Patient identified: Irva Torres
[16:35:57] ✅    ✅ Patient name validation passed
[16:35:57] 🔄 
🔄 Step 3: Processing patient dates...
[16:35:57] [DOC: 9217842] ℹ️  DOB normalized: 01/28/1929
[16:35:57] [DOC: 9217842] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:35:57] [DOC: 9217842] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[16:35:57] [DOC: 9217842] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[16:35:57] [DOC: 9217842] ✅ Patient date processing completed successfully
[16:35:57] ✅    ✅ Date processing completed
[16:35:57] 📊 Processed Patient Data
     └─ patientFName: Irva
     └─ patientLName: Torres
     └─ dob: 01/28/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3046109
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I87.2', 'fourthDiagnosis': 'M25.551', 'fifthDiagnosis': 'M25.552', 'sixthDiagnosis': 'F41.9'}]
[16:35:57] 🔄 
🔄 Step 4: Extracting order data...
[16:36:00] ℹ️  Order extraction - MRN: '3046109'
[16:36:00] ℹ️  Order extraction - Sex: 'FEMALE'
[16:36:00] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[16:36:00] ℹ️  Order extraction - Payer Source: ''
[16:36:00] ✅ Order data extraction completed successfully
[16:36:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:36:00] ℹ️  Using MRN from patient data: '3046109' over '3046109'
[16:36:00] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[16:36:00] ✅ Patient name cross-validation successful
[16:36:00] ✅    ✅ Data merged successfully
[16:36:01] ✅    ✅ Order data extracted and validated
[16:36:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:36:05] [DOC: 9217842] ℹ️  Patient not found in cache or API: Irva Torres
[16:36:05] [DOC: 9217842] ℹ️  Patient not found, creating new patient via API...
[16:36:05] [DOC: 9217842] ℹ️  Creating patient via API: Irva Torres
[16:36:07] [DOC: 9217842] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:36:07] ❌    ❌ Failed to create patient
[16:36:07] [DOC: 9217842] ℹ️  API push details saved for document 9217842
================================================================================
║                        Processing Document ID: 9217836                         ║
================================================================================
[16:36:07] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:36:07] ℹ️  Date: 04/02/2025
[16:36:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:36:10] [DOC: 9217836] ✅ Text extracted using pdfplumber (21540 chars)
[16:36:10] ✅    ✅ Text extracted using pdfplumber (21540 chars)
[16:36:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:36:14] ℹ️  AI extracted raw sex value: 'M'
[16:36:14] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, HHA'
[16:36:14] ℹ️  AI extracted payer source: ''
[16:36:14] ℹ️  AI extracted diagnoses:
[16:36:14] ℹ️    - Diagnosis 1: 'I51.9'
[16:36:14] ℹ️    - Diagnosis 2: 'I10'
[16:36:14] ℹ️    - Diagnosis 3: 'I50.23'
[16:36:14] ℹ️    - Diagnosis 4: 'I25.10'
[16:36:14] ℹ️    - Diagnosis 5: 'I48.91'
[16:36:14] ℹ️    - Diagnosis 6: 'I34.0'
[16:36:14] ℹ️  Final extracted MRN: '2998670'
[16:36:14] ℹ️  Final extracted Sex: 'MALE'
[16:36:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, HHA'
[16:36:14] ℹ️  Final extracted Payer Source: ''
[16:36:14] ✅ Patient data extraction completed successfully
[16:36:14] ✅    ✅ Patient data extracted successfully
[16:36:14] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'I51.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I50.23', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I34.0'}]
[16:36:14] ✅    ✅ Patient identified: Raymond Souza
[16:36:14] ✅    ✅ Patient name validation passed
[16:36:14] 🔄 
🔄 Step 3: Processing patient dates...
[16:36:14] [DOC: 9217836] ℹ️  DOB normalized: 06/18/1927
[16:36:14] [DOC: 9217836] ℹ️  Episode startOfCare normalized: 03/31/2025
[16:36:14] [DOC: 9217836] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[16:36:14] [DOC: 9217836] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[16:36:14] [DOC: 9217836] ✅ Patient date processing completed successfully
[16:36:14] ✅    ✅ Date processing completed
[16:36:14] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'I51.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I50.23', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I34.0'}]
[16:36:14] 🔄 
🔄 Step 4: Extracting order data...
[16:36:17] ℹ️  Order extraction - MRN: '2998670'
[16:36:17] ℹ️  Order extraction - Sex: 'MALE'
[16:36:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[16:36:17] ℹ️  Order extraction - Payer Source: ''
[16:36:17] ✅ Order data extraction completed successfully
[16:36:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:36:17] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[16:36:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, HHA'
[16:36:17] ✅ Patient name cross-validation successful
[16:36:17] ✅    ✅ Data merged successfully
[16:36:19] ✅    ✅ Order data extracted and validated
[16:36:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:36:19] [DOC: 9217836] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:36:19] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:36:19] 🔄 
🔄 Step 6: Pushing order to API...
[16:36:19] [DOC: 9217836] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:36:21] [DOC: 9217836] ❌ Order push failed with status 201: {"id":"a2324f82-e707-4e80-8abd-ca2ad49b8785","orderWAVId":"ORD20069","orderNo":"1077647","orderDate":"04/01/2025","startOfCare":"03/31/2025","episodeStartDate":"03/31/2025","episodeEndDate":"06/28/2025","documentID":"9217836","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:36:21] ❌    ❌ Failed to push order
[16:36:21] 🔄 
🔄 Step 7: Writing to CSV...
[16:36:21] [DOC: 9217836] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[16:36:21] [DOC: 9217836] ℹ️  Service Line extracted: 'Skilled Nursing, MSW, HHA'
[16:36:21] [DOC: 9217836] ℹ️  Payer Source extracted: ''
[16:36:21] [DOC: 9217836] ℹ️  Diagnosis codes being written:
[16:36:21] [DOC: 9217836] ℹ️    - Latest_Episode_Firstdiagnosis: 'I51.9'
[16:36:21] [DOC: 9217836] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[16:36:21] [DOC: 9217836] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.23'
[16:36:21] [DOC: 9217836] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.10'
[16:36:21] [DOC: 9217836] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[16:36:21] [DOC: 9217836] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I34.0'
[16:36:21] [DOC: 9217836] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: Skilled Nursing, MSW, HHA | Payer:  | MRN: 2998670
[16:36:21] ✅    ✅ Document 9217836 processed and saved successfully
[16:36:21] 🔄 
🔄 Step 8: Saving API details...
[16:36:21] [DOC: 9217836] ℹ️  API push details saved for document 9217836
[16:36:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217834                         ║
================================================================================
[16:36:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:36:21] ℹ️  Date: 04/02/2025
[16:36:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:36:23] [DOC: 9217834] ✅ Text extracted using pdfplumber (8487 chars)
[16:36:23] ✅    ✅ Text extracted using pdfplumber (8487 chars)
[16:36:23] 🔄 
🔄 Step 2: Extracting patient data...
[16:36:26] ℹ️  AI extracted raw sex value: 'M'
[16:36:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:36:26] ℹ️  AI extracted payer source: ''
[16:36:26] ℹ️  AI extracted diagnoses:
[16:36:26] ℹ️    - Diagnosis 1: 'I51.9'
[16:36:26] ℹ️    - Diagnosis 2: ''
[16:36:26] ℹ️    - Diagnosis 3: ''
[16:36:26] ℹ️    - Diagnosis 4: ''
[16:36:26] ℹ️    - Diagnosis 5: ''
[16:36:26] ℹ️    - Diagnosis 6: ''
[16:36:26] ℹ️  Final extracted MRN: '2998670'
[16:36:26] ℹ️  Final extracted Sex: 'MALE'
[16:36:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:36:26] ℹ️  Final extracted Payer Source: ''
[16:36:26] ✅ Patient data extraction completed successfully
[16:36:26] ✅    ✅ Patient data extracted successfully
[16:36:26] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'I51.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:36:26] ✅    ✅ Patient identified: Raymond Souza
[16:36:26] ✅    ✅ Patient name validation passed
[16:36:26] 🔄 
🔄 Step 3: Processing patient dates...
[16:36:26] [DOC: 9217834] ℹ️  DOB normalized: 06/18/1927
[16:36:26] [DOC: 9217834] ℹ️  Episode startOfCare normalized: 03/31/2025
[16:36:26] [DOC: 9217834] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[16:36:26] [DOC: 9217834] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[16:36:26] [DOC: 9217834] ✅ Patient date processing completed successfully
[16:36:26] ✅    ✅ Date processing completed
[16:36:26] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'I51.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:36:26] 🔄 
🔄 Step 4: Extracting order data...
[16:36:29] ℹ️  Order extraction - MRN: '2998670'
[16:36:29] ℹ️  Order extraction - Sex: 'MALE'
[16:36:29] ℹ️  Order extraction - Service Line: 'RN'
[16:36:29] ℹ️  Order extraction - Payer Source: ''
[16:36:29] ✅ Order data extraction completed successfully
[16:36:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:36:29] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[16:36:29] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[16:36:29] ✅ Patient name cross-validation successful
[16:36:29] ✅    ✅ Data merged successfully
[16:36:30] ✅    ✅ Order data extracted and validated
[16:36:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:36:30] [DOC: 9217834] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:36:30] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:36:30] 🔄 
🔄 Step 6: Pushing order to API...
[16:36:30] [DOC: 9217834] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[16:36:32] [DOC: 9217834] ❌ Order push failed with status 201: {"id":"e86cb295-b7a7-4b94-8802-787aad3dbb20","orderWAVId":"ORD20070","orderNo":"1076913","orderDate":"03/31/2025","startOfCare":"03/31/2025","episodeStartDate":"03/31/2025","episodeEndDate":"06/28/2025","documentID":"9217834","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Certification of Terminal Illness","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:36:32] ❌    ❌ Failed to push order
[16:36:32] 🔄 
🔄 Step 7: Writing to CSV...
[16:36:32] [DOC: 9217834] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[16:36:32] [DOC: 9217834] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[16:36:32] [DOC: 9217834] ℹ️  Payer Source extracted: ''
[16:36:32] [DOC: 9217834] ℹ️  Diagnosis codes being written:
[16:36:32] [DOC: 9217834] ℹ️    - Latest_Episode_Firstdiagnosis: 'I51.9'
[16:36:32] [DOC: 9217834] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:36:32] [DOC: 9217834] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:36:32] [DOC: 9217834] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:36:32] [DOC: 9217834] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:36:32] [DOC: 9217834] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:36:32] [DOC: 9217834] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: RN, Skilled Nursing | Payer:  | MRN: 2998670
[16:36:32] ✅    ✅ Document 9217834 processed and saved successfully
[16:36:32] 🔄 
🔄 Step 8: Saving API details...
[16:36:32] [DOC: 9217834] ℹ️  API push details saved for document 9217834
[16:36:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217809                         ║
================================================================================
[16:36:32] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:36:32] ℹ️  Date: 04/02/2025
[16:36:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:36:35] [DOC: 9217809] ✅ Text extracted using pdfplumber (18269 chars)
[16:36:35] ✅    ✅ Text extracted using pdfplumber (18269 chars)
[16:36:35] 🔄 
🔄 Step 2: Extracting patient data...
[16:36:38] ℹ️  AI extracted raw sex value: 'F'
[16:36:38] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[16:36:38] ℹ️  AI extracted payer source: ''
[16:36:38] ℹ️  AI extracted diagnoses:
[16:36:38] ℹ️    - Diagnosis 1: 'Z48.3'
[16:36:38] ℹ️    - Diagnosis 2: 'Z48.03'
[16:36:38] ℹ️    - Diagnosis 3: 'C25.1'
[16:36:38] ℹ️    - Diagnosis 4: 'I81'
[16:36:38] ℹ️    - Diagnosis 5: 'E11.9'
[16:36:38] ℹ️    - Diagnosis 6: 'J45.909'
[16:36:38] ℹ️  Final extracted MRN: '2786868'
[16:36:38] ℹ️  Final extracted Sex: 'FEMALE'
[16:36:38] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[16:36:38] ℹ️  Final extracted Payer Source: ''
[16:36:38] ✅ Patient data extraction completed successfully
[16:36:38] ✅    ✅ Patient data extracted successfully
[16:36:38] 📊 Patient Response
     └─ patientFName: Carla
     └─ patientLName: Neno
     └─ dob: 08/28/1972
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2786868
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'Z48.3', 'secondDiagnosis': 'Z48.03', 'thirdDiagnosis': 'C25.1', 'fourthDiagnosis': 'I81', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'J45.909'}]
[16:36:38] ✅    ✅ Patient identified: Carla Neno
[16:36:38] ✅    ✅ Patient name validation passed
[16:36:38] 🔄 
🔄 Step 3: Processing patient dates...
[16:36:38] [DOC: 9217809] ℹ️  DOB normalized: 08/28/1972
[16:36:38] [DOC: 9217809] ℹ️  Episode startOfCare normalized: 03/26/2025
[16:36:38] [DOC: 9217809] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[16:36:38] [DOC: 9217809] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[16:36:38] [DOC: 9217809] ✅ Patient date processing completed successfully
[16:36:38] ✅    ✅ Date processing completed
[16:36:38] 📊 Processed Patient Data
     └─ patientFName: Carla
     └─ patientLName: Neno
     └─ dob: 08/28/1972
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2786868
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'Z48.3', 'secondDiagnosis': 'Z48.03', 'thirdDiagnosis': 'C25.1', 'fourthDiagnosis': 'I81', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'J45.909'}]
[16:36:38] 🔄 
🔄 Step 4: Extracting order data...
[16:36:41] ℹ️  Order extraction - MRN: '2786868'
[16:36:41] ℹ️  Order extraction - Sex: 'FEMALE'
[16:36:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing, HHA'
[16:36:41] ℹ️  Order extraction - Payer Source: ''
[16:36:41] ✅ Order data extraction completed successfully
[16:36:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:36:41] ℹ️  Using MRN from patient data: '2786868' over '2786868'
[16:36:41] ℹ️  Combined service lines: Patient='Skilled Nursing, Home Health Aide' + Order='Skilled Nursing, HHA' = 'HHA, Home Health Aide, Skilled Nursing'
[16:36:41] ✅ Patient name cross-validation successful
[16:36:41] ✅    ✅ Data merged successfully
[16:36:43] ✅    ✅ Order data extracted and validated
[16:36:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:36:48] [DOC: 9217809] ✅ Patient exists in API: Carla Neno, ID: f901925e-55a1-4244-b31e-99deea0fd644
[16:36:48] ✅    ✅ Existing patient found with ID: f901925e-55a1-4244-b31e-99deea0fd644
[16:36:48] 🔄 
🔄 Step 6: Pushing order to API...
[16:36:48] [DOC: 9217809] ℹ️  Pushing order via API for patient ID: f901925e-55a1-4244-b31e-99deea0fd644
[16:36:49] [DOC: 9217809] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13367"}
[16:36:49] ❌    ❌ Failed to push order
[16:36:49] 🔄 
🔄 Step 7: Writing to CSV...
[16:36:49] [DOC: 9217809] ℹ️  Calculated age: 52 from DOB: 08/28/1972
[16:36:49] [DOC: 9217809] ℹ️  Service Line extracted: 'HHA, Home Health Aide, Skilled Nursing'
[16:36:49] [DOC: 9217809] ℹ️  Payer Source extracted: ''
[16:36:49] [DOC: 9217809] ℹ️  Diagnosis codes being written:
[16:36:49] [DOC: 9217809] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.3'
[16:36:49] [DOC: 9217809] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z48.03'
[16:36:49] [DOC: 9217809] ℹ️    - Latest_Episode_Thirddiagnosis: 'C25.1'
[16:36:49] [DOC: 9217809] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I81'
[16:36:49] [DOC: 9217809] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.9'
[16:36:49] [DOC: 9217809] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J45.909'
[16:36:49] [DOC: 9217809] ✅ Patient data written to CSV: Carla Neno | Sex: FEMALE | Age: 52 | Service: HHA, Home Health Aide, Skilled Nursing | Payer:  | MRN: 2786868
[16:36:49] ✅    ✅ Document 9217809 processed and saved successfully
[16:36:49] 🔄 
🔄 Step 8: Saving API details...
[16:36:49] [DOC: 9217809] ℹ️  API push details saved for document 9217809
[16:36:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217798                         ║
================================================================================
[16:36:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:36:49] ℹ️  Date: 04/02/2025
[16:36:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:36:51] [DOC: 9217798] ✅ Text extracted using pdfplumber (2095 chars)
[16:36:51] ✅    ✅ Text extracted using pdfplumber (2095 chars)
[16:36:51] 🔄 
🔄 Step 2: Extracting patient data...
[16:36:53] ℹ️  AI extracted raw sex value: 'F'
[16:36:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:36:53] ℹ️  AI extracted payer source: ''
[16:36:53] ℹ️  AI extracted diagnoses:
[16:36:53] ℹ️    - Diagnosis 1: ''
[16:36:53] ℹ️    - Diagnosis 2: ''
[16:36:53] ℹ️    - Diagnosis 3: ''
[16:36:53] ℹ️    - Diagnosis 4: ''
[16:36:53] ℹ️    - Diagnosis 5: ''
[16:36:53] ℹ️    - Diagnosis 6: ''
[16:36:53] ℹ️  Final extracted MRN: '2761021'
[16:36:53] ℹ️  Final extracted Sex: 'FEMALE'
[16:36:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:36:53] ℹ️  Final extracted Payer Source: ''
[16:36:53] ✅ Patient data extraction completed successfully
[16:36:53] ✅    ✅ Patient data extracted successfully
[16:36:53] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:36:53] ✅    ✅ Patient identified: Theresa Moniz
[16:36:53] ✅    ✅ Patient name validation passed
[16:36:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:36:53] [DOC: 9217798] ℹ️  DOB normalized: 07/09/1956
[16:36:53] [DOC: 9217798] ✅ Patient date processing completed successfully
[16:36:53] ✅    ✅ Date processing completed
[16:36:53] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:36:53] 🔄 
🔄 Step 4: Extracting order data...
[16:36:56] ℹ️  Order extraction - MRN: '2761021'
[16:36:56] ℹ️  Order extraction - Sex: 'FEMALE'
[16:36:56] ℹ️  Order extraction - Service Line: ''
[16:36:56] ℹ️  Order extraction - Payer Source: ''
[16:36:56] ✅ Order data extraction completed successfully
[16:36:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:36:56] ℹ️  Using MRN from patient data: '2761021' over '2761021'
[16:36:56] ℹ️  Using service line from patient data: 'Skilled Nursing'
[16:36:56] ✅ Patient name cross-validation successful
[16:36:56] ✅    ✅ Data merged successfully
[16:36:57] ⚠️     ❌ Skipping - missing episode start date
[16:36:57] [DOC: 9217798] ℹ️  API push details saved for document 9217798
================================================================================
║                        Processing Document ID: 9217797                         ║
================================================================================
[16:36:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:36:57] ℹ️  Date: 04/02/2025
[16:36:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:36:58] [DOC: 9217797] ✅ Text extracted using pdfplumber (1769 chars)
[16:36:58] ✅    ✅ Text extracted using pdfplumber (1769 chars)
[16:36:58] 🔄 
🔄 Step 2: Extracting patient data...
[16:37:01] ℹ️  AI extracted raw sex value: 'M'
[16:37:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:37:01] ℹ️  AI extracted payer source: ''
[16:37:01] ℹ️  AI extracted diagnoses:
[16:37:01] ℹ️    - Diagnosis 1: ''
[16:37:01] ℹ️    - Diagnosis 2: ''
[16:37:01] ℹ️    - Diagnosis 3: ''
[16:37:01] ℹ️    - Diagnosis 4: ''
[16:37:01] ℹ️    - Diagnosis 5: ''
[16:37:01] ℹ️    - Diagnosis 6: ''
[16:37:01] ℹ️  Final extracted MRN: '3170225'
[16:37:01] ℹ️  Final extracted Sex: 'MALE'
[16:37:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:37:01] ℹ️  Final extracted Payer Source: ''
[16:37:01] ✅ Patient data extraction completed successfully
[16:37:01] ✅    ✅ Patient data extracted successfully
[16:37:01] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:37:01] ✅    ✅ Patient identified: Donald Maceachern
[16:37:01] ✅    ✅ Patient name validation passed
[16:37:01] 🔄 
🔄 Step 3: Processing patient dates...
[16:37:01] [DOC: 9217797] ℹ️  DOB normalized: 11/18/1939
[16:37:01] [DOC: 9217797] ✅ Patient date processing completed successfully
[16:37:01] ✅    ✅ Date processing completed
[16:37:01] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:37:01] 🔄 
🔄 Step 4: Extracting order data...
[16:37:03] ℹ️  Order extraction - MRN: '3170225'
[16:37:03] ℹ️  Order extraction - Sex: 'MALE'
[16:37:03] ℹ️  Order extraction - Service Line: ''
[16:37:03] ℹ️  Order extraction - Payer Source: ''
[16:37:03] ✅ Order data extraction completed successfully
[16:37:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:37:03] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[16:37:03] ℹ️  Using service line from patient data: 'Skilled Nursing'
[16:37:03] ✅ Patient name cross-validation successful
[16:37:03] ✅    ✅ Data merged successfully
[16:37:05] ⚠️     ❌ Skipping - missing episode start date
[16:37:05] [DOC: 9217797] ℹ️  API push details saved for document 9217797
================================================================================
║                        Processing Document ID: 9217794                         ║
================================================================================
[16:37:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:37:05] ℹ️  Date: 04/02/2025
[16:37:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:37:07] [DOC: 9217794] ✅ Text extracted using pdfplumber (6484 chars)
[16:37:07] ✅    ✅ Text extracted using pdfplumber (6484 chars)
[16:37:07] 🔄 
🔄 Step 2: Extracting patient data...
[16:37:10] ℹ️  AI extracted raw sex value: 'M'
[16:37:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:37:10] ℹ️  AI extracted payer source: ''
[16:37:10] ℹ️  AI extracted diagnoses:
[16:37:10] ℹ️    - Diagnosis 1: 'C92.10'
[16:37:10] ℹ️    - Diagnosis 2: ''
[16:37:10] ℹ️    - Diagnosis 3: ''
[16:37:10] ℹ️    - Diagnosis 4: ''
[16:37:10] ℹ️    - Diagnosis 5: ''
[16:37:10] ℹ️    - Diagnosis 6: ''
[16:37:10] ℹ️  Final extracted MRN: '3170225'
[16:37:10] ℹ️  Final extracted Sex: 'MALE'
[16:37:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:37:10] ℹ️  Final extracted Payer Source: ''
[16:37:10] ✅ Patient data extraction completed successfully
[16:37:10] ✅    ✅ Patient data extracted successfully
[16:37:10] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'C92.10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:37:10] ✅    ✅ Patient identified: Donald Maceachern
[16:37:10] ✅    ✅ Patient name validation passed
[16:37:10] 🔄 
🔄 Step 3: Processing patient dates...
[16:37:10] [DOC: 9217794] ℹ️  DOB normalized: 11/18/1939
[16:37:10] [DOC: 9217794] ℹ️  Episode startOfCare normalized: 04/01/2025
[16:37:10] [DOC: 9217794] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[16:37:10] [DOC: 9217794] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[16:37:10] [DOC: 9217794] ✅ Patient date processing completed successfully
[16:37:10] ✅    ✅ Date processing completed
[16:37:10] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'C92.10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:37:10] 🔄 
🔄 Step 4: Extracting order data...
[16:37:13] ℹ️  Order extraction - MRN: '3170225'
[16:37:13] ℹ️  Order extraction - Sex: 'MALE'
[16:37:13] ℹ️  Order extraction - Service Line: 'Hospice'
[16:37:13] ℹ️  Order extraction - Payer Source: ''
[16:37:13] ✅ Order data extraction completed successfully
[16:37:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:37:13] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[16:37:13] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Hospice' = 'Hospice, Skilled Nursing'
[16:37:13] ✅ Patient name cross-validation successful
[16:37:13] ✅    ✅ Data merged successfully
[16:37:14] ✅    ✅ Order data extracted and validated
[16:37:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:37:14] [DOC: 9217794] ✅ Patient found in local cache: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:37:14] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:37:14] 🔄 
🔄 Step 6: Pushing order to API...
[16:37:14] [DOC: 9217794] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[16:37:16] [DOC: 9217794] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13305"}
[16:37:16] ❌    ❌ Failed to push order
[16:37:16] 🔄 
🔄 Step 7: Writing to CSV...
[16:37:16] [DOC: 9217794] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[16:37:16] [DOC: 9217794] ℹ️  Service Line extracted: 'Hospice, Skilled Nursing'
[16:37:16] [DOC: 9217794] ℹ️  Payer Source extracted: ''
[16:37:16] [DOC: 9217794] ℹ️  Diagnosis codes being written:
[16:37:16] [DOC: 9217794] ℹ️    - Latest_Episode_Firstdiagnosis: 'C92.10'
[16:37:16] [DOC: 9217794] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:37:16] [DOC: 9217794] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:37:16] [DOC: 9217794] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:37:16] [DOC: 9217794] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:37:16] [DOC: 9217794] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:37:16] [DOC: 9217794] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service: Hospice, Skilled Nursing | Payer:  | MRN: 3170225
[16:37:16] ✅    ✅ Document 9217794 processed and saved successfully
[16:37:16] 🔄 
🔄 Step 8: Saving API details...
[16:37:16] [DOC: 9217794] ℹ️  API push details saved for document 9217794
[16:37:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217779                         ║
================================================================================
[16:37:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:37:16] ℹ️  Date: 04/02/2025
[16:37:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:37:18] [DOC: 9217779] ✅ Text extracted using pdfplumber (8757 chars)
[16:37:18] ✅    ✅ Text extracted using pdfplumber (8757 chars)
[16:37:18] 🔄 
🔄 Step 2: Extracting patient data...
[16:37:21] ℹ️  AI extracted raw sex value: 'F'
[16:37:21] ℹ️  AI extracted service line: 'Physical Therapy'
[16:37:21] ℹ️  AI extracted payer source: ''
[16:37:21] ℹ️  AI extracted diagnoses:
[16:37:21] ℹ️    - Diagnosis 1: 'I10'
[16:37:21] ℹ️    - Diagnosis 2: 'R79.89'
[16:37:21] ℹ️    - Diagnosis 3: 'R42'
[16:37:21] ℹ️    - Diagnosis 4: 'R26.81'
[16:37:21] ℹ️    - Diagnosis 5: 'E87.6'
[16:37:21] ℹ️    - Diagnosis 6: 'F41.1'
[16:37:21] ℹ️  Final extracted MRN: '2638113'
[16:37:21] ℹ️  Final extracted Sex: 'FEMALE'
[16:37:21] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:37:21] ℹ️  Final extracted Payer Source: ''
[16:37:21] ✅ Patient data extraction completed successfully
[16:37:21] ✅    ✅ Patient data extracted successfully
[16:37:21] 📊 Patient Response
     └─ patientFName: Gail
     └─ patientLName: Lapalme
     └─ dob: 11/18/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2638113
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R79.89', 'thirdDiagnosis': 'R42', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'F41.1'}]
[16:37:21] ✅    ✅ Patient identified: Gail Lapalme
[16:37:21] ✅    ✅ Patient name validation passed
[16:37:21] 🔄 
🔄 Step 3: Processing patient dates...
[16:37:21] [DOC: 9217779] ℹ️  DOB normalized: 11/18/1949
[16:37:21] [DOC: 9217779] ℹ️  Episode startOfCare normalized: 03/20/2025
[16:37:21] [DOC: 9217779] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:37:21] [DOC: 9217779] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:37:21] [DOC: 9217779] ✅ Patient date processing completed successfully
[16:37:21] ✅    ✅ Date processing completed
[16:37:21] 📊 Processed Patient Data
     └─ patientFName: Gail
     └─ patientLName: Lapalme
     └─ dob: 11/18/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2638113
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R79.89', 'thirdDiagnosis': 'R42', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'F41.1'}]
[16:37:21] 🔄 
🔄 Step 4: Extracting order data...
[16:37:24] ℹ️  Order extraction - MRN: '2638113'
[16:37:24] ℹ️  Order extraction - Sex: 'FEMALE'
[16:37:24] ℹ️  Order extraction - Service Line: 'PT'
[16:37:24] ℹ️  Order extraction - Payer Source: ''
[16:37:24] ✅ Order data extraction completed successfully
[16:37:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:37:24] ℹ️  Using MRN from patient data: '2638113' over '2638113'
[16:37:24] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[16:37:24] ✅ Patient name cross-validation successful
[16:37:24] ✅    ✅ Data merged successfully
[16:37:25] ✅    ✅ Order data extracted and validated
[16:37:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:38:08] [DOC: 9217779] ✅ Patient exists in API: Gail Lapalme, ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[16:38:08] ✅    ✅ Existing patient found with ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[16:38:08] 🔄 
🔄 Step 6: Pushing order to API...
[16:38:08] [DOC: 9217779] ℹ️  Pushing order via API for patient ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[16:38:09] [DOC: 9217779] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13201"}
[16:38:09] ❌    ❌ Failed to push order
[16:38:09] 🔄 
🔄 Step 7: Writing to CSV...
[16:38:09] [DOC: 9217779] ℹ️  Calculated age: 75 from DOB: 11/18/1949
[16:38:09] [DOC: 9217779] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[16:38:09] [DOC: 9217779] ℹ️  Payer Source extracted: ''
[16:38:09] [DOC: 9217779] ℹ️  Diagnosis codes being written:
[16:38:09] [DOC: 9217779] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[16:38:09] [DOC: 9217779] ℹ️    - Latest_Episode_Seconddiagnosis: 'R79.89'
[16:38:09] [DOC: 9217779] ℹ️    - Latest_Episode_Thirddiagnosis: 'R42'
[16:38:09] [DOC: 9217779] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R26.81'
[16:38:09] [DOC: 9217779] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E87.6'
[16:38:09] [DOC: 9217779] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.1'
[16:38:09] [DOC: 9217779] ✅ Patient data written to CSV: Gail Lapalme | Sex: FEMALE | Age: 75 | Service: PT, Physical Therapy | Payer:  | MRN: 2638113
[16:38:09] ✅    ✅ Document 9217779 processed and saved successfully
[16:38:09] 🔄 
🔄 Step 8: Saving API details...
[16:38:09] [DOC: 9217779] ℹ️  API push details saved for document 9217779
[16:38:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217773                         ║
================================================================================
[16:38:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:38:09] ℹ️  Date: 04/02/2025
[16:38:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:38:16] [DOC: 9217773] ✅ Text extracted using pdfplumber (32909 chars)
[16:38:16] ✅    ✅ Text extracted using pdfplumber (32909 chars)
[16:38:16] 🔄 
🔄 Step 2: Extracting patient data...
[16:38:19] ℹ️  AI extracted raw sex value: 'M'
[16:38:19] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, HHA'
[16:38:19] ℹ️  AI extracted payer source: ''
[16:38:19] ℹ️  AI extracted diagnoses:
[16:38:19] ℹ️    - Diagnosis 1: 'C34.90'
[16:38:19] ℹ️    - Diagnosis 2: 'C79.51'
[16:38:19] ℹ️    - Diagnosis 3: 'C34.92'
[16:38:19] ℹ️    - Diagnosis 4: 'R10.9'
[16:38:19] ℹ️    - Diagnosis 5: 'S22.32XS'
[16:38:19] ℹ️    - Diagnosis 6: 'I10'
[16:38:19] ℹ️  Final extracted MRN: '2611249'
[16:38:19] ℹ️  Final extracted Sex: 'MALE'
[16:38:19] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, HHA'
[16:38:19] ℹ️  Final extracted Payer Source: ''
[16:38:19] ✅ Patient data extraction completed successfully
[16:38:19] ✅    ✅ Patient data extracted successfully
[16:38:19] 📊 Patient Response
     └─ patientFName: Sobhy
     └─ patientLName: Kelada
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'C34.90', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'C34.92', 'fourthDiagnosis': 'R10.9', 'fifthDiagnosis': 'S22.32XS', 'sixthDiagnosis': 'I10'}]
[16:38:19] ✅    ✅ Patient identified: Sobhy Kelada
[16:38:19] ✅    ✅ Patient name validation passed
[16:38:19] 🔄 
🔄 Step 3: Processing patient dates...
[16:38:19] [DOC: 9217773] ℹ️  DOB normalized: 10/02/1947
[16:38:19] [DOC: 9217773] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[16:38:19] [DOC: 9217773] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[16:38:19] [DOC: 9217773] ✅ Patient date processing completed successfully
[16:38:19] ✅    ✅ Date processing completed
[16:38:19] 📊 Processed Patient Data
     └─ patientFName: Sobhy
     └─ patientLName: Kelada
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'C34.90', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'C34.92', 'fourthDiagnosis': 'R10.9', 'fifthDiagnosis': 'S22.32XS', 'sixthDiagnosis': 'I10'}]
[16:38:19] 🔄 
🔄 Step 4: Extracting order data...
[16:38:22] ℹ️  Order extraction - MRN: '2611249'
[16:38:22] ℹ️  Order extraction - Sex: 'MALE'
[16:38:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[16:38:22] ℹ️  Order extraction - Payer Source: ''
[16:38:22] ✅ Order data extraction completed successfully
[16:38:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:38:22] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[16:38:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, HHA'
[16:38:22] ✅ Patient name cross-validation successful
[16:38:22] ✅    ✅ Data merged successfully
[16:38:23] ✅    ✅ Order data extracted and validated
[16:38:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:38:29] [DOC: 9217773] ℹ️  Patient not found in cache or API: Sobhy Kelada
[16:38:29] [DOC: 9217773] ℹ️  Patient not found, creating new patient via API...
[16:38:29] [DOC: 9217773] ℹ️  Creating patient via API: Sobhy Kelada
[16:38:30] [DOC: 9217773] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:38:30] ❌    ❌ Failed to create patient
[16:38:30] [DOC: 9217773] ℹ️  API push details saved for document 9217773
================================================================================
║                        Processing Document ID: 9217766                         ║
================================================================================
[16:38:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:38:30] ℹ️  Date: 04/02/2025
[16:38:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:38:31] [DOC: 9217766] ✅ Text extracted using pdfplumber (1103 chars)
[16:38:31] ✅    ✅ Text extracted using pdfplumber (1103 chars)
[16:38:31] 🔄 
🔄 Step 2: Extracting patient data...
[16:38:34] ℹ️  AI extracted raw sex value: 'F'
[16:38:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:38:34] ℹ️  AI extracted payer source: ''
[16:38:34] ℹ️  AI extracted diagnoses:
[16:38:34] ℹ️    - Diagnosis 1: 'None'
[16:38:34] ℹ️    - Diagnosis 2: 'None'
[16:38:34] ℹ️    - Diagnosis 3: 'None'
[16:38:34] ℹ️    - Diagnosis 4: 'None'
[16:38:34] ℹ️    - Diagnosis 5: 'None'
[16:38:34] ℹ️    - Diagnosis 6: 'None'
[16:38:34] ℹ️  Final extracted MRN: '2075030'
[16:38:34] ℹ️  Final extracted Sex: 'FEMALE'
[16:38:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:38:34] ℹ️  Final extracted Payer Source: ''
[16:38:34] ✅ Patient data extraction completed successfully
[16:38:34] ✅    ✅ Patient data extracted successfully
[16:38:34] 📊 Patient Response
     └─ patientFName: Victoria
     └─ patientLName: Gintis
     └─ dob: 12/02/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2075030
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:38:34] ✅    ✅ Patient identified: Victoria Gintis
[16:38:34] ✅    ✅ Patient name validation passed
[16:38:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:38:34] [DOC: 9217766] ℹ️  DOB normalized: 12/02/1947
[16:38:34] [DOC: 9217766] ✅ Patient date processing completed successfully
[16:38:34] ✅    ✅ Date processing completed
[16:38:34] 📊 Processed Patient Data
     └─ patientFName: Victoria
     └─ patientLName: Gintis
     └─ dob: 12/02/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2075030
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[16:38:34] 🔄 
🔄 Step 4: Extracting order data...
[16:38:36] ℹ️  Order extraction - MRN: '2075030'
[16:38:36] ℹ️  Order extraction - Sex: 'FEMALE'
[16:38:36] ℹ️  Order extraction - Service Line: 'RN'
[16:38:36] ℹ️  Order extraction - Payer Source: ''
[16:38:36] ✅ Order data extraction completed successfully
[16:38:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:38:36] ℹ️  Using MRN from patient data: '2075030' over '2075030'
[16:38:36] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[16:38:36] ✅ Patient name cross-validation successful
[16:38:36] ✅    ✅ Data merged successfully
[16:38:38] ✅    ✅ Order data extracted and validated
[16:38:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:38:52] [DOC: 9217766] ℹ️  Patient not found in cache or API: Victoria Gintis
[16:38:52] [DOC: 9217766] ℹ️  Patient not found, creating new patient via API...
[16:38:52] [DOC: 9217766] ℹ️  Creating patient via API: Victoria Gintis
[16:38:53] [DOC: 9217766] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:38:53] ❌    ❌ Failed to create patient
[16:38:53] [DOC: 9217766] ℹ️  API push details saved for document 9217766
================================================================================
║                        Processing Document ID: 9217758                         ║
================================================================================
[16:38:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:38:53] ℹ️  Date: 04/02/2025
[16:38:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:38:55] [DOC: 9217758] ✅ Text extracted using pdfplumber (13536 chars)
[16:38:55] ✅    ✅ Text extracted using pdfplumber (13536 chars)
[16:38:55] 🔄 
🔄 Step 2: Extracting patient data...
[16:38:59] ℹ️  AI extracted raw sex value: 'M'
[16:38:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:38:59] ℹ️  AI extracted payer source: ''
[16:38:59] ℹ️  AI extracted diagnoses:
[16:38:59] ℹ️    - Diagnosis 1: 'E11.621'
[16:38:59] ℹ️    - Diagnosis 2: 'L97.523'
[16:38:59] ℹ️    - Diagnosis 3: 'L03.116'
[16:38:59] ℹ️    - Diagnosis 4: 'E11.69'
[16:38:59] ℹ️    - Diagnosis 5: 'M86.172'
[16:38:59] ℹ️    - Diagnosis 6: 'E11.65'
[16:38:59] ℹ️  Final extracted MRN: '2149660'
[16:38:59] ℹ️  Final extracted Sex: 'MALE'
[16:38:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:38:59] ℹ️  Final extracted Payer Source: ''
[16:38:59] ✅ Patient data extraction completed successfully
[16:38:59] ✅    ✅ Patient data extracted successfully
[16:38:59] 📊 Patient Response
     └─ patientFName: Scott
     └─ patientLName: Fonseca
     └─ dob: 12/30/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 2149660
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'E11.621', 'secondDiagnosis': 'L97.523', 'thirdDiagnosis': 'L03.116', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'M86.172', 'sixthDiagnosis': 'E11.65'}]
[16:38:59] ✅    ✅ Patient identified: Scott Fonseca
[16:38:59] ✅    ✅ Patient name validation passed
[16:38:59] 🔄 
🔄 Step 3: Processing patient dates...
[16:38:59] [DOC: 9217758] ℹ️  DOB normalized: 12/30/1980
[16:38:59] [DOC: 9217758] ℹ️  Episode startOfCare normalized: 03/27/2025
[16:38:59] [DOC: 9217758] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[16:38:59] [DOC: 9217758] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[16:38:59] [DOC: 9217758] ✅ Patient date processing completed successfully
[16:38:59] ✅    ✅ Date processing completed
[16:38:59] 📊 Processed Patient Data
     └─ patientFName: Scott
     └─ patientLName: Fonseca
     └─ dob: 12/30/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 2149660
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'E11.621', 'secondDiagnosis': 'L97.523', 'thirdDiagnosis': 'L03.116', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'M86.172', 'sixthDiagnosis': 'E11.65'}]
[16:38:59] 🔄 
🔄 Step 4: Extracting order data...
[16:39:02] ℹ️  Order extraction - MRN: '2149660'
[16:39:02] ℹ️  Order extraction - Sex: 'MALE'
[16:39:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:39:02] ℹ️  Order extraction - Payer Source: ''
[16:39:02] ✅ Order data extraction completed successfully
[16:39:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:39:02] ℹ️  Using MRN from patient data: '2149660' over '2149660'
[16:39:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:39:02] ✅ Patient name cross-validation successful
[16:39:02] ✅    ✅ Data merged successfully
[16:39:03] ✅    ✅ Order data extracted and validated
[16:39:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:39:32] [DOC: 9217758] ✅ Patient exists in API: Scott Fonseca, ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[16:39:32] ✅    ✅ Existing patient found with ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[16:39:32] 🔄 
🔄 Step 6: Pushing order to API...
[16:39:32] [DOC: 9217758] ℹ️  Pushing order via API for patient ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[16:39:33] [DOC: 9217758] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14092"}
[16:39:33] ❌    ❌ Failed to push order
[16:39:33] 🔄 
🔄 Step 7: Writing to CSV...
[16:39:33] [DOC: 9217758] ℹ️  Calculated age: 44 from DOB: 12/30/1980
[16:39:33] [DOC: 9217758] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:39:33] [DOC: 9217758] ℹ️  Payer Source extracted: ''
[16:39:33] [DOC: 9217758] ℹ️  Diagnosis codes being written:
[16:39:33] [DOC: 9217758] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.621'
[16:39:33] [DOC: 9217758] ℹ️    - Latest_Episode_Seconddiagnosis: 'L97.523'
[16:39:33] [DOC: 9217758] ℹ️    - Latest_Episode_Thirddiagnosis: 'L03.116'
[16:39:33] [DOC: 9217758] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.69'
[16:39:33] [DOC: 9217758] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M86.172'
[16:39:33] [DOC: 9217758] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.65'
[16:39:33] [DOC: 9217758] ✅ Patient data written to CSV: Scott Fonseca | Sex: MALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 2149660
[16:39:33] ✅    ✅ Document 9217758 processed and saved successfully
[16:39:33] 🔄 
🔄 Step 8: Saving API details...
[16:39:33] [DOC: 9217758] ℹ️  API push details saved for document 9217758
[16:39:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217751                         ║
================================================================================
[16:39:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:39:33] ℹ️  Date: 04/02/2025
[16:39:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:39:35] [DOC: 9217751] ✅ Text extracted using pdfplumber (1512 chars)
[16:39:35] ✅    ✅ Text extracted using pdfplumber (1512 chars)
[16:39:35] 🔄 
🔄 Step 2: Extracting patient data...
[16:39:37] ℹ️  AI extracted raw sex value: 'F'
[16:39:37] ℹ️  AI extracted service line: 'RN'
[16:39:37] ℹ️  AI extracted payer source: ''
[16:39:37] ℹ️  AI extracted diagnoses:
[16:39:37] ℹ️    - Diagnosis 1: ''
[16:39:37] ℹ️    - Diagnosis 2: ''
[16:39:37] ℹ️    - Diagnosis 3: ''
[16:39:37] ℹ️    - Diagnosis 4: ''
[16:39:37] ℹ️    - Diagnosis 5: ''
[16:39:37] ℹ️    - Diagnosis 6: ''
[16:39:37] ℹ️  Final extracted MRN: '2461998'
[16:39:37] ℹ️  Final extracted Sex: 'FEMALE'
[16:39:37] ℹ️  Final extracted Service Line: 'RN'
[16:39:37] ℹ️  Final extracted Payer Source: ''
[16:39:37] ✅ Patient data extraction completed successfully
[16:39:37] ✅    ✅ Patient data extracted successfully
[16:39:37] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:39:37] ✅    ✅ Patient identified: Dolores Fernandes
[16:39:37] ✅    ✅ Patient name validation passed
[16:39:37] 🔄 
🔄 Step 3: Processing patient dates...
[16:39:37] [DOC: 9217751] ℹ️  DOB normalized: 08/26/1931
[16:39:37] [DOC: 9217751] ✅ Patient date processing completed successfully
[16:39:37] ✅    ✅ Date processing completed
[16:39:37] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:39:37] 🔄 
🔄 Step 4: Extracting order data...
[16:39:40] ℹ️  Order extraction - MRN: '2461998'
[16:39:40] ℹ️  Order extraction - Sex: 'FEMALE'
[16:39:40] ℹ️  Order extraction - Service Line: ''
[16:39:40] ℹ️  Order extraction - Payer Source: ''
[16:39:40] ✅ Order data extraction completed successfully
[16:39:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:39:40] ℹ️  Using MRN from patient data: '2461998' over '2461998'
[16:39:40] ℹ️  Using service line from patient data: 'RN'
[16:39:40] ✅ Patient name cross-validation successful
[16:39:40] ✅    ✅ Data merged successfully
[16:39:41] ⚠️     ❌ Skipping - missing episode start date
[16:39:41] [DOC: 9217751] ℹ️  API push details saved for document 9217751
================================================================================
║                        Processing Document ID: 9217746                         ║
================================================================================
[16:39:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:39:41] ℹ️  Date: 04/02/2025
[16:39:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:39:48] [DOC: 9217746] ✅ Text extracted using pdfplumber (20101 chars)
[16:39:48] ✅    ✅ Text extracted using pdfplumber (20101 chars)
[16:39:48] 🔄 
🔄 Step 2: Extracting patient data...
[16:39:51] ℹ️  AI extracted raw sex value: 'F'
[16:39:51] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:39:51] ℹ️  AI extracted payer source: ''
[16:39:51] ℹ️  AI extracted diagnoses:
[16:39:51] ℹ️    - Diagnosis 1: 'S52.502D'
[16:39:51] ℹ️    - Diagnosis 2: 'W19.XXXD'
[16:39:51] ℹ️    - Diagnosis 3: 'E11.9'
[16:39:51] ℹ️    - Diagnosis 4: 'E06.3'
[16:39:51] ℹ️    - Diagnosis 5: 'Z86.73'
[16:39:51] ℹ️    - Diagnosis 6: 'Z79.84'
[16:39:51] ℹ️  Final extracted MRN: '2420800'
[16:39:51] ℹ️  Final extracted Sex: 'FEMALE'
[16:39:51] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:39:51] ℹ️  Final extracted Payer Source: ''
[16:39:51] ✅ Patient data extraction completed successfully
[16:39:51] ✅    ✅ Patient data extracted successfully
[16:39:51] 📊 Patient Response
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S52.502D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'E06.3', 'fifthDiagnosis': 'Z86.73', 'sixthDiagnosis': 'Z79.84'}]
[16:39:51] ✅    ✅ Patient identified: Sally Dobson
[16:39:51] ✅    ✅ Patient name validation passed
[16:39:51] 🔄 
🔄 Step 3: Processing patient dates...
[16:39:51] [DOC: 9217746] ℹ️  DOB normalized: 09/19/1941
[16:39:51] [DOC: 9217746] ℹ️  Episode startOfCare normalized: 03/21/2025
[16:39:51] [DOC: 9217746] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:39:51] [DOC: 9217746] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:39:51] [DOC: 9217746] ✅ Patient date processing completed successfully
[16:39:51] ✅    ✅ Date processing completed
[16:39:51] 📊 Processed Patient Data
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S52.502D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'E06.3', 'fifthDiagnosis': 'Z86.73', 'sixthDiagnosis': 'Z79.84'}]
[16:39:51] 🔄 
🔄 Step 4: Extracting order data...
[16:39:54] ℹ️  Order extraction - MRN: '2420800'
[16:39:54] ℹ️  Order extraction - Sex: 'FEMALE'
[16:39:54] ℹ️  Order extraction - Service Line: 'Physical Therapy,Occupational Therapy,Home Health Aide,Skilled Nursing'
[16:39:54] ℹ️  Order extraction - Payer Source: ''
[16:39:54] ✅ Order data extraction completed successfully
[16:39:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:39:54] ℹ️  Using MRN from patient data: '2420800' over '2420800'
[16:39:54] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Physical Therapy,Occupational Therapy,Home Health Aide,Skilled Nursing' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[16:39:54] ✅ Patient name cross-validation successful
[16:39:54] ✅    ✅ Data merged successfully
[16:39:56] ✅    ✅ Order data extracted and validated
[16:39:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:40:00] [DOC: 9217746] ℹ️  Patient not found in cache or API: Sally Dobson
[16:40:00] [DOC: 9217746] ℹ️  Patient not found, creating new patient via API...
[16:40:00] [DOC: 9217746] ℹ️  Creating patient via API: Sally Dobson
[16:40:01] [DOC: 9217746] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:40:01] ❌    ❌ Failed to create patient
[16:40:01] [DOC: 9217746] ℹ️  API push details saved for document 9217746
================================================================================
║                        Processing Document ID: 9217741                         ║
================================================================================
[16:40:01] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:40:01] ℹ️  Date: 04/02/2025
[16:40:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:40:03] [DOC: 9217741] ✅ Text extracted using pdfplumber (948 chars)
[16:40:03] ✅    ✅ Text extracted using pdfplumber (948 chars)
[16:40:03] 🔄 
🔄 Step 2: Extracting patient data...
[16:40:06] ℹ️  AI extracted raw sex value: 'F'
[16:40:06] ℹ️  AI extracted service line: 'Nursing'
[16:40:06] ℹ️  AI extracted payer source: ''
[16:40:06] ℹ️  AI extracted diagnoses:
[16:40:06] ℹ️    - Diagnosis 1: ''
[16:40:06] ℹ️    - Diagnosis 2: ''
[16:40:06] ℹ️    - Diagnosis 3: ''
[16:40:06] ℹ️    - Diagnosis 4: ''
[16:40:06] ℹ️    - Diagnosis 5: ''
[16:40:06] ℹ️    - Diagnosis 6: ''
[16:40:06] ℹ️  Final extracted MRN: '2301138'
[16:40:06] ℹ️  Final extracted Sex: 'FEMALE'
[16:40:06] ℹ️  Final extracted Service Line: 'Nursing'
[16:40:06] ℹ️  Final extracted Payer Source: ''
[16:40:06] ✅ Patient data extraction completed successfully
[16:40:06] ✅    ✅ Patient data extracted successfully
[16:40:06] 📊 Patient Response
     └─ patientFName: Regina
     └─ patientLName: Capela
     └─ dob: 11/24/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2301138
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:06] ✅    ✅ Patient identified: Regina Capela
[16:40:06] ✅    ✅ Patient name validation passed
[16:40:06] 🔄 
🔄 Step 3: Processing patient dates...
[16:40:06] [DOC: 9217741] ℹ️  DOB normalized: 11/24/1943
[16:40:06] [DOC: 9217741] ✅ Patient date processing completed successfully
[16:40:06] ✅    ✅ Date processing completed
[16:40:06] 📊 Processed Patient Data
     └─ patientFName: Regina
     └─ patientLName: Capela
     └─ dob: 11/24/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2301138
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:06] 🔄 
🔄 Step 4: Extracting order data...
[16:40:08] ℹ️  Order extraction - MRN: '2301138'
[16:40:08] ℹ️  Order extraction - Sex: 'FEMALE'
[16:40:08] ℹ️  Order extraction - Service Line: ''
[16:40:08] ℹ️  Order extraction - Payer Source: ''
[16:40:08] ✅ Order data extraction completed successfully
[16:40:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:40:08] ℹ️  Using MRN from patient data: '2301138' over '2301138'
[16:40:08] ℹ️  Using service line from patient data: 'Nursing'
[16:40:08] ✅ Patient name cross-validation successful
[16:40:08] ✅    ✅ Data merged successfully
[16:40:09] ⚠️     ❌ Skipping - missing episode start date
[16:40:09] [DOC: 9217741] ℹ️  API push details saved for document 9217741
================================================================================
║                        Processing Document ID: 9217273                         ║
================================================================================
[16:40:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:40:09] ℹ️  Date: 04/02/2025
[16:40:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:40:10] [DOC: 9217273] ✅ Text extracted using pdfplumber (936 chars)
[16:40:10] ✅    ✅ Text extracted using pdfplumber (936 chars)
[16:40:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:40:13] ℹ️  AI extracted raw sex value: 'F'
[16:40:13] ℹ️  AI extracted service line: 'Nursing'
[16:40:13] ℹ️  AI extracted payer source: ''
[16:40:13] ℹ️  AI extracted diagnoses:
[16:40:13] ℹ️    - Diagnosis 1: ''
[16:40:13] ℹ️    - Diagnosis 2: ''
[16:40:13] ℹ️    - Diagnosis 3: ''
[16:40:13] ℹ️    - Diagnosis 4: ''
[16:40:13] ℹ️    - Diagnosis 5: ''
[16:40:13] ℹ️    - Diagnosis 6: ''
[16:40:13] ℹ️  Final extracted MRN: '2104569'
[16:40:13] ℹ️  Final extracted Sex: 'FEMALE'
[16:40:13] ℹ️  Final extracted Service Line: 'Nursing'
[16:40:13] ℹ️  Final extracted Payer Source: ''
[16:40:13] ✅ Patient data extraction completed successfully
[16:40:13] ✅    ✅ Patient data extracted successfully
[16:40:13] 📊 Patient Response
     └─ patientFName: Francine
     └─ patientLName: Tavares
     └─ dob: 12/21/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104569
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:13] ✅    ✅ Patient identified: Francine Tavares
[16:40:13] ✅    ✅ Patient name validation passed
[16:40:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:40:13] [DOC: 9217273] ℹ️  DOB normalized: 12/21/1939
[16:40:13] [DOC: 9217273] ✅ Patient date processing completed successfully
[16:40:13] ✅    ✅ Date processing completed
[16:40:13] 📊 Processed Patient Data
     └─ patientFName: Francine
     └─ patientLName: Tavares
     └─ dob: 12/21/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104569
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:13] 🔄 
🔄 Step 4: Extracting order data...
[16:40:15] ℹ️  Order extraction - MRN: '2104569'
[16:40:15] ℹ️  Order extraction - Sex: 'FEMALE'
[16:40:15] ℹ️  Order extraction - Service Line: 'Nursing'
[16:40:15] ℹ️  Order extraction - Payer Source: ''
[16:40:15] ✅ Order data extraction completed successfully
[16:40:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:40:15] ℹ️  Using MRN from patient data: '2104569' over '2104569'
[16:40:15] ℹ️  Service line consistent in both sources: 'Nursing'
[16:40:15] ✅ Patient name cross-validation successful
[16:40:15] ✅    ✅ Data merged successfully
[16:40:17] ⚠️     ❌ Skipping - missing episode start date
[16:40:17] [DOC: 9217273] ℹ️  API push details saved for document 9217273
================================================================================
║                        Processing Document ID: 9217233                         ║
================================================================================
[16:40:17] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:40:17] ℹ️  Date: 04/02/2025
[16:40:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:40:19] [DOC: 9217233] ✅ Text extracted using pdfplumber (1155 chars)
[16:40:19] ✅    ✅ Text extracted using pdfplumber (1155 chars)
[16:40:19] 🔄 
🔄 Step 2: Extracting patient data...
[16:40:22] ℹ️  AI extracted raw sex value: 'M'
[16:40:22] ℹ️  AI extracted service line: 'RN'
[16:40:22] ℹ️  AI extracted payer source: 'Medicaid/MA'
[16:40:22] ℹ️  AI extracted diagnoses:
[16:40:22] ℹ️    - Diagnosis 1: ''
[16:40:22] ℹ️    - Diagnosis 2: ''
[16:40:22] ℹ️    - Diagnosis 3: ''
[16:40:22] ℹ️    - Diagnosis 4: ''
[16:40:22] ℹ️    - Diagnosis 5: ''
[16:40:22] ℹ️    - Diagnosis 6: ''
[16:40:22] ℹ️  Final extracted MRN: '36004'
[16:40:22] ℹ️  Final extracted Sex: 'MALE'
[16:40:22] ℹ️  Final extracted Service Line: 'RN'
[16:40:22] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[16:40:22] ✅ Patient data extraction completed successfully
[16:40:22] ✅    ✅ Patient data extracted successfully
[16:40:22] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Leary
     └─ dob: 10/27/1963
     └─ patientSex: MALE
     └─ medicalRecordNo: 36004
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/23/2016', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:22] ✅    ✅ Patient identified: William Leary
[16:40:22] ✅    ✅ Patient name validation passed
[16:40:22] 🔄 
🔄 Step 3: Processing patient dates...
[16:40:22] [DOC: 9217233] ℹ️  DOB normalized: 10/27/1963
[16:40:22] [DOC: 9217233] ℹ️  Episode startOfCare normalized: 11/23/2016
[16:40:22] [DOC: 9217233] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[16:40:22] [DOC: 9217233] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[16:40:22] [DOC: 9217233] ✅ Patient date processing completed successfully
[16:40:22] ✅    ✅ Date processing completed
[16:40:22] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Leary
     └─ dob: 10/27/1963
     └─ patientSex: MALE
     └─ medicalRecordNo: 36004
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/23/2016', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:22] 🔄 
🔄 Step 4: Extracting order data...
[16:40:25] ℹ️  Order extraction - MRN: '36004'
[16:40:25] ℹ️  Order extraction - Sex: 'MALE'
[16:40:25] ℹ️  Order extraction - Service Line: ''
[16:40:25] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[16:40:25] ✅ Order data extraction completed successfully
[16:40:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:40:25] ℹ️  Using MRN from patient data: '36004' over '36004'
[16:40:25] ℹ️  Using service line from patient data: 'RN'
[16:40:25] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[16:40:25] ✅ Patient name cross-validation successful
[16:40:25] ✅    ✅ Data merged successfully
[16:40:26] ✅    ✅ Order data extracted and validated
[16:40:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:40:26] [DOC: 9217233] ✅ Patient found in local cache: William Leary, ID: 6fc2c40a-61bd-498d-946a-7c0987cdbb37
[16:40:26] ✅    ✅ Existing patient found with ID: 6fc2c40a-61bd-498d-946a-7c0987cdbb37
[16:40:26] 🔄 
🔄 Step 6: Pushing order to API...
[16:40:26] [DOC: 9217233] ℹ️  Pushing order via API for patient ID: 6fc2c40a-61bd-498d-946a-7c0987cdbb37
[16:40:28] [DOC: 9217233] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:40:28] ❌    ❌ Failed to push order
[16:40:28] 🔄 
🔄 Step 7: Writing to CSV...
[16:40:28] [DOC: 9217233] ℹ️  Calculated age: 61 from DOB: 10/27/1963
[16:40:28] [DOC: 9217233] ℹ️  Service Line extracted: 'RN'
[16:40:28] [DOC: 9217233] ℹ️  Payer Source extracted: 'Medicaid/MA'
[16:40:28] [DOC: 9217233] ℹ️  Diagnosis codes being written:
[16:40:28] [DOC: 9217233] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:40:28] [DOC: 9217233] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:40:28] [DOC: 9217233] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:40:28] [DOC: 9217233] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:40:28] [DOC: 9217233] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:40:28] [DOC: 9217233] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:40:28] [DOC: 9217233] ✅ Patient data written to CSV: William Leary | Sex: MALE | Age: 61 | Service: RN | Payer: Medicaid/MA | MRN: 36004
[16:40:28] ✅    ✅ Document 9217233 processed and saved successfully
[16:40:28] 🔄 
🔄 Step 8: Saving API details...
[16:40:28] [DOC: 9217233] ℹ️  API push details saved for document 9217233
[16:40:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217194                         ║
================================================================================
[16:40:28] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:40:28] ℹ️  Date: 04/02/2025
[16:40:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:40:30] [DOC: 9217194] ✅ Text extracted using pdfplumber (1335 chars)
[16:40:30] ✅    ✅ Text extracted using pdfplumber (1335 chars)
[16:40:30] 🔄 
🔄 Step 2: Extracting patient data...
[16:40:33] ℹ️  AI extracted raw sex value: 'M'
[16:40:33] ℹ️  AI extracted service line: 'HHA'
[16:40:33] ℹ️  AI extracted payer source: 'Medicaid/MA'
[16:40:33] ℹ️  AI extracted diagnoses:
[16:40:33] ℹ️    - Diagnosis 1: ''
[16:40:33] ℹ️    - Diagnosis 2: ''
[16:40:33] ℹ️    - Diagnosis 3: ''
[16:40:33] ℹ️    - Diagnosis 4: ''
[16:40:33] ℹ️    - Diagnosis 5: ''
[16:40:33] ℹ️    - Diagnosis 6: ''
[16:40:33] ℹ️  Final extracted MRN: '343005'
[16:40:33] ℹ️  Final extracted Sex: 'MALE'
[16:40:33] ℹ️  Final extracted Service Line: 'HHA'
[16:40:33] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[16:40:33] ✅ Patient data extraction completed successfully
[16:40:33] ✅    ✅ Patient data extracted successfully
[16:40:33] 📊 Patient Response
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Karine A Maalouf-Kaleshian, MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:33] ✅    ✅ Patient identified: Kevin Livramento
[16:40:33] ✅    ✅ Patient name validation passed
[16:40:33] 🔄 
🔄 Step 3: Processing patient dates...
[16:40:33] [DOC: 9217194] ℹ️  DOB normalized: 08/25/1966
[16:40:33] [DOC: 9217194] ℹ️  Episode startOfCare normalized: 09/27/2022
[16:40:33] [DOC: 9217194] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[16:40:33] [DOC: 9217194] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[16:40:33] [DOC: 9217194] ✅ Patient date processing completed successfully
[16:40:33] ✅    ✅ Date processing completed
[16:40:33] 📊 Processed Patient Data
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Karine A Maalouf-Kaleshian, MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:33] 🔄 
🔄 Step 4: Extracting order data...
[16:40:35] ℹ️  Order extraction - MRN: '343005'
[16:40:35] ℹ️  Order extraction - Sex: 'MALE'
[16:40:35] ℹ️  Order extraction - Service Line: 'HHA'
[16:40:35] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[16:40:35] ✅ Order data extraction completed successfully
[16:40:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:40:35] ℹ️  Using MRN from patient data: '343005' over '343005'
[16:40:35] ℹ️  Service line consistent in both sources: 'HHA'
[16:40:35] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[16:40:35] ✅ Patient name cross-validation successful
[16:40:35] ✅    ✅ Data merged successfully
[16:40:37] ✅    ✅ Order data extracted and validated
[16:40:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:40:37] [DOC: 9217194] ✅ Patient found in local cache: Kevin Livramento, ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[16:40:37] ✅    ✅ Existing patient found with ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[16:40:37] 🔄 
🔄 Step 6: Pushing order to API...
[16:40:37] [DOC: 9217194] ℹ️  Pushing order via API for patient ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[16:40:38] [DOC: 9217194] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:40:38] ❌    ❌ Failed to push order
[16:40:38] 🔄 
🔄 Step 7: Writing to CSV...
[16:40:38] [DOC: 9217194] ℹ️  Calculated age: 58 from DOB: 08/25/1966
[16:40:38] [DOC: 9217194] ℹ️  Service Line extracted: 'HHA'
[16:40:38] [DOC: 9217194] ℹ️  Payer Source extracted: 'Medicaid/MA'
[16:40:38] [DOC: 9217194] ℹ️  Diagnosis codes being written:
[16:40:38] [DOC: 9217194] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:40:38] [DOC: 9217194] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:40:38] [DOC: 9217194] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:40:38] [DOC: 9217194] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:40:38] [DOC: 9217194] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:40:38] [DOC: 9217194] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:40:38] [DOC: 9217194] ✅ Patient data written to CSV: Kevin Livramento | Sex: MALE | Age: 58 | Service: HHA | Payer: Medicaid/MA | MRN: 343005
[16:40:38] ✅    ✅ Document 9217194 processed and saved successfully
[16:40:38] 🔄 
🔄 Step 8: Saving API details...
[16:40:38] [DOC: 9217194] ℹ️  API push details saved for document 9217194
[16:40:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217087                         ║
================================================================================
[16:40:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:40:38] ℹ️  Date: 04/02/2025
[16:40:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:40:40] [DOC: 9217087] ✅ Text extracted using pdfplumber (1427 chars)
[16:40:40] ✅    ✅ Text extracted using pdfplumber (1415 chars)
[16:40:40] 🔄 
🔄 Step 2: Extracting patient data...
[16:40:43] ℹ️  AI extracted raw sex value: ''
[16:40:43] ℹ️  AI extracted service line: 'Home Health Aide'
[16:40:43] ℹ️  AI extracted payer source: ''
[16:40:43] ℹ️  AI extracted diagnoses:
[16:40:43] ℹ️    - Diagnosis 1: 'S02.2XX'
[16:40:43] ℹ️    - Diagnosis 2: 'S01.81X'
[16:40:43] ℹ️    - Diagnosis 3: 'E03.9'
[16:40:43] ℹ️    - Diagnosis 4: ''
[16:40:43] ℹ️    - Diagnosis 5: ''
[16:40:43] ℹ️    - Diagnosis 6: ''
[16:40:43] ℹ️  Final extracted MRN: 'MA241009113701'
[16:40:43] ℹ️  Final extracted Sex: ''
[16:40:43] ℹ️  Final extracted Service Line: 'Home Health Aide'
[16:40:43] ℹ️  Final extracted Payer Source: ''
[16:40:43] ✅ Patient data extraction completed successfully
[16:40:43] ✅    ✅ Patient data extracted successfully
[16:40:43] 📊 Patient Response
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:43] ✅    ✅ Patient identified: Maria Ines Figueiredo
[16:40:43] ✅    ✅ Patient name validation passed
[16:40:43] 🔄 
🔄 Step 3: Processing patient dates...
[16:40:43] [DOC: 9217087] ℹ️  DOB normalized: 11/11/1937
[16:40:43] [DOC: 9217087] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:40:43] [DOC: 9217087] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:40:43] [DOC: 9217087] ✅ Patient date processing completed successfully
[16:40:43] ✅    ✅ Date processing completed
[16:40:43] 📊 Processed Patient Data
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:43] 🔄 
🔄 Step 4: Extracting order data...
[16:40:46] ℹ️  Order extraction - MRN: 'MA241009113701'
[16:40:46] ℹ️  Order extraction - Sex: ''
[16:40:46] ℹ️  Order extraction - Service Line: 'HHA'
[16:40:46] ℹ️  Order extraction - Payer Source: ''
[16:40:46] ✅ Order data extraction completed successfully
[16:40:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:40:46] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[16:40:46] ⚠️  Could not determine sex using any available method
[16:40:46] ℹ️  Combined service lines: Patient='Home Health Aide' + Order='HHA' = 'HHA, Home Health Aide'
[16:40:46] ✅ Patient name cross-validation successful
[16:40:46] ✅    ✅ Data merged successfully
[16:40:47] ✅    ✅ Order data extracted and validated
[16:40:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:40:47] [DOC: 9217087] ✅ Patient found in local cache: Maria Ines Figueiredo, ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:40:47] ✅    ✅ Existing patient found with ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:40:47] 🔄 
🔄 Step 6: Pushing order to API...
[16:40:47] [DOC: 9217087] ℹ️  Pushing order via API for patient ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:40:48] [DOC: 9217087] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14044"}
[16:40:48] ❌    ❌ Failed to push order
[16:40:48] 🔄 
🔄 Step 7: Writing to CSV...
[16:40:48] [DOC: 9217087] ℹ️  Calculated age: 87 from DOB: 11/11/1937
[16:40:48] [DOC: 9217087] ℹ️  Service Line extracted: 'HHA, Home Health Aide'
[16:40:48] [DOC: 9217087] ℹ️  Payer Source extracted: ''
[16:40:48] [DOC: 9217087] ℹ️  Diagnosis codes being written:
[16:40:48] [DOC: 9217087] ℹ️    - Latest_Episode_Firstdiagnosis: 'S02.2XX'
[16:40:48] [DOC: 9217087] ℹ️    - Latest_Episode_Seconddiagnosis: 'S01.81X'
[16:40:48] [DOC: 9217087] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[16:40:48] [DOC: 9217087] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:40:48] [DOC: 9217087] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:40:48] [DOC: 9217087] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:40:48] [DOC: 9217087] ✅ Patient data written to CSV: Maria Ines Figueiredo | Sex:  | Age: 87 | Service: HHA, Home Health Aide | Payer:  | MRN: MA241009113701
[16:40:48] ✅    ✅ Document 9217087 processed and saved successfully
[16:40:48] 🔄 
🔄 Step 8: Saving API details...
[16:40:48] [DOC: 9217087] ℹ️  API push details saved for document 9217087
[16:40:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217084                         ║
================================================================================
[16:40:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:40:48] ℹ️  Date: 04/02/2025
[16:40:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:40:51] [DOC: 9217084] ✅ Text extracted using pdfplumber (1542 chars)
[16:40:51] ✅    ✅ Text extracted using pdfplumber (1530 chars)
[16:40:51] 🔄 
🔄 Step 2: Extracting patient data...
[16:40:54] ℹ️  AI extracted raw sex value: ''
[16:40:54] ℹ️  AI extracted service line: 'Physical Therapy'
[16:40:54] ℹ️  AI extracted payer source: ''
[16:40:54] ℹ️  AI extracted diagnoses:
[16:40:54] ℹ️    - Diagnosis 1: 'S02.2XX'
[16:40:54] ℹ️    - Diagnosis 2: 'S01.81X'
[16:40:54] ℹ️    - Diagnosis 3: 'E03.9'
[16:40:54] ℹ️    - Diagnosis 4: ''
[16:40:54] ℹ️    - Diagnosis 5: ''
[16:40:54] ℹ️    - Diagnosis 6: ''
[16:40:54] ℹ️  Final extracted MRN: 'MA241009113701'
[16:40:54] ℹ️  Final extracted Sex: ''
[16:40:54] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:40:54] ℹ️  Final extracted Payer Source: ''
[16:40:54] ✅ Patient data extraction completed successfully
[16:40:54] ✅    ✅ Patient data extracted successfully
[16:40:54] 📊 Patient Response
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:54] ✅    ✅ Patient identified: Maria Ines Figueiredo
[16:40:54] ✅    ✅ Patient name validation passed
[16:40:54] 🔄 
🔄 Step 3: Processing patient dates...
[16:40:54] [DOC: 9217084] ℹ️  DOB normalized: 11/11/1937
[16:40:54] [DOC: 9217084] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:40:54] [DOC: 9217084] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:40:54] [DOC: 9217084] ✅ Patient date processing completed successfully
[16:40:54] ✅    ✅ Date processing completed
[16:40:54] 📊 Processed Patient Data
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:40:54] 🔄 
🔄 Step 4: Extracting order data...
[16:40:57] ℹ️  Order extraction - MRN: 'MA241009113701'
[16:40:57] ℹ️  Order extraction - Sex: ''
[16:40:57] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:40:57] ℹ️  Order extraction - Payer Source: ''
[16:40:57] ✅ Order data extraction completed successfully
[16:40:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:40:57] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[16:40:57] ⚠️  Could not determine sex using any available method
[16:40:57] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:40:57] ✅ Patient name cross-validation successful
[16:40:57] ✅    ✅ Data merged successfully
[16:40:58] ✅    ✅ Order data extracted and validated
[16:40:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:40:58] [DOC: 9217084] ✅ Patient found in local cache: Maria Ines Figueiredo, ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:40:58] ✅    ✅ Existing patient found with ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:40:58] 🔄 
🔄 Step 6: Pushing order to API...
[16:40:58] [DOC: 9217084] ℹ️  Pushing order via API for patient ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:00] [DOC: 9217084] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14045"}
[16:41:00] ❌    ❌ Failed to push order
[16:41:00] 🔄 
🔄 Step 7: Writing to CSV...
[16:41:00] [DOC: 9217084] ℹ️  Calculated age: 87 from DOB: 11/11/1937
[16:41:00] [DOC: 9217084] ℹ️  Service Line extracted: 'Physical Therapy'
[16:41:00] [DOC: 9217084] ℹ️  Payer Source extracted: ''
[16:41:00] [DOC: 9217084] ℹ️  Diagnosis codes being written:
[16:41:00] [DOC: 9217084] ℹ️    - Latest_Episode_Firstdiagnosis: 'S02.2XX'
[16:41:00] [DOC: 9217084] ℹ️    - Latest_Episode_Seconddiagnosis: 'S01.81X'
[16:41:00] [DOC: 9217084] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[16:41:00] [DOC: 9217084] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:41:00] [DOC: 9217084] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:41:00] [DOC: 9217084] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:41:00] [DOC: 9217084] ✅ Patient data written to CSV: Maria Ines Figueiredo | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA241009113701
[16:41:00] ✅    ✅ Document 9217084 processed and saved successfully
[16:41:00] 🔄 
🔄 Step 8: Saving API details...
[16:41:00] [DOC: 9217084] ℹ️  API push details saved for document 9217084
[16:41:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217083                         ║
================================================================================
[16:41:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:41:00] ℹ️  Date: 04/02/2025
[16:41:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:41:02] [DOC: 9217083] ✅ Text extracted using pdfplumber (1618 chars)
[16:41:02] ✅    ✅ Text extracted using pdfplumber (1606 chars)
[16:41:02] 🔄 
🔄 Step 2: Extracting patient data...
[16:41:05] ℹ️  AI extracted raw sex value: ''
[16:41:05] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:41:05] ℹ️  AI extracted payer source: ''
[16:41:05] ℹ️  AI extracted diagnoses:
[16:41:05] ℹ️    - Diagnosis 1: 'S02.2XX'
[16:41:05] ℹ️    - Diagnosis 2: 'S01.81X'
[16:41:05] ℹ️    - Diagnosis 3: 'E03.9'
[16:41:05] ℹ️    - Diagnosis 4: 'None'
[16:41:05] ℹ️    - Diagnosis 5: 'None'
[16:41:05] ℹ️    - Diagnosis 6: 'None'
[16:41:05] ℹ️  Final extracted MRN: 'MA241009113701'
[16:41:05] ℹ️  Final extracted Sex: ''
[16:41:05] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:41:05] ℹ️  Final extracted Payer Source: ''
[16:41:05] ✅ Patient data extraction completed successfully
[16:41:05] ✅    ✅ Patient data extracted successfully
[16:41:05] 📊 Patient Response
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:41:05] ✅    ✅ Patient identified: Maria Ines Figueiredo
[16:41:05] ✅    ✅ Patient name validation passed
[16:41:05] 🔄 
🔄 Step 3: Processing patient dates...
[16:41:05] [DOC: 9217083] ℹ️  DOB normalized: 11/11/1937
[16:41:05] [DOC: 9217083] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:41:05] [DOC: 9217083] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:41:05] [DOC: 9217083] ✅ Patient date processing completed successfully
[16:41:05] ✅    ✅ Date processing completed
[16:41:05] 📊 Processed Patient Data
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9'}]
[16:41:05] 🔄 
🔄 Step 4: Extracting order data...
[16:41:08] ℹ️  Order extraction - MRN: 'MA241009113701'
[16:41:08] ℹ️  Order extraction - Sex: ''
[16:41:08] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:41:08] ℹ️  Order extraction - Payer Source: ''
[16:41:08] ✅ Order data extraction completed successfully
[16:41:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:41:08] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[16:41:08] ⚠️  Could not determine sex using any available method
[16:41:08] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:41:08] ✅ Patient name cross-validation successful
[16:41:08] ✅    ✅ Data merged successfully
[16:41:09] ✅    ✅ Order data extracted and validated
[16:41:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:41:09] [DOC: 9217083] ✅ Patient found in local cache: Maria Ines Figueiredo, ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:09] ✅    ✅ Existing patient found with ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:09] 🔄 
🔄 Step 6: Pushing order to API...
[16:41:09] [DOC: 9217083] ℹ️  Pushing order via API for patient ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:10] [DOC: 9217083] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14046"}
[16:41:10] ❌    ❌ Failed to push order
[16:41:10] 🔄 
🔄 Step 7: Writing to CSV...
[16:41:10] [DOC: 9217083] ℹ️  Calculated age: 87 from DOB: 11/11/1937
[16:41:10] [DOC: 9217083] ℹ️  Service Line extracted: 'Occupational Therapy'
[16:41:10] [DOC: 9217083] ℹ️  Payer Source extracted: ''
[16:41:10] [DOC: 9217083] ℹ️  Diagnosis codes being written:
[16:41:10] [DOC: 9217083] ℹ️    - Latest_Episode_Firstdiagnosis: 'S02.2XX'
[16:41:10] [DOC: 9217083] ℹ️    - Latest_Episode_Seconddiagnosis: 'S01.81X'
[16:41:10] [DOC: 9217083] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[16:41:10] [DOC: 9217083] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:41:10] [DOC: 9217083] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:41:10] [DOC: 9217083] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:41:10] [DOC: 9217083] ✅ Patient data written to CSV: Maria Ines Figueiredo | Sex:  | Age: 87 | Service: Occupational Therapy | Payer:  | MRN: MA241009113701
[16:41:10] ✅    ✅ Document 9217083 processed and saved successfully
[16:41:10] 🔄 
🔄 Step 8: Saving API details...
[16:41:10] [DOC: 9217083] ℹ️  API push details saved for document 9217083
[16:41:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217078                         ║
================================================================================
[16:41:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:41:10] ℹ️  Date: 04/02/2025
[16:41:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:41:14] [DOC: 9217078] ✅ Text extracted using pdfplumber (12455 chars)
[16:41:14] ✅    ✅ Text extracted using pdfplumber (12455 chars)
[16:41:14] 🔄 
🔄 Step 2: Extracting patient data...
[16:41:16] ℹ️  AI extracted raw sex value: 'F'
[16:41:16] ℹ️  AI extracted service line: 'OT'
[16:41:16] ℹ️  AI extracted payer source: ''
[16:41:16] ℹ️  AI extracted diagnoses:
[16:41:16] ℹ️    - Diagnosis 1: 'closed nasal bone fracture, forehead laceration'
[16:41:16] ℹ️    - Diagnosis 2: 'muscle weakness'
[16:41:16] ℹ️    - Diagnosis 3: ''
[16:41:16] ℹ️    - Diagnosis 4: ''
[16:41:16] ℹ️    - Diagnosis 5: ''
[16:41:16] ℹ️    - Diagnosis 6: ''
[16:41:16] ℹ️  Final extracted MRN: 'MA241009113701'
[16:41:16] ℹ️  Final extracted Sex: 'FEMALE'
[16:41:16] ℹ️  Final extracted Service Line: 'OT'
[16:41:16] ℹ️  Final extracted Payer Source: ''
[16:41:16] ✅ Patient data extraction completed successfully
[16:41:16] ✅    ✅ Patient data extracted successfully
[16:41:16] 📊 Patient Response
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '', 'firstDiagnosis': 'closed nasal bone fracture, forehead laceration', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:16] ✅    ✅ Patient identified: Maria Ines Figueiredo
[16:41:16] ✅    ✅ Patient name validation passed
[16:41:16] 🔄 
🔄 Step 3: Processing patient dates...
[16:41:16] [DOC: 9217078] ℹ️  DOB normalized: 11/11/1937
[16:41:16] [DOC: 9217078] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[16:41:16] [DOC: 9217078] ✅ Patient date processing completed successfully
[16:41:16] ✅    ✅ Date processing completed
[16:41:16] 📊 Processed Patient Data
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '', 'firstDiagnosis': 'closed nasal bone fracture, forehead laceration', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:16] 🔄 
🔄 Step 4: Extracting order data...
[16:41:19] ℹ️  Order extraction - MRN: 'MA241009113701'
[16:41:19] ℹ️  Order extraction - Sex: 'FEMALE'
[16:41:19] ℹ️  Order extraction - Service Line: 'OT'
[16:41:19] ℹ️  Order extraction - Payer Source: ''
[16:41:19] ✅ Order data extraction completed successfully
[16:41:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:41:19] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[16:41:19] ℹ️  Service line consistent in both sources: 'OT'
[16:41:19] ✅ Patient name cross-validation successful
[16:41:19] ✅    ✅ Data merged successfully
[16:41:20] ✅    ✅ Order data extracted and validated
[16:41:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:41:20] [DOC: 9217078] ✅ Patient found in local cache: Maria Ines Figueiredo, ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:20] ✅    ✅ Existing patient found with ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:20] 🔄 
🔄 Step 6: Pushing order to API...
[16:41:20] [DOC: 9217078] ℹ️  Pushing order via API for patient ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:22] [DOC: 9217078] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:41:22] ❌    ❌ Failed to push order
[16:41:22] 🔄 
🔄 Step 7: Writing to CSV...
[16:41:22] [DOC: 9217078] ℹ️  Calculated age: 87 from DOB: 11/11/1937
[16:41:22] [DOC: 9217078] ℹ️  Service Line extracted: 'OT'
[16:41:22] [DOC: 9217078] ℹ️  Payer Source extracted: ''
[16:41:22] [DOC: 9217078] ℹ️  Diagnosis codes being written:
[16:41:22] [DOC: 9217078] ℹ️    - Latest_Episode_Firstdiagnosis: 'closed nasal bone fracture, forehead laceration'
[16:41:22] [DOC: 9217078] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[16:41:22] [DOC: 9217078] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:41:22] [DOC: 9217078] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:41:22] [DOC: 9217078] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:41:22] [DOC: 9217078] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:41:22] [DOC: 9217078] ✅ Patient data written to CSV: Maria Ines Figueiredo | Sex: FEMALE | Age: 87 | Service: OT | Payer:  | MRN: MA241009113701
[16:41:22] ✅    ✅ Document 9217078 processed and saved successfully
[16:41:22] 🔄 
🔄 Step 8: Saving API details...
[16:41:22] [DOC: 9217078] ℹ️  API push details saved for document 9217078
[16:41:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217072                         ║
================================================================================
[16:41:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:41:22] ℹ️  Date: 04/02/2025
[16:41:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:41:26] [DOC: 9217072] ✅ Text extracted using pdfplumber (21803 chars)
[16:41:26] ✅    ✅ Text extracted using pdfplumber (21803 chars)
[16:41:26] 🔄 
🔄 Step 2: Extracting patient data...
[16:41:29] ℹ️  AI extracted raw sex value: 'F'
[16:41:29] ℹ️  AI extracted service line: 'PT'
[16:41:29] ℹ️  AI extracted payer source: ''
[16:41:29] ℹ️  AI extracted diagnoses:
[16:41:29] ℹ️    - Diagnosis 1: ''
[16:41:29] ℹ️    - Diagnosis 2: ''
[16:41:29] ℹ️    - Diagnosis 3: ''
[16:41:29] ℹ️    - Diagnosis 4: ''
[16:41:29] ℹ️    - Diagnosis 5: ''
[16:41:29] ℹ️    - Diagnosis 6: ''
[16:41:29] ℹ️  Final extracted MRN: 'MA241009113701'
[16:41:29] ℹ️  Final extracted Sex: 'FEMALE'
[16:41:29] ℹ️  Final extracted Service Line: 'PT'
[16:41:29] ℹ️  Final extracted Payer Source: ''
[16:41:29] ✅ Patient data extraction completed successfully
[16:41:29] ✅    ✅ Patient data extracted successfully
[16:41:29] 📊 Patient Response
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:29] ✅    ✅ Patient identified: Maria Ines Figueiredo
[16:41:29] ✅    ✅ Patient name validation passed
[16:41:29] 🔄 
🔄 Step 3: Processing patient dates...
[16:41:29] [DOC: 9217072] ℹ️  DOB normalized: 11/11/1937
[16:41:29] [DOC: 9217072] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[16:41:29] [DOC: 9217072] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:41:29] [DOC: 9217072] ✅ Patient date processing completed successfully
[16:41:29] ✅    ✅ Date processing completed
[16:41:29] 📊 Processed Patient Data
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:29] 🔄 
🔄 Step 4: Extracting order data...
[16:41:32] ℹ️  Order extraction - MRN: 'MA241009113701'
[16:41:32] ℹ️  Order extraction - Sex: 'FEMALE'
[16:41:32] ℹ️  Order extraction - Service Line: 'PT'
[16:41:32] ℹ️  Order extraction - Payer Source: ''
[16:41:32] ✅ Order data extraction completed successfully
[16:41:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:41:32] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[16:41:32] ℹ️  Service line consistent in both sources: 'PT'
[16:41:32] ✅ Patient name cross-validation successful
[16:41:32] ✅    ✅ Data merged successfully
[16:41:33] ✅    ✅ Order data extracted and validated
[16:41:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:41:33] [DOC: 9217072] ✅ Patient found in local cache: Maria Ines Figueiredo, ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:33] ✅    ✅ Existing patient found with ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:41:33] [DOC: 9217072] ℹ️  Pushing order via API for patient ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[16:41:35] [DOC: 9217072] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:41:35] ❌    ❌ Failed to push order
[16:41:35] 🔄 
🔄 Step 7: Writing to CSV...
[16:41:35] [DOC: 9217072] ℹ️  Calculated age: 87 from DOB: 11/11/1937
[16:41:35] [DOC: 9217072] ℹ️  Service Line extracted: 'PT'
[16:41:35] [DOC: 9217072] ℹ️  Payer Source extracted: ''
[16:41:35] [DOC: 9217072] ℹ️  Diagnosis codes being written:
[16:41:35] [DOC: 9217072] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:41:35] [DOC: 9217072] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:41:35] [DOC: 9217072] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:41:35] [DOC: 9217072] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:41:35] [DOC: 9217072] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:41:35] [DOC: 9217072] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:41:35] [DOC: 9217072] ✅ Patient data written to CSV: Maria Ines Figueiredo | Sex: FEMALE | Age: 87 | Service: PT | Payer:  | MRN: MA241009113701
[16:41:35] ✅    ✅ Document 9217072 processed and saved successfully
[16:41:35] 🔄 
🔄 Step 8: Saving API details...
[16:41:35] [DOC: 9217072] ℹ️  API push details saved for document 9217072
[16:41:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217045                         ║
================================================================================
[16:41:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:41:35] ℹ️  Date: 04/02/2025
[16:41:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:41:40] [DOC: 9217045] ✅ Text extracted using pdfplumber (1456 chars)
[16:41:40] ✅    ✅ Text extracted using pdfplumber (1456 chars)
[16:41:40] 🔄 
🔄 Step 2: Extracting patient data...
[16:41:42] ℹ️  AI extracted raw sex value: ''
[16:41:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:41:42] ℹ️  AI extracted payer source: ''
[16:41:42] ℹ️  AI extracted diagnoses:
[16:41:42] ℹ️    - Diagnosis 1: 'G89.4'
[16:41:42] ℹ️    - Diagnosis 2: 'R29.6'
[16:41:42] ℹ️    - Diagnosis 3: 'G57.00'
[16:41:42] ℹ️    - Diagnosis 4: ''
[16:41:42] ℹ️    - Diagnosis 5: ''
[16:41:42] ℹ️    - Diagnosis 6: ''
[16:41:42] ℹ️  Final extracted MRN: 'MA240113114401'
[16:41:42] ℹ️  Final extracted Sex: ''
[16:41:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:41:42] ℹ️  Final extracted Payer Source: ''
[16:41:42] ✅ Patient data extraction completed successfully
[16:41:42] ✅    ✅ Patient data extracted successfully
[16:41:42] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:42] ✅    ✅ Patient identified: Benjamin Tavares
[16:41:42] ✅    ✅ Patient name validation passed
[16:41:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:41:42] [DOC: 9217045] ℹ️  DOB normalized: 11/30/1944
[16:41:42] [DOC: 9217045] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[16:41:42] [DOC: 9217045] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[16:41:42] [DOC: 9217045] ✅ Patient date processing completed successfully
[16:41:42] ✅    ✅ Date processing completed
[16:41:42] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:42] 🔄 
🔄 Step 4: Extracting order data...
[16:41:45] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:41:45] ℹ️  Order extraction - Sex: ''
[16:41:45] ℹ️  Order extraction - Service Line: 'SN'
[16:41:45] ℹ️  Order extraction - Payer Source: ''
[16:41:45] ✅ Order data extraction completed successfully
[16:41:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:41:45] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:41:45] ℹ️  Inferred sex as MALE from name: Benjamin
[16:41:45] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[16:41:45] ✅ Patient name cross-validation successful
[16:41:45] ✅    ✅ Data merged successfully
[16:41:47] ✅    ✅ Order data extracted and validated
[16:41:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:41:47] [DOC: 9217045] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:41:47] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:41:47] 🔄 
🔄 Step 6: Pushing order to API...
[16:41:47] [DOC: 9217045] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:41:48] [DOC: 9217045] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14487"}
[16:41:48] ❌    ❌ Failed to push order
[16:41:48] 🔄 
🔄 Step 7: Writing to CSV...
[16:41:48] [DOC: 9217045] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:41:48] [DOC: 9217045] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[16:41:48] [DOC: 9217045] ℹ️  Payer Source extracted: ''
[16:41:48] [DOC: 9217045] ℹ️  Diagnosis codes being written:
[16:41:48] [DOC: 9217045] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:41:48] [DOC: 9217045] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:41:48] [DOC: 9217045] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:41:48] [DOC: 9217045] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:41:48] [DOC: 9217045] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:41:48] [DOC: 9217045] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:41:48] [DOC: 9217045] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: SN, Skilled Nursing | Payer:  | MRN: MA240113114401
[16:41:48] ✅    ✅ Document 9217045 processed and saved successfully
[16:41:48] 🔄 
🔄 Step 8: Saving API details...
[16:41:48] [DOC: 9217045] ℹ️  API push details saved for document 9217045
[16:41:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217041                         ║
================================================================================
[16:41:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:41:48] ℹ️  Date: 04/02/2025
[16:41:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:41:50] [DOC: 9217041] ✅ Text extracted using pdfplumber (1453 chars)
[16:41:50] ✅    ✅ Text extracted using pdfplumber (1453 chars)
[16:41:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:41:53] ℹ️  AI extracted raw sex value: ''
[16:41:53] ℹ️  AI extracted service line: 'Physical Therapy'
[16:41:53] ℹ️  AI extracted payer source: ''
[16:41:53] ℹ️  AI extracted diagnoses:
[16:41:53] ℹ️    - Diagnosis 1: 'G89.4'
[16:41:53] ℹ️    - Diagnosis 2: 'R29.6'
[16:41:53] ℹ️    - Diagnosis 3: 'G57.00'
[16:41:53] ℹ️    - Diagnosis 4: ''
[16:41:53] ℹ️    - Diagnosis 5: ''
[16:41:53] ℹ️    - Diagnosis 6: ''
[16:41:53] ℹ️  Final extracted MRN: 'MA240113114401'
[16:41:53] ℹ️  Final extracted Sex: ''
[16:41:53] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:41:53] ℹ️  Final extracted Payer Source: ''
[16:41:53] ✅ Patient data extraction completed successfully
[16:41:53] ✅    ✅ Patient data extracted successfully
[16:41:53] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:53] ✅    ✅ Patient identified: Benjamin Tavares
[16:41:53] ✅    ✅ Patient name validation passed
[16:41:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:41:53] [DOC: 9217041] ℹ️  DOB normalized: 11/30/1944
[16:41:53] [DOC: 9217041] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[16:41:53] [DOC: 9217041] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[16:41:53] [DOC: 9217041] ✅ Patient date processing completed successfully
[16:41:53] ✅    ✅ Date processing completed
[16:41:53] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:41:53] 🔄 
🔄 Step 4: Extracting order data...
[16:41:56] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:41:56] ℹ️  Order extraction - Sex: ''
[16:41:56] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:41:56] ℹ️  Order extraction - Payer Source: ''
[16:41:56] ✅ Order data extraction completed successfully
[16:41:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:41:56] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:41:56] ℹ️  Inferred sex as MALE from name: Benjamin
[16:41:56] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:41:56] ✅ Patient name cross-validation successful
[16:41:56] ✅    ✅ Data merged successfully
[16:41:58] ✅    ✅ Order data extracted and validated
[16:41:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:41:58] [DOC: 9217041] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:41:58] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:41:58] 🔄 
🔄 Step 6: Pushing order to API...
[16:41:58] [DOC: 9217041] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:41:59] [DOC: 9217041] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14488"}
[16:41:59] ❌    ❌ Failed to push order
[16:41:59] 🔄 
🔄 Step 7: Writing to CSV...
[16:41:59] [DOC: 9217041] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:41:59] [DOC: 9217041] ℹ️  Service Line extracted: 'Physical Therapy'
[16:41:59] [DOC: 9217041] ℹ️  Payer Source extracted: ''
[16:41:59] [DOC: 9217041] ℹ️  Diagnosis codes being written:
[16:41:59] [DOC: 9217041] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:41:59] [DOC: 9217041] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:41:59] [DOC: 9217041] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:41:59] [DOC: 9217041] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:41:59] [DOC: 9217041] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:41:59] [DOC: 9217041] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:41:59] [DOC: 9217041] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA240113114401
[16:41:59] ✅    ✅ Document 9217041 processed and saved successfully
[16:41:59] 🔄 
🔄 Step 8: Saving API details...
[16:41:59] [DOC: 9217041] ℹ️  API push details saved for document 9217041
[16:41:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217039                         ║
================================================================================
[16:41:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:41:59] ℹ️  Date: 04/02/2025
[16:41:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:42:01] [DOC: 9217039] ✅ Text extracted using pdfplumber (1710 chars)
[16:42:01] ✅    ✅ Text extracted using pdfplumber (1710 chars)
[16:42:01] 🔄 
🔄 Step 2: Extracting patient data...
[16:42:04] ℹ️  AI extracted raw sex value: ''
[16:42:04] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:42:04] ℹ️  AI extracted payer source: ''
[16:42:04] ℹ️  AI extracted diagnoses:
[16:42:04] ℹ️    - Diagnosis 1: 'G89.4'
[16:42:04] ℹ️    - Diagnosis 2: 'R29.6'
[16:42:04] ℹ️    - Diagnosis 3: 'G57.00'
[16:42:04] ℹ️    - Diagnosis 4: ''
[16:42:04] ℹ️    - Diagnosis 5: ''
[16:42:04] ℹ️    - Diagnosis 6: ''
[16:42:04] ℹ️  Final extracted MRN: 'MA240113114401'
[16:42:04] ℹ️  Final extracted Sex: ''
[16:42:04] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:42:04] ℹ️  Final extracted Payer Source: ''
[16:42:04] ✅ Patient data extraction completed successfully
[16:42:04] ✅    ✅ Patient data extracted successfully
[16:42:04] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:42:04] ✅    ✅ Patient identified: Benjamin Tavares
[16:42:04] ✅    ✅ Patient name validation passed
[16:42:04] 🔄 
🔄 Step 3: Processing patient dates...
[16:42:04] [DOC: 9217039] ℹ️  DOB normalized: 11/30/1944
[16:42:04] [DOC: 9217039] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[16:42:04] [DOC: 9217039] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[16:42:04] [DOC: 9217039] ✅ Patient date processing completed successfully
[16:42:04] ✅    ✅ Date processing completed
[16:42:04] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:42:04] 🔄 
🔄 Step 4: Extracting order data...
[16:42:07] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:42:07] ℹ️  Order extraction - Sex: ''
[16:42:07] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:42:07] ℹ️  Order extraction - Payer Source: ''
[16:42:07] ✅ Order data extraction completed successfully
[16:42:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:42:07] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:42:07] ℹ️  Inferred sex as MALE from name: Benjamin
[16:42:07] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:42:07] ✅ Patient name cross-validation successful
[16:42:07] ✅    ✅ Data merged successfully
[16:42:09] ✅    ✅ Order data extracted and validated
[16:42:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:42:09] [DOC: 9217039] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:09] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:09] 🔄 
🔄 Step 6: Pushing order to API...
[16:42:09] [DOC: 9217039] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:10] [DOC: 9217039] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14489"}
[16:42:10] ❌    ❌ Failed to push order
[16:42:10] 🔄 
🔄 Step 7: Writing to CSV...
[16:42:10] [DOC: 9217039] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:42:10] [DOC: 9217039] ℹ️  Service Line extracted: 'Occupational Therapy'
[16:42:10] [DOC: 9217039] ℹ️  Payer Source extracted: ''
[16:42:10] [DOC: 9217039] ℹ️  Diagnosis codes being written:
[16:42:10] [DOC: 9217039] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:42:10] [DOC: 9217039] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:42:10] [DOC: 9217039] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:42:10] [DOC: 9217039] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:42:10] [DOC: 9217039] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:42:10] [DOC: 9217039] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:42:10] [DOC: 9217039] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA240113114401
[16:42:10] ✅    ✅ Document 9217039 processed and saved successfully
[16:42:10] 🔄 
🔄 Step 8: Saving API details...
[16:42:10] [DOC: 9217039] ℹ️  API push details saved for document 9217039
[16:42:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217035                         ║
================================================================================
[16:42:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:42:10] ℹ️  Date: 04/02/2025
[16:42:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:42:21] [DOC: 9217035] ✅ Text extracted using pdfplumber (17167 chars)
[16:42:21] ✅    ✅ Text extracted using pdfplumber (17167 chars)
[16:42:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:42:25] ℹ️  AI extracted raw sex value: 'M'
[16:42:25] ℹ️  AI extracted service line: 'PT'
[16:42:25] ℹ️  AI extracted payer source: 'None'
[16:42:25] ℹ️  AI extracted diagnoses:
[16:42:25] ℹ️    - Diagnosis 1: 'REPEATED FALLS'
[16:42:25] ℹ️    - Diagnosis 2: 'Gait abnormality and BLE weakness'
[16:42:25] ℹ️    - Diagnosis 3: 'CHRONIC PAIN SYNDROME'
[16:42:25] ℹ️    - Diagnosis 4: 'PORTAL VEIN THROMBOSIS'
[16:42:25] ℹ️    - Diagnosis 5: 'GI BLEED HX'
[16:42:25] ℹ️    - Diagnosis 6: 'CHRONIC THROMBOCYTOPENIA'
[16:42:25] ℹ️  Final extracted MRN: 'MA240113114401'
[16:42:25] ℹ️  Final extracted Sex: 'MALE'
[16:42:25] ℹ️  Final extracted Service Line: 'PT'
[16:42:25] ℹ️  Final extracted Payer Source: ''
[16:42:25] ✅ Patient data extraction completed successfully
[16:42:25] ✅    ✅ Patient data extracted successfully
[16:42:25] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/06/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'REPEATED FALLS', 'secondDiagnosis': 'Gait abnormality and BLE weakness', 'thirdDiagnosis': 'CHRONIC PAIN SYNDROME', 'fourthDiagnosis': 'PORTAL VEIN THROMBOSIS', 'fifthDiagnosis': 'GI BLEED HX', 'sixthDiagnosis': 'CHRONIC THROMBOCYTOPENIA'}]
[16:42:25] ✅    ✅ Patient identified: Benjamin Tavares
[16:42:25] ✅    ✅ Patient name validation passed
[16:42:25] 🔄 
🔄 Step 3: Processing patient dates...
[16:42:25] [DOC: 9217035] ℹ️  DOB normalized: 11/30/1944
[16:42:25] [DOC: 9217035] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[16:42:25] [DOC: 9217035] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[16:42:25] [DOC: 9217035] ✅ Patient date processing completed successfully
[16:42:25] ✅    ✅ Date processing completed
[16:42:25] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'REPEATED FALLS', 'secondDiagnosis': 'Gait abnormality and BLE weakness', 'thirdDiagnosis': 'CHRONIC PAIN SYNDROME', 'fourthDiagnosis': 'PORTAL VEIN THROMBOSIS', 'fifthDiagnosis': 'GI BLEED HX', 'sixthDiagnosis': 'CHRONIC THROMBOCYTOPENIA'}]
[16:42:25] 🔄 
🔄 Step 4: Extracting order data...
[16:42:28] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:42:28] ℹ️  Order extraction - Sex: 'MALE'
[16:42:28] ℹ️  Order extraction - Service Line: 'PT'
[16:42:28] ℹ️  Order extraction - Payer Source: ''
[16:42:28] ✅ Order data extraction completed successfully
[16:42:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:42:28] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:42:28] ℹ️  Service line consistent in both sources: 'PT'
[16:42:28] ✅ Patient name cross-validation successful
[16:42:28] ✅    ✅ Data merged successfully
[16:42:29] ✅    ✅ Order data extracted and validated
[16:42:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:42:29] [DOC: 9217035] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:29] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:29] 🔄 
🔄 Step 6: Pushing order to API...
[16:42:29] [DOC: 9217035] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:30] [DOC: 9217035] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:42:30] ❌    ❌ Failed to push order
[16:42:30] 🔄 
🔄 Step 7: Writing to CSV...
[16:42:30] [DOC: 9217035] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:42:30] [DOC: 9217035] ℹ️  Service Line extracted: 'PT'
[16:42:30] [DOC: 9217035] ℹ️  Payer Source extracted: ''
[16:42:30] [DOC: 9217035] ℹ️  Diagnosis codes being written:
[16:42:30] [DOC: 9217035] ℹ️    - Latest_Episode_Firstdiagnosis: 'REPEATED FALLS'
[16:42:30] [DOC: 9217035] ℹ️    - Latest_Episode_Seconddiagnosis: 'Gait abnormality and BLE weakness'
[16:42:30] [DOC: 9217035] ℹ️    - Latest_Episode_Thirddiagnosis: 'CHRONIC PAIN SYNDROME'
[16:42:30] [DOC: 9217035] ℹ️    - Latest_Episode_Fourthdiagnosis: 'PORTAL VEIN THROMBOSIS'
[16:42:30] [DOC: 9217035] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GI BLEED HX'
[16:42:30] [DOC: 9217035] ℹ️    - Latest_Episode_Sixthdiagnosis: 'CHRONIC THROMBOCYTOPENIA'
[16:42:30] [DOC: 9217035] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: PT | Payer:  | MRN: MA240113114401
[16:42:30] ✅    ✅ Document 9217035 processed and saved successfully
[16:42:30] 🔄 
🔄 Step 8: Saving API details...
[16:42:30] [DOC: 9217035] ℹ️  API push details saved for document 9217035
[16:42:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217030                         ║
================================================================================
[16:42:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:42:30] ℹ️  Date: 04/02/2025
[16:42:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:42:41] [DOC: 9217030] ✅ Text extracted using pdfplumber (13261 chars)
[16:42:41] ✅    ✅ Text extracted using pdfplumber (13261 chars)
[16:42:41] 🔄 
🔄 Step 2: Extracting patient data...
[16:42:44] ℹ️  AI extracted raw sex value: 'M'
[16:42:44] ℹ️  AI extracted service line: 'OT'
[16:42:44] ℹ️  AI extracted payer source: 'None'
[16:42:44] ℹ️  AI extracted diagnoses:
[16:42:44] ℹ️    - Diagnosis 1: 'Sciatica Exacerbation'
[16:42:44] ℹ️    - Diagnosis 2: 'muscle weakness'
[16:42:44] ℹ️    - Diagnosis 3: 'None'
[16:42:44] ℹ️    - Diagnosis 4: 'None'
[16:42:44] ℹ️    - Diagnosis 5: 'None'
[16:42:44] ℹ️    - Diagnosis 6: 'None'
[16:42:44] ℹ️  Final extracted MRN: 'MA240113114401'
[16:42:44] ℹ️  Final extracted Sex: 'MALE'
[16:42:44] ℹ️  Final extracted Service Line: 'OT'
[16:42:44] ℹ️  Final extracted Payer Source: ''
[16:42:44] ✅ Patient data extraction completed successfully
[16:42:44] ✅    ✅ Patient data extracted successfully
[16:42:44] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/09/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Sciatica Exacerbation', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:42:44] ✅    ✅ Patient identified: Benjamin Tavares
[16:42:44] ✅    ✅ Patient name validation passed
[16:42:44] 🔄 
🔄 Step 3: Processing patient dates...
[16:42:44] [DOC: 9217030] ℹ️  DOB normalized: 11/30/1944
[16:42:44] [DOC: 9217030] ℹ️  Episode startOfEpisode normalized: 01/09/2025
[16:42:44] [DOC: 9217030] ✅ Patient date processing completed successfully
[16:42:44] ✅    ✅ Date processing completed
[16:42:44] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/09/2025', 'firstDiagnosis': 'Sciatica Exacerbation', 'secondDiagnosis': 'muscle weakness'}]
[16:42:44] 🔄 
🔄 Step 4: Extracting order data...
[16:42:47] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:42:47] ℹ️  Order extraction - Sex: 'MALE'
[16:42:47] ℹ️  Order extraction - Service Line: 'OT'
[16:42:47] ℹ️  Order extraction - Payer Source: ''
[16:42:47] ✅ Order data extraction completed successfully
[16:42:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:42:47] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:42:47] ℹ️  Service line consistent in both sources: 'OT'
[16:42:47] ✅ Patient name cross-validation successful
[16:42:47] ✅    ✅ Data merged successfully
[16:42:49] ✅    ✅ Order data extracted and validated
[16:42:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:42:49] [DOC: 9217030] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:49] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:49] 🔄 
🔄 Step 6: Pushing order to API...
[16:42:49] [DOC: 9217030] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:51] [DOC: 9217030] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:42:51] ❌    ❌ Failed to push order
[16:42:51] 🔄 
🔄 Step 7: Writing to CSV...
[16:42:51] [DOC: 9217030] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:42:51] [DOC: 9217030] ℹ️  Service Line extracted: 'OT'
[16:42:51] [DOC: 9217030] ℹ️  Payer Source extracted: ''
[16:42:51] [DOC: 9217030] ℹ️  Diagnosis codes being written:
[16:42:51] [DOC: 9217030] ℹ️    - Latest_Episode_Firstdiagnosis: 'Sciatica Exacerbation'
[16:42:51] [DOC: 9217030] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[16:42:51] [DOC: 9217030] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:42:51] [DOC: 9217030] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:42:51] [DOC: 9217030] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:42:51] [DOC: 9217030] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:42:51] [DOC: 9217030] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: OT | Payer:  | MRN: MA240113114401
[16:42:51] ✅    ✅ Document 9217030 processed and saved successfully
[16:42:51] 🔄 
🔄 Step 8: Saving API details...
[16:42:51] [DOC: 9217030] ℹ️  API push details saved for document 9217030
[16:42:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217026                         ║
================================================================================
[16:42:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:42:51] ℹ️  Date: 04/02/2025
[16:42:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:42:53] [DOC: 9217026] ✅ Text extracted using pdfplumber (1261 chars)
[16:42:53] ✅    ✅ Text extracted using pdfplumber (1261 chars)
[16:42:53] 🔄 
🔄 Step 2: Extracting patient data...
[16:42:56] ℹ️  AI extracted raw sex value: ''
[16:42:56] ℹ️  AI extracted service line: 'LPN'
[16:42:56] ℹ️  AI extracted payer source: ''
[16:42:56] ℹ️  AI extracted diagnoses:
[16:42:56] ℹ️    - Diagnosis 1: 'G89.4'
[16:42:56] ℹ️    - Diagnosis 2: 'R29.6'
[16:42:56] ℹ️    - Diagnosis 3: 'G57.00'
[16:42:56] ℹ️    - Diagnosis 4: 'None'
[16:42:56] ℹ️    - Diagnosis 5: 'None'
[16:42:56] ℹ️    - Diagnosis 6: 'None'
[16:42:56] ℹ️  Final extracted MRN: 'MA240113114401'
[16:42:56] ℹ️  Final extracted Sex: ''
[16:42:56] ℹ️  Final extracted Service Line: 'LPN'
[16:42:56] ℹ️  Final extracted Payer Source: ''
[16:42:56] ✅ Patient data extraction completed successfully
[16:42:56] ✅    ✅ Patient data extracted successfully
[16:42:56] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:42:56] ✅    ✅ Patient identified: Benjamin Tavares
[16:42:56] ✅    ✅ Patient name validation passed
[16:42:56] 🔄 
🔄 Step 3: Processing patient dates...
[16:42:56] [DOC: 9217026] ℹ️  DOB normalized: 11/30/1944
[16:42:56] [DOC: 9217026] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[16:42:56] [DOC: 9217026] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[16:42:56] [DOC: 9217026] ✅ Patient date processing completed successfully
[16:42:56] ✅    ✅ Date processing completed
[16:42:56] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00'}]
[16:42:56] 🔄 
🔄 Step 4: Extracting order data...
[16:42:58] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:42:58] ℹ️  Order extraction - Sex: ''
[16:42:58] ℹ️  Order extraction - Service Line: 'Nursing'
[16:42:58] ℹ️  Order extraction - Payer Source: ''
[16:42:58] ✅ Order data extraction completed successfully
[16:42:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:42:58] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:42:58] ℹ️  Inferred sex as MALE from name: Benjamin
[16:42:58] ℹ️  Combined service lines: Patient='LPN' + Order='Nursing' = 'LPN, Nursing'
[16:42:58] ✅ Patient name cross-validation successful
[16:42:58] ✅    ✅ Data merged successfully
[16:42:59] ✅    ✅ Order data extracted and validated
[16:42:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:42:59] [DOC: 9217026] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:59] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:42:59] 🔄 
🔄 Step 6: Pushing order to API...
[16:42:59] [DOC: 9217026] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:01] [DOC: 9217026] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14490"}
[16:43:01] ❌    ❌ Failed to push order
[16:43:01] 🔄 
🔄 Step 7: Writing to CSV...
[16:43:01] [DOC: 9217026] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:43:01] [DOC: 9217026] ℹ️  Service Line extracted: 'LPN, Nursing'
[16:43:01] [DOC: 9217026] ℹ️  Payer Source extracted: ''
[16:43:01] [DOC: 9217026] ℹ️  Diagnosis codes being written:
[16:43:01] [DOC: 9217026] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:43:01] [DOC: 9217026] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:43:01] [DOC: 9217026] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:43:01] [DOC: 9217026] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:43:01] [DOC: 9217026] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:43:01] [DOC: 9217026] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:43:01] [DOC: 9217026] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: LPN, Nursing | Payer:  | MRN: MA240113114401
[16:43:01] ✅    ✅ Document 9217026 processed and saved successfully
[16:43:01] 🔄 
🔄 Step 8: Saving API details...
[16:43:01] [DOC: 9217026] ℹ️  API push details saved for document 9217026
[16:43:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217018                         ║
================================================================================
[16:43:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:43:01] ℹ️  Date: 04/02/2025
[16:43:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:43:04] [DOC: 9217018] ✅ Text extracted using pdfplumber (11733 chars)
[16:43:04] ✅    ✅ Text extracted using pdfplumber (11733 chars)
[16:43:04] 🔄 
🔄 Step 2: Extracting patient data...
[16:43:08] ℹ️  AI extracted raw sex value: 'M'
[16:43:08] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:43:08] ℹ️  AI extracted payer source: 'SWH'
[16:43:08] ℹ️  AI extracted diagnoses:
[16:43:08] ℹ️    - Diagnosis 1: 'G89.4'
[16:43:08] ℹ️    - Diagnosis 2: 'R29.6'
[16:43:08] ℹ️    - Diagnosis 3: 'G57.00'
[16:43:08] ℹ️    - Diagnosis 4: 'D69.6'
[16:43:08] ℹ️    - Diagnosis 5: 'K74.60'
[16:43:08] ℹ️    - Diagnosis 6: 'B19.20'
[16:43:08] ℹ️  Final extracted MRN: 'MA240113114401'
[16:43:08] ℹ️  Final extracted Sex: 'MALE'
[16:43:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:43:08] ℹ️  Final extracted Payer Source: 'SWH'
[16:43:08] ✅ Patient data extraction completed successfully
[16:43:08] ✅    ✅ Patient data extracted successfully
[16:43:08] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: CALDAS, ROBERT DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 60 Monroe Dr
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (774) 627-6161
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': 'D69.6', 'fifthDiagnosis': 'K74.60', 'sixthDiagnosis': 'B19.20'}]
[16:43:08] ✅    ✅ Patient identified: Benjamin Tavares
[16:43:08] ✅    ✅ Patient name validation passed
[16:43:08] 🔄 
🔄 Step 3: Processing patient dates...
[16:43:08] [DOC: 9217018] ℹ️  DOB normalized: 11/30/1944
[16:43:08] [DOC: 9217018] ℹ️  Episode startOfCare normalized: 01/06/2025
[16:43:08] [DOC: 9217018] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[16:43:08] [DOC: 9217018] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[16:43:08] [DOC: 9217018] ✅ Patient date processing completed successfully
[16:43:08] ✅    ✅ Date processing completed
[16:43:08] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: CALDAS, ROBERT DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 60 Monroe Dr
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (774) 627-6161
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': 'D69.6', 'fifthDiagnosis': 'K74.60', 'sixthDiagnosis': 'B19.20'}]
[16:43:08] 🔄 
🔄 Step 4: Extracting order data...
[16:43:10] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:43:10] ℹ️  Order extraction - Sex: 'MALE'
[16:43:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:43:10] ℹ️  Order extraction - Payer Source: 'SWH'
[16:43:10] ✅ Order data extraction completed successfully
[16:43:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:43:10] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:43:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:43:10] ℹ️  Payer source consistent in both sources: 'SWH'
[16:43:10] ✅ Patient name cross-validation successful
[16:43:10] ✅    ✅ Data merged successfully
[16:43:12] ✅    ✅ Order data extracted and validated
[16:43:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:43:12] [DOC: 9217018] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:12] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:12] 🔄 
🔄 Step 6: Pushing order to API...
[16:43:12] [DOC: 9217018] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:13] [DOC: 9217018] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14491"}
[16:43:13] ❌    ❌ Failed to push order
[16:43:13] 🔄 
🔄 Step 7: Writing to CSV...
[16:43:13] [DOC: 9217018] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:43:13] [DOC: 9217018] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:43:13] [DOC: 9217018] ℹ️  Payer Source extracted: 'SWH'
[16:43:13] [DOC: 9217018] ℹ️  Diagnosis codes being written:
[16:43:13] [DOC: 9217018] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:43:13] [DOC: 9217018] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:43:13] [DOC: 9217018] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:43:13] [DOC: 9217018] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D69.6'
[16:43:13] [DOC: 9217018] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K74.60'
[16:43:13] [DOC: 9217018] ℹ️    - Latest_Episode_Sixthdiagnosis: 'B19.20'
[16:43:13] [DOC: 9217018] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: SWH | MRN: MA240113114401
[16:43:13] ✅    ✅ Document 9217018 processed and saved successfully
[16:43:13] 🔄 
🔄 Step 8: Saving API details...
[16:43:13] [DOC: 9217018] ℹ️  API push details saved for document 9217018
[16:43:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217014                         ║
================================================================================
[16:43:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:43:13] ℹ️  Date: 04/02/2025
[16:43:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:43:16] [DOC: 9217014] ✅ Text extracted using pdfplumber (1227 chars)
[16:43:16] ✅    ✅ Text extracted using pdfplumber (1227 chars)
[16:43:16] 🔄 
🔄 Step 2: Extracting patient data...
[16:43:18] ℹ️  AI extracted raw sex value: ''
[16:43:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:43:18] ℹ️  AI extracted payer source: ''
[16:43:18] ℹ️  AI extracted diagnoses:
[16:43:18] ℹ️    - Diagnosis 1: 'G89.4'
[16:43:18] ℹ️    - Diagnosis 2: 'R29.6'
[16:43:18] ℹ️    - Diagnosis 3: 'G57.00'
[16:43:18] ℹ️    - Diagnosis 4: ''
[16:43:18] ℹ️    - Diagnosis 5: ''
[16:43:18] ℹ️    - Diagnosis 6: ''
[16:43:18] ℹ️  Final extracted MRN: 'MA240113114401'
[16:43:18] ℹ️  Final extracted Sex: ''
[16:43:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:43:18] ℹ️  Final extracted Payer Source: ''
[16:43:18] ✅ Patient data extraction completed successfully
[16:43:18] ✅    ✅ Patient data extracted successfully
[16:43:18] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:43:18] ✅    ✅ Patient identified: Benjamin Tavares
[16:43:18] ✅    ✅ Patient name validation passed
[16:43:18] 🔄 
🔄 Step 3: Processing patient dates...
[16:43:18] [DOC: 9217014] ℹ️  DOB normalized: 11/30/1944
[16:43:18] [DOC: 9217014] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[16:43:18] [DOC: 9217014] ℹ️  Episode endOfEpisode normalized: 03/06/2025
[16:43:18] [DOC: 9217014] ✅ Patient date processing completed successfully
[16:43:18] ✅    ✅ Date processing completed
[16:43:18] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:43:18] 🔄 
🔄 Step 4: Extracting order data...
[16:43:21] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:43:21] ℹ️  Order extraction - Sex: ''
[16:43:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:43:21] ℹ️  Order extraction - Payer Source: ''
[16:43:21] ✅ Order data extraction completed successfully
[16:43:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:43:21] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:43:21] ℹ️  Inferred sex as MALE from name: Benjamin
[16:43:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:43:21] ✅ Patient name cross-validation successful
[16:43:21] ✅    ✅ Data merged successfully
[16:43:22] ✅    ✅ Order data extracted and validated
[16:43:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:43:22] [DOC: 9217014] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:22] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:22] 🔄 
🔄 Step 6: Pushing order to API...
[16:43:22] [DOC: 9217014] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:24] [DOC: 9217014] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14492"}
[16:43:24] ❌    ❌ Failed to push order
[16:43:24] 🔄 
🔄 Step 7: Writing to CSV...
[16:43:24] [DOC: 9217014] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:43:24] [DOC: 9217014] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:43:24] [DOC: 9217014] ℹ️  Payer Source extracted: ''
[16:43:24] [DOC: 9217014] ℹ️  Diagnosis codes being written:
[16:43:24] [DOC: 9217014] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:43:24] [DOC: 9217014] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:43:24] [DOC: 9217014] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:43:24] [DOC: 9217014] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:43:24] [DOC: 9217014] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:43:24] [DOC: 9217014] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:43:24] [DOC: 9217014] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: MA240113114401
[16:43:24] ✅    ✅ Document 9217014 processed and saved successfully
[16:43:24] 🔄 
🔄 Step 8: Saving API details...
[16:43:24] [DOC: 9217014] ℹ️  API push details saved for document 9217014
[16:43:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9217013                         ║
================================================================================
[16:43:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:43:24] ℹ️  Date: 04/02/2025
[16:43:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:43:27] [DOC: 9217013] ✅ Text extracted using pdfplumber (1201 chars)
[16:43:27] ✅    ✅ Text extracted using pdfplumber (1201 chars)
[16:43:27] 🔄 
🔄 Step 2: Extracting patient data...
[16:43:30] ℹ️  AI extracted raw sex value: ''
[16:43:30] ℹ️  AI extracted service line: 'RN'
[16:43:30] ℹ️  AI extracted payer source: ''
[16:43:30] ℹ️  AI extracted diagnoses:
[16:43:30] ℹ️    - Diagnosis 1: 'G89.4'
[16:43:30] ℹ️    - Diagnosis 2: 'R29.6'
[16:43:30] ℹ️    - Diagnosis 3: 'G57.00'
[16:43:30] ℹ️    - Diagnosis 4: ''
[16:43:30] ℹ️    - Diagnosis 5: ''
[16:43:30] ℹ️    - Diagnosis 6: ''
[16:43:30] ℹ️  Final extracted MRN: 'MA240113114401'
[16:43:30] ℹ️  Final extracted Sex: ''
[16:43:30] ℹ️  Final extracted Service Line: 'RN'
[16:43:30] ℹ️  Final extracted Payer Source: ''
[16:43:30] ✅ Patient data extraction completed successfully
[16:43:30] ✅    ✅ Patient data extracted successfully
[16:43:30] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:43:30] ✅    ✅ Patient identified: Benjamin Tavares
[16:43:30] ✅    ✅ Patient name validation passed
[16:43:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:43:30] [DOC: 9217013] ℹ️  DOB normalized: 11/30/1944
[16:43:30] [DOC: 9217013] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[16:43:30] [DOC: 9217013] ℹ️  Episode endOfEpisode normalized: 03/06/2025
[16:43:30] [DOC: 9217013] ✅ Patient date processing completed successfully
[16:43:30] ✅    ✅ Date processing completed
[16:43:30] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:43:30] 🔄 
🔄 Step 4: Extracting order data...
[16:43:32] ℹ️  Order extraction - MRN: 'MA240113114401'
[16:43:32] ℹ️  Order extraction - Sex: ''
[16:43:32] ℹ️  Order extraction - Service Line: 'RN'
[16:43:32] ℹ️  Order extraction - Payer Source: ''
[16:43:32] ✅ Order data extraction completed successfully
[16:43:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:43:32] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[16:43:32] ℹ️  Inferred sex as MALE from name: Benjamin
[16:43:32] ℹ️  Service line consistent in both sources: 'RN'
[16:43:32] ✅ Patient name cross-validation successful
[16:43:32] ✅    ✅ Data merged successfully
[16:43:33] ✅    ✅ Order data extracted and validated
[16:43:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:43:33] [DOC: 9217013] ✅ Patient found in local cache: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:33] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:43:33] [DOC: 9217013] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[16:43:35] [DOC: 9217013] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14493"}
[16:43:35] ❌    ❌ Failed to push order
[16:43:35] 🔄 
🔄 Step 7: Writing to CSV...
[16:43:35] [DOC: 9217013] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[16:43:35] [DOC: 9217013] ℹ️  Service Line extracted: 'RN'
[16:43:35] [DOC: 9217013] ℹ️  Payer Source extracted: ''
[16:43:35] [DOC: 9217013] ℹ️  Diagnosis codes being written:
[16:43:35] [DOC: 9217013] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[16:43:35] [DOC: 9217013] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[16:43:35] [DOC: 9217013] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[16:43:35] [DOC: 9217013] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:43:35] [DOC: 9217013] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:43:35] [DOC: 9217013] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:43:35] [DOC: 9217013] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: RN | Payer:  | MRN: MA240113114401
[16:43:35] ✅    ✅ Document 9217013 processed and saved successfully
[16:43:35] 🔄 
🔄 Step 8: Saving API details...
[16:43:35] [DOC: 9217013] ℹ️  API push details saved for document 9217013
[16:43:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216983                         ║
================================================================================
[16:43:35] ℹ️  Agency: All At Home Health Care-Allston
[16:43:35] ℹ️  Date: 04/02/2025
[16:43:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:43:37] [DOC: 9216983] ✅ Text extracted using pdfplumber (2662 chars)
[16:43:37] ✅    ✅ Text extracted using pdfplumber (2662 chars)
[16:43:37] 🔄 
🔄 Step 2: Extracting patient data...
[16:43:40] ℹ️  AI extracted raw sex value: ''
[16:43:40] ℹ️  AI extracted service line: ''
[16:43:40] ℹ️  AI extracted payer source: ''
[16:43:40] ℹ️  AI extracted diagnoses:
[16:43:40] ℹ️    - Diagnosis 1: 'I48.0'
[16:43:40] ℹ️    - Diagnosis 2: ''
[16:43:40] ℹ️    - Diagnosis 3: ''
[16:43:40] ℹ️    - Diagnosis 4: ''
[16:43:40] ℹ️    - Diagnosis 5: ''
[16:43:40] ℹ️    - Diagnosis 6: ''
[16:43:40] ℹ️  Final extracted MRN: ''
[16:43:40] ℹ️  Final extracted Sex: ''
[16:43:40] ℹ️  Final extracted Service Line: ''
[16:43:40] ℹ️  Final extracted Payer Source: ''
[16:43:40] ✅ Patient data extraction completed successfully
[16:43:40] ✅    ✅ Patient data extracted successfully
[16:43:40] 📊 Patient Response
     └─ patientFName: CONCEPCION
     └─ patientLName: GOMES
     └─ dob: 01/09/1941
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (617) 782-9900
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/05/2024', 'startOfEpisode': '11/05/2024', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:43:40] ✅    ✅ Patient identified: CONCEPCION GOMES
[16:43:40] ✅    ✅ Patient name validation passed
[16:43:40] 🔄 
🔄 Step 3: Processing patient dates...
[16:43:40] [DOC: 9216983] ℹ️  DOB normalized: 01/09/1941
[16:43:40] [DOC: 9216983] ℹ️  Episode startOfCare normalized: 11/05/2024
[16:43:40] [DOC: 9216983] ℹ️  Episode startOfEpisode normalized: 11/05/2024
[16:43:40] [DOC: 9216983] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[16:43:40] [DOC: 9216983] ✅ Patient date processing completed successfully
[16:43:40] ✅    ✅ Date processing completed
[16:43:40] 📊 Processed Patient Data
     └─ patientFName: CONCEPCION
     └─ patientLName: GOMES
     └─ dob: 01/09/1941
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (617) 782-9900
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/05/2024', 'startOfEpisode': '11/05/2024', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:43:40] 🔄 
🔄 Step 4: Extracting order data...
[16:43:42] ℹ️  Order extraction - MRN: ''
[16:43:42] ℹ️  Order extraction - Sex: ''
[16:43:42] ℹ️  Order extraction - Service Line: ''
[16:43:42] ℹ️  Order extraction - Payer Source: ''
[16:43:42] ✅ Order data extraction completed successfully
[16:43:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:43:42] ⚠️  No MRN found in either patient or order data
[16:43:42] ⚠️  Could not determine sex using any available method
[16:43:42] ✅ Patient name cross-validation successful
[16:43:42] ✅    ✅ Data merged successfully
[16:43:43] ✅    ✅ Order data extracted and validated
[16:43:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:44:02] [DOC: 9216983] ℹ️  Patient not found in cache or API: CONCEPCION GOMES
[16:44:02] [DOC: 9216983] ℹ️  Patient not found, creating new patient via API...
[16:44:02] [DOC: 9216983] ℹ️  Creating patient via API: CONCEPCION GOMES
[16:44:03] [DOC: 9216983] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:44:03] ❌    ❌ Failed to create patient
[16:44:03] [DOC: 9216983] ℹ️  API push details saved for document 9216983
================================================================================
║                        Processing Document ID: 9216929                         ║
================================================================================
[16:44:03] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:44:03] ℹ️  Date: 04/02/2025
[16:44:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:44:05] [DOC: 9216929] ✅ Text extracted using pdfplumber (1252 chars)
[16:44:05] ✅    ✅ Text extracted using pdfplumber (1252 chars)
[16:44:05] 🔄 
🔄 Step 2: Extracting patient data...
[16:44:08] ℹ️  AI extracted raw sex value: 'F'
[16:44:08] ℹ️  AI extracted service line: 'HHA'
[16:44:08] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance-One Care'
[16:44:08] ℹ️  AI extracted diagnoses:
[16:44:08] ℹ️    - Diagnosis 1: 'None'
[16:44:08] ℹ️    - Diagnosis 2: 'None'
[16:44:08] ℹ️    - Diagnosis 3: 'None'
[16:44:08] ℹ️    - Diagnosis 4: 'None'
[16:44:08] ℹ️    - Diagnosis 5: 'None'
[16:44:08] ℹ️    - Diagnosis 6: 'None'
[16:44:08] ℹ️  Final extracted MRN: '93005'
[16:44:08] ℹ️  Final extracted Sex: 'FEMALE'
[16:44:08] ℹ️  Final extracted Service Line: 'HHA'
[16:44:08] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance-One Care'
[16:44:08] ✅ Patient data extraction completed successfully
[16:44:08] ✅    ✅ Patient data extracted successfully
[16:44:08] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gomes
     └─ dob: 08/04/1993
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 93005
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 8 Avon St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance-One Care
     └─ episodeDiagnoses: [{'startOfCare': '08/27/2020', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:44:08] ✅    ✅ Patient identified: Laura Gomes
[16:44:08] ✅    ✅ Patient name validation passed
[16:44:08] 🔄 
🔄 Step 3: Processing patient dates...
[16:44:08] [DOC: 9216929] ℹ️  DOB normalized: 08/04/1993
[16:44:08] [DOC: 9216929] ℹ️  Episode startOfCare normalized: 08/27/2020
[16:44:08] [DOC: 9216929] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[16:44:08] [DOC: 9216929] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[16:44:08] [DOC: 9216929] ✅ Patient date processing completed successfully
[16:44:08] ✅    ✅ Date processing completed
[16:44:08] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gomes
     └─ dob: 08/04/1993
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 93005
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 8 Avon St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance-One Care
     └─ episodeDiagnoses: [{'startOfCare': '08/27/2020', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025'}]
[16:44:08] 🔄 
🔄 Step 4: Extracting order data...
[16:44:10] ℹ️  Order extraction - MRN: '93005'
[16:44:10] ℹ️  Order extraction - Sex: 'FEMALE'
[16:44:10] ℹ️  Order extraction - Service Line: 'HHA'
[16:44:10] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance-One Care'
[16:44:10] ✅ Order data extraction completed successfully
[16:44:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:44:10] ℹ️  Using MRN from patient data: '93005' over '93005'
[16:44:10] ℹ️  Service line consistent in both sources: 'HHA'
[16:44:10] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance-One Care'
[16:44:10] ✅ Patient name cross-validation successful
[16:44:10] ✅    ✅ Data merged successfully
[16:44:12] ✅    ✅ Order data extracted and validated
[16:44:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:44:12] [DOC: 9216929] ✅ Patient found in local cache: Laura Gomes, ID: 7f6aecce-ca1f-43fb-bfbb-a05403b98464
[16:44:12] ✅    ✅ Existing patient found with ID: 7f6aecce-ca1f-43fb-bfbb-a05403b98464
[16:44:12] 🔄 
🔄 Step 6: Pushing order to API...
[16:44:12] [DOC: 9216929] ℹ️  Pushing order via API for patient ID: 7f6aecce-ca1f-43fb-bfbb-a05403b98464
[16:44:13] [DOC: 9216929] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:44:13] ❌    ❌ Failed to push order
[16:44:13] 🔄 
🔄 Step 7: Writing to CSV...
[16:44:13] [DOC: 9216929] ℹ️  Calculated age: 31 from DOB: 08/04/1993
[16:44:13] [DOC: 9216929] ℹ️  Service Line extracted: 'HHA'
[16:44:13] [DOC: 9216929] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance-One Care'
[16:44:13] [DOC: 9216929] ℹ️  Diagnosis codes being written:
[16:44:13] [DOC: 9216929] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:44:13] [DOC: 9216929] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:44:13] [DOC: 9216929] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:44:13] [DOC: 9216929] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:44:13] [DOC: 9216929] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:44:13] [DOC: 9216929] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:44:13] [DOC: 9216929] ✅ Patient data written to CSV: Laura Gomes | Sex: FEMALE | Age: 31 | Service: HHA | Payer: Commonwealth Care Alliance-One Care | MRN: 93005
[16:44:13] ✅    ✅ Document 9216929 processed and saved successfully
[16:44:13] 🔄 
🔄 Step 8: Saving API details...
[16:44:13] [DOC: 9216929] ℹ️  API push details saved for document 9216929
[16:44:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216877                         ║
================================================================================
[16:44:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:44:13] ℹ️  Date: 04/02/2025
[16:44:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:44:17] [DOC: 9216877] ✅ Text extracted using pdfplumber (2391 chars)
[16:44:17] ✅    ✅ Text extracted using pdfplumber (2379 chars)
[16:44:17] 🔄 
🔄 Step 2: Extracting patient data...
[16:44:20] ℹ️  AI extracted raw sex value: ''
[16:44:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:44:20] ℹ️  AI extracted payer source: ''
[16:44:20] ℹ️  AI extracted diagnoses:
[16:44:20] ℹ️    - Diagnosis 1: 'I12.9'
[16:44:20] ℹ️    - Diagnosis 2: 'N17.9'
[16:44:20] ℹ️    - Diagnosis 3: 'G35'
[16:44:20] ℹ️    - Diagnosis 4: 'None'
[16:44:20] ℹ️    - Diagnosis 5: 'None'
[16:44:20] ℹ️    - Diagnosis 6: 'None'
[16:44:20] ℹ️  Final extracted MRN: 'MA210203125202'
[16:44:20] ℹ️  Final extracted Sex: ''
[16:44:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:44:20] ℹ️  Final extracted Payer Source: ''
[16:44:20] ✅ Patient data extraction completed successfully
[16:44:20] ✅    ✅ Patient data extracted successfully
[16:44:20] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:44:20] ✅    ✅ Patient identified: Ida Souza
[16:44:20] ✅    ✅ Patient name validation passed
[16:44:20] 🔄 
🔄 Step 3: Processing patient dates...
[16:44:20] [DOC: 9216877] ℹ️  DOB normalized: 12/11/1952
[16:44:20] [DOC: 9216877] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:44:20] [DOC: 9216877] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:44:20] [DOC: 9216877] ✅ Patient date processing completed successfully
[16:44:20] ✅    ✅ Date processing completed
[16:44:20] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[16:44:20] 🔄 
🔄 Step 4: Extracting order data...
[16:44:22] ℹ️  Order extraction - MRN: 'MA210203125202'
[16:44:22] ℹ️  Order extraction - Sex: ''
[16:44:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:44:22] ℹ️  Order extraction - Payer Source: ''
[16:44:22] ✅ Order data extraction completed successfully
[16:44:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:44:22] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[16:44:22] ⚠️  Could not determine sex using any available method
[16:44:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:44:22] ✅ Patient name cross-validation successful
[16:44:22] ✅    ✅ Data merged successfully
[16:44:23] ✅    ✅ Order data extracted and validated
[16:44:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:44:29] [DOC: 9216877] ℹ️  Patient not found in cache or API: Ida Souza
[16:44:29] [DOC: 9216877] ℹ️  Patient not found, creating new patient via API...
[16:44:29] [DOC: 9216877] ℹ️  Creating patient via API: Ida Souza
[16:44:31] [DOC: 9216877] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:44:31] ❌    ❌ Failed to create patient
[16:44:31] [DOC: 9216877] ℹ️  API push details saved for document 9216877
================================================================================
║                        Processing Document ID: 9216874                         ║
================================================================================
[16:44:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:44:31] ℹ️  Date: 04/02/2025
[16:44:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:44:35] [DOC: 9216874] ✅ Text extracted using pdfplumber (2508 chars)
[16:44:35] ✅    ✅ Text extracted using pdfplumber (2496 chars)
[16:44:35] 🔄 
🔄 Step 2: Extracting patient data...
[16:44:38] ℹ️  AI extracted raw sex value: ''
[16:44:38] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:44:38] ℹ️  AI extracted payer source: ''
[16:44:38] ℹ️  AI extracted diagnoses:
[16:44:38] ℹ️    - Diagnosis 1: 'I12.9'
[16:44:38] ℹ️    - Diagnosis 2: 'N17.9'
[16:44:38] ℹ️    - Diagnosis 3: 'G35'
[16:44:38] ℹ️    - Diagnosis 4: 'None'
[16:44:38] ℹ️    - Diagnosis 5: 'None'
[16:44:38] ℹ️    - Diagnosis 6: 'None'
[16:44:38] ℹ️  Final extracted MRN: 'MA210203125202'
[16:44:38] ℹ️  Final extracted Sex: ''
[16:44:38] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:44:38] ℹ️  Final extracted Payer Source: ''
[16:44:38] ✅ Patient data extraction completed successfully
[16:44:38] ✅    ✅ Patient data extracted successfully
[16:44:38] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:44:38] ✅    ✅ Patient identified: Ida Souza
[16:44:38] ✅    ✅ Patient name validation passed
[16:44:38] 🔄 
🔄 Step 3: Processing patient dates...
[16:44:38] [DOC: 9216874] ℹ️  DOB normalized: 12/11/1952
[16:44:38] [DOC: 9216874] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:44:38] [DOC: 9216874] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:44:38] [DOC: 9216874] ✅ Patient date processing completed successfully
[16:44:38] ✅    ✅ Date processing completed
[16:44:38] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[16:44:38] 🔄 
🔄 Step 4: Extracting order data...
[16:44:41] ℹ️  Order extraction - MRN: 'MA210203125202'
[16:44:41] ℹ️  Order extraction - Sex: ''
[16:44:41] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:44:41] ℹ️  Order extraction - Payer Source: ''
[16:44:41] ✅ Order data extraction completed successfully
[16:44:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:44:41] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[16:44:41] ⚠️  Could not determine sex using any available method
[16:44:41] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:44:41] ✅ Patient name cross-validation successful
[16:44:41] ✅    ✅ Data merged successfully
[16:44:42] ✅    ✅ Order data extracted and validated
[16:44:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:44:54] [DOC: 9216874] ℹ️  Patient not found in cache or API: Ida Souza
[16:44:54] [DOC: 9216874] ℹ️  Patient not found, creating new patient via API...
[16:44:54] [DOC: 9216874] ℹ️  Creating patient via API: Ida Souza
[16:44:55] [DOC: 9216874] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:44:55] ❌    ❌ Failed to create patient
[16:44:55] [DOC: 9216874] ℹ️  API push details saved for document 9216874
================================================================================
║                        Processing Document ID: 9216869                         ║
================================================================================
[16:44:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:44:55] ℹ️  Date: 04/02/2025
[16:44:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:44:59] [DOC: 9216869] ✅ Text extracted using pdfplumber (2569 chars)
[16:44:59] ✅    ✅ Text extracted using pdfplumber (2557 chars)
[16:44:59] 🔄 
🔄 Step 2: Extracting patient data...
[16:45:02] ℹ️  AI extracted raw sex value: ''
[16:45:02] ℹ️  AI extracted service line: 'Physical Therapy'
[16:45:02] ℹ️  AI extracted payer source: ''
[16:45:02] ℹ️  AI extracted diagnoses:
[16:45:02] ℹ️    - Diagnosis 1: 'I12.9'
[16:45:02] ℹ️    - Diagnosis 2: 'N17.9'
[16:45:02] ℹ️    - Diagnosis 3: 'G35'
[16:45:02] ℹ️    - Diagnosis 4: 'None'
[16:45:02] ℹ️    - Diagnosis 5: 'None'
[16:45:02] ℹ️    - Diagnosis 6: 'None'
[16:45:02] ℹ️  Final extracted MRN: 'MA210203125202'
[16:45:02] ℹ️  Final extracted Sex: ''
[16:45:02] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:45:02] ℹ️  Final extracted Payer Source: ''
[16:45:02] ✅ Patient data extraction completed successfully
[16:45:02] ✅    ✅ Patient data extracted successfully
[16:45:02] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:45:02] ✅    ✅ Patient identified: Ida Souza
[16:45:02] ✅    ✅ Patient name validation passed
[16:45:02] 🔄 
🔄 Step 3: Processing patient dates...
[16:45:02] [DOC: 9216869] ℹ️  DOB normalized: 12/11/1952
[16:45:02] [DOC: 9216869] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:45:02] [DOC: 9216869] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:45:02] [DOC: 9216869] ✅ Patient date processing completed successfully
[16:45:02] ✅    ✅ Date processing completed
[16:45:02] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[16:45:02] 🔄 
🔄 Step 4: Extracting order data...
[16:45:04] ℹ️  Order extraction - MRN: 'MA210203125202'
[16:45:04] ℹ️  Order extraction - Sex: ''
[16:45:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:45:04] ℹ️  Order extraction - Payer Source: ''
[16:45:04] ✅ Order data extraction completed successfully
[16:45:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:45:04] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[16:45:04] ⚠️  Could not determine sex using any available method
[16:45:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:45:04] ✅ Patient name cross-validation successful
[16:45:04] ✅    ✅ Data merged successfully
[16:45:05] ✅    ✅ Order data extracted and validated
[16:45:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:45:33] [DOC: 9216869] ℹ️  Patient not found in cache or API: Ida Souza
[16:45:33] [DOC: 9216869] ℹ️  Patient not found, creating new patient via API...
[16:45:33] [DOC: 9216869] ℹ️  Creating patient via API: Ida Souza
[16:45:35] [DOC: 9216869] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:45:35] ❌    ❌ Failed to create patient
[16:45:35] [DOC: 9216869] ℹ️  API push details saved for document 9216869
================================================================================
║                        Processing Document ID: 9216862                         ║
================================================================================
[16:45:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:45:35] ℹ️  Date: 04/02/2025
[16:45:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:45:40] [DOC: 9216862] ✅ Text extracted using pdfplumber (11500 chars)
[16:45:40] ✅    ✅ Text extracted using pdfplumber (11500 chars)
[16:45:40] 🔄 
🔄 Step 2: Extracting patient data...
[16:45:43] ℹ️  AI extracted raw sex value: 'M'
[16:45:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:45:43] ℹ️  AI extracted payer source: 'SWH'
[16:45:43] ℹ️  AI extracted diagnoses:
[16:45:43] ℹ️    - Diagnosis 1: 'E11.65'
[16:45:43] ℹ️    - Diagnosis 2: 'I10'
[16:45:43] ℹ️    - Diagnosis 3: 'J43.9'
[16:45:43] ℹ️    - Diagnosis 4: 'E78.00'
[16:45:43] ℹ️    - Diagnosis 5: 'F41.1'
[16:45:43] ℹ️    - Diagnosis 6: 'G60.9'
[16:45:43] ℹ️  Final extracted MRN: 'MA240320075402'
[16:45:43] ℹ️  Final extracted Sex: 'MALE'
[16:45:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:45:43] ℹ️  Final extracted Payer Source: 'SWH'
[16:45:43] ✅ Patient data extraction completed successfully
[16:45:43] ✅    ✅ Patient data extracted successfully
[16:45:43] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Mello
     └─ dob: 07/12/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240320075402
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 146 Summit St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 301-7002
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'J43.9', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'G60.9'}]
[16:45:43] ✅    ✅ Patient identified: David Mello
[16:45:43] ✅    ✅ Patient name validation passed
[16:45:43] 🔄 
🔄 Step 3: Processing patient dates...
[16:45:43] [DOC: 9216862] ℹ️  DOB normalized: 07/12/1954
[16:45:43] [DOC: 9216862] ℹ️  Episode startOfCare normalized: 03/21/2024
[16:45:43] [DOC: 9216862] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[16:45:43] [DOC: 9216862] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[16:45:43] [DOC: 9216862] ✅ Patient date processing completed successfully
[16:45:43] ✅    ✅ Date processing completed
[16:45:43] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Mello
     └─ dob: 07/12/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240320075402
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 146 Summit St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 301-7002
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'J43.9', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'G60.9'}]
[16:45:43] 🔄 
🔄 Step 4: Extracting order data...
[16:45:46] ℹ️  Order extraction - MRN: 'MA240320075402'
[16:45:46] ℹ️  Order extraction - Sex: 'MALE'
[16:45:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:45:46] ℹ️  Order extraction - Payer Source: 'SWH'
[16:45:46] ✅ Order data extraction completed successfully
[16:45:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:45:46] ℹ️  Using MRN from patient data: 'MA240320075402' over 'MA240320075402'
[16:45:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:45:46] ℹ️  Payer source consistent in both sources: 'SWH'
[16:45:46] ✅ Patient name cross-validation successful
[16:45:46] ✅    ✅ Data merged successfully
[16:45:48] ✅    ✅ Order data extracted and validated
[16:45:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:45:54] [DOC: 9216862] ℹ️  Patient not found in cache or API: David Mello
[16:45:54] [DOC: 9216862] ℹ️  Patient not found, creating new patient via API...
[16:45:54] [DOC: 9216862] ℹ️  Creating patient via API: David Mello
[16:45:55] [DOC: 9216862] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:45:55] ❌    ❌ Failed to create patient
[16:45:55] [DOC: 9216862] ℹ️  API push details saved for document 9216862
================================================================================
║                        Processing Document ID: 9216842                         ║
================================================================================
[16:45:55] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:45:55] ℹ️  Date: 04/02/2025
[16:45:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:45:57] [DOC: 9216842] ✅ Text extracted using pdfplumber (5717 chars)
[16:45:57] ✅    ✅ Text extracted using pdfplumber (5717 chars)
[16:45:57] 🔄 
🔄 Step 2: Extracting patient data...
[16:46:00] ℹ️  AI extracted raw sex value: 'M'
[16:46:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:46:00] ℹ️  AI extracted payer source: ''
[16:46:00] ℹ️  AI extracted diagnoses:
[16:46:00] ℹ️    - Diagnosis 1: 'F32.9'
[16:46:00] ℹ️    - Diagnosis 2: 'E11.9'
[16:46:00] ℹ️    - Diagnosis 3: 'F81.9'
[16:46:00] ℹ️    - Diagnosis 4: 'F90.9'
[16:46:00] ℹ️    - Diagnosis 5: 'F41.9'
[16:46:00] ℹ️    - Diagnosis 6: 'I10'
[16:46:00] ℹ️  Final extracted MRN: '139005'
[16:46:00] ℹ️  Final extracted Sex: 'MALE'
[16:46:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:46:00] ℹ️  Final extracted Payer Source: ''
[16:46:00] ✅ Patient data extraction completed successfully
[16:46:00] ✅    ✅ Patient data extracted successfully
[16:46:00] 📊 Patient Response
     └─ patientFName: Lemmuel
     └─ patientLName: Lomba
     └─ dob: 08/15/2003
     └─ patientSex: MALE
     └─ medicalRecordNo: 139005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 100031908435
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2021', 'startOfEpisode': '02/24/2021', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F81.9', 'fourthDiagnosis': 'F90.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[16:46:00] ✅    ✅ Patient identified: Lemmuel Lomba
[16:46:00] ✅    ✅ Patient name validation passed
[16:46:00] 🔄 
🔄 Step 3: Processing patient dates...
[16:46:00] [DOC: 9216842] ℹ️  DOB normalized: 08/15/2003
[16:46:00] [DOC: 9216842] ℹ️  Episode startOfCare normalized: 02/24/2021
[16:46:00] [DOC: 9216842] ℹ️  Episode startOfEpisode normalized: 02/24/2021
[16:46:00] [DOC: 9216842] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[16:46:00] [DOC: 9216842] ✅ Patient date processing completed successfully
[16:46:00] ✅    ✅ Date processing completed
[16:46:00] 📊 Processed Patient Data
     └─ patientFName: Lemmuel
     └─ patientLName: Lomba
     └─ dob: 08/15/2003
     └─ patientSex: MALE
     └─ medicalRecordNo: 139005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 100031908435
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2021', 'startOfEpisode': '02/24/2021', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F81.9', 'fourthDiagnosis': 'F90.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[16:46:00] 🔄 
🔄 Step 4: Extracting order data...
[16:46:03] ℹ️  Order extraction - MRN: '139005'
[16:46:03] ℹ️  Order extraction - Sex: 'MALE'
[16:46:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:46:03] ℹ️  Order extraction - Payer Source: ''
[16:46:03] ✅ Order data extraction completed successfully
[16:46:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:46:03] ℹ️  Using MRN from patient data: '139005' over '139005'
[16:46:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:46:03] ✅ Patient name cross-validation successful
[16:46:03] ✅    ✅ Data merged successfully
[16:46:04] ✅    ✅ Order data extracted and validated
[16:46:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:46:04] [DOC: 9216842] ✅ Patient found in local cache: Lemmuel Lomba, ID: 0836dc34-5724-4813-b116-dff31377a557
[16:46:04] ✅    ✅ Existing patient found with ID: 0836dc34-5724-4813-b116-dff31377a557
[16:46:04] 🔄 
🔄 Step 6: Pushing order to API...
[16:46:04] [DOC: 9216842] ℹ️  Pushing order via API for patient ID: 0836dc34-5724-4813-b116-dff31377a557
[16:46:05] [DOC: 9216842] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19939"}
[16:46:05] ❌    ❌ Failed to push order
[16:46:05] 🔄 
🔄 Step 7: Writing to CSV...
[16:46:05] [DOC: 9216842] ℹ️  Calculated age: 21 from DOB: 08/15/2003
[16:46:05] [DOC: 9216842] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:46:05] [DOC: 9216842] ℹ️  Payer Source extracted: ''
[16:46:05] [DOC: 9216842] ℹ️  Diagnosis codes being written:
[16:46:05] [DOC: 9216842] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.9'
[16:46:05] [DOC: 9216842] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[16:46:05] [DOC: 9216842] ℹ️    - Latest_Episode_Thirddiagnosis: 'F81.9'
[16:46:05] [DOC: 9216842] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F90.9'
[16:46:05] [DOC: 9216842] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[16:46:05] [DOC: 9216842] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[16:46:05] [DOC: 9216842] ✅ Patient data written to CSV: Lemmuel Lomba | Sex: MALE | Age: 21 | Service: Skilled Nursing | Payer:  | MRN: 139005
[16:46:05] ✅    ✅ Document 9216842 processed and saved successfully
[16:46:05] 🔄 
🔄 Step 8: Saving API details...
[16:46:05] [DOC: 9216842] ℹ️  API push details saved for document 9216842
[16:46:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216815                         ║
================================================================================
[16:46:05] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:46:05] ℹ️  Date: 04/02/2025
[16:46:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:46:08] [DOC: 9216815] ✅ Text extracted using pdfplumber (12342 chars)
[16:46:08] ✅    ✅ Text extracted using pdfplumber (12342 chars)
[16:46:08] 🔄 
🔄 Step 2: Extracting patient data...
[16:46:11] ℹ️  AI extracted raw sex value: 'F'
[16:46:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:46:11] ℹ️  AI extracted payer source: ''
[16:46:11] ℹ️  AI extracted diagnoses:
[16:46:11] ℹ️    - Diagnosis 1: 'F31.32'
[16:46:11] ℹ️    - Diagnosis 2: 'F43.10'
[16:46:11] ℹ️    - Diagnosis 3: 'C49.A3'
[16:46:11] ℹ️    - Diagnosis 4: 'E11.9'
[16:46:11] ℹ️    - Diagnosis 5: 'I10'
[16:46:11] ℹ️    - Diagnosis 6: 'R00.0'
[16:46:11] ℹ️  Final extracted MRN: '523'
[16:46:11] ℹ️  Final extracted Sex: 'FEMALE'
[16:46:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:46:11] ℹ️  Final extracted Payer Source: ''
[16:46:11] ✅ Patient data extraction completed successfully
[16:46:11] ✅    ✅ Patient data extracted successfully
[16:46:11] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Gomes
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 523
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 022504731
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2010', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'F31.32', 'secondDiagnosis': 'F43.10', 'thirdDiagnosis': 'C49.A3', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R00.0'}]
[16:46:11] ✅    ✅ Patient identified: Dorothy Gomes
[16:46:11] ✅    ✅ Patient name validation passed
[16:46:11] 🔄 
🔄 Step 3: Processing patient dates...
[16:46:11] [DOC: 9216815] ℹ️  DOB normalized: 02/15/1959
[16:46:11] [DOC: 9216815] ℹ️  Episode startOfCare normalized: 10/19/2010
[16:46:11] [DOC: 9216815] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[16:46:11] [DOC: 9216815] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[16:46:11] [DOC: 9216815] ✅ Patient date processing completed successfully
[16:46:11] ✅    ✅ Date processing completed
[16:46:11] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Gomes
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 523
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 022504731
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2010', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'F31.32', 'secondDiagnosis': 'F43.10', 'thirdDiagnosis': 'C49.A3', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R00.0'}]
[16:46:11] 🔄 
🔄 Step 4: Extracting order data...
[16:46:14] ℹ️  Order extraction - MRN: '523'
[16:46:14] ℹ️  Order extraction - Sex: 'FEMALE'
[16:46:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:46:14] ℹ️  Order extraction - Payer Source: ''
[16:46:14] ✅ Order data extraction completed successfully
[16:46:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:46:14] ℹ️  Using MRN from patient data: '523' over '523'
[16:46:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:46:14] ✅ Patient name cross-validation successful
[16:46:14] ✅    ✅ Data merged successfully
[16:46:15] ✅    ✅ Order data extracted and validated
[16:46:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:46:15] [DOC: 9216815] ✅ Patient found in local cache: Dorothy Gomes, ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[16:46:15] ✅    ✅ Existing patient found with ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[16:46:15] 🔄 
🔄 Step 6: Pushing order to API...
[16:46:15] [DOC: 9216815] ℹ️  Pushing order via API for patient ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[16:46:16] [DOC: 9216815] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:46:16] ❌    ❌ Failed to push order
[16:46:16] 🔄 
🔄 Step 7: Writing to CSV...
[16:46:16] [DOC: 9216815] ℹ️  Calculated age: 66 from DOB: 02/15/1959
[16:46:16] [DOC: 9216815] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:46:16] [DOC: 9216815] ℹ️  Payer Source extracted: ''
[16:46:16] [DOC: 9216815] ℹ️  Diagnosis codes being written:
[16:46:16] [DOC: 9216815] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.32'
[16:46:16] [DOC: 9216815] ℹ️    - Latest_Episode_Seconddiagnosis: 'F43.10'
[16:46:16] [DOC: 9216815] ℹ️    - Latest_Episode_Thirddiagnosis: 'C49.A3'
[16:46:16] [DOC: 9216815] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[16:46:16] [DOC: 9216815] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[16:46:16] [DOC: 9216815] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R00.0'
[16:46:16] [DOC: 9216815] ✅ Patient data written to CSV: Dorothy Gomes | Sex: FEMALE | Age: 66 | Service: Skilled Nursing | Payer:  | MRN: 523
[16:46:16] ✅    ✅ Document 9216815 processed and saved successfully
[16:46:16] 🔄 
🔄 Step 8: Saving API details...
[16:46:16] [DOC: 9216815] ℹ️  API push details saved for document 9216815
[16:46:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216796                         ║
================================================================================
[16:46:16] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:46:16] ℹ️  Date: 04/02/2025
[16:46:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:46:19] [DOC: 9216796] ✅ Text extracted using pdfplumber (6706 chars)
[16:46:19] ✅    ✅ Text extracted using pdfplumber (6694 chars)
[16:46:19] 🔄 
🔄 Step 2: Extracting patient data...
[16:46:22] ℹ️  AI extracted raw sex value: 'F'
[16:46:22] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[16:46:22] ℹ️  AI extracted payer source: ''
[16:46:22] ℹ️  AI extracted diagnoses:
[16:46:22] ℹ️    - Diagnosis 1: 'E11.22'
[16:46:22] ℹ️    - Diagnosis 2: 'I13.0'
[16:46:22] ℹ️    - Diagnosis 3: 'I50.32'
[16:46:22] ℹ️    - Diagnosis 4: 'N18.30'
[16:46:22] ℹ️    - Diagnosis 5: 'D63.1'
[16:46:22] ℹ️    - Diagnosis 6: 'F41.8'
[16:46:22] ℹ️  Final extracted MRN: '227504'
[16:46:22] ℹ️  Final extracted Sex: 'FEMALE'
[16:46:22] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[16:46:22] ℹ️  Final extracted Payer Source: ''
[16:46:22] ✅ Patient data extraction completed successfully
[16:46:22] ✅    ✅ Patient data extracted successfully
[16:46:22] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227504
     └─ billingProvider: Shan Qin, MD
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[16:46:22] ✅    ✅ Patient identified: Lorraine Moniz
[16:46:22] ✅    ✅ Patient name validation passed
[16:46:22] 🔄 
🔄 Step 3: Processing patient dates...
[16:46:22] [DOC: 9216796] ℹ️  DOB normalized: 07/18/1944
[16:46:22] [DOC: 9216796] ℹ️  Episode startOfCare normalized: 04/05/2024
[16:46:22] [DOC: 9216796] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[16:46:22] [DOC: 9216796] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[16:46:22] [DOC: 9216796] ✅ Patient date processing completed successfully
[16:46:22] ✅    ✅ Date processing completed
[16:46:22] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227504
     └─ billingProvider: Shan Qin, MD
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[16:46:22] 🔄 
🔄 Step 4: Extracting order data...
[16:46:25] ℹ️  Order extraction - MRN: '227504'
[16:46:25] ℹ️  Order extraction - Sex: 'FEMALE'
[16:46:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[16:46:25] ℹ️  Order extraction - Payer Source: ''
[16:46:25] ✅ Order data extraction completed successfully
[16:46:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:46:25] ℹ️  Using MRN from patient data: '227504' over '227504'
[16:46:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[16:46:25] ✅ Patient name cross-validation successful
[16:46:25] ✅    ✅ Data merged successfully
[16:46:26] ✅    ✅ Order data extracted and validated
[16:46:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:46:35] [DOC: 9216796] ✅ Patient exists in API: Lorraine Moniz, ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[16:46:35] ✅    ✅ Existing patient found with ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[16:46:35] 🔄 
🔄 Step 6: Pushing order to API...
[16:46:35] [DOC: 9216796] ℹ️  Pushing order via API for patient ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[16:46:36] [DOC: 9216796] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:46:36] ❌    ❌ Failed to push order
[16:46:36] 🔄 
🔄 Step 7: Writing to CSV...
[16:46:36] [DOC: 9216796] ℹ️  Calculated age: 80 from DOB: 07/18/1944
[16:46:36] [DOC: 9216796] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[16:46:36] [DOC: 9216796] ℹ️  Payer Source extracted: ''
[16:46:36] [DOC: 9216796] ℹ️  Diagnosis codes being written:
[16:46:36] [DOC: 9216796] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[16:46:36] [DOC: 9216796] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[16:46:36] [DOC: 9216796] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[16:46:36] [DOC: 9216796] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[16:46:36] [DOC: 9216796] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[16:46:36] [DOC: 9216796] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.8'
[16:46:36] [DOC: 9216796] ✅ Patient data written to CSV: Lorraine Moniz | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, PT | Payer:  | MRN: 227504
[16:46:36] ✅    ✅ Document 9216796 processed and saved successfully
[16:46:36] 🔄 
🔄 Step 8: Saving API details...
[16:46:36] [DOC: 9216796] ℹ️  API push details saved for document 9216796
[16:46:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216794                         ║
================================================================================
[16:46:36] ℹ️  Agency: Relief Home Health Services
[16:46:36] ℹ️  Date: 04/02/2025
[16:46:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:46:39] [DOC: 9216794] ✅ Text extracted using pdfplumber (20937 chars)
[16:46:39] ✅    ✅ Text extracted using pdfplumber (20937 chars)
[16:46:39] 🔄 
🔄 Step 2: Extracting patient data...
[16:46:43] ℹ️  AI extracted raw sex value: 'M'
[16:46:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:46:43] ℹ️  AI extracted payer source: ''
[16:46:43] ℹ️  AI extracted diagnoses:
[16:46:43] ℹ️    - Diagnosis 1: 'F20.0'
[16:46:43] ℹ️    - Diagnosis 2: 'I10'
[16:46:43] ℹ️    - Diagnosis 3: 'F41.9'
[16:46:43] ℹ️    - Diagnosis 4: 'R44.0'
[16:46:43] ℹ️    - Diagnosis 5: 'M43.02'
[16:46:43] ℹ️    - Diagnosis 6: 'N40.0'
[16:46:43] ℹ️  Final extracted MRN: 'NB0142'
[16:46:43] ℹ️  Final extracted Sex: 'MALE'
[16:46:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:46:43] ℹ️  Final extracted Payer Source: ''
[16:46:43] ✅ Patient data extraction completed successfully
[16:46:43] ✅    ✅ Patient data extracted successfully
[16:46:43] 📊 Patient Response
     └─ patientFName: MARIO
     └─ patientLName: RESENDES
     └─ dob: 03/22/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0142
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 170 Riverside Ave Apt 126
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/30/2023', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'R44.0', 'fifthDiagnosis': 'M43.02', 'sixthDiagnosis': 'N40.0'}]
[16:46:43] ✅    ✅ Patient identified: MARIO RESENDES
[16:46:43] ✅    ✅ Patient name validation passed
[16:46:43] 🔄 
🔄 Step 3: Processing patient dates...
[16:46:43] [DOC: 9216794] ℹ️  DOB normalized: 03/22/1956
[16:46:43] [DOC: 9216794] ℹ️  Episode startOfCare normalized: 08/30/2023
[16:46:43] [DOC: 9216794] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[16:46:43] [DOC: 9216794] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[16:46:43] [DOC: 9216794] ✅ Patient date processing completed successfully
[16:46:43] ✅    ✅ Date processing completed
[16:46:43] 📊 Processed Patient Data
     └─ patientFName: MARIO
     └─ patientLName: RESENDES
     └─ dob: 03/22/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0142
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 170 Riverside Ave Apt 126
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/30/2023', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'R44.0', 'fifthDiagnosis': 'M43.02', 'sixthDiagnosis': 'N40.0'}]
[16:46:43] 🔄 
🔄 Step 4: Extracting order data...
[16:46:45] ℹ️  Order extraction - MRN: 'NB0142'
[16:46:45] ℹ️  Order extraction - Sex: 'MALE'
[16:46:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:46:45] ℹ️  Order extraction - Payer Source: ''
[16:46:45] ✅ Order data extraction completed successfully
[16:46:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:46:45] ℹ️  Using MRN from patient data: 'NB0142' over 'NB0142'
[16:46:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:46:45] ✅ Patient name cross-validation successful
[16:46:45] ✅    ✅ Data merged successfully
[16:46:47] ✅    ✅ Order data extracted and validated
[16:46:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:46:54] [DOC: 9216794] ✅ Patient exists in API: MARIO RESENDES, ID: 08848138-a40c-4cd5-9d6d-4659da3b8628
[16:46:54] ✅    ✅ Existing patient found with ID: 08848138-a40c-4cd5-9d6d-4659da3b8628
[16:46:54] 🔄 
🔄 Step 6: Pushing order to API...
[16:46:54] [DOC: 9216794] ℹ️  Pushing order via API for patient ID: 08848138-a40c-4cd5-9d6d-4659da3b8628
[16:46:55] [DOC: 9216794] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:46:55] ❌    ❌ Failed to push order
[16:46:55] 🔄 
🔄 Step 7: Writing to CSV...
[16:46:55] [DOC: 9216794] ℹ️  Calculated age: 69 from DOB: 03/22/1956
[16:46:55] [DOC: 9216794] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:46:55] [DOC: 9216794] ℹ️  Payer Source extracted: ''
[16:46:55] [DOC: 9216794] ℹ️  Diagnosis codes being written:
[16:46:55] [DOC: 9216794] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.0'
[16:46:55] [DOC: 9216794] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[16:46:55] [DOC: 9216794] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[16:46:55] [DOC: 9216794] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R44.0'
[16:46:55] [DOC: 9216794] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M43.02'
[16:46:55] [DOC: 9216794] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.0'
[16:46:55] [DOC: 9216794] ✅ Patient data written to CSV: MARIO RESENDES | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer:  | MRN: NB0142
[16:46:55] ✅    ✅ Document 9216794 processed and saved successfully
[16:46:55] 🔄 
🔄 Step 8: Saving API details...
[16:46:55] [DOC: 9216794] ℹ️  API push details saved for document 9216794
[16:46:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216661                         ║
================================================================================
[16:46:55] ℹ️  Agency: AccentCare Fall River
[16:46:55] ℹ️  Date: 04/02/2025
[16:46:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:46:58] [DOC: 9216661] ✅ Text extracted using pdfplumber (1166 chars)
[16:46:58] ✅    ✅ Text extracted using pdfplumber (1166 chars)
[16:46:58] 🔄 
🔄 Step 2: Extracting patient data...
[16:47:01] ℹ️  AI extracted raw sex value: ''
[16:47:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:47:01] ℹ️  AI extracted payer source: ''
[16:47:01] ℹ️  AI extracted diagnoses:
[16:47:01] ℹ️    - Diagnosis 1: 'BOWEL OBSTRUCTION'
[16:47:01] ℹ️    - Diagnosis 2: 'NSTEMI'
[16:47:01] ℹ️    - Diagnosis 3: ''
[16:47:01] ℹ️    - Diagnosis 4: ''
[16:47:01] ℹ️    - Diagnosis 5: ''
[16:47:01] ℹ️    - Diagnosis 6: ''
[16:47:01] ℹ️  Final extracted MRN: 'C0200233174201'
[16:47:01] ℹ️  Final extracted Sex: ''
[16:47:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:47:01] ℹ️  Final extracted Payer Source: ''
[16:47:01] ✅ Patient data extraction completed successfully
[16:47:01] ✅    ✅ Patient data extracted successfully
[16:47:01] 📊 Patient Response
     └─ patientFName: CLAUDETTE
     └─ patientLName: LEMOS
     └─ dob: 08/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: C0200233174201
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': 'BOWEL OBSTRUCTION', 'secondDiagnosis': 'NSTEMI', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:47:01] ✅    ✅ Patient identified: CLAUDETTE LEMOS
[16:47:01] ✅    ✅ Patient name validation passed
[16:47:01] 🔄 
🔄 Step 3: Processing patient dates...
[16:47:01] [DOC: 9216661] ℹ️  DOB normalized: 08/17/1948
[16:47:01] [DOC: 9216661] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[16:47:01] [DOC: 9216661] ℹ️  Episode endOfEpisode normalized: 03/08/2025
[16:47:01] [DOC: 9216661] ✅ Patient date processing completed successfully
[16:47:01] ✅    ✅ Date processing completed
[16:47:01] 📊 Processed Patient Data
     └─ patientFName: CLAUDETTE
     └─ patientLName: LEMOS
     └─ dob: 08/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: C0200233174201
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': 'BOWEL OBSTRUCTION', 'secondDiagnosis': 'NSTEMI', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:47:01] 🔄 
🔄 Step 4: Extracting order data...
[16:47:03] ℹ️  Order extraction - MRN: 'C0200233174201'
[16:47:03] ℹ️  Order extraction - Sex: ''
[16:47:03] ℹ️  Order extraction - Service Line: 'RN'
[16:47:03] ℹ️  Order extraction - Payer Source: ''
[16:47:03] ✅ Order data extraction completed successfully
[16:47:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:47:03] ℹ️  Using MRN from patient data: 'C0200233174201' over 'C0200233174201'
[16:47:03] ⚠️  Could not determine sex using any available method
[16:47:03] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[16:47:03] ✅ Patient name cross-validation successful
[16:47:03] ✅    ✅ Data merged successfully
[16:47:05] ✅    ✅ Order data extracted and validated
[16:47:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:47:05] [DOC: 9216661] ✅ Patient found in local cache: CLAUDETTE LEMOS, ID: b50ff72b-362d-4117-be74-da5fd5b5ed5f
[16:47:05] ✅    ✅ Existing patient found with ID: b50ff72b-362d-4117-be74-da5fd5b5ed5f
[16:47:05] 🔄 
🔄 Step 6: Pushing order to API...
[16:47:05] [DOC: 9216661] ℹ️  Pushing order via API for patient ID: b50ff72b-362d-4117-be74-da5fd5b5ed5f
[16:47:06] [DOC: 9216661] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13934"}
[16:47:06] ❌    ❌ Failed to push order
[16:47:06] 🔄 
🔄 Step 7: Writing to CSV...
[16:47:06] [DOC: 9216661] ℹ️  Calculated age: 76 from DOB: 08/17/1948
[16:47:06] [DOC: 9216661] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[16:47:06] [DOC: 9216661] ℹ️  Payer Source extracted: ''
[16:47:06] [DOC: 9216661] ℹ️  Diagnosis codes being written:
[16:47:06] [DOC: 9216661] ℹ️    - Latest_Episode_Firstdiagnosis: 'BOWEL OBSTRUCTION'
[16:47:06] [DOC: 9216661] ℹ️    - Latest_Episode_Seconddiagnosis: 'NSTEMI'
[16:47:06] [DOC: 9216661] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:47:06] [DOC: 9216661] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:47:06] [DOC: 9216661] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:47:06] [DOC: 9216661] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:47:06] [DOC: 9216661] ✅ Patient data written to CSV: CLAUDETTE LEMOS | Sex:  | Age: 76 | Service: RN, Skilled Nursing | Payer:  | MRN: C0200233174201
[16:47:06] ✅    ✅ Document 9216661 processed and saved successfully
[16:47:06] 🔄 
🔄 Step 8: Saving API details...
[16:47:06] [DOC: 9216661] ℹ️  API push details saved for document 9216661
[16:47:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216448                         ║
================================================================================
[16:47:06] ℹ️  Agency: Fairhaven HH&H
[16:47:06] ℹ️  Date: 04/02/2025
[16:47:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:47:07] [DOC: 9216448] ❌ Critical failure in get_pdf_text: Invalid response format
[16:47:07] ❌ Failed to extract text for Doc ID 9216448
[16:47:07] [DOC: 9216448] ℹ️  API push details saved for document 9216448
================================================================================
║                        Processing Document ID: 9216435                         ║
================================================================================
[16:47:07] ℹ️  Agency: Dartmouth HH
[16:47:07] ℹ️  Date: 04/02/2025
[16:47:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:47:15] [DOC: 9216435] ✅ Text extracted using pdfplumber (17498 chars)
[16:47:15] ✅    ✅ Text extracted using pdfplumber (17486 chars)
[16:47:15] 🔄 
🔄 Step 2: Extracting patient data...
[16:47:18] ℹ️  AI extracted raw sex value: 'F'
[16:47:18] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[16:47:18] ℹ️  AI extracted payer source: 'None'
[16:47:18] ℹ️  AI extracted diagnoses:
[16:47:18] ℹ️    - Diagnosis 1: 'S72.031D'
[16:47:18] ℹ️    - Diagnosis 2: 'I10'
[16:47:18] ℹ️    - Diagnosis 3: 'M51.87'
[16:47:18] ℹ️    - Diagnosis 4: 'G60.9'
[16:47:18] ℹ️    - Diagnosis 5: 'I73.9'
[16:47:18] ℹ️    - Diagnosis 6: 'K21.9'
[16:47:18] ℹ️  Final extracted MRN: '382011'
[16:47:18] ℹ️  Final extracted Sex: 'FEMALE'
[16:47:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[16:47:18] ℹ️  Final extracted Payer Source: ''
[16:47:18] ✅ Patient data extraction completed successfully
[16:47:18] ✅    ✅ Patient data extracted successfully
[16:47:18] 📊 Patient Response
     └─ patientFName: Saint Aubin, Marilyn
     └─ patientLName: 
     └─ dob: 08/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 382011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'S72.031D', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M51.87', 'fourthDiagnosis': 'G60.9', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'K21.9'}]
[16:47:18] ❌    ❌ INVALID PATIENT NAME DETECTED: Names too short: 'Saint Aubin, Marilyn' ''
[16:47:18] ❌    🚫 BLOCKING API PUSH to prevent invalid data in production
[16:47:18] [DOC: 9216435] ℹ️  API push details saved for document 9216435
================================================================================
║                        Processing Document ID: 9216426                         ║
================================================================================
[16:47:18] ℹ️  Agency: Dartmouth HH
[16:47:18] ℹ️  Date: 04/02/2025
[16:47:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:47:20] [DOC: 9216426] ✅ Text extracted using pdfplumber (9886 chars)
[16:47:20] ✅    ✅ Text extracted using pdfplumber (9886 chars)
[16:47:20] 🔄 
🔄 Step 2: Extracting patient data...
[16:47:24] ℹ️  AI extracted raw sex value: 'F'
[16:47:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:47:24] ℹ️  AI extracted payer source: 'Medicare'
[16:47:24] ℹ️  AI extracted diagnoses:
[16:47:24] ℹ️    - Diagnosis 1: 'I26.99'
[16:47:24] ℹ️    - Diagnosis 2: 'I35.0'
[16:47:24] ℹ️    - Diagnosis 3: 'I48.0'
[16:47:24] ℹ️    - Diagnosis 4: 'I13.0'
[16:47:24] ℹ️    - Diagnosis 5: 'I50.32'
[16:47:24] ℹ️    - Diagnosis 6: 'N18.32'
[16:47:24] ℹ️  Final extracted MRN: '771002'
[16:47:24] ℹ️  Final extracted Sex: 'FEMALE'
[16:47:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:47:24] ℹ️  Final extracted Payer Source: 'Medicare'
[16:47:24] ✅ Patient data extraction completed successfully
[16:47:24] ✅    ✅ Patient data extracted successfully
[16:47:24] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'I35.0', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'N18.32'}]
[16:47:24] ✅    ✅ Patient identified: Kathryn McCollester
[16:47:24] ✅    ✅ Patient name validation passed
[16:47:24] 🔄 
🔄 Step 3: Processing patient dates...
[16:47:24] [DOC: 9216426] ℹ️  DOB normalized: 09/24/1930
[16:47:24] [DOC: 9216426] ℹ️  Episode startOfCare normalized: 02/17/2025
[16:47:24] [DOC: 9216426] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[16:47:24] [DOC: 9216426] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[16:47:24] [DOC: 9216426] ✅ Patient date processing completed successfully
[16:47:24] ✅    ✅ Date processing completed
[16:47:24] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'I35.0', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'N18.32'}]
[16:47:24] 🔄 
🔄 Step 4: Extracting order data...
[16:47:26] ℹ️  Order extraction - MRN: ''
[16:47:26] ℹ️  Order extraction - Sex: 'FEMALE'
[16:47:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:47:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:47:26] ✅ Order data extraction completed successfully
[16:47:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:47:26] ℹ️  Using MRN from patient data: '771002'
[16:47:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:47:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:47:26] ✅ Patient name cross-validation successful
[16:47:26] ✅    ✅ Data merged successfully
[16:47:27] ✅    ✅ Order data extracted and validated
[16:47:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:47:27] [DOC: 9216426] ✅ Patient found in local cache: Kathryn McCollester, ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[16:47:27] ✅    ✅ Existing patient found with ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[16:47:27] 🔄 
🔄 Step 6: Pushing order to API...
[16:47:27] [DOC: 9216426] ℹ️  Pushing order via API for patient ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[16:47:29] [DOC: 9216426] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14051"}
[16:47:29] ❌    ❌ Failed to push order
[16:47:29] 🔄 
🔄 Step 7: Writing to CSV...
[16:47:29] [DOC: 9216426] ℹ️  Calculated age: 94 from DOB: 09/24/1930
[16:47:29] [DOC: 9216426] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:47:29] [DOC: 9216426] ℹ️  Payer Source extracted: 'Medicare'
[16:47:29] [DOC: 9216426] ℹ️  Diagnosis codes being written:
[16:47:29] [DOC: 9216426] ℹ️    - Latest_Episode_Firstdiagnosis: 'I26.99'
[16:47:29] [DOC: 9216426] ℹ️    - Latest_Episode_Seconddiagnosis: 'I35.0'
[16:47:29] [DOC: 9216426] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.0'
[16:47:29] [DOC: 9216426] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I13.0'
[16:47:29] [DOC: 9216426] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[16:47:29] [DOC: 9216426] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.32'
[16:47:29] [DOC: 9216426] ✅ Patient data written to CSV: Kathryn McCollester | Sex: FEMALE | Age: 94 | Service: Skilled Nursing | Payer: Medicare | MRN: 771002
[16:47:29] ✅    ✅ Document 9216426 processed and saved successfully
[16:47:29] 🔄 
🔄 Step 8: Saving API details...
[16:47:29] [DOC: 9216426] ℹ️  API push details saved for document 9216426
[16:47:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216422                         ║
================================================================================
[16:47:29] ℹ️  Agency: Dartmouth HH
[16:47:29] ℹ️  Date: 04/02/2025
[16:47:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:47:31] [DOC: 9216422] ✅ Text extracted using pdfplumber (1414 chars)
[16:47:31] ✅    ✅ Text extracted using pdfplumber (1414 chars)
[16:47:31] 🔄 
🔄 Step 2: Extracting patient data...
[16:47:33] ℹ️  AI extracted raw sex value: 'F'
[16:47:33] ℹ️  AI extracted service line: 'RN, LPN'
[16:47:33] ℹ️  AI extracted payer source: 'Medicare'
[16:47:33] ℹ️  AI extracted diagnoses:
[16:47:33] ℹ️    - Diagnosis 1: ''
[16:47:33] ℹ️    - Diagnosis 2: ''
[16:47:33] ℹ️    - Diagnosis 3: ''
[16:47:33] ℹ️    - Diagnosis 4: ''
[16:47:33] ℹ️    - Diagnosis 5: ''
[16:47:33] ℹ️    - Diagnosis 6: ''
[16:47:33] ℹ️  Final extracted MRN: '6045015'
[16:47:33] ℹ️  Final extracted Sex: 'FEMALE'
[16:47:33] ℹ️  Final extracted Service Line: 'RN, LPN'
[16:47:33] ℹ️  Final extracted Payer Source: 'Medicare'
[16:47:33] ✅ Patient data extraction completed successfully
[16:47:33] ✅    ✅ Patient data extracted successfully
[16:47:33] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6045015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/15/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:47:33] ✅    ✅ Patient identified: Bonnie Desrochers
[16:47:33] ✅    ✅ Patient name validation passed
[16:47:33] 🔄 
🔄 Step 3: Processing patient dates...
[16:47:33] [DOC: 9216422] ℹ️  DOB normalized: 08/14/1951
[16:47:33] [DOC: 9216422] ℹ️  Episode startOfCare normalized: 02/15/2025
[16:47:33] [DOC: 9216422] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[16:47:33] [DOC: 9216422] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[16:47:33] [DOC: 9216422] ✅ Patient date processing completed successfully
[16:47:33] ✅    ✅ Date processing completed
[16:47:33] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6045015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/15/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:47:33] 🔄 
🔄 Step 4: Extracting order data...
[16:47:36] ℹ️  Order extraction - MRN: ''
[16:47:36] ℹ️  Order extraction - Sex: 'FEMALE'
[16:47:36] ℹ️  Order extraction - Service Line: 'RN, LPN'
[16:47:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:47:36] ✅ Order data extraction completed successfully
[16:47:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:47:36] ℹ️  Using MRN from patient data: '6045015'
[16:47:36] ℹ️  Service line consistent in both sources: 'RN, LPN'
[16:47:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:47:36] ✅ Patient name cross-validation successful
[16:47:36] ✅    ✅ Data merged successfully
[16:47:37] ✅    ✅ Order data extracted and validated
[16:47:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:47:43] [DOC: 9216422] ℹ️  Patient not found in cache or API: Bonnie Desrochers
[16:47:43] [DOC: 9216422] ℹ️  Patient not found, creating new patient via API...
[16:47:43] [DOC: 9216422] ℹ️  Creating patient via API: Bonnie Desrochers
[16:47:44] [DOC: 9216422] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:47:44] ❌    ❌ Failed to create patient
[16:47:44] [DOC: 9216422] ℹ️  API push details saved for document 9216422
================================================================================
║                        Processing Document ID: 9216390                         ║
================================================================================
[16:47:44] ℹ️  Agency: Dartmouth HH
[16:47:44] ℹ️  Date: 04/02/2025
[16:47:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:47:50] [DOC: 9216390] ✅ Text extracted using pdfplumber (12148 chars)
[16:47:50] ✅    ✅ Text extracted using pdfplumber (12136 chars)
[16:47:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:47:53] ℹ️  AI extracted raw sex value: 'M'
[16:47:53] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, MSW'
[16:47:53] ℹ️  AI extracted payer source: ''
[16:47:53] ℹ️  AI extracted diagnoses:
[16:47:53] ℹ️    - Diagnosis 1: 'J09.X9'
[16:47:53] ℹ️    - Diagnosis 2: 'M62.81'
[16:47:53] ℹ️    - Diagnosis 3: 'R26.81'
[16:47:53] ℹ️    - Diagnosis 4: 'I10'
[16:47:53] ℹ️    - Diagnosis 5: 'G31.84'
[16:47:53] ℹ️    - Diagnosis 6: 'N40.0'
[16:47:53] ℹ️  Final extracted MRN: '5671015'
[16:47:53] ℹ️  Final extracted Sex: 'MALE'
[16:47:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, MSW'
[16:47:53] ℹ️  Final extracted Payer Source: ''
[16:47:53] ✅ Patient data extraction completed successfully
[16:47:53] ✅    ✅ Patient data extracted successfully
[16:47:53] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Erin Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, MSW
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'J09.X9', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.81', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'G31.84', 'sixthDiagnosis': 'N40.0'}]
[16:47:53] ✅    ✅ Patient identified: James Osborne
[16:47:53] ✅    ✅ Patient name validation passed
[16:47:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:47:53] [DOC: 9216390] ℹ️  DOB normalized: 10/21/1940
[16:47:53] [DOC: 9216390] ℹ️  Episode startOfCare normalized: 03/27/2025
[16:47:53] [DOC: 9216390] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[16:47:53] [DOC: 9216390] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[16:47:53] [DOC: 9216390] ✅ Patient date processing completed successfully
[16:47:53] ✅    ✅ Date processing completed
[16:47:53] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Erin Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, MSW
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'J09.X9', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.81', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'G31.84', 'sixthDiagnosis': 'N40.0'}]
[16:47:53] 🔄 
🔄 Step 4: Extracting order data...
[16:47:56] ℹ️  Order extraction - MRN: '5671015'
[16:47:56] ℹ️  Order extraction - Sex: 'MALE'
[16:47:56] ℹ️  Order extraction - Service Line: 'RN, PT, OT, MSW'
[16:47:56] ℹ️  Order extraction - Payer Source: ''
[16:47:56] ✅ Order data extraction completed successfully
[16:47:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:47:56] ℹ️  Using MRN from patient data: '5671015' over '5671015'
[16:47:56] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT, MSW' + Order='RN, PT, OT, MSW' = 'MSW, OT, PT, RN, Skilled Nursing'
[16:47:56] ✅ Patient name cross-validation successful
[16:47:56] ✅    ✅ Data merged successfully
[16:47:57] ✅    ✅ Order data extracted and validated
[16:47:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:47:57] [DOC: 9216390] ✅ Patient found in local cache: James Osborne, ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[16:47:57] ✅    ✅ Existing patient found with ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[16:47:57] 🔄 
🔄 Step 6: Pushing order to API...
[16:47:57] [DOC: 9216390] ℹ️  Pushing order via API for patient ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[16:47:58] [DOC: 9216390] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:47:58] ❌    ❌ Failed to push order
[16:47:58] 🔄 
🔄 Step 7: Writing to CSV...
[16:47:58] [DOC: 9216390] ℹ️  Calculated age: 84 from DOB: 10/21/1940
[16:47:58] [DOC: 9216390] ℹ️  Service Line extracted: 'MSW, OT, PT, RN, Skilled Nursing'
[16:47:58] [DOC: 9216390] ℹ️  Payer Source extracted: ''
[16:47:58] [DOC: 9216390] ℹ️  Diagnosis codes being written:
[16:47:58] [DOC: 9216390] ℹ️    - Latest_Episode_Firstdiagnosis: 'J09.X9'
[16:47:58] [DOC: 9216390] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[16:47:58] [DOC: 9216390] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.81'
[16:47:58] [DOC: 9216390] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[16:47:58] [DOC: 9216390] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G31.84'
[16:47:58] [DOC: 9216390] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.0'
[16:47:58] [DOC: 9216390] ✅ Patient data written to CSV: James Osborne | Sex: MALE | Age: 84 | Service: MSW, OT, PT, RN, Skilled Nursing | Payer:  | MRN: 5671015
[16:47:58] ✅    ✅ Document 9216390 processed and saved successfully
[16:47:58] 🔄 
🔄 Step 8: Saving API details...
[16:47:58] [DOC: 9216390] ℹ️  API push details saved for document 9216390
[16:47:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216382                         ║
================================================================================
[16:47:58] ℹ️  Agency: Dartmouth HH
[16:47:58] ℹ️  Date: 04/02/2025
[16:47:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:48:30] [DOC: 9216382] ⚠️  Network error attempt 1, retrying...
[16:49:04] [DOC: 9216382] ⚠️  Network error attempt 2, retrying...
[16:49:38] [DOC: 9216382] ❌ Critical failure in get_pdf_text: Network error after 3 attempts: HTTPSConnectionPool(host='api.doctoralliance.com', port=443): Read timed out.
[16:49:38] ❌ Failed to extract text for Doc ID 9216382
[16:49:38] [DOC: 9216382] ℹ️  API push details saved for document 9216382
================================================================================
║                        Processing Document ID: 9216376                         ║
================================================================================
[16:49:38] ℹ️  Agency: Dartmouth HH
[16:49:38] ℹ️  Date: 04/02/2025
[16:49:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:49:41] [DOC: 9216376] ✅ Text extracted using pdfplumber (17874 chars)
[16:49:41] ✅    ✅ Text extracted using pdfplumber (17862 chars)
[16:49:41] 🔄 
🔄 Step 2: Extracting patient data...
[16:49:44] ℹ️  AI extracted raw sex value: 'F'
[16:49:44] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[16:49:44] ℹ️  AI extracted payer source: ''
[16:49:44] ℹ️  AI extracted diagnoses:
[16:49:44] ℹ️    - Diagnosis 1: 'Z47.1'
[16:49:44] ℹ️    - Diagnosis 2: 'Z96.651'
[16:49:44] ℹ️    - Diagnosis 3: 'E27.40'
[16:49:44] ℹ️    - Diagnosis 4: 'J44.9'
[16:49:44] ℹ️    - Diagnosis 5: 'M48.061'
[16:49:44] ℹ️    - Diagnosis 6: 'K21.9'
[16:49:44] ℹ️  Final extracted MRN: '1341002'
[16:49:44] ℹ️  Final extracted Sex: 'FEMALE'
[16:49:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[16:49:44] ℹ️  Final extracted Payer Source: ''
[16:49:44] ✅ Patient data extraction completed successfully
[16:49:44] ✅    ✅ Patient data extracted successfully
[16:49:44] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Lafleur
     └─ dob: 12/14/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1341002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.651', 'thirdDiagnosis': 'E27.40', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'M48.061', 'sixthDiagnosis': 'K21.9'}]
[16:49:44] ✅    ✅ Patient identified: Patricia Lafleur
[16:49:44] ✅    ✅ Patient name validation passed
[16:49:44] 🔄 
🔄 Step 3: Processing patient dates...
[16:49:44] [DOC: 9216376] ℹ️  DOB normalized: 12/14/1956
[16:49:44] [DOC: 9216376] ℹ️  Episode startOfCare normalized: 03/19/2025
[16:49:44] [DOC: 9216376] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[16:49:44] [DOC: 9216376] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[16:49:44] [DOC: 9216376] ✅ Patient date processing completed successfully
[16:49:44] ✅    ✅ Date processing completed
[16:49:44] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Lafleur
     └─ dob: 12/14/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1341002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.651', 'thirdDiagnosis': 'E27.40', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'M48.061', 'sixthDiagnosis': 'K21.9'}]
[16:49:44] 🔄 
🔄 Step 4: Extracting order data...
[16:49:46] ℹ️  Order extraction - MRN: '1341002'
[16:49:46] ℹ️  Order extraction - Sex: 'FEMALE'
[16:49:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[16:49:46] ℹ️  Order extraction - Payer Source: ''
[16:49:46] ✅ Order data extraction completed successfully
[16:49:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:49:46] ℹ️  Using MRN from patient data: '1341002' over '1341002'
[16:49:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[16:49:46] ✅ Patient name cross-validation successful
[16:49:46] ✅    ✅ Data merged successfully
[16:49:48] ✅    ✅ Order data extracted and validated
[16:49:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:49:48] [DOC: 9216376] ✅ Patient found in local cache: Patricia Lafleur, ID: 6fd97b99-f777-484b-99cc-adef33e61d6b
[16:49:48] ✅    ✅ Existing patient found with ID: 6fd97b99-f777-484b-99cc-adef33e61d6b
[16:49:48] 🔄 
🔄 Step 6: Pushing order to API...
[16:49:48] [DOC: 9216376] ℹ️  Pushing order via API for patient ID: 6fd97b99-f777-484b-99cc-adef33e61d6b
[16:49:49] [DOC: 9216376] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:49:49] ❌    ❌ Failed to push order
[16:49:49] 🔄 
🔄 Step 7: Writing to CSV...
[16:49:49] [DOC: 9216376] ℹ️  Calculated age: 68 from DOB: 12/14/1956
[16:49:49] [DOC: 9216376] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[16:49:49] [DOC: 9216376] ℹ️  Payer Source extracted: ''
[16:49:49] [DOC: 9216376] ℹ️  Diagnosis codes being written:
[16:49:49] [DOC: 9216376] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[16:49:49] [DOC: 9216376] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.651'
[16:49:49] [DOC: 9216376] ℹ️    - Latest_Episode_Thirddiagnosis: 'E27.40'
[16:49:49] [DOC: 9216376] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[16:49:49] [DOC: 9216376] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M48.061'
[16:49:49] [DOC: 9216376] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[16:49:49] [DOC: 9216376] ✅ Patient data written to CSV: Patricia Lafleur | Sex: FEMALE | Age: 68 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 1341002
[16:49:49] ✅    ✅ Document 9216376 processed and saved successfully
[16:49:49] 🔄 
🔄 Step 8: Saving API details...
[16:49:49] [DOC: 9216376] ℹ️  API push details saved for document 9216376
[16:49:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216373                         ║
================================================================================
[16:49:49] ℹ️  Agency: Dartmouth HH
[16:49:49] ℹ️  Date: 04/02/2025
[16:49:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:49:52] [DOC: 9216373] ✅ Text extracted using pdfplumber (8380 chars)
[16:49:52] ✅    ✅ Text extracted using pdfplumber (8380 chars)
[16:49:52] 🔄 
🔄 Step 2: Extracting patient data...
[16:49:55] ℹ️  AI extracted raw sex value: 'F'
[16:49:55] ℹ️  AI extracted service line: 'PT, OT, Skilled Nursing'
[16:49:55] ℹ️  AI extracted payer source: 'Senior Whole Health'
[16:49:55] ℹ️  AI extracted diagnoses:
[16:49:55] ℹ️    - Diagnosis 1: 'I25.5'
[16:49:55] ℹ️    - Diagnosis 2: 'I47.10'
[16:49:55] ℹ️    - Diagnosis 3: 'I11.0'
[16:49:55] ℹ️    - Diagnosis 4: 'I50.23'
[16:49:55] ℹ️    - Diagnosis 5: 'C34.92'
[16:49:55] ℹ️    - Diagnosis 6: 'C34.91'
[16:49:55] ℹ️  Final extracted MRN: '928015'
[16:49:55] ℹ️  Final extracted Sex: 'FEMALE'
[16:49:55] ℹ️  Final extracted Service Line: 'PT, OT, Skilled Nursing'
[16:49:55] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[16:49:55] ✅ Patient data extraction completed successfully
[16:49:55] ✅    ✅ Patient data extracted successfully
[16:49:55] 📊 Patient Response
     └─ patientFName: Erconida
     └─ patientLName: Graciani
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '01/10/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I25.5', 'secondDiagnosis': 'I47.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.23', 'fifthDiagnosis': 'C34.92', 'sixthDiagnosis': 'C34.91'}]
[16:49:55] ✅    ✅ Patient identified: Erconida Graciani
[16:49:55] ✅    ✅ Patient name validation passed
[16:49:55] 🔄 
🔄 Step 3: Processing patient dates...
[16:49:55] [DOC: 9216373] ℹ️  DOB normalized: 07/07/1940
[16:49:55] [DOC: 9216373] ℹ️  Episode startOfCare normalized: 01/10/2025
[16:49:55] [DOC: 9216373] ℹ️  Episode startOfEpisode normalized: 01/10/2025
[16:49:55] [DOC: 9216373] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[16:49:55] [DOC: 9216373] ✅ Patient date processing completed successfully
[16:49:55] ✅    ✅ Date processing completed
[16:49:55] 📊 Processed Patient Data
     └─ patientFName: Erconida
     └─ patientLName: Graciani
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '01/10/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I25.5', 'secondDiagnosis': 'I47.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.23', 'fifthDiagnosis': 'C34.92', 'sixthDiagnosis': 'C34.91'}]
[16:49:55] 🔄 
🔄 Step 4: Extracting order data...
[16:49:57] ℹ️  Order extraction - MRN: '928015'
[16:49:57] ℹ️  Order extraction - Sex: 'FEMALE'
[16:49:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[16:49:57] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[16:49:57] ✅ Order data extraction completed successfully
[16:49:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:49:57] ℹ️  Using MRN from patient data: '928015' over '928015'
[16:49:57] ℹ️  Combined service lines: Patient='PT, OT, Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[16:49:57] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[16:49:57] ✅ Patient name cross-validation successful
[16:49:57] ✅    ✅ Data merged successfully
[16:49:59] ✅    ✅ Order data extracted and validated
[16:49:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:49:59] [DOC: 9216373] ✅ Patient found in local cache: Erconida Graciani, ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[16:49:59] ✅    ✅ Existing patient found with ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[16:49:59] 🔄 
🔄 Step 6: Pushing order to API...
[16:49:59] [DOC: 9216373] ℹ️  Pushing order via API for patient ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[16:50:00] [DOC: 9216373] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:50:00] ❌    ❌ Failed to push order
[16:50:00] 🔄 
🔄 Step 7: Writing to CSV...
[16:50:00] [DOC: 9216373] ℹ️  Calculated age: 84 from DOB: 07/07/1940
[16:50:00] [DOC: 9216373] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[16:50:00] [DOC: 9216373] ℹ️  Payer Source extracted: 'Senior Whole Health'
[16:50:00] [DOC: 9216373] ℹ️  Diagnosis codes being written:
[16:50:00] [DOC: 9216373] ℹ️    - Latest_Episode_Firstdiagnosis: 'I25.5'
[16:50:00] [DOC: 9216373] ℹ️    - Latest_Episode_Seconddiagnosis: 'I47.10'
[16:50:00] [DOC: 9216373] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[16:50:00] [DOC: 9216373] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.23'
[16:50:00] [DOC: 9216373] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C34.92'
[16:50:00] [DOC: 9216373] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C34.91'
[16:50:00] [DOC: 9216373] ✅ Patient data written to CSV: Erconida Graciani | Sex: FEMALE | Age: 84 | Service: OT, PT, Skilled Nursing | Payer: Senior Whole Health | MRN: 928015
[16:50:00] ✅    ✅ Document 9216373 processed and saved successfully
[16:50:00] 🔄 
🔄 Step 8: Saving API details...
[16:50:00] [DOC: 9216373] ℹ️  API push details saved for document 9216373
[16:50:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216371                         ║
================================================================================
[16:50:00] ℹ️  Agency: Dartmouth HH
[16:50:00] ℹ️  Date: 04/02/2025
[16:50:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:50:02] [DOC: 9216371] ✅ Text extracted using pdfplumber (1349 chars)
[16:50:02] ✅    ✅ Text extracted using pdfplumber (1349 chars)
[16:50:02] 🔄 
🔄 Step 2: Extracting patient data...
[16:50:05] ℹ️  AI extracted raw sex value: 'M'
[16:50:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:50:05] ℹ️  AI extracted payer source: 'Medicare'
[16:50:05] ℹ️  AI extracted diagnoses:
[16:50:05] ℹ️    - Diagnosis 1: ''
[16:50:05] ℹ️    - Diagnosis 2: ''
[16:50:05] ℹ️    - Diagnosis 3: ''
[16:50:05] ℹ️    - Diagnosis 4: ''
[16:50:05] ℹ️    - Diagnosis 5: ''
[16:50:05] ℹ️    - Diagnosis 6: ''
[16:50:05] ℹ️  Final extracted MRN: '3745015'
[16:50:05] ℹ️  Final extracted Sex: 'MALE'
[16:50:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:50:05] ℹ️  Final extracted Payer Source: 'Medicare'
[16:50:05] ✅ Patient data extraction completed successfully
[16:50:05] ✅    ✅ Patient data extracted successfully
[16:50:05] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:50:05] ✅    ✅ Patient identified: Stanley Waters
[16:50:05] ✅    ✅ Patient name validation passed
[16:50:05] 🔄 
🔄 Step 3: Processing patient dates...
[16:50:05] [DOC: 9216371] ℹ️  DOB normalized: 08/19/1941
[16:50:05] [DOC: 9216371] ℹ️  Episode startOfCare normalized: 03/13/2025
[16:50:05] [DOC: 9216371] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:50:05] [DOC: 9216371] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:50:05] [DOC: 9216371] ✅ Patient date processing completed successfully
[16:50:05] ✅    ✅ Date processing completed
[16:50:05] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:50:05] 🔄 
🔄 Step 4: Extracting order data...
[16:50:07] ℹ️  Order extraction - MRN: '3745015'
[16:50:07] ℹ️  Order extraction - Sex: 'MALE'
[16:50:07] ℹ️  Order extraction - Service Line: 'RN, LPN'
[16:50:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:50:07] ✅ Order data extraction completed successfully
[16:50:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:50:07] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[16:50:07] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN, LPN' = 'LPN, RN, Skilled Nursing'
[16:50:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:50:07] ✅ Patient name cross-validation successful
[16:50:07] ✅    ✅ Data merged successfully
[16:50:08] ✅    ✅ Order data extracted and validated
[16:50:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:50:08] [DOC: 9216371] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[16:50:08] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[16:50:08] 🔄 
🔄 Step 6: Pushing order to API...
[16:50:08] [DOC: 9216371] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[16:50:09] [DOC: 9216371] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:50:09] ❌    ❌ Failed to push order
[16:50:09] 🔄 
🔄 Step 7: Writing to CSV...
[16:50:09] [DOC: 9216371] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[16:50:09] [DOC: 9216371] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing'
[16:50:09] [DOC: 9216371] ℹ️  Payer Source extracted: 'Medicare'
[16:50:09] [DOC: 9216371] ℹ️  Diagnosis codes being written:
[16:50:09] [DOC: 9216371] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:50:09] [DOC: 9216371] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:50:09] [DOC: 9216371] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:50:09] [DOC: 9216371] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:50:09] [DOC: 9216371] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:50:09] [DOC: 9216371] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:50:09] [DOC: 9216371] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: LPN, RN, Skilled Nursing | Payer: Medicare | MRN: 3745015
[16:50:09] ✅    ✅ Document 9216371 processed and saved successfully
[16:50:09] 🔄 
🔄 Step 8: Saving API details...
[16:50:09] [DOC: 9216371] ℹ️  API push details saved for document 9216371
[16:50:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216366                         ║
================================================================================
[16:50:09] ℹ️  Agency: Dartmouth HH
[16:50:09] ℹ️  Date: 04/02/2025
[16:50:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:50:12] [DOC: 9216366] ✅ Text extracted using pdfplumber (1247 chars)
[16:50:12] ✅    ✅ Text extracted using pdfplumber (1247 chars)
[16:50:12] 🔄 
🔄 Step 2: Extracting patient data...
[16:50:14] ℹ️  AI extracted raw sex value: 'F'
[16:50:14] ℹ️  AI extracted service line: 'RN, LPN'
[16:50:14] ℹ️  AI extracted payer source: 'Medicare'
[16:50:14] ℹ️  AI extracted diagnoses:
[16:50:14] ℹ️    - Diagnosis 1: ''
[16:50:14] ℹ️    - Diagnosis 2: ''
[16:50:14] ℹ️    - Diagnosis 3: ''
[16:50:14] ℹ️    - Diagnosis 4: ''
[16:50:14] ℹ️    - Diagnosis 5: ''
[16:50:14] ℹ️    - Diagnosis 6: ''
[16:50:14] ℹ️  Final extracted MRN: '5862015'
[16:50:14] ℹ️  Final extracted Sex: 'FEMALE'
[16:50:14] ℹ️  Final extracted Service Line: 'RN, LPN'
[16:50:14] ℹ️  Final extracted Payer Source: 'Medicare'
[16:50:14] ✅ Patient data extraction completed successfully
[16:50:14] ✅    ✅ Patient data extracted successfully
[16:50:14] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:50:14] ✅    ✅ Patient identified: Janice Arruda
[16:50:14] ✅    ✅ Patient name validation passed
[16:50:14] 🔄 
🔄 Step 3: Processing patient dates...
[16:50:14] [DOC: 9216366] ℹ️  DOB normalized: 01/24/1950
[16:50:14] [DOC: 9216366] ℹ️  Episode startOfCare normalized: 02/08/2025
[16:50:14] [DOC: 9216366] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[16:50:14] [DOC: 9216366] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[16:50:14] [DOC: 9216366] ✅ Patient date processing completed successfully
[16:50:14] ✅    ✅ Date processing completed
[16:50:14] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:50:14] 🔄 
🔄 Step 4: Extracting order data...
[16:50:17] ℹ️  Order extraction - MRN: ''
[16:50:17] ℹ️  Order extraction - Sex: 'FEMALE'
[16:50:17] ℹ️  Order extraction - Service Line: 'RN, LPN'
[16:50:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:50:17] ✅ Order data extraction completed successfully
[16:50:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:50:17] ℹ️  Using MRN from patient data: '5862015'
[16:50:17] ℹ️  Service line consistent in both sources: 'RN, LPN'
[16:50:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:50:17] ✅ Patient name cross-validation successful
[16:50:17] ✅    ✅ Data merged successfully
[16:50:18] ✅    ✅ Order data extracted and validated
[16:50:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:50:18] [DOC: 9216366] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[16:50:18] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[16:50:18] 🔄 
🔄 Step 6: Pushing order to API...
[16:50:18] [DOC: 9216366] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[16:50:19] [DOC: 9216366] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12954"}
[16:50:19] ❌    ❌ Failed to push order
[16:50:19] 🔄 
🔄 Step 7: Writing to CSV...
[16:50:19] [DOC: 9216366] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[16:50:19] [DOC: 9216366] ℹ️  Service Line extracted: 'RN, LPN'
[16:50:19] [DOC: 9216366] ℹ️  Payer Source extracted: 'Medicare'
[16:50:19] [DOC: 9216366] ℹ️  Diagnosis codes being written:
[16:50:19] [DOC: 9216366] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:50:19] [DOC: 9216366] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:50:19] [DOC: 9216366] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:50:19] [DOC: 9216366] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:50:19] [DOC: 9216366] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:50:19] [DOC: 9216366] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:50:19] [DOC: 9216366] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: RN, LPN | Payer: Medicare | MRN: 5862015
[16:50:19] ✅    ✅ Document 9216366 processed and saved successfully
[16:50:19] 🔄 
🔄 Step 8: Saving API details...
[16:50:19] [DOC: 9216366] ℹ️  API push details saved for document 9216366
[16:50:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216365                         ║
================================================================================
[16:50:19] ℹ️  Agency: Dartmouth HH
[16:50:19] ℹ️  Date: 04/02/2025
[16:50:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:50:22] [DOC: 9216365] ✅ Text extracted using pdfplumber (4144 chars)
[16:50:22] ✅    ✅ Text extracted using pdfplumber (4144 chars)
[16:50:22] 🔄 
🔄 Step 2: Extracting patient data...
[16:50:25] ℹ️  AI extracted raw sex value: 'M'
[16:50:25] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[16:50:25] ℹ️  AI extracted payer source: 'Medicare'
[16:50:25] ℹ️  AI extracted diagnoses:
[16:50:25] ℹ️    - Diagnosis 1: 'None'
[16:50:25] ℹ️    - Diagnosis 2: 'None'
[16:50:25] ℹ️    - Diagnosis 3: 'None'
[16:50:25] ℹ️    - Diagnosis 4: 'None'
[16:50:25] ℹ️    - Diagnosis 5: 'None'
[16:50:25] ℹ️    - Diagnosis 6: 'None'
[16:50:25] ℹ️  Final extracted MRN: '6137015'
[16:50:25] ℹ️  Final extracted Sex: 'MALE'
[16:50:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[16:50:25] ℹ️  Final extracted Payer Source: 'Medicare'
[16:50:25] ✅ Patient data extraction completed successfully
[16:50:25] ✅    ✅ Patient data extracted successfully
[16:50:25] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Roberts
     └─ dob: 11/20/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 6137015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:50:25] ✅    ✅ Patient identified: Phillip Roberts
[16:50:25] ✅    ✅ Patient name validation passed
[16:50:25] 🔄 
🔄 Step 3: Processing patient dates...
[16:50:25] [DOC: 9216365] ℹ️  DOB normalized: 11/20/1934
[16:50:25] [DOC: 9216365] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:50:25] [DOC: 9216365] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:50:25] [DOC: 9216365] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:50:25] [DOC: 9216365] ✅ Patient date processing completed successfully
[16:50:25] ✅    ✅ Date processing completed
[16:50:25] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Roberts
     └─ dob: 11/20/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 6137015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025'}]
[16:50:25] 🔄 
🔄 Step 4: Extracting order data...
[16:50:27] ℹ️  Order extraction - MRN: '6137015'
[16:50:27] ℹ️  Order extraction - Sex: 'MALE'
[16:50:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Occupational Therapy'
[16:50:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:50:27] ✅ Order data extraction completed successfully
[16:50:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:50:27] ℹ️  Using MRN from patient data: '6137015' over '6137015'
[16:50:27] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy' + Order='Skilled Nursing,Occupational Therapy' = 'Occupational Therapy, Skilled Nursing'
[16:50:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:50:27] ✅ Patient name cross-validation successful
[16:50:27] ✅    ✅ Data merged successfully
[16:50:28] ✅    ✅ Order data extracted and validated
[16:50:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:50:42] [DOC: 9216365] ℹ️  Patient not found in cache or API: Phillip Roberts
[16:50:42] [DOC: 9216365] ℹ️  Patient not found, creating new patient via API...
[16:50:42] [DOC: 9216365] ℹ️  Creating patient via API: Phillip Roberts
[16:50:43] [DOC: 9216365] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:50:43] ❌    ❌ Failed to create patient
[16:50:43] [DOC: 9216365] ℹ️  API push details saved for document 9216365
================================================================================
║                        Processing Document ID: 9216362                         ║
================================================================================
[16:50:43] ℹ️  Agency: Dartmouth HH
[16:50:43] ℹ️  Date: 04/02/2025
[16:50:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:50:47] [DOC: 9216362] ✅ Text extracted using pdfplumber (19794 chars)
[16:50:47] ✅    ✅ Text extracted using pdfplumber (19782 chars)
[16:50:47] 🔄 
🔄 Step 2: Extracting patient data...
[16:50:50] ℹ️  AI extracted raw sex value: 'M'
[16:50:50] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Home Health Aide'
[16:50:50] ℹ️  AI extracted payer source: ''
[16:50:50] ℹ️  AI extracted diagnoses:
[16:50:50] ℹ️    - Diagnosis 1: 'C71.1'
[16:50:50] ℹ️    - Diagnosis 2: 'S42.022D'
[16:50:50] ℹ️    - Diagnosis 3: 'G81.94'
[16:50:50] ℹ️    - Diagnosis 4: 'R26.89'
[16:50:50] ℹ️    - Diagnosis 5: 'I10'
[16:50:50] ℹ️    - Diagnosis 6: 'D50.9'
[16:50:50] ℹ️  Final extracted MRN: '6137015'
[16:50:50] ℹ️  Final extracted Sex: 'MALE'
[16:50:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Home Health Aide'
[16:50:50] ℹ️  Final extracted Payer Source: ''
[16:50:50] ✅ Patient data extraction completed successfully
[16:50:50] ✅    ✅ Patient data extracted successfully
[16:50:50] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Roberts
     └─ dob: 11/20/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 6137015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'C71.1', 'secondDiagnosis': 'S42.022D', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': 'R26.89', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D50.9'}]
[16:50:50] ✅    ✅ Patient identified: Phillip Roberts
[16:50:50] ✅    ✅ Patient name validation passed
[16:50:50] 🔄 
🔄 Step 3: Processing patient dates...
[16:50:50] [DOC: 9216362] ℹ️  DOB normalized: 11/20/1934
[16:50:50] [DOC: 9216362] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:50:50] [DOC: 9216362] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:50:50] [DOC: 9216362] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:50:50] [DOC: 9216362] ✅ Patient date processing completed successfully
[16:50:50] ✅    ✅ Date processing completed
[16:50:50] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Roberts
     └─ dob: 11/20/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 6137015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'C71.1', 'secondDiagnosis': 'S42.022D', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': 'R26.89', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D50.9'}]
[16:50:50] 🔄 
🔄 Step 4: Extracting order data...
[16:50:53] ℹ️  Order extraction - MRN: '6137015'
[16:50:53] ℹ️  Order extraction - Sex: 'MALE'
[16:50:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy, Home Health Aide'
[16:50:53] ℹ️  Order extraction - Payer Source: ''
[16:50:53] ✅ Order data extraction completed successfully
[16:50:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:50:53] ℹ️  Using MRN from patient data: '6137015' over '6137015'
[16:50:53] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy, Home Health Aide' + Order='Skilled Nursing, Physical Therapy, Speech Therapy, Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Therapy'
[16:50:53] ✅ Patient name cross-validation successful
[16:50:53] ✅    ✅ Data merged successfully
[16:50:54] ✅    ✅ Order data extracted and validated
[16:50:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:51:24] [DOC: 9216362] ℹ️  Patient not found in cache or API: Phillip Roberts
[16:51:24] [DOC: 9216362] ℹ️  Patient not found, creating new patient via API...
[16:51:24] [DOC: 9216362] ℹ️  Creating patient via API: Phillip Roberts
[16:51:25] [DOC: 9216362] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:51:25] ❌    ❌ Failed to create patient
[16:51:25] [DOC: 9216362] ℹ️  API push details saved for document 9216362
================================================================================
║                        Processing Document ID: 9216354                         ║
================================================================================
[16:51:25] ℹ️  Agency: Dartmouth HH
[16:51:25] ℹ️  Date: 04/02/2025
[16:51:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:28] [DOC: 9216354] ✅ Text extracted using pdfplumber (11287 chars)
[16:51:28] ✅    ✅ Text extracted using pdfplumber (11287 chars)
[16:51:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:51:31] ℹ️  AI extracted raw sex value: 'F'
[16:51:31] ℹ️  AI extracted service line: 'PT, OT'
[16:51:31] ℹ️  AI extracted payer source: ''
[16:51:31] ℹ️  AI extracted diagnoses:
[16:51:31] ℹ️    - Diagnosis 1: 'G81.14'
[16:51:31] ℹ️    - Diagnosis 2: 'G83.11'
[16:51:31] ℹ️    - Diagnosis 3: 'M24.561'
[16:51:31] ℹ️    - Diagnosis 4: 'M24.562'
[16:51:31] ℹ️    - Diagnosis 5: 'M24.522'
[16:51:31] ℹ️    - Diagnosis 6: 'M24.541'
[16:51:31] ℹ️  Final extracted MRN: '1079011'
[16:51:31] ℹ️  Final extracted Sex: 'FEMALE'
[16:51:31] ℹ️  Final extracted Service Line: 'PT, OT'
[16:51:31] ℹ️  Final extracted Payer Source: ''
[16:51:31] ✅ Patient data extraction completed successfully
[16:51:31] ✅    ✅ Patient data extracted successfully
[16:51:31] 📊 Patient Response
     └─ patientFName: Rosie
     └─ patientLName: Brown
     └─ dob: 08/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1079011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'G81.14', 'secondDiagnosis': 'G83.11', 'thirdDiagnosis': 'M24.561', 'fourthDiagnosis': 'M24.562', 'fifthDiagnosis': 'M24.522', 'sixthDiagnosis': 'M24.541'}]
[16:51:31] ✅    ✅ Patient identified: Rosie Brown
[16:51:31] ✅    ✅ Patient name validation passed
[16:51:31] 🔄 
🔄 Step 3: Processing patient dates...
[16:51:31] [DOC: 9216354] ℹ️  DOB normalized: 08/27/1941
[16:51:31] [DOC: 9216354] ℹ️  Episode startOfCare normalized: 03/14/2025
[16:51:31] [DOC: 9216354] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[16:51:31] [DOC: 9216354] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[16:51:31] [DOC: 9216354] ✅ Patient date processing completed successfully
[16:51:31] ✅    ✅ Date processing completed
[16:51:31] 📊 Processed Patient Data
     └─ patientFName: Rosie
     └─ patientLName: Brown
     └─ dob: 08/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1079011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'G81.14', 'secondDiagnosis': 'G83.11', 'thirdDiagnosis': 'M24.561', 'fourthDiagnosis': 'M24.562', 'fifthDiagnosis': 'M24.522', 'sixthDiagnosis': 'M24.541'}]
[16:51:31] 🔄 
🔄 Step 4: Extracting order data...
[16:51:34] ℹ️  Order extraction - MRN: '1079011'
[16:51:34] ℹ️  Order extraction - Sex: 'FEMALE'
[16:51:34] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:51:34] ℹ️  Order extraction - Payer Source: ''
[16:51:34] ✅ Order data extraction completed successfully
[16:51:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:51:34] ℹ️  Using MRN from patient data: '1079011' over '1079011'
[16:51:34] ℹ️  Service line consistent in both sources: 'PT, OT'
[16:51:34] ✅ Patient name cross-validation successful
[16:51:34] ✅    ✅ Data merged successfully
[16:51:35] ✅    ✅ Order data extracted and validated
[16:51:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:51:35] [DOC: 9216354] ✅ Patient found in local cache: Rosie Brown, ID: cd071c7f-5ce7-416e-a360-189960a49508
[16:51:35] ✅    ✅ Existing patient found with ID: cd071c7f-5ce7-416e-a360-189960a49508
[16:51:35] 🔄 
🔄 Step 6: Pushing order to API...
[16:51:35] [DOC: 9216354] ℹ️  Pushing order via API for patient ID: cd071c7f-5ce7-416e-a360-189960a49508
[16:51:36] [DOC: 9216354] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:51:36] ❌    ❌ Failed to push order
[16:51:36] 🔄 
🔄 Step 7: Writing to CSV...
[16:51:36] [DOC: 9216354] ℹ️  Calculated age: 83 from DOB: 08/27/1941
[16:51:36] [DOC: 9216354] ℹ️  Service Line extracted: 'PT, OT'
[16:51:36] [DOC: 9216354] ℹ️  Payer Source extracted: ''
[16:51:36] [DOC: 9216354] ℹ️  Diagnosis codes being written:
[16:51:36] [DOC: 9216354] ℹ️    - Latest_Episode_Firstdiagnosis: 'G81.14'
[16:51:36] [DOC: 9216354] ℹ️    - Latest_Episode_Seconddiagnosis: 'G83.11'
[16:51:36] [DOC: 9216354] ℹ️    - Latest_Episode_Thirddiagnosis: 'M24.561'
[16:51:36] [DOC: 9216354] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M24.562'
[16:51:36] [DOC: 9216354] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M24.522'
[16:51:36] [DOC: 9216354] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M24.541'
[16:51:36] [DOC: 9216354] ✅ Patient data written to CSV: Rosie Brown | Sex: FEMALE | Age: 83 | Service: PT, OT | Payer:  | MRN: 1079011
[16:51:36] ✅    ✅ Document 9216354 processed and saved successfully
[16:51:36] 🔄 
🔄 Step 8: Saving API details...
[16:51:36] [DOC: 9216354] ℹ️  API push details saved for document 9216354
[16:51:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2167283                         ║
================================================================================
[16:51:36] ℹ️  Agency: Brockton Home Health Care
[16:51:36] ℹ️  Date: 04/01/2025
[16:51:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:38] [DOC: 2167283] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:38] ❌ Failed to extract text for Doc ID 2167283
[16:51:38] [DOC: 2167283] ℹ️  API push details saved for document 2167283
================================================================================
║                        Processing Document ID: 2167281                         ║
================================================================================
[16:51:38] ℹ️  Agency: Brockton Home Health Care
[16:51:38] ℹ️  Date: 04/01/2025
[16:51:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:40] [DOC: 2167281] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:40] ❌ Failed to extract text for Doc ID 2167281
[16:51:40] [DOC: 2167281] ℹ️  API push details saved for document 2167281
================================================================================
║                        Processing Document ID: 2167278                         ║
================================================================================
[16:51:40] ℹ️  Agency: Brockton Home Health Care
[16:51:40] ℹ️  Date: 04/01/2025
[16:51:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:41] [DOC: 2167278] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:41] ❌ Failed to extract text for Doc ID 2167278
[16:51:41] [DOC: 2167278] ℹ️  API push details saved for document 2167278
================================================================================
║                        Processing Document ID: 2167269                         ║
================================================================================
[16:51:41] ℹ️  Agency: Brockton Home Health Care
[16:51:41] ℹ️  Date: 04/01/2025
[16:51:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:42] [DOC: 2167269] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:42] ❌ Failed to extract text for Doc ID 2167269
[16:51:42] [DOC: 2167269] ℹ️  API push details saved for document 2167269
================================================================================
║                        Processing Document ID: 2167268                         ║
================================================================================
[16:51:42] ℹ️  Agency: Brockton Home Health Care
[16:51:42] ℹ️  Date: 04/01/2025
[16:51:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:43] [DOC: 2167268] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:43] ❌ Failed to extract text for Doc ID 2167268
[16:51:43] [DOC: 2167268] ℹ️  API push details saved for document 2167268
================================================================================
║                        Processing Document ID: 2167120                         ║
================================================================================
[16:51:43] ℹ️  Agency: Brockton Home Health Care
[16:51:43] ℹ️  Date: 04/01/2025
[16:51:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:45] [DOC: 2167120] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:45] ❌ Failed to extract text for Doc ID 2167120
[16:51:45] [DOC: 2167120] ℹ️  API push details saved for document 2167120
================================================================================
║                        Processing Document ID: 2167117                         ║
================================================================================
[16:51:45] ℹ️  Agency: Brockton Home Health Care
[16:51:45] ℹ️  Date: 04/01/2025
[16:51:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:46] [DOC: 2167117] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:46] ❌ Failed to extract text for Doc ID 2167117
[16:51:46] [DOC: 2167117] ℹ️  API push details saved for document 2167117
================================================================================
║                        Processing Document ID: 2167116                         ║
================================================================================
[16:51:46] ℹ️  Agency: Brockton Home Health Care
[16:51:46] ℹ️  Date: 04/01/2025
[16:51:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:47] [DOC: 2167116] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:47] ❌ Failed to extract text for Doc ID 2167116
[16:51:47] [DOC: 2167116] ℹ️  API push details saved for document 2167116
================================================================================
║                        Processing Document ID: 2167110                         ║
================================================================================
[16:51:47] ℹ️  Agency: Brockton Home Health Care
[16:51:47] ℹ️  Date: 04/01/2025
[16:51:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:49] [DOC: 2167110] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:49] ❌ Failed to extract text for Doc ID 2167110
[16:51:49] [DOC: 2167110] ℹ️  API push details saved for document 2167110
================================================================================
║                        Processing Document ID: 2167106                         ║
================================================================================
[16:51:49] ℹ️  Agency: Brockton Home Health Care
[16:51:49] ℹ️  Date: 04/01/2025
[16:51:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:51] [DOC: 2167106] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:51] ❌ Failed to extract text for Doc ID 2167106
[16:51:51] [DOC: 2167106] ℹ️  API push details saved for document 2167106
================================================================================
║                        Processing Document ID: 2167103                         ║
================================================================================
[16:51:51] ℹ️  Agency: Brockton Home Health Care
[16:51:51] ℹ️  Date: 04/01/2025
[16:51:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:52] [DOC: 2167103] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:52] ❌ Failed to extract text for Doc ID 2167103
[16:51:52] [DOC: 2167103] ℹ️  API push details saved for document 2167103
================================================================================
║                        Processing Document ID: 2167102                         ║
================================================================================
[16:51:52] ℹ️  Agency: Brockton Home Health Care
[16:51:52] ℹ️  Date: 04/01/2025
[16:51:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:51:54] [DOC: 2167102] ❌ Critical failure in get_pdf_text: Invalid response format
[16:51:54] ❌ Failed to extract text for Doc ID 2167102
[16:51:54] [DOC: 2167102] ℹ️  API push details saved for document 2167102
================================================================================
║                        Processing Document ID: 9215772                         ║
================================================================================
[16:51:54] ℹ️  Agency: AccentCare Fall River
[16:51:54] ℹ️  Date: 04/01/2025
[16:51:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:52:16] [DOC: 9215772] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[16:52:26] [DOC: 9215772] ✅ Text extracted using tesseract_ocr (22683 chars)
[16:52:26] ✅    ✅ Text extracted using tesseract_ocr (22653 chars)
[16:52:26] 🔄 
🔄 Step 2: Extracting patient data...
[16:52:30] ℹ️  AI extracted raw sex value: 'F'
[16:52:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:52:30] ℹ️  AI extracted payer source: 'Medicare'
[16:52:30] ℹ️  AI extracted diagnoses:
[16:52:30] ℹ️    - Diagnosis 1: 'N39.0'
[16:52:30] ℹ️    - Diagnosis 2: 'C83.30'
[16:52:30] ℹ️    - Diagnosis 3: '2452'
[16:52:30] ℹ️    - Diagnosis 4: 'B96.4'
[16:52:30] ℹ️    - Diagnosis 5: 'I10'
[16:52:30] ℹ️    - Diagnosis 6: 'L89.312'
[16:52:30] ℹ️  Final extracted MRN: '0200117976701'
[16:52:30] ℹ️  Final extracted Sex: 'FEMALE'
[16:52:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:52:30] ℹ️  Final extracted Payer Source: 'Medicare'
[16:52:30] ✅ Patient data extraction completed successfully
[16:52:30] ✅    ✅ Patient data extracted successfully
[16:52:30] 📊 Patient Response
     └─ patientFName: LISA
     └─ patientLName: AMEDEIROS
     └─ dob: 11/03/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200117976701
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 9 BEDFORD ST APT 38
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/25/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'C83.30', 'thirdDiagnosis': '2452', 'fourthDiagnosis': 'B96.4', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'L89.312'}]
[16:52:30] ✅    ✅ Patient identified: LISA AMEDEIROS
[16:52:30] ✅    ✅ Patient name validation passed
[16:52:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:52:30] [DOC: 9215772] ℹ️  DOB normalized: 11/03/1967
[16:52:30] [DOC: 9215772] ℹ️  Episode startOfCare normalized: 01/25/2025
[16:52:30] [DOC: 9215772] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[16:52:30] [DOC: 9215772] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[16:52:30] [DOC: 9215772] ✅ Patient date processing completed successfully
[16:52:30] ✅    ✅ Date processing completed
[16:52:30] 📊 Processed Patient Data
     └─ patientFName: LISA
     └─ patientLName: AMEDEIROS
     └─ dob: 11/03/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200117976701
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 9 BEDFORD ST APT 38
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/25/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'C83.30', 'thirdDiagnosis': '2452', 'fourthDiagnosis': 'B96.4', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'L89.312'}]
[16:52:30] 🔄 
🔄 Step 4: Extracting order data...
[16:52:33] ℹ️  Order extraction - MRN: '0200117976701'
[16:52:33] ℹ️  Order extraction - Sex: 'FEMALE'
[16:52:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:52:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:52:33] ✅ Order data extraction completed successfully
[16:52:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:52:33] ℹ️  Using MRN from patient data: '0200117976701' over '0200117976701'
[16:52:33] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:52:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:52:33] ✅ Patient name cross-validation successful
[16:52:33] ✅    ✅ Data merged successfully
[16:52:34] ✅    ✅ Order data extracted and validated
[16:52:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:52:49] [DOC: 9215772] ℹ️  Patient not found in cache or API: LISA AMEDEIROS
[16:52:49] [DOC: 9215772] ℹ️  Patient not found, creating new patient via API...
[16:52:49] [DOC: 9215772] ℹ️  Creating patient via API: LISA AMEDEIROS
[16:52:51] [DOC: 9215772] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:52:51] ❌    ❌ Failed to create patient
[16:52:51] [DOC: 9215772] ℹ️  API push details saved for document 9215772
================================================================================
║                        Processing Document ID: 9213804                         ║
================================================================================
[16:52:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:52:51] ℹ️  Date: 04/01/2025
[16:52:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:52:52] [DOC: 9213804] ✅ Text extracted using pdfplumber (1324 chars)
[16:52:52] ✅    ✅ Text extracted using pdfplumber (1324 chars)
[16:52:52] 🔄 
🔄 Step 2: Extracting patient data...
[16:52:54] ℹ️  AI extracted raw sex value: 'F'
[16:52:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:52:54] ℹ️  AI extracted payer source: ''
[16:52:54] ℹ️  AI extracted diagnoses:
[16:52:54] ℹ️    - Diagnosis 1: ''
[16:52:54] ℹ️    - Diagnosis 2: ''
[16:52:54] ℹ️    - Diagnosis 3: ''
[16:52:54] ℹ️    - Diagnosis 4: ''
[16:52:54] ℹ️    - Diagnosis 5: ''
[16:52:54] ℹ️    - Diagnosis 6: ''
[16:52:54] ℹ️  Final extracted MRN: '2761021'
[16:52:54] ℹ️  Final extracted Sex: 'FEMALE'
[16:52:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:52:54] ℹ️  Final extracted Payer Source: ''
[16:52:54] ✅ Patient data extraction completed successfully
[16:52:54] ✅    ✅ Patient data extracted successfully
[16:52:54] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:52:54] ✅    ✅ Patient identified: Theresa Moniz
[16:52:54] ✅    ✅ Patient name validation passed
[16:52:54] 🔄 
🔄 Step 3: Processing patient dates...
[16:52:54] [DOC: 9213804] ℹ️  DOB normalized: 07/09/1956
[16:52:54] [DOC: 9213804] ✅ Patient date processing completed successfully
[16:52:54] ✅    ✅ Date processing completed
[16:52:54] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:52:54] 🔄 
🔄 Step 4: Extracting order data...
[16:52:57] ℹ️  Order extraction - MRN: '2761021'
[16:52:57] ℹ️  Order extraction - Sex: 'FEMALE'
[16:52:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:52:57] ℹ️  Order extraction - Payer Source: ''
[16:52:57] ✅ Order data extraction completed successfully
[16:52:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:52:57] ℹ️  Using MRN from patient data: '2761021' over '2761021'
[16:52:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:52:57] ✅ Patient name cross-validation successful
[16:52:57] ✅    ✅ Data merged successfully
[16:52:58] ✅    ✅ Order data extracted and validated
[16:52:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:53:06] [DOC: 9213804] ℹ️  Patient not found in cache or API: Theresa Moniz
[16:53:06] [DOC: 9213804] ℹ️  Patient not found, creating new patient via API...
[16:53:06] [DOC: 9213804] ℹ️  Creating patient via API: Theresa Moniz
[16:53:07] [DOC: 9213804] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:53:07] ❌    ❌ Failed to create patient
[16:53:07] [DOC: 9213804] ℹ️  API push details saved for document 9213804
================================================================================
║                        Processing Document ID: 9213763                         ║
================================================================================
[16:53:07] ℹ️  Agency: Visiting Rehab & Nursing Services
[16:53:07] ℹ️  Date: 04/01/2025
[16:53:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:53:10] [DOC: 9213763] ✅ Text extracted using pdfplumber (61998 chars)
[16:53:10] ✅    ✅ Text extracted using pdfplumber (61998 chars)
[16:53:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:53:15] ℹ️  AI extracted raw sex value: ''
[16:53:15] ℹ️  AI extracted service line: ''
[16:53:15] ℹ️  AI extracted payer source: ''
[16:53:15] ℹ️  AI extracted diagnoses:
[16:53:15] ℹ️    - Diagnosis 1: ''
[16:53:15] ℹ️    - Diagnosis 2: ''
[16:53:15] ℹ️    - Diagnosis 3: ''
[16:53:15] ℹ️    - Diagnosis 4: ''
[16:53:15] ℹ️    - Diagnosis 5: ''
[16:53:15] ℹ️    - Diagnosis 6: ''
[16:53:15] ℹ️  Final extracted MRN: ''
[16:53:15] ℹ️  Final extracted Sex: ''
[16:53:15] ℹ️  Final extracted Service Line: ''
[16:53:15] ℹ️  Final extracted Payer Source: ''
[16:53:15] ✅ Patient data extraction completed successfully
[16:53:15] ✅    ✅ Patient data extracted successfully
[16:53:15] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:15] ⚠️     ❌ Insufficient patient data extracted
[16:53:15] [DOC: 9213763] ℹ️  API push details saved for document 9213763
================================================================================
║                        Processing Document ID: 9212117                         ║
================================================================================
[16:53:15] ℹ️  Agency: Dartmouth HH
[16:53:15] ℹ️  Date: 03/31/2025
[16:53:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:53:17] [DOC: 9212117] ✅ Text extracted using pdfplumber (4850 chars)
[16:53:17] ✅    ✅ Text extracted using pdfplumber (4850 chars)
[16:53:17] 🔄 
🔄 Step 2: Extracting patient data...
[16:53:20] ℹ️  AI extracted raw sex value: 'F'
[16:53:20] ℹ️  AI extracted service line: 'OT'
[16:53:20] ℹ️  AI extracted payer source: 'Medicare'
[16:53:20] ℹ️  AI extracted diagnoses:
[16:53:20] ℹ️    - Diagnosis 1: ''
[16:53:20] ℹ️    - Diagnosis 2: ''
[16:53:20] ℹ️    - Diagnosis 3: ''
[16:53:20] ℹ️    - Diagnosis 4: ''
[16:53:20] ℹ️    - Diagnosis 5: ''
[16:53:20] ℹ️    - Diagnosis 6: ''
[16:53:20] ℹ️  Final extracted MRN: '5240015'
[16:53:20] ℹ️  Final extracted Sex: 'FEMALE'
[16:53:20] ℹ️  Final extracted Service Line: 'OT'
[16:53:20] ℹ️  Final extracted Payer Source: 'Medicare'
[16:53:20] ✅ Patient data extraction completed successfully
[16:53:20] ✅    ✅ Patient data extracted successfully
[16:53:20] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:20] ✅    ✅ Patient identified: Donna Cabral
[16:53:20] ✅    ✅ Patient name validation passed
[16:53:20] 🔄 
🔄 Step 3: Processing patient dates...
[16:53:20] [DOC: 9212117] ℹ️  DOB normalized: 10/03/1947
[16:53:20] [DOC: 9212117] ℹ️  Episode startOfCare normalized: 09/18/2024
[16:53:20] [DOC: 9212117] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:53:20] [DOC: 9212117] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:53:20] [DOC: 9212117] ✅ Patient date processing completed successfully
[16:53:20] ✅    ✅ Date processing completed
[16:53:20] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:20] 🔄 
🔄 Step 4: Extracting order data...
[16:53:22] ℹ️  Order extraction - MRN: '5240015'
[16:53:22] ℹ️  Order extraction - Sex: 'FEMALE'
[16:53:22] ℹ️  Order extraction - Service Line: 'OT'
[16:53:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:53:22] ✅ Order data extraction completed successfully
[16:53:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:53:22] ℹ️  Using MRN from patient data: '5240015' over '5240015'
[16:53:22] ℹ️  Service line consistent in both sources: 'OT'
[16:53:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:53:22] ✅ Patient name cross-validation successful
[16:53:22] ✅    ✅ Data merged successfully
[16:53:24] ✅    ✅ Order data extracted and validated
[16:53:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:53:24] [DOC: 9212117] ✅ Patient found in local cache: Donna Cabral, ID: 79190189-814f-4114-a438-904080ae2281
[16:53:24] ✅    ✅ Existing patient found with ID: 79190189-814f-4114-a438-904080ae2281
[16:53:24] 🔄 
🔄 Step 6: Pushing order to API...
[16:53:24] [DOC: 9212117] ℹ️  Pushing order via API for patient ID: 79190189-814f-4114-a438-904080ae2281
[16:53:26] [DOC: 9212117] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:53:26] ❌    ❌ Failed to push order
[16:53:26] 🔄 
🔄 Step 7: Writing to CSV...
[16:53:26] [DOC: 9212117] ℹ️  Calculated age: 77 from DOB: 10/03/1947
[16:53:26] [DOC: 9212117] ℹ️  Service Line extracted: 'OT'
[16:53:26] [DOC: 9212117] ℹ️  Payer Source extracted: 'Medicare'
[16:53:26] [DOC: 9212117] ℹ️  Diagnosis codes being written:
[16:53:26] [DOC: 9212117] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:53:26] [DOC: 9212117] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:53:26] [DOC: 9212117] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:53:26] [DOC: 9212117] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:53:26] [DOC: 9212117] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:53:26] [DOC: 9212117] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:53:26] [DOC: 9212117] ✅ Patient data written to CSV: Donna Cabral | Sex: FEMALE | Age: 77 | Service: OT | Payer: Medicare | MRN: 5240015
[16:53:26] ✅    ✅ Document 9212117 processed and saved successfully
[16:53:26] 🔄 
🔄 Step 8: Saving API details...
[16:53:26] [DOC: 9212117] ℹ️  API push details saved for document 9212117
[16:53:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212112                         ║
================================================================================
[16:53:26] ℹ️  Agency: Dartmouth HH
[16:53:26] ℹ️  Date: 03/31/2025
[16:53:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:53:28] [DOC: 9212112] ✅ Text extracted using pdfplumber (1680 chars)
[16:53:28] ✅    ✅ Text extracted using pdfplumber (1680 chars)
[16:53:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:53:30] ℹ️  AI extracted raw sex value: 'M'
[16:53:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:53:30] ℹ️  AI extracted payer source: 'Medicare'
[16:53:30] ℹ️  AI extracted diagnoses:
[16:53:30] ℹ️    - Diagnosis 1: ''
[16:53:30] ℹ️    - Diagnosis 2: ''
[16:53:30] ℹ️    - Diagnosis 3: ''
[16:53:30] ℹ️    - Diagnosis 4: ''
[16:53:30] ℹ️    - Diagnosis 5: ''
[16:53:30] ℹ️    - Diagnosis 6: ''
[16:53:30] ℹ️  Final extracted MRN: '842002'
[16:53:30] ℹ️  Final extracted Sex: 'MALE'
[16:53:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:53:30] ℹ️  Final extracted Payer Source: 'Medicare'
[16:53:30] ✅ Patient data extraction completed successfully
[16:53:30] ✅    ✅ Patient data extracted successfully
[16:53:30] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:30] ✅    ✅ Patient identified: Johannes Bjornson
[16:53:30] ✅    ✅ Patient name validation passed
[16:53:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:53:30] [DOC: 9212112] ℹ️  DOB normalized: 02/09/1942
[16:53:30] [DOC: 9212112] ℹ️  Episode startOfCare normalized: 10/10/2024
[16:53:30] [DOC: 9212112] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[16:53:30] [DOC: 9212112] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[16:53:30] [DOC: 9212112] ✅ Patient date processing completed successfully
[16:53:30] ✅    ✅ Date processing completed
[16:53:30] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:30] 🔄 
🔄 Step 4: Extracting order data...
[16:53:33] ℹ️  Order extraction - MRN: ''
[16:53:33] ℹ️  Order extraction - Sex: 'MALE'
[16:53:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:53:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:53:33] ✅ Order data extraction completed successfully
[16:53:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:53:33] ℹ️  Using MRN from patient data: '842002'
[16:53:33] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:53:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:53:33] ✅ Patient name cross-validation successful
[16:53:33] ✅    ✅ Data merged successfully
[16:53:34] ✅    ✅ Order data extracted and validated
[16:53:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:53:34] [DOC: 9212112] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[16:53:34] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[16:53:34] 🔄 
🔄 Step 6: Pushing order to API...
[16:53:34] [DOC: 9212112] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[16:53:36] [DOC: 9212112] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[16:53:36] ❌    ❌ Failed to push order
[16:53:36] 🔄 
🔄 Step 7: Writing to CSV...
[16:53:36] [DOC: 9212112] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[16:53:36] [DOC: 9212112] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:53:36] [DOC: 9212112] ℹ️  Payer Source extracted: 'Medicare'
[16:53:36] [DOC: 9212112] ℹ️  Diagnosis codes being written:
[16:53:36] [DOC: 9212112] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:53:36] [DOC: 9212112] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:53:36] [DOC: 9212112] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:53:36] [DOC: 9212112] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:53:36] [DOC: 9212112] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:53:36] [DOC: 9212112] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:53:36] [DOC: 9212112] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 842002
[16:53:36] ✅    ✅ Document 9212112 processed and saved successfully
[16:53:36] 🔄 
🔄 Step 8: Saving API details...
[16:53:36] [DOC: 9212112] ℹ️  API push details saved for document 9212112
[16:53:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212076                         ║
================================================================================
[16:53:36] ℹ️  Agency: Dartmouth HH
[16:53:36] ℹ️  Date: 03/31/2025
[16:53:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:53:38] [DOC: 9212076] ✅ Text extracted using pdfplumber (1107 chars)
[16:53:38] ✅    ✅ Text extracted using pdfplumber (1107 chars)
[16:53:38] 🔄 
🔄 Step 2: Extracting patient data...
[16:53:42] ℹ️  AI extracted raw sex value: 'F'
[16:53:42] ℹ️  AI extracted service line: 'RN'
[16:53:42] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[16:53:42] ℹ️  AI extracted diagnoses:
[16:53:42] ℹ️    - Diagnosis 1: ''
[16:53:42] ℹ️    - Diagnosis 2: ''
[16:53:42] ℹ️    - Diagnosis 3: ''
[16:53:42] ℹ️    - Diagnosis 4: ''
[16:53:42] ℹ️    - Diagnosis 5: ''
[16:53:42] ℹ️    - Diagnosis 6: ''
[16:53:42] ℹ️  Final extracted MRN: '3188009'
[16:53:42] ℹ️  Final extracted Sex: 'FEMALE'
[16:53:42] ℹ️  Final extracted Service Line: 'RN'
[16:53:42] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[16:53:42] ✅ Patient data extraction completed successfully
[16:53:42] ✅    ✅ Patient data extracted successfully
[16:53:42] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Blanchette
     └─ dob: 10/06/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3188009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:42] ✅    ✅ Patient identified: Rita Blanchette
[16:53:42] ✅    ✅ Patient name validation passed
[16:53:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:53:42] [DOC: 9212076] ℹ️  DOB normalized: 10/06/1928
[16:53:42] [DOC: 9212076] ℹ️  Episode startOfCare normalized: 03/12/2025
[16:53:42] [DOC: 9212076] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[16:53:42] [DOC: 9212076] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[16:53:42] [DOC: 9212076] ✅ Patient date processing completed successfully
[16:53:42] ✅    ✅ Date processing completed
[16:53:42] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Blanchette
     └─ dob: 10/06/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3188009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:53:42] 🔄 
🔄 Step 4: Extracting order data...
[16:53:44] ℹ️  Order extraction - MRN: '3188009'
[16:53:44] ℹ️  Order extraction - Sex: 'FEMALE'
[16:53:44] ℹ️  Order extraction - Service Line: 'RN'
[16:53:44] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[16:53:44] ✅ Order data extraction completed successfully
[16:53:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:53:44] ℹ️  Using MRN from patient data: '3188009' over '3188009'
[16:53:44] ℹ️  Service line consistent in both sources: 'RN'
[16:53:44] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[16:53:44] ✅ Patient name cross-validation successful
[16:53:44] ✅    ✅ Data merged successfully
[16:53:45] ✅    ✅ Order data extracted and validated
[16:53:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:53:59] [DOC: 9212076] ✅ Patient exists in API: Rita Blanchette, ID: ea808626-f6db-4916-b57d-dae1fb46c508
[16:53:59] ✅    ✅ Existing patient found with ID: ea808626-f6db-4916-b57d-dae1fb46c508
[16:53:59] 🔄 
🔄 Step 6: Pushing order to API...
[16:53:59] [DOC: 9212076] ℹ️  Pushing order via API for patient ID: ea808626-f6db-4916-b57d-dae1fb46c508
[16:54:00] [DOC: 9212076] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:54:00] ❌    ❌ Failed to push order
[16:54:00] 🔄 
🔄 Step 7: Writing to CSV...
[16:54:00] [DOC: 9212076] ℹ️  Calculated age: 96 from DOB: 10/06/1928
[16:54:00] [DOC: 9212076] ℹ️  Service Line extracted: 'RN'
[16:54:00] [DOC: 9212076] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[16:54:00] [DOC: 9212076] ℹ️  Diagnosis codes being written:
[16:54:00] [DOC: 9212076] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:54:00] [DOC: 9212076] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:54:00] [DOC: 9212076] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:54:00] [DOC: 9212076] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:54:00] [DOC: 9212076] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:54:00] [DOC: 9212076] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:54:00] [DOC: 9212076] ✅ Patient data written to CSV: Rita Blanchette | Sex: FEMALE | Age: 96 | Service: RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 3188009
[16:54:00] ✅    ✅ Document 9212076 processed and saved successfully
[16:54:00] 🔄 
🔄 Step 8: Saving API details...
[16:54:00] [DOC: 9212076] ℹ️  API push details saved for document 9212076
[16:54:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212072                         ║
================================================================================
[16:54:00] ℹ️  Agency: Dartmouth HH
[16:54:00] ℹ️  Date: 03/31/2025
[16:54:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:54:02] [DOC: 9212072] ✅ Text extracted using pdfplumber (1165 chars)
[16:54:02] ✅    ✅ Text extracted using pdfplumber (1165 chars)
[16:54:02] 🔄 
🔄 Step 2: Extracting patient data...
[16:54:05] ℹ️  AI extracted raw sex value: 'F'
[16:54:05] ℹ️  AI extracted service line: 'PT, OT'
[16:54:05] ℹ️  AI extracted payer source: 'Medicare'
[16:54:05] ℹ️  AI extracted diagnoses:
[16:54:05] ℹ️    - Diagnosis 1: ''
[16:54:05] ℹ️    - Diagnosis 2: ''
[16:54:05] ℹ️    - Diagnosis 3: ''
[16:54:05] ℹ️    - Diagnosis 4: ''
[16:54:05] ℹ️    - Diagnosis 5: ''
[16:54:05] ℹ️    - Diagnosis 6: ''
[16:54:05] ℹ️  Final extracted MRN: '3649009'
[16:54:05] ℹ️  Final extracted Sex: 'FEMALE'
[16:54:05] ℹ️  Final extracted Service Line: 'PT, OT'
[16:54:05] ℹ️  Final extracted Payer Source: 'Medicare'
[16:54:05] ✅ Patient data extraction completed successfully
[16:54:05] ✅    ✅ Patient data extracted successfully
[16:54:05] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:54:05] ✅    ✅ Patient identified: Dorothy Fernandes
[16:54:05] ✅    ✅ Patient name validation passed
[16:54:05] 🔄 
🔄 Step 3: Processing patient dates...
[16:54:05] [DOC: 9212072] ℹ️  DOB normalized: 10/01/1937
[16:54:05] [DOC: 9212072] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:54:05] [DOC: 9212072] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:54:05] [DOC: 9212072] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:54:05] [DOC: 9212072] ✅ Patient date processing completed successfully
[16:54:05] ✅    ✅ Date processing completed
[16:54:05] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:54:05] 🔄 
🔄 Step 4: Extracting order data...
[16:54:08] ℹ️  Order extraction - MRN: ''
[16:54:08] ℹ️  Order extraction - Sex: 'FEMALE'
[16:54:08] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:54:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:54:08] ✅ Order data extraction completed successfully
[16:54:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:54:08] ℹ️  Using MRN from patient data: '3649009'
[16:54:08] ℹ️  Service line consistent in both sources: 'PT, OT'
[16:54:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:54:08] ✅ Patient name cross-validation successful
[16:54:08] ✅    ✅ Data merged successfully
[16:54:09] ✅    ✅ Order data extracted and validated
[16:54:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:54:09] [DOC: 9212072] ✅ Patient found in local cache: Dorothy Fernandes, ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[16:54:09] ✅    ✅ Existing patient found with ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[16:54:09] 🔄 
🔄 Step 6: Pushing order to API...
[16:54:09] [DOC: 9212072] ℹ️  Pushing order via API for patient ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[16:54:10] [DOC: 9212072] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13953"}
[16:54:10] ❌    ❌ Failed to push order
[16:54:10] 🔄 
🔄 Step 7: Writing to CSV...
[16:54:10] [DOC: 9212072] ℹ️  Calculated age: 87 from DOB: 10/01/1937
[16:54:10] [DOC: 9212072] ℹ️  Service Line extracted: 'PT, OT'
[16:54:10] [DOC: 9212072] ℹ️  Payer Source extracted: 'Medicare'
[16:54:10] [DOC: 9212072] ℹ️  Diagnosis codes being written:
[16:54:10] [DOC: 9212072] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:54:10] [DOC: 9212072] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:54:10] [DOC: 9212072] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:54:10] [DOC: 9212072] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:54:10] [DOC: 9212072] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:54:10] [DOC: 9212072] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:54:10] [DOC: 9212072] ✅ Patient data written to CSV: Dorothy Fernandes | Sex: FEMALE | Age: 87 | Service: PT, OT | Payer: Medicare | MRN: 3649009
[16:54:10] ✅    ✅ Document 9212072 processed and saved successfully
[16:54:10] 🔄 
🔄 Step 8: Saving API details...
[16:54:10] [DOC: 9212072] ℹ️  API push details saved for document 9212072
[16:54:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212067                         ║
================================================================================
[16:54:10] ℹ️  Agency: Dartmouth HH
[16:54:10] ℹ️  Date: 03/31/2025
[16:54:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:54:14] [DOC: 9212067] ✅ Text extracted using pdfplumber (9412 chars)
[16:54:14] ✅    ✅ Text extracted using pdfplumber (9412 chars)
[16:54:14] 🔄 
🔄 Step 2: Extracting patient data...
[16:54:17] ℹ️  AI extracted raw sex value: 'M'
[16:54:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:54:17] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[16:54:17] ℹ️  AI extracted diagnoses:
[16:54:17] ℹ️    - Diagnosis 1: 'T81.43XD'
[16:54:17] ℹ️    - Diagnosis 2: 'K65.1'
[16:54:17] ℹ️    - Diagnosis 3: 'B96.20'
[16:54:17] ℹ️    - Diagnosis 4: 'B96.1'
[16:54:17] ℹ️    - Diagnosis 5: 'B95.4'
[16:54:17] ℹ️    - Diagnosis 6: 'C25.0'
[16:54:17] ℹ️  Final extracted MRN: '4777015'
[16:54:17] ℹ️  Final extracted Sex: 'MALE'
[16:54:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:54:17] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[16:54:17] ✅ Patient data extraction completed successfully
[16:54:17] ✅    ✅ Patient data extracted successfully
[16:54:17] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'T81.43XD', 'secondDiagnosis': 'K65.1', 'thirdDiagnosis': 'B96.20', 'fourthDiagnosis': 'B96.1', 'fifthDiagnosis': 'B95.4', 'sixthDiagnosis': 'C25.0'}]
[16:54:17] ✅    ✅ Patient identified: Dennis Langevin
[16:54:17] ✅    ✅ Patient name validation passed
[16:54:17] 🔄 
🔄 Step 3: Processing patient dates...
[16:54:17] [DOC: 9212067] ℹ️  DOB normalized: 04/22/1944
[16:54:17] [DOC: 9212067] ℹ️  Episode startOfCare normalized: 08/21/2024
[16:54:17] [DOC: 9212067] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[16:54:17] [DOC: 9212067] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[16:54:17] [DOC: 9212067] ✅ Patient date processing completed successfully
[16:54:17] ✅    ✅ Date processing completed
[16:54:17] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'T81.43XD', 'secondDiagnosis': 'K65.1', 'thirdDiagnosis': 'B96.20', 'fourthDiagnosis': 'B96.1', 'fifthDiagnosis': 'B95.4', 'sixthDiagnosis': 'C25.0'}]
[16:54:17] 🔄 
🔄 Step 4: Extracting order data...
[16:54:19] ℹ️  Order extraction - MRN: '4777015'
[16:54:19] ℹ️  Order extraction - Sex: 'MALE'
[16:54:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:54:19] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[16:54:19] ✅ Order data extraction completed successfully
[16:54:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:54:19] ℹ️  Using MRN from patient data: '4777015' over '4777015'
[16:54:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:54:19] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[16:54:19] ✅ Patient name cross-validation successful
[16:54:19] ✅    ✅ Data merged successfully
[16:54:20] ✅    ✅ Order data extracted and validated
[16:54:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:54:20] [DOC: 9212067] ✅ Patient found in local cache: Dennis Langevin, ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[16:54:20] ✅    ✅ Existing patient found with ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[16:54:20] 🔄 
🔄 Step 6: Pushing order to API...
[16:54:20] [DOC: 9212067] ℹ️  Pushing order via API for patient ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[16:54:22] [DOC: 9212067] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:54:22] ❌    ❌ Failed to push order
[16:54:22] 🔄 
🔄 Step 7: Writing to CSV...
[16:54:22] [DOC: 9212067] ℹ️  Calculated age: 81 from DOB: 04/22/1944
[16:54:22] [DOC: 9212067] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:54:22] [DOC: 9212067] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[16:54:22] [DOC: 9212067] ℹ️  Diagnosis codes being written:
[16:54:22] [DOC: 9212067] ℹ️    - Latest_Episode_Firstdiagnosis: 'T81.43XD'
[16:54:22] [DOC: 9212067] ℹ️    - Latest_Episode_Seconddiagnosis: 'K65.1'
[16:54:22] [DOC: 9212067] ℹ️    - Latest_Episode_Thirddiagnosis: 'B96.20'
[16:54:22] [DOC: 9212067] ℹ️    - Latest_Episode_Fourthdiagnosis: 'B96.1'
[16:54:22] [DOC: 9212067] ℹ️    - Latest_Episode_Fifthdiagnosis: 'B95.4'
[16:54:22] [DOC: 9212067] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C25.0'
[16:54:22] [DOC: 9212067] ✅ Patient data written to CSV: Dennis Langevin | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer: Tufts Health Plan Medicare Preferred | MRN: 4777015
[16:54:22] ✅    ✅ Document 9212067 processed and saved successfully
[16:54:22] 🔄 
🔄 Step 8: Saving API details...
[16:54:22] [DOC: 9212067] ℹ️  API push details saved for document 9212067
[16:54:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212060                         ║
================================================================================
[16:54:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:54:22] ℹ️  Date: 03/31/2025
[16:54:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:54:26] [DOC: 9212060] ✅ Text extracted using pdfplumber (18467 chars)
[16:54:26] ✅    ✅ Text extracted using pdfplumber (18467 chars)
[16:54:26] 🔄 
🔄 Step 2: Extracting patient data...
[16:54:29] ℹ️  AI extracted raw sex value: 'F'
[16:54:29] ℹ️  AI extracted service line: 'PT'
[16:54:29] ℹ️  AI extracted payer source: ''
[16:54:29] ℹ️  AI extracted diagnoses:
[16:54:29] ℹ️    - Diagnosis 1: 'I10'
[16:54:29] ℹ️    - Diagnosis 2: ''
[16:54:29] ℹ️    - Diagnosis 3: ''
[16:54:29] ℹ️    - Diagnosis 4: ''
[16:54:29] ℹ️    - Diagnosis 5: ''
[16:54:29] ℹ️    - Diagnosis 6: ''
[16:54:29] ℹ️  Final extracted MRN: 'MA250115023801'
[16:54:29] ℹ️  Final extracted Sex: 'FEMALE'
[16:54:29] ℹ️  Final extracted Service Line: 'PT'
[16:54:29] ℹ️  Final extracted Payer Source: ''
[16:54:29] ✅ Patient data extraction completed successfully
[16:54:29] ✅    ✅ Patient data extracted successfully
[16:54:29] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Vieira
     └─ dob: 02/05/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250115023801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:54:29] ✅    ✅ Patient identified: Nancy Vieira
[16:54:29] ✅    ✅ Patient name validation passed
[16:54:29] 🔄 
🔄 Step 3: Processing patient dates...
[16:54:29] [DOC: 9212060] ℹ️  DOB normalized: 02/05/1938
[16:54:29] [DOC: 9212060] ℹ️  Episode startOfEpisode normalized: 01/24/2025
[16:54:29] [DOC: 9212060] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[16:54:29] [DOC: 9212060] ✅ Patient date processing completed successfully
[16:54:29] ✅    ✅ Date processing completed
[16:54:29] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Vieira
     └─ dob: 02/05/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250115023801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:54:29] 🔄 
🔄 Step 4: Extracting order data...
[16:54:31] ℹ️  Order extraction - MRN: 'MA250115023801'
[16:54:31] ℹ️  Order extraction - Sex: 'FEMALE'
[16:54:31] ℹ️  Order extraction - Service Line: 'PT'
[16:54:31] ℹ️  Order extraction - Payer Source: ''
[16:54:31] ✅ Order data extraction completed successfully
[16:54:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:54:31] ℹ️  Using MRN from patient data: 'MA250115023801' over 'MA250115023801'
[16:54:31] ℹ️  Service line consistent in both sources: 'PT'
[16:54:31] ✅ Patient name cross-validation successful
[16:54:31] ✅    ✅ Data merged successfully
[16:54:33] ✅    ✅ Order data extracted and validated
[16:54:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:54:33] [DOC: 9212060] ✅ Patient found in local cache: Nancy Vieira, ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:54:33] ✅    ✅ Existing patient found with ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:54:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:54:33] [DOC: 9212060] ℹ️  Pushing order via API for patient ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:54:34] [DOC: 9212060] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:54:34] ❌    ❌ Failed to push order
[16:54:34] 🔄 
🔄 Step 7: Writing to CSV...
[16:54:34] [DOC: 9212060] ℹ️  Calculated age: 87 from DOB: 02/05/1938
[16:54:34] [DOC: 9212060] ℹ️  Service Line extracted: 'PT'
[16:54:34] [DOC: 9212060] ℹ️  Payer Source extracted: ''
[16:54:34] [DOC: 9212060] ℹ️  Diagnosis codes being written:
[16:54:34] [DOC: 9212060] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[16:54:34] [DOC: 9212060] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:54:34] [DOC: 9212060] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:54:34] [DOC: 9212060] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:54:34] [DOC: 9212060] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:54:34] [DOC: 9212060] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:54:34] [DOC: 9212060] ✅ Patient data written to CSV: Nancy Vieira | Sex: FEMALE | Age: 87 | Service: PT | Payer:  | MRN: MA250115023801
[16:54:34] ✅    ✅ Document 9212060 processed and saved successfully
[16:54:34] 🔄 
🔄 Step 8: Saving API details...
[16:54:34] [DOC: 9212060] ℹ️  API push details saved for document 9212060
[16:54:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212057                         ║
================================================================================
[16:54:34] ℹ️  Agency: Dartmouth HH
[16:54:34] ℹ️  Date: 03/31/2025
[16:54:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:54:36] [DOC: 9212057] ✅ Text extracted using pdfplumber (1095 chars)
[16:54:36] ✅    ✅ Text extracted using pdfplumber (1095 chars)
[16:54:36] 🔄 
🔄 Step 2: Extracting patient data...
[16:54:39] ℹ️  AI extracted raw sex value: 'F'
[16:54:39] ℹ️  AI extracted service line: 'PT'
[16:54:39] ℹ️  AI extracted payer source: 'Medicare'
[16:54:39] ℹ️  AI extracted diagnoses:
[16:54:39] ℹ️    - Diagnosis 1: ''
[16:54:39] ℹ️    - Diagnosis 2: ''
[16:54:39] ℹ️    - Diagnosis 3: ''
[16:54:39] ℹ️    - Diagnosis 4: ''
[16:54:39] ℹ️    - Diagnosis 5: ''
[16:54:39] ℹ️    - Diagnosis 6: ''
[16:54:39] ℹ️  Final extracted MRN: '5663015'
[16:54:39] ℹ️  Final extracted Sex: 'FEMALE'
[16:54:39] ℹ️  Final extracted Service Line: 'PT'
[16:54:39] ℹ️  Final extracted Payer Source: 'Medicare'
[16:54:39] ✅ Patient data extraction completed successfully
[16:54:39] ✅    ✅ Patient data extracted successfully
[16:54:39] 📊 Patient Response
     └─ patientFName: Beverley
     └─ patientLName: Oberry
     └─ dob: 02/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5663015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 263 Hawthorn St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/04/2024', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:54:39] ✅    ✅ Patient identified: Beverley Oberry
[16:54:39] ✅    ✅ Patient name validation passed
[16:54:39] 🔄 
🔄 Step 3: Processing patient dates...
[16:54:39] [DOC: 9212057] ℹ️  DOB normalized: 02/16/1932
[16:54:39] [DOC: 9212057] ℹ️  Episode startOfCare normalized: 12/04/2024
[16:54:39] [DOC: 9212057] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[16:54:39] [DOC: 9212057] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[16:54:39] [DOC: 9212057] ✅ Patient date processing completed successfully
[16:54:39] ✅    ✅ Date processing completed
[16:54:39] 📊 Processed Patient Data
     └─ patientFName: Beverley
     └─ patientLName: Oberry
     └─ dob: 02/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5663015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 263 Hawthorn St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/04/2024', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:54:39] 🔄 
🔄 Step 4: Extracting order data...
[16:54:41] ℹ️  Order extraction - MRN: ''
[16:54:41] ℹ️  Order extraction - Sex: 'FEMALE'
[16:54:41] ℹ️  Order extraction - Service Line: 'PT'
[16:54:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:54:41] ✅ Order data extraction completed successfully
[16:54:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:54:41] ℹ️  Using MRN from patient data: '5663015'
[16:54:41] ℹ️  Service line consistent in both sources: 'PT'
[16:54:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:54:41] ✅ Patient name cross-validation successful
[16:54:41] ✅    ✅ Data merged successfully
[16:54:42] ✅    ✅ Order data extracted and validated
[16:54:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:55:06] [DOC: 9212057] ✅ Patient exists in API: Beverley Oberry, ID: fca8d8a7-746d-4a8f-99ee-b8d5ae037a4a
[16:55:06] ✅    ✅ Existing patient found with ID: fca8d8a7-746d-4a8f-99ee-b8d5ae037a4a
[16:55:06] 🔄 
🔄 Step 6: Pushing order to API...
[16:55:06] [DOC: 9212057] ℹ️  Pushing order via API for patient ID: fca8d8a7-746d-4a8f-99ee-b8d5ae037a4a
[16:55:07] [DOC: 9212057] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:55:07] ❌    ❌ Failed to push order
[16:55:07] 🔄 
🔄 Step 7: Writing to CSV...
[16:55:07] [DOC: 9212057] ℹ️  Calculated age: 93 from DOB: 02/16/1932
[16:55:07] [DOC: 9212057] ℹ️  Service Line extracted: 'PT'
[16:55:07] [DOC: 9212057] ℹ️  Payer Source extracted: 'Medicare'
[16:55:07] [DOC: 9212057] ℹ️  Diagnosis codes being written:
[16:55:07] [DOC: 9212057] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:55:07] [DOC: 9212057] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:55:07] [DOC: 9212057] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:55:07] [DOC: 9212057] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:55:07] [DOC: 9212057] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:55:07] [DOC: 9212057] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:55:07] [DOC: 9212057] ✅ Patient data written to CSV: Beverley Oberry | Sex: FEMALE | Age: 93 | Service: PT | Payer: Medicare | MRN: 5663015
[16:55:07] ✅    ✅ Document 9212057 processed and saved successfully
[16:55:07] 🔄 
🔄 Step 8: Saving API details...
[16:55:07] [DOC: 9212057] ℹ️  API push details saved for document 9212057
[16:55:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212055                         ║
================================================================================
[16:55:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:55:07] ℹ️  Date: 03/31/2025
[16:55:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:55:10] [DOC: 9212055] ✅ Text extracted using pdfplumber (13649 chars)
[16:55:10] ✅    ✅ Text extracted using pdfplumber (13649 chars)
[16:55:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:55:13] ℹ️  AI extracted raw sex value: 'F'
[16:55:13] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:55:13] ℹ️  AI extracted payer source: 'Medicare'
[16:55:13] ℹ️  AI extracted diagnoses:
[16:55:13] ℹ️    - Diagnosis 1: 'I10'
[16:55:13] ℹ️    - Diagnosis 2: 'E11.42'
[16:55:13] ℹ️    - Diagnosis 3: 'M51.369'
[16:55:13] ℹ️    - Diagnosis 4: 'M47.816'
[16:55:13] ℹ️    - Diagnosis 5: 'G47.33'
[16:55:13] ℹ️    - Diagnosis 6: 'S02.2XX'
[16:55:13] ℹ️  Final extracted MRN: 'MA250115023801'
[16:55:13] ℹ️  Final extracted Sex: 'FEMALE'
[16:55:13] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:55:13] ℹ️  Final extracted Payer Source: 'Medicare'
[16:55:13] ✅ Patient data extraction completed successfully
[16:55:13] ✅    ✅ Patient data extracted successfully
[16:55:13] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Vieira
     └─ dob: 02/05/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250115023801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 1881923936
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 990-1089
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'M51.369', 'fourthDiagnosis': 'M47.816', 'fifthDiagnosis': 'G47.33', 'sixthDiagnosis': 'S02.2XX'}]
[16:55:13] ✅    ✅ Patient identified: Nancy Vieira
[16:55:13] ✅    ✅ Patient name validation passed
[16:55:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:55:13] [DOC: 9212055] ℹ️  DOB normalized: 02/05/1938
[16:55:13] [DOC: 9212055] ℹ️  Episode startOfCare normalized: 01/20/2025
[16:55:13] [DOC: 9212055] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[16:55:13] [DOC: 9212055] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[16:55:13] [DOC: 9212055] ✅ Patient date processing completed successfully
[16:55:13] ✅    ✅ Date processing completed
[16:55:13] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Vieira
     └─ dob: 02/05/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250115023801
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 1881923936
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 990-1089
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'M51.369', 'fourthDiagnosis': 'M47.816', 'fifthDiagnosis': 'G47.33', 'sixthDiagnosis': 'S02.2XX'}]
[16:55:13] 🔄 
🔄 Step 4: Extracting order data...
[16:55:16] ℹ️  Order extraction - MRN: 'MA250115023801'
[16:55:16] ℹ️  Order extraction - Sex: 'FEMALE'
[16:55:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:55:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:55:16] ✅ Order data extraction completed successfully
[16:55:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:55:16] ℹ️  Using MRN from patient data: 'MA250115023801' over 'MA250115023801'
[16:55:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:55:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:55:16] ✅ Patient name cross-validation successful
[16:55:16] ✅    ✅ Data merged successfully
[16:55:17] ✅    ✅ Order data extracted and validated
[16:55:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:55:17] [DOC: 9212055] ✅ Patient found in local cache: Nancy Vieira, ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:55:17] ✅    ✅ Existing patient found with ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:55:17] 🔄 
🔄 Step 6: Pushing order to API...
[16:55:17] [DOC: 9212055] ℹ️  Pushing order via API for patient ID: 1d679d43-a552-4a8a-a993-8e549f234484
[16:55:18] [DOC: 9212055] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14392"}
[16:55:18] ❌    ❌ Failed to push order
[16:55:18] 🔄 
🔄 Step 7: Writing to CSV...
[16:55:18] [DOC: 9212055] ℹ️  Calculated age: 87 from DOB: 02/05/1938
[16:55:18] [DOC: 9212055] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:55:18] [DOC: 9212055] ℹ️  Payer Source extracted: 'Medicare'
[16:55:18] [DOC: 9212055] ℹ️  Diagnosis codes being written:
[16:55:18] [DOC: 9212055] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[16:55:18] [DOC: 9212055] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.42'
[16:55:18] [DOC: 9212055] ℹ️    - Latest_Episode_Thirddiagnosis: 'M51.369'
[16:55:18] [DOC: 9212055] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M47.816'
[16:55:18] [DOC: 9212055] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G47.33'
[16:55:18] [DOC: 9212055] ℹ️    - Latest_Episode_Sixthdiagnosis: 'S02.2XX'
[16:55:18] [DOC: 9212055] ✅ Patient data written to CSV: Nancy Vieira | Sex: FEMALE | Age: 87 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA250115023801
[16:55:18] ✅    ✅ Document 9212055 processed and saved successfully
[16:55:18] 🔄 
🔄 Step 8: Saving API details...
[16:55:18] [DOC: 9212055] ℹ️  API push details saved for document 9212055
[16:55:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212037                         ║
================================================================================
[16:55:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:55:18] ℹ️  Date: 03/31/2025
[16:55:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:55:20] [DOC: 9212037] ✅ Text extracted using pdfplumber (2338 chars)
[16:55:20] ✅    ✅ Text extracted using pdfplumber (2326 chars)
[16:55:20] 🔄 
🔄 Step 2: Extracting patient data...
[16:55:23] ℹ️  AI extracted raw sex value: ''
[16:55:23] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:55:23] ℹ️  AI extracted payer source: ''
[16:55:23] ℹ️  AI extracted diagnoses:
[16:55:23] ℹ️    - Diagnosis 1: 'I13.0'
[16:55:23] ℹ️    - Diagnosis 2: 'I50.43'
[16:55:23] ℹ️    - Diagnosis 3: 'E11.22'
[16:55:23] ℹ️    - Diagnosis 4: 'None'
[16:55:23] ℹ️    - Diagnosis 5: 'None'
[16:55:23] ℹ️    - Diagnosis 6: 'None'
[16:55:23] ℹ️  Final extracted MRN: 'MA250224016702'
[16:55:23] ℹ️  Final extracted Sex: ''
[16:55:23] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:55:23] ℹ️  Final extracted Payer Source: ''
[16:55:23] ✅ Patient data extraction completed successfully
[16:55:23] ✅    ✅ Patient data extracted successfully
[16:55:23] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:55:23] ✅    ✅ Patient identified: Judith Souza
[16:55:23] ✅    ✅ Patient name validation passed
[16:55:23] 🔄 
🔄 Step 3: Processing patient dates...
[16:55:23] [DOC: 9212037] ℹ️  DOB normalized: 01/04/1967
[16:55:23] [DOC: 9212037] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:55:23] [DOC: 9212037] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:55:23] [DOC: 9212037] ✅ Patient date processing completed successfully
[16:55:23] ✅    ✅ Date processing completed
[16:55:23] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'E11.22'}]
[16:55:23] 🔄 
🔄 Step 4: Extracting order data...
[16:55:26] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:55:26] ℹ️  Order extraction - Sex: ''
[16:55:26] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:55:26] ℹ️  Order extraction - Payer Source: ''
[16:55:26] ✅ Order data extraction completed successfully
[16:55:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:55:26] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:55:26] ⚠️  Could not determine sex using any available method
[16:55:26] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:55:26] ✅ Patient name cross-validation successful
[16:55:26] ✅    ✅ Data merged successfully
[16:55:27] ✅    ✅ Order data extracted and validated
[16:55:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:55:57] [DOC: 9212037] ℹ️  Patient not found in cache or API: Judith Souza
[16:55:57] [DOC: 9212037] ℹ️  Patient not found, creating new patient via API...
[16:55:57] [DOC: 9212037] ℹ️  Creating patient via API: Judith Souza
[16:55:58] [DOC: 9212037] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:55:58] ❌    ❌ Failed to create patient
[16:55:58] [DOC: 9212037] ℹ️  API push details saved for document 9212037
================================================================================
║                        Processing Document ID: 9212032                         ║
================================================================================
[16:55:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:55:58] ℹ️  Date: 03/31/2025
[16:55:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:56:02] [DOC: 9212032] ✅ Text extracted using pdfplumber (24340 chars)
[16:56:02] ✅    ✅ Text extracted using pdfplumber (24328 chars)
[16:56:02] 🔄 
🔄 Step 2: Extracting patient data...
[16:56:06] ℹ️  AI extracted raw sex value: 'F'
[16:56:06] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:56:06] ℹ️  AI extracted payer source: 'Medicare'
[16:56:06] ℹ️  AI extracted diagnoses:
[16:56:06] ℹ️    - Diagnosis 1: 'I13.0'
[16:56:06] ℹ️    - Diagnosis 2: 'I50.43'
[16:56:06] ℹ️    - Diagnosis 3: 'E11.22'
[16:56:06] ℹ️    - Diagnosis 4: 'N18.30'
[16:56:06] ℹ️    - Diagnosis 5: 'E03.9'
[16:56:06] ℹ️    - Diagnosis 6: 'G89.4'
[16:56:06] ℹ️  Final extracted MRN: 'MA250224016702'
[16:56:06] ℹ️  Final extracted Sex: 'FEMALE'
[16:56:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:56:06] ℹ️  Final extracted Payer Source: 'Medicare'
[16:56:06] ✅ Patient data extraction completed successfully
[16:56:06] ✅    ✅ Patient data extracted successfully
[16:56:06] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 1881923936
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 287-8247
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G89.4'}]
[16:56:06] ✅    ✅ Patient identified: Judith Souza
[16:56:06] ✅    ✅ Patient name validation passed
[16:56:06] 🔄 
🔄 Step 3: Processing patient dates...
[16:56:06] [DOC: 9212032] ℹ️  DOB normalized: 01/04/1967
[16:56:06] [DOC: 9212032] ℹ️  Episode startOfCare normalized: 03/01/2025
[16:56:06] [DOC: 9212032] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:56:06] [DOC: 9212032] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:56:06] [DOC: 9212032] ✅ Patient date processing completed successfully
[16:56:06] ✅    ✅ Date processing completed
[16:56:06] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 1881923936
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 287-8247
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G89.4'}]
[16:56:06] 🔄 
🔄 Step 4: Extracting order data...
[16:56:09] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:56:09] ℹ️  Order extraction - Sex: 'FEMALE'
[16:56:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:56:09] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:56:09] ✅ Order data extraction completed successfully
[16:56:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:56:09] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:56:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:56:09] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:56:09] ✅ Patient name cross-validation successful
[16:56:09] ✅    ✅ Data merged successfully
[16:56:10] ✅    ✅ Order data extracted and validated
[16:56:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:56:48] [DOC: 9212032] ℹ️  Patient not found in cache or API: Judith Souza
[16:56:48] [DOC: 9212032] ℹ️  Patient not found, creating new patient via API...
[16:56:48] [DOC: 9212032] ℹ️  Creating patient via API: Judith Souza
[16:56:50] [DOC: 9212032] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:56:50] ❌    ❌ Failed to create patient
[16:56:50] [DOC: 9212032] ℹ️  API push details saved for document 9212032
================================================================================
║                        Processing Document ID: 9212031                         ║
================================================================================
[16:56:50] ℹ️  Agency: Dartmouth HH
[16:56:50] ℹ️  Date: 03/31/2025
[16:56:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:56:52] [DOC: 9212031] ✅ Text extracted using pdfplumber (2771 chars)
[16:56:52] ✅    ✅ Text extracted using pdfplumber (2771 chars)
[16:56:52] 🔄 
🔄 Step 2: Extracting patient data...
[16:56:54] ℹ️  AI extracted raw sex value: 'F'
[16:56:54] ℹ️  AI extracted service line: 'RN, PT, OT'
[16:56:54] ℹ️  AI extracted payer source: 'Medicare'
[16:56:54] ℹ️  AI extracted diagnoses:
[16:56:54] ℹ️    - Diagnosis 1: ''
[16:56:54] ℹ️    - Diagnosis 2: ''
[16:56:54] ℹ️    - Diagnosis 3: ''
[16:56:54] ℹ️    - Diagnosis 4: ''
[16:56:54] ℹ️    - Diagnosis 5: ''
[16:56:54] ℹ️    - Diagnosis 6: ''
[16:56:54] ℹ️  Final extracted MRN: '6117015'
[16:56:54] ℹ️  Final extracted Sex: 'FEMALE'
[16:56:54] ℹ️  Final extracted Service Line: 'RN, PT, OT'
[16:56:54] ℹ️  Final extracted Payer Source: 'Medicare'
[16:56:54] ✅ Patient data extraction completed successfully
[16:56:54] ✅    ✅ Patient data extracted successfully
[16:56:54] 📊 Patient Response
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:56:54] ✅    ✅ Patient identified: Janet Cabral
[16:56:54] ✅    ✅ Patient name validation passed
[16:56:54] 🔄 
🔄 Step 3: Processing patient dates...
[16:56:54] [DOC: 9212031] ℹ️  DOB normalized: 07/26/1952
[16:56:54] [DOC: 9212031] ℹ️  Episode startOfCare normalized: 02/28/2025
[16:56:54] [DOC: 9212031] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[16:56:54] [DOC: 9212031] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[16:56:54] [DOC: 9212031] ✅ Patient date processing completed successfully
[16:56:54] ✅    ✅ Date processing completed
[16:56:54] 📊 Processed Patient Data
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:56:54] 🔄 
🔄 Step 4: Extracting order data...
[16:56:57] ℹ️  Order extraction - MRN: '6117015'
[16:56:57] ℹ️  Order extraction - Sex: 'FEMALE'
[16:56:57] ℹ️  Order extraction - Service Line: 'RN, PT, OT'
[16:56:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:56:57] ✅ Order data extraction completed successfully
[16:56:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:56:57] ℹ️  Using MRN from patient data: '6117015' over '6117015'
[16:56:57] ℹ️  Service line consistent in both sources: 'RN, PT, OT'
[16:56:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:56:57] ✅ Patient name cross-validation successful
[16:56:57] ✅    ✅ Data merged successfully
[16:56:58] ✅    ✅ Order data extracted and validated
[16:56:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:56:58] [DOC: 9212031] ✅ Patient found in local cache: Janet Cabral, ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[16:56:58] ✅    ✅ Existing patient found with ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[16:56:58] 🔄 
🔄 Step 6: Pushing order to API...
[16:56:58] [DOC: 9212031] ℹ️  Pushing order via API for patient ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[16:57:00] [DOC: 9212031] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:57:00] ❌    ❌ Failed to push order
[16:57:00] 🔄 
🔄 Step 7: Writing to CSV...
[16:57:00] [DOC: 9212031] ℹ️  Calculated age: 72 from DOB: 07/26/1952
[16:57:00] [DOC: 9212031] ℹ️  Service Line extracted: 'RN, PT, OT'
[16:57:00] [DOC: 9212031] ℹ️  Payer Source extracted: 'Medicare'
[16:57:00] [DOC: 9212031] ℹ️  Diagnosis codes being written:
[16:57:00] [DOC: 9212031] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:57:00] [DOC: 9212031] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:57:00] [DOC: 9212031] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:57:00] [DOC: 9212031] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:57:00] [DOC: 9212031] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:57:00] [DOC: 9212031] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:57:00] [DOC: 9212031] ✅ Patient data written to CSV: Janet Cabral | Sex: FEMALE | Age: 72 | Service: RN, PT, OT | Payer: Medicare | MRN: 6117015
[16:57:00] ✅    ✅ Document 9212031 processed and saved successfully
[16:57:00] 🔄 
🔄 Step 8: Saving API details...
[16:57:00] [DOC: 9212031] ℹ️  API push details saved for document 9212031
[16:57:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212027                         ║
================================================================================
[16:57:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:57:00] ℹ️  Date: 03/31/2025
[16:57:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:57:04] [DOC: 9212027] ✅ Text extracted using pdfplumber (2084 chars)
[16:57:04] ✅    ✅ Text extracted using pdfplumber (2072 chars)
[16:57:04] 🔄 
🔄 Step 2: Extracting patient data...
[16:57:07] ℹ️  AI extracted raw sex value: ''
[16:57:07] ℹ️  AI extracted service line: 'Physical Therapy'
[16:57:07] ℹ️  AI extracted payer source: ''
[16:57:07] ℹ️  AI extracted diagnoses:
[16:57:07] ℹ️    - Diagnosis 1: 'I13.0'
[16:57:07] ℹ️    - Diagnosis 2: 'I50.43'
[16:57:07] ℹ️    - Diagnosis 3: 'E11.22'
[16:57:07] ℹ️    - Diagnosis 4: 'None'
[16:57:07] ℹ️    - Diagnosis 5: 'None'
[16:57:07] ℹ️    - Diagnosis 6: 'None'
[16:57:07] ℹ️  Final extracted MRN: 'MA250224016702'
[16:57:07] ℹ️  Final extracted Sex: ''
[16:57:07] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:57:07] ℹ️  Final extracted Payer Source: ''
[16:57:07] ✅ Patient data extraction completed successfully
[16:57:07] ✅    ✅ Patient data extracted successfully
[16:57:07] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:57:07] ✅    ✅ Patient identified: Judith Souza
[16:57:07] ✅    ✅ Patient name validation passed
[16:57:07] 🔄 
🔄 Step 3: Processing patient dates...
[16:57:07] [DOC: 9212027] ℹ️  DOB normalized: 01/04/1967
[16:57:07] [DOC: 9212027] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:57:07] [DOC: 9212027] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:57:07] [DOC: 9212027] ✅ Patient date processing completed successfully
[16:57:07] ✅    ✅ Date processing completed
[16:57:07] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'E11.22'}]
[16:57:07] 🔄 
🔄 Step 4: Extracting order data...
[16:57:09] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:57:09] ℹ️  Order extraction - Sex: ''
[16:57:09] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:57:09] ℹ️  Order extraction - Payer Source: ''
[16:57:09] ✅ Order data extraction completed successfully
[16:57:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:57:09] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:57:09] ⚠️  Could not determine sex using any available method
[16:57:09] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:57:09] ✅ Patient name cross-validation successful
[16:57:09] ✅    ✅ Data merged successfully
[16:57:11] ✅    ✅ Order data extracted and validated
[16:57:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:57:27] [DOC: 9212027] ℹ️  Patient not found in cache or API: Judith Souza
[16:57:27] [DOC: 9212027] ℹ️  Patient not found, creating new patient via API...
[16:57:27] [DOC: 9212027] ℹ️  Creating patient via API: Judith Souza
[16:57:28] [DOC: 9212027] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:57:28] ❌    ❌ Failed to create patient
[16:57:28] [DOC: 9212027] ℹ️  API push details saved for document 9212027
================================================================================
║                        Processing Document ID: 9212023                         ║
================================================================================
[16:57:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:57:28] ℹ️  Date: 03/31/2025
[16:57:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:57:31] [DOC: 9212023] ✅ Text extracted using pdfplumber (12273 chars)
[16:57:31] ✅    ✅ Text extracted using pdfplumber (12273 chars)
[16:57:31] 🔄 
🔄 Step 2: Extracting patient data...
[16:57:34] ℹ️  AI extracted raw sex value: 'F'
[16:57:34] ℹ️  AI extracted service line: 'OT'
[16:57:34] ℹ️  AI extracted payer source: ''
[16:57:34] ℹ️  AI extracted diagnoses:
[16:57:34] ℹ️    - Diagnosis 1: 'J44.1'
[16:57:34] ℹ️    - Diagnosis 2: 'N18.9'
[16:57:34] ℹ️    - Diagnosis 3: 'I50.9'
[16:57:34] ℹ️    - Diagnosis 4: ''
[16:57:34] ℹ️    - Diagnosis 5: ''
[16:57:34] ℹ️    - Diagnosis 6: ''
[16:57:34] ℹ️  Final extracted MRN: 'MA250224016702'
[16:57:34] ℹ️  Final extracted Sex: 'FEMALE'
[16:57:34] ℹ️  Final extracted Service Line: 'OT'
[16:57:34] ℹ️  Final extracted Payer Source: ''
[16:57:34] ✅ Patient data extraction completed successfully
[16:57:34] ✅    ✅ Patient data extracted successfully
[16:57:34] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'N18.9', 'thirdDiagnosis': 'I50.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:57:34] ✅    ✅ Patient identified: Judith Souza
[16:57:34] ✅    ✅ Patient name validation passed
[16:57:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:57:34] [DOC: 9212023] ℹ️  DOB normalized: 01/04/1967
[16:57:34] [DOC: 9212023] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[16:57:34] [DOC: 9212023] ✅ Patient date processing completed successfully
[16:57:34] ✅    ✅ Date processing completed
[16:57:34] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'N18.9', 'thirdDiagnosis': 'I50.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:57:34] 🔄 
🔄 Step 4: Extracting order data...
[16:57:37] ℹ️  Order extraction - MRN: 'MA250224016702'
[16:57:37] ℹ️  Order extraction - Sex: 'FEMALE'
[16:57:37] ℹ️  Order extraction - Service Line: 'OT'
[16:57:37] ℹ️  Order extraction - Payer Source: ''
[16:57:37] ✅ Order data extraction completed successfully
[16:57:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:57:37] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[16:57:37] ℹ️  Service line consistent in both sources: 'OT'
[16:57:37] ✅ Patient name cross-validation successful
[16:57:37] ✅    ✅ Data merged successfully
[16:57:38] ⚠️     ❌ Skipping - missing episode start date
[16:57:38] [DOC: 9212023] ℹ️  API push details saved for document 9212023
================================================================================
║                        Processing Document ID: 9212021                         ║
================================================================================
[16:57:38] ℹ️  Agency: Dartmouth HH
[16:57:38] ℹ️  Date: 03/31/2025
[16:57:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:57:40] [DOC: 9212021] ✅ Text extracted using pdfplumber (1086 chars)
[16:57:40] ✅    ✅ Text extracted using pdfplumber (1086 chars)
[16:57:40] 🔄 
🔄 Step 2: Extracting patient data...
[16:57:43] ℹ️  AI extracted raw sex value: 'F'
[16:57:43] ℹ️  AI extracted service line: 'Physical Therapy'
[16:57:43] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:57:43] ℹ️  AI extracted diagnoses:
[16:57:43] ℹ️    - Diagnosis 1: ''
[16:57:43] ℹ️    - Diagnosis 2: ''
[16:57:43] ℹ️    - Diagnosis 3: ''
[16:57:43] ℹ️    - Diagnosis 4: ''
[16:57:43] ℹ️    - Diagnosis 5: ''
[16:57:43] ℹ️    - Diagnosis 6: ''
[16:57:43] ℹ️  Final extracted MRN: '6204015'
[16:57:43] ℹ️  Final extracted Sex: 'FEMALE'
[16:57:43] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:57:43] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:57:43] ✅ Patient data extraction completed successfully
[16:57:43] ✅    ✅ Patient data extracted successfully
[16:57:43] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:57:43] ✅    ✅ Patient identified: Rita Costa
[16:57:43] ✅    ✅ Patient name validation passed
[16:57:43] 🔄 
🔄 Step 3: Processing patient dates...
[16:57:43] [DOC: 9212021] ℹ️  DOB normalized: 10/16/1930
[16:57:43] [DOC: 9212021] ℹ️  Episode startOfCare normalized: 03/17/2025
[16:57:43] [DOC: 9212021] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[16:57:43] [DOC: 9212021] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[16:57:43] [DOC: 9212021] ✅ Patient date processing completed successfully
[16:57:43] ✅    ✅ Date processing completed
[16:57:43] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:57:43] 🔄 
🔄 Step 4: Extracting order data...
[16:57:45] ℹ️  Order extraction - MRN: ''
[16:57:45] ℹ️  Order extraction - Sex: 'FEMALE'
[16:57:45] ℹ️  Order extraction - Service Line: 'PT'
[16:57:45] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:57:45] ✅ Order data extraction completed successfully
[16:57:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:57:45] ℹ️  Using MRN from patient data: '6204015'
[16:57:45] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[16:57:45] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:57:45] ✅ Patient name cross-validation successful
[16:57:45] ✅    ✅ Data merged successfully
[16:57:46] ✅    ✅ Order data extracted and validated
[16:57:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:57:46] [DOC: 9212021] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[16:57:46] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[16:57:46] 🔄 
🔄 Step 6: Pushing order to API...
[16:57:46] [DOC: 9212021] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[16:57:48] [DOC: 9212021] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12877"}
[16:57:48] ❌    ❌ Failed to push order
[16:57:48] 🔄 
🔄 Step 7: Writing to CSV...
[16:57:48] [DOC: 9212021] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[16:57:48] [DOC: 9212021] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[16:57:48] [DOC: 9212021] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[16:57:48] [DOC: 9212021] ℹ️  Diagnosis codes being written:
[16:57:48] [DOC: 9212021] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:57:48] [DOC: 9212021] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:57:48] [DOC: 9212021] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:57:48] [DOC: 9212021] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:57:48] [DOC: 9212021] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:57:48] [DOC: 9212021] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:57:48] [DOC: 9212021] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: PT, Physical Therapy | Payer: Aetna- Mcare | MRN: 6204015
[16:57:48] ✅    ✅ Document 9212021 processed and saved successfully
[16:57:48] 🔄 
🔄 Step 8: Saving API details...
[16:57:48] [DOC: 9212021] ℹ️  API push details saved for document 9212021
[16:57:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212014                         ║
================================================================================
[16:57:48] ℹ️  Agency: Dartmouth HH
[16:57:48] ℹ️  Date: 03/31/2025
[16:57:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:57:50] [DOC: 9212014] ✅ Text extracted using pdfplumber (1551 chars)
[16:57:50] ✅    ✅ Text extracted using pdfplumber (1551 chars)
[16:57:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:57:52] ℹ️  AI extracted raw sex value: 'M'
[16:57:52] ℹ️  AI extracted service line: 'PT'
[16:57:52] ℹ️  AI extracted payer source: 'United Health Care'
[16:57:52] ℹ️  AI extracted diagnoses:
[16:57:52] ℹ️    - Diagnosis 1: ''
[16:57:52] ℹ️    - Diagnosis 2: ''
[16:57:52] ℹ️    - Diagnosis 3: ''
[16:57:52] ℹ️    - Diagnosis 4: ''
[16:57:52] ℹ️    - Diagnosis 5: ''
[16:57:52] ℹ️    - Diagnosis 6: ''
[16:57:52] ℹ️  Final extracted MRN: '926015'
[16:57:52] ℹ️  Final extracted Sex: 'MALE'
[16:57:52] ℹ️  Final extracted Service Line: 'PT'
[16:57:52] ℹ️  Final extracted Payer Source: 'United Health Care'
[16:57:52] ✅ Patient data extraction completed successfully
[16:57:52] ✅    ✅ Patient data extracted successfully
[16:57:52] 📊 Patient Response
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 88 Highland St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:57:52] ✅    ✅ Patient identified: Clinton Sowle
[16:57:52] ✅    ✅ Patient name validation passed
[16:57:52] 🔄 
🔄 Step 3: Processing patient dates...
[16:57:52] [DOC: 9212014] ℹ️  DOB normalized: 12/01/1943
[16:57:52] [DOC: 9212014] ℹ️  Episode startOfCare normalized: 02/14/2025
[16:57:52] [DOC: 9212014] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[16:57:52] [DOC: 9212014] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[16:57:52] [DOC: 9212014] ✅ Patient date processing completed successfully
[16:57:52] ✅    ✅ Date processing completed
[16:57:52] 📊 Processed Patient Data
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 88 Highland St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:57:52] 🔄 
🔄 Step 4: Extracting order data...
[16:57:55] ℹ️  Order extraction - MRN: ''
[16:57:55] ℹ️  Order extraction - Sex: 'MALE'
[16:57:55] ℹ️  Order extraction - Service Line: 'PT'
[16:57:55] ℹ️  Order extraction - Payer Source: 'United Health Care'
[16:57:55] ✅ Order data extraction completed successfully
[16:57:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:57:55] ℹ️  Using MRN from patient data: '926015'
[16:57:55] ℹ️  Service line consistent in both sources: 'PT'
[16:57:55] ℹ️  Payer source consistent in both sources: 'United Health Care'
[16:57:55] ✅ Patient name cross-validation successful
[16:57:55] ✅    ✅ Data merged successfully
[16:57:56] ✅    ✅ Order data extracted and validated
[16:57:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:57:56] [DOC: 9212014] ✅ Patient found in local cache: Clinton Sowle, ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[16:57:56] ✅    ✅ Existing patient found with ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[16:57:56] 🔄 
🔄 Step 6: Pushing order to API...
[16:57:56] [DOC: 9212014] ℹ️  Pushing order via API for patient ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[16:57:57] [DOC: 9212014] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14216"}
[16:57:57] ❌    ❌ Failed to push order
[16:57:57] 🔄 
🔄 Step 7: Writing to CSV...
[16:57:57] [DOC: 9212014] ℹ️  Calculated age: 81 from DOB: 12/01/1943
[16:57:57] [DOC: 9212014] ℹ️  Service Line extracted: 'PT'
[16:57:57] [DOC: 9212014] ℹ️  Payer Source extracted: 'United Health Care'
[16:57:57] [DOC: 9212014] ℹ️  Diagnosis codes being written:
[16:57:57] [DOC: 9212014] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:57:57] [DOC: 9212014] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:57:57] [DOC: 9212014] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:57:57] [DOC: 9212014] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:57:57] [DOC: 9212014] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:57:57] [DOC: 9212014] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:57:57] [DOC: 9212014] ✅ Patient data written to CSV: Clinton Sowle | Sex: MALE | Age: 81 | Service: PT | Payer: United Health Care | MRN: 926015
[16:57:57] ✅    ✅ Document 9212014 processed and saved successfully
[16:57:57] 🔄 
🔄 Step 8: Saving API details...
[16:57:57] [DOC: 9212014] ℹ️  API push details saved for document 9212014
[16:57:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212010                         ║
================================================================================
[16:57:57] ℹ️  Agency: Dartmouth HH
[16:57:57] ℹ️  Date: 03/31/2025
[16:57:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:57:59] [DOC: 9212010] ✅ Text extracted using pdfplumber (2039 chars)
[16:57:59] ✅    ✅ Text extracted using pdfplumber (2039 chars)
[16:57:59] 🔄 
🔄 Step 2: Extracting patient data...
[16:58:02] ℹ️  AI extracted raw sex value: 'F'
[16:58:02] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[16:58:02] ℹ️  AI extracted payer source: 'United Health/ HPHC'
[16:58:02] ℹ️  AI extracted diagnoses:
[16:58:02] ℹ️    - Diagnosis 1: 'None'
[16:58:02] ℹ️    - Diagnosis 2: 'None'
[16:58:02] ℹ️    - Diagnosis 3: 'None'
[16:58:02] ℹ️    - Diagnosis 4: 'None'
[16:58:02] ℹ️    - Diagnosis 5: 'None'
[16:58:02] ℹ️    - Diagnosis 6: 'None'
[16:58:02] ℹ️  Final extracted MRN: '6037015'
[16:58:02] ℹ️  Final extracted Sex: 'FEMALE'
[16:58:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[16:58:02] ℹ️  Final extracted Payer Source: 'United Health/ HPHC'
[16:58:02] ✅ Patient data extraction completed successfully
[16:58:02] ✅    ✅ Patient data extracted successfully
[16:58:02] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Gomes
     └─ dob: 04/01/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6037015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: United Health/ HPHC
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2025', 'startOfEpisode': None, 'endOfEpisode': '04/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:58:02] ✅    ✅ Patient identified: Frances Gomes
[16:58:02] ✅    ✅ Patient name validation passed
[16:58:02] 🔄 
🔄 Step 3: Processing patient dates...
[16:58:02] [DOC: 9212010] ℹ️  DOB normalized: 04/01/1971
[16:58:02] [DOC: 9212010] ℹ️  Episode startOfCare normalized: 02/12/2025
[16:58:02] [DOC: 9212010] ℹ️  Episode endOfEpisode normalized: 04/12/2025
[16:58:02] [DOC: 9212010] ✅ Patient date processing completed successfully
[16:58:02] ✅    ✅ Date processing completed
[16:58:02] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Gomes
     └─ dob: 04/01/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6037015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: United Health/ HPHC
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2025', 'endOfEpisode': '04/12/2025'}]
[16:58:02] 🔄 
🔄 Step 4: Extracting order data...
[16:58:05] ℹ️  Order extraction - MRN: ''
[16:58:05] ℹ️  Order extraction - Sex: 'FEMALE'
[16:58:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[16:58:05] ℹ️  Order extraction - Payer Source: 'United Health/ HPHC'
[16:58:05] ✅ Order data extraction completed successfully
[16:58:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:58:05] ℹ️  Using MRN from patient data: '6037015'
[16:58:05] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[16:58:05] ℹ️  Payer source consistent in both sources: 'United Health/ HPHC'
[16:58:05] ✅ Patient name cross-validation successful
[16:58:05] ✅    ✅ Data merged successfully
[16:58:06] ✅    ✅ Order data extracted and validated
[16:58:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:58:06] [DOC: 9212010] ✅ Patient found in local cache: Frances Gomes, ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:58:06] ✅    ✅ Existing patient found with ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:58:06] 🔄 
🔄 Step 6: Pushing order to API...
[16:58:06] [DOC: 9212010] ℹ️  Pushing order via API for patient ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:58:07] [DOC: 9212010] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:58:07] ❌    ❌ Failed to push order
[16:58:07] 🔄 
🔄 Step 7: Writing to CSV...
[16:58:07] [DOC: 9212010] ℹ️  Calculated age: 54 from DOB: 04/01/1971
[16:58:07] [DOC: 9212010] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[16:58:07] [DOC: 9212010] ℹ️  Payer Source extracted: 'United Health/ HPHC'
[16:58:07] [DOC: 9212010] ℹ️  Diagnosis codes being written:
[16:58:07] [DOC: 9212010] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:58:07] [DOC: 9212010] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:58:07] [DOC: 9212010] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:58:07] [DOC: 9212010] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:58:07] [DOC: 9212010] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:58:07] [DOC: 9212010] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:58:07] [DOC: 9212010] ✅ Patient data written to CSV: Frances Gomes | Sex: FEMALE | Age: 54 | Service: PT, Physical Therapy, Skilled Nursing | Payer: United Health/ HPHC | MRN: 6037015
[16:58:07] ✅    ✅ Document 9212010 processed and saved successfully
[16:58:07] 🔄 
🔄 Step 8: Saving API details...
[16:58:07] [DOC: 9212010] ℹ️  API push details saved for document 9212010
[16:58:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212006                         ║
================================================================================
[16:58:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:58:07] ℹ️  Date: 03/31/2025
[16:58:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:58:09] [DOC: 9212006] ✅ Text extracted using pdfplumber (1182 chars)
[16:58:09] ✅    ✅ Text extracted using pdfplumber (1170 chars)
[16:58:09] 🔄 
🔄 Step 2: Extracting patient data...
[16:58:12] ℹ️  AI extracted raw sex value: ''
[16:58:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:58:12] ℹ️  AI extracted payer source: ''
[16:58:12] ℹ️  AI extracted diagnoses:
[16:58:12] ℹ️    - Diagnosis 1: 'I13.2'
[16:58:12] ℹ️    - Diagnosis 2: 'I50.9'
[16:58:12] ℹ️    - Diagnosis 3: 'E11.22'
[16:58:12] ℹ️    - Diagnosis 4: ''
[16:58:12] ℹ️    - Diagnosis 5: ''
[16:58:12] ℹ️    - Diagnosis 6: ''
[16:58:12] ℹ️  Final extracted MRN: 'MA210804056005'
[16:58:12] ℹ️  Final extracted Sex: ''
[16:58:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:58:12] ℹ️  Final extracted Payer Source: ''
[16:58:12] ✅ Patient data extraction completed successfully
[16:58:12] ✅    ✅ Patient data extracted successfully
[16:58:12] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Miranda
     └─ dob: 05/28/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA210804056005
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:12] ✅    ✅ Patient identified: Maria Miranda
[16:58:12] ✅    ✅ Patient name validation passed
[16:58:12] 🔄 
🔄 Step 3: Processing patient dates...
[16:58:12] [DOC: 9212006] ℹ️  DOB normalized: 05/28/1960
[16:58:12] [DOC: 9212006] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[16:58:12] [DOC: 9212006] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[16:58:12] [DOC: 9212006] ✅ Patient date processing completed successfully
[16:58:12] ✅    ✅ Date processing completed
[16:58:12] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Miranda
     └─ dob: 05/28/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA210804056005
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:12] 🔄 
🔄 Step 4: Extracting order data...
[16:58:14] ℹ️  Order extraction - MRN: 'MA210804056005'
[16:58:14] ℹ️  Order extraction - Sex: ''
[16:58:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:58:14] ℹ️  Order extraction - Payer Source: ''
[16:58:14] ✅ Order data extraction completed successfully
[16:58:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:58:14] ℹ️  Using MRN from patient data: 'MA210804056005' over 'MA210804056005'
[16:58:14] ℹ️  Inferred sex as FEMALE from name: Maria
[16:58:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:58:14] ✅ Patient name cross-validation successful
[16:58:14] ✅    ✅ Data merged successfully
[16:58:16] ✅    ✅ Order data extracted and validated
[16:58:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:58:16] [DOC: 9212006] ✅ Patient found in local cache: Maria Miranda, ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:58:16] ✅    ✅ Existing patient found with ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:58:16] 🔄 
🔄 Step 6: Pushing order to API...
[16:58:16] [DOC: 9212006] ℹ️  Pushing order via API for patient ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:58:17] [DOC: 9212006] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14124"}
[16:58:17] ❌    ❌ Failed to push order
[16:58:17] 🔄 
🔄 Step 7: Writing to CSV...
[16:58:17] [DOC: 9212006] ℹ️  Calculated age: 65 from DOB: 05/28/1960
[16:58:17] [DOC: 9212006] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:58:17] [DOC: 9212006] ℹ️  Payer Source extracted: ''
[16:58:17] [DOC: 9212006] ℹ️  Diagnosis codes being written:
[16:58:17] [DOC: 9212006] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[16:58:17] [DOC: 9212006] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[16:58:17] [DOC: 9212006] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[16:58:17] [DOC: 9212006] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:58:17] [DOC: 9212006] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:58:17] [DOC: 9212006] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:58:17] [DOC: 9212006] ✅ Patient data written to CSV: Maria Miranda | Sex: FEMALE | Age: 65 | Service: Skilled Nursing | Payer:  | MRN: MA210804056005
[16:58:17] ✅    ✅ Document 9212006 processed and saved successfully
[16:58:17] 🔄 
🔄 Step 8: Saving API details...
[16:58:17] [DOC: 9212006] ℹ️  API push details saved for document 9212006
[16:58:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212003                         ║
================================================================================
[16:58:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:58:17] ℹ️  Date: 03/31/2025
[16:58:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:58:19] [DOC: 9212003] ✅ Text extracted using pdfplumber (1210 chars)
[16:58:19] ✅    ✅ Text extracted using pdfplumber (1198 chars)
[16:58:19] 🔄 
🔄 Step 2: Extracting patient data...
[16:58:22] ℹ️  AI extracted raw sex value: ''
[16:58:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:58:22] ℹ️  AI extracted payer source: ''
[16:58:22] ℹ️  AI extracted diagnoses:
[16:58:22] ℹ️    - Diagnosis 1: 'I13.2'
[16:58:22] ℹ️    - Diagnosis 2: 'I50.9'
[16:58:22] ℹ️    - Diagnosis 3: 'E11.22'
[16:58:22] ℹ️    - Diagnosis 4: ''
[16:58:22] ℹ️    - Diagnosis 5: ''
[16:58:22] ℹ️    - Diagnosis 6: ''
[16:58:22] ℹ️  Final extracted MRN: 'MA210804056005'
[16:58:22] ℹ️  Final extracted Sex: ''
[16:58:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:58:22] ℹ️  Final extracted Payer Source: ''
[16:58:22] ✅ Patient data extraction completed successfully
[16:58:22] ✅    ✅ Patient data extracted successfully
[16:58:22] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Miranda
     └─ dob: 05/28/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA210804056005
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:22] ✅    ✅ Patient identified: Maria Miranda
[16:58:22] ✅    ✅ Patient name validation passed
[16:58:22] 🔄 
🔄 Step 3: Processing patient dates...
[16:58:22] [DOC: 9212003] ℹ️  DOB normalized: 05/28/1960
[16:58:22] [DOC: 9212003] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[16:58:22] [DOC: 9212003] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[16:58:22] [DOC: 9212003] ✅ Patient date processing completed successfully
[16:58:22] ✅    ✅ Date processing completed
[16:58:22] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Miranda
     └─ dob: 05/28/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA210804056005
     └─ billingProvider: PAMELA COURY
     └─ npi: 1598703944
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:22] 🔄 
🔄 Step 4: Extracting order data...
[16:58:24] ℹ️  Order extraction - MRN: 'MA210804056005'
[16:58:24] ℹ️  Order extraction - Sex: ''
[16:58:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:58:24] ℹ️  Order extraction - Payer Source: ''
[16:58:24] ✅ Order data extraction completed successfully
[16:58:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:58:24] ℹ️  Using MRN from patient data: 'MA210804056005' over 'MA210804056005'
[16:58:24] ℹ️  Inferred sex as FEMALE from name: Maria
[16:58:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:58:24] ✅ Patient name cross-validation successful
[16:58:24] ✅    ✅ Data merged successfully
[16:58:25] ✅    ✅ Order data extracted and validated
[16:58:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:58:25] [DOC: 9212003] ✅ Patient found in local cache: Maria Miranda, ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:58:25] ✅    ✅ Existing patient found with ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:58:25] 🔄 
🔄 Step 6: Pushing order to API...
[16:58:25] [DOC: 9212003] ℹ️  Pushing order via API for patient ID: d2ac1274-1e4d-4c23-9dd7-eefc7d6ad31f
[16:58:27] [DOC: 9212003] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14126"}
[16:58:27] ❌    ❌ Failed to push order
[16:58:27] 🔄 
🔄 Step 7: Writing to CSV...
[16:58:27] [DOC: 9212003] ℹ️  Calculated age: 65 from DOB: 05/28/1960
[16:58:27] [DOC: 9212003] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:58:27] [DOC: 9212003] ℹ️  Payer Source extracted: ''
[16:58:27] [DOC: 9212003] ℹ️  Diagnosis codes being written:
[16:58:27] [DOC: 9212003] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[16:58:27] [DOC: 9212003] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[16:58:27] [DOC: 9212003] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[16:58:27] [DOC: 9212003] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:58:27] [DOC: 9212003] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:58:27] [DOC: 9212003] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:58:27] [DOC: 9212003] ✅ Patient data written to CSV: Maria Miranda | Sex: FEMALE | Age: 65 | Service: Skilled Nursing | Payer:  | MRN: MA210804056005
[16:58:27] ✅    ✅ Document 9212003 processed and saved successfully
[16:58:27] 🔄 
🔄 Step 8: Saving API details...
[16:58:27] [DOC: 9212003] ℹ️  API push details saved for document 9212003
[16:58:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9212000                         ║
================================================================================
[16:58:27] ℹ️  Agency: Dartmouth HH
[16:58:27] ℹ️  Date: 03/31/2025
[16:58:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:58:29] [DOC: 9212000] ✅ Text extracted using pdfplumber (1110 chars)
[16:58:29] ✅    ✅ Text extracted using pdfplumber (1110 chars)
[16:58:29] 🔄 
🔄 Step 2: Extracting patient data...
[16:58:32] ℹ️  AI extracted raw sex value: 'M'
[16:58:32] ℹ️  AI extracted service line: 'HHA'
[16:58:32] ℹ️  AI extracted payer source: 'Medicare'
[16:58:32] ℹ️  AI extracted diagnoses:
[16:58:32] ℹ️    - Diagnosis 1: ''
[16:58:32] ℹ️    - Diagnosis 2: ''
[16:58:32] ℹ️    - Diagnosis 3: ''
[16:58:32] ℹ️    - Diagnosis 4: ''
[16:58:32] ℹ️    - Diagnosis 5: ''
[16:58:32] ℹ️    - Diagnosis 6: ''
[16:58:32] ℹ️  Final extracted MRN: '6047015'
[16:58:32] ℹ️  Final extracted Sex: 'MALE'
[16:58:32] ℹ️  Final extracted Service Line: 'HHA'
[16:58:32] ℹ️  Final extracted Payer Source: 'Medicare'
[16:58:32] ✅ Patient data extraction completed successfully
[16:58:32] ✅    ✅ Patient data extracted successfully
[16:58:32] 📊 Patient Response
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:32] ✅    ✅ Patient identified: Keith Boling
[16:58:32] ✅    ✅ Patient name validation passed
[16:58:32] 🔄 
🔄 Step 3: Processing patient dates...
[16:58:32] [DOC: 9212000] ℹ️  DOB normalized: 04/09/1950
[16:58:32] [DOC: 9212000] ℹ️  Episode startOfCare normalized: 03/14/2025
[16:58:32] [DOC: 9212000] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[16:58:32] [DOC: 9212000] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[16:58:32] [DOC: 9212000] ✅ Patient date processing completed successfully
[16:58:32] ✅    ✅ Date processing completed
[16:58:32] 📊 Processed Patient Data
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:32] 🔄 
🔄 Step 4: Extracting order data...
[16:58:34] ℹ️  Order extraction - MRN: ''
[16:58:34] ℹ️  Order extraction - Sex: 'MALE'
[16:58:34] ℹ️  Order extraction - Service Line: 'HHA'
[16:58:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:58:34] ✅ Order data extraction completed successfully
[16:58:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:58:34] ℹ️  Using MRN from patient data: '6047015'
[16:58:34] ℹ️  Service line consistent in both sources: 'HHA'
[16:58:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:58:34] ✅ Patient name cross-validation successful
[16:58:34] ✅    ✅ Data merged successfully
[16:58:35] ✅    ✅ Order data extracted and validated
[16:58:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:58:35] [DOC: 9212000] ✅ Patient found in local cache: Keith Boling, ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[16:58:35] ✅    ✅ Existing patient found with ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[16:58:35] 🔄 
🔄 Step 6: Pushing order to API...
[16:58:35] [DOC: 9212000] ℹ️  Pushing order via API for patient ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[16:58:37] [DOC: 9212000] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13191"}
[16:58:37] ❌    ❌ Failed to push order
[16:58:37] 🔄 
🔄 Step 7: Writing to CSV...
[16:58:37] [DOC: 9212000] ℹ️  Calculated age: 75 from DOB: 04/09/1950
[16:58:37] [DOC: 9212000] ℹ️  Service Line extracted: 'HHA'
[16:58:37] [DOC: 9212000] ℹ️  Payer Source extracted: 'Medicare'
[16:58:37] [DOC: 9212000] ℹ️  Diagnosis codes being written:
[16:58:37] [DOC: 9212000] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:58:37] [DOC: 9212000] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:58:37] [DOC: 9212000] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:58:37] [DOC: 9212000] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:58:37] [DOC: 9212000] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:58:37] [DOC: 9212000] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:58:37] [DOC: 9212000] ✅ Patient data written to CSV: Keith Boling | Sex: MALE | Age: 75 | Service: HHA | Payer: Medicare | MRN: 6047015
[16:58:37] ✅    ✅ Document 9212000 processed and saved successfully
[16:58:37] 🔄 
🔄 Step 8: Saving API details...
[16:58:37] [DOC: 9212000] ℹ️  API push details saved for document 9212000
[16:58:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211999                         ║
================================================================================
[16:58:37] ℹ️  Agency: Dartmouth HH
[16:58:37] ℹ️  Date: 03/31/2025
[16:58:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:58:38] [DOC: 9211999] ✅ Text extracted using pdfplumber (1162 chars)
[16:58:38] ✅    ✅ Text extracted using pdfplumber (1162 chars)
[16:58:38] 🔄 
🔄 Step 2: Extracting patient data...
[16:58:41] ℹ️  AI extracted raw sex value: 'F'
[16:58:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:58:41] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:58:41] ℹ️  AI extracted diagnoses:
[16:58:41] ℹ️    - Diagnosis 1: ''
[16:58:41] ℹ️    - Diagnosis 2: ''
[16:58:41] ℹ️    - Diagnosis 3: ''
[16:58:41] ℹ️    - Diagnosis 4: ''
[16:58:41] ℹ️    - Diagnosis 5: ''
[16:58:41] ℹ️    - Diagnosis 6: ''
[16:58:41] ℹ️  Final extracted MRN: '5843015'
[16:58:41] ℹ️  Final extracted Sex: 'FEMALE'
[16:58:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:58:41] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:58:41] ✅ Patient data extraction completed successfully
[16:58:41] ✅    ✅ Patient data extracted successfully
[16:58:41] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:41] ✅    ✅ Patient identified: Joanne Medeiros
[16:58:41] ✅    ✅ Patient name validation passed
[16:58:41] 🔄 
🔄 Step 3: Processing patient dates...
[16:58:41] [DOC: 9211999] ℹ️  DOB normalized: 12/09/1952
[16:58:41] [DOC: 9211999] ℹ️  Episode startOfCare normalized: 01/15/2025
[16:58:41] [DOC: 9211999] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[16:58:41] [DOC: 9211999] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[16:58:41] [DOC: 9211999] ✅ Patient date processing completed successfully
[16:58:41] ✅    ✅ Date processing completed
[16:58:41] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:41] 🔄 
🔄 Step 4: Extracting order data...
[16:58:43] ℹ️  Order extraction - MRN: ''
[16:58:43] ℹ️  Order extraction - Sex: 'FEMALE'
[16:58:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:58:43] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:58:43] ✅ Order data extraction completed successfully
[16:58:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:58:43] ℹ️  Using MRN from patient data: '5843015'
[16:58:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:58:43] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:58:43] ✅ Patient name cross-validation successful
[16:58:43] ✅    ✅ Data merged successfully
[16:58:45] ✅    ✅ Order data extracted and validated
[16:58:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:58:53] [DOC: 9211999] ℹ️  Patient not found in cache or API: Joanne Medeiros
[16:58:53] [DOC: 9211999] ℹ️  Patient not found, creating new patient via API...
[16:58:53] [DOC: 9211999] ℹ️  Creating patient via API: Joanne Medeiros
[16:58:54] [DOC: 9211999] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:58:54] ❌    ❌ Failed to create patient
[16:58:54] [DOC: 9211999] ℹ️  API push details saved for document 9211999
================================================================================
║                        Processing Document ID: 9211996                         ║
================================================================================
[16:58:54] ℹ️  Agency: Dartmouth HH
[16:58:54] ℹ️  Date: 03/31/2025
[16:58:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:58:56] [DOC: 9211996] ✅ Text extracted using pdfplumber (1104 chars)
[16:58:56] ✅    ✅ Text extracted using pdfplumber (1104 chars)
[16:58:56] 🔄 
🔄 Step 2: Extracting patient data...
[16:58:59] ℹ️  AI extracted raw sex value: 'M'
[16:58:59] ℹ️  AI extracted service line: 'HHA'
[16:58:59] ℹ️  AI extracted payer source: 'Medicare'
[16:58:59] ℹ️  AI extracted diagnoses:
[16:58:59] ℹ️    - Diagnosis 1: ''
[16:58:59] ℹ️    - Diagnosis 2: ''
[16:58:59] ℹ️    - Diagnosis 3: ''
[16:58:59] ℹ️    - Diagnosis 4: ''
[16:58:59] ℹ️    - Diagnosis 5: ''
[16:58:59] ℹ️    - Diagnosis 6: ''
[16:58:59] ℹ️  Final extracted MRN: '1396009'
[16:58:59] ℹ️  Final extracted Sex: 'MALE'
[16:58:59] ℹ️  Final extracted Service Line: 'HHA'
[16:58:59] ℹ️  Final extracted Payer Source: 'Medicare'
[16:58:59] ✅ Patient data extraction completed successfully
[16:58:59] ✅    ✅ Patient data extracted successfully
[16:58:59] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Gloriane D Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:59] ✅    ✅ Patient identified: Elias Ramos
[16:58:59] ✅    ✅ Patient name validation passed
[16:58:59] 🔄 
🔄 Step 3: Processing patient dates...
[16:58:59] [DOC: 9211996] ℹ️  DOB normalized: 08/28/1938
[16:58:59] [DOC: 9211996] ℹ️  Episode startOfCare normalized: 12/31/2024
[16:58:59] [DOC: 9211996] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:58:59] [DOC: 9211996] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:58:59] [DOC: 9211996] ✅ Patient date processing completed successfully
[16:58:59] ✅    ✅ Date processing completed
[16:58:59] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Gloriane D Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:58:59] 🔄 
🔄 Step 4: Extracting order data...
[16:59:01] ℹ️  Order extraction - MRN: ''
[16:59:01] ℹ️  Order extraction - Sex: 'MALE'
[16:59:01] ℹ️  Order extraction - Service Line: 'HHA'
[16:59:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:59:01] ✅ Order data extraction completed successfully
[16:59:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:59:01] ℹ️  Using MRN from patient data: '1396009'
[16:59:01] ℹ️  Service line consistent in both sources: 'HHA'
[16:59:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:59:01] ✅ Patient name cross-validation successful
[16:59:01] ✅    ✅ Data merged successfully
[16:59:02] ✅    ✅ Order data extracted and validated
[16:59:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:59:02] [DOC: 9211996] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[16:59:02] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[16:59:02] 🔄 
🔄 Step 6: Pushing order to API...
[16:59:02] [DOC: 9211996] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[16:59:04] [DOC: 9211996] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13134"}
[16:59:04] ❌    ❌ Failed to push order
[16:59:04] 🔄 
🔄 Step 7: Writing to CSV...
[16:59:04] [DOC: 9211996] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[16:59:04] [DOC: 9211996] ℹ️  Service Line extracted: 'HHA'
[16:59:04] [DOC: 9211996] ℹ️  Payer Source extracted: 'Medicare'
[16:59:04] [DOC: 9211996] ℹ️  Diagnosis codes being written:
[16:59:04] [DOC: 9211996] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:59:04] [DOC: 9211996] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:59:04] [DOC: 9211996] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:59:04] [DOC: 9211996] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:59:04] [DOC: 9211996] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:59:04] [DOC: 9211996] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:59:04] [DOC: 9211996] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: HHA | Payer: Medicare | MRN: 1396009
[16:59:04] ✅    ✅ Document 9211996 processed and saved successfully
[16:59:04] 🔄 
🔄 Step 8: Saving API details...
[16:59:04] [DOC: 9211996] ℹ️  API push details saved for document 9211996
[16:59:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211957                         ║
================================================================================
[16:59:04] ℹ️  Agency: AccentCare Fall River
[16:59:04] ℹ️  Date: 03/31/2025
[16:59:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:59:06] [DOC: 9211957] ✅ Text extracted using pdfplumber (1330 chars)
[16:59:06] ✅    ✅ Text extracted using pdfplumber (1330 chars)
[16:59:06] 🔄 
🔄 Step 2: Extracting patient data...
[16:59:09] ℹ️  AI extracted raw sex value: ''
[16:59:09] ℹ️  AI extracted service line: 'PT'
[16:59:09] ℹ️  AI extracted payer source: ''
[16:59:09] ℹ️  AI extracted diagnoses:
[16:59:09] ℹ️    - Diagnosis 1: 'None'
[16:59:09] ℹ️    - Diagnosis 2: 'None'
[16:59:09] ℹ️    - Diagnosis 3: 'None'
[16:59:09] ℹ️    - Diagnosis 4: 'None'
[16:59:09] ℹ️    - Diagnosis 5: 'None'
[16:59:09] ℹ️    - Diagnosis 6: 'None'
[16:59:09] ℹ️  Final extracted MRN: 'C0200049410901'
[16:59:09] ℹ️  Final extracted Sex: ''
[16:59:09] ℹ️  Final extracted Service Line: 'PT'
[16:59:09] ℹ️  Final extracted Payer Source: ''
[16:59:09] ✅ Patient data extraction completed successfully
[16:59:09] ✅    ✅ Patient data extracted successfully
[16:59:09] 📊 Patient Response
     └─ patientFName: JEFFREY
     └─ patientLName: STRANGER
     └─ dob: 04/20/1955
     └─ patientSex: 
     └─ medicalRecordNo: C0200049410901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 305 CEDAR ST, APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/25/2024', 'endOfEpisode': '07/29/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:59:09] ✅    ✅ Patient identified: JEFFREY STRANGER
[16:59:09] ✅    ✅ Patient name validation passed
[16:59:09] 🔄 
🔄 Step 3: Processing patient dates...
[16:59:09] [DOC: 9211957] ℹ️  DOB normalized: 04/20/1955
[16:59:09] [DOC: 9211957] ℹ️  Episode startOfEpisode normalized: 07/25/2024
[16:59:09] [DOC: 9211957] ℹ️  Episode endOfEpisode normalized: 07/29/2024
[16:59:09] [DOC: 9211957] ✅ Patient date processing completed successfully
[16:59:09] ✅    ✅ Date processing completed
[16:59:09] 📊 Processed Patient Data
     └─ patientFName: JEFFREY
     └─ patientLName: STRANGER
     └─ dob: 04/20/1955
     └─ patientSex: 
     └─ medicalRecordNo: C0200049410901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 305 CEDAR ST, APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/25/2024', 'endOfEpisode': '07/29/2024'}, {'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '03/06/2025'}]
[16:59:09] 🔄 
🔄 Step 4: Extracting order data...
[16:59:11] ℹ️  Order extraction - MRN: 'C0200049410901'
[16:59:11] ℹ️  Order extraction - Sex: ''
[16:59:11] ℹ️  Order extraction - Service Line: 'PT'
[16:59:11] ℹ️  Order extraction - Payer Source: ''
[16:59:11] ✅ Order data extraction completed successfully
[16:59:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:59:11] ℹ️  Using MRN from patient data: 'C0200049410901' over 'C0200049410901'
[16:59:11] ℹ️  Inferred sex as MALE from name: JEFFREY
[16:59:11] ℹ️  Service line consistent in both sources: 'PT'
[16:59:11] ✅ Patient name cross-validation successful
[16:59:11] ✅    ✅ Data merged successfully
[16:59:13] ⚠️     ❌ Skipping - missing episode start date
[16:59:13] [DOC: 9211957] ℹ️  API push details saved for document 9211957
================================================================================
║                        Processing Document ID: 9211785                         ║
================================================================================
[16:59:13] ℹ️  Agency: Caretenders-Bourne
[16:59:13] ℹ️  Date: 03/31/2025
[16:59:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:59:16] [DOC: 9211785] ✅ Text extracted using pdfplumber (1870 chars)
[16:59:16] ✅    ✅ Text extracted using pdfplumber (1870 chars)
[16:59:16] 🔄 
🔄 Step 2: Extracting patient data...
[16:59:18] ℹ️  AI extracted raw sex value: ''
[16:59:18] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:18] ℹ️  AI extracted payer source: ''
[16:59:18] ℹ️  AI extracted diagnoses:
[16:59:18] ℹ️    - Diagnosis 1: ''
[16:59:18] ℹ️    - Diagnosis 2: ''
[16:59:18] ℹ️    - Diagnosis 3: ''
[16:59:18] ℹ️    - Diagnosis 4: ''
[16:59:18] ℹ️    - Diagnosis 5: ''
[16:59:18] ℹ️    - Diagnosis 6: ''
[16:59:18] ℹ️  Final extracted MRN: 'CAP00397705401'
[16:59:18] ℹ️  Final extracted Sex: ''
[16:59:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:18] ℹ️  Final extracted Payer Source: ''
[16:59:18] ✅ Patient data extraction completed successfully
[16:59:18] ✅    ✅ Patient data extracted successfully
[16:59:18] 📊 Patient Response
     └─ patientFName: ROBERT
     └─ patientLName: NEWELL
     └─ dob: 03/16/1937
     └─ patientSex: 
     └─ medicalRecordNo: CAP00397705401
     └─ billingProvider: Dr. JORDAN GULAREK
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CARETENDERS - BOURNE
     └─ address: 300 ROSEBROOK WAY
     └─ city: WAREHAM
     └─ state: MA
     └─ zip: 02571
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/13/2024', 'startOfEpisode': '12/23/2024', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:18] ✅    ✅ Patient identified: ROBERT NEWELL
[16:59:18] ✅    ✅ Patient name validation passed
[16:59:18] 🔄 
🔄 Step 3: Processing patient dates...
[16:59:18] [DOC: 9211785] ℹ️  DOB normalized: 03/16/1937
[16:59:18] [DOC: 9211785] ℹ️  Episode startOfCare normalized: 12/13/2024
[16:59:18] [DOC: 9211785] ℹ️  Episode startOfEpisode normalized: 12/23/2024
[16:59:18] [DOC: 9211785] ✅ Patient date processing completed successfully
[16:59:18] ✅    ✅ Date processing completed
[16:59:18] 📊 Processed Patient Data
     └─ patientFName: ROBERT
     └─ patientLName: NEWELL
     └─ dob: 03/16/1937
     └─ patientSex: 
     └─ medicalRecordNo: CAP00397705401
     └─ billingProvider: Dr. JORDAN GULAREK
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CARETENDERS - BOURNE
     └─ address: 300 ROSEBROOK WAY
     └─ city: WAREHAM
     └─ state: MA
     └─ zip: 02571
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/13/2024', 'startOfEpisode': '12/23/2024', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:18] 🔄 
🔄 Step 4: Extracting order data...
[16:59:21] ℹ️  Order extraction - MRN: 'CAP00397705401'
[16:59:21] ℹ️  Order extraction - Sex: ''
[16:59:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:21] ℹ️  Order extraction - Payer Source: ''
[16:59:21] ✅ Order data extraction completed successfully
[16:59:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:59:21] ℹ️  Using MRN from patient data: 'CAP00397705401' over 'CAP00397705401'
[16:59:21] ℹ️  Inferred sex as MALE from name: ROBERT
[16:59:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:21] ✅ Patient name cross-validation successful
[16:59:21] ✅    ✅ Data merged successfully
[16:59:22] ✅    ✅ Order data extracted and validated
[16:59:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:59:28] [DOC: 9211785] ✅ Patient exists in API: ROBERT NEWELL, ID: b6eb50ae-586f-42a0-b403-59bc966b9a8e
[16:59:28] ✅    ✅ Existing patient found with ID: b6eb50ae-586f-42a0-b403-59bc966b9a8e
[16:59:28] 🔄 
🔄 Step 6: Pushing order to API...
[16:59:28] [DOC: 9211785] ℹ️  Pushing order via API for patient ID: b6eb50ae-586f-42a0-b403-59bc966b9a8e
[16:59:29] [DOC: 9211785] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14180"}
[16:59:29] ❌    ❌ Failed to push order
[16:59:29] 🔄 
🔄 Step 7: Writing to CSV...
[16:59:29] [DOC: 9211785] ℹ️  Calculated age: 88 from DOB: 03/16/1937
[16:59:29] [DOC: 9211785] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:29] [DOC: 9211785] ℹ️  Payer Source extracted: ''
[16:59:29] [DOC: 9211785] ℹ️  Diagnosis codes being written:
[16:59:29] [DOC: 9211785] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:59:29] [DOC: 9211785] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:59:29] [DOC: 9211785] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:59:29] [DOC: 9211785] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:59:29] [DOC: 9211785] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:59:29] [DOC: 9211785] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:59:29] [DOC: 9211785] ✅ Patient data written to CSV: ROBERT NEWELL | Sex: MALE | Age: 88 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: CAP00397705401
[16:59:29] ✅    ✅ Document 9211785 processed and saved successfully
[16:59:29] 🔄 
🔄 Step 8: Saving API details...
[16:59:29] [DOC: 9211785] ℹ️  API push details saved for document 9211785
[16:59:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211680                         ║
================================================================================
[16:59:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:59:29] ℹ️  Date: 03/31/2025
[16:59:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:59:31] [DOC: 9211680] ✅ Text extracted using pdfplumber (2602 chars)
[16:59:31] ✅    ✅ Text extracted using pdfplumber (2602 chars)
[16:59:31] 🔄 
🔄 Step 2: Extracting patient data...
[16:59:33] ℹ️  AI extracted raw sex value: 'F'
[16:59:33] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy'
[16:59:33] ℹ️  AI extracted payer source: ''
[16:59:33] ℹ️  AI extracted diagnoses:
[16:59:33] ℹ️    - Diagnosis 1: 'CHF'
[16:59:33] ℹ️    - Diagnosis 2: 'PAF'
[16:59:33] ℹ️    - Diagnosis 3: 'LLE cellulitis'
[16:59:33] ℹ️    - Diagnosis 4: ''
[16:59:33] ℹ️    - Diagnosis 5: ''
[16:59:33] ℹ️    - Diagnosis 6: ''
[16:59:33] ℹ️  Final extracted MRN: '2936720'
[16:59:33] ℹ️  Final extracted Sex: 'FEMALE'
[16:59:33] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy'
[16:59:33] ℹ️  Final extracted Payer Source: ''
[16:59:33] ✅ Patient data extraction completed successfully
[16:59:33] ✅    ✅ Patient data extracted successfully
[16:59:33] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'PAF', 'thirdDiagnosis': 'LLE cellulitis', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:33] ✅    ✅ Patient identified: Stella Saint
[16:59:33] ✅    ✅ Patient name validation passed
[16:59:33] 🔄 
🔄 Step 3: Processing patient dates...
[16:59:33] [DOC: 9211680] ℹ️  DOB normalized: 07/02/1928
[16:59:33] [DOC: 9211680] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[16:59:33] [DOC: 9211680] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[16:59:33] [DOC: 9211680] ✅ Patient date processing completed successfully
[16:59:33] ✅    ✅ Date processing completed
[16:59:33] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'PAF', 'thirdDiagnosis': 'LLE cellulitis', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:33] 🔄 
🔄 Step 4: Extracting order data...
[16:59:36] ℹ️  Order extraction - MRN: '2936720'
[16:59:36] ℹ️  Order extraction - Sex: 'FEMALE'
[16:59:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy'
[16:59:36] ℹ️  Order extraction - Payer Source: ''
[16:59:36] ✅ Order data extraction completed successfully
[16:59:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:59:36] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[16:59:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy'
[16:59:36] ✅ Patient name cross-validation successful
[16:59:36] ✅    ✅ Data merged successfully
[16:59:37] ✅    ✅ Order data extracted and validated
[16:59:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:59:37] [DOC: 9211680] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[16:59:37] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[16:59:37] 🔄 
🔄 Step 6: Pushing order to API...
[16:59:37] [DOC: 9211680] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[16:59:39] [DOC: 9211680] ❌ Order push failed with status 201: {"id":"caa835f3-de3c-4a24-8a81-ac2ce1b534d2","orderWAVId":"ORD20071","orderNo":"1076629, 1076647, 1076648, 1076649","orderDate":"03/30/2025","startOfCare":"03/30/2025","episodeStartDate":"03/30/2025","episodeEndDate":"04/23/2025","documentID":"9211680","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"03/31/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:59:39] ❌    ❌ Failed to push order
[16:59:39] 🔄 
🔄 Step 7: Writing to CSV...
[16:59:39] [DOC: 9211680] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[16:59:39] [DOC: 9211680] ℹ️  Service Line extracted: 'Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy'
[16:59:39] [DOC: 9211680] ℹ️  Payer Source extracted: ''
[16:59:39] [DOC: 9211680] ℹ️  Diagnosis codes being written:
[16:59:39] [DOC: 9211680] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[16:59:39] [DOC: 9211680] ℹ️    - Latest_Episode_Seconddiagnosis: 'PAF'
[16:59:39] [DOC: 9211680] ℹ️    - Latest_Episode_Thirddiagnosis: 'LLE cellulitis'
[16:59:39] [DOC: 9211680] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:59:39] [DOC: 9211680] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:59:39] [DOC: 9211680] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:59:39] [DOC: 9211680] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Skilled Nursing, Home Health Aide, Occupational Therapy, Physical Therapy | Payer:  | MRN: 2936720
[16:59:39] ✅    ✅ Document 9211680 processed and saved successfully
[16:59:39] 🔄 
🔄 Step 8: Saving API details...
[16:59:39] [DOC: 9211680] ℹ️  API push details saved for document 9211680
[16:59:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211619                         ║
================================================================================
[16:59:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:59:39] ℹ️  Date: 03/31/2025
[16:59:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:59:40] [DOC: 9211619] ✅ Text extracted using pdfplumber (1608 chars)
[16:59:40] ✅    ✅ Text extracted using pdfplumber (1608 chars)
[16:59:40] 🔄 
🔄 Step 2: Extracting patient data...
[16:59:43] ℹ️  AI extracted raw sex value: 'M'
[16:59:43] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:43] ℹ️  AI extracted payer source: ''
[16:59:43] ℹ️  AI extracted diagnoses:
[16:59:43] ℹ️    - Diagnosis 1: ''
[16:59:43] ℹ️    - Diagnosis 2: ''
[16:59:43] ℹ️    - Diagnosis 3: ''
[16:59:43] ℹ️    - Diagnosis 4: ''
[16:59:43] ℹ️    - Diagnosis 5: ''
[16:59:43] ℹ️    - Diagnosis 6: ''
[16:59:43] ℹ️  Final extracted MRN: '2447688'
[16:59:43] ℹ️  Final extracted Sex: 'MALE'
[16:59:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:43] ℹ️  Final extracted Payer Source: ''
[16:59:43] ✅ Patient data extraction completed successfully
[16:59:43] ✅    ✅ Patient data extracted successfully
[16:59:43] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:43] ✅    ✅ Patient identified: George England
[16:59:43] ✅    ✅ Patient name validation passed
[16:59:43] 🔄 
🔄 Step 3: Processing patient dates...
[16:59:43] [DOC: 9211619] ℹ️  DOB normalized: 08/26/1924
[16:59:43] [DOC: 9211619] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[16:59:43] [DOC: 9211619] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[16:59:43] [DOC: 9211619] ✅ Patient date processing completed successfully
[16:59:43] ✅    ✅ Date processing completed
[16:59:43] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:43] 🔄 
🔄 Step 4: Extracting order data...
[16:59:46] ℹ️  Order extraction - MRN: '2447688'
[16:59:46] ℹ️  Order extraction - Sex: 'MALE'
[16:59:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:46] ℹ️  Order extraction - Payer Source: ''
[16:59:46] ✅ Order data extraction completed successfully
[16:59:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:59:46] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[16:59:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:46] ✅ Patient name cross-validation successful
[16:59:46] ✅    ✅ Data merged successfully
[16:59:47] ✅    ✅ Order data extracted and validated
[16:59:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:59:47] [DOC: 9211619] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[16:59:47] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[16:59:47] 🔄 
🔄 Step 6: Pushing order to API...
[16:59:47] [DOC: 9211619] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[16:59:49] [DOC: 9211619] ❌ Order push failed with status 201: {"id":"a50c29b1-b4c4-422a-9814-31d8d64bb819","orderWAVId":"ORD20072","orderNo":"1076697, 1076700, 1076701","orderDate":"03/30/2025","startOfCare":"03/30/2025","episodeStartDate":"03/30/2025","episodeEndDate":"05/28/2025","documentID":"9211619","mrn":"2447688","patientName":"England,George N.","sentToPhysicianDate":"03/31/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"9e630b2a-6bbf-4ea5-b7c5-596174a81f4a","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:59:49] ❌    ❌ Failed to push order
[16:59:49] 🔄 
🔄 Step 7: Writing to CSV...
[16:59:49] [DOC: 9211619] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[16:59:49] [DOC: 9211619] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:59:49] [DOC: 9211619] ℹ️  Payer Source extracted: ''
[16:59:49] [DOC: 9211619] ℹ️  Diagnosis codes being written:
[16:59:49] [DOC: 9211619] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:59:49] [DOC: 9211619] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:59:49] [DOC: 9211619] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:59:49] [DOC: 9211619] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:59:49] [DOC: 9211619] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:59:49] [DOC: 9211619] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:59:49] [DOC: 9211619] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2447688
[16:59:49] ✅    ✅ Document 9211619 processed and saved successfully
[16:59:49] 🔄 
🔄 Step 8: Saving API details...
[16:59:49] [DOC: 9211619] ℹ️  API push details saved for document 9211619
[16:59:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211591                         ║
================================================================================
[16:59:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[16:59:49] ℹ️  Date: 03/31/2025
[16:59:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:59:50] [DOC: 9211591] ✅ Text extracted using pdfplumber (1099 chars)
[16:59:50] ✅    ✅ Text extracted using pdfplumber (1099 chars)
[16:59:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:59:53] ℹ️  AI extracted raw sex value: 'F'
[16:59:53] ℹ️  AI extracted service line: 'Occupational Therapy'
[16:59:53] ℹ️  AI extracted payer source: ''
[16:59:53] ℹ️  AI extracted diagnoses:
[16:59:53] ℹ️    - Diagnosis 1: ''
[16:59:53] ℹ️    - Diagnosis 2: ''
[16:59:53] ℹ️    - Diagnosis 3: ''
[16:59:53] ℹ️    - Diagnosis 4: ''
[16:59:53] ℹ️    - Diagnosis 5: ''
[16:59:53] ℹ️    - Diagnosis 6: ''
[16:59:53] ℹ️  Final extracted MRN: '2179688'
[16:59:53] ℹ️  Final extracted Sex: 'FEMALE'
[16:59:53] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[16:59:53] ℹ️  Final extracted Payer Source: ''
[16:59:53] ✅ Patient data extraction completed successfully
[16:59:53] ✅    ✅ Patient data extracted successfully
[16:59:53] 📊 Patient Response
     └─ patientFName: Ruth
     └─ patientLName: Almeida
     └─ dob: 08/02/1925
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2179688
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:53] ✅    ✅ Patient identified: Ruth Almeida
[16:59:53] ✅    ✅ Patient name validation passed
[16:59:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:59:53] [DOC: 9211591] ℹ️  DOB normalized: 08/02/1925
[16:59:53] [DOC: 9211591] ✅ Patient date processing completed successfully
[16:59:53] ✅    ✅ Date processing completed
[16:59:53] 📊 Processed Patient Data
     └─ patientFName: Ruth
     └─ patientLName: Almeida
     └─ dob: 08/02/1925
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2179688
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:59:53] 🔄 
🔄 Step 4: Extracting order data...
[16:59:55] ℹ️  Order extraction - MRN: '2179688'
[16:59:55] ℹ️  Order extraction - Sex: 'FEMALE'
[16:59:55] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[16:59:55] ℹ️  Order extraction - Payer Source: ''
[16:59:55] ✅ Order data extraction completed successfully
[16:59:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:59:55] ℹ️  Using MRN from patient data: '2179688' over '2179688'
[16:59:55] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[16:59:55] ✅ Patient name cross-validation successful
[16:59:55] ✅    ✅ Data merged successfully
[16:59:56] ✅    ✅ Order data extracted and validated
[16:59:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:00:04] [DOC: 9211591] ℹ️  Patient not found in cache or API: Ruth Almeida
[17:00:04] [DOC: 9211591] ℹ️  Patient not found, creating new patient via API...
[17:00:04] [DOC: 9211591] ℹ️  Creating patient via API: Ruth Almeida
[17:00:06] [DOC: 9211591] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:00:06] ❌    ❌ Failed to create patient
[17:00:06] [DOC: 9211591] ℹ️  API push details saved for document 9211591
================================================================================
║                        Processing Document ID: 9211561                         ║
================================================================================
[17:00:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:00:06] ℹ️  Date: 03/31/2025
[17:00:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:00:08] [DOC: 9211561] ✅ Text extracted using pdfplumber (1578 chars)
[17:00:08] ✅    ✅ Text extracted using pdfplumber (1578 chars)
[17:00:08] 🔄 
🔄 Step 2: Extracting patient data...
[17:00:11] ℹ️  AI extracted raw sex value: 'F'
[17:00:11] ℹ️  AI extracted service line: 'Physical Therapy'
[17:00:11] ℹ️  AI extracted payer source: ''
[17:00:11] ℹ️  AI extracted diagnoses:
[17:00:11] ℹ️    - Diagnosis 1: 'C50.911'
[17:00:11] ℹ️    - Diagnosis 2: 'E44.0'
[17:00:11] ℹ️    - Diagnosis 3: 'K90.0'
[17:00:11] ℹ️    - Diagnosis 4: ''
[17:00:11] ℹ️    - Diagnosis 5: ''
[17:00:11] ℹ️    - Diagnosis 6: ''
[17:00:11] ℹ️  Final extracted MRN: 'MA210121015502'
[17:00:11] ℹ️  Final extracted Sex: 'FEMALE'
[17:00:11] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:00:11] ℹ️  Final extracted Payer Source: ''
[17:00:11] ✅ Patient data extraction completed successfully
[17:00:11] ✅    ✅ Patient data extracted successfully
[17:00:11] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'C50.911', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'K90.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:11] ✅    ✅ Patient identified: Louise Rivard
[17:00:11] ✅    ✅ Patient name validation passed
[17:00:11] 🔄 
🔄 Step 3: Processing patient dates...
[17:00:11] [DOC: 9211561] ℹ️  DOB normalized: 01/26/1955
[17:00:11] [DOC: 9211561] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[17:00:11] [DOC: 9211561] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[17:00:11] [DOC: 9211561] ✅ Patient date processing completed successfully
[17:00:11] ✅    ✅ Date processing completed
[17:00:11] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'C50.911', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'K90.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:11] 🔄 
🔄 Step 4: Extracting order data...
[17:00:14] ℹ️  Order extraction - MRN: 'MA210121015502'
[17:00:14] ℹ️  Order extraction - Sex: ''
[17:00:14] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:00:14] ℹ️  Order extraction - Payer Source: ''
[17:00:14] ✅ Order data extraction completed successfully
[17:00:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:00:14] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[17:00:14] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:00:14] ✅ Patient name cross-validation successful
[17:00:14] ✅    ✅ Data merged successfully
[17:00:15] ✅    ✅ Order data extracted and validated
[17:00:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:00:15] [DOC: 9211561] ✅ Patient found in local cache: Louise Rivard, ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[17:00:15] ✅    ✅ Existing patient found with ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[17:00:15] 🔄 
🔄 Step 6: Pushing order to API...
[17:00:15] [DOC: 9211561] ℹ️  Pushing order via API for patient ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[17:00:16] [DOC: 9211561] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13559"}
[17:00:16] ❌    ❌ Failed to push order
[17:00:16] 🔄 
🔄 Step 7: Writing to CSV...
[17:00:16] [DOC: 9211561] ℹ️  Calculated age: 70 from DOB: 01/26/1955
[17:00:16] [DOC: 9211561] ℹ️  Service Line extracted: 'Physical Therapy'
[17:00:16] [DOC: 9211561] ℹ️  Payer Source extracted: ''
[17:00:16] [DOC: 9211561] ℹ️  Diagnosis codes being written:
[17:00:16] [DOC: 9211561] ℹ️    - Latest_Episode_Firstdiagnosis: 'C50.911'
[17:00:16] [DOC: 9211561] ℹ️    - Latest_Episode_Seconddiagnosis: 'E44.0'
[17:00:16] [DOC: 9211561] ℹ️    - Latest_Episode_Thirddiagnosis: 'K90.0'
[17:00:16] [DOC: 9211561] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:00:16] [DOC: 9211561] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:00:16] [DOC: 9211561] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:00:16] [DOC: 9211561] ✅ Patient data written to CSV: Louise Rivard | Sex: FEMALE | Age: 70 | Service: Physical Therapy | Payer:  | MRN: MA210121015502
[17:00:16] ✅    ✅ Document 9211561 processed and saved successfully
[17:00:16] 🔄 
🔄 Step 8: Saving API details...
[17:00:16] [DOC: 9211561] ℹ️  API push details saved for document 9211561
[17:00:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211559                         ║
================================================================================
[17:00:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:00:16] ℹ️  Date: 03/31/2025
[17:00:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:00:19] [DOC: 9211559] ✅ Text extracted using pdfplumber (1562 chars)
[17:00:19] ✅    ✅ Text extracted using pdfplumber (1562 chars)
[17:00:19] 🔄 
🔄 Step 2: Extracting patient data...
[17:00:22] ℹ️  AI extracted raw sex value: 'F'
[17:00:22] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:00:22] ℹ️  AI extracted payer source: ''
[17:00:22] ℹ️  AI extracted diagnoses:
[17:00:22] ℹ️    - Diagnosis 1: 'C50.911'
[17:00:22] ℹ️    - Diagnosis 2: 'E44.0'
[17:00:22] ℹ️    - Diagnosis 3: 'K90.0'
[17:00:22] ℹ️    - Diagnosis 4: ''
[17:00:22] ℹ️    - Diagnosis 5: ''
[17:00:22] ℹ️    - Diagnosis 6: ''
[17:00:22] ℹ️  Final extracted MRN: 'MA210121015502'
[17:00:22] ℹ️  Final extracted Sex: 'FEMALE'
[17:00:22] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:00:22] ℹ️  Final extracted Payer Source: ''
[17:00:22] ✅ Patient data extraction completed successfully
[17:00:22] ✅    ✅ Patient data extracted successfully
[17:00:22] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'C50.911', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'K90.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:22] ✅    ✅ Patient identified: Louise Rivard
[17:00:22] ✅    ✅ Patient name validation passed
[17:00:22] 🔄 
🔄 Step 3: Processing patient dates...
[17:00:22] [DOC: 9211559] ℹ️  DOB normalized: 01/26/1955
[17:00:22] [DOC: 9211559] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[17:00:22] [DOC: 9211559] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[17:00:22] [DOC: 9211559] ✅ Patient date processing completed successfully
[17:00:22] ✅    ✅ Date processing completed
[17:00:22] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'C50.911', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'K90.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:22] 🔄 
🔄 Step 4: Extracting order data...
[17:00:24] ℹ️  Order extraction - MRN: 'MA210121015502'
[17:00:24] ℹ️  Order extraction - Sex: ''
[17:00:24] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:00:24] ℹ️  Order extraction - Payer Source: ''
[17:00:24] ✅ Order data extraction completed successfully
[17:00:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:00:24] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[17:00:24] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:00:24] ✅ Patient name cross-validation successful
[17:00:24] ✅    ✅ Data merged successfully
[17:00:25] ✅    ✅ Order data extracted and validated
[17:00:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:00:25] [DOC: 9211559] ✅ Patient found in local cache: Louise Rivard, ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[17:00:25] ✅    ✅ Existing patient found with ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[17:00:25] 🔄 
🔄 Step 6: Pushing order to API...
[17:00:25] [DOC: 9211559] ℹ️  Pushing order via API for patient ID: 5321df91-73d2-4e85-a1a2-7e0a6007e6c6
[17:00:27] [DOC: 9211559] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13561"}
[17:00:27] ❌    ❌ Failed to push order
[17:00:27] 🔄 
🔄 Step 7: Writing to CSV...
[17:00:27] [DOC: 9211559] ℹ️  Calculated age: 70 from DOB: 01/26/1955
[17:00:27] [DOC: 9211559] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:00:27] [DOC: 9211559] ℹ️  Payer Source extracted: ''
[17:00:27] [DOC: 9211559] ℹ️  Diagnosis codes being written:
[17:00:27] [DOC: 9211559] ℹ️    - Latest_Episode_Firstdiagnosis: 'C50.911'
[17:00:27] [DOC: 9211559] ℹ️    - Latest_Episode_Seconddiagnosis: 'E44.0'
[17:00:27] [DOC: 9211559] ℹ️    - Latest_Episode_Thirddiagnosis: 'K90.0'
[17:00:27] [DOC: 9211559] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:00:27] [DOC: 9211559] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:00:27] [DOC: 9211559] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:00:27] [DOC: 9211559] ✅ Patient data written to CSV: Louise Rivard | Sex: FEMALE | Age: 70 | Service: Occupational Therapy | Payer:  | MRN: MA210121015502
[17:00:27] ✅    ✅ Document 9211559 processed and saved successfully
[17:00:27] 🔄 
🔄 Step 8: Saving API details...
[17:00:27] [DOC: 9211559] ℹ️  API push details saved for document 9211559
[17:00:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211555                         ║
================================================================================
[17:00:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:00:27] ℹ️  Date: 03/31/2025
[17:00:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:00:29] [DOC: 9211555] ✅ Text extracted using pdfplumber (1507 chars)
[17:00:29] ✅    ✅ Text extracted using pdfplumber (1507 chars)
[17:00:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:00:32] ℹ️  AI extracted raw sex value: ''
[17:00:32] ℹ️  AI extracted service line: 'Physical Therapy'
[17:00:32] ℹ️  AI extracted payer source: ''
[17:00:32] ℹ️  AI extracted diagnoses:
[17:00:32] ℹ️    - Diagnosis 1: 'M47.816'
[17:00:32] ℹ️    - Diagnosis 2: 'M75.41'
[17:00:32] ℹ️    - Diagnosis 3: 'M17.0'
[17:00:32] ℹ️    - Diagnosis 4: 'None'
[17:00:32] ℹ️    - Diagnosis 5: 'None'
[17:00:32] ℹ️    - Diagnosis 6: 'None'
[17:00:32] ℹ️  Final extracted MRN: 'MA241216044603'
[17:00:32] ℹ️  Final extracted Sex: ''
[17:00:32] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:00:32] ℹ️  Final extracted Payer Source: ''
[17:00:32] ✅ Patient data extraction completed successfully
[17:00:32] ✅    ✅ Patient data extracted successfully
[17:00:32] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'M75.41', 'thirdDiagnosis': 'M17.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:00:32] ✅    ✅ Patient identified: Leonor Gomes
[17:00:32] ✅    ✅ Patient name validation passed
[17:00:32] 🔄 
🔄 Step 3: Processing patient dates...
[17:00:32] [DOC: 9211555] ℹ️  DOB normalized: 04/15/1946
[17:00:32] [DOC: 9211555] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[17:00:32] [DOC: 9211555] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[17:00:32] [DOC: 9211555] ✅ Patient date processing completed successfully
[17:00:32] ✅    ✅ Date processing completed
[17:00:32] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'M75.41', 'thirdDiagnosis': 'M17.0'}]
[17:00:32] 🔄 
🔄 Step 4: Extracting order data...
[17:00:35] ℹ️  Order extraction - MRN: 'MA241216044603'
[17:00:35] ℹ️  Order extraction - Sex: ''
[17:00:35] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:00:35] ℹ️  Order extraction - Payer Source: ''
[17:00:35] ✅ Order data extraction completed successfully
[17:00:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:00:35] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[17:00:35] ⚠️  Could not determine sex using any available method
[17:00:35] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:00:35] ✅ Patient name cross-validation successful
[17:00:35] ✅    ✅ Data merged successfully
[17:00:36] ✅    ✅ Order data extracted and validated
[17:00:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:00:36] [DOC: 9211555] ✅ Patient found in local cache: Leonor Gomes, ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[17:00:36] ✅    ✅ Existing patient found with ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[17:00:36] 🔄 
🔄 Step 6: Pushing order to API...
[17:00:36] [DOC: 9211555] ℹ️  Pushing order via API for patient ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[17:00:37] [DOC: 9211555] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13810"}
[17:00:37] ❌    ❌ Failed to push order
[17:00:37] 🔄 
🔄 Step 7: Writing to CSV...
[17:00:37] [DOC: 9211555] ℹ️  Calculated age: 79 from DOB: 04/15/1946
[17:00:37] [DOC: 9211555] ℹ️  Service Line extracted: 'Physical Therapy'
[17:00:37] [DOC: 9211555] ℹ️  Payer Source extracted: ''
[17:00:37] [DOC: 9211555] ℹ️  Diagnosis codes being written:
[17:00:37] [DOC: 9211555] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.816'
[17:00:37] [DOC: 9211555] ℹ️    - Latest_Episode_Seconddiagnosis: 'M75.41'
[17:00:37] [DOC: 9211555] ℹ️    - Latest_Episode_Thirddiagnosis: 'M17.0'
[17:00:37] [DOC: 9211555] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:00:37] [DOC: 9211555] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:00:37] [DOC: 9211555] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:00:37] [DOC: 9211555] ✅ Patient data written to CSV: Leonor Gomes | Sex:  | Age: 79 | Service: Physical Therapy | Payer:  | MRN: MA241216044603
[17:00:37] ✅    ✅ Document 9211555 processed and saved successfully
[17:00:37] 🔄 
🔄 Step 8: Saving API details...
[17:00:37] [DOC: 9211555] ℹ️  API push details saved for document 9211555
[17:00:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211553                         ║
================================================================================
[17:00:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:00:37] ℹ️  Date: 03/31/2025
[17:00:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:00:41] [DOC: 9211553] ✅ Text extracted using pdfplumber (14419 chars)
[17:00:41] ✅    ✅ Text extracted using pdfplumber (14419 chars)
[17:00:41] 🔄 
🔄 Step 2: Extracting patient data...
[17:00:43] ℹ️  AI extracted raw sex value: 'F'
[17:00:43] ℹ️  AI extracted service line: 'OT'
[17:00:43] ℹ️  AI extracted payer source: ''
[17:00:43] ℹ️  AI extracted diagnoses:
[17:00:43] ℹ️    - Diagnosis 1: ''
[17:00:43] ℹ️    - Diagnosis 2: ''
[17:00:43] ℹ️    - Diagnosis 3: ''
[17:00:43] ℹ️    - Diagnosis 4: ''
[17:00:43] ℹ️    - Diagnosis 5: ''
[17:00:43] ℹ️    - Diagnosis 6: ''
[17:00:43] ℹ️  Final extracted MRN: 'MA241216044603'
[17:00:43] ℹ️  Final extracted Sex: 'FEMALE'
[17:00:43] ℹ️  Final extracted Service Line: 'OT'
[17:00:43] ℹ️  Final extracted Payer Source: ''
[17:00:43] ✅ Patient data extraction completed successfully
[17:00:43] ✅    ✅ Patient data extracted successfully
[17:00:43] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:43] ✅    ✅ Patient identified: Leonor Gomes
[17:00:43] ✅    ✅ Patient name validation passed
[17:00:43] 🔄 
🔄 Step 3: Processing patient dates...
[17:00:43] [DOC: 9211553] ℹ️  DOB normalized: 04/15/1946
[17:00:43] [DOC: 9211553] ✅ Patient date processing completed successfully
[17:00:43] ✅    ✅ Date processing completed
[17:00:43] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:43] 🔄 
🔄 Step 4: Extracting order data...
[17:00:46] ℹ️  Order extraction - MRN: 'MA241216044603'
[17:00:46] ℹ️  Order extraction - Sex: 'FEMALE'
[17:00:46] ℹ️  Order extraction - Service Line: 'OT'
[17:00:46] ℹ️  Order extraction - Payer Source: ''
[17:00:46] ✅ Order data extraction completed successfully
[17:00:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:00:46] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[17:00:46] ℹ️  Service line consistent in both sources: 'OT'
[17:00:46] ✅ Patient name cross-validation successful
[17:00:46] ✅    ✅ Data merged successfully
[17:00:47] ⚠️     ❌ Skipping - missing episode start date
[17:00:47] [DOC: 9211553] ℹ️  API push details saved for document 9211553
================================================================================
║                        Processing Document ID: 9211550                         ║
================================================================================
[17:00:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:00:47] ℹ️  Date: 03/31/2025
[17:00:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:00:49] [DOC: 9211550] ✅ Text extracted using pdfplumber (1222 chars)
[17:00:49] ✅    ✅ Text extracted using pdfplumber (1222 chars)
[17:00:49] 🔄 
🔄 Step 2: Extracting patient data...
[17:00:52] ℹ️  AI extracted raw sex value: ''
[17:00:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:00:52] ℹ️  AI extracted payer source: ''
[17:00:52] ℹ️  AI extracted diagnoses:
[17:00:52] ℹ️    - Diagnosis 1: 'I10'
[17:00:52] ℹ️    - Diagnosis 2: 'I50.30'
[17:00:52] ℹ️    - Diagnosis 3: 'I47.10'
[17:00:52] ℹ️    - Diagnosis 4: ''
[17:00:52] ℹ️    - Diagnosis 5: ''
[17:00:52] ℹ️    - Diagnosis 6: ''
[17:00:52] ℹ️  Final extracted MRN: '100990115'
[17:00:52] ℹ️  Final extracted Sex: ''
[17:00:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:00:52] ℹ️  Final extracted Payer Source: ''
[17:00:52] ✅ Patient data extraction completed successfully
[17:00:52] ✅    ✅ Patient data extracted successfully
[17:00:52] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Carreiro
     └─ dob: 06/26/1937
     └─ patientSex: 
     └─ medicalRecordNo: 100990115
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'I47.10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:52] ✅    ✅ Patient identified: Maria Carreiro
[17:00:52] ✅    ✅ Patient name validation passed
[17:00:52] 🔄 
🔄 Step 3: Processing patient dates...
[17:00:52] [DOC: 9211550] ℹ️  DOB normalized: 06/26/1937
[17:00:52] [DOC: 9211550] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[17:00:52] [DOC: 9211550] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[17:00:52] [DOC: 9211550] ✅ Patient date processing completed successfully
[17:00:52] ✅    ✅ Date processing completed
[17:00:52] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Carreiro
     └─ dob: 06/26/1937
     └─ patientSex: 
     └─ medicalRecordNo: 100990115
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'I47.10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:00:52] 🔄 
🔄 Step 4: Extracting order data...
[17:00:54] ℹ️  Order extraction - MRN: '100990115'
[17:00:54] ℹ️  Order extraction - Sex: ''
[17:00:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:00:54] ℹ️  Order extraction - Payer Source: ''
[17:00:54] ✅ Order data extraction completed successfully
[17:00:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:00:54] ℹ️  Using MRN from patient data: '100990115' over '100990115'
[17:00:54] ℹ️  Inferred sex as FEMALE from name: Maria
[17:00:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:00:54] ✅ Patient name cross-validation successful
[17:00:54] ✅    ✅ Data merged successfully
[17:00:56] ✅    ✅ Order data extracted and validated
[17:00:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:00:56] [DOC: 9211550] ✅ Patient found in local cache: Maria Carreiro, ID: 6aec569b-b875-4d6a-84f6-67adf52d7649
[17:00:56] ✅    ✅ Existing patient found with ID: 6aec569b-b875-4d6a-84f6-67adf52d7649
[17:00:56] 🔄 
🔄 Step 6: Pushing order to API...
[17:00:56] [DOC: 9211550] ℹ️  Pushing order via API for patient ID: 6aec569b-b875-4d6a-84f6-67adf52d7649
[17:00:57] [DOC: 9211550] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13453"}
[17:00:57] ❌    ❌ Failed to push order
[17:00:57] 🔄 
🔄 Step 7: Writing to CSV...
[17:00:57] [DOC: 9211550] ℹ️  Calculated age: 87 from DOB: 06/26/1937
[17:00:57] [DOC: 9211550] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:00:57] [DOC: 9211550] ℹ️  Payer Source extracted: ''
[17:00:57] [DOC: 9211550] ℹ️  Diagnosis codes being written:
[17:00:57] [DOC: 9211550] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[17:00:57] [DOC: 9211550] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.30'
[17:00:57] [DOC: 9211550] ℹ️    - Latest_Episode_Thirddiagnosis: 'I47.10'
[17:00:57] [DOC: 9211550] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:00:57] [DOC: 9211550] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:00:57] [DOC: 9211550] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:00:57] [DOC: 9211550] ✅ Patient data written to CSV: Maria Carreiro | Sex: FEMALE | Age: 87 | Service: Skilled Nursing | Payer:  | MRN: 100990115
[17:00:57] ✅    ✅ Document 9211550 processed and saved successfully
[17:00:57] 🔄 
🔄 Step 8: Saving API details...
[17:00:57] [DOC: 9211550] ℹ️  API push details saved for document 9211550
[17:00:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211545                         ║
================================================================================
[17:00:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:00:57] ℹ️  Date: 03/31/2025
[17:00:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:00:59] [DOC: 9211545] ✅ Text extracted using pdfplumber (1667 chars)
[17:00:59] ✅    ✅ Text extracted using pdfplumber (1667 chars)
[17:00:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:01:02] ℹ️  AI extracted raw sex value: ''
[17:01:02] ℹ️  AI extracted service line: 'PT'
[17:01:02] ℹ️  AI extracted payer source: ''
[17:01:02] ℹ️  AI extracted diagnoses:
[17:01:02] ℹ️    - Diagnosis 1: 'G20.A1'
[17:01:02] ℹ️    - Diagnosis 2: 'M62.81'
[17:01:02] ℹ️    - Diagnosis 3: 'R29.6'
[17:01:02] ℹ️    - Diagnosis 4: ''
[17:01:02] ℹ️    - Diagnosis 5: ''
[17:01:02] ℹ️    - Diagnosis 6: ''
[17:01:02] ℹ️  Final extracted MRN: 'MA250124035001'
[17:01:02] ℹ️  Final extracted Sex: ''
[17:01:02] ℹ️  Final extracted Service Line: 'PT'
[17:01:02] ℹ️  Final extracted Payer Source: ''
[17:01:02] ✅ Patient data extraction completed successfully
[17:01:02] ✅    ✅ Patient data extracted successfully
[17:01:02] 📊 Patient Response
     └─ patientFName: Joann
     └─ patientLName: Berube
     └─ dob: 03/21/1950
     └─ patientSex: 
     └─ medicalRecordNo: MA250124035001
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:01:02] ✅    ✅ Patient identified: Joann Berube
[17:01:02] ✅    ✅ Patient name validation passed
[17:01:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:01:02] [DOC: 9211545] ℹ️  DOB normalized: 03/21/1950
[17:01:02] [DOC: 9211545] ℹ️  Episode startOfCare normalized: 01/31/2025
[17:01:02] [DOC: 9211545] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[17:01:02] [DOC: 9211545] ℹ️  Episode endOfEpisode normalized: 03/31/2025
[17:01:02] [DOC: 9211545] ✅ Patient date processing completed successfully
[17:01:02] ✅    ✅ Date processing completed
[17:01:02] 📊 Processed Patient Data
     └─ patientFName: Joann
     └─ patientLName: Berube
     └─ dob: 03/21/1950
     └─ patientSex: 
     └─ medicalRecordNo: MA250124035001
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:01:02] 🔄 
🔄 Step 4: Extracting order data...
[17:01:05] ℹ️  Order extraction - MRN: 'MA250124035001'
[17:01:05] ℹ️  Order extraction - Sex: ''
[17:01:05] ℹ️  Order extraction - Service Line: 'PT'
[17:01:05] ℹ️  Order extraction - Payer Source: ''
[17:01:05] ✅ Order data extraction completed successfully
[17:01:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:01:05] ℹ️  Using MRN from patient data: 'MA250124035001' over 'MA250124035001'
[17:01:05] ⚠️  Could not determine sex using any available method
[17:01:05] ℹ️  Service line consistent in both sources: 'PT'
[17:01:05] ✅ Patient name cross-validation successful
[17:01:05] ✅    ✅ Data merged successfully
[17:01:06] ✅    ✅ Order data extracted and validated
[17:01:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:01:13] [DOC: 9211545] ✅ Patient exists in API: Joann Berube, ID: 39673aeb-487a-4df6-b68f-9b8ec9bec006
[17:01:13] ✅    ✅ Existing patient found with ID: 39673aeb-487a-4df6-b68f-9b8ec9bec006
[17:01:13] 🔄 
🔄 Step 6: Pushing order to API...
[17:01:13] [DOC: 9211545] ℹ️  Pushing order via API for patient ID: 39673aeb-487a-4df6-b68f-9b8ec9bec006
[17:01:14] [DOC: 9211545] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13117"}
[17:01:14] ❌    ❌ Failed to push order
[17:01:14] 🔄 
🔄 Step 7: Writing to CSV...
[17:01:14] [DOC: 9211545] ℹ️  Calculated age: 75 from DOB: 03/21/1950
[17:01:14] [DOC: 9211545] ℹ️  Service Line extracted: 'PT'
[17:01:14] [DOC: 9211545] ℹ️  Payer Source extracted: ''
[17:01:14] [DOC: 9211545] ℹ️  Diagnosis codes being written:
[17:01:14] [DOC: 9211545] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[17:01:14] [DOC: 9211545] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[17:01:14] [DOC: 9211545] ℹ️    - Latest_Episode_Thirddiagnosis: 'R29.6'
[17:01:14] [DOC: 9211545] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:01:14] [DOC: 9211545] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:01:14] [DOC: 9211545] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:01:14] [DOC: 9211545] ✅ Patient data written to CSV: Joann Berube | Sex:  | Age: 75 | Service: PT | Payer:  | MRN: MA250124035001
[17:01:14] ✅    ✅ Document 9211545 processed and saved successfully
[17:01:14] 🔄 
🔄 Step 8: Saving API details...
[17:01:14] [DOC: 9211545] ℹ️  API push details saved for document 9211545
[17:01:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211236                         ║
================================================================================
[17:01:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:01:14] ℹ️  Date: 03/31/2025
[17:01:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:01:16] [DOC: 9211236] ✅ Text extracted using pdfplumber (2205 chars)
[17:01:16] ✅    ✅ Text extracted using pdfplumber (2193 chars)
[17:01:16] 🔄 
🔄 Step 2: Extracting patient data...
[17:01:19] ℹ️  AI extracted raw sex value: ''
[17:01:19] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:01:19] ℹ️  AI extracted payer source: ''
[17:01:19] ℹ️  AI extracted diagnoses:
[17:01:19] ℹ️    - Diagnosis 1: 'K74.69'
[17:01:19] ℹ️    - Diagnosis 2: 'R18.8'
[17:01:19] ℹ️    - Diagnosis 3: 'R16.1'
[17:01:19] ℹ️    - Diagnosis 4: 'None'
[17:01:19] ℹ️    - Diagnosis 5: 'None'
[17:01:19] ℹ️    - Diagnosis 6: 'None'
[17:01:19] ℹ️  Final extracted MRN: 'MA250224016702'
[17:01:19] ℹ️  Final extracted Sex: ''
[17:01:19] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:01:19] ℹ️  Final extracted Payer Source: ''
[17:01:19] ✅ Patient data extraction completed successfully
[17:01:19] ✅    ✅ Patient data extracted successfully
[17:01:19] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R18.8', 'thirdDiagnosis': 'R16.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:01:19] ✅    ✅ Patient identified: Judith Souza
[17:01:19] ✅    ✅ Patient name validation passed
[17:01:19] 🔄 
🔄 Step 3: Processing patient dates...
[17:01:19] [DOC: 9211236] ℹ️  DOB normalized: 01/04/1967
[17:01:19] [DOC: 9211236] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[17:01:19] [DOC: 9211236] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[17:01:19] [DOC: 9211236] ✅ Patient date processing completed successfully
[17:01:19] ✅    ✅ Date processing completed
[17:01:19] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R18.8', 'thirdDiagnosis': 'R16.1'}]
[17:01:19] 🔄 
🔄 Step 4: Extracting order data...
[17:01:22] ℹ️  Order extraction - MRN: 'MA250224016702'
[17:01:22] ℹ️  Order extraction - Sex: ''
[17:01:22] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:01:22] ℹ️  Order extraction - Payer Source: ''
[17:01:22] ✅ Order data extraction completed successfully
[17:01:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:01:22] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[17:01:22] ⚠️  Could not determine sex using any available method
[17:01:22] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:01:22] ✅ Patient name cross-validation successful
[17:01:22] ✅    ✅ Data merged successfully
[17:01:23] ✅    ✅ Order data extracted and validated
[17:01:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:01:36] [DOC: 9211236] ℹ️  Patient not found in cache or API: Judith Souza
[17:01:36] [DOC: 9211236] ℹ️  Patient not found, creating new patient via API...
[17:01:36] [DOC: 9211236] ℹ️  Creating patient via API: Judith Souza
[17:01:37] [DOC: 9211236] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:01:37] ❌    ❌ Failed to create patient
[17:01:37] [DOC: 9211236] ℹ️  API push details saved for document 9211236
================================================================================
║                        Processing Document ID: 9211235                         ║
================================================================================
[17:01:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:01:37] ℹ️  Date: 03/31/2025
[17:01:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:01:40] [DOC: 9211235] ✅ Text extracted using pdfplumber (2131 chars)
[17:01:40] ✅    ✅ Text extracted using pdfplumber (2119 chars)
[17:01:40] 🔄 
🔄 Step 2: Extracting patient data...
[17:01:42] ℹ️  AI extracted raw sex value: ''
[17:01:42] ℹ️  AI extracted service line: 'Physical Therapy'
[17:01:42] ℹ️  AI extracted payer source: ''
[17:01:42] ℹ️  AI extracted diagnoses:
[17:01:42] ℹ️    - Diagnosis 1: 'K74.69'
[17:01:42] ℹ️    - Diagnosis 2: 'R18.8'
[17:01:42] ℹ️    - Diagnosis 3: 'R16.1'
[17:01:42] ℹ️    - Diagnosis 4: 'None'
[17:01:42] ℹ️    - Diagnosis 5: 'None'
[17:01:42] ℹ️    - Diagnosis 6: 'None'
[17:01:42] ℹ️  Final extracted MRN: 'MA250224016702'
[17:01:42] ℹ️  Final extracted Sex: ''
[17:01:42] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:01:42] ℹ️  Final extracted Payer Source: ''
[17:01:42] ✅ Patient data extraction completed successfully
[17:01:42] ✅    ✅ Patient data extracted successfully
[17:01:42] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R18.8', 'thirdDiagnosis': 'R16.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:01:42] ✅    ✅ Patient identified: Judith Souza
[17:01:42] ✅    ✅ Patient name validation passed
[17:01:42] 🔄 
🔄 Step 3: Processing patient dates...
[17:01:42] [DOC: 9211235] ℹ️  DOB normalized: 01/04/1967
[17:01:42] [DOC: 9211235] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[17:01:42] [DOC: 9211235] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[17:01:42] [DOC: 9211235] ✅ Patient date processing completed successfully
[17:01:42] ✅    ✅ Date processing completed
[17:01:42] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R18.8', 'thirdDiagnosis': 'R16.1'}]
[17:01:42] 🔄 
🔄 Step 4: Extracting order data...
[17:01:45] ℹ️  Order extraction - MRN: 'MA250224016702'
[17:01:45] ℹ️  Order extraction - Sex: ''
[17:01:45] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:01:45] ℹ️  Order extraction - Payer Source: ''
[17:01:45] ✅ Order data extraction completed successfully
[17:01:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:01:45] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[17:01:45] ⚠️  Could not determine sex using any available method
[17:01:45] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:01:45] ✅ Patient name cross-validation successful
[17:01:45] ✅    ✅ Data merged successfully
[17:01:46] ✅    ✅ Order data extracted and validated
[17:01:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:01:58] [DOC: 9211235] ℹ️  Patient not found in cache or API: Judith Souza
[17:01:58] [DOC: 9211235] ℹ️  Patient not found, creating new patient via API...
[17:01:58] [DOC: 9211235] ℹ️  Creating patient via API: Judith Souza
[17:01:59] [DOC: 9211235] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:01:59] ❌    ❌ Failed to create patient
[17:01:59] [DOC: 9211235] ℹ️  API push details saved for document 9211235
================================================================================
║                        Processing Document ID: 9211233                         ║
================================================================================
[17:01:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:01:59] ℹ️  Date: 03/31/2025
[17:01:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:02:02] [DOC: 9211233] ✅ Text extracted using pdfplumber (2268 chars)
[17:02:02] ✅    ✅ Text extracted using pdfplumber (2256 chars)
[17:02:02] 🔄 
🔄 Step 2: Extracting patient data...
[17:02:04] ℹ️  AI extracted raw sex value: ''
[17:02:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:02:04] ℹ️  AI extracted payer source: ''
[17:02:04] ℹ️  AI extracted diagnoses:
[17:02:04] ℹ️    - Diagnosis 1: 'K74.69'
[17:02:04] ℹ️    - Diagnosis 2: 'R18.8'
[17:02:04] ℹ️    - Diagnosis 3: 'R16.1'
[17:02:04] ℹ️    - Diagnosis 4: ''
[17:02:04] ℹ️    - Diagnosis 5: ''
[17:02:04] ℹ️    - Diagnosis 6: ''
[17:02:04] ℹ️  Final extracted MRN: 'MA250224016702'
[17:02:04] ℹ️  Final extracted Sex: ''
[17:02:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:02:04] ℹ️  Final extracted Payer Source: ''
[17:02:04] ✅ Patient data extraction completed successfully
[17:02:04] ✅    ✅ Patient data extracted successfully
[17:02:04] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R18.8', 'thirdDiagnosis': 'R16.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:02:04] ✅    ✅ Patient identified: Judith Souza
[17:02:04] ✅    ✅ Patient name validation passed
[17:02:04] 🔄 
🔄 Step 3: Processing patient dates...
[17:02:04] [DOC: 9211233] ℹ️  DOB normalized: 01/04/1967
[17:02:04] [DOC: 9211233] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[17:02:04] [DOC: 9211233] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[17:02:04] [DOC: 9211233] ✅ Patient date processing completed successfully
[17:02:04] ✅    ✅ Date processing completed
[17:02:04] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: 
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: JORDAN GULAREK MD
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R18.8', 'thirdDiagnosis': 'R16.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:02:04] 🔄 
🔄 Step 4: Extracting order data...
[17:02:07] ℹ️  Order extraction - MRN: 'MA250224016702'
[17:02:07] ℹ️  Order extraction - Sex: ''
[17:02:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:02:07] ℹ️  Order extraction - Payer Source: ''
[17:02:07] ✅ Order data extraction completed successfully
[17:02:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:02:07] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[17:02:07] ⚠️  Could not determine sex using any available method
[17:02:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:02:07] ✅ Patient name cross-validation successful
[17:02:07] ✅    ✅ Data merged successfully
[17:02:08] ✅    ✅ Order data extracted and validated
[17:02:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:02:14] [DOC: 9211233] ℹ️  Patient not found in cache or API: Judith Souza
[17:02:14] [DOC: 9211233] ℹ️  Patient not found, creating new patient via API...
[17:02:14] [DOC: 9211233] ℹ️  Creating patient via API: Judith Souza
[17:02:15] [DOC: 9211233] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:02:15] ❌    ❌ Failed to create patient
[17:02:15] [DOC: 9211233] ℹ️  API push details saved for document 9211233
================================================================================
║                        Processing Document ID: 9211230                         ║
================================================================================
[17:02:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:02:15] ℹ️  Date: 03/31/2025
[17:02:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:02:18] [DOC: 9211230] ✅ Text extracted using pdfplumber (20878 chars)
[17:02:18] ✅    ✅ Text extracted using pdfplumber (20878 chars)
[17:02:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:02:21] ℹ️  AI extracted raw sex value: 'F'
[17:02:21] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:02:21] ℹ️  AI extracted payer source: 'None'
[17:02:21] ℹ️  AI extracted diagnoses:
[17:02:21] ℹ️    - Diagnosis 1: 'K7469'
[17:02:21] ℹ️    - Diagnosis 2: 'R188'
[17:02:21] ℹ️    - Diagnosis 3: 'Z792'
[17:02:21] ℹ️    - Diagnosis 4: 'Z9181'
[17:02:21] ℹ️    - Diagnosis 5: 'Z8542'
[17:02:21] ℹ️    - Diagnosis 6: 'None'
[17:02:21] ℹ️  Final extracted MRN: 'MA250224016702'
[17:02:21] ℹ️  Final extracted Sex: 'FEMALE'
[17:02:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:02:21] ℹ️  Final extracted Payer Source: ''
[17:02:21] ✅ Patient data extraction completed successfully
[17:02:21] ✅    ✅ Patient data extracted successfully
[17:02:21] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K7469', 'secondDiagnosis': 'R188', 'thirdDiagnosis': 'Z792', 'fourthDiagnosis': 'Z9181', 'fifthDiagnosis': 'Z8542', 'sixthDiagnosis': None}]
[17:02:21] ✅    ✅ Patient identified: Judith Souza
[17:02:21] ✅    ✅ Patient name validation passed
[17:02:21] 🔄 
🔄 Step 3: Processing patient dates...
[17:02:21] [DOC: 9211230] ℹ️  DOB normalized: 01/04/1967
[17:02:21] [DOC: 9211230] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[17:02:21] [DOC: 9211230] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[17:02:21] [DOC: 9211230] ✅ Patient date processing completed successfully
[17:02:21] ✅    ✅ Date processing completed
[17:02:21] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Souza
     └─ dob: 01/04/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250224016702
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'K7469', 'secondDiagnosis': 'R188', 'thirdDiagnosis': 'Z792', 'fourthDiagnosis': 'Z9181', 'fifthDiagnosis': 'Z8542'}]
[17:02:21] 🔄 
🔄 Step 4: Extracting order data...
[17:02:24] ℹ️  Order extraction - MRN: 'MA250224016702'
[17:02:24] ℹ️  Order extraction - Sex: 'FEMALE'
[17:02:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:02:24] ℹ️  Order extraction - Payer Source: ''
[17:02:24] ✅ Order data extraction completed successfully
[17:02:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:02:24] ℹ️  Using MRN from patient data: 'MA250224016702' over 'MA250224016702'
[17:02:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:02:24] ✅ Patient name cross-validation successful
[17:02:24] ✅    ✅ Data merged successfully
[17:02:25] ✅    ✅ Order data extracted and validated
[17:02:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:02:30] [DOC: 9211230] ℹ️  Patient not found in cache or API: Judith Souza
[17:02:30] [DOC: 9211230] ℹ️  Patient not found, creating new patient via API...
[17:02:30] [DOC: 9211230] ℹ️  Creating patient via API: Judith Souza
[17:02:31] [DOC: 9211230] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:02:31] ❌    ❌ Failed to create patient
[17:02:31] [DOC: 9211230] ℹ️  API push details saved for document 9211230
================================================================================
║                        Processing Document ID: 9211104                         ║
================================================================================
[17:02:31] ℹ️  Agency: Dartmouth HH
[17:02:31] ℹ️  Date: 03/31/2025
[17:02:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:02:34] [DOC: 9211104] ✅ Text extracted using pdfplumber (17452 chars)
[17:02:34] ✅    ✅ Text extracted using pdfplumber (17440 chars)
[17:02:34] 🔄 
🔄 Step 2: Extracting patient data...
[17:02:37] ℹ️  AI extracted raw sex value: 'M'
[17:02:37] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[17:02:37] ℹ️  AI extracted payer source: 'None'
[17:02:37] ℹ️  AI extracted diagnoses:
[17:02:37] ℹ️    - Diagnosis 1: 'S72.141D'
[17:02:37] ℹ️    - Diagnosis 2: 'D62'
[17:02:37] ℹ️    - Diagnosis 3: 'C61'
[17:02:37] ℹ️    - Diagnosis 4: 'J44.9'
[17:02:37] ℹ️    - Diagnosis 5: 'G43.809'
[17:02:37] ℹ️    - Diagnosis 6: 'T66.XXXD'
[17:02:37] ℹ️  Final extracted MRN: '227027'
[17:02:37] ℹ️  Final extracted Sex: 'MALE'
[17:02:37] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[17:02:37] ℹ️  Final extracted Payer Source: ''
[17:02:37] ✅ Patient data extraction completed successfully
[17:02:37] ✅    ✅ Patient data extracted successfully
[17:02:37] 📊 Patient Response
     └─ patientFName: Lucas
     └─ patientLName: William E
     └─ dob: 08/18/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/16/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'S72.141D', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'C61', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'G43.809', 'sixthDiagnosis': 'T66.XXXD'}]
[17:02:37] ✅    ✅ Patient identified: Lucas William E
[17:02:37] ✅    ✅ Patient name validation passed
[17:02:37] 🔄 
🔄 Step 3: Processing patient dates...
[17:02:37] [DOC: 9211104] ℹ️  DOB normalized: 08/18/1951
[17:02:37] [DOC: 9211104] ℹ️  Episode startOfCare normalized: 03/16/2025
[17:02:37] [DOC: 9211104] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[17:02:37] [DOC: 9211104] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[17:02:37] [DOC: 9211104] ✅ Patient date processing completed successfully
[17:02:37] ✅    ✅ Date processing completed
[17:02:37] 📊 Processed Patient Data
     └─ patientFName: Lucas
     └─ patientLName: William E
     └─ dob: 08/18/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/16/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'S72.141D', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'C61', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'G43.809', 'sixthDiagnosis': 'T66.XXXD'}]
[17:02:37] 🔄 
🔄 Step 4: Extracting order data...
[17:02:39] ℹ️  Order extraction - MRN: '6164015'
[17:02:39] ℹ️  Order extraction - Sex: 'MALE'
[17:02:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[17:02:39] ℹ️  Order extraction - Payer Source: ''
[17:02:39] ✅ Order data extraction completed successfully
[17:02:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:02:39] ℹ️  Using longer MRN from order data: '6164015' over '227027'
[17:02:39] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[17:02:39] ✅ Patient name cross-validation successful
[17:02:39] ✅    ✅ Data merged successfully
[17:02:41] ✅    ✅ Order data extracted and validated
[17:02:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:02:46] [DOC: 9211104] ✅ Patient exists in API: Lucas William E, ID: e7128ac1-af43-4bbf-80d5-8bc953058bbd
[17:02:46] ✅    ✅ Existing patient found with ID: e7128ac1-af43-4bbf-80d5-8bc953058bbd
[17:02:46] 🔄 
🔄 Step 6: Pushing order to API...
[17:02:46] [DOC: 9211104] ℹ️  Pushing order via API for patient ID: e7128ac1-af43-4bbf-80d5-8bc953058bbd
[17:02:47] [DOC: 9211104] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:02:47] ❌    ❌ Failed to push order
[17:02:47] 🔄 
🔄 Step 7: Writing to CSV...
[17:02:47] [DOC: 9211104] ℹ️  Calculated age: 73 from DOB: 08/18/1951
[17:02:47] [DOC: 9211104] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[17:02:47] [DOC: 9211104] ℹ️  Payer Source extracted: ''
[17:02:47] [DOC: 9211104] ℹ️  Diagnosis codes being written:
[17:02:47] [DOC: 9211104] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.141D'
[17:02:47] [DOC: 9211104] ℹ️    - Latest_Episode_Seconddiagnosis: 'D62'
[17:02:47] [DOC: 9211104] ℹ️    - Latest_Episode_Thirddiagnosis: 'C61'
[17:02:47] [DOC: 9211104] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[17:02:47] [DOC: 9211104] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G43.809'
[17:02:47] [DOC: 9211104] ℹ️    - Latest_Episode_Sixthdiagnosis: 'T66.XXXD'
[17:02:47] [DOC: 9211104] ✅ Patient data written to CSV: Lucas William E | Sex: MALE | Age: 73 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 6164015
[17:02:47] ✅    ✅ Document 9211104 processed and saved successfully
[17:02:47] 🔄 
🔄 Step 8: Saving API details...
[17:02:47] [DOC: 9211104] ℹ️  API push details saved for document 9211104
[17:02:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211101                         ║
================================================================================
[17:02:47] ℹ️  Agency: Dartmouth HH
[17:02:47] ℹ️  Date: 03/31/2025
[17:02:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:02:50] [DOC: 9211101] ✅ Text extracted using pdfplumber (16064 chars)
[17:02:50] ✅    ✅ Text extracted using pdfplumber (16064 chars)
[17:02:50] 🔄 
🔄 Step 2: Extracting patient data...
[17:02:53] ℹ️  AI extracted raw sex value: 'F'
[17:02:53] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[17:02:53] ℹ️  AI extracted payer source: 'Private Pay'
[17:02:53] ℹ️  AI extracted diagnoses:
[17:02:53] ℹ️    - Diagnosis 1: 'Z47.1'
[17:02:53] ℹ️    - Diagnosis 2: 'Z96.611'
[17:02:53] ℹ️    - Diagnosis 3: 'I11.0'
[17:02:53] ℹ️    - Diagnosis 4: 'I50.32'
[17:02:53] ℹ️    - Diagnosis 5: 'J45.909'
[17:02:53] ℹ️    - Diagnosis 6: 'G47.33'
[17:02:53] ℹ️  Final extracted MRN: '3918015'
[17:02:53] ℹ️  Final extracted Sex: 'FEMALE'
[17:02:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[17:02:53] ℹ️  Final extracted Payer Source: 'Private Pay'
[17:02:53] ✅ Patient data extraction completed successfully
[17:02:53] ✅    ✅ Patient data extracted successfully
[17:02:53] 📊 Patient Response
     └─ patientFName: Ann
     └─ patientLName: Kenney
     └─ dob: 07/24/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3918015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'G47.33'}]
[17:02:53] ✅    ✅ Patient identified: Ann Kenney
[17:02:53] ✅    ✅ Patient name validation passed
[17:02:53] 🔄 
🔄 Step 3: Processing patient dates...
[17:02:53] [DOC: 9211101] ℹ️  DOB normalized: 07/24/1946
[17:02:53] [DOC: 9211101] ℹ️  Episode startOfCare normalized: 02/25/2025
[17:02:53] [DOC: 9211101] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[17:02:53] [DOC: 9211101] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[17:02:53] [DOC: 9211101] ✅ Patient date processing completed successfully
[17:02:53] ✅    ✅ Date processing completed
[17:02:53] 📊 Processed Patient Data
     └─ patientFName: Ann
     └─ patientLName: Kenney
     └─ dob: 07/24/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3918015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'G47.33'}]
[17:02:53] 🔄 
🔄 Step 4: Extracting order data...
[17:02:55] ℹ️  Order extraction - MRN: '3918015'
[17:02:55] ℹ️  Order extraction - Sex: 'FEMALE'
[17:02:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[17:02:55] ℹ️  Order extraction - Payer Source: 'Private Pay'
[17:02:55] ✅ Order data extraction completed successfully
[17:02:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:02:55] ℹ️  Using MRN from patient data: '3918015' over '3918015'
[17:02:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[17:02:55] ℹ️  Payer source consistent in both sources: 'Private Pay'
[17:02:55] ✅ Patient name cross-validation successful
[17:02:55] ✅    ✅ Data merged successfully
[17:02:57] ✅    ✅ Order data extracted and validated
[17:02:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:03:03] [DOC: 9211101] ✅ Patient exists in API: Ann Kenney, ID: a9b91d98-060f-4c1c-a9b3-b77154fb4758
[17:03:03] ✅    ✅ Existing patient found with ID: a9b91d98-060f-4c1c-a9b3-b77154fb4758
[17:03:03] 🔄 
🔄 Step 6: Pushing order to API...
[17:03:03] [DOC: 9211101] ℹ️  Pushing order via API for patient ID: a9b91d98-060f-4c1c-a9b3-b77154fb4758
[17:03:04] [DOC: 9211101] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:03:04] ❌    ❌ Failed to push order
[17:03:04] 🔄 
🔄 Step 7: Writing to CSV...
[17:03:04] [DOC: 9211101] ℹ️  Calculated age: 78 from DOB: 07/24/1946
[17:03:04] [DOC: 9211101] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy'
[17:03:04] [DOC: 9211101] ℹ️  Payer Source extracted: 'Private Pay'
[17:03:04] [DOC: 9211101] ℹ️  Diagnosis codes being written:
[17:03:04] [DOC: 9211101] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[17:03:04] [DOC: 9211101] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.611'
[17:03:04] [DOC: 9211101] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[17:03:04] [DOC: 9211101] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.32'
[17:03:04] [DOC: 9211101] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J45.909'
[17:03:04] [DOC: 9211101] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[17:03:04] [DOC: 9211101] ✅ Patient data written to CSV: Ann Kenney | Sex: FEMALE | Age: 78 | Service: Skilled Nursing, Occupational Therapy | Payer: Private Pay | MRN: 3918015
[17:03:04] ✅    ✅ Document 9211101 processed and saved successfully
[17:03:04] 🔄 
🔄 Step 8: Saving API details...
[17:03:04] [DOC: 9211101] ℹ️  API push details saved for document 9211101
[17:03:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211100                         ║
================================================================================
[17:03:04] ℹ️  Agency: Dartmouth HH
[17:03:04] ℹ️  Date: 03/31/2025
[17:03:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:03:07] [DOC: 9211100] ✅ Text extracted using pdfplumber (12271 chars)
[17:03:07] ✅    ✅ Text extracted using pdfplumber (12271 chars)
[17:03:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:03:10] ℹ️  AI extracted raw sex value: 'M'
[17:03:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:03:10] ℹ️  AI extracted payer source: 'Medicare'
[17:03:10] ℹ️  AI extracted diagnoses:
[17:03:10] ℹ️    - Diagnosis 1: 'Z47.89'
[17:03:10] ℹ️    - Diagnosis 2: 'S32.040A'
[17:03:10] ℹ️    - Diagnosis 3: 'S32.050A'
[17:03:10] ℹ️    - Diagnosis 4: 'I21.4'
[17:03:10] ℹ️    - Diagnosis 5: 'I25.10'
[17:03:10] ℹ️    - Diagnosis 6: 'I12.9'
[17:03:10] ℹ️  Final extracted MRN: '6129015'
[17:03:10] ℹ️  Final extracted Sex: 'MALE'
[17:03:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:03:10] ℹ️  Final extracted Payer Source: 'Medicare'
[17:03:10] ✅ Patient data extraction completed successfully
[17:03:10] ✅    ✅ Patient data extracted successfully
[17:03:10] 📊 Patient Response
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'S32.040A', 'thirdDiagnosis': 'S32.050A', 'fourthDiagnosis': 'I21.4', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I12.9'}]
[17:03:10] ✅    ✅ Patient identified: Theodore Small
[17:03:10] ✅    ✅ Patient name validation passed
[17:03:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:03:10] [DOC: 9211100] ℹ️  DOB normalized: 09/25/1931
[17:03:10] [DOC: 9211100] ℹ️  Episode startOfCare normalized: 02/28/2025
[17:03:10] [DOC: 9211100] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[17:03:10] [DOC: 9211100] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[17:03:10] [DOC: 9211100] ✅ Patient date processing completed successfully
[17:03:10] ✅    ✅ Date processing completed
[17:03:10] 📊 Processed Patient Data
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'S32.040A', 'thirdDiagnosis': 'S32.050A', 'fourthDiagnosis': 'I21.4', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I12.9'}]
[17:03:10] 🔄 
🔄 Step 4: Extracting order data...
[17:03:13] ℹ️  Order extraction - MRN: '6129015'
[17:03:13] ℹ️  Order extraction - Sex: 'MALE'
[17:03:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:03:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:03:13] ✅ Order data extraction completed successfully
[17:03:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:03:13] ℹ️  Using MRN from patient data: '6129015' over '6129015'
[17:03:13] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:03:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:03:13] ✅ Patient name cross-validation successful
[17:03:13] ✅    ✅ Data merged successfully
[17:03:14] ✅    ✅ Order data extracted and validated
[17:03:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:03:14] [DOC: 9211100] ✅ Patient found in local cache: Theodore Small, ID: 8c849805-1775-4653-aa7c-ce211697fc95
[17:03:14] ✅    ✅ Existing patient found with ID: 8c849805-1775-4653-aa7c-ce211697fc95
[17:03:14] 🔄 
🔄 Step 6: Pushing order to API...
[17:03:14] [DOC: 9211100] ℹ️  Pushing order via API for patient ID: 8c849805-1775-4653-aa7c-ce211697fc95
[17:03:15] [DOC: 9211100] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:03:15] ❌    ❌ Failed to push order
[17:03:15] 🔄 
🔄 Step 7: Writing to CSV...
[17:03:15] [DOC: 9211100] ℹ️  Calculated age: 93 from DOB: 09/25/1931
[17:03:15] [DOC: 9211100] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:03:15] [DOC: 9211100] ℹ️  Payer Source extracted: 'Medicare'
[17:03:15] [DOC: 9211100] ℹ️  Diagnosis codes being written:
[17:03:15] [DOC: 9211100] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.89'
[17:03:15] [DOC: 9211100] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.040A'
[17:03:15] [DOC: 9211100] ℹ️    - Latest_Episode_Thirddiagnosis: 'S32.050A'
[17:03:15] [DOC: 9211100] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I21.4'
[17:03:15] [DOC: 9211100] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[17:03:15] [DOC: 9211100] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[17:03:15] [DOC: 9211100] ✅ Patient data written to CSV: Theodore Small | Sex: MALE | Age: 93 | Service: Skilled Nursing | Payer: Medicare | MRN: 6129015
[17:03:15] ✅    ✅ Document 9211100 processed and saved successfully
[17:03:15] 🔄 
🔄 Step 8: Saving API details...
[17:03:15] [DOC: 9211100] ℹ️  API push details saved for document 9211100
[17:03:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211099                         ║
================================================================================
[17:03:15] ℹ️  Agency: Dartmouth HH
[17:03:15] ℹ️  Date: 03/31/2025
[17:03:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:03:17] [DOC: 9211099] ✅ Text extracted using pdfplumber (9808 chars)
[17:03:17] ✅    ✅ Text extracted using pdfplumber (9808 chars)
[17:03:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:03:20] ℹ️  AI extracted raw sex value: 'M'
[17:03:20] ℹ️  AI extracted service line: 'PT, OT, RN, SN'
[17:03:20] ℹ️  AI extracted payer source: 'Medicare'
[17:03:20] ℹ️  AI extracted diagnoses:
[17:03:20] ℹ️    - Diagnosis 1: 'None'
[17:03:20] ℹ️    - Diagnosis 2: 'None'
[17:03:20] ℹ️    - Diagnosis 3: 'None'
[17:03:20] ℹ️    - Diagnosis 4: 'None'
[17:03:20] ℹ️    - Diagnosis 5: 'None'
[17:03:20] ℹ️    - Diagnosis 6: 'None'
[17:03:20] ℹ️  Final extracted MRN: '5564011'
[17:03:20] ℹ️  Final extracted Sex: 'MALE'
[17:03:20] ℹ️  Final extracted Service Line: 'PT, OT, RN, SN'
[17:03:20] ℹ️  Final extracted Payer Source: 'Medicare'
[17:03:20] ✅ Patient data extraction completed successfully
[17:03:20] ✅    ✅ Patient data extracted successfully
[17:03:20] 📊 Patient Response
     └─ patientFName: Chauncey
     └─ patientLName: Geer Jr,
     └─ dob: 10/27/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 5564011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, RN, SN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:03:20] ✅    ✅ Patient identified: Chauncey Geer Jr,
[17:03:20] ✅    ✅ Patient name validation passed
[17:03:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:03:20] [DOC: 9211099] ℹ️  DOB normalized: 10/27/1935
[17:03:20] [DOC: 9211099] ℹ️  Episode startOfCare normalized: 01/26/2025
[17:03:20] [DOC: 9211099] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[17:03:20] [DOC: 9211099] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[17:03:20] [DOC: 9211099] ✅ Patient date processing completed successfully
[17:03:20] ✅    ✅ Date processing completed
[17:03:20] 📊 Processed Patient Data
     └─ patientFName: Chauncey
     └─ patientLName: Geer Jr,
     └─ dob: 10/27/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 5564011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, RN, SN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025'}]
[17:03:20] 🔄 
🔄 Step 4: Extracting order data...
[17:03:23] ℹ️  Order extraction - MRN: '5564011'
[17:03:23] ℹ️  Order extraction - Sex: 'MALE'
[17:03:23] ℹ️  Order extraction - Service Line: 'PT, OT, SN'
[17:03:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:03:23] ✅ Order data extraction completed successfully
[17:03:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:03:23] ℹ️  Using MRN from patient data: '5564011' over '5564011'
[17:03:23] ℹ️  Combined service lines: Patient='PT, OT, RN, SN' + Order='PT, OT, SN' = 'OT, PT, RN, SN'
[17:03:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:03:23] ✅ Patient name cross-validation successful
[17:03:23] ✅    ✅ Data merged successfully
[17:03:24] ✅    ✅ Order data extracted and validated
[17:03:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:03:24] [DOC: 9211099] ✅ Patient found in local cache: Chauncey Geer Jr,, ID: 5f36389d-bdd3-45b9-9d8a-d2096383a006
[17:03:24] ✅    ✅ Existing patient found with ID: 5f36389d-bdd3-45b9-9d8a-d2096383a006
[17:03:24] 🔄 
🔄 Step 6: Pushing order to API...
[17:03:24] [DOC: 9211099] ℹ️  Pushing order via API for patient ID: 5f36389d-bdd3-45b9-9d8a-d2096383a006
[17:03:25] [DOC: 9211099] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:03:25] ❌    ❌ Failed to push order
[17:03:25] 🔄 
🔄 Step 7: Writing to CSV...
[17:03:25] [DOC: 9211099] ℹ️  Calculated age: 89 from DOB: 10/27/1935
[17:03:25] [DOC: 9211099] ℹ️  Service Line extracted: 'OT, PT, RN, SN'
[17:03:25] [DOC: 9211099] ℹ️  Payer Source extracted: 'Medicare'
[17:03:25] [DOC: 9211099] ℹ️  Diagnosis codes being written:
[17:03:25] [DOC: 9211099] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:03:25] [DOC: 9211099] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:03:25] [DOC: 9211099] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:03:25] [DOC: 9211099] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:03:25] [DOC: 9211099] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:03:25] [DOC: 9211099] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:03:25] [DOC: 9211099] ✅ Patient data written to CSV: Chauncey Geer Jr, | Sex: MALE | Age: 89 | Service: OT, PT, RN, SN | Payer: Medicare | MRN: 5564011
[17:03:25] ✅    ✅ Document 9211099 processed and saved successfully
[17:03:25] 🔄 
🔄 Step 8: Saving API details...
[17:03:25] [DOC: 9211099] ℹ️  API push details saved for document 9211099
[17:03:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211098                         ║
================================================================================
[17:03:25] ℹ️  Agency: Dartmouth HH
[17:03:25] ℹ️  Date: 03/31/2025
[17:03:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:03:30] [DOC: 9211098] ✅ Text extracted using pdfplumber (20068 chars)
[17:03:30] ✅    ✅ Text extracted using pdfplumber (20056 chars)
[17:03:30] 🔄 
🔄 Step 2: Extracting patient data...
[17:03:33] ℹ️  AI extracted raw sex value: 'M'
[17:03:33] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[17:03:33] ℹ️  AI extracted payer source: ''
[17:03:33] ℹ️  AI extracted diagnoses:
[17:03:33] ℹ️    - Diagnosis 1: 'F03.90'
[17:03:33] ℹ️    - Diagnosis 2: 'R55'
[17:03:33] ℹ️    - Diagnosis 3: 'E43'
[17:03:33] ℹ️    - Diagnosis 4: 'D61.818'
[17:03:33] ℹ️    - Diagnosis 5: 'I13.0'
[17:03:33] ℹ️    - Diagnosis 6: 'I50.32'
[17:03:33] ℹ️  Final extracted MRN: '227027'
[17:03:33] ℹ️  Final extracted Sex: 'MALE'
[17:03:33] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[17:03:33] ℹ️  Final extracted Payer Source: ''
[17:03:33] ✅ Patient data extraction completed successfully
[17:03:33] ✅    ✅ Patient data extracted successfully
[17:03:33] 📊 Patient Response
     └─ patientFName: Chauncey
     └─ patientLName: Geer
     └─ dob: 10/27/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/26/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R55', 'thirdDiagnosis': 'E43', 'fourthDiagnosis': 'D61.818', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.32'}]
[17:03:33] ✅    ✅ Patient identified: Chauncey Geer
[17:03:33] ✅    ✅ Patient name validation passed
[17:03:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:03:33] [DOC: 9211098] ℹ️  DOB normalized: 10/27/1935
[17:03:33] [DOC: 9211098] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[17:03:33] [DOC: 9211098] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[17:03:33] [DOC: 9211098] ✅ Patient date processing completed successfully
[17:03:33] ✅    ✅ Date processing completed
[17:03:33] 📊 Processed Patient Data
     └─ patientFName: Chauncey
     └─ patientLName: Geer
     └─ dob: 10/27/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R55', 'thirdDiagnosis': 'E43', 'fourthDiagnosis': 'D61.818', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.32'}]
[17:03:33] 🔄 
🔄 Step 4: Extracting order data...
[17:03:36] ℹ️  Order extraction - MRN: '227027'
[17:03:36] ℹ️  Order extraction - Sex: 'MALE'
[17:03:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing,PT,OT'
[17:03:36] ℹ️  Order extraction - Payer Source: ''
[17:03:36] ✅ Order data extraction completed successfully
[17:03:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:03:36] ℹ️  Using MRN from patient data: '227027' over '227027'
[17:03:36] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing,PT,OT' = 'OT, PT, Skilled Nursing'
[17:03:36] ✅ Patient name cross-validation successful
[17:03:36] ✅    ✅ Data merged successfully
[17:03:37] ✅    ✅ Order data extracted and validated
[17:03:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:03:50] [DOC: 9211098] ℹ️  Patient not found in cache or API: Chauncey Geer
[17:03:50] [DOC: 9211098] ℹ️  Patient not found, creating new patient via API...
[17:03:50] [DOC: 9211098] ℹ️  Creating patient via API: Chauncey Geer
[17:03:51] [DOC: 9211098] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:03:51] ❌    ❌ Failed to create patient
[17:03:51] [DOC: 9211098] ℹ️  API push details saved for document 9211098
================================================================================
║                        Processing Document ID: 9211081                         ║
================================================================================
[17:03:51] ℹ️  Agency: Nizhoni Health-Fall River
[17:03:51] ℹ️  Date: 03/31/2025
[17:03:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:03:54] [DOC: 9211081] ✅ Text extracted using pdfplumber (1153 chars)
[17:03:54] ✅    ✅ Text extracted using pdfplumber (1153 chars)
[17:03:54] 🔄 
🔄 Step 2: Extracting patient data...
[17:03:57] ℹ️  AI extracted raw sex value: 'M'
[17:03:57] ℹ️  AI extracted service line: 'RN'
[17:03:57] ℹ️  AI extracted payer source: 'Medicaid/MA'
[17:03:57] ℹ️  AI extracted diagnoses:
[17:03:57] ℹ️    - Diagnosis 1: ''
[17:03:57] ℹ️    - Diagnosis 2: ''
[17:03:57] ℹ️    - Diagnosis 3: ''
[17:03:57] ℹ️    - Diagnosis 4: ''
[17:03:57] ℹ️    - Diagnosis 5: ''
[17:03:57] ℹ️    - Diagnosis 6: ''
[17:03:57] ℹ️  Final extracted MRN: '3057020'
[17:03:57] ℹ️  Final extracted Sex: 'MALE'
[17:03:57] ℹ️  Final extracted Service Line: 'RN'
[17:03:57] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[17:03:57] ✅ Patient data extraction completed successfully
[17:03:57] ✅    ✅ Patient data extracted successfully
[17:03:57] 📊 Patient Response
     └─ patientFName: Scott
     └─ patientLName: Frates
     └─ dob: 02/01/1971
     └─ patientSex: MALE
     └─ medicalRecordNo: 3057020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 850 Pleasant Street Apt 229
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/13/2024', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:03:57] ✅    ✅ Patient identified: Scott Frates
[17:03:57] ✅    ✅ Patient name validation passed
[17:03:57] 🔄 
🔄 Step 3: Processing patient dates...
[17:03:57] [DOC: 9211081] ℹ️  DOB normalized: 02/01/1971
[17:03:57] [DOC: 9211081] ℹ️  Episode startOfCare normalized: 09/13/2024
[17:03:57] [DOC: 9211081] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:03:57] [DOC: 9211081] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[17:03:57] [DOC: 9211081] ✅ Patient date processing completed successfully
[17:03:57] ✅    ✅ Date processing completed
[17:03:57] 📊 Processed Patient Data
     └─ patientFName: Scott
     └─ patientLName: Frates
     └─ dob: 02/01/1971
     └─ patientSex: MALE
     └─ medicalRecordNo: 3057020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 850 Pleasant Street Apt 229
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/13/2024', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:03:57] 🔄 
🔄 Step 4: Extracting order data...
[17:03:59] ℹ️  Order extraction - MRN: '3057020'
[17:03:59] ℹ️  Order extraction - Sex: 'MALE'
[17:03:59] ℹ️  Order extraction - Service Line: ''
[17:03:59] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[17:03:59] ✅ Order data extraction completed successfully
[17:03:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:03:59] ℹ️  Using MRN from patient data: '3057020' over '3057020'
[17:03:59] ℹ️  Using service line from patient data: 'RN'
[17:03:59] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[17:03:59] ✅ Patient name cross-validation successful
[17:03:59] ✅    ✅ Data merged successfully
[17:04:00] ✅    ✅ Order data extracted and validated
[17:04:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:04:09] [DOC: 9211081] ✅ Patient exists in API: Scott Frates, ID: e0d11b23-aae3-474f-9bde-a49e55a9e708
[17:04:09] ✅    ✅ Existing patient found with ID: e0d11b23-aae3-474f-9bde-a49e55a9e708
[17:04:09] 🔄 
🔄 Step 6: Pushing order to API...
[17:04:09] [DOC: 9211081] ℹ️  Pushing order via API for patient ID: e0d11b23-aae3-474f-9bde-a49e55a9e708
[17:04:10] [DOC: 9211081] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:04:10] ❌    ❌ Failed to push order
[17:04:10] 🔄 
🔄 Step 7: Writing to CSV...
[17:04:10] [DOC: 9211081] ℹ️  Calculated age: 54 from DOB: 02/01/1971
[17:04:10] [DOC: 9211081] ℹ️  Service Line extracted: 'RN'
[17:04:10] [DOC: 9211081] ℹ️  Payer Source extracted: 'Medicaid/MA'
[17:04:10] [DOC: 9211081] ℹ️  Diagnosis codes being written:
[17:04:10] [DOC: 9211081] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:04:10] [DOC: 9211081] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:04:10] [DOC: 9211081] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:04:10] [DOC: 9211081] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:04:10] [DOC: 9211081] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:04:10] [DOC: 9211081] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:04:10] [DOC: 9211081] ✅ Patient data written to CSV: Scott Frates | Sex: MALE | Age: 54 | Service: RN | Payer: Medicaid/MA | MRN: 3057020
[17:04:10] ✅    ✅ Document 9211081 processed and saved successfully
[17:04:10] 🔄 
🔄 Step 8: Saving API details...
[17:04:10] [DOC: 9211081] ℹ️  API push details saved for document 9211081
[17:04:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211079                         ║
================================================================================
[17:04:10] ℹ️  Agency: Dartmouth HH
[17:04:10] ℹ️  Date: 03/31/2025
[17:04:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:04:12] [DOC: 9211079] ✅ Text extracted using pdfplumber (1358 chars)
[17:04:12] ✅    ✅ Text extracted using pdfplumber (1358 chars)
[17:04:12] 🔄 
🔄 Step 2: Extracting patient data...
[17:04:15] ℹ️  AI extracted raw sex value: 'F'
[17:04:15] ℹ️  AI extracted service line: 'RN, HHA'
[17:04:15] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[17:04:15] ℹ️  AI extracted diagnoses:
[17:04:15] ℹ️    - Diagnosis 1: ''
[17:04:15] ℹ️    - Diagnosis 2: ''
[17:04:15] ℹ️    - Diagnosis 3: ''
[17:04:15] ℹ️    - Diagnosis 4: ''
[17:04:15] ℹ️    - Diagnosis 5: ''
[17:04:15] ℹ️    - Diagnosis 6: ''
[17:04:15] ℹ️  Final extracted MRN: '6204015'
[17:04:15] ℹ️  Final extracted Sex: 'FEMALE'
[17:04:15] ℹ️  Final extracted Service Line: 'RN, HHA'
[17:04:15] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[17:04:15] ✅ Patient data extraction completed successfully
[17:04:15] ✅    ✅ Patient data extracted successfully
[17:04:15] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:04:15] ✅    ✅ Patient identified: Rita Costa
[17:04:15] ✅    ✅ Patient name validation passed
[17:04:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:04:15] [DOC: 9211079] ℹ️  DOB normalized: 10/16/1930
[17:04:15] [DOC: 9211079] ℹ️  Episode startOfCare normalized: 03/17/2025
[17:04:15] [DOC: 9211079] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[17:04:15] [DOC: 9211079] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:04:15] [DOC: 9211079] ✅ Patient date processing completed successfully
[17:04:15] ✅    ✅ Date processing completed
[17:04:15] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:04:15] 🔄 
🔄 Step 4: Extracting order data...
[17:04:17] ℹ️  Order extraction - MRN: ''
[17:04:17] ℹ️  Order extraction - Sex: 'FEMALE'
[17:04:17] ℹ️  Order extraction - Service Line: 'Wound Healing'
[17:04:17] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[17:04:17] ✅ Order data extraction completed successfully
[17:04:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:04:17] ℹ️  Using MRN from patient data: '6204015'
[17:04:17] ℹ️  Combined service lines: Patient='RN, HHA' + Order='Wound Healing' = 'HHA, RN, Wound Healing'
[17:04:17] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[17:04:17] ✅ Patient name cross-validation successful
[17:04:17] ✅    ✅ Data merged successfully
[17:04:18] ✅    ✅ Order data extracted and validated
[17:04:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:04:18] [DOC: 9211079] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[17:04:18] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[17:04:18] 🔄 
🔄 Step 6: Pushing order to API...
[17:04:18] [DOC: 9211079] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[17:04:19] [DOC: 9211079] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:04:19] ❌    ❌ Failed to push order
[17:04:19] 🔄 
🔄 Step 7: Writing to CSV...
[17:04:19] [DOC: 9211079] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[17:04:19] [DOC: 9211079] ℹ️  Service Line extracted: 'HHA, RN, Wound Healing'
[17:04:19] [DOC: 9211079] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[17:04:19] [DOC: 9211079] ℹ️  Diagnosis codes being written:
[17:04:19] [DOC: 9211079] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:04:19] [DOC: 9211079] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:04:19] [DOC: 9211079] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:04:19] [DOC: 9211079] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:04:19] [DOC: 9211079] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:04:19] [DOC: 9211079] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:04:19] [DOC: 9211079] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: HHA, RN, Wound Healing | Payer: Aetna- Mcare | MRN: 6204015
[17:04:19] ✅    ✅ Document 9211079 processed and saved successfully
[17:04:19] 🔄 
🔄 Step 8: Saving API details...
[17:04:19] [DOC: 9211079] ℹ️  API push details saved for document 9211079
[17:04:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9211078                         ║
================================================================================
[17:04:19] ℹ️  Agency: Dartmouth HH
[17:04:19] ℹ️  Date: 03/31/2025
[17:04:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:04:23] [DOC: 9211078] ✅ Text extracted using pdfplumber (23589 chars)
[17:04:23] ✅    ✅ Text extracted using pdfplumber (23589 chars)
[17:04:23] 🔄 
🔄 Step 2: Extracting patient data...
[17:04:26] ℹ️  AI extracted raw sex value: 'F'
[17:04:26] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[17:04:26] ℹ️  AI extracted payer source: 'None'
[17:04:26] ℹ️  AI extracted diagnoses:
[17:04:26] ℹ️    - Diagnosis 1: 'I69.398'
[17:04:26] ℹ️    - Diagnosis 2: 'M62.81'
[17:04:26] ℹ️    - Diagnosis 3: 'I69.318'
[17:04:26] ℹ️    - Diagnosis 4: 'I48.0'
[17:04:26] ℹ️    - Diagnosis 5: 'L89.322'
[17:04:26] ℹ️    - Diagnosis 6: 'I11.0'
[17:04:26] ℹ️  Final extracted MRN: '227027'
[17:04:26] ℹ️  Final extracted Sex: 'FEMALE'
[17:04:26] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[17:04:26] ℹ️  Final extracted Payer Source: ''
[17:04:26] ✅ Patient data extraction completed successfully
[17:04:26] ✅    ✅ Patient data extracted successfully
[17:04:26] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I69.318', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'L89.322', 'sixthDiagnosis': 'I11.0'}]
[17:04:26] ✅    ✅ Patient identified: Rita Costa
[17:04:26] ✅    ✅ Patient name validation passed
[17:04:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:04:26] [DOC: 9211078] ℹ️  DOB normalized: 10/16/1930
[17:04:26] [DOC: 9211078] ℹ️  Episode startOfCare normalized: 03/17/2025
[17:04:26] [DOC: 9211078] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[17:04:26] [DOC: 9211078] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:04:26] [DOC: 9211078] ✅ Patient date processing completed successfully
[17:04:26] ✅    ✅ Date processing completed
[17:04:26] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I69.318', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'L89.322', 'sixthDiagnosis': 'I11.0'}]
[17:04:26] 🔄 
🔄 Step 4: Extracting order data...
[17:04:28] ℹ️  Order extraction - MRN: '6204015'
[17:04:28] ℹ️  Order extraction - Sex: 'FEMALE'
[17:04:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[17:04:28] ℹ️  Order extraction - Payer Source: ''
[17:04:28] ✅ Order data extraction completed successfully
[17:04:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:04:28] ℹ️  Using longer MRN from order data: '6204015' over '227027'
[17:04:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[17:04:28] ✅ Patient name cross-validation successful
[17:04:28] ✅    ✅ Data merged successfully
[17:04:30] ✅    ✅ Order data extracted and validated
[17:04:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:04:30] [DOC: 9211078] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[17:04:30] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[17:04:30] 🔄 
🔄 Step 6: Pushing order to API...
[17:04:30] [DOC: 9211078] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[17:04:31] [DOC: 9211078] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:04:31] ❌    ❌ Failed to push order
[17:04:31] 🔄 
🔄 Step 7: Writing to CSV...
[17:04:31] [DOC: 9211078] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[17:04:31] [DOC: 9211078] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[17:04:31] [DOC: 9211078] ℹ️  Payer Source extracted: ''
[17:04:31] [DOC: 9211078] ℹ️  Diagnosis codes being written:
[17:04:31] [DOC: 9211078] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[17:04:31] [DOC: 9211078] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[17:04:31] [DOC: 9211078] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.318'
[17:04:31] [DOC: 9211078] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[17:04:31] [DOC: 9211078] ℹ️    - Latest_Episode_Fifthdiagnosis: 'L89.322'
[17:04:31] [DOC: 9211078] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[17:04:31] [DOC: 9211078] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 6204015
[17:04:31] ✅    ✅ Document 9211078 processed and saved successfully
[17:04:31] 🔄 
🔄 Step 8: Saving API details...
[17:04:31] [DOC: 9211078] ℹ️  API push details saved for document 9211078
[17:04:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9210977                         ║
================================================================================
[17:04:31] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[17:04:31] ℹ️  Date: 03/30/2025
[17:04:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:04:33] [DOC: 9210977] ✅ Text extracted using pdfplumber (2169 chars)
[17:04:33] ✅    ✅ Text extracted using pdfplumber (2157 chars)
[17:04:33] 🔄 
🔄 Step 2: Extracting patient data...
[17:04:36] ℹ️  AI extracted raw sex value: ''
[17:04:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:04:36] ℹ️  AI extracted payer source: 'Medicare'
[17:04:36] ℹ️  AI extracted diagnoses:
[17:04:36] ℹ️    - Diagnosis 1: 'None'
[17:04:36] ℹ️    - Diagnosis 2: 'None'
[17:04:36] ℹ️    - Diagnosis 3: 'None'
[17:04:36] ℹ️    - Diagnosis 4: 'None'
[17:04:36] ℹ️    - Diagnosis 5: 'None'
[17:04:36] ℹ️    - Diagnosis 6: 'None'
[17:04:36] ℹ️  Final extracted MRN: '28700120687001'
[17:04:36] ℹ️  Final extracted Sex: ''
[17:04:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:04:36] ℹ️  Final extracted Payer Source: 'Medicare'
[17:04:36] ✅ Patient data extraction completed successfully
[17:04:36] ✅    ✅ Patient data extracted successfully
[17:04:36] 📊 Patient Response
     └─ patientFName: WILLIAM
     └─ patientLName: WARECKI
     └─ dob: 06/04/1944
     └─ patientSex: 
     └─ medicalRecordNo: 28700120687001
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 537 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/18/2024', 'endOfEpisode': '11/24/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '02/12/2025', 'endOfEpisode': '02/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:04:36] ✅    ✅ Patient identified: WILLIAM WARECKI
[17:04:36] ✅    ✅ Patient name validation passed
[17:04:36] 🔄 
🔄 Step 3: Processing patient dates...
[17:04:36] [DOC: 9210977] ℹ️  DOB normalized: 06/04/1944
[17:04:36] [DOC: 9210977] ℹ️  Episode startOfEpisode normalized: 11/18/2024
[17:04:36] [DOC: 9210977] ℹ️  Episode endOfEpisode normalized: 11/24/2024
[17:04:36] [DOC: 9210977] ✅ Patient date processing completed successfully
[17:04:36] ✅    ✅ Date processing completed
[17:04:36] 📊 Processed Patient Data
     └─ patientFName: WILLIAM
     └─ patientLName: WARECKI
     └─ dob: 06/04/1944
     └─ patientSex: 
     └─ medicalRecordNo: 28700120687001
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 537 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/18/2024', 'endOfEpisode': '11/24/2024'}, {'startOfCare': '', 'startOfEpisode': '02/12/2025', 'endOfEpisode': '02/20/2025'}]
[17:04:36] 🔄 
🔄 Step 4: Extracting order data...
[17:04:39] ℹ️  Order extraction - MRN: '28700120687001'
[17:04:39] ℹ️  Order extraction - Sex: ''
[17:04:39] ℹ️  Order extraction - Service Line: 'RN'
[17:04:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:04:39] ✅ Order data extraction completed successfully
[17:04:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:04:39] ℹ️  Using MRN from patient data: '28700120687001' over '28700120687001'
[17:04:39] ℹ️  Inferred sex as MALE from name: WILLIAM
[17:04:39] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[17:04:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:04:39] ✅ Patient name cross-validation successful
[17:04:39] ✅    ✅ Data merged successfully
[17:04:40] ✅    ✅ Order data extracted and validated
[17:04:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:04:49] [DOC: 9210977] ℹ️  Patient not found in cache or API: WILLIAM WARECKI
[17:04:49] [DOC: 9210977] ℹ️  Patient not found, creating new patient via API...
[17:04:49] [DOC: 9210977] ℹ️  Creating patient via API: WILLIAM WARECKI
[17:04:50] [DOC: 9210977] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:04:50] ❌    ❌ Failed to create patient
[17:04:50] [DOC: 9210977] ℹ️  API push details saved for document 9210977
================================================================================
║                        Processing Document ID: 9209497                         ║
================================================================================
[17:04:50] ℹ️  Agency: AccentCare Fall River
[17:04:50] ℹ️  Date: 03/28/2025
[17:04:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:09] [DOC: 9209497] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[17:05:21] [DOC: 9209497] ✅ Text extracted using tesseract_ocr (27339 chars)
[17:05:21] ✅    ✅ Text extracted using tesseract_ocr (27291 chars)
[17:05:21] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:25] ℹ️  AI extracted raw sex value: 'F'
[17:05:25] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:05:25] ℹ️  AI extracted payer source: 'Medicare'
[17:05:25] ℹ️  AI extracted diagnoses:
[17:05:25] ℹ️    - Diagnosis 1: 'E11.621'
[17:05:25] ℹ️    - Diagnosis 2: 'I197529'
[17:05:25] ℹ️    - Diagnosis 3: '24801'
[17:05:25] ℹ️    - Diagnosis 4: '747.81'
[17:05:25] ℹ️    - Diagnosis 5: '113.0'
[17:05:25] ℹ️    - Diagnosis 6: '150.32'
[17:05:25] ℹ️  Final extracted MRN: 'C0200069532501'
[17:05:25] ℹ️  Final extracted Sex: 'FEMALE'
[17:05:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:05:25] ℹ️  Final extracted Payer Source: 'Medicare'
[17:05:25] ✅ Patient data extraction completed successfully
[17:05:25] ✅    ✅ Patient data extracted successfully
[17:05:25] 📊 Patient Response
     └─ patientFName: LINDA
     └─ patientLName: RAEDEL
     └─ dob: 01/10/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200069532501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 517 CHASE ROAD
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'E11.621', 'secondDiagnosis': 'I197529', 'thirdDiagnosis': '24801', 'fourthDiagnosis': '747.81', 'fifthDiagnosis': '113.0', 'sixthDiagnosis': '150.32'}]
[17:05:25] ✅    ✅ Patient identified: LINDA RAEDEL
[17:05:25] ✅    ✅ Patient name validation passed
[17:05:25] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:25] [DOC: 9209497] ℹ️  DOB normalized: 01/10/1954
[17:05:25] [DOC: 9209497] ℹ️  Episode startOfCare normalized: 03/24/2025
[17:05:25] [DOC: 9209497] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[17:05:25] [DOC: 9209497] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[17:05:25] [DOC: 9209497] ✅ Patient date processing completed successfully
[17:05:25] ✅    ✅ Date processing completed
[17:05:25] 📊 Processed Patient Data
     └─ patientFName: LINDA
     └─ patientLName: RAEDEL
     └─ dob: 01/10/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200069532501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 517 CHASE ROAD
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'E11.621', 'secondDiagnosis': 'I197529', 'thirdDiagnosis': '24801', 'fourthDiagnosis': '747.81', 'fifthDiagnosis': '113.0', 'sixthDiagnosis': '150.32'}]
[17:05:25] 🔄 
🔄 Step 4: Extracting order data...
[17:05:28] ℹ️  Order extraction - MRN: 'C0200069532501'
[17:05:28] ℹ️  Order extraction - Sex: 'FEMALE'
[17:05:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:05:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:05:28] ✅ Order data extraction completed successfully
[17:05:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:28] ℹ️  Using MRN from patient data: 'C0200069532501' over 'C0200069532501'
[17:05:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:05:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:05:28] ✅ Patient name cross-validation successful
[17:05:28] ✅    ✅ Data merged successfully
[17:05:29] ✅    ✅ Order data extracted and validated
[17:05:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:35] [DOC: 9209497] ℹ️  Patient not found in cache or API: LINDA RAEDEL
[17:05:35] [DOC: 9209497] ℹ️  Patient not found, creating new patient via API...
[17:05:35] [DOC: 9209497] ℹ️  Creating patient via API: LINDA RAEDEL
[17:05:36] [DOC: 9209497] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:05:36] ❌    ❌ Failed to create patient
[17:05:36] [DOC: 9209497] ℹ️  API push details saved for document 9209497
================================================================================
║                        Processing Document ID: 9209090                         ║
================================================================================
[17:05:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:05:36] ℹ️  Date: 03/28/2025
[17:05:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:39] [DOC: 9209090] ✅ Text extracted using pdfplumber (14132 chars)
[17:05:39] ✅    ✅ Text extracted using pdfplumber (14132 chars)
[17:05:39] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:42] ℹ️  AI extracted raw sex value: 'F'
[17:05:42] ℹ️  AI extracted service line: 'Physical Therapy'
[17:05:42] ℹ️  AI extracted payer source: ''
[17:05:42] ℹ️  AI extracted diagnoses:
[17:05:42] ℹ️    - Diagnosis 1: 'I69.398'
[17:05:42] ℹ️    - Diagnosis 2: 'R53.1'
[17:05:42] ℹ️    - Diagnosis 3: 'I12.9'
[17:05:42] ℹ️    - Diagnosis 4: 'N18.31'
[17:05:42] ℹ️    - Diagnosis 5: 'D63.1'
[17:05:42] ℹ️    - Diagnosis 6: 'F41.9'
[17:05:42] ℹ️  Final extracted MRN: '2491526'
[17:05:42] ℹ️  Final extracted Sex: 'FEMALE'
[17:05:42] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:05:42] ℹ️  Final extracted Payer Source: ''
[17:05:42] ✅ Patient data extraction completed successfully
[17:05:42] ✅    ✅ Patient data extracted successfully
[17:05:42] 📊 Patient Response
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.9'}]
[17:05:42] ✅    ✅ Patient identified: Alda Frias
[17:05:42] ✅    ✅ Patient name validation passed
[17:05:42] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:42] [DOC: 9209090] ℹ️  DOB normalized: 10/11/1934
[17:05:42] [DOC: 9209090] ℹ️  Episode startOfCare normalized: 03/14/2025
[17:05:42] [DOC: 9209090] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[17:05:42] [DOC: 9209090] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[17:05:42] [DOC: 9209090] ✅ Patient date processing completed successfully
[17:05:42] ✅    ✅ Date processing completed
[17:05:42] 📊 Processed Patient Data
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.9'}]
[17:05:42] 🔄 
🔄 Step 4: Extracting order data...
[17:05:45] ℹ️  Order extraction - MRN: '2491526'
[17:05:45] ℹ️  Order extraction - Sex: 'FEMALE'
[17:05:45] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:05:45] ℹ️  Order extraction - Payer Source: ''
[17:05:45] ✅ Order data extraction completed successfully
[17:05:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:45] ℹ️  Using MRN from patient data: '2491526' over '2491526'
[17:05:45] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:05:45] ✅ Patient name cross-validation successful
[17:05:45] ✅    ✅ Data merged successfully
[17:05:47] ✅    ✅ Order data extracted and validated
[17:05:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:47] [DOC: 9209090] ✅ Patient found in local cache: Alda Frias, ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[17:05:47] ✅    ✅ Existing patient found with ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[17:05:47] 🔄 
🔄 Step 6: Pushing order to API...
[17:05:47] [DOC: 9209090] ℹ️  Pushing order via API for patient ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[17:05:48] [DOC: 9209090] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13024"}
[17:05:48] ❌    ❌ Failed to push order
[17:05:48] 🔄 
🔄 Step 7: Writing to CSV...
[17:05:48] [DOC: 9209090] ℹ️  Calculated age: 90 from DOB: 10/11/1934
[17:05:48] [DOC: 9209090] ℹ️  Service Line extracted: 'Physical Therapy'
[17:05:48] [DOC: 9209090] ℹ️  Payer Source extracted: ''
[17:05:48] [DOC: 9209090] ℹ️  Diagnosis codes being written:
[17:05:48] [DOC: 9209090] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[17:05:48] [DOC: 9209090] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[17:05:48] [DOC: 9209090] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[17:05:48] [DOC: 9209090] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[17:05:48] [DOC: 9209090] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[17:05:48] [DOC: 9209090] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:05:48] [DOC: 9209090] ✅ Patient data written to CSV: Alda Frias | Sex: FEMALE | Age: 90 | Service: Physical Therapy | Payer:  | MRN: 2491526
[17:05:48] ✅    ✅ Document 9209090 processed and saved successfully
[17:05:48] 🔄 
🔄 Step 8: Saving API details...
[17:05:48] [DOC: 9209090] ℹ️  API push details saved for document 9209090
[17:05:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208972                         ║
================================================================================
[17:05:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:05:48] ℹ️  Date: 03/28/2025
[17:05:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:50] [DOC: 9208972] ✅ Text extracted using pdfplumber (10192 chars)
[17:05:50] ✅    ✅ Text extracted using pdfplumber (10192 chars)
[17:05:50] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:54] ℹ️  AI extracted raw sex value: 'M'
[17:05:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:05:54] ℹ️  AI extracted payer source: 'Medicare'
[17:05:54] ℹ️  AI extracted diagnoses:
[17:05:54] ℹ️    - Diagnosis 1: 'F32.9'
[17:05:54] ℹ️    - Diagnosis 2: 'S80.12X'
[17:05:54] ℹ️    - Diagnosis 3: 'N18.9'
[17:05:54] ℹ️    - Diagnosis 4: 'D63.1'
[17:05:54] ℹ️    - Diagnosis 5: 'I25.10'
[17:05:54] ℹ️    - Diagnosis 6: 'G47.33'
[17:05:54] ℹ️  Final extracted MRN: '9t25qa9jw80'
[17:05:54] ℹ️  Final extracted Sex: 'MALE'
[17:05:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:05:54] ℹ️  Final extracted Payer Source: 'Medicare'
[17:05:54] ✅ Patient data extraction completed successfully
[17:05:54] ✅    ✅ Patient data extracted successfully
[17:05:54] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Tavares
     └─ dob: 10/25/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 9t25qa9jw80
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 1881923936
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 671 Purchase St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 287-4720
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/16/2023', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'S80.12X', 'thirdDiagnosis': 'N18.9', 'fourthDiagnosis': 'D63.1', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'G47.33'}]
[17:05:54] ✅    ✅ Patient identified: James Tavares
[17:05:54] ✅    ✅ Patient name validation passed
[17:05:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:54] [DOC: 9208972] ℹ️  DOB normalized: 10/25/1942
[17:05:54] [DOC: 9208972] ℹ️  Episode startOfCare normalized: 11/16/2023
[17:05:54] [DOC: 9208972] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[17:05:54] [DOC: 9208972] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[17:05:54] [DOC: 9208972] ✅ Patient date processing completed successfully
[17:05:54] ✅    ✅ Date processing completed
[17:05:54] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Tavares
     └─ dob: 10/25/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 9t25qa9jw80
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 1881923936
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 671 Purchase St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 287-4720
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/16/2023', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'S80.12X', 'thirdDiagnosis': 'N18.9', 'fourthDiagnosis': 'D63.1', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'G47.33'}]
[17:05:54] 🔄 
🔄 Step 4: Extracting order data...
[17:05:56] ℹ️  Order extraction - MRN: '9t25qa9jw80'
[17:05:56] ℹ️  Order extraction - Sex: 'MALE'
[17:05:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:05:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:05:56] ✅ Order data extraction completed successfully
[17:05:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:56] ℹ️  Using MRN from patient data: '9t25qa9jw80' over '9t25qa9jw80'
[17:05:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:05:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:05:56] ✅ Patient name cross-validation successful
[17:05:56] ✅    ✅ Data merged successfully
[17:05:57] ✅    ✅ Order data extracted and validated
[17:05:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:02] [DOC: 9208972] ✅ Patient exists in API: James Tavares, ID: 1ebea1b1-a2af-4b4f-98f1-f75488d6f102
[17:06:02] ✅    ✅ Existing patient found with ID: 1ebea1b1-a2af-4b4f-98f1-f75488d6f102
[17:06:02] 🔄 
🔄 Step 6: Pushing order to API...
[17:06:02] [DOC: 9208972] ℹ️  Pushing order via API for patient ID: 1ebea1b1-a2af-4b4f-98f1-f75488d6f102
[17:06:03] [DOC: 9208972] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14224"}
[17:06:03] ❌    ❌ Failed to push order
[17:06:03] 🔄 
🔄 Step 7: Writing to CSV...
[17:06:03] [DOC: 9208972] ℹ️  Calculated age: 82 from DOB: 10/25/1942
[17:06:03] [DOC: 9208972] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:06:03] [DOC: 9208972] ℹ️  Payer Source extracted: 'Medicare'
[17:06:03] [DOC: 9208972] ℹ️  Diagnosis codes being written:
[17:06:03] [DOC: 9208972] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.9'
[17:06:03] [DOC: 9208972] ℹ️    - Latest_Episode_Seconddiagnosis: 'S80.12X'
[17:06:03] [DOC: 9208972] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.9'
[17:06:03] [DOC: 9208972] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D63.1'
[17:06:03] [DOC: 9208972] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[17:06:03] [DOC: 9208972] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[17:06:03] [DOC: 9208972] ✅ Patient data written to CSV: James Tavares | Sex: MALE | Age: 82 | Service: Skilled Nursing | Payer: Medicare | MRN: 9t25qa9jw80
[17:06:03] ✅    ✅ Document 9208972 processed and saved successfully
[17:06:03] 🔄 
🔄 Step 8: Saving API details...
[17:06:03] [DOC: 9208972] ℹ️  API push details saved for document 9208972
[17:06:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208950                         ║
================================================================================
[17:06:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:06:03] ℹ️  Date: 03/28/2025
[17:06:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:06] [DOC: 9208950] ✅ Text extracted using pdfplumber (12555 chars)
[17:06:06] ✅    ✅ Text extracted using pdfplumber (12555 chars)
[17:06:06] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:09] ℹ️  AI extracted raw sex value: 'M'
[17:06:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:06:09] ℹ️  AI extracted payer source: 'SWH'
[17:06:09] ℹ️  AI extracted diagnoses:
[17:06:09] ℹ️    - Diagnosis 1: 'I48.92'
[17:06:09] ℹ️    - Diagnosis 2: 'A08.4'
[17:06:09] ℹ️    - Diagnosis 3: 'J18.9'
[17:06:09] ℹ️    - Diagnosis 4: 'G20.A1'
[17:06:09] ℹ️    - Diagnosis 5: 'I48.0'
[17:06:09] ℹ️    - Diagnosis 6: 'E11.22'
[17:06:09] ℹ️  Final extracted MRN: 'MA220722094502'
[17:06:09] ℹ️  Final extracted Sex: 'MALE'
[17:06:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:06:09] ℹ️  Final extracted Payer Source: 'SWH'
[17:06:09] ✅ Patient data extraction completed successfully
[17:06:09] ✅    ✅ Patient data extracted successfully
[17:06:09] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: WILL, CHRISTINE MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 293 S 2nd St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 717-7943
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '07/27/2022', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'G20.A1', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'E11.22'}]
[17:06:09] ✅    ✅ Patient identified: Robert McHale
[17:06:09] ✅    ✅ Patient name validation passed
[17:06:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:09] [DOC: 9208950] ℹ️  DOB normalized: 09/12/1945
[17:06:09] [DOC: 9208950] ℹ️  Episode startOfCare normalized: 07/27/2022
[17:06:09] [DOC: 9208950] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[17:06:09] [DOC: 9208950] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[17:06:09] [DOC: 9208950] ✅ Patient date processing completed successfully
[17:06:09] ✅    ✅ Date processing completed
[17:06:09] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: WILL, CHRISTINE MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 293 S 2nd St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 717-7943
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '07/27/2022', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'G20.A1', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'E11.22'}]
[17:06:09] 🔄 
🔄 Step 4: Extracting order data...
[17:06:12] ℹ️  Order extraction - MRN: 'MA220722094502'
[17:06:12] ℹ️  Order extraction - Sex: 'MALE'
[17:06:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:06:12] ℹ️  Order extraction - Payer Source: 'SWH'
[17:06:12] ✅ Order data extraction completed successfully
[17:06:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:12] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[17:06:12] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:06:12] ℹ️  Payer source consistent in both sources: 'SWH'
[17:06:12] ✅ Patient name cross-validation successful
[17:06:12] ✅    ✅ Data merged successfully
[17:06:13] ✅    ✅ Order data extracted and validated
[17:06:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:22] [DOC: 9208950] ℹ️  Patient not found in cache or API: Robert McHale
[17:06:22] [DOC: 9208950] ℹ️  Patient not found, creating new patient via API...
[17:06:22] [DOC: 9208950] ℹ️  Creating patient via API: Robert McHale
[17:06:23] [DOC: 9208950] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:06:23] ❌    ❌ Failed to create patient
[17:06:23] [DOC: 9208950] ℹ️  API push details saved for document 9208950
================================================================================
║                        Processing Document ID: 9208947                         ║
================================================================================
[17:06:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:06:23] ℹ️  Date: 03/28/2025
[17:06:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:26] [DOC: 9208947] ✅ Text extracted using pdfplumber (19911 chars)
[17:06:26] ✅    ✅ Text extracted using pdfplumber (19911 chars)
[17:06:26] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:29] ℹ️  AI extracted raw sex value: 'M'
[17:06:29] ℹ️  AI extracted service line: 'PT'
[17:06:29] ℹ️  AI extracted payer source: ''
[17:06:29] ℹ️  AI extracted diagnoses:
[17:06:29] ℹ️    - Diagnosis 1: 'Atrial flutter with RVR'
[17:06:29] ℹ️    - Diagnosis 2: 'BLE weakness'
[17:06:29] ℹ️    - Diagnosis 3: 'Parkinsons disease'
[17:06:29] ℹ️    - Diagnosis 4: 'obesity'
[17:06:29] ℹ️    - Diagnosis 5: 'OSA'
[17:06:29] ℹ️    - Diagnosis 6: 'DOE'
[17:06:29] ℹ️  Final extracted MRN: 'MA220722094502'
[17:06:29] ℹ️  Final extracted Sex: 'MALE'
[17:06:29] ℹ️  Final extracted Service Line: 'PT'
[17:06:29] ℹ️  Final extracted Payer Source: ''
[17:06:29] ✅ Patient data extraction completed successfully
[17:06:29] ✅    ✅ Patient data extracted successfully
[17:06:29] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Atrial flutter with RVR', 'secondDiagnosis': 'BLE weakness', 'thirdDiagnosis': 'Parkinsons disease', 'fourthDiagnosis': 'obesity', 'fifthDiagnosis': 'OSA', 'sixthDiagnosis': 'DOE'}]
[17:06:29] ✅    ✅ Patient identified: Robert McHale
[17:06:29] ✅    ✅ Patient name validation passed
[17:06:29] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:29] [DOC: 9208947] ℹ️  DOB normalized: 09/12/1945
[17:06:29] [DOC: 9208947] ℹ️  Episode startOfEpisode normalized: 01/03/2025
[17:06:29] [DOC: 9208947] ✅ Patient date processing completed successfully
[17:06:29] ✅    ✅ Date processing completed
[17:06:29] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Atrial flutter with RVR', 'secondDiagnosis': 'BLE weakness', 'thirdDiagnosis': 'Parkinsons disease', 'fourthDiagnosis': 'obesity', 'fifthDiagnosis': 'OSA', 'sixthDiagnosis': 'DOE'}]
[17:06:29] 🔄 
🔄 Step 4: Extracting order data...
[17:06:32] ℹ️  Order extraction - MRN: 'MA220722094502'
[17:06:32] ℹ️  Order extraction - Sex: 'MALE'
[17:06:32] ℹ️  Order extraction - Service Line: 'PT'
[17:06:32] ℹ️  Order extraction - Payer Source: ''
[17:06:32] ✅ Order data extraction completed successfully
[17:06:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:32] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[17:06:32] ℹ️  Service line consistent in both sources: 'PT'
[17:06:32] ✅ Patient name cross-validation successful
[17:06:32] ✅    ✅ Data merged successfully
[17:06:34] ✅    ✅ Order data extracted and validated
[17:06:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:43] [DOC: 9208947] ℹ️  Patient not found in cache or API: Robert McHale
[17:06:43] [DOC: 9208947] ℹ️  Patient not found, creating new patient via API...
[17:06:43] [DOC: 9208947] ℹ️  Creating patient via API: Robert McHale
[17:06:45] [DOC: 9208947] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:06:45] ❌    ❌ Failed to create patient
[17:06:45] [DOC: 9208947] ℹ️  API push details saved for document 9208947
================================================================================
║                        Processing Document ID: 9208563                         ║
================================================================================
[17:06:45] ℹ️  Agency: Dartmouth HH
[17:06:45] ℹ️  Date: 03/28/2025
[17:06:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:47] [DOC: 9208563] ✅ Text extracted using pdfplumber (1321 chars)
[17:06:47] ✅    ✅ Text extracted using pdfplumber (1321 chars)
[17:06:47] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:49] ℹ️  AI extracted raw sex value: 'F'
[17:06:49] ℹ️  AI extracted service line: 'RN, LPN'
[17:06:49] ℹ️  AI extracted payer source: 'Fallon Health'
[17:06:49] ℹ️  AI extracted diagnoses:
[17:06:49] ℹ️    - Diagnosis 1: 'None'
[17:06:49] ℹ️    - Diagnosis 2: 'None'
[17:06:49] ℹ️    - Diagnosis 3: 'None'
[17:06:49] ℹ️    - Diagnosis 4: 'None'
[17:06:49] ℹ️    - Diagnosis 5: 'None'
[17:06:49] ℹ️    - Diagnosis 6: 'None'
[17:06:49] ℹ️  Final extracted MRN: '4034011'
[17:06:49] ℹ️  Final extracted Sex: 'FEMALE'
[17:06:49] ℹ️  Final extracted Service Line: 'RN, LPN'
[17:06:49] ℹ️  Final extracted Payer Source: 'Fallon Health'
[17:06:49] ✅ Patient data extraction completed successfully
[17:06:49] ✅    ✅ Patient data extracted successfully
[17:06:49] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:06:49] ✅    ✅ Patient identified: Joan Swift
[17:06:49] ✅    ✅ Patient name validation passed
[17:06:49] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:49] [DOC: 9208563] ℹ️  DOB normalized: 05/05/1943
[17:06:49] [DOC: 9208563] ℹ️  Episode startOfCare normalized: 01/08/2025
[17:06:49] [DOC: 9208563] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[17:06:49] [DOC: 9208563] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[17:06:49] [DOC: 9208563] ✅ Patient date processing completed successfully
[17:06:49] ✅    ✅ Date processing completed
[17:06:49] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025'}]
[17:06:49] 🔄 
🔄 Step 4: Extracting order data...
[17:06:52] ℹ️  Order extraction - MRN: ''
[17:06:52] ℹ️  Order extraction - Sex: 'FEMALE'
[17:06:52] ℹ️  Order extraction - Service Line: 'RN, LPN'
[17:06:52] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[17:06:52] ✅ Order data extraction completed successfully
[17:06:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:52] ℹ️  Using MRN from patient data: '4034011'
[17:06:52] ℹ️  Service line consistent in both sources: 'RN, LPN'
[17:06:52] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[17:06:52] ✅ Patient name cross-validation successful
[17:06:52] ✅    ✅ Data merged successfully
[17:06:53] ✅    ✅ Order data extracted and validated
[17:06:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:53] [DOC: 9208563] ✅ Patient found in local cache: Joan Swift, ID: e83d8c65-60ef-4130-a086-35a05793cc68
[17:06:53] ✅    ✅ Existing patient found with ID: e83d8c65-60ef-4130-a086-35a05793cc68
[17:06:53] 🔄 
🔄 Step 6: Pushing order to API...
[17:06:53] [DOC: 9208563] ℹ️  Pushing order via API for patient ID: e83d8c65-60ef-4130-a086-35a05793cc68
[17:06:54] [DOC: 9208563] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14468"}
[17:06:54] ❌    ❌ Failed to push order
[17:06:54] 🔄 
🔄 Step 7: Writing to CSV...
[17:06:54] [DOC: 9208563] ℹ️  Calculated age: 82 from DOB: 05/05/1943
[17:06:54] [DOC: 9208563] ℹ️  Service Line extracted: 'RN, LPN'
[17:06:54] [DOC: 9208563] ℹ️  Payer Source extracted: 'Fallon Health'
[17:06:54] [DOC: 9208563] ℹ️  Diagnosis codes being written:
[17:06:54] [DOC: 9208563] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:06:54] [DOC: 9208563] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:06:54] [DOC: 9208563] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:06:54] [DOC: 9208563] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:06:54] [DOC: 9208563] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:06:54] [DOC: 9208563] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:06:54] [DOC: 9208563] ✅ Patient data written to CSV: Joan Swift | Sex: FEMALE | Age: 82 | Service: RN, LPN | Payer: Fallon Health | MRN: 4034011
[17:06:54] ✅    ✅ Document 9208563 processed and saved successfully
[17:06:54] 🔄 
🔄 Step 8: Saving API details...
[17:06:54] [DOC: 9208563] ℹ️  API push details saved for document 9208563
[17:06:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208415                         ║
================================================================================
[17:06:54] ℹ️  Agency: Dartmouth HH
[17:06:54] ℹ️  Date: 03/28/2025
[17:06:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:56] [DOC: 9208415] ✅ Text extracted using pdfplumber (1060 chars)
[17:06:56] ✅    ✅ Text extracted using pdfplumber (1060 chars)
[17:06:56] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:59] ℹ️  AI extracted raw sex value: 'M'
[17:06:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:06:59] ℹ️  AI extracted payer source: 'Medicare'
[17:06:59] ℹ️  AI extracted diagnoses:
[17:06:59] ℹ️    - Diagnosis 1: ''
[17:06:59] ℹ️    - Diagnosis 2: ''
[17:06:59] ℹ️    - Diagnosis 3: ''
[17:06:59] ℹ️    - Diagnosis 4: ''
[17:06:59] ℹ️    - Diagnosis 5: ''
[17:06:59] ℹ️    - Diagnosis 6: ''
[17:06:59] ℹ️  Final extracted MRN: '2731011'
[17:06:59] ℹ️  Final extracted Sex: 'MALE'
[17:06:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:06:59] ℹ️  Final extracted Payer Source: 'Medicare'
[17:06:59] ✅ Patient data extraction completed successfully
[17:06:59] ✅    ✅ Patient data extracted successfully
[17:06:59] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 3266 Acushnet Ave Apt 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:06:59] ✅    ✅ Patient identified: Paul Penha
[17:06:59] ✅    ✅ Patient name validation passed
[17:06:59] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:59] [DOC: 9208415] ℹ️  DOB normalized: 07/08/1934
[17:06:59] [DOC: 9208415] ℹ️  Episode startOfCare normalized: 02/02/2025
[17:06:59] [DOC: 9208415] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[17:06:59] [DOC: 9208415] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[17:06:59] [DOC: 9208415] ✅ Patient date processing completed successfully
[17:06:59] ✅    ✅ Date processing completed
[17:06:59] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 3266 Acushnet Ave Apt 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:06:59] 🔄 
🔄 Step 4: Extracting order data...
[17:07:01] ℹ️  Order extraction - MRN: ''
[17:07:01] ℹ️  Order extraction - Sex: 'MALE'
[17:07:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:07:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:07:01] ✅ Order data extraction completed successfully
[17:07:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:01] ℹ️  Using MRN from patient data: '2731011'
[17:07:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:07:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:07:01] ✅ Patient name cross-validation successful
[17:07:01] ✅    ✅ Data merged successfully
[17:07:02] ✅    ✅ Order data extracted and validated
[17:07:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:02] [DOC: 9208415] ✅ Patient found in local cache: Paul Penha, ID: acd1fced-75ff-43a8-8304-4681296c9d26
[17:07:02] ✅    ✅ Existing patient found with ID: acd1fced-75ff-43a8-8304-4681296c9d26
[17:07:02] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:02] [DOC: 9208415] ℹ️  Pushing order via API for patient ID: acd1fced-75ff-43a8-8304-4681296c9d26
[17:07:03] [DOC: 9208415] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:07:03] ❌    ❌ Failed to push order
[17:07:03] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:03] [DOC: 9208415] ℹ️  Calculated age: 90 from DOB: 07/08/1934
[17:07:03] [DOC: 9208415] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:07:03] [DOC: 9208415] ℹ️  Payer Source extracted: 'Medicare'
[17:07:03] [DOC: 9208415] ℹ️  Diagnosis codes being written:
[17:07:03] [DOC: 9208415] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:07:03] [DOC: 9208415] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:07:03] [DOC: 9208415] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:03] [DOC: 9208415] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:03] [DOC: 9208415] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:03] [DOC: 9208415] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:03] [DOC: 9208415] ✅ Patient data written to CSV: Paul Penha | Sex: MALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: 2731011
[17:07:03] ✅    ✅ Document 9208415 processed and saved successfully
[17:07:03] 🔄 
🔄 Step 8: Saving API details...
[17:07:03] [DOC: 9208415] ℹ️  API push details saved for document 9208415
[17:07:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208412                         ║
================================================================================
[17:07:03] ℹ️  Agency: Dartmouth HH
[17:07:03] ℹ️  Date: 03/28/2025
[17:07:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:05] [DOC: 9208412] ✅ Text extracted using pdfplumber (3592 chars)
[17:07:05] ✅    ✅ Text extracted using pdfplumber (3592 chars)
[17:07:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:08] ℹ️  AI extracted raw sex value: 'F'
[17:07:08] ℹ️  AI extracted service line: 'Physical Therapy'
[17:07:08] ℹ️  AI extracted payer source: 'Medicare'
[17:07:08] ℹ️  AI extracted diagnoses:
[17:07:08] ℹ️    - Diagnosis 1: ''
[17:07:08] ℹ️    - Diagnosis 2: ''
[17:07:08] ℹ️    - Diagnosis 3: ''
[17:07:08] ℹ️    - Diagnosis 4: ''
[17:07:08] ℹ️    - Diagnosis 5: ''
[17:07:08] ℹ️    - Diagnosis 6: ''
[17:07:08] ℹ️  Final extracted MRN: '4651015'
[17:07:08] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:07:08] ℹ️  Final extracted Payer Source: 'Medicare'
[17:07:08] ✅ Patient data extraction completed successfully
[17:07:08] ✅    ✅ Patient data extracted successfully
[17:07:08] 📊 Patient Response
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:08] ✅    ✅ Patient identified: Lisa Pavao
[17:07:08] ✅    ✅ Patient name validation passed
[17:07:08] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:08] [DOC: 9208412] ℹ️  DOB normalized: 06/09/1966
[17:07:08] [DOC: 9208412] ℹ️  Episode startOfCare normalized: 01/06/2025
[17:07:08] [DOC: 9208412] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[17:07:08] [DOC: 9208412] ℹ️  Episode endOfEpisode normalized: 03/06/2025
[17:07:08] [DOC: 9208412] ✅ Patient date processing completed successfully
[17:07:08] ✅    ✅ Date processing completed
[17:07:08] 📊 Processed Patient Data
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/06/2025', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:08] 🔄 
🔄 Step 4: Extracting order data...
[17:07:11] ℹ️  Order extraction - MRN: ''
[17:07:11] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:11] ℹ️  Order extraction - Service Line: 'PT, HHA'
[17:07:11] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:07:11] ✅ Order data extraction completed successfully
[17:07:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:11] ℹ️  Using MRN from patient data: '4651015'
[17:07:11] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT, HHA' = 'HHA, PT, Physical Therapy'
[17:07:11] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:07:11] ✅ Patient name cross-validation successful
[17:07:11] ✅    ✅ Data merged successfully
[17:07:12] ✅    ✅ Order data extracted and validated
[17:07:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:18] [DOC: 9208412] ✅ Patient exists in API: Lisa Pavao, ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[17:07:18] ✅    ✅ Existing patient found with ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[17:07:18] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:18] [DOC: 9208412] ℹ️  Pushing order via API for patient ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[17:07:19] [DOC: 9208412] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:07:19] ❌    ❌ Failed to push order
[17:07:19] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:19] [DOC: 9208412] ℹ️  Calculated age: 58 from DOB: 06/09/1966
[17:07:19] [DOC: 9208412] ℹ️  Service Line extracted: 'HHA, PT, Physical Therapy'
[17:07:19] [DOC: 9208412] ℹ️  Payer Source extracted: 'Medicare'
[17:07:19] [DOC: 9208412] ℹ️  Diagnosis codes being written:
[17:07:19] [DOC: 9208412] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:07:19] [DOC: 9208412] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:07:19] [DOC: 9208412] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:19] [DOC: 9208412] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:19] [DOC: 9208412] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:19] [DOC: 9208412] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:19] [DOC: 9208412] ✅ Patient data written to CSV: Lisa Pavao | Sex: FEMALE | Age: 58 | Service: HHA, PT, Physical Therapy | Payer: Medicare | MRN: 4651015
[17:07:19] ✅    ✅ Document 9208412 processed and saved successfully
[17:07:19] 🔄 
🔄 Step 8: Saving API details...
[17:07:19] [DOC: 9208412] ℹ️  API push details saved for document 9208412
[17:07:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208396                         ║
================================================================================
[17:07:19] ℹ️  Agency: Dartmouth HH
[17:07:19] ℹ️  Date: 03/28/2025
[17:07:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:21] [DOC: 9208396] ✅ Text extracted using pdfplumber (6298 chars)
[17:07:21] ✅    ✅ Text extracted using pdfplumber (6298 chars)
[17:07:21] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:24] ℹ️  AI extracted raw sex value: 'F'
[17:07:24] ℹ️  AI extracted service line: 'PT, OT'
[17:07:24] ℹ️  AI extracted payer source: 'Medicare'
[17:07:24] ℹ️  AI extracted diagnoses:
[17:07:24] ℹ️    - Diagnosis 1: 'COPD'
[17:07:24] ℹ️    - Diagnosis 2: 'hypertension'
[17:07:24] ℹ️    - Diagnosis 3: ''
[17:07:24] ℹ️    - Diagnosis 4: ''
[17:07:24] ℹ️    - Diagnosis 5: ''
[17:07:24] ℹ️    - Diagnosis 6: ''
[17:07:24] ℹ️  Final extracted MRN: '5240015'
[17:07:24] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:24] ℹ️  Final extracted Service Line: 'PT, OT'
[17:07:24] ℹ️  Final extracted Payer Source: 'Medicare'
[17:07:24] ✅ Patient data extraction completed successfully
[17:07:24] ✅    ✅ Patient data extracted successfully
[17:07:24] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'hypertension', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:24] ✅    ✅ Patient identified: Donna Cabral
[17:07:24] ✅    ✅ Patient name validation passed
[17:07:24] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:24] [DOC: 9208396] ℹ️  DOB normalized: 10/03/1947
[17:07:24] [DOC: 9208396] ℹ️  Episode startOfCare normalized: 09/18/2024
[17:07:24] [DOC: 9208396] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[17:07:24] [DOC: 9208396] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:07:24] [DOC: 9208396] ✅ Patient date processing completed successfully
[17:07:24] ✅    ✅ Date processing completed
[17:07:24] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'hypertension', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:24] 🔄 
🔄 Step 4: Extracting order data...
[17:07:27] ℹ️  Order extraction - MRN: '5240015'
[17:07:27] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:27] ℹ️  Order extraction - Service Line: 'PT, OT'
[17:07:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:07:27] ✅ Order data extraction completed successfully
[17:07:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:27] ℹ️  Using MRN from patient data: '5240015' over '5240015'
[17:07:27] ℹ️  Service line consistent in both sources: 'PT, OT'
[17:07:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:07:27] ✅ Patient name cross-validation successful
[17:07:27] ✅    ✅ Data merged successfully
[17:07:28] ✅    ✅ Order data extracted and validated
[17:07:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:28] [DOC: 9208396] ✅ Patient found in local cache: Donna Cabral, ID: 79190189-814f-4114-a438-904080ae2281
[17:07:28] ✅    ✅ Existing patient found with ID: 79190189-814f-4114-a438-904080ae2281
[17:07:28] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:28] [DOC: 9208396] ℹ️  Pushing order via API for patient ID: 79190189-814f-4114-a438-904080ae2281
[17:07:29] [DOC: 9208396] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:07:29] ❌    ❌ Failed to push order
[17:07:29] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:29] [DOC: 9208396] ℹ️  Calculated age: 77 from DOB: 10/03/1947
[17:07:29] [DOC: 9208396] ℹ️  Service Line extracted: 'PT, OT'
[17:07:29] [DOC: 9208396] ℹ️  Payer Source extracted: 'Medicare'
[17:07:29] [DOC: 9208396] ℹ️  Diagnosis codes being written:
[17:07:29] [DOC: 9208396] ℹ️    - Latest_Episode_Firstdiagnosis: 'COPD'
[17:07:29] [DOC: 9208396] ℹ️    - Latest_Episode_Seconddiagnosis: 'hypertension'
[17:07:29] [DOC: 9208396] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:29] [DOC: 9208396] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:29] [DOC: 9208396] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:29] [DOC: 9208396] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:29] [DOC: 9208396] ✅ Patient data written to CSV: Donna Cabral | Sex: FEMALE | Age: 77 | Service: PT, OT | Payer: Medicare | MRN: 5240015
[17:07:29] ✅    ✅ Document 9208396 processed and saved successfully
[17:07:29] 🔄 
🔄 Step 8: Saving API details...
[17:07:29] [DOC: 9208396] ℹ️  API push details saved for document 9208396
[17:07:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208392                         ║
================================================================================
[17:07:29] ℹ️  Agency: Dartmouth HH
[17:07:29] ℹ️  Date: 03/28/2025
[17:07:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:31] [DOC: 9208392] ✅ Text extracted using pdfplumber (1545 chars)
[17:07:31] ✅    ✅ Text extracted using pdfplumber (1545 chars)
[17:07:31] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:34] ℹ️  AI extracted raw sex value: 'M'
[17:07:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:07:34] ℹ️  AI extracted payer source: 'Medicare'
[17:07:34] ℹ️  AI extracted diagnoses:
[17:07:34] ℹ️    - Diagnosis 1: ''
[17:07:34] ℹ️    - Diagnosis 2: ''
[17:07:34] ℹ️    - Diagnosis 3: ''
[17:07:34] ℹ️    - Diagnosis 4: ''
[17:07:34] ℹ️    - Diagnosis 5: ''
[17:07:34] ℹ️    - Diagnosis 6: ''
[17:07:34] ℹ️  Final extracted MRN: '842002'
[17:07:34] ℹ️  Final extracted Sex: 'MALE'
[17:07:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:07:34] ℹ️  Final extracted Payer Source: 'Medicare'
[17:07:34] ✅ Patient data extraction completed successfully
[17:07:34] ✅    ✅ Patient data extracted successfully
[17:07:34] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:34] ✅    ✅ Patient identified: Johannes Bjornson
[17:07:34] ✅    ✅ Patient name validation passed
[17:07:34] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:34] [DOC: 9208392] ℹ️  DOB normalized: 02/09/1942
[17:07:34] [DOC: 9208392] ℹ️  Episode startOfCare normalized: 10/10/2024
[17:07:34] [DOC: 9208392] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[17:07:34] [DOC: 9208392] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[17:07:34] [DOC: 9208392] ✅ Patient date processing completed successfully
[17:07:34] ✅    ✅ Date processing completed
[17:07:34] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:34] 🔄 
🔄 Step 4: Extracting order data...
[17:07:37] ℹ️  Order extraction - MRN: ''
[17:07:37] ℹ️  Order extraction - Sex: 'MALE'
[17:07:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:07:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:07:37] ✅ Order data extraction completed successfully
[17:07:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:37] ℹ️  Using MRN from patient data: '842002'
[17:07:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:07:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:07:37] ✅ Patient name cross-validation successful
[17:07:37] ✅    ✅ Data merged successfully
[17:07:38] ✅    ✅ Order data extracted and validated
[17:07:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:38] [DOC: 9208392] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[17:07:38] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[17:07:38] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:38] [DOC: 9208392] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[17:07:39] [DOC: 9208392] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[17:07:39] ❌    ❌ Failed to push order
[17:07:39] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:39] [DOC: 9208392] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[17:07:39] [DOC: 9208392] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:07:39] [DOC: 9208392] ℹ️  Payer Source extracted: 'Medicare'
[17:07:39] [DOC: 9208392] ℹ️  Diagnosis codes being written:
[17:07:39] [DOC: 9208392] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:07:39] [DOC: 9208392] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:07:39] [DOC: 9208392] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:39] [DOC: 9208392] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:39] [DOC: 9208392] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:39] [DOC: 9208392] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:39] [DOC: 9208392] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 842002
[17:07:39] ✅    ✅ Document 9208392 processed and saved successfully
[17:07:39] 🔄 
🔄 Step 8: Saving API details...
[17:07:39] [DOC: 9208392] ℹ️  API push details saved for document 9208392
[17:07:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208364                         ║
================================================================================
[17:07:39] ℹ️  Agency: Dartmouth HH
[17:07:39] ℹ️  Date: 03/28/2025
[17:07:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:41] [DOC: 9208364] ✅ Text extracted using pdfplumber (1467 chars)
[17:07:41] ✅    ✅ Text extracted using pdfplumber (1467 chars)
[17:07:41] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:44] ℹ️  AI extracted raw sex value: 'F'
[17:07:44] ℹ️  AI extracted service line: 'RN, HHA'
[17:07:44] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[17:07:44] ℹ️  AI extracted diagnoses:
[17:07:44] ℹ️    - Diagnosis 1: ''
[17:07:44] ℹ️    - Diagnosis 2: ''
[17:07:44] ℹ️    - Diagnosis 3: ''
[17:07:44] ℹ️    - Diagnosis 4: ''
[17:07:44] ℹ️    - Diagnosis 5: ''
[17:07:44] ℹ️    - Diagnosis 6: ''
[17:07:44] ℹ️  Final extracted MRN: '6066015'
[17:07:44] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:44] ℹ️  Final extracted Service Line: 'RN, HHA'
[17:07:44] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[17:07:44] ✅ Patient data extraction completed successfully
[17:07:44] ✅    ✅ Patient data extracted successfully
[17:07:44] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:44] ✅    ✅ Patient identified: Lois Fernandes
[17:07:44] ✅    ✅ Patient name validation passed
[17:07:44] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:44] [DOC: 9208364] ℹ️  DOB normalized: 05/15/1941
[17:07:44] [DOC: 9208364] ℹ️  Episode startOfCare normalized: 02/22/2025
[17:07:44] [DOC: 9208364] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[17:07:44] [DOC: 9208364] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[17:07:44] [DOC: 9208364] ✅ Patient date processing completed successfully
[17:07:44] ✅    ✅ Date processing completed
[17:07:44] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:44] 🔄 
🔄 Step 4: Extracting order data...
[17:07:47] ℹ️  Order extraction - MRN: '6066015'
[17:07:47] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:47] ℹ️  Order extraction - Service Line: 'RN'
[17:07:47] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[17:07:47] ✅ Order data extraction completed successfully
[17:07:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:47] ℹ️  Using MRN from patient data: '6066015' over '6066015'
[17:07:47] ℹ️  Combined service lines: Patient='RN, HHA' + Order='RN' = 'HHA, RN'
[17:07:47] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[17:07:47] ✅ Patient name cross-validation successful
[17:07:47] ✅    ✅ Data merged successfully
[17:07:48] ✅    ✅ Order data extracted and validated
[17:07:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:48] [DOC: 9208364] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[17:07:48] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[17:07:48] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:48] [DOC: 9208364] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[17:07:49] [DOC: 9208364] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:07:49] ❌    ❌ Failed to push order
[17:07:49] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:49] [DOC: 9208364] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[17:07:49] [DOC: 9208364] ℹ️  Service Line extracted: 'HHA, RN'
[17:07:49] [DOC: 9208364] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[17:07:49] [DOC: 9208364] ℹ️  Diagnosis codes being written:
[17:07:49] [DOC: 9208364] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:07:49] [DOC: 9208364] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:07:49] [DOC: 9208364] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:49] [DOC: 9208364] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:49] [DOC: 9208364] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:49] [DOC: 9208364] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:49] [DOC: 9208364] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: HHA, RN | Payer: Blue Cross Medicare Adv | MRN: 6066015
[17:07:49] ✅    ✅ Document 9208364 processed and saved successfully
[17:07:49] 🔄 
🔄 Step 8: Saving API details...
[17:07:49] [DOC: 9208364] ℹ️  API push details saved for document 9208364
[17:07:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208363                         ║
================================================================================
[17:07:49] ℹ️  Agency: Dartmouth HH
[17:07:49] ℹ️  Date: 03/28/2025
[17:07:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:52] [DOC: 9208363] ✅ Text extracted using pdfplumber (17459 chars)
[17:07:52] ✅    ✅ Text extracted using pdfplumber (17447 chars)
[17:07:52] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:55] ℹ️  AI extracted raw sex value: 'F'
[17:07:55] ℹ️  AI extracted service line: 'PT'
[17:07:55] ℹ️  AI extracted payer source: 'None'
[17:07:55] ℹ️  AI extracted diagnoses:
[17:07:55] ℹ️    - Diagnosis 1: 'N39.0'
[17:07:55] ℹ️    - Diagnosis 2: 'B96.20'
[17:07:55] ℹ️    - Diagnosis 3: 'R29.6'
[17:07:55] ℹ️    - Diagnosis 4: 'M17.12'
[17:07:55] ℹ️    - Diagnosis 5: 'E11.43'
[17:07:55] ℹ️    - Diagnosis 6: 'K31.84'
[17:07:55] ℹ️  Final extracted MRN: '3649009'
[17:07:55] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:55] ℹ️  Final extracted Service Line: 'PT'
[17:07:55] ℹ️  Final extracted Payer Source: ''
[17:07:55] ✅ Patient data extraction completed successfully
[17:07:55] ✅    ✅ Patient data extracted successfully
[17:07:55] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'M17.12', 'fifthDiagnosis': 'E11.43', 'sixthDiagnosis': 'K31.84'}]
[17:07:55] ✅    ✅ Patient identified: Dorothy Fernandes
[17:07:55] ✅    ✅ Patient name validation passed
[17:07:55] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:55] [DOC: 9208363] ℹ️  DOB normalized: 10/01/1937
[17:07:55] [DOC: 9208363] ℹ️  Episode startOfCare normalized: 03/22/2025
[17:07:55] [DOC: 9208363] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[17:07:55] [DOC: 9208363] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[17:07:55] [DOC: 9208363] ✅ Patient date processing completed successfully
[17:07:55] ✅    ✅ Date processing completed
[17:07:55] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'M17.12', 'fifthDiagnosis': 'E11.43', 'sixthDiagnosis': 'K31.84'}]
[17:07:55] 🔄 
🔄 Step 4: Extracting order data...
[17:07:58] ℹ️  Order extraction - MRN: '3649009'
[17:07:58] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:58] ℹ️  Order extraction - Service Line: 'PT'
[17:07:58] ℹ️  Order extraction - Payer Source: ''
[17:07:58] ✅ Order data extraction completed successfully
[17:07:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:58] ℹ️  Using MRN from patient data: '3649009' over '3649009'
[17:07:58] ℹ️  Service line consistent in both sources: 'PT'
[17:07:58] ✅ Patient name cross-validation successful
[17:07:58] ✅    ✅ Data merged successfully
[17:07:59] ✅    ✅ Order data extracted and validated
[17:07:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:59] [DOC: 9208363] ✅ Patient found in local cache: Dorothy Fernandes, ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[17:07:59] ✅    ✅ Existing patient found with ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[17:07:59] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:59] [DOC: 9208363] ℹ️  Pushing order via API for patient ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[17:08:00] [DOC: 9208363] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:08:00] ❌    ❌ Failed to push order
[17:08:00] 🔄 
🔄 Step 7: Writing to CSV...
[17:08:00] [DOC: 9208363] ℹ️  Calculated age: 87 from DOB: 10/01/1937
[17:08:00] [DOC: 9208363] ℹ️  Service Line extracted: 'PT'
[17:08:00] [DOC: 9208363] ℹ️  Payer Source extracted: ''
[17:08:00] [DOC: 9208363] ℹ️  Diagnosis codes being written:
[17:08:00] [DOC: 9208363] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[17:08:00] [DOC: 9208363] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.20'
[17:08:00] [DOC: 9208363] ℹ️    - Latest_Episode_Thirddiagnosis: 'R29.6'
[17:08:00] [DOC: 9208363] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M17.12'
[17:08:00] [DOC: 9208363] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.43'
[17:08:00] [DOC: 9208363] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K31.84'
[17:08:00] [DOC: 9208363] ✅ Patient data written to CSV: Dorothy Fernandes | Sex: FEMALE | Age: 87 | Service: PT | Payer:  | MRN: 3649009
[17:08:00] ✅    ✅ Document 9208363 processed and saved successfully
[17:08:00] 🔄 
🔄 Step 8: Saving API details...
[17:08:00] [DOC: 9208363] ℹ️  API push details saved for document 9208363
[17:08:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208358                         ║
================================================================================
[17:08:00] ℹ️  Agency: Dartmouth HH
[17:08:00] ℹ️  Date: 03/28/2025
[17:08:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:02] [DOC: 9208358] ✅ Text extracted using pdfplumber (1555 chars)
[17:08:02] ✅    ✅ Text extracted using pdfplumber (1555 chars)
[17:08:02] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:05] ℹ️  AI extracted raw sex value: 'F'
[17:08:05] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[17:08:05] ℹ️  AI extracted payer source: 'Medicare'
[17:08:05] ℹ️  AI extracted diagnoses:
[17:08:05] ℹ️    - Diagnosis 1: 'None'
[17:08:05] ℹ️    - Diagnosis 2: 'None'
[17:08:05] ℹ️    - Diagnosis 3: 'None'
[17:08:05] ℹ️    - Diagnosis 4: 'None'
[17:08:05] ℹ️    - Diagnosis 5: 'None'
[17:08:05] ℹ️    - Diagnosis 6: 'None'
[17:08:05] ℹ️  Final extracted MRN: '4799015'
[17:08:05] ℹ️  Final extracted Sex: 'FEMALE'
[17:08:05] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[17:08:05] ℹ️  Final extracted Payer Source: 'Medicare'
[17:08:05] ✅ Patient data extraction completed successfully
[17:08:05] ✅    ✅ Patient data extracted successfully
[17:08:05] 📊 Patient Response
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:08:05] ✅    ✅ Patient identified: Agatina Manna
[17:08:05] ✅    ✅ Patient name validation passed
[17:08:05] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:05] [DOC: 9208358] ℹ️  DOB normalized: 03/10/1937
[17:08:05] [DOC: 9208358] ℹ️  Episode startOfCare normalized: 11/17/2024
[17:08:05] [DOC: 9208358] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[17:08:05] [DOC: 9208358] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:08:05] [DOC: 9208358] ✅ Patient date processing completed successfully
[17:08:05] ✅    ✅ Date processing completed
[17:08:05] 📊 Processed Patient Data
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025'}]
[17:08:05] 🔄 
🔄 Step 4: Extracting order data...
[17:08:07] ℹ️  Order extraction - MRN: '4799015'
[17:08:07] ℹ️  Order extraction - Sex: 'FEMALE'
[17:08:07] ℹ️  Order extraction - Service Line: 'RN'
[17:08:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:08:07] ✅ Order data extraction completed successfully
[17:08:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:07] ℹ️  Using MRN from patient data: '4799015' over '4799015'
[17:08:07] ℹ️  Combined service lines: Patient='Skilled Nursing, HHA' + Order='RN' = 'HHA, RN, Skilled Nursing'
[17:08:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:08:07] ✅ Patient name cross-validation successful
[17:08:07] ✅    ✅ Data merged successfully
[17:08:09] ✅    ✅ Order data extracted and validated
[17:08:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:09] [DOC: 9208358] ✅ Patient found in local cache: Agatina Manna, ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[17:08:09] ✅    ✅ Existing patient found with ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[17:08:09] 🔄 
🔄 Step 6: Pushing order to API...
[17:08:09] [DOC: 9208358] ℹ️  Pushing order via API for patient ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[17:08:10] [DOC: 9208358] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:08:10] ❌    ❌ Failed to push order
[17:08:10] 🔄 
🔄 Step 7: Writing to CSV...
[17:08:10] [DOC: 9208358] ℹ️  Calculated age: 88 from DOB: 03/10/1937
[17:08:10] [DOC: 9208358] ℹ️  Service Line extracted: 'HHA, RN, Skilled Nursing'
[17:08:10] [DOC: 9208358] ℹ️  Payer Source extracted: 'Medicare'
[17:08:10] [DOC: 9208358] ℹ️  Diagnosis codes being written:
[17:08:10] [DOC: 9208358] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:08:10] [DOC: 9208358] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:08:10] [DOC: 9208358] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:08:10] [DOC: 9208358] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:08:10] [DOC: 9208358] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:08:10] [DOC: 9208358] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:08:10] [DOC: 9208358] ✅ Patient data written to CSV: Agatina Manna | Sex: FEMALE | Age: 88 | Service: HHA, RN, Skilled Nursing | Payer: Medicare | MRN: 4799015
[17:08:10] ✅    ✅ Document 9208358 processed and saved successfully
[17:08:10] 🔄 
🔄 Step 8: Saving API details...
[17:08:10] [DOC: 9208358] ℹ️  API push details saved for document 9208358
[17:08:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208357                         ║
================================================================================
[17:08:10] ℹ️  Agency: Dartmouth HH
[17:08:10] ℹ️  Date: 03/28/2025
[17:08:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:12] [DOC: 9208357] ✅ Text extracted using pdfplumber (2372 chars)
[17:08:12] ✅    ✅ Text extracted using pdfplumber (2372 chars)
[17:08:12] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:14] ℹ️  AI extracted raw sex value: 'M'
[17:08:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:08:14] ℹ️  AI extracted payer source: 'Medicare'
[17:08:14] ℹ️  AI extracted diagnoses:
[17:08:14] ℹ️    - Diagnosis 1: ''
[17:08:14] ℹ️    - Diagnosis 2: ''
[17:08:14] ℹ️    - Diagnosis 3: ''
[17:08:14] ℹ️    - Diagnosis 4: ''
[17:08:14] ℹ️    - Diagnosis 5: ''
[17:08:14] ℹ️    - Diagnosis 6: ''
[17:08:14] ℹ️  Final extracted MRN: '1452015'
[17:08:14] ℹ️  Final extracted Sex: 'MALE'
[17:08:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:08:14] ℹ️  Final extracted Payer Source: 'Medicare'
[17:08:14] ✅ Patient data extraction completed successfully
[17:08:14] ✅    ✅ Patient data extracted successfully
[17:08:14] 📊 Patient Response
     └─ patientFName: Normand
     └─ patientLName: Paquette
     └─ dob: 08/20/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1452015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:14] ✅    ✅ Patient identified: Normand Paquette
[17:08:14] ✅    ✅ Patient name validation passed
[17:08:14] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:14] [DOC: 9208357] ℹ️  DOB normalized: 08/20/1935
[17:08:14] [DOC: 9208357] ℹ️  Episode startOfCare normalized: 02/16/2025
[17:08:14] [DOC: 9208357] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[17:08:14] [DOC: 9208357] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[17:08:14] [DOC: 9208357] ✅ Patient date processing completed successfully
[17:08:14] ✅    ✅ Date processing completed
[17:08:14] 📊 Processed Patient Data
     └─ patientFName: Normand
     └─ patientLName: Paquette
     └─ dob: 08/20/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1452015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2025', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:14] 🔄 
🔄 Step 4: Extracting order data...
[17:08:17] ℹ️  Order extraction - MRN: ''
[17:08:17] ℹ️  Order extraction - Sex: 'MALE'
[17:08:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[17:08:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:08:17] ✅ Order data extraction completed successfully
[17:08:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:17] ℹ️  Using MRN from patient data: '1452015'
[17:08:17] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT' = 'PT, Skilled Nursing'
[17:08:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:08:17] ✅ Patient name cross-validation successful
[17:08:17] ✅    ✅ Data merged successfully
[17:08:18] ✅    ✅ Order data extracted and validated
[17:08:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:27] [DOC: 9208357] ✅ Patient exists in API: Normand Paquette, ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[17:08:27] ✅    ✅ Existing patient found with ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[17:08:27] 🔄 
🔄 Step 6: Pushing order to API...
[17:08:27] [DOC: 9208357] ℹ️  Pushing order via API for patient ID: b6687cc1-af5e-4159-aaba-2ccecfe7f0bf
[17:08:28] [DOC: 9208357] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:08:28] ❌    ❌ Failed to push order
[17:08:28] 🔄 
🔄 Step 7: Writing to CSV...
[17:08:28] [DOC: 9208357] ℹ️  Calculated age: 89 from DOB: 08/20/1935
[17:08:28] [DOC: 9208357] ℹ️  Service Line extracted: 'PT, Skilled Nursing'
[17:08:28] [DOC: 9208357] ℹ️  Payer Source extracted: 'Medicare'
[17:08:28] [DOC: 9208357] ℹ️  Diagnosis codes being written:
[17:08:28] [DOC: 9208357] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:08:28] [DOC: 9208357] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:08:28] [DOC: 9208357] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:08:28] [DOC: 9208357] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:08:28] [DOC: 9208357] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:08:28] [DOC: 9208357] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:08:28] [DOC: 9208357] ✅ Patient data written to CSV: Normand Paquette | Sex: MALE | Age: 89 | Service: PT, Skilled Nursing | Payer: Medicare | MRN: 1452015
[17:08:28] ✅    ✅ Document 9208357 processed and saved successfully
[17:08:28] 🔄 
🔄 Step 8: Saving API details...
[17:08:28] [DOC: 9208357] ℹ️  API push details saved for document 9208357
[17:08:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208356                         ║
================================================================================
[17:08:28] ℹ️  Agency: Dartmouth HH
[17:08:28] ℹ️  Date: 03/28/2025
[17:08:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:30] [DOC: 9208356] ✅ Text extracted using pdfplumber (1419 chars)
[17:08:30] ✅    ✅ Text extracted using pdfplumber (1419 chars)
[17:08:30] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:32] ℹ️  AI extracted raw sex value: 'F'
[17:08:32] ℹ️  AI extracted service line: 'PT'
[17:08:32] ℹ️  AI extracted payer source: 'Medicare'
[17:08:32] ℹ️  AI extracted diagnoses:
[17:08:32] ℹ️    - Diagnosis 1: ''
[17:08:32] ℹ️    - Diagnosis 2: ''
[17:08:32] ℹ️    - Diagnosis 3: ''
[17:08:32] ℹ️    - Diagnosis 4: ''
[17:08:32] ℹ️    - Diagnosis 5: ''
[17:08:32] ℹ️    - Diagnosis 6: ''
[17:08:32] ℹ️  Final extracted MRN: '6480009'
[17:08:32] ℹ️  Final extracted Sex: 'FEMALE'
[17:08:32] ℹ️  Final extracted Service Line: 'PT'
[17:08:32] ℹ️  Final extracted Payer Source: 'Medicare'
[17:08:32] ✅ Patient data extraction completed successfully
[17:08:32] ✅    ✅ Patient data extracted successfully
[17:08:32] 📊 Patient Response
     └─ patientFName: Maureen
     └─ patientLName: Glowacki
     └─ dob: 04/15/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6480009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:32] ✅    ✅ Patient identified: Maureen Glowacki
[17:08:32] ✅    ✅ Patient name validation passed
[17:08:32] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:32] [DOC: 9208356] ℹ️  DOB normalized: 04/15/1932
[17:08:32] [DOC: 9208356] ℹ️  Episode startOfCare normalized: 02/28/2025
[17:08:32] [DOC: 9208356] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[17:08:32] [DOC: 9208356] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[17:08:32] [DOC: 9208356] ✅ Patient date processing completed successfully
[17:08:32] ✅    ✅ Date processing completed
[17:08:32] 📊 Processed Patient Data
     └─ patientFName: Maureen
     └─ patientLName: Glowacki
     └─ dob: 04/15/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6480009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:32] 🔄 
🔄 Step 4: Extracting order data...
[17:08:35] ℹ️  Order extraction - MRN: ''
[17:08:35] ℹ️  Order extraction - Sex: 'FEMALE'
[17:08:35] ℹ️  Order extraction - Service Line: 'PT'
[17:08:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:08:35] ✅ Order data extraction completed successfully
[17:08:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:35] ℹ️  Using MRN from patient data: '6480009'
[17:08:35] ℹ️  Service line consistent in both sources: 'PT'
[17:08:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:08:35] ✅ Patient name cross-validation successful
[17:08:35] ✅    ✅ Data merged successfully
[17:08:36] ✅    ✅ Order data extracted and validated
[17:08:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:48] [DOC: 9208356] ✅ Patient exists in API: Maureen Glowacki, ID: 6a3d5b05-0772-47d6-969c-fbe2ca57a98f
[17:08:48] ✅    ✅ Existing patient found with ID: 6a3d5b05-0772-47d6-969c-fbe2ca57a98f
[17:08:48] 🔄 
🔄 Step 6: Pushing order to API...
[17:08:48] [DOC: 9208356] ℹ️  Pushing order via API for patient ID: 6a3d5b05-0772-47d6-969c-fbe2ca57a98f
[17:08:50] [DOC: 9208356] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:08:50] ❌    ❌ Failed to push order
[17:08:50] 🔄 
🔄 Step 7: Writing to CSV...
[17:08:50] [DOC: 9208356] ℹ️  Calculated age: 93 from DOB: 04/15/1932
[17:08:50] [DOC: 9208356] ℹ️  Service Line extracted: 'PT'
[17:08:50] [DOC: 9208356] ℹ️  Payer Source extracted: 'Medicare'
[17:08:50] [DOC: 9208356] ℹ️  Diagnosis codes being written:
[17:08:50] [DOC: 9208356] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:08:50] [DOC: 9208356] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:08:50] [DOC: 9208356] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:08:50] [DOC: 9208356] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:08:50] [DOC: 9208356] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:08:50] [DOC: 9208356] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:08:50] [DOC: 9208356] ✅ Patient data written to CSV: Maureen Glowacki | Sex: FEMALE | Age: 93 | Service: PT | Payer: Medicare | MRN: 6480009
[17:08:50] ✅    ✅ Document 9208356 processed and saved successfully
[17:08:50] 🔄 
🔄 Step 8: Saving API details...
[17:08:50] [DOC: 9208356] ℹ️  API push details saved for document 9208356
[17:08:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208352                         ║
================================================================================
[17:08:50] ℹ️  Agency: Dartmouth HH
[17:08:50] ℹ️  Date: 03/28/2025
[17:08:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:51] [DOC: 9208352] ✅ Text extracted using pdfplumber (1166 chars)
[17:08:51] ✅    ✅ Text extracted using pdfplumber (1166 chars)
[17:08:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:54] ℹ️  AI extracted raw sex value: 'F'
[17:08:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:08:54] ℹ️  AI extracted payer source: 'Fallon Navicare'
[17:08:54] ℹ️  AI extracted diagnoses:
[17:08:54] ℹ️    - Diagnosis 1: 'None'
[17:08:54] ℹ️    - Diagnosis 2: 'None'
[17:08:54] ℹ️    - Diagnosis 3: 'None'
[17:08:54] ℹ️    - Diagnosis 4: 'None'
[17:08:54] ℹ️    - Diagnosis 5: 'None'
[17:08:54] ℹ️    - Diagnosis 6: 'None'
[17:08:54] ℹ️  Final extracted MRN: '6149015'
[17:08:54] ℹ️  Final extracted Sex: 'FEMALE'
[17:08:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:08:54] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[17:08:54] ✅ Patient data extraction completed successfully
[17:08:54] ✅    ✅ Patient data extracted successfully
[17:08:54] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 114 Riverside Ave Apt 160
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:08:54] ✅    ✅ Patient identified: Margaret Rapoza
[17:08:54] ✅    ✅ Patient name validation passed
[17:08:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:54] [DOC: 9208352] ℹ️  DOB normalized: 05/05/1936
[17:08:54] [DOC: 9208352] ℹ️  Episode startOfCare normalized: 03/06/2025
[17:08:54] [DOC: 9208352] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[17:08:54] [DOC: 9208352] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[17:08:54] [DOC: 9208352] ✅ Patient date processing completed successfully
[17:08:54] ✅    ✅ Date processing completed
[17:08:54] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 114 Riverside Ave Apt 160
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025'}]
[17:08:54] 🔄 
🔄 Step 4: Extracting order data...
[17:08:57] ℹ️  Order extraction - MRN: ''
[17:08:57] ℹ️  Order extraction - Sex: 'FEMALE'
[17:08:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:08:57] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[17:08:57] ✅ Order data extraction completed successfully
[17:08:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:57] ℹ️  Using MRN from patient data: '6149015'
[17:08:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:08:57] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[17:08:57] ✅ Patient name cross-validation successful
[17:08:57] ✅    ✅ Data merged successfully
[17:08:58] ✅    ✅ Order data extracted and validated
[17:08:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:58] [DOC: 9208352] ✅ Patient found in local cache: Margaret Rapoza, ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[17:08:58] ✅    ✅ Existing patient found with ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[17:08:58] 🔄 
🔄 Step 6: Pushing order to API...
[17:08:58] [DOC: 9208352] ℹ️  Pushing order via API for patient ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[17:08:59] [DOC: 9208352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:08:59] ❌    ❌ Failed to push order
[17:08:59] 🔄 
🔄 Step 7: Writing to CSV...
[17:08:59] [DOC: 9208352] ℹ️  Calculated age: 89 from DOB: 05/05/1936
[17:08:59] [DOC: 9208352] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:08:59] [DOC: 9208352] ℹ️  Payer Source extracted: 'Fallon Navicare'
[17:08:59] [DOC: 9208352] ℹ️  Diagnosis codes being written:
[17:08:59] [DOC: 9208352] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:08:59] [DOC: 9208352] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:08:59] [DOC: 9208352] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:08:59] [DOC: 9208352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:08:59] [DOC: 9208352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:08:59] [DOC: 9208352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:08:59] [DOC: 9208352] ✅ Patient data written to CSV: Margaret Rapoza | Sex: FEMALE | Age: 89 | Service: Skilled Nursing | Payer: Fallon Navicare | MRN: 6149015
[17:08:59] ✅    ✅ Document 9208352 processed and saved successfully
[17:08:59] 🔄 
🔄 Step 8: Saving API details...
[17:08:59] [DOC: 9208352] ℹ️  API push details saved for document 9208352
[17:08:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208351                         ║
================================================================================
[17:08:59] ℹ️  Agency: Dartmouth HH
[17:08:59] ℹ️  Date: 03/28/2025
[17:08:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:01] [DOC: 9208351] ✅ Text extracted using pdfplumber (1819 chars)
[17:09:01] ✅    ✅ Text extracted using pdfplumber (1819 chars)
[17:09:01] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:04] ℹ️  AI extracted raw sex value: 'F'
[17:09:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:09:04] ℹ️  AI extracted payer source: 'Medicare'
[17:09:04] ℹ️  AI extracted diagnoses:
[17:09:04] ℹ️    - Diagnosis 1: ''
[17:09:04] ℹ️    - Diagnosis 2: ''
[17:09:04] ℹ️    - Diagnosis 3: ''
[17:09:04] ℹ️    - Diagnosis 4: ''
[17:09:04] ℹ️    - Diagnosis 5: ''
[17:09:04] ℹ️    - Diagnosis 6: ''
[17:09:04] ℹ️  Final extracted MRN: '6117015'
[17:09:04] ℹ️  Final extracted Sex: 'FEMALE'
[17:09:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:09:04] ℹ️  Final extracted Payer Source: 'Medicare'
[17:09:04] ✅ Patient data extraction completed successfully
[17:09:04] ✅    ✅ Patient data extracted successfully
[17:09:04] 📊 Patient Response
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:04] ✅    ✅ Patient identified: Janet Cabral
[17:09:04] ✅    ✅ Patient name validation passed
[17:09:04] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:04] [DOC: 9208351] ℹ️  DOB normalized: 07/26/1952
[17:09:04] [DOC: 9208351] ℹ️  Episode startOfCare normalized: 02/28/2025
[17:09:04] [DOC: 9208351] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[17:09:04] [DOC: 9208351] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[17:09:04] [DOC: 9208351] ✅ Patient date processing completed successfully
[17:09:04] ✅    ✅ Date processing completed
[17:09:04] 📊 Processed Patient Data
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:04] 🔄 
🔄 Step 4: Extracting order data...
[17:09:06] ℹ️  Order extraction - MRN: ''
[17:09:06] ℹ️  Order extraction - Sex: 'FEMALE'
[17:09:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:09:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:09:06] ✅ Order data extraction completed successfully
[17:09:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:06] ℹ️  Using MRN from patient data: '6117015'
[17:09:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:09:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:09:06] ✅ Patient name cross-validation successful
[17:09:06] ✅    ✅ Data merged successfully
[17:09:07] ✅    ✅ Order data extracted and validated
[17:09:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:07] [DOC: 9208351] ✅ Patient found in local cache: Janet Cabral, ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[17:09:07] ✅    ✅ Existing patient found with ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[17:09:07] 🔄 
🔄 Step 6: Pushing order to API...
[17:09:07] [DOC: 9208351] ℹ️  Pushing order via API for patient ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[17:09:09] [DOC: 9208351] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:09:09] ❌    ❌ Failed to push order
[17:09:09] 🔄 
🔄 Step 7: Writing to CSV...
[17:09:09] [DOC: 9208351] ℹ️  Calculated age: 72 from DOB: 07/26/1952
[17:09:09] [DOC: 9208351] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:09:09] [DOC: 9208351] ℹ️  Payer Source extracted: 'Medicare'
[17:09:09] [DOC: 9208351] ℹ️  Diagnosis codes being written:
[17:09:09] [DOC: 9208351] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:09:09] [DOC: 9208351] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:09:09] [DOC: 9208351] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:09:09] [DOC: 9208351] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:09:09] [DOC: 9208351] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:09:09] [DOC: 9208351] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:09:09] [DOC: 9208351] ✅ Patient data written to CSV: Janet Cabral | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicare | MRN: 6117015
[17:09:09] ✅    ✅ Document 9208351 processed and saved successfully
[17:09:09] 🔄 
🔄 Step 8: Saving API details...
[17:09:09] [DOC: 9208351] ℹ️  API push details saved for document 9208351
[17:09:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208349                         ║
================================================================================
[17:09:09] ℹ️  Agency: Dartmouth HH
[17:09:09] ℹ️  Date: 03/28/2025
[17:09:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:11] [DOC: 9208349] ✅ Text extracted using pdfplumber (1395 chars)
[17:09:11] ✅    ✅ Text extracted using pdfplumber (1395 chars)
[17:09:11] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:13] ℹ️  AI extracted raw sex value: 'F'
[17:09:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:09:13] ℹ️  AI extracted payer source: 'Medicare'
[17:09:13] ℹ️  AI extracted diagnoses:
[17:09:13] ℹ️    - Diagnosis 1: 'None'
[17:09:13] ℹ️    - Diagnosis 2: 'None'
[17:09:13] ℹ️    - Diagnosis 3: 'None'
[17:09:13] ℹ️    - Diagnosis 4: 'None'
[17:09:13] ℹ️    - Diagnosis 5: 'None'
[17:09:13] ℹ️    - Diagnosis 6: 'None'
[17:09:13] ℹ️  Final extracted MRN: '5496011'
[17:09:13] ℹ️  Final extracted Sex: 'FEMALE'
[17:09:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:09:13] ℹ️  Final extracted Payer Source: 'Medicare'
[17:09:13] ✅ Patient data extraction completed successfully
[17:09:13] ✅    ✅ Patient data extracted successfully
[17:09:13] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:09:13] ✅    ✅ Patient identified: Donna Leclair
[17:09:13] ✅    ✅ Patient name validation passed
[17:09:13] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:13] [DOC: 9208349] ℹ️  DOB normalized: 08/17/1950
[17:09:13] [DOC: 9208349] ℹ️  Episode startOfCare normalized: 03/08/2025
[17:09:13] [DOC: 9208349] ℹ️  Episode startOfEpisode normalized: 03/08/2025
[17:09:13] [DOC: 9208349] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[17:09:13] [DOC: 9208349] ✅ Patient date processing completed successfully
[17:09:13] ✅    ✅ Date processing completed
[17:09:13] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025'}]
[17:09:13] 🔄 
🔄 Step 4: Extracting order data...
[17:09:16] ℹ️  Order extraction - MRN: '5496011'
[17:09:16] ℹ️  Order extraction - Sex: 'FEMALE'
[17:09:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:09:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:09:16] ✅ Order data extraction completed successfully
[17:09:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:16] ℹ️  Using MRN from patient data: '5496011' over '5496011'
[17:09:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:09:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:09:16] ✅ Patient name cross-validation successful
[17:09:16] ✅    ✅ Data merged successfully
[17:09:17] ✅    ✅ Order data extracted and validated
[17:09:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:17] [DOC: 9208349] ✅ Patient found in local cache: Donna Leclair, ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[17:09:17] ✅    ✅ Existing patient found with ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[17:09:17] 🔄 
🔄 Step 6: Pushing order to API...
[17:09:17] [DOC: 9208349] ℹ️  Pushing order via API for patient ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[17:09:18] [DOC: 9208349] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:09:18] ❌    ❌ Failed to push order
[17:09:18] 🔄 
🔄 Step 7: Writing to CSV...
[17:09:18] [DOC: 9208349] ℹ️  Calculated age: 74 from DOB: 08/17/1950
[17:09:18] [DOC: 9208349] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:09:18] [DOC: 9208349] ℹ️  Payer Source extracted: 'Medicare'
[17:09:18] [DOC: 9208349] ℹ️  Diagnosis codes being written:
[17:09:18] [DOC: 9208349] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:09:18] [DOC: 9208349] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:09:18] [DOC: 9208349] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:09:18] [DOC: 9208349] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:09:18] [DOC: 9208349] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:09:18] [DOC: 9208349] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:09:18] [DOC: 9208349] ✅ Patient data written to CSV: Donna Leclair | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 5496011
[17:09:18] ✅    ✅ Document 9208349 processed and saved successfully
[17:09:18] 🔄 
🔄 Step 8: Saving API details...
[17:09:18] [DOC: 9208349] ℹ️  API push details saved for document 9208349
[17:09:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208348                         ║
================================================================================
[17:09:18] ℹ️  Agency: Dartmouth HH
[17:09:18] ℹ️  Date: 03/28/2025
[17:09:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:20] [DOC: 9208348] ✅ Text extracted using pdfplumber (1253 chars)
[17:09:20] ✅    ✅ Text extracted using pdfplumber (1253 chars)
[17:09:20] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:23] ℹ️  AI extracted raw sex value: 'M'
[17:09:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:09:23] ℹ️  AI extracted payer source: 'Medicare'
[17:09:23] ℹ️  AI extracted diagnoses:
[17:09:23] ℹ️    - Diagnosis 1: 'None'
[17:09:23] ℹ️    - Diagnosis 2: 'None'
[17:09:23] ℹ️    - Diagnosis 3: 'None'
[17:09:23] ℹ️    - Diagnosis 4: 'None'
[17:09:23] ℹ️    - Diagnosis 5: 'None'
[17:09:23] ℹ️    - Diagnosis 6: 'None'
[17:09:23] ℹ️  Final extracted MRN: '6140015'
[17:09:23] ℹ️  Final extracted Sex: 'MALE'
[17:09:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:09:23] ℹ️  Final extracted Payer Source: 'Medicare'
[17:09:23] ✅ Patient data extraction completed successfully
[17:09:23] ✅    ✅ Patient data extracted successfully
[17:09:23] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:09:23] ✅    ✅ Patient identified: Ernest Barboza
[17:09:23] ✅    ✅ Patient name validation passed
[17:09:23] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:23] [DOC: 9208348] ℹ️  DOB normalized: 02/22/1937
[17:09:23] [DOC: 9208348] ℹ️  Episode startOfCare normalized: 03/06/2025
[17:09:23] [DOC: 9208348] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[17:09:23] [DOC: 9208348] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[17:09:23] [DOC: 9208348] ✅ Patient date processing completed successfully
[17:09:23] ✅    ✅ Date processing completed
[17:09:23] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025'}]
[17:09:23] 🔄 
🔄 Step 4: Extracting order data...
[17:09:25] ℹ️  Order extraction - MRN: '6140015'
[17:09:25] ℹ️  Order extraction - Sex: 'MALE'
[17:09:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:09:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:09:25] ✅ Order data extraction completed successfully
[17:09:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:25] ℹ️  Using MRN from patient data: '6140015' over '6140015'
[17:09:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:09:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:09:25] ✅ Patient name cross-validation successful
[17:09:25] ✅    ✅ Data merged successfully
[17:09:26] ✅    ✅ Order data extracted and validated
[17:09:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:26] [DOC: 9208348] ✅ Patient found in local cache: Ernest Barboza, ID: adb22793-6127-48ac-9c27-184ca9af82cc
[17:09:26] ✅    ✅ Existing patient found with ID: adb22793-6127-48ac-9c27-184ca9af82cc
[17:09:26] 🔄 
🔄 Step 6: Pushing order to API...
[17:09:26] [DOC: 9208348] ℹ️  Pushing order via API for patient ID: adb22793-6127-48ac-9c27-184ca9af82cc
[17:09:28] [DOC: 9208348] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:09:28] ❌    ❌ Failed to push order
[17:09:28] 🔄 
🔄 Step 7: Writing to CSV...
[17:09:28] [DOC: 9208348] ℹ️  Calculated age: 88 from DOB: 02/22/1937
[17:09:28] [DOC: 9208348] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:09:28] [DOC: 9208348] ℹ️  Payer Source extracted: 'Medicare'
[17:09:28] [DOC: 9208348] ℹ️  Diagnosis codes being written:
[17:09:28] [DOC: 9208348] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:09:28] [DOC: 9208348] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:09:28] [DOC: 9208348] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:09:28] [DOC: 9208348] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:09:28] [DOC: 9208348] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:09:28] [DOC: 9208348] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:09:28] [DOC: 9208348] ✅ Patient data written to CSV: Ernest Barboza | Sex: MALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6140015
[17:09:28] ✅    ✅ Document 9208348 processed and saved successfully
[17:09:28] 🔄 
🔄 Step 8: Saving API details...
[17:09:28] [DOC: 9208348] ℹ️  API push details saved for document 9208348
[17:09:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208344                         ║
================================================================================
[17:09:28] ℹ️  Agency: Nizhoni Health-Fall River
[17:09:28] ℹ️  Date: 03/28/2025
[17:09:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:31] [DOC: 9208344] ✅ Text extracted using pdfplumber (1067 chars)
[17:09:31] ✅    ✅ Text extracted using pdfplumber (1067 chars)
[17:09:31] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:34] ℹ️  AI extracted raw sex value: 'M'
[17:09:34] ℹ️  AI extracted service line: 'HHA'
[17:09:34] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance One Care'
[17:09:34] ℹ️  AI extracted diagnoses:
[17:09:34] ℹ️    - Diagnosis 1: 'None'
[17:09:34] ℹ️    - Diagnosis 2: 'None'
[17:09:34] ℹ️    - Diagnosis 3: 'None'
[17:09:34] ℹ️    - Diagnosis 4: 'None'
[17:09:34] ℹ️    - Diagnosis 5: 'None'
[17:09:34] ℹ️    - Diagnosis 6: 'None'
[17:09:34] ℹ️  Final extracted MRN: '2748020'
[17:09:34] ℹ️  Final extracted Sex: 'MALE'
[17:09:34] ℹ️  Final extracted Service Line: 'HHA'
[17:09:34] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance One Care'
[17:09:34] ✅ Patient data extraction completed successfully
[17:09:34] ✅    ✅ Patient data extracted successfully
[17:09:34] 📊 Patient Response
     └─ patientFName: Anthony
     └─ patientLName: Lawson
     └─ dob: 12/07/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2748020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 514 Union Street 3rd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2022', 'startOfEpisode': None, 'endOfEpisode': '04/05/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:09:34] ✅    ✅ Patient identified: Anthony Lawson
[17:09:34] ✅    ✅ Patient name validation passed
[17:09:34] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:34] [DOC: 9208344] ℹ️  DOB normalized: 12/07/1960
[17:09:34] [DOC: 9208344] ℹ️  Episode startOfCare normalized: 10/19/2022
[17:09:34] [DOC: 9208344] ℹ️  Episode endOfEpisode normalized: 04/05/2025
[17:09:34] [DOC: 9208344] ✅ Patient date processing completed successfully
[17:09:34] ✅    ✅ Date processing completed
[17:09:34] 📊 Processed Patient Data
     └─ patientFName: Anthony
     └─ patientLName: Lawson
     └─ dob: 12/07/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2748020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 514 Union Street 3rd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2022', 'endOfEpisode': '04/05/2025'}]
[17:09:34] 🔄 
🔄 Step 4: Extracting order data...
[17:09:36] ℹ️  Order extraction - MRN: '2748020'
[17:09:36] ℹ️  Order extraction - Sex: 'MALE'
[17:09:36] ℹ️  Order extraction - Service Line: ''
[17:09:36] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance One Care'
[17:09:36] ✅ Order data extraction completed successfully
[17:09:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:36] ℹ️  Using MRN from patient data: '2748020' over '2748020'
[17:09:36] ℹ️  Using service line from patient data: 'HHA'
[17:09:36] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance One Care'
[17:09:36] ✅ Patient name cross-validation successful
[17:09:36] ✅    ✅ Data merged successfully
[17:09:37] ✅    ✅ Order data extracted and validated
[17:09:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:37] [DOC: 9208344] ✅ Patient found in local cache: Anthony Lawson, ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[17:09:37] ✅    ✅ Existing patient found with ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[17:09:37] 🔄 
🔄 Step 6: Pushing order to API...
[17:09:37] [DOC: 9208344] ℹ️  Pushing order via API for patient ID: 55749ca9-f117-4f51-95ea-dca838c39c2c
[17:09:38] [DOC: 9208344] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:09:38] ❌    ❌ Failed to push order
[17:09:38] 🔄 
🔄 Step 7: Writing to CSV...
[17:09:38] [DOC: 9208344] ℹ️  Calculated age: 64 from DOB: 12/07/1960
[17:09:38] [DOC: 9208344] ℹ️  Service Line extracted: 'HHA'
[17:09:38] [DOC: 9208344] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance One Care'
[17:09:38] [DOC: 9208344] ℹ️  Diagnosis codes being written:
[17:09:38] [DOC: 9208344] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:09:38] [DOC: 9208344] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:09:38] [DOC: 9208344] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:09:38] [DOC: 9208344] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:09:38] [DOC: 9208344] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:09:38] [DOC: 9208344] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:09:38] [DOC: 9208344] ✅ Patient data written to CSV: Anthony Lawson | Sex: MALE | Age: 64 | Service: HHA | Payer: Commonwealth Care Alliance One Care | MRN: 2748020
[17:09:38] ✅    ✅ Document 9208344 processed and saved successfully
[17:09:38] 🔄 
🔄 Step 8: Saving API details...
[17:09:38] [DOC: 9208344] ℹ️  API push details saved for document 9208344
[17:09:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208342                         ║
================================================================================
[17:09:38] ℹ️  Agency: Dartmouth HH
[17:09:38] ℹ️  Date: 03/28/2025
[17:09:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:40] [DOC: 9208342] ✅ Text extracted using pdfplumber (2625 chars)
[17:09:40] ✅    ✅ Text extracted using pdfplumber (2625 chars)
[17:09:40] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:43] ℹ️  AI extracted raw sex value: 'F'
[17:09:43] ℹ️  AI extracted service line: 'PT'
[17:09:43] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[17:09:43] ℹ️  AI extracted diagnoses:
[17:09:43] ℹ️    - Diagnosis 1: ''
[17:09:43] ℹ️    - Diagnosis 2: ''
[17:09:43] ℹ️    - Diagnosis 3: ''
[17:09:43] ℹ️    - Diagnosis 4: ''
[17:09:43] ℹ️    - Diagnosis 5: ''
[17:09:43] ℹ️    - Diagnosis 6: ''
[17:09:43] ℹ️  Final extracted MRN: '4398011'
[17:09:43] ℹ️  Final extracted Sex: 'FEMALE'
[17:09:43] ℹ️  Final extracted Service Line: 'PT'
[17:09:43] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[17:09:43] ✅ Patient data extraction completed successfully
[17:09:43] ✅    ✅ Patient data extracted successfully
[17:09:43] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:43] ✅    ✅ Patient identified: Elaine Dos Santos
[17:09:43] ✅    ✅ Patient name validation passed
[17:09:43] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:43] [DOC: 9208342] ℹ️  DOB normalized: 06/30/1950
[17:09:43] [DOC: 9208342] ℹ️  Episode startOfCare normalized: 12/15/2024
[17:09:43] [DOC: 9208342] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[17:09:43] [DOC: 9208342] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[17:09:43] [DOC: 9208342] ✅ Patient date processing completed successfully
[17:09:43] ✅    ✅ Date processing completed
[17:09:43] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:43] 🔄 
🔄 Step 4: Extracting order data...
[17:09:45] ℹ️  Order extraction - MRN: '4398011'
[17:09:45] ℹ️  Order extraction - Sex: 'FEMALE'
[17:09:45] ℹ️  Order extraction - Service Line: 'PT'
[17:09:45] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[17:09:45] ✅ Order data extraction completed successfully
[17:09:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:45] ℹ️  Using MRN from patient data: '4398011' over '4398011'
[17:09:45] ℹ️  Service line consistent in both sources: 'PT'
[17:09:45] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[17:09:45] ✅ Patient name cross-validation successful
[17:09:45] ✅    ✅ Data merged successfully
[17:09:46] ✅    ✅ Order data extracted and validated
[17:09:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:46] [DOC: 9208342] ✅ Patient found in local cache: Elaine Dos Santos, ID: b67987f0-df4a-470f-8698-52193755e58e
[17:09:46] ✅    ✅ Existing patient found with ID: b67987f0-df4a-470f-8698-52193755e58e
[17:09:46] 🔄 
🔄 Step 6: Pushing order to API...
[17:09:46] [DOC: 9208342] ℹ️  Pushing order via API for patient ID: b67987f0-df4a-470f-8698-52193755e58e
[17:09:48] [DOC: 9208342] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:09:48] ❌    ❌ Failed to push order
[17:09:48] 🔄 
🔄 Step 7: Writing to CSV...
[17:09:48] [DOC: 9208342] ℹ️  Calculated age: 74 from DOB: 06/30/1950
[17:09:48] [DOC: 9208342] ℹ️  Service Line extracted: 'PT'
[17:09:48] [DOC: 9208342] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[17:09:48] [DOC: 9208342] ℹ️  Diagnosis codes being written:
[17:09:48] [DOC: 9208342] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:09:48] [DOC: 9208342] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:09:48] [DOC: 9208342] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:09:48] [DOC: 9208342] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:09:48] [DOC: 9208342] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:09:48] [DOC: 9208342] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:09:48] [DOC: 9208342] ✅ Patient data written to CSV: Elaine Dos Santos | Sex: FEMALE | Age: 74 | Service: PT | Payer: Blue Cross Medicare Adv | MRN: 4398011
[17:09:48] ✅    ✅ Document 9208342 processed and saved successfully
[17:09:48] 🔄 
🔄 Step 8: Saving API details...
[17:09:48] [DOC: 9208342] ℹ️  API push details saved for document 9208342
[17:09:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208340                         ║
================================================================================
[17:09:48] ℹ️  Agency: Dartmouth HH
[17:09:48] ℹ️  Date: 03/28/2025
[17:09:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:50] [DOC: 9208340] ✅ Text extracted using pdfplumber (3760 chars)
[17:09:50] ✅    ✅ Text extracted using pdfplumber (3760 chars)
[17:09:50] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:53] ℹ️  AI extracted raw sex value: 'M'
[17:09:53] ℹ️  AI extracted service line: 'PT'
[17:09:53] ℹ️  AI extracted payer source: 'Medicare'
[17:09:53] ℹ️  AI extracted diagnoses:
[17:09:53] ℹ️    - Diagnosis 1: ''
[17:09:53] ℹ️    - Diagnosis 2: ''
[17:09:53] ℹ️    - Diagnosis 3: ''
[17:09:53] ℹ️    - Diagnosis 4: ''
[17:09:53] ℹ️    - Diagnosis 5: ''
[17:09:53] ℹ️    - Diagnosis 6: ''
[17:09:53] ℹ️  Final extracted MRN: '5824015'
[17:09:53] ℹ️  Final extracted Sex: 'MALE'
[17:09:53] ℹ️  Final extracted Service Line: 'PT'
[17:09:53] ℹ️  Final extracted Payer Source: 'Medicare'
[17:09:53] ✅ Patient data extraction completed successfully
[17:09:53] ✅    ✅ Patient data extracted successfully
[17:09:53] 📊 Patient Response
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 5824015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:53] ✅    ✅ Patient identified: Wayne Dubreuil
[17:09:53] ✅    ✅ Patient name validation passed
[17:09:53] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:53] [DOC: 9208340] ℹ️  DOB normalized: 08/14/1953
[17:09:53] [DOC: 9208340] ℹ️  Episode startOfCare normalized: 01/16/2025
[17:09:53] [DOC: 9208340] ℹ️  Episode startOfEpisode normalized: 01/16/2025
[17:09:53] [DOC: 9208340] ℹ️  Episode endOfEpisode normalized: 03/16/2025
[17:09:53] [DOC: 9208340] ✅ Patient date processing completed successfully
[17:09:53] ✅    ✅ Date processing completed
[17:09:53] 📊 Processed Patient Data
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 5824015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:53] 🔄 
🔄 Step 4: Extracting order data...
[17:09:55] ℹ️  Order extraction - MRN: ''
[17:09:55] ℹ️  Order extraction - Sex: 'MALE'
[17:09:55] ℹ️  Order extraction - Service Line: 'PT'
[17:09:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:09:55] ✅ Order data extraction completed successfully
[17:09:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:55] ℹ️  Using MRN from patient data: '5824015'
[17:09:55] ℹ️  Service line consistent in both sources: 'PT'
[17:09:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:09:55] ✅ Patient name cross-validation successful
[17:09:55] ✅    ✅ Data merged successfully
[17:09:56] ✅    ✅ Order data extracted and validated
[17:09:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:10:03] [DOC: 9208340] ✅ Patient exists in API: Wayne Dubreuil, ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[17:10:03] ✅    ✅ Existing patient found with ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[17:10:03] 🔄 
🔄 Step 6: Pushing order to API...
[17:10:03] [DOC: 9208340] ℹ️  Pushing order via API for patient ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[17:10:05] [DOC: 9208340] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:10:05] ❌    ❌ Failed to push order
[17:10:05] 🔄 
🔄 Step 7: Writing to CSV...
[17:10:05] [DOC: 9208340] ℹ️  Calculated age: 71 from DOB: 08/14/1953
[17:10:05] [DOC: 9208340] ℹ️  Service Line extracted: 'PT'
[17:10:05] [DOC: 9208340] ℹ️  Payer Source extracted: 'Medicare'
[17:10:05] [DOC: 9208340] ℹ️  Diagnosis codes being written:
[17:10:05] [DOC: 9208340] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:10:05] [DOC: 9208340] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:10:05] [DOC: 9208340] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:10:05] [DOC: 9208340] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:10:05] [DOC: 9208340] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:10:05] [DOC: 9208340] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:10:05] [DOC: 9208340] ✅ Patient data written to CSV: Wayne Dubreuil | Sex: MALE | Age: 71 | Service: PT | Payer: Medicare | MRN: 5824015
[17:10:05] ✅    ✅ Document 9208340 processed and saved successfully
[17:10:05] 🔄 
🔄 Step 8: Saving API details...
[17:10:05] [DOC: 9208340] ℹ️  API push details saved for document 9208340
[17:10:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208338                         ║
================================================================================
[17:10:05] ℹ️  Agency: Dartmouth HH
[17:10:05] ℹ️  Date: 03/28/2025
[17:10:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:07] [DOC: 9208338] ✅ Text extracted using pdfplumber (1161 chars)
[17:10:07] ✅    ✅ Text extracted using pdfplumber (1161 chars)
[17:10:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:09] ℹ️  AI extracted raw sex value: 'M'
[17:10:09] ℹ️  AI extracted service line: 'RN'
[17:10:09] ℹ️  AI extracted payer source: 'United Health Care'
[17:10:09] ℹ️  AI extracted diagnoses:
[17:10:09] ℹ️    - Diagnosis 1: ''
[17:10:09] ℹ️    - Diagnosis 2: ''
[17:10:09] ℹ️    - Diagnosis 3: ''
[17:10:09] ℹ️    - Diagnosis 4: ''
[17:10:09] ℹ️    - Diagnosis 5: ''
[17:10:09] ℹ️    - Diagnosis 6: ''
[17:10:09] ℹ️  Final extracted MRN: '926015'
[17:10:09] ℹ️  Final extracted Sex: 'MALE'
[17:10:09] ℹ️  Final extracted Service Line: 'RN'
[17:10:09] ℹ️  Final extracted Payer Source: 'United Health Care'
[17:10:09] ✅ Patient data extraction completed successfully
[17:10:09] ✅    ✅ Patient data extracted successfully
[17:10:09] 📊 Patient Response
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 88 Highland St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:09] ✅    ✅ Patient identified: Clinton Sowle
[17:10:09] ✅    ✅ Patient name validation passed
[17:10:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:09] [DOC: 9208338] ℹ️  DOB normalized: 12/01/1943
[17:10:09] [DOC: 9208338] ℹ️  Episode startOfCare normalized: 02/14/2025
[17:10:09] [DOC: 9208338] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[17:10:09] [DOC: 9208338] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[17:10:09] [DOC: 9208338] ✅ Patient date processing completed successfully
[17:10:09] ✅    ✅ Date processing completed
[17:10:09] 📊 Processed Patient Data
     └─ patientFName: Clinton
     └─ patientLName: Sowle
     └─ dob: 12/01/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 926015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 88 Highland St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:09] 🔄 
🔄 Step 4: Extracting order data...
[17:10:12] ℹ️  Order extraction - MRN: ''
[17:10:12] ℹ️  Order extraction - Sex: 'MALE'
[17:10:12] ℹ️  Order extraction - Service Line: 'RN'
[17:10:12] ℹ️  Order extraction - Payer Source: 'United Health Care'
[17:10:12] ✅ Order data extraction completed successfully
[17:10:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:12] ℹ️  Using MRN from patient data: '926015'
[17:10:12] ℹ️  Service line consistent in both sources: 'RN'
[17:10:12] ℹ️  Payer source consistent in both sources: 'United Health Care'
[17:10:12] ✅ Patient name cross-validation successful
[17:10:12] ✅    ✅ Data merged successfully
[17:10:13] ✅    ✅ Order data extracted and validated
[17:10:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:10:13] [DOC: 9208338] ✅ Patient found in local cache: Clinton Sowle, ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[17:10:13] ✅    ✅ Existing patient found with ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[17:10:13] 🔄 
🔄 Step 6: Pushing order to API...
[17:10:13] [DOC: 9208338] ℹ️  Pushing order via API for patient ID: 7e93f2bb-cb9b-4413-8c7e-30e74ce79269
[17:10:14] [DOC: 9208338] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14216"}
[17:10:14] ❌    ❌ Failed to push order
[17:10:14] 🔄 
🔄 Step 7: Writing to CSV...
[17:10:14] [DOC: 9208338] ℹ️  Calculated age: 81 from DOB: 12/01/1943
[17:10:14] [DOC: 9208338] ℹ️  Service Line extracted: 'RN'
[17:10:14] [DOC: 9208338] ℹ️  Payer Source extracted: 'United Health Care'
[17:10:14] [DOC: 9208338] ℹ️  Diagnosis codes being written:
[17:10:14] [DOC: 9208338] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:10:14] [DOC: 9208338] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:10:14] [DOC: 9208338] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:10:14] [DOC: 9208338] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:10:14] [DOC: 9208338] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:10:14] [DOC: 9208338] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:10:14] [DOC: 9208338] ✅ Patient data written to CSV: Clinton Sowle | Sex: MALE | Age: 81 | Service: RN | Payer: United Health Care | MRN: 926015
[17:10:14] ✅    ✅ Document 9208338 processed and saved successfully
[17:10:14] 🔄 
🔄 Step 8: Saving API details...
[17:10:14] [DOC: 9208338] ℹ️  API push details saved for document 9208338
[17:10:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208333                         ║
================================================================================
[17:10:14] ℹ️  Agency: Dartmouth HH
[17:10:14] ℹ️  Date: 03/28/2025
[17:10:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:16] [DOC: 9208333] ✅ Text extracted using pdfplumber (2425 chars)
[17:10:16] ✅    ✅ Text extracted using pdfplumber (2425 chars)
[17:10:16] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:18] ℹ️  AI extracted raw sex value: 'F'
[17:10:18] ℹ️  AI extracted service line: 'PT'
[17:10:18] ℹ️  AI extracted payer source: 'Medicare'
[17:10:18] ℹ️  AI extracted diagnoses:
[17:10:18] ℹ️    - Diagnosis 1: ''
[17:10:18] ℹ️    - Diagnosis 2: ''
[17:10:18] ℹ️    - Diagnosis 3: ''
[17:10:18] ℹ️    - Diagnosis 4: ''
[17:10:18] ℹ️    - Diagnosis 5: ''
[17:10:18] ℹ️    - Diagnosis 6: ''
[17:10:18] ℹ️  Final extracted MRN: '7141009'
[17:10:18] ℹ️  Final extracted Sex: 'FEMALE'
[17:10:18] ℹ️  Final extracted Service Line: 'PT'
[17:10:18] ℹ️  Final extracted Payer Source: 'Medicare'
[17:10:18] ✅ Patient data extraction completed successfully
[17:10:18] ✅    ✅ Patient data extracted successfully
[17:10:18] 📊 Patient Response
     └─ patientFName: Alice
     └─ patientLName: Almeida
     └─ dob: 04/04/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7141009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:18] ✅    ✅ Patient identified: Alice Almeida
[17:10:18] ✅    ✅ Patient name validation passed
[17:10:18] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:18] [DOC: 9208333] ℹ️  DOB normalized: 04/04/1944
[17:10:18] [DOC: 9208333] ℹ️  Episode startOfCare normalized: 02/01/2025
[17:10:18] [DOC: 9208333] ℹ️  Episode startOfEpisode normalized: 02/01/2025
[17:10:18] [DOC: 9208333] ℹ️  Episode endOfEpisode normalized: 04/01/2025
[17:10:18] [DOC: 9208333] ✅ Patient date processing completed successfully
[17:10:18] ✅    ✅ Date processing completed
[17:10:18] 📊 Processed Patient Data
     └─ patientFName: Alice
     └─ patientLName: Almeida
     └─ dob: 04/04/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7141009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2025', 'startOfEpisode': '02/01/2025', 'endOfEpisode': '04/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:18] 🔄 
🔄 Step 4: Extracting order data...
[17:10:21] ℹ️  Order extraction - MRN: ''
[17:10:21] ℹ️  Order extraction - Sex: 'FEMALE'
[17:10:21] ℹ️  Order extraction - Service Line: 'PT'
[17:10:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:10:21] ✅ Order data extraction completed successfully
[17:10:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:21] ℹ️  Using MRN from patient data: '7141009'
[17:10:21] ℹ️  Service line consistent in both sources: 'PT'
[17:10:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:10:21] ✅ Patient name cross-validation successful
[17:10:21] ✅    ✅ Data merged successfully
[17:10:22] ✅    ✅ Order data extracted and validated
[17:10:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:10:28] [DOC: 9208333] ✅ Patient exists in API: Alice Almeida, ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[17:10:28] ✅    ✅ Existing patient found with ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[17:10:28] 🔄 
🔄 Step 6: Pushing order to API...
[17:10:28] [DOC: 9208333] ℹ️  Pushing order via API for patient ID: 7128307f-632d-4c04-a4f9-4b86e03c2991
[17:10:30] [DOC: 9208333] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:10:30] ❌    ❌ Failed to push order
[17:10:30] 🔄 
🔄 Step 7: Writing to CSV...
[17:10:30] [DOC: 9208333] ℹ️  Calculated age: 81 from DOB: 04/04/1944
[17:10:30] [DOC: 9208333] ℹ️  Service Line extracted: 'PT'
[17:10:30] [DOC: 9208333] ℹ️  Payer Source extracted: 'Medicare'
[17:10:30] [DOC: 9208333] ℹ️  Diagnosis codes being written:
[17:10:30] [DOC: 9208333] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:10:30] [DOC: 9208333] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:10:30] [DOC: 9208333] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:10:30] [DOC: 9208333] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:10:30] [DOC: 9208333] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:10:30] [DOC: 9208333] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:10:30] [DOC: 9208333] ✅ Patient data written to CSV: Alice Almeida | Sex: FEMALE | Age: 81 | Service: PT | Payer: Medicare | MRN: 7141009
[17:10:30] ✅    ✅ Document 9208333 processed and saved successfully
[17:10:30] 🔄 
🔄 Step 8: Saving API details...
[17:10:30] [DOC: 9208333] ℹ️  API push details saved for document 9208333
[17:10:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208331                         ║
================================================================================
[17:10:30] ℹ️  Agency: Dartmouth HH
[17:10:30] ℹ️  Date: 03/28/2025
[17:10:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:32] [DOC: 9208331] ✅ Text extracted using pdfplumber (3159 chars)
[17:10:32] ✅    ✅ Text extracted using pdfplumber (3159 chars)
[17:10:32] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:34] ℹ️  AI extracted raw sex value: 'F'
[17:10:34] ℹ️  AI extracted service line: 'PT'
[17:10:34] ℹ️  AI extracted payer source: 'Medicare'
[17:10:34] ℹ️  AI extracted diagnoses:
[17:10:34] ℹ️    - Diagnosis 1: ''
[17:10:34] ℹ️    - Diagnosis 2: ''
[17:10:34] ℹ️    - Diagnosis 3: ''
[17:10:34] ℹ️    - Diagnosis 4: ''
[17:10:34] ℹ️    - Diagnosis 5: ''
[17:10:34] ℹ️    - Diagnosis 6: ''
[17:10:34] ℹ️  Final extracted MRN: '6041015'
[17:10:34] ℹ️  Final extracted Sex: 'FEMALE'
[17:10:34] ℹ️  Final extracted Service Line: 'PT'
[17:10:34] ℹ️  Final extracted Payer Source: 'Medicare'
[17:10:34] ✅ Patient data extraction completed successfully
[17:10:34] ✅    ✅ Patient data extracted successfully
[17:10:34] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Aniceto
     └─ dob: 12/04/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6041015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 284 Earle Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:34] ✅    ✅ Patient identified: Maria Aniceto
[17:10:34] ✅    ✅ Patient name validation passed
[17:10:34] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:34] [DOC: 9208331] ℹ️  DOB normalized: 12/04/1950
[17:10:34] [DOC: 9208331] ℹ️  Episode startOfCare normalized: 02/25/2025
[17:10:34] [DOC: 9208331] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[17:10:34] [DOC: 9208331] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[17:10:34] [DOC: 9208331] ✅ Patient date processing completed successfully
[17:10:34] ✅    ✅ Date processing completed
[17:10:34] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Aniceto
     └─ dob: 12/04/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6041015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 284 Earle Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/25/2025', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:34] 🔄 
🔄 Step 4: Extracting order data...
[17:10:37] ℹ️  Order extraction - MRN: ''
[17:10:37] ℹ️  Order extraction - Sex: 'FEMALE'
[17:10:37] ℹ️  Order extraction - Service Line: 'PT'
[17:10:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:10:37] ✅ Order data extraction completed successfully
[17:10:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:37] ℹ️  Using MRN from patient data: '6041015'
[17:10:37] ℹ️  Service line consistent in both sources: 'PT'
[17:10:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:10:37] ✅ Patient name cross-validation successful
[17:10:37] ✅    ✅ Data merged successfully
[17:10:39] ✅    ✅ Order data extracted and validated
[17:10:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:10:44] [DOC: 9208331] ✅ Patient exists in API: Maria Aniceto, ID: 5df536a2-7c61-4803-85e5-bede11671c97
[17:10:44] ✅    ✅ Existing patient found with ID: 5df536a2-7c61-4803-85e5-bede11671c97
[17:10:44] 🔄 
🔄 Step 6: Pushing order to API...
[17:10:44] [DOC: 9208331] ℹ️  Pushing order via API for patient ID: 5df536a2-7c61-4803-85e5-bede11671c97
[17:10:45] [DOC: 9208331] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12937"}
[17:10:45] ❌    ❌ Failed to push order
[17:10:45] 🔄 
🔄 Step 7: Writing to CSV...
[17:10:45] [DOC: 9208331] ℹ️  Calculated age: 74 from DOB: 12/04/1950
[17:10:45] [DOC: 9208331] ℹ️  Service Line extracted: 'PT'
[17:10:45] [DOC: 9208331] ℹ️  Payer Source extracted: 'Medicare'
[17:10:45] [DOC: 9208331] ℹ️  Diagnosis codes being written:
[17:10:45] [DOC: 9208331] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:10:45] [DOC: 9208331] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:10:45] [DOC: 9208331] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:10:45] [DOC: 9208331] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:10:45] [DOC: 9208331] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:10:45] [DOC: 9208331] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:10:45] [DOC: 9208331] ✅ Patient data written to CSV: Maria Aniceto | Sex: FEMALE | Age: 74 | Service: PT | Payer: Medicare | MRN: 6041015
[17:10:45] ✅    ✅ Document 9208331 processed and saved successfully
[17:10:45] 🔄 
🔄 Step 8: Saving API details...
[17:10:45] [DOC: 9208331] ℹ️  API push details saved for document 9208331
[17:10:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208328                         ║
================================================================================
[17:10:45] ℹ️  Agency: Dartmouth HH
[17:10:45] ℹ️  Date: 03/28/2025
[17:10:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:47] [DOC: 9208328] ✅ Text extracted using pdfplumber (1137 chars)
[17:10:47] ✅    ✅ Text extracted using pdfplumber (1137 chars)
[17:10:47] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:50] ℹ️  AI extracted raw sex value: 'F'
[17:10:50] ℹ️  AI extracted service line: 'OT'
[17:10:50] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[17:10:50] ℹ️  AI extracted diagnoses:
[17:10:50] ℹ️    - Diagnosis 1: ''
[17:10:50] ℹ️    - Diagnosis 2: ''
[17:10:50] ℹ️    - Diagnosis 3: ''
[17:10:50] ℹ️    - Diagnosis 4: ''
[17:10:50] ℹ️    - Diagnosis 5: ''
[17:10:50] ℹ️    - Diagnosis 6: ''
[17:10:50] ℹ️  Final extracted MRN: '6073015'
[17:10:50] ℹ️  Final extracted Sex: 'FEMALE'
[17:10:50] ℹ️  Final extracted Service Line: 'OT'
[17:10:50] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[17:10:50] ✅ Patient data extraction completed successfully
[17:10:50] ✅    ✅ Patient data extracted successfully
[17:10:50] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:50] ✅    ✅ Patient identified: Marilyn Valle
[17:10:50] ✅    ✅ Patient name validation passed
[17:10:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:50] [DOC: 9208328] ℹ️  DOB normalized: 12/24/1947
[17:10:50] [DOC: 9208328] ℹ️  Episode startOfCare normalized: 02/22/2025
[17:10:50] [DOC: 9208328] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[17:10:50] [DOC: 9208328] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[17:10:50] [DOC: 9208328] ✅ Patient date processing completed successfully
[17:10:50] ✅    ✅ Date processing completed
[17:10:50] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:50] 🔄 
🔄 Step 4: Extracting order data...
[17:10:52] ℹ️  Order extraction - MRN: ''
[17:10:52] ℹ️  Order extraction - Sex: 'FEMALE'
[17:10:52] ℹ️  Order extraction - Service Line: 'OT'
[17:10:52] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[17:10:52] ✅ Order data extraction completed successfully
[17:10:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:52] ℹ️  Using MRN from patient data: '6073015'
[17:10:52] ℹ️  Service line consistent in both sources: 'OT'
[17:10:52] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[17:10:52] ✅ Patient name cross-validation successful
[17:10:52] ✅    ✅ Data merged successfully
[17:10:54] ✅    ✅ Order data extracted and validated
[17:10:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:10:54] [DOC: 9208328] ✅ Patient found in local cache: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[17:10:54] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[17:10:54] 🔄 
🔄 Step 6: Pushing order to API...
[17:10:54] [DOC: 9208328] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[17:10:55] [DOC: 9208328] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14250"}
[17:10:55] ❌    ❌ Failed to push order
[17:10:55] 🔄 
🔄 Step 7: Writing to CSV...
[17:10:55] [DOC: 9208328] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[17:10:55] [DOC: 9208328] ℹ️  Service Line extracted: 'OT'
[17:10:55] [DOC: 9208328] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[17:10:55] [DOC: 9208328] ℹ️  Diagnosis codes being written:
[17:10:55] [DOC: 9208328] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:10:55] [DOC: 9208328] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:10:55] [DOC: 9208328] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:10:55] [DOC: 9208328] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:10:55] [DOC: 9208328] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:10:55] [DOC: 9208328] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:10:55] [DOC: 9208328] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT | Payer: Aetna- Mcare | MRN: 6073015
[17:10:55] ✅    ✅ Document 9208328 processed and saved successfully
[17:10:55] 🔄 
🔄 Step 8: Saving API details...
[17:10:55] [DOC: 9208328] ℹ️  API push details saved for document 9208328
[17:10:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208314                         ║
================================================================================
[17:10:55] ℹ️  Agency: Dartmouth HH
[17:10:55] ℹ️  Date: 03/28/2025
[17:10:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:57] [DOC: 9208314] ✅ Text extracted using pdfplumber (2118 chars)
[17:10:57] ✅    ✅ Text extracted using pdfplumber (2118 chars)
[17:10:57] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:59] ℹ️  AI extracted raw sex value: 'F'
[17:10:59] ℹ️  AI extracted service line: 'Skilled Nursing, OT'
[17:10:59] ℹ️  AI extracted payer source: 'Medicare'
[17:10:59] ℹ️  AI extracted diagnoses:
[17:10:59] ℹ️    - Diagnosis 1: ''
[17:10:59] ℹ️    - Diagnosis 2: ''
[17:10:59] ℹ️    - Diagnosis 3: ''
[17:10:59] ℹ️    - Diagnosis 4: ''
[17:10:59] ℹ️    - Diagnosis 5: ''
[17:10:59] ℹ️    - Diagnosis 6: ''
[17:10:59] ℹ️  Final extracted MRN: '6190015'
[17:10:59] ℹ️  Final extracted Sex: 'FEMALE'
[17:10:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT'
[17:10:59] ℹ️  Final extracted Payer Source: 'Medicare'
[17:10:59] ✅ Patient data extraction completed successfully
[17:10:59] ✅    ✅ Patient data extracted successfully
[17:10:59] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:59] ✅    ✅ Patient identified: John Ostapow
[17:10:59] ✅    ✅ Patient name validation passed
[17:10:59] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:59] [DOC: 9208314] ℹ️  DOB normalized: 11/23/1935
[17:10:59] [DOC: 9208314] ℹ️  Episode startOfCare normalized: 03/12/2025
[17:10:59] [DOC: 9208314] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:10:59] [DOC: 9208314] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[17:10:59] [DOC: 9208314] ✅ Patient date processing completed successfully
[17:10:59] ✅    ✅ Date processing completed
[17:10:59] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:59] 🔄 
🔄 Step 4: Extracting order data...
[17:11:02] ℹ️  Order extraction - MRN: ''
[17:11:02] ℹ️  Order extraction - Sex: 'FEMALE'
[17:11:02] ℹ️  Order extraction - Service Line: 'OT, SN'
[17:11:02] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:11:02] ✅ Order data extraction completed successfully
[17:11:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:11:02] ℹ️  Using MRN from patient data: '6190015'
[17:11:02] ℹ️  Combined service lines: Patient='Skilled Nursing, OT' + Order='OT, SN' = 'OT, SN, Skilled Nursing'
[17:11:02] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:11:02] ✅ Patient name cross-validation successful
[17:11:02] ✅    ✅ Data merged successfully
[17:11:03] ✅    ✅ Order data extracted and validated
[17:11:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:11:03] [DOC: 9208314] ✅ Patient found in local cache: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[17:11:03] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[17:11:03] 🔄 
🔄 Step 6: Pushing order to API...
[17:11:03] [DOC: 9208314] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[17:11:04] [DOC: 9208314] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:11:04] ❌    ❌ Failed to push order
[17:11:04] 🔄 
🔄 Step 7: Writing to CSV...
[17:11:04] [DOC: 9208314] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[17:11:04] [DOC: 9208314] ℹ️  Service Line extracted: 'OT, SN, Skilled Nursing'
[17:11:04] [DOC: 9208314] ℹ️  Payer Source extracted: 'Medicare'
[17:11:04] [DOC: 9208314] ℹ️  Diagnosis codes being written:
[17:11:04] [DOC: 9208314] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:11:04] [DOC: 9208314] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:11:04] [DOC: 9208314] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:11:04] [DOC: 9208314] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:11:04] [DOC: 9208314] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:11:04] [DOC: 9208314] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:11:04] [DOC: 9208314] ✅ Patient data written to CSV: John Ostapow | Sex: FEMALE | Age: 89 | Service: OT, SN, Skilled Nursing | Payer: Medicare | MRN: 6190015
[17:11:04] ✅    ✅ Document 9208314 processed and saved successfully
[17:11:04] 🔄 
🔄 Step 8: Saving API details...
[17:11:04] [DOC: 9208314] ℹ️  API push details saved for document 9208314
[17:11:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208313                         ║
================================================================================
[17:11:04] ℹ️  Agency: Dartmouth HH
[17:11:04] ℹ️  Date: 03/28/2025
[17:11:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:11:07] [DOC: 9208313] ✅ Text extracted using pdfplumber (12536 chars)
[17:11:07] ✅    ✅ Text extracted using pdfplumber (12536 chars)
[17:11:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:11:10] ℹ️  AI extracted raw sex value: 'M'
[17:11:10] ℹ️  AI extracted service line: 'PT, SN, HHA'
[17:11:10] ℹ️  AI extracted payer source: 'Medicare'
[17:11:10] ℹ️  AI extracted diagnoses:
[17:11:10] ℹ️    - Diagnosis 1: 'A04.72'
[17:11:10] ℹ️    - Diagnosis 2: 'E86.0'
[17:11:10] ℹ️    - Diagnosis 3: 'G20.A1'
[17:11:10] ℹ️    - Diagnosis 4: 'L89.153'
[17:11:10] ℹ️    - Diagnosis 5: 'I95.9'
[17:11:10] ℹ️    - Diagnosis 6: 'L89.613'
[17:11:10] ℹ️  Final extracted MRN: '1396009'
[17:11:10] ℹ️  Final extracted Sex: 'MALE'
[17:11:10] ℹ️  Final extracted Service Line: 'PT, SN, HHA'
[17:11:10] ℹ️  Final extracted Payer Source: 'Medicare'
[17:11:10] ✅ Patient data extraction completed successfully
[17:11:10] ✅    ✅ Patient data extracted successfully
[17:11:10] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, SN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G20.A1', 'fourthDiagnosis': 'L89.153', 'fifthDiagnosis': 'I95.9', 'sixthDiagnosis': 'L89.613'}]
[17:11:10] ✅    ✅ Patient identified: Elias Ramos
[17:11:10] ✅    ✅ Patient name validation passed
[17:11:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:11:10] [DOC: 9208313] ℹ️  DOB normalized: 08/28/1938
[17:11:10] [DOC: 9208313] ℹ️  Episode startOfCare normalized: 12/31/2024
[17:11:10] [DOC: 9208313] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[17:11:10] [DOC: 9208313] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[17:11:10] [DOC: 9208313] ✅ Patient date processing completed successfully
[17:11:10] ✅    ✅ Date processing completed
[17:11:10] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, SN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G20.A1', 'fourthDiagnosis': 'L89.153', 'fifthDiagnosis': 'I95.9', 'sixthDiagnosis': 'L89.613'}]
[17:11:10] 🔄 
🔄 Step 4: Extracting order data...
[17:11:12] ℹ️  Order extraction - MRN: ''
[17:11:12] ℹ️  Order extraction - Sex: 'MALE'
[17:11:12] ℹ️  Order extraction - Service Line: 'PT, RN, HHA, SN'
[17:11:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:11:12] ✅ Order data extraction completed successfully
[17:11:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:11:12] ℹ️  Using MRN from patient data: '1396009'
[17:11:12] ℹ️  Combined service lines: Patient='PT, SN, HHA' + Order='PT, RN, HHA, SN' = 'HHA, PT, RN, SN'
[17:11:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:11:12] ✅ Patient name cross-validation successful
[17:11:12] ✅    ✅ Data merged successfully
[17:11:13] ✅    ✅ Order data extracted and validated
[17:11:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:11:13] [DOC: 9208313] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[17:11:13] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[17:11:13] 🔄 
🔄 Step 6: Pushing order to API...
[17:11:13] [DOC: 9208313] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[17:11:15] [DOC: 9208313] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:11:15] ❌    ❌ Failed to push order
[17:11:15] 🔄 
🔄 Step 7: Writing to CSV...
[17:11:15] [DOC: 9208313] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[17:11:15] [DOC: 9208313] ℹ️  Service Line extracted: 'HHA, PT, RN, SN'
[17:11:15] [DOC: 9208313] ℹ️  Payer Source extracted: 'Medicare'
[17:11:15] [DOC: 9208313] ℹ️  Diagnosis codes being written:
[17:11:15] [DOC: 9208313] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[17:11:15] [DOC: 9208313] ℹ️    - Latest_Episode_Seconddiagnosis: 'E86.0'
[17:11:15] [DOC: 9208313] ℹ️    - Latest_Episode_Thirddiagnosis: 'G20.A1'
[17:11:15] [DOC: 9208313] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L89.153'
[17:11:15] [DOC: 9208313] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I95.9'
[17:11:15] [DOC: 9208313] ℹ️    - Latest_Episode_Sixthdiagnosis: 'L89.613'
[17:11:15] [DOC: 9208313] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: HHA, PT, RN, SN | Payer: Medicare | MRN: 1396009
[17:11:15] ✅    ✅ Document 9208313 processed and saved successfully
[17:11:15] 🔄 
🔄 Step 8: Saving API details...
[17:11:15] [DOC: 9208313] ℹ️  API push details saved for document 9208313
[17:11:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208311                         ║
================================================================================
[17:11:15] ℹ️  Agency: Dartmouth HH
[17:11:15] ℹ️  Date: 03/28/2025
[17:11:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:11:17] [DOC: 9208311] ✅ Text extracted using pdfplumber (19223 chars)
[17:11:17] ✅    ✅ Text extracted using pdfplumber (19211 chars)
[17:11:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:11:20] ℹ️  AI extracted raw sex value: 'M'
[17:11:20] ℹ️  AI extracted service line: 'Skilled Nursing, OT'
[17:11:20] ℹ️  AI extracted payer source: ''
[17:11:20] ℹ️  AI extracted diagnoses:
[17:11:20] ℹ️    - Diagnosis 1: 'Z47.1'
[17:11:20] ℹ️    - Diagnosis 2: 'Z96.611'
[17:11:20] ℹ️    - Diagnosis 3: 'G89.4'
[17:11:20] ℹ️    - Diagnosis 4: 'M54.50'
[17:11:20] ℹ️    - Diagnosis 5: 'C61'
[17:11:20] ℹ️    - Diagnosis 6: 'N40.1'
[17:11:20] ℹ️  Final extracted MRN: '6047015'
[17:11:20] ℹ️  Final extracted Sex: 'MALE'
[17:11:20] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT'
[17:11:20] ℹ️  Final extracted Payer Source: ''
[17:11:20] ✅ Patient data extraction completed successfully
[17:11:20] ✅    ✅ Patient data extracted successfully
[17:11:20] 📊 Patient Response
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'C61', 'sixthDiagnosis': 'N40.1'}]
[17:11:20] ✅    ✅ Patient identified: Keith Boling
[17:11:20] ✅    ✅ Patient name validation passed
[17:11:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:11:20] [DOC: 9208311] ℹ️  DOB normalized: 04/09/1950
[17:11:20] [DOC: 9208311] ℹ️  Episode startOfCare normalized: 03/14/2025
[17:11:20] [DOC: 9208311] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[17:11:20] [DOC: 9208311] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[17:11:20] [DOC: 9208311] ✅ Patient date processing completed successfully
[17:11:20] ✅    ✅ Date processing completed
[17:11:20] 📊 Processed Patient Data
     └─ patientFName: Keith
     └─ patientLName: Boling
     └─ dob: 04/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6047015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'C61', 'sixthDiagnosis': 'N40.1'}]
[17:11:20] 🔄 
🔄 Step 4: Extracting order data...
[17:11:23] ℹ️  Order extraction - MRN: '6047015'
[17:11:23] ℹ️  Order extraction - Sex: 'MALE'
[17:11:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[17:11:23] ℹ️  Order extraction - Payer Source: ''
[17:11:23] ✅ Order data extraction completed successfully
[17:11:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:11:23] ℹ️  Using MRN from patient data: '6047015' over '6047015'
[17:11:23] ℹ️  Combined service lines: Patient='Skilled Nursing, OT' + Order='Skilled Nursing, Occupational Therapy' = 'OT, Occupational Therapy, Skilled Nursing'
[17:11:23] ✅ Patient name cross-validation successful
[17:11:23] ✅    ✅ Data merged successfully
[17:11:24] ✅    ✅ Order data extracted and validated
[17:11:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:11:24] [DOC: 9208311] ✅ Patient found in local cache: Keith Boling, ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[17:11:24] ✅    ✅ Existing patient found with ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[17:11:24] 🔄 
🔄 Step 6: Pushing order to API...
[17:11:24] [DOC: 9208311] ℹ️  Pushing order via API for patient ID: 71142c74-f5b3-43b5-b686-d8fa1c71cbb0
[17:11:26] [DOC: 9208311] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:11:26] ❌    ❌ Failed to push order
[17:11:26] 🔄 
🔄 Step 7: Writing to CSV...
[17:11:26] [DOC: 9208311] ℹ️  Calculated age: 75 from DOB: 04/09/1950
[17:11:26] [DOC: 9208311] ℹ️  Service Line extracted: 'OT, Occupational Therapy, Skilled Nursing'
[17:11:26] [DOC: 9208311] ℹ️  Payer Source extracted: ''
[17:11:26] [DOC: 9208311] ℹ️  Diagnosis codes being written:
[17:11:26] [DOC: 9208311] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[17:11:26] [DOC: 9208311] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.611'
[17:11:26] [DOC: 9208311] ℹ️    - Latest_Episode_Thirddiagnosis: 'G89.4'
[17:11:26] [DOC: 9208311] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.50'
[17:11:26] [DOC: 9208311] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C61'
[17:11:26] [DOC: 9208311] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[17:11:26] [DOC: 9208311] ✅ Patient data written to CSV: Keith Boling | Sex: MALE | Age: 75 | Service: OT, Occupational Therapy, Skilled Nursing | Payer:  | MRN: 6047015
[17:11:26] ✅    ✅ Document 9208311 processed and saved successfully
[17:11:26] 🔄 
🔄 Step 8: Saving API details...
[17:11:26] [DOC: 9208311] ℹ️  API push details saved for document 9208311
[17:11:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208308                         ║
================================================================================
[17:11:26] ℹ️  Agency: Dartmouth HH
[17:11:26] ℹ️  Date: 03/28/2025
[17:11:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:11:28] [DOC: 9208308] ✅ Text extracted using pdfplumber (7102 chars)
[17:11:28] ✅    ✅ Text extracted using pdfplumber (7102 chars)
[17:11:28] 🔄 
🔄 Step 2: Extracting patient data...
[17:11:31] ℹ️  AI extracted raw sex value: 'F'
[17:11:31] ℹ️  AI extracted service line: 'OT'
[17:11:31] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[17:11:31] ℹ️  AI extracted diagnoses:
[17:11:31] ℹ️    - Diagnosis 1: 'None'
[17:11:31] ℹ️    - Diagnosis 2: 'None'
[17:11:31] ℹ️    - Diagnosis 3: 'None'
[17:11:31] ℹ️    - Diagnosis 4: 'None'
[17:11:31] ℹ️    - Diagnosis 5: 'None'
[17:11:31] ℹ️    - Diagnosis 6: 'None'
[17:11:31] ℹ️  Final extracted MRN: '5843015'
[17:11:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:11:31] ℹ️  Final extracted Service Line: 'OT'
[17:11:31] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[17:11:31] ✅ Patient data extraction completed successfully
[17:11:31] ✅    ✅ Patient data extracted successfully
[17:11:31] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '03/15/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:11:31] ✅    ✅ Patient identified: Joanne Medeiros
[17:11:31] ✅    ✅ Patient name validation passed
[17:11:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:11:31] [DOC: 9208308] ℹ️  DOB normalized: 12/09/1952
[17:11:31] [DOC: 9208308] ℹ️  Episode startOfCare normalized: 01/15/2025
[17:11:31] [DOC: 9208308] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[17:11:31] [DOC: 9208308] ℹ️  Episode endOfEpisode normalized: 03/15/2025
[17:11:31] [DOC: 9208308] ✅ Patient date processing completed successfully
[17:11:31] ✅    ✅ Date processing completed
[17:11:31] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '03/15/2025'}]
[17:11:31] 🔄 
🔄 Step 4: Extracting order data...
[17:11:33] ℹ️  Order extraction - MRN: '5843015'
[17:11:33] ℹ️  Order extraction - Sex: 'FEMALE'
[17:11:33] ℹ️  Order extraction - Service Line: 'OT'
[17:11:33] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[17:11:33] ✅ Order data extraction completed successfully
[17:11:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:11:33] ℹ️  Using MRN from patient data: '5843015' over '5843015'
[17:11:33] ℹ️  Service line consistent in both sources: 'OT'
[17:11:33] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[17:11:33] ✅ Patient name cross-validation successful
[17:11:33] ✅    ✅ Data merged successfully
[17:11:34] ✅    ✅ Order data extracted and validated
[17:11:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:11:44] [DOC: 9208308] ℹ️  Patient not found in cache or API: Joanne Medeiros
[17:11:44] [DOC: 9208308] ℹ️  Patient not found, creating new patient via API...
[17:11:44] [DOC: 9208308] ℹ️  Creating patient via API: Joanne Medeiros
[17:11:46] [DOC: 9208308] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:11:46] ❌    ❌ Failed to create patient
[17:11:46] [DOC: 9208308] ℹ️  API push details saved for document 9208308
================================================================================
║                        Processing Document ID: 9208306                         ║
================================================================================
[17:11:46] ℹ️  Agency: Dartmouth HH
[17:11:46] ℹ️  Date: 03/28/2025
[17:11:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:11:48] [DOC: 9208306] ✅ Text extracted using pdfplumber (8159 chars)
[17:11:48] ✅    ✅ Text extracted using pdfplumber (8147 chars)
[17:11:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:11:51] ℹ️  AI extracted raw sex value: 'M'
[17:11:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:11:51] ℹ️  AI extracted payer source: 'None'
[17:11:51] ℹ️  AI extracted diagnoses:
[17:11:51] ℹ️    - Diagnosis 1: 'I11.0'
[17:11:51] ℹ️    - Diagnosis 2: 'I50.9'
[17:11:51] ℹ️    - Diagnosis 3: 'M47.896'
[17:11:51] ℹ️    - Diagnosis 4: 'I48.91'
[17:11:51] ℹ️    - Diagnosis 5: 'K21.9'
[17:11:51] ℹ️    - Diagnosis 6: 'E78.5'
[17:11:51] ℹ️  Final extracted MRN: '227027'
[17:11:51] ℹ️  Final extracted Sex: 'MALE'
[17:11:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:11:51] ℹ️  Final extracted Payer Source: ''
[17:11:51] ✅ Patient data extraction completed successfully
[17:11:51] ✅    ✅ Patient data extracted successfully
[17:11:51] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'M47.896', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'E78.5'}]
[17:11:51] ✅    ✅ Patient identified: John Ostapow
[17:11:51] ✅    ✅ Patient name validation passed
[17:11:51] 🔄 
🔄 Step 3: Processing patient dates...
[17:11:51] [DOC: 9208306] ℹ️  DOB normalized: 11/23/1935
[17:11:51] [DOC: 9208306] ℹ️  Episode startOfCare normalized: 03/12/2025
[17:11:51] [DOC: 9208306] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:11:51] [DOC: 9208306] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[17:11:51] [DOC: 9208306] ✅ Patient date processing completed successfully
[17:11:51] ✅    ✅ Date processing completed
[17:11:51] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'M47.896', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'E78.5'}]
[17:11:51] 🔄 
🔄 Step 4: Extracting order data...
[17:11:53] ℹ️  Order extraction - MRN: '6190015'
[17:11:53] ℹ️  Order extraction - Sex: 'MALE'
[17:11:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:11:53] ℹ️  Order extraction - Payer Source: ''
[17:11:53] ✅ Order data extraction completed successfully
[17:11:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:11:53] ℹ️  Using longer MRN from order data: '6190015' over '227027'
[17:11:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:11:53] ✅ Patient name cross-validation successful
[17:11:53] ✅    ✅ Data merged successfully
[17:11:55] ✅    ✅ Order data extracted and validated
[17:11:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:11:55] [DOC: 9208306] ✅ Patient found in local cache: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[17:11:55] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[17:11:55] 🔄 
🔄 Step 6: Pushing order to API...
[17:11:55] [DOC: 9208306] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[17:11:56] [DOC: 9208306] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:11:56] ❌    ❌ Failed to push order
[17:11:56] 🔄 
🔄 Step 7: Writing to CSV...
[17:11:56] [DOC: 9208306] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[17:11:56] [DOC: 9208306] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:11:56] [DOC: 9208306] ℹ️  Payer Source extracted: ''
[17:11:56] [DOC: 9208306] ℹ️  Diagnosis codes being written:
[17:11:56] [DOC: 9208306] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[17:11:56] [DOC: 9208306] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[17:11:56] [DOC: 9208306] ℹ️    - Latest_Episode_Thirddiagnosis: 'M47.896'
[17:11:56] [DOC: 9208306] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.91'
[17:11:56] [DOC: 9208306] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K21.9'
[17:11:56] [DOC: 9208306] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[17:11:56] [DOC: 9208306] ✅ Patient data written to CSV: John Ostapow | Sex: MALE | Age: 89 | Service: Skilled Nursing | Payer:  | MRN: 6190015
[17:11:56] ✅    ✅ Document 9208306 processed and saved successfully
[17:11:56] 🔄 
🔄 Step 8: Saving API details...
[17:11:56] [DOC: 9208306] ℹ️  API push details saved for document 9208306
[17:11:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208299                         ║
================================================================================
[17:11:56] ℹ️  Agency: Fairhaven HH&H
[17:11:56] ℹ️  Date: 03/28/2025
[17:11:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:11:58] [DOC: 9208299] ✅ Text extracted using pdfplumber (1488 chars)
[17:11:58] ✅    ✅ Text extracted using pdfplumber (1488 chars)
[17:11:58] 🔄 
🔄 Step 2: Extracting patient data...
[17:12:01] ℹ️  AI extracted raw sex value: 'F'
[17:12:01] ℹ️  AI extracted service line: 'HHA'
[17:12:01] ℹ️  AI extracted payer source: 'Medicare'
[17:12:01] ℹ️  AI extracted diagnoses:
[17:12:01] ℹ️    - Diagnosis 1: 'None'
[17:12:01] ℹ️    - Diagnosis 2: 'None'
[17:12:01] ℹ️    - Diagnosis 3: 'None'
[17:12:01] ℹ️    - Diagnosis 4: 'None'
[17:12:01] ℹ️    - Diagnosis 5: 'None'
[17:12:01] ℹ️    - Diagnosis 6: 'None'
[17:12:01] ℹ️  Final extracted MRN: '3122001'
[17:12:01] ℹ️  Final extracted Sex: 'FEMALE'
[17:12:01] ℹ️  Final extracted Service Line: 'HHA'
[17:12:01] ℹ️  Final extracted Payer Source: 'Medicare'
[17:12:01] ✅ Patient data extraction completed successfully
[17:12:01] ✅    ✅ Patient data extracted successfully
[17:12:01] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Luckraft
     └─ dob: 01/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3122001
     └─ billingProvider: ACO Health Solutions
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:12:01] ✅    ✅ Patient identified: Louise Luckraft
[17:12:01] ✅    ✅ Patient name validation passed
[17:12:01] 🔄 
🔄 Step 3: Processing patient dates...
[17:12:01] [DOC: 9208299] ℹ️  DOB normalized: 01/15/1935
[17:12:01] [DOC: 9208299] ℹ️  Episode startOfCare normalized: 01/09/2025
[17:12:01] [DOC: 9208299] ℹ️  Episode startOfEpisode normalized: 01/09/2025
[17:12:01] [DOC: 9208299] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[17:12:01] [DOC: 9208299] ✅ Patient date processing completed successfully
[17:12:01] ✅    ✅ Date processing completed
[17:12:01] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Luckraft
     └─ dob: 01/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3122001
     └─ billingProvider: ACO Health Solutions
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/09/2025', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '04/08/2025'}]
[17:12:01] 🔄 
🔄 Step 4: Extracting order data...
[17:12:03] ℹ️  Order extraction - MRN: ''
[17:12:03] ℹ️  Order extraction - Sex: 'FEMALE'
[17:12:03] ℹ️  Order extraction - Service Line: ''
[17:12:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:12:03] ✅ Order data extraction completed successfully
[17:12:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:12:03] ℹ️  Using MRN from patient data: '3122001'
[17:12:03] ℹ️  Using service line from patient data: 'HHA'
[17:12:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:12:03] ✅ Patient name cross-validation successful
[17:12:03] ✅    ✅ Data merged successfully
[17:12:05] ✅    ✅ Order data extracted and validated
[17:12:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:12:10] [DOC: 9208299] ✅ Patient exists in API: Louise Luckraft, ID: e9d728ed-4871-45e2-9dee-a509a1e1f38e
[17:12:10] ✅    ✅ Existing patient found with ID: e9d728ed-4871-45e2-9dee-a509a1e1f38e
[17:12:10] 🔄 
🔄 Step 6: Pushing order to API...
[17:12:10] [DOC: 9208299] ℹ️  Pushing order via API for patient ID: e9d728ed-4871-45e2-9dee-a509a1e1f38e
[17:12:11] [DOC: 9208299] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:12:11] ❌    ❌ Failed to push order
[17:12:11] 🔄 
🔄 Step 7: Writing to CSV...
[17:12:11] [DOC: 9208299] ℹ️  Calculated age: 90 from DOB: 01/15/1935
[17:12:11] [DOC: 9208299] ℹ️  Service Line extracted: 'HHA'
[17:12:11] [DOC: 9208299] ℹ️  Payer Source extracted: 'Medicare'
[17:12:11] [DOC: 9208299] ℹ️  Diagnosis codes being written:
[17:12:11] [DOC: 9208299] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:12:11] [DOC: 9208299] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:12:11] [DOC: 9208299] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:12:11] [DOC: 9208299] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:12:11] [DOC: 9208299] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:12:11] [DOC: 9208299] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:12:11] [DOC: 9208299] ✅ Patient data written to CSV: Louise Luckraft | Sex: FEMALE | Age: 90 | Service: HHA | Payer: Medicare | MRN: 3122001
[17:12:11] ✅    ✅ Document 9208299 processed and saved successfully
[17:12:11] 🔄 
🔄 Step 8: Saving API details...
[17:12:11] [DOC: 9208299] ℹ️  API push details saved for document 9208299
[17:12:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208298                         ║
================================================================================
[17:12:11] ℹ️  Agency: Fairhaven HH&H
[17:12:11] ℹ️  Date: 03/28/2025
[17:12:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:12:13] [DOC: 9208298] ✅ Text extracted using pdfplumber (3027 chars)
[17:12:13] ✅    ✅ Text extracted using pdfplumber (3027 chars)
[17:12:13] 🔄 
🔄 Step 2: Extracting patient data...
[17:12:16] ℹ️  AI extracted raw sex value: 'F'
[17:12:16] ℹ️  AI extracted service line: 'HHA'
[17:12:16] ℹ️  AI extracted payer source: 'Medicare'
[17:12:16] ℹ️  AI extracted diagnoses:
[17:12:16] ℹ️    - Diagnosis 1: 'CHF'
[17:12:16] ℹ️    - Diagnosis 2: 'arthritis'
[17:12:16] ℹ️    - Diagnosis 3: 'breast Ca w/ mastectomy'
[17:12:16] ℹ️    - Diagnosis 4: 'osteoporosis'
[17:12:16] ℹ️    - Diagnosis 5: 'anemia'
[17:12:16] ℹ️    - Diagnosis 6: 'a-fib'
[17:12:16] ℹ️  Final extracted MRN: '3156011'
[17:12:16] ℹ️  Final extracted Sex: 'FEMALE'
[17:12:16] ℹ️  Final extracted Service Line: 'HHA'
[17:12:16] ℹ️  Final extracted Payer Source: 'Medicare'
[17:12:16] ✅ Patient data extraction completed successfully
[17:12:16] ✅    ✅ Patient data extracted successfully
[17:12:16] 📊 Patient Response
     └─ patientFName: Rose
     └─ patientLName: Gouveia
     └─ dob: 03/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3156011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'arthritis', 'thirdDiagnosis': 'breast Ca w/ mastectomy', 'fourthDiagnosis': 'osteoporosis', 'fifthDiagnosis': 'anemia', 'sixthDiagnosis': 'a-fib'}]
[17:12:16] ✅    ✅ Patient identified: Rose Gouveia
[17:12:16] ✅    ✅ Patient name validation passed
[17:12:16] 🔄 
🔄 Step 3: Processing patient dates...
[17:12:16] [DOC: 9208298] ℹ️  DOB normalized: 03/06/1931
[17:12:16] [DOC: 9208298] ℹ️  Episode startOfCare normalized: 05/28/2024
[17:12:16] [DOC: 9208298] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[17:12:16] [DOC: 9208298] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[17:12:16] [DOC: 9208298] ✅ Patient date processing completed successfully
[17:12:16] ✅    ✅ Date processing completed
[17:12:16] 📊 Processed Patient Data
     └─ patientFName: Rose
     └─ patientLName: Gouveia
     └─ dob: 03/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3156011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2024', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'arthritis', 'thirdDiagnosis': 'breast Ca w/ mastectomy', 'fourthDiagnosis': 'osteoporosis', 'fifthDiagnosis': 'anemia', 'sixthDiagnosis': 'a-fib'}]
[17:12:16] 🔄 
🔄 Step 4: Extracting order data...
[17:12:19] ℹ️  Order extraction - MRN: ''
[17:12:19] ℹ️  Order extraction - Sex: 'FEMALE'
[17:12:19] ℹ️  Order extraction - Service Line: 'RN, HHA'
[17:12:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:12:19] ✅ Order data extraction completed successfully
[17:12:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:12:19] ℹ️  Using MRN from patient data: '3156011'
[17:12:19] ℹ️  Combined service lines: Patient='HHA' + Order='RN, HHA' = 'HHA, RN'
[17:12:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:12:19] ✅ Patient name cross-validation successful
[17:12:19] ✅    ✅ Data merged successfully
[17:12:20] ✅    ✅ Order data extracted and validated
[17:12:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:12:29] [DOC: 9208298] ✅ Patient exists in API: Rose Gouveia, ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[17:12:29] ✅    ✅ Existing patient found with ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[17:12:29] 🔄 
🔄 Step 6: Pushing order to API...
[17:12:29] [DOC: 9208298] ℹ️  Pushing order via API for patient ID: cd702c44-3ace-45cf-88dc-c367edf63c08
[17:12:30] [DOC: 9208298] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13816"}
[17:12:30] ❌    ❌ Failed to push order
[17:12:30] 🔄 
🔄 Step 7: Writing to CSV...
[17:12:30] [DOC: 9208298] ℹ️  Calculated age: 94 from DOB: 03/06/1931
[17:12:30] [DOC: 9208298] ℹ️  Service Line extracted: 'HHA, RN'
[17:12:30] [DOC: 9208298] ℹ️  Payer Source extracted: 'Medicare'
[17:12:30] [DOC: 9208298] ℹ️  Diagnosis codes being written:
[17:12:30] [DOC: 9208298] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[17:12:30] [DOC: 9208298] ℹ️    - Latest_Episode_Seconddiagnosis: 'arthritis'
[17:12:30] [DOC: 9208298] ℹ️    - Latest_Episode_Thirddiagnosis: 'breast Ca w/ mastectomy'
[17:12:30] [DOC: 9208298] ℹ️    - Latest_Episode_Fourthdiagnosis: 'osteoporosis'
[17:12:30] [DOC: 9208298] ℹ️    - Latest_Episode_Fifthdiagnosis: 'anemia'
[17:12:30] [DOC: 9208298] ℹ️    - Latest_Episode_Sixthdiagnosis: 'a-fib'
[17:12:30] [DOC: 9208298] ✅ Patient data written to CSV: Rose Gouveia | Sex: FEMALE | Age: 94 | Service: HHA, RN | Payer: Medicare | MRN: 3156011
[17:12:30] ✅    ✅ Document 9208298 processed and saved successfully
[17:12:30] 🔄 
🔄 Step 8: Saving API details...
[17:12:30] [DOC: 9208298] ℹ️  API push details saved for document 9208298
[17:12:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208296                         ║
================================================================================
[17:12:30] ℹ️  Agency: Fairhaven HH&H
[17:12:30] ℹ️  Date: 03/28/2025
[17:12:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:12:32] [DOC: 9208296] ✅ Text extracted using pdfplumber (1073 chars)
[17:12:32] ✅    ✅ Text extracted using pdfplumber (1073 chars)
[17:12:32] 🔄 
🔄 Step 2: Extracting patient data...
[17:12:35] ℹ️  AI extracted raw sex value: 'M'
[17:12:35] ℹ️  AI extracted service line: 'RN'
[17:12:35] ℹ️  AI extracted payer source: 'Medicare'
[17:12:35] ℹ️  AI extracted diagnoses:
[17:12:35] ℹ️    - Diagnosis 1: ''
[17:12:35] ℹ️    - Diagnosis 2: ''
[17:12:35] ℹ️    - Diagnosis 3: ''
[17:12:35] ℹ️    - Diagnosis 4: ''
[17:12:35] ℹ️    - Diagnosis 5: ''
[17:12:35] ℹ️    - Diagnosis 6: ''
[17:12:35] ℹ️  Final extracted MRN: '2486002'
[17:12:35] ℹ️  Final extracted Sex: 'MALE'
[17:12:35] ℹ️  Final extracted Service Line: 'RN'
[17:12:35] ℹ️  Final extracted Payer Source: 'Medicare'
[17:12:35] ✅ Patient data extraction completed successfully
[17:12:35] ✅    ✅ Patient data extracted successfully
[17:12:35] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Andrade
     └─ dob: 06/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2486002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:12:35] ✅    ✅ Patient identified: Robert Andrade
[17:12:35] ✅    ✅ Patient name validation passed
[17:12:35] 🔄 
🔄 Step 3: Processing patient dates...
[17:12:35] [DOC: 9208296] ℹ️  DOB normalized: 06/25/1943
[17:12:35] [DOC: 9208296] ℹ️  Episode startOfCare normalized: 12/19/2024
[17:12:35] [DOC: 9208296] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[17:12:35] [DOC: 9208296] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[17:12:35] [DOC: 9208296] ✅ Patient date processing completed successfully
[17:12:35] ✅    ✅ Date processing completed
[17:12:35] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Andrade
     └─ dob: 06/25/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2486002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:12:35] 🔄 
🔄 Step 4: Extracting order data...
[17:12:37] ℹ️  Order extraction - MRN: ''
[17:12:37] ℹ️  Order extraction - Sex: 'MALE'
[17:12:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:12:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:12:37] ✅ Order data extraction completed successfully
[17:12:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:12:37] ℹ️  Using MRN from patient data: '2486002'
[17:12:37] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[17:12:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:12:37] ✅ Patient name cross-validation successful
[17:12:37] ✅    ✅ Data merged successfully
[17:12:39] ✅    ✅ Order data extracted and validated
[17:12:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:12:52] [DOC: 9208296] ✅ Patient exists in API: Robert Andrade, ID: e367e440-5660-423f-9c06-de94c71235ec
[17:12:52] ✅    ✅ Existing patient found with ID: e367e440-5660-423f-9c06-de94c71235ec
[17:12:52] 🔄 
🔄 Step 6: Pushing order to API...
[17:12:52] [DOC: 9208296] ℹ️  Pushing order via API for patient ID: e367e440-5660-423f-9c06-de94c71235ec
[17:12:53] [DOC: 9208296] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:12:53] ❌    ❌ Failed to push order
[17:12:53] 🔄 
🔄 Step 7: Writing to CSV...
[17:12:53] [DOC: 9208296] ℹ️  Calculated age: 81 from DOB: 06/25/1943
[17:12:53] [DOC: 9208296] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[17:12:53] [DOC: 9208296] ℹ️  Payer Source extracted: 'Medicare'
[17:12:53] [DOC: 9208296] ℹ️  Diagnosis codes being written:
[17:12:53] [DOC: 9208296] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:12:53] [DOC: 9208296] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:12:53] [DOC: 9208296] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:12:53] [DOC: 9208296] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:12:53] [DOC: 9208296] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:12:53] [DOC: 9208296] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:12:53] [DOC: 9208296] ✅ Patient data written to CSV: Robert Andrade | Sex: MALE | Age: 81 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 2486002
[17:12:53] ✅    ✅ Document 9208296 processed and saved successfully
[17:12:53] 🔄 
🔄 Step 8: Saving API details...
[17:12:53] [DOC: 9208296] ℹ️  API push details saved for document 9208296
[17:12:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208268                         ║
================================================================================
[17:12:53] ℹ️  Agency: Fairhaven HH&H
[17:12:53] ℹ️  Date: 03/28/2025
[17:12:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:12:55] [DOC: 9208268] ✅ Text extracted using pdfplumber (5799 chars)
[17:12:55] ✅    ✅ Text extracted using pdfplumber (5799 chars)
[17:12:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:12:58] ℹ️  AI extracted raw sex value: 'F'
[17:12:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:12:58] ℹ️  AI extracted payer source: 'Medicare'
[17:12:58] ℹ️  AI extracted diagnoses:
[17:12:58] ℹ️    - Diagnosis 1: 'G30'
[17:12:58] ℹ️    - Diagnosis 2: 'I10'
[17:12:58] ℹ️    - Diagnosis 3: 'N18.3'
[17:12:58] ℹ️    - Diagnosis 4: 'F41.1'
[17:12:58] ℹ️    - Diagnosis 5: 'F32.9'
[17:12:58] ℹ️    - Diagnosis 6: 'C55.9'
[17:12:58] ℹ️  Final extracted MRN: '5350011'
[17:12:58] ℹ️  Final extracted Sex: 'FEMALE'
[17:12:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:12:58] ℹ️  Final extracted Payer Source: 'Medicare'
[17:12:58] ✅ Patient data extraction completed successfully
[17:12:58] ✅    ✅ Patient data extracted successfully
[17:12:58] 📊 Patient Response
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': 'G30', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'N18.3', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'F32.9', 'sixthDiagnosis': 'C55.9'}]
[17:12:58] ✅    ✅ Patient identified: Rosemary Crompton
[17:12:58] ✅    ✅ Patient name validation passed
[17:12:58] 🔄 
🔄 Step 3: Processing patient dates...
[17:12:58] [DOC: 9208268] ℹ️  DOB normalized: 08/17/1944
[17:12:58] [DOC: 9208268] ℹ️  Episode startOfCare normalized: 12/02/2023
[17:12:58] [DOC: 9208268] ℹ️  Episode startOfEpisode normalized: 01/25/2025
[17:12:58] [DOC: 9208268] ℹ️  Episode endOfEpisode normalized: 03/25/2025
[17:12:58] [DOC: 9208268] ✅ Patient date processing completed successfully
[17:12:58] ✅    ✅ Date processing completed
[17:12:58] 📊 Processed Patient Data
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': 'G30', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'N18.3', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'F32.9', 'sixthDiagnosis': 'C55.9'}]
[17:12:58] 🔄 
🔄 Step 4: Extracting order data...
[17:13:00] ℹ️  Order extraction - MRN: ''
[17:13:00] ℹ️  Order extraction - Sex: 'FEMALE'
[17:13:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:13:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:13:00] ✅ Order data extraction completed successfully
[17:13:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:13:00] ℹ️  Using MRN from patient data: '5350011'
[17:13:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:13:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:13:00] ✅ Patient name cross-validation successful
[17:13:00] ✅    ✅ Data merged successfully
[17:13:02] ✅    ✅ Order data extracted and validated
[17:13:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:13:02] [DOC: 9208268] ✅ Patient found in local cache: Rosemary Crompton, ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[17:13:02] ✅    ✅ Existing patient found with ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[17:13:02] 🔄 
🔄 Step 6: Pushing order to API...
[17:13:02] [DOC: 9208268] ℹ️  Pushing order via API for patient ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[17:13:03] [DOC: 9208268] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:13:03] ❌    ❌ Failed to push order
[17:13:03] 🔄 
🔄 Step 7: Writing to CSV...
[17:13:03] [DOC: 9208268] ℹ️  Calculated age: 80 from DOB: 08/17/1944
[17:13:03] [DOC: 9208268] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:13:03] [DOC: 9208268] ℹ️  Payer Source extracted: 'Medicare'
[17:13:03] [DOC: 9208268] ℹ️  Diagnosis codes being written:
[17:13:03] [DOC: 9208268] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30'
[17:13:03] [DOC: 9208268] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[17:13:03] [DOC: 9208268] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.3'
[17:13:03] [DOC: 9208268] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.1'
[17:13:03] [DOC: 9208268] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.9'
[17:13:03] [DOC: 9208268] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C55.9'
[17:13:03] [DOC: 9208268] ✅ Patient data written to CSV: Rosemary Crompton | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 5350011
[17:13:03] ✅    ✅ Document 9208268 processed and saved successfully
[17:13:03] 🔄 
🔄 Step 8: Saving API details...
[17:13:03] [DOC: 9208268] ℹ️  API push details saved for document 9208268
[17:13:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208266                         ║
================================================================================
[17:13:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:13:03] ℹ️  Date: 03/28/2025
[17:13:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:13:04] [DOC: 9208266] ✅ Text extracted using pdfplumber (1006 chars)
[17:13:04] ✅    ✅ Text extracted using pdfplumber (1006 chars)
[17:13:04] 🔄 
🔄 Step 2: Extracting patient data...
[17:13:07] ℹ️  AI extracted raw sex value: 'F'
[17:13:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:13:07] ℹ️  AI extracted payer source: ''
[17:13:07] ℹ️  AI extracted diagnoses:
[17:13:07] ℹ️    - Diagnosis 1: 'None'
[17:13:07] ℹ️    - Diagnosis 2: 'None'
[17:13:07] ℹ️    - Diagnosis 3: 'None'
[17:13:07] ℹ️    - Diagnosis 4: 'None'
[17:13:07] ℹ️    - Diagnosis 5: 'None'
[17:13:07] ℹ️    - Diagnosis 6: 'None'
[17:13:07] ℹ️  Final extracted MRN: '2121459'
[17:13:07] ℹ️  Final extracted Sex: 'FEMALE'
[17:13:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:13:07] ℹ️  Final extracted Payer Source: ''
[17:13:07] ✅ Patient data extraction completed successfully
[17:13:07] ✅    ✅ Patient data extracted successfully
[17:13:07] 📊 Patient Response
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:13:07] ✅    ✅ Patient identified: Anita Rodrigues
[17:13:07] ✅    ✅ Patient name validation passed
[17:13:07] 🔄 
🔄 Step 3: Processing patient dates...
[17:13:07] [DOC: 9208266] ℹ️  DOB normalized: 09/12/1942
[17:13:07] [DOC: 9208266] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[17:13:07] [DOC: 9208266] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[17:13:07] [DOC: 9208266] ✅ Patient date processing completed successfully
[17:13:07] ✅    ✅ Date processing completed
[17:13:07] 📊 Processed Patient Data
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025'}]
[17:13:07] 🔄 
🔄 Step 4: Extracting order data...
[17:13:10] ℹ️  Order extraction - MRN: '2121459'
[17:13:10] ℹ️  Order extraction - Sex: 'FEMALE'
[17:13:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:13:10] ℹ️  Order extraction - Payer Source: ''
[17:13:10] ✅ Order data extraction completed successfully
[17:13:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:13:10] ℹ️  Using MRN from patient data: '2121459' over '2121459'
[17:13:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:13:10] ✅ Patient name cross-validation successful
[17:13:10] ✅    ✅ Data merged successfully
[17:13:11] ✅    ✅ Order data extracted and validated
[17:13:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:13:16] [DOC: 9208266] ℹ️  Patient not found in cache or API: Anita Rodrigues
[17:13:16] [DOC: 9208266] ℹ️  Patient not found, creating new patient via API...
[17:13:16] [DOC: 9208266] ℹ️  Creating patient via API: Anita Rodrigues
[17:13:17] [DOC: 9208266] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:13:17] ❌    ❌ Failed to create patient
[17:13:17] [DOC: 9208266] ℹ️  API push details saved for document 9208266
================================================================================
║                        Processing Document ID: 9208263                         ║
================================================================================
[17:13:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:13:17] ℹ️  Date: 03/28/2025
[17:13:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:13:19] [DOC: 9208263] ✅ Text extracted using pdfplumber (1342 chars)
[17:13:19] ✅    ✅ Text extracted using pdfplumber (1342 chars)
[17:13:19] 🔄 
🔄 Step 2: Extracting patient data...
[17:13:22] ℹ️  AI extracted raw sex value: 'M'
[17:13:22] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[17:13:22] ℹ️  AI extracted payer source: ''
[17:13:22] ℹ️  AI extracted diagnoses:
[17:13:22] ℹ️    - Diagnosis 1: 'None'
[17:13:22] ℹ️    - Diagnosis 2: 'None'
[17:13:22] ℹ️    - Diagnosis 3: 'None'
[17:13:22] ℹ️    - Diagnosis 4: 'None'
[17:13:22] ℹ️    - Diagnosis 5: 'None'
[17:13:22] ℹ️    - Diagnosis 6: 'None'
[17:13:22] ℹ️  Final extracted MRN: '2060640'
[17:13:22] ℹ️  Final extracted Sex: 'MALE'
[17:13:22] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[17:13:22] ℹ️  Final extracted Payer Source: ''
[17:13:22] ✅ Patient data extraction completed successfully
[17:13:22] ✅    ✅ Patient data extracted successfully
[17:13:22] 📊 Patient Response
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:13:22] ✅    ✅ Patient identified: Elisio Pimental
[17:13:22] ✅    ✅ Patient name validation passed
[17:13:22] 🔄 
🔄 Step 3: Processing patient dates...
[17:13:22] [DOC: 9208263] ℹ️  DOB normalized: 05/17/1944
[17:13:22] [DOC: 9208263] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[17:13:22] [DOC: 9208263] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[17:13:22] [DOC: 9208263] ✅ Patient date processing completed successfully
[17:13:22] ✅    ✅ Date processing completed
[17:13:22] 📊 Processed Patient Data
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025'}]
[17:13:22] 🔄 
🔄 Step 4: Extracting order data...
[17:13:24] ℹ️  Order extraction - MRN: '2060640'
[17:13:24] ℹ️  Order extraction - Sex: 'MALE'
[17:13:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[17:13:24] ℹ️  Order extraction - Payer Source: ''
[17:13:24] ✅ Order data extraction completed successfully
[17:13:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:13:24] ℹ️  Using MRN from patient data: '2060640' over '2060640'
[17:13:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[17:13:24] ✅ Patient name cross-validation successful
[17:13:24] ✅    ✅ Data merged successfully
[17:13:25] ✅    ✅ Order data extracted and validated
[17:13:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:13:25] [DOC: 9208263] ✅ Patient found in local cache: Elisio Pimental, ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[17:13:25] ✅    ✅ Existing patient found with ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[17:13:25] 🔄 
🔄 Step 6: Pushing order to API...
[17:13:25] [DOC: 9208263] ℹ️  Pushing order via API for patient ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[17:13:27] [DOC: 9208263] ❌ Order push failed with status 201: {"id":"d8d82924-02f7-4c2f-981e-df4a7ed8327a","orderWAVId":"ORD20073","orderNo":"1075239, 1075240","orderDate":"03/26/2025","startOfCare":"03/26/2025","episodeStartDate":"03/26/2025","episodeEndDate":"05/24/2025","documentID":"9208263","mrn":"2060640","patientName":"Pimental,Elisio C","sentToPhysicianDate":"03/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"5abd79cf-ab92-43b9-8f9e-55ba862ed92b","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:13:27] ❌    ❌ Failed to push order
[17:13:27] 🔄 
🔄 Step 7: Writing to CSV...
[17:13:27] [DOC: 9208263] ℹ️  Calculated age: 81 from DOB: 05/17/1944
[17:13:27] [DOC: 9208263] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[17:13:27] [DOC: 9208263] ℹ️  Payer Source extracted: ''
[17:13:27] [DOC: 9208263] ℹ️  Diagnosis codes being written:
[17:13:27] [DOC: 9208263] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:13:27] [DOC: 9208263] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:13:27] [DOC: 9208263] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:13:27] [DOC: 9208263] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:13:27] [DOC: 9208263] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:13:27] [DOC: 9208263] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:13:27] [DOC: 9208263] ✅ Patient data written to CSV: Elisio Pimental | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2060640
[17:13:27] ✅    ✅ Document 9208263 processed and saved successfully
[17:13:27] 🔄 
🔄 Step 8: Saving API details...
[17:13:27] [DOC: 9208263] ℹ️  API push details saved for document 9208263
[17:13:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208257                         ║
================================================================================
[17:13:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:13:27] ℹ️  Date: 03/28/2025
[17:13:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:13:29] [DOC: 9208257] ✅ Text extracted using pdfplumber (956 chars)
[17:13:29] ✅    ✅ Text extracted using pdfplumber (956 chars)
[17:13:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:13:32] ℹ️  AI extracted raw sex value: 'M'
[17:13:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:13:32] ℹ️  AI extracted payer source: ''
[17:13:32] ℹ️  AI extracted diagnoses:
[17:13:32] ℹ️    - Diagnosis 1: ''
[17:13:32] ℹ️    - Diagnosis 2: ''
[17:13:32] ℹ️    - Diagnosis 3: ''
[17:13:32] ℹ️    - Diagnosis 4: ''
[17:13:32] ℹ️    - Diagnosis 5: ''
[17:13:32] ℹ️    - Diagnosis 6: ''
[17:13:32] ℹ️  Final extracted MRN: '2773750'
[17:13:32] ℹ️  Final extracted Sex: 'MALE'
[17:13:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:13:32] ℹ️  Final extracted Payer Source: ''
[17:13:32] ✅ Patient data extraction completed successfully
[17:13:32] ✅    ✅ Patient data extracted successfully
[17:13:32] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:13:32] ✅    ✅ Patient identified: Luis Mota
[17:13:32] ✅    ✅ Patient name validation passed
[17:13:32] 🔄 
🔄 Step 3: Processing patient dates...
[17:13:32] [DOC: 9208257] ℹ️  DOB normalized: 12/02/1942
[17:13:32] [DOC: 9208257] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[17:13:32] [DOC: 9208257] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[17:13:32] [DOC: 9208257] ✅ Patient date processing completed successfully
[17:13:32] ✅    ✅ Date processing completed
[17:13:32] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:13:32] 🔄 
🔄 Step 4: Extracting order data...
[17:13:34] ℹ️  Order extraction - MRN: '2773750'
[17:13:34] ℹ️  Order extraction - Sex: 'MALE'
[17:13:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:13:34] ℹ️  Order extraction - Payer Source: ''
[17:13:34] ✅ Order data extraction completed successfully
[17:13:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:13:34] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[17:13:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:13:34] ✅ Patient name cross-validation successful
[17:13:34] ✅    ✅ Data merged successfully
[17:13:35] ✅    ✅ Order data extracted and validated
[17:13:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:13:46] [DOC: 9208257] ℹ️  Patient not found in cache or API: Luis Mota
[17:13:46] [DOC: 9208257] ℹ️  Patient not found, creating new patient via API...
[17:13:46] [DOC: 9208257] ℹ️  Creating patient via API: Luis Mota
[17:13:47] [DOC: 9208257] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:13:47] ❌    ❌ Failed to create patient
[17:13:47] [DOC: 9208257] ℹ️  API push details saved for document 9208257
================================================================================
║                        Processing Document ID: 9208255                         ║
================================================================================
[17:13:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:13:47] ℹ️  Date: 03/28/2025
[17:13:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:13:48] [DOC: 9208255] ✅ Text extracted using pdfplumber (1288 chars)
[17:13:48] ✅    ✅ Text extracted using pdfplumber (1288 chars)
[17:13:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:13:51] ℹ️  AI extracted raw sex value: 'F'
[17:13:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:13:51] ℹ️  AI extracted payer source: ''
[17:13:51] ℹ️  AI extracted diagnoses:
[17:13:51] ℹ️    - Diagnosis 1: ''
[17:13:51] ℹ️    - Diagnosis 2: ''
[17:13:51] ℹ️    - Diagnosis 3: ''
[17:13:51] ℹ️    - Diagnosis 4: ''
[17:13:51] ℹ️    - Diagnosis 5: ''
[17:13:51] ℹ️    - Diagnosis 6: ''
[17:13:51] ℹ️  Final extracted MRN: '2772565'
[17:13:51] ℹ️  Final extracted Sex: 'FEMALE'
[17:13:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:13:51] ℹ️  Final extracted Payer Source: ''
[17:13:51] ✅ Patient data extraction completed successfully
[17:13:51] ✅    ✅ Patient data extracted successfully
[17:13:51] 📊 Patient Response
     └─ patientFName: Annette
     └─ patientLName: Morton
     └─ dob: 12/08/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2772565
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:13:51] ✅    ✅ Patient identified: Annette Morton
[17:13:51] ✅    ✅ Patient name validation passed
[17:13:51] 🔄 
🔄 Step 3: Processing patient dates...
[17:13:51] [DOC: 9208255] ℹ️  DOB normalized: 12/08/1947
[17:13:51] [DOC: 9208255] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[17:13:51] [DOC: 9208255] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[17:13:51] [DOC: 9208255] ✅ Patient date processing completed successfully
[17:13:51] ✅    ✅ Date processing completed
[17:13:51] 📊 Processed Patient Data
     └─ patientFName: Annette
     └─ patientLName: Morton
     └─ dob: 12/08/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2772565
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:13:51] 🔄 
🔄 Step 4: Extracting order data...
[17:13:53] ℹ️  Order extraction - MRN: '2772565'
[17:13:53] ℹ️  Order extraction - Sex: 'FEMALE'
[17:13:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:13:53] ℹ️  Order extraction - Payer Source: ''
[17:13:53] ✅ Order data extraction completed successfully
[17:13:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:13:53] ℹ️  Using MRN from patient data: '2772565' over '2772565'
[17:13:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:13:53] ✅ Patient name cross-validation successful
[17:13:53] ✅    ✅ Data merged successfully
[17:13:54] ✅    ✅ Order data extracted and validated
[17:13:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:14:01] [DOC: 9208255] ℹ️  Patient not found in cache or API: Annette Morton
[17:14:01] [DOC: 9208255] ℹ️  Patient not found, creating new patient via API...
[17:14:01] [DOC: 9208255] ℹ️  Creating patient via API: Annette Morton
[17:14:02] [DOC: 9208255] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:14:02] ❌    ❌ Failed to create patient
[17:14:02] [DOC: 9208255] ℹ️  API push details saved for document 9208255
================================================================================
║                        Processing Document ID: 9208254                         ║
================================================================================
[17:14:02] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:14:02] ℹ️  Date: 03/28/2025
[17:14:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:14:03] [DOC: 9208254] ✅ Text extracted using pdfplumber (1058 chars)
[17:14:03] ✅    ✅ Text extracted using pdfplumber (1058 chars)
[17:14:03] 🔄 
🔄 Step 2: Extracting patient data...
[17:14:06] ℹ️  AI extracted raw sex value: 'M'
[17:14:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:14:06] ℹ️  AI extracted payer source: ''
[17:14:06] ℹ️  AI extracted diagnoses:
[17:14:06] ℹ️    - Diagnosis 1: ''
[17:14:06] ℹ️    - Diagnosis 2: ''
[17:14:06] ℹ️    - Diagnosis 3: ''
[17:14:06] ℹ️    - Diagnosis 4: ''
[17:14:06] ℹ️    - Diagnosis 5: ''
[17:14:06] ℹ️    - Diagnosis 6: ''
[17:14:06] ℹ️  Final extracted MRN: '2714441'
[17:14:06] ℹ️  Final extracted Sex: 'MALE'
[17:14:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:14:06] ℹ️  Final extracted Payer Source: ''
[17:14:06] ✅ Patient data extraction completed successfully
[17:14:06] ✅    ✅ Patient data extracted successfully
[17:14:06] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: McCarthy
     └─ dob: 02/04/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2714441
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:06] ✅    ✅ Patient identified: Dennis McCarthy
[17:14:06] ✅    ✅ Patient name validation passed
[17:14:06] 🔄 
🔄 Step 3: Processing patient dates...
[17:14:06] [DOC: 9208254] ℹ️  DOB normalized: 02/04/1943
[17:14:06] [DOC: 9208254] ✅ Patient date processing completed successfully
[17:14:06] ✅    ✅ Date processing completed
[17:14:06] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: McCarthy
     └─ dob: 02/04/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2714441
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:06] 🔄 
🔄 Step 4: Extracting order data...
[17:14:08] ℹ️  Order extraction - MRN: '2714441'
[17:14:08] ℹ️  Order extraction - Sex: 'MALE'
[17:14:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:14:08] ℹ️  Order extraction - Payer Source: ''
[17:14:08] ✅ Order data extraction completed successfully
[17:14:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:14:08] ℹ️  Using MRN from patient data: '2714441' over '2714441'
[17:14:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:14:08] ✅ Patient name cross-validation successful
[17:14:08] ✅    ✅ Data merged successfully
[17:14:09] ✅    ✅ Order data extracted and validated
[17:14:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:14:14] [DOC: 9208254] ℹ️  Patient not found in cache or API: Dennis McCarthy
[17:14:14] [DOC: 9208254] ℹ️  Patient not found, creating new patient via API...
[17:14:14] [DOC: 9208254] ℹ️  Creating patient via API: Dennis McCarthy
[17:14:16] [DOC: 9208254] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:14:16] ❌    ❌ Failed to create patient
[17:14:16] [DOC: 9208254] ℹ️  API push details saved for document 9208254
================================================================================
║                        Processing Document ID: 9208251                         ║
================================================================================
[17:14:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:14:16] ℹ️  Date: 03/28/2025
[17:14:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:14:17] [DOC: 9208251] ✅ Text extracted using pdfplumber (955 chars)
[17:14:17] ✅    ✅ Text extracted using pdfplumber (955 chars)
[17:14:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:14:20] ℹ️  AI extracted raw sex value: 'M'
[17:14:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:14:20] ℹ️  AI extracted payer source: ''
[17:14:20] ℹ️  AI extracted diagnoses:
[17:14:20] ℹ️    - Diagnosis 1: ''
[17:14:20] ℹ️    - Diagnosis 2: ''
[17:14:20] ℹ️    - Diagnosis 3: ''
[17:14:20] ℹ️    - Diagnosis 4: ''
[17:14:20] ℹ️    - Diagnosis 5: ''
[17:14:20] ℹ️    - Diagnosis 6: ''
[17:14:20] ℹ️  Final extracted MRN: '2063794'
[17:14:20] ℹ️  Final extracted Sex: 'MALE'
[17:14:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:14:20] ℹ️  Final extracted Payer Source: ''
[17:14:20] ✅ Patient data extraction completed successfully
[17:14:20] ✅    ✅ Patient data extracted successfully
[17:14:20] 📊 Patient Response
     └─ patientFName: Adriano
     └─ patientLName: Lima
     └─ dob: 07/27/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063794
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:20] ✅    ✅ Patient identified: Adriano Lima
[17:14:20] ✅    ✅ Patient name validation passed
[17:14:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:14:20] [DOC: 9208251] ℹ️  DOB normalized: 07/27/1956
[17:14:20] [DOC: 9208251] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[17:14:20] [DOC: 9208251] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[17:14:20] [DOC: 9208251] ✅ Patient date processing completed successfully
[17:14:20] ✅    ✅ Date processing completed
[17:14:20] 📊 Processed Patient Data
     └─ patientFName: Adriano
     └─ patientLName: Lima
     └─ dob: 07/27/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063794
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:20] 🔄 
🔄 Step 4: Extracting order data...
[17:14:22] ℹ️  Order extraction - MRN: '2063794'
[17:14:22] ℹ️  Order extraction - Sex: 'MALE'
[17:14:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:14:22] ℹ️  Order extraction - Payer Source: ''
[17:14:22] ✅ Order data extraction completed successfully
[17:14:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:14:22] ℹ️  Using MRN from patient data: '2063794' over '2063794'
[17:14:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:14:22] ✅ Patient name cross-validation successful
[17:14:22] ✅    ✅ Data merged successfully
[17:14:23] ✅    ✅ Order data extracted and validated
[17:14:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:14:23] [DOC: 9208251] ✅ Patient found in local cache: Adriano Lima, ID: bc228bea-5a75-435d-ba11-54637f839b99
[17:14:23] ✅    ✅ Existing patient found with ID: bc228bea-5a75-435d-ba11-54637f839b99
[17:14:23] 🔄 
🔄 Step 6: Pushing order to API...
[17:14:23] [DOC: 9208251] ℹ️  Pushing order via API for patient ID: bc228bea-5a75-435d-ba11-54637f839b99
[17:14:24] [DOC: 9208251] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13188"}
[17:14:24] ❌    ❌ Failed to push order
[17:14:24] 🔄 
🔄 Step 7: Writing to CSV...
[17:14:24] [DOC: 9208251] ℹ️  Calculated age: 68 from DOB: 07/27/1956
[17:14:24] [DOC: 9208251] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:14:24] [DOC: 9208251] ℹ️  Payer Source extracted: ''
[17:14:24] [DOC: 9208251] ℹ️  Diagnosis codes being written:
[17:14:24] [DOC: 9208251] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:14:24] [DOC: 9208251] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:14:24] [DOC: 9208251] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:14:24] [DOC: 9208251] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:14:24] [DOC: 9208251] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:14:24] [DOC: 9208251] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:14:24] [DOC: 9208251] ✅ Patient data written to CSV: Adriano Lima | Sex: MALE | Age: 68 | Service: Skilled Nursing | Payer:  | MRN: 2063794
[17:14:24] ✅    ✅ Document 9208251 processed and saved successfully
[17:14:24] 🔄 
🔄 Step 8: Saving API details...
[17:14:24] [DOC: 9208251] ℹ️  API push details saved for document 9208251
[17:14:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208250                         ║
================================================================================
[17:14:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:14:24] ℹ️  Date: 03/28/2025
[17:14:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:14:26] [DOC: 9208250] ✅ Text extracted using pdfplumber (1065 chars)
[17:14:26] ✅    ✅ Text extracted using pdfplumber (1065 chars)
[17:14:26] 🔄 
🔄 Step 2: Extracting patient data...
[17:14:28] ℹ️  AI extracted raw sex value: 'M'
[17:14:28] ℹ️  AI extracted service line: 'Physical Therapy'
[17:14:28] ℹ️  AI extracted payer source: ''
[17:14:28] ℹ️  AI extracted diagnoses:
[17:14:28] ℹ️    - Diagnosis 1: 'None'
[17:14:28] ℹ️    - Diagnosis 2: 'None'
[17:14:28] ℹ️    - Diagnosis 3: 'None'
[17:14:28] ℹ️    - Diagnosis 4: 'None'
[17:14:28] ℹ️    - Diagnosis 5: 'None'
[17:14:28] ℹ️    - Diagnosis 6: 'None'
[17:14:28] ℹ️  Final extracted MRN: '2648815'
[17:14:28] ℹ️  Final extracted Sex: 'MALE'
[17:14:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:14:28] ℹ️  Final extracted Payer Source: ''
[17:14:28] ✅ Patient data extraction completed successfully
[17:14:28] ✅    ✅ Patient data extracted successfully
[17:14:28] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:14:28] ✅    ✅ Patient identified: Robert Ledoux
[17:14:28] ✅    ✅ Patient name validation passed
[17:14:28] 🔄 
🔄 Step 3: Processing patient dates...
[17:14:28] [DOC: 9208250] ℹ️  DOB normalized: 04/07/1968
[17:14:28] [DOC: 9208250] ✅ Patient date processing completed successfully
[17:14:28] ✅    ✅ Date processing completed
[17:14:28] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:14:28] 🔄 
🔄 Step 4: Extracting order data...
[17:14:31] ℹ️  Order extraction - MRN: '2648815'
[17:14:31] ℹ️  Order extraction - Sex: 'MALE'
[17:14:31] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:14:31] ℹ️  Order extraction - Payer Source: ''
[17:14:31] ✅ Order data extraction completed successfully
[17:14:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:14:31] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[17:14:31] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:14:31] ✅ Patient name cross-validation successful
[17:14:31] ✅    ✅ Data merged successfully
[17:14:32] ✅    ✅ Order data extracted and validated
[17:14:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:14:40] [DOC: 9208250] ℹ️  Patient not found in cache or API: Robert Ledoux
[17:14:40] [DOC: 9208250] ℹ️  Patient not found, creating new patient via API...
[17:14:40] [DOC: 9208250] ℹ️  Creating patient via API: Robert Ledoux
[17:14:41] [DOC: 9208250] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:14:41] ❌    ❌ Failed to create patient
[17:14:41] [DOC: 9208250] ℹ️  API push details saved for document 9208250
================================================================================
║                        Processing Document ID: 9208247                         ║
================================================================================
[17:14:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:14:41] ℹ️  Date: 03/28/2025
[17:14:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:14:43] [DOC: 9208247] ✅ Text extracted using pdfplumber (1058 chars)
[17:14:43] ✅    ✅ Text extracted using pdfplumber (1058 chars)
[17:14:43] 🔄 
🔄 Step 2: Extracting patient data...
[17:14:45] ℹ️  AI extracted raw sex value: 'F'
[17:14:45] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:14:45] ℹ️  AI extracted payer source: ''
[17:14:45] ℹ️  AI extracted diagnoses:
[17:14:45] ℹ️    - Diagnosis 1: ''
[17:14:45] ℹ️    - Diagnosis 2: ''
[17:14:45] ℹ️    - Diagnosis 3: ''
[17:14:45] ℹ️    - Diagnosis 4: ''
[17:14:45] ℹ️    - Diagnosis 5: ''
[17:14:45] ℹ️    - Diagnosis 6: ''
[17:14:45] ℹ️  Final extracted MRN: '2647449'
[17:14:45] ℹ️  Final extracted Sex: 'FEMALE'
[17:14:45] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:14:45] ℹ️  Final extracted Payer Source: ''
[17:14:45] ✅ Patient data extraction completed successfully
[17:14:45] ✅    ✅ Patient data extracted successfully
[17:14:45] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Leblanc
     └─ dob: 07/13/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2647449
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:45] ✅    ✅ Patient identified: Mary Leblanc
[17:14:45] ✅    ✅ Patient name validation passed
[17:14:45] 🔄 
🔄 Step 3: Processing patient dates...
[17:14:45] [DOC: 9208247] ℹ️  DOB normalized: 07/13/1935
[17:14:45] [DOC: 9208247] ✅ Patient date processing completed successfully
[17:14:45] ✅    ✅ Date processing completed
[17:14:45] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Leblanc
     └─ dob: 07/13/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2647449
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:45] 🔄 
🔄 Step 4: Extracting order data...
[17:14:47] ℹ️  Order extraction - MRN: '2647449'
[17:14:47] ℹ️  Order extraction - Sex: 'FEMALE'
[17:14:47] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:14:47] ℹ️  Order extraction - Payer Source: ''
[17:14:47] ✅ Order data extraction completed successfully
[17:14:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:14:47] ℹ️  Using MRN from patient data: '2647449' over '2647449'
[17:14:47] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:14:47] ✅ Patient name cross-validation successful
[17:14:47] ✅    ✅ Data merged successfully
[17:14:49] ✅    ✅ Order data extracted and validated
[17:14:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:14:53] [DOC: 9208247] ✅ Patient exists in API: Mary Leblanc, ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[17:14:53] ✅    ✅ Existing patient found with ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[17:14:53] 🔄 
🔄 Step 6: Pushing order to API...
[17:14:53] [DOC: 9208247] ℹ️  Pushing order via API for patient ID: a6d0e656-75ef-4993-b366-3c51d30b769e
[17:14:55] [DOC: 9208247] ❌ Order push failed with status 201: {"id":"fa6c22b8-3b52-4a75-a107-808bf0d57d9c","orderWAVId":"ORD20074","orderNo":"1075577","orderDate":"03/27/2025","startOfCare":"03/30/2025","episodeStartDate":"03/30/2025","episodeEndDate":"04/12/2025","documentID":"9208247","mrn":"2647449","patientName":"Leblanc,Mary C.","sentToPhysicianDate":"03/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/02/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"a6d0e656-75ef-4993-b366-3c51d30b769e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:14:55] ❌    ❌ Failed to push order
[17:14:55] 🔄 
🔄 Step 7: Writing to CSV...
[17:14:55] [DOC: 9208247] ℹ️  Calculated age: 89 from DOB: 07/13/1935
[17:14:55] [DOC: 9208247] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:14:55] [DOC: 9208247] ℹ️  Payer Source extracted: ''
[17:14:55] [DOC: 9208247] ℹ️  Diagnosis codes being written:
[17:14:55] [DOC: 9208247] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:14:55] [DOC: 9208247] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:14:55] [DOC: 9208247] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:14:55] [DOC: 9208247] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:14:55] [DOC: 9208247] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:14:55] [DOC: 9208247] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:14:55] [DOC: 9208247] ✅ Patient data written to CSV: Mary Leblanc | Sex: FEMALE | Age: 89 | Service: Occupational Therapy | Payer:  | MRN: 2647449
[17:14:55] ✅    ✅ Document 9208247 processed and saved successfully
[17:14:55] 🔄 
🔄 Step 8: Saving API details...
[17:14:55] [DOC: 9208247] ℹ️  API push details saved for document 9208247
[17:14:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208246                         ║
================================================================================
[17:14:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:14:55] ℹ️  Date: 03/28/2025
[17:14:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:14:56] [DOC: 9208246] ✅ Text extracted using pdfplumber (1118 chars)
[17:14:56] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[17:14:56] 🔄 
🔄 Step 2: Extracting patient data...
[17:14:59] ℹ️  AI extracted raw sex value: 'F'
[17:14:59] ℹ️  AI extracted service line: 'Physical Therapy'
[17:14:59] ℹ️  AI extracted payer source: ''
[17:14:59] ℹ️  AI extracted diagnoses:
[17:14:59] ℹ️    - Diagnosis 1: ''
[17:14:59] ℹ️    - Diagnosis 2: ''
[17:14:59] ℹ️    - Diagnosis 3: ''
[17:14:59] ℹ️    - Diagnosis 4: ''
[17:14:59] ℹ️    - Diagnosis 5: ''
[17:14:59] ℹ️    - Diagnosis 6: ''
[17:14:59] ℹ️  Final extracted MRN: '2645822'
[17:14:59] ℹ️  Final extracted Sex: 'FEMALE'
[17:14:59] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:14:59] ℹ️  Final extracted Payer Source: ''
[17:14:59] ✅ Patient data extraction completed successfully
[17:14:59] ✅    ✅ Patient data extracted successfully
[17:14:59] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Leal
     └─ dob: 06/30/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2645822
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:59] ✅    ✅ Patient identified: Maria Leal
[17:14:59] ✅    ✅ Patient name validation passed
[17:14:59] 🔄 
🔄 Step 3: Processing patient dates...
[17:14:59] [DOC: 9208246] ℹ️  DOB normalized: 06/30/1940
[17:14:59] [DOC: 9208246] ✅ Patient date processing completed successfully
[17:14:59] ✅    ✅ Date processing completed
[17:14:59] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Leal
     └─ dob: 06/30/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2645822
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:14:59] 🔄 
🔄 Step 4: Extracting order data...
[17:15:01] ℹ️  Order extraction - MRN: '2645822'
[17:15:01] ℹ️  Order extraction - Sex: 'FEMALE'
[17:15:01] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:15:01] ℹ️  Order extraction - Payer Source: ''
[17:15:01] ✅ Order data extraction completed successfully
[17:15:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:15:01] ℹ️  Using MRN from patient data: '2645822' over '2645822'
[17:15:01] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:15:01] ✅ Patient name cross-validation successful
[17:15:01] ✅    ✅ Data merged successfully
[17:15:03] ✅    ✅ Order data extracted and validated
[17:15:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:15:10] [DOC: 9208246] ✅ Patient exists in API: Maria Leal, ID: 49f21bef-9493-4e6d-8fed-0ae67ee17b5d
[17:15:10] ✅    ✅ Existing patient found with ID: 49f21bef-9493-4e6d-8fed-0ae67ee17b5d
[17:15:10] 🔄 
🔄 Step 6: Pushing order to API...
[17:15:10] [DOC: 9208246] ℹ️  Pushing order via API for patient ID: 49f21bef-9493-4e6d-8fed-0ae67ee17b5d
[17:15:11] [DOC: 9208246] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13662"}
[17:15:11] ❌    ❌ Failed to push order
[17:15:11] 🔄 
🔄 Step 7: Writing to CSV...
[17:15:11] [DOC: 9208246] ℹ️  Calculated age: 84 from DOB: 06/30/1940
[17:15:11] [DOC: 9208246] ℹ️  Service Line extracted: 'Physical Therapy'
[17:15:11] [DOC: 9208246] ℹ️  Payer Source extracted: ''
[17:15:11] [DOC: 9208246] ℹ️  Diagnosis codes being written:
[17:15:11] [DOC: 9208246] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:15:11] [DOC: 9208246] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:15:11] [DOC: 9208246] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:15:11] [DOC: 9208246] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:15:11] [DOC: 9208246] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:15:11] [DOC: 9208246] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:15:11] [DOC: 9208246] ✅ Patient data written to CSV: Maria Leal | Sex: FEMALE | Age: 84 | Service: Physical Therapy | Payer:  | MRN: 2645822
[17:15:11] ✅    ✅ Document 9208246 processed and saved successfully
[17:15:11] 🔄 
🔄 Step 8: Saving API details...
[17:15:11] [DOC: 9208246] ℹ️  API push details saved for document 9208246
[17:15:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208245                         ║
================================================================================
[17:15:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:15:11] ℹ️  Date: 03/28/2025
[17:15:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:15:12] [DOC: 9208245] ✅ Text extracted using pdfplumber (853 chars)
[17:15:12] ✅    ✅ Text extracted using pdfplumber (853 chars)
[17:15:12] 🔄 
🔄 Step 2: Extracting patient data...
[17:15:15] ℹ️  AI extracted raw sex value: 'F'
[17:15:15] ℹ️  AI extracted service line: 'Physical Therapy'
[17:15:15] ℹ️  AI extracted payer source: ''
[17:15:15] ℹ️  AI extracted diagnoses:
[17:15:15] ℹ️    - Diagnosis 1: 'None'
[17:15:15] ℹ️    - Diagnosis 2: 'None'
[17:15:15] ℹ️    - Diagnosis 3: 'None'
[17:15:15] ℹ️    - Diagnosis 4: 'None'
[17:15:15] ℹ️    - Diagnosis 5: 'None'
[17:15:15] ℹ️    - Diagnosis 6: 'None'
[17:15:15] ℹ️  Final extracted MRN: '2638113'
[17:15:15] ℹ️  Final extracted Sex: 'FEMALE'
[17:15:15] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:15:15] ℹ️  Final extracted Payer Source: ''
[17:15:15] ✅ Patient data extraction completed successfully
[17:15:15] ✅    ✅ Patient data extracted successfully
[17:15:15] 📊 Patient Response
     └─ patientFName: Gail
     └─ patientLName: Lapalme
     └─ dob: 11/18/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2638113
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:15:15] ✅    ✅ Patient identified: Gail Lapalme
[17:15:15] ✅    ✅ Patient name validation passed
[17:15:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:15:15] [DOC: 9208245] ℹ️  DOB normalized: 11/18/1949
[17:15:15] [DOC: 9208245] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[17:15:15] [DOC: 9208245] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[17:15:15] [DOC: 9208245] ✅ Patient date processing completed successfully
[17:15:15] ✅    ✅ Date processing completed
[17:15:15] 📊 Processed Patient Data
     └─ patientFName: Gail
     └─ patientLName: Lapalme
     └─ dob: 11/18/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2638113
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '03/22/2025'}]
[17:15:15] 🔄 
🔄 Step 4: Extracting order data...
[17:15:17] ℹ️  Order extraction - MRN: '2638113'
[17:15:17] ℹ️  Order extraction - Sex: 'FEMALE'
[17:15:17] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:15:17] ℹ️  Order extraction - Payer Source: ''
[17:15:17] ✅ Order data extraction completed successfully
[17:15:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:15:17] ℹ️  Using MRN from patient data: '2638113' over '2638113'
[17:15:17] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:15:17] ✅ Patient name cross-validation successful
[17:15:17] ✅    ✅ Data merged successfully
[17:15:18] ✅    ✅ Order data extracted and validated
[17:15:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:15:18] [DOC: 9208245] ✅ Patient found in local cache: Gail Lapalme, ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[17:15:18] ✅    ✅ Existing patient found with ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[17:15:18] 🔄 
🔄 Step 6: Pushing order to API...
[17:15:18] [DOC: 9208245] ℹ️  Pushing order via API for patient ID: f10d0692-7ce2-42c9-9b65-6c9f557ad4d0
[17:15:20] [DOC: 9208245] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13293"}
[17:15:20] ❌    ❌ Failed to push order
[17:15:20] 🔄 
🔄 Step 7: Writing to CSV...
[17:15:20] [DOC: 9208245] ℹ️  Calculated age: 75 from DOB: 11/18/1949
[17:15:20] [DOC: 9208245] ℹ️  Service Line extracted: 'Physical Therapy'
[17:15:20] [DOC: 9208245] ℹ️  Payer Source extracted: ''
[17:15:20] [DOC: 9208245] ℹ️  Diagnosis codes being written:
[17:15:20] [DOC: 9208245] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:15:20] [DOC: 9208245] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:15:20] [DOC: 9208245] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:15:20] [DOC: 9208245] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:15:20] [DOC: 9208245] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:15:20] [DOC: 9208245] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:15:20] [DOC: 9208245] ✅ Patient data written to CSV: Gail Lapalme | Sex: FEMALE | Age: 75 | Service: Physical Therapy | Payer:  | MRN: 2638113
[17:15:20] ✅    ✅ Document 9208245 processed and saved successfully
[17:15:20] 🔄 
🔄 Step 8: Saving API details...
[17:15:20] [DOC: 9208245] ℹ️  API push details saved for document 9208245
[17:15:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208243                         ║
================================================================================
[17:15:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:15:20] ℹ️  Date: 03/28/2025
[17:15:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:15:21] [DOC: 9208243] ✅ Text extracted using pdfplumber (1029 chars)
[17:15:21] ✅    ✅ Text extracted using pdfplumber (1029 chars)
[17:15:21] 🔄 
🔄 Step 2: Extracting patient data...
[17:15:24] ℹ️  AI extracted raw sex value: 'F'
[17:15:24] ℹ️  AI extracted service line: 'Physical Therapy'
[17:15:24] ℹ️  AI extracted payer source: ''
[17:15:24] ℹ️  AI extracted diagnoses:
[17:15:24] ℹ️    - Diagnosis 1: ''
[17:15:24] ℹ️    - Diagnosis 2: ''
[17:15:24] ℹ️    - Diagnosis 3: ''
[17:15:24] ℹ️    - Diagnosis 4: ''
[17:15:24] ℹ️    - Diagnosis 5: ''
[17:15:24] ℹ️    - Diagnosis 6: ''
[17:15:24] ℹ️  Final extracted MRN: '2611003'
[17:15:24] ℹ️  Final extracted Sex: 'FEMALE'
[17:15:24] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:15:24] ℹ️  Final extracted Payer Source: ''
[17:15:24] ✅ Patient data extraction completed successfully
[17:15:24] ✅    ✅ Patient data extracted successfully
[17:15:24] 📊 Patient Response
     └─ patientFName: Johnnie-Ann
     └─ patientLName: Keighley
     └─ dob: 04/04/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2611003
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:24] ✅    ✅ Patient identified: Johnnie-Ann Keighley
[17:15:24] ✅    ✅ Patient name validation passed
[17:15:24] 🔄 
🔄 Step 3: Processing patient dates...
[17:15:24] [DOC: 9208243] ℹ️  DOB normalized: 04/04/1945
[17:15:24] [DOC: 9208243] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[17:15:24] [DOC: 9208243] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[17:15:24] [DOC: 9208243] ✅ Patient date processing completed successfully
[17:15:24] ✅    ✅ Date processing completed
[17:15:24] 📊 Processed Patient Data
     └─ patientFName: Johnnie-Ann
     └─ patientLName: Keighley
     └─ dob: 04/04/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2611003
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:24] 🔄 
🔄 Step 4: Extracting order data...
[17:15:27] ℹ️  Order extraction - MRN: '2611003'
[17:15:27] ℹ️  Order extraction - Sex: 'FEMALE'
[17:15:27] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:15:27] ℹ️  Order extraction - Payer Source: ''
[17:15:27] ✅ Order data extraction completed successfully
[17:15:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:15:27] ℹ️  Using MRN from patient data: '2611003' over '2611003'
[17:15:27] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:15:27] ✅ Patient name cross-validation successful
[17:15:27] ✅    ✅ Data merged successfully
[17:15:28] ✅    ✅ Order data extracted and validated
[17:15:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:15:28] [DOC: 9208243] ✅ Patient found in local cache: Johnnie-Ann Keighley, ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[17:15:28] ✅    ✅ Existing patient found with ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[17:15:28] 🔄 
🔄 Step 6: Pushing order to API...
[17:15:28] [DOC: 9208243] ℹ️  Pushing order via API for patient ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[17:15:29] [DOC: 9208243] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13099"}
[17:15:29] ❌    ❌ Failed to push order
[17:15:29] 🔄 
🔄 Step 7: Writing to CSV...
[17:15:29] [DOC: 9208243] ℹ️  Calculated age: 80 from DOB: 04/04/1945
[17:15:29] [DOC: 9208243] ℹ️  Service Line extracted: 'Physical Therapy'
[17:15:29] [DOC: 9208243] ℹ️  Payer Source extracted: ''
[17:15:29] [DOC: 9208243] ℹ️  Diagnosis codes being written:
[17:15:29] [DOC: 9208243] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:15:29] [DOC: 9208243] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:15:29] [DOC: 9208243] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:15:29] [DOC: 9208243] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:15:29] [DOC: 9208243] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:15:29] [DOC: 9208243] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:15:29] [DOC: 9208243] ✅ Patient data written to CSV: Johnnie-Ann Keighley | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: 2611003
[17:15:29] ✅    ✅ Document 9208243 processed and saved successfully
[17:15:29] 🔄 
🔄 Step 8: Saving API details...
[17:15:29] [DOC: 9208243] ℹ️  API push details saved for document 9208243
[17:15:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208241                         ║
================================================================================
[17:15:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:15:29] ℹ️  Date: 03/28/2025
[17:15:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:15:30] [DOC: 9208241] ✅ Text extracted using pdfplumber (2319 chars)
[17:15:30] ✅    ✅ Text extracted using pdfplumber (2319 chars)
[17:15:30] 🔄 
🔄 Step 2: Extracting patient data...
[17:15:33] ℹ️  AI extracted raw sex value: 'M'
[17:15:33] ℹ️  AI extracted service line: 'Skilled Nursing, Medical Social Work'
[17:15:33] ℹ️  AI extracted payer source: ''
[17:15:33] ℹ️  AI extracted diagnoses:
[17:15:33] ℹ️    - Diagnosis 1: ''
[17:15:33] ℹ️    - Diagnosis 2: ''
[17:15:33] ℹ️    - Diagnosis 3: ''
[17:15:33] ℹ️    - Diagnosis 4: ''
[17:15:33] ℹ️    - Diagnosis 5: ''
[17:15:33] ℹ️    - Diagnosis 6: ''
[17:15:33] ℹ️  Final extracted MRN: '2136200'
[17:15:33] ℹ️  Final extracted Sex: 'MALE'
[17:15:33] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medical Social Work'
[17:15:33] ℹ️  Final extracted Payer Source: ''
[17:15:33] ✅ Patient data extraction completed successfully
[17:15:33] ✅    ✅ Patient data extracted successfully
[17:15:33] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:33] ✅    ✅ Patient identified: Jacob Amadeu
[17:15:33] ✅    ✅ Patient name validation passed
[17:15:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:15:33] [DOC: 9208241] ℹ️  DOB normalized: 04/03/1941
[17:15:33] [DOC: 9208241] ✅ Patient date processing completed successfully
[17:15:33] ✅    ✅ Date processing completed
[17:15:33] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:33] 🔄 
🔄 Step 4: Extracting order data...
[17:15:36] ℹ️  Order extraction - MRN: '2136200'
[17:15:36] ℹ️  Order extraction - Sex: 'MALE'
[17:15:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Medical Social Work'
[17:15:36] ℹ️  Order extraction - Payer Source: ''
[17:15:36] ✅ Order data extraction completed successfully
[17:15:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:15:36] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[17:15:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Medical Social Work'
[17:15:36] ✅ Patient name cross-validation successful
[17:15:36] ✅    ✅ Data merged successfully
[17:15:37] ✅    ✅ Order data extracted and validated
[17:15:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:15:44] [DOC: 9208241] ℹ️  Patient not found in cache or API: Jacob Amadeu
[17:15:44] [DOC: 9208241] ℹ️  Patient not found, creating new patient via API...
[17:15:44] [DOC: 9208241] ℹ️  Creating patient via API: Jacob Amadeu
[17:15:45] [DOC: 9208241] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:15:45] ❌    ❌ Failed to create patient
[17:15:45] [DOC: 9208241] ℹ️  API push details saved for document 9208241
================================================================================
║                        Processing Document ID: 9208240                         ║
================================================================================
[17:15:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:15:45] ℹ️  Date: 03/28/2025
[17:15:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:15:46] [DOC: 9208240] ✅ Text extracted using pdfplumber (1233 chars)
[17:15:46] ✅    ✅ Text extracted using pdfplumber (1233 chars)
[17:15:46] 🔄 
🔄 Step 2: Extracting patient data...
[17:15:49] ℹ️  AI extracted raw sex value: 'M'
[17:15:49] ℹ️  AI extracted service line: 'Home Health Aide, Skilled Nursing'
[17:15:49] ℹ️  AI extracted payer source: ''
[17:15:49] ℹ️  AI extracted diagnoses:
[17:15:49] ℹ️    - Diagnosis 1: ''
[17:15:49] ℹ️    - Diagnosis 2: ''
[17:15:49] ℹ️    - Diagnosis 3: ''
[17:15:49] ℹ️    - Diagnosis 4: ''
[17:15:49] ℹ️    - Diagnosis 5: ''
[17:15:49] ℹ️    - Diagnosis 6: ''
[17:15:49] ℹ️  Final extracted MRN: '2113948'
[17:15:49] ℹ️  Final extracted Sex: 'MALE'
[17:15:49] ℹ️  Final extracted Service Line: 'Home Health Aide, Skilled Nursing'
[17:15:49] ℹ️  Final extracted Payer Source: ''
[17:15:49] ✅ Patient data extraction completed successfully
[17:15:49] ✅    ✅ Patient data extracted successfully
[17:15:49] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:49] ✅    ✅ Patient identified: Jay Greenspan
[17:15:49] ✅    ✅ Patient name validation passed
[17:15:49] 🔄 
🔄 Step 3: Processing patient dates...
[17:15:49] [DOC: 9208240] ℹ️  DOB normalized: 03/11/1942
[17:15:49] [DOC: 9208240] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[17:15:49] [DOC: 9208240] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[17:15:49] [DOC: 9208240] ✅ Patient date processing completed successfully
[17:15:49] ✅    ✅ Date processing completed
[17:15:49] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:49] 🔄 
🔄 Step 4: Extracting order data...
[17:15:51] ℹ️  Order extraction - MRN: '2113948'
[17:15:51] ℹ️  Order extraction - Sex: 'MALE'
[17:15:51] ℹ️  Order extraction - Service Line: 'Home Health Aide, Skilled Nursing'
[17:15:51] ℹ️  Order extraction - Payer Source: ''
[17:15:51] ✅ Order data extraction completed successfully
[17:15:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:15:51] ℹ️  Using MRN from patient data: '2113948' over '2113948'
[17:15:51] ℹ️  Service line consistent in both sources: 'Home Health Aide, Skilled Nursing'
[17:15:51] ✅ Patient name cross-validation successful
[17:15:51] ✅    ✅ Data merged successfully
[17:15:53] ✅    ✅ Order data extracted and validated
[17:15:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:15:53] [DOC: 9208240] ✅ Patient found in local cache: Jay Greenspan, ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[17:15:53] ✅    ✅ Existing patient found with ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[17:15:53] 🔄 
🔄 Step 6: Pushing order to API...
[17:15:53] [DOC: 9208240] ℹ️  Pushing order via API for patient ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[17:15:54] [DOC: 9208240] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13053"}
[17:15:54] ❌    ❌ Failed to push order
[17:15:54] 🔄 
🔄 Step 7: Writing to CSV...
[17:15:54] [DOC: 9208240] ℹ️  Calculated age: 83 from DOB: 03/11/1942
[17:15:54] [DOC: 9208240] ℹ️  Service Line extracted: 'Home Health Aide, Skilled Nursing'
[17:15:54] [DOC: 9208240] ℹ️  Payer Source extracted: ''
[17:15:54] [DOC: 9208240] ℹ️  Diagnosis codes being written:
[17:15:54] [DOC: 9208240] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:15:54] [DOC: 9208240] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:15:54] [DOC: 9208240] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:15:54] [DOC: 9208240] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:15:54] [DOC: 9208240] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:15:54] [DOC: 9208240] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:15:54] [DOC: 9208240] ✅ Patient data written to CSV: Jay Greenspan | Sex: MALE | Age: 83 | Service: Home Health Aide, Skilled Nursing | Payer:  | MRN: 2113948
[17:15:54] ✅    ✅ Document 9208240 processed and saved successfully
[17:15:54] 🔄 
🔄 Step 8: Saving API details...
[17:15:54] [DOC: 9208240] ℹ️  API push details saved for document 9208240
[17:15:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208239                         ║
================================================================================
[17:15:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:15:54] ℹ️  Date: 03/28/2025
[17:15:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:15:55] [DOC: 9208239] ✅ Text extracted using pdfplumber (1053 chars)
[17:15:55] ✅    ✅ Text extracted using pdfplumber (1053 chars)
[17:15:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:15:58] ℹ️  AI extracted raw sex value: 'M'
[17:15:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:15:58] ℹ️  AI extracted payer source: ''
[17:15:58] ℹ️  AI extracted diagnoses:
[17:15:58] ℹ️    - Diagnosis 1: ''
[17:15:58] ℹ️    - Diagnosis 2: ''
[17:15:58] ℹ️    - Diagnosis 3: ''
[17:15:58] ℹ️    - Diagnosis 4: ''
[17:15:58] ℹ️    - Diagnosis 5: ''
[17:15:58] ℹ️    - Diagnosis 6: ''
[17:15:58] ℹ️  Final extracted MRN: '2149660'
[17:15:58] ℹ️  Final extracted Sex: 'MALE'
[17:15:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:15:58] ℹ️  Final extracted Payer Source: ''
[17:15:58] ✅ Patient data extraction completed successfully
[17:15:58] ✅    ✅ Patient data extracted successfully
[17:15:58] 📊 Patient Response
     └─ patientFName: Scott
     └─ patientLName: Fonseca
     └─ dob: 12/30/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 2149660
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:58] ✅    ✅ Patient identified: Scott Fonseca
[17:15:58] ✅    ✅ Patient name validation passed
[17:15:58] 🔄 
🔄 Step 3: Processing patient dates...
[17:15:58] [DOC: 9208239] ℹ️  DOB normalized: 12/30/1980
[17:15:58] [DOC: 9208239] ✅ Patient date processing completed successfully
[17:15:58] ✅    ✅ Date processing completed
[17:15:58] 📊 Processed Patient Data
     └─ patientFName: Scott
     └─ patientLName: Fonseca
     └─ dob: 12/30/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 2149660
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:15:58] 🔄 
🔄 Step 4: Extracting order data...
[17:16:00] ℹ️  Order extraction - MRN: '2149660'
[17:16:00] ℹ️  Order extraction - Sex: 'MALE'
[17:16:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:16:00] ℹ️  Order extraction - Payer Source: ''
[17:16:00] ✅ Order data extraction completed successfully
[17:16:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:16:00] ℹ️  Using MRN from patient data: '2149660' over '2149660'
[17:16:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:16:00] ✅ Patient name cross-validation successful
[17:16:00] ✅    ✅ Data merged successfully
[17:16:01] ✅    ✅ Order data extracted and validated
[17:16:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:16:01] [DOC: 9208239] ✅ Patient found in local cache: Scott Fonseca, ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[17:16:01] ✅    ✅ Existing patient found with ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[17:16:01] 🔄 
🔄 Step 6: Pushing order to API...
[17:16:01] [DOC: 9208239] ℹ️  Pushing order via API for patient ID: bfb7367e-b3ba-48f7-bc58-20369e026358
[17:16:03] [DOC: 9208239] ❌ Order push failed with status 201: {"id":"e39fd773-e105-4e99-9398-fde78f8a57ff","orderWAVId":"ORD20075","orderNo":"1075837","orderDate":"03/27/2025","startOfCare":"03/27/2025","episodeStartDate":"03/27/2025","episodeEndDate":"05/25/2025","documentID":"9208239","mrn":"2149660","patientName":"Fonseca,Scott","sentToPhysicianDate":"03/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/31/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"bfb7367e-b3ba-48f7-bc58-20369e026358","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:16:03] ❌    ❌ Failed to push order
[17:16:03] 🔄 
🔄 Step 7: Writing to CSV...
[17:16:03] [DOC: 9208239] ℹ️  Calculated age: 44 from DOB: 12/30/1980
[17:16:03] [DOC: 9208239] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:16:03] [DOC: 9208239] ℹ️  Payer Source extracted: ''
[17:16:03] [DOC: 9208239] ℹ️  Diagnosis codes being written:
[17:16:03] [DOC: 9208239] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:16:03] [DOC: 9208239] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:16:03] [DOC: 9208239] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:16:03] [DOC: 9208239] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:16:03] [DOC: 9208239] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:16:03] [DOC: 9208239] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:16:03] [DOC: 9208239] ✅ Patient data written to CSV: Scott Fonseca | Sex: MALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 2149660
[17:16:03] ✅    ✅ Document 9208239 processed and saved successfully
[17:16:03] 🔄 
🔄 Step 8: Saving API details...
[17:16:03] [DOC: 9208239] ℹ️  API push details saved for document 9208239
[17:16:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9208236                         ║
================================================================================
[17:16:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:16:03] ℹ️  Date: 03/28/2025
[17:16:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:16:04] [DOC: 9208236] ✅ Text extracted using pdfplumber (1066 chars)
[17:16:04] ✅    ✅ Text extracted using pdfplumber (1066 chars)
[17:16:04] 🔄 
🔄 Step 2: Extracting patient data...
[17:16:11] ℹ️  AI extracted raw sex value: 'F'
[17:16:11] ℹ️  AI extracted service line: 'Physical Therapy'
[17:16:11] ℹ️  AI extracted payer source: ''
[17:16:11] ℹ️  AI extracted diagnoses:
[17:16:11] ℹ️    - Diagnosis 1: ''
[17:16:11] ℹ️    - Diagnosis 2: ''
[17:16:11] ℹ️    - Diagnosis 3: ''
[17:16:11] ℹ️    - Diagnosis 4: ''
[17:16:11] ℹ️    - Diagnosis 5: ''
[17:16:11] ℹ️    - Diagnosis 6: ''
[17:16:11] ℹ️  Final extracted MRN: '2450273'
[17:16:11] ℹ️  Final extracted Sex: 'FEMALE'
[17:16:11] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:16:11] ℹ️  Final extracted Payer Source: ''
[17:16:11] ✅ Patient data extraction completed successfully
[17:16:11] ✅    ✅ Patient data extracted successfully
[17:16:11] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:16:11] ✅    ✅ Patient identified: Maria Estacio
[17:16:11] ✅    ✅ Patient name validation passed
[17:16:11] 🔄 
🔄 Step 3: Processing patient dates...
[17:16:11] [DOC: 9208236] ℹ️  DOB normalized: 12/14/1935
[17:16:11] [DOC: 9208236] ✅ Patient date processing completed successfully
[17:16:11] ✅    ✅ Date processing completed
[17:16:11] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:16:11] 🔄 
🔄 Step 4: Extracting order data...
[17:16:13] ℹ️  Order extraction - MRN: '2450273'
[17:16:13] ℹ️  Order extraction - Sex: 'FEMALE'
[17:16:13] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:16:13] ℹ️  Order extraction - Payer Source: ''
[17:16:13] ✅ Order data extraction completed successfully
[17:16:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:16:13] ℹ️  Using MRN from patient data: '2450273' over '2450273'
[17:16:13] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:16:13] ✅ Patient name cross-validation successful
[17:16:13] ✅    ✅ Data merged successfully
[17:16:15] ✅    ✅ Order data extracted and validated
[17:16:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:16:41] [DOC: 9208236] ℹ️  Patient not found in cache or API: Maria Estacio
[17:16:41] [DOC: 9208236] ℹ️  Patient not found, creating new patient via API...
[17:16:41] [DOC: 9208236] ℹ️  Creating patient via API: Maria Estacio
[17:16:42] [DOC: 9208236] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:16:42] ❌    ❌ Failed to create patient
[17:16:42] [DOC: 9208236] ℹ️  API push details saved for document 9208236
================================================================================
║                        Processing Document ID: 9208227                         ║
================================================================================
[17:16:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:16:42] ℹ️  Date: 03/28/2025
[17:16:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:16:44] [DOC: 9208227] ✅ Text extracted using pdfplumber (1118 chars)
[17:16:44] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[17:16:44] 🔄 
🔄 Step 2: Extracting patient data...
[17:16:47] ℹ️  AI extracted raw sex value: 'F'
[17:16:47] ℹ️  AI extracted service line: 'Medical Social Work'
[17:16:47] ℹ️  AI extracted payer source: ''
[17:16:47] ℹ️  AI extracted diagnoses:
[17:16:47] ℹ️    - Diagnosis 1: ''
[17:16:47] ℹ️    - Diagnosis 2: ''
[17:16:47] ℹ️    - Diagnosis 3: ''
[17:16:47] ℹ️    - Diagnosis 4: ''
[17:16:47] ℹ️    - Diagnosis 5: ''
[17:16:47] ℹ️    - Diagnosis 6: ''
[17:16:47] ℹ️  Final extracted MRN: '2409497'
[17:16:47] ℹ️  Final extracted Sex: 'FEMALE'
[17:16:47] ℹ️  Final extracted Service Line: 'Medical Social Work'
[17:16:47] ℹ️  Final extracted Payer Source: ''
[17:16:47] ✅ Patient data extraction completed successfully
[17:16:47] ✅    ✅ Patient data extracted successfully
[17:16:47] 📊 Patient Response
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:16:47] ✅    ✅ Patient identified: Juliet Desnoyers
[17:16:47] ✅    ✅ Patient name validation passed
[17:16:47] 🔄 
🔄 Step 3: Processing patient dates...
[17:16:47] [DOC: 9208227] ℹ️  DOB normalized: 11/13/1938
[17:16:47] [DOC: 9208227] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[17:16:47] [DOC: 9208227] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[17:16:47] [DOC: 9208227] ✅ Patient date processing completed successfully
[17:16:47] ✅    ✅ Date processing completed
[17:16:47] 📊 Processed Patient Data
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:16:47] 🔄 
🔄 Step 4: Extracting order data...
[17:16:49] ℹ️  Order extraction - MRN: '2409497'
[17:16:49] ℹ️  Order extraction - Sex: 'FEMALE'
[17:16:49] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[17:16:49] ℹ️  Order extraction - Payer Source: ''
[17:16:49] ✅ Order data extraction completed successfully
[17:16:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:16:49] ℹ️  Using MRN from patient data: '2409497' over '2409497'
[17:16:49] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[17:16:49] ✅ Patient name cross-validation successful
[17:16:49] ✅    ✅ Data merged successfully
[17:16:50] ✅    ✅ Order data extracted and validated
[17:16:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:17:01] [DOC: 9208227] ℹ️  Patient not found in cache or API: Juliet Desnoyers
[17:17:01] [DOC: 9208227] ℹ️  Patient not found, creating new patient via API...
[17:17:01] [DOC: 9208227] ℹ️  Creating patient via API: Juliet Desnoyers
[17:17:02] [DOC: 9208227] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:17:02] ❌    ❌ Failed to create patient
[17:17:02] [DOC: 9208227] ℹ️  API push details saved for document 9208227
================================================================================
║                        Processing Document ID: 9208202                         ║
================================================================================
[17:17:02] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:17:02] ℹ️  Date: 03/28/2025
[17:17:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:17:05] [DOC: 9208202] ✅ Text extracted using pdfplumber (5499 chars)
[17:17:05] ✅    ✅ Text extracted using pdfplumber (5499 chars)
[17:17:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:17:07] ℹ️  AI extracted raw sex value: ''
[17:17:07] ℹ️  AI extracted service line: ''
[17:17:07] ℹ️  AI extracted payer source: ''
[17:17:07] ℹ️  AI extracted diagnoses:
[17:17:07] ℹ️    - Diagnosis 1: ''
[17:17:07] ℹ️    - Diagnosis 2: ''
[17:17:07] ℹ️    - Diagnosis 3: ''
[17:17:07] ℹ️    - Diagnosis 4: ''
[17:17:07] ℹ️    - Diagnosis 5: ''
[17:17:07] ℹ️    - Diagnosis 6: ''
[17:17:07] ℹ️  Final extracted MRN: ''
[17:17:07] ℹ️  Final extracted Sex: ''
[17:17:07] ℹ️  Final extracted Service Line: ''
[17:17:07] ℹ️  Final extracted Payer Source: ''
[17:17:07] ✅ Patient data extraction completed successfully
[17:17:07] ✅    ✅ Patient data extracted successfully
[17:17:07] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:17:07] ⚠️     ❌ Insufficient patient data extracted
[17:17:07] [DOC: 9208202] ℹ️  API push details saved for document 9208202
================================================================================
║                        Processing Document ID: 9208197                         ║
================================================================================
[17:17:07] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:17:07] ℹ️  Date: 03/28/2025
[17:17:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:17:12] [DOC: 9208197] ✅ Text extracted using pdfplumber (5167 chars)
[17:17:12] ✅    ✅ Text extracted using pdfplumber (5167 chars)
[17:17:12] 🔄 
🔄 Step 2: Extracting patient data...
[17:17:14] ℹ️  AI extracted raw sex value: 'None'
[17:17:14] ℹ️  AI extracted service line: 'None'
[17:17:14] ℹ️  AI extracted payer source: 'None'
[17:17:14] ℹ️  AI extracted diagnoses:
[17:17:14] ℹ️    - Diagnosis 1: ''
[17:17:14] ℹ️    - Diagnosis 2: ''
[17:17:14] ℹ️    - Diagnosis 3: ''
[17:17:14] ℹ️    - Diagnosis 4: ''
[17:17:14] ℹ️    - Diagnosis 5: ''
[17:17:14] ℹ️    - Diagnosis 6: ''
[17:17:14] ℹ️  Final extracted MRN: ''
[17:17:14] ℹ️  Final extracted Sex: ''
[17:17:14] ℹ️  Final extracted Service Line: ''
[17:17:14] ℹ️  Final extracted Payer Source: ''
[17:17:14] ✅ Patient data extraction completed successfully
[17:17:14] ✅    ✅ Patient data extracted successfully
[17:17:14] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[17:17:14] ⚠️     ❌ Insufficient patient data extracted
[17:17:14] [DOC: 9208197] ℹ️  API push details saved for document 9208197
================================================================================
║                        Processing Document ID: 9208193                         ║
================================================================================
[17:17:14] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:17:14] ℹ️  Date: 03/28/2025
[17:17:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:17:18] [DOC: 9208193] ✅ Text extracted using pdfplumber (51417 chars)
[17:17:18] ✅    ✅ Text extracted using pdfplumber (51417 chars)
[17:17:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:17:23] ℹ️  AI extracted raw sex value: 'None'
[17:17:23] ℹ️  AI extracted service line: 'None'
[17:17:23] ℹ️  AI extracted payer source: 'None'
[17:17:23] ℹ️  AI extracted diagnoses:
[17:17:23] ℹ️    - Diagnosis 1: ''
[17:17:23] ℹ️    - Diagnosis 2: ''
[17:17:23] ℹ️    - Diagnosis 3: ''
[17:17:23] ℹ️    - Diagnosis 4: ''
[17:17:23] ℹ️    - Diagnosis 5: ''
[17:17:23] ℹ️    - Diagnosis 6: ''
[17:17:23] ℹ️  Final extracted MRN: ''
[17:17:23] ℹ️  Final extracted Sex: ''
[17:17:23] ℹ️  Final extracted Service Line: ''
[17:17:23] ℹ️  Final extracted Payer Source: ''
[17:17:23] ✅ Patient data extraction completed successfully
[17:17:23] ✅    ✅ Patient data extracted successfully
[17:17:23] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[17:17:23] ⚠️     ❌ Insufficient patient data extracted
[17:17:23] [DOC: 9208193] ℹ️  API push details saved for document 9208193
================================================================================
║                        Processing Document ID: 9208191                         ║
================================================================================
[17:17:23] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:17:23] ℹ️  Date: 03/28/2025
[17:17:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:17:31] [DOC: 9208191] ✅ Text extracted using pdfplumber (48474 chars)
[17:17:31] ✅    ✅ Text extracted using pdfplumber (48474 chars)
[17:17:31] 🔄 
🔄 Step 2: Extracting patient data...
[17:17:36] ℹ️  AI extracted raw sex value: ''
[17:17:36] ℹ️  AI extracted service line: ''
[17:17:36] ℹ️  AI extracted payer source: ''
[17:17:36] ℹ️  AI extracted diagnoses:
[17:17:36] ℹ️    - Diagnosis 1: ''
[17:17:36] ℹ️    - Diagnosis 2: ''
[17:17:36] ℹ️    - Diagnosis 3: ''
[17:17:36] ℹ️    - Diagnosis 4: ''
[17:17:36] ℹ️    - Diagnosis 5: ''
[17:17:36] ℹ️    - Diagnosis 6: ''
[17:17:36] ℹ️  Final extracted MRN: ''
[17:17:36] ℹ️  Final extracted Sex: ''
[17:17:36] ℹ️  Final extracted Service Line: ''
[17:17:36] ℹ️  Final extracted Payer Source: ''
[17:17:36] ✅ Patient data extraction completed successfully
[17:17:36] ✅    ✅ Patient data extracted successfully
[17:17:36] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:17:36] ⚠️     ❌ Insufficient patient data extracted
[17:17:36] [DOC: 9208191] ℹ️  API push details saved for document 9208191
================================================================================
║                        Processing Document ID: 9207838                         ║
================================================================================
[17:17:36] ℹ️  Agency: Kindred At Home-Fall River
[17:17:36] ℹ️  Date: 03/27/2025
[17:17:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:17:38] [DOC: 9207838] ✅ Text extracted using pdfplumber (1449 chars)
[17:17:38] ✅    ✅ Text extracted using pdfplumber (1449 chars)
[17:17:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:17:40] ℹ️  AI extracted raw sex value: ''
[17:17:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:17:40] ℹ️  AI extracted payer source: ''
[17:17:40] ℹ️  AI extracted diagnoses:
[17:17:40] ℹ️    - Diagnosis 1: 'None'
[17:17:40] ℹ️    - Diagnosis 2: 'None'
[17:17:40] ℹ️    - Diagnosis 3: 'None'
[17:17:40] ℹ️    - Diagnosis 4: 'None'
[17:17:40] ℹ️    - Diagnosis 5: 'None'
[17:17:40] ℹ️    - Diagnosis 6: 'None'
[17:17:40] ℹ️  Final extracted MRN: 'A5300179941701'
[17:17:40] ℹ️  Final extracted Sex: ''
[17:17:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:17:40] ℹ️  Final extracted Payer Source: ''
[17:17:40] ✅ Patient data extraction completed successfully
[17:17:40] ✅    ✅ Patient data extracted successfully
[17:17:40] 📊 Patient Response
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:17:40] ✅    ✅ Patient identified: GEORGE BRAMAN
[17:17:40] ✅    ✅ Patient name validation passed
[17:17:40] 🔄 
🔄 Step 3: Processing patient dates...
[17:17:40] [DOC: 9207838] ℹ️  DOB normalized: 07/29/1941
[17:17:40] [DOC: 9207838] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[17:17:40] [DOC: 9207838] ℹ️  Episode endOfEpisode normalized: 01/16/2025
[17:17:40] [DOC: 9207838] ✅ Patient date processing completed successfully
[17:17:40] ✅    ✅ Date processing completed
[17:17:40] 📊 Processed Patient Data
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025'}]
[17:17:40] 🔄 
🔄 Step 4: Extracting order data...
[17:17:43] ℹ️  Order extraction - MRN: 'A5300179941701'
[17:17:43] ℹ️  Order extraction - Sex: ''
[17:17:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:17:43] ℹ️  Order extraction - Payer Source: ''
[17:17:43] ✅ Order data extraction completed successfully
[17:17:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:17:43] ℹ️  Using MRN from patient data: 'A5300179941701' over 'A5300179941701'
[17:17:43] ℹ️  Inferred sex as MALE from name: GEORGE
[17:17:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:17:43] ✅ Patient name cross-validation successful
[17:17:43] ✅    ✅ Data merged successfully
[17:17:45] ✅    ✅ Order data extracted and validated
[17:17:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:17:49] [DOC: 9207838] ✅ Patient exists in API: GEORGE BRAMAN, ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[17:17:49] ✅    ✅ Existing patient found with ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[17:17:49] 🔄 
🔄 Step 6: Pushing order to API...
[17:17:49] [DOC: 9207838] ℹ️  Pushing order via API for patient ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[17:17:50] [DOC: 9207838] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13358"}
[17:17:50] ❌    ❌ Failed to push order
[17:17:50] 🔄 
🔄 Step 7: Writing to CSV...
[17:17:50] [DOC: 9207838] ℹ️  Calculated age: 83 from DOB: 07/29/1941
[17:17:50] [DOC: 9207838] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:17:50] [DOC: 9207838] ℹ️  Payer Source extracted: ''
[17:17:50] [DOC: 9207838] ℹ️  Diagnosis codes being written:
[17:17:50] [DOC: 9207838] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:17:50] [DOC: 9207838] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:17:50] [DOC: 9207838] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:17:50] [DOC: 9207838] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:17:50] [DOC: 9207838] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:17:50] [DOC: 9207838] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:17:50] [DOC: 9207838] ✅ Patient data written to CSV: GEORGE BRAMAN | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: A5300179941701
[17:17:50] ✅    ✅ Document 9207838 processed and saved successfully
[17:17:50] 🔄 
🔄 Step 8: Saving API details...
[17:17:50] [DOC: 9207838] ℹ️  API push details saved for document 9207838
[17:17:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207717                         ║
================================================================================
[17:17:50] ℹ️  Agency: Kindred At Home-Fall River
[17:17:50] ℹ️  Date: 03/27/2025
[17:17:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:17:53] [DOC: 9207717] ✅ Text extracted using pdfplumber (1449 chars)
[17:17:53] ✅    ✅ Text extracted using pdfplumber (1449 chars)
[17:17:53] 🔄 
🔄 Step 2: Extracting patient data...
[17:17:56] ℹ️  AI extracted raw sex value: ''
[17:17:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:17:56] ℹ️  AI extracted payer source: ''
[17:17:56] ℹ️  AI extracted diagnoses:
[17:17:56] ℹ️    - Diagnosis 1: 'None'
[17:17:56] ℹ️    - Diagnosis 2: 'None'
[17:17:56] ℹ️    - Diagnosis 3: 'None'
[17:17:56] ℹ️    - Diagnosis 4: 'None'
[17:17:56] ℹ️    - Diagnosis 5: 'None'
[17:17:56] ℹ️    - Diagnosis 6: 'None'
[17:17:56] ℹ️  Final extracted MRN: 'A5300179941701'
[17:17:56] ℹ️  Final extracted Sex: ''
[17:17:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:17:56] ℹ️  Final extracted Payer Source: ''
[17:17:56] ✅ Patient data extraction completed successfully
[17:17:56] ✅    ✅ Patient data extracted successfully
[17:17:56] 📊 Patient Response
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:17:56] ✅    ✅ Patient identified: GEORGE BRAMAN
[17:17:56] ✅    ✅ Patient name validation passed
[17:17:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:17:56] [DOC: 9207717] ℹ️  DOB normalized: 07/29/1941
[17:17:56] [DOC: 9207717] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[17:17:56] [DOC: 9207717] ℹ️  Episode endOfEpisode normalized: 01/16/2025
[17:17:56] [DOC: 9207717] ✅ Patient date processing completed successfully
[17:17:56] ✅    ✅ Date processing completed
[17:17:56] 📊 Processed Patient Data
     └─ patientFName: GEORGE
     └─ patientLName: BRAMAN
     └─ dob: 07/29/1941
     └─ patientSex: 
     └─ medicalRecordNo: A5300179941701
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CENTERWELL HOME HEALTH
     └─ address: 275 MARTINE STREET
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1500
     └─ email: 
     └─ phoneNumber: (508) 672-0675
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '01/16/2025'}]
[17:17:56] 🔄 
🔄 Step 4: Extracting order data...
[17:17:58] ℹ️  Order extraction - MRN: 'A5300179941701'
[17:17:58] ℹ️  Order extraction - Sex: ''
[17:17:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:17:58] ℹ️  Order extraction - Payer Source: ''
[17:17:58] ✅ Order data extraction completed successfully
[17:17:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:17:58] ℹ️  Using MRN from patient data: 'A5300179941701' over 'A5300179941701'
[17:17:58] ℹ️  Inferred sex as MALE from name: GEORGE
[17:17:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:17:58] ✅ Patient name cross-validation successful
[17:17:58] ✅    ✅ Data merged successfully
[17:18:00] ✅    ✅ Order data extracted and validated
[17:18:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:18:00] [DOC: 9207717] ✅ Patient found in local cache: GEORGE BRAMAN, ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[17:18:00] ✅    ✅ Existing patient found with ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[17:18:00] 🔄 
🔄 Step 6: Pushing order to API...
[17:18:00] [DOC: 9207717] ℹ️  Pushing order via API for patient ID: 21d637be-cab1-4c9d-a2ca-44fba0c734e3
[17:18:01] [DOC: 9207717] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13358"}
[17:18:01] ❌    ❌ Failed to push order
[17:18:01] 🔄 
🔄 Step 7: Writing to CSV...
[17:18:01] [DOC: 9207717] ℹ️  Calculated age: 83 from DOB: 07/29/1941
[17:18:01] [DOC: 9207717] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:18:01] [DOC: 9207717] ℹ️  Payer Source extracted: ''
[17:18:01] [DOC: 9207717] ℹ️  Diagnosis codes being written:
[17:18:01] [DOC: 9207717] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:18:01] [DOC: 9207717] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:18:01] [DOC: 9207717] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:18:01] [DOC: 9207717] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:18:01] [DOC: 9207717] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:18:01] [DOC: 9207717] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:18:01] [DOC: 9207717] ✅ Patient data written to CSV: GEORGE BRAMAN | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: A5300179941701
[17:18:01] ✅    ✅ Document 9207717 processed and saved successfully
[17:18:01] 🔄 
🔄 Step 8: Saving API details...
[17:18:01] [DOC: 9207717] ℹ️  API push details saved for document 9207717
[17:18:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207701                         ║
================================================================================
[17:18:01] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:18:01] ℹ️  Date: 03/27/2025
[17:18:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:18:04] [DOC: 9207701] ✅ Text extracted using pdfplumber (5010 chars)
[17:18:04] ✅    ✅ Text extracted using pdfplumber (5010 chars)
[17:18:04] 🔄 
🔄 Step 2: Extracting patient data...
[17:18:07] ℹ️  AI extracted raw sex value: 'M'
[17:18:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:18:07] ℹ️  AI extracted payer source: ''
[17:18:07] ℹ️  AI extracted diagnoses:
[17:18:07] ℹ️    - Diagnosis 1: 'F20.0'
[17:18:07] ℹ️    - Diagnosis 2: 'None'
[17:18:07] ℹ️    - Diagnosis 3: 'None'
[17:18:07] ℹ️    - Diagnosis 4: 'None'
[17:18:07] ℹ️    - Diagnosis 5: 'None'
[17:18:07] ℹ️    - Diagnosis 6: 'None'
[17:18:07] ℹ️  Final extracted MRN: '174003'
[17:18:07] ℹ️  Final extracted Sex: 'MALE'
[17:18:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:18:07] ℹ️  Final extracted Payer Source: ''
[17:18:07] ✅ Patient data extraction completed successfully
[17:18:07] ✅    ✅ Patient data extracted successfully
[17:18:07] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 227504
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:18:07] ✅    ✅ Patient identified: Julio Philogene
[17:18:07] ✅    ✅ Patient name validation passed
[17:18:07] 🔄 
🔄 Step 3: Processing patient dates...
[17:18:07] [DOC: 9207701] ℹ️  DOB normalized: 07/29/1980
[17:18:07] [DOC: 9207701] ℹ️  Episode startOfCare normalized: 09/08/2017
[17:18:07] [DOC: 9207701] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[17:18:07] [DOC: 9207701] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[17:18:07] [DOC: 9207701] ✅ Patient date processing completed successfully
[17:18:07] ✅    ✅ Date processing completed
[17:18:07] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 227504
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F20.0'}]
[17:18:07] 🔄 
🔄 Step 4: Extracting order data...
[17:18:09] ℹ️  Order extraction - MRN: '174003'
[17:18:09] ℹ️  Order extraction - Sex: 'MALE'
[17:18:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:18:09] ℹ️  Order extraction - Payer Source: ''
[17:18:09] ✅ Order data extraction completed successfully
[17:18:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:18:09] ℹ️  Using MRN from patient data: '174003' over '174003'
[17:18:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:18:09] ✅ Patient name cross-validation successful
[17:18:09] ✅    ✅ Data merged successfully
[17:18:10] ✅    ✅ Order data extracted and validated
[17:18:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:18:10] [DOC: 9207701] ✅ Patient found in local cache: Julio Philogene, ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[17:18:10] ✅    ✅ Existing patient found with ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[17:18:10] 🔄 
🔄 Step 6: Pushing order to API...
[17:18:10] [DOC: 9207701] ℹ️  Pushing order via API for patient ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[17:18:12] [DOC: 9207701] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:18:12] ❌    ❌ Failed to push order
[17:18:12] 🔄 
🔄 Step 7: Writing to CSV...
[17:18:12] [DOC: 9207701] ℹ️  Calculated age: 44 from DOB: 07/29/1980
[17:18:12] [DOC: 9207701] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:18:12] [DOC: 9207701] ℹ️  Payer Source extracted: ''
[17:18:12] [DOC: 9207701] ℹ️  Diagnosis codes being written:
[17:18:12] [DOC: 9207701] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.0'
[17:18:12] [DOC: 9207701] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:18:12] [DOC: 9207701] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:18:12] [DOC: 9207701] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:18:12] [DOC: 9207701] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:18:12] [DOC: 9207701] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:18:12] [DOC: 9207701] ✅ Patient data written to CSV: Julio Philogene | Sex: MALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 174003
[17:18:12] ✅    ✅ Document 9207701 processed and saved successfully
[17:18:12] 🔄 
🔄 Step 8: Saving API details...
[17:18:12] [DOC: 9207701] ℹ️  API push details saved for document 9207701
[17:18:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207639                         ║
================================================================================
[17:18:12] ℹ️  Agency: AccentCare Fall River
[17:18:12] ℹ️  Date: 03/27/2025
[17:18:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:18:39] [DOC: 9207639] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[17:18:48] [DOC: 9207639] ✅ Text extracted using tesseract_ocr (18502 chars)
[17:18:48] ✅    ✅ Text extracted using tesseract_ocr (18476 chars)
[17:18:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:18:52] ℹ️  AI extracted raw sex value: 'M'
[17:18:52] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[17:18:52] ℹ️  AI extracted payer source: 'Medicare'
[17:18:52] ℹ️  AI extracted diagnoses:
[17:18:52] ℹ️    - Diagnosis 1: 'I21.02'
[17:18:52] ℹ️    - Diagnosis 2: 'I11.0'
[17:18:52] ℹ️    - Diagnosis 3: 'I50.20'
[17:18:52] ℹ️    - Diagnosis 4: 'E11.9'
[17:18:52] ℹ️    - Diagnosis 5: 'J96.01'
[17:18:52] ℹ️    - Diagnosis 6: 'E78.5'
[17:18:52] ℹ️  Final extracted MRN: '0200233978101'
[17:18:52] ℹ️  Final extracted Sex: 'MALE'
[17:18:52] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[17:18:52] ℹ️  Final extracted Payer Source: 'Medicare'
[17:18:52] ✅ Patient data extraction completed successfully
[17:18:52] ✅    ✅ Patient data extracted successfully
[17:18:52] 📊 Patient Response
     └─ patientFName: PAULO
     └─ patientLName: SANTOS
     └─ dob: 04/12/1971
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200233978101
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 13 SUSAN LANE
     └─ city: MIDDLEBORO
     └─ state: MA
     └─ zip: 02346
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'I21.02', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.20', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'E78.5'}]
[17:18:52] ✅    ✅ Patient identified: PAULO SANTOS
[17:18:52] ✅    ✅ Patient name validation passed
[17:18:52] 🔄 
🔄 Step 3: Processing patient dates...
[17:18:52] [DOC: 9207639] ℹ️  DOB normalized: 04/12/1971
[17:18:52] [DOC: 9207639] ℹ️  Episode startOfCare normalized: 03/14/2025
[17:18:52] [DOC: 9207639] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[17:18:52] [DOC: 9207639] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[17:18:52] [DOC: 9207639] ✅ Patient date processing completed successfully
[17:18:52] ✅    ✅ Date processing completed
[17:18:52] 📊 Processed Patient Data
     └─ patientFName: PAULO
     └─ patientLName: SANTOS
     └─ dob: 04/12/1971
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200233978101
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 13 SUSAN LANE
     └─ city: MIDDLEBORO
     └─ state: MA
     └─ zip: 02346
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'I21.02', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.20', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'E78.5'}]
[17:18:52] 🔄 
🔄 Step 4: Extracting order data...
[17:18:54] ℹ️  Order extraction - MRN: '227203'
[17:18:54] ℹ️  Order extraction - Sex: 'MALE'
[17:18:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[17:18:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:18:54] ✅ Order data extraction completed successfully
[17:18:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:18:54] ℹ️  Using MRN from patient data: '0200233978101' over '227203'
[17:18:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[17:18:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:18:54] ✅ Patient name cross-validation successful
[17:18:54] ✅    ✅ Data merged successfully
[17:18:56] ✅    ✅ Order data extracted and validated
[17:18:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:19:01] [DOC: 9207639] ℹ️  Patient not found in cache or API: PAULO SANTOS
[17:19:01] [DOC: 9207639] ℹ️  Patient not found, creating new patient via API...
[17:19:01] [DOC: 9207639] ℹ️  Creating patient via API: PAULO SANTOS
[17:19:02] [DOC: 9207639] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:19:02] ❌    ❌ Failed to create patient
[17:19:02] [DOC: 9207639] ℹ️  API push details saved for document 9207639
================================================================================
║                        Processing Document ID: 9207477                         ║
================================================================================
[17:19:02] ℹ️  Agency: AccentCare Fall River
[17:19:02] ℹ️  Date: 03/27/2025
[17:19:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:19:17] [DOC: 9207477] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[17:19:22] [DOC: 9207477] ✅ Text extracted using tesseract_ocr (8133 chars)
[17:19:22] ✅    ✅ Text extracted using tesseract_ocr (8119 chars)
[17:19:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:19:24] ℹ️  AI extracted raw sex value: ''
[17:19:24] ℹ️  AI extracted service line: 'Physical Therapy'
[17:19:24] ℹ️  AI extracted payer source: ''
[17:19:24] ℹ️  AI extracted diagnoses:
[17:19:24] ℹ️    - Diagnosis 1: 'I69.354'
[17:19:24] ℹ️    - Diagnosis 2: 'G40.401'
[17:19:24] ℹ️    - Diagnosis 3: 'None'
[17:19:24] ℹ️    - Diagnosis 4: 'None'
[17:19:24] ℹ️    - Diagnosis 5: 'None'
[17:19:24] ℹ️    - Diagnosis 6: 'None'
[17:19:24] ℹ️  Final extracted MRN: 'C0200204515501'
[17:19:24] ℹ️  Final extracted Sex: ''
[17:19:24] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:19:24] ℹ️  Final extracted Payer Source: ''
[17:19:24] ✅ Patient data extraction completed successfully
[17:19:24] ✅    ✅ Patient data extracted successfully
[17:19:24] 📊 Patient Response
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'G40.401', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:19:24] ✅    ✅ Patient identified: MILTON ACOSTA JR
[17:19:24] ✅    ✅ Patient name validation passed
[17:19:24] 🔄 
🔄 Step 3: Processing patient dates...
[17:19:24] [DOC: 9207477] ℹ️  DOB normalized: 10/23/1982
[17:19:24] [DOC: 9207477] ✅ Patient date processing completed successfully
[17:19:24] ✅    ✅ Date processing completed
[17:19:24] 📊 Processed Patient Data
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'G40.401'}]
[17:19:24] 🔄 
🔄 Step 4: Extracting order data...
[17:19:27] ℹ️  Order extraction - MRN: 'C0200204515501'
[17:19:27] ℹ️  Order extraction - Sex: ''
[17:19:27] ℹ️  Order extraction - Service Line: 'PT'
[17:19:27] ℹ️  Order extraction - Payer Source: ''
[17:19:27] ✅ Order data extraction completed successfully
[17:19:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:19:27] ℹ️  Using MRN from patient data: 'C0200204515501' over 'C0200204515501'
[17:19:27] ℹ️  Inferred sex as MALE from name: MILTON
[17:19:27] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[17:19:27] ✅ Patient name cross-validation successful
[17:19:27] ✅    ✅ Data merged successfully
[17:19:29] ✅    ✅ Order data extracted and validated
[17:19:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:20:17] [DOC: 9207477] ℹ️  Patient not found in cache or API: MILTON ACOSTA JR
[17:20:17] [DOC: 9207477] ℹ️  Patient not found, creating new patient via API...
[17:20:17] [DOC: 9207477] ℹ️  Creating patient via API: MILTON ACOSTA JR
[17:20:18] [DOC: 9207477] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:20:18] ❌    ❌ Failed to create patient
[17:20:18] [DOC: 9207477] ℹ️  API push details saved for document 9207477
================================================================================
║                        Processing Document ID: 9207378                         ║
================================================================================
[17:20:18] ℹ️  Agency: Relief Home Health Services
[17:20:18] ℹ️  Date: 03/27/2025
[17:20:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:20:23] [DOC: 9207378] ✅ Text extracted using pdfplumber (15043 chars)
[17:20:23] ✅    ✅ Text extracted using pdfplumber (15043 chars)
[17:20:23] 🔄 
🔄 Step 2: Extracting patient data...
[17:20:26] ℹ️  AI extracted raw sex value: 'M'
[17:20:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:20:26] ℹ️  AI extracted payer source: ''
[17:20:26] ℹ️  AI extracted diagnoses:
[17:20:26] ℹ️    - Diagnosis 1: 'E11.9'
[17:20:26] ℹ️    - Diagnosis 2: 'J44.9'
[17:20:26] ℹ️    - Diagnosis 3: 'I10'
[17:20:26] ℹ️    - Diagnosis 4: 'N17.9'
[17:20:26] ℹ️    - Diagnosis 5: 'F20.0'
[17:20:26] ℹ️    - Diagnosis 6: 'E78.2'
[17:20:26] ℹ️  Final extracted MRN: 'NB0097'
[17:20:26] ℹ️  Final extracted Sex: 'MALE'
[17:20:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:20:26] ℹ️  Final extracted Payer Source: ''
[17:20:26] ✅ Patient data extraction completed successfully
[17:20:26] ✅    ✅ Patient data extracted successfully
[17:20:26] 📊 Patient Response
     └─ patientFName: DANIEL
     └─ patientLName: BERBERENA
     └─ dob: 07/28/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0097
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 17 Mill Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 995-2148
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'F20.0', 'sixthDiagnosis': 'E78.2'}]
[17:20:26] ✅    ✅ Patient identified: DANIEL BERBERENA
[17:20:26] ✅    ✅ Patient name validation passed
[17:20:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:20:26] [DOC: 9207378] ℹ️  DOB normalized: 07/28/1960
[17:20:26] [DOC: 9207378] ℹ️  Episode startOfCare normalized: 03/18/2024
[17:20:26] [DOC: 9207378] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[17:20:26] [DOC: 9207378] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[17:20:26] [DOC: 9207378] ✅ Patient date processing completed successfully
[17:20:26] ✅    ✅ Date processing completed
[17:20:26] 📊 Processed Patient Data
     └─ patientFName: DANIEL
     └─ patientLName: BERBERENA
     └─ dob: 07/28/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0097
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 17 Mill Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 995-2148
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'F20.0', 'sixthDiagnosis': 'E78.2'}]
[17:20:26] 🔄 
🔄 Step 4: Extracting order data...
[17:20:29] ℹ️  Order extraction - MRN: 'NB0097'
[17:20:29] ℹ️  Order extraction - Sex: 'MALE'
[17:20:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:20:29] ℹ️  Order extraction - Payer Source: ''
[17:20:29] ✅ Order data extraction completed successfully
[17:20:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:20:29] ℹ️  Using MRN from patient data: 'NB0097' over 'NB0097'
[17:20:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:20:29] ✅ Patient name cross-validation successful
[17:20:29] ✅    ✅ Data merged successfully
[17:20:30] ✅    ✅ Order data extracted and validated
[17:20:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:20:56] [DOC: 9207378] ✅ Patient exists in API: DANIEL BERBERENA, ID: 2b25b2e9-ebc2-45fa-8462-b4dba468ebe0
[17:20:56] ✅    ✅ Existing patient found with ID: 2b25b2e9-ebc2-45fa-8462-b4dba468ebe0
[17:20:56] 🔄 
🔄 Step 6: Pushing order to API...
[17:20:56] [DOC: 9207378] ℹ️  Pushing order via API for patient ID: 2b25b2e9-ebc2-45fa-8462-b4dba468ebe0
[17:20:58] [DOC: 9207378] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:20:58] ❌    ❌ Failed to push order
[17:20:58] 🔄 
🔄 Step 7: Writing to CSV...
[17:20:58] [DOC: 9207378] ℹ️  Calculated age: 64 from DOB: 07/28/1960
[17:20:58] [DOC: 9207378] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:20:58] [DOC: 9207378] ℹ️  Payer Source extracted: ''
[17:20:58] [DOC: 9207378] ℹ️  Diagnosis codes being written:
[17:20:58] [DOC: 9207378] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[17:20:58] [DOC: 9207378] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[17:20:58] [DOC: 9207378] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[17:20:58] [DOC: 9207378] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N17.9'
[17:20:58] [DOC: 9207378] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F20.0'
[17:20:58] [DOC: 9207378] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.2'
[17:20:58] [DOC: 9207378] ✅ Patient data written to CSV: DANIEL BERBERENA | Sex: MALE | Age: 64 | Service: Skilled Nursing | Payer:  | MRN: NB0097
[17:20:58] ✅    ✅ Document 9207378 processed and saved successfully
[17:20:58] 🔄 
🔄 Step 8: Saving API details...
[17:20:58] [DOC: 9207378] ℹ️  API push details saved for document 9207378
[17:20:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207238                         ║
================================================================================
[17:20:58] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:20:58] ℹ️  Date: 03/27/2025
[17:20:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:21:00] [DOC: 9207238] ✅ Text extracted using pdfplumber (8118 chars)
[17:21:00] ✅    ✅ Text extracted using pdfplumber (8118 chars)
[17:21:00] 🔄 
🔄 Step 2: Extracting patient data...
[17:21:03] ℹ️  AI extracted raw sex value: 'F'
[17:21:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:21:03] ℹ️  AI extracted payer source: ''
[17:21:03] ℹ️  AI extracted diagnoses:
[17:21:03] ℹ️    - Diagnosis 1: 'E11.22'
[17:21:03] ℹ️    - Diagnosis 2: 'I12.9'
[17:21:03] ℹ️    - Diagnosis 3: 'N18.31'
[17:21:03] ℹ️    - Diagnosis 4: 'F32.2'
[17:21:03] ℹ️    - Diagnosis 5: 'E11.42'
[17:21:03] ℹ️    - Diagnosis 6: 'K59.00'
[17:21:03] ℹ️  Final extracted MRN: '554005'
[17:21:03] ℹ️  Final extracted Sex: 'FEMALE'
[17:21:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:21:03] ℹ️  Final extracted Payer Source: ''
[17:21:03] ✅ Patient data extraction completed successfully
[17:21:03] ✅    ✅ Patient data extracted successfully
[17:21:03] 📊 Patient Response
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100031947029
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'F32.2', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'K59.00'}]
[17:21:03] ✅    ✅ Patient identified: Yomayra Velez-Morales
[17:21:03] ✅    ✅ Patient name validation passed
[17:21:03] 🔄 
🔄 Step 3: Processing patient dates...
[17:21:03] [DOC: 9207238] ℹ️  DOB normalized: 10/26/1975
[17:21:03] [DOC: 9207238] ℹ️  Episode startOfCare normalized: 06/04/2024
[17:21:03] [DOC: 9207238] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[17:21:03] [DOC: 9207238] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[17:21:03] [DOC: 9207238] ✅ Patient date processing completed successfully
[17:21:03] ✅    ✅ Date processing completed
[17:21:03] 📊 Processed Patient Data
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100031947029
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'F32.2', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'K59.00'}]
[17:21:03] 🔄 
🔄 Step 4: Extracting order data...
[17:21:06] ℹ️  Order extraction - MRN: '554005'
[17:21:06] ℹ️  Order extraction - Sex: 'FEMALE'
[17:21:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:21:06] ℹ️  Order extraction - Payer Source: ''
[17:21:06] ✅ Order data extraction completed successfully
[17:21:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:21:06] ℹ️  Using MRN from patient data: '554005' over '554005'
[17:21:06] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[17:21:06] ✅ Patient name cross-validation successful
[17:21:06] ✅    ✅ Data merged successfully
[17:21:07] ✅    ✅ Order data extracted and validated
[17:21:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:21:07] [DOC: 9207238] ✅ Patient found in local cache: Yomayra Velez-Morales, ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[17:21:07] ✅    ✅ Existing patient found with ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[17:21:07] 🔄 
🔄 Step 6: Pushing order to API...
[17:21:07] [DOC: 9207238] ℹ️  Pushing order via API for patient ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[17:21:09] [DOC: 9207238] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14386"}
[17:21:09] ❌    ❌ Failed to push order
[17:21:09] 🔄 
🔄 Step 7: Writing to CSV...
[17:21:09] [DOC: 9207238] ℹ️  Calculated age: 49 from DOB: 10/26/1975
[17:21:09] [DOC: 9207238] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[17:21:09] [DOC: 9207238] ℹ️  Payer Source extracted: ''
[17:21:09] [DOC: 9207238] ℹ️  Diagnosis codes being written:
[17:21:09] [DOC: 9207238] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[17:21:09] [DOC: 9207238] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[17:21:09] [DOC: 9207238] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[17:21:09] [DOC: 9207238] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F32.2'
[17:21:09] [DOC: 9207238] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.42'
[17:21:09] [DOC: 9207238] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.00'
[17:21:09] [DOC: 9207238] ✅ Patient data written to CSV: Yomayra Velez-Morales | Sex: FEMALE | Age: 49 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 554005
[17:21:09] ✅    ✅ Document 9207238 processed and saved successfully
[17:21:09] 🔄 
🔄 Step 8: Saving API details...
[17:21:09] [DOC: 9207238] ℹ️  API push details saved for document 9207238
[17:21:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207208                         ║
================================================================================
[17:21:09] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:21:09] ℹ️  Date: 03/27/2025
[17:21:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:21:11] [DOC: 9207208] ✅ Text extracted using pdfplumber (7797 chars)
[17:21:11] ✅    ✅ Text extracted using pdfplumber (7797 chars)
[17:21:11] 🔄 
🔄 Step 2: Extracting patient data...
[17:21:15] ℹ️  AI extracted raw sex value: 'F'
[17:21:15] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[17:21:15] ℹ️  AI extracted payer source: ''
[17:21:15] ℹ️  AI extracted diagnoses:
[17:21:15] ℹ️    - Diagnosis 1: 'E11.22'
[17:21:15] ℹ️    - Diagnosis 2: 'I13.0'
[17:21:15] ℹ️    - Diagnosis 3: 'I50.32'
[17:21:15] ℹ️    - Diagnosis 4: 'N18.30'
[17:21:15] ℹ️    - Diagnosis 5: 'E11.40'
[17:21:15] ℹ️    - Diagnosis 6: 'I48.0'
[17:21:15] ℹ️  Final extracted MRN: '76003'
[17:21:15] ℹ️  Final extracted Sex: 'FEMALE'
[17:21:15] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[17:21:15] ℹ️  Final extracted Payer Source: ''
[17:21:15] ✅ Patient data extraction completed successfully
[17:21:15] ✅    ✅ Patient data extracted successfully
[17:21:15] 📊 Patient Response
     └─ patientFName: Gili
     └─ patientLName: Aquilina
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 100030707135
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '08/07/2023', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I48.0'}]
[17:21:15] ✅    ✅ Patient identified: Gili Aquilina
[17:21:15] ✅    ✅ Patient name validation passed
[17:21:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:21:15] [DOC: 9207208] ℹ️  DOB normalized: 06/13/1934
[17:21:15] [DOC: 9207208] ℹ️  Episode startOfCare normalized: 08/07/2023
[17:21:15] [DOC: 9207208] ℹ️  Episode startOfEpisode normalized: 08/07/2023
[17:21:15] [DOC: 9207208] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[17:21:15] [DOC: 9207208] ✅ Patient date processing completed successfully
[17:21:15] ✅    ✅ Date processing completed
[17:21:15] 📊 Processed Patient Data
     └─ patientFName: Gili
     └─ patientLName: Aquilina
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 100030707135
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '08/07/2023', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I48.0'}]
[17:21:15] 🔄 
🔄 Step 4: Extracting order data...
[17:21:17] ℹ️  Order extraction - MRN: '76003'
[17:21:17] ℹ️  Order extraction - Sex: 'FEMALE'
[17:21:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[17:21:17] ℹ️  Order extraction - Payer Source: ''
[17:21:17] ✅ Order data extraction completed successfully
[17:21:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:21:17] ℹ️  Using MRN from patient data: '76003' over '76003'
[17:21:17] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[17:21:17] ✅ Patient name cross-validation successful
[17:21:17] ✅    ✅ Data merged successfully
[17:21:18] ✅    ✅ Order data extracted and validated
[17:21:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:21:28] [DOC: 9207208] ℹ️  Patient not found in cache or API: Gili Aquilina
[17:21:28] [DOC: 9207208] ℹ️  Patient not found, creating new patient via API...
[17:21:28] [DOC: 9207208] ℹ️  Creating patient via API: Gili Aquilina
[17:21:29] [DOC: 9207208] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:21:29] ❌    ❌ Failed to create patient
[17:21:29] [DOC: 9207208] ℹ️  API push details saved for document 9207208
================================================================================
║                        Processing Document ID: 9207206                         ║
================================================================================
[17:21:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:21:29] ℹ️  Date: 03/27/2025
[17:21:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:21:30] [DOC: 9207206] ✅ Text extracted using pdfplumber (1022 chars)
[17:21:30] ✅    ✅ Text extracted using pdfplumber (1022 chars)
[17:21:30] 🔄 
🔄 Step 2: Extracting patient data...
[17:21:33] ℹ️  AI extracted raw sex value: 'M'
[17:21:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:21:33] ℹ️  AI extracted payer source: ''
[17:21:33] ℹ️  AI extracted diagnoses:
[17:21:33] ℹ️    - Diagnosis 1: ''
[17:21:33] ℹ️    - Diagnosis 2: ''
[17:21:33] ℹ️    - Diagnosis 3: ''
[17:21:33] ℹ️    - Diagnosis 4: ''
[17:21:33] ℹ️    - Diagnosis 5: ''
[17:21:33] ℹ️    - Diagnosis 6: ''
[17:21:33] ℹ️  Final extracted MRN: '3018837'
[17:21:33] ℹ️  Final extracted Sex: 'MALE'
[17:21:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:21:33] ℹ️  Final extracted Payer Source: ''
[17:21:33] ✅ Patient data extraction completed successfully
[17:21:33] ✅    ✅ Patient data extracted successfully
[17:21:33] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Sweeney
     └─ dob: 02/21/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 3018837
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:21:33] ✅    ✅ Patient identified: Edward Sweeney
[17:21:33] ✅    ✅ Patient name validation passed
[17:21:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:21:33] [DOC: 9207206] ℹ️  DOB normalized: 02/21/1946
[17:21:33] [DOC: 9207206] ✅ Patient date processing completed successfully
[17:21:33] ✅    ✅ Date processing completed
[17:21:33] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Sweeney
     └─ dob: 02/21/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 3018837
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:21:33] 🔄 
🔄 Step 4: Extracting order data...
[17:21:35] ℹ️  Order extraction - MRN: '3018837'
[17:21:35] ℹ️  Order extraction - Sex: 'MALE'
[17:21:35] ℹ️  Order extraction - Service Line: ''
[17:21:35] ℹ️  Order extraction - Payer Source: ''
[17:21:35] ✅ Order data extraction completed successfully
[17:21:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:21:35] ℹ️  Using MRN from patient data: '3018837' over '3018837'
[17:21:35] ℹ️  Using service line from patient data: 'Skilled Nursing'
[17:21:35] ✅ Patient name cross-validation successful
[17:21:35] ✅    ✅ Data merged successfully
[17:21:36] ✅    ✅ Order data extracted and validated
[17:21:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:21:40] [DOC: 9207206] ℹ️  Patient not found in cache or API: Edward Sweeney
[17:21:40] [DOC: 9207206] ℹ️  Patient not found, creating new patient via API...
[17:21:40] [DOC: 9207206] ℹ️  Creating patient via API: Edward Sweeney
[17:21:42] [DOC: 9207206] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:21:42] ❌    ❌ Failed to create patient
[17:21:42] [DOC: 9207206] ℹ️  API push details saved for document 9207206
================================================================================
║                        Processing Document ID: 9207197                         ║
================================================================================
[17:21:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:21:42] ℹ️  Date: 03/27/2025
[17:21:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:21:44] [DOC: 9207197] ✅ Text extracted using pdfplumber (1191 chars)
[17:21:44] ✅    ✅ Text extracted using pdfplumber (1191 chars)
[17:21:44] 🔄 
🔄 Step 2: Extracting patient data...
[17:21:46] ℹ️  AI extracted raw sex value: 'M'
[17:21:46] ℹ️  AI extracted service line: ''
[17:21:46] ℹ️  AI extracted payer source: ''
[17:21:46] ℹ️  AI extracted diagnoses:
[17:21:46] ℹ️    - Diagnosis 1: ''
[17:21:46] ℹ️    - Diagnosis 2: ''
[17:21:46] ℹ️    - Diagnosis 3: ''
[17:21:46] ℹ️    - Diagnosis 4: ''
[17:21:46] ℹ️    - Diagnosis 5: ''
[17:21:46] ℹ️    - Diagnosis 6: ''
[17:21:46] ℹ️  Final extracted MRN: '2060640'
[17:21:46] ℹ️  Final extracted Sex: 'MALE'
[17:21:46] ℹ️  Final extracted Service Line: ''
[17:21:46] ℹ️  Final extracted Payer Source: ''
[17:21:46] ✅ Patient data extraction completed successfully
[17:21:46] ✅    ✅ Patient data extracted successfully
[17:21:46] 📊 Patient Response
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:21:46] ✅    ✅ Patient identified: Elisio Pimental
[17:21:46] ✅    ✅ Patient name validation passed
[17:21:46] 🔄 
🔄 Step 3: Processing patient dates...
[17:21:46] [DOC: 9207197] ℹ️  DOB normalized: 05/17/1944
[17:21:46] [DOC: 9207197] ✅ Patient date processing completed successfully
[17:21:46] ✅    ✅ Date processing completed
[17:21:46] 📊 Processed Patient Data
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:21:46] 🔄 
🔄 Step 4: Extracting order data...
[17:21:49] ℹ️  Order extraction - MRN: '2060640'
[17:21:49] ℹ️  Order extraction - Sex: 'MALE'
[17:21:49] ℹ️  Order extraction - Service Line: ''
[17:21:49] ℹ️  Order extraction - Payer Source: ''
[17:21:49] ✅ Order data extraction completed successfully
[17:21:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:21:49] ℹ️  Using MRN from patient data: '2060640' over '2060640'
[17:21:49] ✅ Patient name cross-validation successful
[17:21:49] ✅    ✅ Data merged successfully
[17:21:50] ⚠️     ❌ Skipping - missing episode start date
[17:21:50] [DOC: 9207197] ℹ️  API push details saved for document 9207197
================================================================================
║                        Processing Document ID: 9207178                         ║
================================================================================
[17:21:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:21:50] ℹ️  Date: 03/27/2025
[17:21:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:21:51] [DOC: 9207178] ✅ Text extracted using pdfplumber (1301 chars)
[17:21:51] ✅    ✅ Text extracted using pdfplumber (1301 chars)
[17:21:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:21:54] ℹ️  AI extracted raw sex value: 'F'
[17:21:54] ℹ️  AI extracted service line: 'RN'
[17:21:54] ℹ️  AI extracted payer source: ''
[17:21:54] ℹ️  AI extracted diagnoses:
[17:21:54] ℹ️    - Diagnosis 1: ''
[17:21:54] ℹ️    - Diagnosis 2: ''
[17:21:54] ℹ️    - Diagnosis 3: ''
[17:21:54] ℹ️    - Diagnosis 4: ''
[17:21:54] ℹ️    - Diagnosis 5: ''
[17:21:54] ℹ️    - Diagnosis 6: ''
[17:21:54] ℹ️  Final extracted MRN: '2695202'
[17:21:54] ℹ️  Final extracted Sex: 'FEMALE'
[17:21:54] ℹ️  Final extracted Service Line: 'RN'
[17:21:54] ℹ️  Final extracted Payer Source: ''
[17:21:54] ✅ Patient data extraction completed successfully
[17:21:54] ✅    ✅ Patient data extracted successfully
[17:21:54] 📊 Patient Response
     └─ patientFName: Jennifer
     └─ patientLName: Mare-Esteireiro
     └─ dob: 03/29/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2695202
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:21:54] ✅    ✅ Patient identified: Jennifer Mare-Esteireiro
[17:21:54] ✅    ✅ Patient name validation passed
[17:21:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:21:54] [DOC: 9207178] ℹ️  DOB normalized: 03/29/1981
[17:21:54] [DOC: 9207178] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[17:21:54] [DOC: 9207178] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[17:21:54] [DOC: 9207178] ✅ Patient date processing completed successfully
[17:21:54] ✅    ✅ Date processing completed
[17:21:54] 📊 Processed Patient Data
     └─ patientFName: Jennifer
     └─ patientLName: Mare-Esteireiro
     └─ dob: 03/29/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2695202
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:21:54] 🔄 
🔄 Step 4: Extracting order data...
[17:21:56] ℹ️  Order extraction - MRN: '2695202'
[17:21:56] ℹ️  Order extraction - Sex: 'FEMALE'
[17:21:56] ℹ️  Order extraction - Service Line: ''
[17:21:56] ℹ️  Order extraction - Payer Source: ''
[17:21:56] ✅ Order data extraction completed successfully
[17:21:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:21:56] ℹ️  Using MRN from patient data: '2695202' over '2695202'
[17:21:56] ℹ️  Using service line from patient data: 'RN'
[17:21:56] ✅ Patient name cross-validation successful
[17:21:56] ✅    ✅ Data merged successfully
[17:21:58] ✅    ✅ Order data extracted and validated
[17:21:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:22:04] [DOC: 9207178] ℹ️  Patient not found in cache or API: Jennifer Mare-Esteireiro
[17:22:04] [DOC: 9207178] ℹ️  Patient not found, creating new patient via API...
[17:22:04] [DOC: 9207178] ℹ️  Creating patient via API: Jennifer Mare-Esteireiro
[17:22:06] [DOC: 9207178] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:22:06] ❌    ❌ Failed to create patient
[17:22:06] [DOC: 9207178] ℹ️  API push details saved for document 9207178
================================================================================
║                        Processing Document ID: 9207160                         ║
================================================================================
[17:22:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:22:06] ℹ️  Date: 03/27/2025
[17:22:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:22:07] [DOC: 9207160] ✅ Text extracted using pdfplumber (1087 chars)
[17:22:07] ✅    ✅ Text extracted using pdfplumber (1087 chars)
[17:22:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:22:10] ℹ️  AI extracted raw sex value: 'F'
[17:22:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:22:10] ℹ️  AI extracted payer source: ''
[17:22:10] ℹ️  AI extracted diagnoses:
[17:22:10] ℹ️    - Diagnosis 1: 'None'
[17:22:10] ℹ️    - Diagnosis 2: 'None'
[17:22:10] ℹ️    - Diagnosis 3: 'None'
[17:22:10] ℹ️    - Diagnosis 4: 'None'
[17:22:10] ℹ️    - Diagnosis 5: 'None'
[17:22:10] ℹ️    - Diagnosis 6: 'None'
[17:22:10] ℹ️  Final extracted MRN: '2467466'
[17:22:10] ℹ️  Final extracted Sex: 'FEMALE'
[17:22:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:22:10] ℹ️  Final extracted Payer Source: ''
[17:22:10] ✅ Patient data extraction completed successfully
[17:22:10] ✅    ✅ Patient data extracted successfully
[17:22:10] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:22:10] ✅    ✅ Patient identified: Maria Ferreira
[17:22:10] ✅    ✅ Patient name validation passed
[17:22:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:22:10] [DOC: 9207160] ℹ️  DOB normalized: 07/12/1938
[17:22:10] [DOC: 9207160] ✅ Patient date processing completed successfully
[17:22:10] ✅    ✅ Date processing completed
[17:22:10] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:22:10] 🔄 
🔄 Step 4: Extracting order data...
[17:22:12] ℹ️  Order extraction - MRN: '2467466'
[17:22:12] ℹ️  Order extraction - Sex: 'FEMALE'
[17:22:12] ℹ️  Order extraction - Service Line: ''
[17:22:12] ℹ️  Order extraction - Payer Source: ''
[17:22:12] ✅ Order data extraction completed successfully
[17:22:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:22:12] ℹ️  Using MRN from patient data: '2467466' over '2467466'
[17:22:12] ℹ️  Using service line from patient data: 'Skilled Nursing'
[17:22:12] ✅ Patient name cross-validation successful
[17:22:12] ✅    ✅ Data merged successfully
[17:22:13] ⚠️     ❌ Skipping - missing episode start date
[17:22:13] [DOC: 9207160] ℹ️  API push details saved for document 9207160
================================================================================
║                        Processing Document ID: 9207156                         ║
================================================================================
[17:22:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:22:13] ℹ️  Date: 03/27/2025
[17:22:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:22:17] [DOC: 9207156] ✅ Text extracted using pdfplumber (27864 chars)
[17:22:17] ✅    ✅ Text extracted using pdfplumber (27864 chars)
[17:22:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:22:21] ℹ️  AI extracted raw sex value: 'Female'
[17:22:21] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:22:21] ℹ️  AI extracted payer source: ''
[17:22:21] ℹ️  AI extracted diagnoses:
[17:22:21] ℹ️    - Diagnosis 1: 'U07.1'
[17:22:21] ℹ️    - Diagnosis 2: 'J10.1'
[17:22:21] ℹ️    - Diagnosis 3: 'J44.1'
[17:22:21] ℹ️    - Diagnosis 4: 'A41.52'
[17:22:21] ℹ️    - Diagnosis 5: 'R65.21'
[17:22:21] ℹ️    - Diagnosis 6: 'J96.01'
[17:22:21] ℹ️  Final extracted MRN: '2455123'
[17:22:21] ℹ️  Final extracted Sex: 'FEMALE'
[17:22:21] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:22:21] ℹ️  Final extracted Payer Source: ''
[17:22:21] ✅ Patient data extraction completed successfully
[17:22:21] ✅    ✅ Patient data extracted successfully
[17:22:21] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'A41.52', 'fifthDiagnosis': 'R65.21', 'sixthDiagnosis': 'J96.01'}]
[17:22:21] ✅    ✅ Patient identified: Donna Faria
[17:22:21] ✅    ✅ Patient name validation passed
[17:22:21] 🔄 
🔄 Step 3: Processing patient dates...
[17:22:21] [DOC: 9207156] ℹ️  DOB normalized: 04/27/1958
[17:22:21] [DOC: 9207156] ℹ️  Episode startOfCare normalized: 03/12/2025
[17:22:21] [DOC: 9207156] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[17:22:21] [DOC: 9207156] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[17:22:21] [DOC: 9207156] ✅ Patient date processing completed successfully
[17:22:21] ✅    ✅ Date processing completed
[17:22:21] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'A41.52', 'fifthDiagnosis': 'R65.21', 'sixthDiagnosis': 'J96.01'}]
[17:22:21] 🔄 
🔄 Step 4: Extracting order data...
[17:22:23] ℹ️  Order extraction - MRN: '2455123'
[17:22:23] ℹ️  Order extraction - Sex: 'FEMALE'
[17:22:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:22:23] ℹ️  Order extraction - Payer Source: ''
[17:22:23] ✅ Order data extraction completed successfully
[17:22:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:22:23] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[17:22:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:22:23] ✅ Patient name cross-validation successful
[17:22:23] ✅    ✅ Data merged successfully
[17:22:25] ✅    ✅ Order data extracted and validated
[17:22:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:22:25] [DOC: 9207156] ✅ Patient found in local cache: Donna Faria, ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[17:22:25] ✅    ✅ Existing patient found with ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[17:22:25] 🔄 
🔄 Step 6: Pushing order to API...
[17:22:25] [DOC: 9207156] ℹ️  Pushing order via API for patient ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[17:22:26] [DOC: 9207156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14142"}
[17:22:26] ❌    ❌ Failed to push order
[17:22:26] 🔄 
🔄 Step 7: Writing to CSV...
[17:22:26] [DOC: 9207156] ℹ️  Calculated age: 67 from DOB: 04/27/1958
[17:22:26] [DOC: 9207156] ℹ️  Service Line extracted: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:22:26] [DOC: 9207156] ℹ️  Payer Source extracted: ''
[17:22:26] [DOC: 9207156] ℹ️  Diagnosis codes being written:
[17:22:26] [DOC: 9207156] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[17:22:26] [DOC: 9207156] ℹ️    - Latest_Episode_Seconddiagnosis: 'J10.1'
[17:22:26] [DOC: 9207156] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[17:22:26] [DOC: 9207156] ℹ️    - Latest_Episode_Fourthdiagnosis: 'A41.52'
[17:22:26] [DOC: 9207156] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R65.21'
[17:22:26] [DOC: 9207156] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J96.01'
[17:22:26] [DOC: 9207156] ✅ Patient data written to CSV: Donna Faria | Sex: FEMALE | Age: 67 | Service: Skilled Nursing,Physical Therapy,Occupational Therapy | Payer:  | MRN: 2455123
[17:22:26] ✅    ✅ Document 9207156 processed and saved successfully
[17:22:26] 🔄 
🔄 Step 8: Saving API details...
[17:22:26] [DOC: 9207156] ℹ️  API push details saved for document 9207156
[17:22:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207122                         ║
================================================================================
[17:22:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:22:26] ℹ️  Date: 03/27/2025
[17:22:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:22:29] [DOC: 9207122] ✅ Text extracted using pdfplumber (17790 chars)
[17:22:29] ✅    ✅ Text extracted using pdfplumber (17790 chars)
[17:22:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:22:33] ℹ️  AI extracted raw sex value: 'F'
[17:22:33] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[17:22:33] ℹ️  AI extracted payer source: ''
[17:22:33] ℹ️  AI extracted diagnoses:
[17:22:33] ℹ️    - Diagnosis 1: 'G30.9'
[17:22:33] ℹ️    - Diagnosis 2: 'F02.811'
[17:22:33] ℹ️    - Diagnosis 3: 'F02.818'
[17:22:33] ℹ️    - Diagnosis 4: 'R29.6'
[17:22:33] ℹ️    - Diagnosis 5: 'I12.9'
[17:22:33] ℹ️    - Diagnosis 6: 'N18.31'
[17:22:33] ℹ️  Final extracted MRN: '2409497'
[17:22:33] ℹ️  Final extracted Sex: 'FEMALE'
[17:22:33] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[17:22:33] ℹ️  Final extracted Payer Source: ''
[17:22:33] ✅ Patient data extraction completed successfully
[17:22:33] ✅    ✅ Patient data extracted successfully
[17:22:33] 📊 Patient Response
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 127 Acushnet Rd
     └─ city: Mattapoisett
     └─ state: MA
     └─ zip: 02739-1217
     └─ email: 
     └─ phoneNumber: 508-758-3340
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.811', 'thirdDiagnosis': 'F02.818', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.31'}]
[17:22:33] ✅    ✅ Patient identified: Juliet Desnoyers
[17:22:33] ✅    ✅ Patient name validation passed
[17:22:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:22:33] [DOC: 9207122] ℹ️  DOB normalized: 11/13/1938
[17:22:33] [DOC: 9207122] ℹ️  Episode startOfCare normalized: 03/15/2025
[17:22:33] [DOC: 9207122] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[17:22:33] [DOC: 9207122] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[17:22:33] [DOC: 9207122] ✅ Patient date processing completed successfully
[17:22:33] ✅    ✅ Date processing completed
[17:22:33] 📊 Processed Patient Data
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 127 Acushnet Rd
     └─ city: Mattapoisett
     └─ state: MA
     └─ zip: 02739-1217
     └─ email: 
     └─ phoneNumber: 508-758-3340
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.811', 'thirdDiagnosis': 'F02.818', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.31'}]
[17:22:33] 🔄 
🔄 Step 4: Extracting order data...
[17:22:35] ℹ️  Order extraction - MRN: '2409497'
[17:22:35] ℹ️  Order extraction - Sex: 'FEMALE'
[17:22:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[17:22:35] ℹ️  Order extraction - Payer Source: ''
[17:22:35] ✅ Order data extraction completed successfully
[17:22:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:22:35] ℹ️  Using MRN from patient data: '2409497' over '2409497'
[17:22:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[17:22:35] ✅ Patient name cross-validation successful
[17:22:35] ✅    ✅ Data merged successfully
[17:22:37] ✅    ✅ Order data extracted and validated
[17:22:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:22:50] [DOC: 9207122] ℹ️  Patient not found in cache or API: Juliet Desnoyers
[17:22:50] [DOC: 9207122] ℹ️  Patient not found, creating new patient via API...
[17:22:50] [DOC: 9207122] ℹ️  Creating patient via API: Juliet Desnoyers
[17:22:51] [DOC: 9207122] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:22:51] ❌    ❌ Failed to create patient
[17:22:51] [DOC: 9207122] ℹ️  API push details saved for document 9207122
================================================================================
║                        Processing Document ID: 9207113                         ║
================================================================================
[17:22:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:22:51] ℹ️  Date: 03/27/2025
[17:22:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:22:53] [DOC: 9207113] ✅ Text extracted using pdfplumber (1161 chars)
[17:22:53] ✅    ✅ Text extracted using pdfplumber (1161 chars)
[17:22:53] 🔄 
🔄 Step 2: Extracting patient data...
[17:22:56] ℹ️  AI extracted raw sex value: 'F'
[17:22:56] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:22:56] ℹ️  AI extracted payer source: ''
[17:22:56] ℹ️  AI extracted diagnoses:
[17:22:56] ℹ️    - Diagnosis 1: ''
[17:22:56] ℹ️    - Diagnosis 2: ''
[17:22:56] ℹ️    - Diagnosis 3: ''
[17:22:56] ℹ️    - Diagnosis 4: ''
[17:22:56] ℹ️    - Diagnosis 5: ''
[17:22:56] ℹ️    - Diagnosis 6: ''
[17:22:56] ℹ️  Final extracted MRN: '2467466'
[17:22:56] ℹ️  Final extracted Sex: 'FEMALE'
[17:22:56] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:22:56] ℹ️  Final extracted Payer Source: ''
[17:22:56] ✅ Patient data extraction completed successfully
[17:22:56] ✅    ✅ Patient data extracted successfully
[17:22:56] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:22:56] ✅    ✅ Patient identified: Maria Ferreira
[17:22:56] ✅    ✅ Patient name validation passed
[17:22:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:22:56] [DOC: 9207113] ℹ️  DOB normalized: 07/12/1938
[17:22:56] [DOC: 9207113] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[17:22:56] [DOC: 9207113] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[17:22:56] [DOC: 9207113] ✅ Patient date processing completed successfully
[17:22:56] ✅    ✅ Date processing completed
[17:22:56] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 07/12/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467466
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:22:56] 🔄 
🔄 Step 4: Extracting order data...
[17:22:58] ℹ️  Order extraction - MRN: '2467466'
[17:22:58] ℹ️  Order extraction - Sex: 'FEMALE'
[17:22:58] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:22:58] ℹ️  Order extraction - Payer Source: ''
[17:22:58] ✅ Order data extraction completed successfully
[17:22:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:22:58] ℹ️  Using MRN from patient data: '2467466' over '2467466'
[17:22:58] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:22:58] ✅ Patient name cross-validation successful
[17:22:58] ✅    ✅ Data merged successfully
[17:22:59] ✅    ✅ Order data extracted and validated
[17:22:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:23:22] [DOC: 9207113] ℹ️  Patient not found in cache or API: Maria Ferreira
[17:23:22] [DOC: 9207113] ℹ️  Patient not found, creating new patient via API...
[17:23:22] [DOC: 9207113] ℹ️  Creating patient via API: Maria Ferreira
[17:23:24] [DOC: 9207113] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:23:24] ❌    ❌ Failed to create patient
[17:23:24] [DOC: 9207113] ℹ️  API push details saved for document 9207113
================================================================================
║                        Processing Document ID: 9207110                         ║
================================================================================
[17:23:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:23:24] ℹ️  Date: 03/27/2025
[17:23:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:23:29] [DOC: 9207110] ✅ Text extracted using pdfplumber (21512 chars)
[17:23:29] ✅    ✅ Text extracted using pdfplumber (21512 chars)
[17:23:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:23:32] ℹ️  AI extracted raw sex value: 'F'
[17:23:32] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[17:23:32] ℹ️  AI extracted payer source: ''
[17:23:32] ℹ️  AI extracted diagnoses:
[17:23:32] ℹ️    - Diagnosis 1: 'M62.82'
[17:23:32] ℹ️    - Diagnosis 2: 'N17.9'
[17:23:32] ℹ️    - Diagnosis 3: 'I10'
[17:23:32] ℹ️    - Diagnosis 4: 'E11.9'
[17:23:32] ℹ️    - Diagnosis 5: 'D50.9'
[17:23:32] ℹ️    - Diagnosis 6: 'E78.5'
[17:23:32] ℹ️  Final extracted MRN: '2372130'
[17:23:32] ℹ️  Final extracted Sex: 'FEMALE'
[17:23:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[17:23:32] ℹ️  Final extracted Payer Source: ''
[17:23:32] ✅ Patient data extraction completed successfully
[17:23:32] ✅    ✅ Patient data extracted successfully
[17:23:32] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: Crowell
     └─ dob: 07/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2372130
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'M62.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'E78.5'}]
[17:23:32] ✅    ✅ Patient identified: Kathryn Crowell
[17:23:32] ✅    ✅ Patient name validation passed
[17:23:32] 🔄 
🔄 Step 3: Processing patient dates...
[17:23:32] [DOC: 9207110] ℹ️  DOB normalized: 07/27/1941
[17:23:32] [DOC: 9207110] ℹ️  Episode startOfCare normalized: 03/14/2025
[17:23:32] [DOC: 9207110] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[17:23:32] [DOC: 9207110] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[17:23:32] [DOC: 9207110] ✅ Patient date processing completed successfully
[17:23:32] ✅    ✅ Date processing completed
[17:23:32] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: Crowell
     └─ dob: 07/27/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2372130
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'M62.82', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'E78.5'}]
[17:23:32] 🔄 
🔄 Step 4: Extracting order data...
[17:23:35] ℹ️  Order extraction - MRN: '2372130'
[17:23:35] ℹ️  Order extraction - Sex: 'FEMALE'
[17:23:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:23:35] ℹ️  Order extraction - Payer Source: ''
[17:23:35] ✅ Order data extraction completed successfully
[17:23:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:23:35] ℹ️  Using MRN from patient data: '2372130' over '2372130'
[17:23:35] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy, Physical Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[17:23:35] ✅ Patient name cross-validation successful
[17:23:35] ✅    ✅ Data merged successfully
[17:23:36] ✅    ✅ Order data extracted and validated
[17:23:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:23:42] [DOC: 9207110] ✅ Patient exists in API: Kathryn Crowell, ID: fe874f54-af3c-4635-b78e-c3cfb9a73117
[17:23:42] ✅    ✅ Existing patient found with ID: fe874f54-af3c-4635-b78e-c3cfb9a73117
[17:23:42] 🔄 
🔄 Step 6: Pushing order to API...
[17:23:42] [DOC: 9207110] ℹ️  Pushing order via API for patient ID: fe874f54-af3c-4635-b78e-c3cfb9a73117
[17:23:43] [DOC: 9207110] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14134"}
[17:23:43] ❌    ❌ Failed to push order
[17:23:43] 🔄 
🔄 Step 7: Writing to CSV...
[17:23:43] [DOC: 9207110] ℹ️  Calculated age: 83 from DOB: 07/27/1941
[17:23:43] [DOC: 9207110] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[17:23:43] [DOC: 9207110] ℹ️  Payer Source extracted: ''
[17:23:43] [DOC: 9207110] ℹ️  Diagnosis codes being written:
[17:23:43] [DOC: 9207110] ℹ️    - Latest_Episode_Firstdiagnosis: 'M62.82'
[17:23:43] [DOC: 9207110] ℹ️    - Latest_Episode_Seconddiagnosis: 'N17.9'
[17:23:43] [DOC: 9207110] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[17:23:43] [DOC: 9207110] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[17:23:43] [DOC: 9207110] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D50.9'
[17:23:43] [DOC: 9207110] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[17:23:43] [DOC: 9207110] ✅ Patient data written to CSV: Kathryn Crowell | Sex: FEMALE | Age: 83 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2372130
[17:23:43] ✅    ✅ Document 9207110 processed and saved successfully
[17:23:43] 🔄 
🔄 Step 8: Saving API details...
[17:23:43] [DOC: 9207110] ℹ️  API push details saved for document 9207110
[17:23:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207101                         ║
================================================================================
[17:23:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:23:43] ℹ️  Date: 03/27/2025
[17:23:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:23:44] [DOC: 9207101] ✅ Text extracted using pdfplumber (1616 chars)
[17:23:44] ✅    ✅ Text extracted using pdfplumber (1616 chars)
[17:23:44] 🔄 
🔄 Step 2: Extracting patient data...
[17:23:46] ℹ️  AI extracted raw sex value: 'F'
[17:23:46] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:23:46] ℹ️  AI extracted payer source: ''
[17:23:46] ℹ️  AI extracted diagnoses:
[17:23:46] ℹ️    - Diagnosis 1: ''
[17:23:46] ℹ️    - Diagnosis 2: ''
[17:23:46] ℹ️    - Diagnosis 3: ''
[17:23:46] ℹ️    - Diagnosis 4: ''
[17:23:46] ℹ️    - Diagnosis 5: ''
[17:23:46] ℹ️    - Diagnosis 6: ''
[17:23:46] ℹ️  Final extracted MRN: '2461998'
[17:23:46] ℹ️  Final extracted Sex: 'FEMALE'
[17:23:46] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:23:46] ℹ️  Final extracted Payer Source: ''
[17:23:46] ✅ Patient data extraction completed successfully
[17:23:46] ✅    ✅ Patient data extracted successfully
[17:23:46] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:23:46] ✅    ✅ Patient identified: Dolores Fernandes
[17:23:46] ✅    ✅ Patient name validation passed
[17:23:46] 🔄 
🔄 Step 3: Processing patient dates...
[17:23:46] [DOC: 9207101] ℹ️  DOB normalized: 08/26/1931
[17:23:46] [DOC: 9207101] ✅ Patient date processing completed successfully
[17:23:46] ✅    ✅ Date processing completed
[17:23:46] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:23:46] 🔄 
🔄 Step 4: Extracting order data...
[17:23:49] ℹ️  Order extraction - MRN: '2461998'
[17:23:49] ℹ️  Order extraction - Sex: 'FEMALE'
[17:23:49] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:23:49] ℹ️  Order extraction - Payer Source: ''
[17:23:49] ✅ Order data extraction completed successfully
[17:23:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:23:49] ℹ️  Using MRN from patient data: '2461998' over '2461998'
[17:23:49] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:23:49] ✅ Patient name cross-validation successful
[17:23:49] ✅    ✅ Data merged successfully
[17:23:50] ✅    ✅ Order data extracted and validated
[17:23:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:23:50] [DOC: 9207101] ✅ Patient found in local cache: Dolores Fernandes, ID: fcab244b-32d7-404c-9e73-965d056a5073
[17:23:50] ✅    ✅ Existing patient found with ID: fcab244b-32d7-404c-9e73-965d056a5073
[17:23:50] 🔄 
🔄 Step 6: Pushing order to API...
[17:23:50] [DOC: 9207101] ℹ️  Pushing order via API for patient ID: fcab244b-32d7-404c-9e73-965d056a5073
[17:23:51] [DOC: 9207101] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14140"}
[17:23:51] ❌    ❌ Failed to push order
[17:23:51] 🔄 
🔄 Step 7: Writing to CSV...
[17:23:51] [DOC: 9207101] ℹ️  Calculated age: 93 from DOB: 08/26/1931
[17:23:51] [DOC: 9207101] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:23:51] [DOC: 9207101] ℹ️  Payer Source extracted: ''
[17:23:51] [DOC: 9207101] ℹ️  Diagnosis codes being written:
[17:23:51] [DOC: 9207101] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:23:51] [DOC: 9207101] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:23:51] [DOC: 9207101] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:23:51] [DOC: 9207101] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:23:51] [DOC: 9207101] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:23:51] [DOC: 9207101] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:23:51] [DOC: 9207101] ✅ Patient data written to CSV: Dolores Fernandes | Sex: FEMALE | Age: 93 | Service: Occupational Therapy | Payer:  | MRN: 2461998
[17:23:51] ✅    ✅ Document 9207101 processed and saved successfully
[17:23:51] 🔄 
🔄 Step 8: Saving API details...
[17:23:51] [DOC: 9207101] ℹ️  API push details saved for document 9207101
[17:23:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9207054                         ║
================================================================================
[17:23:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:23:51] ℹ️  Date: 03/27/2025
[17:23:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:23:53] [DOC: 9207054] ✅ Text extracted using pdfplumber (1001 chars)
[17:23:53] ✅    ✅ Text extracted using pdfplumber (1001 chars)
[17:23:53] 🔄 
🔄 Step 2: Extracting patient data...
[17:23:56] ℹ️  AI extracted raw sex value: 'F'
[17:23:56] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:23:56] ℹ️  AI extracted payer source: ''
[17:23:56] ℹ️  AI extracted diagnoses:
[17:23:56] ℹ️    - Diagnosis 1: ''
[17:23:56] ℹ️    - Diagnosis 2: ''
[17:23:56] ℹ️    - Diagnosis 3: ''
[17:23:56] ℹ️    - Diagnosis 4: ''
[17:23:56] ℹ️    - Diagnosis 5: ''
[17:23:56] ℹ️    - Diagnosis 6: ''
[17:23:56] ℹ️  Final extracted MRN: '2450273'
[17:23:56] ℹ️  Final extracted Sex: 'FEMALE'
[17:23:56] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:23:56] ℹ️  Final extracted Payer Source: ''
[17:23:56] ✅ Patient data extraction completed successfully
[17:23:56] ✅    ✅ Patient data extracted successfully
[17:23:56] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:23:56] ✅    ✅ Patient identified: Maria Estacio
[17:23:56] ✅    ✅ Patient name validation passed
[17:23:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:23:56] [DOC: 9207054] ℹ️  DOB normalized: 12/14/1935
[17:23:56] [DOC: 9207054] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:23:56] [DOC: 9207054] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[17:23:56] [DOC: 9207054] ✅ Patient date processing completed successfully
[17:23:56] ✅    ✅ Date processing completed
[17:23:56] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:23:56] 🔄 
🔄 Step 4: Extracting order data...
[17:23:58] ℹ️  Order extraction - MRN: '2450273'
[17:23:58] ℹ️  Order extraction - Sex: 'FEMALE'
[17:23:58] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:23:58] ℹ️  Order extraction - Payer Source: ''
[17:23:58] ✅ Order data extraction completed successfully
[17:23:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:23:58] ℹ️  Using MRN from patient data: '2450273' over '2450273'
[17:23:58] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:23:58] ✅ Patient name cross-validation successful
[17:23:58] ✅    ✅ Data merged successfully
[17:23:59] ✅    ✅ Order data extracted and validated
[17:23:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:24:07] [DOC: 9207054] ℹ️  Patient not found in cache or API: Maria Estacio
[17:24:07] [DOC: 9207054] ℹ️  Patient not found, creating new patient via API...
[17:24:07] [DOC: 9207054] ℹ️  Creating patient via API: Maria Estacio
[17:24:08] [DOC: 9207054] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:24:08] ❌    ❌ Failed to create patient
[17:24:08] [DOC: 9207054] ℹ️  API push details saved for document 9207054
================================================================================
║                        Processing Document ID: 9207047                         ║
================================================================================
[17:24:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:24:08] ℹ️  Date: 03/27/2025
[17:24:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:24:09] [DOC: 9207047] ✅ Text extracted using pdfplumber (1999 chars)
[17:24:09] ✅    ✅ Text extracted using pdfplumber (1999 chars)
[17:24:09] 🔄 
🔄 Step 2: Extracting patient data...
[17:24:12] ℹ️  AI extracted raw sex value: 'F'
[17:24:12] ℹ️  AI extracted service line: 'Physical Therapy,Occupational Therapy,Home Health Aide'
[17:24:12] ℹ️  AI extracted payer source: ''
[17:24:12] ℹ️  AI extracted diagnoses:
[17:24:12] ℹ️    - Diagnosis 1: 'None'
[17:24:12] ℹ️    - Diagnosis 2: 'None'
[17:24:12] ℹ️    - Diagnosis 3: 'None'
[17:24:12] ℹ️    - Diagnosis 4: 'None'
[17:24:12] ℹ️    - Diagnosis 5: 'None'
[17:24:12] ℹ️    - Diagnosis 6: 'None'
[17:24:12] ℹ️  Final extracted MRN: '2420800'
[17:24:12] ℹ️  Final extracted Sex: 'FEMALE'
[17:24:12] ℹ️  Final extracted Service Line: 'Physical Therapy,Occupational Therapy,Home Health Aide'
[17:24:12] ℹ️  Final extracted Payer Source: ''
[17:24:12] ✅ Patient data extraction completed successfully
[17:24:12] ✅    ✅ Patient data extracted successfully
[17:24:12] 📊 Patient Response
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy,Occupational Therapy,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:24:12] ✅    ✅ Patient identified: Sally Dobson
[17:24:12] ✅    ✅ Patient name validation passed
[17:24:12] 🔄 
🔄 Step 3: Processing patient dates...
[17:24:12] [DOC: 9207047] ℹ️  DOB normalized: 09/19/1941
[17:24:12] [DOC: 9207047] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[17:24:12] [DOC: 9207047] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[17:24:12] [DOC: 9207047] ✅ Patient date processing completed successfully
[17:24:12] ✅    ✅ Date processing completed
[17:24:12] 📊 Processed Patient Data
     └─ patientFName: Sally
     └─ patientLName: Dobson
     └─ dob: 09/19/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2420800
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy,Occupational Therapy,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/03/2025'}]
[17:24:12] 🔄 
🔄 Step 4: Extracting order data...
[17:24:15] ℹ️  Order extraction - MRN: '2420800'
[17:24:15] ℹ️  Order extraction - Sex: 'FEMALE'
[17:24:15] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[17:24:15] ℹ️  Order extraction - Payer Source: ''
[17:24:15] ✅ Order data extraction completed successfully
[17:24:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:24:15] ℹ️  Using MRN from patient data: '2420800' over '2420800'
[17:24:15] ℹ️  Combined service lines: Patient='Physical Therapy,Occupational Therapy,Home Health Aide' + Order='Physical Therapy, Occupational Therapy, Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy'
[17:24:15] ✅ Patient name cross-validation successful
[17:24:15] ✅    ✅ Data merged successfully
[17:24:16] ✅    ✅ Order data extracted and validated
[17:24:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:24:22] [DOC: 9207047] ℹ️  Patient not found in cache or API: Sally Dobson
[17:24:22] [DOC: 9207047] ℹ️  Patient not found, creating new patient via API...
[17:24:22] [DOC: 9207047] ℹ️  Creating patient via API: Sally Dobson
[17:24:23] [DOC: 9207047] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:24:23] ❌    ❌ Failed to create patient
[17:24:23] [DOC: 9207047] ℹ️  API push details saved for document 9207047
================================================================================
║                        Processing Document ID: 9206837                         ║
================================================================================
[17:24:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:24:23] ℹ️  Date: 03/27/2025
[17:24:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:24:25] [DOC: 9206837] ✅ Text extracted using pdfplumber (1023 chars)
[17:24:25] ✅    ✅ Text extracted using pdfplumber (1023 chars)
[17:24:25] 🔄 
🔄 Step 2: Extracting patient data...
[17:24:27] ℹ️  AI extracted raw sex value: 'M'
[17:24:27] ℹ️  AI extracted service line: 'Physical Therapy'
[17:24:27] ℹ️  AI extracted payer source: ''
[17:24:27] ℹ️  AI extracted diagnoses:
[17:24:27] ℹ️    - Diagnosis 1: ''
[17:24:27] ℹ️    - Diagnosis 2: ''
[17:24:27] ℹ️    - Diagnosis 3: ''
[17:24:27] ℹ️    - Diagnosis 4: ''
[17:24:27] ℹ️    - Diagnosis 5: ''
[17:24:27] ℹ️    - Diagnosis 6: ''
[17:24:27] ℹ️  Final extracted MRN: '2312121'
[17:24:27] ℹ️  Final extracted Sex: 'MALE'
[17:24:27] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:24:27] ℹ️  Final extracted Payer Source: ''
[17:24:27] ✅ Patient data extraction completed successfully
[17:24:27] ✅    ✅ Patient data extracted successfully
[17:24:27] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:24:27] ✅    ✅ Patient identified: Antonio Carvalho
[17:24:27] ✅    ✅ Patient name validation passed
[17:24:27] 🔄 
🔄 Step 3: Processing patient dates...
[17:24:27] [DOC: 9206837] ℹ️  DOB normalized: 07/01/1933
[17:24:27] [DOC: 9206837] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[17:24:27] [DOC: 9206837] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[17:24:27] [DOC: 9206837] ✅ Patient date processing completed successfully
[17:24:27] ✅    ✅ Date processing completed
[17:24:27] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:24:27] 🔄 
🔄 Step 4: Extracting order data...
[17:24:30] ℹ️  Order extraction - MRN: '2312121'
[17:24:30] ℹ️  Order extraction - Sex: 'MALE'
[17:24:30] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:24:30] ℹ️  Order extraction - Payer Source: ''
[17:24:30] ✅ Order data extraction completed successfully
[17:24:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:24:30] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[17:24:30] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:24:30] ✅ Patient name cross-validation successful
[17:24:30] ✅    ✅ Data merged successfully
[17:24:31] ✅    ✅ Order data extracted and validated
[17:24:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:25:03] [DOC: 9206837] ℹ️  Patient not found in cache or API: Antonio Carvalho
[17:25:03] [DOC: 9206837] ℹ️  Patient not found, creating new patient via API...
[17:25:03] [DOC: 9206837] ℹ️  Creating patient via API: Antonio Carvalho
[17:25:04] [DOC: 9206837] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:25:04] ❌    ❌ Failed to create patient
[17:25:04] [DOC: 9206837] ℹ️  API push details saved for document 9206837
================================================================================
║                        Processing Document ID: 9206831                         ║
================================================================================
[17:25:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:25:04] ℹ️  Date: 03/27/2025
[17:25:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:25:06] [DOC: 9206831] ✅ Text extracted using pdfplumber (1073 chars)
[17:25:06] ✅    ✅ Text extracted using pdfplumber (1073 chars)
[17:25:06] 🔄 
🔄 Step 2: Extracting patient data...
[17:25:09] ℹ️  AI extracted raw sex value: 'F'
[17:25:09] ℹ️  AI extracted service line: 'Physical Therapy'
[17:25:09] ℹ️  AI extracted payer source: ''
[17:25:09] ℹ️  AI extracted diagnoses:
[17:25:09] ℹ️    - Diagnosis 1: ''
[17:25:09] ℹ️    - Diagnosis 2: ''
[17:25:09] ℹ️    - Diagnosis 3: ''
[17:25:09] ℹ️    - Diagnosis 4: ''
[17:25:09] ℹ️    - Diagnosis 5: ''
[17:25:09] ℹ️    - Diagnosis 6: ''
[17:25:09] ℹ️  Final extracted MRN: '2301138'
[17:25:09] ℹ️  Final extracted Sex: 'FEMALE'
[17:25:09] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:25:09] ℹ️  Final extracted Payer Source: ''
[17:25:09] ✅ Patient data extraction completed successfully
[17:25:09] ✅    ✅ Patient data extracted successfully
[17:25:09] 📊 Patient Response
     └─ patientFName: Regina
     └─ patientLName: Capela
     └─ dob: 11/24/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2301138
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:25:09] ✅    ✅ Patient identified: Regina Capela
[17:25:09] ✅    ✅ Patient name validation passed
[17:25:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:25:09] [DOC: 9206831] ℹ️  DOB normalized: 11/24/1943
[17:25:09] [DOC: 9206831] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[17:25:09] [DOC: 9206831] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[17:25:09] [DOC: 9206831] ✅ Patient date processing completed successfully
[17:25:09] ✅    ✅ Date processing completed
[17:25:09] 📊 Processed Patient Data
     └─ patientFName: Regina
     └─ patientLName: Capela
     └─ dob: 11/24/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2301138
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:25:09] 🔄 
🔄 Step 4: Extracting order data...
[17:25:11] ℹ️  Order extraction - MRN: '2301138'
[17:25:11] ℹ️  Order extraction - Sex: 'FEMALE'
[17:25:11] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:25:11] ℹ️  Order extraction - Payer Source: ''
[17:25:11] ✅ Order data extraction completed successfully
[17:25:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:25:11] ℹ️  Using MRN from patient data: '2301138' over '2301138'
[17:25:11] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:25:11] ✅ Patient name cross-validation successful
[17:25:11] ✅    ✅ Data merged successfully
[17:25:13] ✅    ✅ Order data extracted and validated
[17:25:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:25:26] [DOC: 9206831] ✅ Patient exists in API: Regina Capela, ID: 9d0c6767-1654-4303-a572-5cf37bae70bd
[17:25:26] ✅    ✅ Existing patient found with ID: 9d0c6767-1654-4303-a572-5cf37bae70bd
[17:25:26] 🔄 
🔄 Step 6: Pushing order to API...
[17:25:26] [DOC: 9206831] ℹ️  Pushing order via API for patient ID: 9d0c6767-1654-4303-a572-5cf37bae70bd
[17:25:27] [DOC: 9206831] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13439"}
[17:25:27] ❌    ❌ Failed to push order
[17:25:27] 🔄 
🔄 Step 7: Writing to CSV...
[17:25:27] [DOC: 9206831] ℹ️  Calculated age: 81 from DOB: 11/24/1943
[17:25:27] [DOC: 9206831] ℹ️  Service Line extracted: 'Physical Therapy'
[17:25:27] [DOC: 9206831] ℹ️  Payer Source extracted: ''
[17:25:27] [DOC: 9206831] ℹ️  Diagnosis codes being written:
[17:25:27] [DOC: 9206831] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:25:27] [DOC: 9206831] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:25:27] [DOC: 9206831] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:25:27] [DOC: 9206831] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:25:27] [DOC: 9206831] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:25:27] [DOC: 9206831] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:25:27] [DOC: 9206831] ✅ Patient data written to CSV: Regina Capela | Sex: FEMALE | Age: 81 | Service: Physical Therapy | Payer:  | MRN: 2301138
[17:25:27] ✅    ✅ Document 9206831 processed and saved successfully
[17:25:27] 🔄 
🔄 Step 8: Saving API details...
[17:25:27] [DOC: 9206831] ℹ️  API push details saved for document 9206831
[17:25:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206821                         ║
================================================================================
[17:25:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:25:27] ℹ️  Date: 03/27/2025
[17:25:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:25:29] [DOC: 9206821] ✅ Text extracted using pdfplumber (984 chars)
[17:25:29] ✅    ✅ Text extracted using pdfplumber (984 chars)
[17:25:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:25:31] ℹ️  AI extracted raw sex value: 'F'
[17:25:31] ℹ️  AI extracted service line: 'Physical Therapy'
[17:25:31] ℹ️  AI extracted payer source: ''
[17:25:31] ℹ️  AI extracted diagnoses:
[17:25:31] ℹ️    - Diagnosis 1: 'None'
[17:25:31] ℹ️    - Diagnosis 2: 'None'
[17:25:31] ℹ️    - Diagnosis 3: 'None'
[17:25:31] ℹ️    - Diagnosis 4: 'None'
[17:25:31] ℹ️    - Diagnosis 5: 'None'
[17:25:31] ℹ️    - Diagnosis 6: 'None'
[17:25:31] ℹ️  Final extracted MRN: '3471157'
[17:25:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:25:31] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:25:31] ℹ️  Final extracted Payer Source: ''
[17:25:31] ✅ Patient data extraction completed successfully
[17:25:31] ✅    ✅ Patient data extracted successfully
[17:25:31] 📊 Patient Response
     └─ patientFName: Claudia
     └─ patientLName: Boujnane
     └─ dob: 01/22/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3471157
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:25:31] ✅    ✅ Patient identified: Claudia Boujnane
[17:25:31] ✅    ✅ Patient name validation passed
[17:25:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:25:31] [DOC: 9206821] ℹ️  DOB normalized: 01/22/1966
[17:25:31] [DOC: 9206821] ✅ Patient date processing completed successfully
[17:25:31] ✅    ✅ Date processing completed
[17:25:31] 📊 Processed Patient Data
     └─ patientFName: Claudia
     └─ patientLName: Boujnane
     └─ dob: 01/22/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3471157
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:25:31] 🔄 
🔄 Step 4: Extracting order data...
[17:25:34] ℹ️  Order extraction - MRN: '3471157'
[17:25:34] ℹ️  Order extraction - Sex: 'FEMALE'
[17:25:34] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:25:34] ℹ️  Order extraction - Payer Source: ''
[17:25:34] ✅ Order data extraction completed successfully
[17:25:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:25:34] ℹ️  Using MRN from patient data: '3471157' over '3471157'
[17:25:34] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:25:34] ✅ Patient name cross-validation successful
[17:25:34] ✅    ✅ Data merged successfully
[17:25:35] ✅    ✅ Order data extracted and validated
[17:25:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:25:35] [DOC: 9206821] ✅ Patient found in local cache: Claudia Boujnane, ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[17:25:35] ✅    ✅ Existing patient found with ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[17:25:35] 🔄 
🔄 Step 6: Pushing order to API...
[17:25:35] [DOC: 9206821] ℹ️  Pushing order via API for patient ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[17:25:36] [DOC: 9206821] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13318"}
[17:25:36] ❌    ❌ Failed to push order
[17:25:36] 🔄 
🔄 Step 7: Writing to CSV...
[17:25:36] [DOC: 9206821] ℹ️  Calculated age: 59 from DOB: 01/22/1966
[17:25:36] [DOC: 9206821] ℹ️  Service Line extracted: 'Physical Therapy'
[17:25:36] [DOC: 9206821] ℹ️  Payer Source extracted: ''
[17:25:36] [DOC: 9206821] ℹ️  Diagnosis codes being written:
[17:25:36] [DOC: 9206821] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:25:36] [DOC: 9206821] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:25:36] [DOC: 9206821] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:25:36] [DOC: 9206821] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:25:36] [DOC: 9206821] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:25:36] [DOC: 9206821] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:25:36] [DOC: 9206821] ✅ Patient data written to CSV: Claudia Boujnane | Sex: FEMALE | Age: 59 | Service: Physical Therapy | Payer:  | MRN: 3471157
[17:25:36] ✅    ✅ Document 9206821 processed and saved successfully
[17:25:36] 🔄 
🔄 Step 8: Saving API details...
[17:25:36] [DOC: 9206821] ℹ️  API push details saved for document 9206821
[17:25:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206745                         ║
================================================================================
[17:25:36] ℹ️  Agency: Alphacare Home Health Agency
[17:25:36] ℹ️  Date: 03/27/2025
[17:25:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:25:41] [DOC: 9206745] ✅ Text extracted using pdfplumber (1422 chars)
[17:25:41] ✅    ✅ Text extracted using pdfplumber (1422 chars)
[17:25:41] 🔄 
🔄 Step 2: Extracting patient data...
[17:25:44] ℹ️  AI extracted raw sex value: ''
[17:25:44] ℹ️  AI extracted service line: 'RN'
[17:25:44] ℹ️  AI extracted payer source: ''
[17:25:44] ℹ️  AI extracted diagnoses:
[17:25:44] ℹ️    - Diagnosis 1: ''
[17:25:44] ℹ️    - Diagnosis 2: ''
[17:25:44] ℹ️    - Diagnosis 3: ''
[17:25:44] ℹ️    - Diagnosis 4: ''
[17:25:44] ℹ️    - Diagnosis 5: ''
[17:25:44] ℹ️    - Diagnosis 6: ''
[17:25:44] ℹ️  Final extracted MRN: '000000015'
[17:25:44] ℹ️  Final extracted Sex: ''
[17:25:44] ℹ️  Final extracted Service Line: 'RN'
[17:25:44] ℹ️  Final extracted Payer Source: ''
[17:25:44] ✅ Patient data extraction completed successfully
[17:25:44] ✅    ✅ Patient data extracted successfully
[17:25:44] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: OBrien
     └─ dob: 04/01/1950
     └─ patientSex: 
     └─ medicalRecordNo: 000000015
     └─ billingProvider: Gularek, Jordan (MD (Dr. Alliance))
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:25:44] ✅    ✅ Patient identified: Dennis OBrien
[17:25:44] ✅    ✅ Patient name validation passed
[17:25:44] 🔄 
🔄 Step 3: Processing patient dates...
[17:25:44] [DOC: 9206745] ℹ️  DOB normalized: 04/01/1950
[17:25:44] [DOC: 9206745] ✅ Patient date processing completed successfully
[17:25:44] ✅    ✅ Date processing completed
[17:25:44] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: OBrien
     └─ dob: 04/01/1950
     └─ patientSex: 
     └─ medicalRecordNo: 000000015
     └─ billingProvider: Gularek, Jordan (MD (Dr. Alliance))
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:25:44] 🔄 
🔄 Step 4: Extracting order data...
[17:25:46] ℹ️  Order extraction - MRN: '000000015'
[17:25:46] ℹ️  Order extraction - Sex: ''
[17:25:46] ℹ️  Order extraction - Service Line: 'HHA'
[17:25:46] ℹ️  Order extraction - Payer Source: ''
[17:25:46] ✅ Order data extraction completed successfully
[17:25:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:25:46] ℹ️  Using MRN from patient data: '000000015' over '000000015'
[17:25:46] ⚠️  Could not determine sex using any available method
[17:25:46] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[17:25:46] ✅ Patient name cross-validation successful
[17:25:46] ✅    ✅ Data merged successfully
[17:25:47] ⚠️     ❌ Skipping - missing episode start date
[17:25:47] [DOC: 9206745] ℹ️  API push details saved for document 9206745
================================================================================
║                        Processing Document ID: 9206712                         ║
================================================================================
[17:25:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:25:47] ℹ️  Date: 03/27/2025
[17:25:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:25:49] [DOC: 9206712] ✅ Text extracted using pdfplumber (1410 chars)
[17:25:49] ✅    ✅ Text extracted using pdfplumber (1410 chars)
[17:25:49] 🔄 
🔄 Step 2: Extracting patient data...
[17:25:51] ℹ️  AI extracted raw sex value: 'M'
[17:25:51] ℹ️  AI extracted service line: 'Physical Therapy'
[17:25:51] ℹ️  AI extracted payer source: ''
[17:25:51] ℹ️  AI extracted diagnoses:
[17:25:51] ℹ️    - Diagnosis 1: 'COPD'
[17:25:51] ℹ️    - Diagnosis 2: 'Flu'
[17:25:51] ℹ️    - Diagnosis 3: ''
[17:25:51] ℹ️    - Diagnosis 4: ''
[17:25:51] ℹ️    - Diagnosis 5: ''
[17:25:51] ℹ️    - Diagnosis 6: ''
[17:25:51] ℹ️  Final extracted MRN: '2005206'
[17:25:51] ℹ️  Final extracted Sex: 'MALE'
[17:25:51] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:25:51] ℹ️  Final extracted Payer Source: ''
[17:25:51] ✅ Patient data extraction completed successfully
[17:25:51] ✅    ✅ Patient data extracted successfully
[17:25:51] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'Flu', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:25:51] ✅    ✅ Patient identified: Jose Baptista
[17:25:51] ✅    ✅ Patient name validation passed
[17:25:51] 🔄 
🔄 Step 3: Processing patient dates...
[17:25:51] [DOC: 9206712] ℹ️  DOB normalized: 07/02/1934
[17:25:51] [DOC: 9206712] ✅ Patient date processing completed successfully
[17:25:51] ✅    ✅ Date processing completed
[17:25:51] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'COPD', 'secondDiagnosis': 'Flu', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:25:51] 🔄 
🔄 Step 4: Extracting order data...
[17:25:53] ℹ️  Order extraction - MRN: '2005206'
[17:25:53] ℹ️  Order extraction - Sex: 'MALE'
[17:25:53] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:25:53] ℹ️  Order extraction - Payer Source: ''
[17:25:53] ✅ Order data extraction completed successfully
[17:25:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:25:53] ℹ️  Using MRN from patient data: '2005206' over '2005206'
[17:25:53] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:25:53] ✅ Patient name cross-validation successful
[17:25:53] ✅    ✅ Data merged successfully
[17:25:54] ✅    ✅ Order data extracted and validated
[17:25:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:26:00] [DOC: 9206712] ℹ️  Patient not found in cache or API: Jose Baptista
[17:26:00] [DOC: 9206712] ℹ️  Patient not found, creating new patient via API...
[17:26:00] [DOC: 9206712] ℹ️  Creating patient via API: Jose Baptista
[17:26:02] [DOC: 9206712] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:26:02] ❌    ❌ Failed to create patient
[17:26:02] [DOC: 9206712] ℹ️  API push details saved for document 9206712
================================================================================
║                        Processing Document ID: 9206542                         ║
================================================================================
[17:26:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:26:02] ℹ️  Date: 03/27/2025
[17:26:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:26:04] [DOC: 9206542] ✅ Text extracted using pdfplumber (11375 chars)
[17:26:04] ✅    ✅ Text extracted using pdfplumber (11375 chars)
[17:26:04] 🔄 
🔄 Step 2: Extracting patient data...
[17:26:08] ℹ️  AI extracted raw sex value: 'M'
[17:26:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:26:08] ℹ️  AI extracted payer source: 'Medicare'
[17:26:08] ℹ️  AI extracted diagnoses:
[17:26:08] ℹ️    - Diagnosis 1: 'F03.90'
[17:26:08] ℹ️    - Diagnosis 2: 'E11.65'
[17:26:08] ℹ️    - Diagnosis 3: 'I10'
[17:26:08] ℹ️    - Diagnosis 4: 'I48.0'
[17:26:08] ℹ️    - Diagnosis 5: 'R63.4'
[17:26:08] ℹ️    - Diagnosis 6: 'Z68.26'
[17:26:08] ℹ️  Final extracted MRN: 'MA230712124102'
[17:26:08] ℹ️  Final extracted Sex: 'MALE'
[17:26:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:26:08] ℹ️  Final extracted Payer Source: 'Medicare'
[17:26:08] ✅ Patient data extraction completed successfully
[17:26:08] ✅    ✅ Patient data extracted successfully
[17:26:08] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[17:26:08] ✅    ✅ Patient identified: Hiram Cordero
[17:26:08] ✅    ✅ Patient name validation passed
[17:26:08] 🔄 
🔄 Step 3: Processing patient dates...
[17:26:08] [DOC: 9206542] ℹ️  DOB normalized: 12/08/1941
[17:26:08] [DOC: 9206542] ℹ️  Episode startOfCare normalized: 03/21/2024
[17:26:08] [DOC: 9206542] ℹ️  Episode startOfEpisode normalized: 11/16/2024
[17:26:08] [DOC: 9206542] ℹ️  Episode endOfEpisode normalized: 01/14/2025
[17:26:08] [DOC: 9206542] ✅ Patient date processing completed successfully
[17:26:08] ✅    ✅ Date processing completed
[17:26:08] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[17:26:08] 🔄 
🔄 Step 4: Extracting order data...
[17:26:10] ℹ️  Order extraction - MRN: 'MA230712124102'
[17:26:10] ℹ️  Order extraction - Sex: 'MALE'
[17:26:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:26:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:26:10] ✅ Order data extraction completed successfully
[17:26:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:26:10] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[17:26:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:26:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:26:10] ✅ Patient name cross-validation successful
[17:26:10] ✅    ✅ Data merged successfully
[17:26:11] ✅    ✅ Order data extracted and validated
[17:26:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:26:11] [DOC: 9206542] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:26:11] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:26:11] 🔄 
🔄 Step 6: Pushing order to API...
[17:26:11] [DOC: 9206542] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:26:13] [DOC: 9206542] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13646"}
[17:26:13] ❌    ❌ Failed to push order
[17:26:13] 🔄 
🔄 Step 7: Writing to CSV...
[17:26:13] [DOC: 9206542] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[17:26:13] [DOC: 9206542] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:26:13] [DOC: 9206542] ℹ️  Payer Source extracted: 'Medicare'
[17:26:13] [DOC: 9206542] ℹ️  Diagnosis codes being written:
[17:26:13] [DOC: 9206542] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[17:26:13] [DOC: 9206542] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[17:26:13] [DOC: 9206542] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[17:26:13] [DOC: 9206542] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[17:26:13] [DOC: 9206542] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[17:26:13] [DOC: 9206542] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.26'
[17:26:13] [DOC: 9206542] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230712124102
[17:26:13] ✅    ✅ Document 9206542 processed and saved successfully
[17:26:13] 🔄 
🔄 Step 8: Saving API details...
[17:26:13] [DOC: 9206542] ℹ️  API push details saved for document 9206542
[17:26:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206530                         ║
================================================================================
[17:26:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:26:13] ℹ️  Date: 03/27/2025
[17:26:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:26:16] [DOC: 9206530] ✅ Text extracted using pdfplumber (9326 chars)
[17:26:16] ✅    ✅ Text extracted using pdfplumber (9326 chars)
[17:26:16] 🔄 
🔄 Step 2: Extracting patient data...
[17:26:19] ℹ️  AI extracted raw sex value: 'F'
[17:26:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:26:19] ℹ️  AI extracted payer source: 'Medicare'
[17:26:19] ℹ️  AI extracted diagnoses:
[17:26:19] ℹ️    - Diagnosis 1: 'Z48.00'
[17:26:19] ℹ️    - Diagnosis 2: 'E11.51'
[17:26:19] ℹ️    - Diagnosis 3: 'I87.2'
[17:26:19] ℹ️    - Diagnosis 4: 'E66.01'
[17:26:19] ℹ️    - Diagnosis 5: 'F25.0'
[17:26:19] ℹ️    - Diagnosis 6: 'I11.0'
[17:26:19] ℹ️  Final extracted MRN: 'MA240708056102'
[17:26:19] ℹ️  Final extracted Sex: 'FEMALE'
[17:26:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:26:19] ℹ️  Final extracted Payer Source: 'Medicare'
[17:26:19] ✅ Patient data extraction completed successfully
[17:26:19] ✅    ✅ Patient data extracted successfully
[17:26:19] 📊 Patient Response
     └─ patientFName: Susan
     └─ patientLName: Turner
     └─ dob: 05/07/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240708056102
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1083657019
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/10/2024', 'startOfEpisode': '07/10/2024', 'endOfEpisode': '09/07/2024', 'firstDiagnosis': 'Z48.00', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I87.2', 'fourthDiagnosis': 'E66.01', 'fifthDiagnosis': 'F25.0', 'sixthDiagnosis': 'I11.0'}]
[17:26:19] ✅    ✅ Patient identified: Susan Turner
[17:26:19] ✅    ✅ Patient name validation passed
[17:26:19] 🔄 
🔄 Step 3: Processing patient dates...
[17:26:19] [DOC: 9206530] ℹ️  DOB normalized: 05/07/1961
[17:26:19] [DOC: 9206530] ℹ️  Episode startOfCare normalized: 07/10/2024
[17:26:19] [DOC: 9206530] ℹ️  Episode startOfEpisode normalized: 07/10/2024
[17:26:19] [DOC: 9206530] ℹ️  Episode endOfEpisode normalized: 09/07/2024
[17:26:19] [DOC: 9206530] ✅ Patient date processing completed successfully
[17:26:19] ✅    ✅ Date processing completed
[17:26:19] 📊 Processed Patient Data
     └─ patientFName: Susan
     └─ patientLName: Turner
     └─ dob: 05/07/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240708056102
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1083657019
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/10/2024', 'startOfEpisode': '07/10/2024', 'endOfEpisode': '09/07/2024', 'firstDiagnosis': 'Z48.00', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I87.2', 'fourthDiagnosis': 'E66.01', 'fifthDiagnosis': 'F25.0', 'sixthDiagnosis': 'I11.0'}]
[17:26:19] 🔄 
🔄 Step 4: Extracting order data...
[17:26:22] ℹ️  Order extraction - MRN: 'MA240708056102'
[17:26:22] ℹ️  Order extraction - Sex: 'FEMALE'
[17:26:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:26:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:26:22] ✅ Order data extraction completed successfully
[17:26:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:26:22] ℹ️  Using MRN from patient data: 'MA240708056102' over 'MA240708056102'
[17:26:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:26:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:26:22] ✅ Patient name cross-validation successful
[17:26:22] ✅    ✅ Data merged successfully
[17:26:23] ✅    ✅ Order data extracted and validated
[17:26:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:26:42] [DOC: 9206530] ✅ Patient exists in API: Susan Turner, ID: de2a3148-5757-4c6b-ba15-69b9525b2212
[17:26:42] ✅    ✅ Existing patient found with ID: de2a3148-5757-4c6b-ba15-69b9525b2212
[17:26:42] 🔄 
🔄 Step 6: Pushing order to API...
[17:26:42] [DOC: 9206530] ℹ️  Pushing order via API for patient ID: de2a3148-5757-4c6b-ba15-69b9525b2212
[17:26:44] [DOC: 9206530] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14363"}
[17:26:44] ❌    ❌ Failed to push order
[17:26:44] 🔄 
🔄 Step 7: Writing to CSV...
[17:26:44] [DOC: 9206530] ℹ️  Calculated age: 64 from DOB: 05/07/1961
[17:26:44] [DOC: 9206530] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:26:44] [DOC: 9206530] ℹ️  Payer Source extracted: 'Medicare'
[17:26:44] [DOC: 9206530] ℹ️  Diagnosis codes being written:
[17:26:44] [DOC: 9206530] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.00'
[17:26:44] [DOC: 9206530] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.51'
[17:26:44] [DOC: 9206530] ℹ️    - Latest_Episode_Thirddiagnosis: 'I87.2'
[17:26:44] [DOC: 9206530] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.01'
[17:26:44] [DOC: 9206530] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F25.0'
[17:26:44] [DOC: 9206530] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[17:26:44] [DOC: 9206530] ✅ Patient data written to CSV: Susan Turner | Sex: FEMALE | Age: 64 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240708056102
[17:26:44] ✅    ✅ Document 9206530 processed and saved successfully
[17:26:44] 🔄 
🔄 Step 8: Saving API details...
[17:26:44] [DOC: 9206530] ℹ️  API push details saved for document 9206530
[17:26:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206517                         ║
================================================================================
[17:26:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:26:44] ℹ️  Date: 03/27/2025
[17:26:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:26:46] [DOC: 9206517] ✅ Text extracted using pdfplumber (10152 chars)
[17:26:46] ✅    ✅ Text extracted using pdfplumber (10152 chars)
[17:26:46] 🔄 
🔄 Step 2: Extracting patient data...
[17:26:50] ℹ️  AI extracted raw sex value: 'M'
[17:26:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:26:50] ℹ️  AI extracted payer source: 'Medicare'
[17:26:50] ℹ️  AI extracted diagnoses:
[17:26:50] ℹ️    - Diagnosis 1: 'F03.90'
[17:26:50] ℹ️    - Diagnosis 2: 'E11.65'
[17:26:50] ℹ️    - Diagnosis 3: 'I10'
[17:26:50] ℹ️    - Diagnosis 4: 'I48.0'
[17:26:50] ℹ️    - Diagnosis 5: 'R63.4'
[17:26:50] ℹ️    - Diagnosis 6: 'Z68.26'
[17:26:50] ℹ️  Final extracted MRN: 'MA230712124102'
[17:26:50] ℹ️  Final extracted Sex: 'MALE'
[17:26:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:26:50] ℹ️  Final extracted Payer Source: 'Medicare'
[17:26:50] ✅ Patient data extraction completed successfully
[17:26:50] ✅    ✅ Patient data extracted successfully
[17:26:50] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[17:26:50] ✅    ✅ Patient identified: Hiram Cordero
[17:26:50] ✅    ✅ Patient name validation passed
[17:26:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:26:50] [DOC: 9206517] ℹ️  DOB normalized: 12/08/1941
[17:26:50] [DOC: 9206517] ℹ️  Episode startOfCare normalized: 03/21/2024
[17:26:50] [DOC: 9206517] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[17:26:50] [DOC: 9206517] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[17:26:50] [DOC: 9206517] ✅ Patient date processing completed successfully
[17:26:50] ✅    ✅ Date processing completed
[17:26:50] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[17:26:50] 🔄 
🔄 Step 4: Extracting order data...
[17:26:52] ℹ️  Order extraction - MRN: 'MA230712124102'
[17:26:52] ℹ️  Order extraction - Sex: 'MALE'
[17:26:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:26:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:26:52] ✅ Order data extraction completed successfully
[17:26:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:26:52] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[17:26:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:26:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:26:52] ✅ Patient name cross-validation successful
[17:26:52] ✅    ✅ Data merged successfully
[17:26:53] ✅    ✅ Order data extracted and validated
[17:26:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:26:53] [DOC: 9206517] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:26:53] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:26:53] 🔄 
🔄 Step 6: Pushing order to API...
[17:26:53] [DOC: 9206517] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:26:55] [DOC: 9206517] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13647"}
[17:26:55] ❌    ❌ Failed to push order
[17:26:55] 🔄 
🔄 Step 7: Writing to CSV...
[17:26:55] [DOC: 9206517] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[17:26:55] [DOC: 9206517] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:26:55] [DOC: 9206517] ℹ️  Payer Source extracted: 'Medicare'
[17:26:55] [DOC: 9206517] ℹ️  Diagnosis codes being written:
[17:26:55] [DOC: 9206517] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[17:26:55] [DOC: 9206517] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[17:26:55] [DOC: 9206517] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[17:26:55] [DOC: 9206517] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[17:26:55] [DOC: 9206517] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[17:26:55] [DOC: 9206517] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.26'
[17:26:55] [DOC: 9206517] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230712124102
[17:26:55] ✅    ✅ Document 9206517 processed and saved successfully
[17:26:55] 🔄 
🔄 Step 8: Saving API details...
[17:26:55] [DOC: 9206517] ℹ️  API push details saved for document 9206517
[17:26:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206512                         ║
================================================================================
[17:26:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:26:55] ℹ️  Date: 03/27/2025
[17:26:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:27:00] [DOC: 9206512] ✅ Text extracted using pdfplumber (10160 chars)
[17:27:00] ✅    ✅ Text extracted using pdfplumber (10160 chars)
[17:27:00] 🔄 
🔄 Step 2: Extracting patient data...
[17:27:03] ℹ️  AI extracted raw sex value: 'M'
[17:27:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:27:03] ℹ️  AI extracted payer source: 'SWH'
[17:27:03] ℹ️  AI extracted diagnoses:
[17:27:03] ℹ️    - Diagnosis 1: 'F03.90'
[17:27:03] ℹ️    - Diagnosis 2: 'E11.65'
[17:27:03] ℹ️    - Diagnosis 3: 'I10'
[17:27:03] ℹ️    - Diagnosis 4: 'I48.0'
[17:27:03] ℹ️    - Diagnosis 5: 'R63.4'
[17:27:03] ℹ️    - Diagnosis 6: 'Z68.26'
[17:27:03] ℹ️  Final extracted MRN: 'MA230712124102'
[17:27:03] ℹ️  Final extracted Sex: 'MALE'
[17:27:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:27:03] ℹ️  Final extracted Payer Source: 'SWH'
[17:27:03] ✅ Patient data extraction completed successfully
[17:27:03] ✅    ✅ Patient data extracted successfully
[17:27:03] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: Dr. SOUZA, AILEEN
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[17:27:03] ✅    ✅ Patient identified: Hiram Cordero
[17:27:03] ✅    ✅ Patient name validation passed
[17:27:03] 🔄 
🔄 Step 3: Processing patient dates...
[17:27:03] [DOC: 9206512] ℹ️  DOB normalized: 12/08/1941
[17:27:03] [DOC: 9206512] ℹ️  Episode startOfCare normalized: 03/21/2024
[17:27:03] [DOC: 9206512] ℹ️  Episode startOfEpisode normalized: 11/16/2024
[17:27:03] [DOC: 9206512] ℹ️  Episode endOfEpisode normalized: 01/14/2025
[17:27:03] [DOC: 9206512] ✅ Patient date processing completed successfully
[17:27:03] ✅    ✅ Date processing completed
[17:27:03] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: Dr. SOUZA, AILEEN
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '11/16/2024', 'endOfEpisode': '01/14/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'Z68.26'}]
[17:27:03] 🔄 
🔄 Step 4: Extracting order data...
[17:27:06] ℹ️  Order extraction - MRN: 'MA230712124102'
[17:27:06] ℹ️  Order extraction - Sex: 'MALE'
[17:27:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:27:06] ℹ️  Order extraction - Payer Source: 'SWH'
[17:27:06] ✅ Order data extraction completed successfully
[17:27:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:27:06] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[17:27:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:27:06] ℹ️  Payer source consistent in both sources: 'SWH'
[17:27:06] ✅ Patient name cross-validation successful
[17:27:06] ✅    ✅ Data merged successfully
[17:27:08] ✅    ✅ Order data extracted and validated
[17:27:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:27:08] [DOC: 9206512] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:27:08] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:27:08] 🔄 
🔄 Step 6: Pushing order to API...
[17:27:08] [DOC: 9206512] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[17:27:09] [DOC: 9206512] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13646"}
[17:27:09] ❌    ❌ Failed to push order
[17:27:09] 🔄 
🔄 Step 7: Writing to CSV...
[17:27:09] [DOC: 9206512] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[17:27:09] [DOC: 9206512] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:27:09] [DOC: 9206512] ℹ️  Payer Source extracted: 'SWH'
[17:27:09] [DOC: 9206512] ℹ️  Diagnosis codes being written:
[17:27:09] [DOC: 9206512] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[17:27:09] [DOC: 9206512] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[17:27:09] [DOC: 9206512] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[17:27:09] [DOC: 9206512] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[17:27:09] [DOC: 9206512] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[17:27:09] [DOC: 9206512] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.26'
[17:27:09] [DOC: 9206512] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: SWH | MRN: MA230712124102
[17:27:09] ✅    ✅ Document 9206512 processed and saved successfully
[17:27:09] 🔄 
🔄 Step 8: Saving API details...
[17:27:09] [DOC: 9206512] ℹ️  API push details saved for document 9206512
[17:27:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206491                         ║
================================================================================
[17:27:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:27:09] ℹ️  Date: 03/27/2025
[17:27:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:27:11] [DOC: 9206491] ✅ Text extracted using pdfplumber (1180 chars)
[17:27:11] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[17:27:11] 🔄 
🔄 Step 2: Extracting patient data...
[17:27:15] ℹ️  AI extracted raw sex value: ''
[17:27:15] ℹ️  AI extracted service line: 'Physical Therapy'
[17:27:15] ℹ️  AI extracted payer source: ''
[17:27:15] ℹ️  AI extracted diagnoses:
[17:27:15] ℹ️    - Diagnosis 1: 'F03.90'
[17:27:15] ℹ️    - Diagnosis 2: 'R41.0'
[17:27:15] ℹ️    - Diagnosis 3: 'I10'
[17:27:15] ℹ️    - Diagnosis 4: 'None'
[17:27:15] ℹ️    - Diagnosis 5: 'None'
[17:27:15] ℹ️    - Diagnosis 6: 'None'
[17:27:15] ℹ️  Final extracted MRN: '101002156'
[17:27:15] ℹ️  Final extracted Sex: ''
[17:27:15] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:27:15] ℹ️  Final extracted Payer Source: ''
[17:27:15] ✅ Patient data extraction completed successfully
[17:27:15] ✅    ✅ Patient data extracted successfully
[17:27:15] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:27:15] ✅    ✅ Patient identified: Eleanor Martin
[17:27:15] ✅    ✅ Patient name validation passed
[17:27:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:27:15] [DOC: 9206491] ℹ️  DOB normalized: 03/25/1934
[17:27:15] [DOC: 9206491] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:27:15] [DOC: 9206491] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:27:15] [DOC: 9206491] ✅ Patient date processing completed successfully
[17:27:15] ✅    ✅ Date processing completed
[17:27:15] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10'}]
[17:27:15] 🔄 
🔄 Step 4: Extracting order data...
[17:27:17] ℹ️  Order extraction - MRN: '101002156'
[17:27:17] ℹ️  Order extraction - Sex: ''
[17:27:17] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:27:17] ℹ️  Order extraction - Payer Source: ''
[17:27:17] ✅ Order data extraction completed successfully
[17:27:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:27:17] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:27:17] ⚠️  Could not determine sex using any available method
[17:27:17] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:27:17] ✅ Patient name cross-validation successful
[17:27:17] ✅    ✅ Data merged successfully
[17:27:18] ✅    ✅ Order data extracted and validated
[17:27:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:27:26] [DOC: 9206491] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:27:26] [DOC: 9206491] ℹ️  Patient not found, creating new patient via API...
[17:27:26] [DOC: 9206491] ℹ️  Creating patient via API: Eleanor Martin
[17:27:27] [DOC: 9206491] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:27:27] ❌    ❌ Failed to create patient
[17:27:27] [DOC: 9206491] ℹ️  API push details saved for document 9206491
================================================================================
║                        Processing Document ID: 9206483                         ║
================================================================================
[17:27:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:27:27] ℹ️  Date: 03/27/2025
[17:27:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:27:31] [DOC: 9206483] ✅ Text extracted using pdfplumber (1150 chars)
[17:27:31] ✅    ✅ Text extracted using pdfplumber (1150 chars)
[17:27:31] 🔄 
🔄 Step 2: Extracting patient data...
[17:27:34] ℹ️  AI extracted raw sex value: ''
[17:27:34] ℹ️  AI extracted service line: 'Physical Therapy'
[17:27:34] ℹ️  AI extracted payer source: ''
[17:27:34] ℹ️  AI extracted diagnoses:
[17:27:34] ℹ️    - Diagnosis 1: 'F03.90'
[17:27:34] ℹ️    - Diagnosis 2: 'R41.0'
[17:27:34] ℹ️    - Diagnosis 3: 'I10'
[17:27:34] ℹ️    - Diagnosis 4: ''
[17:27:34] ℹ️    - Diagnosis 5: ''
[17:27:34] ℹ️    - Diagnosis 6: ''
[17:27:34] ℹ️  Final extracted MRN: '101002156'
[17:27:34] ℹ️  Final extracted Sex: ''
[17:27:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:27:34] ℹ️  Final extracted Payer Source: ''
[17:27:34] ✅ Patient data extraction completed successfully
[17:27:34] ✅    ✅ Patient data extracted successfully
[17:27:34] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:27:34] ✅    ✅ Patient identified: Eleanor Martin
[17:27:34] ✅    ✅ Patient name validation passed
[17:27:34] 🔄 
🔄 Step 3: Processing patient dates...
[17:27:34] [DOC: 9206483] ℹ️  DOB normalized: 03/25/1934
[17:27:34] [DOC: 9206483] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:27:34] [DOC: 9206483] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:27:34] [DOC: 9206483] ✅ Patient date processing completed successfully
[17:27:34] ✅    ✅ Date processing completed
[17:27:34] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:27:34] 🔄 
🔄 Step 4: Extracting order data...
[17:27:36] ℹ️  Order extraction - MRN: '101002156'
[17:27:36] ℹ️  Order extraction - Sex: ''
[17:27:36] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:27:36] ℹ️  Order extraction - Payer Source: ''
[17:27:36] ✅ Order data extraction completed successfully
[17:27:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:27:36] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:27:36] ⚠️  Could not determine sex using any available method
[17:27:36] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:27:36] ✅ Patient name cross-validation successful
[17:27:36] ✅    ✅ Data merged successfully
[17:27:37] ✅    ✅ Order data extracted and validated
[17:27:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:28:09] [DOC: 9206483] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:28:09] [DOC: 9206483] ℹ️  Patient not found, creating new patient via API...
[17:28:09] [DOC: 9206483] ℹ️  Creating patient via API: Eleanor Martin
[17:28:10] [DOC: 9206483] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:28:10] ❌    ❌ Failed to create patient
[17:28:10] [DOC: 9206483] ℹ️  API push details saved for document 9206483
================================================================================
║                        Processing Document ID: 9206480                         ║
================================================================================
[17:28:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:28:10] ℹ️  Date: 03/27/2025
[17:28:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:28:13] [DOC: 9206480] ✅ Text extracted using pdfplumber (15740 chars)
[17:28:13] ✅    ✅ Text extracted using pdfplumber (15740 chars)
[17:28:13] 🔄 
🔄 Step 2: Extracting patient data...
[17:28:16] ℹ️  AI extracted raw sex value: 'F'
[17:28:16] ℹ️  AI extracted service line: 'PT'
[17:28:16] ℹ️  AI extracted payer source: 'None'
[17:28:16] ℹ️  AI extracted diagnoses:
[17:28:16] ℹ️    - Diagnosis 1: 'None'
[17:28:16] ℹ️    - Diagnosis 2: 'None'
[17:28:16] ℹ️    - Diagnosis 3: 'None'
[17:28:16] ℹ️    - Diagnosis 4: 'None'
[17:28:16] ℹ️    - Diagnosis 5: 'None'
[17:28:16] ℹ️    - Diagnosis 6: 'None'
[17:28:16] ℹ️  Final extracted MRN: '101002156'
[17:28:16] ℹ️  Final extracted Sex: 'FEMALE'
[17:28:16] ℹ️  Final extracted Service Line: 'PT'
[17:28:16] ℹ️  Final extracted Payer Source: ''
[17:28:16] ✅ Patient data extraction completed successfully
[17:28:16] ✅    ✅ Patient data extracted successfully
[17:28:16] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002156
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/10/2024', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:28:16] ✅    ✅ Patient identified: Eleanor Martin
[17:28:16] ✅    ✅ Patient name validation passed
[17:28:16] 🔄 
🔄 Step 3: Processing patient dates...
[17:28:16] [DOC: 9206480] ℹ️  DOB normalized: 03/25/1934
[17:28:16] [DOC: 9206480] ℹ️  Episode startOfEpisode normalized: 12/10/2024
[17:28:16] [DOC: 9206480] ✅ Patient date processing completed successfully
[17:28:16] ✅    ✅ Date processing completed
[17:28:16] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002156
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/10/2024'}]
[17:28:16] 🔄 
🔄 Step 4: Extracting order data...
[17:28:19] ℹ️  Order extraction - MRN: '101002156'
[17:28:19] ℹ️  Order extraction - Sex: 'FEMALE'
[17:28:19] ℹ️  Order extraction - Service Line: 'PT'
[17:28:19] ℹ️  Order extraction - Payer Source: ''
[17:28:19] ✅ Order data extraction completed successfully
[17:28:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:28:19] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:28:19] ℹ️  Service line consistent in both sources: 'PT'
[17:28:19] ✅ Patient name cross-validation successful
[17:28:19] ✅    ✅ Data merged successfully
[17:28:20] ✅    ✅ Order data extracted and validated
[17:28:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:28:50] [DOC: 9206480] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:28:50] [DOC: 9206480] ℹ️  Patient not found, creating new patient via API...
[17:28:50] [DOC: 9206480] ℹ️  Creating patient via API: Eleanor Martin
[17:28:51] [DOC: 9206480] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:28:51] ❌    ❌ Failed to create patient
[17:28:51] [DOC: 9206480] ℹ️  API push details saved for document 9206480
================================================================================
║                        Processing Document ID: 9206479                         ║
================================================================================
[17:28:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:28:51] ℹ️  Date: 03/27/2025
[17:28:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:28:53] [DOC: 9206479] ✅ Text extracted using pdfplumber (1413 chars)
[17:28:53] ✅    ✅ Text extracted using pdfplumber (1413 chars)
[17:28:53] 🔄 
🔄 Step 2: Extracting patient data...
[17:28:56] ℹ️  AI extracted raw sex value: ''
[17:28:56] ℹ️  AI extracted service line: 'Physical Therapy'
[17:28:56] ℹ️  AI extracted payer source: ''
[17:28:56] ℹ️  AI extracted diagnoses:
[17:28:56] ℹ️    - Diagnosis 1: 'F03.90'
[17:28:56] ℹ️    - Diagnosis 2: 'R41.0'
[17:28:56] ℹ️    - Diagnosis 3: 'I10'
[17:28:56] ℹ️    - Diagnosis 4: ''
[17:28:56] ℹ️    - Diagnosis 5: ''
[17:28:56] ℹ️    - Diagnosis 6: ''
[17:28:56] ℹ️  Final extracted MRN: '101002156'
[17:28:56] ℹ️  Final extracted Sex: ''
[17:28:56] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:28:56] ℹ️  Final extracted Payer Source: ''
[17:28:56] ✅ Patient data extraction completed successfully
[17:28:56] ✅    ✅ Patient data extracted successfully
[17:28:56] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:28:56] ✅    ✅ Patient identified: Eleanor Martin
[17:28:56] ✅    ✅ Patient name validation passed
[17:28:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:28:56] [DOC: 9206479] ℹ️  DOB normalized: 03/25/1934
[17:28:56] [DOC: 9206479] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:28:56] [DOC: 9206479] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:28:56] [DOC: 9206479] ✅ Patient date processing completed successfully
[17:28:56] ✅    ✅ Date processing completed
[17:28:56] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:28:56] 🔄 
🔄 Step 4: Extracting order data...
[17:28:59] ℹ️  Order extraction - MRN: '101002156'
[17:28:59] ℹ️  Order extraction - Sex: ''
[17:28:59] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:28:59] ℹ️  Order extraction - Payer Source: ''
[17:28:59] ✅ Order data extraction completed successfully
[17:28:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:28:59] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:28:59] ⚠️  Could not determine sex using any available method
[17:28:59] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:28:59] ✅ Patient name cross-validation successful
[17:28:59] ✅    ✅ Data merged successfully
[17:29:00] ✅    ✅ Order data extracted and validated
[17:29:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:29:06] [DOC: 9206479] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:29:06] [DOC: 9206479] ℹ️  Patient not found, creating new patient via API...
[17:29:06] [DOC: 9206479] ℹ️  Creating patient via API: Eleanor Martin
[17:29:07] [DOC: 9206479] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:29:07] ❌    ❌ Failed to create patient
[17:29:07] [DOC: 9206479] ℹ️  API push details saved for document 9206479
================================================================================
║                        Processing Document ID: 9206475                         ║
================================================================================
[17:29:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:29:07] ℹ️  Date: 03/27/2025
[17:29:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:29:09] [DOC: 9206475] ✅ Text extracted using pdfplumber (1145 chars)
[17:29:09] ✅    ✅ Text extracted using pdfplumber (1145 chars)
[17:29:09] 🔄 
🔄 Step 2: Extracting patient data...
[17:29:12] ℹ️  AI extracted raw sex value: ''
[17:29:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:29:12] ℹ️  AI extracted payer source: ''
[17:29:12] ℹ️  AI extracted diagnoses:
[17:29:12] ℹ️    - Diagnosis 1: 'F03.90'
[17:29:12] ℹ️    - Diagnosis 2: 'R41.0'
[17:29:12] ℹ️    - Diagnosis 3: 'I10'
[17:29:12] ℹ️    - Diagnosis 4: ''
[17:29:12] ℹ️    - Diagnosis 5: ''
[17:29:12] ℹ️    - Diagnosis 6: ''
[17:29:12] ℹ️  Final extracted MRN: '101002156'
[17:29:12] ℹ️  Final extracted Sex: ''
[17:29:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:29:12] ℹ️  Final extracted Payer Source: ''
[17:29:12] ✅ Patient data extraction completed successfully
[17:29:12] ✅    ✅ Patient data extracted successfully
[17:29:12] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:29:12] ✅    ✅ Patient identified: Eleanor Martin
[17:29:12] ✅    ✅ Patient name validation passed
[17:29:12] 🔄 
🔄 Step 3: Processing patient dates...
[17:29:12] [DOC: 9206475] ℹ️  DOB normalized: 03/25/1934
[17:29:12] [DOC: 9206475] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:29:12] [DOC: 9206475] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:29:12] [DOC: 9206475] ✅ Patient date processing completed successfully
[17:29:12] ✅    ✅ Date processing completed
[17:29:12] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:29:12] 🔄 
🔄 Step 4: Extracting order data...
[17:29:14] ℹ️  Order extraction - MRN: '101002156'
[17:29:14] ℹ️  Order extraction - Sex: ''
[17:29:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:29:14] ℹ️  Order extraction - Payer Source: ''
[17:29:14] ✅ Order data extraction completed successfully
[17:29:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:29:14] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:29:14] ⚠️  Could not determine sex using any available method
[17:29:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:29:14] ✅ Patient name cross-validation successful
[17:29:14] ✅    ✅ Data merged successfully
[17:29:16] ✅    ✅ Order data extracted and validated
[17:29:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:29:21] [DOC: 9206475] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:29:21] [DOC: 9206475] ℹ️  Patient not found, creating new patient via API...
[17:29:21] [DOC: 9206475] ℹ️  Creating patient via API: Eleanor Martin
[17:29:22] [DOC: 9206475] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:29:22] ❌    ❌ Failed to create patient
[17:29:22] [DOC: 9206475] ℹ️  API push details saved for document 9206475
================================================================================
║                        Processing Document ID: 9206469                         ║
================================================================================
[17:29:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:29:22] ℹ️  Date: 03/27/2025
[17:29:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:29:26] [DOC: 9206469] ✅ Text extracted using pdfplumber (1393 chars)
[17:29:26] ✅    ✅ Text extracted using pdfplumber (1393 chars)
[17:29:26] 🔄 
🔄 Step 2: Extracting patient data...
[17:29:29] ℹ️  AI extracted raw sex value: ''
[17:29:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:29:29] ℹ️  AI extracted payer source: ''
[17:29:29] ℹ️  AI extracted diagnoses:
[17:29:29] ℹ️    - Diagnosis 1: 'F03.90'
[17:29:29] ℹ️    - Diagnosis 2: 'R41.0'
[17:29:29] ℹ️    - Diagnosis 3: 'I10'
[17:29:29] ℹ️    - Diagnosis 4: 'None'
[17:29:29] ℹ️    - Diagnosis 5: 'None'
[17:29:29] ℹ️    - Diagnosis 6: 'None'
[17:29:29] ℹ️  Final extracted MRN: '101002156'
[17:29:29] ℹ️  Final extracted Sex: ''
[17:29:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:29:29] ℹ️  Final extracted Payer Source: ''
[17:29:29] ✅ Patient data extraction completed successfully
[17:29:29] ✅    ✅ Patient data extracted successfully
[17:29:29] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:29:29] ✅    ✅ Patient identified: Eleanor Martin
[17:29:29] ✅    ✅ Patient name validation passed
[17:29:29] 🔄 
🔄 Step 3: Processing patient dates...
[17:29:29] [DOC: 9206469] ℹ️  DOB normalized: 03/25/1934
[17:29:29] [DOC: 9206469] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:29:29] [DOC: 9206469] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:29:29] [DOC: 9206469] ✅ Patient date processing completed successfully
[17:29:29] ✅    ✅ Date processing completed
[17:29:29] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10'}]
[17:29:29] 🔄 
🔄 Step 4: Extracting order data...
[17:29:31] ℹ️  Order extraction - MRN: '101002156'
[17:29:31] ℹ️  Order extraction - Sex: ''
[17:29:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:29:31] ℹ️  Order extraction - Payer Source: ''
[17:29:31] ✅ Order data extraction completed successfully
[17:29:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:29:31] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:29:31] ⚠️  Could not determine sex using any available method
[17:29:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:29:31] ✅ Patient name cross-validation successful
[17:29:31] ✅    ✅ Data merged successfully
[17:29:33] ✅    ✅ Order data extracted and validated
[17:29:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:29:39] [DOC: 9206469] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:29:39] [DOC: 9206469] ℹ️  Patient not found, creating new patient via API...
[17:29:39] [DOC: 9206469] ℹ️  Creating patient via API: Eleanor Martin
[17:29:40] [DOC: 9206469] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:29:40] ❌    ❌ Failed to create patient
[17:29:40] [DOC: 9206469] ℹ️  API push details saved for document 9206469
================================================================================
║                        Processing Document ID: 9206464                         ║
================================================================================
[17:29:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:29:40] ℹ️  Date: 03/27/2025
[17:29:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:29:43] [DOC: 9206464] ✅ Text extracted using pdfplumber (2907 chars)
[17:29:43] ✅    ✅ Text extracted using pdfplumber (2907 chars)
[17:29:43] 🔄 
🔄 Step 2: Extracting patient data...
[17:29:45] ℹ️  AI extracted raw sex value: ''
[17:29:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:29:45] ℹ️  AI extracted payer source: ''
[17:29:45] ℹ️  AI extracted diagnoses:
[17:29:45] ℹ️    - Diagnosis 1: 'F03.90'
[17:29:45] ℹ️    - Diagnosis 2: 'R41.0'
[17:29:45] ℹ️    - Diagnosis 3: 'I10'
[17:29:45] ℹ️    - Diagnosis 4: ''
[17:29:45] ℹ️    - Diagnosis 5: ''
[17:29:45] ℹ️    - Diagnosis 6: ''
[17:29:45] ℹ️  Final extracted MRN: '101002156'
[17:29:45] ℹ️  Final extracted Sex: ''
[17:29:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:29:45] ℹ️  Final extracted Payer Source: ''
[17:29:45] ✅ Patient data extraction completed successfully
[17:29:45] ✅    ✅ Patient data extracted successfully
[17:29:45] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:29:45] ✅    ✅ Patient identified: Eleanor Martin
[17:29:45] ✅    ✅ Patient name validation passed
[17:29:45] 🔄 
🔄 Step 3: Processing patient dates...
[17:29:45] [DOC: 9206464] ℹ️  DOB normalized: 03/25/1934
[17:29:45] [DOC: 9206464] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:29:45] [DOC: 9206464] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:29:45] [DOC: 9206464] ✅ Patient date processing completed successfully
[17:29:45] ✅    ✅ Date processing completed
[17:29:45] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:29:45] 🔄 
🔄 Step 4: Extracting order data...
[17:29:48] ℹ️  Order extraction - MRN: '101002156'
[17:29:48] ℹ️  Order extraction - Sex: ''
[17:29:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:29:48] ℹ️  Order extraction - Payer Source: ''
[17:29:48] ✅ Order data extraction completed successfully
[17:29:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:29:48] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:29:48] ⚠️  Could not determine sex using any available method
[17:29:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:29:48] ✅ Patient name cross-validation successful
[17:29:48] ✅    ✅ Data merged successfully
[17:29:49] ✅    ✅ Order data extracted and validated
[17:29:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:29:55] [DOC: 9206464] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:29:55] [DOC: 9206464] ℹ️  Patient not found, creating new patient via API...
[17:29:55] [DOC: 9206464] ℹ️  Creating patient via API: Eleanor Martin
[17:29:56] [DOC: 9206464] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:29:56] ❌    ❌ Failed to create patient
[17:29:56] [DOC: 9206464] ℹ️  API push details saved for document 9206464
================================================================================
║                        Processing Document ID: 9206461                         ║
================================================================================
[17:29:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:29:56] ℹ️  Date: 03/27/2025
[17:29:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:29:59] [DOC: 9206461] ✅ Text extracted using pdfplumber (1155 chars)
[17:29:59] ✅    ✅ Text extracted using pdfplumber (1155 chars)
[17:29:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:30:02] ℹ️  AI extracted raw sex value: ''
[17:30:02] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:30:02] ℹ️  AI extracted payer source: ''
[17:30:02] ℹ️  AI extracted diagnoses:
[17:30:02] ℹ️    - Diagnosis 1: 'F03.90'
[17:30:02] ℹ️    - Diagnosis 2: 'R41.0'
[17:30:02] ℹ️    - Diagnosis 3: 'I10'
[17:30:02] ℹ️    - Diagnosis 4: ''
[17:30:02] ℹ️    - Diagnosis 5: ''
[17:30:02] ℹ️    - Diagnosis 6: ''
[17:30:02] ℹ️  Final extracted MRN: '101002156'
[17:30:02] ℹ️  Final extracted Sex: ''
[17:30:02] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:30:02] ℹ️  Final extracted Payer Source: ''
[17:30:02] ✅ Patient data extraction completed successfully
[17:30:02] ✅    ✅ Patient data extracted successfully
[17:30:02] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:30:02] ✅    ✅ Patient identified: Eleanor Martin
[17:30:02] ✅    ✅ Patient name validation passed
[17:30:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:30:02] [DOC: 9206461] ℹ️  DOB normalized: 03/25/1934
[17:30:02] [DOC: 9206461] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[17:30:02] [DOC: 9206461] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[17:30:02] [DOC: 9206461] ✅ Patient date processing completed successfully
[17:30:02] ✅    ✅ Date processing completed
[17:30:02] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:30:02] 🔄 
🔄 Step 4: Extracting order data...
[17:30:04] ℹ️  Order extraction - MRN: '101002156'
[17:30:04] ℹ️  Order extraction - Sex: ''
[17:30:04] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:30:04] ℹ️  Order extraction - Payer Source: ''
[17:30:04] ✅ Order data extraction completed successfully
[17:30:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:30:04] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[17:30:04] ⚠️  Could not determine sex using any available method
[17:30:04] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:30:04] ✅ Patient name cross-validation successful
[17:30:04] ✅    ✅ Data merged successfully
[17:30:05] ✅    ✅ Order data extracted and validated
[17:30:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:30:45] [DOC: 9206461] ℹ️  Patient not found in cache or API: Eleanor Martin
[17:30:45] [DOC: 9206461] ℹ️  Patient not found, creating new patient via API...
[17:30:45] [DOC: 9206461] ℹ️  Creating patient via API: Eleanor Martin
[17:30:46] [DOC: 9206461] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:30:46] ❌    ❌ Failed to create patient
[17:30:46] [DOC: 9206461] ℹ️  API push details saved for document 9206461
================================================================================
║                        Processing Document ID: 9206449                         ║
================================================================================
[17:30:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:30:46] ℹ️  Date: 03/27/2025
[17:30:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:30:51] [DOC: 9206449] ✅ Text extracted using pdfplumber (1218 chars)
[17:30:51] ✅    ✅ Text extracted using pdfplumber (1218 chars)
[17:30:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:30:54] ℹ️  AI extracted raw sex value: ''
[17:30:54] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:30:54] ℹ️  AI extracted payer source: ''
[17:30:54] ℹ️  AI extracted diagnoses:
[17:30:54] ℹ️    - Diagnosis 1: 'E11.65'
[17:30:54] ℹ️    - Diagnosis 2: 'U07.1'
[17:30:54] ℹ️    - Diagnosis 3: 'S32.048'
[17:30:54] ℹ️    - Diagnosis 4: 'None'
[17:30:54] ℹ️    - Diagnosis 5: 'None'
[17:30:54] ℹ️    - Diagnosis 6: 'None'
[17:30:54] ℹ️  Final extracted MRN: '100996161'
[17:30:54] ℹ️  Final extracted Sex: ''
[17:30:54] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:30:54] ℹ️  Final extracted Payer Source: ''
[17:30:54] ✅ Patient data extraction completed successfully
[17:30:54] ✅    ✅ Patient data extracted successfully
[17:30:54] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100996161
     └─ billingProvider: JUSTIN ETTER MD
     └─ npi: 1699113472
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/30/2024', 'endOfEpisode': '07/28/2024', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'S32.048', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:30:54] ✅    ✅ Patient identified: Stephen Estevez
[17:30:54] ✅    ✅ Patient name validation passed
[17:30:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:30:54] [DOC: 9206449] ℹ️  DOB normalized: 10/21/1945
[17:30:54] [DOC: 9206449] ℹ️  Episode startOfEpisode normalized: 05/30/2024
[17:30:54] [DOC: 9206449] ℹ️  Episode endOfEpisode normalized: 07/28/2024
[17:30:54] [DOC: 9206449] ✅ Patient date processing completed successfully
[17:30:54] ✅    ✅ Date processing completed
[17:30:54] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Estevez
     └─ dob: 10/21/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100996161
     └─ billingProvider: JUSTIN ETTER MD
     └─ npi: 1699113472
     └─ physicianNPI: 1699113472
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/30/2024', 'endOfEpisode': '07/28/2024', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'U07.1', 'thirdDiagnosis': 'S32.048'}]
[17:30:54] 🔄 
🔄 Step 4: Extracting order data...
[17:30:56] ℹ️  Order extraction - MRN: '100996161'
[17:30:56] ℹ️  Order extraction - Sex: ''
[17:30:56] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:30:56] ℹ️  Order extraction - Payer Source: ''
[17:30:56] ✅ Order data extraction completed successfully
[17:30:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:30:56] ℹ️  Using MRN from patient data: '100996161' over '100996161'
[17:30:56] ℹ️  Inferred sex as MALE from name: Stephen
[17:30:56] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:30:56] ✅ Patient name cross-validation successful
[17:30:56] ✅    ✅ Data merged successfully
[17:30:58] ✅    ✅ Order data extracted and validated
[17:30:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:30:58] [DOC: 9206449] ✅ Patient found in local cache: Stephen Estevez, ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[17:30:58] ✅    ✅ Existing patient found with ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[17:30:58] 🔄 
🔄 Step 6: Pushing order to API...
[17:30:58] [DOC: 9206449] ℹ️  Pushing order via API for patient ID: d2d49e26-9a15-4160-a575-9ee16304aff6
[17:30:59] [DOC: 9206449] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13931"}
[17:30:59] ❌    ❌ Failed to push order
[17:30:59] 🔄 
🔄 Step 7: Writing to CSV...
[17:30:59] [DOC: 9206449] ℹ️  Calculated age: 79 from DOB: 10/21/1945
[17:30:59] [DOC: 9206449] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:30:59] [DOC: 9206449] ℹ️  Payer Source extracted: ''
[17:30:59] [DOC: 9206449] ℹ️  Diagnosis codes being written:
[17:30:59] [DOC: 9206449] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[17:30:59] [DOC: 9206449] ℹ️    - Latest_Episode_Seconddiagnosis: 'U07.1'
[17:30:59] [DOC: 9206449] ℹ️    - Latest_Episode_Thirddiagnosis: 'S32.048'
[17:30:59] [DOC: 9206449] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:30:59] [DOC: 9206449] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:30:59] [DOC: 9206449] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:30:59] [DOC: 9206449] ✅ Patient data written to CSV: Stephen Estevez | Sex: MALE | Age: 79 | Service: Occupational Therapy | Payer:  | MRN: 100996161
[17:30:59] ✅    ✅ Document 9206449 processed and saved successfully
[17:30:59] 🔄 
🔄 Step 8: Saving API details...
[17:30:59] [DOC: 9206449] ℹ️  API push details saved for document 9206449
[17:30:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206295                         ║
================================================================================
[17:30:59] ℹ️  Agency: Alphacare Home Health Agency
[17:30:59] ℹ️  Date: 03/27/2025
[17:30:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:31:02] [DOC: 9206295] ✅ Text extracted using pdfplumber (1483 chars)
[17:31:02] ✅    ✅ Text extracted using pdfplumber (1483 chars)
[17:31:02] 🔄 
🔄 Step 2: Extracting patient data...
[17:31:05] ℹ️  AI extracted raw sex value: ''
[17:31:05] ℹ️  AI extracted service line: 'PT'
[17:31:05] ℹ️  AI extracted payer source: ''
[17:31:05] ℹ️  AI extracted diagnoses:
[17:31:05] ℹ️    - Diagnosis 1: ''
[17:31:05] ℹ️    - Diagnosis 2: ''
[17:31:05] ℹ️    - Diagnosis 3: ''
[17:31:05] ℹ️    - Diagnosis 4: ''
[17:31:05] ℹ️    - Diagnosis 5: ''
[17:31:05] ℹ️    - Diagnosis 6: ''
[17:31:05] ℹ️  Final extracted MRN: '000003599'
[17:31:05] ℹ️  Final extracted Sex: ''
[17:31:05] ℹ️  Final extracted Service Line: 'PT'
[17:31:05] ℹ️  Final extracted Payer Source: ''
[17:31:05] ✅ Patient data extraction completed successfully
[17:31:05] ✅    ✅ Patient data extracted successfully
[17:31:05] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:31:05] ✅    ✅ Patient identified: June Stykowski
[17:31:05] ✅    ✅ Patient name validation passed
[17:31:05] 🔄 
🔄 Step 3: Processing patient dates...
[17:31:05] [DOC: 9206295] ℹ️  DOB normalized: 11/08/1952
[17:31:05] [DOC: 9206295] ✅ Patient date processing completed successfully
[17:31:05] ✅    ✅ Date processing completed
[17:31:05] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:31:05] 🔄 
🔄 Step 4: Extracting order data...
[17:31:07] ℹ️  Order extraction - MRN: '000003599'
[17:31:07] ℹ️  Order extraction - Sex: ''
[17:31:07] ℹ️  Order extraction - Service Line: 'PT'
[17:31:07] ℹ️  Order extraction - Payer Source: ''
[17:31:07] ✅ Order data extraction completed successfully
[17:31:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:31:07] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[17:31:07] ⚠️  Could not determine sex using any available method
[17:31:07] ℹ️  Service line consistent in both sources: 'PT'
[17:31:07] ✅ Patient name cross-validation successful
[17:31:07] ✅    ✅ Data merged successfully
[17:31:08] ✅    ✅ Order data extracted and validated
[17:31:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:31:08] [DOC: 9206295] ✅ Patient found in local cache: June Stykowski, ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[17:31:08] ✅    ✅ Existing patient found with ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[17:31:08] 🔄 
🔄 Step 6: Pushing order to API...
[17:31:08] [DOC: 9206295] ℹ️  Pushing order via API for patient ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[17:31:10] [DOC: 9206295] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:31:10] ❌    ❌ Failed to push order
[17:31:10] 🔄 
🔄 Step 7: Writing to CSV...
[17:31:10] [DOC: 9206295] ℹ️  Calculated age: 72 from DOB: 11/08/1952
[17:31:10] [DOC: 9206295] ℹ️  Service Line extracted: 'PT'
[17:31:10] [DOC: 9206295] ℹ️  Payer Source extracted: ''
[17:31:10] [DOC: 9206295] ℹ️  Diagnosis codes being written:
[17:31:10] [DOC: 9206295] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:31:10] [DOC: 9206295] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:31:10] [DOC: 9206295] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:31:10] [DOC: 9206295] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:31:10] [DOC: 9206295] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:31:10] [DOC: 9206295] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:31:10] [DOC: 9206295] ✅ Patient data written to CSV: June Stykowski | Sex:  | Age: 72 | Service: PT | Payer:  | MRN: 000003599
[17:31:10] ✅    ✅ Document 9206295 processed and saved successfully
[17:31:10] 🔄 
🔄 Step 8: Saving API details...
[17:31:10] [DOC: 9206295] ℹ️  API push details saved for document 9206295
[17:31:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206249                         ║
================================================================================
[17:31:10] ℹ️  Agency: Relief Home Health Services
[17:31:10] ℹ️  Date: 03/27/2025
[17:31:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:31:19] [DOC: 9206249] ✅ Text extracted using pdfplumber (19485 chars)
[17:31:19] ✅    ✅ Text extracted using pdfplumber (19485 chars)
[17:31:19] 🔄 
🔄 Step 2: Extracting patient data...
[17:31:22] ℹ️  AI extracted raw sex value: 'F'
[17:31:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:31:22] ℹ️  AI extracted payer source: ''
[17:31:22] ℹ️  AI extracted diagnoses:
[17:31:22] ℹ️    - Diagnosis 1: 'I50.32'
[17:31:22] ℹ️    - Diagnosis 2: 'J44.9'
[17:31:22] ℹ️    - Diagnosis 3: 'E11.9'
[17:31:22] ℹ️    - Diagnosis 4: 'F32.A'
[17:31:22] ℹ️    - Diagnosis 5: 'F32.89'
[17:31:22] ℹ️    - Diagnosis 6: 'F41.9'
[17:31:22] ℹ️  Final extracted MRN: 'NB2071'
[17:31:22] ℹ️  Final extracted Sex: 'FEMALE'
[17:31:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:31:22] ℹ️  Final extracted Payer Source: ''
[17:31:22] ✅ Patient data extraction completed successfully
[17:31:22] ✅    ✅ Patient data extracted successfully
[17:31:22] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: CARREIRO
     └─ dob: 10/18/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: NB2071
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 89 SEA BREEZE DR
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 996-6084
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/29/2024', 'startOfEpisode': '12/25/2024', 'endOfEpisode': '02/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F32.89', 'sixthDiagnosis': 'F41.9'}]
[17:31:22] ✅    ✅ Patient identified: MARY CARREIRO
[17:31:22] ✅    ✅ Patient name validation passed
[17:31:22] 🔄 
🔄 Step 3: Processing patient dates...
[17:31:22] [DOC: 9206249] ℹ️  DOB normalized: 10/18/1937
[17:31:22] [DOC: 9206249] ℹ️  Episode startOfCare normalized: 02/29/2024
[17:31:22] [DOC: 9206249] ℹ️  Episode startOfEpisode normalized: 12/25/2024
[17:31:22] [DOC: 9206249] ℹ️  Episode endOfEpisode normalized: 02/22/2025
[17:31:22] [DOC: 9206249] ✅ Patient date processing completed successfully
[17:31:22] ✅    ✅ Date processing completed
[17:31:22] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: CARREIRO
     └─ dob: 10/18/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: NB2071
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 89 SEA BREEZE DR
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 996-6084
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/29/2024', 'startOfEpisode': '12/25/2024', 'endOfEpisode': '02/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F32.89', 'sixthDiagnosis': 'F41.9'}]
[17:31:22] 🔄 
🔄 Step 4: Extracting order data...
[17:31:25] ℹ️  Order extraction - MRN: 'NB2071'
[17:31:25] ℹ️  Order extraction - Sex: 'MALE'
[17:31:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:31:25] ℹ️  Order extraction - Payer Source: ''
[17:31:25] ✅ Order data extraction completed successfully
[17:31:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:31:25] ℹ️  Using MRN from patient data: 'NB2071' over 'NB2071'
[17:31:25] ⚠️  Sex mismatch: Patient='FEMALE' vs Order='MALE', using patient data
[17:31:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:31:25] ✅ Patient name cross-validation successful
[17:31:25] ✅    ✅ Data merged successfully
[17:31:27] ✅    ✅ Order data extracted and validated
[17:31:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:31:57] [DOC: 9206249] ℹ️  Patient not found in cache or API: MARY CARREIRO
[17:31:57] [DOC: 9206249] ℹ️  Patient not found, creating new patient via API...
[17:31:57] [DOC: 9206249] ℹ️  Creating patient via API: MARY CARREIRO
[17:31:58] [DOC: 9206249] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:31:58] ❌    ❌ Failed to create patient
[17:31:58] [DOC: 9206249] ℹ️  API push details saved for document 9206249
================================================================================
║                        Processing Document ID: 9206198                         ║
================================================================================
[17:31:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:31:58] ℹ️  Date: 03/27/2025
[17:31:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:32:05] [DOC: 9206198] ✅ Text extracted using pdfplumber (13652 chars)
[17:32:05] ✅    ✅ Text extracted using pdfplumber (13652 chars)
[17:32:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:32:07] ℹ️  AI extracted raw sex value: 'F'
[17:32:07] ℹ️  AI extracted service line: 'OT'
[17:32:07] ℹ️  AI extracted payer source: ''
[17:32:07] ℹ️  AI extracted diagnoses:
[17:32:07] ℹ️    - Diagnosis 1: 'Right Wrist ORIF'
[17:32:07] ℹ️    - Diagnosis 2: 'muscle weakness'
[17:32:07] ℹ️    - Diagnosis 3: ''
[17:32:07] ℹ️    - Diagnosis 4: ''
[17:32:07] ℹ️    - Diagnosis 5: ''
[17:32:07] ℹ️    - Diagnosis 6: ''
[17:32:07] ℹ️  Final extracted MRN: 'MA250127036902'
[17:32:07] ℹ️  Final extracted Sex: 'FEMALE'
[17:32:07] ℹ️  Final extracted Service Line: 'OT'
[17:32:07] ℹ️  Final extracted Payer Source: ''
[17:32:07] ✅ Patient data extraction completed successfully
[17:32:07] ✅    ✅ Patient data extracted successfully
[17:32:07] 📊 Patient Response
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Right Wrist ORIF', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:32:07] ✅    ✅ Patient identified: Lynn Garifales
[17:32:07] ✅    ✅ Patient name validation passed
[17:32:07] 🔄 
🔄 Step 3: Processing patient dates...
[17:32:07] [DOC: 9206198] ℹ️  DOB normalized: 03/04/1969
[17:32:07] [DOC: 9206198] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[17:32:07] [DOC: 9206198] ✅ Patient date processing completed successfully
[17:32:07] ✅    ✅ Date processing completed
[17:32:07] 📊 Processed Patient Data
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Right Wrist ORIF', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:32:07] 🔄 
🔄 Step 4: Extracting order data...
[17:32:10] ℹ️  Order extraction - MRN: 'MA250127036902'
[17:32:10] ℹ️  Order extraction - Sex: 'FEMALE'
[17:32:10] ℹ️  Order extraction - Service Line: 'OT'
[17:32:10] ℹ️  Order extraction - Payer Source: ''
[17:32:10] ✅ Order data extraction completed successfully
[17:32:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:32:10] ℹ️  Using MRN from patient data: 'MA250127036902' over 'MA250127036902'
[17:32:10] ℹ️  Service line consistent in both sources: 'OT'
[17:32:10] ✅ Patient name cross-validation successful
[17:32:10] ✅    ✅ Data merged successfully
[17:32:12] ⚠️     ❌ Skipping - missing episode start date
[17:32:12] [DOC: 9206198] ℹ️  API push details saved for document 9206198
================================================================================
║                        Processing Document ID: 9206195                         ║
================================================================================
[17:32:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:32:12] ℹ️  Date: 03/27/2025
[17:32:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:32:16] [DOC: 9206195] ✅ Text extracted using pdfplumber (1420 chars)
[17:32:16] ✅    ✅ Text extracted using pdfplumber (1408 chars)
[17:32:16] 🔄 
🔄 Step 2: Extracting patient data...
[17:32:19] ℹ️  AI extracted raw sex value: ''
[17:32:19] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:32:19] ℹ️  AI extracted payer source: ''
[17:32:19] ℹ️  AI extracted diagnoses:
[17:32:19] ℹ️    - Diagnosis 1: 'S52.501'
[17:32:19] ℹ️    - Diagnosis 2: 'E78.49'
[17:32:19] ℹ️    - Diagnosis 3: 'D69.3'
[17:32:19] ℹ️    - Diagnosis 4: 'None'
[17:32:19] ℹ️    - Diagnosis 5: 'None'
[17:32:19] ℹ️    - Diagnosis 6: 'None'
[17:32:19] ℹ️  Final extracted MRN: 'MA250127036902'
[17:32:19] ℹ️  Final extracted Sex: ''
[17:32:19] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:32:19] ℹ️  Final extracted Payer Source: ''
[17:32:19] ✅ Patient data extraction completed successfully
[17:32:19] ✅    ✅ Patient data extracted successfully
[17:32:19] 📊 Patient Response
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: 
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'S52.501', 'secondDiagnosis': 'E78.49', 'thirdDiagnosis': 'D69.3', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:32:19] ✅    ✅ Patient identified: Lynn Garifales
[17:32:19] ✅    ✅ Patient name validation passed
[17:32:19] 🔄 
🔄 Step 3: Processing patient dates...
[17:32:19] [DOC: 9206195] ℹ️  DOB normalized: 03/04/1969
[17:32:19] [DOC: 9206195] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[17:32:19] [DOC: 9206195] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[17:32:19] [DOC: 9206195] ✅ Patient date processing completed successfully
[17:32:19] ✅    ✅ Date processing completed
[17:32:19] 📊 Processed Patient Data
     └─ patientFName: Lynn
     └─ patientLName: Garifales
     └─ dob: 03/04/1969
     └─ patientSex: 
     └─ medicalRecordNo: MA250127036902
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'S52.501', 'secondDiagnosis': 'E78.49', 'thirdDiagnosis': 'D69.3'}]
[17:32:19] 🔄 
🔄 Step 4: Extracting order data...
[17:32:23] ℹ️  Order extraction - MRN: 'MA250127036902'
[17:32:23] ℹ️  Order extraction - Sex: ''
[17:32:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:32:23] ℹ️  Order extraction - Payer Source: ''
[17:32:23] ✅ Order data extraction completed successfully
[17:32:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:32:23] ℹ️  Using MRN from patient data: 'MA250127036902' over 'MA250127036902'
[17:32:23] ⚠️  Could not determine sex using any available method
[17:32:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:32:23] ✅ Patient name cross-validation successful
[17:32:23] ✅    ✅ Data merged successfully
[17:32:24] ✅    ✅ Order data extracted and validated
[17:32:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:32:59] [DOC: 9206195] ✅ Patient exists in API: Lynn Garifales, ID: 7d1a71eb-7fb9-4002-8f28-5a489c76a1a0
[17:32:59] ✅    ✅ Existing patient found with ID: 7d1a71eb-7fb9-4002-8f28-5a489c76a1a0
[17:32:59] 🔄 
🔄 Step 6: Pushing order to API...
[17:32:59] [DOC: 9206195] ℹ️  Pushing order via API for patient ID: 7d1a71eb-7fb9-4002-8f28-5a489c76a1a0
[17:33:01] [DOC: 9206195] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13769"}
[17:33:01] ❌    ❌ Failed to push order
[17:33:01] 🔄 
🔄 Step 7: Writing to CSV...
[17:33:01] [DOC: 9206195] ℹ️  Calculated age: 56 from DOB: 03/04/1969
[17:33:01] [DOC: 9206195] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:33:01] [DOC: 9206195] ℹ️  Payer Source extracted: ''
[17:33:01] [DOC: 9206195] ℹ️  Diagnosis codes being written:
[17:33:01] [DOC: 9206195] ℹ️    - Latest_Episode_Firstdiagnosis: 'S52.501'
[17:33:01] [DOC: 9206195] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.49'
[17:33:01] [DOC: 9206195] ℹ️    - Latest_Episode_Thirddiagnosis: 'D69.3'
[17:33:01] [DOC: 9206195] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:33:01] [DOC: 9206195] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:33:01] [DOC: 9206195] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:33:01] [DOC: 9206195] ✅ Patient data written to CSV: Lynn Garifales | Sex:  | Age: 56 | Service: Occupational Therapy | Payer:  | MRN: MA250127036902
[17:33:01] ✅    ✅ Document 9206195 processed and saved successfully
[17:33:01] 🔄 
🔄 Step 8: Saving API details...
[17:33:01] [DOC: 9206195] ℹ️  API push details saved for document 9206195
[17:33:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206185                         ║
================================================================================
[17:33:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:33:01] ℹ️  Date: 03/27/2025
[17:33:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:33:04] [DOC: 9206185] ✅ Text extracted using pdfplumber (19939 chars)
[17:33:04] ✅    ✅ Text extracted using pdfplumber (19939 chars)
[17:33:04] 🔄 
🔄 Step 2: Extracting patient data...
[17:33:07] ℹ️  AI extracted raw sex value: 'F'
[17:33:07] ℹ️  AI extracted service line: 'PT'
[17:33:07] ℹ️  AI extracted payer source: ''
[17:33:07] ℹ️  AI extracted diagnoses:
[17:33:07] ℹ️    - Diagnosis 1: 'G20'
[17:33:07] ℹ️    - Diagnosis 2: 'D51.8'
[17:33:07] ℹ️    - Diagnosis 3: 'G24.2'
[17:33:07] ℹ️    - Diagnosis 4: 'G57.3'
[17:33:07] ℹ️    - Diagnosis 5: 'M54.5'
[17:33:07] ℹ️    - Diagnosis 6: 'I25.10'
[17:33:07] ℹ️  Final extracted MRN: 'MA250220064201'
[17:33:07] ℹ️  Final extracted Sex: 'FEMALE'
[17:33:07] ℹ️  Final extracted Service Line: 'PT'
[17:33:07] ℹ️  Final extracted Payer Source: ''
[17:33:07] ✅ Patient data extraction completed successfully
[17:33:07] ✅    ✅ Patient data extracted successfully
[17:33:07] 📊 Patient Response
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'G20', 'secondDiagnosis': 'D51.8', 'thirdDiagnosis': 'G24.2', 'fourthDiagnosis': 'G57.3', 'fifthDiagnosis': 'M54.5', 'sixthDiagnosis': 'I25.10'}]
[17:33:07] ✅    ✅ Patient identified: Lucy Francis
[17:33:07] ✅    ✅ Patient name validation passed
[17:33:07] 🔄 
🔄 Step 3: Processing patient dates...
[17:33:07] [DOC: 9206185] ℹ️  DOB normalized: 06/12/1942
[17:33:07] [DOC: 9206185] ✅ Patient date processing completed successfully
[17:33:07] ✅    ✅ Date processing completed
[17:33:07] 📊 Processed Patient Data
     └─ patientFName: Lucy
     └─ patientLName: Francis
     └─ dob: 06/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250220064201
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'G20', 'secondDiagnosis': 'D51.8', 'thirdDiagnosis': 'G24.2', 'fourthDiagnosis': 'G57.3', 'fifthDiagnosis': 'M54.5', 'sixthDiagnosis': 'I25.10'}]
[17:33:07] 🔄 
🔄 Step 4: Extracting order data...
[17:33:10] ℹ️  Order extraction - MRN: 'MA250220064201'
[17:33:10] ℹ️  Order extraction - Sex: 'FEMALE'
[17:33:10] ℹ️  Order extraction - Service Line: 'PT'
[17:33:10] ℹ️  Order extraction - Payer Source: ''
[17:33:10] ✅ Order data extraction completed successfully
[17:33:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:33:10] ℹ️  Using MRN from patient data: 'MA250220064201' over 'MA250220064201'
[17:33:10] ℹ️  Service line consistent in both sources: 'PT'
[17:33:10] ✅ Patient name cross-validation successful
[17:33:10] ✅    ✅ Data merged successfully
[17:33:12] ✅    ✅ Order data extracted and validated
[17:33:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:33:12] [DOC: 9206185] ✅ Patient found in local cache: Lucy Francis, ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[17:33:12] ✅    ✅ Existing patient found with ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[17:33:12] 🔄 
🔄 Step 6: Pushing order to API...
[17:33:12] [DOC: 9206185] ℹ️  Pushing order via API for patient ID: 9219abf6-1f07-481e-9ccf-2940b48b12a0
[17:33:13] [DOC: 9206185] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:33:13] ❌    ❌ Failed to push order
[17:33:13] 🔄 
🔄 Step 7: Writing to CSV...
[17:33:13] [DOC: 9206185] ℹ️  Calculated age: 82 from DOB: 06/12/1942
[17:33:13] [DOC: 9206185] ℹ️  Service Line extracted: 'PT'
[17:33:13] [DOC: 9206185] ℹ️  Payer Source extracted: ''
[17:33:13] [DOC: 9206185] ℹ️  Diagnosis codes being written:
[17:33:13] [DOC: 9206185] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20'
[17:33:13] [DOC: 9206185] ℹ️    - Latest_Episode_Seconddiagnosis: 'D51.8'
[17:33:13] [DOC: 9206185] ℹ️    - Latest_Episode_Thirddiagnosis: 'G24.2'
[17:33:13] [DOC: 9206185] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G57.3'
[17:33:13] [DOC: 9206185] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.5'
[17:33:13] [DOC: 9206185] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[17:33:13] [DOC: 9206185] ✅ Patient data written to CSV: Lucy Francis | Sex: FEMALE | Age: 82 | Service: PT | Payer:  | MRN: MA250220064201
[17:33:13] ✅    ✅ Document 9206185 processed and saved successfully
[17:33:13] 🔄 
🔄 Step 8: Saving API details...
[17:33:13] [DOC: 9206185] ℹ️  API push details saved for document 9206185
[17:33:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206175                         ║
================================================================================
[17:33:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:33:13] ℹ️  Date: 03/27/2025
[17:33:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:33:22] [DOC: 9206175] ✅ Text extracted using pdfplumber (15542 chars)
[17:33:22] ✅    ✅ Text extracted using pdfplumber (15530 chars)
[17:33:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:33:26] ℹ️  AI extracted raw sex value: 'F'
[17:33:26] ℹ️  AI extracted service line: 'PT, OT'
[17:33:26] ℹ️  AI extracted payer source: 'Medicare'
[17:33:26] ℹ️  AI extracted diagnoses:
[17:33:26] ℹ️    - Diagnosis 1: 'I69.354'
[17:33:26] ℹ️    - Diagnosis 2: 'E78.00'
[17:33:26] ℹ️    - Diagnosis 3: 'L20.9'
[17:33:26] ℹ️    - Diagnosis 4: 'L28.0'
[17:33:26] ℹ️    - Diagnosis 5: 'I12.9'
[17:33:26] ℹ️    - Diagnosis 6: 'N18.30'
[17:33:26] ℹ️  Final extracted MRN: 'MA230120082705'
[17:33:26] ℹ️  Final extracted Sex: 'FEMALE'
[17:33:26] ℹ️  Final extracted Service Line: 'PT, OT'
[17:33:26] ℹ️  Final extracted Payer Source: 'Medicare'
[17:33:26] ✅ Patient data extraction completed successfully
[17:33:26] ✅    ✅ Patient data extracted successfully
[17:33:26] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9', 'fourthDiagnosis': 'L28.0', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.30'}]
[17:33:26] ✅    ✅ Patient identified: Irene Copley
[17:33:26] ✅    ✅ Patient name validation passed
[17:33:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:33:26] [DOC: 9206175] ℹ️  DOB normalized: 08/04/1927
[17:33:26] [DOC: 9206175] ℹ️  Episode startOfCare normalized: 01/26/2025
[17:33:26] [DOC: 9206175] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[17:33:26] [DOC: 9206175] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[17:33:26] [DOC: 9206175] ✅ Patient date processing completed successfully
[17:33:26] ✅    ✅ Date processing completed
[17:33:26] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9', 'fourthDiagnosis': 'L28.0', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.30'}]
[17:33:26] 🔄 
🔄 Step 4: Extracting order data...
[17:33:29] ℹ️  Order extraction - MRN: 'MA230120082705'
[17:33:29] ℹ️  Order extraction - Sex: 'FEMALE'
[17:33:29] ℹ️  Order extraction - Service Line: 'PT, OT'
[17:33:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:33:29] ✅ Order data extraction completed successfully
[17:33:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:33:29] ℹ️  Using MRN from patient data: 'MA230120082705' over 'MA230120082705'
[17:33:29] ℹ️  Service line consistent in both sources: 'PT, OT'
[17:33:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:33:29] ✅ Patient name cross-validation successful
[17:33:29] ✅    ✅ Data merged successfully
[17:33:31] ✅    ✅ Order data extracted and validated
[17:33:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:33:31] [DOC: 9206175] ✅ Patient found in local cache: Irene Copley, ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[17:33:31] ✅    ✅ Existing patient found with ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[17:33:31] 🔄 
🔄 Step 6: Pushing order to API...
[17:33:31] [DOC: 9206175] ℹ️  Pushing order via API for patient ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[17:33:32] [DOC: 9206175] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13529"}
[17:33:32] ❌    ❌ Failed to push order
[17:33:32] 🔄 
🔄 Step 7: Writing to CSV...
[17:33:32] [DOC: 9206175] ℹ️  Calculated age: 97 from DOB: 08/04/1927
[17:33:32] [DOC: 9206175] ℹ️  Service Line extracted: 'PT, OT'
[17:33:32] [DOC: 9206175] ℹ️  Payer Source extracted: 'Medicare'
[17:33:32] [DOC: 9206175] ℹ️  Diagnosis codes being written:
[17:33:32] [DOC: 9206175] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[17:33:32] [DOC: 9206175] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.00'
[17:33:32] [DOC: 9206175] ℹ️    - Latest_Episode_Thirddiagnosis: 'L20.9'
[17:33:32] [DOC: 9206175] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L28.0'
[17:33:32] [DOC: 9206175] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[17:33:32] [DOC: 9206175] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.30'
[17:33:32] [DOC: 9206175] ✅ Patient data written to CSV: Irene Copley | Sex: FEMALE | Age: 97 | Service: PT, OT | Payer: Medicare | MRN: MA230120082705
[17:33:32] ✅    ✅ Document 9206175 processed and saved successfully
[17:33:32] 🔄 
🔄 Step 8: Saving API details...
[17:33:32] [DOC: 9206175] ℹ️  API push details saved for document 9206175
[17:33:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206097                         ║
================================================================================
[17:33:32] ℹ️  Agency: Nizhoni Health-Fall River
[17:33:32] ℹ️  Date: 03/27/2025
[17:33:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:33:51] [DOC: 9206097] ✅ Text extracted using pdfplumber (5573 chars)
[17:33:51] ✅    ✅ Text extracted using pdfplumber (5573 chars)
[17:33:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:33:54] ℹ️  AI extracted raw sex value: 'M'
[17:33:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:33:54] ℹ️  AI extracted payer source: 'Medicaid/MA'
[17:33:54] ℹ️  AI extracted diagnoses:
[17:33:54] ℹ️    - Diagnosis 1: 'F20.9'
[17:33:54] ℹ️    - Diagnosis 2: 'F25.0'
[17:33:54] ℹ️    - Diagnosis 3: 'E11.9'
[17:33:54] ℹ️    - Diagnosis 4: 'I10'
[17:33:54] ℹ️    - Diagnosis 5: 'None'
[17:33:54] ℹ️    - Diagnosis 6: 'None'
[17:33:54] ℹ️  Final extracted MRN: '6281'
[17:33:54] ℹ️  Final extracted Sex: 'MALE'
[17:33:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:33:54] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[17:33:54] ✅ Patient data extraction completed successfully
[17:33:54] ✅    ✅ Patient data extracted successfully
[17:33:54] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Leiriao
     └─ dob: 04/18/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 6281
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 240 Alden Rd.
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F25.0', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:33:54] ✅    ✅ Patient identified: John Leiriao
[17:33:54] ✅    ✅ Patient name validation passed
[17:33:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:33:54] [DOC: 9206097] ℹ️  DOB normalized: 04/18/1964
[17:33:54] [DOC: 9206097] ℹ️  Episode startOfCare normalized: 11/25/2024
[17:33:54] [DOC: 9206097] ℹ️  Episode startOfEpisode normalized: 01/24/2025
[17:33:54] [DOC: 9206097] ℹ️  Episode endOfEpisode normalized: 03/24/2025
[17:33:54] [DOC: 9206097] ✅ Patient date processing completed successfully
[17:33:54] ✅    ✅ Date processing completed
[17:33:54] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Leiriao
     └─ dob: 04/18/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 6281
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 240 Alden Rd.
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F25.0', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10'}]
[17:33:54] 🔄 
🔄 Step 4: Extracting order data...
[17:33:57] ℹ️  Order extraction - MRN: '6281'
[17:33:57] ℹ️  Order extraction - Sex: 'MALE'
[17:33:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:33:57] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[17:33:57] ✅ Order data extraction completed successfully
[17:33:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:33:57] ℹ️  Using MRN from patient data: '6281' over '6281'
[17:33:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:33:57] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[17:33:57] ✅ Patient name cross-validation successful
[17:33:57] ✅    ✅ Data merged successfully
[17:33:58] ✅    ✅ Order data extracted and validated
[17:33:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:34:38] [DOC: 9206097] ✅ Patient exists in API: John Leiriao, ID: b1bfe056-b1dc-4acb-9bfb-cb7925d0159b
[17:34:38] ✅    ✅ Existing patient found with ID: b1bfe056-b1dc-4acb-9bfb-cb7925d0159b
[17:34:38] 🔄 
🔄 Step 6: Pushing order to API...
[17:34:38] [DOC: 9206097] ℹ️  Pushing order via API for patient ID: b1bfe056-b1dc-4acb-9bfb-cb7925d0159b
[17:34:39] [DOC: 9206097] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:34:39] ❌    ❌ Failed to push order
[17:34:39] 🔄 
🔄 Step 7: Writing to CSV...
[17:34:39] [DOC: 9206097] ℹ️  Calculated age: 61 from DOB: 04/18/1964
[17:34:39] [DOC: 9206097] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:34:39] [DOC: 9206097] ℹ️  Payer Source extracted: 'Medicaid/MA'
[17:34:39] [DOC: 9206097] ℹ️  Diagnosis codes being written:
[17:34:39] [DOC: 9206097] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[17:34:39] [DOC: 9206097] ℹ️    - Latest_Episode_Seconddiagnosis: 'F25.0'
[17:34:39] [DOC: 9206097] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[17:34:39] [DOC: 9206097] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[17:34:39] [DOC: 9206097] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:34:39] [DOC: 9206097] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:34:39] [DOC: 9206097] ✅ Patient data written to CSV: John Leiriao | Sex: MALE | Age: 61 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 6281
[17:34:39] ✅    ✅ Document 9206097 processed and saved successfully
[17:34:39] 🔄 
🔄 Step 8: Saving API details...
[17:34:39] [DOC: 9206097] ℹ️  API push details saved for document 9206097
[17:34:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206015                         ║
================================================================================
[17:34:39] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:34:39] ℹ️  Date: 03/27/2025
[17:34:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:34:42] [DOC: 9206015] ✅ Text extracted using pdfplumber (6601 chars)
[17:34:42] ✅    ✅ Text extracted using pdfplumber (6601 chars)
[17:34:42] 🔄 
🔄 Step 2: Extracting patient data...
[17:34:45] ℹ️  AI extracted raw sex value: 'F'
[17:34:45] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[17:34:45] ℹ️  AI extracted payer source: ''
[17:34:45] ℹ️  AI extracted diagnoses:
[17:34:45] ℹ️    - Diagnosis 1: 'F31.10'
[17:34:45] ℹ️    - Diagnosis 2: 'F41.1'
[17:34:45] ℹ️    - Diagnosis 3: 'E11.40'
[17:34:45] ℹ️    - Diagnosis 4: 'I10'
[17:34:45] ℹ️    - Diagnosis 5: 'E66.01'
[17:34:45] ℹ️    - Diagnosis 6: 'M17.0'
[17:34:45] ℹ️  Final extracted MRN: '253005'
[17:34:45] ℹ️  Final extracted Sex: 'FEMALE'
[17:34:45] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[17:34:45] ℹ️  Final extracted Payer Source: ''
[17:34:45] ✅ Patient data extraction completed successfully
[17:34:45] ✅    ✅ Patient data extracted successfully
[17:34:45] 📊 Patient Response
     └─ patientFName: N/A
     └─ patientLName: N/A
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 227504
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': '12/16/2021', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F31.10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'M17.0'}]
[17:34:45] ✅    ✅ Patient identified: N/A N/A
[17:34:45] ✅    ✅ Patient name validation passed
[17:34:45] 🔄 
🔄 Step 3: Processing patient dates...
[17:34:45] [DOC: 9206015] ℹ️  DOB normalized: 04/22/1971
[17:34:45] [DOC: 9206015] ℹ️  Episode startOfCare normalized: 12/16/2021
[17:34:45] [DOC: 9206015] ℹ️  Episode startOfEpisode normalized: 12/16/2021
[17:34:45] [DOC: 9206015] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[17:34:45] [DOC: 9206015] ✅ Patient date processing completed successfully
[17:34:45] ✅    ✅ Date processing completed
[17:34:45] 📊 Processed Patient Data
     └─ patientFName: N/A
     └─ patientLName: N/A
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 227504
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': '12/16/2021', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'F31.10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'M17.0'}]
[17:34:45] 🔄 
🔄 Step 4: Extracting order data...
[17:34:47] ℹ️  Order extraction - MRN: '253005'
[17:34:47] ℹ️  Order extraction - Sex: 'FEMALE'
[17:34:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:34:47] ℹ️  Order extraction - Payer Source: ''
[17:34:47] ✅ Order data extraction completed successfully
[17:34:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:34:47] ℹ️  Using MRN from patient data: '253005' over '253005'
[17:34:47] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[17:34:47] ⚠️  Patient name mismatch: Order='Fernandes, Versana' vs Patient='N/A N/A'
[17:34:47] ✅    ✅ Data merged successfully
[17:34:49] ✅    ✅ Order data extracted and validated
[17:34:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:34:49] [DOC: 9206015] ✅ Patient found in local cache: N/A N/A, ID: e9629652-0bca-412d-8c30-df4a73e9513b
[17:34:49] ✅    ✅ Existing patient found with ID: e9629652-0bca-412d-8c30-df4a73e9513b
[17:34:49] 🔄 
🔄 Step 6: Pushing order to API...
[17:34:49] [DOC: 9206015] ℹ️  Pushing order via API for patient ID: e9629652-0bca-412d-8c30-df4a73e9513b
[17:34:50] [DOC: 9206015] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13975"}
[17:34:50] ❌    ❌ Failed to push order
[17:34:50] 🔄 
🔄 Step 7: Writing to CSV...
[17:34:50] [DOC: 9206015] ℹ️  Calculated age: 54 from DOB: 04/22/1971
[17:34:50] [DOC: 9206015] ℹ️  Service Line extracted: 'Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[17:34:50] [DOC: 9206015] ℹ️  Payer Source extracted: ''
[17:34:50] [DOC: 9206015] ℹ️  Diagnosis codes being written:
[17:34:50] [DOC: 9206015] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.10'
[17:34:50] [DOC: 9206015] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[17:34:50] [DOC: 9206015] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[17:34:50] [DOC: 9206015] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[17:34:50] [DOC: 9206015] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.01'
[17:34:50] [DOC: 9206015] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M17.0'
[17:34:50] [DOC: 9206015] ✅ Patient data written to CSV: N/A N/A | Sex: FEMALE | Age: 54 | Service: Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 253005
[17:34:50] ✅    ✅ Document 9206015 processed and saved successfully
[17:34:50] 🔄 
🔄 Step 8: Saving API details...
[17:34:50] [DOC: 9206015] ℹ️  API push details saved for document 9206015
[17:34:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205914                         ║
================================================================================
[17:34:50] ℹ️  Agency: Fairhaven HH&H
[17:34:50] ℹ️  Date: 03/27/2025
[17:34:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:34:52] [DOC: 9205914] ✅ Text extracted using pdfplumber (1170 chars)
[17:34:52] ✅    ✅ Text extracted using pdfplumber (1170 chars)
[17:34:52] 🔄 
🔄 Step 2: Extracting patient data...
[17:34:55] ℹ️  AI extracted raw sex value: 'M'
[17:34:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:34:55] ℹ️  AI extracted payer source: 'Medicare'
[17:34:55] ℹ️  AI extracted diagnoses:
[17:34:55] ℹ️    - Diagnosis 1: 'None'
[17:34:55] ℹ️    - Diagnosis 2: 'None'
[17:34:55] ℹ️    - Diagnosis 3: 'None'
[17:34:55] ℹ️    - Diagnosis 4: 'None'
[17:34:55] ℹ️    - Diagnosis 5: 'None'
[17:34:55] ℹ️    - Diagnosis 6: 'None'
[17:34:55] ℹ️  Final extracted MRN: '5021009'
[17:34:55] ℹ️  Final extracted Sex: 'MALE'
[17:34:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:34:55] ℹ️  Final extracted Payer Source: 'Medicare'
[17:34:55] ✅ Patient data extraction completed successfully
[17:34:55] ✅    ✅ Patient data extracted successfully
[17:34:55] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:34:55] ✅    ✅ Patient identified: William Hughes
[17:34:55] ✅    ✅ Patient name validation passed
[17:34:55] 🔄 
🔄 Step 3: Processing patient dates...
[17:34:55] [DOC: 9205914] ℹ️  DOB normalized: 07/10/1937
[17:34:55] [DOC: 9205914] ℹ️  Episode startOfCare normalized: 11/20/2024
[17:34:55] [DOC: 9205914] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[17:34:55] [DOC: 9205914] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[17:34:55] [DOC: 9205914] ✅ Patient date processing completed successfully
[17:34:55] ✅    ✅ Date processing completed
[17:34:55] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025'}]
[17:34:55] 🔄 
🔄 Step 4: Extracting order data...
[17:34:58] ℹ️  Order extraction - MRN: '5021009'
[17:34:58] ℹ️  Order extraction - Sex: 'MALE'
[17:34:58] ℹ️  Order extraction - Service Line: 'RN'
[17:34:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:34:58] ✅ Order data extraction completed successfully
[17:34:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:34:58] ℹ️  Using MRN from patient data: '5021009' over '5021009'
[17:34:58] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[17:34:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:34:58] ✅ Patient name cross-validation successful
[17:34:58] ✅    ✅ Data merged successfully
[17:34:59] ✅    ✅ Order data extracted and validated
[17:34:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:35:20] [DOC: 9205914] ℹ️  Patient not found in cache or API: William Hughes
[17:35:20] [DOC: 9205914] ℹ️  Patient not found, creating new patient via API...
[17:35:20] [DOC: 9205914] ℹ️  Creating patient via API: William Hughes
[17:35:21] [DOC: 9205914] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:35:21] ❌    ❌ Failed to create patient
[17:35:21] [DOC: 9205914] ℹ️  API push details saved for document 9205914
================================================================================
║                        Processing Document ID: 9205898                         ║
================================================================================
[17:35:21] ℹ️  Agency: Compassionate Care Hospice-Taunton
[17:35:21] ℹ️  Date: 03/27/2025
[17:35:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:35:24] [DOC: 9205898] ✅ Text extracted using pdfplumber (1583 chars)
[17:35:24] ✅    ✅ Text extracted using pdfplumber (1571 chars)
[17:35:24] 🔄 
🔄 Step 2: Extracting patient data...
[17:35:26] ℹ️  AI extracted raw sex value: ''
[17:35:26] ℹ️  AI extracted service line: 'Hospice'
[17:35:26] ℹ️  AI extracted payer source: 'Medicare'
[17:35:26] ℹ️  AI extracted diagnoses:
[17:35:26] ℹ️    - Diagnosis 1: ''
[17:35:26] ℹ️    - Diagnosis 2: ''
[17:35:26] ℹ️    - Diagnosis 3: ''
[17:35:26] ℹ️    - Diagnosis 4: ''
[17:35:26] ℹ️    - Diagnosis 5: ''
[17:35:26] ℹ️    - Diagnosis 6: ''
[17:35:26] ℹ️  Final extracted MRN: 'B3700255994202'
[17:35:26] ℹ️  Final extracted Sex: ''
[17:35:26] ℹ️  Final extracted Service Line: 'Hospice'
[17:35:26] ℹ️  Final extracted Payer Source: 'Medicare'
[17:35:26] ✅ Patient data extraction completed successfully
[17:35:26] ✅    ✅ Patient data extracted successfully
[17:35:26] 📊 Patient Response
     └─ patientFName: PATRICIA
     └─ patientLName: SWANSON
     └─ dob: 09/16/1940
     └─ patientSex: 
     └─ medicalRecordNo: B3700255994202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:35:26] ✅    ✅ Patient identified: PATRICIA SWANSON
[17:35:26] ✅    ✅ Patient name validation passed
[17:35:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:35:26] [DOC: 9205898] ℹ️  DOB normalized: 09/16/1940
[17:35:26] [DOC: 9205898] ✅ Patient date processing completed successfully
[17:35:26] ✅    ✅ Date processing completed
[17:35:26] 📊 Processed Patient Data
     └─ patientFName: PATRICIA
     └─ patientLName: SWANSON
     └─ dob: 09/16/1940
     └─ patientSex: 
     └─ medicalRecordNo: B3700255994202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:35:26] 🔄 
🔄 Step 4: Extracting order data...
[17:35:29] ℹ️  Order extraction - MRN: 'B3700255994202'
[17:35:29] ℹ️  Order extraction - Sex: ''
[17:35:29] ℹ️  Order extraction - Service Line: 'Hospice'
[17:35:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:35:29] ✅ Order data extraction completed successfully
[17:35:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:35:29] ℹ️  Using MRN from patient data: 'B3700255994202' over 'B3700255994202'
[17:35:29] ℹ️  Inferred sex as FEMALE from name: PATRICIA
[17:35:29] ℹ️  Service line consistent in both sources: 'Hospice'
[17:35:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:35:29] ✅ Patient name cross-validation successful
[17:35:29] ✅    ✅ Data merged successfully
[17:35:31] ✅    ✅ Order data extracted and validated
[17:35:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:36:07] [DOC: 9205898] ℹ️  Patient not found in cache or API: PATRICIA SWANSON
[17:36:07] [DOC: 9205898] ℹ️  Patient not found, creating new patient via API...
[17:36:07] [DOC: 9205898] ℹ️  Creating patient via API: PATRICIA SWANSON
[17:36:09] [DOC: 9205898] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:36:09] ❌    ❌ Failed to create patient
[17:36:09] [DOC: 9205898] ℹ️  API push details saved for document 9205898
================================================================================
║                        Processing Document ID: 9205856                         ║
================================================================================
[17:36:09] ℹ️  Agency: Dartmouth HH
[17:36:09] ℹ️  Date: 03/27/2025
[17:36:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:36:12] [DOC: 9205856] ✅ Text extracted using pdfplumber (11798 chars)
[17:36:12] ✅    ✅ Text extracted using pdfplumber (11798 chars)
[17:36:12] 🔄 
🔄 Step 2: Extracting patient data...
[17:36:15] ℹ️  AI extracted raw sex value: 'F'
[17:36:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:36:15] ℹ️  AI extracted payer source: 'None'
[17:36:15] ℹ️  AI extracted diagnoses:
[17:36:15] ℹ️    - Diagnosis 1: 'I13.0'
[17:36:15] ℹ️    - Diagnosis 2: 'I50.32'
[17:36:15] ℹ️    - Diagnosis 3: 'N18.31'
[17:36:15] ℹ️    - Diagnosis 4: 'L89.322'
[17:36:15] ℹ️    - Diagnosis 5: 'L89.891'
[17:36:15] ℹ️    - Diagnosis 6: 'J44.9'
[17:36:15] ℹ️  Final extracted MRN: '3177001'
[17:36:15] ℹ️  Final extracted Sex: 'FEMALE'
[17:36:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:36:15] ℹ️  Final extracted Payer Source: ''
[17:36:15] ✅ Patient data extraction completed successfully
[17:36:15] ✅    ✅ Patient data extracted successfully
[17:36:15] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100204971772
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'L89.322', 'fifthDiagnosis': 'L89.891', 'sixthDiagnosis': 'J44.9'}]
[17:36:15] ✅    ✅ Patient identified: Dorothy Lynch
[17:36:15] ✅    ✅ Patient name validation passed
[17:36:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:36:15] [DOC: 9205856] ℹ️  DOB normalized: 03/16/1932
[17:36:15] [DOC: 9205856] ℹ️  Episode startOfCare normalized: 03/12/2025
[17:36:15] [DOC: 9205856] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:36:15] [DOC: 9205856] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[17:36:15] [DOC: 9205856] ✅ Patient date processing completed successfully
[17:36:15] ✅    ✅ Date processing completed
[17:36:15] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100204971772
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'L89.322', 'fifthDiagnosis': 'L89.891', 'sixthDiagnosis': 'J44.9'}]
[17:36:15] 🔄 
🔄 Step 4: Extracting order data...
[17:36:18] ℹ️  Order extraction - MRN: '3177001'
[17:36:18] ℹ️  Order extraction - Sex: 'FEMALE'
[17:36:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:36:18] ℹ️  Order extraction - Payer Source: ''
[17:36:18] ✅ Order data extraction completed successfully
[17:36:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:36:18] ℹ️  Using MRN from patient data: '3177001' over '3177001'
[17:36:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:36:18] ✅ Patient name cross-validation successful
[17:36:18] ✅    ✅ Data merged successfully
[17:36:19] ✅    ✅ Order data extracted and validated
[17:36:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:36:19] [DOC: 9205856] ✅ Patient found in local cache: Dorothy Lynch, ID: d21b3eef-f066-47f0-b26e-3663176af82f
[17:36:19] ✅    ✅ Existing patient found with ID: d21b3eef-f066-47f0-b26e-3663176af82f
[17:36:19] 🔄 
🔄 Step 6: Pushing order to API...
[17:36:19] [DOC: 9205856] ℹ️  Pushing order via API for patient ID: d21b3eef-f066-47f0-b26e-3663176af82f
[17:36:20] [DOC: 9205856] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:36:20] ❌    ❌ Failed to push order
[17:36:20] 🔄 
🔄 Step 7: Writing to CSV...
[17:36:20] [DOC: 9205856] ℹ️  Calculated age: 93 from DOB: 03/16/1932
[17:36:20] [DOC: 9205856] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:36:20] [DOC: 9205856] ℹ️  Payer Source extracted: ''
[17:36:20] [DOC: 9205856] ℹ️  Diagnosis codes being written:
[17:36:20] [DOC: 9205856] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[17:36:20] [DOC: 9205856] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[17:36:20] [DOC: 9205856] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[17:36:20] [DOC: 9205856] ℹ️    - Latest_Episode_Fourthdiagnosis: 'L89.322'
[17:36:20] [DOC: 9205856] ℹ️    - Latest_Episode_Fifthdiagnosis: 'L89.891'
[17:36:20] [DOC: 9205856] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J44.9'
[17:36:20] [DOC: 9205856] ✅ Patient data written to CSV: Dorothy Lynch | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 3177001
[17:36:20] ✅    ✅ Document 9205856 processed and saved successfully
[17:36:20] 🔄 
🔄 Step 8: Saving API details...
[17:36:20] [DOC: 9205856] ℹ️  API push details saved for document 9205856
[17:36:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205854                         ║
================================================================================
[17:36:20] ℹ️  Agency: Nizhoni Health-Fall River
[17:36:20] ℹ️  Date: 03/27/2025
[17:36:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:36:38] [DOC: 9205854] ✅ Text extracted using pdfplumber (12487 chars)
[17:36:38] ✅    ✅ Text extracted using pdfplumber (12487 chars)
[17:36:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:36:41] ℹ️  AI extracted raw sex value: 'M'
[17:36:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:36:41] ℹ️  AI extracted payer source: 'None'
[17:36:41] ℹ️  AI extracted diagnoses:
[17:36:41] ℹ️    - Diagnosis 1: 'F20.9'
[17:36:41] ℹ️    - Diagnosis 2: 'F32.9'
[17:36:41] ℹ️    - Diagnosis 3: 'F39'
[17:36:41] ℹ️    - Diagnosis 4: 'I10'
[17:36:41] ℹ️    - Diagnosis 5: 'K21.9'
[17:36:41] ℹ️    - Diagnosis 6: 'Z79.899'
[17:36:41] ℹ️  Final extracted MRN: '7864'
[17:36:41] ℹ️  Final extracted Sex: 'MALE'
[17:36:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:36:41] ℹ️  Final extracted Payer Source: ''
[17:36:41] ✅ Patient data extraction completed successfully
[17:36:41] ✅    ✅ Patient data extracted successfully
[17:36:41] 📊 Patient Response
     └─ patientFName: Gary
     └─ patientLName: Pierce
     └─ dob: 07/14/1967
     └─ patientSex: MALE
     └─ medicalRecordNo: 7864
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/12/2016', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F32.9', 'thirdDiagnosis': 'F39', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'Z79.899'}]
[17:36:41] ✅    ✅ Patient identified: Gary Pierce
[17:36:41] ✅    ✅ Patient name validation passed
[17:36:41] 🔄 
🔄 Step 3: Processing patient dates...
[17:36:41] [DOC: 9205854] ℹ️  DOB normalized: 07/14/1967
[17:36:41] [DOC: 9205854] ℹ️  Episode startOfCare normalized: 09/12/2016
[17:36:41] [DOC: 9205854] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[17:36:41] [DOC: 9205854] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[17:36:41] [DOC: 9205854] ✅ Patient date processing completed successfully
[17:36:41] ✅    ✅ Date processing completed
[17:36:41] 📊 Processed Patient Data
     └─ patientFName: Gary
     └─ patientLName: Pierce
     └─ dob: 07/14/1967
     └─ patientSex: MALE
     └─ medicalRecordNo: 7864
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/12/2016', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F32.9', 'thirdDiagnosis': 'F39', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'Z79.899'}]
[17:36:41] 🔄 
🔄 Step 4: Extracting order data...
[17:36:44] ℹ️  Order extraction - MRN: '7864'
[17:36:44] ℹ️  Order extraction - Sex: 'MALE'
[17:36:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:36:44] ℹ️  Order extraction - Payer Source: ''
[17:36:44] ✅ Order data extraction completed successfully
[17:36:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:36:44] ℹ️  Using MRN from patient data: '7864' over '7864'
[17:36:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:36:44] ✅ Patient name cross-validation successful
[17:36:44] ✅    ✅ Data merged successfully
[17:36:45] ✅    ✅ Order data extracted and validated
[17:36:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:36:53] [DOC: 9205854] ℹ️  Patient not found in cache or API: Gary Pierce
[17:36:53] [DOC: 9205854] ℹ️  Patient not found, creating new patient via API...
[17:36:53] [DOC: 9205854] ℹ️  Creating patient via API: Gary Pierce
[17:36:54] [DOC: 9205854] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:36:54] ❌    ❌ Failed to create patient
[17:36:54] [DOC: 9205854] ℹ️  API push details saved for document 9205854
================================================================================
║                        Processing Document ID: 9205834                         ║
================================================================================
[17:36:54] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:36:54] ℹ️  Date: 03/27/2025
[17:36:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:36:56] [DOC: 9205834] ✅ Text extracted using pdfplumber (5197 chars)
[17:36:56] ✅    ✅ Text extracted using pdfplumber (5197 chars)
[17:36:56] 🔄 
🔄 Step 2: Extracting patient data...
[17:36:58] ℹ️  AI extracted raw sex value: ''
[17:36:58] ℹ️  AI extracted service line: ''
[17:36:58] ℹ️  AI extracted payer source: ''
[17:36:58] ℹ️  AI extracted diagnoses:
[17:36:58] ℹ️    - Diagnosis 1: ''
[17:36:58] ℹ️    - Diagnosis 2: ''
[17:36:58] ℹ️    - Diagnosis 3: ''
[17:36:58] ℹ️    - Diagnosis 4: ''
[17:36:58] ℹ️    - Diagnosis 5: ''
[17:36:58] ℹ️    - Diagnosis 6: ''
[17:36:58] ℹ️  Final extracted MRN: ''
[17:36:58] ℹ️  Final extracted Sex: ''
[17:36:58] ℹ️  Final extracted Service Line: ''
[17:36:58] ℹ️  Final extracted Payer Source: ''
[17:36:58] ✅ Patient data extraction completed successfully
[17:36:58] ✅    ✅ Patient data extracted successfully
[17:36:58] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:36:58] ⚠️     ❌ Insufficient patient data extracted
[17:36:58] [DOC: 9205834] ℹ️  API push details saved for document 9205834
================================================================================
║                        Processing Document ID: 9205833                         ║
================================================================================
[17:36:58] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:36:58] ℹ️  Date: 03/27/2025
[17:36:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:01] [DOC: 9205833] ✅ Text extracted using pdfplumber (68506 chars)
[17:37:01] ✅    ✅ Text extracted using pdfplumber (68506 chars)
[17:37:01] 🔄 
🔄 Step 2: Extracting patient data...
[17:37:05] ℹ️  AI extracted raw sex value: ''
[17:37:05] ℹ️  AI extracted service line: ''
[17:37:05] ℹ️  AI extracted payer source: ''
[17:37:05] ℹ️  AI extracted diagnoses:
[17:37:05] ℹ️    - Diagnosis 1: ''
[17:37:05] ℹ️    - Diagnosis 2: ''
[17:37:05] ℹ️    - Diagnosis 3: ''
[17:37:05] ℹ️    - Diagnosis 4: ''
[17:37:05] ℹ️    - Diagnosis 5: ''
[17:37:05] ℹ️    - Diagnosis 6: ''
[17:37:05] ℹ️  Final extracted MRN: ''
[17:37:05] ℹ️  Final extracted Sex: ''
[17:37:05] ℹ️  Final extracted Service Line: ''
[17:37:05] ℹ️  Final extracted Payer Source: ''
[17:37:05] ✅ Patient data extraction completed successfully
[17:37:05] ✅    ✅ Patient data extracted successfully
[17:37:05] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[17:37:05] ⚠️     ❌ Insufficient patient data extracted
[17:37:05] [DOC: 9205833] ℹ️  API push details saved for document 9205833
================================================================================
║                        Processing Document ID: 2166080                         ║
================================================================================
[17:37:05] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:37:05] ℹ️  Date: 03/26/2025
[17:37:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:07] [DOC: 2166080] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:07] ❌ Failed to extract text for Doc ID 2166080
[17:37:07] [DOC: 2166080] ℹ️  API push details saved for document 2166080
================================================================================
║                        Processing Document ID: 2166079                         ║
================================================================================
[17:37:07] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:37:07] ℹ️  Date: 03/26/2025
[17:37:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:08] [DOC: 2166079] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:08] ❌ Failed to extract text for Doc ID 2166079
[17:37:08] [DOC: 2166079] ℹ️  API push details saved for document 2166079
================================================================================
║                        Processing Document ID: 2166078                         ║
================================================================================
[17:37:08] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:37:08] ℹ️  Date: 03/26/2025
[17:37:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:09] [DOC: 2166078] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:09] ❌ Failed to extract text for Doc ID 2166078
[17:37:09] [DOC: 2166078] ℹ️  API push details saved for document 2166078
================================================================================
║                        Processing Document ID: 2166074                         ║
================================================================================
[17:37:09] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:37:09] ℹ️  Date: 03/26/2025
[17:37:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:10] [DOC: 2166074] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:10] ❌ Failed to extract text for Doc ID 2166074
[17:37:10] [DOC: 2166074] ℹ️  API push details saved for document 2166074
================================================================================
║                        Processing Document ID: 9205138                         ║
================================================================================
[17:37:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:37:10] ℹ️  Date: 03/26/2025
[17:37:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:12] [DOC: 9205138] ✅ Text extracted using pdfplumber (1281 chars)
[17:37:12] ✅    ✅ Text extracted using pdfplumber (1281 chars)
[17:37:12] 🔄 
🔄 Step 2: Extracting patient data...
[17:37:15] ℹ️  AI extracted raw sex value: ''
[17:37:15] ℹ️  AI extracted service line: 'PT'
[17:37:15] ℹ️  AI extracted payer source: ''
[17:37:15] ℹ️  AI extracted diagnoses:
[17:37:15] ℹ️    - Diagnosis 1: 'M54.32'
[17:37:15] ℹ️    - Diagnosis 2: 'I12.9'
[17:37:15] ℹ️    - Diagnosis 3: 'E11.22'
[17:37:15] ℹ️    - Diagnosis 4: 'None'
[17:37:15] ℹ️    - Diagnosis 5: 'None'
[17:37:15] ℹ️    - Diagnosis 6: 'None'
[17:37:15] ℹ️  Final extracted MRN: 'MA220126074307'
[17:37:15] ℹ️  Final extracted Sex: ''
[17:37:15] ℹ️  Final extracted Service Line: 'PT'
[17:37:15] ℹ️  Final extracted Payer Source: ''
[17:37:15] ✅ Patient data extraction completed successfully
[17:37:15] ✅    ✅ Patient data extracted successfully
[17:37:15] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:37:15] ✅    ✅ Patient identified: Manuel Furtado
[17:37:15] ✅    ✅ Patient name validation passed
[17:37:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:37:15] [DOC: 9205138] ℹ️  DOB normalized: 07/13/1943
[17:37:15] [DOC: 9205138] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[17:37:15] [DOC: 9205138] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[17:37:15] [DOC: 9205138] ✅ Patient date processing completed successfully
[17:37:15] ✅    ✅ Date processing completed
[17:37:15] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: DILMA SILVA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22'}]
[17:37:15] 🔄 
🔄 Step 4: Extracting order data...
[17:37:18] ℹ️  Order extraction - MRN: 'MA220126074307'
[17:37:18] ℹ️  Order extraction - Sex: ''
[17:37:18] ℹ️  Order extraction - Service Line: 'PT'
[17:37:18] ℹ️  Order extraction - Payer Source: ''
[17:37:18] ✅ Order data extraction completed successfully
[17:37:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:37:18] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[17:37:18] ⚠️  Could not determine sex using any available method
[17:37:18] ℹ️  Service line consistent in both sources: 'PT'
[17:37:18] ✅ Patient name cross-validation successful
[17:37:18] ✅    ✅ Data merged successfully
[17:37:19] ✅    ✅ Order data extracted and validated
[17:37:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:37:19] [DOC: 9205138] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[17:37:19] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[17:37:19] 🔄 
🔄 Step 6: Pushing order to API...
[17:37:19] [DOC: 9205138] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[17:37:20] [DOC: 9205138] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13015"}
[17:37:20] ❌    ❌ Failed to push order
[17:37:20] 🔄 
🔄 Step 7: Writing to CSV...
[17:37:20] [DOC: 9205138] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[17:37:20] [DOC: 9205138] ℹ️  Service Line extracted: 'PT'
[17:37:20] [DOC: 9205138] ℹ️  Payer Source extracted: ''
[17:37:20] [DOC: 9205138] ℹ️  Diagnosis codes being written:
[17:37:20] [DOC: 9205138] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.32'
[17:37:20] [DOC: 9205138] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[17:37:20] [DOC: 9205138] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[17:37:20] [DOC: 9205138] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:37:20] [DOC: 9205138] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:37:20] [DOC: 9205138] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:37:20] [DOC: 9205138] ✅ Patient data written to CSV: Manuel Furtado | Sex:  | Age: 81 | Service: PT | Payer:  | MRN: MA220126074307
[17:37:20] ✅    ✅ Document 9205138 processed and saved successfully
[17:37:20] 🔄 
🔄 Step 8: Saving API details...
[17:37:20] [DOC: 9205138] ℹ️  API push details saved for document 9205138
[17:37:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205136                         ║
================================================================================
[17:37:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:37:20] ℹ️  Date: 03/26/2025
[17:37:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:22] [DOC: 9205136] ✅ Text extracted using pdfplumber (13780 chars)
[17:37:22] ✅    ✅ Text extracted using pdfplumber (13780 chars)
[17:37:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:37:26] ℹ️  AI extracted raw sex value: 'M'
[17:37:26] ℹ️  AI extracted service line: 'Physical Therapy'
[17:37:26] ℹ️  AI extracted payer source: 'Medicare'
[17:37:26] ℹ️  AI extracted diagnoses:
[17:37:26] ℹ️    - Diagnosis 1: 'M54.32'
[17:37:26] ℹ️    - Diagnosis 2: 'I12.9'
[17:37:26] ℹ️    - Diagnosis 3: 'E11.22'
[17:37:26] ℹ️    - Diagnosis 4: 'N18.30'
[17:37:26] ℹ️    - Diagnosis 5: 'I25.10'
[17:37:26] ℹ️    - Diagnosis 6: 'N40.1'
[17:37:26] ℹ️  Final extracted MRN: 'MA220126074307'
[17:37:26] ℹ️  Final extracted Sex: 'MALE'
[17:37:26] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:37:26] ℹ️  Final extracted Payer Source: 'Medicare'
[17:37:26] ✅ Patient data extraction completed successfully
[17:37:26] ✅    ✅ Patient data extracted successfully
[17:37:26] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: SILVA, DILMA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 996-1046
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'N40.1'}]
[17:37:26] ✅    ✅ Patient identified: Manuel Furtado
[17:37:26] ✅    ✅ Patient name validation passed
[17:37:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:37:26] [DOC: 9205136] ℹ️  DOB normalized: 07/13/1943
[17:37:26] [DOC: 9205136] ℹ️  Episode startOfCare normalized: 03/20/2025
[17:37:26] [DOC: 9205136] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[17:37:26] [DOC: 9205136] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[17:37:26] [DOC: 9205136] ✅ Patient date processing completed successfully
[17:37:26] ✅    ✅ Date processing completed
[17:37:26] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: SILVA, DILMA MD
     └─ npi: 1487641502
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 996-1046
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M54.32', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'N40.1'}]
[17:37:26] 🔄 
🔄 Step 4: Extracting order data...
[17:37:28] ℹ️  Order extraction - MRN: 'MA220126074307'
[17:37:28] ℹ️  Order extraction - Sex: 'MALE'
[17:37:28] ℹ️  Order extraction - Service Line: 'PT'
[17:37:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:37:28] ✅ Order data extraction completed successfully
[17:37:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:37:28] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[17:37:28] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[17:37:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:37:28] ✅ Patient name cross-validation successful
[17:37:28] ✅    ✅ Data merged successfully
[17:37:29] ✅    ✅ Order data extracted and validated
[17:37:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:37:29] [DOC: 9205136] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[17:37:29] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[17:37:29] 🔄 
🔄 Step 6: Pushing order to API...
[17:37:29] [DOC: 9205136] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[17:37:30] [DOC: 9205136] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13016"}
[17:37:30] ❌    ❌ Failed to push order
[17:37:30] 🔄 
🔄 Step 7: Writing to CSV...
[17:37:30] [DOC: 9205136] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[17:37:30] [DOC: 9205136] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[17:37:30] [DOC: 9205136] ℹ️  Payer Source extracted: 'Medicare'
[17:37:30] [DOC: 9205136] ℹ️  Diagnosis codes being written:
[17:37:30] [DOC: 9205136] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.32'
[17:37:30] [DOC: 9205136] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[17:37:30] [DOC: 9205136] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[17:37:30] [DOC: 9205136] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[17:37:30] [DOC: 9205136] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[17:37:30] [DOC: 9205136] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[17:37:30] [DOC: 9205136] ✅ Patient data written to CSV: Manuel Furtado | Sex: MALE | Age: 81 | Service: PT, Physical Therapy | Payer: Medicare | MRN: MA220126074307
[17:37:30] ✅    ✅ Document 9205136 processed and saved successfully
[17:37:30] 🔄 
🔄 Step 8: Saving API details...
[17:37:30] [DOC: 9205136] ℹ️  API push details saved for document 9205136
[17:37:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2165940                         ║
================================================================================
[17:37:30] ℹ️  Agency: Brockton Home Health Care
[17:37:30] ℹ️  Date: 03/26/2025
[17:37:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:32] [DOC: 2165940] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:32] ❌ Failed to extract text for Doc ID 2165940
[17:37:32] [DOC: 2165940] ℹ️  API push details saved for document 2165940
================================================================================
║                        Processing Document ID: 2165937                         ║
================================================================================
[17:37:32] ℹ️  Agency: Brockton Home Health Care
[17:37:32] ℹ️  Date: 03/26/2025
[17:37:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:33] [DOC: 2165937] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:33] ❌ Failed to extract text for Doc ID 2165937
[17:37:33] [DOC: 2165937] ℹ️  API push details saved for document 2165937
================================================================================
║                        Processing Document ID: 2165933                         ║
================================================================================
[17:37:33] ℹ️  Agency: Brockton Home Health Care
[17:37:33] ℹ️  Date: 03/26/2025
[17:37:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:34] [DOC: 2165933] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:34] ❌ Failed to extract text for Doc ID 2165933
[17:37:34] [DOC: 2165933] ℹ️  API push details saved for document 2165933
================================================================================
║                        Processing Document ID: 2165932                         ║
================================================================================
[17:37:34] ℹ️  Agency: Brockton Home Health Care
[17:37:34] ℹ️  Date: 03/26/2025
[17:37:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:35] [DOC: 2165932] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:35] ❌ Failed to extract text for Doc ID 2165932
[17:37:35] [DOC: 2165932] ℹ️  API push details saved for document 2165932
================================================================================
║                        Processing Document ID: 2165931                         ║
================================================================================
[17:37:35] ℹ️  Agency: Brockton Home Health Care
[17:37:35] ℹ️  Date: 03/26/2025
[17:37:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:36] [DOC: 2165931] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:36] ❌ Failed to extract text for Doc ID 2165931
[17:37:36] [DOC: 2165931] ℹ️  API push details saved for document 2165931
================================================================================
║                        Processing Document ID: 2165930                         ║
================================================================================
[17:37:36] ℹ️  Agency: Brockton Home Health Care
[17:37:36] ℹ️  Date: 03/26/2025
[17:37:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:38] [DOC: 2165930] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:38] ❌ Failed to extract text for Doc ID 2165930
[17:37:38] [DOC: 2165930] ℹ️  API push details saved for document 2165930
================================================================================
║                        Processing Document ID: 2165929                         ║
================================================================================
[17:37:38] ℹ️  Agency: Brockton Home Health Care
[17:37:38] ℹ️  Date: 03/26/2025
[17:37:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:39] [DOC: 2165929] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:39] ❌ Failed to extract text for Doc ID 2165929
[17:37:39] [DOC: 2165929] ℹ️  API push details saved for document 2165929
================================================================================
║                        Processing Document ID: 2165928                         ║
================================================================================
[17:37:39] ℹ️  Agency: Brockton Home Health Care
[17:37:39] ℹ️  Date: 03/26/2025
[17:37:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:40] [DOC: 2165928] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:40] ❌ Failed to extract text for Doc ID 2165928
[17:37:40] [DOC: 2165928] ℹ️  API push details saved for document 2165928
================================================================================
║                        Processing Document ID: 2165927                         ║
================================================================================
[17:37:40] ℹ️  Agency: Brockton Home Health Care
[17:37:40] ℹ️  Date: 03/26/2025
[17:37:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:41] [DOC: 2165927] ❌ Critical failure in get_pdf_text: Invalid response format
[17:37:41] ❌ Failed to extract text for Doc ID 2165927
[17:37:41] [DOC: 2165927] ℹ️  API push details saved for document 2165927
================================================================================
║                        Processing Document ID: 9205760                         ║
================================================================================
[17:37:41] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[17:37:41] ℹ️  Date: 03/26/2025
[17:37:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:47] [DOC: 9205760] ✅ Text extracted using pdfplumber (32874 chars)
[17:37:47] ✅    ✅ Text extracted using pdfplumber (32874 chars)
[17:37:47] 🔄 
🔄 Step 2: Extracting patient data...
[17:37:50] ℹ️  AI extracted raw sex value: 'M'
[17:37:50] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Speech Therapy'
[17:37:50] ℹ️  AI extracted payer source: 'Medicare'
[17:37:50] ℹ️  AI extracted diagnoses:
[17:37:50] ℹ️    - Diagnosis 1: 'I69.354'
[17:37:50] ℹ️    - Diagnosis 2: 'I69.320'
[17:37:50] ℹ️    - Diagnosis 3: 'I69.322'
[17:37:50] ℹ️    - Diagnosis 4: 'I11.0'
[17:37:50] ℹ️    - Diagnosis 5: 'I50.32'
[17:37:50] ℹ️    - Diagnosis 6: 'E11.9'
[17:37:50] ℹ️  Final extracted MRN: '28700209064601'
[17:37:50] ℹ️  Final extracted Sex: 'MALE'
[17:37:50] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Speech Therapy'
[17:37:50] ℹ️  Final extracted Payer Source: 'Medicare'
[17:37:50] ✅ Patient data extraction completed successfully
[17:37:50] ✅    ✅ Patient data extracted successfully
[17:37:50] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: COUTO
     └─ dob: 09/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209064601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 887 ROCK ODUNDEE RD
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing,Physical Therapy,Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'I69.320', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.9'}]
[17:37:50] ✅    ✅ Patient identified: JOHN COUTO
[17:37:50] ✅    ✅ Patient name validation passed
[17:37:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:37:50] [DOC: 9205760] ℹ️  DOB normalized: 09/27/1950
[17:37:50] [DOC: 9205760] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:37:50] [DOC: 9205760] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[17:37:50] [DOC: 9205760] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[17:37:50] [DOC: 9205760] ✅ Patient date processing completed successfully
[17:37:50] ✅    ✅ Date processing completed
[17:37:50] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: COUTO
     └─ dob: 09/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209064601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 887 ROCK ODUNDEE RD
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing,Physical Therapy,Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'I69.320', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.9'}]
[17:37:50] 🔄 
🔄 Step 4: Extracting order data...
[17:37:53] ℹ️  Order extraction - MRN: '28700209064601'
[17:37:53] ℹ️  Order extraction - Sex: 'MALE'
[17:37:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[17:37:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:37:53] ✅ Order data extraction completed successfully
[17:37:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:37:53] ℹ️  Using MRN from patient data: '28700209064601' over '28700209064601'
[17:37:53] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Speech Therapy' + Order='Skilled Nursing, Physical Therapy, Speech Therapy' = 'Physical Therapy, Skilled Nursing, Speech Therapy'
[17:37:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:37:53] ✅ Patient name cross-validation successful
[17:37:53] ✅    ✅ Data merged successfully
[17:37:55] ✅    ✅ Order data extracted and validated
[17:37:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:37:55] [DOC: 9205760] ✅ Patient found in local cache: JOHN COUTO, ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[17:37:55] ✅    ✅ Existing patient found with ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[17:37:55] 🔄 
🔄 Step 6: Pushing order to API...
[17:37:55] [DOC: 9205760] ℹ️  Pushing order via API for patient ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[17:37:56] [DOC: 9205760] ❌ Order push failed with status 201: {"id":"32faf2b0-4c70-45d8-8d78-683127fb658e","orderWAVId":"ORD20076","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 12249900","orderDate":"03/13/2025","startOfCare":"03/13/2025","episodeStartDate":"03/13/2025","episodeEndDate":"05/11/2025","documentID":"9205760","mrn":"28700209064601","patientName":"JOHN COUTO","sentToPhysicianDate":"03/26/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6a261ab7-0f82-43fd-a5b1-7ae483996ea5","companyId":"532ae690-17f2-4fb0-b9ec-e3ef8634f57d","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:37:56] ❌    ❌ Failed to push order
[17:37:56] 🔄 
🔄 Step 7: Writing to CSV...
[17:37:56] [DOC: 9205760] ℹ️  Calculated age: 74 from DOB: 09/27/1950
[17:37:56] [DOC: 9205760] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing, Speech Therapy'
[17:37:56] [DOC: 9205760] ℹ️  Payer Source extracted: 'Medicare'
[17:37:56] [DOC: 9205760] ℹ️  Diagnosis codes being written:
[17:37:56] [DOC: 9205760] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[17:37:56] [DOC: 9205760] ℹ️    - Latest_Episode_Seconddiagnosis: 'I69.320'
[17:37:56] [DOC: 9205760] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[17:37:56] [DOC: 9205760] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[17:37:56] [DOC: 9205760] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[17:37:56] [DOC: 9205760] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[17:37:56] [DOC: 9205760] ✅ Patient data written to CSV: JOHN COUTO | Sex: MALE | Age: 74 | Service: Physical Therapy, Skilled Nursing, Speech Therapy | Payer: Medicare | MRN: 28700209064601
[17:37:56] ✅    ✅ Document 9205760 processed and saved successfully
[17:37:56] 🔄 
🔄 Step 8: Saving API details...
[17:37:56] [DOC: 9205760] ℹ️  API push details saved for document 9205760
[17:37:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205746                         ║
================================================================================
[17:37:56] ℹ️  Agency: Bayada Home Health Care Inc-Plymouth
[17:37:56] ℹ️  Date: 03/26/2025
[17:37:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:37:59] [DOC: 9205746] ✅ Text extracted using pdfplumber (4531 chars)
[17:37:59] ✅    ✅ Text extracted using pdfplumber (4519 chars)
[17:37:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:38:02] ℹ️  AI extracted raw sex value: ''
[17:38:02] ℹ️  AI extracted service line: 'RN'
[17:38:02] ℹ️  AI extracted payer source: 'Medicare'
[17:38:02] ℹ️  AI extracted diagnoses:
[17:38:02] ℹ️    - Diagnosis 1: ''
[17:38:02] ℹ️    - Diagnosis 2: ''
[17:38:02] ℹ️    - Diagnosis 3: ''
[17:38:02] ℹ️    - Diagnosis 4: ''
[17:38:02] ℹ️    - Diagnosis 5: ''
[17:38:02] ℹ️    - Diagnosis 6: ''
[17:38:02] ℹ️  Final extracted MRN: '13900203941001'
[17:38:02] ℹ️  Final extracted Sex: ''
[17:38:02] ℹ️  Final extracted Service Line: 'RN'
[17:38:02] ℹ️  Final extracted Payer Source: 'Medicare'
[17:38:02] ✅ Patient data extraction completed successfully
[17:38:02] ✅    ✅ Patient data extracted successfully
[17:38:02] 📊 Patient Response
     └─ patientFName: Paula
     └─ patientLName: Lamothe
     └─ dob: 07/19/1956
     └─ patientSex: 
     └─ medicalRecordNo: 13900203941001
     └─ billingProvider: ELAINE WU, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '03/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:02] ✅    ✅ Patient identified: Paula Lamothe
[17:38:02] ✅    ✅ Patient name validation passed
[17:38:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:38:02] [DOC: 9205746] ℹ️  DOB normalized: 07/19/1956
[17:38:02] [DOC: 9205746] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[17:38:02] [DOC: 9205746] ℹ️  Episode endOfEpisode normalized: 03/10/2025
[17:38:02] [DOC: 9205746] ✅ Patient date processing completed successfully
[17:38:02] ✅    ✅ Date processing completed
[17:38:02] 📊 Processed Patient Data
     └─ patientFName: Paula
     └─ patientLName: Lamothe
     └─ dob: 07/19/1956
     └─ patientSex: 
     └─ medicalRecordNo: 13900203941001
     └─ billingProvider: ELAINE WU, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '03/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:02] 🔄 
🔄 Step 4: Extracting order data...
[17:38:04] ℹ️  Order extraction - MRN: '13900203941001'
[17:38:04] ℹ️  Order extraction - Sex: ''
[17:38:04] ℹ️  Order extraction - Service Line: 'RN'
[17:38:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:38:04] ✅ Order data extraction completed successfully
[17:38:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:38:04] ℹ️  Using MRN from patient data: '13900203941001' over '13900203941001'
[17:38:04] ⚠️  Could not determine sex using any available method
[17:38:04] ℹ️  Service line consistent in both sources: 'RN'
[17:38:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:38:04] ✅ Patient name cross-validation successful
[17:38:04] ✅    ✅ Data merged successfully
[17:38:05] ✅    ✅ Order data extracted and validated
[17:38:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:38:11] [DOC: 9205746] ✅ Patient exists in API: Paula Lamothe, ID: 3bbfbaf4-4834-4f98-a7a9-bc6645df352f
[17:38:11] ✅    ✅ Existing patient found with ID: 3bbfbaf4-4834-4f98-a7a9-bc6645df352f
[17:38:11] 🔄 
🔄 Step 6: Pushing order to API...
[17:38:11] [DOC: 9205746] ℹ️  Pushing order via API for patient ID: 3bbfbaf4-4834-4f98-a7a9-bc6645df352f
[17:38:12] [DOC: 9205746] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13894"}
[17:38:12] ❌    ❌ Failed to push order
[17:38:12] 🔄 
🔄 Step 7: Writing to CSV...
[17:38:12] [DOC: 9205746] ℹ️  Calculated age: 68 from DOB: 07/19/1956
[17:38:12] [DOC: 9205746] ℹ️  Service Line extracted: 'RN'
[17:38:12] [DOC: 9205746] ℹ️  Payer Source extracted: 'Medicare'
[17:38:12] [DOC: 9205746] ℹ️  Diagnosis codes being written:
[17:38:12] [DOC: 9205746] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:38:12] [DOC: 9205746] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:38:12] [DOC: 9205746] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:38:12] [DOC: 9205746] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:38:12] [DOC: 9205746] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:38:12] [DOC: 9205746] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:38:12] [DOC: 9205746] ✅ Patient data written to CSV: Paula Lamothe | Sex:  | Age: 68 | Service: RN | Payer: Medicare | MRN: 13900203941001
[17:38:12] ✅    ✅ Document 9205746 processed and saved successfully
[17:38:12] 🔄 
🔄 Step 8: Saving API details...
[17:38:12] [DOC: 9205746] ℹ️  API push details saved for document 9205746
[17:38:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205569                         ║
================================================================================
[17:38:12] ℹ️  Agency: AccentCare Fall River
[17:38:12] ℹ️  Date: 03/26/2025
[17:38:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:38:15] [DOC: 9205569] ✅ Text extracted using pdfplumber (1267 chars)
[17:38:15] ✅    ✅ Text extracted using pdfplumber (1267 chars)
[17:38:15] 🔄 
🔄 Step 2: Extracting patient data...
[17:38:17] ℹ️  AI extracted raw sex value: ''
[17:38:17] ℹ️  AI extracted service line: 'OT'
[17:38:17] ℹ️  AI extracted payer source: ''
[17:38:17] ℹ️  AI extracted diagnoses:
[17:38:17] ℹ️    - Diagnosis 1: 'Influenza A'
[17:38:17] ℹ️    - Diagnosis 2: 'Acute Hypoxia'
[17:38:17] ℹ️    - Diagnosis 3: 'COPD Exacerbation'
[17:38:17] ℹ️    - Diagnosis 4: ''
[17:38:17] ℹ️    - Diagnosis 5: ''
[17:38:17] ℹ️    - Diagnosis 6: ''
[17:38:17] ℹ️  Final extracted MRN: 'C0200218671301'
[17:38:17] ℹ️  Final extracted Sex: ''
[17:38:17] ℹ️  Final extracted Service Line: 'OT'
[17:38:17] ℹ️  Final extracted Payer Source: ''
[17:38:17] ✅ Patient data extraction completed successfully
[17:38:17] ✅    ✅ Patient data extracted successfully
[17:38:17] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:17] ✅    ✅ Patient identified: MARY LEBLANC
[17:38:17] ✅    ✅ Patient name validation passed
[17:38:17] 🔄 
🔄 Step 3: Processing patient dates...
[17:38:17] [DOC: 9205569] ℹ️  DOB normalized: 03/02/1943
[17:38:17] [DOC: 9205569] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[17:38:17] [DOC: 9205569] ℹ️  Episode endOfEpisode normalized: 02/18/2025
[17:38:17] [DOC: 9205569] ✅ Patient date processing completed successfully
[17:38:17] ✅    ✅ Date processing completed
[17:38:17] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: LEBLANC
     └─ dob: 03/02/1943
     └─ patientSex: 
     └─ medicalRecordNo: C0200218671301
     └─ billingProvider: ACHILLES ROMUALSO ALCARAZ, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': 'Influenza A', 'secondDiagnosis': 'Acute Hypoxia', 'thirdDiagnosis': 'COPD Exacerbation', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:17] 🔄 
🔄 Step 4: Extracting order data...
[17:38:20] ℹ️  Order extraction - MRN: 'C0200218671301'
[17:38:20] ℹ️  Order extraction - Sex: ''
[17:38:20] ℹ️  Order extraction - Service Line: 'OT'
[17:38:20] ℹ️  Order extraction - Payer Source: ''
[17:38:20] ✅ Order data extraction completed successfully
[17:38:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:38:20] ℹ️  Using MRN from patient data: 'C0200218671301' over 'C0200218671301'
[17:38:20] ℹ️  Inferred sex as FEMALE from name: MARY
[17:38:20] ℹ️  Service line consistent in both sources: 'OT'
[17:38:20] ✅ Patient name cross-validation successful
[17:38:20] ✅    ✅ Data merged successfully
[17:38:21] ✅    ✅ Order data extracted and validated
[17:38:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:38:35] [DOC: 9205569] ℹ️  Patient not found in cache or API: MARY LEBLANC
[17:38:35] [DOC: 9205569] ℹ️  Patient not found, creating new patient via API...
[17:38:35] [DOC: 9205569] ℹ️  Creating patient via API: MARY LEBLANC
[17:38:36] [DOC: 9205569] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:38:36] ❌    ❌ Failed to create patient
[17:38:36] [DOC: 9205569] ℹ️  API push details saved for document 9205569
================================================================================
║                        Processing Document ID: 9205443                         ║
================================================================================
[17:38:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:38:36] ℹ️  Date: 03/26/2025
[17:38:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:38:39] [DOC: 9205443] ✅ Text extracted using pdfplumber (1144 chars)
[17:38:39] ✅    ✅ Text extracted using pdfplumber (1132 chars)
[17:38:39] 🔄 
🔄 Step 2: Extracting patient data...
[17:38:41] ℹ️  AI extracted raw sex value: ''
[17:38:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:38:41] ℹ️  AI extracted payer source: ''
[17:38:41] ℹ️  AI extracted diagnoses:
[17:38:41] ℹ️    - Diagnosis 1: 'E11.9'
[17:38:41] ℹ️    - Diagnosis 2: 'E04.1'
[17:38:41] ℹ️    - Diagnosis 3: 'M79.7'
[17:38:41] ℹ️    - Diagnosis 4: ''
[17:38:41] ℹ️    - Diagnosis 5: ''
[17:38:41] ℹ️    - Diagnosis 6: ''
[17:38:41] ℹ️  Final extracted MRN: 'MA250313044605'
[17:38:41] ℹ️  Final extracted Sex: ''
[17:38:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:38:41] ℹ️  Final extracted Payer Source: ''
[17:38:41] ✅ Patient data extraction completed successfully
[17:38:41] ✅    ✅ Patient data extracted successfully
[17:38:41] 📊 Patient Response
     └─ patientFName: Shirley Ann
     └─ patientLName: Marcondes
     └─ dob: 04/09/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA250313044605
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'E04.1', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:41] ✅    ✅ Patient identified: Shirley Ann Marcondes
[17:38:41] ✅    ✅ Patient name validation passed
[17:38:41] 🔄 
🔄 Step 3: Processing patient dates...
[17:38:41] [DOC: 9205443] ℹ️  DOB normalized: 04/09/1946
[17:38:41] [DOC: 9205443] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[17:38:41] [DOC: 9205443] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[17:38:41] [DOC: 9205443] ✅ Patient date processing completed successfully
[17:38:41] ✅    ✅ Date processing completed
[17:38:41] 📊 Processed Patient Data
     └─ patientFName: Shirley Ann
     └─ patientLName: Marcondes
     └─ dob: 04/09/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA250313044605
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'E04.1', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:41] 🔄 
🔄 Step 4: Extracting order data...
[17:38:44] ℹ️  Order extraction - MRN: 'MA250313044605'
[17:38:44] ℹ️  Order extraction - Sex: ''
[17:38:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:38:44] ℹ️  Order extraction - Payer Source: ''
[17:38:44] ✅ Order data extraction completed successfully
[17:38:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:38:44] ℹ️  Using MRN from patient data: 'MA250313044605' over 'MA250313044605'
[17:38:44] ⚠️  Could not determine sex using any available method
[17:38:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:38:44] ✅ Patient name cross-validation successful
[17:38:44] ✅    ✅ Data merged successfully
[17:38:45] ✅    ✅ Order data extracted and validated
[17:38:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:38:45] [DOC: 9205443] ✅ Patient found in local cache: Shirley Ann Marcondes, ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[17:38:45] ✅    ✅ Existing patient found with ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[17:38:45] 🔄 
🔄 Step 6: Pushing order to API...
[17:38:45] [DOC: 9205443] ℹ️  Pushing order via API for patient ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[17:38:46] [DOC: 9205443] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14020"}
[17:38:46] ❌    ❌ Failed to push order
[17:38:46] 🔄 
🔄 Step 7: Writing to CSV...
[17:38:46] [DOC: 9205443] ℹ️  Calculated age: 79 from DOB: 04/09/1946
[17:38:46] [DOC: 9205443] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:38:46] [DOC: 9205443] ℹ️  Payer Source extracted: ''
[17:38:46] [DOC: 9205443] ℹ️  Diagnosis codes being written:
[17:38:46] [DOC: 9205443] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[17:38:46] [DOC: 9205443] ℹ️    - Latest_Episode_Seconddiagnosis: 'E04.1'
[17:38:46] [DOC: 9205443] ℹ️    - Latest_Episode_Thirddiagnosis: 'M79.7'
[17:38:46] [DOC: 9205443] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:38:46] [DOC: 9205443] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:38:46] [DOC: 9205443] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:38:46] [DOC: 9205443] ✅ Patient data written to CSV: Shirley Ann Marcondes | Sex:  | Age: 79 | Service: Skilled Nursing | Payer:  | MRN: MA250313044605
[17:38:46] ✅    ✅ Document 9205443 processed and saved successfully
[17:38:46] 🔄 
🔄 Step 8: Saving API details...
[17:38:46] [DOC: 9205443] ℹ️  API push details saved for document 9205443
[17:38:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205430                         ║
================================================================================
[17:38:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:38:46] ℹ️  Date: 03/26/2025
[17:38:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:38:48] [DOC: 9205430] ✅ Text extracted using pdfplumber (1429 chars)
[17:38:48] ✅    ✅ Text extracted using pdfplumber (1429 chars)
[17:38:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:38:51] ℹ️  AI extracted raw sex value: ''
[17:38:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:38:51] ℹ️  AI extracted payer source: ''
[17:38:51] ℹ️  AI extracted diagnoses:
[17:38:51] ℹ️    - Diagnosis 1: 'J44.0'
[17:38:51] ℹ️    - Diagnosis 2: 'J15.8'
[17:38:51] ℹ️    - Diagnosis 3: 'A41.3'
[17:38:51] ℹ️    - Diagnosis 4: ''
[17:38:51] ℹ️    - Diagnosis 5: ''
[17:38:51] ℹ️    - Diagnosis 6: ''
[17:38:51] ℹ️  Final extracted MRN: 'MA250203063802'
[17:38:51] ℹ️  Final extracted Sex: ''
[17:38:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:38:51] ℹ️  Final extracted Payer Source: ''
[17:38:51] ✅ Patient data extraction completed successfully
[17:38:51] ✅    ✅ Patient data extracted successfully
[17:38:51] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:51] ✅    ✅ Patient identified: Priscila Diaz
[17:38:51] ✅    ✅ Patient name validation passed
[17:38:51] 🔄 
🔄 Step 3: Processing patient dates...
[17:38:51] [DOC: 9205430] ℹ️  DOB normalized: 06/11/1938
[17:38:51] [DOC: 9205430] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[17:38:51] [DOC: 9205430] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[17:38:51] [DOC: 9205430] ✅ Patient date processing completed successfully
[17:38:51] ✅    ✅ Date processing completed
[17:38:51] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:38:51] 🔄 
🔄 Step 4: Extracting order data...
[17:38:54] ℹ️  Order extraction - MRN: 'MA250203063802'
[17:38:54] ℹ️  Order extraction - Sex: ''
[17:38:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:38:54] ℹ️  Order extraction - Payer Source: ''
[17:38:54] ✅ Order data extraction completed successfully
[17:38:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:38:54] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[17:38:54] ⚠️  Could not determine sex using any available method
[17:38:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:38:54] ✅ Patient name cross-validation successful
[17:38:54] ✅    ✅ Data merged successfully
[17:38:55] ✅    ✅ Order data extracted and validated
[17:38:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:38:55] [DOC: 9205430] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[17:38:55] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[17:38:55] 🔄 
🔄 Step 6: Pushing order to API...
[17:38:55] [DOC: 9205430] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[17:38:56] [DOC: 9205430] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13871"}
[17:38:56] ❌    ❌ Failed to push order
[17:38:56] 🔄 
🔄 Step 7: Writing to CSV...
[17:38:56] [DOC: 9205430] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[17:38:56] [DOC: 9205430] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:38:56] [DOC: 9205430] ℹ️  Payer Source extracted: ''
[17:38:56] [DOC: 9205430] ℹ️  Diagnosis codes being written:
[17:38:56] [DOC: 9205430] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[17:38:56] [DOC: 9205430] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[17:38:56] [DOC: 9205430] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[17:38:56] [DOC: 9205430] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:38:56] [DOC: 9205430] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:38:56] [DOC: 9205430] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:38:56] [DOC: 9205430] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: MA250203063802
[17:38:56] ✅    ✅ Document 9205430 processed and saved successfully
[17:38:56] 🔄 
🔄 Step 8: Saving API details...
[17:38:56] [DOC: 9205430] ℹ️  API push details saved for document 9205430
[17:38:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205428                         ║
================================================================================
[17:38:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:38:56] ℹ️  Date: 03/26/2025
[17:38:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:38:58] [DOC: 9205428] ✅ Text extracted using pdfplumber (1475 chars)
[17:38:58] ✅    ✅ Text extracted using pdfplumber (1475 chars)
[17:38:58] 🔄 
🔄 Step 2: Extracting patient data...
[17:39:01] ℹ️  AI extracted raw sex value: ''
[17:39:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:39:01] ℹ️  AI extracted payer source: ''
[17:39:01] ℹ️  AI extracted diagnoses:
[17:39:01] ℹ️    - Diagnosis 1: 'J44.0'
[17:39:01] ℹ️    - Diagnosis 2: 'J15.8'
[17:39:01] ℹ️    - Diagnosis 3: 'A41.3'
[17:39:01] ℹ️    - Diagnosis 4: ''
[17:39:01] ℹ️    - Diagnosis 5: ''
[17:39:01] ℹ️    - Diagnosis 6: ''
[17:39:01] ℹ️  Final extracted MRN: 'MA250203063802'
[17:39:01] ℹ️  Final extracted Sex: ''
[17:39:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:39:01] ℹ️  Final extracted Payer Source: ''
[17:39:01] ✅ Patient data extraction completed successfully
[17:39:01] ✅    ✅ Patient data extracted successfully
[17:39:01] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:39:01] ✅    ✅ Patient identified: Priscila Diaz
[17:39:01] ✅    ✅ Patient name validation passed
[17:39:01] 🔄 
🔄 Step 3: Processing patient dates...
[17:39:01] [DOC: 9205428] ℹ️  DOB normalized: 06/11/1938
[17:39:01] [DOC: 9205428] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[17:39:01] [DOC: 9205428] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[17:39:01] [DOC: 9205428] ✅ Patient date processing completed successfully
[17:39:01] ✅    ✅ Date processing completed
[17:39:01] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:39:01] 🔄 
🔄 Step 4: Extracting order data...
[17:39:04] ℹ️  Order extraction - MRN: 'MA250203063802'
[17:39:04] ℹ️  Order extraction - Sex: ''
[17:39:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:39:04] ℹ️  Order extraction - Payer Source: ''
[17:39:04] ✅ Order data extraction completed successfully
[17:39:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:39:04] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[17:39:04] ⚠️  Could not determine sex using any available method
[17:39:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:39:04] ✅ Patient name cross-validation successful
[17:39:04] ✅    ✅ Data merged successfully
[17:39:05] ✅    ✅ Order data extracted and validated
[17:39:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:39:05] [DOC: 9205428] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[17:39:05] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[17:39:05] 🔄 
🔄 Step 6: Pushing order to API...
[17:39:05] [DOC: 9205428] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[17:39:06] [DOC: 9205428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13873"}
[17:39:06] ❌    ❌ Failed to push order
[17:39:06] 🔄 
🔄 Step 7: Writing to CSV...
[17:39:06] [DOC: 9205428] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[17:39:06] [DOC: 9205428] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:39:06] [DOC: 9205428] ℹ️  Payer Source extracted: ''
[17:39:06] [DOC: 9205428] ℹ️  Diagnosis codes being written:
[17:39:06] [DOC: 9205428] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[17:39:06] [DOC: 9205428] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[17:39:06] [DOC: 9205428] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[17:39:06] [DOC: 9205428] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:39:06] [DOC: 9205428] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:39:06] [DOC: 9205428] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:39:06] [DOC: 9205428] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: MA250203063802
[17:39:06] ✅    ✅ Document 9205428 processed and saved successfully
[17:39:06] 🔄 
🔄 Step 8: Saving API details...
[17:39:06] [DOC: 9205428] ℹ️  API push details saved for document 9205428
[17:39:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9205369                         ║
================================================================================
[17:39:06] ℹ️  Agency: AccentCare Fall River
[17:39:06] ℹ️  Date: 03/26/2025
[17:39:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:39:31] [DOC: 9205369] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[17:39:44] [DOC: 9205369] ✅ Text extracted using tesseract_ocr (25891 chars)
[17:39:44] ✅    ✅ Text extracted using tesseract_ocr (25866 chars)
[17:39:44] 🔄 
🔄 Step 2: Extracting patient data...
[17:39:48] ℹ️  AI extracted raw sex value: 'M'
[17:39:48] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:39:48] ℹ️  AI extracted payer source: 'Medicare'
[17:39:48] ℹ️  AI extracted diagnoses:
[17:39:48] ℹ️    - Diagnosis 1: 'G40.401'
[17:39:48] ℹ️    - Diagnosis 2: 'I69.354'
[17:39:48] ℹ️    - Diagnosis 3: 'I69.323'
[17:39:48] ℹ️    - Diagnosis 4: 'J45.909'
[17:39:48] ℹ️    - Diagnosis 5: 'F29'
[17:39:48] ℹ️    - Diagnosis 6: 'G89.29'
[17:39:48] ℹ️  Final extracted MRN: '0200204515501'
[17:39:48] ℹ️  Final extracted Sex: 'MALE'
[17:39:48] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:39:48] ℹ️  Final extracted Payer Source: 'Medicare'
[17:39:48] ✅ Patient data extraction completed successfully
[17:39:48] ✅    ✅ Patient data extracted successfully
[17:39:48] 📊 Patient Response
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA
     └─ dob: 10/23/1982
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200204515501
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 71 MERRIMAC ST, APT 1W
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/26/2024', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'G40.401', 'secondDiagnosis': 'I69.354', 'thirdDiagnosis': 'I69.323', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'F29', 'sixthDiagnosis': 'G89.29'}]
[17:39:48] ✅    ✅ Patient identified: MILTON ACOSTA
[17:39:48] ✅    ✅ Patient name validation passed
[17:39:48] 🔄 
🔄 Step 3: Processing patient dates...
[17:39:48] [DOC: 9205369] ℹ️  DOB normalized: 10/23/1982
[17:39:48] [DOC: 9205369] ℹ️  Episode startOfCare normalized: 07/26/2024
[17:39:48] [DOC: 9205369] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[17:39:48] [DOC: 9205369] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[17:39:48] [DOC: 9205369] ✅ Patient date processing completed successfully
[17:39:48] ✅    ✅ Date processing completed
[17:39:48] 📊 Processed Patient Data
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA
     └─ dob: 10/23/1982
     └─ patientSex: MALE
     └─ medicalRecordNo: 0200204515501
     └─ billingProvider: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: AACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 71 MERRIMAC ST, APT 1W
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/26/2024', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'G40.401', 'secondDiagnosis': 'I69.354', 'thirdDiagnosis': 'I69.323', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'F29', 'sixthDiagnosis': 'G89.29'}]
[17:39:48] 🔄 
🔄 Step 4: Extracting order data...
[17:39:51] ℹ️  Order extraction - MRN: 'C0200204515501'
[17:39:51] ℹ️  Order extraction - Sex: 'MALE'
[17:39:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:39:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:39:51] ✅ Order data extraction completed successfully
[17:39:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:39:51] ℹ️  Using longer MRN from order data: 'C0200204515501' over '0200204515501'
[17:39:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:39:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:39:51] ✅ Patient name cross-validation successful
[17:39:51] ✅    ✅ Data merged successfully
[17:39:52] ✅    ✅ Order data extracted and validated
[17:39:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:39:59] [DOC: 9205369] ℹ️  Patient not found in cache or API: MILTON ACOSTA
[17:39:59] [DOC: 9205369] ℹ️  Patient not found, creating new patient via API...
[17:39:59] [DOC: 9205369] ℹ️  Creating patient via API: MILTON ACOSTA
[17:40:00] [DOC: 9205369] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:40:00] ❌    ❌ Failed to create patient
[17:40:00] [DOC: 9205369] ℹ️  API push details saved for document 9205369
================================================================================
║                        Processing Document ID: 9204844                         ║
================================================================================
[17:40:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:40:00] ℹ️  Date: 03/26/2025
[17:40:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:40:02] [DOC: 9204844] ✅ Text extracted using pdfplumber (1217 chars)
[17:40:02] ✅    ✅ Text extracted using pdfplumber (1217 chars)
[17:40:02] 🔄 
🔄 Step 2: Extracting patient data...
[17:40:04] ℹ️  AI extracted raw sex value: 'M'
[17:40:04] ℹ️  AI extracted service line: 'SN'
[17:40:04] ℹ️  AI extracted payer source: ''
[17:40:04] ℹ️  AI extracted diagnoses:
[17:40:04] ℹ️    - Diagnosis 1: ''
[17:40:04] ℹ️    - Diagnosis 2: ''
[17:40:04] ℹ️    - Diagnosis 3: ''
[17:40:04] ℹ️    - Diagnosis 4: ''
[17:40:04] ℹ️    - Diagnosis 5: ''
[17:40:04] ℹ️    - Diagnosis 6: ''
[17:40:04] ℹ️  Final extracted MRN: '3091790'
[17:40:04] ℹ️  Final extracted Sex: 'MALE'
[17:40:04] ℹ️  Final extracted Service Line: 'SN'
[17:40:04] ℹ️  Final extracted Payer Source: ''
[17:40:04] ✅ Patient data extraction completed successfully
[17:40:04] ✅    ✅ Patient data extracted successfully
[17:40:04] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: SN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:40:04] ✅    ✅ Patient identified: Richard White
[17:40:04] ✅    ✅ Patient name validation passed
[17:40:04] 🔄 
🔄 Step 3: Processing patient dates...
[17:40:04] [DOC: 9204844] ℹ️  DOB normalized: 12/08/1957
[17:40:04] [DOC: 9204844] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[17:40:04] [DOC: 9204844] ✅ Patient date processing completed successfully
[17:40:04] ✅    ✅ Date processing completed
[17:40:04] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: SN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:40:04] 🔄 
🔄 Step 4: Extracting order data...
[17:40:07] ℹ️  Order extraction - MRN: '3091790'
[17:40:07] ℹ️  Order extraction - Sex: 'MALE'
[17:40:07] ℹ️  Order extraction - Service Line: 'SN'
[17:40:07] ℹ️  Order extraction - Payer Source: ''
[17:40:07] ✅ Order data extraction completed successfully
[17:40:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:40:07] ℹ️  Using MRN from patient data: '3091790' over '3091790'
[17:40:07] ℹ️  Service line consistent in both sources: 'SN'
[17:40:07] ✅ Patient name cross-validation successful
[17:40:07] ✅    ✅ Data merged successfully
[17:40:08] ✅    ✅ Order data extracted and validated
[17:40:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:40:14] [DOC: 9204844] ℹ️  Patient not found in cache or API: Richard White
[17:40:14] [DOC: 9204844] ℹ️  Patient not found, creating new patient via API...
[17:40:14] [DOC: 9204844] ℹ️  Creating patient via API: Richard White
[17:40:15] [DOC: 9204844] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:40:15] ❌    ❌ Failed to create patient
[17:40:15] [DOC: 9204844] ℹ️  API push details saved for document 9204844
================================================================================
║                        Processing Document ID: 9204839                         ║
================================================================================
[17:40:15] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:40:15] ℹ️  Date: 03/26/2025
[17:40:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:40:19] [DOC: 9204839] ✅ Text extracted using pdfplumber (19955 chars)
[17:40:19] ✅    ✅ Text extracted using pdfplumber (19955 chars)
[17:40:19] 🔄 
🔄 Step 2: Extracting patient data...
[17:40:23] ℹ️  AI extracted raw sex value: 'F'
[17:40:23] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[17:40:23] ℹ️  AI extracted payer source: ''
[17:40:23] ℹ️  AI extracted diagnoses:
[17:40:23] ℹ️    - Diagnosis 1: 'M80.061D'
[17:40:23] ℹ️    - Diagnosis 2: 'N18.32'
[17:40:23] ℹ️    - Diagnosis 3: 'D63.1'
[17:40:23] ℹ️    - Diagnosis 4: 'M10.30'
[17:40:23] ℹ️    - Diagnosis 5: 'I73.9'
[17:40:23] ℹ️    - Diagnosis 6: 'G47.33'
[17:40:23] ℹ️  Final extracted MRN: '2936840'
[17:40:23] ℹ️  Final extracted Sex: 'FEMALE'
[17:40:23] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[17:40:23] ℹ️  Final extracted Payer Source: ''
[17:40:23] ✅ Patient data extraction completed successfully
[17:40:23] ✅    ✅ Patient data extracted successfully
[17:40:23] 📊 Patient Response
     └─ patientFName: Fotoula
     └─ patientLName: Sakellaropoulos
     └─ dob: 06/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936840
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 763 Hathaway Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-1945
     └─ email: 
     └─ phoneNumber: 508-496-6025
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'M80.061D', 'secondDiagnosis': 'N18.32', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'M10.30', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'G47.33'}]
[17:40:23] ✅    ✅ Patient identified: Fotoula Sakellaropoulos
[17:40:23] ✅    ✅ Patient name validation passed
[17:40:23] 🔄 
🔄 Step 3: Processing patient dates...
[17:40:23] [DOC: 9204839] ℹ️  DOB normalized: 06/08/1957
[17:40:23] [DOC: 9204839] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:40:23] [DOC: 9204839] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[17:40:23] [DOC: 9204839] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[17:40:23] [DOC: 9204839] ✅ Patient date processing completed successfully
[17:40:23] ✅    ✅ Date processing completed
[17:40:23] 📊 Processed Patient Data
     └─ patientFName: Fotoula
     └─ patientLName: Sakellaropoulos
     └─ dob: 06/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936840
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 763 Hathaway Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-1945
     └─ email: 
     └─ phoneNumber: 508-496-6025
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'M80.061D', 'secondDiagnosis': 'N18.32', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'M10.30', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'G47.33'}]
[17:40:23] 🔄 
🔄 Step 4: Extracting order data...
[17:40:25] ℹ️  Order extraction - MRN: '2936840'
[17:40:25] ℹ️  Order extraction - Sex: 'FEMALE'
[17:40:25] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:40:25] ℹ️  Order extraction - Payer Source: ''
[17:40:25] ✅ Order data extraction completed successfully
[17:40:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:40:25] ℹ️  Using MRN from patient data: '2936840' over '2936840'
[17:40:25] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[17:40:25] ✅ Patient name cross-validation successful
[17:40:25] ✅    ✅ Data merged successfully
[17:40:26] ✅    ✅ Order data extracted and validated
[17:40:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:40:31] [DOC: 9204839] ℹ️  Patient not found in cache or API: Fotoula Sakellaropoulos
[17:40:31] [DOC: 9204839] ℹ️  Patient not found, creating new patient via API...
[17:40:31] [DOC: 9204839] ℹ️  Creating patient via API: Fotoula Sakellaropoulos
[17:40:33] [DOC: 9204839] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:40:33] ❌    ❌ Failed to create patient
[17:40:33] [DOC: 9204839] ℹ️  API push details saved for document 9204839
================================================================================
║                        Processing Document ID: 9204833                         ║
================================================================================
[17:40:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:40:33] ℹ️  Date: 03/26/2025
[17:40:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:40:36] [DOC: 9204833] ✅ Text extracted using pdfplumber (19107 chars)
[17:40:36] ✅    ✅ Text extracted using pdfplumber (19097 chars)
[17:40:36] 🔄 
🔄 Step 2: Extracting patient data...
[17:40:40] ℹ️  AI extracted raw sex value: 'F'
[17:40:40] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:40:40] ℹ️  AI extracted payer source: ''
[17:40:40] ℹ️  AI extracted diagnoses:
[17:40:40] ℹ️    - Diagnosis 1: 'S06.350D'
[17:40:40] ℹ️    - Diagnosis 2: 'I48.0'
[17:40:40] ℹ️    - Diagnosis 3: 'I11.0'
[17:40:40] ℹ️    - Diagnosis 4: 'I50.32'
[17:40:40] ℹ️    - Diagnosis 5: 'G47.00'
[17:40:40] ℹ️    - Diagnosis 6: 'K52.89'
[17:40:40] ℹ️  Final extracted MRN: '2902972'
[17:40:40] ℹ️  Final extracted Sex: 'FEMALE'
[17:40:40] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:40:40] ℹ️  Final extracted Payer Source: ''
[17:40:40] ✅ Patient data extraction completed successfully
[17:40:40] ✅    ✅ Patient data extracted successfully
[17:40:40] 📊 Patient Response
     └─ patientFName: Anita
     └─ patientLName: Riley-Robinson
     └─ dob: 05/09/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2902972
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'S06.350D', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'G47.00', 'sixthDiagnosis': 'K52.89'}]
[17:40:40] ✅    ✅ Patient identified: Anita Riley-Robinson
[17:40:40] ✅    ✅ Patient name validation passed
[17:40:40] 🔄 
🔄 Step 3: Processing patient dates...
[17:40:40] [DOC: 9204833] ℹ️  DOB normalized: 05/09/1927
[17:40:40] [DOC: 9204833] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:40:40] [DOC: 9204833] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[17:40:40] [DOC: 9204833] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[17:40:40] [DOC: 9204833] ✅ Patient date processing completed successfully
[17:40:40] ✅    ✅ Date processing completed
[17:40:40] 📊 Processed Patient Data
     └─ patientFName: Anita
     └─ patientLName: Riley-Robinson
     └─ dob: 05/09/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2902972
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'S06.350D', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'G47.00', 'sixthDiagnosis': 'K52.89'}]
[17:40:40] 🔄 
🔄 Step 4: Extracting order data...
[17:40:42] ℹ️  Order extraction - MRN: '2902972'
[17:40:42] ℹ️  Order extraction - Sex: 'FEMALE'
[17:40:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:40:42] ℹ️  Order extraction - Payer Source: ''
[17:40:42] ✅ Order data extraction completed successfully
[17:40:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:40:42] ℹ️  Using MRN from patient data: '2902972' over '2902972'
[17:40:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:40:42] ✅ Patient name cross-validation successful
[17:40:42] ✅    ✅ Data merged successfully
[17:40:44] ✅    ✅ Order data extracted and validated
[17:40:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:41:30] [DOC: 9204833] ℹ️  Patient not found in cache or API: Anita Riley-Robinson
[17:41:30] [DOC: 9204833] ℹ️  Patient not found, creating new patient via API...
[17:41:30] [DOC: 9204833] ℹ️  Creating patient via API: Anita Riley-Robinson
[17:41:31] [DOC: 9204833] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:41:31] ❌    ❌ Failed to create patient
[17:41:31] [DOC: 9204833] ℹ️  API push details saved for document 9204833
================================================================================
║                        Processing Document ID: 9204812                         ║
================================================================================
[17:41:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:41:31] ℹ️  Date: 03/26/2025
[17:41:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:41:32] [DOC: 9204812] ✅ Text extracted using pdfplumber (893 chars)
[17:41:32] ✅    ✅ Text extracted using pdfplumber (893 chars)
[17:41:32] 🔄 
🔄 Step 2: Extracting patient data...
[17:41:35] ℹ️  AI extracted raw sex value: 'M'
[17:41:35] ℹ️  AI extracted service line: 'Physical Therapy'
[17:41:35] ℹ️  AI extracted payer source: ''
[17:41:35] ℹ️  AI extracted diagnoses:
[17:41:35] ℹ️    - Diagnosis 1: 'None'
[17:41:35] ℹ️    - Diagnosis 2: 'None'
[17:41:35] ℹ️    - Diagnosis 3: 'None'
[17:41:35] ℹ️    - Diagnosis 4: 'None'
[17:41:35] ℹ️    - Diagnosis 5: 'None'
[17:41:35] ℹ️    - Diagnosis 6: 'None'
[17:41:35] ℹ️  Final extracted MRN: '2405015'
[17:41:35] ℹ️  Final extracted Sex: 'MALE'
[17:41:35] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:41:35] ℹ️  Final extracted Payer Source: ''
[17:41:35] ✅ Patient data extraction completed successfully
[17:41:35] ✅    ✅ Patient data extracted successfully
[17:41:35] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Neves
     └─ dob: 06/17/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2405015
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:41:35] ✅    ✅ Patient identified: Joao Neves
[17:41:35] ✅    ✅ Patient name validation passed
[17:41:35] 🔄 
🔄 Step 3: Processing patient dates...
[17:41:35] [DOC: 9204812] ℹ️  DOB normalized: 06/17/1936
[17:41:35] [DOC: 9204812] ✅ Patient date processing completed successfully
[17:41:35] ✅    ✅ Date processing completed
[17:41:35] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Neves
     └─ dob: 06/17/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2405015
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:41:35] 🔄 
🔄 Step 4: Extracting order data...
[17:41:37] ℹ️  Order extraction - MRN: '2405015'
[17:41:37] ℹ️  Order extraction - Sex: 'MALE'
[17:41:37] ℹ️  Order extraction - Service Line: ''
[17:41:37] ℹ️  Order extraction - Payer Source: ''
[17:41:37] ✅ Order data extraction completed successfully
[17:41:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:41:37] ℹ️  Using MRN from patient data: '2405015' over '2405015'
[17:41:37] ℹ️  Using service line from patient data: 'Physical Therapy'
[17:41:37] ✅ Patient name cross-validation successful
[17:41:37] ✅    ✅ Data merged successfully
[17:41:39] ⚠️     ❌ Skipping - missing episode start date
[17:41:39] [DOC: 9204812] ℹ️  API push details saved for document 9204812
================================================================================
║                        Processing Document ID: 9204802                         ║
================================================================================
[17:41:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:41:39] ℹ️  Date: 03/26/2025
[17:41:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:41:40] [DOC: 9204802] ✅ Text extracted using pdfplumber (1034 chars)
[17:41:40] ✅    ✅ Text extracted using pdfplumber (1034 chars)
[17:41:40] 🔄 
🔄 Step 2: Extracting patient data...
[17:41:42] ℹ️  AI extracted raw sex value: 'F'
[17:41:42] ℹ️  AI extracted service line: 'RN, LPN'
[17:41:42] ℹ️  AI extracted payer source: ''
[17:41:42] ℹ️  AI extracted diagnoses:
[17:41:42] ℹ️    - Diagnosis 1: ''
[17:41:42] ℹ️    - Diagnosis 2: ''
[17:41:42] ℹ️    - Diagnosis 3: ''
[17:41:42] ℹ️    - Diagnosis 4: ''
[17:41:42] ℹ️    - Diagnosis 5: ''
[17:41:42] ℹ️    - Diagnosis 6: ''
[17:41:42] ℹ️  Final extracted MRN: '2773301'
[17:41:42] ℹ️  Final extracted Sex: 'FEMALE'
[17:41:42] ℹ️  Final extracted Service Line: 'RN, LPN'
[17:41:42] ℹ️  Final extracted Payer Source: ''
[17:41:42] ✅ Patient data extraction completed successfully
[17:41:42] ✅    ✅ Patient data extracted successfully
[17:41:42] 📊 Patient Response
     └─ patientFName: Arlene
     └─ patientLName: Moss
     └─ dob: 01/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773301
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:41:42] ✅    ✅ Patient identified: Arlene Moss
[17:41:42] ✅    ✅ Patient name validation passed
[17:41:42] 🔄 
🔄 Step 3: Processing patient dates...
[17:41:42] [DOC: 9204802] ℹ️  DOB normalized: 01/24/1959
[17:41:42] [DOC: 9204802] ✅ Patient date processing completed successfully
[17:41:42] ✅    ✅ Date processing completed
[17:41:42] 📊 Processed Patient Data
     └─ patientFName: Arlene
     └─ patientLName: Moss
     └─ dob: 01/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773301
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:41:42] 🔄 
🔄 Step 4: Extracting order data...
[17:41:44] ℹ️  Order extraction - MRN: '2773301'
[17:41:44] ℹ️  Order extraction - Sex: 'FEMALE'
[17:41:44] ℹ️  Order extraction - Service Line: ''
[17:41:44] ℹ️  Order extraction - Payer Source: ''
[17:41:44] ✅ Order data extraction completed successfully
[17:41:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:41:44] ℹ️  Using MRN from patient data: '2773301' over '2773301'
[17:41:44] ℹ️  Using service line from patient data: 'RN, LPN'
[17:41:44] ✅ Patient name cross-validation successful
[17:41:44] ✅    ✅ Data merged successfully
[17:41:46] ✅    ✅ Order data extracted and validated
[17:41:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:41:51] [DOC: 9204802] ℹ️  Patient not found in cache or API: Arlene Moss
[17:41:51] [DOC: 9204802] ℹ️  Patient not found, creating new patient via API...
[17:41:51] [DOC: 9204802] ℹ️  Creating patient via API: Arlene Moss
[17:41:52] [DOC: 9204802] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:41:52] ❌    ❌ Failed to create patient
[17:41:52] [DOC: 9204802] ℹ️  API push details saved for document 9204802
================================================================================
║                        Processing Document ID: 9204798                         ║
================================================================================
[17:41:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:41:52] ℹ️  Date: 03/26/2025
[17:41:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:41:54] [DOC: 9204798] ✅ Text extracted using pdfplumber (1120 chars)
[17:41:54] ✅    ✅ Text extracted using pdfplumber (1120 chars)
[17:41:54] 🔄 
🔄 Step 2: Extracting patient data...
[17:41:56] ℹ️  AI extracted raw sex value: 'F'
[17:41:56] ℹ️  AI extracted service line: 'Physical Therapy'
[17:41:56] ℹ️  AI extracted payer source: ''
[17:41:56] ℹ️  AI extracted diagnoses:
[17:41:56] ℹ️    - Diagnosis 1: ''
[17:41:56] ℹ️    - Diagnosis 2: ''
[17:41:56] ℹ️    - Diagnosis 3: ''
[17:41:56] ℹ️    - Diagnosis 4: ''
[17:41:56] ℹ️    - Diagnosis 5: ''
[17:41:56] ℹ️    - Diagnosis 6: ''
[17:41:56] ℹ️  Final extracted MRN: '2743829'
[17:41:56] ℹ️  Final extracted Sex: 'FEMALE'
[17:41:56] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:41:56] ℹ️  Final extracted Payer Source: ''
[17:41:56] ✅ Patient data extraction completed successfully
[17:41:56] ✅    ✅ Patient data extracted successfully
[17:41:56] 📊 Patient Response
     └─ patientFName: Ilda
     └─ patientLName: Mendes
     └─ dob: 09/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2743829
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:41:56] ✅    ✅ Patient identified: Ilda Mendes
[17:41:56] ✅    ✅ Patient name validation passed
[17:41:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:41:56] [DOC: 9204798] ℹ️  DOB normalized: 09/26/1940
[17:41:56] [DOC: 9204798] ✅ Patient date processing completed successfully
[17:41:56] ✅    ✅ Date processing completed
[17:41:56] 📊 Processed Patient Data
     └─ patientFName: Ilda
     └─ patientLName: Mendes
     └─ dob: 09/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2743829
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:41:56] 🔄 
🔄 Step 4: Extracting order data...
[17:41:58] ℹ️  Order extraction - MRN: '2743829'
[17:41:58] ℹ️  Order extraction - Sex: 'FEMALE'
[17:41:58] ℹ️  Order extraction - Service Line: ''
[17:41:58] ℹ️  Order extraction - Payer Source: ''
[17:41:58] ✅ Order data extraction completed successfully
[17:41:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:41:58] ℹ️  Using MRN from patient data: '2743829' over '2743829'
[17:41:58] ℹ️  Using service line from patient data: 'Physical Therapy'
[17:41:58] ✅ Patient name cross-validation successful
[17:41:58] ✅    ✅ Data merged successfully
[17:41:59] ✅    ✅ Order data extracted and validated
[17:41:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:42:23] [DOC: 9204798] ℹ️  Patient not found in cache or API: Ilda Mendes
[17:42:23] [DOC: 9204798] ℹ️  Patient not found, creating new patient via API...
[17:42:23] [DOC: 9204798] ℹ️  Creating patient via API: Ilda Mendes
[17:42:24] [DOC: 9204798] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:42:24] ❌    ❌ Failed to create patient
[17:42:24] [DOC: 9204798] ℹ️  API push details saved for document 9204798
================================================================================
║                        Processing Document ID: 9204791                         ║
================================================================================
[17:42:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:42:24] ℹ️  Date: 03/26/2025
[17:42:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:42:26] [DOC: 9204791] ✅ Text extracted using pdfplumber (2236 chars)
[17:42:26] ✅    ✅ Text extracted using pdfplumber (2236 chars)
[17:42:26] 🔄 
🔄 Step 2: Extracting patient data...
[17:42:28] ℹ️  AI extracted raw sex value: 'M'
[17:42:28] ℹ️  AI extracted service line: 'RN'
[17:42:28] ℹ️  AI extracted payer source: ''
[17:42:28] ℹ️  AI extracted diagnoses:
[17:42:28] ℹ️    - Diagnosis 1: 'None'
[17:42:28] ℹ️    - Diagnosis 2: 'None'
[17:42:28] ℹ️    - Diagnosis 3: 'None'
[17:42:28] ℹ️    - Diagnosis 4: 'None'
[17:42:28] ℹ️    - Diagnosis 5: 'None'
[17:42:28] ℹ️    - Diagnosis 6: 'None'
[17:42:28] ℹ️  Final extracted MRN: '2621702'
[17:42:28] ℹ️  Final extracted Sex: 'MALE'
[17:42:28] ℹ️  Final extracted Service Line: 'RN'
[17:42:28] ℹ️  Final extracted Payer Source: ''
[17:42:28] ✅ Patient data extraction completed successfully
[17:42:28] ✅    ✅ Patient data extracted successfully
[17:42:28] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:42:28] ✅    ✅ Patient identified: Bernard Klim
[17:42:28] ✅    ✅ Patient name validation passed
[17:42:28] 🔄 
🔄 Step 3: Processing patient dates...
[17:42:28] [DOC: 9204791] ℹ️  DOB normalized: 09/20/1957
[17:42:28] [DOC: 9204791] ✅ Patient date processing completed successfully
[17:42:28] ✅    ✅ Date processing completed
[17:42:28] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:42:28] 🔄 
🔄 Step 4: Extracting order data...
[17:42:31] ℹ️  Order extraction - MRN: '2621702'
[17:42:31] ℹ️  Order extraction - Sex: 'MALE'
[17:42:31] ℹ️  Order extraction - Service Line: ''
[17:42:31] ℹ️  Order extraction - Payer Source: ''
[17:42:31] ✅ Order data extraction completed successfully
[17:42:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:42:31] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[17:42:31] ℹ️  Using service line from patient data: 'RN'
[17:42:31] ✅ Patient name cross-validation successful
[17:42:31] ✅    ✅ Data merged successfully
[17:42:32] ⚠️     ❌ Skipping - missing episode start date
[17:42:32] [DOC: 9204791] ℹ️  API push details saved for document 9204791
================================================================================
║                        Processing Document ID: 9204785                         ║
================================================================================
[17:42:32] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:42:32] ℹ️  Date: 03/26/2025
[17:42:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:42:35] [DOC: 9204785] ✅ Text extracted using pdfplumber (17565 chars)
[17:42:35] ✅    ✅ Text extracted using pdfplumber (17555 chars)
[17:42:35] 🔄 
🔄 Step 2: Extracting patient data...
[17:42:39] ℹ️  AI extracted raw sex value: 'M'
[17:42:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:42:39] ℹ️  AI extracted payer source: ''
[17:42:39] ℹ️  AI extracted diagnoses:
[17:42:39] ℹ️    - Diagnosis 1: 'A41.51'
[17:42:39] ℹ️    - Diagnosis 2: 'N39.0'
[17:42:39] ℹ️    - Diagnosis 3: 'I12.9'
[17:42:39] ℹ️    - Diagnosis 4: 'N18.32'
[17:42:39] ℹ️    - Diagnosis 5: 'N31.9'
[17:42:39] ℹ️    - Diagnosis 6: 'F32.A'
[17:42:39] ℹ️  Final extracted MRN: '2621702'
[17:42:39] ℹ️  Final extracted Sex: 'MALE'
[17:42:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:42:39] ℹ️  Final extracted Payer Source: ''
[17:42:39] ✅ Patient data extraction completed successfully
[17:42:39] ✅    ✅ Patient data extracted successfully
[17:42:39] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'F32.A'}]
[17:42:39] ✅    ✅ Patient identified: Bernard Klim
[17:42:39] ✅    ✅ Patient name validation passed
[17:42:39] 🔄 
🔄 Step 3: Processing patient dates...
[17:42:39] [DOC: 9204785] ℹ️  DOB normalized: 09/20/1957
[17:42:39] [DOC: 9204785] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:42:39] [DOC: 9204785] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[17:42:39] [DOC: 9204785] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[17:42:39] [DOC: 9204785] ✅ Patient date processing completed successfully
[17:42:39] ✅    ✅ Date processing completed
[17:42:39] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'F32.A'}]
[17:42:39] 🔄 
🔄 Step 4: Extracting order data...
[17:42:42] ℹ️  Order extraction - MRN: '2621702'
[17:42:42] ℹ️  Order extraction - Sex: 'MALE'
[17:42:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:42:42] ℹ️  Order extraction - Payer Source: ''
[17:42:42] ✅ Order data extraction completed successfully
[17:42:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:42:42] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[17:42:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:42:42] ✅ Patient name cross-validation successful
[17:42:42] ✅    ✅ Data merged successfully
[17:42:43] ✅    ✅ Order data extracted and validated
[17:42:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:42:48] [DOC: 9204785] ℹ️  Patient not found in cache or API: Bernard Klim
[17:42:48] [DOC: 9204785] ℹ️  Patient not found, creating new patient via API...
[17:42:48] [DOC: 9204785] ℹ️  Creating patient via API: Bernard Klim
[17:42:49] [DOC: 9204785] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:42:49] ❌    ❌ Failed to create patient
[17:42:49] [DOC: 9204785] ℹ️  API push details saved for document 9204785
================================================================================
║                        Processing Document ID: 9204778                         ║
================================================================================
[17:42:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:42:49] ℹ️  Date: 03/26/2025
[17:42:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:42:51] [DOC: 9204778] ✅ Text extracted using pdfplumber (1014 chars)
[17:42:51] ✅    ✅ Text extracted using pdfplumber (1014 chars)
[17:42:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:42:53] ℹ️  AI extracted raw sex value: 'M'
[17:42:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:42:53] ℹ️  AI extracted payer source: ''
[17:42:54] ℹ️  AI extracted diagnoses:
[17:42:54] ℹ️    - Diagnosis 1: 'None'
[17:42:54] ℹ️    - Diagnosis 2: 'None'
[17:42:54] ℹ️    - Diagnosis 3: 'None'
[17:42:54] ℹ️    - Diagnosis 4: 'None'
[17:42:54] ℹ️    - Diagnosis 5: 'None'
[17:42:54] ℹ️    - Diagnosis 6: 'None'
[17:42:54] ℹ️  Final extracted MRN: '2136200'
[17:42:54] ℹ️  Final extracted Sex: 'MALE'
[17:42:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:42:54] ℹ️  Final extracted Payer Source: ''
[17:42:54] ✅ Patient data extraction completed successfully
[17:42:54] ✅    ✅ Patient data extracted successfully
[17:42:54] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:42:54] ✅    ✅ Patient identified: Jacob Amadeu
[17:42:54] ✅    ✅ Patient name validation passed
[17:42:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:42:54] [DOC: 9204778] ℹ️  DOB normalized: 04/03/1941
[17:42:54] [DOC: 9204778] ✅ Patient date processing completed successfully
[17:42:54] ✅    ✅ Date processing completed
[17:42:54] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:42:54] 🔄 
🔄 Step 4: Extracting order data...
[17:42:56] ℹ️  Order extraction - MRN: '2136200'
[17:42:56] ℹ️  Order extraction - Sex: 'MALE'
[17:42:56] ℹ️  Order extraction - Service Line: ''
[17:42:56] ℹ️  Order extraction - Payer Source: ''
[17:42:56] ✅ Order data extraction completed successfully
[17:42:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:42:56] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[17:42:56] ℹ️  Using service line from patient data: 'Skilled Nursing'
[17:42:56] ✅ Patient name cross-validation successful
[17:42:56] ✅    ✅ Data merged successfully
[17:42:57] ✅    ✅ Order data extracted and validated
[17:42:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:43:10] [DOC: 9204778] ℹ️  Patient not found in cache or API: Jacob Amadeu
[17:43:10] [DOC: 9204778] ℹ️  Patient not found, creating new patient via API...
[17:43:10] [DOC: 9204778] ℹ️  Creating patient via API: Jacob Amadeu
[17:43:11] [DOC: 9204778] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:43:11] ❌    ❌ Failed to create patient
[17:43:11] [DOC: 9204778] ℹ️  API push details saved for document 9204778
================================================================================
║                        Processing Document ID: 9204775                         ║
================================================================================
[17:43:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:43:11] ℹ️  Date: 03/26/2025
[17:43:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:43:13] [DOC: 9204775] ✅ Text extracted using pdfplumber (1039 chars)
[17:43:13] ✅    ✅ Text extracted using pdfplumber (1039 chars)
[17:43:13] 🔄 
🔄 Step 2: Extracting patient data...
[17:43:16] ℹ️  AI extracted raw sex value: 'F'
[17:43:16] ℹ️  AI extracted service line: 'Nursing'
[17:43:16] ℹ️  AI extracted payer source: ''
[17:43:16] ℹ️  AI extracted diagnoses:
[17:43:16] ℹ️    - Diagnosis 1: ''
[17:43:16] ℹ️    - Diagnosis 2: ''
[17:43:16] ℹ️    - Diagnosis 3: ''
[17:43:16] ℹ️    - Diagnosis 4: ''
[17:43:16] ℹ️    - Diagnosis 5: ''
[17:43:16] ℹ️    - Diagnosis 6: ''
[17:43:16] ℹ️  Final extracted MRN: '2467814'
[17:43:16] ℹ️  Final extracted Sex: 'FEMALE'
[17:43:16] ℹ️  Final extracted Service Line: 'Nursing'
[17:43:16] ℹ️  Final extracted Payer Source: ''
[17:43:16] ✅ Patient data extraction completed successfully
[17:43:16] ✅    ✅ Patient data extracted successfully
[17:43:16] 📊 Patient Response
     └─ patientFName: Natalie
     └─ patientLName: Ferreira
     └─ dob: 05/21/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467814
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:43:16] ✅    ✅ Patient identified: Natalie Ferreira
[17:43:16] ✅    ✅ Patient name validation passed
[17:43:16] 🔄 
🔄 Step 3: Processing patient dates...
[17:43:16] [DOC: 9204775] ℹ️  DOB normalized: 05/21/1923
[17:43:16] [DOC: 9204775] ✅ Patient date processing completed successfully
[17:43:16] ✅    ✅ Date processing completed
[17:43:16] 📊 Processed Patient Data
     └─ patientFName: Natalie
     └─ patientLName: Ferreira
     └─ dob: 05/21/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467814
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:43:16] 🔄 
🔄 Step 4: Extracting order data...
[17:43:18] ℹ️  Order extraction - MRN: '2467814'
[17:43:18] ℹ️  Order extraction - Sex: 'FEMALE'
[17:43:18] ℹ️  Order extraction - Service Line: ''
[17:43:18] ℹ️  Order extraction - Payer Source: ''
[17:43:18] ✅ Order data extraction completed successfully
[17:43:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:43:18] ℹ️  Using MRN from patient data: '2467814' over '2467814'
[17:43:18] ℹ️  Using service line from patient data: 'Nursing'
[17:43:18] ✅ Patient name cross-validation successful
[17:43:18] ✅    ✅ Data merged successfully
[17:43:19] ✅    ✅ Order data extracted and validated
[17:43:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:43:19] [DOC: 9204775] ✅ Patient found in local cache: Natalie Ferreira, ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[17:43:19] ✅    ✅ Existing patient found with ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[17:43:19] 🔄 
🔄 Step 6: Pushing order to API...
[17:43:19] [DOC: 9204775] ℹ️  Pushing order via API for patient ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[17:43:21] [DOC: 9204775] ❌ Order push failed with status 201: {"id":"0575b543-d017-489d-b20d-b83de807ecfc","orderWAVId":"ORD20077","orderNo":"1073281","orderDate":"03/21/2025","startOfCare":"03/21/2025","episodeStartDate":"03/21/2025","episodeEndDate":"03/28/2025","documentID":"9204775","mrn":"2467814","patientName":"Ferreira,Natalie","sentToPhysicianDate":"03/26/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/28/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6b2caa28-b014-4962-9fd1-3a569c1b8750","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:43:21] ❌    ❌ Failed to push order
[17:43:21] 🔄 
🔄 Step 7: Writing to CSV...
[17:43:21] [DOC: 9204775] ℹ️  Calculated age: 102 from DOB: 05/21/1923
[17:43:21] [DOC: 9204775] ℹ️  Service Line extracted: 'Nursing'
[17:43:21] [DOC: 9204775] ℹ️  Payer Source extracted: ''
[17:43:21] [DOC: 9204775] ℹ️  Diagnosis codes being written:
[17:43:21] [DOC: 9204775] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:43:21] [DOC: 9204775] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:43:21] [DOC: 9204775] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:43:21] [DOC: 9204775] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:43:21] [DOC: 9204775] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:43:21] [DOC: 9204775] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:43:21] [DOC: 9204775] ✅ Patient data written to CSV: Natalie Ferreira | Sex: FEMALE | Age: 102 | Service: Nursing | Payer:  | MRN: 2467814
[17:43:21] ✅    ✅ Document 9204775 processed and saved successfully
[17:43:21] 🔄 
🔄 Step 8: Saving API details...
[17:43:21] [DOC: 9204775] ℹ️  API push details saved for document 9204775
[17:43:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204764                         ║
================================================================================
[17:43:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:43:21] ℹ️  Date: 03/26/2025
[17:43:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:43:22] [DOC: 9204764] ✅ Text extracted using pdfplumber (1614 chars)
[17:43:22] ✅    ✅ Text extracted using pdfplumber (1614 chars)
[17:43:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:43:25] ℹ️  AI extracted raw sex value: 'F'
[17:43:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:43:25] ℹ️  AI extracted payer source: ''
[17:43:25] ℹ️  AI extracted diagnoses:
[17:43:25] ℹ️    - Diagnosis 1: ''
[17:43:25] ℹ️    - Diagnosis 2: ''
[17:43:25] ℹ️    - Diagnosis 3: ''
[17:43:25] ℹ️    - Diagnosis 4: ''
[17:43:25] ℹ️    - Diagnosis 5: ''
[17:43:25] ℹ️    - Diagnosis 6: ''
[17:43:25] ℹ️  Final extracted MRN: '2409497'
[17:43:25] ℹ️  Final extracted Sex: 'FEMALE'
[17:43:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:43:25] ℹ️  Final extracted Payer Source: ''
[17:43:25] ✅ Patient data extraction completed successfully
[17:43:25] ✅    ✅ Patient data extracted successfully
[17:43:25] 📊 Patient Response
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:43:25] ✅    ✅ Patient identified: Juliet Desnoyers
[17:43:25] ✅    ✅ Patient name validation passed
[17:43:25] 🔄 
🔄 Step 3: Processing patient dates...
[17:43:25] [DOC: 9204764] ℹ️  DOB normalized: 11/13/1938
[17:43:25] [DOC: 9204764] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[17:43:25] [DOC: 9204764] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[17:43:25] [DOC: 9204764] ✅ Patient date processing completed successfully
[17:43:25] ✅    ✅ Date processing completed
[17:43:25] 📊 Processed Patient Data
     └─ patientFName: Juliet
     └─ patientLName: Desnoyers
     └─ dob: 11/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2409497
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:43:25] 🔄 
🔄 Step 4: Extracting order data...
[17:43:28] ℹ️  Order extraction - MRN: '2409497'
[17:43:28] ℹ️  Order extraction - Sex: 'FEMALE'
[17:43:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:43:28] ℹ️  Order extraction - Payer Source: ''
[17:43:28] ✅ Order data extraction completed successfully
[17:43:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:43:28] ℹ️  Using MRN from patient data: '2409497' over '2409497'
[17:43:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:43:28] ✅ Patient name cross-validation successful
[17:43:28] ✅    ✅ Data merged successfully
[17:43:29] ✅    ✅ Order data extracted and validated
[17:43:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:43:36] [DOC: 9204764] ℹ️  Patient not found in cache or API: Juliet Desnoyers
[17:43:36] [DOC: 9204764] ℹ️  Patient not found, creating new patient via API...
[17:43:36] [DOC: 9204764] ℹ️  Creating patient via API: Juliet Desnoyers
[17:43:37] [DOC: 9204764] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:43:37] ❌    ❌ Failed to create patient
[17:43:37] [DOC: 9204764] ℹ️  API push details saved for document 9204764
================================================================================
║                        Processing Document ID: 9204757                         ║
================================================================================
[17:43:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:43:37] ℹ️  Date: 03/26/2025
[17:43:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:43:38] [DOC: 9204757] ✅ Text extracted using pdfplumber (2074 chars)
[17:43:38] ✅    ✅ Text extracted using pdfplumber (2074 chars)
[17:43:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:43:41] ℹ️  AI extracted raw sex value: 'M'
[17:43:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:43:41] ℹ️  AI extracted payer source: ''
[17:43:41] ℹ️  AI extracted diagnoses:
[17:43:41] ℹ️    - Diagnosis 1: 'None'
[17:43:41] ℹ️    - Diagnosis 2: 'None'
[17:43:41] ℹ️    - Diagnosis 3: 'None'
[17:43:41] ℹ️    - Diagnosis 4: 'None'
[17:43:41] ℹ️    - Diagnosis 5: 'None'
[17:43:41] ℹ️    - Diagnosis 6: 'None'
[17:43:41] ℹ️  Final extracted MRN: '2400478'
[17:43:41] ℹ️  Final extracted Sex: 'MALE'
[17:43:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:43:41] ℹ️  Final extracted Payer Source: ''
[17:43:41] ✅ Patient data extraction completed successfully
[17:43:41] ✅    ✅ Patient data extracted successfully
[17:43:41] 📊 Patient Response
     └─ patientFName: Juan
     └─ patientLName: Torres
     └─ dob: 05/10/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2400478
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:43:41] ✅    ✅ Patient identified: Juan Torres
[17:43:41] ✅    ✅ Patient name validation passed
[17:43:41] 🔄 
🔄 Step 3: Processing patient dates...
[17:43:41] [DOC: 9204757] ℹ️  DOB normalized: 05/10/1941
[17:43:41] [DOC: 9204757] ✅ Patient date processing completed successfully
[17:43:41] ✅    ✅ Date processing completed
[17:43:41] 📊 Processed Patient Data
     └─ patientFName: Juan
     └─ patientLName: Torres
     └─ dob: 05/10/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2400478
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:43:41] 🔄 
🔄 Step 4: Extracting order data...
[17:43:43] ℹ️  Order extraction - MRN: '2400478'
[17:43:43] ℹ️  Order extraction - Sex: 'MALE'
[17:43:43] ℹ️  Order extraction - Service Line: ''
[17:43:43] ℹ️  Order extraction - Payer Source: ''
[17:43:43] ✅ Order data extraction completed successfully
[17:43:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:43:43] ℹ️  Using MRN from patient data: '2400478' over '2400478'
[17:43:43] ℹ️  Using service line from patient data: 'Skilled Nursing'
[17:43:43] ✅ Patient name cross-validation successful
[17:43:43] ✅    ✅ Data merged successfully
[17:43:45] ⚠️     ❌ Skipping - missing episode start date
[17:43:45] [DOC: 9204757] ℹ️  API push details saved for document 9204757
================================================================================
║                        Processing Document ID: 9204744                         ║
================================================================================
[17:43:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:43:45] ℹ️  Date: 03/26/2025
[17:43:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:43:48] [DOC: 9204744] ✅ Text extracted using pdfplumber (22412 chars)
[17:43:48] ✅    ✅ Text extracted using pdfplumber (22400 chars)
[17:43:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:43:51] ℹ️  AI extracted raw sex value: 'F'
[17:43:51] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[17:43:51] ℹ️  AI extracted payer source: ''
[17:43:51] ℹ️  AI extracted diagnoses:
[17:43:51] ℹ️    - Diagnosis 1: 'I95.89'
[17:43:51] ℹ️    - Diagnosis 2: 'F03.90'
[17:43:51] ℹ️    - Diagnosis 3: 'M62.84'
[17:43:51] ℹ️    - Diagnosis 4: 'I10'
[17:43:51] ℹ️    - Diagnosis 5: 'L40.9'
[17:43:51] ℹ️    - Diagnosis 6: 'E66.3'
[17:43:51] ℹ️  Final extracted MRN: '2366208'
[17:43:51] ℹ️  Final extracted Sex: 'FEMALE'
[17:43:51] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work'
[17:43:51] ℹ️  Final extracted Payer Source: ''
[17:43:51] ✅ Patient data extraction completed successfully
[17:43:51] ✅    ✅ Patient data extracted successfully
[17:43:51] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Couto
     └─ dob: 07/02/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2366208
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I95.89', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'M62.84', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'L40.9', 'sixthDiagnosis': 'E66.3'}]
[17:43:51] ✅    ✅ Patient identified: Maria Couto
[17:43:51] ✅    ✅ Patient name validation passed
[17:43:51] 🔄 
🔄 Step 3: Processing patient dates...
[17:43:51] [DOC: 9204744] ℹ️  DOB normalized: 07/02/1943
[17:43:51] [DOC: 9204744] ℹ️  Episode startOfCare normalized: 03/04/2025
[17:43:51] [DOC: 9204744] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:43:51] [DOC: 9204744] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[17:43:51] [DOC: 9204744] ✅ Patient date processing completed successfully
[17:43:51] ✅    ✅ Date processing completed
[17:43:51] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Couto
     └─ dob: 07/02/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2366208
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I95.89', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'M62.84', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'L40.9', 'sixthDiagnosis': 'E66.3'}]
[17:43:51] 🔄 
🔄 Step 4: Extracting order data...
[17:43:54] ℹ️  Order extraction - MRN: '2366208'
[17:43:54] ℹ️  Order extraction - Sex: 'FEMALE'
[17:43:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work'
[17:43:54] ℹ️  Order extraction - Payer Source: ''
[17:43:54] ✅ Order data extraction completed successfully
[17:43:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:43:54] ℹ️  Using MRN from patient data: '2366208' over '2366208'
[17:43:54] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Medical Social Work' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy,Medical Social Work' = 'Medical Social Work, Occupational Therapy, Physical Therapy, Skilled Nursing'
[17:43:54] ✅ Patient name cross-validation successful
[17:43:54] ✅    ✅ Data merged successfully
[17:43:56] ✅    ✅ Order data extracted and validated
[17:43:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:44:19] [DOC: 9204744] ℹ️  Patient not found in cache or API: Maria Couto
[17:44:19] [DOC: 9204744] ℹ️  Patient not found, creating new patient via API...
[17:44:19] [DOC: 9204744] ℹ️  Creating patient via API: Maria Couto
[17:44:20] [DOC: 9204744] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:44:20] ❌    ❌ Failed to create patient
[17:44:20] [DOC: 9204744] ℹ️  API push details saved for document 9204744
================================================================================
║                        Processing Document ID: 9204734                         ║
================================================================================
[17:44:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:44:20] ℹ️  Date: 03/26/2025
[17:44:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:44:22] [DOC: 9204734] ✅ Text extracted using pdfplumber (3548 chars)
[17:44:22] ✅    ✅ Text extracted using pdfplumber (3548 chars)
[17:44:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:44:25] ℹ️  AI extracted raw sex value: 'M'
[17:44:25] ℹ️  AI extracted service line: 'Physical Therapy'
[17:44:25] ℹ️  AI extracted payer source: ''
[17:44:25] ℹ️  AI extracted diagnoses:
[17:44:25] ℹ️    - Diagnosis 1: ''
[17:44:25] ℹ️    - Diagnosis 2: ''
[17:44:25] ℹ️    - Diagnosis 3: ''
[17:44:25] ℹ️    - Diagnosis 4: ''
[17:44:25] ℹ️    - Diagnosis 5: ''
[17:44:25] ℹ️    - Diagnosis 6: ''
[17:44:25] ℹ️  Final extracted MRN: '2094562'
[17:44:25] ℹ️  Final extracted Sex: 'MALE'
[17:44:25] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:44:25] ℹ️  Final extracted Payer Source: ''
[17:44:25] ✅ Patient data extraction completed successfully
[17:44:25] ✅    ✅ Patient data extracted successfully
[17:44:25] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:44:25] ✅    ✅ Patient identified: Edward Correia
[17:44:25] ✅    ✅ Patient name validation passed
[17:44:25] 🔄 
🔄 Step 3: Processing patient dates...
[17:44:25] [DOC: 9204734] ℹ️  DOB normalized: 07/27/1950
[17:44:25] [DOC: 9204734] ✅ Patient date processing completed successfully
[17:44:25] ✅    ✅ Date processing completed
[17:44:25] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:44:25] 🔄 
🔄 Step 4: Extracting order data...
[17:44:27] ℹ️  Order extraction - MRN: '2094562'
[17:44:27] ℹ️  Order extraction - Sex: 'MALE'
[17:44:27] ℹ️  Order extraction - Service Line: ''
[17:44:27] ℹ️  Order extraction - Payer Source: ''
[17:44:27] ✅ Order data extraction completed successfully
[17:44:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:44:27] ℹ️  Using MRN from patient data: '2094562' over '2094562'
[17:44:27] ℹ️  Using service line from patient data: 'Physical Therapy'
[17:44:27] ✅ Patient name cross-validation successful
[17:44:27] ✅    ✅ Data merged successfully
[17:44:29] ⚠️     ❌ Skipping - missing episode start date
[17:44:29] [DOC: 9204734] ℹ️  API push details saved for document 9204734
================================================================================
║                        Processing Document ID: 9204721                         ║
================================================================================
[17:44:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:44:29] ℹ️  Date: 03/26/2025
[17:44:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:44:30] [DOC: 9204721] ✅ Text extracted using pdfplumber (1196 chars)
[17:44:30] ✅    ✅ Text extracted using pdfplumber (1196 chars)
[17:44:30] 🔄 
🔄 Step 2: Extracting patient data...
[17:44:33] ℹ️  AI extracted raw sex value: 'M'
[17:44:33] ℹ️  AI extracted service line: 'Nursing'
[17:44:33] ℹ️  AI extracted payer source: ''
[17:44:33] ℹ️  AI extracted diagnoses:
[17:44:33] ℹ️    - Diagnosis 1: ''
[17:44:33] ℹ️    - Diagnosis 2: ''
[17:44:33] ℹ️    - Diagnosis 3: ''
[17:44:33] ℹ️    - Diagnosis 4: ''
[17:44:33] ℹ️    - Diagnosis 5: ''
[17:44:33] ℹ️    - Diagnosis 6: ''
[17:44:33] ℹ️  Final extracted MRN: '2312121'
[17:44:33] ℹ️  Final extracted Sex: 'MALE'
[17:44:33] ℹ️  Final extracted Service Line: 'Nursing'
[17:44:33] ℹ️  Final extracted Payer Source: ''
[17:44:33] ✅ Patient data extraction completed successfully
[17:44:33] ✅    ✅ Patient data extracted successfully
[17:44:33] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:44:33] ✅    ✅ Patient identified: Antonio Carvalho
[17:44:33] ✅    ✅ Patient name validation passed
[17:44:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:44:33] [DOC: 9204721] ℹ️  DOB normalized: 07/01/1933
[17:44:33] [DOC: 9204721] ✅ Patient date processing completed successfully
[17:44:33] ✅    ✅ Date processing completed
[17:44:33] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:44:33] 🔄 
🔄 Step 4: Extracting order data...
[17:44:35] ℹ️  Order extraction - MRN: '2312121'
[17:44:35] ℹ️  Order extraction - Sex: 'MALE'
[17:44:35] ℹ️  Order extraction - Service Line: ''
[17:44:35] ℹ️  Order extraction - Payer Source: ''
[17:44:35] ✅ Order data extraction completed successfully
[17:44:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:44:35] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[17:44:35] ℹ️  Using service line from patient data: 'Nursing'
[17:44:35] ✅ Patient name cross-validation successful
[17:44:35] ✅    ✅ Data merged successfully
[17:44:36] ✅    ✅ Order data extracted and validated
[17:44:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:44:41] [DOC: 9204721] ℹ️  Patient not found in cache or API: Antonio Carvalho
[17:44:41] [DOC: 9204721] ℹ️  Patient not found, creating new patient via API...
[17:44:41] [DOC: 9204721] ℹ️  Creating patient via API: Antonio Carvalho
[17:44:42] [DOC: 9204721] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:44:42] ❌    ❌ Failed to create patient
[17:44:42] [DOC: 9204721] ℹ️  API push details saved for document 9204721
================================================================================
║                        Processing Document ID: 9204716                         ║
================================================================================
[17:44:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:44:42] ℹ️  Date: 03/26/2025
[17:44:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:44:44] [DOC: 9204716] ✅ Text extracted using pdfplumber (10101 chars)
[17:44:44] ✅    ✅ Text extracted using pdfplumber (10101 chars)
[17:44:44] 🔄 
🔄 Step 2: Extracting patient data...
[17:44:48] ℹ️  AI extracted raw sex value: 'F'
[17:44:48] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:44:48] ℹ️  AI extracted payer source: ''
[17:44:48] ℹ️  AI extracted diagnoses:
[17:44:48] ℹ️    - Diagnosis 1: 'C92.00'
[17:44:48] ℹ️    - Diagnosis 2: 'D63.0'
[17:44:48] ℹ️    - Diagnosis 3: 'D69.6'
[17:44:48] ℹ️    - Diagnosis 4: 'D72.820'
[17:44:48] ℹ️    - Diagnosis 5: 'M17.12'
[17:44:48] ℹ️    - Diagnosis 6: 'S80.12XD'
[17:44:48] ℹ️  Final extracted MRN: '2287746'
[17:44:48] ℹ️  Final extracted Sex: 'FEMALE'
[17:44:48] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:44:48] ℹ️  Final extracted Payer Source: ''
[17:44:48] ✅ Patient data extraction completed successfully
[17:44:48] ✅    ✅ Patient data extracted successfully
[17:44:48] 📊 Patient Response
     └─ patientFName: Priscilla
     └─ patientLName: Cabeca
     └─ dob: 01/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2287746
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': 'C92.00', 'secondDiagnosis': 'D63.0', 'thirdDiagnosis': 'D69.6', 'fourthDiagnosis': 'D72.820', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'S80.12XD'}]
[17:44:48] ✅    ✅ Patient identified: Priscilla Cabeca
[17:44:48] ✅    ✅ Patient name validation passed
[17:44:48] 🔄 
🔄 Step 3: Processing patient dates...
[17:44:48] [DOC: 9204716] ℹ️  DOB normalized: 01/21/1941
[17:44:48] [DOC: 9204716] ℹ️  Episode startOfCare normalized: 03/14/2025
[17:44:48] [DOC: 9204716] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[17:44:48] [DOC: 9204716] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[17:44:48] [DOC: 9204716] ✅ Patient date processing completed successfully
[17:44:48] ✅    ✅ Date processing completed
[17:44:48] 📊 Processed Patient Data
     └─ patientFName: Priscilla
     └─ patientLName: Cabeca
     └─ dob: 01/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2287746
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': 'C92.00', 'secondDiagnosis': 'D63.0', 'thirdDiagnosis': 'D69.6', 'fourthDiagnosis': 'D72.820', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'S80.12XD'}]
[17:44:48] 🔄 
🔄 Step 4: Extracting order data...
[17:44:50] ℹ️  Order extraction - MRN: '2287746'
[17:44:50] ℹ️  Order extraction - Sex: 'FEMALE'
[17:44:50] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:44:50] ℹ️  Order extraction - Payer Source: ''
[17:44:50] ✅ Order data extraction completed successfully
[17:44:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:44:50] ℹ️  Using MRN from patient data: '2287746' over '2287746'
[17:44:50] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:44:50] ✅ Patient name cross-validation successful
[17:44:50] ✅    ✅ Data merged successfully
[17:44:51] ✅    ✅ Order data extracted and validated
[17:44:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:44:58] [DOC: 9204716] ✅ Patient exists in API: Priscilla Cabeca, ID: eb0c3877-011b-4332-aac2-fb95712aa53e
[17:44:58] ✅    ✅ Existing patient found with ID: eb0c3877-011b-4332-aac2-fb95712aa53e
[17:44:58] 🔄 
🔄 Step 6: Pushing order to API...
[17:44:58] [DOC: 9204716] ℹ️  Pushing order via API for patient ID: eb0c3877-011b-4332-aac2-fb95712aa53e
[17:44:59] [DOC: 9204716] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13421"}
[17:44:59] ❌    ❌ Failed to push order
[17:44:59] 🔄 
🔄 Step 7: Writing to CSV...
[17:44:59] [DOC: 9204716] ℹ️  Calculated age: 84 from DOB: 01/21/1941
[17:44:59] [DOC: 9204716] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:44:59] [DOC: 9204716] ℹ️  Payer Source extracted: ''
[17:44:59] [DOC: 9204716] ℹ️  Diagnosis codes being written:
[17:44:59] [DOC: 9204716] ℹ️    - Latest_Episode_Firstdiagnosis: 'C92.00'
[17:44:59] [DOC: 9204716] ℹ️    - Latest_Episode_Seconddiagnosis: 'D63.0'
[17:44:59] [DOC: 9204716] ℹ️    - Latest_Episode_Thirddiagnosis: 'D69.6'
[17:44:59] [DOC: 9204716] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D72.820'
[17:44:59] [DOC: 9204716] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M17.12'
[17:44:59] [DOC: 9204716] ℹ️    - Latest_Episode_Sixthdiagnosis: 'S80.12XD'
[17:44:59] [DOC: 9204716] ✅ Patient data written to CSV: Priscilla Cabeca | Sex: FEMALE | Age: 84 | Service: Occupational Therapy | Payer:  | MRN: 2287746
[17:44:59] ✅    ✅ Document 9204716 processed and saved successfully
[17:44:59] 🔄 
🔄 Step 8: Saving API details...
[17:44:59] [DOC: 9204716] ℹ️  API push details saved for document 9204716
[17:44:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204710                         ║
================================================================================
[17:44:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:44:59] ℹ️  Date: 03/26/2025
[17:44:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:45:00] [DOC: 9204710] ✅ Text extracted using pdfplumber (1028 chars)
[17:45:00] ✅    ✅ Text extracted using pdfplumber (1028 chars)
[17:45:00] 🔄 
🔄 Step 2: Extracting patient data...
[17:45:03] ℹ️  AI extracted raw sex value: 'M'
[17:45:03] ℹ️  AI extracted service line: 'PT'
[17:45:03] ℹ️  AI extracted payer source: ''
[17:45:03] ℹ️  AI extracted diagnoses:
[17:45:03] ℹ️    - Diagnosis 1: ''
[17:45:03] ℹ️    - Diagnosis 2: ''
[17:45:03] ℹ️    - Diagnosis 3: ''
[17:45:03] ℹ️    - Diagnosis 4: ''
[17:45:03] ℹ️    - Diagnosis 5: ''
[17:45:03] ℹ️    - Diagnosis 6: ''
[17:45:03] ℹ️  Final extracted MRN: '2261639'
[17:45:03] ℹ️  Final extracted Sex: 'MALE'
[17:45:03] ℹ️  Final extracted Service Line: 'PT'
[17:45:03] ℹ️  Final extracted Payer Source: ''
[17:45:03] ✅ Patient data extraction completed successfully
[17:45:03] ✅    ✅ Patient data extracted successfully
[17:45:03] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:45:03] ✅    ✅ Patient identified: Webster Bowen
[17:45:03] ✅    ✅ Patient name validation passed
[17:45:03] 🔄 
🔄 Step 3: Processing patient dates...
[17:45:03] [DOC: 9204710] ℹ️  DOB normalized: 09/12/1949
[17:45:03] [DOC: 9204710] ✅ Patient date processing completed successfully
[17:45:03] ✅    ✅ Date processing completed
[17:45:03] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:45:03] 🔄 
🔄 Step 4: Extracting order data...
[17:45:05] ℹ️  Order extraction - MRN: '2261639'
[17:45:05] ℹ️  Order extraction - Sex: 'MALE'
[17:45:05] ℹ️  Order extraction - Service Line: 'PT'
[17:45:05] ℹ️  Order extraction - Payer Source: ''
[17:45:05] ✅ Order data extraction completed successfully
[17:45:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:45:05] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[17:45:05] ℹ️  Service line consistent in both sources: 'PT'
[17:45:05] ✅ Patient name cross-validation successful
[17:45:05] ✅    ✅ Data merged successfully
[17:45:06] ⚠️     ❌ Skipping - missing episode start date
[17:45:06] [DOC: 9204710] ℹ️  API push details saved for document 9204710
================================================================================
║                        Processing Document ID: 9204704                         ║
================================================================================
[17:45:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:45:06] ℹ️  Date: 03/26/2025
[17:45:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:45:08] [DOC: 9204704] ✅ Text extracted using pdfplumber (1388 chars)
[17:45:08] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[17:45:08] 🔄 
🔄 Step 2: Extracting patient data...
[17:45:10] ℹ️  AI extracted raw sex value: 'F'
[17:45:10] ℹ️  AI extracted service line: 'RN'
[17:45:10] ℹ️  AI extracted payer source: ''
[17:45:10] ℹ️  AI extracted diagnoses:
[17:45:10] ℹ️    - Diagnosis 1: 'None'
[17:45:10] ℹ️    - Diagnosis 2: 'None'
[17:45:10] ℹ️    - Diagnosis 3: 'None'
[17:45:10] ℹ️    - Diagnosis 4: 'None'
[17:45:10] ℹ️    - Diagnosis 5: 'None'
[17:45:10] ℹ️    - Diagnosis 6: 'None'
[17:45:10] ℹ️  Final extracted MRN: '2221050'
[17:45:10] ℹ️  Final extracted Sex: 'FEMALE'
[17:45:10] ℹ️  Final extracted Service Line: 'RN'
[17:45:10] ℹ️  Final extracted Payer Source: ''
[17:45:10] ✅ Patient data extraction completed successfully
[17:45:10] ✅    ✅ Patient data extracted successfully
[17:45:10] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Barros
     └─ dob: 04/30/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2221050
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:45:10] ✅    ✅ Patient identified: Maria Barros
[17:45:10] ✅    ✅ Patient name validation passed
[17:45:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:45:10] [DOC: 9204704] ℹ️  DOB normalized: 04/30/1936
[17:45:10] [DOC: 9204704] ✅ Patient date processing completed successfully
[17:45:10] ✅    ✅ Date processing completed
[17:45:10] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Barros
     └─ dob: 04/30/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2221050
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:45:10] 🔄 
🔄 Step 4: Extracting order data...
[17:45:12] ℹ️  Order extraction - MRN: '2221050'
[17:45:12] ℹ️  Order extraction - Sex: 'FEMALE'
[17:45:12] ℹ️  Order extraction - Service Line: ''
[17:45:12] ℹ️  Order extraction - Payer Source: ''
[17:45:12] ✅ Order data extraction completed successfully
[17:45:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:45:12] ℹ️  Using MRN from patient data: '2221050' over '2221050'
[17:45:12] ℹ️  Using service line from patient data: 'RN'
[17:45:12] ✅ Patient name cross-validation successful
[17:45:12] ✅    ✅ Data merged successfully
[17:45:13] ✅    ✅ Order data extracted and validated
[17:45:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:45:21] [DOC: 9204704] ℹ️  Patient not found in cache or API: Maria Barros
[17:45:21] [DOC: 9204704] ℹ️  Patient not found, creating new patient via API...
[17:45:21] [DOC: 9204704] ℹ️  Creating patient via API: Maria Barros
[17:45:22] [DOC: 9204704] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:45:22] ❌    ❌ Failed to create patient
[17:45:22] [DOC: 9204704] ℹ️  API push details saved for document 9204704
================================================================================
║                        Processing Document ID: 9204702                         ║
================================================================================
[17:45:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:45:22] ℹ️  Date: 03/26/2025
[17:45:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:45:23] [DOC: 9204702] ✅ Text extracted using pdfplumber (994 chars)
[17:45:23] ✅    ✅ Text extracted using pdfplumber (994 chars)
[17:45:23] 🔄 
🔄 Step 2: Extracting patient data...
[17:45:26] ℹ️  AI extracted raw sex value: 'F'
[17:45:26] ℹ️  AI extracted service line: 'Physical Therapy'
[17:45:26] ℹ️  AI extracted payer source: ''
[17:45:26] ℹ️  AI extracted diagnoses:
[17:45:26] ℹ️    - Diagnosis 1: 'None'
[17:45:26] ℹ️    - Diagnosis 2: 'None'
[17:45:26] ℹ️    - Diagnosis 3: 'None'
[17:45:26] ℹ️    - Diagnosis 4: 'None'
[17:45:26] ℹ️    - Diagnosis 5: 'None'
[17:45:26] ℹ️    - Diagnosis 6: 'None'
[17:45:26] ℹ️  Final extracted MRN: '2193337'
[17:45:26] ℹ️  Final extracted Sex: 'FEMALE'
[17:45:26] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:45:26] ℹ️  Final extracted Payer Source: ''
[17:45:26] ✅ Patient data extraction completed successfully
[17:45:26] ✅    ✅ Patient data extracted successfully
[17:45:26] 📊 Patient Response
     └─ patientFName: Muriel
     └─ patientLName: Angers
     └─ dob: 01/21/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2193337
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:45:26] ✅    ✅ Patient identified: Muriel Angers
[17:45:26] ✅    ✅ Patient name validation passed
[17:45:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:45:26] [DOC: 9204702] ℹ️  DOB normalized: 01/21/1935
[17:45:26] [DOC: 9204702] ✅ Patient date processing completed successfully
[17:45:26] ✅    ✅ Date processing completed
[17:45:26] 📊 Processed Patient Data
     └─ patientFName: Muriel
     └─ patientLName: Angers
     └─ dob: 01/21/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2193337
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:45:26] 🔄 
🔄 Step 4: Extracting order data...
[17:45:28] ℹ️  Order extraction - MRN: '2193337'
[17:45:28] ℹ️  Order extraction - Sex: 'FEMALE'
[17:45:28] ℹ️  Order extraction - Service Line: 'PT'
[17:45:28] ℹ️  Order extraction - Payer Source: ''
[17:45:28] ✅ Order data extraction completed successfully
[17:45:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:45:28] ℹ️  Using MRN from patient data: '2193337' over '2193337'
[17:45:28] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[17:45:28] ✅ Patient name cross-validation successful
[17:45:28] ✅    ✅ Data merged successfully
[17:45:29] ✅    ✅ Order data extracted and validated
[17:45:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:45:34] [DOC: 9204702] ℹ️  Patient not found in cache or API: Muriel Angers
[17:45:34] [DOC: 9204702] ℹ️  Patient not found, creating new patient via API...
[17:45:34] [DOC: 9204702] ℹ️  Creating patient via API: Muriel Angers
[17:45:35] [DOC: 9204702] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:45:35] ❌    ❌ Failed to create patient
[17:45:35] [DOC: 9204702] ℹ️  API push details saved for document 9204702
================================================================================
║                        Processing Document ID: 9204692                         ║
================================================================================
[17:45:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:45:35] ℹ️  Date: 03/26/2025
[17:45:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:45:37] [DOC: 9204692] ✅ Text extracted using pdfplumber (1658 chars)
[17:45:37] ✅    ✅ Text extracted using pdfplumber (1658 chars)
[17:45:37] 🔄 
🔄 Step 2: Extracting patient data...
[17:45:39] ℹ️  AI extracted raw sex value: 'F'
[17:45:39] ℹ️  AI extracted service line: 'RN'
[17:45:39] ℹ️  AI extracted payer source: ''
[17:45:39] ℹ️  AI extracted diagnoses:
[17:45:39] ℹ️    - Diagnosis 1: 'None'
[17:45:39] ℹ️    - Diagnosis 2: 'None'
[17:45:39] ℹ️    - Diagnosis 3: 'None'
[17:45:39] ℹ️    - Diagnosis 4: 'None'
[17:45:39] ℹ️    - Diagnosis 5: 'None'
[17:45:39] ℹ️    - Diagnosis 6: 'None'
[17:45:39] ℹ️  Final extracted MRN: '2168743'
[17:45:39] ℹ️  Final extracted Sex: 'FEMALE'
[17:45:39] ℹ️  Final extracted Service Line: 'RN'
[17:45:39] ℹ️  Final extracted Payer Source: ''
[17:45:39] ✅ Patient data extraction completed successfully
[17:45:39] ✅    ✅ Patient data extracted successfully
[17:45:39] 📊 Patient Response
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:45:39] ✅    ✅ Patient identified: Sheila Adesso
[17:45:39] ✅    ✅ Patient name validation passed
[17:45:39] 🔄 
🔄 Step 3: Processing patient dates...
[17:45:39] [DOC: 9204692] ℹ️  DOB normalized: 11/24/1963
[17:45:39] [DOC: 9204692] ✅ Patient date processing completed successfully
[17:45:39] ✅    ✅ Date processing completed
[17:45:39] 📊 Processed Patient Data
     └─ patientFName: Sheila
     └─ patientLName: Adesso
     └─ dob: 11/24/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2168743
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:45:39] 🔄 
🔄 Step 4: Extracting order data...
[17:45:42] ℹ️  Order extraction - MRN: '2168743'
[17:45:42] ℹ️  Order extraction - Sex: 'FEMALE'
[17:45:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:45:42] ℹ️  Order extraction - Payer Source: ''
[17:45:42] ✅ Order data extraction completed successfully
[17:45:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:45:42] ℹ️  Using MRN from patient data: '2168743' over '2168743'
[17:45:42] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[17:45:42] ✅ Patient name cross-validation successful
[17:45:42] ✅    ✅ Data merged successfully
[17:45:43] ⚠️     ❌ Skipping - missing episode start date
[17:45:43] [DOC: 9204692] ℹ️  API push details saved for document 9204692
================================================================================
║                        Processing Document ID: 9204659                         ║
================================================================================
[17:45:43] ℹ️  Agency: Alphacare Home Health Agency
[17:45:43] ℹ️  Date: 03/26/2025
[17:45:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:45:48] [DOC: 9204659] ✅ Text extracted using pdfplumber (23987 chars)
[17:45:48] ✅    ✅ Text extracted using pdfplumber (23987 chars)
[17:45:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:45:52] ℹ️  AI extracted raw sex value: 'M'
[17:45:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:45:52] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[17:45:52] ℹ️  AI extracted diagnoses:
[17:45:52] ℹ️    - Diagnosis 1: 'F31.81'
[17:45:52] ℹ️    - Diagnosis 2: 'F33.9'
[17:45:52] ℹ️    - Diagnosis 3: 'F41.1'
[17:45:52] ℹ️    - Diagnosis 4: 'M79.7'
[17:45:52] ℹ️    - Diagnosis 5: 'E66.9'
[17:45:52] ℹ️    - Diagnosis 6: 'M50.90'
[17:45:52] ℹ️  Final extracted MRN: '000001761'
[17:45:52] ℹ️  Final extracted Sex: 'MALE'
[17:45:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:45:52] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[17:45:52] ✅ Patient data extraction completed successfully
[17:45:52] ✅    ✅ Patient data extracted successfully
[17:45:52] 📊 Patient Response
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[17:45:52] ✅    ✅ Patient identified: Melissa Edwards
[17:45:52] ✅    ✅ Patient name validation passed
[17:45:52] 🔄 
🔄 Step 3: Processing patient dates...
[17:45:52] [DOC: 9204659] ℹ️  DOB normalized: 07/10/1978
[17:45:52] [DOC: 9204659] ℹ️  Episode startOfCare normalized: 05/21/2021
[17:45:52] [DOC: 9204659] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[17:45:52] [DOC: 9204659] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[17:45:52] [DOC: 9204659] ✅ Patient date processing completed successfully
[17:45:52] ✅    ✅ Date processing completed
[17:45:52] 📊 Processed Patient Data
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[17:45:52] 🔄 
🔄 Step 4: Extracting order data...
[17:45:55] ℹ️  Order extraction - MRN: '000001761'
[17:45:55] ℹ️  Order extraction - Sex: 'MALE'
[17:45:55] ℹ️  Order extraction - Service Line: 'RN'
[17:45:55] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[17:45:55] ✅ Order data extraction completed successfully
[17:45:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:45:55] ℹ️  Using MRN from patient data: '000001761' over '000001761'
[17:45:55] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[17:45:55] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[17:45:55] ✅ Patient name cross-validation successful
[17:45:55] ✅    ✅ Data merged successfully
[17:45:56] ✅    ✅ Order data extracted and validated
[17:45:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:45:56] [DOC: 9204659] ✅ Patient found in local cache: Melissa Edwards, ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[17:45:56] ✅    ✅ Existing patient found with ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[17:45:56] 🔄 
🔄 Step 6: Pushing order to API...
[17:45:56] [DOC: 9204659] ℹ️  Pushing order via API for patient ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[17:45:57] [DOC: 9204659] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:45:57] ❌    ❌ Failed to push order
[17:45:57] 🔄 
🔄 Step 7: Writing to CSV...
[17:45:57] [DOC: 9204659] ℹ️  Calculated age: 46 from DOB: 07/10/1978
[17:45:57] [DOC: 9204659] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[17:45:57] [DOC: 9204659] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[17:45:57] [DOC: 9204659] ℹ️  Diagnosis codes being written:
[17:45:57] [DOC: 9204659] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.81'
[17:45:57] [DOC: 9204659] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.9'
[17:45:57] [DOC: 9204659] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[17:45:57] [DOC: 9204659] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M79.7'
[17:45:57] [DOC: 9204659] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.9'
[17:45:57] [DOC: 9204659] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M50.90'
[17:45:57] [DOC: 9204659] ✅ Patient data written to CSV: Melissa Edwards | Sex: MALE | Age: 46 | Service: RN, Skilled Nursing | Payer: MassHealth (Medicaid) | MRN: 000001761
[17:45:57] ✅    ✅ Document 9204659 processed and saved successfully
[17:45:57] 🔄 
🔄 Step 8: Saving API details...
[17:45:57] [DOC: 9204659] ℹ️  API push details saved for document 9204659
[17:45:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204644                         ║
================================================================================
[17:45:57] ℹ️  Agency: Alphacare Home Health Agency
[17:45:57] ℹ️  Date: 03/26/2025
[17:45:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:45:59] [DOC: 9204644] ✅ Text extracted using pdfplumber (1533 chars)
[17:45:59] ✅    ✅ Text extracted using pdfplumber (1533 chars)
[17:45:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:46:02] ℹ️  AI extracted raw sex value: ''
[17:46:02] ℹ️  AI extracted service line: 'HHA'
[17:46:02] ℹ️  AI extracted payer source: ''
[17:46:02] ℹ️  AI extracted diagnoses:
[17:46:02] ℹ️    - Diagnosis 1: ''
[17:46:02] ℹ️    - Diagnosis 2: ''
[17:46:02] ℹ️    - Diagnosis 3: ''
[17:46:02] ℹ️    - Diagnosis 4: ''
[17:46:02] ℹ️    - Diagnosis 5: ''
[17:46:02] ℹ️    - Diagnosis 6: ''
[17:46:02] ℹ️  Final extracted MRN: '000003599'
[17:46:02] ℹ️  Final extracted Sex: ''
[17:46:02] ℹ️  Final extracted Service Line: 'HHA'
[17:46:02] ℹ️  Final extracted Payer Source: ''
[17:46:02] ✅ Patient data extraction completed successfully
[17:46:02] ✅    ✅ Patient data extracted successfully
[17:46:02] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:46:02] ✅    ✅ Patient identified: June Stykowski
[17:46:02] ✅    ✅ Patient name validation passed
[17:46:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:46:02] [DOC: 9204644] ℹ️  DOB normalized: 11/08/1952
[17:46:02] [DOC: 9204644] ✅ Patient date processing completed successfully
[17:46:02] ✅    ✅ Date processing completed
[17:46:02] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:46:02] 🔄 
🔄 Step 4: Extracting order data...
[17:46:04] ℹ️  Order extraction - MRN: '000003599'
[17:46:04] ℹ️  Order extraction - Sex: ''
[17:46:04] ℹ️  Order extraction - Service Line: 'HHA'
[17:46:04] ℹ️  Order extraction - Payer Source: ''
[17:46:04] ✅ Order data extraction completed successfully
[17:46:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:46:04] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[17:46:04] ⚠️  Could not determine sex using any available method
[17:46:04] ℹ️  Service line consistent in both sources: 'HHA'
[17:46:04] ✅ Patient name cross-validation successful
[17:46:04] ✅    ✅ Data merged successfully
[17:46:05] ⚠️     ❌ Skipping - missing episode start date
[17:46:05] [DOC: 9204644] ℹ️  API push details saved for document 9204644
================================================================================
║                        Processing Document ID: 9204499                         ║
================================================================================
[17:46:05] ℹ️  Agency: Alphacare Home Health Agency
[17:46:05] ℹ️  Date: 03/26/2025
[17:46:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:46:08] [DOC: 9204499] ✅ Text extracted using pdfplumber (1632 chars)
[17:46:08] ✅    ✅ Text extracted using pdfplumber (1632 chars)
[17:46:08] 🔄 
🔄 Step 2: Extracting patient data...
[17:46:11] ℹ️  AI extracted raw sex value: ''
[17:46:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:46:11] ℹ️  AI extracted payer source: ''
[17:46:11] ℹ️  AI extracted diagnoses:
[17:46:11] ℹ️    - Diagnosis 1: 'None'
[17:46:11] ℹ️    - Diagnosis 2: 'None'
[17:46:11] ℹ️    - Diagnosis 3: 'None'
[17:46:11] ℹ️    - Diagnosis 4: 'None'
[17:46:11] ℹ️    - Diagnosis 5: 'None'
[17:46:11] ℹ️    - Diagnosis 6: 'None'
[17:46:11] ℹ️  Final extracted MRN: '000003599'
[17:46:11] ℹ️  Final extracted Sex: ''
[17:46:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:46:11] ℹ️  Final extracted Payer Source: ''
[17:46:11] ✅ Patient data extraction completed successfully
[17:46:11] ✅    ✅ Patient data extracted successfully
[17:46:11] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:46:11] ✅    ✅ Patient identified: June Stykowski
[17:46:11] ✅    ✅ Patient name validation passed
[17:46:11] 🔄 
🔄 Step 3: Processing patient dates...
[17:46:11] [DOC: 9204499] ℹ️  DOB normalized: 11/08/1952
[17:46:11] [DOC: 9204499] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[17:46:11] [DOC: 9204499] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[17:46:11] [DOC: 9204499] ✅ Patient date processing completed successfully
[17:46:11] ✅    ✅ Date processing completed
[17:46:11] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: 
     └─ medicalRecordNo: 000003599
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025'}]
[17:46:11] 🔄 
🔄 Step 4: Extracting order data...
[17:46:13] ⚠️  JSON parsing failed (attempt 1): Invalid control character at: line 23 column 27 (char 570)
[17:46:17] ⚠️  JSON parsing failed (attempt 2): Invalid control character at: line 23 column 27 (char 543)
[17:46:20] ⚠️  JSON parsing failed (attempt 3): Invalid control character at: line 23 column 27 (char 569)
[17:46:20] ❌ All JSON parsing attempts failed
[17:46:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:46:20] ℹ️  Using MRN from patient data: '000003599'
[17:46:20] ⚠️  Could not determine sex using any available method
[17:46:20] ℹ️  Using service line from patient data: 'Skilled Nursing'
[17:46:20] ✅    ✅ Data merged successfully
[17:46:21] ⚠️     ❌ Skipping - missing episode start date
[17:46:21] [DOC: 9204499] ℹ️  API push details saved for document 9204499
================================================================================
║                        Processing Document ID: 9204360                         ║
================================================================================
[17:46:21] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:46:21] ℹ️  Date: 03/26/2025
[17:46:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:46:24] [DOC: 9204360] ✅ Text extracted using pdfplumber (94763 chars)
[17:46:24] ✅    ✅ Text extracted using pdfplumber (94763 chars)
[17:46:24] 🔄 
🔄 Step 2: Extracting patient data...
[17:46:29] ℹ️  AI extracted raw sex value: 'None'
[17:46:29] ℹ️  AI extracted service line: 'None'
[17:46:29] ℹ️  AI extracted payer source: 'None'
[17:46:29] ℹ️  AI extracted diagnoses:
[17:46:29] ℹ️    - Diagnosis 1: ''
[17:46:29] ℹ️    - Diagnosis 2: ''
[17:46:29] ℹ️    - Diagnosis 3: ''
[17:46:29] ℹ️    - Diagnosis 4: ''
[17:46:29] ℹ️    - Diagnosis 5: ''
[17:46:29] ℹ️    - Diagnosis 6: ''
[17:46:29] ℹ️  Final extracted MRN: ''
[17:46:29] ℹ️  Final extracted Sex: ''
[17:46:29] ℹ️  Final extracted Service Line: ''
[17:46:29] ℹ️  Final extracted Payer Source: ''
[17:46:29] ✅ Patient data extraction completed successfully
[17:46:29] ✅    ✅ Patient data extracted successfully
[17:46:29] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[17:46:29] ⚠️     ❌ Insufficient patient data extracted
[17:46:29] [DOC: 9204360] ℹ️  API push details saved for document 9204360
================================================================================
║                        Processing Document ID: 9204304                         ║
================================================================================
[17:46:29] ℹ️  Agency: Dartmouth HH
[17:46:29] ℹ️  Date: 03/26/2025
[17:46:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:46:33] [DOC: 9204304] ✅ Text extracted using pdfplumber (11304 chars)
[17:46:33] ✅    ✅ Text extracted using pdfplumber (11292 chars)
[17:46:33] 🔄 
🔄 Step 2: Extracting patient data...
[17:46:36] ℹ️  AI extracted raw sex value: 'F'
[17:46:36] ℹ️  AI extracted service line: 'PT'
[17:46:36] ℹ️  AI extracted payer source: 'None'
[17:46:36] ℹ️  AI extracted diagnoses:
[17:46:36] ℹ️    - Diagnosis 1: 'Z47.1'
[17:46:36] ℹ️    - Diagnosis 2: 'E66.9'
[17:46:36] ℹ️    - Diagnosis 3: 'Z68.37'
[17:46:36] ℹ️    - Diagnosis 4: 'M19.90'
[17:46:36] ℹ️    - Diagnosis 5: 'D50.9'
[17:46:36] ℹ️    - Diagnosis 6: 'F41.9'
[17:46:36] ℹ️  Final extracted MRN: '6043015'
[17:46:36] ℹ️  Final extracted Sex: 'FEMALE'
[17:46:36] ℹ️  Final extracted Service Line: 'PT'
[17:46:36] ℹ️  Final extracted Payer Source: ''
[17:46:36] ✅ Patient data extraction completed successfully
[17:46:36] ✅    ✅ Patient data extracted successfully
[17:46:36] 📊 Patient Response
     └─ patientFName: Debra
     └─ patientLName: Ozug
     └─ dob: 10/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6043015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.37', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'F41.9'}]
[17:46:36] ✅    ✅ Patient identified: Debra Ozug
[17:46:36] ✅    ✅ Patient name validation passed
[17:46:36] 🔄 
🔄 Step 3: Processing patient dates...
[17:46:36] [DOC: 9204304] ℹ️  DOB normalized: 10/08/1957
[17:46:36] [DOC: 9204304] ℹ️  Episode startOfCare normalized: 03/20/2025
[17:46:36] [DOC: 9204304] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[17:46:36] [DOC: 9204304] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[17:46:36] [DOC: 9204304] ✅ Patient date processing completed successfully
[17:46:36] ✅    ✅ Date processing completed
[17:46:36] 📊 Processed Patient Data
     └─ patientFName: Debra
     └─ patientLName: Ozug
     └─ dob: 10/08/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6043015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.37', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'F41.9'}]
[17:46:36] 🔄 
🔄 Step 4: Extracting order data...
[17:46:38] ℹ️  Order extraction - MRN: '6043015'
[17:46:38] ℹ️  Order extraction - Sex: 'FEMALE'
[17:46:38] ℹ️  Order extraction - Service Line: 'PT, RN'
[17:46:38] ℹ️  Order extraction - Payer Source: ''
[17:46:38] ✅ Order data extraction completed successfully
[17:46:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:46:38] ℹ️  Using MRN from patient data: '6043015' over '6043015'
[17:46:38] ℹ️  Combined service lines: Patient='PT' + Order='PT, RN' = 'PT, RN'
[17:46:38] ✅ Patient name cross-validation successful
[17:46:38] ✅    ✅ Data merged successfully
[17:46:39] ✅    ✅ Order data extracted and validated
[17:46:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:46:48] [DOC: 9204304] ✅ Patient exists in API: Debra Ozug, ID: 9adb191b-5424-4c5c-9a7b-715e2cbd658c
[17:46:48] ✅    ✅ Existing patient found with ID: 9adb191b-5424-4c5c-9a7b-715e2cbd658c
[17:46:48] 🔄 
🔄 Step 6: Pushing order to API...
[17:46:48] [DOC: 9204304] ℹ️  Pushing order via API for patient ID: 9adb191b-5424-4c5c-9a7b-715e2cbd658c
[17:46:49] [DOC: 9204304] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:46:49] ❌    ❌ Failed to push order
[17:46:49] 🔄 
🔄 Step 7: Writing to CSV...
[17:46:49] [DOC: 9204304] ℹ️  Calculated age: 67 from DOB: 10/08/1957
[17:46:49] [DOC: 9204304] ℹ️  Service Line extracted: 'PT, RN'
[17:46:49] [DOC: 9204304] ℹ️  Payer Source extracted: ''
[17:46:49] [DOC: 9204304] ℹ️  Diagnosis codes being written:
[17:46:49] [DOC: 9204304] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[17:46:49] [DOC: 9204304] ℹ️    - Latest_Episode_Seconddiagnosis: 'E66.9'
[17:46:49] [DOC: 9204304] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z68.37'
[17:46:49] [DOC: 9204304] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M19.90'
[17:46:49] [DOC: 9204304] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D50.9'
[17:46:49] [DOC: 9204304] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:46:49] [DOC: 9204304] ✅ Patient data written to CSV: Debra Ozug | Sex: FEMALE | Age: 67 | Service: PT, RN | Payer:  | MRN: 6043015
[17:46:49] ✅    ✅ Document 9204304 processed and saved successfully
[17:46:49] 🔄 
🔄 Step 8: Saving API details...
[17:46:49] [DOC: 9204304] ℹ️  API push details saved for document 9204304
[17:46:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204300                         ║
================================================================================
[17:46:49] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:46:49] ℹ️  Date: 03/26/2025
[17:46:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:47:19] [DOC: 9204300] ⚠️  Network error attempt 1, retrying...
[17:47:23] [DOC: 9204300] ✅ Text extracted using pdfplumber (1839 chars)
[17:47:23] ✅    ✅ Text extracted using pdfplumber (1839 chars)
[17:47:23] 🔄 
🔄 Step 2: Extracting patient data...
[17:47:26] ℹ️  AI extracted raw sex value: 'M'
[17:47:26] ℹ️  AI extracted service line: 'RN'
[17:47:26] ℹ️  AI extracted payer source: 'Senior Whole Health'
[17:47:26] ℹ️  AI extracted diagnoses:
[17:47:26] ℹ️    - Diagnosis 1: 'None'
[17:47:26] ℹ️    - Diagnosis 2: 'None'
[17:47:26] ℹ️    - Diagnosis 3: 'None'
[17:47:26] ℹ️    - Diagnosis 4: 'None'
[17:47:26] ℹ️    - Diagnosis 5: 'None'
[17:47:26] ℹ️    - Diagnosis 6: 'None'
[17:47:26] ℹ️  Final extracted MRN: '114004'
[17:47:26] ℹ️  Final extracted Sex: 'MALE'
[17:47:26] ℹ️  Final extracted Service Line: 'RN'
[17:47:26] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[17:47:26] ✅ Patient data extraction completed successfully
[17:47:26] ✅    ✅ Patient data extracted successfully
[17:47:26] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:47:26] ✅    ✅ Patient identified: Donald Brown
[17:47:26] ✅    ✅ Patient name validation passed
[17:47:26] 🔄 
🔄 Step 3: Processing patient dates...
[17:47:26] [DOC: 9204300] ℹ️  DOB normalized: 06/18/1949
[17:47:26] [DOC: 9204300] ℹ️  Episode startOfCare normalized: 12/01/2018
[17:47:26] [DOC: 9204300] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[17:47:26] [DOC: 9204300] ✅ Patient date processing completed successfully
[17:47:26] ✅    ✅ Date processing completed
[17:47:26] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'endOfEpisode': '04/27/2025'}]
[17:47:26] 🔄 
🔄 Step 4: Extracting order data...
[17:47:29] ℹ️  Order extraction - MRN: '114004'
[17:47:29] ℹ️  Order extraction - Sex: 'MALE'
[17:47:29] ℹ️  Order extraction - Service Line: ''
[17:47:29] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[17:47:29] ✅ Order data extraction completed successfully
[17:47:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:47:29] ℹ️  Using MRN from patient data: '114004' over '114004'
[17:47:29] ℹ️  Using service line from patient data: 'RN'
[17:47:29] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[17:47:29] ✅ Patient name cross-validation successful
[17:47:29] ✅    ✅ Data merged successfully
[17:47:30] ✅    ✅ Order data extracted and validated
[17:47:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:47:30] [DOC: 9204300] ✅ Patient found in local cache: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[17:47:30] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[17:47:30] 🔄 
🔄 Step 6: Pushing order to API...
[17:47:30] [DOC: 9204300] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[17:47:31] [DOC: 9204300] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:47:31] ❌    ❌ Failed to push order
[17:47:31] 🔄 
🔄 Step 7: Writing to CSV...
[17:47:31] [DOC: 9204300] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[17:47:31] [DOC: 9204300] ℹ️  Service Line extracted: 'RN'
[17:47:31] [DOC: 9204300] ℹ️  Payer Source extracted: 'Senior Whole Health'
[17:47:31] [DOC: 9204300] ℹ️  Diagnosis codes being written:
[17:47:31] [DOC: 9204300] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:47:31] [DOC: 9204300] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:47:31] [DOC: 9204300] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:47:31] [DOC: 9204300] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:47:31] [DOC: 9204300] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:47:31] [DOC: 9204300] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:47:31] [DOC: 9204300] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: RN | Payer: Senior Whole Health | MRN: 114004
[17:47:31] ✅    ✅ Document 9204300 processed and saved successfully
[17:47:31] 🔄 
🔄 Step 8: Saving API details...
[17:47:31] [DOC: 9204300] ℹ️  API push details saved for document 9204300
[17:47:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204288                         ║
================================================================================
[17:47:31] ℹ️  Agency: Dartmouth HH
[17:47:31] ℹ️  Date: 03/26/2025
[17:47:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:47:34] [DOC: 9204288] ✅ Text extracted using pdfplumber (10176 chars)
[17:47:34] ✅    ✅ Text extracted using pdfplumber (10164 chars)
[17:47:34] 🔄 
🔄 Step 2: Extracting patient data...
[17:47:37] ℹ️  AI extracted raw sex value: 'F'
[17:47:37] ℹ️  AI extracted service line: 'PT, RN'
[17:47:37] ℹ️  AI extracted payer source: ''
[17:47:37] ℹ️  AI extracted diagnoses:
[17:47:37] ℹ️    - Diagnosis 1: 'Z47.1'
[17:47:37] ℹ️    - Diagnosis 2: 'Z96.652'
[17:47:37] ℹ️    - Diagnosis 3: 'J96.01'
[17:47:37] ℹ️    - Diagnosis 4: 'I13.0'
[17:47:37] ℹ️    - Diagnosis 5: 'I50.33'
[17:47:37] ℹ️    - Diagnosis 6: 'N18.32'
[17:47:37] ℹ️  Final extracted MRN: '804015'
[17:47:37] ℹ️  Final extracted Sex: 'FEMALE'
[17:47:37] ℹ️  Final extracted Service Line: 'PT, RN'
[17:47:37] ℹ️  Final extracted Payer Source: ''
[17:47:37] ✅ Patient data extraction completed successfully
[17:47:37] ✅    ✅ Patient data extracted successfully
[17:47:37] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 804015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.32'}]
[17:47:37] ✅    ✅ Patient identified: Joan Harb
[17:47:37] ✅    ✅ Patient name validation passed
[17:47:37] 🔄 
🔄 Step 3: Processing patient dates...
[17:47:37] [DOC: 9204288] ℹ️  DOB normalized: 12/27/1945
[17:47:37] [DOC: 9204288] ℹ️  Episode startOfCare normalized: 01/14/2025
[17:47:37] [DOC: 9204288] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[17:47:37] [DOC: 9204288] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[17:47:37] [DOC: 9204288] ✅ Patient date processing completed successfully
[17:47:37] ✅    ✅ Date processing completed
[17:47:37] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 804015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.32'}]
[17:47:37] 🔄 
🔄 Step 4: Extracting order data...
[17:47:39] ℹ️  Order extraction - MRN: '804015'
[17:47:39] ℹ️  Order extraction - Sex: 'FEMALE'
[17:47:39] ℹ️  Order extraction - Service Line: 'PT, RN'
[17:47:39] ℹ️  Order extraction - Payer Source: ''
[17:47:39] ✅ Order data extraction completed successfully
[17:47:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:47:39] ℹ️  Using MRN from patient data: '804015' over '804015'
[17:47:39] ℹ️  Service line consistent in both sources: 'PT, RN'
[17:47:39] ✅ Patient name cross-validation successful
[17:47:39] ✅    ✅ Data merged successfully
[17:47:40] ✅    ✅ Order data extracted and validated
[17:47:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:47:40] [DOC: 9204288] ✅ Patient found in local cache: Joan Harb, ID: e6448657-0278-414c-9f62-37332e5b561b
[17:47:40] ✅    ✅ Existing patient found with ID: e6448657-0278-414c-9f62-37332e5b561b
[17:47:40] 🔄 
🔄 Step 6: Pushing order to API...
[17:47:40] [DOC: 9204288] ℹ️  Pushing order via API for patient ID: e6448657-0278-414c-9f62-37332e5b561b
[17:47:41] [DOC: 9204288] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:47:41] ❌    ❌ Failed to push order
[17:47:41] 🔄 
🔄 Step 7: Writing to CSV...
[17:47:41] [DOC: 9204288] ℹ️  Calculated age: 79 from DOB: 12/27/1945
[17:47:41] [DOC: 9204288] ℹ️  Service Line extracted: 'PT, RN'
[17:47:41] [DOC: 9204288] ℹ️  Payer Source extracted: ''
[17:47:41] [DOC: 9204288] ℹ️  Diagnosis codes being written:
[17:47:41] [DOC: 9204288] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[17:47:41] [DOC: 9204288] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.652'
[17:47:41] [DOC: 9204288] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.01'
[17:47:41] [DOC: 9204288] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I13.0'
[17:47:41] [DOC: 9204288] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.33'
[17:47:41] [DOC: 9204288] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.32'
[17:47:41] [DOC: 9204288] ✅ Patient data written to CSV: Joan Harb | Sex: FEMALE | Age: 79 | Service: PT, RN | Payer:  | MRN: 804015
[17:47:41] ✅    ✅ Document 9204288 processed and saved successfully
[17:47:41] 🔄 
🔄 Step 8: Saving API details...
[17:47:41] [DOC: 9204288] ℹ️  API push details saved for document 9204288
[17:47:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204260                         ║
================================================================================
[17:47:41] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:47:41] ℹ️  Date: 03/26/2025
[17:47:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:47:43] [DOC: 9204260] ✅ Text extracted using pdfplumber (2659 chars)
[17:47:43] ✅    ✅ Text extracted using pdfplumber (2659 chars)
[17:47:43] 🔄 
🔄 Step 2: Extracting patient data...
[17:47:47] ℹ️  AI extracted raw sex value: 'M'
[17:47:47] ℹ️  AI extracted service line: 'HHA'
[17:47:47] ℹ️  AI extracted payer source: 'Medicaid/MA'
[17:47:47] ℹ️  AI extracted diagnoses:
[17:47:47] ℹ️    - Diagnosis 1: 'F25.0'
[17:47:47] ℹ️    - Diagnosis 2: 'E11.22'
[17:47:47] ℹ️    - Diagnosis 3: 'I13.10'
[17:47:47] ℹ️    - Diagnosis 4: 'N18.31'
[17:47:47] ℹ️    - Diagnosis 5: 'F41.0'
[17:47:47] ℹ️    - Diagnosis 6: 'F41.9'
[17:47:47] ℹ️  Final extracted MRN: '879'
[17:47:47] ℹ️  Final extracted Sex: 'MALE'
[17:47:47] ℹ️  Final extracted Service Line: 'HHA'
[17:47:47] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[17:47:47] ✅ Patient data extraction completed successfully
[17:47:47] ✅    ✅ Patient data extracted successfully
[17:47:47] 📊 Patient Response
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/30/2024', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[17:47:47] ✅    ✅ Patient identified: Sean McCarthy
[17:47:47] ✅    ✅ Patient name validation passed
[17:47:47] 🔄 
🔄 Step 3: Processing patient dates...
[17:47:47] [DOC: 9204260] ℹ️  DOB normalized: 09/16/1969
[17:47:47] [DOC: 9204260] ℹ️  Episode startOfCare normalized: 03/30/2024
[17:47:47] [DOC: 9204260] ℹ️  Episode startOfEpisode normalized: 03/30/2024
[17:47:47] [DOC: 9204260] ℹ️  Episode endOfEpisode normalized: 03/24/2025
[17:47:47] [DOC: 9204260] ✅ Patient date processing completed successfully
[17:47:47] ✅    ✅ Date processing completed
[17:47:47] 📊 Processed Patient Data
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/30/2024', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[17:47:47] 🔄 
🔄 Step 4: Extracting order data...
[17:47:49] ℹ️  Order extraction - MRN: '879'
[17:47:49] ℹ️  Order extraction - Sex: 'MALE'
[17:47:49] ℹ️  Order extraction - Service Line: 'HHA'
[17:47:49] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[17:47:49] ✅ Order data extraction completed successfully
[17:47:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:47:49] ℹ️  Using MRN from patient data: '879' over '879'
[17:47:49] ℹ️  Service line consistent in both sources: 'HHA'
[17:47:49] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[17:47:49] ✅ Patient name cross-validation successful
[17:47:49] ✅    ✅ Data merged successfully
[17:47:51] ✅    ✅ Order data extracted and validated
[17:47:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:47:51] [DOC: 9204260] ✅ Patient found in local cache: Sean McCarthy, ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[17:47:51] ✅    ✅ Existing patient found with ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[17:47:51] 🔄 
🔄 Step 6: Pushing order to API...
[17:47:51] [DOC: 9204260] ℹ️  Pushing order via API for patient ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[17:47:52] [DOC: 9204260] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[17:47:52] ❌    ❌ Failed to push order
[17:47:52] 🔄 
🔄 Step 7: Writing to CSV...
[17:47:52] [DOC: 9204260] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[17:47:52] [DOC: 9204260] ℹ️  Service Line extracted: 'HHA'
[17:47:52] [DOC: 9204260] ℹ️  Payer Source extracted: 'Medicaid/MA'
[17:47:52] [DOC: 9204260] ℹ️  Diagnosis codes being written:
[17:47:52] [DOC: 9204260] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[17:47:52] [DOC: 9204260] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[17:47:52] [DOC: 9204260] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.10'
[17:47:52] [DOC: 9204260] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[17:47:52] [DOC: 9204260] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.0'
[17:47:52] [DOC: 9204260] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:47:52] [DOC: 9204260] ✅ Patient data written to CSV: Sean McCarthy | Sex: MALE | Age: 55 | Service: HHA | Payer: Medicaid/MA | MRN: 879
[17:47:52] ✅    ✅ Document 9204260 processed and saved successfully
[17:47:52] 🔄 
🔄 Step 8: Saving API details...
[17:47:52] [DOC: 9204260] ℹ️  API push details saved for document 9204260
[17:47:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204222                         ║
================================================================================
[17:47:52] ℹ️  Agency: Dartmouth HH
[17:47:52] ℹ️  Date: 03/26/2025
[17:47:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:47:55] [DOC: 9204222] ✅ Text extracted using pdfplumber (22754 chars)
[17:47:55] ✅    ✅ Text extracted using pdfplumber (22754 chars)
[17:47:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:47:58] ℹ️  AI extracted raw sex value: 'F'
[17:47:58] ℹ️  AI extracted service line: 'Skilled Nursing, MSW'
[17:47:58] ℹ️  AI extracted payer source: ''
[17:47:58] ℹ️  AI extracted diagnoses:
[17:47:58] ℹ️    - Diagnosis 1: 'I87.2'
[17:47:58] ℹ️    - Diagnosis 2: 'L97.311'
[17:47:58] ℹ️    - Diagnosis 3: 'B37.2'
[17:47:58] ℹ️    - Diagnosis 4: 'F41.9'
[17:47:58] ℹ️    - Diagnosis 5: 'I12.9'
[17:47:58] ℹ️    - Diagnosis 6: 'N18.4'
[17:47:58] ℹ️  Final extracted MRN: '651015'
[17:47:58] ℹ️  Final extracted Sex: 'FEMALE'
[17:47:58] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW'
[17:47:58] ℹ️  Final extracted Payer Source: ''
[17:47:58] ✅ Patient data extraction completed successfully
[17:47:58] ✅    ✅ Patient data extracted successfully
[17:47:58] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Roseman
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, MSW
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'L97.311', 'thirdDiagnosis': 'B37.2', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.4'}]
[17:47:58] ✅    ✅ Patient identified: Jane Roseman
[17:47:58] ✅    ✅ Patient name validation passed
[17:47:58] 🔄 
🔄 Step 3: Processing patient dates...
[17:47:58] [DOC: 9204222] ℹ️  DOB normalized: 01/19/1935
[17:47:58] [DOC: 9204222] ℹ️  Episode startOfCare normalized: 05/23/2024
[17:47:58] [DOC: 9204222] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[17:47:58] [DOC: 9204222] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[17:47:58] [DOC: 9204222] ✅ Patient date processing completed successfully
[17:47:58] ✅    ✅ Date processing completed
[17:47:58] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Roseman
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, MSW
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'L97.311', 'thirdDiagnosis': 'B37.2', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.4'}]
[17:47:58] 🔄 
🔄 Step 4: Extracting order data...
[17:48:00] ℹ️  Order extraction - MRN: '651015'
[17:48:00] ℹ️  Order extraction - Sex: 'FEMALE'
[17:48:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW'
[17:48:00] ℹ️  Order extraction - Payer Source: ''
[17:48:00] ✅ Order data extraction completed successfully
[17:48:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:48:00] ℹ️  Using MRN from patient data: '651015' over '651015'
[17:48:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW'
[17:48:00] ⚠️  Patient name mismatch: Order='Jadlowe, A Shirley' vs Patient='Jane Roseman'
[17:48:00] ✅    ✅ Data merged successfully
[17:48:02] ✅    ✅ Order data extracted and validated
[17:48:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:48:11] [DOC: 9204222] ℹ️  Patient not found in cache or API: Jane Roseman
[17:48:11] [DOC: 9204222] ℹ️  Patient not found, creating new patient via API...
[17:48:11] [DOC: 9204222] ℹ️  Creating patient via API: Jane Roseman
[17:48:12] [DOC: 9204222] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:48:12] ❌    ❌ Failed to create patient
[17:48:12] [DOC: 9204222] ℹ️  API push details saved for document 9204222
================================================================================
║                        Processing Document ID: 9204212                         ║
================================================================================
[17:48:12] ℹ️  Agency: Dartmouth HH
[17:48:12] ℹ️  Date: 03/26/2025
[17:48:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:48:15] [DOC: 9204212] ✅ Text extracted using pdfplumber (10354 chars)
[17:48:15] ✅    ✅ Text extracted using pdfplumber (10342 chars)
[17:48:15] 🔄 
🔄 Step 2: Extracting patient data...
[17:48:18] ℹ️  AI extracted raw sex value: 'F'
[17:48:18] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[17:48:18] ℹ️  AI extracted payer source: ''
[17:48:18] ℹ️  AI extracted diagnoses:
[17:48:18] ℹ️    - Diagnosis 1: 'G80.9'
[17:48:18] ℹ️    - Diagnosis 2: 'R33.9'
[17:48:18] ℹ️    - Diagnosis 3: 'S21.201D'
[17:48:18] ℹ️    - Diagnosis 4: 'K59.04'
[17:48:18] ℹ️    - Diagnosis 5: 'B37.2'
[17:48:18] ℹ️    - Diagnosis 6: 'R13.12'
[17:48:18] ℹ️  Final extracted MRN: '227027'
[17:48:18] ℹ️  Final extracted Sex: 'FEMALE'
[17:48:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[17:48:18] ℹ️  Final extracted Payer Source: ''
[17:48:18] ✅ Patient data extraction completed successfully
[17:48:18] ✅    ✅ Patient data extracted successfully
[17:48:18] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/17/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'G80.9', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'S21.201D', 'fourthDiagnosis': 'K59.04', 'fifthDiagnosis': 'B37.2', 'sixthDiagnosis': 'R13.12'}]
[17:48:18] ✅    ✅ Patient identified: Kim Teixeira
[17:48:18] ✅    ✅ Patient name validation passed
[17:48:18] 🔄 
🔄 Step 3: Processing patient dates...
[17:48:18] [DOC: 9204212] ℹ️  DOB normalized: 02/28/1964
[17:48:18] [DOC: 9204212] ℹ️  Episode startOfCare normalized: 01/17/2025
[17:48:18] [DOC: 9204212] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[17:48:18] [DOC: 9204212] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[17:48:18] [DOC: 9204212] ✅ Patient date processing completed successfully
[17:48:18] ✅    ✅ Date processing completed
[17:48:18] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/17/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'G80.9', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'S21.201D', 'fourthDiagnosis': 'K59.04', 'fifthDiagnosis': 'B37.2', 'sixthDiagnosis': 'R13.12'}]
[17:48:18] 🔄 
🔄 Step 4: Extracting order data...
[17:48:21] ℹ️  Order extraction - MRN: '227027'
[17:48:21] ℹ️  Order extraction - Sex: 'FEMALE'
[17:48:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[17:48:21] ℹ️  Order extraction - Payer Source: ''
[17:48:21] ✅ Order data extraction completed successfully
[17:48:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:48:21] ℹ️  Using MRN from patient data: '227027' over '227027'
[17:48:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[17:48:21] ✅ Patient name cross-validation successful
[17:48:21] ✅    ✅ Data merged successfully
[17:48:22] ✅    ✅ Order data extracted and validated
[17:48:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:48:22] [DOC: 9204212] ✅ Patient found in local cache: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[17:48:22] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[17:48:22] 🔄 
🔄 Step 6: Pushing order to API...
[17:48:22] [DOC: 9204212] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[17:48:23] [DOC: 9204212] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:48:23] ❌    ❌ Failed to push order
[17:48:23] 🔄 
🔄 Step 7: Writing to CSV...
[17:48:23] [DOC: 9204212] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[17:48:23] [DOC: 9204212] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[17:48:23] [DOC: 9204212] ℹ️  Payer Source extracted: ''
[17:48:23] [DOC: 9204212] ℹ️  Diagnosis codes being written:
[17:48:23] [DOC: 9204212] ℹ️    - Latest_Episode_Firstdiagnosis: 'G80.9'
[17:48:23] [DOC: 9204212] ℹ️    - Latest_Episode_Seconddiagnosis: 'R33.9'
[17:48:23] [DOC: 9204212] ℹ️    - Latest_Episode_Thirddiagnosis: 'S21.201D'
[17:48:23] [DOC: 9204212] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K59.04'
[17:48:23] [DOC: 9204212] ℹ️    - Latest_Episode_Fifthdiagnosis: 'B37.2'
[17:48:23] [DOC: 9204212] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R13.12'
[17:48:23] [DOC: 9204212] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 227027
[17:48:23] ✅    ✅ Document 9204212 processed and saved successfully
[17:48:23] 🔄 
🔄 Step 8: Saving API details...
[17:48:23] [DOC: 9204212] ℹ️  API push details saved for document 9204212
[17:48:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204192                         ║
================================================================================
[17:48:23] ℹ️  Agency: Dartmouth HH
[17:48:23] ℹ️  Date: 03/26/2025
[17:48:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:48:25] [DOC: 9204192] ✅ Text extracted using pdfplumber (6929 chars)
[17:48:25] ✅    ✅ Text extracted using pdfplumber (6929 chars)
[17:48:25] 🔄 
🔄 Step 2: Extracting patient data...
[17:48:28] ℹ️  AI extracted raw sex value: 'F'
[17:48:28] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[17:48:28] ℹ️  AI extracted payer source: 'Medicare'
[17:48:28] ℹ️  AI extracted diagnoses:
[17:48:28] ℹ️    - Diagnosis 1: 'RSV'
[17:48:28] ℹ️    - Diagnosis 2: 'Acute on chronic diastolic HF'
[17:48:28] ℹ️    - Diagnosis 3: 'afib'
[17:48:28] ℹ️    - Diagnosis 4: 'hypokalemia'
[17:48:28] ℹ️    - Diagnosis 5: 'CHF'
[17:48:28] ℹ️    - Diagnosis 6: 'CAD'
[17:48:28] ℹ️  Final extracted MRN: '5915015'
[17:48:28] ℹ️  Final extracted Sex: 'FEMALE'
[17:48:28] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[17:48:28] ℹ️  Final extracted Payer Source: 'Medicare'
[17:48:28] ✅ Patient data extraction completed successfully
[17:48:28] ✅    ✅ Patient data extracted successfully
[17:48:28] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': 'Acute on chronic diastolic HF', 'thirdDiagnosis': 'afib', 'fourthDiagnosis': 'hypokalemia', 'fifthDiagnosis': 'CHF', 'sixthDiagnosis': 'CAD'}]
[17:48:28] ✅    ✅ Patient identified: Suzanne Fawcett
[17:48:28] ✅    ✅ Patient name validation passed
[17:48:28] 🔄 
🔄 Step 3: Processing patient dates...
[17:48:28] [DOC: 9204192] ℹ️  DOB normalized: 12/08/1939
[17:48:28] [DOC: 9204192] ℹ️  Episode startOfCare normalized: 01/26/2025
[17:48:28] [DOC: 9204192] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[17:48:28] [DOC: 9204192] ℹ️  Episode endOfEpisode normalized: 01/25/2025
[17:48:28] [DOC: 9204192] ✅ Patient date processing completed successfully
[17:48:28] ✅    ✅ Date processing completed
[17:48:28] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': 'Acute on chronic diastolic HF', 'thirdDiagnosis': 'afib', 'fourthDiagnosis': 'hypokalemia', 'fifthDiagnosis': 'CHF', 'sixthDiagnosis': 'CAD'}]
[17:48:28] 🔄 
🔄 Step 4: Extracting order data...
[17:48:31] ℹ️  Order extraction - MRN: '5915015'
[17:48:31] ℹ️  Order extraction - Sex: 'FEMALE'
[17:48:31] ℹ️  Order extraction - Service Line: 'PT, SN'
[17:48:31] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:48:31] ✅ Order data extraction completed successfully
[17:48:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:48:31] ℹ️  Using MRN from patient data: '5915015' over '5915015'
[17:48:31] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT, SN' = 'PT, Physical Therapy, SN, Skilled Nursing'
[17:48:31] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:48:31] ✅ Patient name cross-validation successful
[17:48:31] ✅    ✅ Data merged successfully
[17:48:32] ✅    ✅ Order data extracted and validated
[17:48:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:48:43] [DOC: 9204192] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[17:48:43] [DOC: 9204192] ℹ️  Patient not found, creating new patient via API...
[17:48:43] [DOC: 9204192] ℹ️  Creating patient via API: Suzanne Fawcett
[17:48:44] [DOC: 9204192] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:48:44] ❌    ❌ Failed to create patient
[17:48:44] [DOC: 9204192] ℹ️  API push details saved for document 9204192
================================================================================
║                        Processing Document ID: 9204191                         ║
================================================================================
[17:48:44] ℹ️  Agency: Dartmouth HH
[17:48:44] ℹ️  Date: 03/26/2025
[17:48:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:48:46] [DOC: 9204191] ✅ Text extracted using pdfplumber (1303 chars)
[17:48:46] ✅    ✅ Text extracted using pdfplumber (1303 chars)
[17:48:46] 🔄 
🔄 Step 2: Extracting patient data...
[17:48:49] ℹ️  AI extracted raw sex value: 'M'
[17:48:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:48:49] ℹ️  AI extracted payer source: 'Medicare'
[17:48:49] ℹ️  AI extracted diagnoses:
[17:48:49] ℹ️    - Diagnosis 1: ''
[17:48:49] ℹ️    - Diagnosis 2: ''
[17:48:49] ℹ️    - Diagnosis 3: ''
[17:48:49] ℹ️    - Diagnosis 4: ''
[17:48:49] ℹ️    - Diagnosis 5: ''
[17:48:49] ℹ️    - Diagnosis 6: ''
[17:48:49] ℹ️  Final extracted MRN: '3745015'
[17:48:49] ℹ️  Final extracted Sex: 'MALE'
[17:48:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:48:49] ℹ️  Final extracted Payer Source: 'Medicare'
[17:48:49] ✅ Patient data extraction completed successfully
[17:48:49] ✅    ✅ Patient data extracted successfully
[17:48:49] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:48:49] ✅    ✅ Patient identified: Stanley Waters
[17:48:49] ✅    ✅ Patient name validation passed
[17:48:49] 🔄 
🔄 Step 3: Processing patient dates...
[17:48:49] [DOC: 9204191] ℹ️  DOB normalized: 08/19/1941
[17:48:49] [DOC: 9204191] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:48:49] [DOC: 9204191] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[17:48:49] [DOC: 9204191] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[17:48:49] [DOC: 9204191] ✅ Patient date processing completed successfully
[17:48:49] ✅    ✅ Date processing completed
[17:48:49] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:48:49] 🔄 
🔄 Step 4: Extracting order data...
[17:48:51] ℹ️  Order extraction - MRN: '3745015'
[17:48:51] ℹ️  Order extraction - Sex: 'MALE'
[17:48:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:48:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:48:51] ✅ Order data extraction completed successfully
[17:48:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:48:51] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[17:48:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:48:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:48:51] ✅ Patient name cross-validation successful
[17:48:51] ✅    ✅ Data merged successfully
[17:48:52] ✅    ✅ Order data extracted and validated
[17:48:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:48:52] [DOC: 9204191] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[17:48:52] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[17:48:52] 🔄 
🔄 Step 6: Pushing order to API...
[17:48:52] [DOC: 9204191] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[17:48:53] [DOC: 9204191] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:48:53] ❌    ❌ Failed to push order
[17:48:53] 🔄 
🔄 Step 7: Writing to CSV...
[17:48:53] [DOC: 9204191] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[17:48:53] [DOC: 9204191] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:48:53] [DOC: 9204191] ℹ️  Payer Source extracted: 'Medicare'
[17:48:53] [DOC: 9204191] ℹ️  Diagnosis codes being written:
[17:48:53] [DOC: 9204191] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:48:53] [DOC: 9204191] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:48:53] [DOC: 9204191] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:48:53] [DOC: 9204191] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:48:53] [DOC: 9204191] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:48:53] [DOC: 9204191] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:48:53] [DOC: 9204191] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 3745015
[17:48:53] ✅    ✅ Document 9204191 processed and saved successfully
[17:48:53] 🔄 
🔄 Step 8: Saving API details...
[17:48:53] [DOC: 9204191] ℹ️  API push details saved for document 9204191
[17:48:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204187                         ║
================================================================================
[17:48:53] ℹ️  Agency: Dartmouth HH
[17:48:53] ℹ️  Date: 03/26/2025
[17:48:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:48:56] [DOC: 9204187] ✅ Text extracted using pdfplumber (11338 chars)
[17:48:56] ✅    ✅ Text extracted using pdfplumber (11326 chars)
[17:48:56] 🔄 
🔄 Step 2: Extracting patient data...
[17:48:59] ℹ️  AI extracted raw sex value: 'M'
[17:48:59] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:48:59] ℹ️  AI extracted payer source: 'None'
[17:48:59] ℹ️  AI extracted diagnoses:
[17:48:59] ℹ️    - Diagnosis 1: 'L89.150'
[17:48:59] ℹ️    - Diagnosis 2: 'K62.5'
[17:48:59] ℹ️    - Diagnosis 3: 'J44.9'
[17:48:59] ℹ️    - Diagnosis 4: 'D64.9'
[17:48:59] ℹ️    - Diagnosis 5: 'R63.4'
[17:48:59] ℹ️    - Diagnosis 6: 'G90.09'
[17:48:59] ℹ️  Final extracted MRN: '3745015'
[17:48:59] ℹ️  Final extracted Sex: 'MALE'
[17:48:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:48:59] ℹ️  Final extracted Payer Source: ''
[17:48:59] ✅ Patient data extraction completed successfully
[17:48:59] ✅    ✅ Patient data extracted successfully
[17:48:59] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'L89.150', 'secondDiagnosis': 'K62.5', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'G90.09'}]
[17:48:59] ✅    ✅ Patient identified: Stanley Waters
[17:48:59] ✅    ✅ Patient name validation passed
[17:48:59] 🔄 
🔄 Step 3: Processing patient dates...
[17:48:59] [DOC: 9204187] ℹ️  DOB normalized: 08/19/1941
[17:48:59] [DOC: 9204187] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:48:59] [DOC: 9204187] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[17:48:59] [DOC: 9204187] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[17:48:59] [DOC: 9204187] ✅ Patient date processing completed successfully
[17:48:59] ✅    ✅ Date processing completed
[17:48:59] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'L89.150', 'secondDiagnosis': 'K62.5', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'R63.4', 'sixthDiagnosis': 'G90.09'}]
[17:48:59] 🔄 
🔄 Step 4: Extracting order data...
[17:49:02] ℹ️  Order extraction - MRN: '3745015'
[17:49:02] ℹ️  Order extraction - Sex: 'MALE'
[17:49:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:49:02] ℹ️  Order extraction - Payer Source: ''
[17:49:02] ✅ Order data extraction completed successfully
[17:49:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:49:02] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[17:49:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:49:02] ✅ Patient name cross-validation successful
[17:49:02] ✅    ✅ Data merged successfully
[17:49:03] ✅    ✅ Order data extracted and validated
[17:49:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:49:03] [DOC: 9204187] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[17:49:03] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[17:49:03] 🔄 
🔄 Step 6: Pushing order to API...
[17:49:03] [DOC: 9204187] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[17:49:04] [DOC: 9204187] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:49:04] ❌    ❌ Failed to push order
[17:49:04] 🔄 
🔄 Step 7: Writing to CSV...
[17:49:04] [DOC: 9204187] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[17:49:04] [DOC: 9204187] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:49:04] [DOC: 9204187] ℹ️  Payer Source extracted: ''
[17:49:04] [DOC: 9204187] ℹ️  Diagnosis codes being written:
[17:49:04] [DOC: 9204187] ℹ️    - Latest_Episode_Firstdiagnosis: 'L89.150'
[17:49:04] [DOC: 9204187] ℹ️    - Latest_Episode_Seconddiagnosis: 'K62.5'
[17:49:04] [DOC: 9204187] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[17:49:04] [DOC: 9204187] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D64.9'
[17:49:04] [DOC: 9204187] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R63.4'
[17:49:04] [DOC: 9204187] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G90.09'
[17:49:04] [DOC: 9204187] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 3745015
[17:49:04] ✅    ✅ Document 9204187 processed and saved successfully
[17:49:04] 🔄 
🔄 Step 8: Saving API details...
[17:49:04] [DOC: 9204187] ℹ️  API push details saved for document 9204187
[17:49:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204172                         ║
================================================================================
[17:49:04] ℹ️  Agency: Dartmouth HH
[17:49:04] ℹ️  Date: 03/26/2025
[17:49:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:49:06] [DOC: 9204172] ✅ Text extracted using pdfplumber (9517 chars)
[17:49:06] ✅    ✅ Text extracted using pdfplumber (9505 chars)
[17:49:06] 🔄 
🔄 Step 2: Extracting patient data...
[17:49:09] ℹ️  AI extracted raw sex value: 'M'
[17:49:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:49:09] ℹ️  AI extracted payer source: 'None'
[17:49:09] ℹ️  AI extracted diagnoses:
[17:49:09] ℹ️    - Diagnosis 1: 'N40.1'
[17:49:09] ℹ️    - Diagnosis 2: 'R33.9'
[17:49:09] ℹ️    - Diagnosis 3: 'R31.9'
[17:49:09] ℹ️    - Diagnosis 4: 'N42.9'
[17:49:09] ℹ️    - Diagnosis 5: 'D45'
[17:49:09] ℹ️    - Diagnosis 6: 'I10'
[17:49:09] ℹ️  Final extracted MRN: '227027'
[17:49:09] ℹ️  Final extracted Sex: 'MALE'
[17:49:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:49:09] ℹ️  Final extracted Payer Source: ''
[17:49:09] ✅ Patient data extraction completed successfully
[17:49:09] ✅    ✅ Patient data extracted successfully
[17:49:09] 📊 Patient Response
     └─ patientFName: Doherty
     └─ patientLName: Louis
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/19/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'N40.1', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'R31.9', 'fourthDiagnosis': 'N42.9', 'fifthDiagnosis': 'D45', 'sixthDiagnosis': 'I10'}]
[17:49:09] ✅    ✅ Patient identified: Doherty Louis
[17:49:09] ✅    ✅ Patient name validation passed
[17:49:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:49:09] [DOC: 9204172] ℹ️  DOB normalized: 09/22/1939
[17:49:09] [DOC: 9204172] ℹ️  Episode startOfCare normalized: 01/19/2025
[17:49:09] [DOC: 9204172] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[17:49:09] [DOC: 9204172] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[17:49:09] [DOC: 9204172] ✅ Patient date processing completed successfully
[17:49:09] ✅    ✅ Date processing completed
[17:49:09] 📊 Processed Patient Data
     └─ patientFName: Doherty
     └─ patientLName: Louis
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/19/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'N40.1', 'secondDiagnosis': 'R33.9', 'thirdDiagnosis': 'R31.9', 'fourthDiagnosis': 'N42.9', 'fifthDiagnosis': 'D45', 'sixthDiagnosis': 'I10'}]
[17:49:09] 🔄 
🔄 Step 4: Extracting order data...
[17:49:12] ℹ️  Order extraction - MRN: '227027'
[17:49:12] ℹ️  Order extraction - Sex: 'MALE'
[17:49:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:49:12] ℹ️  Order extraction - Payer Source: ''
[17:49:12] ✅ Order data extraction completed successfully
[17:49:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:49:12] ℹ️  Using MRN from patient data: '227027' over '227027'
[17:49:12] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:49:12] ✅ Patient name cross-validation successful
[17:49:12] ✅    ✅ Data merged successfully
[17:49:13] ✅    ✅ Order data extracted and validated
[17:49:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:49:43] [DOC: 9204172] ℹ️  Patient not found in cache or API: Doherty Louis
[17:49:43] [DOC: 9204172] ℹ️  Patient not found, creating new patient via API...
[17:49:43] [DOC: 9204172] ℹ️  Creating patient via API: Doherty Louis
[17:49:45] [DOC: 9204172] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:49:45] ❌    ❌ Failed to create patient
[17:49:45] [DOC: 9204172] ℹ️  API push details saved for document 9204172
================================================================================
║                        Processing Document ID: 9204169                         ║
================================================================================
[17:49:45] ℹ️  Agency: Dartmouth HH
[17:49:45] ℹ️  Date: 03/26/2025
[17:49:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:49:47] [DOC: 9204169] ✅ Text extracted using pdfplumber (1954 chars)
[17:49:47] ✅    ✅ Text extracted using pdfplumber (1954 chars)
[17:49:47] 🔄 
🔄 Step 2: Extracting patient data...
[17:49:50] ℹ️  AI extracted raw sex value: 'M'
[17:49:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:49:50] ℹ️  AI extracted payer source: 'Medicare'
[17:49:50] ℹ️  AI extracted diagnoses:
[17:49:50] ℹ️    - Diagnosis 1: ''
[17:49:50] ℹ️    - Diagnosis 2: ''
[17:49:50] ℹ️    - Diagnosis 3: ''
[17:49:50] ℹ️    - Diagnosis 4: ''
[17:49:50] ℹ️    - Diagnosis 5: ''
[17:49:50] ℹ️    - Diagnosis 6: ''
[17:49:50] ℹ️  Final extracted MRN: '5894015'
[17:49:50] ℹ️  Final extracted Sex: 'MALE'
[17:49:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:49:50] ℹ️  Final extracted Payer Source: 'Medicare'
[17:49:50] ✅ Patient data extraction completed successfully
[17:49:50] ✅    ✅ Patient data extracted successfully
[17:49:50] 📊 Patient Response
     └─ patientFName: Louis
     └─ patientLName: Doherty
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 5894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:49:50] ✅    ✅ Patient identified: Louis Doherty
[17:49:50] ✅    ✅ Patient name validation passed
[17:49:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:49:50] [DOC: 9204169] ℹ️  DOB normalized: 09/22/1939
[17:49:50] [DOC: 9204169] ℹ️  Episode startOfCare normalized: 01/20/2025
[17:49:50] [DOC: 9204169] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[17:49:50] [DOC: 9204169] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[17:49:50] [DOC: 9204169] ✅ Patient date processing completed successfully
[17:49:50] ✅    ✅ Date processing completed
[17:49:50] 📊 Processed Patient Data
     └─ patientFName: Louis
     └─ patientLName: Doherty
     └─ dob: 09/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 5894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:49:50] 🔄 
🔄 Step 4: Extracting order data...
[17:49:53] ℹ️  Order extraction - MRN: ''
[17:49:53] ℹ️  Order extraction - Sex: 'MALE'
[17:49:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:49:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:49:53] ✅ Order data extraction completed successfully
[17:49:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:49:53] ℹ️  Using MRN from patient data: '5894015'
[17:49:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:49:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:49:53] ✅ Patient name cross-validation successful
[17:49:53] ✅    ✅ Data merged successfully
[17:49:54] ✅    ✅ Order data extracted and validated
[17:49:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:49:59] [DOC: 9204169] ✅ Patient exists in API: Louis Doherty, ID: d22c2c4d-c413-4c62-bd0e-f571b12a80e7
[17:49:59] ✅    ✅ Existing patient found with ID: d22c2c4d-c413-4c62-bd0e-f571b12a80e7
[17:49:59] 🔄 
🔄 Step 6: Pushing order to API...
[17:49:59] [DOC: 9204169] ℹ️  Pushing order via API for patient ID: d22c2c4d-c413-4c62-bd0e-f571b12a80e7
[17:50:00] [DOC: 9204169] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13886"}
[17:50:00] ❌    ❌ Failed to push order
[17:50:00] 🔄 
🔄 Step 7: Writing to CSV...
[17:50:00] [DOC: 9204169] ℹ️  Calculated age: 85 from DOB: 09/22/1939
[17:50:00] [DOC: 9204169] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:50:00] [DOC: 9204169] ℹ️  Payer Source extracted: 'Medicare'
[17:50:00] [DOC: 9204169] ℹ️  Diagnosis codes being written:
[17:50:00] [DOC: 9204169] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:50:00] [DOC: 9204169] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:50:00] [DOC: 9204169] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:50:00] [DOC: 9204169] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:50:00] [DOC: 9204169] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:50:00] [DOC: 9204169] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:50:00] [DOC: 9204169] ✅ Patient data written to CSV: Louis Doherty | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: 5894015
[17:50:00] ✅    ✅ Document 9204169 processed and saved successfully
[17:50:00] 🔄 
🔄 Step 8: Saving API details...
[17:50:00] [DOC: 9204169] ℹ️  API push details saved for document 9204169
[17:50:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204166                         ║
================================================================================
[17:50:00] ℹ️  Agency: Dartmouth HH
[17:50:00] ℹ️  Date: 03/26/2025
[17:50:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:50:03] [DOC: 9204166] ✅ Text extracted using pdfplumber (19867 chars)
[17:50:03] ✅    ✅ Text extracted using pdfplumber (19867 chars)
[17:50:03] 🔄 
🔄 Step 2: Extracting patient data...
[17:50:06] ℹ️  AI extracted raw sex value: 'F'
[17:50:06] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[17:50:06] ℹ️  AI extracted payer source: ''
[17:50:06] ℹ️  AI extracted diagnoses:
[17:50:06] ℹ️    - Diagnosis 1: 'J18.9'
[17:50:06] ℹ️    - Diagnosis 2: 'S22.31XD'
[17:50:06] ℹ️    - Diagnosis 3: 'I48.20'
[17:50:06] ℹ️    - Diagnosis 4: 'I10'
[17:50:06] ℹ️    - Diagnosis 5: 'E78.5'
[17:50:06] ℹ️    - Diagnosis 6: 'F41.9'
[17:50:06] ℹ️  Final extracted MRN: '3188009'
[17:50:06] ℹ️  Final extracted Sex: 'FEMALE'
[17:50:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[17:50:06] ℹ️  Final extracted Payer Source: ''
[17:50:06] ✅ Patient data extraction completed successfully
[17:50:06] ✅    ✅ Patient data extracted successfully
[17:50:06] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Blanchette
     └─ dob: 10/06/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3188009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'S22.31XD', 'thirdDiagnosis': 'I48.20', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[17:50:06] ✅    ✅ Patient identified: Rita Blanchette
[17:50:06] ✅    ✅ Patient name validation passed
[17:50:06] 🔄 
🔄 Step 3: Processing patient dates...
[17:50:06] [DOC: 9204166] ℹ️  DOB normalized: 10/06/1928
[17:50:06] [DOC: 9204166] ℹ️  Episode startOfCare normalized: 03/12/2025
[17:50:06] [DOC: 9204166] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[17:50:06] [DOC: 9204166] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[17:50:06] [DOC: 9204166] ✅ Patient date processing completed successfully
[17:50:06] ✅    ✅ Date processing completed
[17:50:06] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Blanchette
     └─ dob: 10/06/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3188009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'S22.31XD', 'thirdDiagnosis': 'I48.20', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[17:50:06] 🔄 
🔄 Step 4: Extracting order data...
[17:50:09] ℹ️  Order extraction - MRN: '3188009'
[17:50:09] ℹ️  Order extraction - Sex: 'FEMALE'
[17:50:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[17:50:09] ℹ️  Order extraction - Payer Source: ''
[17:50:09] ✅ Order data extraction completed successfully
[17:50:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:50:09] ℹ️  Using MRN from patient data: '3188009' over '3188009'
[17:50:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[17:50:09] ✅ Patient name cross-validation successful
[17:50:09] ✅    ✅ Data merged successfully
[17:50:10] ✅    ✅ Order data extracted and validated
[17:50:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:50:10] [DOC: 9204166] ✅ Patient found in local cache: Rita Blanchette, ID: ea808626-f6db-4916-b57d-dae1fb46c508
[17:50:10] ✅    ✅ Existing patient found with ID: ea808626-f6db-4916-b57d-dae1fb46c508
[17:50:10] 🔄 
🔄 Step 6: Pushing order to API...
[17:50:10] [DOC: 9204166] ℹ️  Pushing order via API for patient ID: ea808626-f6db-4916-b57d-dae1fb46c508
[17:50:11] [DOC: 9204166] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:50:11] ❌    ❌ Failed to push order
[17:50:11] 🔄 
🔄 Step 7: Writing to CSV...
[17:50:11] [DOC: 9204166] ℹ️  Calculated age: 96 from DOB: 10/06/1928
[17:50:11] [DOC: 9204166] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[17:50:11] [DOC: 9204166] ℹ️  Payer Source extracted: ''
[17:50:11] [DOC: 9204166] ℹ️  Diagnosis codes being written:
[17:50:11] [DOC: 9204166] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[17:50:11] [DOC: 9204166] ℹ️    - Latest_Episode_Seconddiagnosis: 'S22.31XD'
[17:50:11] [DOC: 9204166] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.20'
[17:50:11] [DOC: 9204166] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[17:50:11] [DOC: 9204166] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[17:50:11] [DOC: 9204166] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:50:11] [DOC: 9204166] ✅ Patient data written to CSV: Rita Blanchette | Sex: FEMALE | Age: 96 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 3188009
[17:50:11] ✅    ✅ Document 9204166 processed and saved successfully
[17:50:11] 🔄 
🔄 Step 8: Saving API details...
[17:50:11] [DOC: 9204166] ℹ️  API push details saved for document 9204166
[17:50:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204160                         ║
================================================================================
[17:50:11] ℹ️  Agency: Dartmouth HH
[17:50:11] ℹ️  Date: 03/26/2025
[17:50:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:50:18] [DOC: 9204160] ✅ Text extracted using pdfplumber (20451 chars)
[17:50:18] ✅    ✅ Text extracted using pdfplumber (20451 chars)
[17:50:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:50:21] ℹ️  AI extracted raw sex value: 'F'
[17:50:21] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[17:50:21] ℹ️  AI extracted payer source: 'None'
[17:50:21] ℹ️  AI extracted diagnoses:
[17:50:21] ℹ️    - Diagnosis 1: 'K29.70'
[17:50:21] ℹ️    - Diagnosis 2: 'R10.13'
[17:50:21] ℹ️    - Diagnosis 3: 'E11.65'
[17:50:21] ℹ️    - Diagnosis 4: 'E03.1'
[17:50:21] ℹ️    - Diagnosis 5: 'I13.0'
[17:50:21] ℹ️    - Diagnosis 6: 'I50.30'
[17:50:21] ℹ️  Final extracted MRN: '227027'
[17:50:21] ℹ️  Final extracted Sex: 'FEMALE'
[17:50:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[17:50:21] ℹ️  Final extracted Payer Source: ''
[17:50:21] ✅ Patient data extraction completed successfully
[17:50:21] ✅    ✅ Patient data extracted successfully
[17:50:21] 📊 Patient Response
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K29.70', 'secondDiagnosis': 'R10.13', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E03.1', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[17:50:21] ✅    ✅ Patient identified: Katherine Ferreira
[17:50:21] ✅    ✅ Patient name validation passed
[17:50:21] 🔄 
🔄 Step 3: Processing patient dates...
[17:50:21] [DOC: 9204160] ℹ️  DOB normalized: 02/26/1929
[17:50:21] [DOC: 9204160] ℹ️  Episode startOfCare normalized: 03/09/2025
[17:50:21] [DOC: 9204160] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[17:50:21] [DOC: 9204160] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[17:50:21] [DOC: 9204160] ✅ Patient date processing completed successfully
[17:50:21] ✅    ✅ Date processing completed
[17:50:21] 📊 Processed Patient Data
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K29.70', 'secondDiagnosis': 'R10.13', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E03.1', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[17:50:21] 🔄 
🔄 Step 4: Extracting order data...
[17:50:24] ℹ️  Order extraction - MRN: '4929009'
[17:50:24] ℹ️  Order extraction - Sex: 'FEMALE'
[17:50:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[17:50:24] ℹ️  Order extraction - Payer Source: ''
[17:50:24] ✅ Order data extraction completed successfully
[17:50:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:50:24] ℹ️  Using longer MRN from order data: '4929009' over '227027'
[17:50:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[17:50:24] ✅ Patient name cross-validation successful
[17:50:24] ✅    ✅ Data merged successfully
[17:50:25] ✅    ✅ Order data extracted and validated
[17:50:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:50:25] [DOC: 9204160] ✅ Patient found in local cache: Katherine Ferreira, ID: a91e06c9-4785-41d3-ae13-67be5545d837
[17:50:25] ✅    ✅ Existing patient found with ID: a91e06c9-4785-41d3-ae13-67be5545d837
[17:50:25] 🔄 
🔄 Step 6: Pushing order to API...
[17:50:25] [DOC: 9204160] ℹ️  Pushing order via API for patient ID: a91e06c9-4785-41d3-ae13-67be5545d837
[17:50:26] [DOC: 9204160] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:50:26] ❌    ❌ Failed to push order
[17:50:26] 🔄 
🔄 Step 7: Writing to CSV...
[17:50:26] [DOC: 9204160] ℹ️  Calculated age: 96 from DOB: 02/26/1929
[17:50:26] [DOC: 9204160] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[17:50:26] [DOC: 9204160] ℹ️  Payer Source extracted: ''
[17:50:26] [DOC: 9204160] ℹ️  Diagnosis codes being written:
[17:50:26] [DOC: 9204160] ℹ️    - Latest_Episode_Firstdiagnosis: 'K29.70'
[17:50:26] [DOC: 9204160] ℹ️    - Latest_Episode_Seconddiagnosis: 'R10.13'
[17:50:26] [DOC: 9204160] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[17:50:26] [DOC: 9204160] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.1'
[17:50:26] [DOC: 9204160] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I13.0'
[17:50:26] [DOC: 9204160] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.30'
[17:50:26] [DOC: 9204160] ✅ Patient data written to CSV: Katherine Ferreira | Sex: FEMALE | Age: 96 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 4929009
[17:50:26] ✅    ✅ Document 9204160 processed and saved successfully
[17:50:26] 🔄 
🔄 Step 8: Saving API details...
[17:50:26] [DOC: 9204160] ℹ️  API push details saved for document 9204160
[17:50:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204156                         ║
================================================================================
[17:50:26] ℹ️  Agency: Dartmouth HH
[17:50:26] ℹ️  Date: 03/26/2025
[17:50:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:50:28] [DOC: 9204156] ✅ Text extracted using pdfplumber (1475 chars)
[17:50:28] ✅    ✅ Text extracted using pdfplumber (1475 chars)
[17:50:28] 🔄 
🔄 Step 2: Extracting patient data...
[17:50:31] ℹ️  AI extracted raw sex value: 'F'
[17:50:31] ℹ️  AI extracted service line: 'RN,OT'
[17:50:31] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[17:50:31] ℹ️  AI extracted diagnoses:
[17:50:31] ℹ️    - Diagnosis 1: 'None'
[17:50:31] ℹ️    - Diagnosis 2: 'None'
[17:50:31] ℹ️    - Diagnosis 3: 'None'
[17:50:31] ℹ️    - Diagnosis 4: 'None'
[17:50:31] ℹ️    - Diagnosis 5: 'None'
[17:50:31] ℹ️    - Diagnosis 6: 'None'
[17:50:31] ℹ️  Final extracted MRN: '4929009'
[17:50:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:50:31] ℹ️  Final extracted Service Line: 'RN,OT'
[17:50:31] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[17:50:31] ✅ Patient data extraction completed successfully
[17:50:31] ✅    ✅ Patient data extracted successfully
[17:50:31] 📊 Patient Response
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN,OT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:50:31] ✅    ✅ Patient identified: Katherine Ferreira
[17:50:31] ✅    ✅ Patient name validation passed
[17:50:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:50:31] [DOC: 9204156] ℹ️  DOB normalized: 02/26/1929
[17:50:31] [DOC: 9204156] ℹ️  Episode startOfCare normalized: 03/10/2025
[17:50:31] [DOC: 9204156] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[17:50:31] [DOC: 9204156] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[17:50:31] [DOC: 9204156] ✅ Patient date processing completed successfully
[17:50:31] ✅    ✅ Date processing completed
[17:50:31] 📊 Processed Patient Data
     └─ patientFName: Katherine
     └─ patientLName: Ferreira
     └─ dob: 02/26/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN,OT
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025'}]
[17:50:31] 🔄 
🔄 Step 4: Extracting order data...
[17:50:34] ℹ️  Order extraction - MRN: ''
[17:50:34] ℹ️  Order extraction - Sex: 'FEMALE'
[17:50:34] ℹ️  Order extraction - Service Line: 'OT, RN'
[17:50:34] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[17:50:34] ✅ Order data extraction completed successfully
[17:50:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:50:34] ℹ️  Using MRN from patient data: '4929009'
[17:50:34] ℹ️  Combined service lines: Patient='RN,OT' + Order='OT, RN' = 'OT, RN'
[17:50:34] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[17:50:34] ✅ Patient name cross-validation successful
[17:50:34] ✅    ✅ Data merged successfully
[17:50:35] ✅    ✅ Order data extracted and validated
[17:50:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:50:35] [DOC: 9204156] ✅ Patient found in local cache: Katherine Ferreira, ID: a91e06c9-4785-41d3-ae13-67be5545d837
[17:50:35] ✅    ✅ Existing patient found with ID: a91e06c9-4785-41d3-ae13-67be5545d837
[17:50:35] 🔄 
🔄 Step 6: Pushing order to API...
[17:50:35] [DOC: 9204156] ℹ️  Pushing order via API for patient ID: a91e06c9-4785-41d3-ae13-67be5545d837
[17:50:37] [DOC: 9204156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:50:37] ❌    ❌ Failed to push order
[17:50:37] 🔄 
🔄 Step 7: Writing to CSV...
[17:50:37] [DOC: 9204156] ℹ️  Calculated age: 96 from DOB: 02/26/1929
[17:50:37] [DOC: 9204156] ℹ️  Service Line extracted: 'OT, RN'
[17:50:37] [DOC: 9204156] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[17:50:37] [DOC: 9204156] ℹ️  Diagnosis codes being written:
[17:50:37] [DOC: 9204156] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:50:37] [DOC: 9204156] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:50:37] [DOC: 9204156] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:50:37] [DOC: 9204156] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:50:37] [DOC: 9204156] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:50:37] [DOC: 9204156] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:50:37] [DOC: 9204156] ✅ Patient data written to CSV: Katherine Ferreira | Sex: FEMALE | Age: 96 | Service: OT, RN | Payer: Tufts Health Plan Senior Care Options | MRN: 4929009
[17:50:37] ✅    ✅ Document 9204156 processed and saved successfully
[17:50:37] 🔄 
🔄 Step 8: Saving API details...
[17:50:37] [DOC: 9204156] ℹ️  API push details saved for document 9204156
[17:50:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204151                         ║
================================================================================
[17:50:37] ℹ️  Agency: Dartmouth HH
[17:50:37] ℹ️  Date: 03/26/2025
[17:50:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:50:39] [DOC: 9204151] ✅ Text extracted using pdfplumber (9909 chars)
[17:50:39] ✅    ✅ Text extracted using pdfplumber (9897 chars)
[17:50:39] 🔄 
🔄 Step 2: Extracting patient data...
[17:50:42] ℹ️  AI extracted raw sex value: 'M'
[17:50:42] ℹ️  AI extracted service line: 'PT, RN'
[17:50:42] ℹ️  AI extracted payer source: ''
[17:50:42] ℹ️  AI extracted diagnoses:
[17:50:42] ℹ️    - Diagnosis 1: 'I69.354'
[17:50:42] ℹ️    - Diagnosis 2: 'F41.9'
[17:50:42] ℹ️    - Diagnosis 3: 'I11.0'
[17:50:42] ℹ️    - Diagnosis 4: 'I50.9'
[17:50:42] ℹ️    - Diagnosis 5: 'K59.00'
[17:50:42] ℹ️    - Diagnosis 6: 'I25.2'
[17:50:42] ℹ️  Final extracted MRN: '227027'
[17:50:42] ℹ️  Final extracted Sex: 'MALE'
[17:50:42] ℹ️  Final extracted Service Line: 'PT, RN'
[17:50:42] ℹ️  Final extracted Payer Source: ''
[17:50:42] ✅ Patient data extraction completed successfully
[17:50:42] ✅    ✅ Patient data extracted successfully
[17:50:42] 📊 Patient Response
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/05/2024', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'K59.00', 'sixthDiagnosis': 'I25.2'}]
[17:50:42] ✅    ✅ Patient identified: Wayne Dubreuil
[17:50:42] ✅    ✅ Patient name validation passed
[17:50:42] 🔄 
🔄 Step 3: Processing patient dates...
[17:50:42] [DOC: 9204151] ℹ️  DOB normalized: 08/14/1953
[17:50:42] [DOC: 9204151] ℹ️  Episode startOfCare normalized: 11/05/2024
[17:50:42] [DOC: 9204151] ℹ️  Episode startOfEpisode normalized: 01/16/2025
[17:50:42] [DOC: 9204151] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:50:42] [DOC: 9204151] ✅ Patient date processing completed successfully
[17:50:42] ✅    ✅ Date processing completed
[17:50:42] 📊 Processed Patient Data
     └─ patientFName: Wayne
     └─ patientLName: Dubreuil
     └─ dob: 08/14/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/05/2024', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'K59.00', 'sixthDiagnosis': 'I25.2'}]
[17:50:42] 🔄 
🔄 Step 4: Extracting order data...
[17:50:45] ℹ️  Order extraction - MRN: '227027'
[17:50:45] ℹ️  Order extraction - Sex: 'MALE'
[17:50:45] ℹ️  Order extraction - Service Line: 'PT, RN'
[17:50:45] ℹ️  Order extraction - Payer Source: ''
[17:50:45] ✅ Order data extraction completed successfully
[17:50:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:50:45] ℹ️  Using MRN from patient data: '227027' over '227027'
[17:50:45] ℹ️  Service line consistent in both sources: 'PT, RN'
[17:50:45] ✅ Patient name cross-validation successful
[17:50:45] ✅    ✅ Data merged successfully
[17:50:46] ✅    ✅ Order data extracted and validated
[17:50:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:50:46] [DOC: 9204151] ✅ Patient found in local cache: Wayne Dubreuil, ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[17:50:46] ✅    ✅ Existing patient found with ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[17:50:46] 🔄 
🔄 Step 6: Pushing order to API...
[17:50:46] [DOC: 9204151] ℹ️  Pushing order via API for patient ID: 692ad74e-370c-466d-91e5-cf26a1ccd582
[17:50:48] [DOC: 9204151] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:50:48] ❌    ❌ Failed to push order
[17:50:48] 🔄 
🔄 Step 7: Writing to CSV...
[17:50:48] [DOC: 9204151] ℹ️  Calculated age: 71 from DOB: 08/14/1953
[17:50:48] [DOC: 9204151] ℹ️  Service Line extracted: 'PT, RN'
[17:50:48] [DOC: 9204151] ℹ️  Payer Source extracted: ''
[17:50:48] [DOC: 9204151] ℹ️  Diagnosis codes being written:
[17:50:48] [DOC: 9204151] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[17:50:48] [DOC: 9204151] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[17:50:48] [DOC: 9204151] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[17:50:48] [DOC: 9204151] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.9'
[17:50:48] [DOC: 9204151] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K59.00'
[17:50:48] [DOC: 9204151] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.2'
[17:50:48] [DOC: 9204151] ✅ Patient data written to CSV: Wayne Dubreuil | Sex: MALE | Age: 71 | Service: PT, RN | Payer:  | MRN: 227027
[17:50:48] ✅    ✅ Document 9204151 processed and saved successfully
[17:50:48] 🔄 
🔄 Step 8: Saving API details...
[17:50:48] [DOC: 9204151] ℹ️  API push details saved for document 9204151
[17:50:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204148                         ║
================================================================================
[17:50:48] ℹ️  Agency: Dartmouth HH
[17:50:48] ℹ️  Date: 03/26/2025
[17:50:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:50:50] [DOC: 9204148] ✅ Text extracted using pdfplumber (11338 chars)
[17:50:50] ✅    ✅ Text extracted using pdfplumber (11338 chars)
[17:50:50] 🔄 
🔄 Step 2: Extracting patient data...
[17:50:53] ℹ️  AI extracted raw sex value: 'F'
[17:50:53] ℹ️  AI extracted service line: 'PT'
[17:50:53] ℹ️  AI extracted payer source: ''
[17:50:53] ℹ️  AI extracted diagnoses:
[17:50:53] ℹ️    - Diagnosis 1: 'Z47.1'
[17:50:53] ℹ️    - Diagnosis 2: 'E66.9'
[17:50:53] ℹ️    - Diagnosis 3: 'Z68.30'
[17:50:53] ℹ️    - Diagnosis 4: 'F41.9'
[17:50:53] ℹ️    - Diagnosis 5: 'E55.9'
[17:50:53] ℹ️    - Diagnosis 6: 'M81.0'
[17:50:53] ℹ️  Final extracted MRN: '6191015'
[17:50:53] ℹ️  Final extracted Sex: 'FEMALE'
[17:50:53] ℹ️  Final extracted Service Line: 'PT'
[17:50:53] ℹ️  Final extracted Payer Source: ''
[17:50:53] ✅ Patient data extraction completed successfully
[17:50:53] ✅    ✅ Patient data extracted successfully
[17:50:53] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Fernandes
     └─ dob: 12/06/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6191015
     └─ billingProvider: Community Nurse Home Care, Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.30', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'M81.0'}]
[17:50:53] ✅    ✅ Patient identified: Janice Fernandes
[17:50:53] ✅    ✅ Patient name validation passed
[17:50:53] 🔄 
🔄 Step 3: Processing patient dates...
[17:50:53] [DOC: 9204148] ℹ️  DOB normalized: 12/06/1950
[17:50:53] [DOC: 9204148] ℹ️  Episode startOfCare normalized: 03/13/2025
[17:50:53] [DOC: 9204148] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[17:50:53] [DOC: 9204148] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[17:50:53] [DOC: 9204148] ✅ Patient date processing completed successfully
[17:50:53] ✅    ✅ Date processing completed
[17:50:53] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Fernandes
     └─ dob: 12/06/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6191015
     └─ billingProvider: Community Nurse Home Care, Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.9', 'thirdDiagnosis': 'Z68.30', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'M81.0'}]
[17:50:53] 🔄 
🔄 Step 4: Extracting order data...
[17:50:56] ℹ️  Order extraction - MRN: '6191015'
[17:50:56] ℹ️  Order extraction - Sex: 'FEMALE'
[17:50:56] ℹ️  Order extraction - Service Line: 'PT'
[17:50:56] ℹ️  Order extraction - Payer Source: ''
[17:50:56] ✅ Order data extraction completed successfully
[17:50:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:50:56] ℹ️  Using MRN from patient data: '6191015' over '6191015'
[17:50:56] ℹ️  Service line consistent in both sources: 'PT'
[17:50:56] ✅ Patient name cross-validation successful
[17:50:56] ✅    ✅ Data merged successfully
[17:50:58] ✅    ✅ Order data extracted and validated
[17:50:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:51:36] [DOC: 9204148] ℹ️  Patient not found in cache or API: Janice Fernandes
[17:51:36] [DOC: 9204148] ℹ️  Patient not found, creating new patient via API...
[17:51:36] [DOC: 9204148] ℹ️  Creating patient via API: Janice Fernandes
[17:51:37] [DOC: 9204148] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:51:37] ❌    ❌ Failed to create patient
[17:51:37] [DOC: 9204148] ℹ️  API push details saved for document 9204148
================================================================================
║                        Processing Document ID: 9204139                         ║
================================================================================
[17:51:37] ℹ️  Agency: Dartmouth HH
[17:51:37] ℹ️  Date: 03/26/2025
[17:51:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:51:43] [DOC: 9204139] ✅ Text extracted using pdfplumber (14197 chars)
[17:51:43] ✅    ✅ Text extracted using pdfplumber (14197 chars)
[17:51:43] 🔄 
🔄 Step 2: Extracting patient data...
[17:51:46] ℹ️  AI extracted raw sex value: 'M'
[17:51:46] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[17:51:46] ℹ️  AI extracted payer source: ''
[17:51:46] ℹ️  AI extracted diagnoses:
[17:51:46] ℹ️    - Diagnosis 1: 'E11.65'
[17:51:46] ℹ️    - Diagnosis 2: 'J84.9'
[17:51:46] ℹ️    - Diagnosis 3: 'I13.0'
[17:51:46] ℹ️    - Diagnosis 4: 'I50.32'
[17:51:46] ℹ️    - Diagnosis 5: 'E11.22'
[17:51:46] ℹ️    - Diagnosis 6: 'N18.30'
[17:51:46] ℹ️  Final extracted MRN: '227027'
[17:51:46] ℹ️  Final extracted Sex: 'MALE'
[17:51:46] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[17:51:46] ℹ️  Final extracted Payer Source: ''
[17:51:46] ✅ Patient data extraction completed successfully
[17:51:46] ✅    ✅ Patient data extracted successfully
[17:51:46] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'J84.9', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[17:51:46] ✅    ✅ Patient identified: Roger Alves
[17:51:46] ✅    ✅ Patient name validation passed
[17:51:46] 🔄 
🔄 Step 3: Processing patient dates...
[17:51:46] [DOC: 9204139] ℹ️  DOB normalized: 11/12/1943
[17:51:46] [DOC: 9204139] ℹ️  Episode startOfCare normalized: 01/20/2025
[17:51:46] [DOC: 9204139] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[17:51:46] [DOC: 9204139] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[17:51:46] [DOC: 9204139] ✅ Patient date processing completed successfully
[17:51:46] ✅    ✅ Date processing completed
[17:51:46] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'J84.9', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[17:51:46] 🔄 
🔄 Step 4: Extracting order data...
[17:51:49] ℹ️  Order extraction - MRN: '5879015'
[17:51:49] ℹ️  Order extraction - Sex: 'MALE'
[17:51:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[17:51:49] ℹ️  Order extraction - Payer Source: ''
[17:51:49] ✅ Order data extraction completed successfully
[17:51:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:51:49] ℹ️  Using longer MRN from order data: '5879015' over '227027'
[17:51:49] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[17:51:49] ✅ Patient name cross-validation successful
[17:51:49] ✅    ✅ Data merged successfully
[17:51:50] ✅    ✅ Order data extracted and validated
[17:51:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:51:50] [DOC: 9204139] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:51:50] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:51:50] 🔄 
🔄 Step 6: Pushing order to API...
[17:51:50] [DOC: 9204139] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:51:51] [DOC: 9204139] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12874"}
[17:51:51] ❌    ❌ Failed to push order
[17:51:51] 🔄 
🔄 Step 7: Writing to CSV...
[17:51:51] [DOC: 9204139] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[17:51:51] [DOC: 9204139] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[17:51:51] [DOC: 9204139] ℹ️  Payer Source extracted: ''
[17:51:51] [DOC: 9204139] ℹ️  Diagnosis codes being written:
[17:51:51] [DOC: 9204139] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[17:51:51] [DOC: 9204139] ℹ️    - Latest_Episode_Seconddiagnosis: 'J84.9'
[17:51:51] [DOC: 9204139] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[17:51:51] [DOC: 9204139] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.32'
[17:51:51] [DOC: 9204139] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[17:51:51] [DOC: 9204139] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.30'
[17:51:51] [DOC: 9204139] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 5879015
[17:51:51] ✅    ✅ Document 9204139 processed and saved successfully
[17:51:51] 🔄 
🔄 Step 8: Saving API details...
[17:51:51] [DOC: 9204139] ℹ️  API push details saved for document 9204139
[17:51:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204135                         ║
================================================================================
[17:51:51] ℹ️  Agency: Dartmouth HH
[17:51:51] ℹ️  Date: 03/26/2025
[17:51:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:51:54] [DOC: 9204135] ✅ Text extracted using pdfplumber (1322 chars)
[17:51:54] ✅    ✅ Text extracted using pdfplumber (1322 chars)
[17:51:54] 🔄 
🔄 Step 2: Extracting patient data...
[17:51:56] ℹ️  AI extracted raw sex value: 'M'
[17:51:56] ℹ️  AI extracted service line: 'RN'
[17:51:56] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[17:51:56] ℹ️  AI extracted diagnoses:
[17:51:56] ℹ️    - Diagnosis 1: 'None'
[17:51:56] ℹ️    - Diagnosis 2: 'None'
[17:51:56] ℹ️    - Diagnosis 3: 'None'
[17:51:56] ℹ️    - Diagnosis 4: 'None'
[17:51:56] ℹ️    - Diagnosis 5: 'None'
[17:51:56] ℹ️    - Diagnosis 6: 'None'
[17:51:56] ℹ️  Final extracted MRN: '5879015'
[17:51:56] ℹ️  Final extracted Sex: 'MALE'
[17:51:56] ℹ️  Final extracted Service Line: 'RN'
[17:51:56] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[17:51:56] ✅ Patient data extraction completed successfully
[17:51:56] ✅    ✅ Patient data extracted successfully
[17:51:56] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Community Nurse Home Care, Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:51:56] ✅    ✅ Patient identified: Roger Alves
[17:51:56] ✅    ✅ Patient name validation passed
[17:51:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:51:56] [DOC: 9204135] ℹ️  DOB normalized: 11/12/1943
[17:51:56] [DOC: 9204135] ℹ️  Episode startOfCare normalized: 01/20/2025
[17:51:56] [DOC: 9204135] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[17:51:56] [DOC: 9204135] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[17:51:56] [DOC: 9204135] ✅ Patient date processing completed successfully
[17:51:56] ✅    ✅ Date processing completed
[17:51:56] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Community Nurse Home Care, Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Home Care, Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025'}]
[17:51:56] 🔄 
🔄 Step 4: Extracting order data...
[17:51:59] ℹ️  Order extraction - MRN: '5879015'
[17:51:59] ℹ️  Order extraction - Sex: 'MALE'
[17:51:59] ℹ️  Order extraction - Service Line: 'RN'
[17:51:59] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[17:51:59] ✅ Order data extraction completed successfully
[17:51:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:51:59] ℹ️  Using MRN from patient data: '5879015' over '5879015'
[17:51:59] ℹ️  Service line consistent in both sources: 'RN'
[17:51:59] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[17:51:59] ✅ Patient name cross-validation successful
[17:51:59] ✅    ✅ Data merged successfully
[17:52:00] ✅    ✅ Order data extracted and validated
[17:52:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:52:00] [DOC: 9204135] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:52:00] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:52:00] 🔄 
🔄 Step 6: Pushing order to API...
[17:52:00] [DOC: 9204135] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:52:01] [DOC: 9204135] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12874"}
[17:52:01] ❌    ❌ Failed to push order
[17:52:01] 🔄 
🔄 Step 7: Writing to CSV...
[17:52:01] [DOC: 9204135] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[17:52:01] [DOC: 9204135] ℹ️  Service Line extracted: 'RN'
[17:52:01] [DOC: 9204135] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[17:52:01] [DOC: 9204135] ℹ️  Diagnosis codes being written:
[17:52:01] [DOC: 9204135] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:52:01] [DOC: 9204135] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:52:01] [DOC: 9204135] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:52:01] [DOC: 9204135] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:52:01] [DOC: 9204135] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:52:01] [DOC: 9204135] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:52:01] [DOC: 9204135] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 5879015
[17:52:01] ✅    ✅ Document 9204135 processed and saved successfully
[17:52:01] 🔄 
🔄 Step 8: Saving API details...
[17:52:01] [DOC: 9204135] ℹ️  API push details saved for document 9204135
[17:52:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9204131                         ║
================================================================================
[17:52:01] ℹ️  Agency: Fairhaven HH&H
[17:52:01] ℹ️  Date: 03/26/2025
[17:52:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:02] [DOC: 9204131] ❌ Critical failure in get_pdf_text: Invalid response format
[17:52:02] ❌ Failed to extract text for Doc ID 9204131
[17:52:02] [DOC: 9204131] ℹ️  API push details saved for document 9204131
================================================================================
║                        Processing Document ID: 9203913                         ║
================================================================================
[17:52:02] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:52:02] ℹ️  Date: 03/26/2025
[17:52:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:05] [DOC: 9203913] ✅ Text extracted using pdfplumber (5333 chars)
[17:52:05] ✅    ✅ Text extracted using pdfplumber (5333 chars)
[17:52:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:08] ℹ️  AI extracted raw sex value: 'F'
[17:52:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:52:08] ℹ️  AI extracted payer source: 'Fallon Navicare'
[17:52:08] ℹ️  AI extracted diagnoses:
[17:52:08] ℹ️    - Diagnosis 1: 'E11.22'
[17:52:08] ℹ️    - Diagnosis 2: 'I13.0'
[17:52:08] ℹ️    - Diagnosis 3: 'I50.32'
[17:52:08] ℹ️    - Diagnosis 4: 'N18.30'
[17:52:08] ℹ️    - Diagnosis 5: 'D63.1'
[17:52:08] ℹ️    - Diagnosis 6: 'F41.8'
[17:52:08] ℹ️  Final extracted MRN: '528005'
[17:52:08] ℹ️  Final extracted Sex: 'FEMALE'
[17:52:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:52:08] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[17:52:08] ✅ Patient data extraction completed successfully
[17:52:08] ✅    ✅ Patient data extracted successfully
[17:52:08] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 528005
     └─ billingProvider: Shan Qin, MD
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[17:52:08] ✅    ✅ Patient identified: Lorraine Moniz
[17:52:08] ✅    ✅ Patient name validation passed
[17:52:08] 🔄 
🔄 Step 3: Processing patient dates...
[17:52:08] [DOC: 9203913] ℹ️  DOB normalized: 07/18/1944
[17:52:08] [DOC: 9203913] ℹ️  Episode startOfCare normalized: 04/05/2024
[17:52:08] [DOC: 9203913] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[17:52:08] [DOC: 9203913] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[17:52:08] [DOC: 9203913] ✅ Patient date processing completed successfully
[17:52:08] ✅    ✅ Date processing completed
[17:52:08] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 528005
     └─ billingProvider: Shan Qin, MD
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[17:52:08] 🔄 
🔄 Step 4: Extracting order data...
[17:52:11] ℹ️  Order extraction - MRN: '528005'
[17:52:11] ℹ️  Order extraction - Sex: 'FEMALE'
[17:52:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:52:11] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[17:52:11] ✅ Order data extraction completed successfully
[17:52:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:52:11] ℹ️  Using MRN from patient data: '528005' over '528005'
[17:52:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:52:11] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[17:52:11] ✅ Patient name cross-validation successful
[17:52:11] ✅    ✅ Data merged successfully
[17:52:12] ✅    ✅ Order data extracted and validated
[17:52:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:52:12] [DOC: 9203913] ✅ Patient found in local cache: Lorraine Moniz, ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[17:52:12] ✅    ✅ Existing patient found with ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[17:52:12] 🔄 
🔄 Step 6: Pushing order to API...
[17:52:12] [DOC: 9203913] ℹ️  Pushing order via API for patient ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[17:52:13] [DOC: 9203913] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:52:13] ❌    ❌ Failed to push order
[17:52:13] 🔄 
🔄 Step 7: Writing to CSV...
[17:52:13] [DOC: 9203913] ℹ️  Calculated age: 80 from DOB: 07/18/1944
[17:52:13] [DOC: 9203913] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:52:13] [DOC: 9203913] ℹ️  Payer Source extracted: 'Fallon Navicare'
[17:52:13] [DOC: 9203913] ℹ️  Diagnosis codes being written:
[17:52:13] [DOC: 9203913] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[17:52:13] [DOC: 9203913] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[17:52:13] [DOC: 9203913] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[17:52:13] [DOC: 9203913] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[17:52:13] [DOC: 9203913] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[17:52:13] [DOC: 9203913] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.8'
[17:52:13] [DOC: 9203913] ✅ Patient data written to CSV: Lorraine Moniz | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Fallon Navicare | MRN: 528005
[17:52:13] ✅    ✅ Document 9203913 processed and saved successfully
[17:52:13] 🔄 
🔄 Step 8: Saving API details...
[17:52:13] [DOC: 9203913] ℹ️  API push details saved for document 9203913
[17:52:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203906                         ║
================================================================================
[17:52:13] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:52:13] ℹ️  Date: 03/26/2025
[17:52:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:15] [DOC: 9203906] ✅ Text extracted using pdfplumber (1751 chars)
[17:52:15] ✅    ✅ Text extracted using pdfplumber (1751 chars)
[17:52:15] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:18] ℹ️  AI extracted raw sex value: 'F'
[17:52:18] ℹ️  AI extracted service line: 'RN'
[17:52:18] ℹ️  AI extracted payer source: 'Senior Whole Health'
[17:52:18] ℹ️  AI extracted diagnoses:
[17:52:18] ℹ️    - Diagnosis 1: ''
[17:52:18] ℹ️    - Diagnosis 2: ''
[17:52:18] ℹ️    - Diagnosis 3: ''
[17:52:18] ℹ️    - Diagnosis 4: ''
[17:52:18] ℹ️    - Diagnosis 5: ''
[17:52:18] ℹ️    - Diagnosis 6: ''
[17:52:18] ℹ️  Final extracted MRN: '333005'
[17:52:18] ℹ️  Final extracted Sex: 'FEMALE'
[17:52:18] ℹ️  Final extracted Service Line: 'RN'
[17:52:18] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[17:52:18] ✅ Patient data extraction completed successfully
[17:52:18] ✅    ✅ Patient data extracted successfully
[17:52:18] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ billingProvider: Karmina Bautista, MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:52:18] ✅    ✅ Patient identified: Shirley Tavares
[17:52:18] ✅    ✅ Patient name validation passed
[17:52:18] 🔄 
🔄 Step 3: Processing patient dates...
[17:52:18] [DOC: 9203906] ℹ️  DOB normalized: 11/10/1949
[17:52:18] [DOC: 9203906] ℹ️  Episode startOfCare normalized: 09/19/2022
[17:52:18] [DOC: 9203906] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[17:52:18] [DOC: 9203906] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[17:52:18] [DOC: 9203906] ✅ Patient date processing completed successfully
[17:52:18] ✅    ✅ Date processing completed
[17:52:18] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ billingProvider: Karmina Bautista, MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:52:18] 🔄 
🔄 Step 4: Extracting order data...
[17:52:21] ℹ️  Order extraction - MRN: '333005'
[17:52:21] ℹ️  Order extraction - Sex: 'FEMALE'
[17:52:21] ℹ️  Order extraction - Service Line: 'HHA'
[17:52:21] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[17:52:21] ✅ Order data extraction completed successfully
[17:52:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:52:21] ℹ️  Using MRN from patient data: '333005' over '333005'
[17:52:21] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[17:52:21] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[17:52:21] ✅ Patient name cross-validation successful
[17:52:21] ✅    ✅ Data merged successfully
[17:52:22] ✅    ✅ Order data extracted and validated
[17:52:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:52:22] [DOC: 9203906] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[17:52:22] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[17:52:22] 🔄 
🔄 Step 6: Pushing order to API...
[17:52:22] [DOC: 9203906] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[17:52:23] [DOC: 9203906] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:52:23] ❌    ❌ Failed to push order
[17:52:23] 🔄 
🔄 Step 7: Writing to CSV...
[17:52:23] [DOC: 9203906] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[17:52:23] [DOC: 9203906] ℹ️  Service Line extracted: 'HHA, RN'
[17:52:23] [DOC: 9203906] ℹ️  Payer Source extracted: 'Senior Whole Health'
[17:52:23] [DOC: 9203906] ℹ️  Diagnosis codes being written:
[17:52:23] [DOC: 9203906] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:52:23] [DOC: 9203906] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:52:23] [DOC: 9203906] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:52:23] [DOC: 9203906] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:52:23] [DOC: 9203906] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:52:23] [DOC: 9203906] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:52:23] [DOC: 9203906] ✅ Patient data written to CSV: Shirley Tavares | Sex: FEMALE | Age: 75 | Service: HHA, RN | Payer: Senior Whole Health | MRN: 333005
[17:52:23] ✅    ✅ Document 9203906 processed and saved successfully
[17:52:23] 🔄 
🔄 Step 8: Saving API details...
[17:52:23] [DOC: 9203906] ℹ️  API push details saved for document 9203906
[17:52:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203819                         ║
================================================================================
[17:52:23] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:52:23] ℹ️  Date: 03/26/2025
[17:52:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:27] [DOC: 9203819] ✅ Text extracted using pdfplumber (48698 chars)
[17:52:27] ✅    ✅ Text extracted using pdfplumber (48698 chars)
[17:52:27] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:32] ℹ️  AI extracted raw sex value: ''
[17:52:32] ℹ️  AI extracted service line: ''
[17:52:32] ℹ️  AI extracted payer source: ''
[17:52:32] ℹ️  AI extracted diagnoses:
[17:52:32] ℹ️    - Diagnosis 1: ''
[17:52:32] ℹ️    - Diagnosis 2: ''
[17:52:32] ℹ️    - Diagnosis 3: ''
[17:52:32] ℹ️    - Diagnosis 4: ''
[17:52:32] ℹ️    - Diagnosis 5: ''
[17:52:32] ℹ️    - Diagnosis 6: ''
[17:52:32] ℹ️  Final extracted MRN: ''
[17:52:32] ℹ️  Final extracted Sex: ''
[17:52:32] ℹ️  Final extracted Service Line: ''
[17:52:32] ℹ️  Final extracted Payer Source: ''
[17:52:32] ✅ Patient data extraction completed successfully
[17:52:32] ✅    ✅ Patient data extracted successfully
[17:52:32] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[17:52:32] ⚠️     ❌ Insufficient patient data extracted
[17:52:32] [DOC: 9203819] ℹ️  API push details saved for document 9203819
================================================================================
║                        Processing Document ID: 9203811                         ║
================================================================================
[17:52:32] ℹ️  Agency: Visiting Rehab & Nursing Services
[17:52:32] ℹ️  Date: 03/26/2025
[17:52:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:35] [DOC: 9203811] ✅ Text extracted using pdfplumber (4627 chars)
[17:52:35] ✅    ✅ Text extracted using pdfplumber (4627 chars)
[17:52:35] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:37] ℹ️  AI extracted raw sex value: 'None'
[17:52:37] ℹ️  AI extracted service line: 'None'
[17:52:37] ℹ️  AI extracted payer source: 'None'
[17:52:37] ℹ️  AI extracted diagnoses:
[17:52:37] ℹ️    - Diagnosis 1: 'None'
[17:52:37] ℹ️    - Diagnosis 2: 'None'
[17:52:37] ℹ️    - Diagnosis 3: 'None'
[17:52:37] ℹ️    - Diagnosis 4: 'None'
[17:52:37] ℹ️    - Diagnosis 5: 'None'
[17:52:37] ℹ️    - Diagnosis 6: 'None'
[17:52:37] ℹ️  Final extracted MRN: ''
[17:52:37] ℹ️  Final extracted Sex: ''
[17:52:37] ℹ️  Final extracted Service Line: ''
[17:52:37] ℹ️  Final extracted Payer Source: ''
[17:52:37] ✅ Patient data extraction completed successfully
[17:52:37] ✅    ✅ Patient data extracted successfully
[17:52:37] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:52:37] ⚠️     ❌ Insufficient patient data extracted
[17:52:37] [DOC: 9203811] ℹ️  API push details saved for document 9203811
================================================================================
║                        Processing Document ID: 9203598                         ║
================================================================================
[17:52:37] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[17:52:37] ℹ️  Date: 03/26/2025
[17:52:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:39] [DOC: 9203598] ✅ Text extracted using pdfplumber (7399 chars)
[17:52:39] ✅    ✅ Text extracted using pdfplumber (7399 chars)
[17:52:39] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:42] ℹ️  AI extracted raw sex value: 'M'
[17:52:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:52:42] ℹ️  AI extracted payer source: 'None'
[17:52:42] ℹ️  AI extracted diagnoses:
[17:52:42] ℹ️    - Diagnosis 1: 'F25.0'
[17:52:42] ℹ️    - Diagnosis 2: 'E11.22'
[17:52:42] ℹ️    - Diagnosis 3: 'I13.10'
[17:52:42] ℹ️    - Diagnosis 4: 'N18.31'
[17:52:42] ℹ️    - Diagnosis 5: 'F41.0'
[17:52:42] ℹ️    - Diagnosis 6: 'F41.9'
[17:52:42] ℹ️  Final extracted MRN: '879'
[17:52:42] ℹ️  Final extracted Sex: 'MALE'
[17:52:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:52:42] ℹ️  Final extracted Payer Source: ''
[17:52:42] ✅ Patient data extraction completed successfully
[17:52:42] ✅    ✅ Patient data extracted successfully
[17:52:42] 📊 Patient Response
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[17:52:42] ✅    ✅ Patient identified: Sean McCarthy
[17:52:42] ✅    ✅ Patient name validation passed
[17:52:42] 🔄 
🔄 Step 3: Processing patient dates...
[17:52:42] [DOC: 9203598] ℹ️  DOB normalized: 09/16/1969
[17:52:42] [DOC: 9203598] ℹ️  Episode startOfCare normalized: 03/30/2024
[17:52:42] [DOC: 9203598] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[17:52:42] [DOC: 9203598] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[17:52:42] [DOC: 9203598] ✅ Patient date processing completed successfully
[17:52:42] ✅    ✅ Date processing completed
[17:52:42] 📊 Processed Patient Data
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'I13.10', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'F41.0', 'sixthDiagnosis': 'F41.9'}]
[17:52:42] 🔄 
🔄 Step 4: Extracting order data...
[17:52:45] ℹ️  Order extraction - MRN: '879'
[17:52:45] ℹ️  Order extraction - Sex: 'MALE'
[17:52:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:52:45] ℹ️  Order extraction - Payer Source: ''
[17:52:45] ✅ Order data extraction completed successfully
[17:52:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:52:45] ℹ️  Using MRN from patient data: '879' over '879'
[17:52:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:52:45] ✅ Patient name cross-validation successful
[17:52:45] ✅    ✅ Data merged successfully
[17:52:46] ✅    ✅ Order data extracted and validated
[17:52:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:52:46] [DOC: 9203598] ✅ Patient found in local cache: Sean McCarthy, ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[17:52:46] ✅    ✅ Existing patient found with ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[17:52:46] 🔄 
🔄 Step 6: Pushing order to API...
[17:52:46] [DOC: 9203598] ℹ️  Pushing order via API for patient ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[17:52:47] [DOC: 9203598] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[17:52:47] ❌    ❌ Failed to push order
[17:52:47] 🔄 
🔄 Step 7: Writing to CSV...
[17:52:47] [DOC: 9203598] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[17:52:47] [DOC: 9203598] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:52:47] [DOC: 9203598] ℹ️  Payer Source extracted: ''
[17:52:47] [DOC: 9203598] ℹ️  Diagnosis codes being written:
[17:52:47] [DOC: 9203598] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[17:52:47] [DOC: 9203598] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[17:52:47] [DOC: 9203598] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.10'
[17:52:47] [DOC: 9203598] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[17:52:47] [DOC: 9203598] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.0'
[17:52:47] [DOC: 9203598] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:52:47] [DOC: 9203598] ✅ Patient data written to CSV: Sean McCarthy | Sex: MALE | Age: 55 | Service: Skilled Nursing | Payer:  | MRN: 879
[17:52:47] ✅    ✅ Document 9203598 processed and saved successfully
[17:52:47] 🔄 
🔄 Step 8: Saving API details...
[17:52:47] [DOC: 9203598] ℹ️  API push details saved for document 9203598
[17:52:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203542                         ║
================================================================================
[17:52:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:52:47] ℹ️  Date: 03/26/2025
[17:52:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:49] [DOC: 9203542] ✅ Text extracted using pdfplumber (1347 chars)
[17:52:49] ✅    ✅ Text extracted using pdfplumber (1347 chars)
[17:52:49] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:51] ℹ️  AI extracted raw sex value: 'F'
[17:52:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:52:51] ℹ️  AI extracted payer source: ''
[17:52:51] ℹ️  AI extracted diagnoses:
[17:52:51] ℹ️    - Diagnosis 1: ''
[17:52:51] ℹ️    - Diagnosis 2: ''
[17:52:51] ℹ️    - Diagnosis 3: ''
[17:52:51] ℹ️    - Diagnosis 4: ''
[17:52:51] ℹ️    - Diagnosis 5: ''
[17:52:51] ℹ️    - Diagnosis 6: ''
[17:52:51] ℹ️  Final extracted MRN: '2085476'
[17:52:51] ℹ️  Final extracted Sex: 'FEMALE'
[17:52:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:52:51] ℹ️  Final extracted Payer Source: ''
[17:52:51] ✅ Patient data extraction completed successfully
[17:52:51] ✅    ✅ Patient data extracted successfully
[17:52:51] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Simon
     └─ dob: 01/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085476
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:52:51] ✅    ✅ Patient identified: Joyce Simon
[17:52:51] ✅    ✅ Patient name validation passed
[17:52:51] 🔄 
🔄 Step 3: Processing patient dates...
[17:52:51] [DOC: 9203542] ℹ️  DOB normalized: 01/01/1936
[17:52:51] [DOC: 9203542] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[17:52:51] [DOC: 9203542] ✅ Patient date processing completed successfully
[17:52:51] ✅    ✅ Date processing completed
[17:52:51] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Simon
     └─ dob: 01/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085476
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:52:51] 🔄 
🔄 Step 4: Extracting order data...
[17:52:53] ℹ️  Order extraction - MRN: '2085476'
[17:52:53] ℹ️  Order extraction - Sex: 'FEMALE'
[17:52:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:52:53] ℹ️  Order extraction - Payer Source: ''
[17:52:53] ✅ Order data extraction completed successfully
[17:52:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:52:53] ℹ️  Using MRN from patient data: '2085476' over '2085476'
[17:52:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:52:53] ✅ Patient name cross-validation successful
[17:52:53] ✅    ✅ Data merged successfully
[17:52:55] ✅    ✅ Order data extracted and validated
[17:52:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:52:55] [DOC: 9203542] ✅ Patient found in local cache: Joyce Simon, ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[17:52:55] ✅    ✅ Existing patient found with ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[17:52:55] 🔄 
🔄 Step 6: Pushing order to API...
[17:52:55] [DOC: 9203542] ℹ️  Pushing order via API for patient ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[17:52:56] [DOC: 9203542] ❌ Order push failed with status 201: {"id":"b22573be-1abb-4c76-ba93-3f084f1596c4","orderWAVId":"ORD20078","orderNo":"1073154","orderDate":"03/21/2025","startOfCare":"02/15/2025","episodeStartDate":"02/15/2025","episodeEndDate":"04/15/2025","documentID":"9203542","mrn":"2085476","patientName":"Simon,Joyce","sentToPhysicianDate":"03/26/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/28/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"a5f8298d-63ea-4aab-8ad4-b4c248dd241f","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:52:56] ❌    ❌ Failed to push order
[17:52:56] 🔄 
🔄 Step 7: Writing to CSV...
[17:52:56] [DOC: 9203542] ℹ️  Calculated age: 89 from DOB: 01/01/1936
[17:52:56] [DOC: 9203542] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:52:56] [DOC: 9203542] ℹ️  Payer Source extracted: ''
[17:52:56] [DOC: 9203542] ℹ️  Diagnosis codes being written:
[17:52:56] [DOC: 9203542] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:52:56] [DOC: 9203542] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:52:56] [DOC: 9203542] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:52:56] [DOC: 9203542] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:52:56] [DOC: 9203542] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:52:56] [DOC: 9203542] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:52:56] [DOC: 9203542] ✅ Patient data written to CSV: Joyce Simon | Sex: FEMALE | Age: 89 | Service: Skilled Nursing | Payer:  | MRN: 2085476
[17:52:56] ✅    ✅ Document 9203542 processed and saved successfully
[17:52:56] 🔄 
🔄 Step 8: Saving API details...
[17:52:56] [DOC: 9203542] ℹ️  API push details saved for document 9203542
[17:52:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203520                         ║
================================================================================
[17:52:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:52:56] ℹ️  Date: 03/26/2025
[17:52:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:58] [DOC: 9203520] ✅ Text extracted using pdfplumber (1180 chars)
[17:52:58] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[17:52:58] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:00] ℹ️  AI extracted raw sex value: 'M'
[17:53:00] ℹ️  AI extracted service line: 'Home Health Aide'
[17:53:00] ℹ️  AI extracted payer source: ''
[17:53:00] ℹ️  AI extracted diagnoses:
[17:53:00] ℹ️    - Diagnosis 1: ''
[17:53:00] ℹ️    - Diagnosis 2: ''
[17:53:00] ℹ️    - Diagnosis 3: ''
[17:53:00] ℹ️    - Diagnosis 4: ''
[17:53:00] ℹ️    - Diagnosis 5: ''
[17:53:00] ℹ️    - Diagnosis 6: ''
[17:53:00] ℹ️  Final extracted MRN: '2716471'
[17:53:00] ℹ️  Final extracted Sex: 'MALE'
[17:53:00] ℹ️  Final extracted Service Line: 'Home Health Aide'
[17:53:00] ℹ️  Final extracted Payer Source: ''
[17:53:00] ✅ Patient data extraction completed successfully
[17:53:00] ✅    ✅ Patient data extracted successfully
[17:53:00] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:00] ✅    ✅ Patient identified: Thomas McCormack
[17:53:00] ✅    ✅ Patient name validation passed
[17:53:00] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:00] [DOC: 9203520] ℹ️  DOB normalized: 03/17/1944
[17:53:00] [DOC: 9203520] ✅ Patient date processing completed successfully
[17:53:00] ✅    ✅ Date processing completed
[17:53:00] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:00] 🔄 
🔄 Step 4: Extracting order data...
[17:53:02] ℹ️  Order extraction - MRN: '2716471'
[17:53:02] ℹ️  Order extraction - Sex: 'MALE'
[17:53:02] ℹ️  Order extraction - Service Line: 'Home Health Aide'
[17:53:02] ℹ️  Order extraction - Payer Source: ''
[17:53:02] ✅ Order data extraction completed successfully
[17:53:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:02] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[17:53:02] ℹ️  Service line consistent in both sources: 'Home Health Aide'
[17:53:02] ✅ Patient name cross-validation successful
[17:53:02] ✅    ✅ Data merged successfully
[17:53:04] ✅    ✅ Order data extracted and validated
[17:53:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:04] [DOC: 9203520] ✅ Patient found in local cache: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[17:53:04] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[17:53:04] 🔄 
🔄 Step 6: Pushing order to API...
[17:53:04] [DOC: 9203520] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[17:53:05] [DOC: 9203520] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13335"}
[17:53:05] ❌    ❌ Failed to push order
[17:53:05] 🔄 
🔄 Step 7: Writing to CSV...
[17:53:05] [DOC: 9203520] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[17:53:05] [DOC: 9203520] ℹ️  Service Line extracted: 'Home Health Aide'
[17:53:05] [DOC: 9203520] ℹ️  Payer Source extracted: ''
[17:53:05] [DOC: 9203520] ℹ️  Diagnosis codes being written:
[17:53:05] [DOC: 9203520] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:53:05] [DOC: 9203520] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:53:05] [DOC: 9203520] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:53:05] [DOC: 9203520] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:53:05] [DOC: 9203520] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:53:05] [DOC: 9203520] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:53:05] [DOC: 9203520] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Home Health Aide | Payer:  | MRN: 2716471
[17:53:05] ✅    ✅ Document 9203520 processed and saved successfully
[17:53:05] 🔄 
🔄 Step 8: Saving API details...
[17:53:05] [DOC: 9203520] ℹ️  API push details saved for document 9203520
[17:53:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203483                         ║
================================================================================
[17:53:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:53:05] ℹ️  Date: 03/26/2025
[17:53:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:06] [DOC: 9203483] ✅ Text extracted using pdfplumber (2293 chars)
[17:53:06] ✅    ✅ Text extracted using pdfplumber (2293 chars)
[17:53:06] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:12] ℹ️  AI extracted raw sex value: 'F'
[17:53:12] ℹ️  AI extracted service line: 'Medical Social Work'
[17:53:12] ℹ️  AI extracted payer source: ''
[17:53:12] ℹ️  AI extracted diagnoses:
[17:53:12] ℹ️    - Diagnosis 1: ''
[17:53:12] ℹ️    - Diagnosis 2: ''
[17:53:12] ℹ️    - Diagnosis 3: ''
[17:53:12] ℹ️    - Diagnosis 4: ''
[17:53:12] ℹ️    - Diagnosis 5: ''
[17:53:12] ℹ️    - Diagnosis 6: ''
[17:53:12] ℹ️  Final extracted MRN: '2544762'
[17:53:12] ℹ️  Final extracted Sex: 'FEMALE'
[17:53:12] ℹ️  Final extracted Service Line: 'Medical Social Work'
[17:53:12] ℹ️  Final extracted Payer Source: ''
[17:53:12] ✅ Patient data extraction completed successfully
[17:53:12] ✅    ✅ Patient data extracted successfully
[17:53:12] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Gurney
     └─ dob: 12/05/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2544762
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/14/2024', 'endOfEpisode': '05/18/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '05/15/2024', 'endOfEpisode': '08/11/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '08/12/2024', 'endOfEpisode': '10/31/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '11/10/2024', 'endOfEpisode': '01/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '01/12/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:12] ✅    ✅ Patient identified: Janice Gurney
[17:53:12] ✅    ✅ Patient name validation passed
[17:53:12] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:12] [DOC: 9203483] ℹ️  DOB normalized: 12/05/1929
[17:53:12] [DOC: 9203483] ℹ️  Episode startOfEpisode normalized: 05/14/2024
[17:53:12] [DOC: 9203483] ℹ️  Episode endOfEpisode normalized: 05/18/2024
[17:53:12] [DOC: 9203483] ✅ Patient date processing completed successfully
[17:53:12] ✅    ✅ Date processing completed
[17:53:12] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Gurney
     └─ dob: 12/05/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2544762
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/14/2024', 'endOfEpisode': '05/18/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '05/15/2024', 'endOfEpisode': '08/11/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '08/12/2024', 'endOfEpisode': '10/31/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '11/10/2024', 'endOfEpisode': '01/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '01/09/2025', 'endOfEpisode': '03/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '01/12/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:12] 🔄 
🔄 Step 4: Extracting order data...
[17:53:15] ℹ️  Order extraction - MRN: '2544762'
[17:53:15] ℹ️  Order extraction - Sex: 'FEMALE'
[17:53:15] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[17:53:15] ℹ️  Order extraction - Payer Source: ''
[17:53:15] ✅ Order data extraction completed successfully
[17:53:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:15] ℹ️  Using MRN from patient data: '2544762' over '2544762'
[17:53:15] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[17:53:15] ✅ Patient name cross-validation successful
[17:53:15] ✅    ✅ Data merged successfully
[17:53:16] ✅    ✅ Order data extracted and validated
[17:53:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:24] [DOC: 9203483] ℹ️  Patient not found in cache or API: Janice Gurney
[17:53:24] [DOC: 9203483] ℹ️  Patient not found, creating new patient via API...
[17:53:24] [DOC: 9203483] ℹ️  Creating patient via API: Janice Gurney
[17:53:25] [DOC: 9203483] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:53:25] ❌    ❌ Failed to create patient
[17:53:25] [DOC: 9203483] ℹ️  API push details saved for document 9203483
================================================================================
║                        Processing Document ID: 9203466                         ║
================================================================================
[17:53:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:53:25] ℹ️  Date: 03/26/2025
[17:53:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:27] [DOC: 9203466] ✅ Text extracted using pdfplumber (1410 chars)
[17:53:27] ✅    ✅ Text extracted using pdfplumber (1398 chars)
[17:53:27] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:30] ℹ️  AI extracted raw sex value: ''
[17:53:30] ℹ️  AI extracted service line: 'Physical Therapy'
[17:53:30] ℹ️  AI extracted payer source: ''
[17:53:30] ℹ️  AI extracted diagnoses:
[17:53:30] ℹ️    - Diagnosis 1: 'I82.412'
[17:53:30] ℹ️    - Diagnosis 2: 'E78.5'
[17:53:30] ℹ️    - Diagnosis 3: 'I10'
[17:53:30] ℹ️    - Diagnosis 4: ''
[17:53:30] ℹ️    - Diagnosis 5: ''
[17:53:30] ℹ️    - Diagnosis 6: ''
[17:53:30] ℹ️  Final extracted MRN: 'MA250121084101'
[17:53:30] ℹ️  Final extracted Sex: ''
[17:53:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:53:30] ℹ️  Final extracted Payer Source: ''
[17:53:30] ✅ Patient data extraction completed successfully
[17:53:30] ✅    ✅ Patient data extracted successfully
[17:53:30] 📊 Patient Response
     └─ patientFName: Dora
     └─ patientLName: Simas
     └─ dob: 08/03/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA250121084101
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I82.412', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:30] ✅    ✅ Patient identified: Dora Simas
[17:53:30] ✅    ✅ Patient name validation passed
[17:53:30] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:30] [DOC: 9203466] ℹ️  DOB normalized: 08/03/1941
[17:53:30] [DOC: 9203466] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[17:53:30] [DOC: 9203466] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[17:53:30] [DOC: 9203466] ✅ Patient date processing completed successfully
[17:53:30] ✅    ✅ Date processing completed
[17:53:30] 📊 Processed Patient Data
     └─ patientFName: Dora
     └─ patientLName: Simas
     └─ dob: 08/03/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA250121084101
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'I82.412', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:30] 🔄 
🔄 Step 4: Extracting order data...
[17:53:33] ℹ️  Order extraction - MRN: 'MA250121084101'
[17:53:33] ℹ️  Order extraction - Sex: ''
[17:53:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:53:33] ℹ️  Order extraction - Payer Source: ''
[17:53:33] ✅ Order data extraction completed successfully
[17:53:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:33] ℹ️  Using MRN from patient data: 'MA250121084101' over 'MA250121084101'
[17:53:33] ⚠️  Could not determine sex using any available method
[17:53:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:53:33] ✅ Patient name cross-validation successful
[17:53:33] ✅    ✅ Data merged successfully
[17:53:34] ✅    ✅ Order data extracted and validated
[17:53:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:39] [DOC: 9203466] ℹ️  Patient not found in cache or API: Dora Simas
[17:53:39] [DOC: 9203466] ℹ️  Patient not found, creating new patient via API...
[17:53:39] [DOC: 9203466] ℹ️  Creating patient via API: Dora Simas
[17:53:40] [DOC: 9203466] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:53:40] ❌    ❌ Failed to create patient
[17:53:40] [DOC: 9203466] ℹ️  API push details saved for document 9203466
================================================================================
║                        Processing Document ID: 9203465                         ║
================================================================================
[17:53:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:53:40] ℹ️  Date: 03/26/2025
[17:53:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:42] [DOC: 9203465] ✅ Text extracted using pdfplumber (1136 chars)
[17:53:42] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[17:53:42] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:45] ℹ️  AI extracted raw sex value: ''
[17:53:45] ℹ️  AI extracted service line: 'Nursing, LVN/LPN'
[17:53:45] ℹ️  AI extracted payer source: ''
[17:53:45] ℹ️  AI extracted diagnoses:
[17:53:45] ℹ️    - Diagnosis 1: 'F31.30'
[17:53:45] ℹ️    - Diagnosis 2: 'I11.0'
[17:53:45] ℹ️    - Diagnosis 3: 'I50.32'
[17:53:45] ℹ️    - Diagnosis 4: 'None'
[17:53:45] ℹ️    - Diagnosis 5: 'None'
[17:53:45] ℹ️    - Diagnosis 6: 'None'
[17:53:45] ℹ️  Final extracted MRN: '100991032'
[17:53:45] ℹ️  Final extracted Sex: ''
[17:53:45] ℹ️  Final extracted Service Line: 'Nursing, LVN/LPN'
[17:53:45] ℹ️  Final extracted Payer Source: ''
[17:53:45] ✅ Patient data extraction completed successfully
[17:53:45] ✅    ✅ Patient data extracted successfully
[17:53:45] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Ferreira
     └─ dob: 10/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100991032
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing, LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/11/2024', 'endOfEpisode': '09/08/2024', 'firstDiagnosis': 'F31.30', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:53:45] ✅    ✅ Patient identified: Gloria Ferreira
[17:53:45] ✅    ✅ Patient name validation passed
[17:53:45] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:45] [DOC: 9203465] ℹ️  DOB normalized: 10/01/1944
[17:53:45] [DOC: 9203465] ℹ️  Episode startOfEpisode normalized: 07/11/2024
[17:53:45] [DOC: 9203465] ℹ️  Episode endOfEpisode normalized: 09/08/2024
[17:53:45] [DOC: 9203465] ✅ Patient date processing completed successfully
[17:53:45] ✅    ✅ Date processing completed
[17:53:45] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Ferreira
     └─ dob: 10/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100991032
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing, LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/11/2024', 'endOfEpisode': '09/08/2024', 'firstDiagnosis': 'F31.30', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32'}]
[17:53:45] 🔄 
🔄 Step 4: Extracting order data...
[17:53:48] ℹ️  Order extraction - MRN: '100991032'
[17:53:48] ℹ️  Order extraction - Sex: ''
[17:53:48] ℹ️  Order extraction - Service Line: 'Nursing'
[17:53:48] ℹ️  Order extraction - Payer Source: ''
[17:53:48] ✅ Order data extraction completed successfully
[17:53:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:48] ℹ️  Using MRN from patient data: '100991032' over '100991032'
[17:53:48] ⚠️  Could not determine sex using any available method
[17:53:48] ℹ️  Combined service lines: Patient='Nursing, LVN/LPN' + Order='Nursing' = 'LVN/LPN, Nursing'
[17:53:48] ✅ Patient name cross-validation successful
[17:53:48] ✅    ✅ Data merged successfully
[17:53:49] ✅    ✅ Order data extracted and validated
[17:53:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:49] [DOC: 9203465] ✅ Patient found in local cache: Gloria Ferreira, ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[17:53:49] ✅    ✅ Existing patient found with ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[17:53:49] 🔄 
🔄 Step 6: Pushing order to API...
[17:53:49] [DOC: 9203465] ℹ️  Pushing order via API for patient ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[17:53:50] [DOC: 9203465] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13976"}
[17:53:50] ❌    ❌ Failed to push order
[17:53:50] 🔄 
🔄 Step 7: Writing to CSV...
[17:53:50] [DOC: 9203465] ℹ️  Calculated age: 80 from DOB: 10/01/1944
[17:53:50] [DOC: 9203465] ℹ️  Service Line extracted: 'LVN/LPN, Nursing'
[17:53:50] [DOC: 9203465] ℹ️  Payer Source extracted: ''
[17:53:50] [DOC: 9203465] ℹ️  Diagnosis codes being written:
[17:53:50] [DOC: 9203465] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.30'
[17:53:50] [DOC: 9203465] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[17:53:50] [DOC: 9203465] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[17:53:50] [DOC: 9203465] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:53:50] [DOC: 9203465] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:53:50] [DOC: 9203465] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:53:50] [DOC: 9203465] ✅ Patient data written to CSV: Gloria Ferreira | Sex:  | Age: 80 | Service: LVN/LPN, Nursing | Payer:  | MRN: 100991032
[17:53:50] ✅    ✅ Document 9203465 processed and saved successfully
[17:53:50] 🔄 
🔄 Step 8: Saving API details...
[17:53:50] [DOC: 9203465] ℹ️  API push details saved for document 9203465
[17:53:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203408                         ║
================================================================================
[17:53:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:53:50] ℹ️  Date: 03/26/2025
[17:53:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:53] [DOC: 9203408] ✅ Text extracted using pdfplumber (15671 chars)
[17:53:53] ✅    ✅ Text extracted using pdfplumber (15671 chars)
[17:53:53] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:56] ℹ️  AI extracted raw sex value: 'F'
[17:53:56] ℹ️  AI extracted service line: 'PT'
[17:53:56] ℹ️  AI extracted payer source: ''
[17:53:56] ℹ️  AI extracted diagnoses:
[17:53:56] ℹ️    - Diagnosis 1: ''
[17:53:56] ℹ️    - Diagnosis 2: ''
[17:53:56] ℹ️    - Diagnosis 3: ''
[17:53:56] ℹ️    - Diagnosis 4: ''
[17:53:56] ℹ️    - Diagnosis 5: ''
[17:53:56] ℹ️    - Diagnosis 6: ''
[17:53:56] ℹ️  Final extracted MRN: 'MA211018024802'
[17:53:56] ℹ️  Final extracted Sex: 'FEMALE'
[17:53:56] ℹ️  Final extracted Service Line: 'PT'
[17:53:56] ℹ️  Final extracted Payer Source: ''
[17:53:56] ✅ Patient data extraction completed successfully
[17:53:56] ✅    ✅ Patient data extracted successfully
[17:53:56] 📊 Patient Response
     └─ patientFName: Bernice
     └─ patientLName: Duarte
     └─ dob: 02/07/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA211018024802
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/09/2024', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:56] ✅    ✅ Patient identified: Bernice Duarte
[17:53:56] ✅    ✅ Patient name validation passed
[17:53:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:56] [DOC: 9203408] ℹ️  DOB normalized: 02/07/1948
[17:53:56] [DOC: 9203408] ℹ️  Episode startOfEpisode normalized: 09/09/2024
[17:53:56] [DOC: 9203408] ✅ Patient date processing completed successfully
[17:53:56] ✅    ✅ Date processing completed
[17:53:56] 📊 Processed Patient Data
     └─ patientFName: Bernice
     └─ patientLName: Duarte
     └─ dob: 02/07/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA211018024802
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/09/2024', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:56] 🔄 
🔄 Step 4: Extracting order data...
[17:53:59] ℹ️  Order extraction - MRN: 'MA211018024802'
[17:53:59] ℹ️  Order extraction - Sex: 'FEMALE'
[17:53:59] ℹ️  Order extraction - Service Line: 'PT'
[17:53:59] ℹ️  Order extraction - Payer Source: ''
[17:53:59] ✅ Order data extraction completed successfully
[17:53:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:59] ℹ️  Using MRN from patient data: 'MA211018024802' over 'MA211018024802'
[17:53:59] ℹ️  Service line consistent in both sources: 'PT'
[17:53:59] ✅ Patient name cross-validation successful
[17:53:59] ✅    ✅ Data merged successfully
[17:54:00] ⚠️     ❌ Skipping - missing episode start date
[17:54:00] [DOC: 9203408] ℹ️  API push details saved for document 9203408
================================================================================
║                        Processing Document ID: 9203400                         ║
================================================================================
[17:54:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:54:00] ℹ️  Date: 03/26/2025
[17:54:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:02] [DOC: 9203400] ✅ Text extracted using pdfplumber (2381 chars)
[17:54:02] ✅    ✅ Text extracted using pdfplumber (2369 chars)
[17:54:02] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:05] ℹ️  AI extracted raw sex value: ''
[17:54:05] ℹ️  AI extracted service line: 'PT'
[17:54:05] ℹ️  AI extracted payer source: ''
[17:54:05] ℹ️  AI extracted diagnoses:
[17:54:05] ℹ️    - Diagnosis 1: 'I69.354'
[17:54:05] ℹ️    - Diagnosis 2: 'E78.00'
[17:54:05] ℹ️    - Diagnosis 3: 'L20.9'
[17:54:05] ℹ️    - Diagnosis 4: 'None'
[17:54:05] ℹ️    - Diagnosis 5: 'None'
[17:54:05] ℹ️    - Diagnosis 6: 'None'
[17:54:05] ℹ️  Final extracted MRN: 'MA230120082705'
[17:54:05] ℹ️  Final extracted Sex: ''
[17:54:05] ℹ️  Final extracted Service Line: 'PT'
[17:54:05] ℹ️  Final extracted Payer Source: ''
[17:54:05] ✅ Patient data extraction completed successfully
[17:54:05] ✅    ✅ Patient data extracted successfully
[17:54:05] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: 
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:54:05] ✅    ✅ Patient identified: Irene Copley
[17:54:05] ✅    ✅ Patient name validation passed
[17:54:05] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:05] [DOC: 9203400] ℹ️  DOB normalized: 08/04/1927
[17:54:05] [DOC: 9203400] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[17:54:05] [DOC: 9203400] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[17:54:05] [DOC: 9203400] ✅ Patient date processing completed successfully
[17:54:05] ✅    ✅ Date processing completed
[17:54:05] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Copley
     └─ dob: 08/04/1927
     └─ patientSex: 
     └─ medicalRecordNo: MA230120082705
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'I69.354', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'L20.9'}]
[17:54:05] 🔄 
🔄 Step 4: Extracting order data...
[17:54:08] ℹ️  Order extraction - MRN: 'MA230120082705'
[17:54:08] ℹ️  Order extraction - Sex: ''
[17:54:08] ℹ️  Order extraction - Service Line: 'PT'
[17:54:08] ℹ️  Order extraction - Payer Source: ''
[17:54:08] ✅ Order data extraction completed successfully
[17:54:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:08] ℹ️  Using MRN from patient data: 'MA230120082705' over 'MA230120082705'
[17:54:08] ⚠️  Could not determine sex using any available method
[17:54:08] ℹ️  Service line consistent in both sources: 'PT'
[17:54:08] ✅ Patient name cross-validation successful
[17:54:08] ✅    ✅ Data merged successfully
[17:54:09] ✅    ✅ Order data extracted and validated
[17:54:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:54:09] [DOC: 9203400] ✅ Patient found in local cache: Irene Copley, ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[17:54:09] ✅    ✅ Existing patient found with ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[17:54:09] 🔄 
🔄 Step 6: Pushing order to API...
[17:54:09] [DOC: 9203400] ℹ️  Pushing order via API for patient ID: 3e329eec-69f4-4ea6-ac46-12adcb9c44f7
[17:54:10] [DOC: 9203400] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13530"}
[17:54:10] ❌    ❌ Failed to push order
[17:54:10] 🔄 
🔄 Step 7: Writing to CSV...
[17:54:10] [DOC: 9203400] ℹ️  Calculated age: 97 from DOB: 08/04/1927
[17:54:10] [DOC: 9203400] ℹ️  Service Line extracted: 'PT'
[17:54:10] [DOC: 9203400] ℹ️  Payer Source extracted: ''
[17:54:10] [DOC: 9203400] ℹ️  Diagnosis codes being written:
[17:54:10] [DOC: 9203400] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.354'
[17:54:10] [DOC: 9203400] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.00'
[17:54:10] [DOC: 9203400] ℹ️    - Latest_Episode_Thirddiagnosis: 'L20.9'
[17:54:10] [DOC: 9203400] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:54:10] [DOC: 9203400] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:54:10] [DOC: 9203400] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:54:10] [DOC: 9203400] ✅ Patient data written to CSV: Irene Copley | Sex:  | Age: 97 | Service: PT | Payer:  | MRN: MA230120082705
[17:54:10] ✅    ✅ Document 9203400 processed and saved successfully
[17:54:10] 🔄 
🔄 Step 8: Saving API details...
[17:54:10] [DOC: 9203400] ℹ️  API push details saved for document 9203400
[17:54:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203378                         ║
================================================================================
[17:54:10] ℹ️  Agency: Nizhoni Health-Fall River
[17:54:10] ℹ️  Date: 03/26/2025
[17:54:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:17] [DOC: 9203378] ✅ Text extracted using pdfplumber (5782 chars)
[17:54:17] ✅    ✅ Text extracted using pdfplumber (5782 chars)
[17:54:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:20] ℹ️  AI extracted raw sex value: 'F'
[17:54:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:54:20] ℹ️  AI extracted payer source: 'Medicaid/MA'
[17:54:20] ℹ️  AI extracted diagnoses:
[17:54:20] ℹ️    - Diagnosis 1: 'F33.3'
[17:54:20] ℹ️    - Diagnosis 2: 'F41.1'
[17:54:20] ℹ️    - Diagnosis 3: 'K51.90'
[17:54:20] ℹ️    - Diagnosis 4: 'M54.50'
[17:54:20] ℹ️    - Diagnosis 5: 'N18.30'
[17:54:20] ℹ️    - Diagnosis 6: 'F01.518'
[17:54:20] ℹ️  Final extracted MRN: '24037'
[17:54:20] ℹ️  Final extracted Sex: 'FEMALE'
[17:54:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:54:20] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[17:54:20] ✅ Patient data extraction completed successfully
[17:54:20] ✅    ✅ Patient data extracted successfully
[17:54:20] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Gibson
     └─ dob: 07/27/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 24037
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2018', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'F33.3', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'K51.90', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'F01.518'}]
[17:54:20] ✅    ✅ Patient identified: Patricia Gibson
[17:54:20] ✅    ✅ Patient name validation passed
[17:54:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:20] [DOC: 9203378] ℹ️  DOB normalized: 07/27/1952
[17:54:20] [DOC: 9203378] ℹ️  Episode startOfCare normalized: 11/13/2018
[17:54:20] [DOC: 9203378] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[17:54:20] [DOC: 9203378] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[17:54:20] [DOC: 9203378] ✅ Patient date processing completed successfully
[17:54:20] ✅    ✅ Date processing completed
[17:54:20] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Gibson
     └─ dob: 07/27/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 24037
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2018', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'F33.3', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'K51.90', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'F01.518'}]
[17:54:20] 🔄 
🔄 Step 4: Extracting order data...
[17:54:22] ℹ️  Order extraction - MRN: '24037'
[17:54:22] ℹ️  Order extraction - Sex: 'FEMALE'
[17:54:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:54:22] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[17:54:22] ✅ Order data extraction completed successfully
[17:54:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:22] ℹ️  Using MRN from patient data: '24037' over '24037'
[17:54:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:54:22] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[17:54:22] ✅ Patient name cross-validation successful
[17:54:22] ✅    ✅ Data merged successfully
[17:54:23] ✅    ✅ Order data extracted and validated
[17:54:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:54:23] [DOC: 9203378] ✅ Patient found in local cache: Patricia Gibson, ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[17:54:23] ✅    ✅ Existing patient found with ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[17:54:23] 🔄 
🔄 Step 6: Pushing order to API...
[17:54:23] [DOC: 9203378] ℹ️  Pushing order via API for patient ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[17:54:25] [DOC: 9203378] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:54:25] ❌    ❌ Failed to push order
[17:54:25] 🔄 
🔄 Step 7: Writing to CSV...
[17:54:25] [DOC: 9203378] ℹ️  Calculated age: 72 from DOB: 07/27/1952
[17:54:25] [DOC: 9203378] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:54:25] [DOC: 9203378] ℹ️  Payer Source extracted: 'Medicaid/MA'
[17:54:25] [DOC: 9203378] ℹ️  Diagnosis codes being written:
[17:54:25] [DOC: 9203378] ℹ️    - Latest_Episode_Firstdiagnosis: 'F33.3'
[17:54:25] [DOC: 9203378] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[17:54:25] [DOC: 9203378] ℹ️    - Latest_Episode_Thirddiagnosis: 'K51.90'
[17:54:25] [DOC: 9203378] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.50'
[17:54:25] [DOC: 9203378] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[17:54:25] [DOC: 9203378] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F01.518'
[17:54:25] [DOC: 9203378] ✅ Patient data written to CSV: Patricia Gibson | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 24037
[17:54:25] ✅    ✅ Document 9203378 processed and saved successfully
[17:54:25] 🔄 
🔄 Step 8: Saving API details...
[17:54:25] [DOC: 9203378] ℹ️  API push details saved for document 9203378
[17:54:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9201676                         ║
================================================================================
[17:54:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:54:25] ℹ️  Date: 03/25/2025
[17:54:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:26] [DOC: 9201676] ✅ Text extracted using pdfplumber (1480 chars)
[17:54:26] ✅    ✅ Text extracted using pdfplumber (1480 chars)
[17:54:26] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:29] ℹ️  AI extracted raw sex value: ''
[17:54:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:54:29] ℹ️  AI extracted payer source: ''
[17:54:29] ℹ️  AI extracted diagnoses:
[17:54:29] ℹ️    - Diagnosis 1: 'I10'
[17:54:29] ℹ️    - Diagnosis 2: 'G89.29'
[17:54:29] ℹ️    - Diagnosis 3: 'M19.90'
[17:54:29] ℹ️    - Diagnosis 4: 'None'
[17:54:29] ℹ️    - Diagnosis 5: 'None'
[17:54:29] ℹ️    - Diagnosis 6: 'None'
[17:54:29] ℹ️  Final extracted MRN: 'MA240624105104'
[17:54:29] ℹ️  Final extracted Sex: ''
[17:54:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:54:29] ℹ️  Final extracted Payer Source: ''
[17:54:29] ✅ Patient data extraction completed successfully
[17:54:29] ✅    ✅ Patient data extracted successfully
[17:54:29] 📊 Patient Response
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: JUNE RODRIGUES NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:54:29] ✅    ✅ Patient identified: Marsha Tilley
[17:54:29] ✅    ✅ Patient name validation passed
[17:54:29] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:29] [DOC: 9201676] ℹ️  DOB normalized: 10/08/1951
[17:54:29] [DOC: 9201676] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[17:54:29] [DOC: 9201676] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[17:54:29] [DOC: 9201676] ✅ Patient date processing completed successfully
[17:54:29] ✅    ✅ Date processing completed
[17:54:29] 📊 Processed Patient Data
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: 
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: JUNE RODRIGUES NP
     └─ npi: 1821065913
     └─ physicianNPI: 1821065913
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'M19.90'}]
[17:54:29] 🔄 
🔄 Step 4: Extracting order data...
[17:54:32] ℹ️  Order extraction - MRN: 'MA240624105104'
[17:54:32] ℹ️  Order extraction - Sex: ''
[17:54:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:54:32] ℹ️  Order extraction - Payer Source: ''
[17:54:32] ✅ Order data extraction completed successfully
[17:54:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:32] ℹ️  Using MRN from patient data: 'MA240624105104' over 'MA240624105104'
[17:54:32] ⚠️  Could not determine sex using any available method
[17:54:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:54:32] ✅ Patient name cross-validation successful
[17:54:32] ✅    ✅ Data merged successfully
[17:54:33] ✅    ✅ Order data extracted and validated
[17:54:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:54:33] [DOC: 9201676] ✅ Patient found in local cache: Marsha Tilley, ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[17:54:33] ✅    ✅ Existing patient found with ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[17:54:33] 🔄 
🔄 Step 6: Pushing order to API...
[17:54:33] [DOC: 9201676] ℹ️  Pushing order via API for patient ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[17:54:34] [DOC: 9201676] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14356"}
[17:54:34] ❌    ❌ Failed to push order
[17:54:34] 🔄 
🔄 Step 7: Writing to CSV...
[17:54:34] [DOC: 9201676] ℹ️  Calculated age: 73 from DOB: 10/08/1951
[17:54:34] [DOC: 9201676] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:54:34] [DOC: 9201676] ℹ️  Payer Source extracted: ''
[17:54:34] [DOC: 9201676] ℹ️  Diagnosis codes being written:
[17:54:34] [DOC: 9201676] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[17:54:34] [DOC: 9201676] ℹ️    - Latest_Episode_Seconddiagnosis: 'G89.29'
[17:54:34] [DOC: 9201676] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.90'
[17:54:34] [DOC: 9201676] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:54:34] [DOC: 9201676] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:54:34] [DOC: 9201676] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:54:34] [DOC: 9201676] ✅ Patient data written to CSV: Marsha Tilley | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA240624105104
[17:54:34] ✅    ✅ Document 9201676 processed and saved successfully
[17:54:34] 🔄 
🔄 Step 8: Saving API details...
[17:54:34] [DOC: 9201676] ℹ️  API push details saved for document 9201676
[17:54:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9203303                         ║
================================================================================
[17:54:34] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[17:54:34] ℹ️  Date: 03/25/2025
[17:54:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:37] [DOC: 9203303] ✅ Text extracted using pdfplumber (25199 chars)
[17:54:37] ✅    ✅ Text extracted using pdfplumber (25199 chars)
[17:54:37] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:41] ℹ️  AI extracted raw sex value: 'M'
[17:54:41] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:41] ℹ️  AI extracted payer source: 'Medicare'
[17:54:41] ℹ️  AI extracted diagnoses:
[17:54:41] ℹ️    - Diagnosis 1: 'B35.6'
[17:54:41] ℹ️    - Diagnosis 2: 'I12.9'
[17:54:41] ℹ️    - Diagnosis 3: 'E11.22'
[17:54:41] ℹ️    - Diagnosis 4: 'N18.31'
[17:54:41] ℹ️    - Diagnosis 5: 'E78.49'
[17:54:41] ℹ️    - Diagnosis 6: 'N40.1'
[17:54:41] ℹ️  Final extracted MRN: '28700209267201'
[17:54:41] ℹ️  Final extracted Sex: 'MALE'
[17:54:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:41] ℹ️  Final extracted Payer Source: 'Medicare'
[17:54:41] ✅ Patient data extraction completed successfully
[17:54:41] ✅    ✅ Patient data extracted successfully
[17:54:41] 📊 Patient Response
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 217 DEANE ST APT 304
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02746-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'E78.49', 'sixthDiagnosis': 'N40.1'}]
[17:54:41] ✅    ✅ Patient identified: ROGER VARIEUR
[17:54:41] ✅    ✅ Patient name validation passed
[17:54:41] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:41] [DOC: 9203303] ℹ️  DOB normalized: 05/12/1938
[17:54:41] [DOC: 9203303] ℹ️  Episode startOfCare normalized: 03/15/2025
[17:54:41] [DOC: 9203303] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[17:54:41] [DOC: 9203303] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[17:54:41] [DOC: 9203303] ✅ Patient date processing completed successfully
[17:54:41] ✅    ✅ Date processing completed
[17:54:41] 📊 Processed Patient Data
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 217 DEANE ST APT 304
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02746-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'E78.49', 'sixthDiagnosis': 'N40.1'}]
[17:54:41] 🔄 
🔄 Step 4: Extracting order data...
[17:54:44] ℹ️  Order extraction - MRN: '28700209267201'
[17:54:44] ℹ️  Order extraction - Sex: 'MALE'
[17:54:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:54:44] ✅ Order data extraction completed successfully
[17:54:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:44] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[17:54:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:54:44] ✅ Patient name cross-validation successful
[17:54:44] ✅    ✅ Data merged successfully
[17:54:45] ✅    ✅ Order data extracted and validated
[17:54:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:54:52] [DOC: 9203303] ℹ️  Patient not found in cache or API: ROGER VARIEUR
[17:54:52] [DOC: 9203303] ℹ️  Patient not found, creating new patient via API...
[17:54:52] [DOC: 9203303] ℹ️  Creating patient via API: ROGER VARIEUR
[17:54:53] [DOC: 9203303] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:54:53] ❌    ❌ Failed to create patient
[17:54:53] [DOC: 9203303] ℹ️  API push details saved for document 9203303
================================================================================
║                        Processing Document ID: 9201180                         ║
================================================================================
[17:54:53] ℹ️  Agency: Alliance Home Care VNA
[17:54:53] ℹ️  Date: 03/25/2025
[17:54:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:55] [DOC: 9201180] ✅ Text extracted using pdfplumber (2677 chars)
[17:54:55] ✅    ✅ Text extracted using pdfplumber (2677 chars)
[17:54:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:58] ℹ️  AI extracted raw sex value: ''
[17:54:58] ℹ️  AI extracted service line: 'PT'
[17:54:58] ℹ️  AI extracted payer source: ''
[17:54:58] ℹ️  AI extracted diagnoses:
[17:54:58] ℹ️    - Diagnosis 1: ''
[17:54:58] ℹ️    - Diagnosis 2: ''
[17:54:58] ℹ️    - Diagnosis 3: ''
[17:54:58] ℹ️    - Diagnosis 4: ''
[17:54:58] ℹ️    - Diagnosis 5: ''
[17:54:58] ℹ️    - Diagnosis 6: ''
[17:54:58] ℹ️  Final extracted MRN: ''
[17:54:58] ℹ️  Final extracted Sex: ''
[17:54:58] ℹ️  Final extracted Service Line: 'PT'
[17:54:58] ℹ️  Final extracted Payer Source: ''
[17:54:58] ✅ Patient data extraction completed successfully
[17:54:58] ✅    ✅ Patient data extracted successfully
[17:54:58] 📊 Patient Response
     └─ patientFName: Colm
     └─ patientLName: Mccarthy
     └─ dob: 09/06/1969
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 1376784660
     └─ physicianNPI: 
     └─ nameOfAgency: Alliance Home Care VNA Inc
     └─ address: 277 Pleasant St
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02721
     └─ email: arryc@alliancevna.com
     └─ phoneNumber: (781) 281-1626
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:54:58] ✅    ✅ Patient identified: Colm Mccarthy
[17:54:58] ✅    ✅ Patient name validation passed
[17:54:58] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:58] [DOC: 9201180] ℹ️  DOB normalized: 09/06/1969
[17:54:58] [DOC: 9201180] ℹ️  Episode startOfCare normalized: 03/09/2025
[17:54:58] [DOC: 9201180] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[17:54:58] [DOC: 9201180] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[17:54:58] [DOC: 9201180] ✅ Patient date processing completed successfully
[17:54:58] ✅    ✅ Date processing completed
[17:54:58] 📊 Processed Patient Data
     └─ patientFName: Colm
     └─ patientLName: Mccarthy
     └─ dob: 09/06/1969
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 1376784660
     └─ physicianNPI: 
     └─ nameOfAgency: Alliance Home Care VNA Inc
     └─ address: 277 Pleasant St
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02721
     └─ email: arryc@alliancevna.com
     └─ phoneNumber: (781) 281-1626
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:54:58] 🔄 
🔄 Step 4: Extracting order data...
[17:55:01] ℹ️  Order extraction - MRN: ''
[17:55:01] ℹ️  Order extraction - Sex: ''
[17:55:01] ℹ️  Order extraction - Service Line: 'PT'
[17:55:01] ℹ️  Order extraction - Payer Source: ''
[17:55:01] ✅ Order data extraction completed successfully
[17:55:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:01] ⚠️  No MRN found in either patient or order data
[17:55:01] ⚠️  Could not determine sex using any available method
[17:55:01] ℹ️  Service line consistent in both sources: 'PT'
[17:55:01] ✅ Patient name cross-validation successful
[17:55:01] ✅    ✅ Data merged successfully
[17:55:02] ✅    ✅ Order data extracted and validated
[17:55:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:22] [DOC: 9201180] ℹ️  Patient not found in cache or API: Colm Mccarthy
[17:55:22] [DOC: 9201180] ℹ️  Patient not found, creating new patient via API...
[17:55:22] [DOC: 9201180] ℹ️  Creating patient via API: Colm Mccarthy
[17:55:23] [DOC: 9201180] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:55:23] ❌    ❌ Failed to create patient
[17:55:23] [DOC: 9201180] ℹ️  API push details saved for document 9201180
================================================================================
║                        Processing Document ID: 9201104                         ║
================================================================================
[17:55:23] ℹ️  Agency: Fairhaven HH&H
[17:55:23] ℹ️  Date: 03/25/2025
[17:55:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:24] [DOC: 9201104] ❌ Critical failure in get_pdf_text: Invalid response format
[17:55:24] ❌ Failed to extract text for Doc ID 9201104
[17:55:24] [DOC: 9201104] ℹ️  API push details saved for document 9201104
================================================================================
║                        Processing Document ID: 9201090                         ║
================================================================================
[17:55:24] ℹ️  Agency: Fairhaven HH&H
[17:55:24] ℹ️  Date: 03/25/2025
[17:55:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:26] [DOC: 9201090] ❌ Critical failure in get_pdf_text: Invalid response format
[17:55:26] ❌ Failed to extract text for Doc ID 9201090
[17:55:26] [DOC: 9201090] ℹ️  API push details saved for document 9201090
================================================================================
║                        Processing Document ID: 9200776                         ║
================================================================================
[17:55:26] ℹ️  Agency: Dartmouth HH
[17:55:26] ℹ️  Date: 03/25/2025
[17:55:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:28] [DOC: 9200776] ✅ Text extracted using pdfplumber (1667 chars)
[17:55:28] ✅    ✅ Text extracted using pdfplumber (1667 chars)
[17:55:28] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:31] ℹ️  AI extracted raw sex value: 'F'
[17:55:31] ℹ️  AI extracted service line: 'Skilled Nursing, LPN, RN'
[17:55:31] ℹ️  AI extracted payer source: 'Medicare'
[17:55:31] ℹ️  AI extracted diagnoses:
[17:55:31] ℹ️    - Diagnosis 1: ''
[17:55:31] ℹ️    - Diagnosis 2: ''
[17:55:31] ℹ️    - Diagnosis 3: ''
[17:55:31] ℹ️    - Diagnosis 4: ''
[17:55:31] ℹ️    - Diagnosis 5: ''
[17:55:31] ℹ️    - Diagnosis 6: ''
[17:55:31] ℹ️  Final extracted MRN: '5094015'
[17:55:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:55:31] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN, RN'
[17:55:31] ℹ️  Final extracted Payer Source: 'Medicare'
[17:55:31] ✅ Patient data extraction completed successfully
[17:55:31] ✅    ✅ Patient data extracted successfully
[17:55:31] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, LPN, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:31] ✅    ✅ Patient identified: Laura Gregoire
[17:55:31] ✅    ✅ Patient name validation passed
[17:55:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:31] [DOC: 9200776] ℹ️  DOB normalized: 12/06/1944
[17:55:31] [DOC: 9200776] ℹ️  Episode startOfCare normalized: 08/26/2024
[17:55:31] [DOC: 9200776] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[17:55:31] [DOC: 9200776] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[17:55:31] [DOC: 9200776] ✅ Patient date processing completed successfully
[17:55:31] ✅    ✅ Date processing completed
[17:55:31] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, LPN, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:31] 🔄 
🔄 Step 4: Extracting order data...
[17:55:34] ℹ️  Order extraction - MRN: '5094015'
[17:55:34] ℹ️  Order extraction - Sex: 'FEMALE'
[17:55:34] ℹ️  Order extraction - Service Line: 'RN, LPN'
[17:55:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:55:34] ✅ Order data extraction completed successfully
[17:55:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:34] ℹ️  Using MRN from patient data: '5094015' over '5094015'
[17:55:34] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN, RN' + Order='RN, LPN' = 'LPN, RN, Skilled Nursing'
[17:55:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:55:34] ✅ Patient name cross-validation successful
[17:55:34] ✅    ✅ Data merged successfully
[17:55:35] ✅    ✅ Order data extracted and validated
[17:55:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:35] [DOC: 9200776] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[17:55:35] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[17:55:35] 🔄 
🔄 Step 6: Pushing order to API...
[17:55:35] [DOC: 9200776] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[17:55:37] [DOC: 9200776] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:55:37] ❌    ❌ Failed to push order
[17:55:37] 🔄 
🔄 Step 7: Writing to CSV...
[17:55:37] [DOC: 9200776] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[17:55:37] [DOC: 9200776] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing'
[17:55:37] [DOC: 9200776] ℹ️  Payer Source extracted: 'Medicare'
[17:55:37] [DOC: 9200776] ℹ️  Diagnosis codes being written:
[17:55:37] [DOC: 9200776] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:55:37] [DOC: 9200776] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:55:37] [DOC: 9200776] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:55:37] [DOC: 9200776] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:55:37] [DOC: 9200776] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:55:37] [DOC: 9200776] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:55:37] [DOC: 9200776] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: LPN, RN, Skilled Nursing | Payer: Medicare | MRN: 5094015
[17:55:37] ✅    ✅ Document 9200776 processed and saved successfully
[17:55:37] 🔄 
🔄 Step 8: Saving API details...
[17:55:37] [DOC: 9200776] ℹ️  API push details saved for document 9200776
[17:55:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200769                         ║
================================================================================
[17:55:37] ℹ️  Agency: Dartmouth HH
[17:55:37] ℹ️  Date: 03/25/2025
[17:55:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:39] [DOC: 9200769] ✅ Text extracted using pdfplumber (10860 chars)
[17:55:39] ✅    ✅ Text extracted using pdfplumber (10848 chars)
[17:55:39] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:42] ℹ️  AI extracted raw sex value: 'F'
[17:55:42] ℹ️  AI extracted service line: 'PT, HCA'
[17:55:42] ℹ️  AI extracted payer source: 'None'
[17:55:42] ℹ️  AI extracted diagnoses:
[17:55:42] ℹ️    - Diagnosis 1: 'J44.89'
[17:55:42] ℹ️    - Diagnosis 2: 'J45.50'
[17:55:42] ℹ️    - Diagnosis 3: 'M54.50'
[17:55:42] ℹ️    - Diagnosis 4: 'E11.9'
[17:55:42] ℹ️    - Diagnosis 5: 'F41.9'
[17:55:42] ℹ️    - Diagnosis 6: 'M19.90'
[17:55:42] ℹ️  Final extracted MRN: '227027'
[17:55:42] ℹ️  Final extracted Sex: 'FEMALE'
[17:55:42] ℹ️  Final extracted Service Line: 'PT, HCA'
[17:55:42] ℹ️  Final extracted Payer Source: ''
[17:55:42] ✅ Patient data extraction completed successfully
[17:55:42] ✅    ✅ Patient data extracted successfully
[17:55:42] 📊 Patient Response
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, HCA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/06/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'J44.89', 'secondDiagnosis': 'J45.50', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'M19.90'}]
[17:55:42] ✅    ✅ Patient identified: Lisa Pavao
[17:55:42] ✅    ✅ Patient name validation passed
[17:55:42] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:42] [DOC: 9200769] ℹ️  DOB normalized: 06/09/1966
[17:55:42] [DOC: 9200769] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[17:55:42] [DOC: 9200769] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[17:55:42] [DOC: 9200769] ✅ Patient date processing completed successfully
[17:55:42] ✅    ✅ Date processing completed
[17:55:42] 📊 Processed Patient Data
     └─ patientFName: Lisa
     └─ patientLName: Pavao
     └─ dob: 06/09/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, HCA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'J44.89', 'secondDiagnosis': 'J45.50', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'M19.90'}]
[17:55:42] 🔄 
🔄 Step 4: Extracting order data...
[17:55:45] ℹ️  Order extraction - MRN: '4651015'
[17:55:45] ℹ️  Order extraction - Sex: 'FEMALE'
[17:55:45] ℹ️  Order extraction - Service Line: 'PT, HCA'
[17:55:45] ℹ️  Order extraction - Payer Source: ''
[17:55:45] ✅ Order data extraction completed successfully
[17:55:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:45] ℹ️  Using longer MRN from order data: '4651015' over '227027'
[17:55:45] ℹ️  Service line consistent in both sources: 'PT, HCA'
[17:55:45] ✅ Patient name cross-validation successful
[17:55:45] ✅    ✅ Data merged successfully
[17:55:46] ✅    ✅ Order data extracted and validated
[17:55:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:46] [DOC: 9200769] ✅ Patient found in local cache: Lisa Pavao, ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[17:55:46] ✅    ✅ Existing patient found with ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[17:55:46] 🔄 
🔄 Step 6: Pushing order to API...
[17:55:46] [DOC: 9200769] ℹ️  Pushing order via API for patient ID: 0ac49aec-c7d5-4816-babd-f57378df66db
[17:55:47] [DOC: 9200769] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:55:47] ❌    ❌ Failed to push order
[17:55:47] 🔄 
🔄 Step 7: Writing to CSV...
[17:55:47] [DOC: 9200769] ℹ️  Calculated age: 58 from DOB: 06/09/1966
[17:55:47] [DOC: 9200769] ℹ️  Service Line extracted: 'PT, HCA'
[17:55:47] [DOC: 9200769] ℹ️  Payer Source extracted: ''
[17:55:47] [DOC: 9200769] ℹ️  Diagnosis codes being written:
[17:55:47] [DOC: 9200769] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.89'
[17:55:47] [DOC: 9200769] ℹ️    - Latest_Episode_Seconddiagnosis: 'J45.50'
[17:55:47] [DOC: 9200769] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.50'
[17:55:47] [DOC: 9200769] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[17:55:47] [DOC: 9200769] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[17:55:47] [DOC: 9200769] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M19.90'
[17:55:47] [DOC: 9200769] ✅ Patient data written to CSV: Lisa Pavao | Sex: FEMALE | Age: 58 | Service: PT, HCA | Payer:  | MRN: 4651015
[17:55:47] ✅    ✅ Document 9200769 processed and saved successfully
[17:55:47] 🔄 
🔄 Step 8: Saving API details...
[17:55:47] [DOC: 9200769] ℹ️  API push details saved for document 9200769
[17:55:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200761                         ║
================================================================================
[17:55:47] ℹ️  Agency: Dartmouth HH
[17:55:47] ℹ️  Date: 03/25/2025
[17:55:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:49] [DOC: 9200761] ✅ Text extracted using pdfplumber (2998 chars)
[17:55:49] ✅    ✅ Text extracted using pdfplumber (2998 chars)
[17:55:49] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:52] ℹ️  AI extracted raw sex value: 'M'
[17:55:52] ℹ️  AI extracted service line: 'PT'
[17:55:52] ℹ️  AI extracted payer source: 'Medicare'
[17:55:52] ℹ️  AI extracted diagnoses:
[17:55:52] ℹ️    - Diagnosis 1: ''
[17:55:52] ℹ️    - Diagnosis 2: ''
[17:55:52] ℹ️    - Diagnosis 3: ''
[17:55:52] ℹ️    - Diagnosis 4: ''
[17:55:52] ℹ️    - Diagnosis 5: ''
[17:55:52] ℹ️    - Diagnosis 6: ''
[17:55:52] ℹ️  Final extracted MRN: '2731011'
[17:55:52] ℹ️  Final extracted Sex: 'MALE'
[17:55:52] ℹ️  Final extracted Service Line: 'PT'
[17:55:52] ℹ️  Final extracted Payer Source: 'Medicare'
[17:55:52] ✅ Patient data extraction completed successfully
[17:55:52] ✅    ✅ Patient data extracted successfully
[17:55:52] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:52] ✅    ✅ Patient identified: Paul Penha
[17:55:52] ✅    ✅ Patient name validation passed
[17:55:52] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:52] [DOC: 9200761] ℹ️  DOB normalized: 07/08/1934
[17:55:52] [DOC: 9200761] ℹ️  Episode startOfCare normalized: 02/02/2025
[17:55:52] [DOC: 9200761] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[17:55:52] [DOC: 9200761] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[17:55:52] [DOC: 9200761] ✅ Patient date processing completed successfully
[17:55:52] ✅    ✅ Date processing completed
[17:55:52] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/02/2025', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:52] 🔄 
🔄 Step 4: Extracting order data...
[17:55:54] ℹ️  Order extraction - MRN: ''
[17:55:54] ℹ️  Order extraction - Sex: 'MALE'
[17:55:54] ℹ️  Order extraction - Service Line: 'PT'
[17:55:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:55:54] ✅ Order data extraction completed successfully
[17:55:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:54] ℹ️  Using MRN from patient data: '2731011'
[17:55:54] ℹ️  Service line consistent in both sources: 'PT'
[17:55:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:55:54] ✅ Patient name cross-validation successful
[17:55:54] ✅    ✅ Data merged successfully
[17:55:56] ✅    ✅ Order data extracted and validated
[17:55:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:56] [DOC: 9200761] ✅ Patient found in local cache: Paul Penha, ID: acd1fced-75ff-43a8-8304-4681296c9d26
[17:55:56] ✅    ✅ Existing patient found with ID: acd1fced-75ff-43a8-8304-4681296c9d26
[17:55:56] 🔄 
🔄 Step 6: Pushing order to API...
[17:55:56] [DOC: 9200761] ℹ️  Pushing order via API for patient ID: acd1fced-75ff-43a8-8304-4681296c9d26
[17:55:57] [DOC: 9200761] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13011"}
[17:55:57] ❌    ❌ Failed to push order
[17:55:57] 🔄 
🔄 Step 7: Writing to CSV...
[17:55:57] [DOC: 9200761] ℹ️  Calculated age: 90 from DOB: 07/08/1934
[17:55:57] [DOC: 9200761] ℹ️  Service Line extracted: 'PT'
[17:55:57] [DOC: 9200761] ℹ️  Payer Source extracted: 'Medicare'
[17:55:57] [DOC: 9200761] ℹ️  Diagnosis codes being written:
[17:55:57] [DOC: 9200761] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:55:57] [DOC: 9200761] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:55:57] [DOC: 9200761] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:55:57] [DOC: 9200761] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:55:57] [DOC: 9200761] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:55:57] [DOC: 9200761] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:55:57] [DOC: 9200761] ✅ Patient data written to CSV: Paul Penha | Sex: MALE | Age: 90 | Service: PT | Payer: Medicare | MRN: 2731011
[17:55:57] ✅    ✅ Document 9200761 processed and saved successfully
[17:55:57] 🔄 
🔄 Step 8: Saving API details...
[17:55:57] [DOC: 9200761] ℹ️  API push details saved for document 9200761
[17:55:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200759                         ║
================================================================================
[17:55:57] ℹ️  Agency: Dartmouth HH
[17:55:57] ℹ️  Date: 03/25/2025
[17:55:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:59] [DOC: 9200759] ✅ Text extracted using pdfplumber (1247 chars)
[17:55:59] ✅    ✅ Text extracted using pdfplumber (1247 chars)
[17:55:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:01] ℹ️  AI extracted raw sex value: 'M'
[17:56:01] ℹ️  AI extracted service line: 'RN'
[17:56:01] ℹ️  AI extracted payer source: 'Medicare'
[17:56:01] ℹ️  AI extracted diagnoses:
[17:56:01] ℹ️    - Diagnosis 1: ''
[17:56:01] ℹ️    - Diagnosis 2: ''
[17:56:01] ℹ️    - Diagnosis 3: ''
[17:56:01] ℹ️    - Diagnosis 4: ''
[17:56:01] ℹ️    - Diagnosis 5: ''
[17:56:01] ℹ️    - Diagnosis 6: ''
[17:56:01] ℹ️  Final extracted MRN: '956008'
[17:56:01] ℹ️  Final extracted Sex: 'MALE'
[17:56:01] ℹ️  Final extracted Service Line: 'RN'
[17:56:01] ℹ️  Final extracted Payer Source: 'Medicare'
[17:56:01] ✅ Patient data extraction completed successfully
[17:56:01] ✅    ✅ Patient data extracted successfully
[17:56:01] 📊 Patient Response
     └─ patientFName: Gerald
     └─ patientLName: Ferreira
     └─ dob: 07/12/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 956008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2025', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:01] ✅    ✅ Patient identified: Gerald Ferreira
[17:56:01] ✅    ✅ Patient name validation passed
[17:56:01] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:01] [DOC: 9200759] ℹ️  DOB normalized: 07/12/1942
[17:56:01] [DOC: 9200759] ℹ️  Episode startOfCare normalized: 02/24/2025
[17:56:01] [DOC: 9200759] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[17:56:01] [DOC: 9200759] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[17:56:01] [DOC: 9200759] ✅ Patient date processing completed successfully
[17:56:01] ✅    ✅ Date processing completed
[17:56:01] 📊 Processed Patient Data
     └─ patientFName: Gerald
     └─ patientLName: Ferreira
     └─ dob: 07/12/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 956008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2025', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:01] 🔄 
🔄 Step 4: Extracting order data...
[17:56:04] ℹ️  Order extraction - MRN: ''
[17:56:04] ℹ️  Order extraction - Sex: 'MALE'
[17:56:04] ℹ️  Order extraction - Service Line: ''
[17:56:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:56:04] ✅ Order data extraction completed successfully
[17:56:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:04] ℹ️  Using MRN from patient data: '956008'
[17:56:04] ℹ️  Using service line from patient data: 'RN'
[17:56:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:56:04] ✅ Patient name cross-validation successful
[17:56:04] ✅    ✅ Data merged successfully
[17:56:05] ✅    ✅ Order data extracted and validated
[17:56:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:56:10] [DOC: 9200759] ✅ Patient exists in API: Gerald Ferreira, ID: 00478924-474c-4077-836a-7cb43c03a9bc
[17:56:10] ✅    ✅ Existing patient found with ID: 00478924-474c-4077-836a-7cb43c03a9bc
[17:56:10] 🔄 
🔄 Step 6: Pushing order to API...
[17:56:10] [DOC: 9200759] ℹ️  Pushing order via API for patient ID: 00478924-474c-4077-836a-7cb43c03a9bc
[17:56:11] [DOC: 9200759] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13982"}
[17:56:11] ❌    ❌ Failed to push order
[17:56:11] 🔄 
🔄 Step 7: Writing to CSV...
[17:56:11] [DOC: 9200759] ℹ️  Calculated age: 82 from DOB: 07/12/1942
[17:56:11] [DOC: 9200759] ℹ️  Service Line extracted: 'RN'
[17:56:11] [DOC: 9200759] ℹ️  Payer Source extracted: 'Medicare'
[17:56:11] [DOC: 9200759] ℹ️  Diagnosis codes being written:
[17:56:11] [DOC: 9200759] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:56:11] [DOC: 9200759] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:56:11] [DOC: 9200759] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:56:11] [DOC: 9200759] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:56:11] [DOC: 9200759] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:56:11] [DOC: 9200759] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:56:11] [DOC: 9200759] ✅ Patient data written to CSV: Gerald Ferreira | Sex: MALE | Age: 82 | Service: RN | Payer: Medicare | MRN: 956008
[17:56:11] ✅    ✅ Document 9200759 processed and saved successfully
[17:56:11] 🔄 
🔄 Step 8: Saving API details...
[17:56:11] [DOC: 9200759] ℹ️  API push details saved for document 9200759
[17:56:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200754                         ║
================================================================================
[17:56:11] ℹ️  Agency: Dartmouth HH
[17:56:11] ℹ️  Date: 03/25/2025
[17:56:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:13] [DOC: 9200754] ✅ Text extracted using pdfplumber (1203 chars)
[17:56:13] ✅    ✅ Text extracted using pdfplumber (1203 chars)
[17:56:13] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:15] ℹ️  AI extracted raw sex value: 'F'
[17:56:15] ℹ️  AI extracted service line: 'RN'
[17:56:15] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[17:56:15] ℹ️  AI extracted diagnoses:
[17:56:15] ℹ️    - Diagnosis 1: 'None'
[17:56:15] ℹ️    - Diagnosis 2: 'None'
[17:56:15] ℹ️    - Diagnosis 3: 'None'
[17:56:15] ℹ️    - Diagnosis 4: 'None'
[17:56:15] ℹ️    - Diagnosis 5: 'None'
[17:56:15] ℹ️    - Diagnosis 6: 'None'
[17:56:15] ℹ️  Final extracted MRN: '6843'
[17:56:15] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:15] ℹ️  Final extracted Service Line: 'RN'
[17:56:15] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[17:56:15] ✅ Patient data extraction completed successfully
[17:56:15] ✅    ✅ Patient data extracted successfully
[17:56:15] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': None, 'endOfEpisode': '04/17/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:56:15] ✅    ✅ Patient identified: Pearl Moura
[17:56:15] ✅    ✅ Patient name validation passed
[17:56:15] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:15] [DOC: 9200754] ℹ️  DOB normalized: 01/29/1930
[17:56:15] [DOC: 9200754] ℹ️  Episode startOfCare normalized: 01/04/2022
[17:56:15] [DOC: 9200754] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[17:56:15] [DOC: 9200754] ✅ Patient date processing completed successfully
[17:56:15] ✅    ✅ Date processing completed
[17:56:15] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'endOfEpisode': '04/17/2025'}]
[17:56:15] 🔄 
🔄 Step 4: Extracting order data...
[17:56:18] ℹ️  Order extraction - MRN: ''
[17:56:18] ℹ️  Order extraction - Sex: 'FEMALE'
[17:56:18] ℹ️  Order extraction - Service Line: ''
[17:56:18] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[17:56:18] ✅ Order data extraction completed successfully
[17:56:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:18] ℹ️  Using MRN from patient data: '6843'
[17:56:18] ℹ️  Using service line from patient data: 'RN'
[17:56:18] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[17:56:18] ✅ Patient name cross-validation successful
[17:56:18] ✅    ✅ Data merged successfully
[17:56:19] ✅    ✅ Order data extracted and validated
[17:56:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:56:19] [DOC: 9200754] ✅ Patient found in local cache: Pearl Moura, ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[17:56:19] ✅    ✅ Existing patient found with ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[17:56:19] 🔄 
🔄 Step 6: Pushing order to API...
[17:56:19] [DOC: 9200754] ℹ️  Pushing order via API for patient ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[17:56:20] [DOC: 9200754] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14163"}
[17:56:20] ❌    ❌ Failed to push order
[17:56:20] 🔄 
🔄 Step 7: Writing to CSV...
[17:56:20] [DOC: 9200754] ℹ️  Calculated age: 95 from DOB: 01/29/1930
[17:56:20] [DOC: 9200754] ℹ️  Service Line extracted: 'RN'
[17:56:20] [DOC: 9200754] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[17:56:20] [DOC: 9200754] ℹ️  Diagnosis codes being written:
[17:56:20] [DOC: 9200754] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:56:20] [DOC: 9200754] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:56:20] [DOC: 9200754] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:56:20] [DOC: 9200754] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:56:20] [DOC: 9200754] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:56:20] [DOC: 9200754] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:56:20] [DOC: 9200754] ✅ Patient data written to CSV: Pearl Moura | Sex: FEMALE | Age: 95 | Service: RN | Payer: Aetna- Mcare | MRN: 6843
[17:56:20] ✅    ✅ Document 9200754 processed and saved successfully
[17:56:20] 🔄 
🔄 Step 8: Saving API details...
[17:56:20] [DOC: 9200754] ℹ️  API push details saved for document 9200754
[17:56:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200752                         ║
================================================================================
[17:56:20] ℹ️  Agency: Dartmouth HH
[17:56:20] ℹ️  Date: 03/25/2025
[17:56:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:22] [DOC: 9200752] ✅ Text extracted using pdfplumber (1664 chars)
[17:56:22] ✅    ✅ Text extracted using pdfplumber (1664 chars)
[17:56:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:24] ℹ️  AI extracted raw sex value: 'F'
[17:56:24] ℹ️  AI extracted service line: 'RN'
[17:56:24] ℹ️  AI extracted payer source: 'Fallon Health'
[17:56:24] ℹ️  AI extracted diagnoses:
[17:56:24] ℹ️    - Diagnosis 1: ''
[17:56:24] ℹ️    - Diagnosis 2: ''
[17:56:24] ℹ️    - Diagnosis 3: ''
[17:56:24] ℹ️    - Diagnosis 4: ''
[17:56:24] ℹ️    - Diagnosis 5: ''
[17:56:24] ℹ️    - Diagnosis 6: ''
[17:56:24] ℹ️  Final extracted MRN: '4034011'
[17:56:24] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:24] ℹ️  Final extracted Service Line: 'RN'
[17:56:24] ℹ️  Final extracted Payer Source: 'Fallon Health'
[17:56:24] ✅ Patient data extraction completed successfully
[17:56:24] ✅    ✅ Patient data extracted successfully
[17:56:24] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 8 Flag Swamp Road
     └─ city: East Freetown
     └─ state: MA
     └─ zip: 02717
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:24] ✅    ✅ Patient identified: Joan E Swift
[17:56:24] ✅    ✅ Patient name validation passed
[17:56:24] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:24] [DOC: 9200752] ℹ️  DOB normalized: 05/05/1943
[17:56:24] [DOC: 9200752] ℹ️  Episode startOfCare normalized: 01/08/2025
[17:56:24] [DOC: 9200752] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[17:56:24] [DOC: 9200752] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[17:56:24] [DOC: 9200752] ✅ Patient date processing completed successfully
[17:56:24] ✅    ✅ Date processing completed
[17:56:24] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 8 Flag Swamp Road
     └─ city: East Freetown
     └─ state: MA
     └─ zip: 02717
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:24] 🔄 
🔄 Step 4: Extracting order data...
[17:56:27] ℹ️  Order extraction - MRN: ''
[17:56:27] ℹ️  Order extraction - Sex: 'FEMALE'
[17:56:27] ℹ️  Order extraction - Service Line: 'RN'
[17:56:27] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[17:56:27] ✅ Order data extraction completed successfully
[17:56:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:27] ℹ️  Using MRN from patient data: '4034011'
[17:56:27] ℹ️  Service line consistent in both sources: 'RN'
[17:56:27] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[17:56:27] ✅ Patient name cross-validation successful
[17:56:27] ✅    ✅ Data merged successfully
[17:56:28] ✅    ✅ Order data extracted and validated
[17:56:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:56:35] [DOC: 9200752] ℹ️  Patient not found in cache or API: Joan E Swift
[17:56:35] [DOC: 9200752] ℹ️  Patient not found, creating new patient via API...
[17:56:35] [DOC: 9200752] ℹ️  Creating patient via API: Joan E Swift
[17:56:36] [DOC: 9200752] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:56:36] ❌    ❌ Failed to create patient
[17:56:36] [DOC: 9200752] ℹ️  API push details saved for document 9200752
================================================================================
║                        Processing Document ID: 9200748                         ║
================================================================================
[17:56:36] ℹ️  Agency: Dartmouth HH
[17:56:36] ℹ️  Date: 03/25/2025
[17:56:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:38] [DOC: 9200748] ✅ Text extracted using pdfplumber (1195 chars)
[17:56:38] ✅    ✅ Text extracted using pdfplumber (1195 chars)
[17:56:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:41] ℹ️  AI extracted raw sex value: 'F'
[17:56:41] ℹ️  AI extracted service line: 'RN'
[17:56:41] ℹ️  AI extracted payer source: 'Medicare'
[17:56:41] ℹ️  AI extracted diagnoses:
[17:56:41] ℹ️    - Diagnosis 1: 'None'
[17:56:41] ℹ️    - Diagnosis 2: 'None'
[17:56:41] ℹ️    - Diagnosis 3: 'None'
[17:56:41] ℹ️    - Diagnosis 4: 'None'
[17:56:41] ℹ️    - Diagnosis 5: 'None'
[17:56:41] ℹ️    - Diagnosis 6: 'None'
[17:56:41] ℹ️  Final extracted MRN: '5939015'
[17:56:41] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:41] ℹ️  Final extracted Service Line: 'RN'
[17:56:41] ℹ️  Final extracted Payer Source: 'Medicare'
[17:56:41] ✅ Patient data extraction completed successfully
[17:56:41] ✅    ✅ Patient data extracted successfully
[17:56:41] 📊 Patient Response
     └─ patientFName: Darlene
     └─ patientLName: Tremblay
     └─ dob: 09/07/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5939015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:56:41] ✅    ✅ Patient identified: Darlene Tremblay
[17:56:41] ✅    ✅ Patient name validation passed
[17:56:41] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:41] [DOC: 9200748] ℹ️  DOB normalized: 09/07/1955
[17:56:41] [DOC: 9200748] ℹ️  Episode startOfCare normalized: 01/30/2025
[17:56:41] [DOC: 9200748] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[17:56:41] [DOC: 9200748] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[17:56:41] [DOC: 9200748] ✅ Patient date processing completed successfully
[17:56:41] ✅    ✅ Date processing completed
[17:56:41] 📊 Processed Patient Data
     └─ patientFName: Darlene
     └─ patientLName: Tremblay
     └─ dob: 09/07/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5939015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025'}]
[17:56:41] 🔄 
🔄 Step 4: Extracting order data...
[17:56:43] ℹ️  Order extraction - MRN: ''
[17:56:43] ℹ️  Order extraction - Sex: 'FEMALE'
[17:56:43] ℹ️  Order extraction - Service Line: ''
[17:56:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:56:43] ✅ Order data extraction completed successfully
[17:56:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:43] ℹ️  Using MRN from patient data: '5939015'
[17:56:43] ℹ️  Using service line from patient data: 'RN'
[17:56:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:56:43] ✅ Patient name cross-validation successful
[17:56:43] ✅    ✅ Data merged successfully
[17:56:44] ✅    ✅ Order data extracted and validated
[17:56:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:56:50] [DOC: 9200748] ✅ Patient exists in API: Darlene Tremblay, ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[17:56:50] ✅    ✅ Existing patient found with ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[17:56:50] 🔄 
🔄 Step 6: Pushing order to API...
[17:56:50] [DOC: 9200748] ℹ️  Pushing order via API for patient ID: d219e1ba-ea85-42c8-9109-723bc3783e22
[17:56:51] [DOC: 9200748] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14361"}
[17:56:51] ❌    ❌ Failed to push order
[17:56:51] 🔄 
🔄 Step 7: Writing to CSV...
[17:56:51] [DOC: 9200748] ℹ️  Calculated age: 69 from DOB: 09/07/1955
[17:56:51] [DOC: 9200748] ℹ️  Service Line extracted: 'RN'
[17:56:51] [DOC: 9200748] ℹ️  Payer Source extracted: 'Medicare'
[17:56:51] [DOC: 9200748] ℹ️  Diagnosis codes being written:
[17:56:51] [DOC: 9200748] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:56:51] [DOC: 9200748] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:56:51] [DOC: 9200748] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:56:51] [DOC: 9200748] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:56:51] [DOC: 9200748] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:56:51] [DOC: 9200748] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:56:51] [DOC: 9200748] ✅ Patient data written to CSV: Darlene Tremblay | Sex: FEMALE | Age: 69 | Service: RN | Payer: Medicare | MRN: 5939015
[17:56:51] ✅    ✅ Document 9200748 processed and saved successfully
[17:56:51] 🔄 
🔄 Step 8: Saving API details...
[17:56:51] [DOC: 9200748] ℹ️  API push details saved for document 9200748
[17:56:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200743                         ║
================================================================================
[17:56:51] ℹ️  Agency: Dartmouth HH
[17:56:51] ℹ️  Date: 03/25/2025
[17:56:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:54] [DOC: 9200743] ✅ Text extracted using pdfplumber (12029 chars)
[17:56:54] ✅    ✅ Text extracted using pdfplumber (12017 chars)
[17:56:54] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:57] ℹ️  AI extracted raw sex value: 'F'
[17:56:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:56:57] ℹ️  AI extracted payer source: ''
[17:56:57] ℹ️  AI extracted diagnoses:
[17:56:57] ℹ️    - Diagnosis 1: 'J44.9'
[17:56:57] ℹ️    - Diagnosis 2: 'I89.0'
[17:56:57] ℹ️    - Diagnosis 3: 'I10'
[17:56:57] ℹ️    - Diagnosis 4: 'R09.02'
[17:56:57] ℹ️    - Diagnosis 5: 'M15.9'
[17:56:57] ℹ️    - Diagnosis 6: 'E03.9'
[17:56:57] ℹ️  Final extracted MRN: '5240015'
[17:56:57] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:56:57] ℹ️  Final extracted Payer Source: ''
[17:56:57] ✅ Patient data extraction completed successfully
[17:56:57] ✅    ✅ Patient data extracted successfully
[17:56:57] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/16/2024', 'startOfEpisode': '09/18/2024', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'R09.02', 'fifthDiagnosis': 'M15.9', 'sixthDiagnosis': 'E03.9'}]
[17:56:57] ✅    ✅ Patient identified: Donna Cabral
[17:56:57] ✅    ✅ Patient name validation passed
[17:56:57] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:57] [DOC: 9200743] ℹ️  DOB normalized: 10/03/1947
[17:56:57] [DOC: 9200743] ℹ️  Episode startOfCare normalized: 09/16/2024
[17:56:57] [DOC: 9200743] ℹ️  Episode startOfEpisode normalized: 09/18/2024
[17:56:57] [DOC: 9200743] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:56:57] [DOC: 9200743] ✅ Patient date processing completed successfully
[17:56:57] ✅    ✅ Date processing completed
[17:56:57] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/16/2024', 'startOfEpisode': '09/18/2024', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'R09.02', 'fifthDiagnosis': 'M15.9', 'sixthDiagnosis': 'E03.9'}]
[17:56:57] 🔄 
🔄 Step 4: Extracting order data...
[17:57:00] ℹ️  Order extraction - MRN: '5240015'
[17:57:00] ℹ️  Order extraction - Sex: 'FEMALE'
[17:57:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[17:57:00] ℹ️  Order extraction - Payer Source: ''
[17:57:00] ✅ Order data extraction completed successfully
[17:57:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:00] ℹ️  Using MRN from patient data: '5240015' over '5240015'
[17:57:00] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[17:57:00] ✅ Patient name cross-validation successful
[17:57:00] ✅    ✅ Data merged successfully
[17:57:01] ✅    ✅ Order data extracted and validated
[17:57:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:01] [DOC: 9200743] ✅ Patient found in local cache: Donna Cabral, ID: 79190189-814f-4114-a438-904080ae2281
[17:57:01] ✅    ✅ Existing patient found with ID: 79190189-814f-4114-a438-904080ae2281
[17:57:01] 🔄 
🔄 Step 6: Pushing order to API...
[17:57:01] [DOC: 9200743] ℹ️  Pushing order via API for patient ID: 79190189-814f-4114-a438-904080ae2281
[17:57:02] [DOC: 9200743] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:57:02] ❌    ❌ Failed to push order
[17:57:02] 🔄 
🔄 Step 7: Writing to CSV...
[17:57:02] [DOC: 9200743] ℹ️  Calculated age: 77 from DOB: 10/03/1947
[17:57:02] [DOC: 9200743] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[17:57:02] [DOC: 9200743] ℹ️  Payer Source extracted: ''
[17:57:02] [DOC: 9200743] ℹ️  Diagnosis codes being written:
[17:57:02] [DOC: 9200743] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[17:57:02] [DOC: 9200743] ℹ️    - Latest_Episode_Seconddiagnosis: 'I89.0'
[17:57:02] [DOC: 9200743] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[17:57:02] [DOC: 9200743] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R09.02'
[17:57:02] [DOC: 9200743] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M15.9'
[17:57:02] [DOC: 9200743] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E03.9'
[17:57:02] [DOC: 9200743] ✅ Patient data written to CSV: Donna Cabral | Sex: FEMALE | Age: 77 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 5240015
[17:57:02] ✅    ✅ Document 9200743 processed and saved successfully
[17:57:02] 🔄 
🔄 Step 8: Saving API details...
[17:57:02] [DOC: 9200743] ℹ️  API push details saved for document 9200743
[17:57:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200715                         ║
================================================================================
[17:57:02] ℹ️  Agency: Dartmouth HH
[17:57:02] ℹ️  Date: 03/25/2025
[17:57:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:05] [DOC: 9200715] ✅ Text extracted using pdfplumber (6872 chars)
[17:57:05] ✅    ✅ Text extracted using pdfplumber (6872 chars)
[17:57:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:07] ℹ️  AI extracted raw sex value: 'F'
[17:57:07] ℹ️  AI extracted service line: 'PT, OT'
[17:57:07] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[17:57:07] ℹ️  AI extracted diagnoses:
[17:57:07] ℹ️    - Diagnosis 1: ''
[17:57:07] ℹ️    - Diagnosis 2: ''
[17:57:07] ℹ️    - Diagnosis 3: ''
[17:57:07] ℹ️    - Diagnosis 4: ''
[17:57:07] ℹ️    - Diagnosis 5: ''
[17:57:07] ℹ️    - Diagnosis 6: ''
[17:57:07] ℹ️  Final extracted MRN: '6066015'
[17:57:07] ℹ️  Final extracted Sex: 'FEMALE'
[17:57:07] ℹ️  Final extracted Service Line: 'PT, OT'
[17:57:07] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[17:57:07] ✅ Patient data extraction completed successfully
[17:57:07] ✅    ✅ Patient data extracted successfully
[17:57:07] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:57:07] ✅    ✅ Patient identified: Lois Fernandes
[17:57:07] ✅    ✅ Patient name validation passed
[17:57:07] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:07] [DOC: 9200715] ℹ️  DOB normalized: 05/15/1941
[17:57:07] [DOC: 9200715] ℹ️  Episode startOfCare normalized: 02/22/2025
[17:57:07] [DOC: 9200715] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[17:57:07] [DOC: 9200715] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[17:57:07] [DOC: 9200715] ✅ Patient date processing completed successfully
[17:57:07] ✅    ✅ Date processing completed
[17:57:07] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:57:07] 🔄 
🔄 Step 4: Extracting order data...
[17:57:10] ℹ️  Order extraction - MRN: ''
[17:57:10] ℹ️  Order extraction - Sex: 'FEMALE'
[17:57:10] ℹ️  Order extraction - Service Line: 'PT, OT'
[17:57:10] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[17:57:10] ✅ Order data extraction completed successfully
[17:57:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:10] ℹ️  Using MRN from patient data: '6066015'
[17:57:10] ℹ️  Service line consistent in both sources: 'PT, OT'
[17:57:10] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[17:57:10] ✅ Patient name cross-validation successful
[17:57:10] ✅    ✅ Data merged successfully
[17:57:11] ✅    ✅ Order data extracted and validated
[17:57:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:11] [DOC: 9200715] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[17:57:11] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[17:57:11] 🔄 
🔄 Step 6: Pushing order to API...
[17:57:11] [DOC: 9200715] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[17:57:12] [DOC: 9200715] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13961"}
[17:57:12] ❌    ❌ Failed to push order
[17:57:12] 🔄 
🔄 Step 7: Writing to CSV...
[17:57:12] [DOC: 9200715] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[17:57:12] [DOC: 9200715] ℹ️  Service Line extracted: 'PT, OT'
[17:57:12] [DOC: 9200715] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[17:57:12] [DOC: 9200715] ℹ️  Diagnosis codes being written:
[17:57:12] [DOC: 9200715] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:57:12] [DOC: 9200715] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:57:12] [DOC: 9200715] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:57:12] [DOC: 9200715] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:57:12] [DOC: 9200715] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:57:12] [DOC: 9200715] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:57:12] [DOC: 9200715] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: PT, OT | Payer: Blue Cross Medicare Adv | MRN: 6066015
[17:57:12] ✅    ✅ Document 9200715 processed and saved successfully
[17:57:12] 🔄 
🔄 Step 8: Saving API details...
[17:57:12] [DOC: 9200715] ℹ️  API push details saved for document 9200715
[17:57:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9200549                         ║
================================================================================
[17:57:12] ℹ️  Agency: Fairhaven HH&H
[17:57:12] ℹ️  Date: 03/25/2025
[17:57:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:13] [DOC: 9200549] ❌ Critical failure in get_pdf_text: Invalid response format
[17:57:13] ❌ Failed to extract text for Doc ID 9200549
[17:57:13] [DOC: 9200549] ℹ️  API push details saved for document 9200549
================================================================================
║                        Processing Document ID: 9199459                         ║
================================================================================
[17:57:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:57:13] ℹ️  Date: 03/24/2025
[17:57:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:18] [DOC: 9199459] ✅ Text extracted using pdfplumber (11356 chars)
[17:57:18] ✅    ✅ Text extracted using pdfplumber (11356 chars)
[17:57:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:21] ℹ️  AI extracted raw sex value: 'M'
[17:57:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:57:21] ℹ️  AI extracted payer source: 'SWH'
[17:57:21] ℹ️  AI extracted diagnoses:
[17:57:21] ℹ️    - Diagnosis 1: 'E11.65'
[17:57:21] ℹ️    - Diagnosis 2: 'I10'
[17:57:21] ℹ️    - Diagnosis 3: 'M54.50'
[17:57:21] ℹ️    - Diagnosis 4: 'F41.9'
[17:57:21] ℹ️    - Diagnosis 5: 'Z79.84'
[17:57:21] ℹ️    - Diagnosis 6: 'None'
[17:57:21] ℹ️  Final extracted MRN: '100994870'
[17:57:21] ℹ️  Final extracted Sex: 'MALE'
[17:57:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:57:21] ℹ️  Final extracted Payer Source: 'SWH'
[17:57:21] ✅ Patient data extraction completed successfully
[17:57:21] ✅    ✅ Patient data extracted successfully
[17:57:21] 📊 Patient Response
     └─ patientFName: Ismael
     └─ patientLName: Diaz
     └─ dob: 08/16/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 100994870
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 151 Rockway St, #D
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 762-7069
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '06/22/2018', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'Z79.84', 'sixthDiagnosis': None}]
[17:57:21] ✅    ✅ Patient identified: Ismael Diaz
[17:57:21] ✅    ✅ Patient name validation passed
[17:57:21] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:21] [DOC: 9199459] ℹ️  DOB normalized: 08/16/1938
[17:57:21] [DOC: 9199459] ℹ️  Episode startOfCare normalized: 06/22/2018
[17:57:21] [DOC: 9199459] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[17:57:21] [DOC: 9199459] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:57:21] [DOC: 9199459] ✅ Patient date processing completed successfully
[17:57:21] ✅    ✅ Date processing completed
[17:57:21] 📊 Processed Patient Data
     └─ patientFName: Ismael
     └─ patientLName: Diaz
     └─ dob: 08/16/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 100994870
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 151 Rockway St, #D
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 762-7069
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '06/22/2018', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M54.50', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'Z79.84'}]
[17:57:21] 🔄 
🔄 Step 4: Extracting order data...
[17:57:24] ℹ️  Order extraction - MRN: '100994870'
[17:57:24] ℹ️  Order extraction - Sex: 'MALE'
[17:57:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:57:24] ℹ️  Order extraction - Payer Source: 'SWH'
[17:57:24] ✅ Order data extraction completed successfully
[17:57:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:24] ℹ️  Using MRN from patient data: '100994870' over '100994870'
[17:57:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:57:24] ℹ️  Payer source consistent in both sources: 'SWH'
[17:57:24] ✅ Patient name cross-validation successful
[17:57:24] ✅    ✅ Data merged successfully
[17:57:25] ✅    ✅ Order data extracted and validated
[17:57:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:30] [DOC: 9199459] ✅ Patient exists in API: Ismael Diaz, ID: ad826fad-cf4a-4cdb-853f-b093f8c3b547
[17:57:30] ✅    ✅ Existing patient found with ID: ad826fad-cf4a-4cdb-853f-b093f8c3b547
[17:57:30] 🔄 
🔄 Step 6: Pushing order to API...
[17:57:30] [DOC: 9199459] ℹ️  Pushing order via API for patient ID: ad826fad-cf4a-4cdb-853f-b093f8c3b547
[17:57:31] [DOC: 9199459] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13860"}
[17:57:31] ❌    ❌ Failed to push order
[17:57:31] 🔄 
🔄 Step 7: Writing to CSV...
[17:57:31] [DOC: 9199459] ℹ️  Calculated age: 86 from DOB: 08/16/1938
[17:57:31] [DOC: 9199459] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:57:31] [DOC: 9199459] ℹ️  Payer Source extracted: 'SWH'
[17:57:31] [DOC: 9199459] ℹ️  Diagnosis codes being written:
[17:57:31] [DOC: 9199459] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[17:57:31] [DOC: 9199459] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[17:57:31] [DOC: 9199459] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.50'
[17:57:31] [DOC: 9199459] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.9'
[17:57:31] [DOC: 9199459] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z79.84'
[17:57:31] [DOC: 9199459] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:57:31] [DOC: 9199459] ✅ Patient data written to CSV: Ismael Diaz | Sex: MALE | Age: 86 | Service: Skilled Nursing | Payer: SWH | MRN: 100994870
[17:57:31] ✅    ✅ Document 9199459 processed and saved successfully
[17:57:31] 🔄 
🔄 Step 8: Saving API details...
[17:57:31] [DOC: 9199459] ℹ️  API push details saved for document 9199459
[17:57:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199448                         ║
================================================================================
[17:57:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:57:31] ℹ️  Date: 03/24/2025
[17:57:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:33] [DOC: 9199448] ✅ Text extracted using pdfplumber (1768 chars)
[17:57:33] ✅    ✅ Text extracted using pdfplumber (1768 chars)
[17:57:33] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:36] ℹ️  AI extracted raw sex value: ''
[17:57:36] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:57:36] ℹ️  AI extracted payer source: ''
[17:57:36] ℹ️  AI extracted diagnoses:
[17:57:36] ℹ️    - Diagnosis 1: 'J10.00'
[17:57:36] ℹ️    - Diagnosis 2: 'E11.59'
[17:57:36] ℹ️    - Diagnosis 3: 'I15.2'
[17:57:36] ℹ️    - Diagnosis 4: 'None'
[17:57:36] ℹ️    - Diagnosis 5: 'None'
[17:57:36] ℹ️    - Diagnosis 6: 'None'
[17:57:36] ℹ️  Final extracted MRN: 'MA250110074701'
[17:57:36] ℹ️  Final extracted Sex: ''
[17:57:36] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:57:36] ℹ️  Final extracted Payer Source: ''
[17:57:36] ✅ Patient data extraction completed successfully
[17:57:36] ✅    ✅ Patient data extracted successfully
[17:57:36] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:57:36] ✅    ✅ Patient identified: Gloria Couto
[17:57:36] ✅    ✅ Patient name validation passed
[17:57:36] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:36] [DOC: 9199448] ℹ️  DOB normalized: 07/30/1947
[17:57:36] [DOC: 9199448] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[17:57:36] [DOC: 9199448] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[17:57:36] [DOC: 9199448] ✅ Patient date processing completed successfully
[17:57:36] ✅    ✅ Date processing completed
[17:57:36] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2'}]
[17:57:36] 🔄 
🔄 Step 4: Extracting order data...
[17:57:38] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:57:38] ℹ️  Order extraction - Sex: ''
[17:57:38] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:57:38] ℹ️  Order extraction - Payer Source: ''
[17:57:38] ✅ Order data extraction completed successfully
[17:57:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:38] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:57:38] ⚠️  Could not determine sex using any available method
[17:57:38] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:57:38] ✅ Patient name cross-validation successful
[17:57:38] ✅    ✅ Data merged successfully
[17:57:39] ✅    ✅ Order data extracted and validated
[17:57:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:39] [DOC: 9199448] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:39] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:39] 🔄 
🔄 Step 6: Pushing order to API...
[17:57:39] [DOC: 9199448] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:40] [DOC: 9199448] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13738"}
[17:57:40] ❌    ❌ Failed to push order
[17:57:40] 🔄 
🔄 Step 7: Writing to CSV...
[17:57:40] [DOC: 9199448] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:57:40] [DOC: 9199448] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:57:40] [DOC: 9199448] ℹ️  Payer Source extracted: ''
[17:57:40] [DOC: 9199448] ℹ️  Diagnosis codes being written:
[17:57:40] [DOC: 9199448] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[17:57:40] [DOC: 9199448] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.59'
[17:57:40] [DOC: 9199448] ℹ️    - Latest_Episode_Thirddiagnosis: 'I15.2'
[17:57:40] [DOC: 9199448] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:57:40] [DOC: 9199448] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:57:40] [DOC: 9199448] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:57:40] [DOC: 9199448] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[17:57:40] ✅    ✅ Document 9199448 processed and saved successfully
[17:57:40] 🔄 
🔄 Step 8: Saving API details...
[17:57:40] [DOC: 9199448] ℹ️  API push details saved for document 9199448
[17:57:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199446                         ║
================================================================================
[17:57:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:57:40] ℹ️  Date: 03/24/2025
[17:57:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:43] [DOC: 9199446] ✅ Text extracted using pdfplumber (12800 chars)
[17:57:43] ✅    ✅ Text extracted using pdfplumber (12800 chars)
[17:57:43] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:46] ℹ️  AI extracted raw sex value: 'F'
[17:57:46] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[17:57:46] ℹ️  AI extracted payer source: 'Medicare'
[17:57:46] ℹ️  AI extracted diagnoses:
[17:57:46] ℹ️    - Diagnosis 1: 'J10.00'
[17:57:46] ℹ️    - Diagnosis 2: 'E11.59'
[17:57:46] ℹ️    - Diagnosis 3: 'I15.2'
[17:57:46] ℹ️    - Diagnosis 4: 'E11.69'
[17:57:46] ℹ️    - Diagnosis 5: 'E78.5'
[17:57:46] ℹ️    - Diagnosis 6: 'F41.9'
[17:57:46] ℹ️  Final extracted MRN: 'MA250110074701'
[17:57:46] ℹ️  Final extracted Sex: 'FEMALE'
[17:57:46] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[17:57:46] ℹ️  Final extracted Payer Source: 'Medicare'
[17:57:46] ✅ Patient data extraction completed successfully
[17:57:46] ✅    ✅ Patient data extracted successfully
[17:57:46] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[17:57:46] ✅    ✅ Patient identified: Gloria Couto
[17:57:46] ✅    ✅ Patient name validation passed
[17:57:46] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:46] [DOC: 9199446] ℹ️  DOB normalized: 07/30/1947
[17:57:46] [DOC: 9199446] ℹ️  Episode startOfCare normalized: 01/14/2025
[17:57:46] [DOC: 9199446] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[17:57:46] [DOC: 9199446] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[17:57:46] [DOC: 9199446] ✅ Patient date processing completed successfully
[17:57:46] ✅    ✅ Date processing completed
[17:57:46] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/14/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'E11.59', 'thirdDiagnosis': 'I15.2', 'fourthDiagnosis': 'E11.69', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'F41.9'}]
[17:57:46] 🔄 
🔄 Step 4: Extracting order data...
[17:57:49] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:57:49] ℹ️  Order extraction - Sex: 'FEMALE'
[17:57:49] ℹ️  Order extraction - Service Line: 'PT, OT'
[17:57:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:57:49] ✅ Order data extraction completed successfully
[17:57:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:49] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:57:49] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[17:57:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:57:49] ✅ Patient name cross-validation successful
[17:57:49] ✅    ✅ Data merged successfully
[17:57:50] ✅    ✅ Order data extracted and validated
[17:57:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:50] [DOC: 9199446] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:50] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:50] 🔄 
🔄 Step 6: Pushing order to API...
[17:57:50] [DOC: 9199446] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:51] [DOC: 9199446] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13739"}
[17:57:51] ❌    ❌ Failed to push order
[17:57:51] 🔄 
🔄 Step 7: Writing to CSV...
[17:57:51] [DOC: 9199446] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:57:51] [DOC: 9199446] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[17:57:51] [DOC: 9199446] ℹ️  Payer Source extracted: 'Medicare'
[17:57:51] [DOC: 9199446] ℹ️  Diagnosis codes being written:
[17:57:51] [DOC: 9199446] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[17:57:51] [DOC: 9199446] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.59'
[17:57:51] [DOC: 9199446] ℹ️    - Latest_Episode_Thirddiagnosis: 'I15.2'
[17:57:51] [DOC: 9199446] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.69'
[17:57:51] [DOC: 9199446] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[17:57:51] [DOC: 9199446] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:57:51] [DOC: 9199446] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: MA250110074701
[17:57:51] ✅    ✅ Document 9199446 processed and saved successfully
[17:57:51] 🔄 
🔄 Step 8: Saving API details...
[17:57:51] [DOC: 9199446] ℹ️  API push details saved for document 9199446
[17:57:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199440                         ║
================================================================================
[17:57:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:57:51] ℹ️  Date: 03/24/2025
[17:57:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:53] [DOC: 9199440] ✅ Text extracted using pdfplumber (1472 chars)
[17:57:53] ✅    ✅ Text extracted using pdfplumber (1472 chars)
[17:57:53] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:56] ℹ️  AI extracted raw sex value: ''
[17:57:56] ℹ️  AI extracted service line: 'Physical Therapy'
[17:57:56] ℹ️  AI extracted payer source: ''
[17:57:56] ℹ️  AI extracted diagnoses:
[17:57:56] ℹ️    - Diagnosis 1: 'U07.1'
[17:57:56] ℹ️    - Diagnosis 2: 'J12.82'
[17:57:56] ℹ️    - Diagnosis 3: 'R13.12'
[17:57:56] ℹ️    - Diagnosis 4: 'None'
[17:57:56] ℹ️    - Diagnosis 5: 'None'
[17:57:56] ℹ️    - Diagnosis 6: 'None'
[17:57:56] ℹ️  Final extracted MRN: 'MA250110074701'
[17:57:56] ℹ️  Final extracted Sex: ''
[17:57:56] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:57:56] ℹ️  Final extracted Payer Source: ''
[17:57:56] ✅ Patient data extraction completed successfully
[17:57:56] ✅    ✅ Patient data extracted successfully
[17:57:56] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:57:56] ✅    ✅ Patient identified: Gloria Couto
[17:57:56] ✅    ✅ Patient name validation passed
[17:57:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:56] [DOC: 9199440] ℹ️  DOB normalized: 07/30/1947
[17:57:56] [DOC: 9199440] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[17:57:56] [DOC: 9199440] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[17:57:56] [DOC: 9199440] ✅ Patient date processing completed successfully
[17:57:56] ✅    ✅ Date processing completed
[17:57:56] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[17:57:56] 🔄 
🔄 Step 4: Extracting order data...
[17:57:58] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:57:58] ℹ️  Order extraction - Sex: ''
[17:57:58] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:57:58] ℹ️  Order extraction - Payer Source: ''
[17:57:58] ✅ Order data extraction completed successfully
[17:57:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:58] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:57:58] ⚠️  Could not determine sex using any available method
[17:57:58] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:57:58] ✅ Patient name cross-validation successful
[17:57:58] ✅    ✅ Data merged successfully
[17:57:59] ✅    ✅ Order data extracted and validated
[17:57:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:59] [DOC: 9199440] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:59] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:57:59] 🔄 
🔄 Step 6: Pushing order to API...
[17:57:59] [DOC: 9199440] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:01] [DOC: 9199440] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13740"}
[17:58:01] ❌    ❌ Failed to push order
[17:58:01] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:01] [DOC: 9199440] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:58:01] [DOC: 9199440] ℹ️  Service Line extracted: 'Physical Therapy'
[17:58:01] [DOC: 9199440] ℹ️  Payer Source extracted: ''
[17:58:01] [DOC: 9199440] ℹ️  Diagnosis codes being written:
[17:58:01] [DOC: 9199440] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[17:58:01] [DOC: 9199440] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[17:58:01] [DOC: 9199440] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[17:58:01] [DOC: 9199440] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:01] [DOC: 9199440] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:01] [DOC: 9199440] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:01] [DOC: 9199440] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy | Payer:  | MRN: MA250110074701
[17:58:01] ✅    ✅ Document 9199440 processed and saved successfully
[17:58:01] 🔄 
🔄 Step 8: Saving API details...
[17:58:01] [DOC: 9199440] ℹ️  API push details saved for document 9199440
[17:58:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199438                         ║
================================================================================
[17:58:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:01] ℹ️  Date: 03/24/2025
[17:58:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:07] [DOC: 9199438] ✅ Text extracted using pdfplumber (17205 chars)
[17:58:07] ✅    ✅ Text extracted using pdfplumber (17205 chars)
[17:58:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:10] ℹ️  AI extracted raw sex value: ''
[17:58:10] ℹ️  AI extracted service line: 'PT'
[17:58:10] ℹ️  AI extracted payer source: ''
[17:58:10] ℹ️  AI extracted diagnoses:
[17:58:10] ℹ️    - Diagnosis 1: 'J09'
[17:58:10] ℹ️    - Diagnosis 2: 'I10'
[17:58:10] ℹ️    - Diagnosis 3: 'I25.10'
[17:58:10] ℹ️    - Diagnosis 4: 'E11.9'
[17:58:10] ℹ️    - Diagnosis 5: 'C50.9'
[17:58:10] ℹ️    - Diagnosis 6: 'F41.9'
[17:58:10] ℹ️  Final extracted MRN: 'MA250110074701'
[17:58:10] ℹ️  Final extracted Sex: ''
[17:58:10] ℹ️  Final extracted Service Line: 'PT'
[17:58:10] ℹ️  Final extracted Payer Source: ''
[17:58:10] ✅ Patient data extraction completed successfully
[17:58:10] ✅    ✅ Patient data extracted successfully
[17:58:10] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'J09', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'C50.9', 'sixthDiagnosis': 'F41.9'}]
[17:58:10] ✅    ✅ Patient identified: Gloria Couto
[17:58:10] ✅    ✅ Patient name validation passed
[17:58:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:10] [DOC: 9199438] ℹ️  DOB normalized: 07/30/1947
[17:58:10] [DOC: 9199438] ✅ Patient date processing completed successfully
[17:58:10] ✅    ✅ Date processing completed
[17:58:10] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'J09', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'C50.9', 'sixthDiagnosis': 'F41.9'}]
[17:58:10] 🔄 
🔄 Step 4: Extracting order data...
[17:58:13] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:58:13] ℹ️  Order extraction - Sex: 'FEMALE'
[17:58:13] ℹ️  Order extraction - Service Line: 'PT'
[17:58:13] ℹ️  Order extraction - Payer Source: ''
[17:58:13] ✅ Order data extraction completed successfully
[17:58:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:13] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:58:13] ℹ️  Service line consistent in both sources: 'PT'
[17:58:13] ✅ Patient name cross-validation successful
[17:58:13] ✅    ✅ Data merged successfully
[17:58:14] ✅    ✅ Order data extracted and validated
[17:58:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:14] [DOC: 9199438] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:14] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:14] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:14] [DOC: 9199438] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:15] [DOC: 9199438] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:58:15] ❌    ❌ Failed to push order
[17:58:15] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:15] [DOC: 9199438] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:58:15] [DOC: 9199438] ℹ️  Service Line extracted: 'PT'
[17:58:15] [DOC: 9199438] ℹ️  Payer Source extracted: ''
[17:58:15] [DOC: 9199438] ℹ️  Diagnosis codes being written:
[17:58:15] [DOC: 9199438] ℹ️    - Latest_Episode_Firstdiagnosis: 'J09'
[17:58:15] [DOC: 9199438] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[17:58:15] [DOC: 9199438] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[17:58:15] [DOC: 9199438] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[17:58:15] [DOC: 9199438] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C50.9'
[17:58:15] [DOC: 9199438] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[17:58:15] [DOC: 9199438] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: PT | Payer:  | MRN: MA250110074701
[17:58:15] ✅    ✅ Document 9199438 processed and saved successfully
[17:58:15] 🔄 
🔄 Step 8: Saving API details...
[17:58:15] [DOC: 9199438] ℹ️  API push details saved for document 9199438
[17:58:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199433                         ║
================================================================================
[17:58:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:15] ℹ️  Date: 03/24/2025
[17:58:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:17] [DOC: 9199433] ✅ Text extracted using pdfplumber (1591 chars)
[17:58:17] ✅    ✅ Text extracted using pdfplumber (1591 chars)
[17:58:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:20] ℹ️  AI extracted raw sex value: ''
[17:58:20] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:58:20] ℹ️  AI extracted payer source: ''
[17:58:20] ℹ️  AI extracted diagnoses:
[17:58:20] ℹ️    - Diagnosis 1: 'U07.1'
[17:58:20] ℹ️    - Diagnosis 2: 'J12.82'
[17:58:20] ℹ️    - Diagnosis 3: 'R13.12'
[17:58:20] ℹ️    - Diagnosis 4: ''
[17:58:20] ℹ️    - Diagnosis 5: ''
[17:58:20] ℹ️    - Diagnosis 6: ''
[17:58:20] ℹ️  Final extracted MRN: 'MA250110074701'
[17:58:20] ℹ️  Final extracted Sex: ''
[17:58:20] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:58:20] ℹ️  Final extracted Payer Source: ''
[17:58:20] ✅ Patient data extraction completed successfully
[17:58:20] ✅    ✅ Patient data extracted successfully
[17:58:20] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:20] ✅    ✅ Patient identified: Gloria Couto
[17:58:20] ✅    ✅ Patient name validation passed
[17:58:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:20] [DOC: 9199433] ℹ️  DOB normalized: 07/30/1947
[17:58:20] [DOC: 9199433] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[17:58:20] [DOC: 9199433] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[17:58:20] [DOC: 9199433] ✅ Patient date processing completed successfully
[17:58:20] ✅    ✅ Date processing completed
[17:58:20] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:20] 🔄 
🔄 Step 4: Extracting order data...
[17:58:23] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:58:23] ℹ️  Order extraction - Sex: ''
[17:58:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:58:23] ℹ️  Order extraction - Payer Source: ''
[17:58:23] ✅ Order data extraction completed successfully
[17:58:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:23] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:58:23] ⚠️  Could not determine sex using any available method
[17:58:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:58:23] ✅ Patient name cross-validation successful
[17:58:23] ✅    ✅ Data merged successfully
[17:58:24] ✅    ✅ Order data extracted and validated
[17:58:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:24] [DOC: 9199433] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:24] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:24] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:24] [DOC: 9199433] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:25] [DOC: 9199433] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13741"}
[17:58:25] ❌    ❌ Failed to push order
[17:58:25] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:25] [DOC: 9199433] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:58:25] [DOC: 9199433] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:58:25] [DOC: 9199433] ℹ️  Payer Source extracted: ''
[17:58:25] [DOC: 9199433] ℹ️  Diagnosis codes being written:
[17:58:25] [DOC: 9199433] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[17:58:25] [DOC: 9199433] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[17:58:25] [DOC: 9199433] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[17:58:25] [DOC: 9199433] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:25] [DOC: 9199433] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:25] [DOC: 9199433] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:25] [DOC: 9199433] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[17:58:25] ✅    ✅ Document 9199433 processed and saved successfully
[17:58:25] 🔄 
🔄 Step 8: Saving API details...
[17:58:25] [DOC: 9199433] ℹ️  API push details saved for document 9199433
[17:58:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199430                         ║
================================================================================
[17:58:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:25] ℹ️  Date: 03/24/2025
[17:58:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:28] [DOC: 9199430] ✅ Text extracted using pdfplumber (12283 chars)
[17:58:28] ✅    ✅ Text extracted using pdfplumber (12283 chars)
[17:58:28] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:31] ℹ️  AI extracted raw sex value: 'F'
[17:58:31] ℹ️  AI extracted service line: 'OT'
[17:58:31] ℹ️  AI extracted payer source: ''
[17:58:31] ℹ️  AI extracted diagnoses:
[17:58:31] ℹ️    - Diagnosis 1: 'PNA from COVID-19'
[17:58:31] ℹ️    - Diagnosis 2: ''
[17:58:31] ℹ️    - Diagnosis 3: ''
[17:58:31] ℹ️    - Diagnosis 4: ''
[17:58:31] ℹ️    - Diagnosis 5: ''
[17:58:31] ℹ️    - Diagnosis 6: ''
[17:58:31] ℹ️  Final extracted MRN: 'MA250110074701'
[17:58:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:58:31] ℹ️  Final extracted Service Line: 'OT'
[17:58:31] ℹ️  Final extracted Payer Source: ''
[17:58:31] ✅ Patient data extraction completed successfully
[17:58:31] ✅    ✅ Patient data extracted successfully
[17:58:31] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': 'PNA from COVID-19', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:31] ✅    ✅ Patient identified: Gloria Couto
[17:58:31] ✅    ✅ Patient name validation passed
[17:58:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:31] [DOC: 9199430] ℹ️  DOB normalized: 07/30/1947
[17:58:31] [DOC: 9199430] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[17:58:31] [DOC: 9199430] ℹ️  Episode endOfEpisode normalized: 02/26/2025
[17:58:31] [DOC: 9199430] ✅ Patient date processing completed successfully
[17:58:31] ✅    ✅ Date processing completed
[17:58:31] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': 'PNA from COVID-19', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:31] 🔄 
🔄 Step 4: Extracting order data...
[17:58:34] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:58:34] ℹ️  Order extraction - Sex: 'FEMALE'
[17:58:34] ℹ️  Order extraction - Service Line: 'OT'
[17:58:34] ℹ️  Order extraction - Payer Source: ''
[17:58:34] ✅ Order data extraction completed successfully
[17:58:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:34] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:58:34] ℹ️  Service line consistent in both sources: 'OT'
[17:58:34] ✅ Patient name cross-validation successful
[17:58:34] ✅    ✅ Data merged successfully
[17:58:35] ✅    ✅ Order data extracted and validated
[17:58:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:35] [DOC: 9199430] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:35] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:35] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:35] [DOC: 9199430] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:36] [DOC: 9199430] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:58:36] ❌    ❌ Failed to push order
[17:58:36] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:36] [DOC: 9199430] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:58:36] [DOC: 9199430] ℹ️  Service Line extracted: 'OT'
[17:58:36] [DOC: 9199430] ℹ️  Payer Source extracted: ''
[17:58:36] [DOC: 9199430] ℹ️  Diagnosis codes being written:
[17:58:36] [DOC: 9199430] ℹ️    - Latest_Episode_Firstdiagnosis: 'PNA from COVID-19'
[17:58:36] [DOC: 9199430] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:58:36] [DOC: 9199430] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:58:36] [DOC: 9199430] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:36] [DOC: 9199430] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:36] [DOC: 9199430] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:36] [DOC: 9199430] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT | Payer:  | MRN: MA250110074701
[17:58:36] ✅    ✅ Document 9199430 processed and saved successfully
[17:58:36] 🔄 
🔄 Step 8: Saving API details...
[17:58:36] [DOC: 9199430] ℹ️  API push details saved for document 9199430
[17:58:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199415                         ║
================================================================================
[17:58:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:36] ℹ️  Date: 03/24/2025
[17:58:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:38] [DOC: 9199415] ✅ Text extracted using pdfplumber (1594 chars)
[17:58:38] ✅    ✅ Text extracted using pdfplumber (1594 chars)
[17:58:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:41] ℹ️  AI extracted raw sex value: ''
[17:58:41] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[17:58:41] ℹ️  AI extracted payer source: ''
[17:58:41] ℹ️  AI extracted diagnoses:
[17:58:41] ℹ️    - Diagnosis 1: 'U07.1'
[17:58:41] ℹ️    - Diagnosis 2: 'J12.82'
[17:58:41] ℹ️    - Diagnosis 3: 'R13.12'
[17:58:41] ℹ️    - Diagnosis 4: 'None'
[17:58:41] ℹ️    - Diagnosis 5: 'None'
[17:58:41] ℹ️    - Diagnosis 6: 'None'
[17:58:41] ℹ️  Final extracted MRN: 'MA250110074701'
[17:58:41] ℹ️  Final extracted Sex: ''
[17:58:41] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Speech Therapy'
[17:58:41] ℹ️  Final extracted Payer Source: ''
[17:58:41] ✅ Patient data extraction completed successfully
[17:58:41] ✅    ✅ Patient data extracted successfully
[17:58:41] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:58:41] ✅    ✅ Patient identified: Gloria Couto
[17:58:41] ✅    ✅ Patient name validation passed
[17:58:41] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:41] [DOC: 9199415] ℹ️  DOB normalized: 07/30/1947
[17:58:41] [DOC: 9199415] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[17:58:41] [DOC: 9199415] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[17:58:41] [DOC: 9199415] ✅ Patient date processing completed successfully
[17:58:41] ✅    ✅ Date processing completed
[17:58:41] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[17:58:41] 🔄 
🔄 Step 4: Extracting order data...
[17:58:44] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:58:44] ℹ️  Order extraction - Sex: ''
[17:58:44] ℹ️  Order extraction - Service Line: 'Physical Therapy,Occupational Therapy,Speech Therapy'
[17:58:44] ℹ️  Order extraction - Payer Source: ''
[17:58:44] ✅ Order data extraction completed successfully
[17:58:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:44] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:58:44] ⚠️  Could not determine sex using any available method
[17:58:44] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy, Speech Therapy' + Order='Physical Therapy,Occupational Therapy,Speech Therapy' = 'Occupational Therapy, Physical Therapy, Speech Therapy'
[17:58:44] ✅ Patient name cross-validation successful
[17:58:44] ✅    ✅ Data merged successfully
[17:58:45] ✅    ✅ Order data extracted and validated
[17:58:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:45] [DOC: 9199415] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:45] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:45] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:45] [DOC: 9199415] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:47] [DOC: 9199415] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13743"}
[17:58:47] ❌    ❌ Failed to push order
[17:58:47] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:47] [DOC: 9199415] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:58:47] [DOC: 9199415] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Speech Therapy'
[17:58:47] [DOC: 9199415] ℹ️  Payer Source extracted: ''
[17:58:47] [DOC: 9199415] ℹ️  Diagnosis codes being written:
[17:58:47] [DOC: 9199415] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[17:58:47] [DOC: 9199415] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[17:58:47] [DOC: 9199415] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[17:58:47] [DOC: 9199415] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:47] [DOC: 9199415] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:47] [DOC: 9199415] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:47] [DOC: 9199415] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy, Physical Therapy, Speech Therapy | Payer:  | MRN: MA250110074701
[17:58:47] ✅    ✅ Document 9199415 processed and saved successfully
[17:58:47] 🔄 
🔄 Step 8: Saving API details...
[17:58:47] [DOC: 9199415] ℹ️  API push details saved for document 9199415
[17:58:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199412                         ║
================================================================================
[17:58:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:47] ℹ️  Date: 03/24/2025
[17:58:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:49] [DOC: 9199412] ✅ Text extracted using pdfplumber (1400 chars)
[17:58:49] ✅    ✅ Text extracted using pdfplumber (1400 chars)
[17:58:49] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:52] ℹ️  AI extracted raw sex value: ''
[17:58:52] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:58:52] ℹ️  AI extracted payer source: ''
[17:58:52] ℹ️  AI extracted diagnoses:
[17:58:52] ℹ️    - Diagnosis 1: 'U07.1'
[17:58:52] ℹ️    - Diagnosis 2: 'J12.82'
[17:58:52] ℹ️    - Diagnosis 3: 'R13.12'
[17:58:52] ℹ️    - Diagnosis 4: 'None'
[17:58:52] ℹ️    - Diagnosis 5: 'None'
[17:58:52] ℹ️    - Diagnosis 6: 'None'
[17:58:52] ℹ️  Final extracted MRN: 'MA250110074701'
[17:58:52] ℹ️  Final extracted Sex: ''
[17:58:52] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:58:52] ℹ️  Final extracted Payer Source: ''
[17:58:52] ✅ Patient data extraction completed successfully
[17:58:52] ✅    ✅ Patient data extracted successfully
[17:58:52] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:58:52] ✅    ✅ Patient identified: Gloria Couto
[17:58:52] ✅    ✅ Patient name validation passed
[17:58:52] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:52] [DOC: 9199412] ℹ️  DOB normalized: 07/30/1947
[17:58:52] [DOC: 9199412] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[17:58:52] [DOC: 9199412] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[17:58:52] [DOC: 9199412] ✅ Patient date processing completed successfully
[17:58:52] ✅    ✅ Date processing completed
[17:58:52] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[17:58:52] 🔄 
🔄 Step 4: Extracting order data...
[17:58:54] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:58:54] ℹ️  Order extraction - Sex: ''
[17:58:54] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:58:54] ℹ️  Order extraction - Payer Source: ''
[17:58:54] ✅ Order data extraction completed successfully
[17:58:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:54] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:58:54] ⚠️  Could not determine sex using any available method
[17:58:54] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:58:54] ✅ Patient name cross-validation successful
[17:58:54] ✅    ✅ Data merged successfully
[17:58:55] ✅    ✅ Order data extracted and validated
[17:58:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:55] [DOC: 9199412] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:55] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:55] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:55] [DOC: 9199412] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:58:57] [DOC: 9199412] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13745"}
[17:58:57] ❌    ❌ Failed to push order
[17:58:57] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:57] [DOC: 9199412] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:58:57] [DOC: 9199412] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:58:57] [DOC: 9199412] ℹ️  Payer Source extracted: ''
[17:58:57] [DOC: 9199412] ℹ️  Diagnosis codes being written:
[17:58:57] [DOC: 9199412] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[17:58:57] [DOC: 9199412] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[17:58:57] [DOC: 9199412] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[17:58:57] [DOC: 9199412] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:57] [DOC: 9199412] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:57] [DOC: 9199412] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:57] [DOC: 9199412] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[17:58:57] ✅    ✅ Document 9199412 processed and saved successfully
[17:58:57] 🔄 
🔄 Step 8: Saving API details...
[17:58:57] [DOC: 9199412] ℹ️  API push details saved for document 9199412
[17:58:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199408                         ║
================================================================================
[17:58:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:57] ℹ️  Date: 03/24/2025
[17:58:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:59] [DOC: 9199408] ✅ Text extracted using pdfplumber (1397 chars)
[17:58:59] ✅    ✅ Text extracted using pdfplumber (1397 chars)
[17:58:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:02] ℹ️  AI extracted raw sex value: ''
[17:59:02] ℹ️  AI extracted service line: 'Physical Therapy'
[17:59:02] ℹ️  AI extracted payer source: ''
[17:59:02] ℹ️  AI extracted diagnoses:
[17:59:02] ℹ️    - Diagnosis 1: 'U07.1'
[17:59:02] ℹ️    - Diagnosis 2: 'J12.82'
[17:59:02] ℹ️    - Diagnosis 3: 'R13.12'
[17:59:02] ℹ️    - Diagnosis 4: 'None'
[17:59:02] ℹ️    - Diagnosis 5: 'None'
[17:59:02] ℹ️    - Diagnosis 6: 'None'
[17:59:02] ℹ️  Final extracted MRN: 'MA250110074701'
[17:59:02] ℹ️  Final extracted Sex: ''
[17:59:02] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:59:02] ℹ️  Final extracted Payer Source: ''
[17:59:02] ✅ Patient data extraction completed successfully
[17:59:02] ✅    ✅ Patient data extracted successfully
[17:59:02] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:59:02] ✅    ✅ Patient identified: Gloria Couto
[17:59:02] ✅    ✅ Patient name validation passed
[17:59:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:02] [DOC: 9199408] ℹ️  DOB normalized: 07/30/1947
[17:59:02] [DOC: 9199408] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[17:59:02] [DOC: 9199408] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[17:59:02] [DOC: 9199408] ✅ Patient date processing completed successfully
[17:59:02] ✅    ✅ Date processing completed
[17:59:02] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'J12.82', 'thirdDiagnosis': 'R13.12'}]
[17:59:02] 🔄 
🔄 Step 4: Extracting order data...
[17:59:04] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:59:04] ℹ️  Order extraction - Sex: ''
[17:59:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:59:04] ℹ️  Order extraction - Payer Source: ''
[17:59:04] ✅ Order data extraction completed successfully
[17:59:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:04] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:59:04] ⚠️  Could not determine sex using any available method
[17:59:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:59:04] ✅ Patient name cross-validation successful
[17:59:04] ✅    ✅ Data merged successfully
[17:59:06] ✅    ✅ Order data extracted and validated
[17:59:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:06] [DOC: 9199408] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:59:06] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:59:06] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:06] [DOC: 9199408] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:59:07] [DOC: 9199408] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13746"}
[17:59:07] ❌    ❌ Failed to push order
[17:59:07] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:07] [DOC: 9199408] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:59:07] [DOC: 9199408] ℹ️  Service Line extracted: 'Physical Therapy'
[17:59:07] [DOC: 9199408] ℹ️  Payer Source extracted: ''
[17:59:07] [DOC: 9199408] ℹ️  Diagnosis codes being written:
[17:59:07] [DOC: 9199408] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[17:59:07] [DOC: 9199408] ℹ️    - Latest_Episode_Seconddiagnosis: 'J12.82'
[17:59:07] [DOC: 9199408] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[17:59:07] [DOC: 9199408] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:07] [DOC: 9199408] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:07] [DOC: 9199408] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:07] [DOC: 9199408] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy | Payer:  | MRN: MA250110074701
[17:59:07] ✅    ✅ Document 9199408 processed and saved successfully
[17:59:07] 🔄 
🔄 Step 8: Saving API details...
[17:59:07] [DOC: 9199408] ℹ️  API push details saved for document 9199408
[17:59:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9199403                         ║
================================================================================
[17:59:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:59:07] ℹ️  Date: 03/24/2025
[17:59:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:10] [DOC: 9199403] ✅ Text extracted using pdfplumber (10246 chars)
[17:59:10] ✅    ✅ Text extracted using pdfplumber (10246 chars)
[17:59:10] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:13] ℹ️  AI extracted raw sex value: 'F'
[17:59:13] ℹ️  AI extracted service line: 'PT, OT, SLP'
[17:59:13] ℹ️  AI extracted payer source: 'None'
[17:59:13] ℹ️  AI extracted diagnoses:
[17:59:13] ℹ️    - Diagnosis 1: 'U071'
[17:59:13] ℹ️    - Diagnosis 2: 'J1282'
[17:59:13] ℹ️    - Diagnosis 3: 'None'
[17:59:13] ℹ️    - Diagnosis 4: 'None'
[17:59:13] ℹ️    - Diagnosis 5: 'None'
[17:59:13] ℹ️    - Diagnosis 6: 'None'
[17:59:13] ℹ️  Final extracted MRN: 'MA250110074701'
[17:59:13] ℹ️  Final extracted Sex: 'FEMALE'
[17:59:13] ℹ️  Final extracted Service Line: 'PT, OT, SLP'
[17:59:13] ℹ️  Final extracted Payer Source: ''
[17:59:13] ✅ Patient data extraction completed successfully
[17:59:13] ✅    ✅ Patient data extracted successfully
[17:59:13] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT, SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U071', 'secondDiagnosis': 'J1282', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:59:13] ✅    ✅ Patient identified: Gloria Couto
[17:59:13] ✅    ✅ Patient name validation passed
[17:59:13] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:13] [DOC: 9199403] ℹ️  DOB normalized: 07/30/1947
[17:59:13] [DOC: 9199403] ℹ️  Episode startOfEpisode normalized: 01/14/2025
[17:59:13] [DOC: 9199403] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[17:59:13] [DOC: 9199403] ✅ Patient date processing completed successfully
[17:59:13] ✅    ✅ Date processing completed
[17:59:13] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT, SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/14/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'U071', 'secondDiagnosis': 'J1282'}]
[17:59:13] 🔄 
🔄 Step 4: Extracting order data...
[17:59:16] ℹ️  Order extraction - MRN: 'MA250110074701'
[17:59:16] ℹ️  Order extraction - Sex: 'FEMALE'
[17:59:16] ℹ️  Order extraction - Service Line: 'PT, OT, ST'
[17:59:16] ℹ️  Order extraction - Payer Source: ''
[17:59:16] ✅ Order data extraction completed successfully
[17:59:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:16] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[17:59:16] ℹ️  Combined service lines: Patient='PT, OT, SLP' + Order='PT, OT, ST' = 'OT, PT, SLP, ST'
[17:59:16] ✅ Patient name cross-validation successful
[17:59:16] ✅    ✅ Data merged successfully
[17:59:17] ✅    ✅ Order data extracted and validated
[17:59:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:17] [DOC: 9199403] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:59:17] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:59:17] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:17] [DOC: 9199403] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[17:59:18] [DOC: 9199403] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13747"}
[17:59:18] ❌    ❌ Failed to push order
[17:59:18] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:18] [DOC: 9199403] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[17:59:18] [DOC: 9199403] ℹ️  Service Line extracted: 'OT, PT, SLP, ST'
[17:59:18] [DOC: 9199403] ℹ️  Payer Source extracted: ''
[17:59:18] [DOC: 9199403] ℹ️  Diagnosis codes being written:
[17:59:18] [DOC: 9199403] ℹ️    - Latest_Episode_Firstdiagnosis: 'U071'
[17:59:18] [DOC: 9199403] ℹ️    - Latest_Episode_Seconddiagnosis: 'J1282'
[17:59:18] [DOC: 9199403] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:59:18] [DOC: 9199403] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:18] [DOC: 9199403] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:18] [DOC: 9199403] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:18] [DOC: 9199403] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT, PT, SLP, ST | Payer:  | MRN: MA250110074701
[17:59:18] ✅    ✅ Document 9199403 processed and saved successfully
[17:59:18] 🔄 
🔄 Step 8: Saving API details...
[17:59:18] [DOC: 9199403] ℹ️  API push details saved for document 9199403
[17:59:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9196561                         ║
================================================================================
[17:59:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:59:18] ℹ️  Date: 03/21/2025
[17:59:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:21] [DOC: 9196561] ✅ Text extracted using pdfplumber (15639 chars)
[17:59:21] ✅    ✅ Text extracted using pdfplumber (15639 chars)
[17:59:21] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:24] ℹ️  AI extracted raw sex value: 'M'
[17:59:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:59:24] ℹ️  AI extracted payer source: ''
[17:59:24] ℹ️  AI extracted diagnoses:
[17:59:24] ℹ️    - Diagnosis 1: 'N39.0'
[17:59:24] ℹ️    - Diagnosis 2: 'I13.0'
[17:59:24] ℹ️    - Diagnosis 3: 'I50.32'
[17:59:24] ℹ️    - Diagnosis 4: 'E11.22'
[17:59:24] ℹ️    - Diagnosis 5: 'E11.51'
[17:59:24] ℹ️    - Diagnosis 6: 'E78.2'
[17:59:24] ℹ️  Final extracted MRN: '3028278'
[17:59:24] ℹ️  Final extracted Sex: 'MALE'
[17:59:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:59:24] ℹ️  Final extracted Payer Source: ''
[17:59:24] ✅ Patient data extraction completed successfully
[17:59:24] ✅    ✅ Patient data extracted successfully
[17:59:24] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Tavares
     └─ dob: 07/26/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 3028278
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'E78.2'}]
[17:59:24] ✅    ✅ Patient identified: Jose Tavares
[17:59:24] ✅    ✅ Patient name validation passed
[17:59:24] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:24] [DOC: 9196561] ℹ️  DOB normalized: 07/26/1927
[17:59:24] [DOC: 9196561] ℹ️  Episode startOfCare normalized: 03/02/2025
[17:59:24] [DOC: 9196561] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[17:59:24] [DOC: 9196561] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[17:59:24] [DOC: 9196561] ✅ Patient date processing completed successfully
[17:59:24] ✅    ✅ Date processing completed
[17:59:24] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Tavares
     └─ dob: 07/26/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 3028278
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'E78.2'}]
[17:59:24] 🔄 
🔄 Step 4: Extracting order data...
[17:59:27] ℹ️  Order extraction - MRN: '3028278'
[17:59:27] ℹ️  Order extraction - Sex: 'MALE'
[17:59:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:59:27] ℹ️  Order extraction - Payer Source: ''
[17:59:27] ✅ Order data extraction completed successfully
[17:59:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:27] ℹ️  Using MRN from patient data: '3028278' over '3028278'
[17:59:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:59:27] ✅ Patient name cross-validation successful
[17:59:27] ✅    ✅ Data merged successfully
[17:59:28] ✅    ✅ Order data extracted and validated
[17:59:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:38] [DOC: 9196561] ℹ️  Patient not found in cache or API: Jose Tavares
[17:59:38] [DOC: 9196561] ℹ️  Patient not found, creating new patient via API...
[17:59:38] [DOC: 9196561] ℹ️  Creating patient via API: Jose Tavares
[17:59:39] [DOC: 9196561] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:59:39] ❌    ❌ Failed to create patient
[17:59:39] [DOC: 9196561] ℹ️  API push details saved for document 9196561
================================================================================
║                        Processing Document ID: 9196545                         ║
================================================================================
[17:59:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:59:39] ℹ️  Date: 03/21/2025
[17:59:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:42] [DOC: 9196545] ✅ Text extracted using pdfplumber (1018 chars)
[17:59:42] ✅    ✅ Text extracted using pdfplumber (1018 chars)
[17:59:42] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:45] ℹ️  AI extracted raw sex value: 'F'
[17:59:45] ℹ️  AI extracted service line: 'PT'
[17:59:45] ℹ️  AI extracted payer source: ''
[17:59:45] ℹ️  AI extracted diagnoses:
[17:59:45] ℹ️    - Diagnosis 1: ''
[17:59:45] ℹ️    - Diagnosis 2: ''
[17:59:45] ℹ️    - Diagnosis 3: ''
[17:59:45] ℹ️    - Diagnosis 4: ''
[17:59:45] ℹ️    - Diagnosis 5: ''
[17:59:45] ℹ️    - Diagnosis 6: ''
[17:59:45] ℹ️  Final extracted MRN: '2120086'
[17:59:45] ℹ️  Final extracted Sex: 'FEMALE'
[17:59:45] ℹ️  Final extracted Service Line: 'PT'
[17:59:45] ℹ️  Final extracted Payer Source: ''
[17:59:45] ✅ Patient data extraction completed successfully
[17:59:45] ✅    ✅ Patient data extracted successfully
[17:59:45] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:59:45] ✅    ✅ Patient identified: Elaine Dupont
[17:59:45] ✅    ✅ Patient name validation passed
[17:59:45] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:45] [DOC: 9196545] ℹ️  DOB normalized: 09/06/1942
[17:59:45] [DOC: 9196545] ✅ Patient date processing completed successfully
[17:59:45] ✅    ✅ Date processing completed
[17:59:45] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dupont
     └─ dob: 09/06/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2120086
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:59:45] 🔄 
🔄 Step 4: Extracting order data...
[17:59:47] ℹ️  Order extraction - MRN: '2120086'
[17:59:47] ℹ️  Order extraction - Sex: 'FEMALE'
[17:59:47] ℹ️  Order extraction - Service Line: ''
[17:59:47] ℹ️  Order extraction - Payer Source: ''
[17:59:47] ✅ Order data extraction completed successfully
[17:59:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:47] ℹ️  Using MRN from patient data: '2120086' over '2120086'
[17:59:47] ℹ️  Using service line from patient data: 'PT'
[17:59:47] ✅ Patient name cross-validation successful
[17:59:47] ✅    ✅ Data merged successfully
[17:59:48] ⚠️     ❌ Skipping - missing episode start date
[17:59:48] [DOC: 9196545] ℹ️  API push details saved for document 9196545
================================================================================
║                        Processing Document ID: 9194248                         ║
================================================================================
[17:59:48] ℹ️  Agency: AccentCare Fall River
[17:59:48] ℹ️  Date: 03/20/2025
[17:59:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:52] [DOC: 9194248] ✅ Text extracted using pdfplumber (20923 chars)
[17:59:52] ✅    ✅ Text extracted using pdfplumber (20851 chars)
[17:59:52] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:55] ℹ️  AI extracted raw sex value: 'F'
[17:59:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:59:55] ℹ️  AI extracted payer source: 'Medicare'
[17:59:55] ℹ️  AI extracted diagnoses:
[17:59:55] ℹ️    - Diagnosis 1: 'S81.812D'
[17:59:55] ℹ️    - Diagnosis 2: 'B99.9'
[17:59:55] ℹ️    - Diagnosis 3: 'I10'
[17:59:55] ℹ️    - Diagnosis 4: 'I48.91'
[17:59:55] ℹ️    - Diagnosis 5: 'E78.00'
[17:59:55] ℹ️    - Diagnosis 6: 'D64.9'
[17:59:55] ℹ️  Final extracted MRN: 'C0200225862501'
[17:59:55] ℹ️  Final extracted Sex: 'FEMALE'
[17:59:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:59:55] ℹ️  Final extracted Payer Source: 'Medicare'
[17:59:55] ✅ Patient data extraction completed successfully
[17:59:55] ✅    ✅ Patient data extracted successfully
[17:59:55] 📊 Patient Response
     └─ patientFName: JOAN
     └─ patientLName: BULLARD
     └─ dob: 05/18/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225862501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'B99.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'E78.00', 'sixthDiagnosis': 'D64.9'}]
[17:59:55] ✅    ✅ Patient identified: JOAN BULLARD
[17:59:55] ✅    ✅ Patient name validation passed
[17:59:55] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:55] [DOC: 9194248] ℹ️  DOB normalized: 05/18/1932
[17:59:55] [DOC: 9194248] ℹ️  Episode startOfCare normalized: 01/16/2025
[17:59:55] [DOC: 9194248] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[17:59:55] [DOC: 9194248] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[17:59:55] [DOC: 9194248] ✅ Patient date processing completed successfully
[17:59:55] ✅    ✅ Date processing completed
[17:59:55] 📊 Processed Patient Data
     └─ patientFName: JOAN
     └─ patientLName: BULLARD
     └─ dob: 05/18/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225862501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'B99.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'E78.00', 'sixthDiagnosis': 'D64.9'}]
[17:59:55] 🔄 
🔄 Step 4: Extracting order data...
[17:59:58] ℹ️  Order extraction - MRN: 'C0200225862501'
[17:59:58] ℹ️  Order extraction - Sex: 'FEMALE'
[17:59:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:59:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:59:58] ✅ Order data extraction completed successfully
[17:59:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:58] ℹ️  Using MRN from patient data: 'C0200225862501' over 'C0200225862501'
[17:59:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:59:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:59:58] ✅ Patient name cross-validation successful
[17:59:58] ✅    ✅ Data merged successfully
[17:59:59] ✅    ✅ Order data extracted and validated
[17:59:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:07] [DOC: 9194248] ℹ️  Patient not found in cache or API: JOAN BULLARD
[18:00:07] [DOC: 9194248] ℹ️  Patient not found, creating new patient via API...
[18:00:07] [DOC: 9194248] ℹ️  Creating patient via API: JOAN BULLARD
[18:00:08] [DOC: 9194248] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:00:08] ❌    ❌ Failed to create patient
[18:00:08] [DOC: 9194248] ℹ️  API push details saved for document 9194248
================================================================================
║                        Processing Document ID: 9194204                         ║
================================================================================
[18:00:08] ℹ️  Agency: AccentCare Fall River
[18:00:08] ℹ️  Date: 03/20/2025
[18:00:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:11] [DOC: 9194204] ✅ Text extracted using pdfplumber (17412 chars)
[18:00:11] ✅    ✅ Text extracted using pdfplumber (17352 chars)
[18:00:11] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:15] ℹ️  AI extracted raw sex value: 'M'
[18:00:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:00:15] ℹ️  AI extracted payer source: 'Medicare'
[18:00:15] ℹ️  AI extracted diagnoses:
[18:00:15] ℹ️    - Diagnosis 1: 'I10'
[18:00:15] ℹ️    - Diagnosis 2: 'N40.0'
[18:00:15] ℹ️    - Diagnosis 3: 'N32.0'
[18:00:15] ℹ️    - Diagnosis 4: 'E66.3'
[18:00:15] ℹ️    - Diagnosis 5: 'Z68.27'
[18:00:15] ℹ️    - Diagnosis 6: 'Z91.81'
[18:00:15] ℹ️  Final extracted MRN: 'C0200218380901'
[18:00:15] ℹ️  Final extracted Sex: 'MALE'
[18:00:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:00:15] ℹ️  Final extracted Payer Source: 'Medicare'
[18:00:15] ✅ Patient data extraction completed successfully
[18:00:15] ✅    ✅ Patient data extracted successfully
[18:00:15] 📊 Patient Response
     └─ patientFName: JOSE
     └─ patientLName: CASADO
     └─ dob: 02/24/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200218380901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 89 BROOKLAWN ST
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/15/2024', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N40.0', 'thirdDiagnosis': 'N32.0', 'fourthDiagnosis': 'E66.3', 'fifthDiagnosis': 'Z68.27', 'sixthDiagnosis': 'Z91.81'}]
[18:00:15] ✅    ✅ Patient identified: JOSE CASADO
[18:00:15] ✅    ✅ Patient name validation passed
[18:00:15] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:15] [DOC: 9194204] ℹ️  DOB normalized: 02/24/1954
[18:00:15] [DOC: 9194204] ℹ️  Episode startOfCare normalized: 11/15/2024
[18:00:15] [DOC: 9194204] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[18:00:15] [DOC: 9194204] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[18:00:15] [DOC: 9194204] ✅ Patient date processing completed successfully
[18:00:15] ✅    ✅ Date processing completed
[18:00:15] 📊 Processed Patient Data
     └─ patientFName: JOSE
     └─ patientLName: CASADO
     └─ dob: 02/24/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200218380901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 89 BROOKLAWN ST
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/15/2024', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N40.0', 'thirdDiagnosis': 'N32.0', 'fourthDiagnosis': 'E66.3', 'fifthDiagnosis': 'Z68.27', 'sixthDiagnosis': 'Z91.81'}]
[18:00:15] 🔄 
🔄 Step 4: Extracting order data...
[18:00:18] ℹ️  Order extraction - MRN: '227203'
[18:00:18] ℹ️  Order extraction - Sex: 'MALE'
[18:00:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:00:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:00:18] ✅ Order data extraction completed successfully
[18:00:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:18] ℹ️  Using MRN from patient data: 'C0200218380901' over '227203'
[18:00:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:00:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:00:18] ✅ Patient name cross-validation successful
[18:00:18] ✅    ✅ Data merged successfully
[18:00:19] ✅    ✅ Order data extracted and validated
[18:00:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:19] [DOC: 9194204] ✅ Patient found in local cache: JOSE CASADO, ID: 82dd4811-5b48-4329-a55b-8cd28c1370fb
[18:00:19] ✅    ✅ Existing patient found with ID: 82dd4811-5b48-4329-a55b-8cd28c1370fb
[18:00:19] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:19] [DOC: 9194204] ℹ️  Pushing order via API for patient ID: 82dd4811-5b48-4329-a55b-8cd28c1370fb
[18:00:21] [DOC: 9194204] ❌ Order push failed with status 201: {"id":"b95ae9eb-e095-4e1b-a828-e09463b48005","orderWAVId":"ORD20079","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 11854824","orderDate":"03/11/2025","startOfCare":"11/15/2024","episodeStartDate":"03/15/2025","episodeEndDate":"05/13/2025","documentID":"9194204","mrn":"227203","patientName":"JOSE D CASADO","sentToPhysicianDate":"03/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Home Health Certification and Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"82dd4811-5b48-4329-a55b-8cd28c1370fb","companyId":"c7cc6389-e15a-468f-bfbc-bc60ac4d4e81","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:00:21] ❌    ❌ Failed to push order
[18:00:21] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:21] [DOC: 9194204] ℹ️  Calculated age: 71 from DOB: 02/24/1954
[18:00:21] [DOC: 9194204] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:00:21] [DOC: 9194204] ℹ️  Payer Source extracted: 'Medicare'
[18:00:21] [DOC: 9194204] ℹ️  Diagnosis codes being written:
[18:00:21] [DOC: 9194204] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:00:21] [DOC: 9194204] ℹ️    - Latest_Episode_Seconddiagnosis: 'N40.0'
[18:00:21] [DOC: 9194204] ℹ️    - Latest_Episode_Thirddiagnosis: 'N32.0'
[18:00:21] [DOC: 9194204] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.3'
[18:00:21] [DOC: 9194204] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.27'
[18:00:21] [DOC: 9194204] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z91.81'
[18:00:21] [DOC: 9194204] ✅ Patient data written to CSV: JOSE CASADO | Sex: MALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: C0200218380901
[18:00:21] ✅    ✅ Document 9194204 processed and saved successfully
[18:00:21] 🔄 
🔄 Step 8: Saving API details...
[18:00:21] [DOC: 9194204] ℹ️  API push details saved for document 9194204
[18:00:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194096                         ║
================================================================================
[18:00:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:00:21] ℹ️  Date: 03/20/2025
[18:00:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:23] [DOC: 9194096] ✅ Text extracted using pdfplumber (15179 chars)
[18:00:23] ✅    ✅ Text extracted using pdfplumber (15179 chars)
[18:00:23] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:27] ℹ️  AI extracted raw sex value: 'F'
[18:00:27] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[18:00:27] ℹ️  AI extracted payer source: ''
[18:00:27] ℹ️  AI extracted diagnoses:
[18:00:27] ℹ️    - Diagnosis 1: 'I26.94'
[18:00:27] ℹ️    - Diagnosis 2: 'J18.9'
[18:00:27] ℹ️    - Diagnosis 3: 'I24.89'
[18:00:27] ℹ️    - Diagnosis 4: 'E87.6'
[18:00:27] ℹ️    - Diagnosis 5: 'I10'
[18:00:27] ℹ️    - Diagnosis 6: 'R55'
[18:00:27] ℹ️  Final extracted MRN: '3073617'
[18:00:27] ℹ️  Final extracted Sex: 'FEMALE'
[18:00:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[18:00:27] ℹ️  Final extracted Payer Source: ''
[18:00:27] ✅ Patient data extraction completed successfully
[18:00:27] ✅    ✅ Patient data extracted successfully
[18:00:27] 📊 Patient Response
     └─ patientFName: Ruth
     └─ patientLName: Vital
     └─ dob: 10/11/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3073617
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.94', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'I24.89', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R55'}]
[18:00:27] ✅    ✅ Patient identified: Ruth Vital
[18:00:27] ✅    ✅ Patient name validation passed
[18:00:27] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:27] [DOC: 9194096] ℹ️  DOB normalized: 10/11/1936
[18:00:27] [DOC: 9194096] ℹ️  Episode startOfCare normalized: 03/08/2025
[18:00:27] [DOC: 9194096] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[18:00:27] [DOC: 9194096] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[18:00:27] [DOC: 9194096] ✅ Patient date processing completed successfully
[18:00:27] ✅    ✅ Date processing completed
[18:00:27] 📊 Processed Patient Data
     └─ patientFName: Ruth
     └─ patientLName: Vital
     └─ dob: 10/11/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3073617
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.94', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'I24.89', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'R55'}]
[18:00:27] 🔄 
🔄 Step 4: Extracting order data...
[18:00:29] ℹ️  Order extraction - MRN: '3073617'
[18:00:29] ℹ️  Order extraction - Sex: 'FEMALE'
[18:00:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[18:00:29] ℹ️  Order extraction - Payer Source: ''
[18:00:29] ✅ Order data extraction completed successfully
[18:00:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:29] ℹ️  Using MRN from patient data: '3073617' over '3073617'
[18:00:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[18:00:29] ✅ Patient name cross-validation successful
[18:00:29] ✅    ✅ Data merged successfully
[18:00:31] ✅    ✅ Order data extracted and validated
[18:00:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:31] [DOC: 9194096] ✅ Patient found in local cache: Ruth Vital, ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[18:00:31] ✅    ✅ Existing patient found with ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[18:00:31] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:31] [DOC: 9194096] ℹ️  Pushing order via API for patient ID: 6b03e825-8391-4922-ab86-fa9a134c2757
[18:00:32] [DOC: 9194096] ❌ Order push failed with status 201: {"id":"e2b8d274-2e6a-4dd5-84b8-ca67045f59bf","orderWAVId":"ORD20080","orderNo":"1072530","orderDate":"03/19/2025","startOfCare":"03/08/2025","episodeStartDate":"03/09/2025","episodeEndDate":"05/07/2025","documentID":"9194096","mrn":"3073617","patientName":"Vital, Ruth J","sentToPhysicianDate":"03/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6b03e825-8391-4922-ab86-fa9a134c2757","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:00:32] ❌    ❌ Failed to push order
[18:00:32] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:32] [DOC: 9194096] ℹ️  Calculated age: 88 from DOB: 10/11/1936
[18:00:32] [DOC: 9194096] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[18:00:32] [DOC: 9194096] ℹ️  Payer Source extracted: ''
[18:00:32] [DOC: 9194096] ℹ️  Diagnosis codes being written:
[18:00:32] [DOC: 9194096] ℹ️    - Latest_Episode_Firstdiagnosis: 'I26.94'
[18:00:32] [DOC: 9194096] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[18:00:32] [DOC: 9194096] ℹ️    - Latest_Episode_Thirddiagnosis: 'I24.89'
[18:00:32] [DOC: 9194096] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E87.6'
[18:00:32] [DOC: 9194096] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[18:00:32] [DOC: 9194096] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R55'
[18:00:32] [DOC: 9194096] ✅ Patient data written to CSV: Ruth Vital | Sex: FEMALE | Age: 88 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 3073617
[18:00:32] ✅    ✅ Document 9194096 processed and saved successfully
[18:00:32] 🔄 
🔄 Step 8: Saving API details...
[18:00:32] [DOC: 9194096] ℹ️  API push details saved for document 9194096
[18:00:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194090                         ║
================================================================================
[18:00:32] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:00:32] ℹ️  Date: 03/20/2025
[18:00:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:34] [DOC: 9194090] ✅ Text extracted using pdfplumber (906 chars)
[18:00:34] ✅    ✅ Text extracted using pdfplumber (906 chars)
[18:00:34] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:36] ℹ️  AI extracted raw sex value: 'F'
[18:00:36] ℹ️  AI extracted service line: 'Physical Therapy'
[18:00:36] ℹ️  AI extracted payer source: ''
[18:00:36] ℹ️  AI extracted diagnoses:
[18:00:36] ℹ️    - Diagnosis 1: 'None'
[18:00:36] ℹ️    - Diagnosis 2: 'None'
[18:00:36] ℹ️    - Diagnosis 3: 'None'
[18:00:36] ℹ️    - Diagnosis 4: 'None'
[18:00:36] ℹ️    - Diagnosis 5: 'None'
[18:00:36] ℹ️    - Diagnosis 6: 'None'
[18:00:36] ℹ️  Final extracted MRN: '2017657'
[18:00:36] ℹ️  Final extracted Sex: 'FEMALE'
[18:00:36] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:00:36] ℹ️  Final extracted Payer Source: ''
[18:00:36] ✅ Patient data extraction completed successfully
[18:00:36] ✅    ✅ Patient data extracted successfully
[18:00:36] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Tripp
     └─ dob: 10/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2017657
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:00:36] ✅    ✅ Patient identified: Theresa Tripp
[18:00:36] ✅    ✅ Patient name validation passed
[18:00:36] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:36] [DOC: 9194090] ℹ️  DOB normalized: 10/28/1964
[18:00:36] [DOC: 9194090] ✅ Patient date processing completed successfully
[18:00:36] ✅    ✅ Date processing completed
[18:00:36] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Tripp
     └─ dob: 10/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2017657
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[18:00:36] 🔄 
🔄 Step 4: Extracting order data...
[18:00:38] ℹ️  Order extraction - MRN: '2017657'
[18:00:38] ℹ️  Order extraction - Sex: 'FEMALE'
[18:00:38] ℹ️  Order extraction - Service Line: ''
[18:00:38] ℹ️  Order extraction - Payer Source: ''
[18:00:38] ✅ Order data extraction completed successfully
[18:00:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:38] ℹ️  Using MRN from patient data: '2017657' over '2017657'
[18:00:38] ℹ️  Using service line from patient data: 'Physical Therapy'
[18:00:38] ✅ Patient name cross-validation successful
[18:00:38] ✅    ✅ Data merged successfully
[18:00:39] ⚠️     ❌ Skipping - missing episode start date
[18:00:39] [DOC: 9194090] ℹ️  API push details saved for document 9194090
================================================================================
║                        Processing Document ID: 9194082                         ║
================================================================================
[18:00:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:00:39] ℹ️  Date: 03/20/2025
[18:00:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:41] [DOC: 9194082] ✅ Text extracted using pdfplumber (1496 chars)
[18:00:41] ✅    ✅ Text extracted using pdfplumber (1496 chars)
[18:00:41] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:43] ℹ️  AI extracted raw sex value: 'M'
[18:00:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:00:43] ℹ️  AI extracted payer source: ''
[18:00:43] ℹ️  AI extracted diagnoses:
[18:00:43] ℹ️    - Diagnosis 1: ''
[18:00:43] ℹ️    - Diagnosis 2: ''
[18:00:43] ℹ️    - Diagnosis 3: ''
[18:00:43] ℹ️    - Diagnosis 4: ''
[18:00:43] ℹ️    - Diagnosis 5: ''
[18:00:43] ℹ️    - Diagnosis 6: ''
[18:00:43] ℹ️  Final extracted MRN: '2944175'
[18:00:43] ℹ️  Final extracted Sex: 'MALE'
[18:00:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:00:43] ℹ️  Final extracted Payer Source: ''
[18:00:43] ✅ Patient data extraction completed successfully
[18:00:43] ✅    ✅ Patient data extracted successfully
[18:00:43] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:43] ✅    ✅ Patient identified: Ernest Santos
[18:00:43] ✅    ✅ Patient name validation passed
[18:00:43] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:43] [DOC: 9194082] ℹ️  DOB normalized: 08/29/1944
[18:00:43] [DOC: 9194082] ✅ Patient date processing completed successfully
[18:00:43] ✅    ✅ Date processing completed
[18:00:43] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:43] 🔄 
🔄 Step 4: Extracting order data...
[18:00:46] ℹ️  Order extraction - MRN: '2944175'
[18:00:46] ℹ️  Order extraction - Sex: 'MALE'
[18:00:46] ℹ️  Order extraction - Service Line: ''
[18:00:46] ℹ️  Order extraction - Payer Source: ''
[18:00:46] ✅ Order data extraction completed successfully
[18:00:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:46] ℹ️  Using MRN from patient data: '2944175' over '2944175'
[18:00:46] ℹ️  Using service line from patient data: 'Skilled Nursing'
[18:00:46] ✅ Patient name cross-validation successful
[18:00:46] ✅    ✅ Data merged successfully
[18:00:47] ✅    ✅ Order data extracted and validated
[18:00:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:01] [DOC: 9194082] ℹ️  Patient not found in cache or API: Ernest Santos
[18:01:01] [DOC: 9194082] ℹ️  Patient not found, creating new patient via API...
[18:01:01] [DOC: 9194082] ℹ️  Creating patient via API: Ernest Santos
[18:01:02] [DOC: 9194082] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:01:02] ❌    ❌ Failed to create patient
[18:01:02] [DOC: 9194082] ℹ️  API push details saved for document 9194082
================================================================================
║                        Processing Document ID: 9194076                         ║
================================================================================
[18:01:02] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:01:02] ℹ️  Date: 03/20/2025
[18:01:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:04] [DOC: 9194076] ✅ Text extracted using pdfplumber (1721 chars)
[18:01:04] ✅    ✅ Text extracted using pdfplumber (1721 chars)
[18:01:04] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:06] ℹ️  AI extracted raw sex value: 'M'
[18:01:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:01:06] ℹ️  AI extracted payer source: ''
[18:01:06] ℹ️  AI extracted diagnoses:
[18:01:06] ℹ️    - Diagnosis 1: 'Alzheimers/Dementia'
[18:01:06] ℹ️    - Diagnosis 2: ''
[18:01:06] ℹ️    - Diagnosis 3: ''
[18:01:06] ℹ️    - Diagnosis 4: ''
[18:01:06] ℹ️    - Diagnosis 5: ''
[18:01:06] ℹ️    - Diagnosis 6: ''
[18:01:06] ℹ️  Final extracted MRN: '2944175'
[18:01:06] ℹ️  Final extracted Sex: 'MALE'
[18:01:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:01:06] ℹ️  Final extracted Payer Source: ''
[18:01:06] ✅ Patient data extraction completed successfully
[18:01:06] ✅    ✅ Patient data extracted successfully
[18:01:06] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Alzheimers/Dementia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:06] ✅    ✅ Patient identified: Ernest Santos
[18:01:06] ✅    ✅ Patient name validation passed
[18:01:06] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:06] [DOC: 9194076] ℹ️  DOB normalized: 08/29/1944
[18:01:06] [DOC: 9194076] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[18:01:06] [DOC: 9194076] ✅ Patient date processing completed successfully
[18:01:06] ✅    ✅ Date processing completed
[18:01:06] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Alzheimers/Dementia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:06] 🔄 
🔄 Step 4: Extracting order data...
[18:01:09] ℹ️  Order extraction - MRN: '2944175'
[18:01:09] ℹ️  Order extraction - Sex: 'MALE'
[18:01:09] ℹ️  Order extraction - Service Line: 'SN'
[18:01:09] ℹ️  Order extraction - Payer Source: ''
[18:01:09] ✅ Order data extraction completed successfully
[18:01:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:09] ℹ️  Using MRN from patient data: '2944175' over '2944175'
[18:01:09] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[18:01:09] ✅ Patient name cross-validation successful
[18:01:09] ✅    ✅ Data merged successfully
[18:01:10] ✅    ✅ Order data extracted and validated
[18:01:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:15] [DOC: 9194076] ℹ️  Patient not found in cache or API: Ernest Santos
[18:01:15] [DOC: 9194076] ℹ️  Patient not found, creating new patient via API...
[18:01:15] [DOC: 9194076] ℹ️  Creating patient via API: Ernest Santos
[18:01:16] [DOC: 9194076] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:01:16] ❌    ❌ Failed to create patient
[18:01:16] [DOC: 9194076] ℹ️  API push details saved for document 9194076
================================================================================
║                        Processing Document ID: 9194062                         ║
================================================================================
[18:01:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:01:16] ℹ️  Date: 03/20/2025
[18:01:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:17] [DOC: 9194062] ✅ Text extracted using pdfplumber (1062 chars)
[18:01:17] ✅    ✅ Text extracted using pdfplumber (1062 chars)
[18:01:17] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:20] ℹ️  AI extracted raw sex value: 'F'
[18:01:20] ℹ️  AI extracted service line: 'RN'
[18:01:20] ℹ️  AI extracted payer source: ''
[18:01:20] ℹ️  AI extracted diagnoses:
[18:01:20] ℹ️    - Diagnosis 1: ''
[18:01:20] ℹ️    - Diagnosis 2: ''
[18:01:20] ℹ️    - Diagnosis 3: ''
[18:01:20] ℹ️    - Diagnosis 4: ''
[18:01:20] ℹ️    - Diagnosis 5: ''
[18:01:20] ℹ️    - Diagnosis 6: ''
[18:01:20] ℹ️  Final extracted MRN: '2848942'
[18:01:20] ℹ️  Final extracted Sex: 'FEMALE'
[18:01:20] ℹ️  Final extracted Service Line: 'RN'
[18:01:20] ℹ️  Final extracted Payer Source: ''
[18:01:20] ✅ Patient data extraction completed successfully
[18:01:20] ✅    ✅ Patient data extracted successfully
[18:01:20] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Phaneuf
     └─ dob: 10/04/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2848942
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/21/2025', 'endOfEpisode': '03/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:20] ✅    ✅ Patient identified: Jean Phaneuf
[18:01:20] ✅    ✅ Patient name validation passed
[18:01:20] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:20] [DOC: 9194062] ℹ️  DOB normalized: 10/04/1956
[18:01:20] [DOC: 9194062] ℹ️  Episode startOfEpisode normalized: 01/21/2025
[18:01:20] [DOC: 9194062] ℹ️  Episode endOfEpisode normalized: 03/19/2025
[18:01:20] [DOC: 9194062] ✅ Patient date processing completed successfully
[18:01:20] ✅    ✅ Date processing completed
[18:01:20] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Phaneuf
     └─ dob: 10/04/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2848942
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/21/2025', 'endOfEpisode': '03/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:20] 🔄 
🔄 Step 4: Extracting order data...
[18:01:22] ℹ️  Order extraction - MRN: '2848942'
[18:01:22] ℹ️  Order extraction - Sex: 'FEMALE'
[18:01:22] ℹ️  Order extraction - Service Line: ''
[18:01:22] ℹ️  Order extraction - Payer Source: ''
[18:01:22] ✅ Order data extraction completed successfully
[18:01:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:22] ℹ️  Using MRN from patient data: '2848942' over '2848942'
[18:01:22] ℹ️  Using service line from patient data: 'RN'
[18:01:22] ✅ Patient name cross-validation successful
[18:01:22] ✅    ✅ Data merged successfully
[18:01:23] ✅    ✅ Order data extracted and validated
[18:01:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:28] [DOC: 9194062] ℹ️  Patient not found in cache or API: Jean Phaneuf
[18:01:28] [DOC: 9194062] ℹ️  Patient not found, creating new patient via API...
[18:01:28] [DOC: 9194062] ℹ️  Creating patient via API: Jean Phaneuf
[18:01:29] [DOC: 9194062] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:01:29] ❌    ❌ Failed to create patient
[18:01:29] [DOC: 9194062] ℹ️  API push details saved for document 9194062
================================================================================
║                        Processing Document ID: 9194059                         ║
================================================================================
[18:01:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:01:29] ℹ️  Date: 03/20/2025
[18:01:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:31] [DOC: 9194059] ✅ Text extracted using pdfplumber (807 chars)
[18:01:31] ✅    ✅ Text extracted using pdfplumber (807 chars)
[18:01:31] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:33] ℹ️  AI extracted raw sex value: 'F'
[18:01:33] ℹ️  AI extracted service line: ''
[18:01:33] ℹ️  AI extracted payer source: ''
[18:01:33] ℹ️  AI extracted diagnoses:
[18:01:33] ℹ️    - Diagnosis 1: ''
[18:01:33] ℹ️    - Diagnosis 2: ''
[18:01:33] ℹ️    - Diagnosis 3: ''
[18:01:33] ℹ️    - Diagnosis 4: ''
[18:01:33] ℹ️    - Diagnosis 5: ''
[18:01:33] ℹ️    - Diagnosis 6: ''
[18:01:33] ℹ️  Final extracted MRN: '2796046'
[18:01:33] ℹ️  Final extracted Sex: 'FEMALE'
[18:01:33] ℹ️  Final extracted Service Line: ''
[18:01:33] ℹ️  Final extracted Payer Source: ''
[18:01:33] ✅ Patient data extraction completed successfully
[18:01:33] ✅    ✅ Patient data extracted successfully
[18:01:33] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:33] ✅    ✅ Patient identified: Betty Nunes
[18:01:33] ✅    ✅ Patient name validation passed
[18:01:33] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:33] [DOC: 9194059] ℹ️  DOB normalized: 02/21/1933
[18:01:33] [DOC: 9194059] ✅ Patient date processing completed successfully
[18:01:33] ✅    ✅ Date processing completed
[18:01:33] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:33] 🔄 
🔄 Step 4: Extracting order data...
[18:01:35] ℹ️  Order extraction - MRN: '2796046'
[18:01:35] ℹ️  Order extraction - Sex: 'FEMALE'
[18:01:35] ℹ️  Order extraction - Service Line: ''
[18:01:35] ℹ️  Order extraction - Payer Source: ''
[18:01:35] ✅ Order data extraction completed successfully
[18:01:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:35] ℹ️  Using MRN from patient data: '2796046' over '2796046'
[18:01:35] ✅ Patient name cross-validation successful
[18:01:35] ✅    ✅ Data merged successfully
[18:01:37] ⚠️     ❌ Skipping - missing episode start date
[18:01:37] [DOC: 9194059] ℹ️  API push details saved for document 9194059
================================================================================
║                        Processing Document ID: 9194055                         ║
================================================================================
[18:01:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:01:37] ℹ️  Date: 03/20/2025
[18:01:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:39] [DOC: 9194055] ✅ Text extracted using pdfplumber (7376 chars)
[18:01:39] ✅    ✅ Text extracted using pdfplumber (7376 chars)
[18:01:39] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:42] ℹ️  AI extracted raw sex value: 'F'
[18:01:42] ℹ️  AI extracted service line: 'Hospice'
[18:01:42] ℹ️  AI extracted payer source: ''
[18:01:42] ℹ️  AI extracted diagnoses:
[18:01:42] ℹ️    - Diagnosis 1: 'I69.90'
[18:01:42] ℹ️    - Diagnosis 2: ''
[18:01:42] ℹ️    - Diagnosis 3: ''
[18:01:42] ℹ️    - Diagnosis 4: ''
[18:01:42] ℹ️    - Diagnosis 5: ''
[18:01:42] ℹ️    - Diagnosis 6: ''
[18:01:42] ℹ️  Final extracted MRN: '2796046'
[18:01:42] ℹ️  Final extracted Sex: 'FEMALE'
[18:01:42] ℹ️  Final extracted Service Line: 'Hospice'
[18:01:42] ℹ️  Final extracted Payer Source: ''
[18:01:42] ✅ Patient data extraction completed successfully
[18:01:42] ✅    ✅ Patient data extracted successfully
[18:01:42] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:42] ✅    ✅ Patient identified: Betty Nunes
[18:01:42] ✅    ✅ Patient name validation passed
[18:01:42] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:42] [DOC: 9194055] ℹ️  DOB normalized: 02/21/1933
[18:01:42] [DOC: 9194055] ℹ️  Episode startOfCare normalized: 03/19/2025
[18:01:42] [DOC: 9194055] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[18:01:42] [DOC: 9194055] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[18:01:42] [DOC: 9194055] ✅ Patient date processing completed successfully
[18:01:42] ✅    ✅ Date processing completed
[18:01:42] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Nunes
     └─ dob: 02/21/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2796046
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:01:42] 🔄 
🔄 Step 4: Extracting order data...
[18:01:44] ℹ️  Order extraction - MRN: '2796046'
[18:01:44] ℹ️  Order extraction - Sex: 'FEMALE'
[18:01:44] ℹ️  Order extraction - Service Line: 'Nursing'
[18:01:44] ℹ️  Order extraction - Payer Source: ''
[18:01:44] ✅ Order data extraction completed successfully
[18:01:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:44] ℹ️  Using MRN from patient data: '2796046' over '2796046'
[18:01:44] ℹ️  Combined service lines: Patient='Hospice' + Order='Nursing' = 'Hospice, Nursing'
[18:01:44] ✅ Patient name cross-validation successful
[18:01:44] ✅    ✅ Data merged successfully
[18:01:45] ✅    ✅ Order data extracted and validated
[18:01:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:51] [DOC: 9194055] ✅ Patient exists in API: Betty Nunes, ID: 4b03624c-2fcd-456b-a080-3d1ced8d722b
[18:01:51] ✅    ✅ Existing patient found with ID: 4b03624c-2fcd-456b-a080-3d1ced8d722b
[18:01:51] 🔄 
🔄 Step 6: Pushing order to API...
[18:01:51] [DOC: 9194055] ℹ️  Pushing order via API for patient ID: 4b03624c-2fcd-456b-a080-3d1ced8d722b
[18:01:52] [DOC: 9194055] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12928"}
[18:01:52] ❌    ❌ Failed to push order
[18:01:52] 🔄 
🔄 Step 7: Writing to CSV...
[18:01:52] [DOC: 9194055] ℹ️  Calculated age: 92 from DOB: 02/21/1933
[18:01:52] [DOC: 9194055] ℹ️  Service Line extracted: 'Hospice, Nursing'
[18:01:52] [DOC: 9194055] ℹ️  Payer Source extracted: ''
[18:01:52] [DOC: 9194055] ℹ️  Diagnosis codes being written:
[18:01:52] [DOC: 9194055] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.90'
[18:01:52] [DOC: 9194055] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:01:52] [DOC: 9194055] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:01:52] [DOC: 9194055] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:01:52] [DOC: 9194055] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:01:52] [DOC: 9194055] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:01:52] [DOC: 9194055] ✅ Patient data written to CSV: Betty Nunes | Sex: FEMALE | Age: 92 | Service: Hospice, Nursing | Payer:  | MRN: 2796046
[18:01:52] ✅    ✅ Document 9194055 processed and saved successfully
[18:01:52] 🔄 
🔄 Step 8: Saving API details...
[18:01:52] [DOC: 9194055] ℹ️  API push details saved for document 9194055
[18:01:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194046                         ║
================================================================================
[18:01:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:01:52] ℹ️  Date: 03/20/2025
[18:01:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:53] [DOC: 9194046] ✅ Text extracted using pdfplumber (1020 chars)
[18:01:53] ✅    ✅ Text extracted using pdfplumber (1020 chars)
[18:01:53] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:56] ℹ️  AI extracted raw sex value: 'F'
[18:01:56] ℹ️  AI extracted service line: 'Physical Therapy'
[18:01:56] ℹ️  AI extracted payer source: ''
[18:01:56] ℹ️  AI extracted diagnoses:
[18:01:56] ℹ️    - Diagnosis 1: 'None'
[18:01:56] ℹ️    - Diagnosis 2: 'None'
[18:01:56] ℹ️    - Diagnosis 3: 'None'
[18:01:56] ℹ️    - Diagnosis 4: 'None'
[18:01:56] ℹ️    - Diagnosis 5: 'None'
[18:01:56] ℹ️    - Diagnosis 6: 'None'
[18:01:56] ℹ️  Final extracted MRN: '2794259'
[18:01:56] ℹ️  Final extracted Sex: 'FEMALE'
[18:01:56] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:01:56] ℹ️  Final extracted Payer Source: ''
[18:01:56] ✅ Patient data extraction completed successfully
[18:01:56] ✅    ✅ Patient data extracted successfully
[18:01:56] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:01:56] ✅    ✅ Patient identified: Joyce Normandin
[18:01:56] ✅    ✅ Patient name validation passed
[18:01:56] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:56] [DOC: 9194046] ℹ️  DOB normalized: 09/26/1950
[18:01:56] [DOC: 9194046] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[18:01:56] [DOC: 9194046] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[18:01:56] [DOC: 9194046] ✅ Patient date processing completed successfully
[18:01:56] ✅    ✅ Date processing completed
[18:01:56] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025'}]
[18:01:56] 🔄 
🔄 Step 4: Extracting order data...
[18:01:58] ℹ️  Order extraction - MRN: '2794259'
[18:01:58] ℹ️  Order extraction - Sex: 'FEMALE'
[18:01:58] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:01:58] ℹ️  Order extraction - Payer Source: ''
[18:01:58] ✅ Order data extraction completed successfully
[18:01:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:58] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[18:01:58] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:01:58] ✅ Patient name cross-validation successful
[18:01:58] ✅    ✅ Data merged successfully
[18:01:59] ✅    ✅ Order data extracted and validated
[18:01:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:59] [DOC: 9194046] ✅ Patient found in local cache: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[18:01:59] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[18:01:59] 🔄 
🔄 Step 6: Pushing order to API...
[18:01:59] [DOC: 9194046] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[18:02:00] [DOC: 9194046] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12923"}
[18:02:00] ❌    ❌ Failed to push order
[18:02:00] 🔄 
🔄 Step 7: Writing to CSV...
[18:02:00] [DOC: 9194046] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[18:02:00] [DOC: 9194046] ℹ️  Service Line extracted: 'Physical Therapy'
[18:02:00] [DOC: 9194046] ℹ️  Payer Source extracted: ''
[18:02:00] [DOC: 9194046] ℹ️  Diagnosis codes being written:
[18:02:00] [DOC: 9194046] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:02:00] [DOC: 9194046] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:02:00] [DOC: 9194046] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:02:00] [DOC: 9194046] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:02:00] [DOC: 9194046] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:02:00] [DOC: 9194046] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:02:00] [DOC: 9194046] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Physical Therapy | Payer:  | MRN: 2794259
[18:02:00] ✅    ✅ Document 9194046 processed and saved successfully
[18:02:00] 🔄 
🔄 Step 8: Saving API details...
[18:02:00] [DOC: 9194046] ℹ️  API push details saved for document 9194046
[18:02:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194043                         ║
================================================================================
[18:02:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:02:00] ℹ️  Date: 03/20/2025
[18:02:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:03] [DOC: 9194043] ✅ Text extracted using pdfplumber (22091 chars)
[18:02:03] ✅    ✅ Text extracted using pdfplumber (22091 chars)
[18:02:03] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:07] ℹ️  AI extracted raw sex value: 'F'
[18:02:07] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide'
[18:02:07] ℹ️  AI extracted payer source: ''
[18:02:07] ℹ️  AI extracted diagnoses:
[18:02:07] ℹ️    - Diagnosis 1: 'I69.393'
[18:02:07] ℹ️    - Diagnosis 2: 'I10'
[18:02:07] ℹ️    - Diagnosis 3: 'I69.322'
[18:02:07] ℹ️    - Diagnosis 4: 'H53.2'
[18:02:07] ℹ️    - Diagnosis 5: 'R41.89'
[18:02:07] ℹ️    - Diagnosis 6: 'E78.2'
[18:02:07] ℹ️  Final extracted MRN: '2794259'
[18:02:07] ℹ️  Final extracted Sex: 'FEMALE'
[18:02:07] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide'
[18:02:07] ℹ️  Final extracted Payer Source: ''
[18:02:07] ✅ Patient data extraction completed successfully
[18:02:07] ✅    ✅ Patient data extracted successfully
[18:02:07] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I69.393', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'H53.2', 'fifthDiagnosis': 'R41.89', 'sixthDiagnosis': 'E78.2'}]
[18:02:07] ✅    ✅ Patient identified: Joyce Normandin
[18:02:07] ✅    ✅ Patient name validation passed
[18:02:07] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:07] [DOC: 9194043] ℹ️  DOB normalized: 09/26/1950
[18:02:07] [DOC: 9194043] ℹ️  Episode startOfCare normalized: 03/07/2025
[18:02:07] [DOC: 9194043] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[18:02:07] [DOC: 9194043] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[18:02:07] [DOC: 9194043] ✅ Patient date processing completed successfully
[18:02:07] ✅    ✅ Date processing completed
[18:02:07] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I69.393', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'H53.2', 'fifthDiagnosis': 'R41.89', 'sixthDiagnosis': 'E78.2'}]
[18:02:07] 🔄 
🔄 Step 4: Extracting order data...
[18:02:10] ℹ️  Order extraction - MRN: '2794259'
[18:02:10] ℹ️  Order extraction - Sex: 'FEMALE'
[18:02:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide'
[18:02:10] ℹ️  Order extraction - Payer Source: ''
[18:02:10] ✅ Order data extraction completed successfully
[18:02:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:10] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[18:02:10] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Home Health Aide' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[18:02:10] ✅ Patient name cross-validation successful
[18:02:10] ✅    ✅ Data merged successfully
[18:02:11] ✅    ✅ Order data extracted and validated
[18:02:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:02:11] [DOC: 9194043] ✅ Patient found in local cache: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[18:02:11] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[18:02:11] 🔄 
🔄 Step 6: Pushing order to API...
[18:02:11] [DOC: 9194043] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[18:02:12] [DOC: 9194043] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12924"}
[18:02:12] ❌    ❌ Failed to push order
[18:02:12] 🔄 
🔄 Step 7: Writing to CSV...
[18:02:12] [DOC: 9194043] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[18:02:12] [DOC: 9194043] ℹ️  Service Line extracted: 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[18:02:12] [DOC: 9194043] ℹ️  Payer Source extracted: ''
[18:02:12] [DOC: 9194043] ℹ️  Diagnosis codes being written:
[18:02:12] [DOC: 9194043] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.393'
[18:02:12] [DOC: 9194043] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[18:02:12] [DOC: 9194043] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[18:02:12] [DOC: 9194043] ℹ️    - Latest_Episode_Fourthdiagnosis: 'H53.2'
[18:02:12] [DOC: 9194043] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R41.89'
[18:02:12] [DOC: 9194043] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.2'
[18:02:12] [DOC: 9194043] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology | Payer:  | MRN: 2794259
[18:02:12] ✅    ✅ Document 9194043 processed and saved successfully
[18:02:12] 🔄 
🔄 Step 8: Saving API details...
[18:02:12] [DOC: 9194043] ℹ️  API push details saved for document 9194043
[18:02:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194037                         ║
================================================================================
[18:02:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:02:12] ℹ️  Date: 03/20/2025
[18:02:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:14] [DOC: 9194037] ✅ Text extracted using pdfplumber (1714 chars)
[18:02:14] ✅    ✅ Text extracted using pdfplumber (1714 chars)
[18:02:14] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:16] ℹ️  AI extracted raw sex value: 'M'
[18:02:16] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[18:02:16] ℹ️  AI extracted payer source: ''
[18:02:16] ℹ️  AI extracted diagnoses:
[18:02:16] ℹ️    - Diagnosis 1: ''
[18:02:16] ℹ️    - Diagnosis 2: ''
[18:02:16] ℹ️    - Diagnosis 3: ''
[18:02:16] ℹ️    - Diagnosis 4: ''
[18:02:16] ℹ️    - Diagnosis 5: ''
[18:02:16] ℹ️    - Diagnosis 6: ''
[18:02:16] ℹ️  Final extracted MRN: '2773750'
[18:02:16] ℹ️  Final extracted Sex: 'MALE'
[18:02:16] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[18:02:16] ℹ️  Final extracted Payer Source: ''
[18:02:16] ✅ Patient data extraction completed successfully
[18:02:16] ✅    ✅ Patient data extracted successfully
[18:02:16] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:16] ✅    ✅ Patient identified: Luis Mota
[18:02:16] ✅    ✅ Patient name validation passed
[18:02:16] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:16] [DOC: 9194037] ℹ️  DOB normalized: 12/02/1942
[18:02:16] [DOC: 9194037] ✅ Patient date processing completed successfully
[18:02:16] ✅    ✅ Date processing completed
[18:02:16] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:16] 🔄 
🔄 Step 4: Extracting order data...
[18:02:19] ℹ️  Order extraction - MRN: '2773750'
[18:02:19] ℹ️  Order extraction - Sex: 'MALE'
[18:02:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[18:02:19] ℹ️  Order extraction - Payer Source: ''
[18:02:19] ✅ Order data extraction completed successfully
[18:02:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:19] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[18:02:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[18:02:19] ✅ Patient name cross-validation successful
[18:02:19] ✅    ✅ Data merged successfully
[18:02:20] ✅    ✅ Order data extracted and validated
[18:02:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:02:27] [DOC: 9194037] ℹ️  Patient not found in cache or API: Luis Mota
[18:02:27] [DOC: 9194037] ℹ️  Patient not found, creating new patient via API...
[18:02:27] [DOC: 9194037] ℹ️  Creating patient via API: Luis Mota
[18:02:29] [DOC: 9194037] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:02:29] ❌    ❌ Failed to create patient
[18:02:29] [DOC: 9194037] ℹ️  API push details saved for document 9194037
================================================================================
║                        Processing Document ID: 9194034                         ║
================================================================================
[18:02:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:02:29] ℹ️  Date: 03/20/2025
[18:02:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:30] [DOC: 9194034] ✅ Text extracted using pdfplumber (1299 chars)
[18:02:30] ✅    ✅ Text extracted using pdfplumber (1299 chars)
[18:02:30] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:32] ℹ️  AI extracted raw sex value: 'F'
[18:02:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:02:32] ℹ️  AI extracted payer source: ''
[18:02:32] ℹ️  AI extracted diagnoses:
[18:02:32] ℹ️    - Diagnosis 1: ''
[18:02:32] ℹ️    - Diagnosis 2: ''
[18:02:32] ℹ️    - Diagnosis 3: ''
[18:02:32] ℹ️    - Diagnosis 4: ''
[18:02:32] ℹ️    - Diagnosis 5: ''
[18:02:32] ℹ️    - Diagnosis 6: ''
[18:02:32] ℹ️  Final extracted MRN: '2737072'
[18:02:32] ℹ️  Final extracted Sex: 'FEMALE'
[18:02:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:02:32] ℹ️  Final extracted Payer Source: ''
[18:02:32] ✅ Patient data extraction completed successfully
[18:02:32] ✅    ✅ Patient data extracted successfully
[18:02:32] 📊 Patient Response
     └─ patientFName: Mary L
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:32] ✅    ✅ Patient identified: Mary L Melancon
[18:02:32] ✅    ✅ Patient name validation passed
[18:02:32] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:32] [DOC: 9194034] ℹ️  DOB normalized: 08/02/1934
[18:02:32] [DOC: 9194034] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[18:02:32] [DOC: 9194034] ✅ Patient date processing completed successfully
[18:02:32] ✅    ✅ Date processing completed
[18:02:32] 📊 Processed Patient Data
     └─ patientFName: Mary L
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:32] 🔄 
🔄 Step 4: Extracting order data...
[18:02:35] ℹ️  Order extraction - MRN: '2737072'
[18:02:35] ℹ️  Order extraction - Sex: 'FEMALE'
[18:02:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:02:35] ℹ️  Order extraction - Payer Source: ''
[18:02:35] ✅ Order data extraction completed successfully
[18:02:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:35] ℹ️  Using MRN from patient data: '2737072' over '2737072'
[18:02:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:02:35] ✅ Patient name cross-validation successful
[18:02:35] ✅    ✅ Data merged successfully
[18:02:36] ✅    ✅ Order data extracted and validated
[18:02:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:02:41] [DOC: 9194034] ℹ️  Patient not found in cache or API: Mary L Melancon
[18:02:41] [DOC: 9194034] ℹ️  Patient not found, creating new patient via API...
[18:02:41] [DOC: 9194034] ℹ️  Creating patient via API: Mary L Melancon
[18:02:42] [DOC: 9194034] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:02:42] ❌    ❌ Failed to create patient
[18:02:42] [DOC: 9194034] ℹ️  API push details saved for document 9194034
================================================================================
║                        Processing Document ID: 9194031                         ║
================================================================================
[18:02:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:02:42] ℹ️  Date: 03/20/2025
[18:02:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:44] [DOC: 9194031] ✅ Text extracted using pdfplumber (1547 chars)
[18:02:44] ✅    ✅ Text extracted using pdfplumber (1547 chars)
[18:02:44] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:46] ℹ️  AI extracted raw sex value: 'M'
[18:02:46] ℹ️  AI extracted service line: 'RN'
[18:02:46] ℹ️  AI extracted payer source: ''
[18:02:46] ℹ️  AI extracted diagnoses:
[18:02:46] ℹ️    - Diagnosis 1: ''
[18:02:46] ℹ️    - Diagnosis 2: ''
[18:02:46] ℹ️    - Diagnosis 3: ''
[18:02:46] ℹ️    - Diagnosis 4: ''
[18:02:46] ℹ️    - Diagnosis 5: ''
[18:02:46] ℹ️    - Diagnosis 6: ''
[18:02:46] ℹ️  Final extracted MRN: '2679776'
[18:02:46] ℹ️  Final extracted Sex: 'MALE'
[18:02:46] ℹ️  Final extracted Service Line: 'RN'
[18:02:46] ℹ️  Final extracted Payer Source: ''
[18:02:46] ✅ Patient data extraction completed successfully
[18:02:46] ✅    ✅ Patient data extracted successfully
[18:02:46] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:46] ✅    ✅ Patient identified: Milton MacDonald
[18:02:46] ✅    ✅ Patient name validation passed
[18:02:46] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:46] [DOC: 9194031] ℹ️  DOB normalized: 03/20/1939
[18:02:46] [DOC: 9194031] ✅ Patient date processing completed successfully
[18:02:46] ✅    ✅ Date processing completed
[18:02:46] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:46] 🔄 
🔄 Step 4: Extracting order data...
[18:02:49] ℹ️  Order extraction - MRN: '2679776'
[18:02:49] ℹ️  Order extraction - Sex: 'MALE'
[18:02:49] ℹ️  Order extraction - Service Line: ''
[18:02:49] ℹ️  Order extraction - Payer Source: ''
[18:02:49] ✅ Order data extraction completed successfully
[18:02:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:49] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[18:02:49] ℹ️  Using service line from patient data: 'RN'
[18:02:49] ✅ Patient name cross-validation successful
[18:02:49] ✅    ✅ Data merged successfully
[18:02:50] ✅    ✅ Order data extracted and validated
[18:02:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:02:50] [DOC: 9194031] ✅ Patient found in local cache: Milton MacDonald, ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:02:50] ✅    ✅ Existing patient found with ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:02:50] 🔄 
🔄 Step 6: Pushing order to API...
[18:02:50] [DOC: 9194031] ℹ️  Pushing order via API for patient ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:02:52] [DOC: 9194031] ❌ Order push failed with status 201: {"id":"68fb535a-de90-45c4-a181-2c1e8f108493","orderWAVId":"ORD20081","orderNo":"1072346, 1072347, 1072348, 1072349, 1072350","orderDate":"03/19/2025","startOfCare":"01/16/2025","episodeStartDate":"01/16/2025","episodeEndDate":"03/16/2025","documentID":"9194031","mrn":"2679776","patientName":"MacDonald,Milton M","sentToPhysicianDate":"03/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/28/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Reported Medications","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"7aac5721-c2a3-4529-a771-b4ad8c6af027","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:02:52] ❌    ❌ Failed to push order
[18:02:52] 🔄 
🔄 Step 7: Writing to CSV...
[18:02:52] [DOC: 9194031] ℹ️  Calculated age: 86 from DOB: 03/20/1939
[18:02:52] [DOC: 9194031] ℹ️  Service Line extracted: 'RN'
[18:02:52] [DOC: 9194031] ℹ️  Payer Source extracted: ''
[18:02:52] [DOC: 9194031] ℹ️  Diagnosis codes being written:
[18:02:52] [DOC: 9194031] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:02:52] [DOC: 9194031] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:02:52] [DOC: 9194031] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:02:52] [DOC: 9194031] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:02:52] [DOC: 9194031] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:02:52] [DOC: 9194031] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:02:52] [DOC: 9194031] ✅ Patient data written to CSV: Milton MacDonald | Sex: MALE | Age: 86 | Service: RN | Payer:  | MRN: 2679776
[18:02:52] ✅    ✅ Document 9194031 processed and saved successfully
[18:02:52] 🔄 
🔄 Step 8: Saving API details...
[18:02:52] [DOC: 9194031] ℹ️  API push details saved for document 9194031
[18:02:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194027                         ║
================================================================================
[18:02:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:02:52] ℹ️  Date: 03/20/2025
[18:02:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:53] [DOC: 9194027] ✅ Text extracted using pdfplumber (1063 chars)
[18:02:53] ✅    ✅ Text extracted using pdfplumber (1063 chars)
[18:02:53] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:56] ℹ️  AI extracted raw sex value: 'M'
[18:02:56] ℹ️  AI extracted service line: 'Physical Therapy'
[18:02:56] ℹ️  AI extracted payer source: ''
[18:02:56] ℹ️  AI extracted diagnoses:
[18:02:56] ℹ️    - Diagnosis 1: ''
[18:02:56] ℹ️    - Diagnosis 2: ''
[18:02:56] ℹ️    - Diagnosis 3: ''
[18:02:56] ℹ️    - Diagnosis 4: ''
[18:02:56] ℹ️    - Diagnosis 5: ''
[18:02:56] ℹ️    - Diagnosis 6: ''
[18:02:56] ℹ️  Final extracted MRN: '2648815'
[18:02:56] ℹ️  Final extracted Sex: 'MALE'
[18:02:56] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:02:56] ℹ️  Final extracted Payer Source: ''
[18:02:56] ✅ Patient data extraction completed successfully
[18:02:56] ✅    ✅ Patient data extracted successfully
[18:02:56] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:56] ✅    ✅ Patient identified: Robert Ledoux
[18:02:56] ✅    ✅ Patient name validation passed
[18:02:56] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:56] [DOC: 9194027] ℹ️  DOB normalized: 04/07/1968
[18:02:56] [DOC: 9194027] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[18:02:56] [DOC: 9194027] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[18:02:56] [DOC: 9194027] ✅ Patient date processing completed successfully
[18:02:56] ✅    ✅ Date processing completed
[18:02:56] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:56] 🔄 
🔄 Step 4: Extracting order data...
[18:02:58] ℹ️  Order extraction - MRN: '2648815'
[18:02:58] ℹ️  Order extraction - Sex: 'MALE'
[18:02:58] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:02:58] ℹ️  Order extraction - Payer Source: ''
[18:02:58] ✅ Order data extraction completed successfully
[18:02:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:58] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[18:02:58] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:02:58] ✅ Patient name cross-validation successful
[18:02:58] ✅    ✅ Data merged successfully
[18:03:00] ✅    ✅ Order data extracted and validated
[18:03:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:05] [DOC: 9194027] ℹ️  Patient not found in cache or API: Robert Ledoux
[18:03:05] [DOC: 9194027] ℹ️  Patient not found, creating new patient via API...
[18:03:05] [DOC: 9194027] ℹ️  Creating patient via API: Robert Ledoux
[18:03:06] [DOC: 9194027] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:03:06] ❌    ❌ Failed to create patient
[18:03:06] [DOC: 9194027] ℹ️  API push details saved for document 9194027
================================================================================
║                        Processing Document ID: 9194022                         ║
================================================================================
[18:03:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:06] ℹ️  Date: 03/20/2025
[18:03:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:10] [DOC: 9194022] ✅ Text extracted using pdfplumber (22838 chars)
[18:03:10] ✅    ✅ Text extracted using pdfplumber (22838 chars)
[18:03:10] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:13] ℹ️  AI extracted raw sex value: 'M'
[18:03:13] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[18:03:13] ℹ️  AI extracted payer source: ''
[18:03:13] ℹ️  AI extracted diagnoses:
[18:03:13] ℹ️    - Diagnosis 1: 'Z47.89'
[18:03:13] ℹ️    - Diagnosis 2: 'M17.12'
[18:03:13] ℹ️    - Diagnosis 3: 'J44.1'
[18:03:13] ℹ️    - Diagnosis 4: 'I12.9'
[18:03:13] ℹ️    - Diagnosis 5: 'E11.22'
[18:03:13] ℹ️    - Diagnosis 6: 'N18.30'
[18:03:13] ℹ️  Final extracted MRN: '2648815'
[18:03:13] ℹ️  Final extracted Sex: 'MALE'
[18:03:13] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[18:03:13] ℹ️  Final extracted Payer Source: ''
[18:03:13] ✅ Patient data extraction completed successfully
[18:03:13] ✅    ✅ Patient data extracted successfully
[18:03:13] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M17.12', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[18:03:13] ✅    ✅ Patient identified: Robert Ledoux
[18:03:13] ✅    ✅ Patient name validation passed
[18:03:13] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:13] [DOC: 9194022] ℹ️  DOB normalized: 04/07/1968
[18:03:13] [DOC: 9194022] ℹ️  Episode startOfCare normalized: 03/08/2025
[18:03:13] [DOC: 9194022] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[18:03:13] [DOC: 9194022] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[18:03:13] [DOC: 9194022] ✅ Patient date processing completed successfully
[18:03:13] ✅    ✅ Date processing completed
[18:03:13] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M17.12', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[18:03:13] 🔄 
🔄 Step 4: Extracting order data...
[18:03:16] ℹ️  Order extraction - MRN: '2648815'
[18:03:16] ℹ️  Order extraction - Sex: 'MALE'
[18:03:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:03:16] ℹ️  Order extraction - Payer Source: ''
[18:03:16] ✅ Order data extraction completed successfully
[18:03:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:16] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[18:03:16] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[18:03:16] ✅ Patient name cross-validation successful
[18:03:16] ✅    ✅ Data merged successfully
[18:03:17] ✅    ✅ Order data extracted and validated
[18:03:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:22] [DOC: 9194022] ℹ️  Patient not found in cache or API: Robert Ledoux
[18:03:22] [DOC: 9194022] ℹ️  Patient not found, creating new patient via API...
[18:03:22] [DOC: 9194022] ℹ️  Creating patient via API: Robert Ledoux
[18:03:23] [DOC: 9194022] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:03:23] ❌    ❌ Failed to create patient
[18:03:23] [DOC: 9194022] ℹ️  API push details saved for document 9194022
================================================================================
║                        Processing Document ID: 9194018                         ║
================================================================================
[18:03:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:23] ℹ️  Date: 03/20/2025
[18:03:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:24] [DOC: 9194018] ✅ Text extracted using pdfplumber (1064 chars)
[18:03:24] ✅    ✅ Text extracted using pdfplumber (1064 chars)
[18:03:24] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:27] ℹ️  AI extracted raw sex value: 'F'
[18:03:27] ℹ️  AI extracted service line: 'Physical Therapy'
[18:03:27] ℹ️  AI extracted payer source: ''
[18:03:27] ℹ️  AI extracted diagnoses:
[18:03:27] ℹ️    - Diagnosis 1: ''
[18:03:27] ℹ️    - Diagnosis 2: ''
[18:03:27] ℹ️    - Diagnosis 3: ''
[18:03:27] ℹ️    - Diagnosis 4: ''
[18:03:27] ℹ️    - Diagnosis 5: ''
[18:03:27] ℹ️    - Diagnosis 6: ''
[18:03:27] ℹ️  Final extracted MRN: '2104551'
[18:03:27] ℹ️  Final extracted Sex: 'FEMALE'
[18:03:27] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:03:27] ℹ️  Final extracted Payer Source: ''
[18:03:27] ✅ Patient data extraction completed successfully
[18:03:27] ✅    ✅ Patient data extracted successfully
[18:03:27] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: Keough
     └─ dob: 06/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104551
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:03:27] ✅    ✅ Patient identified: Jacqueline Keough
[18:03:27] ✅    ✅ Patient name validation passed
[18:03:27] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:27] [DOC: 9194018] ℹ️  DOB normalized: 06/29/1942
[18:03:27] [DOC: 9194018] ✅ Patient date processing completed successfully
[18:03:27] ✅    ✅ Date processing completed
[18:03:27] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: Keough
     └─ dob: 06/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2104551
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:03:27] 🔄 
🔄 Step 4: Extracting order data...
[18:03:29] ℹ️  Order extraction - MRN: '2104551'
[18:03:29] ℹ️  Order extraction - Sex: 'FEMALE'
[18:03:29] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:03:29] ℹ️  Order extraction - Payer Source: ''
[18:03:29] ✅ Order data extraction completed successfully
[18:03:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:29] ℹ️  Using MRN from patient data: '2104551' over '2104551'
[18:03:29] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:03:29] ✅ Patient name cross-validation successful
[18:03:29] ✅    ✅ Data merged successfully
[18:03:30] ✅    ✅ Order data extracted and validated
[18:03:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:41] [DOC: 9194018] ✅ Patient exists in API: Jacqueline Keough, ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[18:03:41] ✅    ✅ Existing patient found with ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[18:03:41] 🔄 
🔄 Step 6: Pushing order to API...
[18:03:41] [DOC: 9194018] ℹ️  Pushing order via API for patient ID: 5eac2869-a8f6-401b-81e0-29cd9355068f
[18:03:42] [DOC: 9194018] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13102"}
[18:03:42] ❌    ❌ Failed to push order
[18:03:42] 🔄 
🔄 Step 7: Writing to CSV...
[18:03:42] [DOC: 9194018] ℹ️  Calculated age: 82 from DOB: 06/29/1942
[18:03:42] [DOC: 9194018] ℹ️  Service Line extracted: 'Physical Therapy'
[18:03:42] [DOC: 9194018] ℹ️  Payer Source extracted: ''
[18:03:42] [DOC: 9194018] ℹ️  Diagnosis codes being written:
[18:03:42] [DOC: 9194018] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:03:42] [DOC: 9194018] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:03:42] [DOC: 9194018] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:03:42] [DOC: 9194018] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:03:42] [DOC: 9194018] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:03:42] [DOC: 9194018] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:03:42] [DOC: 9194018] ✅ Patient data written to CSV: Jacqueline Keough | Sex: FEMALE | Age: 82 | Service: Physical Therapy | Payer:  | MRN: 2104551
[18:03:42] ✅    ✅ Document 9194018 processed and saved successfully
[18:03:42] 🔄 
🔄 Step 8: Saving API details...
[18:03:42] [DOC: 9194018] ℹ️  API push details saved for document 9194018
[18:03:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9194015                         ║
================================================================================
[18:03:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:42] ℹ️  Date: 03/20/2025
[18:03:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:44] [DOC: 9194015] ✅ Text extracted using pdfplumber (1186 chars)
[18:03:44] ✅    ✅ Text extracted using pdfplumber (1186 chars)
[18:03:44] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:47] ℹ️  AI extracted raw sex value: 'F'
[18:03:47] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:03:47] ℹ️  AI extracted payer source: ''
[18:03:47] ℹ️  AI extracted diagnoses:
[18:03:47] ℹ️    - Diagnosis 1: 'None'
[18:03:47] ℹ️    - Diagnosis 2: 'None'
[18:03:47] ℹ️    - Diagnosis 3: 'None'
[18:03:47] ℹ️    - Diagnosis 4: 'None'
[18:03:47] ℹ️    - Diagnosis 5: 'None'
[18:03:47] ℹ️    - Diagnosis 6: 'None'
[18:03:47] ℹ️  Final extracted MRN: '2530633'
[18:03:47] ℹ️  Final extracted Sex: 'FEMALE'
[18:03:47] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:03:47] ℹ️  Final extracted Payer Source: ''
[18:03:47] ✅ Patient data extraction completed successfully
[18:03:47] ✅    ✅ Patient data extracted successfully
[18:03:47] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Goulart
     └─ dob: 06/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2530633
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:03:47] ✅    ✅ Patient identified: Beverly Goulart
[18:03:47] ✅    ✅ Patient name validation passed
[18:03:47] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:47] [DOC: 9194015] ℹ️  DOB normalized: 06/08/1936
[18:03:47] [DOC: 9194015] ✅ Patient date processing completed successfully
[18:03:47] ✅    ✅ Date processing completed
[18:03:47] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Goulart
     └─ dob: 06/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2530633
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[18:03:47] 🔄 
🔄 Step 4: Extracting order data...
[18:03:49] ℹ️  Order extraction - MRN: '2530633'
[18:03:49] ℹ️  Order extraction - Sex: 'FEMALE'
[18:03:49] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:03:49] ℹ️  Order extraction - Payer Source: ''
[18:03:49] ✅ Order data extraction completed successfully
[18:03:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:49] ℹ️  Using MRN from patient data: '2530633' over '2530633'
[18:03:49] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:03:49] ✅ Patient name cross-validation successful
[18:03:49] ✅    ✅ Data merged successfully
[18:03:50] ✅    ✅ Order data extracted and validated
[18:03:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:58] [DOC: 9194015] ℹ️  Patient not found in cache or API: Beverly Goulart
[18:03:58] [DOC: 9194015] ℹ️  Patient not found, creating new patient via API...
[18:03:58] [DOC: 9194015] ℹ️  Creating patient via API: Beverly Goulart
[18:03:59] [DOC: 9194015] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:03:59] ❌    ❌ Failed to create patient
[18:03:59] [DOC: 9194015] ℹ️  API push details saved for document 9194015
================================================================================
║                        Processing Document ID: 9194001                         ║
================================================================================
[18:03:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:59] ℹ️  Date: 03/20/2025
[18:03:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:02] [DOC: 9194001] ✅ Text extracted using pdfplumber (14341 chars)
[18:04:02] ✅    ✅ Text extracted using pdfplumber (14341 chars)
[18:04:02] 🔄 
🔄 Step 2: Extracting patient data...
[18:04:05] ℹ️  AI extracted raw sex value: 'F'
[18:04:05] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[18:04:05] ℹ️  AI extracted payer source: ''
[18:04:05] ℹ️  AI extracted diagnoses:
[18:04:05] ℹ️    - Diagnosis 1: 'I26.99'
[18:04:05] ℹ️    - Diagnosis 2: 'I10'
[18:04:05] ℹ️    - Diagnosis 3: 'J10.1'
[18:04:05] ℹ️    - Diagnosis 4: 'E78.00'
[18:04:05] ℹ️    - Diagnosis 5: 'R91.1'
[18:04:05] ℹ️    - Diagnosis 6: 'Z79.01'
[18:04:05] ℹ️  Final extracted MRN: '2459108'
[18:04:05] ℹ️  Final extracted Sex: 'FEMALE'
[18:04:05] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[18:04:05] ℹ️  Final extracted Payer Source: ''
[18:04:05] ✅ Patient data extraction completed successfully
[18:04:05] ✅    ✅ Patient data extracted successfully
[18:04:05] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: Feener
     └─ dob: 09/28/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2459108
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'J10.1', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'R91.1', 'sixthDiagnosis': 'Z79.01'}]
[18:04:05] ✅    ✅ Patient identified: Jacqueline Feener
[18:04:05] ✅    ✅ Patient name validation passed
[18:04:05] 🔄 
🔄 Step 3: Processing patient dates...
[18:04:05] [DOC: 9194001] ℹ️  DOB normalized: 09/28/1944
[18:04:05] [DOC: 9194001] ℹ️  Episode startOfCare normalized: 03/04/2025
[18:04:05] [DOC: 9194001] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[18:04:05] [DOC: 9194001] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[18:04:05] [DOC: 9194001] ✅ Patient date processing completed successfully
[18:04:05] ✅    ✅ Date processing completed
[18:04:05] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: Feener
     └─ dob: 09/28/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2459108
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/04/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'J10.1', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'R91.1', 'sixthDiagnosis': 'Z79.01'}]
[18:04:05] 🔄 
🔄 Step 4: Extracting order data...
[18:04:08] ℹ️  Order extraction - MRN: '2459108'
[18:04:08] ℹ️  Order extraction - Sex: 'FEMALE'
[18:04:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[18:04:08] ℹ️  Order extraction - Payer Source: ''
[18:04:08] ✅ Order data extraction completed successfully
[18:04:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:04:08] ℹ️  Using MRN from patient data: '2459108' over '2459108'
[18:04:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[18:04:08] ✅ Patient name cross-validation successful
[18:04:08] ✅    ✅ Data merged successfully
[18:04:09] ✅    ✅ Order data extracted and validated
[18:04:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:04:16] [DOC: 9194001] ℹ️  Patient not found in cache or API: Jacqueline Feener
[18:04:16] [DOC: 9194001] ℹ️  Patient not found, creating new patient via API...
[18:04:16] [DOC: 9194001] ℹ️  Creating patient via API: Jacqueline Feener
[18:04:17] [DOC: 9194001] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:04:17] ❌    ❌ Failed to create patient
[18:04:17] [DOC: 9194001] ℹ️  API push details saved for document 9194001
================================================================================
║                        Processing Document ID: 9193996                         ║
================================================================================
[18:04:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:04:17] ℹ️  Date: 03/20/2025
[18:04:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:20] [DOC: 9193996] ✅ Text extracted using pdfplumber (18351 chars)
[18:04:20] ✅    ✅ Text extracted using pdfplumber (18351 chars)
[18:04:20] 🔄 
🔄 Step 2: Extracting patient data...
[18:04:23] ℹ️  AI extracted raw sex value: 'M'
[18:04:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:04:23] ℹ️  AI extracted payer source: ''
[18:04:23] ℹ️  AI extracted diagnoses:
[18:04:23] ℹ️    - Diagnosis 1: 'I11.0'
[18:04:23] ℹ️    - Diagnosis 2: 'I50.23'
[18:04:23] ℹ️    - Diagnosis 3: 'E11.29'
[18:04:23] ℹ️    - Diagnosis 4: 'D50.0'
[18:04:23] ℹ️    - Diagnosis 5: 'E11.51'
[18:04:23] ℹ️    - Diagnosis 6: 'I25.10'
[18:04:23] ℹ️  Final extracted MRN: '2106160'
[18:04:23] ℹ️  Final extracted Sex: 'MALE'
[18:04:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:04:23] ℹ️  Final extracted Payer Source: ''
[18:04:23] ✅ Patient data extraction completed successfully
[18:04:23] ✅    ✅ Patient data extracted successfully
[18:04:23] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Demello
     └─ dob: 03/22/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 2106160
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'E11.29', 'fourthDiagnosis': 'D50.0', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'I25.10'}]
[18:04:23] ✅    ✅ Patient identified: Manuel Demello
[18:04:23] ✅    ✅ Patient name validation passed
[18:04:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:04:23] [DOC: 9193996] ℹ️  DOB normalized: 03/22/1945
[18:04:23] [DOC: 9193996] ℹ️  Episode startOfCare normalized: 03/09/2025
[18:04:23] [DOC: 9193996] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[18:04:23] [DOC: 9193996] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[18:04:23] [DOC: 9193996] ✅ Patient date processing completed successfully
[18:04:23] ✅    ✅ Date processing completed
[18:04:23] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Demello
     └─ dob: 03/22/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 2106160
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'E11.29', 'fourthDiagnosis': 'D50.0', 'fifthDiagnosis': 'E11.51', 'sixthDiagnosis': 'I25.10'}]
[18:04:23] 🔄 
🔄 Step 4: Extracting order data...
[18:04:26] ℹ️  Order extraction - MRN: '2106160'
[18:04:26] ℹ️  Order extraction - Sex: 'MALE'
[18:04:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:04:26] ℹ️  Order extraction - Payer Source: ''
[18:04:26] ✅ Order data extraction completed successfully
[18:04:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:04:26] ℹ️  Using MRN from patient data: '2106160' over '2106160'
[18:04:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:04:26] ✅ Patient name cross-validation successful
[18:04:26] ✅    ✅ Data merged successfully
[18:04:27] ✅    ✅ Order data extracted and validated
[18:04:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:04:27] [DOC: 9193996] ✅ Patient found in local cache: Manuel Demello, ID: 54784569-a65e-445e-be68-20a38f0b9a63
[18:04:27] ✅    ✅ Existing patient found with ID: 54784569-a65e-445e-be68-20a38f0b9a63
[18:04:27] 🔄 
🔄 Step 6: Pushing order to API...
[18:04:27] [DOC: 9193996] ℹ️  Pushing order via API for patient ID: 54784569-a65e-445e-be68-20a38f0b9a63
[18:04:29] [DOC: 9193996] ❌ Order push failed with status 201: {"id":"cee89287-4b93-4f97-8948-4888537b00c0","orderWAVId":"ORD20082","orderNo":"1072686","orderDate":"03/19/2025","startOfCare":"03/09/2025","episodeStartDate":"03/11/2025","episodeEndDate":"05/09/2025","documentID":"9193996","mrn":"2106160","patientName":"Demello, Manuel Jr.","sentToPhysicianDate":"03/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"03/25/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"54784569-a65e-445e-be68-20a38f0b9a63","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:04:29] ❌    ❌ Failed to push order
[18:04:29] 🔄 
🔄 Step 7: Writing to CSV...
[18:04:29] [DOC: 9193996] ℹ️  Calculated age: 80 from DOB: 03/22/1945
[18:04:29] [DOC: 9193996] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:04:29] [DOC: 9193996] ℹ️  Payer Source extracted: ''
[18:04:29] [DOC: 9193996] ℹ️  Diagnosis codes being written:
[18:04:29] [DOC: 9193996] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:04:29] [DOC: 9193996] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.23'
[18:04:29] [DOC: 9193996] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.29'
[18:04:29] [DOC: 9193996] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.0'
[18:04:29] [DOC: 9193996] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.51'
[18:04:29] [DOC: 9193996] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[18:04:29] [DOC: 9193996] ✅ Patient data written to CSV: Manuel Demello | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: 2106160
[18:04:29] ✅    ✅ Document 9193996 processed and saved successfully
[18:04:29] 🔄 
🔄 Step 8: Saving API details...
[18:04:29] [DOC: 9193996] ℹ️  API push details saved for document 9193996
[18:04:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193994                         ║
================================================================================
[18:04:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:04:29] ℹ️  Date: 03/20/2025
[18:04:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:31] [DOC: 9193994] ✅ Text extracted using pdfplumber (983 chars)
[18:04:31] ✅    ✅ Text extracted using pdfplumber (983 chars)
[18:04:31] 🔄 
🔄 Step 2: Extracting patient data...
[18:04:33] ℹ️  AI extracted raw sex value: 'F'
[18:04:33] ℹ️  AI extracted service line: 'OT'
[18:04:33] ℹ️  AI extracted payer source: ''
[18:04:33] ℹ️  AI extracted diagnoses:
[18:04:33] ℹ️    - Diagnosis 1: ''
[18:04:33] ℹ️    - Diagnosis 2: ''
[18:04:33] ℹ️    - Diagnosis 3: ''
[18:04:33] ℹ️    - Diagnosis 4: ''
[18:04:33] ℹ️    - Diagnosis 5: ''
[18:04:33] ℹ️    - Diagnosis 6: ''
[18:04:33] ℹ️  Final extracted MRN: '2397060'
[18:04:33] ℹ️  Final extracted Sex: 'FEMALE'
[18:04:33] ℹ️  Final extracted Service Line: 'OT'
[18:04:33] ℹ️  Final extracted Payer Source: ''
[18:04:33] ✅ Patient data extraction completed successfully
[18:04:33] ✅    ✅ Patient data extracted successfully
[18:04:33] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Defrias
     └─ dob: 11/25/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2397060
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:04:33] ✅    ✅ Patient identified: Maria Defrias
[18:04:33] ✅    ✅ Patient name validation passed
[18:04:33] 🔄 
🔄 Step 3: Processing patient dates...
[18:04:33] [DOC: 9193994] ℹ️  DOB normalized: 11/25/1941
[18:04:33] [DOC: 9193994] ✅ Patient date processing completed successfully
[18:04:33] ✅    ✅ Date processing completed
[18:04:33] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Defrias
     └─ dob: 11/25/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2397060
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:04:33] 🔄 
🔄 Step 4: Extracting order data...
[18:04:36] ℹ️  Order extraction - MRN: '2397060'
[18:04:36] ℹ️  Order extraction - Sex: 'FEMALE'
[18:04:36] ℹ️  Order extraction - Service Line: ''
[18:04:36] ℹ️  Order extraction - Payer Source: ''
[18:04:36] ✅ Order data extraction completed successfully
[18:04:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:04:36] ℹ️  Using MRN from patient data: '2397060' over '2397060'
[18:04:36] ℹ️  Using service line from patient data: 'OT'
[18:04:36] ✅ Patient name cross-validation successful
[18:04:36] ✅    ✅ Data merged successfully
[18:04:37] ⚠️     ❌ Skipping - missing episode start date
[18:04:37] [DOC: 9193994] ℹ️  API push details saved for document 9193994
================================================================================
║                        Processing Document ID: 9193993                         ║
================================================================================
[18:04:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:04:37] ℹ️  Date: 03/20/2025
[18:04:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:38] [DOC: 9193993] ✅ Text extracted using pdfplumber (1595 chars)
[18:04:38] ✅    ✅ Text extracted using pdfplumber (1595 chars)
[18:04:38] 🔄 
🔄 Step 2: Extracting patient data...
[18:04:41] ℹ️  AI extracted raw sex value: 'F'
[18:04:41] ℹ️  AI extracted service line: 'Medical Social Work'
[18:04:41] ℹ️  AI extracted payer source: ''
[18:04:41] ℹ️  AI extracted diagnoses:
[18:04:41] ℹ️    - Diagnosis 1: ''
[18:04:41] ℹ️    - Diagnosis 2: ''
[18:04:41] ℹ️    - Diagnosis 3: ''
[18:04:41] ℹ️    - Diagnosis 4: ''
[18:04:41] ℹ️    - Diagnosis 5: ''
[18:04:41] ℹ️    - Diagnosis 6: ''
[18:04:41] ℹ️  Final extracted MRN: '2385572'
[18:04:41] ℹ️  Final extracted Sex: 'FEMALE'
[18:04:41] ℹ️  Final extracted Service Line: 'Medical Social Work'
[18:04:41] ℹ️  Final extracted Payer Source: ''
[18:04:41] ✅ Patient data extraction completed successfully
[18:04:41] ✅    ✅ Patient data extracted successfully
[18:04:41] 📊 Patient Response
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:04:41] ✅    ✅ Patient identified: Anneliese Darling
[18:04:41] ✅    ✅ Patient name validation passed
[18:04:41] 🔄 
🔄 Step 3: Processing patient dates...
[18:04:41] [DOC: 9193993] ℹ️  DOB normalized: 10/19/1927
[18:04:41] [DOC: 9193993] ✅ Patient date processing completed successfully
[18:04:41] ✅    ✅ Date processing completed
[18:04:41] 📊 Processed Patient Data
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:04:41] 🔄 
🔄 Step 4: Extracting order data...
[18:04:43] ℹ️  Order extraction - MRN: '2385572'
[18:04:43] ℹ️  Order extraction - Sex: 'FEMALE'
[18:04:43] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[18:04:43] ℹ️  Order extraction - Payer Source: ''
[18:04:43] ✅ Order data extraction completed successfully
[18:04:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:04:43] ℹ️  Using MRN from patient data: '2385572' over '2385572'
[18:04:43] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[18:04:43] ✅ Patient name cross-validation successful
[18:04:43] ✅    ✅ Data merged successfully
[18:04:44] ✅    ✅ Order data extracted and validated
[18:04:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:04:51] [DOC: 9193993] ✅ Patient exists in API: Anneliese Darling, ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:04:51] ✅    ✅ Existing patient found with ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:04:51] 🔄 
🔄 Step 6: Pushing order to API...
[18:04:51] [DOC: 9193993] ℹ️  Pushing order via API for patient ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:04:53] [DOC: 9193993] ❌ Order push failed with status 201: {"id":"d5c4e2a0-33c2-432f-b7a0-f2df3ab3e6d8","orderWAVId":"ORD20083","orderNo":"1072551, 1072620","orderDate":"03/19/2025","startOfCare":"03/19/2025","episodeStartDate":"03/19/2025","episodeEndDate":"06/15/2025","documentID":"9193993","mrn":"2385572","patientName":"Darling,Anneliese","sentToPhysicianDate":"03/20/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/02/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"5b0c8b16-891b-4d6d-ac13-437d5046cd63","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:04:53] ❌    ❌ Failed to push order
[18:04:53] 🔄 
🔄 Step 7: Writing to CSV...
[18:04:53] [DOC: 9193993] ℹ️  Calculated age: 97 from DOB: 10/19/1927
[18:04:53] [DOC: 9193993] ℹ️  Service Line extracted: 'Medical Social Work'
[18:04:53] [DOC: 9193993] ℹ️  Payer Source extracted: ''
[18:04:53] [DOC: 9193993] ℹ️  Diagnosis codes being written:
[18:04:53] [DOC: 9193993] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:04:53] [DOC: 9193993] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:04:53] [DOC: 9193993] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:04:53] [DOC: 9193993] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:04:53] [DOC: 9193993] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:04:53] [DOC: 9193993] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:04:53] [DOC: 9193993] ✅ Patient data written to CSV: Anneliese Darling | Sex: FEMALE | Age: 97 | Service: Medical Social Work | Payer:  | MRN: 2385572
[18:04:53] ✅    ✅ Document 9193993 processed and saved successfully
[18:04:53] 🔄 
🔄 Step 8: Saving API details...
[18:04:53] [DOC: 9193993] ℹ️  API push details saved for document 9193993
[18:04:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193992                         ║
================================================================================
[18:04:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:04:53] ℹ️  Date: 03/20/2025
[18:04:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:57] [DOC: 9193992] ✅ Text extracted using pdfplumber (29116 chars)
[18:04:57] ✅    ✅ Text extracted using pdfplumber (29116 chars)
[18:04:57] 🔄 
🔄 Step 2: Extracting patient data...
[18:05:00] ℹ️  AI extracted raw sex value: 'F'
[18:05:00] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[18:05:00] ℹ️  AI extracted payer source: ''
[18:05:00] ℹ️  AI extracted diagnoses:
[18:05:00] ℹ️    - Diagnosis 1: 'E43'
[18:05:00] ℹ️    - Diagnosis 2: 'S32.592S'
[18:05:00] ℹ️    - Diagnosis 3: 'W19.XXXS'
[18:05:00] ℹ️    - Diagnosis 4: 'J18.9'
[18:05:00] ℹ️    - Diagnosis 5: 'A04.72'
[18:05:00] ℹ️    - Diagnosis 6: 'K59.09'
[18:05:00] ℹ️  Final extracted MRN: '2385572'
[18:05:00] ℹ️  Final extracted Sex: 'FEMALE'
[18:05:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[18:05:00] ℹ️  Final extracted Payer Source: ''
[18:05:00] ✅ Patient data extraction completed successfully
[18:05:00] ✅    ✅ Patient data extracted successfully
[18:05:00] 📊 Patient Response
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[18:05:00] ✅    ✅ Patient identified: Anneliese Darling
[18:05:00] ✅    ✅ Patient name validation passed
[18:05:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:05:00] [DOC: 9193992] ℹ️  DOB normalized: 10/19/1927
[18:05:00] [DOC: 9193992] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[18:05:00] [DOC: 9193992] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[18:05:00] [DOC: 9193992] ✅ Patient date processing completed successfully
[18:05:00] ✅    ✅ Date processing completed
[18:05:00] 📊 Processed Patient Data
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[18:05:00] 🔄 
🔄 Step 4: Extracting order data...
[18:05:03] ℹ️  Order extraction - MRN: '2385572'
[18:05:03] ℹ️  Order extraction - Sex: 'FEMALE'
[18:05:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA, Clergy'
[18:05:03] ℹ️  Order extraction - Payer Source: ''
[18:05:03] ✅ Order data extraction completed successfully
[18:05:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:05:03] ℹ️  Using MRN from patient data: '2385572' over '2385572'
[18:05:03] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, Home Health Aide' + Order='Skilled Nursing, MSW, HHA, Clergy' = 'Clergy, HHA, Home Health Aide, MSW, Skilled Nursing'
[18:05:03] ✅ Patient name cross-validation successful
[18:05:03] ✅    ✅ Data merged successfully
[18:05:04] ✅    ✅ Order data extracted and validated
[18:05:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:05:04] [DOC: 9193992] ✅ Patient found in local cache: Anneliese Darling, ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:05:04] ✅    ✅ Existing patient found with ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:05:04] 🔄 
🔄 Step 6: Pushing order to API...
[18:05:04] [DOC: 9193992] ℹ️  Pushing order via API for patient ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:05:05] [DOC: 9193992] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14628"}
[18:05:05] ❌    ❌ Failed to push order
[18:05:05] 🔄 
🔄 Step 7: Writing to CSV...
[18:05:05] [DOC: 9193992] ℹ️  Calculated age: 97 from DOB: 10/19/1927
[18:05:05] [DOC: 9193992] ℹ️  Service Line extracted: 'Clergy, HHA, Home Health Aide, MSW, Skilled Nursing'
[18:05:05] [DOC: 9193992] ℹ️  Payer Source extracted: ''
[18:05:05] [DOC: 9193992] ℹ️  Diagnosis codes being written:
[18:05:05] [DOC: 9193992] ℹ️    - Latest_Episode_Firstdiagnosis: 'E43'
[18:05:05] [DOC: 9193992] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.592S'
[18:05:05] [DOC: 9193992] ℹ️    - Latest_Episode_Thirddiagnosis: 'W19.XXXS'
[18:05:05] [DOC: 9193992] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J18.9'
[18:05:05] [DOC: 9193992] ℹ️    - Latest_Episode_Fifthdiagnosis: 'A04.72'
[18:05:05] [DOC: 9193992] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.09'
[18:05:05] [DOC: 9193992] ✅ Patient data written to CSV: Anneliese Darling | Sex: FEMALE | Age: 97 | Service: Clergy, HHA, Home Health Aide, MSW, Skilled Nursing | Payer:  | MRN: 2385572
[18:05:05] ✅    ✅ Document 9193992 processed and saved successfully
[18:05:05] 🔄 
🔄 Step 8: Saving API details...
[18:05:05] [DOC: 9193992] ℹ️  API push details saved for document 9193992
[18:05:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193990                         ║
================================================================================
[18:05:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:05:05] ℹ️  Date: 03/20/2025
[18:05:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:05:07] [DOC: 9193990] ✅ Text extracted using pdfplumber (7221 chars)
[18:05:07] ✅    ✅ Text extracted using pdfplumber (7221 chars)
[18:05:07] 🔄 
🔄 Step 2: Extracting patient data...
[18:05:11] ℹ️  AI extracted raw sex value: 'F'
[18:05:11] ℹ️  AI extracted service line: 'Nursing'
[18:05:11] ℹ️  AI extracted payer source: ''
[18:05:11] ℹ️  AI extracted diagnoses:
[18:05:11] ℹ️    - Diagnosis 1: 'E43'
[18:05:11] ℹ️    - Diagnosis 2: 'S32.592S'
[18:05:11] ℹ️    - Diagnosis 3: 'W19.XXXS'
[18:05:11] ℹ️    - Diagnosis 4: 'J18.9'
[18:05:11] ℹ️    - Diagnosis 5: 'A04.72'
[18:05:11] ℹ️    - Diagnosis 6: 'K59.09'
[18:05:11] ℹ️  Final extracted MRN: '2385572'
[18:05:11] ℹ️  Final extracted Sex: 'FEMALE'
[18:05:11] ℹ️  Final extracted Service Line: 'Nursing'
[18:05:11] ℹ️  Final extracted Payer Source: ''
[18:05:11] ✅ Patient data extraction completed successfully
[18:05:11] ✅    ✅ Patient data extracted successfully
[18:05:11] 📊 Patient Response
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[18:05:11] ✅    ✅ Patient identified: Anneliese Darling
[18:05:11] ✅    ✅ Patient name validation passed
[18:05:11] 🔄 
🔄 Step 3: Processing patient dates...
[18:05:11] [DOC: 9193990] ℹ️  DOB normalized: 10/19/1927
[18:05:11] [DOC: 9193990] ℹ️  Episode startOfCare normalized: 03/18/2025
[18:05:11] [DOC: 9193990] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[18:05:11] [DOC: 9193990] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[18:05:11] [DOC: 9193990] ✅ Patient date processing completed successfully
[18:05:11] ✅    ✅ Date processing completed
[18:05:11] 📊 Processed Patient Data
     └─ patientFName: Anneliese
     └─ patientLName: Darling
     └─ dob: 10/19/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2385572
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'S32.592S', 'thirdDiagnosis': 'W19.XXXS', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'A04.72', 'sixthDiagnosis': 'K59.09'}]
[18:05:11] 🔄 
🔄 Step 4: Extracting order data...
[18:05:13] ℹ️  Order extraction - MRN: '2385572'
[18:05:13] ℹ️  Order extraction - Sex: 'FEMALE'
[18:05:13] ℹ️  Order extraction - Service Line: 'Hospice'
[18:05:13] ℹ️  Order extraction - Payer Source: ''
[18:05:13] ✅ Order data extraction completed successfully
[18:05:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:05:13] ℹ️  Using MRN from patient data: '2385572' over '2385572'
[18:05:13] ℹ️  Combined service lines: Patient='Nursing' + Order='Hospice' = 'Hospice, Nursing'
[18:05:13] ✅ Patient name cross-validation successful
[18:05:13] ✅    ✅ Data merged successfully
[18:05:14] ✅    ✅ Order data extracted and validated
[18:05:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:05:14] [DOC: 9193990] ✅ Patient found in local cache: Anneliese Darling, ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:05:14] ✅    ✅ Existing patient found with ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:05:14] 🔄 
🔄 Step 6: Pushing order to API...
[18:05:14] [DOC: 9193990] ℹ️  Pushing order via API for patient ID: 5b0c8b16-891b-4d6d-ac13-437d5046cd63
[18:05:15] [DOC: 9193990] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14629"}
[18:05:15] ❌    ❌ Failed to push order
[18:05:15] 🔄 
🔄 Step 7: Writing to CSV...
[18:05:15] [DOC: 9193990] ℹ️  Calculated age: 97 from DOB: 10/19/1927
[18:05:15] [DOC: 9193990] ℹ️  Service Line extracted: 'Hospice, Nursing'
[18:05:15] [DOC: 9193990] ℹ️  Payer Source extracted: ''
[18:05:15] [DOC: 9193990] ℹ️  Diagnosis codes being written:
[18:05:15] [DOC: 9193990] ℹ️    - Latest_Episode_Firstdiagnosis: 'E43'
[18:05:15] [DOC: 9193990] ℹ️    - Latest_Episode_Seconddiagnosis: 'S32.592S'
[18:05:15] [DOC: 9193990] ℹ️    - Latest_Episode_Thirddiagnosis: 'W19.XXXS'
[18:05:15] [DOC: 9193990] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J18.9'
[18:05:15] [DOC: 9193990] ℹ️    - Latest_Episode_Fifthdiagnosis: 'A04.72'
[18:05:15] [DOC: 9193990] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.09'
[18:05:15] [DOC: 9193990] ✅ Patient data written to CSV: Anneliese Darling | Sex: FEMALE | Age: 97 | Service: Hospice, Nursing | Payer:  | MRN: 2385572
[18:05:15] ✅    ✅ Document 9193990 processed and saved successfully
[18:05:15] 🔄 
🔄 Step 8: Saving API details...
[18:05:15] [DOC: 9193990] ℹ️  API push details saved for document 9193990
[18:05:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193975                         ║
================================================================================
[18:05:15] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:05:15] ℹ️  Date: 03/20/2025
[18:05:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:05:19] [DOC: 9193975] ✅ Text extracted using pdfplumber (27280 chars)
[18:05:19] ✅    ✅ Text extracted using pdfplumber (27280 chars)
[18:05:19] 🔄 
🔄 Step 2: Extracting patient data...
[18:05:22] ℹ️  AI extracted raw sex value: 'F'
[18:05:22] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:05:22] ℹ️  AI extracted payer source: ''
[18:05:22] ℹ️  AI extracted diagnoses:
[18:05:22] ℹ️    - Diagnosis 1: 'K74.69'
[18:05:22] ℹ️    - Diagnosis 2: 'R26.81'
[18:05:22] ℹ️    - Diagnosis 3: 'D61.818'
[18:05:22] ℹ️    - Diagnosis 4: 'I13.0'
[18:05:22] ℹ️    - Diagnosis 5: 'I50.22'
[18:05:22] ℹ️    - Diagnosis 6: 'E11.22'
[18:05:22] ℹ️  Final extracted MRN: '2258674'
[18:05:22] ℹ️  Final extracted Sex: 'FEMALE'
[18:05:22] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:05:22] ℹ️  Final extracted Payer Source: ''
[18:05:22] ✅ Patient data extraction completed successfully
[18:05:22] ✅    ✅ Patient data extracted successfully
[18:05:22] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'D61.818', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.22', 'sixthDiagnosis': 'E11.22'}]
[18:05:22] ✅    ✅ Patient identified: Maryann Boucher
[18:05:22] ✅    ✅ Patient name validation passed
[18:05:22] 🔄 
🔄 Step 3: Processing patient dates...
[18:05:22] [DOC: 9193975] ℹ️  DOB normalized: 03/22/1946
[18:05:22] [DOC: 9193975] ℹ️  Episode startOfCare normalized: 03/10/2025
[18:05:22] [DOC: 9193975] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[18:05:22] [DOC: 9193975] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[18:05:22] [DOC: 9193975] ✅ Patient date processing completed successfully
[18:05:22] ✅    ✅ Date processing completed
[18:05:22] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/10/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': 'K74.69', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'D61.818', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.22', 'sixthDiagnosis': 'E11.22'}]
[18:05:22] 🔄 
🔄 Step 4: Extracting order data...
[18:05:25] ℹ️  Order extraction - MRN: '2258674'
[18:05:25] ℹ️  Order extraction - Sex: 'FEMALE'
[18:05:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:05:25] ℹ️  Order extraction - Payer Source: ''
[18:05:25] ✅ Order data extraction completed successfully
[18:05:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:05:25] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[18:05:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:05:25] ✅ Patient name cross-validation successful
[18:05:25] ✅    ✅ Data merged successfully
[18:05:26] ✅    ✅ Order data extracted and validated
[18:05:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:05:32] [DOC: 9193975] ℹ️  Patient not found in cache or API: Maryann Boucher
[18:05:32] [DOC: 9193975] ℹ️  Patient not found, creating new patient via API...
[18:05:32] [DOC: 9193975] ℹ️  Creating patient via API: Maryann Boucher
[18:05:33] [DOC: 9193975] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:05:33] ❌    ❌ Failed to create patient
[18:05:33] [DOC: 9193975] ℹ️  API push details saved for document 9193975
================================================================================
║                        Processing Document ID: 9193962                         ║
================================================================================
[18:05:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:05:33] ℹ️  Date: 03/20/2025
[18:05:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:05:34] [DOC: 9193962] ✅ Text extracted using pdfplumber (1508 chars)
[18:05:34] ✅    ✅ Text extracted using pdfplumber (1508 chars)
[18:05:34] 🔄 
🔄 Step 2: Extracting patient data...
[18:05:37] ℹ️  AI extracted raw sex value: 'F'
[18:05:37] ℹ️  AI extracted service line: 'RN'
[18:05:37] ℹ️  AI extracted payer source: ''
[18:05:37] ℹ️  AI extracted diagnoses:
[18:05:37] ℹ️    - Diagnosis 1: ''
[18:05:37] ℹ️    - Diagnosis 2: ''
[18:05:37] ℹ️    - Diagnosis 3: ''
[18:05:37] ℹ️    - Diagnosis 4: ''
[18:05:37] ℹ️    - Diagnosis 5: ''
[18:05:37] ℹ️    - Diagnosis 6: ''
[18:05:37] ℹ️  Final extracted MRN: '2189741'
[18:05:37] ℹ️  Final extracted Sex: 'FEMALE'
[18:05:37] ℹ️  Final extracted Service Line: 'RN'
[18:05:37] ℹ️  Final extracted Payer Source: ''
[18:05:37] ✅ Patient data extraction completed successfully
[18:05:37] ✅    ✅ Patient data extracted successfully
[18:05:37] 📊 Patient Response
     └─ patientFName: Cizaltina
     └─ patientLName: Andrade
     └─ dob: 09/06/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2189741
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:05:37] ✅    ✅ Patient identified: Cizaltina Andrade
[18:05:37] ✅    ✅ Patient name validation passed
[18:05:37] 🔄 
🔄 Step 3: Processing patient dates...
[18:05:37] [DOC: 9193962] ℹ️  DOB normalized: 09/06/1936
[18:05:37] [DOC: 9193962] ✅ Patient date processing completed successfully
[18:05:37] ✅    ✅ Date processing completed
[18:05:37] 📊 Processed Patient Data
     └─ patientFName: Cizaltina
     └─ patientLName: Andrade
     └─ dob: 09/06/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2189741
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:05:37] 🔄 
🔄 Step 4: Extracting order data...
[18:05:39] ℹ️  Order extraction - MRN: '2189741'
[18:05:39] ℹ️  Order extraction - Sex: 'FEMALE'
[18:05:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:05:39] ℹ️  Order extraction - Payer Source: ''
[18:05:39] ✅ Order data extraction completed successfully
[18:05:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:05:39] ℹ️  Using MRN from patient data: '2189741' over '2189741'
[18:05:39] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[18:05:39] ✅ Patient name cross-validation successful
[18:05:39] ✅    ✅ Data merged successfully
[18:05:40] ✅    ✅ Order data extracted and validated
[18:05:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:05:45] [DOC: 9193962] ℹ️  Patient not found in cache or API: Cizaltina Andrade
[18:05:45] [DOC: 9193962] ℹ️  Patient not found, creating new patient via API...
[18:05:45] [DOC: 9193962] ℹ️  Creating patient via API: Cizaltina Andrade
[18:05:46] [DOC: 9193962] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:05:46] ❌    ❌ Failed to create patient
[18:05:46] [DOC: 9193962] ℹ️  API push details saved for document 9193962
================================================================================
║                        Processing Document ID: 9193920                         ║
================================================================================
[18:05:46] ℹ️  Agency: Alphacare Home Health Agency
[18:05:46] ℹ️  Date: 03/20/2025
[18:05:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:05:50] [DOC: 9193920] ✅ Text extracted using pdfplumber (9862 chars)
[18:05:50] ✅    ✅ Text extracted using pdfplumber (9862 chars)
[18:05:50] 🔄 
🔄 Step 2: Extracting patient data...
[18:05:53] ℹ️  AI extracted raw sex value: 'F'
[18:05:53] ℹ️  AI extracted service line: 'Physical Therapy'
[18:05:53] ℹ️  AI extracted payer source: 'None'
[18:05:53] ℹ️  AI extracted diagnoses:
[18:05:53] ℹ️    - Diagnosis 1: 'None'
[18:05:53] ℹ️    - Diagnosis 2: 'None'
[18:05:53] ℹ️    - Diagnosis 3: 'None'
[18:05:53] ℹ️    - Diagnosis 4: 'None'
[18:05:53] ℹ️    - Diagnosis 5: 'None'
[18:05:53] ℹ️    - Diagnosis 6: 'None'
[18:05:53] ℹ️  Final extracted MRN: '000003599'
[18:05:53] ℹ️  Final extracted Sex: 'FEMALE'
[18:05:53] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:05:53] ℹ️  Final extracted Payer Source: ''
[18:05:53] ✅ Patient data extraction completed successfully
[18:05:53] ✅    ✅ Patient data extracted successfully
[18:05:53] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000003599
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/31/2025', 'endOfEpisode': '02/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:05:53] ✅    ✅ Patient identified: June Stykowski
[18:05:53] ✅    ✅ Patient name validation passed
[18:05:53] 🔄 
🔄 Step 3: Processing patient dates...
[18:05:53] [DOC: 9193920] ℹ️  DOB normalized: 11/08/1952
[18:05:53] [DOC: 9193920] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[18:05:53] [DOC: 9193920] ℹ️  Episode endOfEpisode normalized: 02/10/2025
[18:05:53] [DOC: 9193920] ✅ Patient date processing completed successfully
[18:05:53] ✅    ✅ Date processing completed
[18:05:53] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000003599
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ zip: 
     └─ phoneNumber: 
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '02/10/2025'}]
[18:05:53] 🔄 
🔄 Step 4: Extracting order data...
[18:05:55] ℹ️  Order extraction - MRN: '000003599'
[18:05:55] ℹ️  Order extraction - Sex: 'FEMALE'
[18:05:55] ℹ️  Order extraction - Service Line: 'PT'
[18:05:55] ℹ️  Order extraction - Payer Source: ''
[18:05:55] ✅ Order data extraction completed successfully
[18:05:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:05:55] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[18:05:55] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[18:05:55] ✅ Patient name cross-validation successful
[18:05:55] ✅    ✅ Data merged successfully
[18:05:56] ✅    ✅ Order data extracted and validated
[18:05:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:05:56] [DOC: 9193920] ✅ Patient found in local cache: June Stykowski, ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[18:05:56] ✅    ✅ Existing patient found with ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[18:05:56] 🔄 
🔄 Step 6: Pushing order to API...
[18:05:56] [DOC: 9193920] ℹ️  Pushing order via API for patient ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[18:05:57] [DOC: 9193920] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:05:57] ❌    ❌ Failed to push order
[18:05:57] 🔄 
🔄 Step 7: Writing to CSV...
[18:05:57] [DOC: 9193920] ℹ️  Calculated age: 72 from DOB: 11/08/1952
[18:05:57] [DOC: 9193920] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[18:05:57] [DOC: 9193920] ℹ️  Payer Source extracted: ''
[18:05:57] [DOC: 9193920] ℹ️  Diagnosis codes being written:
[18:05:57] [DOC: 9193920] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:05:57] [DOC: 9193920] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:05:57] [DOC: 9193920] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:05:57] [DOC: 9193920] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:05:57] [DOC: 9193920] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:05:57] [DOC: 9193920] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:05:57] [DOC: 9193920] ✅ Patient data written to CSV: June Stykowski | Sex: FEMALE | Age: 72 | Service: PT, Physical Therapy | Payer:  | MRN: 000003599
[18:05:57] ✅    ✅ Document 9193920 processed and saved successfully
[18:05:57] 🔄 
🔄 Step 8: Saving API details...
[18:05:57] [DOC: 9193920] ℹ️  API push details saved for document 9193920
[18:05:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193509                         ║
================================================================================
[18:05:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:05:57] ℹ️  Date: 03/20/2025
[18:05:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:06:00] [DOC: 9193509] ✅ Text extracted using pdfplumber (1202 chars)
[18:06:00] ✅    ✅ Text extracted using pdfplumber (1202 chars)
[18:06:00] 🔄 
🔄 Step 2: Extracting patient data...
[18:06:03] ℹ️  AI extracted raw sex value: ''
[18:06:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:06:03] ℹ️  AI extracted payer source: ''
[18:06:03] ℹ️  AI extracted diagnoses:
[18:06:03] ℹ️    - Diagnosis 1: 'F39'
[18:06:03] ℹ️    - Diagnosis 2: 'F32.A'
[18:06:03] ℹ️    - Diagnosis 3: 'E11.42'
[18:06:03] ℹ️    - Diagnosis 4: ''
[18:06:03] ℹ️    - Diagnosis 5: ''
[18:06:03] ℹ️    - Diagnosis 6: ''
[18:06:03] ℹ️  Final extracted MRN: 'MA221103064405'
[18:06:03] ℹ️  Final extracted Sex: ''
[18:06:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:06:03] ℹ️  Final extracted Payer Source: ''
[18:06:03] ✅ Patient data extraction completed successfully
[18:06:03] ✅    ✅ Patient data extracted successfully
[18:06:03] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:06:03] ✅    ✅ Patient identified: Marie Mendoza
[18:06:03] ✅    ✅ Patient name validation passed
[18:06:03] 🔄 
🔄 Step 3: Processing patient dates...
[18:06:03] [DOC: 9193509] ℹ️  DOB normalized: 06/25/1944
[18:06:03] [DOC: 9193509] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[18:06:03] [DOC: 9193509] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[18:06:03] [DOC: 9193509] ✅ Patient date processing completed successfully
[18:06:03] ✅    ✅ Date processing completed
[18:06:03] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:06:03] 🔄 
🔄 Step 4: Extracting order data...
[18:06:06] ℹ️  Order extraction - MRN: 'MA221103064405'
[18:06:06] ℹ️  Order extraction - Sex: ''
[18:06:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:06:06] ℹ️  Order extraction - Payer Source: ''
[18:06:06] ✅ Order data extraction completed successfully
[18:06:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:06:06] ℹ️  Using MRN from patient data: 'MA221103064405' over 'MA221103064405'
[18:06:06] ℹ️  Inferred sex as FEMALE from name: Marie
[18:06:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:06:06] ✅ Patient name cross-validation successful
[18:06:06] ✅    ✅ Data merged successfully
[18:06:07] ✅    ✅ Order data extracted and validated
[18:06:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:06:16] [DOC: 9193509] ℹ️  Patient not found in cache or API: Marie Mendoza
[18:06:16] [DOC: 9193509] ℹ️  Patient not found, creating new patient via API...
[18:06:16] [DOC: 9193509] ℹ️  Creating patient via API: Marie Mendoza
[18:06:17] [DOC: 9193509] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:06:17] ❌    ❌ Failed to create patient
[18:06:17] [DOC: 9193509] ℹ️  API push details saved for document 9193509
================================================================================
║                        Processing Document ID: 9193505                         ║
================================================================================
[18:06:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:06:17] ℹ️  Date: 03/20/2025
[18:06:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:06:19] [DOC: 9193505] ✅ Text extracted using pdfplumber (1085 chars)
[18:06:19] ✅    ✅ Text extracted using pdfplumber (1073 chars)
[18:06:19] 🔄 
🔄 Step 2: Extracting patient data...
[18:06:22] ℹ️  AI extracted raw sex value: ''
[18:06:22] ℹ️  AI extracted service line: 'RN'
[18:06:22] ℹ️  AI extracted payer source: ''
[18:06:22] ℹ️  AI extracted diagnoses:
[18:06:22] ℹ️    - Diagnosis 1: 'I10'
[18:06:22] ℹ️    - Diagnosis 2: 'E11.65'
[18:06:22] ℹ️    - Diagnosis 3: 'E78.5'
[18:06:22] ℹ️    - Diagnosis 4: ''
[18:06:22] ℹ️    - Diagnosis 5: ''
[18:06:22] ℹ️    - Diagnosis 6: ''
[18:06:22] ℹ️  Final extracted MRN: '100993650'
[18:06:22] ℹ️  Final extracted Sex: ''
[18:06:22] ℹ️  Final extracted Service Line: 'RN'
[18:06:22] ℹ️  Final extracted Payer Source: ''
[18:06:22] ✅ Patient data extraction completed successfully
[18:06:22] ✅    ✅ Patient data extracted successfully
[18:06:22] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Fernandes
     └─ dob: 04/12/1949
     └─ patientSex: 
     └─ medicalRecordNo: 100993650
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:06:22] ✅    ✅ Patient identified: Maria Fernandes
[18:06:22] ✅    ✅ Patient name validation passed
[18:06:22] 🔄 
🔄 Step 3: Processing patient dates...
[18:06:22] [DOC: 9193505] ℹ️  DOB normalized: 04/12/1949
[18:06:22] [DOC: 9193505] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:06:22] [DOC: 9193505] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:06:22] [DOC: 9193505] ✅ Patient date processing completed successfully
[18:06:22] ✅    ✅ Date processing completed
[18:06:22] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Fernandes
     └─ dob: 04/12/1949
     └─ patientSex: 
     └─ medicalRecordNo: 100993650
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:06:22] 🔄 
🔄 Step 4: Extracting order data...
[18:06:25] ℹ️  Order extraction - MRN: '100993650'
[18:06:25] ℹ️  Order extraction - Sex: ''
[18:06:25] ℹ️  Order extraction - Service Line: 'PCP'
[18:06:25] ℹ️  Order extraction - Payer Source: ''
[18:06:25] ✅ Order data extraction completed successfully
[18:06:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:06:25] ℹ️  Using MRN from patient data: '100993650' over '100993650'
[18:06:25] ℹ️  Inferred sex as FEMALE from name: Maria
[18:06:25] ℹ️  Combined service lines: Patient='RN' + Order='PCP' = 'PCP, RN'
[18:06:25] ✅ Patient name cross-validation successful
[18:06:25] ✅    ✅ Data merged successfully
[18:06:26] ✅    ✅ Order data extracted and validated
[18:06:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:06:31] [DOC: 9193505] ✅ Patient exists in API: Maria Fernandes, ID: d8e266a9-d047-44ee-a281-6fd6c44fed89
[18:06:31] ✅    ✅ Existing patient found with ID: d8e266a9-d047-44ee-a281-6fd6c44fed89
[18:06:31] 🔄 
🔄 Step 6: Pushing order to API...
[18:06:31] [DOC: 9193505] ℹ️  Pushing order via API for patient ID: d8e266a9-d047-44ee-a281-6fd6c44fed89
[18:06:32] [DOC: 9193505] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13969"}
[18:06:32] ❌    ❌ Failed to push order
[18:06:32] 🔄 
🔄 Step 7: Writing to CSV...
[18:06:32] [DOC: 9193505] ℹ️  Calculated age: 76 from DOB: 04/12/1949
[18:06:32] [DOC: 9193505] ℹ️  Service Line extracted: 'PCP, RN'
[18:06:32] [DOC: 9193505] ℹ️  Payer Source extracted: ''
[18:06:32] [DOC: 9193505] ℹ️  Diagnosis codes being written:
[18:06:32] [DOC: 9193505] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:06:32] [DOC: 9193505] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[18:06:32] [DOC: 9193505] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[18:06:32] [DOC: 9193505] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:06:32] [DOC: 9193505] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:06:32] [DOC: 9193505] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:06:32] [DOC: 9193505] ✅ Patient data written to CSV: Maria Fernandes | Sex: FEMALE | Age: 76 | Service: PCP, RN | Payer:  | MRN: 100993650
[18:06:32] ✅    ✅ Document 9193505 processed and saved successfully
[18:06:32] 🔄 
🔄 Step 8: Saving API details...
[18:06:32] [DOC: 9193505] ℹ️  API push details saved for document 9193505
[18:06:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193502                         ║
================================================================================
[18:06:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:06:32] ℹ️  Date: 03/20/2025
[18:06:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:06:34] [DOC: 9193502] ✅ Text extracted using pdfplumber (1237 chars)
[18:06:34] ✅    ✅ Text extracted using pdfplumber (1237 chars)
[18:06:34] 🔄 
🔄 Step 2: Extracting patient data...
[18:06:37] ℹ️  AI extracted raw sex value: ''
[18:06:37] ℹ️  AI extracted service line: 'Physical Therapy'
[18:06:37] ℹ️  AI extracted payer source: ''
[18:06:37] ℹ️  AI extracted diagnoses:
[18:06:37] ℹ️    - Diagnosis 1: 'S81.801'
[18:06:37] ℹ️    - Diagnosis 2: 'E11.51'
[18:06:37] ℹ️    - Diagnosis 3: 'I70.209'
[18:06:37] ℹ️    - Diagnosis 4: ''
[18:06:37] ℹ️    - Diagnosis 5: ''
[18:06:37] ℹ️    - Diagnosis 6: ''
[18:06:37] ℹ️  Final extracted MRN: 'MA200528053701'
[18:06:37] ℹ️  Final extracted Sex: ''
[18:06:37] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:06:37] ℹ️  Final extracted Payer Source: ''
[18:06:37] ✅ Patient data extraction completed successfully
[18:06:37] ✅    ✅ Patient data extracted successfully
[18:06:37] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:06:37] ✅    ✅ Patient identified: Roderick Lopez
[18:06:37] ✅    ✅ Patient name validation passed
[18:06:37] 🔄 
🔄 Step 3: Processing patient dates...
[18:06:37] [DOC: 9193502] ℹ️  DOB normalized: 05/21/1937
[18:06:37] [DOC: 9193502] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[18:06:37] [DOC: 9193502] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[18:06:37] [DOC: 9193502] ✅ Patient date processing completed successfully
[18:06:37] ✅    ✅ Date processing completed
[18:06:37] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:06:37] 🔄 
🔄 Step 4: Extracting order data...
[18:06:39] ℹ️  Order extraction - MRN: 'MA200528053701'
[18:06:39] ℹ️  Order extraction - Sex: ''
[18:06:39] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:06:39] ℹ️  Order extraction - Payer Source: ''
[18:06:39] ✅ Order data extraction completed successfully
[18:06:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:06:39] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[18:06:39] ℹ️  Inferred sex as MALE from name: Roderick
[18:06:39] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:06:39] ✅ Patient name cross-validation successful
[18:06:39] ✅    ✅ Data merged successfully
[18:06:41] ✅    ✅ Order data extracted and validated
[18:06:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:06:45] [DOC: 9193502] ℹ️  Patient not found in cache or API: Roderick Lopez
[18:06:45] [DOC: 9193502] ℹ️  Patient not found, creating new patient via API...
[18:06:45] [DOC: 9193502] ℹ️  Creating patient via API: Roderick Lopez
[18:06:46] [DOC: 9193502] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:06:46] ❌    ❌ Failed to create patient
[18:06:46] [DOC: 9193502] ℹ️  API push details saved for document 9193502
================================================================================
║                        Processing Document ID: 9193499                         ║
================================================================================
[18:06:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:06:46] ℹ️  Date: 03/20/2025
[18:06:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:06:49] [DOC: 9193499] ✅ Text extracted using pdfplumber (7990 chars)
[18:06:49] ✅    ✅ Text extracted using pdfplumber (7990 chars)
[18:06:49] 🔄 
🔄 Step 2: Extracting patient data...
[18:06:51] ℹ️  AI extracted raw sex value: ''
[18:06:51] ℹ️  AI extracted service line: 'ST'
[18:06:51] ℹ️  AI extracted payer source: ''
[18:06:51] ℹ️  AI extracted diagnoses:
[18:06:51] ℹ️    - Diagnosis 1: 'pneumonia'
[18:06:51] ℹ️    - Diagnosis 2: 'dysphagia'
[18:06:51] ℹ️    - Diagnosis 3: 'post laminectomy syndrome'
[18:06:51] ℹ️    - Diagnosis 4: 'spinal stenosis with neurogenic claudication'
[18:06:51] ℹ️    - Diagnosis 5: 'UTI'
[18:06:51] ℹ️    - Diagnosis 6: 'COPD'
[18:06:51] ℹ️  Final extracted MRN: 'MA250210123603'
[18:06:51] ℹ️  Final extracted Sex: ''
[18:06:51] ℹ️  Final extracted Service Line: 'ST'
[18:06:51] ℹ️  Final extracted Payer Source: ''
[18:06:51] ✅ Patient data extraction completed successfully
[18:06:51] ✅    ✅ Patient data extracted successfully
[18:06:51] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'pneumonia', 'secondDiagnosis': 'dysphagia', 'thirdDiagnosis': 'post laminectomy syndrome', 'fourthDiagnosis': 'spinal stenosis with neurogenic claudication', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COPD'}]
[18:06:51] ✅    ✅ Patient identified: David Boswell
[18:06:51] ✅    ✅ Patient name validation passed
[18:06:51] 🔄 
🔄 Step 3: Processing patient dates...
[18:06:51] [DOC: 9193499] ℹ️  DOB normalized: 12/29/1936
[18:06:51] [DOC: 9193499] ✅ Patient date processing completed successfully
[18:06:51] ✅    ✅ Date processing completed
[18:06:51] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'pneumonia', 'secondDiagnosis': 'dysphagia', 'thirdDiagnosis': 'post laminectomy syndrome', 'fourthDiagnosis': 'spinal stenosis with neurogenic claudication', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COPD'}]
[18:06:51] 🔄 
🔄 Step 4: Extracting order data...
[18:06:54] ℹ️  Order extraction - MRN: 'MA250210123603'
[18:06:54] ℹ️  Order extraction - Sex: ''
[18:06:54] ℹ️  Order extraction - Service Line: 'ST'
[18:06:54] ℹ️  Order extraction - Payer Source: ''
[18:06:54] ✅ Order data extraction completed successfully
[18:06:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:06:54] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[18:06:54] ℹ️  Inferred sex as MALE from name: David
[18:06:54] ℹ️  Service line consistent in both sources: 'ST'
[18:06:54] ✅ Patient name cross-validation successful
[18:06:54] ✅    ✅ Data merged successfully
[18:06:55] ⚠️     ❌ Skipping - missing episode start date
[18:06:55] [DOC: 9193499] ℹ️  API push details saved for document 9193499
================================================================================
║                        Processing Document ID: 9193497                         ║
================================================================================
[18:06:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:06:55] ℹ️  Date: 03/20/2025
[18:06:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:01] [DOC: 9193497] ✅ Text extracted using pdfplumber (15662 chars)
[18:07:01] ✅    ✅ Text extracted using pdfplumber (15662 chars)
[18:07:01] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:04] ℹ️  AI extracted raw sex value: 'M'
[18:07:04] ℹ️  AI extracted service line: 'OT'
[18:07:04] ℹ️  AI extracted payer source: ''
[18:07:04] ℹ️  AI extracted diagnoses:
[18:07:04] ℹ️    - Diagnosis 1: 'J44.1'
[18:07:04] ℹ️    - Diagnosis 2: 'M54.5'
[18:07:04] ℹ️    - Diagnosis 3: 'G31.83'
[18:07:04] ℹ️    - Diagnosis 4: 'N39.0'
[18:07:04] ℹ️    - Diagnosis 5: 'J45.909'
[18:07:04] ℹ️    - Diagnosis 6: 'M06.9'
[18:07:04] ℹ️  Final extracted MRN: 'MA250210123603'
[18:07:04] ℹ️  Final extracted Sex: 'MALE'
[18:07:04] ℹ️  Final extracted Service Line: 'OT'
[18:07:04] ℹ️  Final extracted Payer Source: ''
[18:07:04] ✅ Patient data extraction completed successfully
[18:07:04] ✅    ✅ Patient data extracted successfully
[18:07:04] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'G31.83', 'fourthDiagnosis': 'N39.0', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'M06.9'}]
[18:07:04] ✅    ✅ Patient identified: David Boswell
[18:07:04] ✅    ✅ Patient name validation passed
[18:07:04] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:04] [DOC: 9193497] ℹ️  DOB normalized: 12/29/1936
[18:07:04] [DOC: 9193497] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[18:07:04] [DOC: 9193497] ✅ Patient date processing completed successfully
[18:07:04] ✅    ✅ Date processing completed
[18:07:04] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'G31.83', 'fourthDiagnosis': 'N39.0', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'M06.9'}]
[18:07:04] 🔄 
🔄 Step 4: Extracting order data...
[18:07:07] ℹ️  Order extraction - MRN: 'MA250210123603'
[18:07:07] ℹ️  Order extraction - Sex: 'MALE'
[18:07:07] ℹ️  Order extraction - Service Line: 'OT'
[18:07:07] ℹ️  Order extraction - Payer Source: ''
[18:07:07] ✅ Order data extraction completed successfully
[18:07:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:07] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[18:07:07] ℹ️  Service line consistent in both sources: 'OT'
[18:07:07] ✅ Patient name cross-validation successful
[18:07:07] ✅    ✅ Data merged successfully
[18:07:08] ⚠️     ❌ Skipping - missing episode start date
[18:07:08] [DOC: 9193497] ℹ️  API push details saved for document 9193497
================================================================================
║                        Processing Document ID: 9193494                         ║
================================================================================
[18:07:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:07:08] ℹ️  Date: 03/20/2025
[18:07:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:11] [DOC: 9193494] ✅ Text extracted using pdfplumber (13068 chars)
[18:07:11] ✅    ✅ Text extracted using pdfplumber (13068 chars)
[18:07:11] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:14] ℹ️  AI extracted raw sex value: 'M'
[18:07:14] ℹ️  AI extracted service line: 'OT'
[18:07:14] ℹ️  AI extracted payer source: 'None'
[18:07:14] ℹ️  AI extracted diagnoses:
[18:07:14] ℹ️    - Diagnosis 1: 'pneumonia'
[18:07:14] ℹ️    - Diagnosis 2: 'influenza A'
[18:07:14] ℹ️    - Diagnosis 3: 'exacerbation COPD'
[18:07:14] ℹ️    - Diagnosis 4: 'None'
[18:07:14] ℹ️    - Diagnosis 5: 'None'
[18:07:14] ℹ️    - Diagnosis 6: 'None'
[18:07:14] ℹ️  Final extracted MRN: 'MA250210123603'
[18:07:14] ℹ️  Final extracted Sex: 'MALE'
[18:07:14] ℹ️  Final extracted Service Line: 'OT'
[18:07:14] ℹ️  Final extracted Payer Source: ''
[18:07:14] ✅ Patient data extraction completed successfully
[18:07:14] ✅    ✅ Patient data extracted successfully
[18:07:14] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/10/2025', 'endOfEpisode': None, 'firstDiagnosis': 'pneumonia', 'secondDiagnosis': 'influenza A', 'thirdDiagnosis': 'exacerbation COPD', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:07:14] ✅    ✅ Patient identified: David Boswell
[18:07:14] ✅    ✅ Patient name validation passed
[18:07:14] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:14] [DOC: 9193494] ℹ️  DOB normalized: 12/29/1936
[18:07:14] [DOC: 9193494] ℹ️  Episode startOfEpisode normalized: 02/10/2025
[18:07:14] [DOC: 9193494] ✅ Patient date processing completed successfully
[18:07:14] ✅    ✅ Date processing completed
[18:07:14] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/10/2025', 'firstDiagnosis': 'pneumonia', 'secondDiagnosis': 'influenza A', 'thirdDiagnosis': 'exacerbation COPD'}]
[18:07:14] 🔄 
🔄 Step 4: Extracting order data...
[18:07:17] ℹ️  Order extraction - MRN: 'MA250210123603'
[18:07:17] ℹ️  Order extraction - Sex: 'MALE'
[18:07:17] ℹ️  Order extraction - Service Line: 'OT'
[18:07:17] ℹ️  Order extraction - Payer Source: ''
[18:07:17] ✅ Order data extraction completed successfully
[18:07:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:17] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[18:07:17] ℹ️  Service line consistent in both sources: 'OT'
[18:07:17] ✅ Patient name cross-validation successful
[18:07:17] ✅    ✅ Data merged successfully
[18:07:18] ⚠️     ❌ Skipping - missing episode start date
[18:07:18] [DOC: 9193494] ℹ️  API push details saved for document 9193494
================================================================================
║                        Processing Document ID: 9193491                         ║
================================================================================
[18:07:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:07:18] ℹ️  Date: 03/20/2025
[18:07:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:20] [DOC: 9193491] ✅ Text extracted using pdfplumber (1313 chars)
[18:07:20] ✅    ✅ Text extracted using pdfplumber (1313 chars)
[18:07:20] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:23] ℹ️  AI extracted raw sex value: ''
[18:07:23] ℹ️  AI extracted service line: 'Physical Therapy'
[18:07:23] ℹ️  AI extracted payer source: ''
[18:07:23] ℹ️  AI extracted diagnoses:
[18:07:23] ℹ️    - Diagnosis 1: 'B37.81'
[18:07:23] ℹ️    - Diagnosis 2: 'J44.1'
[18:07:23] ℹ️    - Diagnosis 3: 'J18.9'
[18:07:23] ℹ️    - Diagnosis 4: ''
[18:07:23] ℹ️    - Diagnosis 5: ''
[18:07:23] ℹ️    - Diagnosis 6: ''
[18:07:23] ℹ️  Final extracted MRN: 'MA250210123603'
[18:07:23] ℹ️  Final extracted Sex: ''
[18:07:23] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:07:23] ℹ️  Final extracted Payer Source: ''
[18:07:23] ✅ Patient data extraction completed successfully
[18:07:23] ✅    ✅ Patient data extracted successfully
[18:07:23] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:23] ✅    ✅ Patient identified: David Boswell
[18:07:23] ✅    ✅ Patient name validation passed
[18:07:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:23] [DOC: 9193491] ℹ️  DOB normalized: 12/29/1936
[18:07:23] [DOC: 9193491] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[18:07:23] [DOC: 9193491] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[18:07:23] [DOC: 9193491] ✅ Patient date processing completed successfully
[18:07:23] ✅    ✅ Date processing completed
[18:07:23] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:23] 🔄 
🔄 Step 4: Extracting order data...
[18:07:25] ℹ️  Order extraction - MRN: 'MA250210123603'
[18:07:25] ℹ️  Order extraction - Sex: ''
[18:07:25] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:07:25] ℹ️  Order extraction - Payer Source: ''
[18:07:25] ✅ Order data extraction completed successfully
[18:07:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:25] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[18:07:25] ℹ️  Inferred sex as MALE from name: David
[18:07:25] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:07:25] ✅ Patient name cross-validation successful
[18:07:25] ✅    ✅ Data merged successfully
[18:07:27] ✅    ✅ Order data extracted and validated
[18:07:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:07:27] [DOC: 9193491] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[18:07:27] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[18:07:27] 🔄 
🔄 Step 6: Pushing order to API...
[18:07:27] [DOC: 9193491] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[18:07:28] [DOC: 9193491] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13211"}
[18:07:28] ❌    ❌ Failed to push order
[18:07:28] 🔄 
🔄 Step 7: Writing to CSV...
[18:07:28] [DOC: 9193491] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[18:07:28] [DOC: 9193491] ℹ️  Service Line extracted: 'Physical Therapy'
[18:07:28] [DOC: 9193491] ℹ️  Payer Source extracted: ''
[18:07:28] [DOC: 9193491] ℹ️  Diagnosis codes being written:
[18:07:28] [DOC: 9193491] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.81'
[18:07:28] [DOC: 9193491] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.1'
[18:07:28] [DOC: 9193491] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[18:07:28] [DOC: 9193491] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:07:28] [DOC: 9193491] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:07:28] [DOC: 9193491] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:07:28] [DOC: 9193491] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA250210123603
[18:07:28] ✅    ✅ Document 9193491 processed and saved successfully
[18:07:28] 🔄 
🔄 Step 8: Saving API details...
[18:07:28] [DOC: 9193491] ℹ️  API push details saved for document 9193491
[18:07:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193490                         ║
================================================================================
[18:07:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:07:28] ℹ️  Date: 03/20/2025
[18:07:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:30] [DOC: 9193490] ✅ Text extracted using pdfplumber (1286 chars)
[18:07:30] ✅    ✅ Text extracted using pdfplumber (1286 chars)
[18:07:30] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:33] ℹ️  AI extracted raw sex value: ''
[18:07:33] ℹ️  AI extracted service line: 'Speech Therapy'
[18:07:33] ℹ️  AI extracted payer source: ''
[18:07:33] ℹ️  AI extracted diagnoses:
[18:07:33] ℹ️    - Diagnosis 1: 'B37.81'
[18:07:33] ℹ️    - Diagnosis 2: 'J44.1'
[18:07:33] ℹ️    - Diagnosis 3: 'J18.9'
[18:07:33] ℹ️    - Diagnosis 4: 'None'
[18:07:33] ℹ️    - Diagnosis 5: 'None'
[18:07:33] ℹ️    - Diagnosis 6: 'None'
[18:07:33] ℹ️  Final extracted MRN: 'MA250210123603'
[18:07:33] ℹ️  Final extracted Sex: ''
[18:07:33] ℹ️  Final extracted Service Line: 'Speech Therapy'
[18:07:33] ℹ️  Final extracted Payer Source: ''
[18:07:33] ✅ Patient data extraction completed successfully
[18:07:33] ✅    ✅ Patient data extracted successfully
[18:07:33] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:07:33] ✅    ✅ Patient identified: David Boswell
[18:07:33] ✅    ✅ Patient name validation passed
[18:07:33] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:33] [DOC: 9193490] ℹ️  DOB normalized: 12/29/1936
[18:07:33] [DOC: 9193490] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[18:07:33] [DOC: 9193490] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[18:07:33] [DOC: 9193490] ✅ Patient date processing completed successfully
[18:07:33] ✅    ✅ Date processing completed
[18:07:33] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9'}]
[18:07:33] 🔄 
🔄 Step 4: Extracting order data...
[18:07:36] ℹ️  Order extraction - MRN: 'MA250210123603'
[18:07:36] ℹ️  Order extraction - Sex: ''
[18:07:36] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[18:07:36] ℹ️  Order extraction - Payer Source: ''
[18:07:36] ✅ Order data extraction completed successfully
[18:07:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:36] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[18:07:36] ℹ️  Inferred sex as MALE from name: David
[18:07:36] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[18:07:36] ✅ Patient name cross-validation successful
[18:07:36] ✅    ✅ Data merged successfully
[18:07:37] ✅    ✅ Order data extracted and validated
[18:07:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:07:37] [DOC: 9193490] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[18:07:37] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[18:07:37] 🔄 
🔄 Step 6: Pushing order to API...
[18:07:37] [DOC: 9193490] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[18:07:38] [DOC: 9193490] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13212"}
[18:07:38] ❌    ❌ Failed to push order
[18:07:38] 🔄 
🔄 Step 7: Writing to CSV...
[18:07:38] [DOC: 9193490] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[18:07:38] [DOC: 9193490] ℹ️  Service Line extracted: 'Speech Therapy'
[18:07:38] [DOC: 9193490] ℹ️  Payer Source extracted: ''
[18:07:38] [DOC: 9193490] ℹ️  Diagnosis codes being written:
[18:07:38] [DOC: 9193490] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.81'
[18:07:38] [DOC: 9193490] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.1'
[18:07:38] [DOC: 9193490] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[18:07:38] [DOC: 9193490] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:07:38] [DOC: 9193490] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:07:38] [DOC: 9193490] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:07:38] [DOC: 9193490] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: Speech Therapy | Payer:  | MRN: MA250210123603
[18:07:38] ✅    ✅ Document 9193490 processed and saved successfully
[18:07:38] 🔄 
🔄 Step 8: Saving API details...
[18:07:38] [DOC: 9193490] ℹ️  API push details saved for document 9193490
[18:07:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193008                         ║
================================================================================
[18:07:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:07:38] ℹ️  Date: 03/20/2025
[18:07:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:41] [DOC: 9193008] ✅ Text extracted using pdfplumber (11606 chars)
[18:07:41] ✅    ✅ Text extracted using pdfplumber (11606 chars)
[18:07:41] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:44] ℹ️  AI extracted raw sex value: 'F'
[18:07:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:07:44] ℹ️  AI extracted payer source: 'SWH insurance provider'
[18:07:44] ℹ️  AI extracted diagnoses:
[18:07:44] ℹ️    - Diagnosis 1: 'E11.21'
[18:07:44] ℹ️    - Diagnosis 2: 'J44.9'
[18:07:44] ℹ️    - Diagnosis 3: 'I10'
[18:07:44] ℹ️    - Diagnosis 4: 'D50.9'
[18:07:44] ℹ️    - Diagnosis 5: 'F41.9'
[18:07:44] ℹ️    - Diagnosis 6: 'F33.8'
[18:07:44] ℹ️  Final extracted MRN: '100990266'
[18:07:44] ℹ️  Final extracted Sex: 'FEMALE'
[18:07:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:07:44] ℹ️  Final extracted Payer Source: 'SWH insurance provider'
[18:07:44] ✅ Patient data extraction completed successfully
[18:07:44] ✅    ✅ Patient data extracted successfully
[18:07:44] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance provider
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '09/05/2023', 'endOfEpisode': '11/03/2023', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[18:07:44] ✅    ✅ Patient identified: Maria Antunes
[18:07:44] ✅    ✅ Patient name validation passed
[18:07:44] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:44] [DOC: 9193008] ℹ️  DOB normalized: 11/22/1934
[18:07:44] [DOC: 9193008] ℹ️  Episode startOfCare normalized: 09/05/2023
[18:07:44] [DOC: 9193008] ℹ️  Episode startOfEpisode normalized: 09/05/2023
[18:07:44] [DOC: 9193008] ℹ️  Episode endOfEpisode normalized: 11/03/2023
[18:07:44] [DOC: 9193008] ✅ Patient date processing completed successfully
[18:07:44] ✅    ✅ Date processing completed
[18:07:44] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH insurance provider
     └─ episodeDiagnoses: [{'startOfCare': '09/05/2023', 'startOfEpisode': '09/05/2023', 'endOfEpisode': '11/03/2023', 'firstDiagnosis': 'E11.21', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[18:07:44] 🔄 
🔄 Step 4: Extracting order data...
[18:07:47] ℹ️  Order extraction - MRN: '100990266'
[18:07:47] ℹ️  Order extraction - Sex: 'FEMALE'
[18:07:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:07:47] ℹ️  Order extraction - Payer Source: 'SWH insurance provider'
[18:07:47] ✅ Order data extraction completed successfully
[18:07:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:47] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[18:07:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:07:47] ℹ️  Payer source consistent in both sources: 'SWH insurance provider'
[18:07:47] ✅ Patient name cross-validation successful
[18:07:47] ✅    ✅ Data merged successfully
[18:07:48] ✅    ✅ Order data extracted and validated
[18:07:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:07:54] [DOC: 9193008] ✅ Patient exists in API: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:07:54] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:07:54] 🔄 
🔄 Step 6: Pushing order to API...
[18:07:54] [DOC: 9193008] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:07:55] [DOC: 9193008] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12938"}
[18:07:55] ❌    ❌ Failed to push order
[18:07:55] 🔄 
🔄 Step 7: Writing to CSV...
[18:07:55] [DOC: 9193008] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[18:07:55] [DOC: 9193008] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:07:55] [DOC: 9193008] ℹ️  Payer Source extracted: 'SWH insurance provider'
[18:07:55] [DOC: 9193008] ℹ️  Diagnosis codes being written:
[18:07:55] [DOC: 9193008] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.21'
[18:07:55] [DOC: 9193008] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[18:07:55] [DOC: 9193008] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[18:07:55] [DOC: 9193008] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[18:07:55] [DOC: 9193008] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[18:07:55] [DOC: 9193008] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[18:07:55] [DOC: 9193008] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: SWH insurance provider | MRN: 100990266
[18:07:55] ✅    ✅ Document 9193008 processed and saved successfully
[18:07:55] 🔄 
🔄 Step 8: Saving API details...
[18:07:55] [DOC: 9193008] ℹ️  API push details saved for document 9193008
[18:07:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193006                         ║
================================================================================
[18:07:55] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[18:07:55] ℹ️  Date: 03/20/2025
[18:07:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:57] [DOC: 9193006] ✅ Text extracted using pdfplumber (1543 chars)
[18:07:57] ✅    ✅ Text extracted using pdfplumber (1543 chars)
[18:07:57] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:00] ℹ️  AI extracted raw sex value: 'F'
[18:08:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:08:00] ℹ️  AI extracted payer source: 'Senior Whole Health'
[18:08:00] ℹ️  AI extracted diagnoses:
[18:08:00] ℹ️    - Diagnosis 1: 'None'
[18:08:00] ℹ️    - Diagnosis 2: 'None'
[18:08:00] ℹ️    - Diagnosis 3: 'None'
[18:08:00] ℹ️    - Diagnosis 4: 'None'
[18:08:00] ℹ️    - Diagnosis 5: 'None'
[18:08:00] ℹ️    - Diagnosis 6: 'None'
[18:08:00] ℹ️  Final extracted MRN: '333005'
[18:08:00] ℹ️  Final extracted Sex: 'FEMALE'
[18:08:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:08:00] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[18:08:00] ✅ Patient data extraction completed successfully
[18:08:00] ✅    ✅ Patient data extracted successfully
[18:08:00] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ billingProvider: None
     └─ npi: 1053367128
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:08:00] ✅    ✅ Patient identified: Shirley Tavares
[18:08:00] ✅    ✅ Patient name validation passed
[18:08:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:00] [DOC: 9193006] ℹ️  DOB normalized: 11/10/1949
[18:08:00] [DOC: 9193006] ℹ️  Episode startOfCare normalized: 09/19/2022
[18:08:00] [DOC: 9193006] ℹ️  Episode startOfEpisode normalized: 01/06/2025
[18:08:00] [DOC: 9193006] ℹ️  Episode endOfEpisode normalized: 03/06/2025
[18:08:00] [DOC: 9193006] ✅ Patient date processing completed successfully
[18:08:00] ✅    ✅ Date processing completed
[18:08:00] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 333005
     └─ npi: 1053367128
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 442 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/19/2022', 'startOfEpisode': '01/06/2025', 'endOfEpisode': '03/06/2025'}]
[18:08:00] 🔄 
🔄 Step 4: Extracting order data...
[18:08:03] ℹ️  Order extraction - MRN: '333005'
[18:08:03] ℹ️  Order extraction - Sex: 'FEMALE'
[18:08:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:08:03] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[18:08:03] ✅ Order data extraction completed successfully
[18:08:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:03] ℹ️  Using MRN from patient data: '333005' over '333005'
[18:08:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:08:03] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[18:08:03] ✅ Patient name cross-validation successful
[18:08:03] ✅    ✅ Data merged successfully
[18:08:04] ✅    ✅ Order data extracted and validated
[18:08:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:04] [DOC: 9193006] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:08:04] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:08:04] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:04] [DOC: 9193006] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:08:05] [DOC: 9193006] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:08:05] ❌    ❌ Failed to push order
[18:08:05] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:05] [DOC: 9193006] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[18:08:05] [DOC: 9193006] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:08:05] [DOC: 9193006] ℹ️  Payer Source extracted: 'Senior Whole Health'
[18:08:05] [DOC: 9193006] ℹ️  Diagnosis codes being written:
[18:08:05] [DOC: 9193006] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:08:05] [DOC: 9193006] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:08:05] [DOC: 9193006] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:08:05] [DOC: 9193006] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:08:05] [DOC: 9193006] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:08:05] [DOC: 9193006] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:08:05] [DOC: 9193006] ✅ Patient data written to CSV: Shirley Tavares | Sex: FEMALE | Age: 75 | Service: Skilled Nursing | Payer: Senior Whole Health | MRN: 333005
[18:08:05] ✅    ✅ Document 9193006 processed and saved successfully
[18:08:05] 🔄 
🔄 Step 8: Saving API details...
[18:08:05] [DOC: 9193006] ℹ️  API push details saved for document 9193006
[18:08:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193005                         ║
================================================================================
[18:08:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:08:05] ℹ️  Date: 03/20/2025
[18:08:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:08] [DOC: 9193005] ✅ Text extracted using pdfplumber (13630 chars)
[18:08:08] ✅    ✅ Text extracted using pdfplumber (13630 chars)
[18:08:08] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:11] ℹ️  AI extracted raw sex value: 'F'
[18:08:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:08:11] ℹ️  AI extracted payer source: 'Medicare'
[18:08:11] ℹ️  AI extracted diagnoses:
[18:08:11] ℹ️    - Diagnosis 1: 'E11.9'
[18:08:11] ℹ️    - Diagnosis 2: 'J44.9'
[18:08:11] ℹ️    - Diagnosis 3: 'I10'
[18:08:11] ℹ️    - Diagnosis 4: 'D50.9'
[18:08:11] ℹ️    - Diagnosis 5: 'F41.9'
[18:08:11] ℹ️    - Diagnosis 6: 'F33.8'
[18:08:11] ℹ️  Final extracted MRN: '100990266'
[18:08:11] ℹ️  Final extracted Sex: 'FEMALE'
[18:08:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:08:11] ℹ️  Final extracted Payer Source: 'Medicare'
[18:08:11] ✅ Patient data extraction completed successfully
[18:08:11] ✅    ✅ Patient data extracted successfully
[18:08:11] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[18:08:11] ✅    ✅ Patient identified: Maria Antunes
[18:08:11] ✅    ✅ Patient name validation passed
[18:08:11] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:11] [DOC: 9193005] ℹ️  DOB normalized: 11/22/1934
[18:08:11] [DOC: 9193005] ℹ️  Episode startOfCare normalized: 02/01/2023
[18:08:11] [DOC: 9193005] ℹ️  Episode startOfEpisode normalized: 06/01/2023
[18:08:11] [DOC: 9193005] ℹ️  Episode endOfEpisode normalized: 07/30/2023
[18:08:11] [DOC: 9193005] ✅ Patient date processing completed successfully
[18:08:11] ✅    ✅ Date processing completed
[18:08:11] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[18:08:11] 🔄 
🔄 Step 4: Extracting order data...
[18:08:14] ℹ️  Order extraction - MRN: '100990266'
[18:08:14] ℹ️  Order extraction - Sex: 'FEMALE'
[18:08:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:08:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:08:14] ✅ Order data extraction completed successfully
[18:08:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:14] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[18:08:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:08:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:08:14] ✅ Patient name cross-validation successful
[18:08:14] ✅    ✅ Data merged successfully
[18:08:15] ✅    ✅ Order data extracted and validated
[18:08:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:15] [DOC: 9193005] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:15] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:15] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:15] [DOC: 9193005] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:16] [DOC: 9193005] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12939"}
[18:08:16] ❌    ❌ Failed to push order
[18:08:16] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:16] [DOC: 9193005] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[18:08:16] [DOC: 9193005] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:08:16] [DOC: 9193005] ℹ️  Payer Source extracted: 'Medicare'
[18:08:16] [DOC: 9193005] ℹ️  Diagnosis codes being written:
[18:08:16] [DOC: 9193005] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[18:08:16] [DOC: 9193005] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[18:08:16] [DOC: 9193005] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[18:08:16] [DOC: 9193005] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[18:08:16] [DOC: 9193005] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[18:08:16] [DOC: 9193005] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[18:08:16] [DOC: 9193005] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990266
[18:08:16] ✅    ✅ Document 9193005 processed and saved successfully
[18:08:16] 🔄 
🔄 Step 8: Saving API details...
[18:08:16] [DOC: 9193005] ℹ️  API push details saved for document 9193005
[18:08:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193002                         ║
================================================================================
[18:08:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:08:16] ℹ️  Date: 03/20/2025
[18:08:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:19] [DOC: 9193002] ✅ Text extracted using pdfplumber (13630 chars)
[18:08:19] ✅    ✅ Text extracted using pdfplumber (13630 chars)
[18:08:19] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:22] ℹ️  AI extracted raw sex value: 'F'
[18:08:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:08:22] ℹ️  AI extracted payer source: 'Medicare'
[18:08:22] ℹ️  AI extracted diagnoses:
[18:08:22] ℹ️    - Diagnosis 1: 'E11.9'
[18:08:22] ℹ️    - Diagnosis 2: 'J44.9'
[18:08:22] ℹ️    - Diagnosis 3: 'I10'
[18:08:22] ℹ️    - Diagnosis 4: 'D50.9'
[18:08:22] ℹ️    - Diagnosis 5: 'F41.9'
[18:08:22] ℹ️    - Diagnosis 6: 'F33.8'
[18:08:22] ℹ️  Final extracted MRN: '100990266'
[18:08:22] ℹ️  Final extracted Sex: 'FEMALE'
[18:08:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:08:22] ℹ️  Final extracted Payer Source: 'Medicare'
[18:08:22] ✅ Patient data extraction completed successfully
[18:08:22] ✅    ✅ Patient data extracted successfully
[18:08:22] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[18:08:22] ✅    ✅ Patient identified: Maria Antunes
[18:08:22] ✅    ✅ Patient name validation passed
[18:08:22] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:22] [DOC: 9193002] ℹ️  DOB normalized: 11/22/1934
[18:08:22] [DOC: 9193002] ℹ️  Episode startOfCare normalized: 02/01/2023
[18:08:22] [DOC: 9193002] ℹ️  Episode startOfEpisode normalized: 06/01/2023
[18:08:22] [DOC: 9193002] ℹ️  Episode endOfEpisode normalized: 07/30/2023
[18:08:22] [DOC: 9193002] ✅ Patient date processing completed successfully
[18:08:22] ✅    ✅ Date processing completed
[18:08:22] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990266
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 287-5066
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/01/2023', 'startOfEpisode': '06/01/2023', 'endOfEpisode': '07/30/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F33.8'}]
[18:08:22] 🔄 
🔄 Step 4: Extracting order data...
[18:08:25] ℹ️  Order extraction - MRN: '100990266'
[18:08:25] ℹ️  Order extraction - Sex: 'FEMALE'
[18:08:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:08:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:08:25] ✅ Order data extraction completed successfully
[18:08:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:25] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[18:08:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:08:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:08:25] ✅ Patient name cross-validation successful
[18:08:25] ✅    ✅ Data merged successfully
[18:08:26] ✅    ✅ Order data extracted and validated
[18:08:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:26] [DOC: 9193002] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:26] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:26] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:26] [DOC: 9193002] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:27] [DOC: 9193002] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12939"}
[18:08:27] ❌    ❌ Failed to push order
[18:08:27] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:27] [DOC: 9193002] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[18:08:27] [DOC: 9193002] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:08:27] [DOC: 9193002] ℹ️  Payer Source extracted: 'Medicare'
[18:08:27] [DOC: 9193002] ℹ️  Diagnosis codes being written:
[18:08:27] [DOC: 9193002] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[18:08:27] [DOC: 9193002] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[18:08:27] [DOC: 9193002] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[18:08:27] [DOC: 9193002] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D50.9'
[18:08:27] [DOC: 9193002] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[18:08:27] [DOC: 9193002] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F33.8'
[18:08:27] [DOC: 9193002] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990266
[18:08:27] ✅    ✅ Document 9193002 processed and saved successfully
[18:08:27] 🔄 
🔄 Step 8: Saving API details...
[18:08:27] [DOC: 9193002] ℹ️  API push details saved for document 9193002
[18:08:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9193001                         ║
================================================================================
[18:08:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:08:27] ℹ️  Date: 03/20/2025
[18:08:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:29] [DOC: 9193001] ✅ Text extracted using pdfplumber (1234 chars)
[18:08:29] ✅    ✅ Text extracted using pdfplumber (1234 chars)
[18:08:29] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:32] ℹ️  AI extracted raw sex value: ''
[18:08:32] ℹ️  AI extracted service line: 'LPN'
[18:08:32] ℹ️  AI extracted payer source: ''
[18:08:32] ℹ️  AI extracted diagnoses:
[18:08:32] ℹ️    - Diagnosis 1: 'E11.9'
[18:08:32] ℹ️    - Diagnosis 2: 'J44.9'
[18:08:32] ℹ️    - Diagnosis 3: 'I10'
[18:08:32] ℹ️    - Diagnosis 4: 'None'
[18:08:32] ℹ️    - Diagnosis 5: 'None'
[18:08:32] ℹ️    - Diagnosis 6: 'None'
[18:08:32] ℹ️  Final extracted MRN: '100990266'
[18:08:32] ℹ️  Final extracted Sex: ''
[18:08:32] ℹ️  Final extracted Service Line: 'LPN'
[18:08:32] ℹ️  Final extracted Payer Source: ''
[18:08:32] ✅ Patient data extraction completed successfully
[18:08:32] ✅    ✅ Patient data extracted successfully
[18:08:32] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2023', 'endOfEpisode': '05/31/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:08:32] ✅    ✅ Patient identified: Maria Antunes
[18:08:32] ✅    ✅ Patient name validation passed
[18:08:32] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:32] [DOC: 9193001] ℹ️  DOB normalized: 11/22/1934
[18:08:32] [DOC: 9193001] ℹ️  Episode startOfEpisode normalized: 04/02/2023
[18:08:32] [DOC: 9193001] ℹ️  Episode endOfEpisode normalized: 05/31/2023
[18:08:32] [DOC: 9193001] ✅ Patient date processing completed successfully
[18:08:32] ✅    ✅ Date processing completed
[18:08:32] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Antunes
     └─ dob: 11/22/1934
     └─ patientSex: 
     └─ medicalRecordNo: 100990266
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2023', 'endOfEpisode': '05/31/2023', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'I10'}]
[18:08:32] 🔄 
🔄 Step 4: Extracting order data...
[18:08:34] ℹ️  Order extraction - MRN: '100990266'
[18:08:34] ℹ️  Order extraction - Sex: ''
[18:08:34] ℹ️  Order extraction - Service Line: 'Nursing'
[18:08:34] ℹ️  Order extraction - Payer Source: ''
[18:08:34] ✅ Order data extraction completed successfully
[18:08:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:34] ℹ️  Using MRN from patient data: '100990266' over '100990266'
[18:08:34] ℹ️  Inferred sex as FEMALE from name: Maria
[18:08:34] ℹ️  Combined service lines: Patient='LPN' + Order='Nursing' = 'LPN, Nursing'
[18:08:34] ✅ Patient name cross-validation successful
[18:08:34] ✅    ✅ Data merged successfully
[18:08:36] ✅    ✅ Order data extracted and validated
[18:08:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:36] [DOC: 9193001] ✅ Patient found in local cache: Maria Antunes, ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:36] ✅    ✅ Existing patient found with ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:36] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:36] [DOC: 9193001] ℹ️  Pushing order via API for patient ID: 047e9d30-d949-48fe-a00a-4f451dc1bcc0
[18:08:37] [DOC: 9193001] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12940"}
[18:08:37] ❌    ❌ Failed to push order
[18:08:37] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:37] [DOC: 9193001] ℹ️  Calculated age: 90 from DOB: 11/22/1934
[18:08:37] [DOC: 9193001] ℹ️  Service Line extracted: 'LPN, Nursing'
[18:08:37] [DOC: 9193001] ℹ️  Payer Source extracted: ''
[18:08:37] [DOC: 9193001] ℹ️  Diagnosis codes being written:
[18:08:37] [DOC: 9193001] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[18:08:37] [DOC: 9193001] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[18:08:37] [DOC: 9193001] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[18:08:37] [DOC: 9193001] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:08:37] [DOC: 9193001] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:08:37] [DOC: 9193001] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:08:37] [DOC: 9193001] ✅ Patient data written to CSV: Maria Antunes | Sex: FEMALE | Age: 90 | Service: LPN, Nursing | Payer:  | MRN: 100990266
[18:08:37] ✅    ✅ Document 9193001 processed and saved successfully
[18:08:37] 🔄 
🔄 Step 8: Saving API details...
[18:08:37] [DOC: 9193001] ℹ️  API push details saved for document 9193001
[18:08:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192875                         ║
================================================================================
[18:08:37] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:08:37] ℹ️  Date: 03/20/2025
[18:08:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:39] [DOC: 9192875] ✅ Text extracted using pdfplumber (6159 chars)
[18:08:39] ✅    ✅ Text extracted using pdfplumber (6159 chars)
[18:08:39] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:41] ℹ️  AI extracted raw sex value: 'None'
[18:08:41] ℹ️  AI extracted service line: 'None'
[18:08:41] ℹ️  AI extracted payer source: 'None'
[18:08:41] ℹ️  AI extracted diagnoses:
[18:08:41] ℹ️    - Diagnosis 1: ''
[18:08:41] ℹ️    - Diagnosis 2: ''
[18:08:41] ℹ️    - Diagnosis 3: ''
[18:08:41] ℹ️    - Diagnosis 4: ''
[18:08:41] ℹ️    - Diagnosis 5: ''
[18:08:41] ℹ️    - Diagnosis 6: ''
[18:08:41] ℹ️  Final extracted MRN: ''
[18:08:41] ℹ️  Final extracted Sex: ''
[18:08:41] ℹ️  Final extracted Service Line: ''
[18:08:41] ℹ️  Final extracted Payer Source: ''
[18:08:41] ✅ Patient data extraction completed successfully
[18:08:41] ✅    ✅ Patient data extracted successfully
[18:08:41] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[18:08:41] ⚠️     ❌ Insufficient patient data extracted
[18:08:41] [DOC: 9192875] ℹ️  API push details saved for document 9192875
================================================================================
║                        Processing Document ID: 9192864                         ║
================================================================================
[18:08:41] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:08:41] ℹ️  Date: 03/20/2025
[18:08:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:43] [DOC: 9192864] ✅ Text extracted using pdfplumber (7273 chars)
[18:08:43] ✅    ✅ Text extracted using pdfplumber (7273 chars)
[18:08:43] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:45] ℹ️  AI extracted raw sex value: 'None'
[18:08:45] ℹ️  AI extracted service line: 'None'
[18:08:45] ℹ️  AI extracted payer source: 'None'
[18:08:45] ℹ️  AI extracted diagnoses:
[18:08:45] ℹ️    - Diagnosis 1: ''
[18:08:45] ℹ️    - Diagnosis 2: ''
[18:08:45] ℹ️    - Diagnosis 3: ''
[18:08:45] ℹ️    - Diagnosis 4: ''
[18:08:45] ℹ️    - Diagnosis 5: ''
[18:08:45] ℹ️    - Diagnosis 6: ''
[18:08:45] ℹ️  Final extracted MRN: ''
[18:08:45] ℹ️  Final extracted Sex: ''
[18:08:45] ℹ️  Final extracted Service Line: ''
[18:08:45] ℹ️  Final extracted Payer Source: ''
[18:08:45] ✅ Patient data extraction completed successfully
[18:08:45] ✅    ✅ Patient data extracted successfully
[18:08:45] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[18:08:45] ⚠️     ❌ Insufficient patient data extracted
[18:08:45] [DOC: 9192864] ℹ️  API push details saved for document 9192864
================================================================================
║                        Processing Document ID: 9192858                         ║
================================================================================
[18:08:45] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:08:45] ℹ️  Date: 03/20/2025
[18:08:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:48] [DOC: 9192858] ✅ Text extracted using pdfplumber (6105 chars)
[18:08:48] ✅    ✅ Text extracted using pdfplumber (6105 chars)
[18:08:48] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:49] ℹ️  AI extracted raw sex value: 'None'
[18:08:49] ℹ️  AI extracted service line: 'None'
[18:08:49] ℹ️  AI extracted payer source: 'None'
[18:08:49] ℹ️  AI extracted diagnoses:
[18:08:49] ℹ️    - Diagnosis 1: ''
[18:08:49] ℹ️    - Diagnosis 2: ''
[18:08:49] ℹ️    - Diagnosis 3: ''
[18:08:49] ℹ️    - Diagnosis 4: ''
[18:08:49] ℹ️    - Diagnosis 5: ''
[18:08:49] ℹ️    - Diagnosis 6: ''
[18:08:49] ℹ️  Final extracted MRN: ''
[18:08:49] ℹ️  Final extracted Sex: ''
[18:08:49] ℹ️  Final extracted Service Line: ''
[18:08:49] ℹ️  Final extracted Payer Source: ''
[18:08:49] ✅ Patient data extraction completed successfully
[18:08:49] ✅    ✅ Patient data extracted successfully
[18:08:49] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[18:08:49] ⚠️     ❌ Insufficient patient data extracted
[18:08:49] [DOC: 9192858] ℹ️  API push details saved for document 9192858
================================================================================
║                        Processing Document ID: 9192851                         ║
================================================================================
[18:08:49] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:08:49] ℹ️  Date: 03/20/2025
[18:08:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:55] [DOC: 9192851] ✅ Text extracted using pdfplumber (46498 chars)
[18:08:55] ✅    ✅ Text extracted using pdfplumber (46498 chars)
[18:08:55] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:58] ℹ️  AI extracted raw sex value: ''
[18:08:58] ℹ️  AI extracted service line: ''
[18:08:58] ℹ️  AI extracted payer source: ''
[18:08:58] ℹ️  AI extracted diagnoses:
[18:08:58] ℹ️    - Diagnosis 1: ''
[18:08:58] ℹ️    - Diagnosis 2: ''
[18:08:58] ℹ️    - Diagnosis 3: ''
[18:08:58] ℹ️    - Diagnosis 4: ''
[18:08:58] ℹ️    - Diagnosis 5: ''
[18:08:58] ℹ️    - Diagnosis 6: ''
[18:08:58] ℹ️  Final extracted MRN: ''
[18:08:58] ℹ️  Final extracted Sex: ''
[18:08:58] ℹ️  Final extracted Service Line: ''
[18:08:58] ℹ️  Final extracted Payer Source: ''
[18:08:58] ✅ Patient data extraction completed successfully
[18:08:58] ✅    ✅ Patient data extracted successfully
[18:08:58] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[18:08:58] ⚠️     ❌ Insufficient patient data extracted
[18:08:58] [DOC: 9192851] ℹ️  API push details saved for document 9192851
================================================================================
║                        Processing Document ID: 9192836                         ║
================================================================================
[18:08:58] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[18:08:58] ℹ️  Date: 03/20/2025
[18:08:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:00] [DOC: 9192836] ✅ Text extracted using pdfplumber (1709 chars)
[18:09:00] ✅    ✅ Text extracted using pdfplumber (1709 chars)
[18:09:00] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:03] ℹ️  AI extracted raw sex value: 'F'
[18:09:03] ℹ️  AI extracted service line: 'HHA'
[18:09:03] ℹ️  AI extracted payer source: 'Medicaid/MA'
[18:09:03] ℹ️  AI extracted diagnoses:
[18:09:03] ℹ️    - Diagnosis 1: ''
[18:09:03] ℹ️    - Diagnosis 2: ''
[18:09:03] ℹ️    - Diagnosis 3: ''
[18:09:03] ℹ️    - Diagnosis 4: ''
[18:09:03] ℹ️    - Diagnosis 5: ''
[18:09:03] ℹ️    - Diagnosis 6: ''
[18:09:03] ℹ️  Final extracted MRN: '263005'
[18:09:03] ℹ️  Final extracted Sex: 'FEMALE'
[18:09:03] ℹ️  Final extracted Service Line: 'HHA'
[18:09:03] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[18:09:03] ✅ Patient data extraction completed successfully
[18:09:03] ✅    ✅ Patient data extracted successfully
[18:09:03] 📊 Patient Response
     └─ patientFName: Sarah
     └─ patientLName: Przystarz
     └─ dob: 01/29/1985
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 263005
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2022', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:03] ✅    ✅ Patient identified: Sarah Przystarz
[18:09:03] ✅    ✅ Patient name validation passed
[18:09:03] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:03] [DOC: 9192836] ℹ️  DOB normalized: 01/29/1985
[18:09:03] [DOC: 9192836] ℹ️  Episode startOfCare normalized: 02/07/2022
[18:09:03] [DOC: 9192836] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[18:09:03] [DOC: 9192836] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[18:09:03] [DOC: 9192836] ✅ Patient date processing completed successfully
[18:09:03] ✅    ✅ Date processing completed
[18:09:03] 📊 Processed Patient Data
     └─ patientFName: Sarah
     └─ patientLName: Przystarz
     └─ dob: 01/29/1985
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 263005
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2022', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:03] 🔄 
🔄 Step 4: Extracting order data...
[18:09:06] ℹ️  Order extraction - MRN: '263005'
[18:09:06] ℹ️  Order extraction - Sex: 'FEMALE'
[18:09:06] ℹ️  Order extraction - Service Line: 'HHA'
[18:09:06] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[18:09:06] ✅ Order data extraction completed successfully
[18:09:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:06] ℹ️  Using MRN from patient data: '263005' over '263005'
[18:09:06] ℹ️  Service line consistent in both sources: 'HHA'
[18:09:06] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[18:09:06] ✅ Patient name cross-validation successful
[18:09:06] ✅    ✅ Data merged successfully
[18:09:07] ✅    ✅ Order data extracted and validated
[18:09:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:09:13] [DOC: 9192836] ✅ Patient exists in API: Sarah Przystarz, ID: a32f1f28-4499-4bdb-9490-c78f61c267a2
[18:09:13] ✅    ✅ Existing patient found with ID: a32f1f28-4499-4bdb-9490-c78f61c267a2
[18:09:13] 🔄 
🔄 Step 6: Pushing order to API...
[18:09:13] [DOC: 9192836] ℹ️  Pushing order via API for patient ID: a32f1f28-4499-4bdb-9490-c78f61c267a2
[18:09:14] [DOC: 9192836] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:09:14] ❌    ❌ Failed to push order
[18:09:14] 🔄 
🔄 Step 7: Writing to CSV...
[18:09:14] [DOC: 9192836] ℹ️  Calculated age: 40 from DOB: 01/29/1985
[18:09:14] [DOC: 9192836] ℹ️  Service Line extracted: 'HHA'
[18:09:14] [DOC: 9192836] ℹ️  Payer Source extracted: 'Medicaid/MA'
[18:09:14] [DOC: 9192836] ℹ️  Diagnosis codes being written:
[18:09:14] [DOC: 9192836] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:09:14] [DOC: 9192836] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:09:14] [DOC: 9192836] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:09:14] [DOC: 9192836] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:09:14] [DOC: 9192836] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:09:14] [DOC: 9192836] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:09:14] [DOC: 9192836] ✅ Patient data written to CSV: Sarah Przystarz | Sex: FEMALE | Age: 40 | Service: HHA | Payer: Medicaid/MA | MRN: 263005
[18:09:14] ✅    ✅ Document 9192836 processed and saved successfully
[18:09:14] 🔄 
🔄 Step 8: Saving API details...
[18:09:14] [DOC: 9192836] ℹ️  API push details saved for document 9192836
[18:09:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192805                         ║
================================================================================
[18:09:14] ℹ️  Agency: AccentCare Fall River
[18:09:14] ℹ️  Date: 03/20/2025
[18:09:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:21] [DOC: 9192805] ✅ Text extracted using pdfplumber (1177 chars)
[18:09:21] ✅    ✅ Text extracted using pdfplumber (1177 chars)
[18:09:21] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:24] ℹ️  AI extracted raw sex value: ''
[18:09:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:09:24] ℹ️  AI extracted payer source: ''
[18:09:24] ℹ️  AI extracted diagnoses:
[18:09:24] ℹ️    - Diagnosis 1: 'K51'
[18:09:24] ℹ️    - Diagnosis 2: ''
[18:09:24] ℹ️    - Diagnosis 3: ''
[18:09:24] ℹ️    - Diagnosis 4: ''
[18:09:24] ℹ️    - Diagnosis 5: ''
[18:09:24] ℹ️    - Diagnosis 6: ''
[18:09:24] ℹ️  Final extracted MRN: 'C0200234381101'
[18:09:24] ℹ️  Final extracted Sex: ''
[18:09:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:09:24] ℹ️  Final extracted Payer Source: ''
[18:09:24] ✅ Patient data extraction completed successfully
[18:09:24] ✅    ✅ Patient data extracted successfully
[18:09:24] 📊 Patient Response
     └─ patientFName: SUSAN
     └─ patientLName: STRANZ
     └─ dob: 11/22/1957
     └─ patientSex: 
     └─ medicalRecordNo: C0200234381101
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/17/2025', 'firstDiagnosis': 'K51', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:24] ✅    ✅ Patient identified: SUSAN STRANZ
[18:09:24] ✅    ✅ Patient name validation passed
[18:09:24] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:24] [DOC: 9192805] ℹ️  DOB normalized: 11/22/1957
[18:09:24] [DOC: 9192805] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[18:09:24] [DOC: 9192805] ℹ️  Episode endOfEpisode normalized: 03/17/2025
[18:09:24] [DOC: 9192805] ✅ Patient date processing completed successfully
[18:09:24] ✅    ✅ Date processing completed
[18:09:24] 📊 Processed Patient Data
     └─ patientFName: SUSAN
     └─ patientLName: STRANZ
     └─ dob: 11/22/1957
     └─ patientSex: 
     └─ medicalRecordNo: C0200234381101
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '03/17/2025', 'firstDiagnosis': 'K51', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:24] 🔄 
🔄 Step 4: Extracting order data...
[18:09:27] ℹ️  Order extraction - MRN: 'C0200234381101'
[18:09:27] ℹ️  Order extraction - Sex: ''
[18:09:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:09:27] ℹ️  Order extraction - Payer Source: ''
[18:09:27] ✅ Order data extraction completed successfully
[18:09:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:27] ℹ️  Using MRN from patient data: 'C0200234381101' over 'C0200234381101'
[18:09:27] ℹ️  Inferred sex as FEMALE from name: SUSAN
[18:09:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:09:27] ✅ Patient name cross-validation successful
[18:09:27] ✅    ✅ Data merged successfully
[18:09:28] ✅    ✅ Order data extracted and validated
[18:09:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:09:33] [DOC: 9192805] ✅ Patient exists in API: SUSAN STRANZ, ID: d7db664a-06aa-44c5-b9cd-7c7068351270
[18:09:33] ✅    ✅ Existing patient found with ID: d7db664a-06aa-44c5-b9cd-7c7068351270
[18:09:33] 🔄 
🔄 Step 6: Pushing order to API...
[18:09:33] [DOC: 9192805] ℹ️  Pushing order via API for patient ID: d7db664a-06aa-44c5-b9cd-7c7068351270
[18:09:34] [DOC: 9192805] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14218"}
[18:09:34] ❌    ❌ Failed to push order
[18:09:34] 🔄 
🔄 Step 7: Writing to CSV...
[18:09:34] [DOC: 9192805] ℹ️  Calculated age: 67 from DOB: 11/22/1957
[18:09:34] [DOC: 9192805] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:09:34] [DOC: 9192805] ℹ️  Payer Source extracted: ''
[18:09:34] [DOC: 9192805] ℹ️  Diagnosis codes being written:
[18:09:34] [DOC: 9192805] ℹ️    - Latest_Episode_Firstdiagnosis: 'K51'
[18:09:34] [DOC: 9192805] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:09:34] [DOC: 9192805] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:09:34] [DOC: 9192805] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:09:34] [DOC: 9192805] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:09:34] [DOC: 9192805] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:09:34] [DOC: 9192805] ✅ Patient data written to CSV: SUSAN STRANZ | Sex: FEMALE | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: C0200234381101
[18:09:34] ✅    ✅ Document 9192805 processed and saved successfully
[18:09:34] 🔄 
🔄 Step 8: Saving API details...
[18:09:34] [DOC: 9192805] ℹ️  API push details saved for document 9192805
[18:09:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192708                         ║
================================================================================
[18:09:34] ℹ️  Agency: AccentCare Fall River
[18:09:34] ℹ️  Date: 03/20/2025
[18:09:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:38] [DOC: 9192708] ✅ Text extracted using pdfplumber (16536 chars)
[18:09:38] ✅    ✅ Text extracted using pdfplumber (16536 chars)
[18:09:38] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:41] ℹ️  AI extracted raw sex value: 'F'
[18:09:41] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[18:09:41] ℹ️  AI extracted payer source: ''
[18:09:41] ℹ️  AI extracted diagnoses:
[18:09:41] ℹ️    - Diagnosis 1: 'F03.911'
[18:09:41] ℹ️    - Diagnosis 2: 'F03.918'
[18:09:41] ℹ️    - Diagnosis 3: 'F03.93'
[18:09:41] ℹ️    - Diagnosis 4: 'F32.A'
[18:09:41] ℹ️    - Diagnosis 5: 'F03.94'
[18:09:41] ℹ️    - Diagnosis 6: 'F03.92'
[18:09:41] ℹ️  Final extracted MRN: 'C0200197668001'
[18:09:41] ℹ️  Final extracted Sex: 'FEMALE'
[18:09:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[18:09:41] ℹ️  Final extracted Payer Source: ''
[18:09:41] ✅ Patient data extraction completed successfully
[18:09:41] ✅    ✅ Patient data extracted successfully
[18:09:41] 📊 Patient Response
     └─ patientFName: PATRICIA
     └─ patientLName: RUMNEY
     └─ dob: 01/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200197668001
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Psychiatric Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/19/2024', 'endOfEpisode': None, 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'F03.918', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.92'}]
[18:09:41] ✅    ✅ Patient identified: PATRICIA RUMNEY
[18:09:41] ✅    ✅ Patient name validation passed
[18:09:41] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:41] [DOC: 9192708] ℹ️  DOB normalized: 01/11/1940
[18:09:41] [DOC: 9192708] ℹ️  Episode startOfEpisode normalized: 12/19/2024
[18:09:41] [DOC: 9192708] ✅ Patient date processing completed successfully
[18:09:41] ✅    ✅ Date processing completed
[18:09:41] 📊 Processed Patient Data
     └─ patientFName: PATRICIA
     └─ patientLName: RUMNEY
     └─ dob: 01/11/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200197668001
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Psychiatric Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/19/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'F03.918', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': 'F32.A', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.92'}]
[18:09:41] 🔄 
🔄 Step 4: Extracting order data...
[18:09:44] ℹ️  Order extraction - MRN: 'C0200197668001'
[18:09:44] ℹ️  Order extraction - Sex: 'FEMALE'
[18:09:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[18:09:44] ℹ️  Order extraction - Payer Source: ''
[18:09:44] ✅ Order data extraction completed successfully
[18:09:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:44] ℹ️  Using MRN from patient data: 'C0200197668001' over 'C0200197668001'
[18:09:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Psychiatric Nursing'
[18:09:44] ✅ Patient name cross-validation successful
[18:09:44] ✅    ✅ Data merged successfully
[18:09:45] ✅    ✅ Order data extracted and validated
[18:09:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:10:00] [DOC: 9192708] ℹ️  Patient not found in cache or API: PATRICIA RUMNEY
[18:10:00] [DOC: 9192708] ℹ️  Patient not found, creating new patient via API...
[18:10:00] [DOC: 9192708] ℹ️  Creating patient via API: PATRICIA RUMNEY
[18:10:01] [DOC: 9192708] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:10:01] ❌    ❌ Failed to create patient
[18:10:01] [DOC: 9192708] ℹ️  API push details saved for document 9192708
================================================================================
║                        Processing Document ID: 9192681                         ║
================================================================================
[18:10:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:10:01] ℹ️  Date: 03/20/2025
[18:10:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:03] [DOC: 9192681] ✅ Text extracted using pdfplumber (1215 chars)
[18:10:03] ✅    ✅ Text extracted using pdfplumber (1215 chars)
[18:10:03] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:06] ℹ️  AI extracted raw sex value: ''
[18:10:06] ℹ️  AI extracted service line: 'Physical Therapy'
[18:10:06] ℹ️  AI extracted payer source: ''
[18:10:06] ℹ️  AI extracted diagnoses:
[18:10:06] ℹ️    - Diagnosis 1: 'F03.911'
[18:10:06] ℹ️    - Diagnosis 2: 'M62.81'
[18:10:06] ℹ️    - Diagnosis 3: 'R26.89'
[18:10:06] ℹ️    - Diagnosis 4: 'None'
[18:10:06] ℹ️    - Diagnosis 5: 'None'
[18:10:06] ℹ️    - Diagnosis 6: 'None'
[18:10:06] ℹ️  Final extracted MRN: 'MA221128094306'
[18:10:06] ℹ️  Final extracted Sex: ''
[18:10:06] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:10:06] ℹ️  Final extracted Payer Source: ''
[18:10:06] ✅ Patient data extraction completed successfully
[18:10:06] ✅    ✅ Patient data extracted successfully
[18:10:06] 📊 Patient Response
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/07/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:10:06] ✅    ✅ Patient identified: Vicente Amaro
[18:10:06] ✅    ✅ Patient name validation passed
[18:10:06] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:06] [DOC: 9192681] ℹ️  DOB normalized: 09/09/1943
[18:10:06] [DOC: 9192681] ℹ️  Episode startOfEpisode normalized: 09/10/2024
[18:10:06] [DOC: 9192681] ℹ️  Episode endOfEpisode normalized: 11/07/2024
[18:10:06] [DOC: 9192681] ✅ Patient date processing completed successfully
[18:10:06] ✅    ✅ Date processing completed
[18:10:06] 📊 Processed Patient Data
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/07/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89'}]
[18:10:06] 🔄 
🔄 Step 4: Extracting order data...
[18:10:09] ℹ️  Order extraction - MRN: 'MA221128094306'
[18:10:09] ℹ️  Order extraction - Sex: ''
[18:10:09] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:10:09] ℹ️  Order extraction - Payer Source: ''
[18:10:09] ✅ Order data extraction completed successfully
[18:10:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:09] ℹ️  Using MRN from patient data: 'MA221128094306' over 'MA221128094306'
[18:10:09] ⚠️  Could not determine sex using any available method
[18:10:09] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:10:09] ✅ Patient name cross-validation successful
[18:10:09] ✅    ✅ Data merged successfully
[18:10:10] ✅    ✅ Order data extracted and validated
[18:10:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:10:10] [DOC: 9192681] ✅ Patient found in local cache: Vicente Amaro, ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[18:10:10] ✅    ✅ Existing patient found with ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[18:10:10] 🔄 
🔄 Step 6: Pushing order to API...
[18:10:10] [DOC: 9192681] ℹ️  Pushing order via API for patient ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[18:10:11] [DOC: 9192681] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12905"}
[18:10:11] ❌    ❌ Failed to push order
[18:10:11] 🔄 
🔄 Step 7: Writing to CSV...
[18:10:11] [DOC: 9192681] ℹ️  Calculated age: 81 from DOB: 09/09/1943
[18:10:11] [DOC: 9192681] ℹ️  Service Line extracted: 'Physical Therapy'
[18:10:11] [DOC: 9192681] ℹ️  Payer Source extracted: ''
[18:10:11] [DOC: 9192681] ℹ️  Diagnosis codes being written:
[18:10:11] [DOC: 9192681] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.911'
[18:10:11] [DOC: 9192681] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[18:10:11] [DOC: 9192681] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.89'
[18:10:11] [DOC: 9192681] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:10:11] [DOC: 9192681] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:10:11] [DOC: 9192681] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:10:11] [DOC: 9192681] ✅ Patient data written to CSV: Vicente Amaro | Sex:  | Age: 81 | Service: Physical Therapy | Payer:  | MRN: MA221128094306
[18:10:11] ✅    ✅ Document 9192681 processed and saved successfully
[18:10:11] 🔄 
🔄 Step 8: Saving API details...
[18:10:11] [DOC: 9192681] ℹ️  API push details saved for document 9192681
[18:10:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192680                         ║
================================================================================
[18:10:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:10:11] ℹ️  Date: 03/20/2025
[18:10:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:13] [DOC: 9192680] ✅ Text extracted using pdfplumber (11892 chars)
[18:10:13] ✅    ✅ Text extracted using pdfplumber (11892 chars)
[18:10:13] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:16] ℹ️  AI extracted raw sex value: 'M'
[18:10:16] ℹ️  AI extracted service line: 'Physical Therapy'
[18:10:16] ℹ️  AI extracted payer source: 'Medicare'
[18:10:16] ℹ️  AI extracted diagnoses:
[18:10:16] ℹ️    - Diagnosis 1: 'F03.911'
[18:10:16] ℹ️    - Diagnosis 2: 'M62.81'
[18:10:16] ℹ️    - Diagnosis 3: 'R26.89'
[18:10:16] ℹ️    - Diagnosis 4: 'F03.93'
[18:10:16] ℹ️    - Diagnosis 5: 'F03.94'
[18:10:16] ℹ️    - Diagnosis 6: 'I50.9'
[18:10:16] ℹ️  Final extracted MRN: 'MA221128094306'
[18:10:16] ℹ️  Final extracted Sex: 'MALE'
[18:10:16] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:10:16] ℹ️  Final extracted Payer Source: 'Medicare'
[18:10:16] ✅ Patient data extraction completed successfully
[18:10:16] ✅    ✅ Patient data extracted successfully
[18:10:16] 📊 Patient Response
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/12/2024', 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/08/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'F03.93', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'I50.9'}]
[18:10:16] ✅    ✅ Patient identified: Vicente Amaro
[18:10:16] ✅    ✅ Patient name validation passed
[18:10:16] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:16] [DOC: 9192680] ℹ️  DOB normalized: 09/09/1943
[18:10:16] [DOC: 9192680] ℹ️  Episode startOfCare normalized: 07/12/2024
[18:10:16] [DOC: 9192680] ℹ️  Episode startOfEpisode normalized: 09/10/2024
[18:10:16] [DOC: 9192680] ℹ️  Episode endOfEpisode normalized: 11/08/2024
[18:10:16] [DOC: 9192680] ✅ Patient date processing completed successfully
[18:10:16] ✅    ✅ Date processing completed
[18:10:16] 📊 Processed Patient Data
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '07/12/2024', 'startOfEpisode': '09/10/2024', 'endOfEpisode': '11/08/2024', 'firstDiagnosis': 'F03.911', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'F03.93', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'I50.9'}]
[18:10:16] 🔄 
🔄 Step 4: Extracting order data...
[18:10:19] ℹ️  Order extraction - MRN: 'MA221128094306'
[18:10:19] ℹ️  Order extraction - Sex: 'MALE'
[18:10:19] ℹ️  Order extraction - Service Line: 'PT'
[18:10:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:10:19] ✅ Order data extraction completed successfully
[18:10:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:19] ℹ️  Using MRN from patient data: 'MA221128094306' over 'MA221128094306'
[18:10:19] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[18:10:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:10:19] ✅ Patient name cross-validation successful
[18:10:19] ✅    ✅ Data merged successfully
[18:10:21] ✅    ✅ Order data extracted and validated
[18:10:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:10:21] [DOC: 9192680] ✅ Patient found in local cache: Vicente Amaro, ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[18:10:21] ✅    ✅ Existing patient found with ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[18:10:21] 🔄 
🔄 Step 6: Pushing order to API...
[18:10:21] [DOC: 9192680] ℹ️  Pushing order via API for patient ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[18:10:22] [DOC: 9192680] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12906"}
[18:10:22] ❌    ❌ Failed to push order
[18:10:22] 🔄 
🔄 Step 7: Writing to CSV...
[18:10:22] [DOC: 9192680] ℹ️  Calculated age: 81 from DOB: 09/09/1943
[18:10:22] [DOC: 9192680] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[18:10:22] [DOC: 9192680] ℹ️  Payer Source extracted: 'Medicare'
[18:10:22] [DOC: 9192680] ℹ️  Diagnosis codes being written:
[18:10:22] [DOC: 9192680] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.911'
[18:10:22] [DOC: 9192680] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[18:10:22] [DOC: 9192680] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.89'
[18:10:22] [DOC: 9192680] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F03.93'
[18:10:22] [DOC: 9192680] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F03.94'
[18:10:22] [DOC: 9192680] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.9'
[18:10:22] [DOC: 9192680] ✅ Patient data written to CSV: Vicente Amaro | Sex: MALE | Age: 81 | Service: PT, Physical Therapy | Payer: Medicare | MRN: MA221128094306
[18:10:22] ✅    ✅ Document 9192680 processed and saved successfully
[18:10:22] 🔄 
🔄 Step 8: Saving API details...
[18:10:22] [DOC: 9192680] ℹ️  API push details saved for document 9192680
[18:10:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192674                         ║
================================================================================
[18:10:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:10:22] ℹ️  Date: 03/20/2025
[18:10:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:24] [DOC: 9192674] ✅ Text extracted using pdfplumber (1962 chars)
[18:10:24] ✅    ✅ Text extracted using pdfplumber (1950 chars)
[18:10:24] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:27] ℹ️  AI extracted raw sex value: ''
[18:10:27] ℹ️  AI extracted service line: 'Physical Therapy'
[18:10:27] ℹ️  AI extracted payer source: ''
[18:10:27] ℹ️  AI extracted diagnoses:
[18:10:27] ℹ️    - Diagnosis 1: 'I12.9'
[18:10:27] ℹ️    - Diagnosis 2: 'N17.9'
[18:10:27] ℹ️    - Diagnosis 3: 'G35'
[18:10:27] ℹ️    - Diagnosis 4: ''
[18:10:27] ℹ️    - Diagnosis 5: ''
[18:10:27] ℹ️    - Diagnosis 6: ''
[18:10:27] ℹ️  Final extracted MRN: 'MA210203125202'
[18:10:27] ℹ️  Final extracted Sex: ''
[18:10:27] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:10:27] ℹ️  Final extracted Payer Source: ''
[18:10:27] ✅ Patient data extraction completed successfully
[18:10:27] ✅    ✅ Patient data extracted successfully
[18:10:27] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:10:27] ✅    ✅ Patient identified: Ida Souza
[18:10:27] ✅    ✅ Patient name validation passed
[18:10:27] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:27] [DOC: 9192674] ℹ️  DOB normalized: 12/11/1952
[18:10:27] [DOC: 9192674] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[18:10:27] [DOC: 9192674] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[18:10:27] [DOC: 9192674] ✅ Patient date processing completed successfully
[18:10:27] ✅    ✅ Date processing completed
[18:10:27] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:10:27] 🔄 
🔄 Step 4: Extracting order data...
[18:10:30] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:10:30] ℹ️  Order extraction - Sex: ''
[18:10:30] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:10:30] ℹ️  Order extraction - Payer Source: ''
[18:10:30] ✅ Order data extraction completed successfully
[18:10:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:30] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:10:30] ⚠️  Could not determine sex using any available method
[18:10:30] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:10:30] ✅ Patient name cross-validation successful
[18:10:30] ✅    ✅ Data merged successfully
[18:10:31] ✅    ✅ Order data extracted and validated
[18:10:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:10:36] [DOC: 9192674] ℹ️  Patient not found in cache or API: Ida Souza
[18:10:36] [DOC: 9192674] ℹ️  Patient not found, creating new patient via API...
[18:10:36] [DOC: 9192674] ℹ️  Creating patient via API: Ida Souza
[18:10:37] [DOC: 9192674] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:10:37] ❌    ❌ Failed to create patient
[18:10:37] [DOC: 9192674] ℹ️  API push details saved for document 9192674
================================================================================
║                        Processing Document ID: 9192670                         ║
================================================================================
[18:10:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:10:37] ℹ️  Date: 03/20/2025
[18:10:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:43] [DOC: 9192670] ✅ Text extracted using pdfplumber (13212 chars)
[18:10:43] ✅    ✅ Text extracted using pdfplumber (13212 chars)
[18:10:43] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:46] ℹ️  AI extracted raw sex value: 'F'
[18:10:46] ℹ️  AI extracted service line: 'PT'
[18:10:46] ℹ️  AI extracted payer source: ''
[18:10:46] ℹ️  AI extracted diagnoses:
[18:10:46] ℹ️    - Diagnosis 1: 'I12.0'
[18:10:46] ℹ️    - Diagnosis 2: 'N18.9'
[18:10:46] ℹ️    - Diagnosis 3: 'M86.0XXA'
[18:10:46] ℹ️    - Diagnosis 4: 'L97.10'
[18:10:46] ℹ️    - Diagnosis 5: 'I48.91'
[18:10:46] ℹ️    - Diagnosis 6: 'G35.2'
[18:10:46] ℹ️  Final extracted MRN: 'MA210203125202'
[18:10:46] ℹ️  Final extracted Sex: 'FEMALE'
[18:10:46] ℹ️  Final extracted Service Line: 'PT'
[18:10:46] ℹ️  Final extracted Payer Source: ''
[18:10:46] ✅ Patient data extraction completed successfully
[18:10:46] ✅    ✅ Patient data extracted successfully
[18:10:46] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/07/2025', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18.9', 'thirdDiagnosis': 'M86.0XXA', 'fourthDiagnosis': 'L97.10', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'G35.2'}]
[18:10:46] ✅    ✅ Patient identified: Ida Souza
[18:10:46] ✅    ✅ Patient name validation passed
[18:10:46] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:46] [DOC: 9192670] ℹ️  DOB normalized: 12/11/1952
[18:10:46] [DOC: 9192670] ℹ️  Episode startOfCare normalized: 01/07/2025
[18:10:46] [DOC: 9192670] ℹ️  Episode startOfEpisode normalized: 01/22/2025
[18:10:46] [DOC: 9192670] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[18:10:46] [DOC: 9192670] ✅ Patient date processing completed successfully
[18:10:46] ✅    ✅ Date processing completed
[18:10:46] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/07/2025', 'startOfEpisode': '01/22/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18.9', 'thirdDiagnosis': 'M86.0XXA', 'fourthDiagnosis': 'L97.10', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'G35.2'}]
[18:10:46] 🔄 
🔄 Step 4: Extracting order data...
[18:10:49] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:10:49] ℹ️  Order extraction - Sex: 'FEMALE'
[18:10:49] ℹ️  Order extraction - Service Line: 'PT'
[18:10:49] ℹ️  Order extraction - Payer Source: ''
[18:10:49] ✅ Order data extraction completed successfully
[18:10:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:49] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:10:49] ℹ️  Service line consistent in both sources: 'PT'
[18:10:49] ✅ Patient name cross-validation successful
[18:10:49] ✅    ✅ Data merged successfully
[18:10:50] ⚠️     ❌ Skipping - missing episode start date
[18:10:50] [DOC: 9192670] ℹ️  API push details saved for document 9192670
================================================================================
║                        Processing Document ID: 9192669                         ║
================================================================================
[18:10:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:10:50] ℹ️  Date: 03/20/2025
[18:10:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:53] [DOC: 9192669] ✅ Text extracted using pdfplumber (2372 chars)
[18:10:53] ✅    ✅ Text extracted using pdfplumber (2360 chars)
[18:10:53] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:56] ℹ️  AI extracted raw sex value: ''
[18:10:56] ℹ️  AI extracted service line: 'PT'
[18:10:56] ℹ️  AI extracted payer source: ''
[18:10:56] ℹ️  AI extracted diagnoses:
[18:10:56] ℹ️    - Diagnosis 1: 'I12.9'
[18:10:56] ℹ️    - Diagnosis 2: 'N17.9'
[18:10:56] ℹ️    - Diagnosis 3: 'G35'
[18:10:56] ℹ️    - Diagnosis 4: 'None'
[18:10:56] ℹ️    - Diagnosis 5: 'None'
[18:10:56] ℹ️    - Diagnosis 6: 'None'
[18:10:56] ℹ️  Final extracted MRN: 'MA210203125202'
[18:10:56] ℹ️  Final extracted Sex: ''
[18:10:56] ℹ️  Final extracted Service Line: 'PT'
[18:10:56] ℹ️  Final extracted Payer Source: ''
[18:10:56] ✅ Patient data extraction completed successfully
[18:10:56] ✅    ✅ Patient data extracted successfully
[18:10:56] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:10:56] ✅    ✅ Patient identified: Ida Souza
[18:10:56] ✅    ✅ Patient name validation passed
[18:10:56] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:56] [DOC: 9192669] ℹ️  DOB normalized: 12/11/1952
[18:10:56] [DOC: 9192669] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[18:10:56] [DOC: 9192669] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[18:10:56] [DOC: 9192669] ✅ Patient date processing completed successfully
[18:10:56] ✅    ✅ Date processing completed
[18:10:56] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[18:10:56] 🔄 
🔄 Step 4: Extracting order data...
[18:10:59] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:10:59] ℹ️  Order extraction - Sex: ''
[18:10:59] ℹ️  Order extraction - Service Line: 'PT'
[18:10:59] ℹ️  Order extraction - Payer Source: ''
[18:10:59] ✅ Order data extraction completed successfully
[18:10:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:59] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:10:59] ⚠️  Could not determine sex using any available method
[18:10:59] ℹ️  Service line consistent in both sources: 'PT'
[18:10:59] ✅ Patient name cross-validation successful
[18:10:59] ✅    ✅ Data merged successfully
[18:11:00] ✅    ✅ Order data extracted and validated
[18:11:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:11:06] [DOC: 9192669] ℹ️  Patient not found in cache or API: Ida Souza
[18:11:06] [DOC: 9192669] ℹ️  Patient not found, creating new patient via API...
[18:11:06] [DOC: 9192669] ℹ️  Creating patient via API: Ida Souza
[18:11:07] [DOC: 9192669] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:11:07] ❌    ❌ Failed to create patient
[18:11:07] [DOC: 9192669] ℹ️  API push details saved for document 9192669
================================================================================
║                        Processing Document ID: 9192666                         ║
================================================================================
[18:11:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:07] ℹ️  Date: 03/20/2025
[18:11:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:10] [DOC: 9192666] ✅ Text extracted using pdfplumber (1964 chars)
[18:11:10] ✅    ✅ Text extracted using pdfplumber (1952 chars)
[18:11:10] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:13] ℹ️  AI extracted raw sex value: ''
[18:11:13] ℹ️  AI extracted service line: 'Physical Therapy'
[18:11:13] ℹ️  AI extracted payer source: ''
[18:11:13] ℹ️  AI extracted diagnoses:
[18:11:13] ℹ️    - Diagnosis 1: 'I12.9'
[18:11:13] ℹ️    - Diagnosis 2: 'N17.9'
[18:11:13] ℹ️    - Diagnosis 3: 'G35'
[18:11:13] ℹ️    - Diagnosis 4: 'None'
[18:11:13] ℹ️    - Diagnosis 5: 'None'
[18:11:13] ℹ️    - Diagnosis 6: 'None'
[18:11:13] ℹ️  Final extracted MRN: 'MA210203125202'
[18:11:13] ℹ️  Final extracted Sex: ''
[18:11:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:11:13] ℹ️  Final extracted Payer Source: ''
[18:11:13] ✅ Patient data extraction completed successfully
[18:11:13] ✅    ✅ Patient data extracted successfully
[18:11:13] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:11:13] ✅    ✅ Patient identified: Ida Souza
[18:11:13] ✅    ✅ Patient name validation passed
[18:11:13] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:13] [DOC: 9192666] ℹ️  DOB normalized: 12/11/1952
[18:11:13] [DOC: 9192666] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[18:11:13] [DOC: 9192666] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[18:11:13] [DOC: 9192666] ✅ Patient date processing completed successfully
[18:11:13] ✅    ✅ Date processing completed
[18:11:13] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[18:11:13] 🔄 
🔄 Step 4: Extracting order data...
[18:11:15] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:11:15] ℹ️  Order extraction - Sex: ''
[18:11:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:11:15] ℹ️  Order extraction - Payer Source: ''
[18:11:15] ✅ Order data extraction completed successfully
[18:11:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:15] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:11:15] ⚠️  Could not determine sex using any available method
[18:11:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:11:15] ✅ Patient name cross-validation successful
[18:11:15] ✅    ✅ Data merged successfully
[18:11:16] ✅    ✅ Order data extracted and validated
[18:11:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:11:31] [DOC: 9192666] ℹ️  Patient not found in cache or API: Ida Souza
[18:11:31] [DOC: 9192666] ℹ️  Patient not found, creating new patient via API...
[18:11:31] [DOC: 9192666] ℹ️  Creating patient via API: Ida Souza
[18:11:32] [DOC: 9192666] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:11:32] ❌    ❌ Failed to create patient
[18:11:32] [DOC: 9192666] ℹ️  API push details saved for document 9192666
================================================================================
║                        Processing Document ID: 9192664                         ║
================================================================================
[18:11:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:32] ℹ️  Date: 03/20/2025
[18:11:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:38] [DOC: 9192664] ✅ Text extracted using pdfplumber (14823 chars)
[18:11:38] ✅    ✅ Text extracted using pdfplumber (14823 chars)
[18:11:38] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:41] ℹ️  AI extracted raw sex value: 'F'
[18:11:41] ℹ️  AI extracted service line: 'PT'
[18:11:41] ℹ️  AI extracted payer source: ''
[18:11:41] ℹ️  AI extracted diagnoses:
[18:11:41] ℹ️    - Diagnosis 1: 'I12.0'
[18:11:41] ℹ️    - Diagnosis 2: 'N18'
[18:11:41] ℹ️    - Diagnosis 3: 'M96.60'
[18:11:41] ℹ️    - Diagnosis 4: 'I48.91'
[18:11:41] ℹ️    - Diagnosis 5: 'G35.2'
[18:11:41] ℹ️    - Diagnosis 6: 'M79.2'
[18:11:41] ℹ️  Final extracted MRN: 'MA210203125202'
[18:11:41] ℹ️  Final extracted Sex: 'FEMALE'
[18:11:41] ℹ️  Final extracted Service Line: 'PT'
[18:11:41] ℹ️  Final extracted Payer Source: ''
[18:11:41] ✅ Patient data extraction completed successfully
[18:11:41] ✅    ✅ Patient data extracted successfully
[18:11:41] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18', 'thirdDiagnosis': 'M96.60', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'G35.2', 'sixthDiagnosis': 'M79.2'}]
[18:11:41] ✅    ✅ Patient identified: Ida Souza
[18:11:41] ✅    ✅ Patient name validation passed
[18:11:41] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:41] [DOC: 9192664] ℹ️  DOB normalized: 12/11/1952
[18:11:41] [DOC: 9192664] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[18:11:41] [DOC: 9192664] ✅ Patient date processing completed successfully
[18:11:41] ✅    ✅ Date processing completed
[18:11:41] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18', 'thirdDiagnosis': 'M96.60', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'G35.2', 'sixthDiagnosis': 'M79.2'}]
[18:11:41] 🔄 
🔄 Step 4: Extracting order data...
[18:11:44] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:11:44] ℹ️  Order extraction - Sex: 'FEMALE'
[18:11:44] ℹ️  Order extraction - Service Line: 'PT'
[18:11:44] ℹ️  Order extraction - Payer Source: ''
[18:11:44] ✅ Order data extraction completed successfully
[18:11:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:44] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:11:44] ℹ️  Service line consistent in both sources: 'PT'
[18:11:44] ✅ Patient name cross-validation successful
[18:11:44] ✅    ✅ Data merged successfully
[18:11:45] ✅    ✅ Order data extracted and validated
[18:11:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:11:50] [DOC: 9192664] ℹ️  Patient not found in cache or API: Ida Souza
[18:11:50] [DOC: 9192664] ℹ️  Patient not found, creating new patient via API...
[18:11:50] [DOC: 9192664] ℹ️  Creating patient via API: Ida Souza
[18:11:51] [DOC: 9192664] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:11:51] ❌    ❌ Failed to create patient
[18:11:51] [DOC: 9192664] ℹ️  API push details saved for document 9192664
================================================================================
║                        Processing Document ID: 9192663                         ║
================================================================================
[18:11:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:51] ℹ️  Date: 03/20/2025
[18:11:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:54] [DOC: 9192663] ✅ Text extracted using pdfplumber (2242 chars)
[18:11:54] ✅    ✅ Text extracted using pdfplumber (2230 chars)
[18:11:54] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:57] ℹ️  AI extracted raw sex value: ''
[18:11:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:11:57] ℹ️  AI extracted payer source: ''
[18:11:57] ℹ️  AI extracted diagnoses:
[18:11:57] ℹ️    - Diagnosis 1: 'I12.9'
[18:11:57] ℹ️    - Diagnosis 2: 'N17.9'
[18:11:57] ℹ️    - Diagnosis 3: 'G35'
[18:11:57] ℹ️    - Diagnosis 4: ''
[18:11:57] ℹ️    - Diagnosis 5: ''
[18:11:57] ℹ️    - Diagnosis 6: ''
[18:11:57] ℹ️  Final extracted MRN: 'MA210203125202'
[18:11:57] ℹ️  Final extracted Sex: ''
[18:11:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:11:57] ℹ️  Final extracted Payer Source: ''
[18:11:57] ✅ Patient data extraction completed successfully
[18:11:57] ✅    ✅ Patient data extracted successfully
[18:11:57] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:11:57] ✅    ✅ Patient identified: Ida Souza
[18:11:57] ✅    ✅ Patient name validation passed
[18:11:57] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:57] [DOC: 9192663] ℹ️  DOB normalized: 12/11/1952
[18:11:57] [DOC: 9192663] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[18:11:57] [DOC: 9192663] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[18:11:57] [DOC: 9192663] ✅ Patient date processing completed successfully
[18:11:57] ✅    ✅ Date processing completed
[18:11:57] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:11:57] 🔄 
🔄 Step 4: Extracting order data...
[18:11:59] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:11:59] ℹ️  Order extraction - Sex: ''
[18:11:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:11:59] ℹ️  Order extraction - Payer Source: ''
[18:11:59] ✅ Order data extraction completed successfully
[18:11:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:59] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:11:59] ⚠️  Could not determine sex using any available method
[18:11:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:11:59] ✅ Patient name cross-validation successful
[18:11:59] ✅    ✅ Data merged successfully
[18:12:00] ✅    ✅ Order data extracted and validated
[18:12:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:06] [DOC: 9192663] ℹ️  Patient not found in cache or API: Ida Souza
[18:12:06] [DOC: 9192663] ℹ️  Patient not found, creating new patient via API...
[18:12:06] [DOC: 9192663] ℹ️  Creating patient via API: Ida Souza
[18:12:07] [DOC: 9192663] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:12:07] ❌    ❌ Failed to create patient
[18:12:07] [DOC: 9192663] ℹ️  API push details saved for document 9192663
================================================================================
║                        Processing Document ID: 9192660                         ║
================================================================================
[18:12:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:07] ℹ️  Date: 03/20/2025
[18:12:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:10] [DOC: 9192660] ✅ Text extracted using pdfplumber (1924 chars)
[18:12:10] ✅    ✅ Text extracted using pdfplumber (1912 chars)
[18:12:10] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:13] ℹ️  AI extracted raw sex value: ''
[18:12:13] ℹ️  AI extracted service line: 'Physical Therapy'
[18:12:13] ℹ️  AI extracted payer source: ''
[18:12:13] ℹ️  AI extracted diagnoses:
[18:12:13] ℹ️    - Diagnosis 1: 'I12.9'
[18:12:13] ℹ️    - Diagnosis 2: 'N17.9'
[18:12:13] ℹ️    - Diagnosis 3: 'G35'
[18:12:13] ℹ️    - Diagnosis 4: 'None'
[18:12:13] ℹ️    - Diagnosis 5: 'None'
[18:12:13] ℹ️    - Diagnosis 6: 'None'
[18:12:13] ℹ️  Final extracted MRN: 'MA210203125202'
[18:12:13] ℹ️  Final extracted Sex: ''
[18:12:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:12:13] ℹ️  Final extracted Payer Source: ''
[18:12:13] ✅ Patient data extraction completed successfully
[18:12:13] ✅    ✅ Patient data extracted successfully
[18:12:13] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:12:13] ✅    ✅ Patient identified: Ida Souza
[18:12:13] ✅    ✅ Patient name validation passed
[18:12:13] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:13] [DOC: 9192660] ℹ️  DOB normalized: 12/11/1952
[18:12:13] [DOC: 9192660] ℹ️  Episode startOfEpisode normalized: 12/31/2024
[18:12:13] [DOC: 9192660] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[18:12:13] [DOC: 9192660] ✅ Patient date processing completed successfully
[18:12:13] ✅    ✅ Date processing completed
[18:12:13] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/31/2024', 'endOfEpisode': '02/28/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[18:12:13] 🔄 
🔄 Step 4: Extracting order data...
[18:12:15] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:12:15] ℹ️  Order extraction - Sex: ''
[18:12:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:12:15] ℹ️  Order extraction - Payer Source: ''
[18:12:15] ✅ Order data extraction completed successfully
[18:12:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:15] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:12:15] ⚠️  Could not determine sex using any available method
[18:12:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:12:15] ✅ Patient name cross-validation successful
[18:12:15] ✅    ✅ Data merged successfully
[18:12:17] ✅    ✅ Order data extracted and validated
[18:12:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:24] [DOC: 9192660] ℹ️  Patient not found in cache or API: Ida Souza
[18:12:24] [DOC: 9192660] ℹ️  Patient not found, creating new patient via API...
[18:12:24] [DOC: 9192660] ℹ️  Creating patient via API: Ida Souza
[18:12:25] [DOC: 9192660] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:12:25] ❌    ❌ Failed to create patient
[18:12:25] [DOC: 9192660] ℹ️  API push details saved for document 9192660
================================================================================
║                        Processing Document ID: 9192657                         ║
================================================================================
[18:12:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:25] ℹ️  Date: 03/20/2025
[18:12:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:28] [DOC: 9192657] ✅ Text extracted using pdfplumber (17755 chars)
[18:12:28] ✅    ✅ Text extracted using pdfplumber (17755 chars)
[18:12:28] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:31] ℹ️  AI extracted raw sex value: 'F'
[18:12:31] ℹ️  AI extracted service line: 'OT'
[18:12:31] ℹ️  AI extracted payer source: ''
[18:12:31] ℹ️  AI extracted diagnoses:
[18:12:31] ℹ️    - Diagnosis 1: 'altered mental status'
[18:12:31] ℹ️    - Diagnosis 2: 'weakness/limitations/bed bound'
[18:12:31] ℹ️    - Diagnosis 3: 'MS'
[18:12:31] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[18:12:31] ℹ️    - Diagnosis 5: 'Spondylosis w/o myelopathy or radiculopathy, cervical region'
[18:12:31] ℹ️    - Diagnosis 6: 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'
[18:12:31] ℹ️  Final extracted MRN: 'MA210203125202'
[18:12:31] ℹ️  Final extracted Sex: 'FEMALE'
[18:12:31] ℹ️  Final extracted Service Line: 'OT'
[18:12:31] ℹ️  Final extracted Payer Source: ''
[18:12:31] ✅ Patient data extraction completed successfully
[18:12:31] ✅    ✅ Patient data extracted successfully
[18:12:31] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '', 'firstDiagnosis': 'altered mental status', 'secondDiagnosis': 'weakness/limitations/bed bound', 'thirdDiagnosis': 'MS', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'Spondylosis w/o myelopathy or radiculopathy, cervical region', 'sixthDiagnosis': 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'}]
[18:12:31] ✅    ✅ Patient identified: Ida Souza
[18:12:31] ✅    ✅ Patient name validation passed
[18:12:31] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:31] [DOC: 9192657] ℹ️  DOB normalized: 12/11/1952
[18:12:31] [DOC: 9192657] ℹ️  Episode startOfEpisode normalized: 01/11/2025
[18:12:31] [DOC: 9192657] ✅ Patient date processing completed successfully
[18:12:31] ✅    ✅ Date processing completed
[18:12:31] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '', 'firstDiagnosis': 'altered mental status', 'secondDiagnosis': 'weakness/limitations/bed bound', 'thirdDiagnosis': 'MS', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'Spondylosis w/o myelopathy or radiculopathy, cervical region', 'sixthDiagnosis': 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'}]
[18:12:31] 🔄 
🔄 Step 4: Extracting order data...
[18:12:34] ℹ️  Order extraction - MRN: 'MA210203125202'
[18:12:34] ℹ️  Order extraction - Sex: 'FEMALE'
[18:12:34] ℹ️  Order extraction - Service Line: 'OT'
[18:12:34] ℹ️  Order extraction - Payer Source: ''
[18:12:34] ✅ Order data extraction completed successfully
[18:12:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:34] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[18:12:34] ℹ️  Service line consistent in both sources: 'OT'
[18:12:34] ✅ Patient name cross-validation successful
[18:12:34] ✅    ✅ Data merged successfully
[18:12:35] ⚠️     ❌ Skipping - missing episode start date
[18:12:35] [DOC: 9192657] ℹ️  API push details saved for document 9192657
================================================================================
║                        Processing Document ID: 9192655                         ║
================================================================================
[18:12:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:35] ℹ️  Date: 03/20/2025
[18:12:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:37] [DOC: 9192655] ✅ Text extracted using pdfplumber (12735 chars)
[18:12:37] ✅    ✅ Text extracted using pdfplumber (12735 chars)
[18:12:37] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:40] ℹ️  AI extracted raw sex value: 'F'
[18:12:40] ℹ️  AI extracted service line: 'Physical Therapy'
[18:12:40] ℹ️  AI extracted payer source: 'Medicare'
[18:12:40] ℹ️  AI extracted diagnoses:
[18:12:40] ℹ️    - Diagnosis 1: 'S82.891'
[18:12:40] ℹ️    - Diagnosis 2: 'R29.6'
[18:12:40] ℹ️    - Diagnosis 3: 'R27.0'
[18:12:40] ℹ️    - Diagnosis 4: 'F31.9'
[18:12:40] ℹ️    - Diagnosis 5: 'E11.9'
[18:12:40] ℹ️    - Diagnosis 6: 'M47.12'
[18:12:40] ℹ️  Final extracted MRN: 'MA210216076302'
[18:12:40] ℹ️  Final extracted Sex: 'FEMALE'
[18:12:40] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:12:40] ℹ️  Final extracted Payer Source: 'Medicare'
[18:12:40] ✅ Patient data extraction completed successfully
[18:12:40] ✅    ✅ Patient data extracted successfully
[18:12:40] 📊 Patient Response
     └─ patientFName: Jeannine
     └─ patientLName: Lavigne
     └─ dob: 09/27/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210216076302
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 394 Briggs Rd
     └─ city: Westport
     └─ state: MA
     └─ zip: 02790
     └─ email: None
     └─ phoneNumber: (774) 319-4126
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'S82.891', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'R27.0', 'fourthDiagnosis': 'F31.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'M47.12'}]
[18:12:40] ✅    ✅ Patient identified: Jeannine Lavigne
[18:12:40] ✅    ✅ Patient name validation passed
[18:12:40] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:40] [DOC: 9192655] ℹ️  DOB normalized: 09/27/1963
[18:12:40] [DOC: 9192655] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[18:12:40] [DOC: 9192655] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[18:12:40] [DOC: 9192655] ✅ Patient date processing completed successfully
[18:12:40] ✅    ✅ Date processing completed
[18:12:40] 📊 Processed Patient Data
     └─ patientFName: Jeannine
     └─ patientLName: Lavigne
     └─ dob: 09/27/1963
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210216076302
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 394 Briggs Rd
     └─ city: Westport
     └─ state: MA
     └─ zip: 02790
     └─ phoneNumber: (774) 319-4126
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'S82.891', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'R27.0', 'fourthDiagnosis': 'F31.9', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'M47.12'}]
[18:12:40] 🔄 
🔄 Step 4: Extracting order data...
[18:12:43] ℹ️  Order extraction - MRN: 'MA210216076302'
[18:12:43] ℹ️  Order extraction - Sex: 'FEMALE'
[18:12:43] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:12:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:12:43] ✅ Order data extraction completed successfully
[18:12:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:43] ℹ️  Using MRN from patient data: 'MA210216076302' over 'MA210216076302'
[18:12:43] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:12:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:12:43] ✅ Patient name cross-validation successful
[18:12:43] ✅    ✅ Data merged successfully
[18:12:44] ✅    ✅ Order data extracted and validated
[18:12:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:51] [DOC: 9192655] ℹ️  Patient not found in cache or API: Jeannine Lavigne
[18:12:51] [DOC: 9192655] ℹ️  Patient not found, creating new patient via API...
[18:12:51] [DOC: 9192655] ℹ️  Creating patient via API: Jeannine Lavigne
[18:12:53] [DOC: 9192655] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:12:53] ❌    ❌ Failed to create patient
[18:12:53] [DOC: 9192655] ℹ️  API push details saved for document 9192655
================================================================================
║                        Processing Document ID: 9192653                         ║
================================================================================
[18:12:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:53] ℹ️  Date: 03/20/2025
[18:12:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:55] [DOC: 9192653] ✅ Text extracted using pdfplumber (10148 chars)
[18:12:55] ✅    ✅ Text extracted using pdfplumber (10148 chars)
[18:12:55] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:58] ℹ️  AI extracted raw sex value: 'F'
[18:12:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:12:58] ℹ️  AI extracted payer source: 'Medicare'
[18:12:58] ℹ️  AI extracted diagnoses:
[18:12:58] ℹ️    - Diagnosis 1: 'E11.65'
[18:12:58] ℹ️    - Diagnosis 2: 'E78.00'
[18:12:58] ℹ️    - Diagnosis 3: 'M15.9'
[18:12:58] ℹ️    - Diagnosis 4: 'K91.2'
[18:12:58] ℹ️    - Diagnosis 5: 'G25.81'
[18:12:58] ℹ️    - Diagnosis 6: 'D50.9'
[18:12:58] ℹ️  Final extracted MRN: 'MA241111055903'
[18:12:58] ℹ️  Final extracted Sex: 'FEMALE'
[18:12:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:12:58] ℹ️  Final extracted Payer Source: 'Medicare'
[18:12:58] ✅ Patient data extraction completed successfully
[18:12:58] ✅    ✅ Patient data extracted successfully
[18:12:58] 📊 Patient Response
     └─ patientFName: Anabela
     └─ patientLName: Ferrinha
     └─ dob: 05/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241111055903
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 956 Rockdale Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 728-5414
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/14/2024', 'startOfEpisode': '11/14/2024', 'endOfEpisode': '01/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'K91.2', 'fifthDiagnosis': 'G25.81', 'sixthDiagnosis': 'D50.9'}]
[18:12:58] ✅    ✅ Patient identified: Anabela Ferrinha
[18:12:58] ✅    ✅ Patient name validation passed
[18:12:58] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:58] [DOC: 9192653] ℹ️  DOB normalized: 05/24/1959
[18:12:58] [DOC: 9192653] ℹ️  Episode startOfCare normalized: 11/14/2024
[18:12:58] [DOC: 9192653] ℹ️  Episode startOfEpisode normalized: 11/14/2024
[18:12:58] [DOC: 9192653] ℹ️  Episode endOfEpisode normalized: 01/12/2025
[18:12:58] [DOC: 9192653] ✅ Patient date processing completed successfully
[18:12:58] ✅    ✅ Date processing completed
[18:12:58] 📊 Processed Patient Data
     └─ patientFName: Anabela
     └─ patientLName: Ferrinha
     └─ dob: 05/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241111055903
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 956 Rockdale Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 728-5414
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/14/2024', 'startOfEpisode': '11/14/2024', 'endOfEpisode': '01/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'K91.2', 'fifthDiagnosis': 'G25.81', 'sixthDiagnosis': 'D50.9'}]
[18:12:58] 🔄 
🔄 Step 4: Extracting order data...
[18:13:01] ℹ️  Order extraction - MRN: 'MA241111055903'
[18:13:01] ℹ️  Order extraction - Sex: 'FEMALE'
[18:13:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:13:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:13:01] ✅ Order data extraction completed successfully
[18:13:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:01] ℹ️  Using MRN from patient data: 'MA241111055903' over 'MA241111055903'
[18:13:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:13:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:13:01] ✅ Patient name cross-validation successful
[18:13:01] ✅    ✅ Data merged successfully
[18:13:02] ✅    ✅ Order data extracted and validated
[18:13:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:13:10] [DOC: 9192653] ℹ️  Patient not found in cache or API: Anabela Ferrinha
[18:13:10] [DOC: 9192653] ℹ️  Patient not found, creating new patient via API...
[18:13:10] [DOC: 9192653] ℹ️  Creating patient via API: Anabela Ferrinha
[18:13:11] [DOC: 9192653] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:13:11] ❌    ❌ Failed to create patient
[18:13:11] [DOC: 9192653] ℹ️  API push details saved for document 9192653
================================================================================
║                        Processing Document ID: 9192650                         ║
================================================================================
[18:13:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:13:11] ℹ️  Date: 03/20/2025
[18:13:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:14] [DOC: 9192650] ✅ Text extracted using pdfplumber (12431 chars)
[18:13:14] ✅    ✅ Text extracted using pdfplumber (12431 chars)
[18:13:14] 🔄 
🔄 Step 2: Extracting patient data...
[18:13:17] ℹ️  AI extracted raw sex value: 'F'
[18:13:17] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[18:13:17] ℹ️  AI extracted payer source: 'Medicare'
[18:13:17] ℹ️  AI extracted diagnoses:
[18:13:17] ℹ️    - Diagnosis 1: 'L97.519'
[18:13:17] ℹ️    - Diagnosis 2: 'E11.621'
[18:13:17] ℹ️    - Diagnosis 3: 'Z47.81'
[18:13:17] ℹ️    - Diagnosis 4: 'L03.115'
[18:13:17] ℹ️    - Diagnosis 5: 'M54.31'
[18:13:17] ℹ️    - Diagnosis 6: 'I10'
[18:13:17] ℹ️  Final extracted MRN: '100994258'
[18:13:17] ℹ️  Final extracted Sex: 'FEMALE'
[18:13:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[18:13:17] ℹ️  Final extracted Payer Source: 'Medicare'
[18:13:17] ✅ Patient data extraction completed successfully
[18:13:17] ✅    ✅ Patient data extracted successfully
[18:13:17] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994258
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 830 County St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 202-2631
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/21/2023', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'L97.519', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'Z47.81', 'fourthDiagnosis': 'L03.115', 'fifthDiagnosis': 'M54.31', 'sixthDiagnosis': 'I10'}]
[18:13:17] ✅    ✅ Patient identified: Gloria Diaz
[18:13:17] ✅    ✅ Patient name validation passed
[18:13:17] 🔄 
🔄 Step 3: Processing patient dates...
[18:13:17] [DOC: 9192650] ℹ️  DOB normalized: 04/09/1951
[18:13:17] [DOC: 9192650] ℹ️  Episode startOfCare normalized: 04/21/2023
[18:13:17] [DOC: 9192650] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[18:13:17] [DOC: 9192650] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[18:13:17] [DOC: 9192650] ✅ Patient date processing completed successfully
[18:13:17] ✅    ✅ Date processing completed
[18:13:17] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994258
     └─ billingProvider: BAUTISTA, KARMINA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 830 County St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 202-2631
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/21/2023', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'L97.519', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'Z47.81', 'fourthDiagnosis': 'L03.115', 'fifthDiagnosis': 'M54.31', 'sixthDiagnosis': 'I10'}]
[18:13:17] 🔄 
🔄 Step 4: Extracting order data...
[18:13:20] ℹ️  Order extraction - MRN: '100994258'
[18:13:20] ℹ️  Order extraction - Sex: 'FEMALE'
[18:13:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[18:13:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:13:20] ✅ Order data extraction completed successfully
[18:13:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:20] ℹ️  Using MRN from patient data: '100994258' over '100994258'
[18:13:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[18:13:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:13:20] ✅ Patient name cross-validation successful
[18:13:20] ✅    ✅ Data merged successfully
[18:13:21] ✅    ✅ Order data extracted and validated
[18:13:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:13:27] [DOC: 9192650] ℹ️  Patient not found in cache or API: Gloria Diaz
[18:13:27] [DOC: 9192650] ℹ️  Patient not found, creating new patient via API...
[18:13:27] [DOC: 9192650] ℹ️  Creating patient via API: Gloria Diaz
[18:13:28] [DOC: 9192650] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:13:28] ❌    ❌ Failed to create patient
[18:13:28] [DOC: 9192650] ℹ️  API push details saved for document 9192650
================================================================================
║                        Processing Document ID: 9192560                         ║
================================================================================
[18:13:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:13:28] ℹ️  Date: 03/20/2025
[18:13:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:30] [DOC: 9192560] ✅ Text extracted using pdfplumber (1334 chars)
[18:13:30] ✅    ✅ Text extracted using pdfplumber (1322 chars)
[18:13:30] 🔄 
🔄 Step 2: Extracting patient data...
[18:13:33] ℹ️  AI extracted raw sex value: ''
[18:13:33] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:13:33] ℹ️  AI extracted payer source: ''
[18:13:33] ℹ️  AI extracted diagnoses:
[18:13:33] ℹ️    - Diagnosis 1: 'G89.4'
[18:13:33] ℹ️    - Diagnosis 2: 'M54.9'
[18:13:33] ℹ️    - Diagnosis 3: 'J44.89'
[18:13:33] ℹ️    - Diagnosis 4: 'None'
[18:13:33] ℹ️    - Diagnosis 5: 'None'
[18:13:33] ℹ️    - Diagnosis 6: 'None'
[18:13:33] ℹ️  Final extracted MRN: 'MA241122026006'
[18:13:33] ℹ️  Final extracted Sex: ''
[18:13:33] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:13:33] ℹ️  Final extracted Payer Source: ''
[18:13:33] ✅ Patient data extraction completed successfully
[18:13:33] ✅    ✅ Patient data extracted successfully
[18:13:33] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:13:33] ✅    ✅ Patient identified: Elba Rivera
[18:13:33] ✅    ✅ Patient name validation passed
[18:13:33] 🔄 
🔄 Step 3: Processing patient dates...
[18:13:33] [DOC: 9192560] ℹ️  DOB normalized: 02/14/1960
[18:13:33] [DOC: 9192560] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[18:13:33] [DOC: 9192560] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[18:13:33] [DOC: 9192560] ✅ Patient date processing completed successfully
[18:13:33] ✅    ✅ Date processing completed
[18:13:33] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'M54.9', 'thirdDiagnosis': 'J44.89'}]
[18:13:33] 🔄 
🔄 Step 4: Extracting order data...
[18:13:36] ℹ️  Order extraction - MRN: 'MA241122026006'
[18:13:36] ℹ️  Order extraction - Sex: ''
[18:13:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:13:36] ℹ️  Order extraction - Payer Source: ''
[18:13:36] ✅ Order data extraction completed successfully
[18:13:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:36] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[18:13:36] ⚠️  Could not determine sex using any available method
[18:13:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:13:36] ✅ Patient name cross-validation successful
[18:13:36] ✅    ✅ Data merged successfully
[18:13:37] ✅    ✅ Order data extracted and validated
[18:13:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:13:53] [DOC: 9192560] ℹ️  Patient not found in cache or API: Elba Rivera
[18:13:53] [DOC: 9192560] ℹ️  Patient not found, creating new patient via API...
[18:13:53] [DOC: 9192560] ℹ️  Creating patient via API: Elba Rivera
[18:13:54] [DOC: 9192560] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:13:54] ❌    ❌ Failed to create patient
[18:13:54] [DOC: 9192560] ℹ️  API push details saved for document 9192560
================================================================================
║                        Processing Document ID: 9192558                         ║
================================================================================
[18:13:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:13:54] ℹ️  Date: 03/20/2025
[18:13:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:57] [DOC: 9192558] ✅ Text extracted using pdfplumber (14570 chars)
[18:13:57] ✅    ✅ Text extracted using pdfplumber (14570 chars)
[18:13:57] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:00] ℹ️  AI extracted raw sex value: 'F'
[18:14:00] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:14:00] ℹ️  AI extracted payer source: ''
[18:14:00] ℹ️  AI extracted diagnoses:
[18:14:00] ℹ️    - Diagnosis 1: 'I110'
[18:14:00] ℹ️    - Diagnosis 2: 'I5032'
[18:14:00] ℹ️    - Diagnosis 3: ''
[18:14:00] ℹ️    - Diagnosis 4: ''
[18:14:00] ℹ️    - Diagnosis 5: ''
[18:14:00] ℹ️    - Diagnosis 6: ''
[18:14:00] ℹ️  Final extracted MRN: 'MA221012094404'
[18:14:00] ℹ️  Final extracted Sex: 'FEMALE'
[18:14:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:14:00] ℹ️  Final extracted Payer Source: ''
[18:14:00] ✅ Patient data extraction completed successfully
[18:14:00] ✅    ✅ Patient data extracted successfully
[18:14:00] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/29/2025', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:00] ✅    ✅ Patient identified: Maria Ferreira
[18:14:00] ✅    ✅ Patient name validation passed
[18:14:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:00] [DOC: 9192558] ℹ️  DOB normalized: 09/29/1944
[18:14:00] [DOC: 9192558] ℹ️  Episode startOfCare normalized: 01/29/2025
[18:14:00] [DOC: 9192558] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:14:00] [DOC: 9192558] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:14:00] [DOC: 9192558] ✅ Patient date processing completed successfully
[18:14:00] ✅    ✅ Date processing completed
[18:14:00] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/29/2025', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:00] 🔄 
🔄 Step 4: Extracting order data...
[18:14:02] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:14:02] ℹ️  Order extraction - Sex: 'FEMALE'
[18:14:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:14:02] ℹ️  Order extraction - Payer Source: ''
[18:14:02] ✅ Order data extraction completed successfully
[18:14:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:02] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:14:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:14:02] ✅ Patient name cross-validation successful
[18:14:02] ✅    ✅ Data merged successfully
[18:14:04] ✅    ✅ Order data extracted and validated
[18:14:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:14:04] [DOC: 9192558] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:04] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:04] 🔄 
🔄 Step 6: Pushing order to API...
[18:14:04] [DOC: 9192558] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:05] [DOC: 9192558] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13994"}
[18:14:05] ❌    ❌ Failed to push order
[18:14:05] 🔄 
🔄 Step 7: Writing to CSV...
[18:14:05] [DOC: 9192558] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:14:05] [DOC: 9192558] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:14:05] [DOC: 9192558] ℹ️  Payer Source extracted: ''
[18:14:05] [DOC: 9192558] ℹ️  Diagnosis codes being written:
[18:14:05] [DOC: 9192558] ℹ️    - Latest_Episode_Firstdiagnosis: 'I110'
[18:14:05] [DOC: 9192558] ℹ️    - Latest_Episode_Seconddiagnosis: 'I5032'
[18:14:05] [DOC: 9192558] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:14:05] [DOC: 9192558] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:14:05] [DOC: 9192558] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:14:05] [DOC: 9192558] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:14:05] [DOC: 9192558] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA221012094404
[18:14:05] ✅    ✅ Document 9192558 processed and saved successfully
[18:14:05] 🔄 
🔄 Step 8: Saving API details...
[18:14:05] [DOC: 9192558] ℹ️  API push details saved for document 9192558
[18:14:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192556                         ║
================================================================================
[18:14:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:05] ℹ️  Date: 03/20/2025
[18:14:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:07] [DOC: 9192556] ✅ Text extracted using pdfplumber (10623 chars)
[18:14:07] ✅    ✅ Text extracted using pdfplumber (10623 chars)
[18:14:07] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:10] ℹ️  AI extracted raw sex value: 'F'
[18:14:10] ℹ️  AI extracted service line: 'OT'
[18:14:10] ℹ️  AI extracted payer source: ''
[18:14:10] ℹ️  AI extracted diagnoses:
[18:14:10] ℹ️    - Diagnosis 1: ''
[18:14:10] ℹ️    - Diagnosis 2: ''
[18:14:10] ℹ️    - Diagnosis 3: ''
[18:14:10] ℹ️    - Diagnosis 4: ''
[18:14:10] ℹ️    - Diagnosis 5: ''
[18:14:10] ℹ️    - Diagnosis 6: ''
[18:14:10] ℹ️  Final extracted MRN: 'MA221012094404'
[18:14:10] ℹ️  Final extracted Sex: 'FEMALE'
[18:14:10] ℹ️  Final extracted Service Line: 'OT'
[18:14:10] ℹ️  Final extracted Payer Source: ''
[18:14:10] ✅ Patient data extraction completed successfully
[18:14:10] ✅    ✅ Patient data extracted successfully
[18:14:10] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:10] ✅    ✅ Patient identified: Maria Ferreira
[18:14:10] ✅    ✅ Patient name validation passed
[18:14:10] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:10] [DOC: 9192556] ℹ️  DOB normalized: 09/29/1944
[18:14:10] [DOC: 9192556] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[18:14:10] [DOC: 9192556] ✅ Patient date processing completed successfully
[18:14:10] ✅    ✅ Date processing completed
[18:14:10] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:10] 🔄 
🔄 Step 4: Extracting order data...
[18:14:13] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:14:13] ℹ️  Order extraction - Sex: 'FEMALE'
[18:14:13] ℹ️  Order extraction - Service Line: 'OT'
[18:14:13] ℹ️  Order extraction - Payer Source: ''
[18:14:13] ✅ Order data extraction completed successfully
[18:14:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:13] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:14:13] ℹ️  Service line consistent in both sources: 'OT'
[18:14:13] ✅ Patient name cross-validation successful
[18:14:13] ✅    ✅ Data merged successfully
[18:14:14] ⚠️     ❌ Skipping - missing episode start date
[18:14:14] [DOC: 9192556] ℹ️  API push details saved for document 9192556
================================================================================
║                        Processing Document ID: 9192555                         ║
================================================================================
[18:14:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:14] ℹ️  Date: 03/20/2025
[18:14:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:16] [DOC: 9192555] ✅ Text extracted using pdfplumber (1474 chars)
[18:14:16] ✅    ✅ Text extracted using pdfplumber (1462 chars)
[18:14:16] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:19] ℹ️  AI extracted raw sex value: ''
[18:14:19] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:14:19] ℹ️  AI extracted payer source: ''
[18:14:19] ℹ️  AI extracted diagnoses:
[18:14:19] ℹ️    - Diagnosis 1: 'I11.0'
[18:14:19] ℹ️    - Diagnosis 2: 'I50.32'
[18:14:19] ℹ️    - Diagnosis 3: ''
[18:14:19] ℹ️    - Diagnosis 4: ''
[18:14:19] ℹ️    - Diagnosis 5: ''
[18:14:19] ℹ️    - Diagnosis 6: ''
[18:14:19] ℹ️  Final extracted MRN: 'MA221012094404'
[18:14:19] ℹ️  Final extracted Sex: ''
[18:14:19] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:14:19] ℹ️  Final extracted Payer Source: ''
[18:14:19] ✅ Patient data extraction completed successfully
[18:14:19] ✅    ✅ Patient data extracted successfully
[18:14:19] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:19] ✅    ✅ Patient identified: Maria Ferreira
[18:14:19] ✅    ✅ Patient name validation passed
[18:14:19] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:19] [DOC: 9192555] ℹ️  DOB normalized: 09/29/1944
[18:14:19] [DOC: 9192555] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:14:19] [DOC: 9192555] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:14:19] [DOC: 9192555] ✅ Patient date processing completed successfully
[18:14:19] ✅    ✅ Date processing completed
[18:14:19] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:19] 🔄 
🔄 Step 4: Extracting order data...
[18:14:21] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:14:21] ℹ️  Order extraction - Sex: ''
[18:14:21] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:14:21] ℹ️  Order extraction - Payer Source: ''
[18:14:21] ✅ Order data extraction completed successfully
[18:14:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:21] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:14:21] ℹ️  Inferred sex as FEMALE from name: Maria
[18:14:21] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:14:21] ✅ Patient name cross-validation successful
[18:14:21] ✅    ✅ Data merged successfully
[18:14:22] ✅    ✅ Order data extracted and validated
[18:14:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:14:22] [DOC: 9192555] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:22] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:22] 🔄 
🔄 Step 6: Pushing order to API...
[18:14:22] [DOC: 9192555] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:24] [DOC: 9192555] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13985"}
[18:14:24] ❌    ❌ Failed to push order
[18:14:24] 🔄 
🔄 Step 7: Writing to CSV...
[18:14:24] [DOC: 9192555] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:14:24] [DOC: 9192555] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:14:24] [DOC: 9192555] ℹ️  Payer Source extracted: ''
[18:14:24] [DOC: 9192555] ℹ️  Diagnosis codes being written:
[18:14:24] [DOC: 9192555] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:14:24] [DOC: 9192555] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[18:14:24] [DOC: 9192555] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:14:24] [DOC: 9192555] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:14:24] [DOC: 9192555] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:14:24] [DOC: 9192555] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:14:24] [DOC: 9192555] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[18:14:24] ✅    ✅ Document 9192555 processed and saved successfully
[18:14:24] 🔄 
🔄 Step 8: Saving API details...
[18:14:24] [DOC: 9192555] ℹ️  API push details saved for document 9192555
[18:14:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192553                         ║
================================================================================
[18:14:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:24] ℹ️  Date: 03/20/2025
[18:14:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:26] [DOC: 9192553] ✅ Text extracted using pdfplumber (1382 chars)
[18:14:26] ✅    ✅ Text extracted using pdfplumber (1370 chars)
[18:14:26] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:29] ℹ️  AI extracted raw sex value: ''
[18:14:29] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:14:29] ℹ️  AI extracted payer source: ''
[18:14:29] ℹ️  AI extracted diagnoses:
[18:14:29] ℹ️    - Diagnosis 1: 'I11.0'
[18:14:29] ℹ️    - Diagnosis 2: 'I50.32'
[18:14:29] ℹ️    - Diagnosis 3: ''
[18:14:29] ℹ️    - Diagnosis 4: ''
[18:14:29] ℹ️    - Diagnosis 5: ''
[18:14:29] ℹ️    - Diagnosis 6: ''
[18:14:29] ℹ️  Final extracted MRN: 'MA221012094404'
[18:14:29] ℹ️  Final extracted Sex: ''
[18:14:29] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:14:29] ℹ️  Final extracted Payer Source: ''
[18:14:29] ✅ Patient data extraction completed successfully
[18:14:29] ✅    ✅ Patient data extracted successfully
[18:14:29] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:29] ✅    ✅ Patient identified: Maria Ferreira
[18:14:29] ✅    ✅ Patient name validation passed
[18:14:29] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:29] [DOC: 9192553] ℹ️  DOB normalized: 09/29/1944
[18:14:29] [DOC: 9192553] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:14:29] [DOC: 9192553] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:14:29] [DOC: 9192553] ✅ Patient date processing completed successfully
[18:14:29] ✅    ✅ Date processing completed
[18:14:29] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:29] 🔄 
🔄 Step 4: Extracting order data...
[18:14:31] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:14:31] ℹ️  Order extraction - Sex: ''
[18:14:31] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:14:31] ℹ️  Order extraction - Payer Source: ''
[18:14:31] ✅ Order data extraction completed successfully
[18:14:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:31] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:14:31] ℹ️  Inferred sex as FEMALE from name: Maria
[18:14:31] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:14:31] ✅ Patient name cross-validation successful
[18:14:31] ✅    ✅ Data merged successfully
[18:14:32] ✅    ✅ Order data extracted and validated
[18:14:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:14:32] [DOC: 9192553] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:32] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:32] 🔄 
🔄 Step 6: Pushing order to API...
[18:14:32] [DOC: 9192553] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:33] [DOC: 9192553] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13986"}
[18:14:33] ❌    ❌ Failed to push order
[18:14:33] 🔄 
🔄 Step 7: Writing to CSV...
[18:14:33] [DOC: 9192553] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:14:33] [DOC: 9192553] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:14:33] [DOC: 9192553] ℹ️  Payer Source extracted: ''
[18:14:33] [DOC: 9192553] ℹ️  Diagnosis codes being written:
[18:14:33] [DOC: 9192553] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:14:33] [DOC: 9192553] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[18:14:33] [DOC: 9192553] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:14:33] [DOC: 9192553] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:14:33] [DOC: 9192553] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:14:33] [DOC: 9192553] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:14:33] [DOC: 9192553] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[18:14:33] ✅    ✅ Document 9192553 processed and saved successfully
[18:14:33] 🔄 
🔄 Step 8: Saving API details...
[18:14:33] [DOC: 9192553] ℹ️  API push details saved for document 9192553
[18:14:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192550                         ║
================================================================================
[18:14:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:33] ℹ️  Date: 03/20/2025
[18:14:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:36] [DOC: 9192550] ✅ Text extracted using pdfplumber (1377 chars)
[18:14:36] ✅    ✅ Text extracted using pdfplumber (1365 chars)
[18:14:36] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:39] ℹ️  AI extracted raw sex value: ''
[18:14:39] ℹ️  AI extracted service line: 'Physical Therapy'
[18:14:39] ℹ️  AI extracted payer source: ''
[18:14:39] ℹ️  AI extracted diagnoses:
[18:14:39] ℹ️    - Diagnosis 1: 'I11.0'
[18:14:39] ℹ️    - Diagnosis 2: 'I50.32'
[18:14:39] ℹ️    - Diagnosis 3: ''
[18:14:39] ℹ️    - Diagnosis 4: ''
[18:14:39] ℹ️    - Diagnosis 5: ''
[18:14:39] ℹ️    - Diagnosis 6: ''
[18:14:39] ℹ️  Final extracted MRN: 'MA221012094404'
[18:14:39] ℹ️  Final extracted Sex: ''
[18:14:39] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:14:39] ℹ️  Final extracted Payer Source: ''
[18:14:39] ✅ Patient data extraction completed successfully
[18:14:39] ✅    ✅ Patient data extracted successfully
[18:14:39] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:39] ✅    ✅ Patient identified: Maria Ferreira
[18:14:39] ✅    ✅ Patient name validation passed
[18:14:39] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:39] [DOC: 9192550] ℹ️  DOB normalized: 09/29/1944
[18:14:39] [DOC: 9192550] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:14:39] [DOC: 9192550] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:14:39] [DOC: 9192550] ✅ Patient date processing completed successfully
[18:14:39] ✅    ✅ Date processing completed
[18:14:39] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:14:39] 🔄 
🔄 Step 4: Extracting order data...
[18:14:42] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:14:42] ℹ️  Order extraction - Sex: ''
[18:14:42] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:14:42] ℹ️  Order extraction - Payer Source: ''
[18:14:42] ✅ Order data extraction completed successfully
[18:14:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:42] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:14:42] ℹ️  Inferred sex as FEMALE from name: Maria
[18:14:42] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:14:42] ✅ Patient name cross-validation successful
[18:14:42] ✅    ✅ Data merged successfully
[18:14:43] ✅    ✅ Order data extracted and validated
[18:14:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:14:43] [DOC: 9192550] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:43] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:43] 🔄 
🔄 Step 6: Pushing order to API...
[18:14:43] [DOC: 9192550] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:44] [DOC: 9192550] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14001"}
[18:14:44] ❌    ❌ Failed to push order
[18:14:44] 🔄 
🔄 Step 7: Writing to CSV...
[18:14:44] [DOC: 9192550] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:14:44] [DOC: 9192550] ℹ️  Service Line extracted: 'Physical Therapy'
[18:14:44] [DOC: 9192550] ℹ️  Payer Source extracted: ''
[18:14:44] [DOC: 9192550] ℹ️  Diagnosis codes being written:
[18:14:44] [DOC: 9192550] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:14:44] [DOC: 9192550] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[18:14:44] [DOC: 9192550] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:14:44] [DOC: 9192550] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:14:44] [DOC: 9192550] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:14:44] [DOC: 9192550] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:14:44] [DOC: 9192550] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA221012094404
[18:14:44] ✅    ✅ Document 9192550 processed and saved successfully
[18:14:44] 🔄 
🔄 Step 8: Saving API details...
[18:14:44] [DOC: 9192550] ℹ️  API push details saved for document 9192550
[18:14:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192547                         ║
================================================================================
[18:14:44] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:44] ℹ️  Date: 03/20/2025
[18:14:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:46] [DOC: 9192547] ✅ Text extracted using pdfplumber (1386 chars)
[18:14:46] ✅    ✅ Text extracted using pdfplumber (1374 chars)
[18:14:46] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:49] ℹ️  AI extracted raw sex value: ''
[18:14:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:14:49] ℹ️  AI extracted payer source: ''
[18:14:49] ℹ️  AI extracted diagnoses:
[18:14:49] ℹ️    - Diagnosis 1: 'I11.0'
[18:14:49] ℹ️    - Diagnosis 2: 'I50.32'
[18:14:49] ℹ️    - Diagnosis 3: 'None'
[18:14:49] ℹ️    - Diagnosis 4: 'None'
[18:14:49] ℹ️    - Diagnosis 5: 'None'
[18:14:49] ℹ️    - Diagnosis 6: 'None'
[18:14:49] ℹ️  Final extracted MRN: 'MA221012094404'
[18:14:49] ℹ️  Final extracted Sex: ''
[18:14:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:14:49] ℹ️  Final extracted Payer Source: ''
[18:14:49] ✅ Patient data extraction completed successfully
[18:14:49] ✅    ✅ Patient data extracted successfully
[18:14:49] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:14:49] ✅    ✅ Patient identified: Maria Ferreira
[18:14:49] ✅    ✅ Patient name validation passed
[18:14:49] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:49] [DOC: 9192547] ℹ️  DOB normalized: 09/29/1944
[18:14:49] [DOC: 9192547] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:14:49] [DOC: 9192547] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:14:49] [DOC: 9192547] ✅ Patient date processing completed successfully
[18:14:49] ✅    ✅ Date processing completed
[18:14:49] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32'}]
[18:14:49] 🔄 
🔄 Step 4: Extracting order data...
[18:14:51] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:14:51] ℹ️  Order extraction - Sex: ''
[18:14:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:14:51] ℹ️  Order extraction - Payer Source: ''
[18:14:51] ✅ Order data extraction completed successfully
[18:14:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:51] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:14:51] ℹ️  Inferred sex as FEMALE from name: Maria
[18:14:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:14:51] ✅ Patient name cross-validation successful
[18:14:51] ✅    ✅ Data merged successfully
[18:14:52] ✅    ✅ Order data extracted and validated
[18:14:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:14:52] [DOC: 9192547] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:52] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:52] 🔄 
🔄 Step 6: Pushing order to API...
[18:14:52] [DOC: 9192547] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:14:53] [DOC: 9192547] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14002"}
[18:14:53] ❌    ❌ Failed to push order
[18:14:53] 🔄 
🔄 Step 7: Writing to CSV...
[18:14:53] [DOC: 9192547] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:14:53] [DOC: 9192547] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:14:53] [DOC: 9192547] ℹ️  Payer Source extracted: ''
[18:14:53] [DOC: 9192547] ℹ️  Diagnosis codes being written:
[18:14:53] [DOC: 9192547] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:14:53] [DOC: 9192547] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[18:14:53] [DOC: 9192547] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:14:53] [DOC: 9192547] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:14:53] [DOC: 9192547] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:14:53] [DOC: 9192547] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:14:53] [DOC: 9192547] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: MA221012094404
[18:14:53] ✅    ✅ Document 9192547 processed and saved successfully
[18:14:53] 🔄 
🔄 Step 8: Saving API details...
[18:14:53] [DOC: 9192547] ℹ️  API push details saved for document 9192547
[18:14:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192546                         ║
================================================================================
[18:14:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:53] ℹ️  Date: 03/20/2025
[18:14:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:56] [DOC: 9192546] ✅ Text extracted using pdfplumber (15257 chars)
[18:14:56] ✅    ✅ Text extracted using pdfplumber (15257 chars)
[18:14:56] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:00] ℹ️  AI extracted raw sex value: 'F'
[18:15:00] ℹ️  AI extracted service line: 'PT'
[18:15:00] ℹ️  AI extracted payer source: ''
[18:15:00] ℹ️  AI extracted diagnoses:
[18:15:00] ℹ️    - Diagnosis 1: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[18:15:00] ℹ️    - Diagnosis 2: 'Muscle weakness'
[18:15:00] ℹ️    - Diagnosis 3: 'L LE cellulitis'
[18:15:00] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[18:15:00] ℹ️    - Diagnosis 5: 'GERD'
[18:15:00] ℹ️    - Diagnosis 6: 'DM type 2 with hyperglycemia'
[18:15:00] ℹ️  Final extracted MRN: 'MA240822115704'
[18:15:00] ℹ️  Final extracted Sex: 'FEMALE'
[18:15:00] ℹ️  Final extracted Service Line: 'PT'
[18:15:00] ℹ️  Final extracted Payer Source: ''
[18:15:00] ✅ Patient data extraction completed successfully
[18:15:00] ✅    ✅ Patient data extracted successfully
[18:15:00] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[18:15:00] ✅    ✅ Patient identified: Charlene Couto
[18:15:00] ✅    ✅ Patient name validation passed
[18:15:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:00] [DOC: 9192546] ℹ️  DOB normalized: 11/01/1957
[18:15:00] [DOC: 9192546] ℹ️  Episode startOfCare normalized: 02/21/2025
[18:15:00] [DOC: 9192546] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[18:15:00] [DOC: 9192546] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[18:15:00] [DOC: 9192546] ✅ Patient date processing completed successfully
[18:15:00] ✅    ✅ Date processing completed
[18:15:00] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[18:15:00] 🔄 
🔄 Step 4: Extracting order data...
[18:15:02] ℹ️  Order extraction - MRN: 'MA240822115704'
[18:15:02] ℹ️  Order extraction - Sex: 'FEMALE'
[18:15:02] ℹ️  Order extraction - Service Line: 'PT'
[18:15:02] ℹ️  Order extraction - Payer Source: ''
[18:15:02] ✅ Order data extraction completed successfully
[18:15:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:02] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[18:15:02] ℹ️  Service line consistent in both sources: 'PT'
[18:15:02] ✅ Patient name cross-validation successful
[18:15:02] ✅    ✅ Data merged successfully
[18:15:04] ✅    ✅ Order data extracted and validated
[18:15:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:04] [DOC: 9192546] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[18:15:04] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[18:15:04] 🔄 
🔄 Step 6: Pushing order to API...
[18:15:04] [DOC: 9192546] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[18:15:05] [DOC: 9192546] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:15:05] ❌    ❌ Failed to push order
[18:15:05] 🔄 
🔄 Step 7: Writing to CSV...
[18:15:05] [DOC: 9192546] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[18:15:05] [DOC: 9192546] ℹ️  Service Line extracted: 'PT'
[18:15:05] [DOC: 9192546] ℹ️  Payer Source extracted: ''
[18:15:05] [DOC: 9192546] ℹ️  Diagnosis codes being written:
[18:15:05] [DOC: 9192546] ℹ️    - Latest_Episode_Firstdiagnosis: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[18:15:05] [DOC: 9192546] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[18:15:05] [DOC: 9192546] ℹ️    - Latest_Episode_Thirddiagnosis: 'L LE cellulitis'
[18:15:05] [DOC: 9192546] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Multiple sclerosis'
[18:15:05] [DOC: 9192546] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GERD'
[18:15:05] [DOC: 9192546] ℹ️    - Latest_Episode_Sixthdiagnosis: 'DM type 2 with hyperglycemia'
[18:15:05] [DOC: 9192546] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: PT | Payer:  | MRN: MA240822115704
[18:15:05] ✅    ✅ Document 9192546 processed and saved successfully
[18:15:05] 🔄 
🔄 Step 8: Saving API details...
[18:15:05] [DOC: 9192546] ℹ️  API push details saved for document 9192546
[18:15:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192523                         ║
================================================================================
[18:15:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:15:05] ℹ️  Date: 03/20/2025
[18:15:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:09] [DOC: 9192523] ✅ Text extracted using pdfplumber (15257 chars)
[18:15:09] ✅    ✅ Text extracted using pdfplumber (15257 chars)
[18:15:09] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:12] ℹ️  AI extracted raw sex value: 'F'
[18:15:12] ℹ️  AI extracted service line: 'PT'
[18:15:12] ℹ️  AI extracted payer source: ''
[18:15:12] ℹ️  AI extracted diagnoses:
[18:15:12] ℹ️    - Diagnosis 1: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[18:15:12] ℹ️    - Diagnosis 2: 'Muscle weakness'
[18:15:12] ℹ️    - Diagnosis 3: 'L LE cellulitis'
[18:15:12] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[18:15:12] ℹ️    - Diagnosis 5: 'GERD'
[18:15:12] ℹ️    - Diagnosis 6: 'DM type 2 with hyperglycemia'
[18:15:12] ℹ️  Final extracted MRN: 'MA240822115704'
[18:15:12] ℹ️  Final extracted Sex: 'FEMALE'
[18:15:12] ℹ️  Final extracted Service Line: 'PT'
[18:15:12] ℹ️  Final extracted Payer Source: ''
[18:15:12] ✅ Patient data extraction completed successfully
[18:15:12] ✅    ✅ Patient data extracted successfully
[18:15:12] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/25', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[18:15:12] ✅    ✅ Patient identified: Charlene Couto
[18:15:12] ✅    ✅ Patient name validation passed
[18:15:12] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:12] [DOC: 9192523] ℹ️  DOB normalized: 11/01/1957
[18:15:12] [DOC: 9192523] ℹ️  Episode startOfCare normalized: 02/21/2025
[18:15:12] [DOC: 9192523] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[18:15:12] [DOC: 9192523] ⚠️  Invalid endOfEpisode format: 04/21/25
[18:15:12] [DOC: 9192523] ✅ Patient date processing completed successfully
[18:15:12] ✅    ✅ Date processing completed
[18:15:12] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '04/21/25', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[18:15:12] 🔄 
🔄 Step 4: Extracting order data...
[18:15:15] ℹ️  Order extraction - MRN: 'MA240822115704'
[18:15:15] ℹ️  Order extraction - Sex: 'FEMALE'
[18:15:15] ℹ️  Order extraction - Service Line: 'PT'
[18:15:15] ℹ️  Order extraction - Payer Source: ''
[18:15:15] ✅ Order data extraction completed successfully
[18:15:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:15] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[18:15:15] ℹ️  Service line consistent in both sources: 'PT'
[18:15:15] ✅ Patient name cross-validation successful
[18:15:15] ✅    ✅ Data merged successfully
[18:15:16] ⚠️     ❌ Skipping - missing episode start date
[18:15:16] [DOC: 9192523] ℹ️  API push details saved for document 9192523
================================================================================
║                        Processing Document ID: 9192508                         ║
================================================================================
[18:15:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:15:16] ℹ️  Date: 03/20/2025
[18:15:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:18] [DOC: 9192508] ✅ Text extracted using pdfplumber (1552 chars)
[18:15:18] ✅    ✅ Text extracted using pdfplumber (1552 chars)
[18:15:18] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:21] ℹ️  AI extracted raw sex value: ''
[18:15:21] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:15:21] ℹ️  AI extracted payer source: ''
[18:15:21] ℹ️  AI extracted diagnoses:
[18:15:21] ℹ️    - Diagnosis 1: 'G40.909'
[18:15:21] ℹ️    - Diagnosis 2: 'F51.04'
[18:15:21] ℹ️    - Diagnosis 3: 'G81.94'
[18:15:21] ℹ️    - Diagnosis 4: ''
[18:15:21] ℹ️    - Diagnosis 5: ''
[18:15:21] ℹ️    - Diagnosis 6: ''
[18:15:21] ℹ️  Final extracted MRN: 'MA240318025203'
[18:15:21] ℹ️  Final extracted Sex: ''
[18:15:21] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:15:21] ℹ️  Final extracted Payer Source: ''
[18:15:21] ✅ Patient data extraction completed successfully
[18:15:21] ✅    ✅ Patient data extracted successfully
[18:15:21] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:15:21] ✅    ✅ Patient identified: Dale Brooks
[18:15:21] ✅    ✅ Patient name validation passed
[18:15:21] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:21] [DOC: 9192508] ℹ️  DOB normalized: 02/24/1952
[18:15:21] [DOC: 9192508] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:15:21] [DOC: 9192508] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:15:21] [DOC: 9192508] ✅ Patient date processing completed successfully
[18:15:21] ✅    ✅ Date processing completed
[18:15:21] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:15:21] 🔄 
🔄 Step 4: Extracting order data...
[18:15:23] ℹ️  Order extraction - MRN: 'MA240318025203'
[18:15:23] ℹ️  Order extraction - Sex: ''
[18:15:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:15:23] ℹ️  Order extraction - Payer Source: ''
[18:15:23] ✅ Order data extraction completed successfully
[18:15:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:23] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[18:15:23] ⚠️  Could not determine sex using any available method
[18:15:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:15:23] ✅ Patient name cross-validation successful
[18:15:23] ✅    ✅ Data merged successfully
[18:15:25] ✅    ✅ Order data extracted and validated
[18:15:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:25] [DOC: 9192508] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:25] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:25] 🔄 
🔄 Step 6: Pushing order to API...
[18:15:25] [DOC: 9192508] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:26] [DOC: 9192508] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13361"}
[18:15:26] ❌    ❌ Failed to push order
[18:15:26] 🔄 
🔄 Step 7: Writing to CSV...
[18:15:26] [DOC: 9192508] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[18:15:26] [DOC: 9192508] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:15:26] [DOC: 9192508] ℹ️  Payer Source extracted: ''
[18:15:26] [DOC: 9192508] ℹ️  Diagnosis codes being written:
[18:15:26] [DOC: 9192508] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[18:15:26] [DOC: 9192508] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[18:15:26] [DOC: 9192508] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[18:15:26] [DOC: 9192508] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:15:26] [DOC: 9192508] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:15:26] [DOC: 9192508] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:15:26] [DOC: 9192508] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Occupational Therapy | Payer:  | MRN: MA240318025203
[18:15:26] ✅    ✅ Document 9192508 processed and saved successfully
[18:15:26] 🔄 
🔄 Step 8: Saving API details...
[18:15:26] [DOC: 9192508] ℹ️  API push details saved for document 9192508
[18:15:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192505                         ║
================================================================================
[18:15:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:15:26] ℹ️  Date: 03/20/2025
[18:15:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:28] [DOC: 9192505] ✅ Text extracted using pdfplumber (1547 chars)
[18:15:28] ✅    ✅ Text extracted using pdfplumber (1547 chars)
[18:15:28] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:31] ℹ️  AI extracted raw sex value: ''
[18:15:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:15:31] ℹ️  AI extracted payer source: ''
[18:15:31] ℹ️  AI extracted diagnoses:
[18:15:31] ℹ️    - Diagnosis 1: 'G40.909'
[18:15:31] ℹ️    - Diagnosis 2: 'F51.04'
[18:15:31] ℹ️    - Diagnosis 3: 'G81.94'
[18:15:31] ℹ️    - Diagnosis 4: ''
[18:15:31] ℹ️    - Diagnosis 5: ''
[18:15:31] ℹ️    - Diagnosis 6: ''
[18:15:31] ℹ️  Final extracted MRN: 'MA240318025203'
[18:15:31] ℹ️  Final extracted Sex: ''
[18:15:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:15:31] ℹ️  Final extracted Payer Source: ''
[18:15:31] ✅ Patient data extraction completed successfully
[18:15:31] ✅    ✅ Patient data extracted successfully
[18:15:31] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:15:31] ✅    ✅ Patient identified: Dale Brooks
[18:15:31] ✅    ✅ Patient name validation passed
[18:15:31] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:31] [DOC: 9192505] ℹ️  DOB normalized: 02/24/1952
[18:15:31] [DOC: 9192505] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:15:31] [DOC: 9192505] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:15:31] [DOC: 9192505] ✅ Patient date processing completed successfully
[18:15:31] ✅    ✅ Date processing completed
[18:15:31] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:15:31] 🔄 
🔄 Step 4: Extracting order data...
[18:15:34] ℹ️  Order extraction - MRN: 'MA240318025203'
[18:15:34] ℹ️  Order extraction - Sex: ''
[18:15:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:15:34] ℹ️  Order extraction - Payer Source: ''
[18:15:34] ✅ Order data extraction completed successfully
[18:15:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:34] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[18:15:34] ⚠️  Could not determine sex using any available method
[18:15:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:15:34] ✅ Patient name cross-validation successful
[18:15:34] ✅    ✅ Data merged successfully
[18:15:35] ✅    ✅ Order data extracted and validated
[18:15:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:35] [DOC: 9192505] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:35] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:35] 🔄 
🔄 Step 6: Pushing order to API...
[18:15:35] [DOC: 9192505] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:36] [DOC: 9192505] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13362"}
[18:15:36] ❌    ❌ Failed to push order
[18:15:36] 🔄 
🔄 Step 7: Writing to CSV...
[18:15:36] [DOC: 9192505] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[18:15:36] [DOC: 9192505] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:15:36] [DOC: 9192505] ℹ️  Payer Source extracted: ''
[18:15:36] [DOC: 9192505] ℹ️  Diagnosis codes being written:
[18:15:36] [DOC: 9192505] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[18:15:36] [DOC: 9192505] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[18:15:36] [DOC: 9192505] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[18:15:36] [DOC: 9192505] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:15:36] [DOC: 9192505] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:15:36] [DOC: 9192505] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:15:36] [DOC: 9192505] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA240318025203
[18:15:36] ✅    ✅ Document 9192505 processed and saved successfully
[18:15:36] 🔄 
🔄 Step 8: Saving API details...
[18:15:36] [DOC: 9192505] ℹ️  API push details saved for document 9192505
[18:15:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192504                         ║
================================================================================
[18:15:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:15:36] ℹ️  Date: 03/20/2025
[18:15:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:38] [DOC: 9192504] ✅ Text extracted using pdfplumber (1702 chars)
[18:15:38] ✅    ✅ Text extracted using pdfplumber (1702 chars)
[18:15:38] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:41] ℹ️  AI extracted raw sex value: ''
[18:15:41] ℹ️  AI extracted service line: 'Physical Therapy'
[18:15:41] ℹ️  AI extracted payer source: ''
[18:15:41] ℹ️  AI extracted diagnoses:
[18:15:41] ℹ️    - Diagnosis 1: 'G40.909'
[18:15:41] ℹ️    - Diagnosis 2: 'F51.04'
[18:15:41] ℹ️    - Diagnosis 3: 'G81.94'
[18:15:41] ℹ️    - Diagnosis 4: 'None'
[18:15:41] ℹ️    - Diagnosis 5: 'None'
[18:15:41] ℹ️    - Diagnosis 6: 'None'
[18:15:41] ℹ️  Final extracted MRN: 'MA240318025203'
[18:15:41] ℹ️  Final extracted Sex: ''
[18:15:41] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:15:41] ℹ️  Final extracted Payer Source: ''
[18:15:41] ✅ Patient data extraction completed successfully
[18:15:41] ✅    ✅ Patient data extracted successfully
[18:15:41] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:15:41] ✅    ✅ Patient identified: Dale Brooks
[18:15:41] ✅    ✅ Patient name validation passed
[18:15:41] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:41] [DOC: 9192504] ℹ️  DOB normalized: 02/24/1952
[18:15:41] [DOC: 9192504] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:15:41] [DOC: 9192504] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:15:41] [DOC: 9192504] ✅ Patient date processing completed successfully
[18:15:41] ✅    ✅ Date processing completed
[18:15:41] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94'}]
[18:15:41] 🔄 
🔄 Step 4: Extracting order data...
[18:15:44] ℹ️  Order extraction - MRN: 'MA240318025203'
[18:15:44] ℹ️  Order extraction - Sex: ''
[18:15:44] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:15:44] ℹ️  Order extraction - Payer Source: ''
[18:15:44] ✅ Order data extraction completed successfully
[18:15:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:44] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[18:15:44] ⚠️  Could not determine sex using any available method
[18:15:44] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:15:44] ✅ Patient name cross-validation successful
[18:15:44] ✅    ✅ Data merged successfully
[18:15:45] ✅    ✅ Order data extracted and validated
[18:15:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:45] [DOC: 9192504] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:45] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:45] 🔄 
🔄 Step 6: Pushing order to API...
[18:15:45] [DOC: 9192504] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:46] [DOC: 9192504] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13368"}
[18:15:46] ❌    ❌ Failed to push order
[18:15:46] 🔄 
🔄 Step 7: Writing to CSV...
[18:15:46] [DOC: 9192504] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[18:15:46] [DOC: 9192504] ℹ️  Service Line extracted: 'Physical Therapy'
[18:15:46] [DOC: 9192504] ℹ️  Payer Source extracted: ''
[18:15:46] [DOC: 9192504] ℹ️  Diagnosis codes being written:
[18:15:46] [DOC: 9192504] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[18:15:46] [DOC: 9192504] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[18:15:46] [DOC: 9192504] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[18:15:46] [DOC: 9192504] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:15:46] [DOC: 9192504] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:15:46] [DOC: 9192504] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:15:46] [DOC: 9192504] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Physical Therapy | Payer:  | MRN: MA240318025203
[18:15:46] ✅    ✅ Document 9192504 processed and saved successfully
[18:15:46] 🔄 
🔄 Step 8: Saving API details...
[18:15:46] [DOC: 9192504] ℹ️  API push details saved for document 9192504
[18:15:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192502                         ║
================================================================================
[18:15:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:15:46] ℹ️  Date: 03/20/2025
[18:15:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:49] [DOC: 9192502] ✅ Text extracted using pdfplumber (1959 chars)
[18:15:49] ✅    ✅ Text extracted using pdfplumber (1959 chars)
[18:15:49] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:52] ℹ️  AI extracted raw sex value: ''
[18:15:52] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:15:52] ℹ️  AI extracted payer source: ''
[18:15:52] ℹ️  AI extracted diagnoses:
[18:15:52] ℹ️    - Diagnosis 1: 'G40.909'
[18:15:52] ℹ️    - Diagnosis 2: 'F51.04'
[18:15:52] ℹ️    - Diagnosis 3: 'G81.94'
[18:15:52] ℹ️    - Diagnosis 4: 'None'
[18:15:52] ℹ️    - Diagnosis 5: 'None'
[18:15:52] ℹ️    - Diagnosis 6: 'None'
[18:15:52] ℹ️  Final extracted MRN: 'MA240318025203'
[18:15:52] ℹ️  Final extracted Sex: ''
[18:15:52] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:15:52] ℹ️  Final extracted Payer Source: ''
[18:15:52] ✅ Patient data extraction completed successfully
[18:15:52] ✅    ✅ Patient data extracted successfully
[18:15:52] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:15:52] ✅    ✅ Patient identified: Dale Brooks
[18:15:52] ✅    ✅ Patient name validation passed
[18:15:52] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:52] [DOC: 9192502] ℹ️  DOB normalized: 02/24/1952
[18:15:52] [DOC: 9192502] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:15:52] [DOC: 9192502] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:15:52] [DOC: 9192502] ✅ Patient date processing completed successfully
[18:15:52] ✅    ✅ Date processing completed
[18:15:52] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94'}]
[18:15:52] 🔄 
🔄 Step 4: Extracting order data...
[18:15:54] ℹ️  Order extraction - MRN: 'MA240318025203'
[18:15:54] ℹ️  Order extraction - Sex: ''
[18:15:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:15:54] ℹ️  Order extraction - Payer Source: ''
[18:15:54] ✅ Order data extraction completed successfully
[18:15:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:54] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[18:15:54] ⚠️  Could not determine sex using any available method
[18:15:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:15:54] ✅ Patient name cross-validation successful
[18:15:54] ✅    ✅ Data merged successfully
[18:15:56] ✅    ✅ Order data extracted and validated
[18:15:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:56] [DOC: 9192502] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:56] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:56] 🔄 
🔄 Step 6: Pushing order to API...
[18:15:56] [DOC: 9192502] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:15:57] [DOC: 9192502] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13369"}
[18:15:57] ❌    ❌ Failed to push order
[18:15:57] 🔄 
🔄 Step 7: Writing to CSV...
[18:15:57] [DOC: 9192502] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[18:15:57] [DOC: 9192502] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:15:57] [DOC: 9192502] ℹ️  Payer Source extracted: ''
[18:15:57] [DOC: 9192502] ℹ️  Diagnosis codes being written:
[18:15:57] [DOC: 9192502] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[18:15:57] [DOC: 9192502] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[18:15:57] [DOC: 9192502] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[18:15:57] [DOC: 9192502] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:15:57] [DOC: 9192502] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:15:57] [DOC: 9192502] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:15:57] [DOC: 9192502] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA240318025203
[18:15:57] ✅    ✅ Document 9192502 processed and saved successfully
[18:15:57] 🔄 
🔄 Step 8: Saving API details...
[18:15:57] [DOC: 9192502] ℹ️  API push details saved for document 9192502
[18:15:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192470                         ║
================================================================================
[18:15:57] ℹ️  Agency: Nizhoni Health-Fall River
[18:15:57] ℹ️  Date: 03/20/2025
[18:15:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:00] [DOC: 9192470] ✅ Text extracted using pdfplumber (1125 chars)
[18:16:00] ✅    ✅ Text extracted using pdfplumber (1125 chars)
[18:16:00] 🔄 
🔄 Step 2: Extracting patient data...
[18:16:03] ℹ️  AI extracted raw sex value: 'M'
[18:16:03] ℹ️  AI extracted service line: 'HHA'
[18:16:03] ℹ️  AI extracted payer source: 'Medicaid/MA'
[18:16:03] ℹ️  AI extracted diagnoses:
[18:16:03] ℹ️    - Diagnosis 1: ''
[18:16:03] ℹ️    - Diagnosis 2: ''
[18:16:03] ℹ️    - Diagnosis 3: ''
[18:16:03] ℹ️    - Diagnosis 4: ''
[18:16:03] ℹ️    - Diagnosis 5: ''
[18:16:03] ℹ️    - Diagnosis 6: ''
[18:16:03] ℹ️  Final extracted MRN: '8496020'
[18:16:03] ℹ️  Final extracted Sex: 'MALE'
[18:16:03] ℹ️  Final extracted Service Line: 'HHA'
[18:16:03] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[18:16:03] ✅ Patient data extraction completed successfully
[18:16:03] ✅    ✅ Patient data extracted successfully
[18:16:03] 📊 Patient Response
     └─ patientFName: Cullen
     └─ patientLName: Tate
     └─ dob: 11/23/2000
     └─ patientSex: MALE
     └─ medicalRecordNo: 8496020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2023', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:16:03] ✅    ✅ Patient identified: Cullen Tate
[18:16:03] ✅    ✅ Patient name validation passed
[18:16:03] 🔄 
🔄 Step 3: Processing patient dates...
[18:16:03] [DOC: 9192470] ℹ️  DOB normalized: 11/23/2000
[18:16:03] [DOC: 9192470] ℹ️  Episode startOfCare normalized: 11/03/2023
[18:16:03] [DOC: 9192470] ℹ️  Episode startOfEpisode normalized: 02/25/2025
[18:16:03] [DOC: 9192470] ℹ️  Episode endOfEpisode normalized: 04/25/2025
[18:16:03] [DOC: 9192470] ✅ Patient date processing completed successfully
[18:16:03] ✅    ✅ Date processing completed
[18:16:03] 📊 Processed Patient Data
     └─ patientFName: Cullen
     └─ patientLName: Tate
     └─ dob: 11/23/2000
     └─ patientSex: MALE
     └─ medicalRecordNo: 8496020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2023', 'startOfEpisode': '02/25/2025', 'endOfEpisode': '04/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:16:03] 🔄 
🔄 Step 4: Extracting order data...
[18:16:06] ℹ️  Order extraction - MRN: '8496020'
[18:16:06] ℹ️  Order extraction - Sex: 'MALE'
[18:16:06] ℹ️  Order extraction - Service Line: 'HHA'
[18:16:06] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[18:16:06] ✅ Order data extraction completed successfully
[18:16:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:16:06] ℹ️  Using MRN from patient data: '8496020' over '8496020'
[18:16:06] ℹ️  Service line consistent in both sources: 'HHA'
[18:16:06] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[18:16:06] ✅ Patient name cross-validation successful
[18:16:06] ✅    ✅ Data merged successfully
[18:16:07] ✅    ✅ Order data extracted and validated
[18:16:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:16:16] [DOC: 9192470] ✅ Patient exists in API: Cullen Tate, ID: a5853fc6-5bef-4f78-9edc-fefdecd72573
[18:16:16] ✅    ✅ Existing patient found with ID: a5853fc6-5bef-4f78-9edc-fefdecd72573
[18:16:16] 🔄 
🔄 Step 6: Pushing order to API...
[18:16:16] [DOC: 9192470] ℹ️  Pushing order via API for patient ID: a5853fc6-5bef-4f78-9edc-fefdecd72573
[18:16:17] [DOC: 9192470] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:16:17] ❌    ❌ Failed to push order
[18:16:17] 🔄 
🔄 Step 7: Writing to CSV...
[18:16:17] [DOC: 9192470] ℹ️  Calculated age: 24 from DOB: 11/23/2000
[18:16:17] [DOC: 9192470] ℹ️  Service Line extracted: 'HHA'
[18:16:17] [DOC: 9192470] ℹ️  Payer Source extracted: 'Medicaid/MA'
[18:16:17] [DOC: 9192470] ℹ️  Diagnosis codes being written:
[18:16:17] [DOC: 9192470] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:16:17] [DOC: 9192470] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:16:17] [DOC: 9192470] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:16:17] [DOC: 9192470] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:16:17] [DOC: 9192470] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:16:17] [DOC: 9192470] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:16:17] [DOC: 9192470] ✅ Patient data written to CSV: Cullen Tate | Sex: MALE | Age: 24 | Service: HHA | Payer: Medicaid/MA | MRN: 8496020
[18:16:17] ✅    ✅ Document 9192470 processed and saved successfully
[18:16:17] 🔄 
🔄 Step 8: Saving API details...
[18:16:17] [DOC: 9192470] ℹ️  API push details saved for document 9192470
[18:16:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9192081                         ║
================================================================================
[18:16:17] ℹ️  Agency: Brigham Home Care Services.Inc
[18:16:17] ℹ️  Date: 03/19/2025
[18:16:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:20] [DOC: 9192081] ✅ Text extracted using pdfplumber (1956 chars)
[18:16:20] ✅    ✅ Text extracted using pdfplumber (1956 chars)
[18:16:20] 🔄 
🔄 Step 2: Extracting patient data...
[18:16:22] ℹ️  AI extracted raw sex value: 'M'
[18:16:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:16:22] ℹ️  AI extracted payer source: ''
[18:16:22] ℹ️  AI extracted diagnoses:
[18:16:22] ℹ️    - Diagnosis 1: 'None'
[18:16:22] ℹ️    - Diagnosis 2: 'None'
[18:16:22] ℹ️    - Diagnosis 3: 'None'
[18:16:22] ℹ️    - Diagnosis 4: 'None'
[18:16:22] ℹ️    - Diagnosis 5: 'None'
[18:16:22] ℹ️    - Diagnosis 6: 'None'
[18:16:22] ℹ️  Final extracted MRN: '1442'
[18:16:22] ℹ️  Final extracted Sex: 'MALE'
[18:16:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:16:22] ℹ️  Final extracted Payer Source: ''
[18:16:22] ✅ Patient data extraction completed successfully
[18:16:22] ✅    ✅ Patient data extracted successfully
[18:16:22] 📊 Patient Response
     └─ patientFName: STEVEN
     └─ patientLName: PICHE
     └─ dob: 04/10/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 1442
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/21/2024', 'endOfEpisode': '02/18/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:16:22] ✅    ✅ Patient identified: STEVEN PICHE
[18:16:22] ✅    ✅ Patient name validation passed
[18:16:22] 🔄 
🔄 Step 3: Processing patient dates...
[18:16:22] [DOC: 9192081] ℹ️  DOB normalized: 04/10/1968
[18:16:22] [DOC: 9192081] ℹ️  Episode startOfEpisode normalized: 12/21/2024
[18:16:22] [DOC: 9192081] ℹ️  Episode endOfEpisode normalized: 02/18/2025
[18:16:22] [DOC: 9192081] ✅ Patient date processing completed successfully
[18:16:22] ✅    ✅ Date processing completed
[18:16:22] 📊 Processed Patient Data
     └─ patientFName: STEVEN
     └─ patientLName: PICHE
     └─ dob: 04/10/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 1442
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/21/2024', 'endOfEpisode': '02/18/2025'}]
[18:16:22] 🔄 
🔄 Step 4: Extracting order data...
[18:16:25] ℹ️  Order extraction - MRN: '1442'
[18:16:25] ℹ️  Order extraction - Sex: 'MALE'
[18:16:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:16:25] ℹ️  Order extraction - Payer Source: ''
[18:16:25] ✅ Order data extraction completed successfully
[18:16:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:16:25] ℹ️  Using MRN from patient data: '1442' over '1442'
[18:16:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:16:25] ✅ Patient name cross-validation successful
[18:16:25] ✅    ✅ Data merged successfully
[18:16:26] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[18:16:26] [DOC: 9192081] ℹ️  API push details saved for document 9192081
================================================================================
║                        Processing Document ID: 2164334                         ║
================================================================================
[18:16:26] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:16:26] ℹ️  Date: 03/19/2025
[18:16:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:27] [DOC: 2164334] ❌ Critical failure in get_pdf_text: Invalid response format
[18:16:27] ❌ Failed to extract text for Doc ID 2164334
[18:16:27] [DOC: 2164334] ℹ️  API push details saved for document 2164334
================================================================================
║                        Processing Document ID: 2164330                         ║
================================================================================
[18:16:27] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:16:27] ℹ️  Date: 03/19/2025
[18:16:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:28] [DOC: 2164330] ❌ Critical failure in get_pdf_text: Invalid response format
[18:16:28] ❌ Failed to extract text for Doc ID 2164330
[18:16:28] [DOC: 2164330] ℹ️  API push details saved for document 2164330
================================================================================
║                        Processing Document ID: 9190942                         ║
================================================================================
[18:16:28] ℹ️  Agency: Brigham Home Care Services.Inc
[18:16:28] ℹ️  Date: 03/19/2025
[18:16:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:31] [DOC: 9190942] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[18:16:32] [DOC: 9190942] ✅ Text extracted using tesseract_ocr (1785 chars)
[18:16:32] ✅    ✅ Text extracted using tesseract_ocr (1758 chars)
[18:16:32] 🔄 
🔄 Step 2: Extracting patient data...
[18:16:34] ℹ️  AI extracted raw sex value: 'M'
[18:16:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:16:34] ℹ️  AI extracted payer source: ''
[18:16:34] ℹ️  AI extracted diagnoses:
[18:16:34] ℹ️    - Diagnosis 1: ''
[18:16:34] ℹ️    - Diagnosis 2: ''
[18:16:34] ℹ️    - Diagnosis 3: ''
[18:16:34] ℹ️    - Diagnosis 4: ''
[18:16:34] ℹ️    - Diagnosis 5: ''
[18:16:34] ℹ️    - Diagnosis 6: ''
[18:16:34] ℹ️  Final extracted MRN: '3757'
[18:16:34] ℹ️  Final extracted Sex: 'MALE'
[18:16:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:16:34] ℹ️  Final extracted Payer Source: ''
[18:16:34] ✅ Patient data extraction completed successfully
[18:16:34] ✅    ✅ Patient data extracted successfully
[18:16:34] 📊 Patient Response
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:16:34] ✅    ✅ Patient identified: RYAN MENDONCA
[18:16:34] ✅    ✅ Patient name validation passed
[18:16:34] 🔄 
🔄 Step 3: Processing patient dates...
[18:16:34] [DOC: 9190942] ℹ️  DOB normalized: 04/23/1980
[18:16:34] [DOC: 9190942] ℹ️  Episode startOfEpisode normalized: 01/11/2025
[18:16:34] [DOC: 9190942] ℹ️  Episode endOfEpisode normalized: 03/11/2025
[18:16:34] [DOC: 9190942] ✅ Patient date processing completed successfully
[18:16:34] ✅    ✅ Date processing completed
[18:16:34] 📊 Processed Patient Data
     └─ patientFName: RYAN
     └─ patientLName: MENDONCA
     └─ dob: 04/23/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 3757
     └─ billingProvider: Addo, Theophilus
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:16:34] 🔄 
🔄 Step 4: Extracting order data...
[18:16:37] ℹ️  Order extraction - MRN: '3757'
[18:16:37] ℹ️  Order extraction - Sex: 'MALE'
[18:16:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:16:37] ℹ️  Order extraction - Payer Source: ''
[18:16:37] ✅ Order data extraction completed successfully
[18:16:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:16:37] ℹ️  Using MRN from patient data: '3757' over '3757'
[18:16:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:16:37] ✅ Patient name cross-validation successful
[18:16:37] ✅    ✅ Data merged successfully
[18:16:38] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[18:16:38] [DOC: 9190942] ℹ️  API push details saved for document 9190942
================================================================================
║                        Processing Document ID: 9192368                         ║
================================================================================
[18:16:38] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[18:16:38] ℹ️  Date: 03/19/2025
[18:16:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:40] [DOC: 9192368] ✅ Text extracted using pdfplumber (1439 chars)
[18:16:40] ✅    ✅ Text extracted using pdfplumber (1439 chars)
[18:16:40] 🔄 
🔄 Step 2: Extracting patient data...
[18:16:43] ℹ️  AI extracted raw sex value: ''
[18:16:43] ℹ️  AI extracted service line: 'PT'
[18:16:43] ℹ️  AI extracted payer source: 'Medicare'
[18:16:43] ℹ️  AI extracted diagnoses:
[18:16:43] ℹ️    - Diagnosis 1: 'B35.6'
[18:16:43] ℹ️    - Diagnosis 2: 'None'
[18:16:43] ℹ️    - Diagnosis 3: 'None'
[18:16:43] ℹ️    - Diagnosis 4: 'None'
[18:16:43] ℹ️    - Diagnosis 5: 'None'
[18:16:43] ℹ️    - Diagnosis 6: 'None'
[18:16:43] ℹ️  Final extracted MRN: '28700209267201'
[18:16:43] ℹ️  Final extracted Sex: ''
[18:16:43] ℹ️  Final extracted Service Line: 'PT'
[18:16:43] ℹ️  Final extracted Payer Source: 'Medicare'
[18:16:43] ✅ Patient data extraction completed successfully
[18:16:43] ✅    ✅ Patient data extracted successfully
[18:16:43] 📊 Patient Response
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: CHRISTINE WILL, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 217 DEANE ST APT 304
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02746-
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:16:43] ✅    ✅ Patient identified: ROGER VARIEUR
[18:16:43] ✅    ✅ Patient name validation passed
[18:16:43] 🔄 
🔄 Step 3: Processing patient dates...
[18:16:43] [DOC: 9192368] ℹ️  DOB normalized: 05/12/1938
[18:16:43] [DOC: 9192368] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:16:43] [DOC: 9192368] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[18:16:43] [DOC: 9192368] ✅ Patient date processing completed successfully
[18:16:43] ✅    ✅ Date processing completed
[18:16:43] 📊 Processed Patient Data
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: CHRISTINE WILL, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 217 DEANE ST APT 304
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02746-
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6'}]
[18:16:43] 🔄 
🔄 Step 4: Extracting order data...
[18:16:46] ℹ️  Order extraction - MRN: '28700209267201'
[18:16:46] ℹ️  Order extraction - Sex: ''
[18:16:46] ℹ️  Order extraction - Service Line: 'PT'
[18:16:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:16:46] ✅ Order data extraction completed successfully
[18:16:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:16:46] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[18:16:46] ⚠️  Could not determine sex using any available method
[18:16:46] ℹ️  Service line consistent in both sources: 'PT'
[18:16:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:16:46] ✅ Patient name cross-validation successful
[18:16:46] ✅    ✅ Data merged successfully
[18:16:47] ✅    ✅ Order data extracted and validated
[18:16:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:16:52] [DOC: 9192368] ℹ️  Patient not found in cache or API: ROGER VARIEUR
[18:16:52] [DOC: 9192368] ℹ️  Patient not found, creating new patient via API...
[18:16:52] [DOC: 9192368] ℹ️  Creating patient via API: ROGER VARIEUR
[18:16:53] [DOC: 9192368] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:16:53] ❌    ❌ Failed to create patient
[18:16:53] [DOC: 9192368] ℹ️  API push details saved for document 9192368
================================================================================
║                        Processing Document ID: 9192367                         ║
================================================================================
[18:16:53] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[18:16:53] ℹ️  Date: 03/19/2025
[18:16:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:55] [DOC: 9192367] ✅ Text extracted using pdfplumber (1440 chars)
[18:16:55] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[18:16:55] 🔄 
🔄 Step 2: Extracting patient data...
[18:16:58] ℹ️  AI extracted raw sex value: ''
[18:16:58] ℹ️  AI extracted service line: 'OT'
[18:16:58] ℹ️  AI extracted payer source: 'Medicare'
[18:16:58] ℹ️  AI extracted diagnoses:
[18:16:58] ℹ️    - Diagnosis 1: 'B35.6'
[18:16:58] ℹ️    - Diagnosis 2: 'None'
[18:16:58] ℹ️    - Diagnosis 3: 'None'
[18:16:58] ℹ️    - Diagnosis 4: 'None'
[18:16:58] ℹ️    - Diagnosis 5: 'None'
[18:16:58] ℹ️    - Diagnosis 6: 'None'
[18:16:58] ℹ️  Final extracted MRN: '28700209267201'
[18:16:58] ℹ️  Final extracted Sex: ''
[18:16:58] ℹ️  Final extracted Service Line: 'OT'
[18:16:58] ℹ️  Final extracted Payer Source: 'Medicare'
[18:16:58] ✅ Patient data extraction completed successfully
[18:16:58] ✅    ✅ Patient data extracted successfully
[18:16:58] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Varieur
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:16:58] ✅    ✅ Patient identified: Roger Varieur
[18:16:58] ✅    ✅ Patient name validation passed
[18:16:58] 🔄 
🔄 Step 3: Processing patient dates...
[18:16:58] [DOC: 9192367] ℹ️  DOB normalized: 05/12/1938
[18:16:58] [DOC: 9192367] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:16:58] [DOC: 9192367] ℹ️  Episode endOfEpisode normalized: 03/14/2025
[18:16:58] [DOC: 9192367] ✅ Patient date processing completed successfully
[18:16:58] ✅    ✅ Date processing completed
[18:16:58] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Varieur
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '03/14/2025', 'firstDiagnosis': 'B35.6'}]
[18:16:58] 🔄 
🔄 Step 4: Extracting order data...
[18:17:01] ℹ️  Order extraction - MRN: '28700209267201'
[18:17:01] ℹ️  Order extraction - Sex: ''
[18:17:01] ℹ️  Order extraction - Service Line: 'OT'
[18:17:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:17:01] ✅ Order data extraction completed successfully
[18:17:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:01] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[18:17:01] ⚠️  Could not determine sex using any available method
[18:17:01] ℹ️  Service line consistent in both sources: 'OT'
[18:17:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:17:01] ✅ Patient name cross-validation successful
[18:17:01] ✅    ✅ Data merged successfully
[18:17:02] ✅    ✅ Order data extracted and validated
[18:17:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:08] [DOC: 9192367] ℹ️  Patient not found in cache or API: Roger Varieur
[18:17:08] [DOC: 9192367] ℹ️  Patient not found, creating new patient via API...
[18:17:08] [DOC: 9192367] ℹ️  Creating patient via API: Roger Varieur
[18:17:09] [DOC: 9192367] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:17:09] ❌    ❌ Failed to create patient
[18:17:09] [DOC: 9192367] ℹ️  API push details saved for document 9192367
================================================================================
║                        Processing Document ID: 9190396                         ║
================================================================================
[18:17:09] ℹ️  Agency: Dartmouth HH
[18:17:09] ℹ️  Date: 03/19/2025
[18:17:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:11] [DOC: 9190396] ✅ Text extracted using pdfplumber (1250 chars)
[18:17:11] ✅    ✅ Text extracted using pdfplumber (1250 chars)
[18:17:11] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:14] ℹ️  AI extracted raw sex value: 'M'
[18:17:14] ℹ️  AI extracted service line: 'RN'
[18:17:14] ℹ️  AI extracted payer source: 'Medicare'
[18:17:14] ℹ️  AI extracted diagnoses:
[18:17:14] ℹ️    - Diagnosis 1: ''
[18:17:14] ℹ️    - Diagnosis 2: ''
[18:17:14] ℹ️    - Diagnosis 3: ''
[18:17:14] ℹ️    - Diagnosis 4: ''
[18:17:14] ℹ️    - Diagnosis 5: ''
[18:17:14] ℹ️    - Diagnosis 6: ''
[18:17:14] ℹ️  Final extracted MRN: '842002'
[18:17:14] ℹ️  Final extracted Sex: 'MALE'
[18:17:14] ℹ️  Final extracted Service Line: 'RN'
[18:17:14] ℹ️  Final extracted Payer Source: 'Medicare'
[18:17:14] ✅ Patient data extraction completed successfully
[18:17:14] ✅    ✅ Patient data extracted successfully
[18:17:14] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:14] ✅    ✅ Patient identified: Johannes Bjornson
[18:17:14] ✅    ✅ Patient name validation passed
[18:17:14] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:14] [DOC: 9190396] ℹ️  DOB normalized: 02/09/1942
[18:17:14] [DOC: 9190396] ℹ️  Episode startOfCare normalized: 10/10/2024
[18:17:14] [DOC: 9190396] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[18:17:14] [DOC: 9190396] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[18:17:14] [DOC: 9190396] ✅ Patient date processing completed successfully
[18:17:14] ✅    ✅ Date processing completed
[18:17:14] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:14] 🔄 
🔄 Step 4: Extracting order data...
[18:17:16] ℹ️  Order extraction - MRN: ''
[18:17:16] ℹ️  Order extraction - Sex: 'MALE'
[18:17:16] ℹ️  Order extraction - Service Line: 'RN'
[18:17:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:17:16] ✅ Order data extraction completed successfully
[18:17:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:16] ℹ️  Using MRN from patient data: '842002'
[18:17:16] ℹ️  Service line consistent in both sources: 'RN'
[18:17:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:17:16] ✅ Patient name cross-validation successful
[18:17:16] ✅    ✅ Data merged successfully
[18:17:18] ✅    ✅ Order data extracted and validated
[18:17:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:18] [DOC: 9190396] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[18:17:18] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[18:17:18] 🔄 
🔄 Step 6: Pushing order to API...
[18:17:18] [DOC: 9190396] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[18:17:19] [DOC: 9190396] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[18:17:19] ❌    ❌ Failed to push order
[18:17:19] 🔄 
🔄 Step 7: Writing to CSV...
[18:17:19] [DOC: 9190396] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[18:17:19] [DOC: 9190396] ℹ️  Service Line extracted: 'RN'
[18:17:19] [DOC: 9190396] ℹ️  Payer Source extracted: 'Medicare'
[18:17:19] [DOC: 9190396] ℹ️  Diagnosis codes being written:
[18:17:19] [DOC: 9190396] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:17:19] [DOC: 9190396] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:17:19] [DOC: 9190396] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:17:19] [DOC: 9190396] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:17:19] [DOC: 9190396] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:17:19] [DOC: 9190396] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:17:19] [DOC: 9190396] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: RN | Payer: Medicare | MRN: 842002
[18:17:19] ✅    ✅ Document 9190396 processed and saved successfully
[18:17:19] 🔄 
🔄 Step 8: Saving API details...
[18:17:19] [DOC: 9190396] ℹ️  API push details saved for document 9190396
[18:17:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9190392                         ║
================================================================================
[18:17:19] ℹ️  Agency: Dartmouth HH
[18:17:19] ℹ️  Date: 03/19/2025
[18:17:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:21] [DOC: 9190392] ✅ Text extracted using pdfplumber (1250 chars)
[18:17:21] ✅    ✅ Text extracted using pdfplumber (1250 chars)
[18:17:21] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:23] ℹ️  AI extracted raw sex value: 'F'
[18:17:23] ℹ️  AI extracted service line: 'RN'
[18:17:23] ℹ️  AI extracted payer source: 'Medicare'
[18:17:23] ℹ️  AI extracted diagnoses:
[18:17:23] ℹ️    - Diagnosis 1: ''
[18:17:23] ℹ️    - Diagnosis 2: ''
[18:17:23] ℹ️    - Diagnosis 3: ''
[18:17:23] ℹ️    - Diagnosis 4: ''
[18:17:23] ℹ️    - Diagnosis 5: ''
[18:17:23] ℹ️    - Diagnosis 6: ''
[18:17:23] ℹ️  Final extracted MRN: '5938015'
[18:17:23] ℹ️  Final extracted Sex: 'FEMALE'
[18:17:23] ℹ️  Final extracted Service Line: 'RN'
[18:17:23] ℹ️  Final extracted Payer Source: 'Medicare'
[18:17:23] ✅ Patient data extraction completed successfully
[18:17:23] ✅    ✅ Patient data extracted successfully
[18:17:23] 📊 Patient Response
     └─ patientFName: Lorna
     └─ patientLName: Lessa
     └─ dob: 07/26/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5938015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 390 Purchase Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:23] ✅    ✅ Patient identified: Lorna Lessa
[18:17:23] ✅    ✅ Patient name validation passed
[18:17:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:23] [DOC: 9190392] ℹ️  DOB normalized: 07/26/1959
[18:17:23] [DOC: 9190392] ℹ️  Episode startOfCare normalized: 01/31/2025
[18:17:23] [DOC: 9190392] ℹ️  Episode startOfEpisode normalized: 01/31/2025
[18:17:23] [DOC: 9190392] ℹ️  Episode endOfEpisode normalized: 03/31/2025
[18:17:23] [DOC: 9190392] ✅ Patient date processing completed successfully
[18:17:23] ✅    ✅ Date processing completed
[18:17:23] 📊 Processed Patient Data
     └─ patientFName: Lorna
     └─ patientLName: Lessa
     └─ dob: 07/26/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5938015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 390 Purchase Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '01/31/2025', 'endOfEpisode': '03/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:23] 🔄 
🔄 Step 4: Extracting order data...
[18:17:26] ℹ️  Order extraction - MRN: ''
[18:17:26] ℹ️  Order extraction - Sex: 'FEMALE'
[18:17:26] ℹ️  Order extraction - Service Line: ''
[18:17:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:17:26] ✅ Order data extraction completed successfully
[18:17:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:26] ℹ️  Using MRN from patient data: '5938015'
[18:17:26] ℹ️  Using service line from patient data: 'RN'
[18:17:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:17:26] ✅ Patient name cross-validation successful
[18:17:26] ✅    ✅ Data merged successfully
[18:17:27] ✅    ✅ Order data extracted and validated
[18:17:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:33] [DOC: 9190392] ✅ Patient exists in API: Lorna Lessa, ID: f3a9f4a1-957c-4a56-8c8b-ac101bef954d
[18:17:33] ✅    ✅ Existing patient found with ID: f3a9f4a1-957c-4a56-8c8b-ac101bef954d
[18:17:33] 🔄 
🔄 Step 6: Pushing order to API...
[18:17:33] [DOC: 9190392] ℹ️  Pushing order via API for patient ID: f3a9f4a1-957c-4a56-8c8b-ac101bef954d
[18:17:34] [DOC: 9190392] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13935"}
[18:17:34] ❌    ❌ Failed to push order
[18:17:34] 🔄 
🔄 Step 7: Writing to CSV...
[18:17:34] [DOC: 9190392] ℹ️  Calculated age: 65 from DOB: 07/26/1959
[18:17:34] [DOC: 9190392] ℹ️  Service Line extracted: 'RN'
[18:17:34] [DOC: 9190392] ℹ️  Payer Source extracted: 'Medicare'
[18:17:34] [DOC: 9190392] ℹ️  Diagnosis codes being written:
[18:17:34] [DOC: 9190392] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:17:34] [DOC: 9190392] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:17:34] [DOC: 9190392] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:17:34] [DOC: 9190392] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:17:34] [DOC: 9190392] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:17:34] [DOC: 9190392] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:17:34] [DOC: 9190392] ✅ Patient data written to CSV: Lorna Lessa | Sex: FEMALE | Age: 65 | Service: RN | Payer: Medicare | MRN: 5938015
[18:17:34] ✅    ✅ Document 9190392 processed and saved successfully
[18:17:34] 🔄 
🔄 Step 8: Saving API details...
[18:17:34] [DOC: 9190392] ℹ️  API push details saved for document 9190392
[18:17:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189930                         ║
================================================================================
[18:17:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:17:34] ℹ️  Date: 03/19/2025
[18:17:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:37] [DOC: 9189930] ✅ Text extracted using pdfplumber (12733 chars)
[18:17:37] ✅    ✅ Text extracted using pdfplumber (12733 chars)
[18:17:37] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:40] ℹ️  AI extracted raw sex value: 'F'
[18:17:40] ℹ️  AI extracted service line: 'OT'
[18:17:40] ℹ️  AI extracted payer source: ''
[18:17:40] ℹ️  AI extracted diagnoses:
[18:17:40] ℹ️    - Diagnosis 1: 'HTN'
[18:17:40] ℹ️    - Diagnosis 2: 'CVA'
[18:17:40] ℹ️    - Diagnosis 3: ''
[18:17:40] ℹ️    - Diagnosis 4: ''
[18:17:40] ℹ️    - Diagnosis 5: ''
[18:17:40] ℹ️    - Diagnosis 6: ''
[18:17:40] ℹ️  Final extracted MRN: 'MA230120073707'
[18:17:40] ℹ️  Final extracted Sex: 'FEMALE'
[18:17:40] ℹ️  Final extracted Service Line: 'OT'
[18:17:40] ℹ️  Final extracted Payer Source: ''
[18:17:40] ✅ Patient data extraction completed successfully
[18:17:40] ✅    ✅ Patient data extracted successfully
[18:17:40] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2024', 'endOfEpisode': '', 'firstDiagnosis': 'HTN', 'secondDiagnosis': 'CVA', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:40] ✅    ✅ Patient identified: Diamantina Frias
[18:17:40] ✅    ✅ Patient name validation passed
[18:17:40] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:40] [DOC: 9189930] ℹ️  DOB normalized: 07/04/1937
[18:17:40] [DOC: 9189930] ℹ️  Episode startOfEpisode normalized: 01/26/2024
[18:17:40] [DOC: 9189930] ✅ Patient date processing completed successfully
[18:17:40] ✅    ✅ Date processing completed
[18:17:40] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/26/2024', 'endOfEpisode': '', 'firstDiagnosis': 'HTN', 'secondDiagnosis': 'CVA', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:40] 🔄 
🔄 Step 4: Extracting order data...
[18:17:42] ℹ️  Order extraction - MRN: 'MA230120073707'
[18:17:42] ℹ️  Order extraction - Sex: 'FEMALE'
[18:17:42] ℹ️  Order extraction - Service Line: 'OT'
[18:17:42] ℹ️  Order extraction - Payer Source: ''
[18:17:42] ✅ Order data extraction completed successfully
[18:17:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:42] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[18:17:42] ℹ️  Service line consistent in both sources: 'OT'
[18:17:42] ✅ Patient name cross-validation successful
[18:17:42] ✅    ✅ Data merged successfully
[18:17:43] ⚠️     ❌ Skipping - missing episode start date
[18:17:43] [DOC: 9189930] ℹ️  API push details saved for document 9189930
================================================================================
║                        Processing Document ID: 9189921                         ║
================================================================================
[18:17:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:17:43] ℹ️  Date: 03/19/2025
[18:17:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:46] [DOC: 9189921] ✅ Text extracted using pdfplumber (1388 chars)
[18:17:46] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[18:17:46] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:48] ℹ️  AI extracted raw sex value: ''
[18:17:48] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:17:48] ℹ️  AI extracted payer source: ''
[18:17:48] ℹ️  AI extracted diagnoses:
[18:17:48] ℹ️    - Diagnosis 1: 'I10'
[18:17:48] ℹ️    - Diagnosis 2: 'I63.00'
[18:17:48] ℹ️    - Diagnosis 3: 'F41.9'
[18:17:48] ℹ️    - Diagnosis 4: 'None'
[18:17:48] ℹ️    - Diagnosis 5: 'None'
[18:17:48] ℹ️    - Diagnosis 6: 'None'
[18:17:48] ℹ️  Final extracted MRN: 'MA230120073707'
[18:17:48] ℹ️  Final extracted Sex: ''
[18:17:48] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:17:48] ℹ️  Final extracted Payer Source: ''
[18:17:48] ✅ Patient data extraction completed successfully
[18:17:48] ✅    ✅ Patient data extracted successfully
[18:17:48] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:17:48] ✅    ✅ Patient identified: Diamantina Frias
[18:17:48] ✅    ✅ Patient name validation passed
[18:17:48] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:48] [DOC: 9189921] ℹ️  DOB normalized: 07/04/1937
[18:17:48] [DOC: 9189921] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[18:17:48] [DOC: 9189921] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[18:17:48] [DOC: 9189921] ✅ Patient date processing completed successfully
[18:17:48] ✅    ✅ Date processing completed
[18:17:48] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9'}]
[18:17:48] 🔄 
🔄 Step 4: Extracting order data...
[18:17:51] ℹ️  Order extraction - MRN: 'MA230120073707'
[18:17:51] ℹ️  Order extraction - Sex: ''
[18:17:51] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:17:51] ℹ️  Order extraction - Payer Source: ''
[18:17:51] ✅ Order data extraction completed successfully
[18:17:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:51] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[18:17:51] ⚠️  Could not determine sex using any available method
[18:17:51] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:17:51] ✅ Patient name cross-validation successful
[18:17:51] ✅    ✅ Data merged successfully
[18:17:52] ✅    ✅ Order data extracted and validated
[18:17:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:58] [DOC: 9189921] ✅ Patient exists in API: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:17:58] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:17:58] 🔄 
🔄 Step 6: Pushing order to API...
[18:17:58] [DOC: 9189921] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:17:59] [DOC: 9189921] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12943"}
[18:17:59] ❌    ❌ Failed to push order
[18:17:59] 🔄 
🔄 Step 7: Writing to CSV...
[18:17:59] [DOC: 9189921] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[18:17:59] [DOC: 9189921] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:17:59] [DOC: 9189921] ℹ️  Payer Source extracted: ''
[18:17:59] [DOC: 9189921] ℹ️  Diagnosis codes being written:
[18:17:59] [DOC: 9189921] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:17:59] [DOC: 9189921] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[18:17:59] [DOC: 9189921] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[18:17:59] [DOC: 9189921] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:17:59] [DOC: 9189921] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:17:59] [DOC: 9189921] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:17:59] [DOC: 9189921] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Occupational Therapy | Payer:  | MRN: MA230120073707
[18:17:59] ✅    ✅ Document 9189921 processed and saved successfully
[18:17:59] 🔄 
🔄 Step 8: Saving API details...
[18:17:59] [DOC: 9189921] ℹ️  API push details saved for document 9189921
[18:17:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189919                         ║
================================================================================
[18:17:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:17:59] ℹ️  Date: 03/19/2025
[18:17:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:01] [DOC: 9189919] ✅ Text extracted using pdfplumber (1385 chars)
[18:18:01] ✅    ✅ Text extracted using pdfplumber (1385 chars)
[18:18:01] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:04] ℹ️  AI extracted raw sex value: ''
[18:18:04] ℹ️  AI extracted service line: 'Physical Therapy'
[18:18:04] ℹ️  AI extracted payer source: ''
[18:18:04] ℹ️  AI extracted diagnoses:
[18:18:04] ℹ️    - Diagnosis 1: 'I10'
[18:18:04] ℹ️    - Diagnosis 2: 'I63.00'
[18:18:04] ℹ️    - Diagnosis 3: 'F41.9'
[18:18:04] ℹ️    - Diagnosis 4: ''
[18:18:04] ℹ️    - Diagnosis 5: ''
[18:18:04] ℹ️    - Diagnosis 6: ''
[18:18:04] ℹ️  Final extracted MRN: 'MA230120073707'
[18:18:04] ℹ️  Final extracted Sex: ''
[18:18:04] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:18:04] ℹ️  Final extracted Payer Source: ''
[18:18:04] ✅ Patient data extraction completed successfully
[18:18:04] ✅    ✅ Patient data extracted successfully
[18:18:04] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:18:04] ✅    ✅ Patient identified: Diamantina Frias
[18:18:04] ✅    ✅ Patient name validation passed
[18:18:04] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:04] [DOC: 9189919] ℹ️  DOB normalized: 07/04/1937
[18:18:04] [DOC: 9189919] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[18:18:04] [DOC: 9189919] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[18:18:04] [DOC: 9189919] ✅ Patient date processing completed successfully
[18:18:04] ✅    ✅ Date processing completed
[18:18:04] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:18:04] 🔄 
🔄 Step 4: Extracting order data...
[18:18:06] ℹ️  Order extraction - MRN: 'MA230120073707'
[18:18:06] ℹ️  Order extraction - Sex: ''
[18:18:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:18:06] ℹ️  Order extraction - Payer Source: ''
[18:18:06] ✅ Order data extraction completed successfully
[18:18:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:06] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[18:18:06] ⚠️  Could not determine sex using any available method
[18:18:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:18:06] ✅ Patient name cross-validation successful
[18:18:06] ✅    ✅ Data merged successfully
[18:18:08] ✅    ✅ Order data extracted and validated
[18:18:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:08] [DOC: 9189919] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:08] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:08] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:08] [DOC: 9189919] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:09] [DOC: 9189919] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12944"}
[18:18:09] ❌    ❌ Failed to push order
[18:18:09] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:09] [DOC: 9189919] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[18:18:09] [DOC: 9189919] ℹ️  Service Line extracted: 'Physical Therapy'
[18:18:09] [DOC: 9189919] ℹ️  Payer Source extracted: ''
[18:18:09] [DOC: 9189919] ℹ️  Diagnosis codes being written:
[18:18:09] [DOC: 9189919] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:18:09] [DOC: 9189919] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[18:18:09] [DOC: 9189919] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[18:18:09] [DOC: 9189919] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:09] [DOC: 9189919] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:09] [DOC: 9189919] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:09] [DOC: 9189919] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA230120073707
[18:18:09] ✅    ✅ Document 9189919 processed and saved successfully
[18:18:09] 🔄 
🔄 Step 8: Saving API details...
[18:18:09] [DOC: 9189919] ℹ️  API push details saved for document 9189919
[18:18:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189918                         ║
================================================================================
[18:18:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:18:09] ℹ️  Date: 03/19/2025
[18:18:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:11] [DOC: 9189918] ✅ Text extracted using pdfplumber (1388 chars)
[18:18:11] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[18:18:11] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:14] ℹ️  AI extracted raw sex value: ''
[18:18:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:18:14] ℹ️  AI extracted payer source: ''
[18:18:14] ℹ️  AI extracted diagnoses:
[18:18:14] ℹ️    - Diagnosis 1: 'I10'
[18:18:14] ℹ️    - Diagnosis 2: 'I63.00'
[18:18:14] ℹ️    - Diagnosis 3: 'F41.9'
[18:18:14] ℹ️    - Diagnosis 4: 'None'
[18:18:14] ℹ️    - Diagnosis 5: 'None'
[18:18:14] ℹ️    - Diagnosis 6: 'None'
[18:18:14] ℹ️  Final extracted MRN: 'MA230120073707'
[18:18:14] ℹ️  Final extracted Sex: ''
[18:18:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:18:14] ℹ️  Final extracted Payer Source: ''
[18:18:14] ✅ Patient data extraction completed successfully
[18:18:14] ✅    ✅ Patient data extracted successfully
[18:18:14] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: AILEEN SOUZA
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:18:14] ✅    ✅ Patient identified: Diamantina Frias
[18:18:14] ✅    ✅ Patient name validation passed
[18:18:14] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:14] [DOC: 9189918] ℹ️  DOB normalized: 07/04/1937
[18:18:14] [DOC: 9189918] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[18:18:14] [DOC: 9189918] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[18:18:14] [DOC: 9189918] ✅ Patient date processing completed successfully
[18:18:14] ✅    ✅ Date processing completed
[18:18:14] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: AILEEN SOUZA
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9'}]
[18:18:14] 🔄 
🔄 Step 4: Extracting order data...
[18:18:17] ℹ️  Order extraction - MRN: 'MA230120073707'
[18:18:17] ℹ️  Order extraction - Sex: ''
[18:18:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:18:17] ℹ️  Order extraction - Payer Source: ''
[18:18:17] ✅ Order data extraction completed successfully
[18:18:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:17] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[18:18:17] ⚠️  Could not determine sex using any available method
[18:18:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:18:17] ✅ Patient name cross-validation successful
[18:18:17] ✅    ✅ Data merged successfully
[18:18:18] ✅    ✅ Order data extracted and validated
[18:18:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:18] [DOC: 9189918] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:18] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:18] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:18] [DOC: 9189918] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:19] [DOC: 9189918] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12945"}
[18:18:19] ❌    ❌ Failed to push order
[18:18:19] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:19] [DOC: 9189918] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[18:18:19] [DOC: 9189918] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:18:19] [DOC: 9189918] ℹ️  Payer Source extracted: ''
[18:18:19] [DOC: 9189918] ℹ️  Diagnosis codes being written:
[18:18:19] [DOC: 9189918] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:18:19] [DOC: 9189918] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[18:18:19] [DOC: 9189918] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[18:18:19] [DOC: 9189918] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:19] [DOC: 9189918] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:19] [DOC: 9189918] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:19] [DOC: 9189918] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Skilled Nursing | Payer:  | MRN: MA230120073707
[18:18:19] ✅    ✅ Document 9189918 processed and saved successfully
[18:18:19] 🔄 
🔄 Step 8: Saving API details...
[18:18:19] [DOC: 9189918] ℹ️  API push details saved for document 9189918
[18:18:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189917                         ║
================================================================================
[18:18:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:18:19] ℹ️  Date: 03/19/2025
[18:18:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:21] [DOC: 9189917] ✅ Text extracted using pdfplumber (1375 chars)
[18:18:21] ✅    ✅ Text extracted using pdfplumber (1375 chars)
[18:18:21] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:24] ℹ️  AI extracted raw sex value: ''
[18:18:24] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:18:24] ℹ️  AI extracted payer source: ''
[18:18:24] ℹ️  AI extracted diagnoses:
[18:18:24] ℹ️    - Diagnosis 1: 'I10'
[18:18:24] ℹ️    - Diagnosis 2: 'I63.00'
[18:18:24] ℹ️    - Diagnosis 3: 'F41.9'
[18:18:24] ℹ️    - Diagnosis 4: ''
[18:18:24] ℹ️    - Diagnosis 5: ''
[18:18:24] ℹ️    - Diagnosis 6: ''
[18:18:24] ℹ️  Final extracted MRN: 'MA230120073707'
[18:18:24] ℹ️  Final extracted Sex: ''
[18:18:24] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:18:24] ℹ️  Final extracted Payer Source: ''
[18:18:24] ✅ Patient data extraction completed successfully
[18:18:24] ✅    ✅ Patient data extracted successfully
[18:18:24] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:18:24] ✅    ✅ Patient identified: Diamantina Frias
[18:18:24] ✅    ✅ Patient name validation passed
[18:18:24] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:24] [DOC: 9189917] ℹ️  DOB normalized: 07/04/1937
[18:18:24] [DOC: 9189917] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[18:18:24] [DOC: 9189917] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[18:18:24] [DOC: 9189917] ✅ Patient date processing completed successfully
[18:18:24] ✅    ✅ Date processing completed
[18:18:24] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:18:24] 🔄 
🔄 Step 4: Extracting order data...
[18:18:27] ℹ️  Order extraction - MRN: 'MA230120073707'
[18:18:27] ℹ️  Order extraction - Sex: ''
[18:18:27] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:18:27] ℹ️  Order extraction - Payer Source: ''
[18:18:27] ✅ Order data extraction completed successfully
[18:18:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:27] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[18:18:27] ⚠️  Could not determine sex using any available method
[18:18:27] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:18:27] ✅ Patient name cross-validation successful
[18:18:27] ✅    ✅ Data merged successfully
[18:18:28] ✅    ✅ Order data extracted and validated
[18:18:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:28] [DOC: 9189917] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:28] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:28] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:28] [DOC: 9189917] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:29] [DOC: 9189917] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12946"}
[18:18:29] ❌    ❌ Failed to push order
[18:18:29] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:29] [DOC: 9189917] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[18:18:29] [DOC: 9189917] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:18:29] [DOC: 9189917] ℹ️  Payer Source extracted: ''
[18:18:29] [DOC: 9189917] ℹ️  Diagnosis codes being written:
[18:18:29] [DOC: 9189917] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:18:29] [DOC: 9189917] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[18:18:29] [DOC: 9189917] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[18:18:29] [DOC: 9189917] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:29] [DOC: 9189917] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:29] [DOC: 9189917] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:29] [DOC: 9189917] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Occupational Therapy | Payer:  | MRN: MA230120073707
[18:18:29] ✅    ✅ Document 9189917 processed and saved successfully
[18:18:29] 🔄 
🔄 Step 8: Saving API details...
[18:18:29] [DOC: 9189917] ℹ️  API push details saved for document 9189917
[18:18:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189916                         ║
================================================================================
[18:18:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:18:29] ℹ️  Date: 03/19/2025
[18:18:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:31] [DOC: 9189916] ✅ Text extracted using pdfplumber (1305 chars)
[18:18:31] ✅    ✅ Text extracted using pdfplumber (1305 chars)
[18:18:31] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:34] ℹ️  AI extracted raw sex value: ''
[18:18:34] ℹ️  AI extracted service line: 'Physical Therapy'
[18:18:34] ℹ️  AI extracted payer source: ''
[18:18:34] ℹ️  AI extracted diagnoses:
[18:18:34] ℹ️    - Diagnosis 1: 'I10'
[18:18:34] ℹ️    - Diagnosis 2: 'I63.00'
[18:18:34] ℹ️    - Diagnosis 3: 'F41.9'
[18:18:34] ℹ️    - Diagnosis 4: ''
[18:18:34] ℹ️    - Diagnosis 5: ''
[18:18:34] ℹ️    - Diagnosis 6: ''
[18:18:34] ℹ️  Final extracted MRN: 'MA230120073707'
[18:18:34] ℹ️  Final extracted Sex: ''
[18:18:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:18:34] ℹ️  Final extracted Payer Source: ''
[18:18:34] ✅ Patient data extraction completed successfully
[18:18:34] ✅    ✅ Patient data extracted successfully
[18:18:34] 📊 Patient Response
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:18:34] ✅    ✅ Patient identified: Diamantina Frias
[18:18:34] ✅    ✅ Patient name validation passed
[18:18:34] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:34] [DOC: 9189916] ℹ️  DOB normalized: 07/04/1937
[18:18:34] [DOC: 9189916] ℹ️  Episode startOfEpisode normalized: 01/25/2024
[18:18:34] [DOC: 9189916] ℹ️  Episode endOfEpisode normalized: 03/24/2024
[18:18:34] [DOC: 9189916] ✅ Patient date processing completed successfully
[18:18:34] ✅    ✅ Date processing completed
[18:18:34] 📊 Processed Patient Data
     └─ patientFName: Diamantina
     └─ patientLName: Frias
     └─ dob: 07/04/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230120073707
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/25/2024', 'endOfEpisode': '03/24/2024', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I63.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:18:34] 🔄 
🔄 Step 4: Extracting order data...
[18:18:37] ℹ️  Order extraction - MRN: 'MA230120073707'
[18:18:37] ℹ️  Order extraction - Sex: ''
[18:18:37] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:18:37] ℹ️  Order extraction - Payer Source: ''
[18:18:37] ✅ Order data extraction completed successfully
[18:18:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:37] ℹ️  Using MRN from patient data: 'MA230120073707' over 'MA230120073707'
[18:18:37] ⚠️  Could not determine sex using any available method
[18:18:37] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:18:37] ✅ Patient name cross-validation successful
[18:18:37] ✅    ✅ Data merged successfully
[18:18:38] ✅    ✅ Order data extracted and validated
[18:18:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:38] [DOC: 9189916] ✅ Patient found in local cache: Diamantina Frias, ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:38] ✅    ✅ Existing patient found with ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:38] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:38] [DOC: 9189916] ℹ️  Pushing order via API for patient ID: b639a475-376a-4b34-98bc-422fb0382c80
[18:18:39] [DOC: 9189916] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12947"}
[18:18:39] ❌    ❌ Failed to push order
[18:18:39] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:39] [DOC: 9189916] ℹ️  Calculated age: 87 from DOB: 07/04/1937
[18:18:39] [DOC: 9189916] ℹ️  Service Line extracted: 'Physical Therapy'
[18:18:39] [DOC: 9189916] ℹ️  Payer Source extracted: ''
[18:18:39] [DOC: 9189916] ℹ️  Diagnosis codes being written:
[18:18:39] [DOC: 9189916] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[18:18:39] [DOC: 9189916] ℹ️    - Latest_Episode_Seconddiagnosis: 'I63.00'
[18:18:39] [DOC: 9189916] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[18:18:39] [DOC: 9189916] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:39] [DOC: 9189916] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:39] [DOC: 9189916] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:39] [DOC: 9189916] ✅ Patient data written to CSV: Diamantina Frias | Sex:  | Age: 87 | Service: Physical Therapy | Payer:  | MRN: MA230120073707
[18:18:39] ✅    ✅ Document 9189916 processed and saved successfully
[18:18:39] 🔄 
🔄 Step 8: Saving API details...
[18:18:39] [DOC: 9189916] ℹ️  API push details saved for document 9189916
[18:18:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9189873                         ║
================================================================================
[18:18:39] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:18:39] ℹ️  Date: 03/19/2025
[18:18:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:42] [DOC: 9189873] ✅ Text extracted using pdfplumber (39690 chars)
[18:18:42] ✅    ✅ Text extracted using pdfplumber (39690 chars)
[18:18:42] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:45] ℹ️  AI extracted raw sex value: 'None'
[18:18:45] ℹ️  AI extracted service line: 'None'
[18:18:45] ℹ️  AI extracted payer source: 'None'
[18:18:45] ℹ️  AI extracted diagnoses:
[18:18:45] ℹ️    - Diagnosis 1: ''
[18:18:45] ℹ️    - Diagnosis 2: ''
[18:18:45] ℹ️    - Diagnosis 3: ''
[18:18:45] ℹ️    - Diagnosis 4: ''
[18:18:45] ℹ️    - Diagnosis 5: ''
[18:18:45] ℹ️    - Diagnosis 6: ''
[18:18:45] ℹ️  Final extracted MRN: ''
[18:18:45] ℹ️  Final extracted Sex: ''
[18:18:45] ℹ️  Final extracted Service Line: ''
[18:18:45] ℹ️  Final extracted Payer Source: ''
[18:18:45] ✅ Patient data extraction completed successfully
[18:18:45] ✅    ✅ Patient data extracted successfully
[18:18:45] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[18:18:45] ⚠️     ❌ Insufficient patient data extracted
[18:18:45] [DOC: 9189873] ℹ️  API push details saved for document 9189873
================================================================================
║                        Processing Document ID: 9187500                         ║
================================================================================
[18:18:45] ℹ️  Agency: Dartmouth HH
[18:18:45] ℹ️  Date: 03/18/2025
[18:18:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:47] [DOC: 9187500] ✅ Text extracted using pdfplumber (1184 chars)
[18:18:47] ✅    ✅ Text extracted using pdfplumber (1184 chars)
[18:18:47] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:50] ℹ️  AI extracted raw sex value: 'M'
[18:18:50] ℹ️  AI extracted service line: 'RN, LPN'
[18:18:50] ℹ️  AI extracted payer source: 'Medicare'
[18:18:50] ℹ️  AI extracted diagnoses:
[18:18:50] ℹ️    - Diagnosis 1: 'None'
[18:18:50] ℹ️    - Diagnosis 2: 'None'
[18:18:50] ℹ️    - Diagnosis 3: 'None'
[18:18:50] ℹ️    - Diagnosis 4: 'None'
[18:18:50] ℹ️    - Diagnosis 5: 'None'
[18:18:50] ℹ️    - Diagnosis 6: 'None'
[18:18:50] ℹ️  Final extracted MRN: '842002'
[18:18:50] ℹ️  Final extracted Sex: 'MALE'
[18:18:50] ℹ️  Final extracted Service Line: 'RN, LPN'
[18:18:50] ℹ️  Final extracted Payer Source: 'Medicare'
[18:18:50] ✅ Patient data extraction completed successfully
[18:18:50] ✅    ✅ Patient data extracted successfully
[18:18:50] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:18:50] ✅    ✅ Patient identified: Johannes Bjornson
[18:18:50] ✅    ✅ Patient name validation passed
[18:18:50] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:50] [DOC: 9187500] ℹ️  DOB normalized: 02/09/1942
[18:18:50] [DOC: 9187500] ℹ️  Episode startOfCare normalized: 10/10/2024
[18:18:50] [DOC: 9187500] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[18:18:50] [DOC: 9187500] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[18:18:50] [DOC: 9187500] ✅ Patient date processing completed successfully
[18:18:50] ✅    ✅ Date processing completed
[18:18:50] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025'}]
[18:18:50] 🔄 
🔄 Step 4: Extracting order data...
[18:18:52] ℹ️  Order extraction - MRN: ''
[18:18:52] ℹ️  Order extraction - Sex: 'MALE'
[18:18:52] ℹ️  Order extraction - Service Line: 'RN, LPN'
[18:18:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:18:52] ✅ Order data extraction completed successfully
[18:18:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:52] ℹ️  Using MRN from patient data: '842002'
[18:18:52] ℹ️  Service line consistent in both sources: 'RN, LPN'
[18:18:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:18:52] ✅ Patient name cross-validation successful
[18:18:52] ✅    ✅ Data merged successfully
[18:18:53] ✅    ✅ Order data extracted and validated
[18:18:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:53] [DOC: 9187500] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[18:18:53] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[18:18:53] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:53] [DOC: 9187500] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[18:18:55] [DOC: 9187500] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[18:18:55] ❌    ❌ Failed to push order
[18:18:55] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:55] [DOC: 9187500] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[18:18:55] [DOC: 9187500] ℹ️  Service Line extracted: 'RN, LPN'
[18:18:55] [DOC: 9187500] ℹ️  Payer Source extracted: 'Medicare'
[18:18:55] [DOC: 9187500] ℹ️  Diagnosis codes being written:
[18:18:55] [DOC: 9187500] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:18:55] [DOC: 9187500] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:18:55] [DOC: 9187500] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:18:55] [DOC: 9187500] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:55] [DOC: 9187500] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:55] [DOC: 9187500] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:55] [DOC: 9187500] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: RN, LPN | Payer: Medicare | MRN: 842002
[18:18:55] ✅    ✅ Document 9187500 processed and saved successfully
[18:18:55] 🔄 
🔄 Step 8: Saving API details...
[18:18:55] [DOC: 9187500] ℹ️  API push details saved for document 9187500
[18:18:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187493                         ║
================================================================================
[18:18:55] ℹ️  Agency: Dartmouth HH
[18:18:55] ℹ️  Date: 03/18/2025
[18:18:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:58] [DOC: 9187493] ✅ Text extracted using pdfplumber (1668 chars)
[18:18:58] ✅    ✅ Text extracted using pdfplumber (1668 chars)
[18:18:58] 🔄 
🔄 Step 2: Extracting patient data...
[18:19:00] ℹ️  AI extracted raw sex value: 'F'
[18:19:00] ℹ️  AI extracted service line: 'RN, LPN'
[18:19:00] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[18:19:00] ℹ️  AI extracted diagnoses:
[18:19:00] ℹ️    - Diagnosis 1: ''
[18:19:00] ℹ️    - Diagnosis 2: ''
[18:19:00] ℹ️    - Diagnosis 3: ''
[18:19:00] ℹ️    - Diagnosis 4: ''
[18:19:00] ℹ️    - Diagnosis 5: ''
[18:19:00] ℹ️    - Diagnosis 6: ''
[18:19:00] ℹ️  Final extracted MRN: '6066015'
[18:19:00] ℹ️  Final extracted Sex: 'FEMALE'
[18:19:00] ℹ️  Final extracted Service Line: 'RN, LPN'
[18:19:00] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[18:19:00] ✅ Patient data extraction completed successfully
[18:19:00] ✅    ✅ Patient data extracted successfully
[18:19:00] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:19:00] ✅    ✅ Patient identified: Lois Fernandes
[18:19:00] ✅    ✅ Patient name validation passed
[18:19:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:19:00] [DOC: 9187493] ℹ️  DOB normalized: 05/15/1941
[18:19:00] [DOC: 9187493] ℹ️  Episode startOfCare normalized: 02/22/2025
[18:19:00] [DOC: 9187493] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[18:19:00] [DOC: 9187493] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[18:19:00] [DOC: 9187493] ✅ Patient date processing completed successfully
[18:19:00] ✅    ✅ Date processing completed
[18:19:00] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:19:00] 🔄 
🔄 Step 4: Extracting order data...
[18:19:03] ℹ️  Order extraction - MRN: ''
[18:19:03] ℹ️  Order extraction - Sex: 'FEMALE'
[18:19:03] ℹ️  Order extraction - Service Line: 'RN, LPN'
[18:19:03] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[18:19:03] ✅ Order data extraction completed successfully
[18:19:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:19:03] ℹ️  Using MRN from patient data: '6066015'
[18:19:03] ℹ️  Service line consistent in both sources: 'RN, LPN'
[18:19:03] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[18:19:03] ✅ Patient name cross-validation successful
[18:19:03] ✅    ✅ Data merged successfully
[18:19:05] ✅    ✅ Order data extracted and validated
[18:19:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:19:05] [DOC: 9187493] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[18:19:05] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[18:19:05] 🔄 
🔄 Step 6: Pushing order to API...
[18:19:05] [DOC: 9187493] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[18:19:06] [DOC: 9187493] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13961"}
[18:19:06] ❌    ❌ Failed to push order
[18:19:06] 🔄 
🔄 Step 7: Writing to CSV...
[18:19:06] [DOC: 9187493] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[18:19:06] [DOC: 9187493] ℹ️  Service Line extracted: 'RN, LPN'
[18:19:06] [DOC: 9187493] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[18:19:06] [DOC: 9187493] ℹ️  Diagnosis codes being written:
[18:19:06] [DOC: 9187493] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:19:06] [DOC: 9187493] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:19:06] [DOC: 9187493] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:19:06] [DOC: 9187493] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:19:06] [DOC: 9187493] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:19:06] [DOC: 9187493] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:19:06] [DOC: 9187493] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: RN, LPN | Payer: Blue Cross Medicare Adv | MRN: 6066015
[18:19:06] ✅    ✅ Document 9187493 processed and saved successfully
[18:19:06] 🔄 
🔄 Step 8: Saving API details...
[18:19:06] [DOC: 9187493] ℹ️  API push details saved for document 9187493
[18:19:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9187373                         ║
================================================================================
[18:19:06] ℹ️  Agency: Dartmouth HH
[18:19:06] ℹ️  Date: 03/18/2025
[18:19:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:19:10] [DOC: 9187373] ✅ Text extracted using pdfplumber (13362 chars)
[18:19:10] ✅    ✅ Text extracted using pdfplumber (13362 chars)
[18:19:10] 🔄 
🔄 Step 2: Extracting patient data...
[18:19:13] ℹ️  AI extracted raw sex value: 'M'
[18:19:13] ℹ️  AI extracted service line: 'PT'
[18:19:13] ℹ️  AI extracted payer source: ''
[18:19:13] ℹ️  AI extracted diagnoses:
[18:19:13] ℹ️    - Diagnosis 1: 'M18.11'
[18:19:13] ℹ️    - Diagnosis 2: 'Z47.1'
[18:19:13] ℹ️    - Diagnosis 3: 'E11.9'
[18:19:13] ℹ️    - Diagnosis 4: 'I10'
[18:19:13] ℹ️    - Diagnosis 5: 'J44.89'
[18:19:13] ℹ️    - Diagnosis 6: 'G47.31'
[18:19:13] ℹ️  Final extracted MRN: '227027'
[18:19:13] ℹ️  Final extracted Sex: 'MALE'
[18:19:13] ℹ️  Final extracted Service Line: 'PT'
[18:19:13] ℹ️  Final extracted Payer Source: ''
[18:19:13] ✅ Patient data extraction completed successfully
[18:19:13] ✅    ✅ Patient data extracted successfully
[18:19:13] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Dossantos
     └─ dob: 08/22/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'M18.11', 'secondDiagnosis': 'Z47.1', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'G47.31'}]
[18:19:13] ✅    ✅ Patient identified: John Dossantos
[18:19:13] ✅    ✅ Patient name validation passed
[18:19:13] 🔄 
🔄 Step 3: Processing patient dates...
[18:19:13] [DOC: 9187373] ℹ️  DOB normalized: 08/22/1947
[18:19:13] [DOC: 9187373] ℹ️  Episode startOfCare normalized: 03/01/2025
[18:19:13] [DOC: 9187373] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[18:19:13] [DOC: 9187373] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[18:19:13] [DOC: 9187373] ✅ Patient date processing completed successfully
[18:19:13] ✅    ✅ Date processing completed
[18:19:13] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Dossantos
     └─ dob: 08/22/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'M18.11', 'secondDiagnosis': 'Z47.1', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J44.89', 'sixthDiagnosis': 'G47.31'}]
[18:19:13] 🔄 
🔄 Step 4: Extracting order data...
[18:19:17] ℹ️  Order extraction - MRN: '6114015'
[18:19:17] ℹ️  Order extraction - Sex: 'MALE'
[18:19:17] ℹ️  Order extraction - Service Line: 'PT'
[18:19:17] ℹ️  Order extraction - Payer Source: ''
[18:19:17] ✅ Order data extraction completed successfully
[18:19:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:19:17] ℹ️  Using longer MRN from order data: '6114015' over '227027'
[18:19:17] ℹ️  Service line consistent in both sources: 'PT'
[18:19:17] ✅ Patient name cross-validation successful
[18:19:17] ✅    ✅ Data merged successfully
