================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[04:44:53] ℹ️  CSV Data Extraction & API Push Tool
[04:44:53] ℹ️  
[04:44:53] ℹ️  Features:
[04:44:53] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[04:44:53] ℹ️  - AI-powered patient and order data extraction
[04:44:53] ℹ️  - Enhanced error handling and logging
[04:44:53] ℹ️  - Full API integration (patient creation + order pushing)
[04:44:53] ℹ️  - CSV output with comprehensive patient data
[04:44:53] ℹ️  - Detailed API tracking with remarks for every document
[04:44:53] ℹ️  - Complete audit trail of all processing attempts
[04:44:53] ℹ️  
[04:44:53] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[04:44:53] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_044453.csv
[04:44:53] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_044453.csv
================================================================================
║                        Processing Document ID: 9249199                         ║
================================================================================
[04:44:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:44:53] ℹ️  Date: 04/18/2025
[04:44:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:44:54] [DOC: 9249199] ✅ Text extracted using pdfplumber (1056 chars)
[04:44:54] ✅    ✅ Text extracted using pdfplumber (1056 chars)
[04:44:54] 🔄 
🔄 Step 2: Extracting patient data...
[04:44:58] ℹ️  AI extracted raw sex value: 'F'
[04:44:58] ℹ️  AI extracted service line: 'OT'
[04:44:58] ℹ️  AI extracted payer source: ''
[04:44:58] ℹ️  AI extracted diagnoses:
[04:44:58] ℹ️    - Diagnosis 1: ''
[04:44:58] ℹ️    - Diagnosis 2: ''
[04:44:58] ℹ️    - Diagnosis 3: ''
[04:44:58] ℹ️    - Diagnosis 4: ''
[04:44:58] ℹ️    - Diagnosis 5: ''
[04:44:58] ℹ️    - Diagnosis 6: ''
[04:44:58] ℹ️  Final extracted MRN: '2311186'
[04:44:58] ℹ️  Final extracted Sex: 'FEMALE'
[04:44:58] ℹ️  Final extracted Service Line: 'OT'
[04:44:58] ℹ️  Final extracted Payer Source: ''
[04:44:58] ✅ Patient data extraction completed successfully
[04:44:58] ✅    ✅ Patient data extracted successfully
[04:44:58] 📊 Patient Response
     └─ patientFName: Helen
     └─ patientLName: Carter
     └─ dob: 02/14/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2311186
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:44:58] ✅    ✅ Patient identified: Helen Carter
[04:44:58] ✅    ✅ Patient name validation passed
[04:44:58] 🔄 
🔄 Step 3: Processing patient dates...
[04:44:58] [DOC: 9249199] ℹ️  DOB normalized: 02/14/1943
[04:44:58] [DOC: 9249199] ✅ Patient date processing completed successfully
[04:44:58] ✅    ✅ Date processing completed
[04:44:58] 📊 Processed Patient Data
     └─ patientFName: Helen
     └─ patientLName: Carter
     └─ dob: 02/14/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2311186
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:44:58] 🔄 
🔄 Step 4: Extracting order data...
[04:45:00] ℹ️  Order extraction - MRN: '2311186'
[04:45:00] ℹ️  Order extraction - Sex: 'FEMALE'
[04:45:00] ℹ️  Order extraction - Service Line: ''
[04:45:00] ℹ️  Order extraction - Payer Source: ''
[04:45:00] ✅ Order data extraction completed successfully
[04:45:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:45:00] ℹ️  Using MRN from patient data: '2311186' over '2311186'
[04:45:00] ℹ️  Using service line from patient data: 'OT'
[04:45:00] ✅ Patient name cross-validation successful
[04:45:00] ✅    ✅ Data merged successfully
[04:45:01] ✅    ✅ Order data extracted and validated
[04:45:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:45:01] [DOC: 9249199] ✅ Patient found in local cache: Helen Carter, ID: b04c2986-ad2c-4c23-bb3a-f58cc1572f97
[04:45:01] ✅    ✅ Existing patient found with ID: b04c2986-ad2c-4c23-bb3a-f58cc1572f97
[04:45:01] 🔄 
🔄 Step 6: Pushing order to API...
[04:45:01] [DOC: 9249199] ℹ️  Pushing order via API for patient ID: b04c2986-ad2c-4c23-bb3a-f58cc1572f97
[04:45:03] [DOC: 9249199] ❌ Order push failed with status 201: {"id":"c41fc8fc-88cc-49cb-9631-efaa787b947a","orderWAVId":"ORD20019","orderNo":"1083392","orderDate":"04/14/2025","startOfCare":"04/10/2025","episodeStartDate":"04/10/2025","episodeEndDate":"05/10/2025","documentID":"9249199","mrn":"2311186","patientName":"Carter,Helen S","sentToPhysicianDate":"04/18/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"b04c2986-ad2c-4c23-bb3a-f58cc1572f97","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:45:03] ❌    ❌ Failed to push order
[04:45:03] 🔄 
🔄 Step 7: Writing to CSV...
[04:45:03] [DOC: 9249199] ℹ️  Calculated age: 82 from DOB: 02/14/1943
[04:45:03] [DOC: 9249199] ℹ️  Service Line extracted: 'OT'
[04:45:03] [DOC: 9249199] ℹ️  Payer Source extracted: ''
[04:45:03] [DOC: 9249199] ℹ️  Diagnosis codes being written:
[04:45:03] [DOC: 9249199] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:45:03] [DOC: 9249199] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:45:03] [DOC: 9249199] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:45:03] [DOC: 9249199] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:45:03] [DOC: 9249199] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:45:03] [DOC: 9249199] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:45:03] [DOC: 9249199] ✅ Patient data written to CSV: Helen Carter | Sex: FEMALE | Age: 82 | Service: OT | Payer:  | MRN: 2311186
[04:45:03] ✅    ✅ Document 9249199 processed and saved successfully
[04:45:03] 🔄 
🔄 Step 8: Saving API details...
[04:45:03] [DOC: 9249199] ℹ️  API push details saved for document 9249199
[04:45:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249192                         ║
================================================================================
[04:45:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:45:03] ℹ️  Date: 04/18/2025
[04:45:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:45:06] [DOC: 9249192] ✅ Text extracted using pdfplumber (13333 chars)
[04:45:06] ✅    ✅ Text extracted using pdfplumber (13323 chars)
[04:45:06] 🔄 
🔄 Step 2: Extracting patient data...
[04:45:09] ℹ️  AI extracted raw sex value: 'F'
[04:45:09] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[04:45:09] ℹ️  AI extracted payer source: ''
[04:45:09] ℹ️  AI extracted diagnoses:
[04:45:09] ℹ️    - Diagnosis 1: 'T21.25XD'
[04:45:09] ℹ️    - Diagnosis 2: 'T24.211D'
[04:45:09] ℹ️    - Diagnosis 3: 'X16.XXXD'
[04:45:09] ℹ️    - Diagnosis 4: 'I12.9'
[04:45:09] ℹ️    - Diagnosis 5: 'N18.32'
[04:45:09] ℹ️    - Diagnosis 6: 'J42'
[04:45:09] ℹ️  Final extracted MRN: '2037361'
[04:45:09] ℹ️  Final extracted Sex: 'FEMALE'
[04:45:09] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[04:45:09] ℹ️  Final extracted Payer Source: ''
[04:45:09] ✅ Patient data extraction completed successfully
[04:45:09] ✅    ✅ Patient data extracted successfully
[04:45:09] 📊 Patient Response
     └─ patientFName: Euridice
     └─ patientLName: Caldas
     └─ dob: 10/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2037361
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'T21.25XD', 'secondDiagnosis': 'T24.211D', 'thirdDiagnosis': 'X16.XXXD', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'J42'}]
[04:45:09] ✅    ✅ Patient identified: Euridice Caldas
[04:45:09] ✅    ✅ Patient name validation passed
[04:45:09] 🔄 
🔄 Step 3: Processing patient dates...
[04:45:09] [DOC: 9249192] ℹ️  DOB normalized: 10/13/1934
[04:45:09] [DOC: 9249192] ℹ️  Episode startOfCare normalized: 04/07/2025
[04:45:09] [DOC: 9249192] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[04:45:09] [DOC: 9249192] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[04:45:09] [DOC: 9249192] ✅ Patient date processing completed successfully
[04:45:09] ✅    ✅ Date processing completed
[04:45:09] 📊 Processed Patient Data
     └─ patientFName: Euridice
     └─ patientLName: Caldas
     └─ dob: 10/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2037361
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'T21.25XD', 'secondDiagnosis': 'T24.211D', 'thirdDiagnosis': 'X16.XXXD', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'J42'}]
[04:45:09] 🔄 
🔄 Step 4: Extracting order data...
[04:45:12] ℹ️  Order extraction - MRN: '2037361'
[04:45:12] ℹ️  Order extraction - Sex: 'FEMALE'
[04:45:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[04:45:12] ℹ️  Order extraction - Payer Source: ''
[04:45:12] ✅ Order data extraction completed successfully
[04:45:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:45:12] ℹ️  Using MRN from patient data: '2037361' over '2037361'
[04:45:12] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide'
[04:45:12] ✅ Patient name cross-validation successful
[04:45:12] ✅    ✅ Data merged successfully
[04:45:13] ✅    ✅ Order data extracted and validated
[04:45:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:45:37] [DOC: 9249192] ✅ Patient exists in API: Euridice Caldas, ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[04:45:37] ✅    ✅ Existing patient found with ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[04:45:37] 🔄 
🔄 Step 6: Pushing order to API...
[04:45:37] [DOC: 9249192] ℹ️  Pushing order via API for patient ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[04:45:38] [DOC: 9249192] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13427"}
[04:45:38] ❌    ❌ Failed to push order
[04:45:38] 🔄 
🔄 Step 7: Writing to CSV...
[04:45:38] [DOC: 9249192] ℹ️  Calculated age: 90 from DOB: 10/13/1934
[04:45:38] [DOC: 9249192] ℹ️  Service Line extracted: 'Skilled Nursing, Home Health Aide'
[04:45:38] [DOC: 9249192] ℹ️  Payer Source extracted: ''
[04:45:38] [DOC: 9249192] ℹ️  Diagnosis codes being written:
[04:45:38] [DOC: 9249192] ℹ️    - Latest_Episode_Firstdiagnosis: 'T21.25XD'
[04:45:38] [DOC: 9249192] ℹ️    - Latest_Episode_Seconddiagnosis: 'T24.211D'
[04:45:38] [DOC: 9249192] ℹ️    - Latest_Episode_Thirddiagnosis: 'X16.XXXD'
[04:45:38] [DOC: 9249192] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I12.9'
[04:45:38] [DOC: 9249192] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.32'
[04:45:38] [DOC: 9249192] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J42'
[04:45:38] [DOC: 9249192] ✅ Patient data written to CSV: Euridice Caldas | Sex: FEMALE | Age: 90 | Service: Skilled Nursing, Home Health Aide | Payer:  | MRN: 2037361
[04:45:38] ✅    ✅ Document 9249192 processed and saved successfully
[04:45:38] 🔄 
🔄 Step 8: Saving API details...
[04:45:38] [DOC: 9249192] ℹ️  API push details saved for document 9249192
[04:45:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249188                         ║
================================================================================
[04:45:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:45:38] ℹ️  Date: 04/18/2025
[04:45:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:45:40] [DOC: 9249188] ✅ Text extracted using pdfplumber (2294 chars)
[04:45:40] ✅    ✅ Text extracted using pdfplumber (2294 chars)
[04:45:40] 🔄 
🔄 Step 2: Extracting patient data...
[04:45:42] ℹ️  AI extracted raw sex value: 'M'
[04:45:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:45:42] ℹ️  AI extracted payer source: ''
[04:45:42] ℹ️  AI extracted diagnoses:
[04:45:42] ℹ️    - Diagnosis 1: ''
[04:45:42] ℹ️    - Diagnosis 2: ''
[04:45:42] ℹ️    - Diagnosis 3: ''
[04:45:42] ℹ️    - Diagnosis 4: ''
[04:45:42] ℹ️    - Diagnosis 5: ''
[04:45:42] ℹ️    - Diagnosis 6: ''
[04:45:42] ℹ️  Final extracted MRN: '2261639'
[04:45:42] ℹ️  Final extracted Sex: 'MALE'
[04:45:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:45:42] ℹ️  Final extracted Payer Source: ''
[04:45:42] ✅ Patient data extraction completed successfully
[04:45:42] ✅    ✅ Patient data extracted successfully
[04:45:42] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:45:42] ✅    ✅ Patient identified: Webster Bowen
[04:45:42] ✅    ✅ Patient name validation passed
[04:45:42] 🔄 
🔄 Step 3: Processing patient dates...
[04:45:42] [DOC: 9249188] ℹ️  DOB normalized: 09/12/1949
[04:45:42] [DOC: 9249188] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[04:45:42] [DOC: 9249188] ✅ Patient date processing completed successfully
[04:45:42] ✅    ✅ Date processing completed
[04:45:42] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:45:42] 🔄 
🔄 Step 4: Extracting order data...
[04:45:44] ℹ️  Order extraction - MRN: '2261639'
[04:45:44] ℹ️  Order extraction - Sex: 'MALE'
[04:45:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:45:44] ℹ️  Order extraction - Payer Source: ''
[04:45:44] ✅ Order data extraction completed successfully
[04:45:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:45:44] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[04:45:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:45:44] ✅ Patient name cross-validation successful
[04:45:44] ✅    ✅ Data merged successfully
[04:45:46] ✅    ✅ Order data extracted and validated
[04:45:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:45:53] [DOC: 9249188] ℹ️  Patient not found in cache or API: Webster Bowen
[04:45:53] [DOC: 9249188] ℹ️  Patient not found, creating new patient via API...
[04:45:53] [DOC: 9249188] ℹ️  Creating patient via API: Webster Bowen
[04:45:54] [DOC: 9249188] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:45:54] ❌    ❌ Failed to create patient
[04:45:54] [DOC: 9249188] ℹ️  API push details saved for document 9249188
================================================================================
║                        Processing Document ID: 9249183                         ║
================================================================================
[04:45:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:45:54] ℹ️  Date: 04/18/2025
[04:45:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:46:01] [DOC: 9249183] ✅ Text extracted using pdfplumber (35626 chars)
[04:46:01] ✅    ✅ Text extracted using pdfplumber (35626 chars)
[04:46:01] 🔄 
🔄 Step 2: Extracting patient data...
[04:46:05] ℹ️  AI extracted raw sex value: 'F'
[04:46:05] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[04:46:05] ℹ️  AI extracted payer source: ''
[04:46:05] ℹ️  AI extracted diagnoses:
[04:46:05] ℹ️    - Diagnosis 1: 'C22.0'
[04:46:05] ℹ️    - Diagnosis 2: 'K74.69'
[04:46:05] ℹ️    - Diagnosis 3: 'N17.9'
[04:46:05] ℹ️    - Diagnosis 4: 'N18.9'
[04:46:05] ℹ️    - Diagnosis 5: 'D64.9'
[04:46:05] ℹ️    - Diagnosis 6: 'K21.9'
[04:46:05] ℹ️  Final extracted MRN: '2258674'
[04:46:05] ℹ️  Final extracted Sex: 'FEMALE'
[04:46:05] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[04:46:05] ℹ️  Final extracted Payer Source: ''
[04:46:05] ✅ Patient data extraction completed successfully
[04:46:05] ✅    ✅ Patient data extracted successfully
[04:46:05] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[04:46:05] ✅    ✅ Patient identified: Maryann Boucher
[04:46:05] ✅    ✅ Patient name validation passed
[04:46:05] 🔄 
🔄 Step 3: Processing patient dates...
[04:46:05] [DOC: 9249183] ℹ️  DOB normalized: 03/22/1946
[04:46:05] [DOC: 9249183] ℹ️  Episode startOfCare normalized: 04/16/2025
[04:46:05] [DOC: 9249183] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[04:46:05] [DOC: 9249183] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[04:46:05] [DOC: 9249183] ✅ Patient date processing completed successfully
[04:46:05] ✅    ✅ Date processing completed
[04:46:05] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[04:46:05] 🔄 
🔄 Step 4: Extracting order data...
[04:46:08] ℹ️  Order extraction - MRN: '2258674'
[04:46:08] ℹ️  Order extraction - Sex: 'FEMALE'
[04:46:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[04:46:08] ℹ️  Order extraction - Payer Source: ''
[04:46:08] ✅ Order data extraction completed successfully
[04:46:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:46:08] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[04:46:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, HHA'
[04:46:08] ✅ Patient name cross-validation successful
[04:46:08] ✅    ✅ Data merged successfully
[04:46:09] ✅    ✅ Order data extracted and validated
[04:46:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:46:15] [DOC: 9249183] ℹ️  Patient not found in cache or API: Maryann Boucher
[04:46:15] [DOC: 9249183] ℹ️  Patient not found, creating new patient via API...
[04:46:15] [DOC: 9249183] ℹ️  Creating patient via API: Maryann Boucher
[04:46:16] [DOC: 9249183] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:46:16] ❌    ❌ Failed to create patient
[04:46:16] [DOC: 9249183] ℹ️  API push details saved for document 9249183
================================================================================
║                        Processing Document ID: 9249182                         ║
================================================================================
[04:46:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:46:16] ℹ️  Date: 04/18/2025
[04:46:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:46:19] [DOC: 9249182] ✅ Text extracted using pdfplumber (9192 chars)
[04:46:19] ✅    ✅ Text extracted using pdfplumber (9192 chars)
[04:46:19] 🔄 
🔄 Step 2: Extracting patient data...
[04:46:22] ℹ️  AI extracted raw sex value: 'F'
[04:46:22] ℹ️  AI extracted service line: 'Hospice'
[04:46:22] ℹ️  AI extracted payer source: ''
[04:46:22] ℹ️  AI extracted diagnoses:
[04:46:22] ℹ️    - Diagnosis 1: 'C22.0'
[04:46:22] ℹ️    - Diagnosis 2: 'K74.69'
[04:46:22] ℹ️    - Diagnosis 3: 'N17.9'
[04:46:22] ℹ️    - Diagnosis 4: 'N18.9'
[04:46:22] ℹ️    - Diagnosis 5: 'D64.9'
[04:46:22] ℹ️    - Diagnosis 6: 'K21.9'
[04:46:22] ℹ️  Final extracted MRN: '2258674'
[04:46:22] ℹ️  Final extracted Sex: 'FEMALE'
[04:46:22] ℹ️  Final extracted Service Line: 'Hospice'
[04:46:22] ℹ️  Final extracted Payer Source: ''
[04:46:22] ✅ Patient data extraction completed successfully
[04:46:22] ✅    ✅ Patient data extracted successfully
[04:46:22] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[04:46:22] ✅    ✅ Patient identified: Maryann Boucher
[04:46:22] ✅    ✅ Patient name validation passed
[04:46:22] 🔄 
🔄 Step 3: Processing patient dates...
[04:46:22] [DOC: 9249182] ℹ️  DOB normalized: 03/22/1946
[04:46:22] [DOC: 9249182] ℹ️  Episode startOfCare normalized: 04/16/2025
[04:46:22] [DOC: 9249182] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[04:46:22] [DOC: 9249182] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[04:46:22] [DOC: 9249182] ✅ Patient date processing completed successfully
[04:46:22] ✅    ✅ Date processing completed
[04:46:22] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[04:46:22] 🔄 
🔄 Step 4: Extracting order data...
[04:46:25] ℹ️  Order extraction - MRN: '2258674'
[04:46:25] ℹ️  Order extraction - Sex: 'FEMALE'
[04:46:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:46:25] ℹ️  Order extraction - Payer Source: ''
[04:46:25] ✅ Order data extraction completed successfully
[04:46:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:46:25] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[04:46:25] ℹ️  Combined service lines: Patient='Hospice' + Order='Skilled Nursing' = 'Hospice, Skilled Nursing'
[04:46:25] ✅ Patient name cross-validation successful
[04:46:25] ✅    ✅ Data merged successfully
[04:46:26] ✅    ✅ Order data extracted and validated
[04:46:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:46:33] [DOC: 9249182] ℹ️  Patient not found in cache or API: Maryann Boucher
[04:46:33] [DOC: 9249182] ℹ️  Patient not found, creating new patient via API...
[04:46:33] [DOC: 9249182] ℹ️  Creating patient via API: Maryann Boucher
[04:46:35] [DOC: 9249182] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:46:35] ❌    ❌ Failed to create patient
[04:46:35] [DOC: 9249182] ℹ️  API push details saved for document 9249182
================================================================================
║                        Processing Document ID: 9249171                         ║
================================================================================
[04:46:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:46:35] ℹ️  Date: 04/18/2025
[04:46:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:46:39] [DOC: 9249171] ✅ Text extracted using pdfplumber (19121 chars)
[04:46:39] ✅    ✅ Text extracted using pdfplumber (19121 chars)
[04:46:39] 🔄 
🔄 Step 2: Extracting patient data...
[04:46:43] ℹ️  AI extracted raw sex value: 'Female'
[04:46:43] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[04:46:43] ℹ️  AI extracted payer source: ''
[04:46:43] ℹ️  AI extracted diagnoses:
[04:46:43] ℹ️    - Diagnosis 1: 'J18.9'
[04:46:43] ℹ️    - Diagnosis 2: 'N39.0'
[04:46:43] ℹ️    - Diagnosis 3: 'G70.00'
[04:46:43] ℹ️    - Diagnosis 4: 'I10'
[04:46:43] ℹ️    - Diagnosis 5: 'E11.65'
[04:46:43] ℹ️    - Diagnosis 6: 'K31.84'
[04:46:43] ℹ️  Final extracted MRN: '2188842'
[04:46:43] ℹ️  Final extracted Sex: 'FEMALE'
[04:46:43] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[04:46:43] ℹ️  Final extracted Payer Source: ''
[04:46:43] ✅ Patient data extraction completed successfully
[04:46:43] ✅    ✅ Patient data extracted successfully
[04:46:43] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'G70.00', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'K31.84'}]
[04:46:43] ✅    ✅ Patient identified: Nancy Anderson
[04:46:43] ✅    ✅ Patient name validation passed
[04:46:43] 🔄 
🔄 Step 3: Processing patient dates...
[04:46:43] [DOC: 9249171] ℹ️  DOB normalized: 07/12/1954
[04:46:43] [DOC: 9249171] ℹ️  Episode startOfCare normalized: 04/05/2025
[04:46:43] [DOC: 9249171] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[04:46:43] [DOC: 9249171] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[04:46:43] [DOC: 9249171] ✅ Patient date processing completed successfully
[04:46:43] ✅    ✅ Date processing completed
[04:46:43] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'G70.00', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'K31.84'}]
[04:46:43] 🔄 
🔄 Step 4: Extracting order data...
[04:46:46] ℹ️  Order extraction - MRN: '2188842'
[04:46:46] ℹ️  Order extraction - Sex: 'FEMALE'
[04:46:46] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[04:46:46] ℹ️  Order extraction - Payer Source: ''
[04:46:46] ✅ Order data extraction completed successfully
[04:46:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:46:46] ℹ️  Using MRN from patient data: '2188842' over '2188842'
[04:46:46] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing'
[04:46:46] ✅ Patient name cross-validation successful
[04:46:46] ✅    ✅ Data merged successfully
[04:46:47] ✅    ✅ Order data extracted and validated
[04:46:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:47:17] [DOC: 9249171] ℹ️  Patient not found in cache or API: Nancy Anderson
[04:47:17] [DOC: 9249171] ℹ️  Patient not found, creating new patient via API...
[04:47:17] [DOC: 9249171] ℹ️  Creating patient via API: Nancy Anderson
[04:47:18] [DOC: 9249171] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:47:18] ❌    ❌ Failed to create patient
[04:47:18] [DOC: 9249171] ℹ️  API push details saved for document 9249171
================================================================================
║                        Processing Document ID: 9249049                         ║
================================================================================
[04:47:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:47:18] ℹ️  Date: 04/18/2025
[04:47:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:47:22] [DOC: 9249049] ✅ Text extracted using pdfplumber (14630 chars)
[04:47:22] ✅    ✅ Text extracted using pdfplumber (14630 chars)
[04:47:22] 🔄 
🔄 Step 2: Extracting patient data...
[04:47:25] ℹ️  AI extracted raw sex value: 'F'
[04:47:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:47:25] ℹ️  AI extracted payer source: 'Medicare'
[04:47:25] ℹ️  AI extracted diagnoses:
[04:47:25] ℹ️    - Diagnosis 1: 'M47.26'
[04:47:25] ℹ️    - Diagnosis 2: 'M47.812'
[04:47:25] ℹ️    - Diagnosis 3: 'M75.101'
[04:47:25] ℹ️    - Diagnosis 4: 'M70.62'
[04:47:25] ℹ️    - Diagnosis 5: 'E11.42'
[04:47:25] ℹ️    - Diagnosis 6: 'H81.12'
[04:47:25] ℹ️  Final extracted MRN: 'MA240617055801'
[04:47:25] ℹ️  Final extracted Sex: 'FEMALE'
[04:47:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:47:25] ℹ️  Final extracted Payer Source: 'Medicare'
[04:47:25] ✅ Patient data extraction completed successfully
[04:47:25] ✅    ✅ Patient data extracted successfully
[04:47:25] 📊 Patient Response
     └─ patientFName: Leticia
     └─ patientLName: Alves
     └─ dob: 05/25/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240617055801
     └─ billingProvider: DIAS-REGUS, MARY NP
     └─ npi: 1326015496
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 320 Court St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 636-9133
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'M47.26', 'secondDiagnosis': 'M47.812', 'thirdDiagnosis': 'M75.101', 'fourthDiagnosis': 'M70.62', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'H81.12'}]
[04:47:25] ✅    ✅ Patient identified: Leticia Alves
[04:47:25] ✅    ✅ Patient name validation passed
[04:47:25] 🔄 
🔄 Step 3: Processing patient dates...
[04:47:25] [DOC: 9249049] ℹ️  DOB normalized: 05/25/1958
[04:47:25] [DOC: 9249049] ℹ️  Episode startOfCare normalized: 04/03/2025
[04:47:25] [DOC: 9249049] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[04:47:25] [DOC: 9249049] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[04:47:25] [DOC: 9249049] ✅ Patient date processing completed successfully
[04:47:25] ✅    ✅ Date processing completed
[04:47:25] 📊 Processed Patient Data
     └─ patientFName: Leticia
     └─ patientLName: Alves
     └─ dob: 05/25/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240617055801
     └─ billingProvider: DIAS-REGUS, MARY NP
     └─ npi: 1326015496
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 320 Court St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 636-9133
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'M47.26', 'secondDiagnosis': 'M47.812', 'thirdDiagnosis': 'M75.101', 'fourthDiagnosis': 'M70.62', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'H81.12'}]
[04:47:25] 🔄 
🔄 Step 4: Extracting order data...
[04:47:28] ℹ️  Order extraction - MRN: 'MA240617055801'
[04:47:28] ℹ️  Order extraction - Sex: 'FEMALE'
[04:47:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:47:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:47:28] ✅ Order data extraction completed successfully
[04:47:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:47:28] ℹ️  Using MRN from patient data: 'MA240617055801' over 'MA240617055801'
[04:47:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:47:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:47:28] ✅ Patient name cross-validation successful
[04:47:28] ✅    ✅ Data merged successfully
[04:47:29] ✅    ✅ Order data extracted and validated
[04:47:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:47:53] [DOC: 9249049] ✅ Patient exists in API: Leticia Alves, ID: 9d1435a0-398f-4377-8037-07d8a159253d
[04:47:53] ✅    ✅ Existing patient found with ID: 9d1435a0-398f-4377-8037-07d8a159253d
[04:47:53] 🔄 
🔄 Step 6: Pushing order to API...
[04:47:53] [DOC: 9249049] ℹ️  Pushing order via API for patient ID: 9d1435a0-398f-4377-8037-07d8a159253d
[04:47:54] [DOC: 9249049] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12870"}
[04:47:54] ❌    ❌ Failed to push order
[04:47:54] 🔄 
🔄 Step 7: Writing to CSV...
[04:47:54] [DOC: 9249049] ℹ️  Calculated age: 67 from DOB: 05/25/1958
[04:47:54] [DOC: 9249049] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:47:54] [DOC: 9249049] ℹ️  Payer Source extracted: 'Medicare'
[04:47:54] [DOC: 9249049] ℹ️  Diagnosis codes being written:
[04:47:54] [DOC: 9249049] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.26'
[04:47:54] [DOC: 9249049] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.812'
[04:47:54] [DOC: 9249049] ℹ️    - Latest_Episode_Thirddiagnosis: 'M75.101'
[04:47:54] [DOC: 9249049] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M70.62'
[04:47:54] [DOC: 9249049] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.42'
[04:47:54] [DOC: 9249049] ℹ️    - Latest_Episode_Sixthdiagnosis: 'H81.12'
[04:47:54] [DOC: 9249049] ✅ Patient data written to CSV: Leticia Alves | Sex: FEMALE | Age: 67 | Service: Skilled Nursing | Payer: Medicare | MRN: MA240617055801
[04:47:54] ✅    ✅ Document 9249049 processed and saved successfully
[04:47:54] 🔄 
🔄 Step 8: Saving API details...
[04:47:54] [DOC: 9249049] ℹ️  API push details saved for document 9249049
[04:47:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249021                         ║
================================================================================
[04:47:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:47:54] ℹ️  Date: 04/18/2025
[04:47:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:47:58] [DOC: 9249021] ✅ Text extracted using pdfplumber (22087 chars)
[04:47:58] ✅    ✅ Text extracted using pdfplumber (22075 chars)
[04:47:58] 🔄 
🔄 Step 2: Extracting patient data...
[04:48:02] ℹ️  AI extracted raw sex value: 'F'
[04:48:02] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[04:48:02] ℹ️  AI extracted payer source: 'Medicare'
[04:48:02] ℹ️  AI extracted diagnoses:
[04:48:02] ℹ️    - Diagnosis 1: 'S42.201'
[04:48:02] ℹ️    - Diagnosis 2: 'M19.011'
[04:48:02] ℹ️    - Diagnosis 3: 'I10'
[04:48:02] ℹ️    - Diagnosis 4: 'G62.9'
[04:48:02] ℹ️    - Diagnosis 5: 'E03.9'
[04:48:02] ℹ️    - Diagnosis 6: 'E78.5'
[04:48:02] ℹ️  Final extracted MRN: 'MA250311063603'
[04:48:02] ℹ️  Final extracted Sex: 'FEMALE'
[04:48:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[04:48:02] ℹ️  Final extracted Payer Source: 'Medicare'
[04:48:02] ✅ Patient data extraction completed successfully
[04:48:02] ✅    ✅ Patient data extracted successfully
[04:48:02] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Afonso-Fede, Gloriane
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 789-4352
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'S42.201', 'secondDiagnosis': 'M19.011', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'G62.9', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'E78.5'}]
[04:48:02] ✅    ✅ Patient identified: Maria Demelo
[04:48:02] ✅    ✅ Patient name validation passed
[04:48:02] 🔄 
🔄 Step 3: Processing patient dates...
[04:48:02] [DOC: 9249021] ℹ️  DOB normalized: 06/13/1936
[04:48:02] [DOC: 9249021] ℹ️  Episode startOfCare normalized: 03/13/2025
[04:48:02] [DOC: 9249021] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[04:48:02] [DOC: 9249021] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[04:48:02] [DOC: 9249021] ✅ Patient date processing completed successfully
[04:48:02] ✅    ✅ Date processing completed
[04:48:02] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Afonso-Fede, Gloriane
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 789-4352
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'S42.201', 'secondDiagnosis': 'M19.011', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'G62.9', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'E78.5'}]
[04:48:02] 🔄 
🔄 Step 4: Extracting order data...
[04:48:05] ℹ️  Order extraction - MRN: 'MA250311063603'
[04:48:05] ℹ️  Order extraction - Sex: 'FEMALE'
[04:48:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[04:48:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:48:05] ✅ Order data extraction completed successfully
[04:48:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:48:05] ℹ️  Using MRN from patient data: 'MA250311063603' over 'MA250311063603'
[04:48:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[04:48:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:48:05] ✅ Patient name cross-validation successful
[04:48:05] ✅    ✅ Data merged successfully
[04:48:06] ✅    ✅ Order data extracted and validated
[04:48:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:48:13] [DOC: 9249021] ℹ️  Patient not found in cache or API: Maria Demelo
[04:48:13] [DOC: 9249021] ℹ️  Patient not found, creating new patient via API...
[04:48:13] [DOC: 9249021] ℹ️  Creating patient via API: Maria Demelo
[04:48:14] [DOC: 9249021] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:48:14] ❌    ❌ Failed to create patient
[04:48:14] [DOC: 9249021] ℹ️  API push details saved for document 9249021
================================================================================
║                        Processing Document ID: 9249019                         ║
================================================================================
[04:48:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:48:14] ℹ️  Date: 04/18/2025
[04:48:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:48:18] [DOC: 9249019] ✅ Text extracted using pdfplumber (13634 chars)
[04:48:18] ✅    ✅ Text extracted using pdfplumber (13634 chars)
[04:48:18] 🔄 
🔄 Step 2: Extracting patient data...
[04:48:22] ℹ️  AI extracted raw sex value: 'F'
[04:48:22] ℹ️  AI extracted service line: 'OT'
[04:48:22] ℹ️  AI extracted payer source: 'None'
[04:48:22] ℹ️  AI extracted diagnoses:
[04:48:22] ℹ️    - Diagnosis 1: 'Exacerbation'
[04:48:22] ℹ️    - Diagnosis 2: 'muscle weakness'
[04:48:22] ℹ️    - Diagnosis 3: 'None'
[04:48:22] ℹ️    - Diagnosis 4: 'None'
[04:48:22] ℹ️    - Diagnosis 5: 'None'
[04:48:22] ℹ️    - Diagnosis 6: 'None'
[04:48:22] ℹ️  Final extracted MRN: 'MA250311063603'
[04:48:22] ℹ️  Final extracted Sex: 'FEMALE'
[04:48:22] ℹ️  Final extracted Service Line: 'OT'
[04:48:22] ℹ️  Final extracted Payer Source: ''
[04:48:22] ✅ Patient data extraction completed successfully
[04:48:22] ✅    ✅ Patient data extracted successfully
[04:48:22] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/18/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Exacerbation', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:48:22] ✅    ✅ Patient identified: Maria Demelo
[04:48:22] ✅    ✅ Patient name validation passed
[04:48:22] 🔄 
🔄 Step 3: Processing patient dates...
[04:48:22] [DOC: 9249019] ℹ️  DOB normalized: 06/13/1936
[04:48:22] [DOC: 9249019] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[04:48:22] [DOC: 9249019] ✅ Patient date processing completed successfully
[04:48:22] ✅    ✅ Date processing completed
[04:48:22] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'firstDiagnosis': 'Exacerbation', 'secondDiagnosis': 'muscle weakness'}]
[04:48:22] 🔄 
🔄 Step 4: Extracting order data...
[04:48:24] ℹ️  Order extraction - MRN: 'MA250311063603'
[04:48:24] ℹ️  Order extraction - Sex: 'FEMALE'
[04:48:24] ℹ️  Order extraction - Service Line: 'OT'
[04:48:24] ℹ️  Order extraction - Payer Source: ''
[04:48:24] ✅ Order data extraction completed successfully
[04:48:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:48:24] ℹ️  Using MRN from patient data: 'MA250311063603' over 'MA250311063603'
[04:48:24] ℹ️  Service line consistent in both sources: 'OT'
[04:48:24] ✅ Patient name cross-validation successful
[04:48:24] ✅    ✅ Data merged successfully
[04:48:26] ✅    ✅ Order data extracted and validated
[04:48:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:48:53] [DOC: 9249019] ℹ️  Patient not found in cache or API: Maria Demelo
[04:48:53] [DOC: 9249019] ℹ️  Patient not found, creating new patient via API...
[04:48:53] [DOC: 9249019] ℹ️  Creating patient via API: Maria Demelo
[04:48:54] [DOC: 9249019] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:48:54] ❌    ❌ Failed to create patient
[04:48:54] [DOC: 9249019] ℹ️  API push details saved for document 9249019
================================================================================
║                        Processing Document ID: 9249004                         ║
================================================================================
[04:48:54] ℹ️  Agency: Compassionate Care Hospice-Taunton
[04:48:54] ℹ️  Date: 04/18/2025
[04:48:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:48:58] [DOC: 9249004] ✅ Text extracted using pdfplumber (1515 chars)
[04:48:58] ✅    ✅ Text extracted using pdfplumber (1503 chars)
[04:48:58] 🔄 
🔄 Step 2: Extracting patient data...
[04:49:01] ℹ️  AI extracted raw sex value: ''
[04:49:01] ℹ️  AI extracted service line: 'Hospice'
[04:49:01] ℹ️  AI extracted payer source: 'Medicare'
[04:49:01] ℹ️  AI extracted diagnoses:
[04:49:01] ℹ️    - Diagnosis 1: ''
[04:49:01] ℹ️    - Diagnosis 2: ''
[04:49:01] ℹ️    - Diagnosis 3: ''
[04:49:01] ℹ️    - Diagnosis 4: ''
[04:49:01] ℹ️    - Diagnosis 5: ''
[04:49:01] ℹ️    - Diagnosis 6: ''
[04:49:01] ℹ️  Final extracted MRN: 'B3700296223202'
[04:49:01] ℹ️  Final extracted Sex: ''
[04:49:01] ℹ️  Final extracted Service Line: 'Hospice'
[04:49:01] ℹ️  Final extracted Payer Source: 'Medicare'
[04:49:01] ✅ Patient data extraction completed successfully
[04:49:01] ✅    ✅ Patient data extracted successfully
[04:49:01] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:49:01] ✅    ✅ Patient identified: MARIA JARDIM
[04:49:01] ✅    ✅ Patient name validation passed
[04:49:01] 🔄 
🔄 Step 3: Processing patient dates...
[04:49:01] [DOC: 9249004] ℹ️  DOB normalized: 05/20/1931
[04:49:01] [DOC: 9249004] ✅ Patient date processing completed successfully
[04:49:01] ✅    ✅ Date processing completed
[04:49:01] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:49:01] 🔄 
🔄 Step 4: Extracting order data...
[04:49:03] ℹ️  Order extraction - MRN: 'B3700296223202'
[04:49:03] ℹ️  Order extraction - Sex: ''
[04:49:03] ℹ️  Order extraction - Service Line: 'Hospice'
[04:49:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:49:03] ✅ Order data extraction completed successfully
[04:49:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:49:03] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[04:49:03] ℹ️  Inferred sex as FEMALE from name: MARIA
[04:49:03] ℹ️  Service line consistent in both sources: 'Hospice'
[04:49:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:49:03] ✅ Patient name cross-validation successful
[04:49:03] ✅    ✅ Data merged successfully
[04:49:04] ✅    ✅ Order data extracted and validated
[04:49:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:49:04] [DOC: 9249004] ✅ Patient found in local cache: MARIA JARDIM, ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[04:49:04] ✅    ✅ Existing patient found with ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[04:49:04] 🔄 
🔄 Step 6: Pushing order to API...
[04:49:04] [DOC: 9249004] ℹ️  Pushing order via API for patient ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[04:49:06] [DOC: 9249004] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13847"}
[04:49:06] ❌    ❌ Failed to push order
[04:49:06] 🔄 
🔄 Step 7: Writing to CSV...
[04:49:06] [DOC: 9249004] ℹ️  Calculated age: 94 from DOB: 05/20/1931
[04:49:06] [DOC: 9249004] ℹ️  Service Line extracted: 'Hospice'
[04:49:06] [DOC: 9249004] ℹ️  Payer Source extracted: 'Medicare'
[04:49:06] [DOC: 9249004] ℹ️  Diagnosis codes being written:
[04:49:06] [DOC: 9249004] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:49:06] [DOC: 9249004] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:49:06] [DOC: 9249004] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:49:06] [DOC: 9249004] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:49:06] [DOC: 9249004] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:49:06] [DOC: 9249004] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:49:06] [DOC: 9249004] ✅ Patient data written to CSV: MARIA JARDIM | Sex: FEMALE | Age: 94 | Service: Hospice | Payer: Medicare | MRN: B3700296223202
[04:49:06] ✅    ✅ Document 9249004 processed and saved successfully
[04:49:06] 🔄 
🔄 Step 8: Saving API details...
[04:49:06] [DOC: 9249004] ℹ️  API push details saved for document 9249004
[04:49:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9248571                         ║
================================================================================
[04:49:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:49:06] ℹ️  Date: 04/18/2025
[04:49:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:49:10] [DOC: 9248571] ✅ Text extracted using pdfplumber (13060 chars)
[04:49:10] ✅    ✅ Text extracted using pdfplumber (13060 chars)
[04:49:10] 🔄 
🔄 Step 2: Extracting patient data...
[04:49:13] ℹ️  AI extracted raw sex value: 'F'
[04:49:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:49:13] ℹ️  AI extracted payer source: 'Medicare'
[04:49:13] ℹ️  AI extracted diagnoses:
[04:49:13] ℹ️    - Diagnosis 1: 'I10'
[04:49:13] ℹ️    - Diagnosis 2: 'K21.9'
[04:49:13] ℹ️    - Diagnosis 3: 'G30.9'
[04:49:13] ℹ️    - Diagnosis 4: 'E78.5'
[04:49:13] ℹ️    - Diagnosis 5: 'F32.A'
[04:49:13] ℹ️    - Diagnosis 6: 'E11.65'
[04:49:13] ℹ️  Final extracted MRN: 'MA201027114506'
[04:49:13] ℹ️  Final extracted Sex: 'FEMALE'
[04:49:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:49:13] ℹ️  Final extracted Payer Source: 'Medicare'
[04:49:13] ✅ Patient data extraction completed successfully
[04:49:13] ✅    ✅ Patient data extracted successfully
[04:49:13] 📊 Patient Response
     └─ patientFName: Isabel
     └─ patientLName: Azevedo
     └─ dob: 11/19/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA201027114506
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 1881923936
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 90 Fern St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 825-4022
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/09/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'K21.9', 'thirdDiagnosis': 'G30.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'E11.65'}]
[04:49:13] ✅    ✅ Patient identified: Isabel Azevedo
[04:49:13] ✅    ✅ Patient name validation passed
[04:49:13] 🔄 
🔄 Step 3: Processing patient dates...
[04:49:13] [DOC: 9248571] ℹ️  DOB normalized: 11/19/1945
[04:49:13] [DOC: 9248571] ℹ️  Episode startOfCare normalized: 02/09/2025
[04:49:13] [DOC: 9248571] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[04:49:13] [DOC: 9248571] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[04:49:13] [DOC: 9248571] ✅ Patient date processing completed successfully
[04:49:13] ✅    ✅ Date processing completed
[04:49:13] 📊 Processed Patient Data
     └─ patientFName: Isabel
     └─ patientLName: Azevedo
     └─ dob: 11/19/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA201027114506
     └─ billingProvider: Dr. Coury, Pamela
     └─ npi: 1881923936
     └─ physicianNPI: 1598703944
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 90 Fern St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 825-4022
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/09/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'K21.9', 'thirdDiagnosis': 'G30.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'E11.65'}]
[04:49:13] 🔄 
🔄 Step 4: Extracting order data...
[04:49:16] ℹ️  Order extraction - MRN: 'MA201027114506'
[04:49:16] ℹ️  Order extraction - Sex: 'FEMALE'
[04:49:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:49:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:49:16] ✅ Order data extraction completed successfully
[04:49:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:49:16] ℹ️  Using MRN from patient data: 'MA201027114506' over 'MA201027114506'
[04:49:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:49:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:49:16] ✅ Patient name cross-validation successful
[04:49:16] ✅    ✅ Data merged successfully
[04:49:17] ✅    ✅ Order data extracted and validated
[04:49:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:49:51] [DOC: 9248571] ✅ Patient exists in API: Isabel Azevedo, ID: 2d473227-bbda-4e2d-9a7a-a85ebf4e2da7
[04:49:51] ✅    ✅ Existing patient found with ID: 2d473227-bbda-4e2d-9a7a-a85ebf4e2da7
[04:49:51] 🔄 
🔄 Step 6: Pushing order to API...
[04:49:51] [DOC: 9248571] ℹ️  Pushing order via API for patient ID: 2d473227-bbda-4e2d-9a7a-a85ebf4e2da7
[04:49:53] [DOC: 9248571] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12973"}
[04:49:53] ❌    ❌ Failed to push order
[04:49:53] 🔄 
🔄 Step 7: Writing to CSV...
[04:49:53] [DOC: 9248571] ℹ️  Calculated age: 79 from DOB: 11/19/1945
[04:49:53] [DOC: 9248571] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:49:53] [DOC: 9248571] ℹ️  Payer Source extracted: 'Medicare'
[04:49:53] [DOC: 9248571] ℹ️  Diagnosis codes being written:
[04:49:53] [DOC: 9248571] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[04:49:53] [DOC: 9248571] ℹ️    - Latest_Episode_Seconddiagnosis: 'K21.9'
[04:49:53] [DOC: 9248571] ℹ️    - Latest_Episode_Thirddiagnosis: 'G30.9'
[04:49:53] [DOC: 9248571] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[04:49:53] [DOC: 9248571] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.A'
[04:49:53] [DOC: 9248571] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.65'
[04:49:53] [DOC: 9248571] ✅ Patient data written to CSV: Isabel Azevedo | Sex: FEMALE | Age: 79 | Service: Skilled Nursing | Payer: Medicare | MRN: MA201027114506
[04:49:53] ✅    ✅ Document 9248571 processed and saved successfully
[04:49:53] 🔄 
🔄 Step 8: Saving API details...
[04:49:53] [DOC: 9248571] ℹ️  API push details saved for document 9248571
[04:49:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9248431                         ║
================================================================================
[04:49:53] ℹ️  Agency: Alphacare Home Health Agency
[04:49:53] ℹ️  Date: 04/18/2025
[04:49:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:49:59] [DOC: 9248431] ✅ Text extracted using pdfplumber (1567 chars)
[04:49:59] ✅    ✅ Text extracted using pdfplumber (1567 chars)
[04:49:59] 🔄 
🔄 Step 2: Extracting patient data...
[04:50:01] ℹ️  AI extracted raw sex value: ''
[04:50:01] ℹ️  AI extracted service line: 'RN, HHA'
[04:50:01] ℹ️  AI extracted payer source: ''
[04:50:01] ℹ️  AI extracted diagnoses:
[04:50:01] ℹ️    - Diagnosis 1: 'None'
[04:50:01] ℹ️    - Diagnosis 2: 'None'
[04:50:01] ℹ️    - Diagnosis 3: 'None'
[04:50:01] ℹ️    - Diagnosis 4: 'None'
[04:50:01] ℹ️    - Diagnosis 5: 'None'
[04:50:01] ℹ️    - Diagnosis 6: 'None'
[04:50:01] ℹ️  Final extracted MRN: '000000085'
[04:50:01] ℹ️  Final extracted Sex: ''
[04:50:01] ℹ️  Final extracted Service Line: 'RN, HHA'
[04:50:01] ℹ️  Final extracted Payer Source: ''
[04:50:01] ✅ Patient data extraction completed successfully
[04:50:01] ✅    ✅ Patient data extracted successfully
[04:50:01] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:50:01] ✅    ✅ Patient identified: James Lowman
[04:50:01] ✅    ✅ Patient name validation passed
[04:50:01] 🔄 
🔄 Step 3: Processing patient dates...
[04:50:01] [DOC: 9248431] ℹ️  DOB normalized: 04/05/1968
[04:50:01] [DOC: 9248431] ✅ Patient date processing completed successfully
[04:50:01] ✅    ✅ Date processing completed
[04:50:01] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:50:01] 🔄 
🔄 Step 4: Extracting order data...
[04:50:03] ℹ️  Order extraction - MRN: '000000085'
[04:50:03] ℹ️  Order extraction - Sex: ''
[04:50:03] ℹ️  Order extraction - Service Line: 'HHA'
[04:50:03] ℹ️  Order extraction - Payer Source: ''
[04:50:03] ✅ Order data extraction completed successfully
[04:50:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:50:03] ℹ️  Using MRN from patient data: '000000085' over '000000085'
[04:50:03] ℹ️  Inferred sex as MALE from name: James
[04:50:03] ℹ️  Combined service lines: Patient='RN, HHA' + Order='HHA' = 'HHA, RN'
[04:50:03] ✅ Patient name cross-validation successful
[04:50:03] ✅    ✅ Data merged successfully
[04:50:05] ⚠️     ❌ Skipping - missing episode start date
[04:50:05] [DOC: 9248431] ℹ️  API push details saved for document 9248431
================================================================================
║                        Processing Document ID: 9248419                         ║
================================================================================
[04:50:05] ℹ️  Agency: Dartmouth HH
[04:50:05] ℹ️  Date: 04/18/2025
[04:50:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:50:08] [DOC: 9248419] ✅ Text extracted using pdfplumber (6958 chars)
[04:50:08] ✅    ✅ Text extracted using pdfplumber (6958 chars)
[04:50:08] 🔄 
🔄 Step 2: Extracting patient data...
[04:50:11] ℹ️  AI extracted raw sex value: 'F'
[04:50:11] ℹ️  AI extracted service line: 'OT'
[04:50:11] ℹ️  AI extracted payer source: 'Medicare'
[04:50:11] ℹ️  AI extracted diagnoses:
[04:50:11] ℹ️    - Diagnosis 1: 'Aspiration'
[04:50:11] ℹ️    - Diagnosis 2: 'Dysphagia'
[04:50:11] ℹ️    - Diagnosis 3: 'CVA'
[04:50:11] ℹ️    - Diagnosis 4: 'None'
[04:50:11] ℹ️    - Diagnosis 5: 'None'
[04:50:11] ℹ️    - Diagnosis 6: 'None'
[04:50:11] ℹ️  Final extracted MRN: '2502011'
[04:50:11] ℹ️  Final extracted Sex: 'FEMALE'
[04:50:11] ℹ️  Final extracted Service Line: 'OT'
[04:50:11] ℹ️  Final extracted Payer Source: 'Medicare'
[04:50:11] ✅ Patient data extraction completed successfully
[04:50:11] ✅    ✅ Patient data extracted successfully
[04:50:11] 📊 Patient Response
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'Aspiration', 'secondDiagnosis': 'Dysphagia', 'thirdDiagnosis': 'CVA', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:50:11] ✅    ✅ Patient identified: Veronica Cusson
[04:50:11] ✅    ✅ Patient name validation passed
[04:50:11] 🔄 
🔄 Step 3: Processing patient dates...
[04:50:11] [DOC: 9248419] ℹ️  DOB normalized: 08/26/1964
[04:50:11] [DOC: 9248419] ℹ️  Episode startOfCare normalized: 04/02/2025
[04:50:11] [DOC: 9248419] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[04:50:11] [DOC: 9248419] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[04:50:11] [DOC: 9248419] ✅ Patient date processing completed successfully
[04:50:11] ✅    ✅ Date processing completed
[04:50:11] 📊 Processed Patient Data
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'Aspiration', 'secondDiagnosis': 'Dysphagia', 'thirdDiagnosis': 'CVA'}]
[04:50:11] 🔄 
🔄 Step 4: Extracting order data...
[04:50:13] ℹ️  Order extraction - MRN: ''
[04:50:13] ℹ️  Order extraction - Sex: 'FEMALE'
[04:50:13] ℹ️  Order extraction - Service Line: 'OT'
[04:50:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:50:13] ✅ Order data extraction completed successfully
[04:50:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:50:13] ℹ️  Using MRN from patient data: '2502011'
[04:50:13] ℹ️  Service line consistent in both sources: 'OT'
[04:50:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:50:13] ✅ Patient name cross-validation successful
[04:50:13] ✅    ✅ Data merged successfully
[04:50:15] ✅    ✅ Order data extracted and validated
[04:50:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:50:22] [DOC: 9248419] ℹ️  Patient not found in cache or API: Veronica Cusson
[04:50:22] [DOC: 9248419] ℹ️  Patient not found, creating new patient via API...
[04:50:22] [DOC: 9248419] ℹ️  Creating patient via API: Veronica Cusson
[04:50:23] [DOC: 9248419] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:50:23] ❌    ❌ Failed to create patient
[04:50:23] [DOC: 9248419] ℹ️  API push details saved for document 9248419
================================================================================
║                        Processing Document ID: 9248103                         ║
================================================================================
[04:50:23] ℹ️  Agency: Dartmouth HH
[04:50:23] ℹ️  Date: 04/18/2025
[04:50:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:50:25] [DOC: 9248103] ✅ Text extracted using pdfplumber (1276 chars)
[04:50:25] ✅    ✅ Text extracted using pdfplumber (1276 chars)
[04:50:25] 🔄 
🔄 Step 2: Extracting patient data...
[04:50:27] ℹ️  AI extracted raw sex value: 'M'
[04:50:27] ℹ️  AI extracted service line: 'Speech Therapy, Home Health Aide'
[04:50:27] ℹ️  AI extracted payer source: 'Medicare'
[04:50:27] ℹ️  AI extracted diagnoses:
[04:50:27] ℹ️    - Diagnosis 1: 'None'
[04:50:27] ℹ️    - Diagnosis 2: 'None'
[04:50:27] ℹ️    - Diagnosis 3: 'None'
[04:50:27] ℹ️    - Diagnosis 4: 'None'
[04:50:27] ℹ️    - Diagnosis 5: 'None'
[04:50:27] ℹ️    - Diagnosis 6: 'None'
[04:50:27] ℹ️  Final extracted MRN: '2194001'
[04:50:27] ℹ️  Final extracted Sex: 'MALE'
[04:50:27] ℹ️  Final extracted Service Line: 'Speech Therapy, Home Health Aide'
[04:50:27] ℹ️  Final extracted Payer Source: 'Medicare'
[04:50:27] ✅ Patient data extraction completed successfully
[04:50:27] ✅    ✅ Patient data extracted successfully
[04:50:27] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Desnoyers
     └─ dob: 06/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2194001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy, Home Health Aide
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': None, 'endOfEpisode': '05/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:50:27] ✅    ✅ Patient identified: Dennis Desnoyers
[04:50:27] ✅    ✅ Patient name validation passed
[04:50:27] 🔄 
🔄 Step 3: Processing patient dates...
[04:50:27] [DOC: 9248103] ℹ️  DOB normalized: 06/09/1950
[04:50:27] [DOC: 9248103] ℹ️  Episode startOfCare normalized: 03/06/2025
[04:50:27] [DOC: 9248103] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[04:50:27] [DOC: 9248103] ✅ Patient date processing completed successfully
[04:50:27] ✅    ✅ Date processing completed
[04:50:27] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Desnoyers
     └─ dob: 06/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2194001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy, Home Health Aide
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'endOfEpisode': '05/04/2025'}]
[04:50:27] 🔄 
🔄 Step 4: Extracting order data...
[04:50:30] ℹ️  Order extraction - MRN: '2194001'
[04:50:30] ℹ️  Order extraction - Sex: 'MALE'
[04:50:30] ℹ️  Order extraction - Service Line: 'ST, HCA'
[04:50:30] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:50:30] ✅ Order data extraction completed successfully
[04:50:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:50:30] ℹ️  Using MRN from patient data: '2194001' over '2194001'
[04:50:30] ℹ️  Combined service lines: Patient='Speech Therapy, Home Health Aide' + Order='ST, HCA' = 'HCA, Home Health Aide, ST, Speech Therapy'
[04:50:30] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:50:30] ✅ Patient name cross-validation successful
[04:50:30] ✅    ✅ Data merged successfully
[04:50:31] ✅    ✅ Order data extracted and validated
[04:50:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:50:31] [DOC: 9248103] ✅ Patient found in local cache: Dennis Desnoyers, ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[04:50:31] ✅    ✅ Existing patient found with ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[04:50:31] 🔄 
🔄 Step 6: Pushing order to API...
[04:50:31] [DOC: 9248103] ℹ️  Pushing order via API for patient ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[04:50:33] [DOC: 9248103] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:50:33] ❌    ❌ Failed to push order
[04:50:33] 🔄 
🔄 Step 7: Writing to CSV...
[04:50:33] [DOC: 9248103] ℹ️  Calculated age: 74 from DOB: 06/09/1950
[04:50:33] [DOC: 9248103] ℹ️  Service Line extracted: 'HCA, Home Health Aide, ST, Speech Therapy'
[04:50:33] [DOC: 9248103] ℹ️  Payer Source extracted: 'Medicare'
[04:50:33] [DOC: 9248103] ℹ️  Diagnosis codes being written:
[04:50:33] [DOC: 9248103] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:50:33] [DOC: 9248103] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:50:33] [DOC: 9248103] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:50:33] [DOC: 9248103] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:50:33] [DOC: 9248103] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:50:33] [DOC: 9248103] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:50:33] [DOC: 9248103] ✅ Patient data written to CSV: Dennis Desnoyers | Sex: MALE | Age: 74 | Service: HCA, Home Health Aide, ST, Speech Therapy | Payer: Medicare | MRN: 2194001
[04:50:33] ✅    ✅ Document 9248103 processed and saved successfully
[04:50:33] 🔄 
🔄 Step 8: Saving API details...
[04:50:33] [DOC: 9248103] ℹ️  API push details saved for document 9248103
[04:50:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9248096                         ║
================================================================================
[04:50:33] ℹ️  Agency: Dartmouth HH
[04:50:33] ℹ️  Date: 04/18/2025
[04:50:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:50:40] [DOC: 9248096] ✅ Text extracted using pdfplumber (11318 chars)
[04:50:40] ✅    ✅ Text extracted using pdfplumber (11318 chars)
[04:50:40] 🔄 
🔄 Step 2: Extracting patient data...
[04:50:44] ℹ️  AI extracted raw sex value: 'F'
[04:50:44] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[04:50:44] ℹ️  AI extracted payer source: ''
[04:50:44] ℹ️  AI extracted diagnoses:
[04:50:44] ℹ️    - Diagnosis 1: 'F41.9'
[04:50:44] ℹ️    - Diagnosis 2: 'G31.84'
[04:50:44] ℹ️    - Diagnosis 3: 'Z91.148'
[04:50:44] ℹ️    - Diagnosis 4: 'D64.9'
[04:50:44] ℹ️    - Diagnosis 5: 'I25.10'
[04:50:44] ℹ️    - Diagnosis 6: 'K58.9'
[04:50:44] ℹ️  Final extracted MRN: '5118009'
[04:50:44] ℹ️  Final extracted Sex: 'FEMALE'
[04:50:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[04:50:44] ℹ️  Final extracted Payer Source: ''
[04:50:44] ✅ Patient data extraction completed successfully
[04:50:44] ✅    ✅ Patient data extracted successfully
[04:50:44] 📊 Patient Response
     └─ patientFName: Geraldine
     └─ patientLName: DeMello
     └─ dob: 12/23/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5118009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2022', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F41.9', 'secondDiagnosis': 'G31.84', 'thirdDiagnosis': 'Z91.148', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'K58.9'}]
[04:50:44] ✅    ✅ Patient identified: Geraldine DeMello
[04:50:44] ✅    ✅ Patient name validation passed
[04:50:44] 🔄 
🔄 Step 3: Processing patient dates...
[04:50:44] [DOC: 9248096] ℹ️  DOB normalized: 12/23/1944
[04:50:44] [DOC: 9248096] ℹ️  Episode startOfCare normalized: 08/26/2022
[04:50:44] [DOC: 9248096] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[04:50:44] [DOC: 9248096] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[04:50:44] [DOC: 9248096] ✅ Patient date processing completed successfully
[04:50:44] ✅    ✅ Date processing completed
[04:50:44] 📊 Processed Patient Data
     └─ patientFName: Geraldine
     └─ patientLName: DeMello
     └─ dob: 12/23/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5118009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2022', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F41.9', 'secondDiagnosis': 'G31.84', 'thirdDiagnosis': 'Z91.148', 'fourthDiagnosis': 'D64.9', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'K58.9'}]
[04:50:44] 🔄 
🔄 Step 4: Extracting order data...
[04:50:46] ℹ️  Order extraction - MRN: '5118009'
[04:50:46] ℹ️  Order extraction - Sex: 'FEMALE'
[04:50:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[04:50:46] ℹ️  Order extraction - Payer Source: ''
[04:50:46] ✅ Order data extraction completed successfully
[04:50:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:50:46] ℹ️  Using MRN from patient data: '5118009' over '5118009'
[04:50:46] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[04:50:46] ✅ Patient name cross-validation successful
[04:50:46] ✅    ✅ Data merged successfully
[04:50:48] ✅    ✅ Order data extracted and validated
[04:50:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:50:54] [DOC: 9248096] ✅ Patient exists in API: Geraldine DeMello, ID: 8dbcfac3-e9d4-43f1-b3b0-9ea7c169c083
[04:50:54] ✅    ✅ Existing patient found with ID: 8dbcfac3-e9d4-43f1-b3b0-9ea7c169c083
[04:50:54] 🔄 
🔄 Step 6: Pushing order to API...
[04:50:54] [DOC: 9248096] ℹ️  Pushing order via API for patient ID: 8dbcfac3-e9d4-43f1-b3b0-9ea7c169c083
[04:50:55] [DOC: 9248096] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:50:55] ❌    ❌ Failed to push order
[04:50:55] 🔄 
🔄 Step 7: Writing to CSV...
[04:50:55] [DOC: 9248096] ℹ️  Calculated age: 80 from DOB: 12/23/1944
[04:50:55] [DOC: 9248096] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[04:50:55] [DOC: 9248096] ℹ️  Payer Source extracted: ''
[04:50:55] [DOC: 9248096] ℹ️  Diagnosis codes being written:
[04:50:55] [DOC: 9248096] ℹ️    - Latest_Episode_Firstdiagnosis: 'F41.9'
[04:50:55] [DOC: 9248096] ℹ️    - Latest_Episode_Seconddiagnosis: 'G31.84'
[04:50:55] [DOC: 9248096] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z91.148'
[04:50:55] [DOC: 9248096] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D64.9'
[04:50:55] [DOC: 9248096] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[04:50:55] [DOC: 9248096] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K58.9'
[04:50:55] [DOC: 9248096] ✅ Patient data written to CSV: Geraldine DeMello | Sex: FEMALE | Age: 80 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 5118009
[04:50:55] ✅    ✅ Document 9248096 processed and saved successfully
[04:50:55] 🔄 
🔄 Step 8: Saving API details...
[04:50:55] [DOC: 9248096] ℹ️  API push details saved for document 9248096
[04:50:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9248089                         ║
================================================================================
[04:50:55] ℹ️  Agency: Dartmouth HH
[04:50:55] ℹ️  Date: 04/18/2025
[04:50:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:50:57] [DOC: 9248089] ✅ Text extracted using pdfplumber (1057 chars)
[04:50:57] ✅    ✅ Text extracted using pdfplumber (1057 chars)
[04:50:57] 🔄 
🔄 Step 2: Extracting patient data...
[04:51:00] ℹ️  AI extracted raw sex value: 'F'
[04:51:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:51:00] ℹ️  AI extracted payer source: 'Medicare'
[04:51:00] ℹ️  AI extracted diagnoses:
[04:51:00] ℹ️    - Diagnosis 1: ''
[04:51:00] ℹ️    - Diagnosis 2: ''
[04:51:00] ℹ️    - Diagnosis 3: ''
[04:51:00] ℹ️    - Diagnosis 4: ''
[04:51:00] ℹ️    - Diagnosis 5: ''
[04:51:00] ℹ️    - Diagnosis 6: ''
[04:51:00] ℹ️  Final extracted MRN: '6448011'
[04:51:00] ℹ️  Final extracted Sex: 'FEMALE'
[04:51:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:51:00] ℹ️  Final extracted Payer Source: 'Medicare'
[04:51:00] ✅ Patient data extraction completed successfully
[04:51:00] ✅    ✅ Patient data extracted successfully
[04:51:00] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 471 Rockdale Avenue
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:00] ✅    ✅ Patient identified: Kim Teixeira
[04:51:00] ✅    ✅ Patient name validation passed
[04:51:00] 🔄 
🔄 Step 3: Processing patient dates...
[04:51:00] [DOC: 9248089] ℹ️  DOB normalized: 02/28/1964
[04:51:00] [DOC: 9248089] ℹ️  Episode startOfCare normalized: 01/18/2025
[04:51:00] [DOC: 9248089] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[04:51:00] [DOC: 9248089] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[04:51:00] [DOC: 9248089] ✅ Patient date processing completed successfully
[04:51:00] ✅    ✅ Date processing completed
[04:51:00] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 471 Rockdale Avenue
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:00] 🔄 
🔄 Step 4: Extracting order data...
[04:51:03] ℹ️  Order extraction - MRN: ''
[04:51:03] ℹ️  Order extraction - Sex: 'FEMALE'
[04:51:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:51:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:51:03] ✅ Order data extraction completed successfully
[04:51:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:51:03] ℹ️  Using MRN from patient data: '6448011'
[04:51:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:51:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:51:03] ✅ Patient name cross-validation successful
[04:51:03] ✅    ✅ Data merged successfully
[04:51:04] ✅    ✅ Order data extracted and validated
[04:51:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:51:04] [DOC: 9248089] ✅ Patient found in local cache: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[04:51:04] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[04:51:04] 🔄 
🔄 Step 6: Pushing order to API...
[04:51:04] [DOC: 9248089] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[04:51:06] [DOC: 9248089] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:51:06] ❌    ❌ Failed to push order
[04:51:06] 🔄 
🔄 Step 7: Writing to CSV...
[04:51:06] [DOC: 9248089] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[04:51:06] [DOC: 9248089] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:51:06] [DOC: 9248089] ℹ️  Payer Source extracted: 'Medicare'
[04:51:06] [DOC: 9248089] ℹ️  Diagnosis codes being written:
[04:51:06] [DOC: 9248089] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:51:06] [DOC: 9248089] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:51:06] [DOC: 9248089] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:51:06] [DOC: 9248089] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:51:06] [DOC: 9248089] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:51:06] [DOC: 9248089] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:51:06] [DOC: 9248089] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: Skilled Nursing | Payer: Medicare | MRN: 6448011
[04:51:06] ✅    ✅ Document 9248089 processed and saved successfully
[04:51:06] 🔄 
🔄 Step 8: Saving API details...
[04:51:06] [DOC: 9248089] ℹ️  API push details saved for document 9248089
[04:51:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9248074                         ║
================================================================================
[04:51:06] ℹ️  Agency: Dartmouth HH
[04:51:06] ℹ️  Date: 04/18/2025
[04:51:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:51:07] [DOC: 9248074] ✅ Text extracted using pdfplumber (1126 chars)
[04:51:07] ✅    ✅ Text extracted using pdfplumber (1126 chars)
[04:51:07] 🔄 
🔄 Step 2: Extracting patient data...
[04:51:10] ℹ️  AI extracted raw sex value: 'F'
[04:51:10] ℹ️  AI extracted service line: 'HHA'
[04:51:10] ℹ️  AI extracted payer source: 'Medicare'
[04:51:10] ℹ️  AI extracted diagnoses:
[04:51:10] ℹ️    - Diagnosis 1: ''
[04:51:10] ℹ️    - Diagnosis 2: ''
[04:51:10] ℹ️    - Diagnosis 3: ''
[04:51:10] ℹ️    - Diagnosis 4: ''
[04:51:10] ℹ️    - Diagnosis 5: ''
[04:51:10] ℹ️    - Diagnosis 6: ''
[04:51:10] ℹ️  Final extracted MRN: '672008'
[04:51:10] ℹ️  Final extracted Sex: 'FEMALE'
[04:51:10] ℹ️  Final extracted Service Line: 'HHA'
[04:51:10] ℹ️  Final extracted Payer Source: 'Medicare'
[04:51:10] ✅ Patient data extraction completed successfully
[04:51:10] ✅    ✅ Patient data extracted successfully
[04:51:10] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:10] ✅    ✅ Patient identified: Jane Lonsdale
[04:51:10] ✅    ✅ Patient name validation passed
[04:51:10] 🔄 
🔄 Step 3: Processing patient dates...
[04:51:10] [DOC: 9248074] ℹ️  DOB normalized: 02/20/1930
[04:51:10] [DOC: 9248074] ℹ️  Episode startOfCare normalized: 03/09/2025
[04:51:10] [DOC: 9248074] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[04:51:10] [DOC: 9248074] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[04:51:10] [DOC: 9248074] ✅ Patient date processing completed successfully
[04:51:10] ✅    ✅ Date processing completed
[04:51:10] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:10] 🔄 
🔄 Step 4: Extracting order data...
[04:51:12] ℹ️  Order extraction - MRN: ''
[04:51:12] ℹ️  Order extraction - Sex: 'FEMALE'
[04:51:12] ℹ️  Order extraction - Service Line: 'HHA'
[04:51:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:51:12] ✅ Order data extraction completed successfully
[04:51:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:51:12] ℹ️  Using MRN from patient data: '672008'
[04:51:12] ℹ️  Service line consistent in both sources: 'HHA'
[04:51:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:51:12] ✅ Patient name cross-validation successful
[04:51:12] ✅    ✅ Data merged successfully
[04:51:14] ✅    ✅ Order data extracted and validated
[04:51:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:51:32] [DOC: 9248074] ℹ️  Patient not found in cache or API: Jane Lonsdale
[04:51:32] [DOC: 9248074] ℹ️  Patient not found, creating new patient via API...
[04:51:32] [DOC: 9248074] ℹ️  Creating patient via API: Jane Lonsdale
[04:51:34] [DOC: 9248074] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:51:34] ❌    ❌ Failed to create patient
[04:51:34] [DOC: 9248074] ℹ️  API push details saved for document 9248074
================================================================================
║                        Processing Document ID: 9248069                         ║
================================================================================
[04:51:34] ℹ️  Agency: Dartmouth HH
[04:51:34] ℹ️  Date: 04/18/2025
[04:51:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:51:36] [DOC: 9248069] ✅ Text extracted using pdfplumber (4947 chars)
[04:51:36] ✅    ✅ Text extracted using pdfplumber (4947 chars)
[04:51:36] 🔄 
🔄 Step 2: Extracting patient data...
[04:51:39] ℹ️  AI extracted raw sex value: 'F'
[04:51:39] ℹ️  AI extracted service line: 'OT'
[04:51:39] ℹ️  AI extracted payer source: 'Medicare'
[04:51:39] ℹ️  AI extracted diagnoses:
[04:51:39] ℹ️    - Diagnosis 1: ''
[04:51:39] ℹ️    - Diagnosis 2: ''
[04:51:39] ℹ️    - Diagnosis 3: ''
[04:51:39] ℹ️    - Diagnosis 4: ''
[04:51:39] ℹ️    - Diagnosis 5: ''
[04:51:39] ℹ️    - Diagnosis 6: ''
[04:51:39] ℹ️  Final extracted MRN: '338008'
[04:51:39] ℹ️  Final extracted Sex: 'FEMALE'
[04:51:39] ℹ️  Final extracted Service Line: 'OT'
[04:51:39] ℹ️  Final extracted Payer Source: 'Medicare'
[04:51:39] ✅ Patient data extraction completed successfully
[04:51:39] ✅    ✅ Patient data extracted successfully
[04:51:39] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Kelly
     └─ dob: 04/18/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 338008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:39] ✅    ✅ Patient identified: Louise Kelly
[04:51:39] ✅    ✅ Patient name validation passed
[04:51:39] 🔄 
🔄 Step 3: Processing patient dates...
[04:51:39] [DOC: 9248069] ℹ️  DOB normalized: 04/18/1952
[04:51:39] [DOC: 9248069] ℹ️  Episode startOfCare normalized: 03/07/2025
[04:51:39] [DOC: 9248069] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[04:51:39] [DOC: 9248069] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[04:51:39] [DOC: 9248069] ✅ Patient date processing completed successfully
[04:51:39] ✅    ✅ Date processing completed
[04:51:39] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Kelly
     └─ dob: 04/18/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 338008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/07/2025', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:39] 🔄 
🔄 Step 4: Extracting order data...
[04:51:41] ℹ️  Order extraction - MRN: ''
[04:51:41] ℹ️  Order extraction - Sex: 'FEMALE'
[04:51:41] ℹ️  Order extraction - Service Line: 'OT'
[04:51:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:51:41] ✅ Order data extraction completed successfully
[04:51:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:51:41] ℹ️  Using MRN from patient data: '338008'
[04:51:41] ℹ️  Service line consistent in both sources: 'OT'
[04:51:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:51:41] ✅ Patient name cross-validation successful
[04:51:41] ✅    ✅ Data merged successfully
[04:51:43] ✅    ✅ Order data extracted and validated
[04:51:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:52:20] [DOC: 9248069] ℹ️  Patient not found in cache or API: Louise Kelly
[04:52:20] [DOC: 9248069] ℹ️  Patient not found, creating new patient via API...
[04:52:20] [DOC: 9248069] ℹ️  Creating patient via API: Louise Kelly
[04:52:21] [DOC: 9248069] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:52:21] ❌    ❌ Failed to create patient
[04:52:21] [DOC: 9248069] ℹ️  API push details saved for document 9248069
================================================================================
║                        Processing Document ID: 9248064                         ║
================================================================================
[04:52:21] ℹ️  Agency: Dartmouth HH
[04:52:21] ℹ️  Date: 04/18/2025
[04:52:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:52:23] [DOC: 9248064] ✅ Text extracted using pdfplumber (1293 chars)
[04:52:23] ✅    ✅ Text extracted using pdfplumber (1293 chars)
[04:52:23] 🔄 
🔄 Step 2: Extracting patient data...
[04:52:26] ℹ️  AI extracted raw sex value: 'F'
[04:52:26] ℹ️  AI extracted service line: 'PT'
[04:52:26] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[04:52:26] ℹ️  AI extracted diagnoses:
[04:52:26] ℹ️    - Diagnosis 1: ''
[04:52:26] ℹ️    - Diagnosis 2: ''
[04:52:26] ℹ️    - Diagnosis 3: ''
[04:52:26] ℹ️    - Diagnosis 4: ''
[04:52:26] ℹ️    - Diagnosis 5: ''
[04:52:26] ℹ️    - Diagnosis 6: ''
[04:52:26] ℹ️  Final extracted MRN: '667011'
[04:52:26] ℹ️  Final extracted Sex: 'FEMALE'
[04:52:26] ℹ️  Final extracted Service Line: 'PT'
[04:52:26] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[04:52:26] ✅ Patient data extraction completed successfully
[04:52:26] ✅    ✅ Patient data extracted successfully
[04:52:26] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 17 Abbey St
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:26] ✅    ✅ Patient identified: Linda Hotte
[04:52:26] ✅    ✅ Patient name validation passed
[04:52:26] 🔄 
🔄 Step 3: Processing patient dates...
[04:52:26] [DOC: 9248064] ℹ️  DOB normalized: 09/14/1952
[04:52:26] [DOC: 9248064] ℹ️  Episode startOfCare normalized: 02/23/2025
[04:52:26] [DOC: 9248064] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[04:52:26] [DOC: 9248064] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[04:52:26] [DOC: 9248064] ✅ Patient date processing completed successfully
[04:52:26] ✅    ✅ Date processing completed
[04:52:26] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 17 Abbey St
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:26] 🔄 
🔄 Step 4: Extracting order data...
[04:52:28] ℹ️  Order extraction - MRN: ''
[04:52:28] ℹ️  Order extraction - Sex: 'FEMALE'
[04:52:28] ℹ️  Order extraction - Service Line: 'PT'
[04:52:28] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[04:52:28] ✅ Order data extraction completed successfully
[04:52:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:52:28] ℹ️  Using MRN from patient data: '667011'
[04:52:28] ℹ️  Service line consistent in both sources: 'PT'
[04:52:28] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[04:52:28] ✅ Patient name cross-validation successful
[04:52:28] ✅    ✅ Data merged successfully
[04:52:29] ✅    ✅ Order data extracted and validated
[04:52:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:52:40] [DOC: 9248064] ℹ️  Patient not found in cache or API: Linda Hotte
[04:52:40] [DOC: 9248064] ℹ️  Patient not found, creating new patient via API...
[04:52:40] [DOC: 9248064] ℹ️  Creating patient via API: Linda Hotte
[04:52:41] [DOC: 9248064] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:52:41] ❌    ❌ Failed to create patient
[04:52:41] [DOC: 9248064] ℹ️  API push details saved for document 9248064
================================================================================
║                        Processing Document ID: 9248059                         ║
================================================================================
[04:52:41] ℹ️  Agency: Dartmouth HH
[04:52:41] ℹ️  Date: 04/18/2025
[04:52:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:52:43] [DOC: 9248059] ✅ Text extracted using pdfplumber (1204 chars)
[04:52:43] ✅    ✅ Text extracted using pdfplumber (1204 chars)
[04:52:43] 🔄 
🔄 Step 2: Extracting patient data...
[04:52:46] ℹ️  AI extracted raw sex value: 'F'
[04:52:46] ℹ️  AI extracted service line: 'Skilled Observation & Assessment of Incision Line'
[04:52:46] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[04:52:46] ℹ️  AI extracted diagnoses:
[04:52:46] ℹ️    - Diagnosis 1: ''
[04:52:46] ℹ️    - Diagnosis 2: ''
[04:52:46] ℹ️    - Diagnosis 3: ''
[04:52:46] ℹ️    - Diagnosis 4: ''
[04:52:46] ℹ️    - Diagnosis 5: ''
[04:52:46] ℹ️    - Diagnosis 6: ''
[04:52:46] ℹ️  Final extracted MRN: '6201015'
[04:52:46] ℹ️  Final extracted Sex: 'FEMALE'
[04:52:46] ℹ️  Final extracted Service Line: 'Skilled Observation & Assessment of Incision Line'
[04:52:46] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[04:52:46] ✅ Patient data extraction completed successfully
[04:52:46] ✅    ✅ Patient data extracted successfully
[04:52:46] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 103 Fair St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Observation & Assessment of Incision Line
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:46] ✅    ✅ Patient identified: Maria Laborinho
[04:52:46] ✅    ✅ Patient name validation passed
[04:52:46] 🔄 
🔄 Step 3: Processing patient dates...
[04:52:46] [DOC: 9248059] ℹ️  DOB normalized: 02/08/1951
[04:52:46] [DOC: 9248059] ℹ️  Episode startOfCare normalized: 03/13/2025
[04:52:46] [DOC: 9248059] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[04:52:46] [DOC: 9248059] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[04:52:46] [DOC: 9248059] ✅ Patient date processing completed successfully
[04:52:46] ✅    ✅ Date processing completed
[04:52:46] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 103 Fair St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Observation & Assessment of Incision Line
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:46] 🔄 
🔄 Step 4: Extracting order data...
[04:52:48] ℹ️  Order extraction - MRN: ''
[04:52:48] ℹ️  Order extraction - Sex: 'FEMALE'
[04:52:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:52:48] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[04:52:48] ✅ Order data extraction completed successfully
[04:52:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:52:48] ℹ️  Using MRN from patient data: '6201015'
[04:52:48] ℹ️  Combined service lines: Patient='Skilled Observation & Assessment of Incision Line' + Order='Skilled Nursing' = 'Skilled Nursing, Skilled Observation & Assessment of Incision Line'
[04:52:48] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[04:52:48] ✅ Patient name cross-validation successful
[04:52:48] ✅    ✅ Data merged successfully
[04:52:49] ✅    ✅ Order data extracted and validated
[04:52:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:52:54] [DOC: 9248059] ℹ️  Patient not found in cache or API: Maria Laborinho
[04:52:54] [DOC: 9248059] ℹ️  Patient not found, creating new patient via API...
[04:52:54] [DOC: 9248059] ℹ️  Creating patient via API: Maria Laborinho
[04:52:55] [DOC: 9248059] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:52:55] ❌    ❌ Failed to create patient
[04:52:55] [DOC: 9248059] ℹ️  API push details saved for document 9248059
================================================================================
║                        Processing Document ID: 9248018                         ║
================================================================================
[04:52:55] ℹ️  Agency: Dartmouth HH
[04:52:55] ℹ️  Date: 04/18/2025
[04:52:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:52:59] [DOC: 9248018] ✅ Text extracted using pdfplumber (10490 chars)
[04:52:59] ✅    ✅ Text extracted using pdfplumber (10478 chars)
[04:52:59] 🔄 
🔄 Step 2: Extracting patient data...
[04:53:02] ℹ️  AI extracted raw sex value: 'F'
[04:53:02] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[04:53:02] ℹ️  AI extracted payer source: ''
[04:53:02] ℹ️  AI extracted diagnoses:
[04:53:02] ℹ️    - Diagnosis 1: 'I25.709'
[04:53:02] ℹ️    - Diagnosis 2: 'I24.1'
[04:53:02] ℹ️    - Diagnosis 3: 'I25.2'
[04:53:02] ℹ️    - Diagnosis 4: 'I11.0'
[04:53:02] ℹ️    - Diagnosis 5: 'I50.9'
[04:53:02] ℹ️    - Diagnosis 6: 'N63.0'
[04:53:02] ℹ️  Final extracted MRN: '227027'
[04:53:02] ℹ️  Final extracted Sex: 'FEMALE'
[04:53:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[04:53:02] ℹ️  Final extracted Payer Source: ''
[04:53:02] ✅ Patient data extraction completed successfully
[04:53:02] ✅    ✅ Patient data extracted successfully
[04:53:02] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I25.709', 'secondDiagnosis': 'I24.1', 'thirdDiagnosis': 'I25.2', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'N63.0'}]
[04:53:02] ✅    ✅ Patient identified: Bonnie Desrochers
[04:53:02] ✅    ✅ Patient name validation passed
[04:53:02] 🔄 
🔄 Step 3: Processing patient dates...
[04:53:02] [DOC: 9248018] ℹ️  DOB normalized: 08/14/1951
[04:53:02] [DOC: 9248018] ℹ️  Episode startOfCare normalized: 02/10/2025
[04:53:02] [DOC: 9248018] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[04:53:02] [DOC: 9248018] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[04:53:02] [DOC: 9248018] ✅ Patient date processing completed successfully
[04:53:02] ✅    ✅ Date processing completed
[04:53:02] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I25.709', 'secondDiagnosis': 'I24.1', 'thirdDiagnosis': 'I25.2', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'N63.0'}]
[04:53:02] 🔄 
🔄 Step 4: Extracting order data...
[04:53:05] ℹ️  Order extraction - MRN: '227027'
[04:53:05] ℹ️  Order extraction - Sex: 'FEMALE'
[04:53:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[04:53:05] ℹ️  Order extraction - Payer Source: ''
[04:53:05] ✅ Order data extraction completed successfully
[04:53:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:53:05] ℹ️  Using MRN from patient data: '227027' over '227027'
[04:53:05] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[04:53:05] ✅ Patient name cross-validation successful
[04:53:05] ✅    ✅ Data merged successfully
[04:53:06] ✅    ✅ Order data extracted and validated
[04:53:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:53:36] [DOC: 9248018] ℹ️  Patient not found in cache or API: Bonnie Desrochers
[04:53:36] [DOC: 9248018] ℹ️  Patient not found, creating new patient via API...
[04:53:36] [DOC: 9248018] ℹ️  Creating patient via API: Bonnie Desrochers
[04:53:37] [DOC: 9248018] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:53:37] ❌    ❌ Failed to create patient
[04:53:37] [DOC: 9248018] ℹ️  API push details saved for document 9248018
================================================================================
║                        Processing Document ID: 9248011                         ║
================================================================================
[04:53:37] ℹ️  Agency: Dartmouth HH
[04:53:37] ℹ️  Date: 04/18/2025
[04:53:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:53:39] [DOC: 9248011] ✅ Text extracted using pdfplumber (3020 chars)
[04:53:39] ✅    ✅ Text extracted using pdfplumber (3020 chars)
[04:53:39] 🔄 
🔄 Step 2: Extracting patient data...
[04:53:42] ℹ️  AI extracted raw sex value: 'F'
[04:53:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:53:42] ℹ️  AI extracted payer source: 'Medicare'
[04:53:42] ℹ️  AI extracted diagnoses:
[04:53:42] ℹ️    - Diagnosis 1: ''
[04:53:42] ℹ️    - Diagnosis 2: ''
[04:53:42] ℹ️    - Diagnosis 3: ''
[04:53:42] ℹ️    - Diagnosis 4: ''
[04:53:42] ℹ️    - Diagnosis 5: ''
[04:53:42] ℹ️    - Diagnosis 6: ''
[04:53:42] ℹ️  Final extracted MRN: '6045015'
[04:53:42] ℹ️  Final extracted Sex: 'FEMALE'
[04:53:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:53:42] ℹ️  Final extracted Payer Source: 'Medicare'
[04:53:42] ✅ Patient data extraction completed successfully
[04:53:42] ✅    ✅ Patient data extracted successfully
[04:53:42] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6045015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/15/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:53:42] ✅    ✅ Patient identified: Bonnie Desrochers
[04:53:42] ✅    ✅ Patient name validation passed
[04:53:42] 🔄 
🔄 Step 3: Processing patient dates...
[04:53:42] [DOC: 9248011] ℹ️  DOB normalized: 08/14/1951
[04:53:42] [DOC: 9248011] ℹ️  Episode startOfCare normalized: 02/15/2025
[04:53:42] [DOC: 9248011] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[04:53:42] [DOC: 9248011] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[04:53:42] [DOC: 9248011] ✅ Patient date processing completed successfully
[04:53:42] ✅    ✅ Date processing completed
[04:53:42] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Desrochers
     └─ dob: 08/14/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6045015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/15/2025', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:53:42] 🔄 
🔄 Step 4: Extracting order data...
[04:53:44] ℹ️  Order extraction - MRN: ''
[04:53:44] ℹ️  Order extraction - Sex: 'FEMALE'
[04:53:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:53:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:53:44] ✅ Order data extraction completed successfully
[04:53:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:53:44] ℹ️  Using MRN from patient data: '6045015'
[04:53:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:53:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:53:44] ✅ Patient name cross-validation successful
[04:53:44] ✅    ✅ Data merged successfully
[04:53:46] ✅    ✅ Order data extracted and validated
[04:53:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:53:51] [DOC: 9248011] ℹ️  Patient not found in cache or API: Bonnie Desrochers
[04:53:51] [DOC: 9248011] ℹ️  Patient not found, creating new patient via API...
[04:53:51] [DOC: 9248011] ℹ️  Creating patient via API: Bonnie Desrochers
[04:53:53] [DOC: 9248011] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:53:53] ❌    ❌ Failed to create patient
[04:53:53] [DOC: 9248011] ℹ️  API push details saved for document 9248011
================================================================================
║                        Processing Document ID: 9247960                         ║
================================================================================
[04:53:53] ℹ️  Agency: Dartmouth HH
[04:53:53] ℹ️  Date: 04/18/2025
[04:53:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:53:55] [DOC: 9247960] ✅ Text extracted using pdfplumber (2053 chars)
[04:53:55] ✅    ✅ Text extracted using pdfplumber (2053 chars)
[04:53:55] 🔄 
🔄 Step 2: Extracting patient data...
[04:53:58] ℹ️  AI extracted raw sex value: 'F'
[04:53:58] ℹ️  AI extracted service line: 'RN, LPN, Home Health Aide'
[04:53:58] ℹ️  AI extracted payer source: 'Senior Whole Health'
[04:53:58] ℹ️  AI extracted diagnoses:
[04:53:58] ℹ️    - Diagnosis 1: ''
[04:53:58] ℹ️    - Diagnosis 2: ''
[04:53:58] ℹ️    - Diagnosis 3: ''
[04:53:58] ℹ️    - Diagnosis 4: ''
[04:53:58] ℹ️    - Diagnosis 5: ''
[04:53:58] ℹ️    - Diagnosis 6: ''
[04:53:58] ℹ️  Final extracted MRN: '14017'
[04:53:58] ℹ️  Final extracted Sex: 'FEMALE'
[04:53:58] ℹ️  Final extracted Service Line: 'RN, LPN, Home Health Aide'
[04:53:58] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[04:53:58] ✅ Patient data extraction completed successfully
[04:53:58] ✅    ✅ Patient data extracted successfully
[04:53:58] 📊 Patient Response
     └─ patientFName: Cynthia
     └─ patientLName: Santos
     └─ dob: 10/07/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14017
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 580 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN, Home Health Aide
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:53:58] ✅    ✅ Patient identified: Cynthia Santos
[04:53:58] ✅    ✅ Patient name validation passed
[04:53:58] 🔄 
🔄 Step 3: Processing patient dates...
[04:53:58] [DOC: 9247960] ℹ️  DOB normalized: 10/07/1935
[04:53:58] [DOC: 9247960] ℹ️  Episode startOfCare normalized: 04/01/2025
[04:53:58] [DOC: 9247960] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[04:53:58] [DOC: 9247960] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[04:53:58] [DOC: 9247960] ✅ Patient date processing completed successfully
[04:53:58] ✅    ✅ Date processing completed
[04:53:58] 📊 Processed Patient Data
     └─ patientFName: Cynthia
     └─ patientLName: Santos
     └─ dob: 10/07/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14017
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 580 Summer Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN, Home Health Aide
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:53:58] 🔄 
🔄 Step 4: Extracting order data...
[04:54:00] ℹ️  Order extraction - MRN: ''
[04:54:00] ℹ️  Order extraction - Sex: 'FEMALE'
[04:54:00] ℹ️  Order extraction - Service Line: 'RN, LPN, HHA'
[04:54:00] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[04:54:00] ✅ Order data extraction completed successfully
[04:54:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:54:00] ℹ️  Using MRN from patient data: '14017'
[04:54:00] ℹ️  Combined service lines: Patient='RN, LPN, Home Health Aide' + Order='RN, LPN, HHA' = 'HHA, Home Health Aide, LPN, RN'
[04:54:00] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[04:54:00] ✅ Patient name cross-validation successful
[04:54:00] ✅    ✅ Data merged successfully
[04:54:01] ✅    ✅ Order data extracted and validated
[04:54:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:54:14] [DOC: 9247960] ℹ️  Patient not found in cache or API: Cynthia Santos
[04:54:14] [DOC: 9247960] ℹ️  Patient not found, creating new patient via API...
[04:54:14] [DOC: 9247960] ℹ️  Creating patient via API: Cynthia Santos
[04:54:15] [DOC: 9247960] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:54:15] ❌    ❌ Failed to create patient
[04:54:15] [DOC: 9247960] ℹ️  API push details saved for document 9247960
================================================================================
║                        Processing Document ID: 9247954                         ║
================================================================================
[04:54:15] ℹ️  Agency: Dartmouth HH
[04:54:15] ℹ️  Date: 04/18/2025
[04:54:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:54:20] [DOC: 9247954] ✅ Text extracted using pdfplumber (14368 chars)
[04:54:20] ✅    ✅ Text extracted using pdfplumber (14368 chars)
[04:54:20] 🔄 
🔄 Step 2: Extracting patient data...
[04:54:24] ℹ️  AI extracted raw sex value: 'F'
[04:54:24] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[04:54:24] ℹ️  AI extracted payer source: 'None'
[04:54:24] ℹ️  AI extracted diagnoses:
[04:54:24] ℹ️    - Diagnosis 1: 'I13.0'
[04:54:24] ℹ️    - Diagnosis 2: 'I50.33'
[04:54:24] ℹ️    - Diagnosis 3: 'N18.9'
[04:54:24] ℹ️    - Diagnosis 4: 'J44.1'
[04:54:24] ℹ️    - Diagnosis 5: 'I25.10'
[04:54:24] ℹ️    - Diagnosis 6: 'D50.9'
[04:54:24] ℹ️  Final extracted MRN: '14017'
[04:54:24] ℹ️  Final extracted Sex: 'FEMALE'
[04:54:24] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[04:54:24] ℹ️  Final extracted Payer Source: ''
[04:54:24] ✅ Patient data extraction completed successfully
[04:54:24] ✅    ✅ Patient data extracted successfully
[04:54:24] 📊 Patient Response
     └─ patientFName: Cynthia
     └─ patientLName: Santos
     └─ dob: 10/07/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14017
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100003766977
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.9', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'D50.9'}]
[04:54:24] ✅    ✅ Patient identified: Cynthia Santos
[04:54:24] ✅    ✅ Patient name validation passed
[04:54:24] 🔄 
🔄 Step 3: Processing patient dates...
[04:54:24] [DOC: 9247954] ℹ️  DOB normalized: 10/07/1935
[04:54:24] [DOC: 9247954] ℹ️  Episode startOfCare normalized: 03/31/2025
[04:54:24] [DOC: 9247954] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[04:54:24] [DOC: 9247954] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[04:54:24] [DOC: 9247954] ✅ Patient date processing completed successfully
[04:54:24] ✅    ✅ Date processing completed
[04:54:24] 📊 Processed Patient Data
     └─ patientFName: Cynthia
     └─ patientLName: Santos
     └─ dob: 10/07/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14017
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100003766977
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.9', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'D50.9'}]
[04:54:24] 🔄 
🔄 Step 4: Extracting order data...
[04:54:27] ℹ️  Order extraction - MRN: '14017'
[04:54:27] ℹ️  Order extraction - Sex: 'FEMALE'
[04:54:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, Diet'
[04:54:27] ℹ️  Order extraction - Payer Source: ''
[04:54:27] ✅ Order data extraction completed successfully
[04:54:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:54:27] ℹ️  Using MRN from patient data: '14017' over '14017'
[04:54:27] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT, Diet' = 'Diet, PT, Physical Therapy, Skilled Nursing'
[04:54:27] ✅ Patient name cross-validation successful
[04:54:27] ✅    ✅ Data merged successfully
[04:54:28] ✅    ✅ Order data extracted and validated
[04:54:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:54:45] [DOC: 9247954] ℹ️  Patient not found in cache or API: Cynthia Santos
[04:54:45] [DOC: 9247954] ℹ️  Patient not found, creating new patient via API...
[04:54:45] [DOC: 9247954] ℹ️  Creating patient via API: Cynthia Santos
[04:54:46] [DOC: 9247954] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:54:46] ❌    ❌ Failed to create patient
[04:54:46] [DOC: 9247954] ℹ️  API push details saved for document 9247954
================================================================================
║                        Processing Document ID: 9247934                         ║
================================================================================
[04:54:46] ℹ️  Agency: Nizhoni Health-Fall River
[04:54:46] ℹ️  Date: 04/18/2025
[04:54:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:54:50] [DOC: 9247934] ✅ Text extracted using pdfplumber (10794 chars)
[04:54:50] ✅    ✅ Text extracted using pdfplumber (10794 chars)
[04:54:50] 🔄 
🔄 Step 2: Extracting patient data...
[04:54:53] ℹ️  AI extracted raw sex value: 'F'
[04:54:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:54:53] ℹ️  AI extracted payer source: 'None'
[04:54:53] ℹ️  AI extracted diagnoses:
[04:54:53] ℹ️    - Diagnosis 1: 'F31.72'
[04:54:53] ℹ️    - Diagnosis 2: 'F41.8'
[04:54:53] ℹ️    - Diagnosis 3: 'I10'
[04:54:53] ℹ️    - Diagnosis 4: 'J98.4'
[04:54:53] ℹ️    - Diagnosis 5: 'F10.21'
[04:54:53] ℹ️    - Diagnosis 6: 'I70.0'
[04:54:53] ℹ️  Final extracted MRN: '14458020'
[04:54:53] ℹ️  Final extracted Sex: 'FEMALE'
[04:54:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:54:53] ℹ️  Final extracted Payer Source: ''
[04:54:53] ✅ Patient data extraction completed successfully
[04:54:53] ✅    ✅ Patient data extracted successfully
[04:54:53] 📊 Patient Response
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100019270527
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'F31.72', 'secondDiagnosis': 'F41.8', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J98.4', 'fifthDiagnosis': 'F10.21', 'sixthDiagnosis': 'I70.0'}]
[04:54:53] ✅    ✅ Patient identified: Gina Reich
[04:54:53] ✅    ✅ Patient name validation passed
[04:54:53] 🔄 
🔄 Step 3: Processing patient dates...
[04:54:53] [DOC: 9247934] ℹ️  DOB normalized: 12/30/1962
[04:54:53] [DOC: 9247934] ℹ️  Episode startOfCare normalized: 10/22/2024
[04:54:53] [DOC: 9247934] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[04:54:53] [DOC: 9247934] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[04:54:53] [DOC: 9247934] ✅ Patient date processing completed successfully
[04:54:53] ✅    ✅ Date processing completed
[04:54:53] 📊 Processed Patient Data
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100019270527
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'F31.72', 'secondDiagnosis': 'F41.8', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J98.4', 'fifthDiagnosis': 'F10.21', 'sixthDiagnosis': 'I70.0'}]
[04:54:53] 🔄 
🔄 Step 4: Extracting order data...
[04:54:55] ℹ️  Order extraction - MRN: '14458020'
[04:54:55] ℹ️  Order extraction - Sex: 'FEMALE'
[04:54:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:54:55] ℹ️  Order extraction - Payer Source: ''
[04:54:55] ✅ Order data extraction completed successfully
[04:54:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:54:55] ℹ️  Using MRN from patient data: '14458020' over '14458020'
[04:54:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:54:55] ✅ Patient name cross-validation successful
[04:54:55] ✅    ✅ Data merged successfully
[04:54:57] ✅    ✅ Order data extracted and validated
[04:54:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:54:57] [DOC: 9247934] ✅ Patient found in local cache: Gina Reich, ID: d58989e3-7402-4034-9b32-9290658d7724
[04:54:57] ✅    ✅ Existing patient found with ID: d58989e3-7402-4034-9b32-9290658d7724
[04:54:57] 🔄 
🔄 Step 6: Pushing order to API...
[04:54:57] [DOC: 9247934] ℹ️  Pushing order via API for patient ID: d58989e3-7402-4034-9b32-9290658d7724
[04:54:58] [DOC: 9247934] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:54:58] ❌    ❌ Failed to push order
[04:54:58] 🔄 
🔄 Step 7: Writing to CSV...
[04:54:58] [DOC: 9247934] ℹ️  Calculated age: 62 from DOB: 12/30/1962
[04:54:58] [DOC: 9247934] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:54:58] [DOC: 9247934] ℹ️  Payer Source extracted: ''
[04:54:58] [DOC: 9247934] ℹ️  Diagnosis codes being written:
[04:54:58] [DOC: 9247934] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.72'
[04:54:58] [DOC: 9247934] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.8'
[04:54:58] [DOC: 9247934] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[04:54:58] [DOC: 9247934] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J98.4'
[04:54:58] [DOC: 9247934] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F10.21'
[04:54:58] [DOC: 9247934] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I70.0'
[04:54:58] [DOC: 9247934] ✅ Patient data written to CSV: Gina Reich | Sex: FEMALE | Age: 62 | Service: Skilled Nursing | Payer:  | MRN: 14458020
[04:54:58] ✅    ✅ Document 9247934 processed and saved successfully
[04:54:58] 🔄 
🔄 Step 8: Saving API details...
[04:54:58] [DOC: 9247934] ℹ️  API push details saved for document 9247934
[04:54:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247936                         ║
================================================================================
[04:54:58] ℹ️  Agency: Dartmouth HH
[04:54:58] ℹ️  Date: 04/18/2025
[04:54:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:00] [DOC: 9247936] ✅ Text extracted using pdfplumber (1470 chars)
[04:55:00] ✅    ✅ Text extracted using pdfplumber (1470 chars)
[04:55:00] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:03] ℹ️  AI extracted raw sex value: 'F'
[04:55:03] ℹ️  AI extracted service line: 'OT'
[04:55:03] ℹ️  AI extracted payer source: 'Medicare'
[04:55:03] ℹ️  AI extracted diagnoses:
[04:55:03] ℹ️    - Diagnosis 1: ''
[04:55:03] ℹ️    - Diagnosis 2: ''
[04:55:03] ℹ️    - Diagnosis 3: ''
[04:55:03] ℹ️    - Diagnosis 4: ''
[04:55:03] ℹ️    - Diagnosis 5: ''
[04:55:03] ℹ️    - Diagnosis 6: ''
[04:55:03] ℹ️  Final extracted MRN: '711015'
[04:55:03] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:03] ℹ️  Final extracted Service Line: 'OT'
[04:55:03] ℹ️  Final extracted Payer Source: 'Medicare'
[04:55:03] ✅ Patient data extraction completed successfully
[04:55:03] ✅    ✅ Patient data extracted successfully
[04:55:03] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:55:03] ✅    ✅ Patient identified: Eileen Roddy
[04:55:03] ✅    ✅ Patient name validation passed
[04:55:03] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:03] [DOC: 9247936] ℹ️  DOB normalized: 02/29/1948
[04:55:03] [DOC: 9247936] ℹ️  Episode startOfCare normalized: 04/02/2025
[04:55:03] [DOC: 9247936] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[04:55:03] [DOC: 9247936] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[04:55:03] [DOC: 9247936] ✅ Patient date processing completed successfully
[04:55:03] ✅    ✅ Date processing completed
[04:55:03] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:55:03] 🔄 
🔄 Step 4: Extracting order data...
[04:55:05] ℹ️  Order extraction - MRN: ''
[04:55:05] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:05] ℹ️  Order extraction - Service Line: 'OT'
[04:55:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:55:05] ✅ Order data extraction completed successfully
[04:55:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:05] ℹ️  Using MRN from patient data: '711015'
[04:55:05] ℹ️  Service line consistent in both sources: 'OT'
[04:55:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:55:05] ✅ Patient name cross-validation successful
[04:55:05] ✅    ✅ Data merged successfully
[04:55:07] ✅    ✅ Order data extracted and validated
[04:55:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:55:07] [DOC: 9247936] ✅ Patient found in local cache: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[04:55:07] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[04:55:07] 🔄 
🔄 Step 6: Pushing order to API...
[04:55:07] [DOC: 9247936] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[04:55:08] [DOC: 9247936] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14266"}
[04:55:08] ❌    ❌ Failed to push order
[04:55:08] 🔄 
🔄 Step 7: Writing to CSV...
[04:55:08] [DOC: 9247936] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[04:55:08] [DOC: 9247936] ℹ️  Service Line extracted: 'OT'
[04:55:08] [DOC: 9247936] ℹ️  Payer Source extracted: 'Medicare'
[04:55:08] [DOC: 9247936] ℹ️  Diagnosis codes being written:
[04:55:08] [DOC: 9247936] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:55:08] [DOC: 9247936] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:55:08] [DOC: 9247936] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:55:08] [DOC: 9247936] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:55:08] [DOC: 9247936] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:55:08] [DOC: 9247936] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:55:08] [DOC: 9247936] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: OT | Payer: Medicare | MRN: 711015
[04:55:08] ✅    ✅ Document 9247936 processed and saved successfully
[04:55:08] 🔄 
🔄 Step 8: Saving API details...
[04:55:08] [DOC: 9247936] ℹ️  API push details saved for document 9247936
[04:55:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247931                         ║
================================================================================
[04:55:08] ℹ️  Agency: Dartmouth HH
[04:55:08] ℹ️  Date: 04/18/2025
[04:55:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:10] [DOC: 9247931] ✅ Text extracted using pdfplumber (1662 chars)
[04:55:10] ✅    ✅ Text extracted using pdfplumber (1662 chars)
[04:55:10] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:12] ℹ️  AI extracted raw sex value: 'F'
[04:55:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:55:12] ℹ️  AI extracted payer source: 'Medicare'
[04:55:12] ℹ️  AI extracted diagnoses:
[04:55:12] ℹ️    - Diagnosis 1: 'None'
[04:55:12] ℹ️    - Diagnosis 2: 'None'
[04:55:12] ℹ️    - Diagnosis 3: 'None'
[04:55:12] ℹ️    - Diagnosis 4: 'None'
[04:55:12] ℹ️    - Diagnosis 5: 'None'
[04:55:12] ℹ️    - Diagnosis 6: 'None'
[04:55:12] ℹ️  Final extracted MRN: '6115015'
[04:55:12] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:55:12] ℹ️  Final extracted Payer Source: 'Medicare'
[04:55:12] ✅ Patient data extraction completed successfully
[04:55:12] ✅    ✅ Patient data extracted successfully
[04:55:12] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:55:12] ✅    ✅ Patient identified: Nancy Silva
[04:55:12] ✅    ✅ Patient name validation passed
[04:55:12] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:12] [DOC: 9247931] ℹ️  DOB normalized: 11/18/1936
[04:55:12] [DOC: 9247931] ℹ️  Episode startOfCare normalized: 03/01/2025
[04:55:12] [DOC: 9247931] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[04:55:12] [DOC: 9247931] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[04:55:12] [DOC: 9247931] ✅ Patient date processing completed successfully
[04:55:12] ✅    ✅ Date processing completed
[04:55:12] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025'}]
[04:55:12] 🔄 
🔄 Step 4: Extracting order data...
[04:55:15] ℹ️  Order extraction - MRN: ''
[04:55:15] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:55:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:55:15] ✅ Order data extraction completed successfully
[04:55:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:15] ℹ️  Using MRN from patient data: '6115015'
[04:55:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:55:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:55:15] ✅ Patient name cross-validation successful
[04:55:15] ✅    ✅ Data merged successfully
[04:55:17] ✅    ✅ Order data extracted and validated
[04:55:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:55:17] [DOC: 9247931] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[04:55:17] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[04:55:17] 🔄 
🔄 Step 6: Pushing order to API...
[04:55:17] [DOC: 9247931] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[04:55:18] [DOC: 9247931] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:55:18] ❌    ❌ Failed to push order
[04:55:18] 🔄 
🔄 Step 7: Writing to CSV...
[04:55:18] [DOC: 9247931] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[04:55:18] [DOC: 9247931] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:55:18] [DOC: 9247931] ℹ️  Payer Source extracted: 'Medicare'
[04:55:18] [DOC: 9247931] ℹ️  Diagnosis codes being written:
[04:55:18] [DOC: 9247931] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:55:18] [DOC: 9247931] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:55:18] [DOC: 9247931] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:55:18] [DOC: 9247931] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:55:18] [DOC: 9247931] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:55:18] [DOC: 9247931] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:55:18] [DOC: 9247931] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6115015
[04:55:18] ✅    ✅ Document 9247931 processed and saved successfully
[04:55:18] 🔄 
🔄 Step 8: Saving API details...
[04:55:18] [DOC: 9247931] ℹ️  API push details saved for document 9247931
[04:55:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247924                         ║
================================================================================
[04:55:18] ℹ️  Agency: Dartmouth HH
[04:55:18] ℹ️  Date: 04/18/2025
[04:55:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:21] [DOC: 9247924] ✅ Text extracted using pdfplumber (15324 chars)
[04:55:21] ✅    ✅ Text extracted using pdfplumber (15312 chars)
[04:55:21] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:24] ℹ️  AI extracted raw sex value: 'F'
[04:55:24] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[04:55:24] ℹ️  AI extracted payer source: ''
[04:55:24] ℹ️  AI extracted diagnoses:
[04:55:24] ℹ️    - Diagnosis 1: 'M47.27'
[04:55:24] ℹ️    - Diagnosis 2: 'R26.89'
[04:55:24] ℹ️    - Diagnosis 3: 'G90.09'
[04:55:24] ℹ️    - Diagnosis 4: 'I10'
[04:55:24] ℹ️    - Diagnosis 5: 'F41.9'
[04:55:24] ℹ️    - Diagnosis 6: 'F32.9'
[04:55:24] ℹ️  Final extracted MRN: '711015'
[04:55:24] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:24] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[04:55:24] ℹ️  Final extracted Payer Source: ''
[04:55:24] ✅ Patient data extraction completed successfully
[04:55:24] ✅    ✅ Patient data extracted successfully
[04:55:24] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'M47.27', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'G90.09', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.9'}]
[04:55:24] ✅    ✅ Patient identified: Eileen Roddy
[04:55:24] ✅    ✅ Patient name validation passed
[04:55:24] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:24] [DOC: 9247924] ℹ️  DOB normalized: 02/29/1948
[04:55:24] [DOC: 9247924] ℹ️  Episode startOfCare normalized: 04/02/2025
[04:55:24] [DOC: 9247924] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[04:55:24] [DOC: 9247924] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[04:55:24] [DOC: 9247924] ✅ Patient date processing completed successfully
[04:55:24] ✅    ✅ Date processing completed
[04:55:24] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'M47.27', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'G90.09', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.9'}]
[04:55:24] 🔄 
🔄 Step 4: Extracting order data...
[04:55:26] ℹ️  Order extraction - MRN: '711015'
[04:55:26] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[04:55:26] ℹ️  Order extraction - Payer Source: ''
[04:55:26] ✅ Order data extraction completed successfully
[04:55:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:26] ℹ️  Using MRN from patient data: '711015' over '711015'
[04:55:26] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='Skilled Nursing, Physical Therapy' = 'PT, Physical Therapy, Skilled Nursing'
[04:55:26] ✅ Patient name cross-validation successful
[04:55:26] ✅    ✅ Data merged successfully
[04:55:28] ✅    ✅ Order data extracted and validated
[04:55:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:55:28] [DOC: 9247924] ✅ Patient found in local cache: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[04:55:28] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[04:55:28] 🔄 
🔄 Step 6: Pushing order to API...
[04:55:28] [DOC: 9247924] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[04:55:29] [DOC: 9247924] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:55:29] ❌    ❌ Failed to push order
[04:55:29] 🔄 
🔄 Step 7: Writing to CSV...
[04:55:29] [DOC: 9247924] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[04:55:29] [DOC: 9247924] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[04:55:29] [DOC: 9247924] ℹ️  Payer Source extracted: ''
[04:55:29] [DOC: 9247924] ℹ️  Diagnosis codes being written:
[04:55:29] [DOC: 9247924] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.27'
[04:55:29] [DOC: 9247924] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.89'
[04:55:29] [DOC: 9247924] ℹ️    - Latest_Episode_Thirddiagnosis: 'G90.09'
[04:55:29] [DOC: 9247924] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[04:55:29] [DOC: 9247924] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[04:55:29] [DOC: 9247924] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.9'
[04:55:29] [DOC: 9247924] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 711015
[04:55:29] ✅    ✅ Document 9247924 processed and saved successfully
[04:55:29] 🔄 
🔄 Step 8: Saving API details...
[04:55:29] [DOC: 9247924] ℹ️  API push details saved for document 9247924
[04:55:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247917                         ║
================================================================================
[04:55:29] ℹ️  Agency: Dartmouth HH
[04:55:29] ℹ️  Date: 04/18/2025
[04:55:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:32] [DOC: 9247917] ✅ Text extracted using pdfplumber (12382 chars)
[04:55:32] ✅    ✅ Text extracted using pdfplumber (12382 chars)
[04:55:32] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:36] ℹ️  AI extracted raw sex value: 'F'
[04:55:36] ℹ️  AI extracted service line: 'PT, RN'
[04:55:36] ℹ️  AI extracted payer source: 'None'
[04:55:36] ℹ️  AI extracted diagnoses:
[04:55:36] ℹ️    - Diagnosis 1: 'Z47.1'
[04:55:36] ℹ️    - Diagnosis 2: 'I48.0'
[04:55:36] ℹ️    - Diagnosis 3: 'R60.0'
[04:55:36] ℹ️    - Diagnosis 4: 'E66.3'
[04:55:36] ℹ️    - Diagnosis 5: 'Z68.31'
[04:55:36] ℹ️    - Diagnosis 6: 'K21.9'
[04:55:36] ℹ️  Final extracted MRN: '2170011'
[04:55:36] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:36] ℹ️  Final extracted Service Line: 'PT, RN'
[04:55:36] ℹ️  Final extracted Payer Source: ''
[04:55:36] ✅ Patient data extraction completed successfully
[04:55:36] ✅    ✅ Patient data extracted successfully
[04:55:36] 📊 Patient Response
     └─ patientFName: Genevieve
     └─ patientLName: Dasilva
     └─ dob: 11/28/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2170011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100201296272
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'R60.0', 'fourthDiagnosis': 'E66.3', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'K21.9'}]
[04:55:36] ✅    ✅ Patient identified: Genevieve Dasilva
[04:55:36] ✅    ✅ Patient name validation passed
[04:55:36] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:36] [DOC: 9247917] ℹ️  DOB normalized: 11/28/1945
[04:55:36] [DOC: 9247917] ℹ️  Episode startOfCare normalized: 04/13/2025
[04:55:36] [DOC: 9247917] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[04:55:36] [DOC: 9247917] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[04:55:36] [DOC: 9247917] ✅ Patient date processing completed successfully
[04:55:36] ✅    ✅ Date processing completed
[04:55:36] 📊 Processed Patient Data
     └─ patientFName: Genevieve
     └─ patientLName: Dasilva
     └─ dob: 11/28/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2170011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100201296272
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'R60.0', 'fourthDiagnosis': 'E66.3', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'K21.9'}]
[04:55:36] 🔄 
🔄 Step 4: Extracting order data...
[04:55:43] ℹ️  Order extraction - MRN: '2170011'
[04:55:43] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:43] ℹ️  Order extraction - Service Line: 'PT'
[04:55:43] ℹ️  Order extraction - Payer Source: ''
[04:55:43] ✅ Order data extraction completed successfully
[04:55:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:43] ℹ️  Using MRN from patient data: '2170011' over '2170011'
[04:55:43] ℹ️  Combined service lines: Patient='PT, RN' + Order='PT' = 'PT, RN'
[04:55:43] ✅ Patient name cross-validation successful
[04:55:43] ✅    ✅ Data merged successfully
[04:55:44] ✅    ✅ Order data extracted and validated
[04:55:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:56:42] [DOC: 9247917] ℹ️  Patient not found in cache or API: Genevieve Dasilva
[04:56:42] [DOC: 9247917] ℹ️  Patient not found, creating new patient via API...
[04:56:42] [DOC: 9247917] ℹ️  Creating patient via API: Genevieve Dasilva
[04:56:43] [DOC: 9247917] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:56:43] ❌    ❌ Failed to create patient
[04:56:43] [DOC: 9247917] ℹ️  API push details saved for document 9247917
================================================================================
║                        Processing Document ID: 9247895                         ║
================================================================================
[04:56:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:56:43] ℹ️  Date: 04/18/2025
[04:56:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:56:46] [DOC: 9247895] ✅ Text extracted using pdfplumber (10337 chars)
[04:56:46] ✅    ✅ Text extracted using pdfplumber (10337 chars)
[04:56:46] 🔄 
🔄 Step 2: Extracting patient data...
[04:56:50] ℹ️  AI extracted raw sex value: 'M'
[04:56:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:56:50] ℹ️  AI extracted payer source: 'Medicare'
[04:56:50] ℹ️  AI extracted diagnoses:
[04:56:50] ℹ️    - Diagnosis 1: 'E10.65'
[04:56:50] ℹ️    - Diagnosis 2: 'G92.8'
[04:56:50] ℹ️    - Diagnosis 3: 'N17.9'
[04:56:50] ℹ️    - Diagnosis 4: 'E83.39'
[04:56:50] ℹ️    - Diagnosis 5: 'E87.6'
[04:56:50] ℹ️    - Diagnosis 6: 'I11.0'
[04:56:50] ℹ️  Final extracted MRN: '100022892564'
[04:56:50] ℹ️  Final extracted Sex: 'MALE'
[04:56:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:56:50] ℹ️  Final extracted Payer Source: 'Medicare'
[04:56:50] ✅ Patient data extraction completed successfully
[04:56:50] ✅    ✅ Patient data extracted successfully
[04:56:50] 📊 Patient Response
     └─ patientFName: Carl
     └─ patientLName: Weisman
     └─ dob: 02/05/1961
     └─ patientSex: MALE
     └─ medicalRecordNo: 100022892564
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (774) 992-7668
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'E10.65', 'secondDiagnosis': 'G92.8', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'E83.39', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'I11.0'}]
[04:56:50] ✅    ✅ Patient identified: Carl Weisman
[04:56:50] ✅    ✅ Patient name validation passed
[04:56:50] 🔄 
🔄 Step 3: Processing patient dates...
[04:56:50] [DOC: 9247895] ℹ️  DOB normalized: 02/05/1961
[04:56:50] [DOC: 9247895] ℹ️  Episode startOfCare normalized: 10/20/2023
[04:56:50] [DOC: 9247895] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[04:56:50] [DOC: 9247895] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[04:56:50] [DOC: 9247895] ✅ Patient date processing completed successfully
[04:56:50] ✅    ✅ Date processing completed
[04:56:50] 📊 Processed Patient Data
     └─ patientFName: Carl
     └─ patientLName: Weisman
     └─ dob: 02/05/1961
     └─ patientSex: MALE
     └─ medicalRecordNo: 100022892564
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (774) 992-7668
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'E10.65', 'secondDiagnosis': 'G92.8', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'E83.39', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'I11.0'}]
[04:56:50] 🔄 
🔄 Step 4: Extracting order data...
[04:56:52] ℹ️  Order extraction - MRN: '100022892564'
[04:56:52] ℹ️  Order extraction - Sex: 'MALE'
[04:56:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:56:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:56:52] ✅ Order data extraction completed successfully
[04:56:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:56:52] ℹ️  Using MRN from patient data: '100022892564' over '100022892564'
[04:56:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:56:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:56:52] ✅ Patient name cross-validation successful
[04:56:52] ✅    ✅ Data merged successfully
[04:56:54] ✅    ✅ Order data extracted and validated
[04:56:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:56:54] [DOC: 9247895] ✅ Patient found in local cache: Carl Weisman, ID: 66077570-f7f5-4f5e-b9df-6a7deaa8b8c6
[04:56:54] ✅    ✅ Existing patient found with ID: 66077570-f7f5-4f5e-b9df-6a7deaa8b8c6
[04:56:54] 🔄 
🔄 Step 6: Pushing order to API...
[04:56:54] [DOC: 9247895] ℹ️  Pushing order via API for patient ID: 66077570-f7f5-4f5e-b9df-6a7deaa8b8c6
[04:56:57] [DOC: 9247895] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14421"}
[04:56:57] ❌    ❌ Failed to push order
[04:56:57] 🔄 
🔄 Step 7: Writing to CSV...
[04:56:57] [DOC: 9247895] ℹ️  Calculated age: 64 from DOB: 02/05/1961
[04:56:57] [DOC: 9247895] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:56:57] [DOC: 9247895] ℹ️  Payer Source extracted: 'Medicare'
[04:56:57] [DOC: 9247895] ℹ️  Diagnosis codes being written:
[04:56:57] [DOC: 9247895] ℹ️    - Latest_Episode_Firstdiagnosis: 'E10.65'
[04:56:57] [DOC: 9247895] ℹ️    - Latest_Episode_Seconddiagnosis: 'G92.8'
[04:56:57] [DOC: 9247895] ℹ️    - Latest_Episode_Thirddiagnosis: 'N17.9'
[04:56:57] [DOC: 9247895] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E83.39'
[04:56:57] [DOC: 9247895] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E87.6'
[04:56:57] [DOC: 9247895] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[04:56:57] [DOC: 9247895] ✅ Patient data written to CSV: Carl Weisman | Sex: MALE | Age: 64 | Service: Skilled Nursing | Payer: Medicare | MRN: 100022892564
[04:56:57] ✅    ✅ Document 9247895 processed and saved successfully
[04:56:57] 🔄 
🔄 Step 8: Saving API details...
[04:56:57] [DOC: 9247895] ℹ️  API push details saved for document 9247895
[04:56:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247875                         ║
================================================================================
[04:56:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:56:57] ℹ️  Date: 04/18/2025
[04:56:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:57:01] [DOC: 9247875] ✅ Text extracted using pdfplumber (11307 chars)
[04:57:01] ✅    ✅ Text extracted using pdfplumber (11307 chars)
[04:57:01] 🔄 
🔄 Step 2: Extracting patient data...
[04:57:04] ℹ️  AI extracted raw sex value: 'M'
[04:57:04] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[04:57:04] ℹ️  AI extracted payer source: 'Medicare'
[04:57:04] ℹ️  AI extracted diagnoses:
[04:57:04] ℹ️    - Diagnosis 1: 'J18.9'
[04:57:04] ℹ️    - Diagnosis 2: 'I71.21'
[04:57:04] ℹ️    - Diagnosis 3: 'I11.0'
[04:57:04] ℹ️    - Diagnosis 4: 'I21.4'
[04:57:04] ℹ️    - Diagnosis 5: 'I50.32'
[04:57:04] ℹ️    - Diagnosis 6: 'E11.9'
[04:57:04] ℹ️  Final extracted MRN: 'MA221128094306'
[04:57:04] ℹ️  Final extracted Sex: 'MALE'
[04:57:04] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[04:57:04] ℹ️  Final extracted Payer Source: 'Medicare'
[04:57:04] ✅ Patient data extraction completed successfully
[04:57:04] ✅    ✅ Patient data extracted successfully
[04:57:04] 📊 Patient Response
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 26 Kearsarge St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (774) 206-1040
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'I71.21', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I21.4', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.9'}]
[04:57:04] ✅    ✅ Patient identified: Vicente Amaro
[04:57:04] ✅    ✅ Patient name validation passed
[04:57:04] 🔄 
🔄 Step 3: Processing patient dates...
[04:57:04] [DOC: 9247875] ℹ️  DOB normalized: 09/09/1943
[04:57:04] [DOC: 9247875] ℹ️  Episode startOfCare normalized: 04/09/2025
[04:57:04] [DOC: 9247875] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[04:57:04] [DOC: 9247875] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[04:57:04] [DOC: 9247875] ✅ Patient date processing completed successfully
[04:57:04] ✅    ✅ Date processing completed
[04:57:04] 📊 Processed Patient Data
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 26 Kearsarge St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (774) 206-1040
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'I71.21', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I21.4', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.9'}]
[04:57:04] 🔄 
🔄 Step 4: Extracting order data...
[04:57:07] ℹ️  Order extraction - MRN: 'MA221128094306'
[04:57:07] ℹ️  Order extraction - Sex: 'MALE'
[04:57:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[04:57:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:57:07] ✅ Order data extraction completed successfully
[04:57:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:57:07] ℹ️  Using MRN from patient data: 'MA221128094306' over 'MA221128094306'
[04:57:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[04:57:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:57:07] ✅ Patient name cross-validation successful
[04:57:07] ✅    ✅ Data merged successfully
[04:57:08] ✅    ✅ Order data extracted and validated
[04:57:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:57:08] [DOC: 9247875] ✅ Patient found in local cache: Vicente Amaro, ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[04:57:08] ✅    ✅ Existing patient found with ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[04:57:08] 🔄 
🔄 Step 6: Pushing order to API...
[04:57:08] [DOC: 9247875] ℹ️  Pushing order via API for patient ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[04:57:10] [DOC: 9247875] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12904"}
[04:57:10] ❌    ❌ Failed to push order
[04:57:10] 🔄 
🔄 Step 7: Writing to CSV...
[04:57:10] [DOC: 9247875] ℹ️  Calculated age: 81 from DOB: 09/09/1943
[04:57:10] [DOC: 9247875] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[04:57:10] [DOC: 9247875] ℹ️  Payer Source extracted: 'Medicare'
[04:57:10] [DOC: 9247875] ℹ️  Diagnosis codes being written:
[04:57:10] [DOC: 9247875] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[04:57:10] [DOC: 9247875] ℹ️    - Latest_Episode_Seconddiagnosis: 'I71.21'
[04:57:10] [DOC: 9247875] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[04:57:10] [DOC: 9247875] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I21.4'
[04:57:10] [DOC: 9247875] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[04:57:10] [DOC: 9247875] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[04:57:10] [DOC: 9247875] ✅ Patient data written to CSV: Vicente Amaro | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA221128094306
[04:57:10] ✅    ✅ Document 9247875 processed and saved successfully
[04:57:10] 🔄 
🔄 Step 8: Saving API details...
[04:57:10] [DOC: 9247875] ℹ️  API push details saved for document 9247875
[04:57:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247858                         ║
================================================================================
[04:57:10] ℹ️  Agency: Dartmouth HH
[04:57:10] ℹ️  Date: 04/18/2025
[04:57:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:57:12] [DOC: 9247858] ✅ Text extracted using pdfplumber (1079 chars)
[04:57:12] ✅    ✅ Text extracted using pdfplumber (1079 chars)
[04:57:12] 🔄 
🔄 Step 2: Extracting patient data...
[04:57:15] ℹ️  AI extracted raw sex value: 'F'
[04:57:15] ℹ️  AI extracted service line: 'Physical Therapy'
[04:57:15] ℹ️  AI extracted payer source: 'Medicare'
[04:57:15] ℹ️  AI extracted diagnoses:
[04:57:15] ℹ️    - Diagnosis 1: ''
[04:57:15] ℹ️    - Diagnosis 2: ''
[04:57:15] ℹ️    - Diagnosis 3: ''
[04:57:15] ℹ️    - Diagnosis 4: ''
[04:57:15] ℹ️    - Diagnosis 5: ''
[04:57:15] ℹ️    - Diagnosis 6: ''
[04:57:15] ℹ️  Final extracted MRN: '6267009'
[04:57:15] ℹ️  Final extracted Sex: 'FEMALE'
[04:57:15] ℹ️  Final extracted Service Line: 'Physical Therapy'
[04:57:15] ℹ️  Final extracted Payer Source: 'Medicare'
[04:57:15] ✅ Patient data extraction completed successfully
[04:57:15] ✅    ✅ Patient data extracted successfully
[04:57:15] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:57:15] ✅    ✅ Patient identified: Donna Finni
[04:57:15] ✅    ✅ Patient name validation passed
[04:57:15] 🔄 
🔄 Step 3: Processing patient dates...
[04:57:15] [DOC: 9247858] ℹ️  DOB normalized: 04/04/1955
[04:57:15] [DOC: 9247858] ℹ️  Episode startOfCare normalized: 03/19/2025
[04:57:15] [DOC: 9247858] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[04:57:15] [DOC: 9247858] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[04:57:15] [DOC: 9247858] ✅ Patient date processing completed successfully
[04:57:15] ✅    ✅ Date processing completed
[04:57:15] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:57:15] 🔄 
🔄 Step 4: Extracting order data...
[04:57:18] ℹ️  Order extraction - MRN: ''
[04:57:18] ℹ️  Order extraction - Sex: 'FEMALE'
[04:57:18] ℹ️  Order extraction - Service Line: 'PT'
[04:57:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:57:18] ✅ Order data extraction completed successfully
[04:57:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:57:18] ℹ️  Using MRN from patient data: '6267009'
[04:57:18] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[04:57:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:57:18] ✅ Patient name cross-validation successful
[04:57:18] ✅    ✅ Data merged successfully
[04:57:19] ✅    ✅ Order data extracted and validated
[04:57:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:57:55] [DOC: 9247858] ℹ️  Patient not found in cache or API: Donna Finni
[04:57:55] [DOC: 9247858] ℹ️  Patient not found, creating new patient via API...
[04:57:55] [DOC: 9247858] ℹ️  Creating patient via API: Donna Finni
[04:57:57] [DOC: 9247858] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:57:57] ❌    ❌ Failed to create patient
[04:57:57] [DOC: 9247858] ℹ️  API push details saved for document 9247858
================================================================================
║                        Processing Document ID: 9247822                         ║
================================================================================
[04:57:57] ℹ️  Agency: Dartmouth HH
[04:57:57] ℹ️  Date: 04/18/2025
[04:57:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:57:59] [DOC: 9247822] ✅ Text extracted using pdfplumber (2608 chars)
[04:57:59] ✅    ✅ Text extracted using pdfplumber (2608 chars)
[04:57:59] 🔄 
🔄 Step 2: Extracting patient data...
[04:58:01] ℹ️  AI extracted raw sex value: 'M'
[04:58:01] ℹ️  AI extracted service line: 'Physical Therapy'
[04:58:01] ℹ️  AI extracted payer source: 'Medicare'
[04:58:01] ℹ️  AI extracted diagnoses:
[04:58:01] ℹ️    - Diagnosis 1: 'None'
[04:58:01] ℹ️    - Diagnosis 2: 'None'
[04:58:01] ℹ️    - Diagnosis 3: 'None'
[04:58:01] ℹ️    - Diagnosis 4: 'None'
[04:58:01] ℹ️    - Diagnosis 5: 'None'
[04:58:01] ℹ️    - Diagnosis 6: 'None'
[04:58:01] ℹ️  Final extracted MRN: '5979015'
[04:58:01] ℹ️  Final extracted Sex: 'MALE'
[04:58:01] ℹ️  Final extracted Service Line: 'Physical Therapy'
[04:58:01] ℹ️  Final extracted Payer Source: 'Medicare'
[04:58:01] ✅ Patient data extraction completed successfully
[04:58:01] ✅    ✅ Patient data extracted successfully
[04:58:01] 📊 Patient Response
     └─ patientFName: Fernando
     └─ patientLName: Dasilva
     └─ dob: 09/07/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5979015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/27/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:58:01] ✅    ✅ Patient identified: Fernando Dasilva
[04:58:01] ✅    ✅ Patient name validation passed
[04:58:01] 🔄 
🔄 Step 3: Processing patient dates...
[04:58:01] [DOC: 9247822] ℹ️  DOB normalized: 09/07/1944
[04:58:01] [DOC: 9247822] ℹ️  Episode startOfCare normalized: 02/27/2025
[04:58:01] [DOC: 9247822] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[04:58:01] [DOC: 9247822] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[04:58:01] [DOC: 9247822] ✅ Patient date processing completed successfully
[04:58:01] ✅    ✅ Date processing completed
[04:58:01] 📊 Processed Patient Data
     └─ patientFName: Fernando
     └─ patientLName: Dasilva
     └─ dob: 09/07/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5979015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/27/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025'}]
[04:58:01] 🔄 
🔄 Step 4: Extracting order data...
[04:58:04] ℹ️  Order extraction - MRN: ''
[04:58:04] ℹ️  Order extraction - Sex: 'MALE'
[04:58:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[04:58:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:58:04] ✅ Order data extraction completed successfully
[04:58:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:58:04] ℹ️  Using MRN from patient data: '5979015'
[04:58:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[04:58:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:58:04] ✅ Patient name cross-validation successful
[04:58:04] ✅    ✅ Data merged successfully
[04:58:05] ✅    ✅ Order data extracted and validated
[04:58:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:58:45] [DOC: 9247822] ℹ️  Patient not found in cache or API: Fernando Dasilva
[04:58:45] [DOC: 9247822] ℹ️  Patient not found, creating new patient via API...
[04:58:45] [DOC: 9247822] ℹ️  Creating patient via API: Fernando Dasilva
[04:58:47] [DOC: 9247822] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:58:47] ❌    ❌ Failed to create patient
[04:58:47] [DOC: 9247822] ℹ️  API push details saved for document 9247822
================================================================================
║                        Processing Document ID: 9247817                         ║
================================================================================
[04:58:47] ℹ️  Agency: Dartmouth HH
[04:58:47] ℹ️  Date: 04/18/2025
[04:58:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:58:53] [DOC: 9247817] ✅ Text extracted using pdfplumber (12307 chars)
[04:58:53] ✅    ✅ Text extracted using pdfplumber (12295 chars)
[04:58:53] 🔄 
🔄 Step 2: Extracting patient data...
[04:58:57] ℹ️  AI extracted raw sex value: 'F'
[04:58:57] ℹ️  AI extracted service line: 'PT, RN'
[04:58:57] ℹ️  AI extracted payer source: 'None'
[04:58:57] ℹ️  AI extracted diagnoses:
[04:58:57] ℹ️    - Diagnosis 1: 'M25.851'
[04:58:57] ℹ️    - Diagnosis 2: 'M25.551'
[04:58:57] ℹ️    - Diagnosis 3: 'M79.7'
[04:58:57] ℹ️    - Diagnosis 4: 'G90.09'
[04:58:57] ℹ️    - Diagnosis 5: 'M81.0'
[04:58:57] ℹ️    - Diagnosis 6: 'M54.16'
[04:58:57] ℹ️  Final extracted MRN: '227027'
[04:58:57] ℹ️  Final extracted Sex: 'FEMALE'
[04:58:57] ℹ️  Final extracted Service Line: 'PT, RN'
[04:58:57] ℹ️  Final extracted Payer Source: ''
[04:58:57] ✅ Patient data extraction completed successfully
[04:58:57] ✅    ✅ Patient data extracted successfully
[04:58:57] 📊 Patient Response
     └─ patientFName: Agrella
     └─ patientLName: Annette
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'M25.851', 'secondDiagnosis': 'M25.551', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': 'G90.09', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'M54.16'}]
[04:58:57] ✅    ✅ Patient identified: Agrella Annette
[04:58:57] ✅    ✅ Patient name validation passed
[04:58:57] 🔄 
🔄 Step 3: Processing patient dates...
[04:58:57] [DOC: 9247817] ℹ️  DOB normalized: 03/01/1959
[04:58:57] [DOC: 9247817] ℹ️  Episode startOfCare normalized: 03/26/2025
[04:58:57] [DOC: 9247817] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:58:57] [DOC: 9247817] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:58:57] [DOC: 9247817] ✅ Patient date processing completed successfully
[04:58:57] ✅    ✅ Date processing completed
[04:58:57] 📊 Processed Patient Data
     └─ patientFName: Agrella
     └─ patientLName: Annette
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'M25.851', 'secondDiagnosis': 'M25.551', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': 'G90.09', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'M54.16'}]
[04:58:57] 🔄 
🔄 Step 4: Extracting order data...
[04:58:59] ℹ️  Order extraction - MRN: '227027'
[04:58:59] ℹ️  Order extraction - Sex: 'FEMALE'
[04:58:59] ℹ️  Order extraction - Service Line: 'PT, RN'
[04:58:59] ℹ️  Order extraction - Payer Source: ''
[04:58:59] ✅ Order data extraction completed successfully
[04:58:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:58:59] ℹ️  Using MRN from patient data: '227027' over '227027'
[04:58:59] ℹ️  Service line consistent in both sources: 'PT, RN'
[04:58:59] ✅ Patient name cross-validation successful
[04:58:59] ✅    ✅ Data merged successfully
[04:59:01] ✅    ✅ Order data extracted and validated
[04:59:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:59:42] [DOC: 9247817] ℹ️  Patient not found in cache or API: Agrella Annette
[04:59:42] [DOC: 9247817] ℹ️  Patient not found, creating new patient via API...
[04:59:42] [DOC: 9247817] ℹ️  Creating patient via API: Agrella Annette
[04:59:44] [DOC: 9247817] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:59:44] ❌    ❌ Failed to create patient
[04:59:44] [DOC: 9247817] ℹ️  API push details saved for document 9247817
================================================================================
║                        Processing Document ID: 9247800                         ║
================================================================================
[04:59:44] ℹ️  Agency: Nizhoni Health-Fall River
[04:59:44] ℹ️  Date: 04/18/2025
[04:59:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:59:52] [DOC: 9247800] ✅ Text extracted using pdfplumber (1476 chars)
[04:59:52] ✅    ✅ Text extracted using pdfplumber (1476 chars)
[04:59:52] 🔄 
🔄 Step 2: Extracting patient data...
[04:59:55] ℹ️  AI extracted raw sex value: 'M'
[04:59:55] ℹ️  AI extracted service line: 'HHA'
[04:59:55] ℹ️  AI extracted payer source: 'Medicaid/MA'
[04:59:55] ℹ️  AI extracted diagnoses:
[04:59:55] ℹ️    - Diagnosis 1: 'None'
[04:59:55] ℹ️    - Diagnosis 2: 'None'
[04:59:55] ℹ️    - Diagnosis 3: 'None'
[04:59:55] ℹ️    - Diagnosis 4: 'None'
[04:59:55] ℹ️    - Diagnosis 5: 'None'
[04:59:55] ℹ️    - Diagnosis 6: 'None'
[04:59:55] ℹ️  Final extracted MRN: '3934020'
[04:59:55] ℹ️  Final extracted Sex: 'MALE'
[04:59:55] ℹ️  Final extracted Service Line: 'HHA'
[04:59:55] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[04:59:55] ✅ Patient data extraction completed successfully
[04:59:55] ✅    ✅ Patient data extracted successfully
[04:59:55] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Maker
     └─ dob: 03/26/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 3934020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 12 Ruth Street Apt 403
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2023', 'startOfEpisode': None, 'endOfEpisode': '05/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:59:55] ✅    ✅ Patient identified: Robert Maker
[04:59:55] ✅    ✅ Patient name validation passed
[04:59:55] 🔄 
🔄 Step 3: Processing patient dates...
[04:59:55] [DOC: 9247800] ℹ️  DOB normalized: 03/26/1951
[04:59:55] [DOC: 9247800] ℹ️  Episode startOfCare normalized: 01/18/2023
[04:59:55] [DOC: 9247800] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[04:59:55] [DOC: 9247800] ✅ Patient date processing completed successfully
[04:59:55] ✅    ✅ Date processing completed
[04:59:55] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Maker
     └─ dob: 03/26/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 3934020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 12 Ruth Street Apt 403
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2023', 'endOfEpisode': '05/06/2025'}]
[04:59:55] 🔄 
🔄 Step 4: Extracting order data...
[04:59:58] ℹ️  Order extraction - MRN: '3934020'
[04:59:58] ℹ️  Order extraction - Sex: 'MALE'
[04:59:58] ℹ️  Order extraction - Service Line: 'RN'
[04:59:58] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[04:59:58] ✅ Order data extraction completed successfully
[04:59:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:59:58] ℹ️  Using MRN from patient data: '3934020' over '3934020'
[04:59:58] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[04:59:58] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[04:59:58] ✅ Patient name cross-validation successful
[04:59:58] ✅    ✅ Data merged successfully
[04:59:59] ✅    ✅ Order data extracted and validated
[04:59:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:00:49] [DOC: 9247800] ℹ️  Patient not found in cache or API: Robert Maker
[05:00:49] [DOC: 9247800] ℹ️  Patient not found, creating new patient via API...
[05:00:49] [DOC: 9247800] ℹ️  Creating patient via API: Robert Maker
[05:00:50] [DOC: 9247800] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:00:50] ❌    ❌ Failed to create patient
[05:00:50] [DOC: 9247800] ℹ️  API push details saved for document 9247800
================================================================================
║                        Processing Document ID: 9247794                         ║
================================================================================
[05:00:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:00:50] ℹ️  Date: 04/18/2025
[05:00:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:01:02] [DOC: 9247794] ✅ Text extracted using pdfplumber (5502 chars)
[05:01:02] ✅    ✅ Text extracted using pdfplumber (5502 chars)
[05:01:02] 🔄 
🔄 Step 2: Extracting patient data...
[05:01:05] ℹ️  AI extracted raw sex value: ''
[05:01:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:01:05] ℹ️  AI extracted payer source: ''
[05:01:05] ℹ️  AI extracted diagnoses:
[05:01:05] ℹ️    - Diagnosis 1: 'K25.9'
[05:01:05] ℹ️    - Diagnosis 2: 'D50.0'
[05:01:05] ℹ️    - Diagnosis 3: 'K50.90'
[05:01:05] ℹ️    - Diagnosis 4: 'None'
[05:01:05] ℹ️    - Diagnosis 5: 'None'
[05:01:05] ℹ️    - Diagnosis 6: 'None'
[05:01:05] ℹ️  Final extracted MRN: 'MA250328114901'
[05:01:05] ℹ️  Final extracted Sex: ''
[05:01:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:01:05] ℹ️  Final extracted Payer Source: ''
[05:01:05] ✅ Patient data extraction completed successfully
[05:01:05] ✅    ✅ Patient data extracted successfully
[05:01:05] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:01:05] ✅    ✅ Patient identified: Shirley Tavares
[05:01:05] ✅    ✅ Patient name validation passed
[05:01:05] 🔄 
🔄 Step 3: Processing patient dates...
[05:01:05] [DOC: 9247794] ℹ️  DOB normalized: 11/10/1949
[05:01:05] [DOC: 9247794] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[05:01:05] [DOC: 9247794] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[05:01:05] [DOC: 9247794] ✅ Patient date processing completed successfully
[05:01:05] ✅    ✅ Date processing completed
[05:01:05] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90'}]
[05:01:05] 🔄 
🔄 Step 4: Extracting order data...
[05:01:08] ℹ️  Order extraction - MRN: 'MA250328114901'
[05:01:08] ℹ️  Order extraction - Sex: ''
[05:01:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:01:08] ℹ️  Order extraction - Payer Source: ''
[05:01:08] ✅ Order data extraction completed successfully
[05:01:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:01:08] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[05:01:08] ⚠️  Could not determine sex using any available method
[05:01:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:01:08] ✅ Patient name cross-validation successful
[05:01:08] ✅    ✅ Data merged successfully
[05:01:09] ✅    ✅ Order data extracted and validated
[05:01:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:01:09] [DOC: 9247794] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[05:01:09] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[05:01:09] 🔄 
🔄 Step 6: Pushing order to API...
[05:01:09] [DOC: 9247794] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[05:01:10] [DOC: 9247794] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14232"}
[05:01:10] ❌    ❌ Failed to push order
[05:01:10] 🔄 
🔄 Step 7: Writing to CSV...
[05:01:10] [DOC: 9247794] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[05:01:10] [DOC: 9247794] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:01:10] [DOC: 9247794] ℹ️  Payer Source extracted: ''
[05:01:10] [DOC: 9247794] ℹ️  Diagnosis codes being written:
[05:01:10] [DOC: 9247794] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[05:01:10] [DOC: 9247794] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[05:01:10] [DOC: 9247794] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[05:01:10] [DOC: 9247794] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:01:10] [DOC: 9247794] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:01:10] [DOC: 9247794] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:01:10] [DOC: 9247794] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Skilled Nursing | Payer:  | MRN: MA250328114901
[05:01:10] ✅    ✅ Document 9247794 processed and saved successfully
[05:01:10] 🔄 
🔄 Step 8: Saving API details...
[05:01:10] [DOC: 9247794] ℹ️  API push details saved for document 9247794
[05:01:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247790                         ║
================================================================================
[05:01:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:01:10] ℹ️  Date: 04/18/2025
[05:01:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:01:15] [DOC: 9247790] ✅ Text extracted using pdfplumber (2451 chars)
[05:01:15] ✅    ✅ Text extracted using pdfplumber (2439 chars)
[05:01:15] 🔄 
🔄 Step 2: Extracting patient data...
[05:01:18] ℹ️  AI extracted raw sex value: ''
[05:01:18] ℹ️  AI extracted service line: 'Physical Therapy'
[05:01:18] ℹ️  AI extracted payer source: ''
[05:01:18] ℹ️  AI extracted diagnoses:
[05:01:18] ℹ️    - Diagnosis 1: 'I12.9'
[05:01:18] ℹ️    - Diagnosis 2: 'N17.9'
[05:01:18] ℹ️    - Diagnosis 3: 'G35'
[05:01:18] ℹ️    - Diagnosis 4: 'None'
[05:01:18] ℹ️    - Diagnosis 5: 'None'
[05:01:18] ℹ️    - Diagnosis 6: 'None'
[05:01:18] ℹ️  Final extracted MRN: 'MA210203125202'
[05:01:18] ℹ️  Final extracted Sex: ''
[05:01:18] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:01:18] ℹ️  Final extracted Payer Source: ''
[05:01:18] ✅ Patient data extraction completed successfully
[05:01:18] ✅    ✅ Patient data extracted successfully
[05:01:18] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:01:18] ✅    ✅ Patient identified: Ida Souza
[05:01:18] ✅    ✅ Patient name validation passed
[05:01:18] 🔄 
🔄 Step 3: Processing patient dates...
[05:01:18] [DOC: 9247790] ℹ️  DOB normalized: 12/11/1952
[05:01:18] [DOC: 9247790] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[05:01:18] [DOC: 9247790] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[05:01:18] [DOC: 9247790] ✅ Patient date processing completed successfully
[05:01:18] ✅    ✅ Date processing completed
[05:01:18] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'G35'}]
[05:01:18] 🔄 
🔄 Step 4: Extracting order data...
[05:01:20] ℹ️  Order extraction - MRN: 'MA210203125202'
[05:01:20] ℹ️  Order extraction - Sex: ''
[05:01:20] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:01:20] ℹ️  Order extraction - Payer Source: ''
[05:01:20] ✅ Order data extraction completed successfully
[05:01:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:01:20] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[05:01:20] ⚠️  Could not determine sex using any available method
[05:01:20] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:01:20] ✅ Patient name cross-validation successful
[05:01:20] ✅    ✅ Data merged successfully
[05:01:22] ✅    ✅ Order data extracted and validated
[05:01:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:02:17] [DOC: 9247790] ℹ️  Patient not found in cache or API: Ida Souza
[05:02:17] [DOC: 9247790] ℹ️  Patient not found, creating new patient via API...
[05:02:17] [DOC: 9247790] ℹ️  Creating patient via API: Ida Souza
[05:02:19] [DOC: 9247790] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:02:19] ❌    ❌ Failed to create patient
[05:02:19] [DOC: 9247790] ℹ️  API push details saved for document 9247790
================================================================================
║                        Processing Document ID: 9247788                         ║
================================================================================
[05:02:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:02:19] ℹ️  Date: 04/18/2025
[05:02:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:02:29] [DOC: 9247788] ✅ Text extracted using pdfplumber (18137 chars)
[05:02:29] ✅    ✅ Text extracted using pdfplumber (18137 chars)
[05:02:29] 🔄 
🔄 Step 2: Extracting patient data...
[05:02:32] ℹ️  AI extracted raw sex value: 'F'
[05:02:32] ℹ️  AI extracted service line: 'PT'
[05:02:32] ℹ️  AI extracted payer source: ''
[05:02:32] ℹ️  AI extracted diagnoses:
[05:02:32] ℹ️    - Diagnosis 1: 'Hypertensive chronic kidney disease w stg 1-4'
[05:02:32] ℹ️    - Diagnosis 2: 'unsp chr kdny'
[05:02:32] ℹ️    - Diagnosis 3: 'Muscle weakness'
[05:02:32] ℹ️    - Diagnosis 4: 'Left leg osteomyelitis'
[05:02:32] ℹ️    - Diagnosis 5: 'Left leg ulcers'
[05:02:32] ℹ️    - Diagnosis 6: 'HTN'
[05:02:32] ℹ️  Final extracted MRN: 'MA210203125202'
[05:02:32] ℹ️  Final extracted Sex: 'FEMALE'
[05:02:32] ℹ️  Final extracted Service Line: 'PT'
[05:02:32] ℹ️  Final extracted Payer Source: ''
[05:02:32] ✅ Patient data extraction completed successfully
[05:02:32] ✅    ✅ Patient data extracted successfully
[05:02:32] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/07/2025', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'Hypertensive chronic kidney disease w stg 1-4', 'secondDiagnosis': 'unsp chr kdny', 'thirdDiagnosis': 'Muscle weakness', 'fourthDiagnosis': 'Left leg osteomyelitis', 'fifthDiagnosis': 'Left leg ulcers', 'sixthDiagnosis': 'HTN'}]
[05:02:32] ✅    ✅ Patient identified: Ida Souza
[05:02:32] ✅    ✅ Patient name validation passed
[05:02:32] 🔄 
🔄 Step 3: Processing patient dates...
[05:02:32] [DOC: 9247788] ℹ️  DOB normalized: 12/11/1952
[05:02:32] [DOC: 9247788] ℹ️  Episode startOfCare normalized: 01/07/2025
[05:02:32] [DOC: 9247788] ℹ️  Episode startOfEpisode normalized: 01/07/2025
[05:02:32] [DOC: 9247788] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[05:02:32] [DOC: 9247788] ✅ Patient date processing completed successfully
[05:02:32] ✅    ✅ Date processing completed
[05:02:32] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/07/2025', 'startOfEpisode': '01/07/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'Hypertensive chronic kidney disease w stg 1-4', 'secondDiagnosis': 'unsp chr kdny', 'thirdDiagnosis': 'Muscle weakness', 'fourthDiagnosis': 'Left leg osteomyelitis', 'fifthDiagnosis': 'Left leg ulcers', 'sixthDiagnosis': 'HTN'}]
[05:02:32] 🔄 
🔄 Step 4: Extracting order data...
[05:02:35] ℹ️  Order extraction - MRN: 'MA210203125202'
[05:02:35] ℹ️  Order extraction - Sex: 'FEMALE'
[05:02:35] ℹ️  Order extraction - Service Line: 'PT'
[05:02:35] ℹ️  Order extraction - Payer Source: ''
[05:02:35] ✅ Order data extraction completed successfully
[05:02:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:02:35] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[05:02:35] ℹ️  Service line consistent in both sources: 'PT'
[05:02:35] ✅ Patient name cross-validation successful
[05:02:35] ✅    ✅ Data merged successfully
[05:02:37] ✅    ✅ Order data extracted and validated
[05:02:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:04:18] [DOC: 9247788] ℹ️  Patient not found in cache or API: Ida Souza
[05:04:18] [DOC: 9247788] ℹ️  Patient not found, creating new patient via API...
[05:04:18] [DOC: 9247788] ℹ️  Creating patient via API: Ida Souza
[05:04:20] [DOC: 9247788] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:04:20] ❌    ❌ Failed to create patient
[05:04:20] [DOC: 9247788] ℹ️  API push details saved for document 9247788
================================================================================
║                        Processing Document ID: 9247785                         ║
================================================================================
[05:04:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:04:20] ℹ️  Date: 04/18/2025
[05:04:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:04:28] [DOC: 9247785] ✅ Text extracted using pdfplumber (8413 chars)
[05:04:28] ✅    ✅ Text extracted using pdfplumber (8413 chars)
[05:04:28] 🔄 
🔄 Step 2: Extracting patient data...
[05:04:31] ℹ️  AI extracted raw sex value: 'F'
[05:04:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:04:31] ℹ️  AI extracted payer source: 'Medicare'
[05:04:31] ℹ️  AI extracted diagnoses:
[05:04:31] ℹ️    - Diagnosis 1: 'E11.9'
[05:04:31] ℹ️    - Diagnosis 2: 'B02.29'
[05:04:31] ℹ️    - Diagnosis 3: 'I48.91'
[05:04:31] ℹ️    - Diagnosis 4: 'I31.39'
[05:04:31] ℹ️    - Diagnosis 5: 'I50.32'
[05:04:31] ℹ️    - Diagnosis 6: 'I10'
[05:04:31] ℹ️  Final extracted MRN: 'MA250211072502'
[05:04:31] ℹ️  Final extracted Sex: 'FEMALE'
[05:04:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:04:31] ℹ️  Final extracted Payer Source: 'Medicare'
[05:04:31] ✅ Patient data extraction completed successfully
[05:04:31] ✅    ✅ Patient data extracted successfully
[05:04:31] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Spencer
     └─ dob: 07/10/1925
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250211072502
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 231 Middle St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 990-3724
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/11/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'B02.29', 'thirdDiagnosis': 'I48.91', 'fourthDiagnosis': 'I31.39', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'I10'}]
[05:04:31] ✅    ✅ Patient identified: Maria Spencer
[05:04:31] ✅    ✅ Patient name validation passed
[05:04:31] 🔄 
🔄 Step 3: Processing patient dates...
[05:04:31] [DOC: 9247785] ℹ️  DOB normalized: 07/10/1925
[05:04:31] [DOC: 9247785] ℹ️  Episode startOfCare normalized: 02/11/2025
[05:04:31] [DOC: 9247785] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[05:04:31] [DOC: 9247785] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[05:04:31] [DOC: 9247785] ✅ Patient date processing completed successfully
[05:04:31] ✅    ✅ Date processing completed
[05:04:31] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Spencer
     └─ dob: 07/10/1925
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250211072502
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 231 Middle St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 990-3724
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/11/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'B02.29', 'thirdDiagnosis': 'I48.91', 'fourthDiagnosis': 'I31.39', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'I10'}]
[05:04:31] 🔄 
🔄 Step 4: Extracting order data...
[05:04:34] ℹ️  Order extraction - MRN: 'MA250211072502'
[05:04:34] ℹ️  Order extraction - Sex: 'FEMALE'
[05:04:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:04:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:04:34] ✅ Order data extraction completed successfully
[05:04:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:04:34] ℹ️  Using MRN from patient data: 'MA250211072502' over 'MA250211072502'
[05:04:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:04:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:04:34] ✅ Patient name cross-validation successful
[05:04:34] ✅    ✅ Data merged successfully
[05:04:35] ✅    ✅ Order data extracted and validated
[05:04:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:06:18] [DOC: 9247785] ✅ Patient exists in API: Maria Spencer, ID: e8205f4c-5660-441d-b536-37d0ba1b7f54
[05:06:18] ✅    ✅ Existing patient found with ID: e8205f4c-5660-441d-b536-37d0ba1b7f54
[05:06:18] 🔄 
🔄 Step 6: Pushing order to API...
[05:06:18] [DOC: 9247785] ℹ️  Pushing order via API for patient ID: e8205f4c-5660-441d-b536-37d0ba1b7f54
[05:06:20] [DOC: 9247785] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14217"}
[05:06:20] ❌    ❌ Failed to push order
[05:06:20] 🔄 
🔄 Step 7: Writing to CSV...
[05:06:20] [DOC: 9247785] ℹ️  Calculated age: 99 from DOB: 07/10/1925
[05:06:20] [DOC: 9247785] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:06:20] [DOC: 9247785] ℹ️  Payer Source extracted: 'Medicare'
[05:06:20] [DOC: 9247785] ℹ️  Diagnosis codes being written:
[05:06:20] [DOC: 9247785] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[05:06:20] [DOC: 9247785] ℹ️    - Latest_Episode_Seconddiagnosis: 'B02.29'
[05:06:20] [DOC: 9247785] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.91'
[05:06:20] [DOC: 9247785] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I31.39'
[05:06:20] [DOC: 9247785] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[05:06:20] [DOC: 9247785] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[05:06:20] [DOC: 9247785] ✅ Patient data written to CSV: Maria Spencer | Sex: FEMALE | Age: 99 | Service: Skilled Nursing | Payer: Medicare | MRN: MA250211072502
[05:06:20] ✅    ✅ Document 9247785 processed and saved successfully
[05:06:20] 🔄 
🔄 Step 8: Saving API details...
[05:06:20] [DOC: 9247785] ℹ️  API push details saved for document 9247785
[05:06:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247780                         ║
================================================================================
[05:06:20] ℹ️  Agency: Nizhoni Health-Fall River
[05:06:20] ℹ️  Date: 04/18/2025
[05:06:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:06:40] [DOC: 9247780] ✅ Text extracted using pdfplumber (1017 chars)
[05:06:40] ✅    ✅ Text extracted using pdfplumber (1017 chars)
[05:06:40] 🔄 
🔄 Step 2: Extracting patient data...
[05:06:43] ℹ️  AI extracted raw sex value: 'F'
[05:06:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:06:43] ℹ️  AI extracted payer source: 'Medicaid/MA'
[05:06:43] ℹ️  AI extracted diagnoses:
[05:06:43] ℹ️    - Diagnosis 1: ''
[05:06:43] ℹ️    - Diagnosis 2: ''
[05:06:43] ℹ️    - Diagnosis 3: ''
[05:06:43] ℹ️    - Diagnosis 4: ''
[05:06:43] ℹ️    - Diagnosis 5: ''
[05:06:43] ℹ️    - Diagnosis 6: ''
[05:06:43] ℹ️  Final extracted MRN: '3761020'
[05:06:43] ℹ️  Final extracted Sex: 'FEMALE'
[05:06:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:06:43] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[05:06:43] ✅ Patient data extraction completed successfully
[05:06:43] ✅    ✅ Patient data extracted successfully
[05:06:43] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:43] ✅    ✅ Patient identified: Carol Jimon-Ajqui
[05:06:43] ✅    ✅ Patient name validation passed
[05:06:43] 🔄 
🔄 Step 3: Processing patient dates...
[05:06:43] [DOC: 9247780] ℹ️  DOB normalized: 08/23/1974
[05:06:43] [DOC: 9247780] ℹ️  Episode startOfCare normalized: 01/04/2023
[05:06:43] [DOC: 9247780] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[05:06:43] [DOC: 9247780] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[05:06:43] [DOC: 9247780] ✅ Patient date processing completed successfully
[05:06:43] ✅    ✅ Date processing completed
[05:06:43] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:43] 🔄 
🔄 Step 4: Extracting order data...
[05:06:45] ℹ️  Order extraction - MRN: '3761020'
[05:06:45] ℹ️  Order extraction - Sex: 'FEMALE'
[05:06:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:06:45] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[05:06:45] ✅ Order data extraction completed successfully
[05:06:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:06:45] ℹ️  Using MRN from patient data: '3761020' over '3761020'
[05:06:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:06:45] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[05:06:45] ✅ Patient name cross-validation successful
[05:06:45] ✅    ✅ Data merged successfully
[05:06:46] ✅    ✅ Order data extracted and validated
[05:06:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:07:57] [DOC: 9247780] ℹ️  Patient not found in cache or API: Carol Jimon-Ajqui
[05:07:57] [DOC: 9247780] ℹ️  Patient not found, creating new patient via API...
[05:07:57] [DOC: 9247780] ℹ️  Creating patient via API: Carol Jimon-Ajqui
[05:07:58] [DOC: 9247780] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:07:58] ❌    ❌ Failed to create patient
[05:07:58] [DOC: 9247780] ℹ️  API push details saved for document 9247780
================================================================================
║                        Processing Document ID: 9247778                         ║
================================================================================
[05:07:58] ℹ️  Agency: Dartmouth HH
[05:07:58] ℹ️  Date: 04/18/2025
[05:07:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:08:04] [DOC: 9247778] ✅ Text extracted using pdfplumber (13964 chars)
[05:08:04] ✅    ✅ Text extracted using pdfplumber (13964 chars)
[05:08:04] 🔄 
🔄 Step 2: Extracting patient data...
[05:08:07] ℹ️  AI extracted raw sex value: 'F'
[05:08:07] ℹ️  AI extracted service line: 'PT, RN'
[05:08:07] ℹ️  AI extracted payer source: ''
[05:08:07] ℹ️  AI extracted diagnoses:
[05:08:07] ℹ️    - Diagnosis 1: 'M17.0'
[05:08:07] ℹ️    - Diagnosis 2: 'M06.4'
[05:08:07] ℹ️    - Diagnosis 3: 'M25.551'
[05:08:07] ℹ️    - Diagnosis 4: 'M25.552'
[05:08:07] ℹ️    - Diagnosis 5: 'M54.50'
[05:08:07] ℹ️    - Diagnosis 6: 'F03.911'
[05:08:07] ℹ️  Final extracted MRN: '3140011'
[05:08:07] ℹ️  Final extracted Sex: 'FEMALE'
[05:08:07] ℹ️  Final extracted Service Line: 'PT, RN'
[05:08:07] ℹ️  Final extracted Payer Source: ''
[05:08:07] ✅ Patient data extraction completed successfully
[05:08:07] ✅    ✅ Patient data extracted successfully
[05:08:07] 📊 Patient Response
     └─ patientFName: Nicolet
     └─ patientLName: Tania A
     └─ dob: 11/01/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3140011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M17.0', 'secondDiagnosis': 'M06.4', 'thirdDiagnosis': 'M25.551', 'fourthDiagnosis': 'M25.552', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'F03.911'}]
[05:08:07] ✅    ✅ Patient identified: Nicolet Tania A
[05:08:07] ✅    ✅ Patient name validation passed
[05:08:07] 🔄 
🔄 Step 3: Processing patient dates...
[05:08:07] [DOC: 9247778] ℹ️  DOB normalized: 11/01/1929
[05:08:07] [DOC: 9247778] ℹ️  Episode startOfCare normalized: 04/15/2025
[05:08:07] [DOC: 9247778] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[05:08:07] [DOC: 9247778] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[05:08:07] [DOC: 9247778] ✅ Patient date processing completed successfully
[05:08:07] ✅    ✅ Date processing completed
[05:08:07] 📊 Processed Patient Data
     └─ patientFName: Nicolet
     └─ patientLName: Tania A
     └─ dob: 11/01/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3140011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M17.0', 'secondDiagnosis': 'M06.4', 'thirdDiagnosis': 'M25.551', 'fourthDiagnosis': 'M25.552', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'F03.911'}]
[05:08:07] 🔄 
🔄 Step 4: Extracting order data...
[05:08:09] ℹ️  Order extraction - MRN: '3140011'
[05:08:09] ℹ️  Order extraction - Sex: 'FEMALE'
[05:08:09] ℹ️  Order extraction - Service Line: 'PT, RN'
[05:08:09] ℹ️  Order extraction - Payer Source: ''
[05:08:09] ✅ Order data extraction completed successfully
[05:08:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:08:09] ℹ️  Using MRN from patient data: '3140011' over '3140011'
[05:08:09] ℹ️  Service line consistent in both sources: 'PT, RN'
[05:08:09] ✅ Patient name cross-validation successful
[05:08:09] ✅    ✅ Data merged successfully
[05:08:11] ✅    ✅ Order data extracted and validated
[05:08:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:02] [DOC: 9247778] ℹ️  Patient not found in cache or API: Nicolet Tania A
[05:09:02] [DOC: 9247778] ℹ️  Patient not found, creating new patient via API...
[05:09:02] [DOC: 9247778] ℹ️  Creating patient via API: Nicolet Tania A
[05:09:04] [DOC: 9247778] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:09:04] ❌    ❌ Failed to create patient
[05:09:04] [DOC: 9247778] ℹ️  API push details saved for document 9247778
================================================================================
║                        Processing Document ID: 9247773                         ║
================================================================================
[05:09:04] ℹ️  Agency: Dartmouth HH
[05:09:04] ℹ️  Date: 04/18/2025
[05:09:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:08] [DOC: 9247773] ✅ Text extracted using pdfplumber (1709 chars)
[05:09:08] ✅    ✅ Text extracted using pdfplumber (1709 chars)
[05:09:08] 🔄 
🔄 Step 2: Extracting patient data...
[05:09:11] ℹ️  AI extracted raw sex value: 'M'
[05:09:11] ℹ️  AI extracted service line: 'RN'
[05:09:11] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[05:09:11] ℹ️  AI extracted diagnoses:
[05:09:11] ℹ️    - Diagnosis 1: ''
[05:09:11] ℹ️    - Diagnosis 2: ''
[05:09:11] ℹ️    - Diagnosis 3: ''
[05:09:11] ℹ️    - Diagnosis 4: ''
[05:09:11] ℹ️    - Diagnosis 5: ''
[05:09:11] ℹ️    - Diagnosis 6: ''
[05:09:11] ℹ️  Final extracted MRN: '5019015'
[05:09:11] ℹ️  Final extracted Sex: 'MALE'
[05:09:11] ℹ️  Final extracted Service Line: 'RN'
[05:09:11] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[05:09:11] ✅ Patient data extraction completed successfully
[05:09:11] ✅    ✅ Patient data extracted successfully
[05:09:11] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:11] ✅    ✅ Patient identified: Phillip Sylvia
[05:09:11] ✅    ✅ Patient name validation passed
[05:09:11] 🔄 
🔄 Step 3: Processing patient dates...
[05:09:11] [DOC: 9247773] ℹ️  DOB normalized: 08/03/1944
[05:09:11] [DOC: 9247773] ℹ️  Episode startOfCare normalized: 04/02/2025
[05:09:11] [DOC: 9247773] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[05:09:11] [DOC: 9247773] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[05:09:11] [DOC: 9247773] ✅ Patient date processing completed successfully
[05:09:11] ✅    ✅ Date processing completed
[05:09:11] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:11] 🔄 
🔄 Step 4: Extracting order data...
[05:09:13] ℹ️  Order extraction - MRN: ''
[05:09:13] ℹ️  Order extraction - Sex: 'MALE'
[05:09:13] ℹ️  Order extraction - Service Line: 'RN'
[05:09:13] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[05:09:13] ✅ Order data extraction completed successfully
[05:09:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:13] ℹ️  Using MRN from patient data: '5019015'
[05:09:13] ℹ️  Service line consistent in both sources: 'RN'
[05:09:13] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[05:09:13] ✅ Patient name cross-validation successful
[05:09:13] ✅    ✅ Data merged successfully
[05:09:14] ✅    ✅ Order data extracted and validated
[05:09:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:14] [DOC: 9247773] ✅ Patient found in local cache: Phillip Sylvia, ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[05:09:14] ✅    ✅ Existing patient found with ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[05:09:14] 🔄 
🔄 Step 6: Pushing order to API...
[05:09:14] [DOC: 9247773] ℹ️  Pushing order via API for patient ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[05:09:15] [DOC: 9247773] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:09:15] ❌    ❌ Failed to push order
[05:09:15] 🔄 
🔄 Step 7: Writing to CSV...
[05:09:15] [DOC: 9247773] ℹ️  Calculated age: 80 from DOB: 08/03/1944
[05:09:15] [DOC: 9247773] ℹ️  Service Line extracted: 'RN'
[05:09:15] [DOC: 9247773] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[05:09:15] [DOC: 9247773] ℹ️  Diagnosis codes being written:
[05:09:15] [DOC: 9247773] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:09:15] [DOC: 9247773] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:09:15] [DOC: 9247773] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:09:15] [DOC: 9247773] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:09:15] [DOC: 9247773] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:09:15] [DOC: 9247773] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:09:15] [DOC: 9247773] ✅ Patient data written to CSV: Phillip Sylvia | Sex: MALE | Age: 80 | Service: RN | Payer: Aetna- Mcare | MRN: 5019015
[05:09:15] ✅    ✅ Document 9247773 processed and saved successfully
[05:09:15] 🔄 
🔄 Step 8: Saving API details...
[05:09:15] [DOC: 9247773] ℹ️  API push details saved for document 9247773
[05:09:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247771                         ║
================================================================================
[05:09:15] ℹ️  Agency: Dartmouth HH
[05:09:15] ℹ️  Date: 04/18/2025
[05:09:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:19] [DOC: 9247771] ✅ Text extracted using pdfplumber (1208 chars)
[05:09:19] ✅    ✅ Text extracted using pdfplumber (1208 chars)
[05:09:19] 🔄 
🔄 Step 2: Extracting patient data...
[05:09:21] ℹ️  AI extracted raw sex value: 'M'
[05:09:21] ℹ️  AI extracted service line: 'HHA'
[05:09:21] ℹ️  AI extracted payer source: 'Medicare'
[05:09:21] ℹ️  AI extracted diagnoses:
[05:09:21] ℹ️    - Diagnosis 1: ''
[05:09:21] ℹ️    - Diagnosis 2: ''
[05:09:21] ℹ️    - Diagnosis 3: ''
[05:09:21] ℹ️    - Diagnosis 4: ''
[05:09:21] ℹ️    - Diagnosis 5: ''
[05:09:21] ℹ️    - Diagnosis 6: ''
[05:09:21] ℹ️  Final extracted MRN: '842002'
[05:09:21] ℹ️  Final extracted Sex: 'MALE'
[05:09:21] ℹ️  Final extracted Service Line: 'HHA'
[05:09:21] ℹ️  Final extracted Payer Source: 'Medicare'
[05:09:21] ✅ Patient data extraction completed successfully
[05:09:21] ✅    ✅ Patient data extracted successfully
[05:09:21] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:21] ✅    ✅ Patient identified: Johannes Bjornson
[05:09:21] ✅    ✅ Patient name validation passed
[05:09:21] 🔄 
🔄 Step 3: Processing patient dates...
[05:09:21] [DOC: 9247771] ℹ️  DOB normalized: 02/09/1942
[05:09:21] [DOC: 9247771] ℹ️  Episode startOfCare normalized: 10/10/2024
[05:09:21] [DOC: 9247771] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:09:21] [DOC: 9247771] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:09:21] [DOC: 9247771] ✅ Patient date processing completed successfully
[05:09:21] ✅    ✅ Date processing completed
[05:09:21] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:21] 🔄 
🔄 Step 4: Extracting order data...
[05:09:24] ℹ️  Order extraction - MRN: ''
[05:09:24] ℹ️  Order extraction - Sex: 'MALE'
[05:09:24] ℹ️  Order extraction - Service Line: ''
[05:09:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:09:24] ✅ Order data extraction completed successfully
[05:09:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:24] ℹ️  Using MRN from patient data: '842002'
[05:09:24] ℹ️  Using service line from patient data: 'HHA'
[05:09:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:09:24] ✅ Patient name cross-validation successful
[05:09:24] ✅    ✅ Data merged successfully
[05:09:25] ✅    ✅ Order data extracted and validated
[05:09:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:25] [DOC: 9247771] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[05:09:25] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[05:09:25] 🔄 
🔄 Step 6: Pushing order to API...
[05:09:25] [DOC: 9247771] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[05:09:26] [DOC: 9247771] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[05:09:26] ❌    ❌ Failed to push order
[05:09:26] 🔄 
🔄 Step 7: Writing to CSV...
[05:09:26] [DOC: 9247771] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[05:09:26] [DOC: 9247771] ℹ️  Service Line extracted: 'HHA'
[05:09:26] [DOC: 9247771] ℹ️  Payer Source extracted: 'Medicare'
[05:09:26] [DOC: 9247771] ℹ️  Diagnosis codes being written:
[05:09:26] [DOC: 9247771] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:09:26] [DOC: 9247771] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:09:26] [DOC: 9247771] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:09:26] [DOC: 9247771] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:09:26] [DOC: 9247771] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:09:26] [DOC: 9247771] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:09:26] [DOC: 9247771] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: HHA | Payer: Medicare | MRN: 842002
[05:09:26] ✅    ✅ Document 9247771 processed and saved successfully
[05:09:26] 🔄 
🔄 Step 8: Saving API details...
[05:09:26] [DOC: 9247771] ℹ️  API push details saved for document 9247771
[05:09:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247766                         ║
================================================================================
[05:09:26] ℹ️  Agency: Dartmouth HH
[05:09:26] ℹ️  Date: 04/18/2025
[05:09:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:28] [DOC: 9247766] ✅ Text extracted using pdfplumber (4994 chars)
[05:09:28] ✅    ✅ Text extracted using pdfplumber (4994 chars)
[05:09:28] 🔄 
🔄 Step 2: Extracting patient data...
[05:09:31] ℹ️  AI extracted raw sex value: 'F'
[05:09:31] ℹ️  AI extracted service line: 'OT'
[05:09:31] ℹ️  AI extracted payer source: 'Senior Whole Health'
[05:09:31] ℹ️  AI extracted diagnoses:
[05:09:31] ℹ️    - Diagnosis 1: ''
[05:09:31] ℹ️    - Diagnosis 2: ''
[05:09:31] ℹ️    - Diagnosis 3: ''
[05:09:31] ℹ️    - Diagnosis 4: ''
[05:09:31] ℹ️    - Diagnosis 5: ''
[05:09:31] ℹ️    - Diagnosis 6: ''
[05:09:31] ℹ️  Final extracted MRN: '3611001'
[05:09:31] ℹ️  Final extracted Sex: 'FEMALE'
[05:09:31] ℹ️  Final extracted Service Line: 'OT'
[05:09:31] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[05:09:31] ✅ Patient data extraction completed successfully
[05:09:31] ✅    ✅ Patient data extracted successfully
[05:09:31] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Lavadinho
     └─ dob: 12/16/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3611001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:31] ✅    ✅ Patient identified: Marie Lavadinho
[05:09:31] ✅    ✅ Patient name validation passed
[05:09:31] 🔄 
🔄 Step 3: Processing patient dates...
[05:09:31] [DOC: 9247766] ℹ️  DOB normalized: 12/16/1936
[05:09:31] [DOC: 9247766] ℹ️  Episode startOfCare normalized: 03/14/2025
[05:09:31] [DOC: 9247766] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[05:09:31] [DOC: 9247766] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[05:09:31] [DOC: 9247766] ✅ Patient date processing completed successfully
[05:09:31] ✅    ✅ Date processing completed
[05:09:31] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Lavadinho
     └─ dob: 12/16/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3611001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:31] 🔄 
🔄 Step 4: Extracting order data...
[05:09:33] ℹ️  Order extraction - MRN: ''
[05:09:33] ℹ️  Order extraction - Sex: 'FEMALE'
[05:09:33] ℹ️  Order extraction - Service Line: 'OT'
[05:09:33] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[05:09:33] ✅ Order data extraction completed successfully
[05:09:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:33] ℹ️  Using MRN from patient data: '3611001'
[05:09:33] ℹ️  Service line consistent in both sources: 'OT'
[05:09:33] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[05:09:33] ✅ Patient name cross-validation successful
[05:09:33] ✅    ✅ Data merged successfully
[05:09:35] ✅    ✅ Order data extracted and validated
[05:09:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:35] [DOC: 9247766] ✅ Patient found in local cache: Marie Lavadinho, ID: 1709d00e-fe2b-41a2-aabc-e8cf65d43776
[05:09:35] ✅    ✅ Existing patient found with ID: 1709d00e-fe2b-41a2-aabc-e8cf65d43776
[05:09:35] 🔄 
🔄 Step 6: Pushing order to API...
[05:09:35] [DOC: 9247766] ℹ️  Pushing order via API for patient ID: 1709d00e-fe2b-41a2-aabc-e8cf65d43776
[05:09:36] [DOC: 9247766] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13903"}
[05:09:36] ❌    ❌ Failed to push order
[05:09:36] 🔄 
🔄 Step 7: Writing to CSV...
[05:09:36] [DOC: 9247766] ℹ️  Calculated age: 88 from DOB: 12/16/1936
[05:09:36] [DOC: 9247766] ℹ️  Service Line extracted: 'OT'
[05:09:36] [DOC: 9247766] ℹ️  Payer Source extracted: 'Senior Whole Health'
[05:09:36] [DOC: 9247766] ℹ️  Diagnosis codes being written:
[05:09:36] [DOC: 9247766] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:09:36] [DOC: 9247766] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:09:36] [DOC: 9247766] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:09:36] [DOC: 9247766] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:09:36] [DOC: 9247766] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:09:36] [DOC: 9247766] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:09:36] [DOC: 9247766] ✅ Patient data written to CSV: Marie Lavadinho | Sex: FEMALE | Age: 88 | Service: OT | Payer: Senior Whole Health | MRN: 3611001
[05:09:36] ✅    ✅ Document 9247766 processed and saved successfully
[05:09:36] 🔄 
🔄 Step 8: Saving API details...
[05:09:36] [DOC: 9247766] ℹ️  API push details saved for document 9247766
[05:09:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247764                         ║
================================================================================
[05:09:36] ℹ️  Agency: Dartmouth HH
[05:09:36] ℹ️  Date: 04/18/2025
[05:09:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:38] [DOC: 9247764] ✅ Text extracted using pdfplumber (1316 chars)
[05:09:38] ✅    ✅ Text extracted using pdfplumber (1316 chars)
[05:09:38] 🔄 
🔄 Step 2: Extracting patient data...
[05:09:41] ℹ️  AI extracted raw sex value: 'M'
[05:09:41] ℹ️  AI extracted service line: 'HHA'
[05:09:41] ℹ️  AI extracted payer source: 'Medicare'
[05:09:41] ℹ️  AI extracted diagnoses:
[05:09:41] ℹ️    - Diagnosis 1: 'None'
[05:09:41] ℹ️    - Diagnosis 2: 'None'
[05:09:41] ℹ️    - Diagnosis 3: 'None'
[05:09:41] ℹ️    - Diagnosis 4: 'None'
[05:09:41] ℹ️    - Diagnosis 5: 'None'
[05:09:41] ℹ️    - Diagnosis 6: 'None'
[05:09:41] ℹ️  Final extracted MRN: '6396009'
[05:09:41] ℹ️  Final extracted Sex: 'MALE'
[05:09:41] ℹ️  Final extracted Service Line: 'HHA'
[05:09:41] ℹ️  Final extracted Payer Source: 'Medicare'
[05:09:41] ✅ Patient data extraction completed successfully
[05:09:41] ✅    ✅ Patient data extracted successfully
[05:09:41] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:09:41] ✅    ✅ Patient identified: Frank Edwards
[05:09:41] ✅    ✅ Patient name validation passed
[05:09:41] 🔄 
🔄 Step 3: Processing patient dates...
[05:09:41] [DOC: 9247764] ℹ️  DOB normalized: 04/08/1942
[05:09:41] [DOC: 9247764] ℹ️  Episode startOfCare normalized: 03/13/2025
[05:09:41] [DOC: 9247764] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[05:09:41] [DOC: 9247764] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[05:09:41] [DOC: 9247764] ✅ Patient date processing completed successfully
[05:09:41] ✅    ✅ Date processing completed
[05:09:41] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025'}]
[05:09:41] 🔄 
🔄 Step 4: Extracting order data...
[05:09:43] ℹ️  Order extraction - MRN: ''
[05:09:43] ℹ️  Order extraction - Sex: 'MALE'
[05:09:43] ℹ️  Order extraction - Service Line: 'HHA'
[05:09:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:09:43] ✅ Order data extraction completed successfully
[05:09:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:43] ℹ️  Using MRN from patient data: '6396009'
[05:09:43] ℹ️  Service line consistent in both sources: 'HHA'
[05:09:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:09:43] ✅ Patient name cross-validation successful
[05:09:43] ✅    ✅ Data merged successfully
[05:09:45] ✅    ✅ Order data extracted and validated
[05:09:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:45] [DOC: 9247764] ✅ Patient found in local cache: Frank Edwards, ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[05:09:45] ✅    ✅ Existing patient found with ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[05:09:45] 🔄 
🔄 Step 6: Pushing order to API...
[05:09:45] [DOC: 9247764] ℹ️  Pushing order via API for patient ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[05:09:46] [DOC: 9247764] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13905"}
[05:09:46] ❌    ❌ Failed to push order
[05:09:46] 🔄 
🔄 Step 7: Writing to CSV...
[05:09:46] [DOC: 9247764] ℹ️  Calculated age: 83 from DOB: 04/08/1942
[05:09:46] [DOC: 9247764] ℹ️  Service Line extracted: 'HHA'
[05:09:46] [DOC: 9247764] ℹ️  Payer Source extracted: 'Medicare'
[05:09:46] [DOC: 9247764] ℹ️  Diagnosis codes being written:
[05:09:46] [DOC: 9247764] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:09:46] [DOC: 9247764] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:09:46] [DOC: 9247764] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:09:46] [DOC: 9247764] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:09:46] [DOC: 9247764] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:09:46] [DOC: 9247764] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:09:46] [DOC: 9247764] ✅ Patient data written to CSV: Frank Edwards | Sex: MALE | Age: 83 | Service: HHA | Payer: Medicare | MRN: 6396009
[05:09:46] ✅    ✅ Document 9247764 processed and saved successfully
[05:09:46] 🔄 
🔄 Step 8: Saving API details...
[05:09:46] [DOC: 9247764] ℹ️  API push details saved for document 9247764
[05:09:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247760                         ║
================================================================================
[05:09:46] ℹ️  Agency: Dartmouth HH
[05:09:46] ℹ️  Date: 04/18/2025
[05:09:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:48] [DOC: 9247760] ✅ Text extracted using pdfplumber (1145 chars)
[05:09:48] ✅    ✅ Text extracted using pdfplumber (1145 chars)
[05:09:48] 🔄 
🔄 Step 2: Extracting patient data...
[05:09:51] ℹ️  AI extracted raw sex value: 'F'
[05:09:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:09:51] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[05:09:51] ℹ️  AI extracted diagnoses:
[05:09:51] ℹ️    - Diagnosis 1: ''
[05:09:51] ℹ️    - Diagnosis 2: ''
[05:09:51] ℹ️    - Diagnosis 3: ''
[05:09:51] ℹ️    - Diagnosis 4: ''
[05:09:51] ℹ️    - Diagnosis 5: ''
[05:09:51] ℹ️    - Diagnosis 6: ''
[05:09:51] ℹ️  Final extracted MRN: '6066015'
[05:09:51] ℹ️  Final extracted Sex: 'FEMALE'
[05:09:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:09:51] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[05:09:51] ✅ Patient data extraction completed successfully
[05:09:51] ✅    ✅ Patient data extracted successfully
[05:09:51] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:51] ✅    ✅ Patient identified: Lois Fernandes
[05:09:51] ✅    ✅ Patient name validation passed
[05:09:51] 🔄 
🔄 Step 3: Processing patient dates...
[05:09:51] [DOC: 9247760] ℹ️  DOB normalized: 05/15/1941
[05:09:51] [DOC: 9247760] ℹ️  Episode startOfCare normalized: 02/22/2025
[05:09:51] [DOC: 9247760] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[05:09:51] [DOC: 9247760] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[05:09:51] [DOC: 9247760] ✅ Patient date processing completed successfully
[05:09:51] ✅    ✅ Date processing completed
[05:09:51] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:51] 🔄 
🔄 Step 4: Extracting order data...
[05:09:53] ℹ️  Order extraction - MRN: ''
[05:09:53] ℹ️  Order extraction - Sex: 'FEMALE'
[05:09:53] ℹ️  Order extraction - Service Line: 'RN'
[05:09:53] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[05:09:53] ✅ Order data extraction completed successfully
[05:09:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:53] ℹ️  Using MRN from patient data: '6066015'
[05:09:53] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[05:09:53] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[05:09:53] ✅ Patient name cross-validation successful
[05:09:53] ✅    ✅ Data merged successfully
[05:09:55] ✅    ✅ Order data extracted and validated
[05:09:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:55] [DOC: 9247760] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[05:09:55] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[05:09:55] 🔄 
🔄 Step 6: Pushing order to API...
[05:09:55] [DOC: 9247760] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[05:09:56] [DOC: 9247760] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13961"}
[05:09:56] ❌    ❌ Failed to push order
[05:09:56] 🔄 
🔄 Step 7: Writing to CSV...
[05:09:56] [DOC: 9247760] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[05:09:56] [DOC: 9247760] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[05:09:56] [DOC: 9247760] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[05:09:56] [DOC: 9247760] ℹ️  Diagnosis codes being written:
[05:09:56] [DOC: 9247760] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:09:56] [DOC: 9247760] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:09:56] [DOC: 9247760] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:09:56] [DOC: 9247760] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:09:56] [DOC: 9247760] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:09:56] [DOC: 9247760] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:09:56] [DOC: 9247760] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: RN, Skilled Nursing | Payer: Blue Cross Medicare Adv | MRN: 6066015
[05:09:56] ✅    ✅ Document 9247760 processed and saved successfully
[05:09:56] 🔄 
🔄 Step 8: Saving API details...
[05:09:56] [DOC: 9247760] ℹ️  API push details saved for document 9247760
[05:09:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247756                         ║
================================================================================
[05:09:56] ℹ️  Agency: Dartmouth HH
[05:09:56] ℹ️  Date: 04/18/2025
[05:09:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:59] [DOC: 9247756] ✅ Text extracted using pdfplumber (12167 chars)
[05:09:59] ✅    ✅ Text extracted using pdfplumber (12167 chars)
[05:09:59] 🔄 
🔄 Step 2: Extracting patient data...
[05:10:02] ℹ️  AI extracted raw sex value: 'M'
[05:10:02] ℹ️  AI extracted service line: 'PT'
[05:10:02] ℹ️  AI extracted payer source: ''
[05:10:02] ℹ️  AI extracted diagnoses:
[05:10:02] ℹ️    - Diagnosis 1: 'Z47.1'
[05:10:02] ℹ️    - Diagnosis 2: 'I10'
[05:10:02] ℹ️    - Diagnosis 3: 'M47.816'
[05:10:02] ℹ️    - Diagnosis 4: 'E66.9'
[05:10:02] ℹ️    - Diagnosis 5: 'Z68.31'
[05:10:02] ℹ️    - Diagnosis 6: 'K57.90'
[05:10:02] ℹ️  Final extracted MRN: '3021015'
[05:10:02] ℹ️  Final extracted Sex: 'MALE'
[05:10:02] ℹ️  Final extracted Service Line: 'PT'
[05:10:02] ℹ️  Final extracted Payer Source: ''
[05:10:02] ✅ Patient data extraction completed successfully
[05:10:02] ✅    ✅ Patient data extracted successfully
[05:10:02] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Boucher
     └─ dob: 02/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 3021015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/10/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M47.816', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'K57.90'}]
[05:10:02] ✅    ✅ Patient identified: Robert Boucher
[05:10:02] ✅    ✅ Patient name validation passed
[05:10:02] 🔄 
🔄 Step 3: Processing patient dates...
[05:10:02] [DOC: 9247756] ℹ️  DOB normalized: 02/11/1942
[05:10:02] [DOC: 9247756] ℹ️  Episode startOfCare normalized: 04/10/2025
[05:10:02] [DOC: 9247756] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[05:10:02] [DOC: 9247756] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[05:10:02] [DOC: 9247756] ✅ Patient date processing completed successfully
[05:10:02] ✅    ✅ Date processing completed
[05:10:02] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Boucher
     └─ dob: 02/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 3021015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/10/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M47.816', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'K57.90'}]
[05:10:02] 🔄 
🔄 Step 4: Extracting order data...
[05:10:05] ℹ️  Order extraction - MRN: '3021015'
[05:10:05] ℹ️  Order extraction - Sex: 'MALE'
[05:10:05] ℹ️  Order extraction - Service Line: 'PT'
[05:10:05] ℹ️  Order extraction - Payer Source: ''
[05:10:05] ✅ Order data extraction completed successfully
[05:10:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:10:05] ℹ️  Using MRN from patient data: '3021015' over '3021015'
[05:10:05] ℹ️  Service line consistent in both sources: 'PT'
[05:10:05] ✅ Patient name cross-validation successful
[05:10:05] ✅    ✅ Data merged successfully
[05:10:06] ✅    ✅ Order data extracted and validated
[05:10:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:10:49] [DOC: 9247756] ✅ Patient exists in API: Robert Boucher, ID: 3d5c3d21-71c6-4856-b8a0-ae21924eab59
[05:10:49] ✅    ✅ Existing patient found with ID: 3d5c3d21-71c6-4856-b8a0-ae21924eab59
[05:10:49] 🔄 
🔄 Step 6: Pushing order to API...
[05:10:49] [DOC: 9247756] ℹ️  Pushing order via API for patient ID: 3d5c3d21-71c6-4856-b8a0-ae21924eab59
[05:10:50] [DOC: 9247756] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:10:50] ❌    ❌ Failed to push order
[05:10:50] 🔄 
🔄 Step 7: Writing to CSV...
[05:10:50] [DOC: 9247756] ℹ️  Calculated age: 83 from DOB: 02/11/1942
[05:10:50] [DOC: 9247756] ℹ️  Service Line extracted: 'PT'
[05:10:50] [DOC: 9247756] ℹ️  Payer Source extracted: ''
[05:10:50] [DOC: 9247756] ℹ️  Diagnosis codes being written:
[05:10:50] [DOC: 9247756] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[05:10:50] [DOC: 9247756] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[05:10:50] [DOC: 9247756] ℹ️    - Latest_Episode_Thirddiagnosis: 'M47.816'
[05:10:50] [DOC: 9247756] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.9'
[05:10:50] [DOC: 9247756] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.31'
[05:10:50] [DOC: 9247756] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K57.90'
[05:10:50] [DOC: 9247756] ✅ Patient data written to CSV: Robert Boucher | Sex: MALE | Age: 83 | Service: PT | Payer:  | MRN: 3021015
[05:10:50] ✅    ✅ Document 9247756 processed and saved successfully
[05:10:50] 🔄 
🔄 Step 8: Saving API details...
[05:10:50] [DOC: 9247756] ℹ️  API push details saved for document 9247756
[05:10:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247750                         ║
================================================================================
[05:10:50] ℹ️  Agency: Dartmouth HH
[05:10:50] ℹ️  Date: 04/18/2025
[05:10:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:10:52] [DOC: 9247750] ✅ Text extracted using pdfplumber (4134 chars)
[05:10:52] ✅    ✅ Text extracted using pdfplumber (4134 chars)
[05:10:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:10:55] ℹ️  AI extracted raw sex value: 'M'
[05:10:55] ℹ️  AI extracted service line: 'PT'
[05:10:55] ℹ️  AI extracted payer source: 'Fallon Health'
[05:10:55] ℹ️  AI extracted diagnoses:
[05:10:55] ℹ️    - Diagnosis 1: ''
[05:10:55] ℹ️    - Diagnosis 2: ''
[05:10:55] ℹ️    - Diagnosis 3: ''
[05:10:55] ℹ️    - Diagnosis 4: ''
[05:10:55] ℹ️    - Diagnosis 5: ''
[05:10:55] ℹ️    - Diagnosis 6: ''
[05:10:55] ℹ️  Final extracted MRN: '5334009'
[05:10:55] ℹ️  Final extracted Sex: 'MALE'
[05:10:55] ℹ️  Final extracted Service Line: 'PT'
[05:10:55] ℹ️  Final extracted Payer Source: 'Fallon Health'
[05:10:55] ✅ Patient data extraction completed successfully
[05:10:55] ✅    ✅ Patient data extracted successfully
[05:10:55] 📊 Patient Response
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:10:55] ✅    ✅ Patient identified: Jeremias Teixeira
[05:10:55] ✅    ✅ Patient name validation passed
[05:10:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:10:55] [DOC: 9247750] ℹ️  DOB normalized: 12/26/1931
[05:10:55] [DOC: 9247750] ℹ️  Episode startOfCare normalized: 03/25/2025
[05:10:55] [DOC: 9247750] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[05:10:55] [DOC: 9247750] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[05:10:55] [DOC: 9247750] ✅ Patient date processing completed successfully
[05:10:55] ✅    ✅ Date processing completed
[05:10:55] 📊 Processed Patient Data
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:10:55] 🔄 
🔄 Step 4: Extracting order data...
[05:10:57] ℹ️  Order extraction - MRN: '5334009'
[05:10:57] ℹ️  Order extraction - Sex: 'MALE'
[05:10:57] ℹ️  Order extraction - Service Line: 'PT'
[05:10:57] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[05:10:57] ✅ Order data extraction completed successfully
[05:10:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:10:57] ℹ️  Using MRN from patient data: '5334009' over '5334009'
[05:10:57] ℹ️  Service line consistent in both sources: 'PT'
[05:10:57] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[05:10:57] ✅ Patient name cross-validation successful
[05:10:57] ✅    ✅ Data merged successfully
[05:10:59] ✅    ✅ Order data extracted and validated
[05:10:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:10:59] [DOC: 9247750] ✅ Patient found in local cache: Jeremias Teixeira, ID: b4f73061-83ef-486e-b374-3b920247ea12
[05:10:59] ✅    ✅ Existing patient found with ID: b4f73061-83ef-486e-b374-3b920247ea12
[05:10:59] 🔄 
🔄 Step 6: Pushing order to API...
[05:10:59] [DOC: 9247750] ℹ️  Pushing order via API for patient ID: b4f73061-83ef-486e-b374-3b920247ea12
[05:11:00] [DOC: 9247750] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:11:00] ❌    ❌ Failed to push order
[05:11:00] 🔄 
🔄 Step 7: Writing to CSV...
[05:11:00] [DOC: 9247750] ℹ️  Calculated age: 93 from DOB: 12/26/1931
[05:11:00] [DOC: 9247750] ℹ️  Service Line extracted: 'PT'
[05:11:00] [DOC: 9247750] ℹ️  Payer Source extracted: 'Fallon Health'
[05:11:00] [DOC: 9247750] ℹ️  Diagnosis codes being written:
[05:11:00] [DOC: 9247750] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:11:00] [DOC: 9247750] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:11:00] [DOC: 9247750] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:11:00] [DOC: 9247750] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:11:00] [DOC: 9247750] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:11:00] [DOC: 9247750] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:11:00] [DOC: 9247750] ✅ Patient data written to CSV: Jeremias Teixeira | Sex: MALE | Age: 93 | Service: PT | Payer: Fallon Health | MRN: 5334009
[05:11:00] ✅    ✅ Document 9247750 processed and saved successfully
[05:11:00] 🔄 
🔄 Step 8: Saving API details...
[05:11:00] [DOC: 9247750] ℹ️  API push details saved for document 9247750
[05:11:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247737                         ║
================================================================================
[05:11:00] ℹ️  Agency: Dartmouth HH
[05:11:00] ℹ️  Date: 04/18/2025
[05:11:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:11:03] [DOC: 9247737] ✅ Text extracted using pdfplumber (13432 chars)
[05:11:03] ✅    ✅ Text extracted using pdfplumber (13432 chars)
[05:11:03] 🔄 
🔄 Step 2: Extracting patient data...
[05:11:06] ℹ️  AI extracted raw sex value: 'M'
[05:11:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:11:06] ℹ️  AI extracted payer source: 'Medicare'
[05:11:06] ℹ️  AI extracted diagnoses:
[05:11:06] ℹ️    - Diagnosis 1: 'J44.9'
[05:11:06] ℹ️    - Diagnosis 2: 'J96.21'
[05:11:06] ℹ️    - Diagnosis 3: 'N20.0'
[05:11:06] ℹ️    - Diagnosis 4: 'Z96.0'
[05:11:06] ℹ️    - Diagnosis 5: 'N28.9'
[05:11:06] ℹ️    - Diagnosis 6: 'D64.9'
[05:11:06] ℹ️  Final extracted MRN: '4937015'
[05:11:06] ℹ️  Final extracted Sex: 'MALE'
[05:11:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:11:06] ℹ️  Final extracted Payer Source: 'Medicare'
[05:11:06] ✅ Patient data extraction completed successfully
[05:11:06] ✅    ✅ Patient data extracted successfully
[05:11:06] 📊 Patient Response
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J96.21', 'thirdDiagnosis': 'N20.0', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'N28.9', 'sixthDiagnosis': 'D64.9'}]
[05:11:06] ✅    ✅ Patient identified: Harvey Lewis
[05:11:06] ✅    ✅ Patient name validation passed
[05:11:06] 🔄 
🔄 Step 3: Processing patient dates...
[05:11:06] [DOC: 9247737] ℹ️  DOB normalized: 05/02/1949
[05:11:06] [DOC: 9247737] ℹ️  Episode startOfCare normalized: 12/18/2024
[05:11:06] [DOC: 9247737] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[05:11:06] [DOC: 9247737] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[05:11:06] [DOC: 9247737] ✅ Patient date processing completed successfully
[05:11:06] ✅    ✅ Date processing completed
[05:11:06] 📊 Processed Patient Data
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J96.21', 'thirdDiagnosis': 'N20.0', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'N28.9', 'sixthDiagnosis': 'D64.9'}]
[05:11:06] 🔄 
🔄 Step 4: Extracting order data...
[05:11:09] ℹ️  Order extraction - MRN: '4937015'
[05:11:09] ℹ️  Order extraction - Sex: 'MALE'
[05:11:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:11:09] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:11:09] ✅ Order data extraction completed successfully
[05:11:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:11:09] ℹ️  Using MRN from patient data: '4937015' over '4937015'
[05:11:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:11:09] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:11:09] ✅ Patient name cross-validation successful
[05:11:09] ✅    ✅ Data merged successfully
[05:11:10] ✅    ✅ Order data extracted and validated
[05:11:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:11:10] [DOC: 9247737] ✅ Patient found in local cache: Harvey Lewis, ID: 173f09ed-5f3d-4120-a940-63a4db422257
[05:11:10] ✅    ✅ Existing patient found with ID: 173f09ed-5f3d-4120-a940-63a4db422257
[05:11:10] 🔄 
🔄 Step 6: Pushing order to API...
[05:11:10] [DOC: 9247737] ℹ️  Pushing order via API for patient ID: 173f09ed-5f3d-4120-a940-63a4db422257
[05:11:11] [DOC: 9247737] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:11:11] ❌    ❌ Failed to push order
[05:11:11] 🔄 
🔄 Step 7: Writing to CSV...
[05:11:11] [DOC: 9247737] ℹ️  Calculated age: 76 from DOB: 05/02/1949
[05:11:11] [DOC: 9247737] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:11:11] [DOC: 9247737] ℹ️  Payer Source extracted: 'Medicare'
[05:11:11] [DOC: 9247737] ℹ️  Diagnosis codes being written:
[05:11:11] [DOC: 9247737] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[05:11:11] [DOC: 9247737] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.21'
[05:11:11] [DOC: 9247737] ℹ️    - Latest_Episode_Thirddiagnosis: 'N20.0'
[05:11:11] [DOC: 9247737] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z96.0'
[05:11:11] [DOC: 9247737] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N28.9'
[05:11:11] [DOC: 9247737] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D64.9'
[05:11:11] [DOC: 9247737] ✅ Patient data written to CSV: Harvey Lewis | Sex: MALE | Age: 76 | Service: Skilled Nursing | Payer: Medicare | MRN: 4937015
[05:11:11] ✅    ✅ Document 9247737 processed and saved successfully
[05:11:11] 🔄 
🔄 Step 8: Saving API details...
[05:11:11] [DOC: 9247737] ℹ️  API push details saved for document 9247737
[05:11:11] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[05:11:11] ℹ️  Total Processed: 49
[05:11:11] ℹ️  CSV Success: 24
[05:11:11] ℹ️  CSV Errors: 1
[05:11:11] ℹ️  API Success: 0
[05:11:11] ℹ️  API Errors: 48
[05:11:11] ℹ️  CSV Success Rate: 49.0%
[05:11:11] ℹ️  API Success Rate: 0.0%
[05:11:11] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_044453.csv
[05:11:11] ℹ️  API Details File: api_outputs/api_push_details_20250608_044453.csv
================================================================================
║          ============================================================          ║
================================================================================
