================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[05:13:17] ℹ️  CSV Data Extraction & API Push Tool
[05:13:17] ℹ️  
[05:13:17] ℹ️  Features:
[05:13:17] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[05:13:17] ℹ️  - AI-powered patient and order data extraction
[05:13:17] ℹ️  - Enhanced error handling and logging
[05:13:17] ℹ️  - Full API integration (patient creation + order pushing)
[05:13:17] ℹ️  - CSV output with comprehensive patient data
[05:13:17] ℹ️  - Detailed API tracking with remarks for every document
[05:13:17] ℹ️  - Complete audit trail of all processing attempts
[05:13:17] ℹ️  
[05:13:17] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[05:13:17] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_051317.csv
[05:13:17] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_051317.csv
================================================================================
║                        Processing Document ID: 9247732                         ║
================================================================================
[05:13:17] ℹ️  Agency: Dartmouth HH
[05:13:17] ℹ️  Date: 04/18/2025
[05:13:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:26] [DOC: 9247732] ✅ Text extracted using pdfplumber (16329 chars)
[05:13:26] ✅    ✅ Text extracted using pdfplumber (16317 chars)
[05:13:26] 🔄 
🔄 Step 2: Extracting patient data...
[05:13:30] ℹ️  AI extracted raw sex value: 'M'
[05:13:30] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:13:30] ℹ️  AI extracted payer source: ''
[05:13:30] ℹ️  AI extracted diagnoses:
[05:13:30] ℹ️    - Diagnosis 1: 'J44.9'
[05:13:30] ℹ️    - Diagnosis 2: 'J96.21'
[05:13:30] ℹ️    - Diagnosis 3: 'N20.0'
[05:13:30] ℹ️    - Diagnosis 4: 'Z96.0'
[05:13:30] ℹ️    - Diagnosis 5: 'N28.9'
[05:13:30] ℹ️    - Diagnosis 6: 'D64.9'
[05:13:30] ℹ️  Final extracted MRN: '4937015'
[05:13:30] ℹ️  Final extracted Sex: 'MALE'
[05:13:30] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:13:30] ℹ️  Final extracted Payer Source: ''
[05:13:30] ✅ Patient data extraction completed successfully
[05:13:30] ✅    ✅ Patient data extracted successfully
[05:13:30] 📊 Patient Response
     └─ patientFName: Lewis
     └─ patientLName: Harvey
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J96.21', 'thirdDiagnosis': 'N20.0', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'N28.9', 'sixthDiagnosis': 'D64.9'}]
[05:13:30] ✅    ✅ Patient identified: Lewis Harvey
[05:13:30] ✅    ✅ Patient name validation passed
[05:13:30] 🔄 
🔄 Step 3: Processing patient dates...
[05:13:30] [DOC: 9247732] ℹ️  DOB normalized: 05/02/1949
[05:13:30] [DOC: 9247732] ℹ️  Episode startOfCare normalized: 12/18/2024
[05:13:30] [DOC: 9247732] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[05:13:30] [DOC: 9247732] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[05:13:30] [DOC: 9247732] ✅ Patient date processing completed successfully
[05:13:30] ✅    ✅ Date processing completed
[05:13:30] 📊 Processed Patient Data
     └─ patientFName: Lewis
     └─ patientLName: Harvey
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J96.21', 'thirdDiagnosis': 'N20.0', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'N28.9', 'sixthDiagnosis': 'D64.9'}]
[05:13:30] 🔄 
🔄 Step 4: Extracting order data...
[05:13:33] ℹ️  Order extraction - MRN: '4937015'
[05:13:33] ℹ️  Order extraction - Sex: 'MALE'
[05:13:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[05:13:33] ℹ️  Order extraction - Payer Source: ''
[05:13:33] ✅ Order data extraction completed successfully
[05:13:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:13:33] ℹ️  Using MRN from patient data: '4937015' over '4937015'
[05:13:33] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[05:13:33] ✅ Patient name cross-validation successful
[05:13:33] ✅    ✅ Data merged successfully
[05:13:34] ✅    ✅ Order data extracted and validated
[05:13:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:13:40] [DOC: 9247732] ✅ Patient exists in API: Lewis Harvey, ID: 243d65ed-6787-40f3-895c-943210083d7d
[05:13:40] ✅    ✅ Existing patient found with ID: 243d65ed-6787-40f3-895c-943210083d7d
[05:13:40] 🔄 
🔄 Step 6: Pushing order to API...
[05:13:40] [DOC: 9247732] ℹ️  Pushing order via API for patient ID: 243d65ed-6787-40f3-895c-943210083d7d
[05:13:41] [DOC: 9247732] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:13:41] ❌    ❌ Failed to push order
[05:13:41] 🔄 
🔄 Step 7: Writing to CSV...
[05:13:41] [DOC: 9247732] ℹ️  Calculated age: 76 from DOB: 05/02/1949
[05:13:41] [DOC: 9247732] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[05:13:41] [DOC: 9247732] ℹ️  Payer Source extracted: ''
[05:13:41] [DOC: 9247732] ℹ️  Diagnosis codes being written:
[05:13:41] [DOC: 9247732] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[05:13:41] [DOC: 9247732] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.21'
[05:13:41] [DOC: 9247732] ℹ️    - Latest_Episode_Thirddiagnosis: 'N20.0'
[05:13:41] [DOC: 9247732] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z96.0'
[05:13:41] [DOC: 9247732] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N28.9'
[05:13:41] [DOC: 9247732] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D64.9'
[05:13:41] [DOC: 9247732] ✅ Patient data written to CSV: Lewis Harvey | Sex: MALE | Age: 76 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 4937015
[05:13:41] ✅    ✅ Document 9247732 processed and saved successfully
[05:13:41] 🔄 
🔄 Step 8: Saving API details...
[05:13:41] [DOC: 9247732] ℹ️  API push details saved for document 9247732
[05:13:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247727                         ║
================================================================================
[05:13:41] ℹ️  Agency: Dartmouth HH
[05:13:41] ℹ️  Date: 04/18/2025
[05:13:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:44] [DOC: 9247727] ✅ Text extracted using pdfplumber (1088 chars)
[05:13:44] ✅    ✅ Text extracted using pdfplumber (1088 chars)
[05:13:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:13:46] ℹ️  AI extracted raw sex value: 'M'
[05:13:46] ℹ️  AI extracted service line: 'RN'
[05:13:46] ℹ️  AI extracted payer source: 'Fallon Health'
[05:13:46] ℹ️  AI extracted diagnoses:
[05:13:46] ℹ️    - Diagnosis 1: ''
[05:13:46] ℹ️    - Diagnosis 2: ''
[05:13:46] ℹ️    - Diagnosis 3: ''
[05:13:46] ℹ️    - Diagnosis 4: ''
[05:13:46] ℹ️    - Diagnosis 5: ''
[05:13:46] ℹ️    - Diagnosis 6: ''
[05:13:46] ℹ️  Final extracted MRN: '6310015'
[05:13:46] ℹ️  Final extracted Sex: 'MALE'
[05:13:46] ℹ️  Final extracted Service Line: 'RN'
[05:13:46] ℹ️  Final extracted Payer Source: 'Fallon Health'
[05:13:46] ✅ Patient data extraction completed successfully
[05:13:46] ✅    ✅ Patient data extracted successfully
[05:13:46] 📊 Patient Response
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 6310015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 28 Manhattan Avenue
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:13:46] ✅    ✅ Patient identified: Augusto Dejesus
[05:13:46] ✅    ✅ Patient name validation passed
[05:13:46] 🔄 
🔄 Step 3: Processing patient dates...
[05:13:46] [DOC: 9247727] ℹ️  DOB normalized: 02/02/1940
[05:13:46] [DOC: 9247727] ℹ️  Episode startOfCare normalized: 03/30/2025
[05:13:46] [DOC: 9247727] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[05:13:46] [DOC: 9247727] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[05:13:46] [DOC: 9247727] ✅ Patient date processing completed successfully
[05:13:46] ✅    ✅ Date processing completed
[05:13:46] 📊 Processed Patient Data
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 6310015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 28 Manhattan Avenue
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:13:46] 🔄 
🔄 Step 4: Extracting order data...
[05:13:49] ℹ️  Order extraction - MRN: ''
[05:13:49] ℹ️  Order extraction - Sex: 'MALE'
[05:13:49] ℹ️  Order extraction - Service Line: 'RN'
[05:13:49] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[05:13:49] ✅ Order data extraction completed successfully
[05:13:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:13:49] ℹ️  Using MRN from patient data: '6310015'
[05:13:49] ℹ️  Service line consistent in both sources: 'RN'
[05:13:49] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[05:13:49] ✅ Patient name cross-validation successful
[05:13:49] ✅    ✅ Data merged successfully
[05:13:50] ✅    ✅ Order data extracted and validated
[05:13:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:13:50] [DOC: 9247727] ✅ Patient found in local cache: Augusto Dejesus, ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[05:13:50] ✅    ✅ Existing patient found with ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[05:13:50] 🔄 
🔄 Step 6: Pushing order to API...
[05:13:50] [DOC: 9247727] ℹ️  Pushing order via API for patient ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[05:13:51] [DOC: 9247727] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:13:51] ❌    ❌ Failed to push order
[05:13:51] 🔄 
🔄 Step 7: Writing to CSV...
[05:13:51] [DOC: 9247727] ℹ️  Calculated age: 85 from DOB: 02/02/1940
[05:13:51] [DOC: 9247727] ℹ️  Service Line extracted: 'RN'
[05:13:51] [DOC: 9247727] ℹ️  Payer Source extracted: 'Fallon Health'
[05:13:51] [DOC: 9247727] ℹ️  Diagnosis codes being written:
[05:13:51] [DOC: 9247727] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:13:51] [DOC: 9247727] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:13:51] [DOC: 9247727] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:13:51] [DOC: 9247727] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:13:51] [DOC: 9247727] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:13:51] [DOC: 9247727] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:13:51] [DOC: 9247727] ✅ Patient data written to CSV: Augusto Dejesus | Sex: MALE | Age: 85 | Service: RN | Payer: Fallon Health | MRN: 6310015
[05:13:51] ✅    ✅ Document 9247727 processed and saved successfully
[05:13:51] 🔄 
🔄 Step 8: Saving API details...
[05:13:51] [DOC: 9247727] ℹ️  API push details saved for document 9247727
[05:13:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247722                         ║
================================================================================
[05:13:51] ℹ️  Agency: Dartmouth HH
[05:13:51] ℹ️  Date: 04/18/2025
[05:13:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:13:57] [DOC: 9247722] ✅ Text extracted using pdfplumber (9597 chars)
[05:13:57] ✅    ✅ Text extracted using pdfplumber (9597 chars)
[05:13:57] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:00] ℹ️  AI extracted raw sex value: 'M'
[05:14:00] ℹ️  AI extracted service line: 'PT'
[05:14:00] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[05:14:00] ℹ️  AI extracted diagnoses:
[05:14:00] ℹ️    - Diagnosis 1: ''
[05:14:00] ℹ️    - Diagnosis 2: ''
[05:14:00] ℹ️    - Diagnosis 3: ''
[05:14:00] ℹ️    - Diagnosis 4: ''
[05:14:00] ℹ️    - Diagnosis 5: ''
[05:14:00] ℹ️    - Diagnosis 6: ''
[05:14:00] ℹ️  Final extracted MRN: '6348015'
[05:14:00] ℹ️  Final extracted Sex: 'MALE'
[05:14:00] ℹ️  Final extracted Service Line: 'PT'
[05:14:00] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[05:14:00] ✅ Patient data extraction completed successfully
[05:14:00] ✅    ✅ Patient data extracted successfully
[05:14:00] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:00] ✅    ✅ Patient identified: David Teixeira
[05:14:00] ✅    ✅ Patient name validation passed
[05:14:00] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:00] [DOC: 9247722] ℹ️  DOB normalized: 12/29/1956
[05:14:00] [DOC: 9247722] ℹ️  Episode startOfCare normalized: 04/08/2025
[05:14:00] [DOC: 9247722] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:14:00] [DOC: 9247722] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:14:00] [DOC: 9247722] ✅ Patient date processing completed successfully
[05:14:00] ✅    ✅ Date processing completed
[05:14:00] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:00] 🔄 
🔄 Step 4: Extracting order data...
[05:14:03] ℹ️  Order extraction - MRN: ''
[05:14:03] ℹ️  Order extraction - Sex: 'MALE'
[05:14:03] ℹ️  Order extraction - Service Line: 'PT'
[05:14:03] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[05:14:03] ✅ Order data extraction completed successfully
[05:14:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:03] ℹ️  Using MRN from patient data: '6348015'
[05:14:03] ℹ️  Service line consistent in both sources: 'PT'
[05:14:03] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[05:14:03] ✅ Patient name cross-validation successful
[05:14:03] ✅    ✅ Data merged successfully
[05:14:04] ✅    ✅ Order data extracted and validated
[05:14:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:04] [DOC: 9247722] ✅ Patient found in local cache: David Teixeira, ID: 92d56142-8dce-415a-ac6f-6020de943b51
[05:14:04] ✅    ✅ Existing patient found with ID: 92d56142-8dce-415a-ac6f-6020de943b51
[05:14:04] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:04] [DOC: 9247722] ℹ️  Pushing order via API for patient ID: 92d56142-8dce-415a-ac6f-6020de943b51
[05:14:05] [DOC: 9247722] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:14:05] ❌    ❌ Failed to push order
[05:14:05] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:05] [DOC: 9247722] ℹ️  Calculated age: 68 from DOB: 12/29/1956
[05:14:05] [DOC: 9247722] ℹ️  Service Line extracted: 'PT'
[05:14:05] [DOC: 9247722] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[05:14:05] [DOC: 9247722] ℹ️  Diagnosis codes being written:
[05:14:05] [DOC: 9247722] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:14:05] [DOC: 9247722] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:14:05] [DOC: 9247722] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:14:05] [DOC: 9247722] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:14:05] [DOC: 9247722] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:14:05] [DOC: 9247722] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:14:05] [DOC: 9247722] ✅ Patient data written to CSV: David Teixeira | Sex: MALE | Age: 68 | Service: PT | Payer: Blue Cross Blue Shield | MRN: 6348015
[05:14:05] ✅    ✅ Document 9247722 processed and saved successfully
[05:14:05] 🔄 
🔄 Step 8: Saving API details...
[05:14:05] [DOC: 9247722] ℹ️  API push details saved for document 9247722
[05:14:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247717                         ║
================================================================================
[05:14:05] ℹ️  Agency: Dartmouth HH
[05:14:05] ℹ️  Date: 04/18/2025
[05:14:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:10] [DOC: 9247717] ✅ Text extracted using pdfplumber (12934 chars)
[05:14:10] ✅    ✅ Text extracted using pdfplumber (12934 chars)
[05:14:10] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:13] ℹ️  AI extracted raw sex value: 'F'
[05:14:13] ℹ️  AI extracted service line: 'PT'
[05:14:13] ℹ️  AI extracted payer source: 'None'
[05:14:13] ℹ️  AI extracted diagnoses:
[05:14:13] ℹ️    - Diagnosis 1: 'M17.11'
[05:14:13] ℹ️    - Diagnosis 2: 'M21.161'
[05:14:13] ℹ️    - Diagnosis 3: 'G89.29'
[05:14:13] ℹ️    - Diagnosis 4: 'R53.1'
[05:14:13] ℹ️    - Diagnosis 5: 'M47.816'
[05:14:13] ℹ️    - Diagnosis 6: 'M70.60'
[05:14:13] ℹ️  Final extracted MRN: '227027'
[05:14:13] ℹ️  Final extracted Sex: 'FEMALE'
[05:14:13] ℹ️  Final extracted Service Line: 'PT'
[05:14:13] ℹ️  Final extracted Payer Source: ''
[05:14:13] ✅ Patient data extraction completed successfully
[05:14:13] ✅    ✅ Patient data extracted successfully
[05:14:13] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Oliver
     └─ dob: 04/17/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'M17.11', 'secondDiagnosis': 'M21.161', 'thirdDiagnosis': 'G89.29', 'fourthDiagnosis': 'R53.1', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'M70.60'}]
[05:14:13] ✅    ✅ Patient identified: Shirley Oliver
[05:14:13] ✅    ✅ Patient name validation passed
[05:14:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:13] [DOC: 9247717] ℹ️  DOB normalized: 04/17/1934
[05:14:13] [DOC: 9247717] ℹ️  Episode startOfCare normalized: 03/26/2025
[05:14:13] [DOC: 9247717] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[05:14:13] [DOC: 9247717] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[05:14:13] [DOC: 9247717] ✅ Patient date processing completed successfully
[05:14:13] ✅    ✅ Date processing completed
[05:14:13] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Oliver
     └─ dob: 04/17/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'M17.11', 'secondDiagnosis': 'M21.161', 'thirdDiagnosis': 'G89.29', 'fourthDiagnosis': 'R53.1', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'M70.60'}]
[05:14:13] 🔄 
🔄 Step 4: Extracting order data...
[05:14:16] ℹ️  Order extraction - MRN: '6920009'
[05:14:16] ℹ️  Order extraction - Sex: 'FEMALE'
[05:14:16] ℹ️  Order extraction - Service Line: 'PT'
[05:14:16] ℹ️  Order extraction - Payer Source: ''
[05:14:16] ✅ Order data extraction completed successfully
[05:14:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:16] ℹ️  Using longer MRN from order data: '6920009' over '227027'
[05:14:16] ℹ️  Service line consistent in both sources: 'PT'
[05:14:16] ✅ Patient name cross-validation successful
[05:14:16] ✅    ✅ Data merged successfully
[05:14:17] ✅    ✅ Order data extracted and validated
[05:14:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:17] [DOC: 9247717] ✅ Patient found in local cache: Shirley Oliver, ID: 587ee5d1-c176-4a81-b2df-c2ced317687c
[05:14:17] ✅    ✅ Existing patient found with ID: 587ee5d1-c176-4a81-b2df-c2ced317687c
[05:14:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:17] [DOC: 9247717] ℹ️  Pushing order via API for patient ID: 587ee5d1-c176-4a81-b2df-c2ced317687c
[05:14:19] [DOC: 9247717] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:14:19] ❌    ❌ Failed to push order
[05:14:19] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:19] [DOC: 9247717] ℹ️  Calculated age: 91 from DOB: 04/17/1934
[05:14:19] [DOC: 9247717] ℹ️  Service Line extracted: 'PT'
[05:14:19] [DOC: 9247717] ℹ️  Payer Source extracted: ''
[05:14:19] [DOC: 9247717] ℹ️  Diagnosis codes being written:
[05:14:19] [DOC: 9247717] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.11'
[05:14:19] [DOC: 9247717] ℹ️    - Latest_Episode_Seconddiagnosis: 'M21.161'
[05:14:19] [DOC: 9247717] ℹ️    - Latest_Episode_Thirddiagnosis: 'G89.29'
[05:14:19] [DOC: 9247717] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R53.1'
[05:14:19] [DOC: 9247717] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M47.816'
[05:14:19] [DOC: 9247717] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M70.60'
[05:14:19] [DOC: 9247717] ✅ Patient data written to CSV: Shirley Oliver | Sex: FEMALE | Age: 91 | Service: PT | Payer:  | MRN: 6920009
[05:14:19] ✅    ✅ Document 9247717 processed and saved successfully
[05:14:19] 🔄 
🔄 Step 8: Saving API details...
[05:14:19] [DOC: 9247717] ℹ️  API push details saved for document 9247717
[05:14:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247713                         ║
================================================================================
[05:14:19] ℹ️  Agency: Dartmouth HH
[05:14:19] ℹ️  Date: 04/18/2025
[05:14:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:21] [DOC: 9247713] ✅ Text extracted using pdfplumber (1480 chars)
[05:14:21] ✅    ✅ Text extracted using pdfplumber (1480 chars)
[05:14:21] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:23] ℹ️  AI extracted raw sex value: 'M'
[05:14:23] ℹ️  AI extracted service line: 'RN'
[05:14:23] ℹ️  AI extracted payer source: 'Medicare'
[05:14:23] ℹ️  AI extracted diagnoses:
[05:14:23] ℹ️    - Diagnosis 1: 'None'
[05:14:23] ℹ️    - Diagnosis 2: 'None'
[05:14:23] ℹ️    - Diagnosis 3: 'None'
[05:14:23] ℹ️    - Diagnosis 4: 'None'
[05:14:23] ℹ️    - Diagnosis 5: 'None'
[05:14:23] ℹ️    - Diagnosis 6: 'None'
[05:14:23] ℹ️  Final extracted MRN: '6142015'
[05:14:23] ℹ️  Final extracted Sex: 'MALE'
[05:14:23] ℹ️  Final extracted Service Line: 'RN'
[05:14:23] ℹ️  Final extracted Payer Source: 'Medicare'
[05:14:23] ✅ Patient data extraction completed successfully
[05:14:23] ✅    ✅ Patient data extracted successfully
[05:14:23] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:14:23] ✅    ✅ Patient identified: Raymond Sleight
[05:14:23] ✅    ✅ Patient name validation passed
[05:14:23] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:23] [DOC: 9247713] ℹ️  DOB normalized: 07/10/1942
[05:14:23] [DOC: 9247713] ℹ️  Episode startOfCare normalized: 03/13/2025
[05:14:23] [DOC: 9247713] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[05:14:23] [DOC: 9247713] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[05:14:23] [DOC: 9247713] ✅ Patient date processing completed successfully
[05:14:23] ✅    ✅ Date processing completed
[05:14:23] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025'}]
[05:14:23] 🔄 
🔄 Step 4: Extracting order data...
[05:14:26] ℹ️  Order extraction - MRN: ''
[05:14:26] ℹ️  Order extraction - Sex: 'MALE'
[05:14:26] ℹ️  Order extraction - Service Line: 'RN'
[05:14:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:14:26] ✅ Order data extraction completed successfully
[05:14:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:26] ℹ️  Using MRN from patient data: '6142015'
[05:14:26] ℹ️  Service line consistent in both sources: 'RN'
[05:14:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:14:26] ✅ Patient name cross-validation successful
[05:14:26] ✅    ✅ Data merged successfully
[05:14:27] ✅    ✅ Order data extracted and validated
[05:14:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:27] [DOC: 9247713] ✅ Patient found in local cache: Raymond Sleight, ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[05:14:27] ✅    ✅ Existing patient found with ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[05:14:27] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:27] [DOC: 9247713] ℹ️  Pushing order via API for patient ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[05:14:28] [DOC: 9247713] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:14:28] ❌    ❌ Failed to push order
[05:14:28] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:28] [DOC: 9247713] ℹ️  Calculated age: 82 from DOB: 07/10/1942
[05:14:28] [DOC: 9247713] ℹ️  Service Line extracted: 'RN'
[05:14:28] [DOC: 9247713] ℹ️  Payer Source extracted: 'Medicare'
[05:14:28] [DOC: 9247713] ℹ️  Diagnosis codes being written:
[05:14:28] [DOC: 9247713] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:14:28] [DOC: 9247713] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:14:28] [DOC: 9247713] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:14:28] [DOC: 9247713] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:14:28] [DOC: 9247713] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:14:28] [DOC: 9247713] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:14:28] [DOC: 9247713] ✅ Patient data written to CSV: Raymond Sleight | Sex: MALE | Age: 82 | Service: RN | Payer: Medicare | MRN: 6142015
[05:14:28] ✅    ✅ Document 9247713 processed and saved successfully
[05:14:28] 🔄 
🔄 Step 8: Saving API details...
[05:14:28] [DOC: 9247713] ℹ️  API push details saved for document 9247713
[05:14:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247712                         ║
================================================================================
[05:14:28] ℹ️  Agency: Dartmouth HH
[05:14:28] ℹ️  Date: 04/18/2025
[05:14:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:31] [DOC: 9247712] ✅ Text extracted using pdfplumber (3100 chars)
[05:14:31] ✅    ✅ Text extracted using pdfplumber (3100 chars)
[05:14:31] 🔄 
🔄 Step 2: Extracting patient data...
[05:14:33] ℹ️  AI extracted raw sex value: 'F'
[05:14:33] ℹ️  AI extracted service line: 'PT'
[05:14:33] ℹ️  AI extracted payer source: 'United Health Care'
[05:14:33] ℹ️  AI extracted diagnoses:
[05:14:33] ℹ️    - Diagnosis 1: ''
[05:14:33] ℹ️    - Diagnosis 2: ''
[05:14:33] ℹ️    - Diagnosis 3: ''
[05:14:33] ℹ️    - Diagnosis 4: ''
[05:14:33] ℹ️    - Diagnosis 5: ''
[05:14:33] ℹ️    - Diagnosis 6: ''
[05:14:33] ℹ️  Final extracted MRN: '3488015'
[05:14:33] ℹ️  Final extracted Sex: 'FEMALE'
[05:14:33] ℹ️  Final extracted Service Line: 'PT'
[05:14:33] ℹ️  Final extracted Payer Source: 'United Health Care'
[05:14:33] ✅ Patient data extraction completed successfully
[05:14:33] ✅    ✅ Patient data extracted successfully
[05:14:33] 📊 Patient Response
     └─ patientFName: Miriam
     └─ patientLName: Razon
     └─ dob: 03/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3488015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:33] ✅    ✅ Patient identified: Miriam Razon
[05:14:33] ✅    ✅ Patient name validation passed
[05:14:33] 🔄 
🔄 Step 3: Processing patient dates...
[05:14:33] [DOC: 9247712] ℹ️  DOB normalized: 03/12/1942
[05:14:33] [DOC: 9247712] ℹ️  Episode startOfCare normalized: 03/19/2025
[05:14:33] [DOC: 9247712] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[05:14:33] [DOC: 9247712] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[05:14:33] [DOC: 9247712] ✅ Patient date processing completed successfully
[05:14:33] ✅    ✅ Date processing completed
[05:14:33] 📊 Processed Patient Data
     └─ patientFName: Miriam
     └─ patientLName: Razon
     └─ dob: 03/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3488015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:14:33] 🔄 
🔄 Step 4: Extracting order data...
[05:14:36] ℹ️  Order extraction - MRN: ''
[05:14:36] ℹ️  Order extraction - Sex: 'FEMALE'
[05:14:36] ℹ️  Order extraction - Service Line: 'PT'
[05:14:36] ℹ️  Order extraction - Payer Source: 'United Health Care'
[05:14:36] ✅ Order data extraction completed successfully
[05:14:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:14:36] ℹ️  Using MRN from patient data: '3488015'
[05:14:36] ℹ️  Service line consistent in both sources: 'PT'
[05:14:36] ℹ️  Payer source consistent in both sources: 'United Health Care'
[05:14:36] ✅ Patient name cross-validation successful
[05:14:36] ✅    ✅ Data merged successfully
[05:14:37] ✅    ✅ Order data extracted and validated
[05:14:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:14:53] [DOC: 9247712] ✅ Patient exists in API: Miriam Razon, ID: c3a41080-216f-4d63-9d64-a1346d08f29e
[05:14:53] ✅    ✅ Existing patient found with ID: c3a41080-216f-4d63-9d64-a1346d08f29e
[05:14:53] 🔄 
🔄 Step 6: Pushing order to API...
[05:14:53] [DOC: 9247712] ℹ️  Pushing order via API for patient ID: c3a41080-216f-4d63-9d64-a1346d08f29e
[05:14:54] [DOC: 9247712] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13153"}
[05:14:54] ❌    ❌ Failed to push order
[05:14:54] 🔄 
🔄 Step 7: Writing to CSV...
[05:14:54] [DOC: 9247712] ℹ️  Calculated age: 83 from DOB: 03/12/1942
[05:14:54] [DOC: 9247712] ℹ️  Service Line extracted: 'PT'
[05:14:54] [DOC: 9247712] ℹ️  Payer Source extracted: 'United Health Care'
[05:14:54] [DOC: 9247712] ℹ️  Diagnosis codes being written:
[05:14:54] [DOC: 9247712] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:14:54] [DOC: 9247712] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:14:54] [DOC: 9247712] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:14:54] [DOC: 9247712] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:14:54] [DOC: 9247712] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:14:54] [DOC: 9247712] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:14:54] [DOC: 9247712] ✅ Patient data written to CSV: Miriam Razon | Sex: FEMALE | Age: 83 | Service: PT | Payer: United Health Care | MRN: 3488015
[05:14:54] ✅    ✅ Document 9247712 processed and saved successfully
[05:14:54] 🔄 
🔄 Step 8: Saving API details...
[05:14:54] [DOC: 9247712] ℹ️  API push details saved for document 9247712
[05:14:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247693                         ║
================================================================================
[05:14:54] ℹ️  Agency: Dartmouth HH
[05:14:54] ℹ️  Date: 04/18/2025
[05:14:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:14:58] [DOC: 9247693] ✅ Text extracted using pdfplumber (12580 chars)
[05:14:59] ✅    ✅ Text extracted using pdfplumber (12568 chars)
[05:14:59] 🔄 
🔄 Step 2: Extracting patient data...
[05:15:02] ℹ️  AI extracted raw sex value: 'F'
[05:15:02] ℹ️  AI extracted service line: 'Skilled Nursing, MSW'
[05:15:02] ℹ️  AI extracted payer source: 'Private Pay'
[05:15:02] ℹ️  AI extracted diagnoses:
[05:15:02] ℹ️    - Diagnosis 1: 'F32.9'
[05:15:02] ℹ️    - Diagnosis 2: 'N39.0'
[05:15:02] ℹ️    - Diagnosis 3: 'F41.9'
[05:15:02] ℹ️    - Diagnosis 4: 'I10'
[05:15:02] ℹ️    - Diagnosis 5: 'G31.84'
[05:15:02] ℹ️    - Diagnosis 6: 'G47.33'
[05:15:02] ℹ️  Final extracted MRN: '227027'
[05:15:02] ℹ️  Final extracted Sex: 'FEMALE'
[05:15:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW'
[05:15:02] ℹ️  Final extracted Payer Source: 'Private Pay'
[05:15:02] ✅ Patient data extraction completed successfully
[05:15:02] ✅    ✅ Patient data extracted successfully
[05:15:02] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Ferreira
     └─ dob: 12/30/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, MSW
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'G31.84', 'sixthDiagnosis': 'G47.33'}]
[05:15:02] ✅    ✅ Patient identified: Janice Ferreira
[05:15:02] ✅    ✅ Patient name validation passed
[05:15:02] 🔄 
🔄 Step 3: Processing patient dates...
[05:15:02] [DOC: 9247693] ℹ️  DOB normalized: 12/30/1934
[05:15:02] [DOC: 9247693] ℹ️  Episode startOfCare normalized: 04/07/2025
[05:15:02] [DOC: 9247693] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[05:15:02] [DOC: 9247693] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[05:15:02] [DOC: 9247693] ✅ Patient date processing completed successfully
[05:15:02] ✅    ✅ Date processing completed
[05:15:02] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Ferreira
     └─ dob: 12/30/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, MSW
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'G31.84', 'sixthDiagnosis': 'G47.33'}]
[05:15:02] 🔄 
🔄 Step 4: Extracting order data...
[05:15:04] ℹ️  Order extraction - MRN: '6816009'
[05:15:04] ℹ️  Order extraction - Sex: 'FEMALE'
[05:15:04] ℹ️  Order extraction - Service Line: 'RN, MSW, SN'
[05:15:04] ℹ️  Order extraction - Payer Source: ''
[05:15:04] ✅ Order data extraction completed successfully
[05:15:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:15:04] ℹ️  Using longer MRN from order data: '6816009' over '227027'
[05:15:04] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW' + Order='RN, MSW, SN' = 'MSW, RN, SN, Skilled Nursing'
[05:15:04] ℹ️  Using payer source from patient data: 'Private Pay'
[05:15:04] ✅ Patient name cross-validation successful
[05:15:04] ✅    ✅ Data merged successfully
[05:15:05] ✅    ✅ Order data extracted and validated
[05:15:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:15:42] [DOC: 9247693] ✅ Patient exists in API: Janice Ferreira, ID: 5722c450-1047-41ac-9d57-21d847ff4b1c
[05:15:42] ✅    ✅ Existing patient found with ID: 5722c450-1047-41ac-9d57-21d847ff4b1c
[05:15:42] 🔄 
🔄 Step 6: Pushing order to API...
[05:15:42] [DOC: 9247693] ℹ️  Pushing order via API for patient ID: 5722c450-1047-41ac-9d57-21d847ff4b1c
[05:15:43] [DOC: 9247693] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:15:43] ❌    ❌ Failed to push order
[05:15:43] 🔄 
🔄 Step 7: Writing to CSV...
[05:15:43] [DOC: 9247693] ℹ️  Calculated age: 90 from DOB: 12/30/1934
[05:15:43] [DOC: 9247693] ℹ️  Service Line extracted: 'MSW, RN, SN, Skilled Nursing'
[05:15:43] [DOC: 9247693] ℹ️  Payer Source extracted: 'Private Pay'
[05:15:43] [DOC: 9247693] ℹ️  Diagnosis codes being written:
[05:15:43] [DOC: 9247693] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.9'
[05:15:43] [DOC: 9247693] ℹ️    - Latest_Episode_Seconddiagnosis: 'N39.0'
[05:15:43] [DOC: 9247693] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[05:15:43] [DOC: 9247693] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[05:15:43] [DOC: 9247693] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G31.84'
[05:15:43] [DOC: 9247693] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[05:15:43] [DOC: 9247693] ✅ Patient data written to CSV: Janice Ferreira | Sex: FEMALE | Age: 90 | Service: MSW, RN, SN, Skilled Nursing | Payer: Private Pay | MRN: 6816009
[05:15:43] ✅    ✅ Document 9247693 processed and saved successfully
[05:15:43] 🔄 
🔄 Step 8: Saving API details...
[05:15:43] [DOC: 9247693] ℹ️  API push details saved for document 9247693
[05:15:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247688                         ║
================================================================================
[05:15:43] ℹ️  Agency: Dartmouth HH
[05:15:43] ℹ️  Date: 04/18/2025
[05:15:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:15:49] [DOC: 9247688] ✅ Text extracted using pdfplumber (1591 chars)
[05:15:49] ✅    ✅ Text extracted using pdfplumber (1591 chars)
[05:15:49] 🔄 
🔄 Step 2: Extracting patient data...
[05:15:51] ℹ️  AI extracted raw sex value: 'F'
[05:15:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:15:51] ℹ️  AI extracted payer source: 'Medicare'
[05:15:51] ℹ️  AI extracted diagnoses:
[05:15:51] ℹ️    - Diagnosis 1: ''
[05:15:51] ℹ️    - Diagnosis 2: ''
[05:15:51] ℹ️    - Diagnosis 3: ''
[05:15:51] ℹ️    - Diagnosis 4: ''
[05:15:51] ℹ️    - Diagnosis 5: ''
[05:15:51] ℹ️    - Diagnosis 6: ''
[05:15:51] ℹ️  Final extracted MRN: '6117015'
[05:15:51] ℹ️  Final extracted Sex: 'FEMALE'
[05:15:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:15:51] ℹ️  Final extracted Payer Source: 'Medicare'
[05:15:51] ✅ Patient data extraction completed successfully
[05:15:51] ✅    ✅ Patient data extracted successfully
[05:15:51] 📊 Patient Response
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:15:51] ✅    ✅ Patient identified: Janet Cabral
[05:15:51] ✅    ✅ Patient name validation passed
[05:15:51] 🔄 
🔄 Step 3: Processing patient dates...
[05:15:51] [DOC: 9247688] ℹ️  DOB normalized: 07/26/1952
[05:15:51] [DOC: 9247688] ℹ️  Episode startOfCare normalized: 02/28/2025
[05:15:51] [DOC: 9247688] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[05:15:51] [DOC: 9247688] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[05:15:51] [DOC: 9247688] ✅ Patient date processing completed successfully
[05:15:51] ✅    ✅ Date processing completed
[05:15:51] 📊 Processed Patient Data
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:15:51] 🔄 
🔄 Step 4: Extracting order data...
[05:15:54] ℹ️  Order extraction - MRN: ''
[05:15:54] ℹ️  Order extraction - Sex: 'FEMALE'
[05:15:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:15:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:15:54] ✅ Order data extraction completed successfully
[05:15:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:15:54] ℹ️  Using MRN from patient data: '6117015'
[05:15:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:15:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:15:54] ✅ Patient name cross-validation successful
[05:15:54] ✅    ✅ Data merged successfully
[05:15:55] ✅    ✅ Order data extracted and validated
[05:15:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:15:55] [DOC: 9247688] ✅ Patient found in local cache: Janet Cabral, ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[05:15:55] ✅    ✅ Existing patient found with ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[05:15:55] 🔄 
🔄 Step 6: Pushing order to API...
[05:15:55] [DOC: 9247688] ℹ️  Pushing order via API for patient ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[05:15:56] [DOC: 9247688] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13425"}
[05:15:56] ❌    ❌ Failed to push order
[05:15:56] 🔄 
🔄 Step 7: Writing to CSV...
[05:15:56] [DOC: 9247688] ℹ️  Calculated age: 72 from DOB: 07/26/1952
[05:15:56] [DOC: 9247688] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:15:56] [DOC: 9247688] ℹ️  Payer Source extracted: 'Medicare'
[05:15:56] [DOC: 9247688] ℹ️  Diagnosis codes being written:
[05:15:56] [DOC: 9247688] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:15:56] [DOC: 9247688] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:15:56] [DOC: 9247688] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:15:56] [DOC: 9247688] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:15:56] [DOC: 9247688] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:15:56] [DOC: 9247688] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:15:56] [DOC: 9247688] ✅ Patient data written to CSV: Janet Cabral | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicare | MRN: 6117015
[05:15:56] ✅    ✅ Document 9247688 processed and saved successfully
[05:15:56] 🔄 
🔄 Step 8: Saving API details...
[05:15:56] [DOC: 9247688] ℹ️  API push details saved for document 9247688
[05:15:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247687                         ║
================================================================================
[05:15:56] ℹ️  Agency: Dartmouth HH
[05:15:56] ℹ️  Date: 04/18/2025
[05:15:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:15:58] [DOC: 9247687] ✅ Text extracted using pdfplumber (1742 chars)
[05:15:58] ✅    ✅ Text extracted using pdfplumber (1742 chars)
[05:15:58] 🔄 
🔄 Step 2: Extracting patient data...
[05:16:01] ℹ️  AI extracted raw sex value: 'F'
[05:16:01] ℹ️  AI extracted service line: 'RN'
[05:16:01] ℹ️  AI extracted payer source: 'Fallon Navicare'
[05:16:01] ℹ️  AI extracted diagnoses:
[05:16:01] ℹ️    - Diagnosis 1: ''
[05:16:01] ℹ️    - Diagnosis 2: ''
[05:16:01] ℹ️    - Diagnosis 3: ''
[05:16:01] ℹ️    - Diagnosis 4: ''
[05:16:01] ℹ️    - Diagnosis 5: ''
[05:16:01] ℹ️    - Diagnosis 6: ''
[05:16:01] ℹ️  Final extracted MRN: '301015'
[05:16:01] ℹ️  Final extracted Sex: 'FEMALE'
[05:16:01] ℹ️  Final extracted Service Line: 'RN'
[05:16:01] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[05:16:01] ✅ Patient data extraction completed successfully
[05:16:01] ✅    ✅ Patient data extracted successfully
[05:16:01] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 117 Bonney Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:16:01] ✅    ✅ Patient identified: Maria Dacosta
[05:16:01] ✅    ✅ Patient name validation passed
[05:16:01] 🔄 
🔄 Step 3: Processing patient dates...
[05:16:01] [DOC: 9247687] ℹ️  DOB normalized: 10/10/1943
[05:16:01] [DOC: 9247687] ℹ️  Episode startOfCare normalized: 04/19/2024
[05:16:01] [DOC: 9247687] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[05:16:01] [DOC: 9247687] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[05:16:01] [DOC: 9247687] ✅ Patient date processing completed successfully
[05:16:01] ✅    ✅ Date processing completed
[05:16:01] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 117 Bonney Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:16:01] 🔄 
🔄 Step 4: Extracting order data...
[05:16:04] ℹ️  Order extraction - MRN: ''
[05:16:04] ℹ️  Order extraction - Sex: 'FEMALE'
[05:16:04] ℹ️  Order extraction - Service Line: 'RN'
[05:16:04] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[05:16:04] ✅ Order data extraction completed successfully
[05:16:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:16:04] ℹ️  Using MRN from patient data: '301015'
[05:16:04] ℹ️  Service line consistent in both sources: 'RN'
[05:16:04] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[05:16:04] ✅ Patient name cross-validation successful
[05:16:04] ✅    ✅ Data merged successfully
[05:16:05] ✅    ✅ Order data extracted and validated
[05:16:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:16:05] [DOC: 9247687] ✅ Patient found in local cache: Maria Dacosta, ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[05:16:05] ✅    ✅ Existing patient found with ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[05:16:05] 🔄 
🔄 Step 6: Pushing order to API...
[05:16:05] [DOC: 9247687] ℹ️  Pushing order via API for patient ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[05:16:06] [DOC: 9247687] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13749"}
[05:16:06] ❌    ❌ Failed to push order
[05:16:06] 🔄 
🔄 Step 7: Writing to CSV...
[05:16:06] [DOC: 9247687] ℹ️  Calculated age: 81 from DOB: 10/10/1943
[05:16:06] [DOC: 9247687] ℹ️  Service Line extracted: 'RN'
[05:16:06] [DOC: 9247687] ℹ️  Payer Source extracted: 'Fallon Navicare'
[05:16:06] [DOC: 9247687] ℹ️  Diagnosis codes being written:
[05:16:06] [DOC: 9247687] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:16:06] [DOC: 9247687] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:16:06] [DOC: 9247687] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:16:06] [DOC: 9247687] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:16:06] [DOC: 9247687] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:16:06] [DOC: 9247687] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:16:06] [DOC: 9247687] ✅ Patient data written to CSV: Maria Dacosta | Sex: FEMALE | Age: 81 | Service: RN | Payer: Fallon Navicare | MRN: 301015
[05:16:06] ✅    ✅ Document 9247687 processed and saved successfully
[05:16:06] 🔄 
🔄 Step 8: Saving API details...
[05:16:06] [DOC: 9247687] ℹ️  API push details saved for document 9247687
[05:16:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247680                         ║
================================================================================
[05:16:06] ℹ️  Agency: Dartmouth HH
[05:16:06] ℹ️  Date: 04/18/2025
[05:16:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:16:10] [DOC: 9247680] ✅ Text extracted using pdfplumber (14421 chars)
[05:16:10] ✅    ✅ Text extracted using pdfplumber (14421 chars)
[05:16:10] 🔄 
🔄 Step 2: Extracting patient data...
[05:16:13] ℹ️  AI extracted raw sex value: 'F'
[05:16:13] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:16:13] ℹ️  AI extracted payer source: ''
[05:16:13] ℹ️  AI extracted diagnoses:
[05:16:13] ℹ️    - Diagnosis 1: 'L97.819'
[05:16:13] ℹ️    - Diagnosis 2: 'I89.0'
[05:16:13] ℹ️    - Diagnosis 3: 'L97.829'
[05:16:13] ℹ️    - Diagnosis 4: 'I12.9'
[05:16:13] ℹ️    - Diagnosis 5: 'N18.30'
[05:16:13] ℹ️    - Diagnosis 6: 'D63.1'
[05:16:13] ℹ️  Final extracted MRN: '4398011'
[05:16:13] ℹ️  Final extracted Sex: 'FEMALE'
[05:16:13] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:16:13] ℹ️  Final extracted Payer Source: ''
[05:16:13] ✅ Patient data extraction completed successfully
[05:16:13] ✅    ✅ Patient data extracted successfully
[05:16:13] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/10/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'L97.819', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'L97.829', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'D63.1'}]
[05:16:13] ✅    ✅ Patient identified: Elaine Dos Santos
[05:16:13] ✅    ✅ Patient name validation passed
[05:16:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:16:13] [DOC: 9247680] ℹ️  DOB normalized: 06/30/1950
[05:16:13] [DOC: 9247680] ℹ️  Episode startOfCare normalized: 12/10/2024
[05:16:13] [DOC: 9247680] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[05:16:13] [DOC: 9247680] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[05:16:13] [DOC: 9247680] ✅ Patient date processing completed successfully
[05:16:13] ✅    ✅ Date processing completed
[05:16:13] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/10/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'L97.819', 'secondDiagnosis': 'I89.0', 'thirdDiagnosis': 'L97.829', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'D63.1'}]
[05:16:13] 🔄 
🔄 Step 4: Extracting order data...
[05:16:16] ℹ️  Order extraction - MRN: '4398011'
[05:16:16] ℹ️  Order extraction - Sex: 'FEMALE'
[05:16:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy'
[05:16:16] ℹ️  Order extraction - Payer Source: ''
[05:16:16] ✅ Order data extraction completed successfully
[05:16:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:16:16] ℹ️  Using MRN from patient data: '4398011' over '4398011'
[05:16:16] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing,Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[05:16:16] ✅ Patient name cross-validation successful
[05:16:16] ✅    ✅ Data merged successfully
[05:16:17] ✅    ✅ Order data extracted and validated
[05:16:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:16:17] [DOC: 9247680] ✅ Patient found in local cache: Elaine Dos Santos, ID: b67987f0-df4a-470f-8698-52193755e58e
[05:16:17] ✅    ✅ Existing patient found with ID: b67987f0-df4a-470f-8698-52193755e58e
[05:16:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:16:17] [DOC: 9247680] ℹ️  Pushing order via API for patient ID: b67987f0-df4a-470f-8698-52193755e58e
[05:16:18] [DOC: 9247680] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:16:18] ❌    ❌ Failed to push order
[05:16:18] 🔄 
🔄 Step 7: Writing to CSV...
[05:16:18] [DOC: 9247680] ℹ️  Calculated age: 74 from DOB: 06/30/1950
[05:16:18] [DOC: 9247680] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[05:16:18] [DOC: 9247680] ℹ️  Payer Source extracted: ''
[05:16:18] [DOC: 9247680] ℹ️  Diagnosis codes being written:
[05:16:18] [DOC: 9247680] ℹ️    - Latest_Episode_Firstdiagnosis: 'L97.819'
[05:16:18] [DOC: 9247680] ℹ️    - Latest_Episode_Seconddiagnosis: 'I89.0'
[05:16:18] [DOC: 9247680] ℹ️    - Latest_Episode_Thirddiagnosis: 'L97.829'
[05:16:18] [DOC: 9247680] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I12.9'
[05:16:18] [DOC: 9247680] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[05:16:18] [DOC: 9247680] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D63.1'
[05:16:18] [DOC: 9247680] ✅ Patient data written to CSV: Elaine Dos Santos | Sex: FEMALE | Age: 74 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 4398011
[05:16:18] ✅    ✅ Document 9247680 processed and saved successfully
[05:16:18] 🔄 
🔄 Step 8: Saving API details...
[05:16:18] [DOC: 9247680] ℹ️  API push details saved for document 9247680
[05:16:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247661                         ║
================================================================================
[05:16:18] ℹ️  Agency: Dartmouth HH
[05:16:18] ℹ️  Date: 04/18/2025
[05:16:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:16:20] [DOC: 9247661] ✅ Text extracted using pdfplumber (1244 chars)
[05:16:20] ✅    ✅ Text extracted using pdfplumber (1244 chars)
[05:16:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:16:22] ℹ️  AI extracted raw sex value: 'F'
[05:16:22] ℹ️  AI extracted service line: 'RN'
[05:16:22] ℹ️  AI extracted payer source: 'Medicare'
[05:16:22] ℹ️  AI extracted diagnoses:
[05:16:22] ℹ️    - Diagnosis 1: ''
[05:16:22] ℹ️    - Diagnosis 2: ''
[05:16:22] ℹ️    - Diagnosis 3: ''
[05:16:22] ℹ️    - Diagnosis 4: ''
[05:16:22] ℹ️    - Diagnosis 5: ''
[05:16:22] ℹ️    - Diagnosis 6: ''
[05:16:22] ℹ️  Final extracted MRN: '421008'
[05:16:22] ℹ️  Final extracted Sex: 'FEMALE'
[05:16:22] ℹ️  Final extracted Service Line: 'RN'
[05:16:22] ℹ️  Final extracted Payer Source: 'Medicare'
[05:16:22] ✅ Patient data extraction completed successfully
[05:16:22] ✅    ✅ Patient data extracted successfully
[05:16:22] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:16:22] ✅    ✅ Patient identified: Nancy Mulcare
[05:16:22] ✅    ✅ Patient name validation passed
[05:16:22] 🔄 
🔄 Step 3: Processing patient dates...
[05:16:22] [DOC: 9247661] ℹ️  DOB normalized: 10/20/1945
[05:16:22] [DOC: 9247661] ℹ️  Episode startOfCare normalized: 03/25/2025
[05:16:22] [DOC: 9247661] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[05:16:22] [DOC: 9247661] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[05:16:22] [DOC: 9247661] ✅ Patient date processing completed successfully
[05:16:22] ✅    ✅ Date processing completed
[05:16:22] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:16:22] 🔄 
🔄 Step 4: Extracting order data...
[05:16:25] ℹ️  Order extraction - MRN: ''
[05:16:25] ℹ️  Order extraction - Sex: 'FEMALE'
[05:16:25] ℹ️  Order extraction - Service Line: 'RN'
[05:16:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:16:25] ✅ Order data extraction completed successfully
[05:16:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:16:25] ℹ️  Using MRN from patient data: '421008'
[05:16:25] ℹ️  Service line consistent in both sources: 'RN'
[05:16:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:16:25] ✅ Patient name cross-validation successful
[05:16:25] ✅    ✅ Data merged successfully
[05:16:26] ✅    ✅ Order data extracted and validated
[05:16:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:16:34] [DOC: 9247661] ℹ️  Patient not found in cache or API: Nancy Mulcare
[05:16:34] [DOC: 9247661] ℹ️  Patient not found, creating new patient via API...
[05:16:34] [DOC: 9247661] ℹ️  Creating patient via API: Nancy Mulcare
[05:16:35] [DOC: 9247661] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:16:35] ❌    ❌ Failed to create patient
[05:16:35] [DOC: 9247661] ℹ️  API push details saved for document 9247661
================================================================================
║                        Processing Document ID: 9247658                         ║
================================================================================
[05:16:35] ℹ️  Agency: Dartmouth HH
[05:16:35] ℹ️  Date: 04/18/2025
[05:16:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:16:37] [DOC: 9247658] ✅ Text extracted using pdfplumber (6959 chars)
[05:16:37] ✅    ✅ Text extracted using pdfplumber (6959 chars)
[05:16:37] 🔄 
🔄 Step 2: Extracting patient data...
[05:16:40] ℹ️  AI extracted raw sex value: 'F'
[05:16:40] ℹ️  AI extracted service line: 'OT'
[05:16:40] ℹ️  AI extracted payer source: 'Medicare'
[05:16:40] ℹ️  AI extracted diagnoses:
[05:16:40] ℹ️    - Diagnosis 1: ''
[05:16:40] ℹ️    - Diagnosis 2: ''
[05:16:40] ℹ️    - Diagnosis 3: ''
[05:16:40] ℹ️    - Diagnosis 4: ''
[05:16:40] ℹ️    - Diagnosis 5: ''
[05:16:40] ℹ️    - Diagnosis 6: ''
[05:16:40] ℹ️  Final extracted MRN: '6323015'
[05:16:40] ℹ️  Final extracted Sex: 'FEMALE'
[05:16:40] ℹ️  Final extracted Service Line: 'OT'
[05:16:40] ℹ️  Final extracted Payer Source: 'Medicare'
[05:16:40] ✅ Patient data extraction completed successfully
[05:16:40] ✅    ✅ Patient data extracted successfully
[05:16:40] 📊 Patient Response
     └─ patientFName: Natalia
     └─ patientLName: Moura
     └─ dob: 10/01/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6323015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:16:40] ✅    ✅ Patient identified: Natalia Moura
[05:16:40] ✅    ✅ Patient name validation passed
[05:16:40] 🔄 
🔄 Step 3: Processing patient dates...
[05:16:40] [DOC: 9247658] ℹ️  DOB normalized: 10/01/1945
[05:16:40] [DOC: 9247658] ℹ️  Episode startOfCare normalized: 04/05/2025
[05:16:40] [DOC: 9247658] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:16:40] [DOC: 9247658] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:16:40] [DOC: 9247658] ✅ Patient date processing completed successfully
[05:16:40] ✅    ✅ Date processing completed
[05:16:40] 📊 Processed Patient Data
     └─ patientFName: Natalia
     └─ patientLName: Moura
     └─ dob: 10/01/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6323015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:16:40] 🔄 
🔄 Step 4: Extracting order data...
[05:16:43] ℹ️  Order extraction - MRN: '3289'
[05:16:43] ℹ️  Order extraction - Sex: 'FEMALE'
[05:16:43] ℹ️  Order extraction - Service Line: 'OT'
[05:16:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:16:43] ✅ Order data extraction completed successfully
[05:16:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:16:43] ℹ️  Using MRN from patient data: '6323015' over '3289'
[05:16:43] ℹ️  Service line consistent in both sources: 'OT'
[05:16:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:16:43] ✅ Patient name cross-validation successful
[05:16:43] ✅    ✅ Data merged successfully
[05:16:44] ✅    ✅ Order data extracted and validated
[05:16:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:17:02] [DOC: 9247658] ℹ️  Patient not found in cache or API: Natalia Moura
[05:17:02] [DOC: 9247658] ℹ️  Patient not found, creating new patient via API...
[05:17:02] [DOC: 9247658] ℹ️  Creating patient via API: Natalia Moura
[05:17:03] [DOC: 9247658] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:17:03] ❌    ❌ Failed to create patient
[05:17:03] [DOC: 9247658] ℹ️  API push details saved for document 9247658
================================================================================
║                        Processing Document ID: 9247656                         ║
================================================================================
[05:17:03] ℹ️  Agency: Dartmouth HH
[05:17:03] ℹ️  Date: 04/18/2025
[05:17:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:17:05] [DOC: 9247656] ✅ Text extracted using pdfplumber (3560 chars)
[05:17:05] ✅    ✅ Text extracted using pdfplumber (3560 chars)
[05:17:05] 🔄 
🔄 Step 2: Extracting patient data...
[05:17:09] ℹ️  AI extracted raw sex value: 'F'
[05:17:09] ℹ️  AI extracted service line: 'OT'
[05:17:09] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[05:17:09] ℹ️  AI extracted diagnoses:
[05:17:09] ℹ️    - Diagnosis 1: ''
[05:17:09] ℹ️    - Diagnosis 2: ''
[05:17:09] ℹ️    - Diagnosis 3: ''
[05:17:09] ℹ️    - Diagnosis 4: ''
[05:17:09] ℹ️    - Diagnosis 5: ''
[05:17:09] ℹ️    - Diagnosis 6: ''
[05:17:09] ℹ️  Final extracted MRN: '6204015'
[05:17:09] ℹ️  Final extracted Sex: 'FEMALE'
[05:17:09] ℹ️  Final extracted Service Line: 'OT'
[05:17:09] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[05:17:09] ✅ Patient data extraction completed successfully
[05:17:09] ✅    ✅ Patient data extracted successfully
[05:17:09] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:17:09] ✅    ✅ Patient identified: Rita Costa
[05:17:09] ✅    ✅ Patient name validation passed
[05:17:09] 🔄 
🔄 Step 3: Processing patient dates...
[05:17:09] [DOC: 9247656] ℹ️  DOB normalized: 10/16/1930
[05:17:09] [DOC: 9247656] ℹ️  Episode startOfCare normalized: 03/17/2025
[05:17:09] [DOC: 9247656] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[05:17:09] [DOC: 9247656] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[05:17:09] [DOC: 9247656] ✅ Patient date processing completed successfully
[05:17:09] ✅    ✅ Date processing completed
[05:17:09] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:17:09] 🔄 
🔄 Step 4: Extracting order data...
[05:17:12] ℹ️  Order extraction - MRN: ''
[05:17:12] ℹ️  Order extraction - Sex: 'FEMALE'
[05:17:12] ℹ️  Order extraction - Service Line: 'OT'
[05:17:12] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[05:17:12] ✅ Order data extraction completed successfully
[05:17:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:17:12] ℹ️  Using MRN from patient data: '6204015'
[05:17:12] ℹ️  Service line consistent in both sources: 'OT'
[05:17:12] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[05:17:12] ✅ Patient name cross-validation successful
[05:17:12] ✅    ✅ Data merged successfully
[05:17:13] ✅    ✅ Order data extracted and validated
[05:17:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:17:21] [DOC: 9247656] ✅ Patient exists in API: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[05:17:22] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[05:17:22] 🔄 
🔄 Step 6: Pushing order to API...
[05:17:22] [DOC: 9247656] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[05:17:23] [DOC: 9247656] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12877"}
[05:17:23] ❌    ❌ Failed to push order
[05:17:23] 🔄 
🔄 Step 7: Writing to CSV...
[05:17:23] [DOC: 9247656] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[05:17:23] [DOC: 9247656] ℹ️  Service Line extracted: 'OT'
[05:17:23] [DOC: 9247656] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[05:17:23] [DOC: 9247656] ℹ️  Diagnosis codes being written:
[05:17:23] [DOC: 9247656] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:17:23] [DOC: 9247656] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:17:23] [DOC: 9247656] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:17:23] [DOC: 9247656] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:17:23] [DOC: 9247656] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:17:23] [DOC: 9247656] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:17:23] [DOC: 9247656] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: OT | Payer: Aetna- Mcare | MRN: 6204015
[05:17:23] ✅    ✅ Document 9247656 processed and saved successfully
[05:17:23] 🔄 
🔄 Step 8: Saving API details...
[05:17:23] [DOC: 9247656] ℹ️  API push details saved for document 9247656
[05:17:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247652                         ║
================================================================================
[05:17:23] ℹ️  Agency: Dartmouth HH
[05:17:23] ℹ️  Date: 04/18/2025
[05:17:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:17:25] [DOC: 9247652] ✅ Text extracted using pdfplumber (8289 chars)
[05:17:25] ✅    ✅ Text extracted using pdfplumber (8289 chars)
[05:17:25] 🔄 
🔄 Step 2: Extracting patient data...
[05:17:28] ℹ️  AI extracted raw sex value: 'F'
[05:17:28] ℹ️  AI extracted service line: 'OT'
[05:17:28] ℹ️  AI extracted payer source: 'Fallon Navicare'
[05:17:28] ℹ️  AI extracted diagnoses:
[05:17:28] ℹ️    - Diagnosis 1: 'G97'
[05:17:28] ℹ️    - Diagnosis 2: 'M54.5'
[05:17:28] ℹ️    - Diagnosis 3: 'M25.511'
[05:17:28] ℹ️    - Diagnosis 4: 'M25.511'
[05:17:28] ℹ️    - Diagnosis 5: 'M15.1'
[05:17:28] ℹ️    - Diagnosis 6: ''
[05:17:28] ℹ️  Final extracted MRN: '6324015'
[05:17:28] ℹ️  Final extracted Sex: 'FEMALE'
[05:17:28] ℹ️  Final extracted Service Line: 'OT'
[05:17:28] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[05:17:28] ✅ Patient data extraction completed successfully
[05:17:28] ✅    ✅ Patient data extracted successfully
[05:17:28] 📊 Patient Response
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6324015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'G97', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'M25.511', 'fourthDiagnosis': 'M25.511', 'fifthDiagnosis': 'M15.1', 'sixthDiagnosis': ''}]
[05:17:28] ✅    ✅ Patient identified: Pascualina Costa
[05:17:28] ✅    ✅ Patient name validation passed
[05:17:28] 🔄 
🔄 Step 3: Processing patient dates...
[05:17:28] [DOC: 9247652] ℹ️  DOB normalized: 12/10/1935
[05:17:28] [DOC: 9247652] ℹ️  Episode startOfCare normalized: 04/04/2025
[05:17:28] [DOC: 9247652] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[05:17:28] [DOC: 9247652] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:17:28] [DOC: 9247652] ✅ Patient date processing completed successfully
[05:17:28] ✅    ✅ Date processing completed
[05:17:28] 📊 Processed Patient Data
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6324015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'G97', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'M25.511', 'fourthDiagnosis': 'M25.511', 'fifthDiagnosis': 'M15.1', 'sixthDiagnosis': ''}]
[05:17:28] 🔄 
🔄 Step 4: Extracting order data...
[05:17:30] ℹ️  Order extraction - MRN: ''
[05:17:30] ℹ️  Order extraction - Sex: 'FEMALE'
[05:17:30] ℹ️  Order extraction - Service Line: 'OT'
[05:17:30] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[05:17:30] ✅ Order data extraction completed successfully
[05:17:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:17:30] ℹ️  Using MRN from patient data: '6324015'
[05:17:30] ℹ️  Service line consistent in both sources: 'OT'
[05:17:30] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[05:17:30] ✅ Patient name cross-validation successful
[05:17:30] ✅    ✅ Data merged successfully
[05:17:31] ✅    ✅ Order data extracted and validated
[05:17:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:17:31] [DOC: 9247652] ✅ Patient found in local cache: Pascualina Costa, ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[05:17:31] ✅    ✅ Existing patient found with ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[05:17:31] 🔄 
🔄 Step 6: Pushing order to API...
[05:17:31] [DOC: 9247652] ℹ️  Pushing order via API for patient ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[05:17:33] [DOC: 9247652] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:17:33] ❌    ❌ Failed to push order
[05:17:33] 🔄 
🔄 Step 7: Writing to CSV...
[05:17:33] [DOC: 9247652] ℹ️  Calculated age: 89 from DOB: 12/10/1935
[05:17:33] [DOC: 9247652] ℹ️  Service Line extracted: 'OT'
[05:17:33] [DOC: 9247652] ℹ️  Payer Source extracted: 'Fallon Navicare'
[05:17:33] [DOC: 9247652] ℹ️  Diagnosis codes being written:
[05:17:33] [DOC: 9247652] ℹ️    - Latest_Episode_Firstdiagnosis: 'G97'
[05:17:33] [DOC: 9247652] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.5'
[05:17:33] [DOC: 9247652] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.511'
[05:17:33] [DOC: 9247652] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M25.511'
[05:17:33] [DOC: 9247652] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M15.1'
[05:17:33] [DOC: 9247652] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:17:33] [DOC: 9247652] ✅ Patient data written to CSV: Pascualina Costa | Sex: FEMALE | Age: 89 | Service: OT | Payer: Fallon Navicare | MRN: 6324015
[05:17:33] ✅    ✅ Document 9247652 processed and saved successfully
[05:17:33] 🔄 
🔄 Step 8: Saving API details...
[05:17:33] [DOC: 9247652] ℹ️  API push details saved for document 9247652
[05:17:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247647                         ║
================================================================================
[05:17:33] ℹ️  Agency: Dartmouth HH
[05:17:33] ℹ️  Date: 04/18/2025
[05:17:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:17:37] [DOC: 9247647] ✅ Text extracted using pdfplumber (1126 chars)
[05:17:37] ✅    ✅ Text extracted using pdfplumber (1126 chars)
[05:17:37] 🔄 
🔄 Step 2: Extracting patient data...
[05:17:40] ℹ️  AI extracted raw sex value: 'F'
[05:17:40] ℹ️  AI extracted service line: 'MSW'
[05:17:40] ℹ️  AI extracted payer source: 'Medicare'
[05:17:40] ℹ️  AI extracted diagnoses:
[05:17:40] ℹ️    - Diagnosis 1: 'None'
[05:17:40] ℹ️    - Diagnosis 2: 'None'
[05:17:40] ℹ️    - Diagnosis 3: 'None'
[05:17:40] ℹ️    - Diagnosis 4: 'None'
[05:17:40] ℹ️    - Diagnosis 5: 'None'
[05:17:40] ℹ️    - Diagnosis 6: 'None'
[05:17:40] ℹ️  Final extracted MRN: '6190015'
[05:17:40] ℹ️  Final extracted Sex: 'FEMALE'
[05:17:40] ℹ️  Final extracted Service Line: 'MSW'
[05:17:40] ℹ️  Final extracted Payer Source: 'Medicare'
[05:17:40] ✅ Patient data extraction completed successfully
[05:17:40] ✅    ✅ Patient data extracted successfully
[05:17:40] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:17:40] ✅    ✅ Patient identified: John Ostapow
[05:17:40] ✅    ✅ Patient name validation passed
[05:17:40] 🔄 
🔄 Step 3: Processing patient dates...
[05:17:40] [DOC: 9247647] ℹ️  DOB normalized: 11/23/1935
[05:17:40] [DOC: 9247647] ℹ️  Episode startOfCare normalized: 03/12/2025
[05:17:40] [DOC: 9247647] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[05:17:40] [DOC: 9247647] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[05:17:40] [DOC: 9247647] ✅ Patient date processing completed successfully
[05:17:40] ✅    ✅ Date processing completed
[05:17:40] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '05/10/2025'}]
[05:17:40] 🔄 
🔄 Step 4: Extracting order data...
[05:17:42] ℹ️  Order extraction - MRN: ''
[05:17:42] ℹ️  Order extraction - Sex: 'FEMALE'
[05:17:42] ℹ️  Order extraction - Service Line: 'MSW'
[05:17:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:17:42] ✅ Order data extraction completed successfully
[05:17:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:17:42] ℹ️  Using MRN from patient data: '6190015'
[05:17:42] ℹ️  Service line consistent in both sources: 'MSW'
[05:17:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:17:42] ✅ Patient name cross-validation successful
[05:17:42] ✅    ✅ Data merged successfully
[05:17:43] ✅    ✅ Order data extracted and validated
[05:17:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:18:10] [DOC: 9247647] ✅ Patient exists in API: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[05:18:10] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[05:18:10] 🔄 
🔄 Step 6: Pushing order to API...
[05:18:10] [DOC: 9247647] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[05:18:12] [DOC: 9247647] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12966"}
[05:18:12] ❌    ❌ Failed to push order
[05:18:12] 🔄 
🔄 Step 7: Writing to CSV...
[05:18:12] [DOC: 9247647] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[05:18:12] [DOC: 9247647] ℹ️  Service Line extracted: 'MSW'
[05:18:12] [DOC: 9247647] ℹ️  Payer Source extracted: 'Medicare'
[05:18:12] [DOC: 9247647] ℹ️  Diagnosis codes being written:
[05:18:12] [DOC: 9247647] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:18:12] [DOC: 9247647] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:18:12] [DOC: 9247647] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:18:12] [DOC: 9247647] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:18:12] [DOC: 9247647] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:18:12] [DOC: 9247647] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:18:12] [DOC: 9247647] ✅ Patient data written to CSV: John Ostapow | Sex: FEMALE | Age: 89 | Service: MSW | Payer: Medicare | MRN: 6190015
[05:18:12] ✅    ✅ Document 9247647 processed and saved successfully
[05:18:12] 🔄 
🔄 Step 8: Saving API details...
[05:18:12] [DOC: 9247647] ℹ️  API push details saved for document 9247647
[05:18:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247641                         ║
================================================================================
[05:18:12] ℹ️  Agency: Dartmouth HH
[05:18:12] ℹ️  Date: 04/18/2025
[05:18:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:18:14] [DOC: 9247641] ✅ Text extracted using pdfplumber (17735 chars)
[05:18:14] ✅    ✅ Text extracted using pdfplumber (17735 chars)
[05:18:14] 🔄 
🔄 Step 2: Extracting patient data...
[05:18:17] ℹ️  AI extracted raw sex value: 'M'
[05:18:17] ℹ️  AI extracted service line: 'PT, OT, RN, LPN'
[05:18:17] ℹ️  AI extracted payer source: 'Medicare'
[05:18:17] ℹ️  AI extracted diagnoses:
[05:18:17] ℹ️    - Diagnosis 1: ''
[05:18:17] ℹ️    - Diagnosis 2: ''
[05:18:17] ℹ️    - Diagnosis 3: ''
[05:18:17] ℹ️    - Diagnosis 4: ''
[05:18:17] ℹ️    - Diagnosis 5: ''
[05:18:17] ℹ️    - Diagnosis 6: ''
[05:18:17] ℹ️  Final extracted MRN: '864008'
[05:18:17] ℹ️  Final extracted Sex: 'MALE'
[05:18:17] ℹ️  Final extracted Service Line: 'PT, OT, RN, LPN'
[05:18:17] ℹ️  Final extracted Payer Source: 'Medicare'
[05:18:17] ✅ Patient data extraction completed successfully
[05:18:17] ✅    ✅ Patient data extracted successfully
[05:18:17] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:18:17] ✅    ✅ Patient identified: Robert Lawton
[05:18:17] ✅    ✅ Patient name validation passed
[05:18:17] 🔄 
🔄 Step 3: Processing patient dates...
[05:18:17] [DOC: 9247641] ℹ️  DOB normalized: 06/15/1943
[05:18:17] [DOC: 9247641] ℹ️  Episode startOfCare normalized: 03/18/2025
[05:18:17] [DOC: 9247641] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[05:18:17] [DOC: 9247641] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[05:18:17] [DOC: 9247641] ✅ Patient date processing completed successfully
[05:18:17] ✅    ✅ Date processing completed
[05:18:17] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:18:17] 🔄 
🔄 Step 4: Extracting order data...
[05:18:20] ℹ️  Order extraction - MRN: ''
[05:18:20] ℹ️  Order extraction - Sex: 'MALE'
[05:18:20] ℹ️  Order extraction - Service Line: 'PT, OT, RN, LPN'
[05:18:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:18:20] ✅ Order data extraction completed successfully
[05:18:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:20] ℹ️  Using MRN from patient data: '864008'
[05:18:20] ℹ️  Service line consistent in both sources: 'PT, OT, RN, LPN'
[05:18:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:18:20] ✅ Patient name cross-validation successful
[05:18:20] ✅    ✅ Data merged successfully
[05:18:21] ✅    ✅ Order data extracted and validated
[05:18:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:18:30] [DOC: 9247641] ℹ️  Patient not found in cache or API: Robert Lawton
[05:18:30] [DOC: 9247641] ℹ️  Patient not found, creating new patient via API...
[05:18:30] [DOC: 9247641] ℹ️  Creating patient via API: Robert Lawton
[05:18:31] [DOC: 9247641] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:18:31] ❌    ❌ Failed to create patient
[05:18:31] [DOC: 9247641] ℹ️  API push details saved for document 9247641
================================================================================
║                        Processing Document ID: 9247638                         ║
================================================================================
[05:18:31] ℹ️  Agency: Dartmouth HH
[05:18:31] ℹ️  Date: 04/18/2025
[05:18:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:18:35] [DOC: 9247638] ✅ Text extracted using pdfplumber (11778 chars)
[05:18:35] ✅    ✅ Text extracted using pdfplumber (11766 chars)
[05:18:35] 🔄 
🔄 Step 2: Extracting patient data...
[05:18:38] ℹ️  AI extracted raw sex value: 'M'
[05:18:38] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[05:18:38] ℹ️  AI extracted payer source: ''
[05:18:38] ℹ️  AI extracted diagnoses:
[05:18:38] ℹ️    - Diagnosis 1: 'S72.142D'
[05:18:38] ℹ️    - Diagnosis 2: 'D47.1'
[05:18:38] ℹ️    - Diagnosis 3: 'E87.1'
[05:18:38] ℹ️    - Diagnosis 4: 'I48.0'
[05:18:38] ℹ️    - Diagnosis 5: 'I10'
[05:18:38] ℹ️    - Diagnosis 6: 'N40.0'
[05:18:38] ℹ️  Final extracted MRN: '864008'
[05:18:38] ℹ️  Final extracted Sex: 'MALE'
[05:18:38] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[05:18:38] ℹ️  Final extracted Payer Source: ''
[05:18:38] ✅ Patient data extraction completed successfully
[05:18:38] ✅    ✅ Patient data extracted successfully
[05:18:38] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': 'S72.142D', 'secondDiagnosis': 'D47.1', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'N40.0'}]
[05:18:38] ✅    ✅ Patient identified: Robert Lawton
[05:18:38] ✅    ✅ Patient name validation passed
[05:18:38] 🔄 
🔄 Step 3: Processing patient dates...
[05:18:38] [DOC: 9247638] ℹ️  DOB normalized: 06/15/1943
[05:18:38] [DOC: 9247638] ℹ️  Episode startOfCare normalized: 03/18/2025
[05:18:38] [DOC: 9247638] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[05:18:38] [DOC: 9247638] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[05:18:38] [DOC: 9247638] ✅ Patient date processing completed successfully
[05:18:38] ✅    ✅ Date processing completed
[05:18:38] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': 'S72.142D', 'secondDiagnosis': 'D47.1', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'N40.0'}]
[05:18:38] 🔄 
🔄 Step 4: Extracting order data...
[05:18:41] ℹ️  Order extraction - MRN: '864008'
[05:18:41] ℹ️  Order extraction - Sex: 'MALE'
[05:18:41] ℹ️  Order extraction - Service Line: 'PT, OT, Skilled Nursing'
[05:18:41] ℹ️  Order extraction - Payer Source: ''
[05:18:41] ✅ Order data extraction completed successfully
[05:18:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:18:41] ℹ️  Using MRN from patient data: '864008' over '864008'
[05:18:41] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='PT, OT, Skilled Nursing' = 'OT, PT, Skilled Nursing'
[05:18:41] ✅ Patient name cross-validation successful
[05:18:41] ✅    ✅ Data merged successfully
[05:18:42] ✅    ✅ Order data extracted and validated
[05:18:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:18:58] [DOC: 9247638] ℹ️  Patient not found in cache or API: Robert Lawton
[05:18:58] [DOC: 9247638] ℹ️  Patient not found, creating new patient via API...
[05:18:58] [DOC: 9247638] ℹ️  Creating patient via API: Robert Lawton
[05:19:00] [DOC: 9247638] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:19:00] ❌    ❌ Failed to create patient
[05:19:00] [DOC: 9247638] ℹ️  API push details saved for document 9247638
================================================================================
║                        Processing Document ID: 9247615                         ║
================================================================================
[05:19:00] ℹ️  Agency: Nizhoni Health-Fall River
[05:19:00] ℹ️  Date: 04/18/2025
[05:19:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:03] [DOC: 9247615] ✅ Text extracted using pdfplumber (1531 chars)
[05:19:03] ✅    ✅ Text extracted using pdfplumber (1531 chars)
[05:19:03] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:05] ℹ️  AI extracted raw sex value: 'F'
[05:19:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:19:05] ℹ️  AI extracted payer source: 'Medicaid/MA'
[05:19:05] ℹ️  AI extracted diagnoses:
[05:19:05] ℹ️    - Diagnosis 1: ''
[05:19:05] ℹ️    - Diagnosis 2: ''
[05:19:05] ℹ️    - Diagnosis 3: ''
[05:19:05] ℹ️    - Diagnosis 4: ''
[05:19:05] ℹ️    - Diagnosis 5: ''
[05:19:05] ℹ️    - Diagnosis 6: ''
[05:19:05] ℹ️  Final extracted MRN: '17207020'
[05:19:05] ℹ️  Final extracted Sex: 'FEMALE'
[05:19:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:19:05] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[05:19:05] ✅ Patient data extraction completed successfully
[05:19:05] ✅    ✅ Patient data extracted successfully
[05:19:05] 📊 Patient Response
     └─ patientFName: Tammy
     └─ patientLName: Alves
     └─ dob: 04/30/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 17207020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:05] ✅    ✅ Patient identified: Tammy Alves
[05:19:05] ✅    ✅ Patient name validation passed
[05:19:05] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:05] [DOC: 9247615] ℹ️  DOB normalized: 04/30/1981
[05:19:05] [DOC: 9247615] ℹ️  Episode startOfCare normalized: 03/26/2025
[05:19:05] [DOC: 9247615] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[05:19:05] [DOC: 9247615] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[05:19:05] [DOC: 9247615] ✅ Patient date processing completed successfully
[05:19:05] ✅    ✅ Date processing completed
[05:19:05] 📊 Processed Patient Data
     └─ patientFName: Tammy
     └─ patientLName: Alves
     └─ dob: 04/30/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 17207020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:05] 🔄 
🔄 Step 4: Extracting order data...
[05:19:08] ℹ️  Order extraction - MRN: '17207020'
[05:19:08] ℹ️  Order extraction - Sex: 'FEMALE'
[05:19:08] ℹ️  Order extraction - Service Line: 'RN'
[05:19:08] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[05:19:08] ✅ Order data extraction completed successfully
[05:19:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:08] ℹ️  Using MRN from patient data: '17207020' over '17207020'
[05:19:08] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[05:19:08] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[05:19:08] ✅ Patient name cross-validation successful
[05:19:08] ✅    ✅ Data merged successfully
[05:19:09] ✅    ✅ Order data extracted and validated
[05:19:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:19:09] [DOC: 9247615] ✅ Patient found in local cache: Tammy Alves, ID: b762ac43-5719-4426-a8a1-b93c8317b643
[05:19:09] ✅    ✅ Existing patient found with ID: b762ac43-5719-4426-a8a1-b93c8317b643
[05:19:09] 🔄 
🔄 Step 6: Pushing order to API...
[05:19:09] [DOC: 9247615] ℹ️  Pushing order via API for patient ID: b762ac43-5719-4426-a8a1-b93c8317b643
[05:19:10] [DOC: 9247615] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:19:10] ❌    ❌ Failed to push order
[05:19:10] 🔄 
🔄 Step 7: Writing to CSV...
[05:19:10] [DOC: 9247615] ℹ️  Calculated age: 44 from DOB: 04/30/1981
[05:19:10] [DOC: 9247615] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[05:19:10] [DOC: 9247615] ℹ️  Payer Source extracted: 'Medicaid/MA'
[05:19:10] [DOC: 9247615] ℹ️  Diagnosis codes being written:
[05:19:10] [DOC: 9247615] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:19:10] [DOC: 9247615] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:19:10] [DOC: 9247615] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:19:10] [DOC: 9247615] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:19:10] [DOC: 9247615] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:19:10] [DOC: 9247615] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:19:10] [DOC: 9247615] ✅ Patient data written to CSV: Tammy Alves | Sex: FEMALE | Age: 44 | Service: RN, Skilled Nursing | Payer: Medicaid/MA | MRN: 17207020
[05:19:10] ✅    ✅ Document 9247615 processed and saved successfully
[05:19:10] 🔄 
🔄 Step 8: Saving API details...
[05:19:10] [DOC: 9247615] ℹ️  API push details saved for document 9247615
[05:19:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247568                         ║
================================================================================
[05:19:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:19:10] ℹ️  Date: 04/18/2025
[05:19:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:12] [DOC: 9247568] ✅ Text extracted using pdfplumber (1682 chars)
[05:19:12] ✅    ✅ Text extracted using pdfplumber (1670 chars)
[05:19:12] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:15] ℹ️  AI extracted raw sex value: ''
[05:19:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:19:15] ℹ️  AI extracted payer source: ''
[05:19:15] ℹ️  AI extracted diagnoses:
[05:19:15] ℹ️    - Diagnosis 1: 'I48.19'
[05:19:15] ℹ️    - Diagnosis 2: 'I50.32'
[05:19:15] ℹ️    - Diagnosis 3: 'N18.31'
[05:19:15] ℹ️    - Diagnosis 4: ''
[05:19:15] ℹ️    - Diagnosis 5: ''
[05:19:15] ℹ️    - Diagnosis 6: ''
[05:19:15] ℹ️  Final extracted MRN: 'MA240214024201'
[05:19:15] ℹ️  Final extracted Sex: ''
[05:19:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:19:15] ℹ️  Final extracted Payer Source: ''
[05:19:15] ✅ Patient data extraction completed successfully
[05:19:15] ✅    ✅ Patient data extracted successfully
[05:19:15] 📊 Patient Response
     └─ patientFName: Charles
     └─ patientLName: Gaspar
     └─ dob: 02/28/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA240214024201
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I48.19', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:15] ✅    ✅ Patient identified: Charles Gaspar
[05:19:15] ✅    ✅ Patient name validation passed
[05:19:15] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:15] [DOC: 9247568] ℹ️  DOB normalized: 02/28/1942
[05:19:15] [DOC: 9247568] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[05:19:15] [DOC: 9247568] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[05:19:15] [DOC: 9247568] ✅ Patient date processing completed successfully
[05:19:15] ✅    ✅ Date processing completed
[05:19:15] 📊 Processed Patient Data
     └─ patientFName: Charles
     └─ patientLName: Gaspar
     └─ dob: 02/28/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA240214024201
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'I48.19', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:15] 🔄 
🔄 Step 4: Extracting order data...
[05:19:18] ℹ️  Order extraction - MRN: 'MA240214024201'
[05:19:18] ℹ️  Order extraction - Sex: ''
[05:19:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:19:18] ℹ️  Order extraction - Payer Source: ''
[05:19:18] ✅ Order data extraction completed successfully
[05:19:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:18] ℹ️  Using MRN from patient data: 'MA240214024201' over 'MA240214024201'
[05:19:18] ℹ️  Inferred sex as MALE from name: Charles
[05:19:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:19:18] ✅ Patient name cross-validation successful
[05:19:18] ✅    ✅ Data merged successfully
[05:19:19] ✅    ✅ Order data extracted and validated
[05:19:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:19:19] [DOC: 9247568] ✅ Patient found in local cache: Charles Gaspar, ID: 876abdb3-5fa6-4c38-a4b6-a838b1d703e7
[05:19:19] ✅    ✅ Existing patient found with ID: 876abdb3-5fa6-4c38-a4b6-a838b1d703e7
[05:19:19] 🔄 
🔄 Step 6: Pushing order to API...
[05:19:19] [DOC: 9247568] ℹ️  Pushing order via API for patient ID: 876abdb3-5fa6-4c38-a4b6-a838b1d703e7
[05:19:20] [DOC: 9247568] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13772"}
[05:19:20] ❌    ❌ Failed to push order
[05:19:20] 🔄 
🔄 Step 7: Writing to CSV...
[05:19:20] [DOC: 9247568] ℹ️  Calculated age: 83 from DOB: 02/28/1942
[05:19:20] [DOC: 9247568] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:19:20] [DOC: 9247568] ℹ️  Payer Source extracted: ''
[05:19:20] [DOC: 9247568] ℹ️  Diagnosis codes being written:
[05:19:20] [DOC: 9247568] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.19'
[05:19:20] [DOC: 9247568] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[05:19:20] [DOC: 9247568] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[05:19:20] [DOC: 9247568] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:19:20] [DOC: 9247568] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:19:20] [DOC: 9247568] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:19:20] [DOC: 9247568] ✅ Patient data written to CSV: Charles Gaspar | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: MA240214024201
[05:19:20] ✅    ✅ Document 9247568 processed and saved successfully
[05:19:20] 🔄 
🔄 Step 8: Saving API details...
[05:19:20] [DOC: 9247568] ℹ️  API push details saved for document 9247568
[05:19:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247565                         ║
================================================================================
[05:19:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:19:20] ℹ️  Date: 04/18/2025
[05:19:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:23] [DOC: 9247565] ✅ Text extracted using pdfplumber (1632 chars)
[05:19:23] ✅    ✅ Text extracted using pdfplumber (1632 chars)
[05:19:23] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:25] ℹ️  AI extracted raw sex value: ''
[05:19:25] ℹ️  AI extracted service line: 'Wound care'
[05:19:25] ℹ️  AI extracted payer source: ''
[05:19:25] ℹ️  AI extracted diagnoses:
[05:19:25] ℹ️    - Diagnosis 1: 'J43.9'
[05:19:25] ℹ️    - Diagnosis 2: 'J96.11'
[05:19:25] ℹ️    - Diagnosis 3: 'J96.12'
[05:19:25] ℹ️    - Diagnosis 4: 'None'
[05:19:25] ℹ️    - Diagnosis 5: 'None'
[05:19:25] ℹ️    - Diagnosis 6: 'None'
[05:19:25] ℹ️  Final extracted MRN: 'MA250331114803'
[05:19:25] ℹ️  Final extracted Sex: ''
[05:19:25] ℹ️  Final extracted Service Line: 'Wound care'
[05:19:25] ℹ️  Final extracted Payer Source: ''
[05:19:25] ✅ Patient data extraction completed successfully
[05:19:25] ✅    ✅ Patient data extracted successfully
[05:19:25] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Wound care
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:19:25] ✅    ✅ Patient identified: David Sturgeon
[05:19:25] ✅    ✅ Patient name validation passed
[05:19:25] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:25] [DOC: 9247565] ℹ️  DOB normalized: 11/14/1948
[05:19:25] [DOC: 9247565] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:19:25] [DOC: 9247565] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:19:25] [DOC: 9247565] ✅ Patient date processing completed successfully
[05:19:25] ✅    ✅ Date processing completed
[05:19:25] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Wound care
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12'}]
[05:19:25] 🔄 
🔄 Step 4: Extracting order data...
[05:19:28] ℹ️  Order extraction - MRN: 'MA250331114803'
[05:19:28] ℹ️  Order extraction - Sex: ''
[05:19:28] ℹ️  Order extraction - Service Line: 'Wound Care, RN'
[05:19:28] ℹ️  Order extraction - Payer Source: ''
[05:19:28] ✅ Order data extraction completed successfully
[05:19:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:28] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[05:19:28] ℹ️  Inferred sex as MALE from name: David
[05:19:28] ℹ️  Combined service lines: Patient='Wound care' + Order='Wound Care, RN' = 'RN, Wound Care, Wound care'
[05:19:28] ✅ Patient name cross-validation successful
[05:19:28] ✅    ✅ Data merged successfully
[05:19:29] ✅    ✅ Order data extracted and validated
[05:19:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:19:29] [DOC: 9247565] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[05:19:29] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[05:19:29] 🔄 
🔄 Step 6: Pushing order to API...
[05:19:29] [DOC: 9247565] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[05:19:31] [DOC: 9247565] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14460"}
[05:19:31] ❌    ❌ Failed to push order
[05:19:31] 🔄 
🔄 Step 7: Writing to CSV...
[05:19:31] [DOC: 9247565] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[05:19:31] [DOC: 9247565] ℹ️  Service Line extracted: 'RN, Wound Care, Wound care'
[05:19:31] [DOC: 9247565] ℹ️  Payer Source extracted: ''
[05:19:31] [DOC: 9247565] ℹ️  Diagnosis codes being written:
[05:19:31] [DOC: 9247565] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.9'
[05:19:31] [DOC: 9247565] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.11'
[05:19:31] [DOC: 9247565] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.12'
[05:19:31] [DOC: 9247565] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:19:31] [DOC: 9247565] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:19:31] [DOC: 9247565] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:19:31] [DOC: 9247565] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: RN, Wound Care, Wound care | Payer:  | MRN: MA250331114803
[05:19:31] ✅    ✅ Document 9247565 processed and saved successfully
[05:19:31] 🔄 
🔄 Step 8: Saving API details...
[05:19:31] [DOC: 9247565] ℹ️  API push details saved for document 9247565
[05:19:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247562                         ║
================================================================================
[05:19:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:19:31] ℹ️  Date: 04/18/2025
[05:19:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:34] [DOC: 9247562] ✅ Text extracted using pdfplumber (1698 chars)
[05:19:34] ✅    ✅ Text extracted using pdfplumber (1698 chars)
[05:19:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:36] ℹ️  AI extracted raw sex value: ''
[05:19:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:19:36] ℹ️  AI extracted payer source: ''
[05:19:36] ℹ️  AI extracted diagnoses:
[05:19:36] ℹ️    - Diagnosis 1: 'J43.9'
[05:19:36] ℹ️    - Diagnosis 2: 'J96.11'
[05:19:36] ℹ️    - Diagnosis 3: 'J96.12'
[05:19:36] ℹ️    - Diagnosis 4: 'None'
[05:19:36] ℹ️    - Diagnosis 5: 'None'
[05:19:36] ℹ️    - Diagnosis 6: 'None'
[05:19:36] ℹ️  Final extracted MRN: 'MA250331114803'
[05:19:36] ℹ️  Final extracted Sex: ''
[05:19:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:19:36] ℹ️  Final extracted Payer Source: ''
[05:19:36] ✅ Patient data extraction completed successfully
[05:19:36] ✅    ✅ Patient data extracted successfully
[05:19:36] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:19:36] ✅    ✅ Patient identified: David Sturgeon
[05:19:36] ✅    ✅ Patient name validation passed
[05:19:36] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:36] [DOC: 9247562] ℹ️  DOB normalized: 11/14/1948
[05:19:36] [DOC: 9247562] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:19:36] [DOC: 9247562] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:19:36] [DOC: 9247562] ✅ Patient date processing completed successfully
[05:19:36] ✅    ✅ Date processing completed
[05:19:36] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12'}]
[05:19:36] 🔄 
🔄 Step 4: Extracting order data...
[05:19:39] ℹ️  Order extraction - MRN: 'MA250331114803'
[05:19:39] ℹ️  Order extraction - Sex: ''
[05:19:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:19:39] ℹ️  Order extraction - Payer Source: ''
[05:19:39] ✅ Order data extraction completed successfully
[05:19:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:39] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[05:19:39] ℹ️  Inferred sex as MALE from name: David
[05:19:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:19:39] ✅ Patient name cross-validation successful
[05:19:39] ✅    ✅ Data merged successfully
[05:19:41] ✅    ✅ Order data extracted and validated
[05:19:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:19:41] [DOC: 9247562] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[05:19:41] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[05:19:41] 🔄 
🔄 Step 6: Pushing order to API...
[05:19:41] [DOC: 9247562] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[05:19:42] [DOC: 9247562] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14461"}
[05:19:42] ❌    ❌ Failed to push order
[05:19:42] 🔄 
🔄 Step 7: Writing to CSV...
[05:19:42] [DOC: 9247562] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[05:19:42] [DOC: 9247562] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:19:42] [DOC: 9247562] ℹ️  Payer Source extracted: ''
[05:19:42] [DOC: 9247562] ℹ️  Diagnosis codes being written:
[05:19:42] [DOC: 9247562] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.9'
[05:19:42] [DOC: 9247562] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.11'
[05:19:42] [DOC: 9247562] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.12'
[05:19:42] [DOC: 9247562] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:19:42] [DOC: 9247562] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:19:42] [DOC: 9247562] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:19:42] [DOC: 9247562] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: Skilled Nursing | Payer:  | MRN: MA250331114803
[05:19:42] ✅    ✅ Document 9247562 processed and saved successfully
[05:19:42] 🔄 
🔄 Step 8: Saving API details...
[05:19:42] [DOC: 9247562] ℹ️  API push details saved for document 9247562
[05:19:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247545                         ║
================================================================================
[05:19:42] ℹ️  Agency: Dartmouth HH
[05:19:42] ℹ️  Date: 04/18/2025
[05:19:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:19:44] [DOC: 9247545] ✅ Text extracted using pdfplumber (1138 chars)
[05:19:44] ✅    ✅ Text extracted using pdfplumber (1138 chars)
[05:19:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:19:47] ℹ️  AI extracted raw sex value: 'F'
[05:19:47] ℹ️  AI extracted service line: 'RN'
[05:19:47] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[05:19:47] ℹ️  AI extracted diagnoses:
[05:19:47] ℹ️    - Diagnosis 1: ''
[05:19:47] ℹ️    - Diagnosis 2: ''
[05:19:47] ℹ️    - Diagnosis 3: ''
[05:19:47] ℹ️    - Diagnosis 4: ''
[05:19:47] ℹ️    - Diagnosis 5: ''
[05:19:47] ℹ️    - Diagnosis 6: ''
[05:19:47] ℹ️  Final extracted MRN: '5843015'
[05:19:47] ℹ️  Final extracted Sex: 'FEMALE'
[05:19:47] ℹ️  Final extracted Service Line: 'RN'
[05:19:47] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[05:19:47] ✅ Patient data extraction completed successfully
[05:19:47] ✅    ✅ Patient data extracted successfully
[05:19:47] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:47] ✅    ✅ Patient identified: Joanne Medeiros
[05:19:47] ✅    ✅ Patient name validation passed
[05:19:47] 🔄 
🔄 Step 3: Processing patient dates...
[05:19:47] [DOC: 9247545] ℹ️  DOB normalized: 12/09/1952
[05:19:47] [DOC: 9247545] ℹ️  Episode startOfCare normalized: 01/15/2025
[05:19:47] [DOC: 9247545] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[05:19:47] [DOC: 9247545] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[05:19:47] [DOC: 9247545] ✅ Patient date processing completed successfully
[05:19:47] ✅    ✅ Date processing completed
[05:19:47] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:19:47] 🔄 
🔄 Step 4: Extracting order data...
[05:19:50] ℹ️  Order extraction - MRN: ''
[05:19:50] ℹ️  Order extraction - Sex: 'FEMALE'
[05:19:50] ℹ️  Order extraction - Service Line: 'RN'
[05:19:50] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[05:19:50] ✅ Order data extraction completed successfully
[05:19:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:19:50] ℹ️  Using MRN from patient data: '5843015'
[05:19:50] ℹ️  Service line consistent in both sources: 'RN'
[05:19:50] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[05:19:50] ✅ Patient name cross-validation successful
[05:19:50] ✅    ✅ Data merged successfully
[05:19:51] ✅    ✅ Order data extracted and validated
[05:19:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:20:09] [DOC: 9247545] ℹ️  Patient not found in cache or API: Joanne Medeiros
[05:20:09] [DOC: 9247545] ℹ️  Patient not found, creating new patient via API...
[05:20:09] [DOC: 9247545] ℹ️  Creating patient via API: Joanne Medeiros
[05:20:10] [DOC: 9247545] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:20:10] ❌    ❌ Failed to create patient
[05:20:10] [DOC: 9247545] ℹ️  API push details saved for document 9247545
================================================================================
║                        Processing Document ID: 9247513                         ║
================================================================================
[05:20:10] ℹ️  Agency: Fairhaven HH&H
[05:20:10] ℹ️  Date: 04/18/2025
[05:20:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:20:13] [DOC: 9247513] ✅ Text extracted using pdfplumber (1234 chars)
[05:20:13] ✅    ✅ Text extracted using pdfplumber (1234 chars)
[05:20:13] 🔄 
🔄 Step 2: Extracting patient data...
[05:20:15] ℹ️  AI extracted raw sex value: 'F'
[05:20:15] ℹ️  AI extracted service line: 'HHA'
[05:20:15] ℹ️  AI extracted payer source: 'Medicare'
[05:20:15] ℹ️  AI extracted diagnoses:
[05:20:15] ℹ️    - Diagnosis 1: ''
[05:20:15] ℹ️    - Diagnosis 2: ''
[05:20:15] ℹ️    - Diagnosis 3: ''
[05:20:15] ℹ️    - Diagnosis 4: ''
[05:20:15] ℹ️    - Diagnosis 5: ''
[05:20:15] ℹ️    - Diagnosis 6: ''
[05:20:15] ℹ️  Final extracted MRN: '2406002'
[05:20:15] ℹ️  Final extracted Sex: 'FEMALE'
[05:20:15] ℹ️  Final extracted Service Line: 'HHA'
[05:20:15] ℹ️  Final extracted Payer Source: 'Medicare'
[05:20:15] ✅ Patient data extraction completed successfully
[05:20:15] ✅    ✅ Patient data extracted successfully
[05:20:15] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:20:15] ✅    ✅ Patient identified: Patricia Lobo
[05:20:15] ✅    ✅ Patient name validation passed
[05:20:15] 🔄 
🔄 Step 3: Processing patient dates...
[05:20:15] [DOC: 9247513] ℹ️  DOB normalized: 02/06/1938
[05:20:15] [DOC: 9247513] ℹ️  Episode startOfCare normalized: 06/05/2024
[05:20:15] [DOC: 9247513] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[05:20:15] [DOC: 9247513] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[05:20:15] [DOC: 9247513] ✅ Patient date processing completed successfully
[05:20:15] ✅    ✅ Date processing completed
[05:20:15] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:20:15] 🔄 
🔄 Step 4: Extracting order data...
[05:20:18] ℹ️  Order extraction - MRN: ''
[05:20:18] ℹ️  Order extraction - Sex: 'FEMALE'
[05:20:18] ℹ️  Order extraction - Service Line: 'Hospice'
[05:20:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:20:18] ✅ Order data extraction completed successfully
[05:20:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:20:18] ℹ️  Using MRN from patient data: '2406002'
[05:20:18] ℹ️  Combined service lines: Patient='HHA' + Order='Hospice' = 'HHA, Hospice'
[05:20:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:20:18] ✅ Patient name cross-validation successful
[05:20:18] ✅    ✅ Data merged successfully
[05:20:19] ✅    ✅ Order data extracted and validated
[05:20:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:20:19] [DOC: 9247513] ✅ Patient found in local cache: Patricia Lobo, ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[05:20:19] ✅    ✅ Existing patient found with ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[05:20:19] 🔄 
🔄 Step 6: Pushing order to API...
[05:20:19] [DOC: 9247513] ℹ️  Pushing order via API for patient ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[05:20:20] [DOC: 9247513] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13949"}
[05:20:20] ❌    ❌ Failed to push order
[05:20:20] 🔄 
🔄 Step 7: Writing to CSV...
[05:20:20] [DOC: 9247513] ℹ️  Calculated age: 87 from DOB: 02/06/1938
[05:20:20] [DOC: 9247513] ℹ️  Service Line extracted: 'HHA, Hospice'
[05:20:20] [DOC: 9247513] ℹ️  Payer Source extracted: 'Medicare'
[05:20:20] [DOC: 9247513] ℹ️  Diagnosis codes being written:
[05:20:20] [DOC: 9247513] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:20:20] [DOC: 9247513] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:20:20] [DOC: 9247513] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:20:20] [DOC: 9247513] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:20:20] [DOC: 9247513] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:20:20] [DOC: 9247513] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:20:20] [DOC: 9247513] ✅ Patient data written to CSV: Patricia Lobo | Sex: FEMALE | Age: 87 | Service: HHA, Hospice | Payer: Medicare | MRN: 2406002
[05:20:20] ✅    ✅ Document 9247513 processed and saved successfully
[05:20:20] 🔄 
🔄 Step 8: Saving API details...
[05:20:20] [DOC: 9247513] ℹ️  API push details saved for document 9247513
[05:20:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247512                         ║
================================================================================
[05:20:20] ℹ️  Agency: Fairhaven HH&H
[05:20:20] ℹ️  Date: 04/18/2025
[05:20:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:20:22] [DOC: 9247512] ✅ Text extracted using pdfplumber (1050 chars)
[05:20:22] ✅    ✅ Text extracted using pdfplumber (1050 chars)
[05:20:22] 🔄 
🔄 Step 2: Extracting patient data...
[05:20:25] ℹ️  AI extracted raw sex value: 'F'
[05:20:25] ℹ️  AI extracted service line: 'HHA'
[05:20:25] ℹ️  AI extracted payer source: 'Medicare'
[05:20:25] ℹ️  AI extracted diagnoses:
[05:20:25] ℹ️    - Diagnosis 1: ''
[05:20:25] ℹ️    - Diagnosis 2: ''
[05:20:25] ℹ️    - Diagnosis 3: ''
[05:20:25] ℹ️    - Diagnosis 4: ''
[05:20:25] ℹ️    - Diagnosis 5: ''
[05:20:25] ℹ️    - Diagnosis 6: ''
[05:20:25] ℹ️  Final extracted MRN: '4758015'
[05:20:25] ℹ️  Final extracted Sex: 'FEMALE'
[05:20:25] ℹ️  Final extracted Service Line: 'HHA'
[05:20:25] ℹ️  Final extracted Payer Source: 'Medicare'
[05:20:25] ✅ Patient data extraction completed successfully
[05:20:25] ✅    ✅ Patient data extracted successfully
[05:20:25] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Sylvia
     └─ dob: 03/21/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4758015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/13/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:20:25] ✅    ✅ Patient identified: Beverly Sylvia
[05:20:25] ✅    ✅ Patient name validation passed
[05:20:25] 🔄 
🔄 Step 3: Processing patient dates...
[05:20:25] [DOC: 9247512] ℹ️  DOB normalized: 03/21/1937
[05:20:25] [DOC: 9247512] ℹ️  Episode startOfCare normalized: 06/13/2024
[05:20:25] [DOC: 9247512] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[05:20:25] [DOC: 9247512] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[05:20:25] [DOC: 9247512] ✅ Patient date processing completed successfully
[05:20:25] ✅    ✅ Date processing completed
[05:20:25] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Sylvia
     └─ dob: 03/21/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4758015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/13/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:20:25] 🔄 
🔄 Step 4: Extracting order data...
[05:20:27] ℹ️  Order extraction - MRN: '4758015'
[05:20:27] ℹ️  Order extraction - Sex: 'FEMALE'
[05:20:27] ℹ️  Order extraction - Service Line: ''
[05:20:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:20:27] ✅ Order data extraction completed successfully
[05:20:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:20:27] ℹ️  Using MRN from patient data: '4758015' over '4758015'
[05:20:27] ℹ️  Using service line from patient data: 'HHA'
[05:20:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:20:27] ✅ Patient name cross-validation successful
[05:20:27] ✅    ✅ Data merged successfully
[05:20:28] ✅    ✅ Order data extracted and validated
[05:20:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:20:50] [DOC: 9247512] ℹ️  Patient not found in cache or API: Beverly Sylvia
[05:20:50] [DOC: 9247512] ℹ️  Patient not found, creating new patient via API...
[05:20:50] [DOC: 9247512] ℹ️  Creating patient via API: Beverly Sylvia
[05:20:51] [DOC: 9247512] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:20:51] ❌    ❌ Failed to create patient
[05:20:51] [DOC: 9247512] ℹ️  API push details saved for document 9247512
================================================================================
║                        Processing Document ID: 9247509                         ║
================================================================================
[05:20:51] ℹ️  Agency: Fairhaven HH&H
[05:20:51] ℹ️  Date: 04/18/2025
[05:20:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:20:53] [DOC: 9247509] ✅ Text extracted using pdfplumber (1596 chars)
[05:20:53] ✅    ✅ Text extracted using pdfplumber (1596 chars)
[05:20:53] 🔄 
🔄 Step 2: Extracting patient data...
[05:20:56] ℹ️  AI extracted raw sex value: 'M'
[05:20:56] ℹ️  AI extracted service line: 'HOSPICE'
[05:20:56] ℹ️  AI extracted payer source: 'Medicare'
[05:20:56] ℹ️  AI extracted diagnoses:
[05:20:56] ℹ️    - Diagnosis 1: 'None'
[05:20:56] ℹ️    - Diagnosis 2: 'None'
[05:20:56] ℹ️    - Diagnosis 3: 'None'
[05:20:56] ℹ️    - Diagnosis 4: 'None'
[05:20:56] ℹ️    - Diagnosis 5: 'None'
[05:20:56] ℹ️    - Diagnosis 6: 'None'
[05:20:56] ℹ️  Final extracted MRN: '5021009'
[05:20:56] ℹ️  Final extracted Sex: 'MALE'
[05:20:56] ℹ️  Final extracted Service Line: 'HOSPICE'
[05:20:56] ℹ️  Final extracted Payer Source: 'Medicare'
[05:20:56] ✅ Patient data extraction completed successfully
[05:20:56] ✅    ✅ Patient data extracted successfully
[05:20:56] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HOSPICE
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:20:56] ✅    ✅ Patient identified: William Hughes
[05:20:56] ✅    ✅ Patient name validation passed
[05:20:56] 🔄 
🔄 Step 3: Processing patient dates...
[05:20:56] [DOC: 9247509] ℹ️  DOB normalized: 07/10/1937
[05:20:56] [DOC: 9247509] ℹ️  Episode startOfCare normalized: 11/20/2024
[05:20:56] [DOC: 9247509] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[05:20:56] [DOC: 9247509] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[05:20:56] [DOC: 9247509] ✅ Patient date processing completed successfully
[05:20:56] ✅    ✅ Date processing completed
[05:20:56] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HOSPICE
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025'}]
[05:20:56] 🔄 
🔄 Step 4: Extracting order data...
[05:20:58] ℹ️  Order extraction - MRN: ''
[05:20:58] ℹ️  Order extraction - Sex: 'MALE'
[05:20:58] ℹ️  Order extraction - Service Line: 'Hospice'
[05:20:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:20:58] ✅ Order data extraction completed successfully
[05:20:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:20:58] ℹ️  Using MRN from patient data: '5021009'
[05:20:58] ℹ️  Service line consistent in both sources: 'HOSPICE'
[05:20:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:20:58] ✅ Patient name cross-validation successful
[05:20:58] ✅    ✅ Data merged successfully
[05:21:00] ✅    ✅ Order data extracted and validated
[05:21:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:06] [DOC: 9247509] ℹ️  Patient not found in cache or API: William Hughes
[05:21:06] [DOC: 9247509] ℹ️  Patient not found, creating new patient via API...
[05:21:06] [DOC: 9247509] ℹ️  Creating patient via API: William Hughes
[05:21:07] [DOC: 9247509] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:21:07] ❌    ❌ Failed to create patient
[05:21:07] [DOC: 9247509] ℹ️  API push details saved for document 9247509
================================================================================
║                        Processing Document ID: 9246740                         ║
================================================================================
[05:21:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:21:07] ℹ️  Date: 04/17/2025
[05:21:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:21:09] [DOC: 9246740] ✅ Text extracted using pdfplumber (1538 chars)
[05:21:09] ✅    ✅ Text extracted using pdfplumber (1538 chars)
[05:21:09] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:12] ℹ️  AI extracted raw sex value: ''
[05:21:12] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:21:12] ℹ️  AI extracted payer source: ''
[05:21:12] ℹ️  AI extracted diagnoses:
[05:21:12] ℹ️    - Diagnosis 1: 'I11.0'
[05:21:12] ℹ️    - Diagnosis 2: 'I50.32'
[05:21:12] ℹ️    - Diagnosis 3: 'I25.119'
[05:21:12] ℹ️    - Diagnosis 4: ''
[05:21:12] ℹ️    - Diagnosis 5: ''
[05:21:12] ℹ️    - Diagnosis 6: ''
[05:21:12] ℹ️  Final extracted MRN: 'MA250402034603'
[05:21:12] ℹ️  Final extracted Sex: ''
[05:21:12] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:21:12] ℹ️  Final extracted Payer Source: ''
[05:21:12] ✅ Patient data extraction completed successfully
[05:21:12] ✅    ✅ Patient data extracted successfully
[05:21:12] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Machado
     └─ dob: 03/03/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA250402034603
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'I25.119', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:21:12] ✅    ✅ Patient identified: Maria Machado
[05:21:12] ✅    ✅ Patient name validation passed
[05:21:12] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:12] [DOC: 9246740] ℹ️  DOB normalized: 03/03/1946
[05:21:12] [DOC: 9246740] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:21:12] [DOC: 9246740] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:21:12] [DOC: 9246740] ✅ Patient date processing completed successfully
[05:21:12] ✅    ✅ Date processing completed
[05:21:12] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Machado
     └─ dob: 03/03/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA250402034603
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'I25.119', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:21:12] 🔄 
🔄 Step 4: Extracting order data...
[05:21:14] ℹ️  Order extraction - MRN: 'MA250402034603'
[05:21:14] ℹ️  Order extraction - Sex: ''
[05:21:14] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:21:14] ℹ️  Order extraction - Payer Source: ''
[05:21:14] ✅ Order data extraction completed successfully
[05:21:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:14] ℹ️  Using MRN from patient data: 'MA250402034603' over 'MA250402034603'
[05:21:14] ℹ️  Inferred sex as FEMALE from name: Maria
[05:21:14] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:21:14] ✅ Patient name cross-validation successful
[05:21:14] ✅    ✅ Data merged successfully
[05:21:16] ✅    ✅ Order data extracted and validated
[05:21:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:16] [DOC: 9246740] ✅ Patient found in local cache: Maria Machado, ID: 84886eb7-1715-43b2-8bfd-a62b101a7023
[05:21:16] ✅    ✅ Existing patient found with ID: 84886eb7-1715-43b2-8bfd-a62b101a7023
[05:21:16] 🔄 
🔄 Step 6: Pushing order to API...
[05:21:16] [DOC: 9246740] ℹ️  Pushing order via API for patient ID: 84886eb7-1715-43b2-8bfd-a62b101a7023
[05:21:17] [DOC: 9246740] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14000"}
[05:21:17] ❌    ❌ Failed to push order
[05:21:17] 🔄 
🔄 Step 7: Writing to CSV...
[05:21:17] [DOC: 9246740] ℹ️  Calculated age: 79 from DOB: 03/03/1946
[05:21:17] [DOC: 9246740] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:21:17] [DOC: 9246740] ℹ️  Payer Source extracted: ''
[05:21:17] [DOC: 9246740] ℹ️  Diagnosis codes being written:
[05:21:17] [DOC: 9246740] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:21:17] [DOC: 9246740] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[05:21:17] [DOC: 9246740] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.119'
[05:21:17] [DOC: 9246740] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:21:17] [DOC: 9246740] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:21:17] [DOC: 9246740] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:21:17] [DOC: 9246740] ✅ Patient data written to CSV: Maria Machado | Sex: FEMALE | Age: 79 | Service: Occupational Therapy | Payer:  | MRN: MA250402034603
[05:21:17] ✅    ✅ Document 9246740 processed and saved successfully
[05:21:17] 🔄 
🔄 Step 8: Saving API details...
[05:21:17] [DOC: 9246740] ℹ️  API push details saved for document 9246740
[05:21:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246736                         ║
================================================================================
[05:21:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:21:17] ℹ️  Date: 04/17/2025
[05:21:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:21:20] [DOC: 9246736] ✅ Text extracted using pdfplumber (11487 chars)
[05:21:20] ✅    ✅ Text extracted using pdfplumber (11487 chars)
[05:21:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:23] ℹ️  AI extracted raw sex value: 'F'
[05:21:23] ℹ️  AI extracted service line: 'OT'
[05:21:23] ℹ️  AI extracted payer source: ''
[05:21:23] ℹ️  AI extracted diagnoses:
[05:21:23] ℹ️    - Diagnosis 1: 'CHF'
[05:21:23] ℹ️    - Diagnosis 2: 'OA Exacerbation'
[05:21:23] ℹ️    - Diagnosis 3: ''
[05:21:23] ℹ️    - Diagnosis 4: ''
[05:21:23] ℹ️    - Diagnosis 5: ''
[05:21:23] ℹ️    - Diagnosis 6: ''
[05:21:23] ℹ️  Final extracted MRN: 'MA250402034603'
[05:21:23] ℹ️  Final extracted Sex: 'FEMALE'
[05:21:23] ℹ️  Final extracted Service Line: 'OT'
[05:21:23] ℹ️  Final extracted Payer Source: ''
[05:21:23] ✅ Patient data extraction completed successfully
[05:21:23] ✅    ✅ Patient data extracted successfully
[05:21:23] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Machado
     └─ dob: 03/03/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250402034603
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'OA Exacerbation', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:21:23] ✅    ✅ Patient identified: Maria Machado
[05:21:23] ✅    ✅ Patient name validation passed
[05:21:23] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:23] [DOC: 9246736] ℹ️  DOB normalized: 03/03/1946
[05:21:23] [DOC: 9246736] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:21:23] [DOC: 9246736] ✅ Patient date processing completed successfully
[05:21:23] ✅    ✅ Date processing completed
[05:21:23] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Machado
     └─ dob: 03/03/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250402034603
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'OA Exacerbation', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:21:23] 🔄 
🔄 Step 4: Extracting order data...
[05:21:25] ℹ️  Order extraction - MRN: 'MA250402034603'
[05:21:25] ℹ️  Order extraction - Sex: 'FEMALE'
[05:21:25] ℹ️  Order extraction - Service Line: 'OT'
[05:21:25] ℹ️  Order extraction - Payer Source: ''
[05:21:25] ✅ Order data extraction completed successfully
[05:21:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:25] ℹ️  Using MRN from patient data: 'MA250402034603' over 'MA250402034603'
[05:21:25] ℹ️  Service line consistent in both sources: 'OT'
[05:21:25] ✅ Patient name cross-validation successful
[05:21:25] ✅    ✅ Data merged successfully
[05:21:27] ✅    ✅ Order data extracted and validated
[05:21:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:27] [DOC: 9246736] ✅ Patient found in local cache: Maria Machado, ID: 84886eb7-1715-43b2-8bfd-a62b101a7023
[05:21:27] ✅    ✅ Existing patient found with ID: 84886eb7-1715-43b2-8bfd-a62b101a7023
[05:21:27] 🔄 
🔄 Step 6: Pushing order to API...
[05:21:27] [DOC: 9246736] ℹ️  Pushing order via API for patient ID: 84886eb7-1715-43b2-8bfd-a62b101a7023
[05:21:28] [DOC: 9246736] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:21:28] ❌    ❌ Failed to push order
[05:21:28] 🔄 
🔄 Step 7: Writing to CSV...
[05:21:28] [DOC: 9246736] ℹ️  Calculated age: 79 from DOB: 03/03/1946
[05:21:28] [DOC: 9246736] ℹ️  Service Line extracted: 'OT'
[05:21:28] [DOC: 9246736] ℹ️  Payer Source extracted: ''
[05:21:28] [DOC: 9246736] ℹ️  Diagnosis codes being written:
[05:21:28] [DOC: 9246736] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[05:21:28] [DOC: 9246736] ℹ️    - Latest_Episode_Seconddiagnosis: 'OA Exacerbation'
[05:21:28] [DOC: 9246736] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:21:28] [DOC: 9246736] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:21:28] [DOC: 9246736] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:21:28] [DOC: 9246736] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:21:28] [DOC: 9246736] ✅ Patient data written to CSV: Maria Machado | Sex: FEMALE | Age: 79 | Service: OT | Payer:  | MRN: MA250402034603
[05:21:28] ✅    ✅ Document 9246736 processed and saved successfully
[05:21:28] 🔄 
🔄 Step 8: Saving API details...
[05:21:28] [DOC: 9246736] ℹ️  API push details saved for document 9246736
[05:21:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245647                         ║
================================================================================
[05:21:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:21:28] ℹ️  Date: 04/17/2025
[05:21:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:21:30] [DOC: 9245647] ✅ Text extracted using pdfplumber (9432 chars)
[05:21:30] ✅    ✅ Text extracted using pdfplumber (9432 chars)
[05:21:30] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:33] ℹ️  AI extracted raw sex value: 'F'
[05:21:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:21:33] ℹ️  AI extracted payer source: 'None'
[05:21:33] ℹ️  AI extracted diagnoses:
[05:21:33] ℹ️    - Diagnosis 1: 'I10'
[05:21:33] ℹ️    - Diagnosis 2: 'G8929'
[05:21:33] ℹ️    - Diagnosis 3: 'None'
[05:21:33] ℹ️    - Diagnosis 4: 'None'
[05:21:33] ℹ️    - Diagnosis 5: 'None'
[05:21:33] ℹ️    - Diagnosis 6: 'None'
[05:21:33] ℹ️  Final extracted MRN: 'MA240624105104'
[05:21:33] ℹ️  Final extracted Sex: 'FEMALE'
[05:21:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:21:33] ℹ️  Final extracted Payer Source: ''
[05:21:33] ✅ Patient data extraction completed successfully
[05:21:33] ✅    ✅ Patient data extracted successfully
[05:21:33] 📊 Patient Response
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240624105104
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G8929', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:21:33] ✅    ✅ Patient identified: Marsha Tilley
[05:21:33] ✅    ✅ Patient name validation passed
[05:21:33] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:33] [DOC: 9245647] ℹ️  DOB normalized: 10/08/1951
[05:21:33] [DOC: 9245647] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[05:21:33] [DOC: 9245647] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[05:21:33] [DOC: 9245647] ✅ Patient date processing completed successfully
[05:21:33] ✅    ✅ Date processing completed
[05:21:33] 📊 Processed Patient Data
     └─ patientFName: Marsha
     └─ patientLName: Tilley
     └─ dob: 10/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240624105104
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G8929'}]
[05:21:33] 🔄 
🔄 Step 4: Extracting order data...
[05:21:36] ℹ️  Order extraction - MRN: 'MA240624105104'
[05:21:36] ℹ️  Order extraction - Sex: 'FEMALE'
[05:21:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:21:36] ℹ️  Order extraction - Payer Source: ''
[05:21:36] ✅ Order data extraction completed successfully
[05:21:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:36] ℹ️  Using MRN from patient data: 'MA240624105104' over 'MA240624105104'
[05:21:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:21:36] ✅ Patient name cross-validation successful
[05:21:36] ✅    ✅ Data merged successfully
[05:21:37] ✅    ✅ Order data extracted and validated
[05:21:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:21:43] [DOC: 9245647] ✅ Patient exists in API: Marsha Tilley, ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[05:21:43] ✅    ✅ Existing patient found with ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[05:21:43] 🔄 
🔄 Step 6: Pushing order to API...
[05:21:43] [DOC: 9245647] ℹ️  Pushing order via API for patient ID: 26caa9be-49f0-48db-abe7-e2e6d175118c
[05:21:44] [DOC: 9245647] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14355"}
[05:21:44] ❌    ❌ Failed to push order
[05:21:44] 🔄 
🔄 Step 7: Writing to CSV...
[05:21:44] [DOC: 9245647] ℹ️  Calculated age: 73 from DOB: 10/08/1951
[05:21:44] [DOC: 9245647] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:21:44] [DOC: 9245647] ℹ️  Payer Source extracted: ''
[05:21:44] [DOC: 9245647] ℹ️  Diagnosis codes being written:
[05:21:44] [DOC: 9245647] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[05:21:44] [DOC: 9245647] ℹ️    - Latest_Episode_Seconddiagnosis: 'G8929'
[05:21:44] [DOC: 9245647] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:21:44] [DOC: 9245647] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:21:44] [DOC: 9245647] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:21:44] [DOC: 9245647] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:21:44] [DOC: 9245647] ✅ Patient data written to CSV: Marsha Tilley | Sex: FEMALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA240624105104
[05:21:44] ✅    ✅ Document 9245647 processed and saved successfully
[05:21:44] 🔄 
🔄 Step 8: Saving API details...
[05:21:44] [DOC: 9245647] ℹ️  API push details saved for document 9245647
[05:21:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247415                         ║
================================================================================
[05:21:44] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:21:44] ℹ️  Date: 04/17/2025
[05:21:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:21:47] [DOC: 9247415] ✅ Text extracted using pdfplumber (25154 chars)
[05:21:47] ✅    ✅ Text extracted using pdfplumber (25154 chars)
[05:21:47] 🔄 
🔄 Step 2: Extracting patient data...
[05:21:51] ℹ️  AI extracted raw sex value: 'M'
[05:21:51] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:21:51] ℹ️  AI extracted payer source: 'Medicare'
[05:21:51] ℹ️  AI extracted diagnoses:
[05:21:51] ℹ️    - Diagnosis 1: 'I13.0'
[05:21:51] ℹ️    - Diagnosis 2: 'I50.33'
[05:21:51] ℹ️    - Diagnosis 3: 'N18.32'
[05:21:51] ℹ️    - Diagnosis 4: 'I48.19'
[05:21:51] ℹ️    - Diagnosis 5: 'J15.9'
[05:21:51] ℹ️    - Diagnosis 6: 'N40.0'
[05:21:51] ℹ️  Final extracted MRN: '28700179206001'
[05:21:51] ℹ️  Final extracted Sex: 'MALE'
[05:21:51] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:21:51] ℹ️  Final extracted Payer Source: 'Medicare'
[05:21:51] ✅ Patient data extraction completed successfully
[05:21:51] ✅    ✅ Patient data extracted successfully
[05:21:51] 📊 Patient Response
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 60 COULOMBE ST
     └─ city: ACUSHNET
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'I48.19', 'fifthDiagnosis': 'J15.9', 'sixthDiagnosis': 'N40.0'}]
[05:21:51] ✅    ✅ Patient identified: JOSEPH LEDOUX
[05:21:51] ✅    ✅ Patient name validation passed
[05:21:51] 🔄 
🔄 Step 3: Processing patient dates...
[05:21:51] [DOC: 9247415] ℹ️  DOB normalized: 04/26/1941
[05:21:51] [DOC: 9247415] ℹ️  Episode startOfCare normalized: 04/05/2025
[05:21:51] [DOC: 9247415] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:21:51] [DOC: 9247415] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:21:51] [DOC: 9247415] ✅ Patient date processing completed successfully
[05:21:51] ✅    ✅ Date processing completed
[05:21:51] 📊 Processed Patient Data
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 60 COULOMBE ST
     └─ city: ACUSHNET
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'I48.19', 'fifthDiagnosis': 'J15.9', 'sixthDiagnosis': 'N40.0'}]
[05:21:51] 🔄 
🔄 Step 4: Extracting order data...
[05:21:54] ℹ️  Order extraction - MRN: '28700179206001'
[05:21:54] ℹ️  Order extraction - Sex: 'MALE'
[05:21:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:21:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:21:54] ✅ Order data extraction completed successfully
[05:21:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:21:54] ℹ️  Using MRN from patient data: '28700179206001' over '28700179206001'
[05:21:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:21:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:21:54] ✅ Patient name cross-validation successful
[05:21:54] ✅    ✅ Data merged successfully
[05:21:56] ✅    ✅ Order data extracted and validated
[05:21:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:22:17] [DOC: 9247415] ✅ Patient exists in API: JOSEPH LEDOUX, ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[05:22:17] ✅    ✅ Existing patient found with ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[05:22:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:22:17] [DOC: 9247415] ℹ️  Pushing order via API for patient ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[05:22:18] [DOC: 9247415] ❌ Order push failed with status 201: {"id":"872a7f1f-3050-48fa-93df-588cb238d39a","orderWAVId":"ORD20020","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 12340854","orderDate":"04/05/2025","startOfCare":"04/05/2025","episodeStartDate":"04/05/2025","episodeEndDate":"06/03/2025","documentID":"9247415","mrn":"28700179206001","patientName":"JOSEPH LEDOUX","sentToPhysicianDate":"04/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/18/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"a649b1f9-a81a-4d88-abca-33596b2b2d88","companyId":"532ae690-17f2-4fb0-b9ec-e3ef8634f57d","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:22:18] ❌    ❌ Failed to push order
[05:22:18] 🔄 
🔄 Step 7: Writing to CSV...
[05:22:18] [DOC: 9247415] ℹ️  Calculated age: 84 from DOB: 04/26/1941
[05:22:18] [DOC: 9247415] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:22:18] [DOC: 9247415] ℹ️  Payer Source extracted: 'Medicare'
[05:22:18] [DOC: 9247415] ℹ️  Diagnosis codes being written:
[05:22:18] [DOC: 9247415] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[05:22:18] [DOC: 9247415] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[05:22:18] [DOC: 9247415] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.32'
[05:22:18] [DOC: 9247415] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.19'
[05:22:18] [DOC: 9247415] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J15.9'
[05:22:18] [DOC: 9247415] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.0'
[05:22:18] [DOC: 9247415] ✅ Patient data written to CSV: JOSEPH LEDOUX | Sex: MALE | Age: 84 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 28700179206001
[05:22:18] ✅    ✅ Document 9247415 processed and saved successfully
[05:22:18] 🔄 
🔄 Step 8: Saving API details...
[05:22:18] [DOC: 9247415] ℹ️  API push details saved for document 9247415
[05:22:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247414                         ║
================================================================================
[05:22:18] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:22:18] ℹ️  Date: 04/17/2025
[05:22:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:22:20] [DOC: 9247414] ✅ Text extracted using pdfplumber (1588 chars)
[05:22:20] ✅    ✅ Text extracted using pdfplumber (1588 chars)
[05:22:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:22:23] ℹ️  AI extracted raw sex value: ''
[05:22:23] ℹ️  AI extracted service line: 'RN'
[05:22:23] ℹ️  AI extracted payer source: 'Medicare'
[05:22:23] ℹ️  AI extracted diagnoses:
[05:22:23] ℹ️    - Diagnosis 1: 'None'
[05:22:23] ℹ️    - Diagnosis 2: 'None'
[05:22:23] ℹ️    - Diagnosis 3: 'None'
[05:22:23] ℹ️    - Diagnosis 4: 'None'
[05:22:23] ℹ️    - Diagnosis 5: 'None'
[05:22:23] ℹ️    - Diagnosis 6: 'None'
[05:22:23] ℹ️  Final extracted MRN: '28700179206001'
[05:22:23] ℹ️  Final extracted Sex: ''
[05:22:23] ℹ️  Final extracted Service Line: 'RN'
[05:22:23] ℹ️  Final extracted Payer Source: 'Medicare'
[05:22:23] ✅ Patient data extraction completed successfully
[05:22:23] ✅    ✅ Patient data extracted successfully
[05:22:23] 📊 Patient Response
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: 
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:22:23] ✅    ✅ Patient identified: JOSEPH LEDOUX
[05:22:23] ✅    ✅ Patient name validation passed
[05:22:23] 🔄 
🔄 Step 3: Processing patient dates...
[05:22:23] [DOC: 9247414] ℹ️  DOB normalized: 04/26/1941
[05:22:23] [DOC: 9247414] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[05:22:23] [DOC: 9247414] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[05:22:23] [DOC: 9247414] ✅ Patient date processing completed successfully
[05:22:23] ✅    ✅ Date processing completed
[05:22:23] 📊 Processed Patient Data
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: 
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/04/2025'}]
[05:22:23] 🔄 
🔄 Step 4: Extracting order data...
[05:22:26] ℹ️  Order extraction - MRN: '28700179206001'
[05:22:26] ℹ️  Order extraction - Sex: ''
[05:22:26] ℹ️  Order extraction - Service Line: 'RN'
[05:22:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:22:26] ✅ Order data extraction completed successfully
[05:22:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:22:26] ℹ️  Using MRN from patient data: '28700179206001' over '28700179206001'
[05:22:26] ℹ️  Inferred sex as MALE from name: JOSEPH
[05:22:26] ℹ️  Service line consistent in both sources: 'RN'
[05:22:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:22:26] ✅ Patient name cross-validation successful
[05:22:26] ✅    ✅ Data merged successfully
[05:22:27] ✅    ✅ Order data extracted and validated
[05:22:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:22:27] [DOC: 9247414] ✅ Patient found in local cache: JOSEPH LEDOUX, ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[05:22:27] ✅    ✅ Existing patient found with ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[05:22:27] 🔄 
🔄 Step 6: Pushing order to API...
[05:22:27] [DOC: 9247414] ℹ️  Pushing order via API for patient ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[05:22:28] [DOC: 9247414] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13918"}
[05:22:28] ❌    ❌ Failed to push order
[05:22:28] 🔄 
🔄 Step 7: Writing to CSV...
[05:22:28] [DOC: 9247414] ℹ️  Calculated age: 84 from DOB: 04/26/1941
[05:22:28] [DOC: 9247414] ℹ️  Service Line extracted: 'RN'
[05:22:28] [DOC: 9247414] ℹ️  Payer Source extracted: 'Medicare'
[05:22:28] [DOC: 9247414] ℹ️  Diagnosis codes being written:
[05:22:28] [DOC: 9247414] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:22:28] [DOC: 9247414] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:22:28] [DOC: 9247414] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:22:28] [DOC: 9247414] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:22:28] [DOC: 9247414] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:22:28] [DOC: 9247414] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:22:28] [DOC: 9247414] ✅ Patient data written to CSV: JOSEPH LEDOUX | Sex: MALE | Age: 84 | Service: RN | Payer: Medicare | MRN: 28700179206001
[05:22:28] ✅    ✅ Document 9247414 processed and saved successfully
[05:22:28] 🔄 
🔄 Step 8: Saving API details...
[05:22:28] [DOC: 9247414] ℹ️  API push details saved for document 9247414
[05:22:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246919                         ║
================================================================================
[05:22:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:22:28] ℹ️  Date: 04/17/2025
[05:22:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:22:32] [DOC: 9246919] ✅ Text extracted using pdfplumber (11649 chars)
[05:22:32] ✅    ✅ Text extracted using pdfplumber (11649 chars)
[05:22:32] 🔄 
🔄 Step 2: Extracting patient data...
[05:22:35] ℹ️  AI extracted raw sex value: 'F'
[05:22:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:22:35] ℹ️  AI extracted payer source: 'Medicare'
[05:22:35] ℹ️  AI extracted diagnoses:
[05:22:35] ℹ️    - Diagnosis 1: 'J44.9'
[05:22:35] ℹ️    - Diagnosis 2: 'S42.402'
[05:22:35] ℹ️    - Diagnosis 3: 'M19.90'
[05:22:35] ℹ️    - Diagnosis 4: 'F32.9'
[05:22:35] ℹ️    - Diagnosis 5: 'F41.9'
[05:22:35] ℹ️    - Diagnosis 6: 'G89.4'
[05:22:35] ℹ️  Final extracted MRN: '100999305'
[05:22:35] ℹ️  Final extracted Sex: 'FEMALE'
[05:22:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:22:35] ℹ️  Final extracted Payer Source: 'Medicare'
[05:22:35] ✅ Patient data extraction completed successfully
[05:22:35] ✅    ✅ Patient data extracted successfully
[05:22:35] 📊 Patient Response
     └─ patientFName: Phyllis
     └─ patientLName: Monteiro
     └─ dob: 01/07/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100999305
     └─ billingProvider: WU, ELAINE MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 180 Adams St
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 904-3912
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2023', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'S42.402', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'F32.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'G89.4'}]
[05:22:35] ✅    ✅ Patient identified: Phyllis Monteiro
[05:22:35] ✅    ✅ Patient name validation passed
[05:22:35] 🔄 
🔄 Step 3: Processing patient dates...
[05:22:35] [DOC: 9246919] ℹ️  DOB normalized: 01/07/1951
[05:22:35] [DOC: 9246919] ℹ️  Episode startOfCare normalized: 02/26/2023
[05:22:35] [DOC: 9246919] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[05:22:35] [DOC: 9246919] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[05:22:35] [DOC: 9246919] ✅ Patient date processing completed successfully
[05:22:35] ✅    ✅ Date processing completed
[05:22:35] 📊 Processed Patient Data
     └─ patientFName: Phyllis
     └─ patientLName: Monteiro
     └─ dob: 01/07/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100999305
     └─ billingProvider: WU, ELAINE MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 180 Adams St
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 904-3912
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2023', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'S42.402', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': 'F32.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'G89.4'}]
[05:22:35] 🔄 
🔄 Step 4: Extracting order data...
[05:22:38] ℹ️  Order extraction - MRN: '100999305'
[05:22:38] ℹ️  Order extraction - Sex: 'FEMALE'
[05:22:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:22:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:22:38] ✅ Order data extraction completed successfully
[05:22:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:22:38] ℹ️  Using MRN from patient data: '100999305' over '100999305'
[05:22:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:22:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:22:38] ✅ Patient name cross-validation successful
[05:22:38] ✅    ✅ Data merged successfully
[05:22:39] ✅    ✅ Order data extracted and validated
[05:22:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:22:48] [DOC: 9246919] ✅ Patient exists in API: Phyllis Monteiro, ID: 1e3fa9e7-2fe2-4bdf-8848-72aa7b1811ea
[05:22:48] ✅    ✅ Existing patient found with ID: 1e3fa9e7-2fe2-4bdf-8848-72aa7b1811ea
[05:22:48] 🔄 
🔄 Step 6: Pushing order to API...
[05:22:48] [DOC: 9246919] ℹ️  Pushing order via API for patient ID: 1e3fa9e7-2fe2-4bdf-8848-72aa7b1811ea
[05:22:49] [DOC: 9246919] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14139"}
[05:22:49] ❌    ❌ Failed to push order
[05:22:49] 🔄 
🔄 Step 7: Writing to CSV...
[05:22:49] [DOC: 9246919] ℹ️  Calculated age: 74 from DOB: 01/07/1951
[05:22:49] [DOC: 9246919] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:22:49] [DOC: 9246919] ℹ️  Payer Source extracted: 'Medicare'
[05:22:49] [DOC: 9246919] ℹ️  Diagnosis codes being written:
[05:22:49] [DOC: 9246919] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[05:22:49] [DOC: 9246919] ℹ️    - Latest_Episode_Seconddiagnosis: 'S42.402'
[05:22:49] [DOC: 9246919] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.90'
[05:22:49] [DOC: 9246919] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F32.9'
[05:22:49] [DOC: 9246919] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[05:22:49] [DOC: 9246919] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G89.4'
[05:22:49] [DOC: 9246919] ✅ Patient data written to CSV: Phyllis Monteiro | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 100999305
[05:22:49] ✅    ✅ Document 9246919 processed and saved successfully
[05:22:49] 🔄 
🔄 Step 8: Saving API details...
[05:22:49] [DOC: 9246919] ℹ️  API push details saved for document 9246919
[05:22:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246914                         ║
================================================================================
[05:22:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:22:49] ℹ️  Date: 04/17/2025
[05:22:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:22:53] [DOC: 9246914] ✅ Text extracted using pdfplumber (14417 chars)
[05:22:53] ✅    ✅ Text extracted using pdfplumber (14417 chars)
[05:22:53] 🔄 
🔄 Step 2: Extracting patient data...
[05:22:55] ℹ️  AI extracted raw sex value: ''
[05:22:55] ℹ️  AI extracted service line: 'PT'
[05:22:55] ℹ️  AI extracted payer source: 'None'
[05:22:55] ℹ️  AI extracted diagnoses:
[05:22:55] ℹ️    - Diagnosis 1: 'None'
[05:22:55] ℹ️    - Diagnosis 2: 'None'
[05:22:55] ℹ️    - Diagnosis 3: 'None'
[05:22:55] ℹ️    - Diagnosis 4: 'None'
[05:22:55] ℹ️    - Diagnosis 5: 'None'
[05:22:55] ℹ️    - Diagnosis 6: 'None'
[05:22:55] ℹ️  Final extracted MRN: 'MA220224114804'
[05:22:55] ℹ️  Final extracted Sex: ''
[05:22:55] ℹ️  Final extracted Service Line: 'PT'
[05:22:55] ℹ️  Final extracted Payer Source: ''
[05:22:55] ✅ Patient data extraction completed successfully
[05:22:55] ✅    ✅ Patient data extracted successfully
[05:22:55] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Minkle
     └─ dob: 11/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220224114804
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '05/02/25', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:22:55] ✅    ✅ Patient identified: Kathleen Minkle
[05:22:55] ✅    ✅ Patient name validation passed
[05:22:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:22:55] [DOC: 9246914] ℹ️  DOB normalized: 11/17/1948
[05:22:55] [DOC: 9246914] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:22:55] [DOC: 9246914] ⚠️  Invalid endOfEpisode format: 05/02/25
[05:22:55] [DOC: 9246914] ✅ Patient date processing completed successfully
[05:22:55] ✅    ✅ Date processing completed
[05:22:55] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Minkle
     └─ dob: 11/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA220224114804
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '05/02/25'}]
[05:22:55] 🔄 
🔄 Step 4: Extracting order data...
[05:22:58] ℹ️  Order extraction - MRN: 'MA220224114804'
[05:22:58] ℹ️  Order extraction - Sex: ''
[05:22:58] ℹ️  Order extraction - Service Line: 'PT'
[05:22:58] ℹ️  Order extraction - Payer Source: ''
[05:22:58] ✅ Order data extraction completed successfully
[05:22:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:22:58] ℹ️  Using MRN from patient data: 'MA220224114804' over 'MA220224114804'
[05:22:58] ⚠️  Could not determine sex using any available method
[05:22:58] ℹ️  Service line consistent in both sources: 'PT'
[05:22:58] ✅ Patient name cross-validation successful
[05:22:58] ✅    ✅ Data merged successfully
[05:23:00] ✅    ✅ Order data extracted and validated
[05:23:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:06] [DOC: 9246914] ✅ Patient exists in API: Kathleen Minkle, ID: b379df60-0af4-4352-bb35-d7b2c726b92c
[05:23:06] ✅    ✅ Existing patient found with ID: b379df60-0af4-4352-bb35-d7b2c726b92c
[05:23:06] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:06] [DOC: 9246914] ℹ️  Pushing order via API for patient ID: b379df60-0af4-4352-bb35-d7b2c726b92c
[05:23:07] [DOC: 9246914] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:23:07] ❌    ❌ Failed to push order
[05:23:07] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:07] [DOC: 9246914] ℹ️  Calculated age: 76 from DOB: 11/17/1948
[05:23:07] [DOC: 9246914] ℹ️  Service Line extracted: 'PT'
[05:23:07] [DOC: 9246914] ℹ️  Payer Source extracted: ''
[05:23:07] [DOC: 9246914] ℹ️  Diagnosis codes being written:
[05:23:07] [DOC: 9246914] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:23:07] [DOC: 9246914] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:23:07] [DOC: 9246914] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:23:07] [DOC: 9246914] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:23:07] [DOC: 9246914] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:23:07] [DOC: 9246914] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:23:07] [DOC: 9246914] ✅ Patient data written to CSV: Kathleen Minkle | Sex:  | Age: 76 | Service: PT | Payer:  | MRN: MA220224114804
[05:23:07] ✅    ✅ Document 9246914 processed and saved successfully
[05:23:07] 🔄 
🔄 Step 8: Saving API details...
[05:23:07] [DOC: 9246914] ℹ️  API push details saved for document 9246914
[05:23:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246907                         ║
================================================================================
[05:23:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:23:07] ℹ️  Date: 04/17/2025
[05:23:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:09] [DOC: 9246907] ✅ Text extracted using pdfplumber (1425 chars)
[05:23:09] ✅    ✅ Text extracted using pdfplumber (1413 chars)
[05:23:09] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:12] ℹ️  AI extracted raw sex value: ''
[05:23:12] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:23:12] ℹ️  AI extracted payer source: ''
[05:23:12] ℹ️  AI extracted diagnoses:
[05:23:12] ℹ️    - Diagnosis 1: 'I65.21'
[05:23:12] ℹ️    - Diagnosis 2: 'R26.89'
[05:23:12] ℹ️    - Diagnosis 3: 'R13.12'
[05:23:12] ℹ️    - Diagnosis 4: ''
[05:23:12] ℹ️    - Diagnosis 5: ''
[05:23:12] ℹ️    - Diagnosis 6: ''
[05:23:12] ℹ️  Final extracted MRN: 'MA250407073603'
[05:23:12] ℹ️  Final extracted Sex: ''
[05:23:12] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:23:12] ℹ️  Final extracted Payer Source: ''
[05:23:12] ✅ Patient data extraction completed successfully
[05:23:12] ✅    ✅ Patient data extracted successfully
[05:23:12] 📊 Patient Response
     └─ patientFName: Harriett
     └─ patientLName: Sherman
     └─ dob: 07/22/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250407073603
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I65.21', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:12] ✅    ✅ Patient identified: Harriett Sherman
[05:23:12] ✅    ✅ Patient name validation passed
[05:23:12] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:12] [DOC: 9246907] ℹ️  DOB normalized: 07/22/1936
[05:23:12] [DOC: 9246907] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:23:12] [DOC: 9246907] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:23:12] [DOC: 9246907] ✅ Patient date processing completed successfully
[05:23:12] ✅    ✅ Date processing completed
[05:23:12] 📊 Processed Patient Data
     └─ patientFName: Harriett
     └─ patientLName: Sherman
     └─ dob: 07/22/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250407073603
     └─ billingProvider: ELAINE WU MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I65.21', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:12] 🔄 
🔄 Step 4: Extracting order data...
[05:23:15] ℹ️  Order extraction - MRN: 'MA250407073603'
[05:23:15] ℹ️  Order extraction - Sex: ''
[05:23:15] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:23:15] ℹ️  Order extraction - Payer Source: ''
[05:23:15] ✅ Order data extraction completed successfully
[05:23:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:15] ℹ️  Using MRN from patient data: 'MA250407073603' over 'MA250407073603'
[05:23:15] ⚠️  Could not determine sex using any available method
[05:23:15] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:23:15] ✅ Patient name cross-validation successful
[05:23:15] ✅    ✅ Data merged successfully
[05:23:16] ✅    ✅ Order data extracted and validated
[05:23:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:24] [DOC: 9246907] ✅ Patient exists in API: Harriett Sherman, ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:24] ✅    ✅ Existing patient found with ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:24] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:24] [DOC: 9246907] ℹ️  Pushing order via API for patient ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:25] [DOC: 9246907] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14396"}
[05:23:25] ❌    ❌ Failed to push order
[05:23:25] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:25] [DOC: 9246907] ℹ️  Calculated age: 88 from DOB: 07/22/1936
[05:23:25] [DOC: 9246907] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:23:25] [DOC: 9246907] ℹ️  Payer Source extracted: ''
[05:23:25] [DOC: 9246907] ℹ️  Diagnosis codes being written:
[05:23:25] [DOC: 9246907] ℹ️    - Latest_Episode_Firstdiagnosis: 'I65.21'
[05:23:25] [DOC: 9246907] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.89'
[05:23:25] [DOC: 9246907] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[05:23:25] [DOC: 9246907] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:23:25] [DOC: 9246907] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:23:25] [DOC: 9246907] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:23:25] [DOC: 9246907] ✅ Patient data written to CSV: Harriett Sherman | Sex:  | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA250407073603
[05:23:25] ✅    ✅ Document 9246907 processed and saved successfully
[05:23:25] 🔄 
🔄 Step 8: Saving API details...
[05:23:25] [DOC: 9246907] ℹ️  API push details saved for document 9246907
[05:23:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246904                         ║
================================================================================
[05:23:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:23:25] ℹ️  Date: 04/17/2025
[05:23:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:28] [DOC: 9246904] ✅ Text extracted using pdfplumber (12798 chars)
[05:23:28] ✅    ✅ Text extracted using pdfplumber (12798 chars)
[05:23:28] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:31] ℹ️  AI extracted raw sex value: 'F'
[05:23:31] ℹ️  AI extracted service line: 'OT'
[05:23:31] ℹ️  AI extracted payer source: ''
[05:23:31] ℹ️  AI extracted diagnoses:
[05:23:31] ℹ️    - Diagnosis 1: ''
[05:23:31] ℹ️    - Diagnosis 2: ''
[05:23:31] ℹ️    - Diagnosis 3: ''
[05:23:31] ℹ️    - Diagnosis 4: ''
[05:23:31] ℹ️    - Diagnosis 5: ''
[05:23:31] ℹ️    - Diagnosis 6: ''
[05:23:31] ℹ️  Final extracted MRN: 'MA250407073603'
[05:23:31] ℹ️  Final extracted Sex: 'FEMALE'
[05:23:31] ℹ️  Final extracted Service Line: 'OT'
[05:23:31] ℹ️  Final extracted Payer Source: ''
[05:23:31] ✅ Patient data extraction completed successfully
[05:23:31] ✅    ✅ Patient data extracted successfully
[05:23:31] 📊 Patient Response
     └─ patientFName: Harriett
     └─ patientLName: Sherman
     └─ dob: 07/22/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250407073603
     └─ billingProvider: Dr. Wu, Elaine
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:31] ✅    ✅ Patient identified: Harriett Sherman
[05:23:31] ✅    ✅ Patient name validation passed
[05:23:31] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:31] [DOC: 9246904] ℹ️  DOB normalized: 07/22/1936
[05:23:31] [DOC: 9246904] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[05:23:31] [DOC: 9246904] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:23:31] [DOC: 9246904] ✅ Patient date processing completed successfully
[05:23:31] ✅    ✅ Date processing completed
[05:23:31] 📊 Processed Patient Data
     └─ patientFName: Harriett
     └─ patientLName: Sherman
     └─ dob: 07/22/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250407073603
     └─ billingProvider: Dr. Wu, Elaine
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:23:31] 🔄 
🔄 Step 4: Extracting order data...
[05:23:34] ℹ️  Order extraction - MRN: 'MA250407073603'
[05:23:34] ℹ️  Order extraction - Sex: 'FEMALE'
[05:23:34] ℹ️  Order extraction - Service Line: 'OT'
[05:23:34] ℹ️  Order extraction - Payer Source: ''
[05:23:34] ✅ Order data extraction completed successfully
[05:23:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:34] ℹ️  Using MRN from patient data: 'MA250407073603' over 'MA250407073603'
[05:23:34] ℹ️  Service line consistent in both sources: 'OT'
[05:23:34] ✅ Patient name cross-validation successful
[05:23:34] ✅    ✅ Data merged successfully
[05:23:35] ✅    ✅ Order data extracted and validated
[05:23:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:35] [DOC: 9246904] ✅ Patient found in local cache: Harriett Sherman, ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:35] ✅    ✅ Existing patient found with ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:35] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:35] [DOC: 9246904] ℹ️  Pushing order via API for patient ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:37] [DOC: 9246904] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:23:37] ❌    ❌ Failed to push order
[05:23:37] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:37] [DOC: 9246904] ℹ️  Calculated age: 88 from DOB: 07/22/1936
[05:23:37] [DOC: 9246904] ℹ️  Service Line extracted: 'OT'
[05:23:37] [DOC: 9246904] ℹ️  Payer Source extracted: ''
[05:23:37] [DOC: 9246904] ℹ️  Diagnosis codes being written:
[05:23:37] [DOC: 9246904] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:23:37] [DOC: 9246904] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:23:37] [DOC: 9246904] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:23:37] [DOC: 9246904] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:23:37] [DOC: 9246904] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:23:37] [DOC: 9246904] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:23:37] [DOC: 9246904] ✅ Patient data written to CSV: Harriett Sherman | Sex: FEMALE | Age: 88 | Service: OT | Payer:  | MRN: MA250407073603
[05:23:37] ✅    ✅ Document 9246904 processed and saved successfully
[05:23:37] 🔄 
🔄 Step 8: Saving API details...
[05:23:37] [DOC: 9246904] ℹ️  API push details saved for document 9246904
[05:23:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246902                         ║
================================================================================
[05:23:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:23:37] ℹ️  Date: 04/17/2025
[05:23:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:40] [DOC: 9246902] ✅ Text extracted using pdfplumber (18816 chars)
[05:23:40] ✅    ✅ Text extracted using pdfplumber (18804 chars)
[05:23:40] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:43] ℹ️  AI extracted raw sex value: 'F'
[05:23:43] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[05:23:43] ℹ️  AI extracted payer source: 'Medicare'
[05:23:43] ℹ️  AI extracted diagnoses:
[05:23:43] ℹ️    - Diagnosis 1: 'I65.21'
[05:23:43] ℹ️    - Diagnosis 2: 'R26.89'
[05:23:43] ℹ️    - Diagnosis 3: 'R13.12'
[05:23:43] ℹ️    - Diagnosis 4: 'E78.00'
[05:23:43] ℹ️    - Diagnosis 5: 'H25.011'
[05:23:43] ℹ️    - Diagnosis 6: 'H81.10'
[05:23:43] ℹ️  Final extracted MRN: 'MA250407073603'
[05:23:43] ℹ️  Final extracted Sex: 'FEMALE'
[05:23:43] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[05:23:43] ℹ️  Final extracted Payer Source: 'Medicare'
[05:23:43] ✅ Patient data extraction completed successfully
[05:23:43] ✅    ✅ Patient data extracted successfully
[05:23:43] 📊 Patient Response
     └─ patientFName: Harriett
     └─ patientLName: Sherman
     └─ dob: 07/22/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250407073603
     └─ billingProvider: WU, ELAINE MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 468 Neck Rd
     └─ city: Rochester
     └─ state: MA
     └─ zip: 02770
     └─ email: None
     └─ phoneNumber: (508) 287-7908
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I65.21', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'H25.011', 'sixthDiagnosis': 'H81.10'}]
[05:23:43] ✅    ✅ Patient identified: Harriett Sherman
[05:23:43] ✅    ✅ Patient name validation passed
[05:23:43] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:43] [DOC: 9246902] ℹ️  DOB normalized: 07/22/1936
[05:23:43] [DOC: 9246902] ℹ️  Episode startOfCare normalized: 04/08/2025
[05:23:43] [DOC: 9246902] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:23:43] [DOC: 9246902] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:23:43] [DOC: 9246902] ✅ Patient date processing completed successfully
[05:23:43] ✅    ✅ Date processing completed
[05:23:43] 📊 Processed Patient Data
     └─ patientFName: Harriett
     └─ patientLName: Sherman
     └─ dob: 07/22/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250407073603
     └─ billingProvider: WU, ELAINE MD
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 468 Neck Rd
     └─ city: Rochester
     └─ state: MA
     └─ zip: 02770
     └─ phoneNumber: (508) 287-7908
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I65.21', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': 'E78.00', 'fifthDiagnosis': 'H25.011', 'sixthDiagnosis': 'H81.10'}]
[05:23:43] 🔄 
🔄 Step 4: Extracting order data...
[05:23:46] ℹ️  Order extraction - MRN: 'MA250407073603'
[05:23:46] ℹ️  Order extraction - Sex: 'FEMALE'
[05:23:46] ℹ️  Order extraction - Service Line: 'PT, OT'
[05:23:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:23:46] ✅ Order data extraction completed successfully
[05:23:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:46] ℹ️  Using MRN from patient data: 'MA250407073603' over 'MA250407073603'
[05:23:46] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[05:23:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:23:46] ✅ Patient name cross-validation successful
[05:23:46] ✅    ✅ Data merged successfully
[05:23:47] ✅    ✅ Order data extracted and validated
[05:23:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:47] [DOC: 9246902] ✅ Patient found in local cache: Harriett Sherman, ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:47] ✅    ✅ Existing patient found with ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:47] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:47] [DOC: 9246902] ℹ️  Pushing order via API for patient ID: 275273c3-58eb-427c-9383-2e5746a049fd
[05:23:48] [DOC: 9246902] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14398"}
[05:23:48] ❌    ❌ Failed to push order
[05:23:48] 🔄 
🔄 Step 7: Writing to CSV...
[05:23:48] [DOC: 9246902] ℹ️  Calculated age: 88 from DOB: 07/22/1936
[05:23:48] [DOC: 9246902] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[05:23:48] [DOC: 9246902] ℹ️  Payer Source extracted: 'Medicare'
[05:23:48] [DOC: 9246902] ℹ️  Diagnosis codes being written:
[05:23:48] [DOC: 9246902] ℹ️    - Latest_Episode_Firstdiagnosis: 'I65.21'
[05:23:48] [DOC: 9246902] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.89'
[05:23:48] [DOC: 9246902] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.12'
[05:23:48] [DOC: 9246902] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.00'
[05:23:48] [DOC: 9246902] ℹ️    - Latest_Episode_Fifthdiagnosis: 'H25.011'
[05:23:48] [DOC: 9246902] ℹ️    - Latest_Episode_Sixthdiagnosis: 'H81.10'
[05:23:48] [DOC: 9246902] ✅ Patient data written to CSV: Harriett Sherman | Sex: FEMALE | Age: 88 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: MA250407073603
[05:23:48] ✅    ✅ Document 9246902 processed and saved successfully
[05:23:48] 🔄 
🔄 Step 8: Saving API details...
[05:23:48] [DOC: 9246902] ℹ️  API push details saved for document 9246902
[05:23:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246764                         ║
================================================================================
[05:23:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:23:48] ℹ️  Date: 04/17/2025
[05:23:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:23:51] [DOC: 9246764] ✅ Text extracted using pdfplumber (13529 chars)
[05:23:51] ✅    ✅ Text extracted using pdfplumber (13529 chars)
[05:23:51] 🔄 
🔄 Step 2: Extracting patient data...
[05:23:54] ℹ️  AI extracted raw sex value: 'F'
[05:23:54] ℹ️  AI extracted service line: 'OT'
[05:23:54] ℹ️  AI extracted payer source: 'None'
[05:23:54] ℹ️  AI extracted diagnoses:
[05:23:54] ℹ️    - Diagnosis 1: 'Pneumonia Exacerbation'
[05:23:54] ℹ️    - Diagnosis 2: 'muscle weakness'
[05:23:54] ℹ️    - Diagnosis 3: 'None'
[05:23:54] ℹ️    - Diagnosis 4: 'None'
[05:23:54] ℹ️    - Diagnosis 5: 'None'
[05:23:54] ℹ️    - Diagnosis 6: 'None'
[05:23:54] ℹ️  Final extracted MRN: 'MA250203063802'
[05:23:54] ℹ️  Final extracted Sex: 'FEMALE'
[05:23:54] ℹ️  Final extracted Service Line: 'OT'
[05:23:54] ℹ️  Final extracted Payer Source: ''
[05:23:54] ✅ Patient data extraction completed successfully
[05:23:54] ✅    ✅ Patient data extracted successfully
[05:23:54] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: Dr. SOUZA, AILEEN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Pneumonia Exacerbation', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:23:54] ✅    ✅ Patient identified: Priscila Diaz
[05:23:54] ✅    ✅ Patient name validation passed
[05:23:54] 🔄 
🔄 Step 3: Processing patient dates...
[05:23:54] [DOC: 9246764] ℹ️  DOB normalized: 06/11/1938
[05:23:54] [DOC: 9246764] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[05:23:54] [DOC: 9246764] ✅ Patient date processing completed successfully
[05:23:54] ✅    ✅ Date processing completed
[05:23:54] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: Dr. SOUZA, AILEEN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'firstDiagnosis': 'Pneumonia Exacerbation', 'secondDiagnosis': 'muscle weakness'}]
[05:23:54] 🔄 
🔄 Step 4: Extracting order data...
[05:23:57] ℹ️  Order extraction - MRN: 'MA250203063802'
[05:23:57] ℹ️  Order extraction - Sex: 'FEMALE'
[05:23:57] ℹ️  Order extraction - Service Line: 'OT'
[05:23:57] ℹ️  Order extraction - Payer Source: ''
[05:23:57] ✅ Order data extraction completed successfully
[05:23:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:23:57] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[05:23:57] ℹ️  Service line consistent in both sources: 'OT'
[05:23:57] ✅ Patient name cross-validation successful
[05:23:57] ✅    ✅ Data merged successfully
[05:23:58] ✅    ✅ Order data extracted and validated
[05:23:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:23:58] [DOC: 9246764] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[05:23:58] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[05:23:58] 🔄 
🔄 Step 6: Pushing order to API...
[05:23:58] [DOC: 9246764] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[05:24:00] [DOC: 9246764] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:24:00] ❌    ❌ Failed to push order
[05:24:00] 🔄 
🔄 Step 7: Writing to CSV...
[05:24:00] [DOC: 9246764] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[05:24:00] [DOC: 9246764] ℹ️  Service Line extracted: 'OT'
[05:24:00] [DOC: 9246764] ℹ️  Payer Source extracted: ''
[05:24:00] [DOC: 9246764] ℹ️  Diagnosis codes being written:
[05:24:00] [DOC: 9246764] ℹ️    - Latest_Episode_Firstdiagnosis: 'Pneumonia Exacerbation'
[05:24:00] [DOC: 9246764] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[05:24:00] [DOC: 9246764] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:24:00] [DOC: 9246764] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:24:00] [DOC: 9246764] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:24:00] [DOC: 9246764] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:24:00] [DOC: 9246764] ✅ Patient data written to CSV: Priscila Diaz | Sex: FEMALE | Age: 86 | Service: OT | Payer:  | MRN: MA250203063802
[05:24:00] ✅    ✅ Document 9246764 processed and saved successfully
[05:24:00] 🔄 
🔄 Step 8: Saving API details...
[05:24:00] [DOC: 9246764] ℹ️  API push details saved for document 9246764
[05:24:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246756                         ║
================================================================================
[05:24:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:24:00] ℹ️  Date: 04/17/2025
[05:24:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:24:02] [DOC: 9246756] ✅ Text extracted using pdfplumber (14881 chars)
[05:24:02] ✅    ✅ Text extracted using pdfplumber (14869 chars)
[05:24:02] 🔄 
🔄 Step 2: Extracting patient data...
[05:24:05] ℹ️  AI extracted raw sex value: 'F'
[05:24:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:24:05] ℹ️  AI extracted payer source: 'Medicare'
[05:24:05] ℹ️  AI extracted diagnoses:
[05:24:05] ℹ️    - Diagnosis 1: 'E11.9'
[05:24:05] ℹ️    - Diagnosis 2: 'E04.1'
[05:24:05] ℹ️    - Diagnosis 3: 'M79.7'
[05:24:05] ℹ️    - Diagnosis 4: 'E78.2'
[05:24:05] ℹ️    - Diagnosis 5: 'I10'
[05:24:05] ℹ️    - Diagnosis 6: 'D64.9'
[05:24:05] ℹ️  Final extracted MRN: 'MA250313044605'
[05:24:05] ℹ️  Final extracted Sex: 'FEMALE'
[05:24:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:24:05] ℹ️  Final extracted Payer Source: 'Medicare'
[05:24:05] ✅ Patient data extraction completed successfully
[05:24:05] ✅    ✅ Patient data extracted successfully
[05:24:05] 📊 Patient Response
     └─ patientFName: Shirley Ann
     └─ patientLName: Marcondes
     └─ dob: 04/09/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250313044605
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 90 Riverside Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 207-3630
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'E04.1', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': 'E78.2', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D64.9'}]
[05:24:05] ✅    ✅ Patient identified: Shirley Ann Marcondes
[05:24:05] ✅    ✅ Patient name validation passed
[05:24:05] 🔄 
🔄 Step 3: Processing patient dates...
[05:24:05] [DOC: 9246756] ℹ️  DOB normalized: 04/09/1946
[05:24:05] [DOC: 9246756] ℹ️  Episode startOfCare normalized: 03/21/2025
[05:24:05] [DOC: 9246756] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[05:24:05] [DOC: 9246756] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[05:24:05] [DOC: 9246756] ✅ Patient date processing completed successfully
[05:24:05] ✅    ✅ Date processing completed
[05:24:05] 📊 Processed Patient Data
     └─ patientFName: Shirley Ann
     └─ patientLName: Marcondes
     └─ dob: 04/09/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250313044605
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 90 Riverside Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 207-3630
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'E04.1', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': 'E78.2', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D64.9'}]
[05:24:05] 🔄 
🔄 Step 4: Extracting order data...
[05:24:08] ℹ️  Order extraction - MRN: 'MA250313044605'
[05:24:08] ℹ️  Order extraction - Sex: 'FEMALE'
[05:24:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:24:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:24:08] ✅ Order data extraction completed successfully
[05:24:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:24:08] ℹ️  Using MRN from patient data: 'MA250313044605' over 'MA250313044605'
[05:24:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:24:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:24:08] ✅ Patient name cross-validation successful
[05:24:08] ✅    ✅ Data merged successfully
[05:24:10] ✅    ✅ Order data extracted and validated
[05:24:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:24:31] [DOC: 9246756] ✅ Patient exists in API: Shirley Ann Marcondes, ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[05:24:31] ✅    ✅ Existing patient found with ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[05:24:31] 🔄 
🔄 Step 6: Pushing order to API...
[05:24:31] [DOC: 9246756] ℹ️  Pushing order via API for patient ID: 01597c8d-6b1c-4104-892c-d5a0a666a7dd
[05:24:32] [DOC: 9246756] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14019"}
[05:24:32] ❌    ❌ Failed to push order
[05:24:32] 🔄 
🔄 Step 7: Writing to CSV...
[05:24:32] [DOC: 9246756] ℹ️  Calculated age: 79 from DOB: 04/09/1946
[05:24:32] [DOC: 9246756] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:24:32] [DOC: 9246756] ℹ️  Payer Source extracted: 'Medicare'
[05:24:32] [DOC: 9246756] ℹ️  Diagnosis codes being written:
[05:24:32] [DOC: 9246756] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[05:24:32] [DOC: 9246756] ℹ️    - Latest_Episode_Seconddiagnosis: 'E04.1'
[05:24:32] [DOC: 9246756] ℹ️    - Latest_Episode_Thirddiagnosis: 'M79.7'
[05:24:32] [DOC: 9246756] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.2'
[05:24:32] [DOC: 9246756] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[05:24:32] [DOC: 9246756] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D64.9'
[05:24:32] [DOC: 9246756] ✅ Patient data written to CSV: Shirley Ann Marcondes | Sex: FEMALE | Age: 79 | Service: Skilled Nursing | Payer: Medicare | MRN: MA250313044605
[05:24:32] ✅    ✅ Document 9246756 processed and saved successfully
[05:24:32] 🔄 
🔄 Step 8: Saving API details...
[05:24:32] [DOC: 9246756] ℹ️  API push details saved for document 9246756
[05:24:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246722                         ║
================================================================================
[05:24:32] ℹ️  Agency: Alphacare Home Health Agency
[05:24:32] ℹ️  Date: 04/17/2025
[05:24:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:24:34] [DOC: 9246722] ✅ Text extracted using pdfplumber (1987 chars)
[05:24:34] ✅    ✅ Text extracted using pdfplumber (1987 chars)
[05:24:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:24:37] ℹ️  AI extracted raw sex value: ''
[05:24:37] ℹ️  AI extracted service line: 'PT'
[05:24:37] ℹ️  AI extracted payer source: ''
[05:24:37] ℹ️  AI extracted diagnoses:
[05:24:37] ℹ️    - Diagnosis 1: 'U07.1'
[05:24:37] ℹ️    - Diagnosis 2: 'M62.81'
[05:24:37] ℹ️    - Diagnosis 3: 'R26.9'
[05:24:37] ℹ️    - Diagnosis 4: 'J44.1'
[05:24:37] ℹ️    - Diagnosis 5: 'None'
[05:24:37] ℹ️    - Diagnosis 6: 'None'
[05:24:37] ℹ️  Final extracted MRN: '000003626'
[05:24:37] ℹ️  Final extracted Sex: ''
[05:24:37] ℹ️  Final extracted Service Line: 'PT'
[05:24:37] ℹ️  Final extracted Payer Source: ''
[05:24:37] ✅ Patient data extraction completed successfully
[05:24:37] ✅    ✅ Patient data extracted successfully
[05:24:37] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Costello
     └─ dob: 09/25/1953
     └─ patientSex: 
     └─ medicalRecordNo: 000003626
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': None, 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.9', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:24:37] ✅    ✅ Patient identified: Edward Costello
[05:24:37] ✅    ✅ Patient name validation passed
[05:24:37] 🔄 
🔄 Step 3: Processing patient dates...
[05:24:37] [DOC: 9246722] ℹ️  DOB normalized: 09/25/1953
[05:24:37] [DOC: 9246722] ℹ️  Episode startOfCare normalized: 04/01/2025
[05:24:37] [DOC: 9246722] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[05:24:37] [DOC: 9246722] ✅ Patient date processing completed successfully
[05:24:37] ✅    ✅ Date processing completed
[05:24:37] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Costello
     └─ dob: 09/25/1953
     └─ patientSex: 
     └─ medicalRecordNo: 000003626
     └─ billingProvider: Bautista, Karmina (MD (Dr. Alliance))
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.9', 'fourthDiagnosis': 'J44.1'}]
[05:24:37] 🔄 
🔄 Step 4: Extracting order data...
[05:24:40] ℹ️  Order extraction - MRN: '000003626'
[05:24:40] ℹ️  Order extraction - Sex: ''
[05:24:40] ℹ️  Order extraction - Service Line: 'PT'
[05:24:40] ℹ️  Order extraction - Payer Source: ''
[05:24:40] ✅ Order data extraction completed successfully
[05:24:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:24:40] ℹ️  Using MRN from patient data: '000003626' over '000003626'
[05:24:40] ℹ️  Inferred sex as MALE from name: Edward
[05:24:40] ℹ️  Service line consistent in both sources: 'PT'
[05:24:40] ✅ Patient name cross-validation successful
[05:24:40] ✅    ✅ Data merged successfully
[05:24:41] ✅    ✅ Order data extracted and validated
[05:24:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:24:48] [DOC: 9246722] ✅ Patient exists in API: Edward Costello, ID: d4e3011f-983e-4bbc-86d0-12c21d9a7024
[05:24:48] ✅    ✅ Existing patient found with ID: d4e3011f-983e-4bbc-86d0-12c21d9a7024
[05:24:48] 🔄 
🔄 Step 6: Pushing order to API...
[05:24:48] [DOC: 9246722] ℹ️  Pushing order via API for patient ID: d4e3011f-983e-4bbc-86d0-12c21d9a7024
[05:24:49] [DOC: 9246722] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:24:49] ❌    ❌ Failed to push order
[05:24:49] 🔄 
🔄 Step 7: Writing to CSV...
[05:24:49] [DOC: 9246722] ℹ️  Calculated age: 71 from DOB: 09/25/1953
[05:24:49] [DOC: 9246722] ℹ️  Service Line extracted: 'PT'
[05:24:49] [DOC: 9246722] ℹ️  Payer Source extracted: ''
[05:24:49] [DOC: 9246722] ℹ️  Diagnosis codes being written:
[05:24:49] [DOC: 9246722] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[05:24:49] [DOC: 9246722] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[05:24:49] [DOC: 9246722] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.9'
[05:24:49] [DOC: 9246722] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.1'
[05:24:49] [DOC: 9246722] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:24:49] [DOC: 9246722] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:24:49] [DOC: 9246722] ✅ Patient data written to CSV: Edward Costello | Sex: MALE | Age: 71 | Service: PT | Payer:  | MRN: 000003626
[05:24:49] ✅    ✅ Document 9246722 processed and saved successfully
[05:24:49] 🔄 
🔄 Step 8: Saving API details...
[05:24:49] [DOC: 9246722] ℹ️  API push details saved for document 9246722
[05:24:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246713                         ║
================================================================================
[05:24:49] ℹ️  Agency: Alphacare Home Health Agency
[05:24:49] ℹ️  Date: 04/17/2025
[05:24:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:24:52] [DOC: 9246713] ✅ Text extracted using pdfplumber (13261 chars)
[05:24:52] ✅    ✅ Text extracted using pdfplumber (13261 chars)
[05:24:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:24:56] ℹ️  AI extracted raw sex value: 'M'
[05:24:56] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[05:24:56] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[05:24:56] ℹ️  AI extracted diagnoses:
[05:24:56] ℹ️    - Diagnosis 1: 'U07.1'
[05:24:56] ℹ️    - Diagnosis 2: 'M62.81'
[05:24:56] ℹ️    - Diagnosis 3: 'R26.9'
[05:24:56] ℹ️    - Diagnosis 4: 'J44.1'
[05:24:56] ℹ️    - Diagnosis 5: 'J18.1'
[05:24:56] ℹ️    - Diagnosis 6: 'I10'
[05:24:56] ℹ️  Final extracted MRN: '000003626'
[05:24:56] ℹ️  Final extracted Sex: 'MALE'
[05:24:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[05:24:56] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[05:24:56] ✅ Patient data extraction completed successfully
[05:24:56] ✅    ✅ Patient data extracted successfully
[05:24:56] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Costello
     └─ dob: 09/25/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 000003626
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 525 Coggesshall Street Suite/Apt #Apt 104
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: 508-998-6364
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.9', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': 'J18.1', 'sixthDiagnosis': 'I10'}]
[05:24:56] ✅    ✅ Patient identified: Edward Costello
[05:24:56] ✅    ✅ Patient name validation passed
[05:24:56] 🔄 
🔄 Step 3: Processing patient dates...
[05:24:56] [DOC: 9246713] ℹ️  DOB normalized: 09/25/1953
[05:24:56] [DOC: 9246713] ℹ️  Episode startOfCare normalized: 04/01/2025
[05:24:56] [DOC: 9246713] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[05:24:56] [DOC: 9246713] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[05:24:56] [DOC: 9246713] ✅ Patient date processing completed successfully
[05:24:56] ✅    ✅ Date processing completed
[05:24:56] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Costello
     └─ dob: 09/25/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 000003626
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 525 Coggesshall Street Suite/Apt #Apt 104
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: 508-998-6364
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'R26.9', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': 'J18.1', 'sixthDiagnosis': 'I10'}]
[05:24:56] 🔄 
🔄 Step 4: Extracting order data...
[05:24:58] ℹ️  Order extraction - MRN: '000003626'
[05:24:58] ℹ️  Order extraction - Sex: 'MALE'
[05:24:58] ℹ️  Order extraction - Service Line: 'PT, Skilled Nursing'
[05:24:58] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[05:24:58] ✅ Order data extraction completed successfully
[05:24:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:24:58] ℹ️  Using MRN from patient data: '000003626' over '000003626'
[05:24:58] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='PT, Skilled Nursing' = 'PT, Skilled Nursing'
[05:24:58] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[05:24:58] ✅ Patient name cross-validation successful
[05:24:58] ✅    ✅ Data merged successfully
[05:25:00] ✅    ✅ Order data extracted and validated
[05:25:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:25:00] [DOC: 9246713] ✅ Patient found in local cache: Edward Costello, ID: d4e3011f-983e-4bbc-86d0-12c21d9a7024
[05:25:00] ✅    ✅ Existing patient found with ID: d4e3011f-983e-4bbc-86d0-12c21d9a7024
[05:25:00] 🔄 
🔄 Step 6: Pushing order to API...
[05:25:00] [DOC: 9246713] ℹ️  Pushing order via API for patient ID: d4e3011f-983e-4bbc-86d0-12c21d9a7024
[05:25:01] [DOC: 9246713] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:25:01] ❌    ❌ Failed to push order
[05:25:01] 🔄 
🔄 Step 7: Writing to CSV...
[05:25:01] [DOC: 9246713] ℹ️  Calculated age: 71 from DOB: 09/25/1953
[05:25:01] [DOC: 9246713] ℹ️  Service Line extracted: 'PT, Skilled Nursing'
[05:25:01] [DOC: 9246713] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[05:25:01] [DOC: 9246713] ℹ️  Diagnosis codes being written:
[05:25:01] [DOC: 9246713] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[05:25:01] [DOC: 9246713] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[05:25:01] [DOC: 9246713] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.9'
[05:25:01] [DOC: 9246713] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.1'
[05:25:01] [DOC: 9246713] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J18.1'
[05:25:01] [DOC: 9246713] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[05:25:01] [DOC: 9246713] ✅ Patient data written to CSV: Edward Costello | Sex: MALE | Age: 71 | Service: PT, Skilled Nursing | Payer: MassHealth (Medicaid) | MRN: 000003626
[05:25:01] ✅    ✅ Document 9246713 processed and saved successfully
[05:25:01] 🔄 
🔄 Step 8: Saving API details...
[05:25:01] [DOC: 9246713] ℹ️  API push details saved for document 9246713
[05:25:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246387                         ║
================================================================================
[05:25:01] ℹ️  Agency: Alphacare Home Health Agency
[05:25:01] ℹ️  Date: 04/17/2025
[05:25:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:25:04] [DOC: 9246387] ✅ Text extracted using pdfplumber (2902 chars)
[05:25:04] ✅    ✅ Text extracted using pdfplumber (2902 chars)
[05:25:04] 🔄 
🔄 Step 2: Extracting patient data...
[05:25:06] ℹ️  AI extracted raw sex value: ''
[05:25:06] ℹ️  AI extracted service line: 'RN'
[05:25:06] ℹ️  AI extracted payer source: ''
[05:25:06] ℹ️  AI extracted diagnoses:
[05:25:06] ℹ️    - Diagnosis 1: 'J44.9'
[05:25:06] ℹ️    - Diagnosis 2: 'J18.9'
[05:25:06] ℹ️    - Diagnosis 3: 'None'
[05:25:06] ℹ️    - Diagnosis 4: 'None'
[05:25:06] ℹ️    - Diagnosis 5: 'None'
[05:25:06] ℹ️    - Diagnosis 6: 'None'
[05:25:06] ℹ️  Final extracted MRN: '000003097'
[05:25:06] ℹ️  Final extracted Sex: ''
[05:25:06] ℹ️  Final extracted Service Line: 'RN'
[05:25:06] ℹ️  Final extracted Payer Source: ''
[05:25:06] ✅ Patient data extraction completed successfully
[05:25:06] ✅    ✅ Patient data extracted successfully
[05:25:06] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/23/2025', 'endOfEpisode': None, 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:25:06] ✅    ✅ Patient identified: Gloria Medeiros
[05:25:06] ✅    ✅ Patient name validation passed
[05:25:06] 🔄 
🔄 Step 3: Processing patient dates...
[05:25:06] [DOC: 9246387] ℹ️  DOB normalized: 07/04/1946
[05:25:06] [DOC: 9246387] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[05:25:06] [DOC: 9246387] ✅ Patient date processing completed successfully
[05:25:06] ✅    ✅ Date processing completed
[05:25:06] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J18.9'}]
[05:25:06] 🔄 
🔄 Step 4: Extracting order data...
[05:25:09] ℹ️  Order extraction - MRN: '000003097'
[05:25:09] ℹ️  Order extraction - Sex: ''
[05:25:09] ℹ️  Order extraction - Service Line: 'RN'
[05:25:09] ℹ️  Order extraction - Payer Source: ''
[05:25:09] ✅ Order data extraction completed successfully
[05:25:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:25:09] ℹ️  Using MRN from patient data: '000003097' over '000003097'
[05:25:09] ⚠️  Could not determine sex using any available method
[05:25:09] ℹ️  Service line consistent in both sources: 'RN'
[05:25:09] ✅ Patient name cross-validation successful
[05:25:09] ✅    ✅ Data merged successfully
[05:25:10] ✅    ✅ Order data extracted and validated
[05:25:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:25:29] [DOC: 9246387] ✅ Patient exists in API: Gloria Medeiros, ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[05:25:29] ✅    ✅ Existing patient found with ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[05:25:29] 🔄 
🔄 Step 6: Pushing order to API...
[05:25:29] [DOC: 9246387] ℹ️  Pushing order via API for patient ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[05:25:30] [DOC: 9246387] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:25:30] ❌    ❌ Failed to push order
[05:25:30] 🔄 
🔄 Step 7: Writing to CSV...
[05:25:30] [DOC: 9246387] ℹ️  Calculated age: 78 from DOB: 07/04/1946
[05:25:30] [DOC: 9246387] ℹ️  Service Line extracted: 'RN'
[05:25:30] [DOC: 9246387] ℹ️  Payer Source extracted: ''
[05:25:30] [DOC: 9246387] ℹ️  Diagnosis codes being written:
[05:25:30] [DOC: 9246387] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[05:25:30] [DOC: 9246387] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[05:25:30] [DOC: 9246387] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:25:30] [DOC: 9246387] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:25:30] [DOC: 9246387] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:25:30] [DOC: 9246387] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:25:30] [DOC: 9246387] ✅ Patient data written to CSV: Gloria Medeiros | Sex:  | Age: 78 | Service: RN | Payer:  | MRN: 000003097
[05:25:30] ✅    ✅ Document 9246387 processed and saved successfully
[05:25:30] 🔄 
🔄 Step 8: Saving API details...
[05:25:30] [DOC: 9246387] ℹ️  API push details saved for document 9246387
[05:25:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246220                         ║
================================================================================
[05:25:30] ℹ️  Agency: Enhabit OF NEW ENGLAND - (SPR)
[05:25:30] ℹ️  Date: 04/17/2025
[05:25:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:25:38] [DOC: 9246220] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[05:25:46] [DOC: 9246220] ✅ Text extracted using tesseract_ocr (13892 chars)
[05:25:46] ✅    ✅ Text extracted using tesseract_ocr (13838 chars)
[05:25:46] 🔄 
🔄 Step 2: Extracting patient data...
[05:25:49] ℹ️  AI extracted raw sex value: 'F'
[05:25:49] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:25:49] ℹ️  AI extracted payer source: 'Medicare'
[05:25:49] ℹ️  AI extracted diagnoses:
[05:25:49] ℹ️    - Diagnosis 1: 'M48.02'
[05:25:49] ℹ️    - Diagnosis 2: 'M62.81'
[05:25:49] ℹ️    - Diagnosis 3: 'W19.XXXD'
[05:25:49] ℹ️    - Diagnosis 4: '298.1'
[05:25:49] ℹ️    - Diagnosis 5: '110'
[05:25:49] ℹ️    - Diagnosis 6: 'E119'
[05:25:49] ℹ️  Final extracted MRN: 'WES00146792801'
[05:25:49] ℹ️  Final extracted Sex: 'FEMALE'
[05:25:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:25:49] ℹ️  Final extracted Payer Source: 'Medicare'
[05:25:49] ✅ Patient data extraction completed successfully
[05:25:49] ✅    ✅ Patient data extracted successfully
[05:25:49] 📊 Patient Response
     └─ patientFName: NATALIE
     └─ patientLName: XAVIER
     └─ dob: 12/20/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: WES00146792801
     └─ billingProvider: ENHABIT HOME HEALTH (WES)
     └─ npi: 227570
     └─ physicianNPI: 
     └─ nameOfAgency: ENHABIT HOME HEALTH (WES)
     └─ address: 10 GREEN MEADOW DR
     └─ city: ACUSHNET
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (774) 992-7068
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '06/28/2024', 'endOfEpisode': '08/26/2024', 'firstDiagnosis': 'M48.02', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'W19.XXXD', 'fourthDiagnosis': '298.1', 'fifthDiagnosis': '110', 'sixthDiagnosis': 'E119'}]
[05:25:49] ✅    ✅ Patient identified: NATALIE XAVIER
[05:25:49] ✅    ✅ Patient name validation passed
[05:25:49] 🔄 
🔄 Step 3: Processing patient dates...
[05:25:49] [DOC: 9246220] ℹ️  DOB normalized: 12/20/1942
[05:25:49] [DOC: 9246220] ℹ️  Episode startOfCare normalized: 06/28/2024
[05:25:49] [DOC: 9246220] ℹ️  Episode startOfEpisode normalized: 06/28/2024
[05:25:49] [DOC: 9246220] ℹ️  Episode endOfEpisode normalized: 08/26/2024
[05:25:49] [DOC: 9246220] ✅ Patient date processing completed successfully
[05:25:49] ✅    ✅ Date processing completed
[05:25:49] 📊 Processed Patient Data
     └─ patientFName: NATALIE
     └─ patientLName: XAVIER
     └─ dob: 12/20/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: WES00146792801
     └─ billingProvider: ENHABIT HOME HEALTH (WES)
     └─ npi: 227570
     └─ physicianNPI: 
     └─ nameOfAgency: ENHABIT HOME HEALTH (WES)
     └─ address: 10 GREEN MEADOW DR
     └─ city: ACUSHNET
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (774) 992-7068
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '06/28/2024', 'endOfEpisode': '08/26/2024', 'firstDiagnosis': 'M48.02', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'W19.XXXD', 'fourthDiagnosis': '298.1', 'fifthDiagnosis': '110', 'sixthDiagnosis': 'E119'}]
[05:25:49] 🔄 
🔄 Step 4: Extracting order data...
[05:25:52] ℹ️  Order extraction - MRN: 'WES00146792801'
[05:25:52] ℹ️  Order extraction - Sex: 'FEMALE'
[05:25:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:25:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:25:52] ✅ Order data extraction completed successfully
[05:25:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:25:52] ℹ️  Using MRN from patient data: 'WES00146792801' over 'WES00146792801'
[05:25:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:25:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:25:52] ✅ Patient name cross-validation successful
[05:25:52] ✅    ✅ Data merged successfully
[05:25:53] ✅    ✅ Order data extracted and validated
[05:25:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:26:06] [DOC: 9246220] ℹ️  Patient not found in cache or API: NATALIE XAVIER
[05:26:06] [DOC: 9246220] ℹ️  Patient not found, creating new patient via API...
[05:26:06] [DOC: 9246220] ℹ️  Creating patient via API: NATALIE XAVIER
[05:26:07] [DOC: 9246220] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:26:07] ❌    ❌ Failed to create patient
[05:26:07] [DOC: 9246220] ℹ️  API push details saved for document 9246220
================================================================================
║                        Processing Document ID: 9246210                         ║
================================================================================
[05:26:07] ℹ️  Agency: Dartmouth HH
[05:26:07] ℹ️  Date: 04/17/2025
[05:26:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:26:09] [DOC: 9246210] ✅ Text extracted using pdfplumber (4635 chars)
[05:26:09] ✅    ✅ Text extracted using pdfplumber (4635 chars)
[05:26:09] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:12] ℹ️  AI extracted raw sex value: 'M'
[05:26:12] ℹ️  AI extracted service line: 'PT, OT'
[05:26:12] ℹ️  AI extracted payer source: 'Medicare'
[05:26:12] ℹ️  AI extracted diagnoses:
[05:26:12] ℹ️    - Diagnosis 1: ''
[05:26:12] ℹ️    - Diagnosis 2: ''
[05:26:12] ℹ️    - Diagnosis 3: ''
[05:26:12] ℹ️    - Diagnosis 4: ''
[05:26:12] ℹ️    - Diagnosis 5: ''
[05:26:12] ℹ️    - Diagnosis 6: ''
[05:26:12] ℹ️  Final extracted MRN: '1396009'
[05:26:12] ℹ️  Final extracted Sex: 'MALE'
[05:26:12] ℹ️  Final extracted Service Line: 'PT, OT'
[05:26:12] ℹ️  Final extracted Payer Source: 'Medicare'
[05:26:12] ✅ Patient data extraction completed successfully
[05:26:12] ✅    ✅ Patient data extracted successfully
[05:26:12] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:26:12] ✅    ✅ Patient identified: Elias Ramos
[05:26:12] ✅    ✅ Patient name validation passed
[05:26:12] 🔄 
🔄 Step 3: Processing patient dates...
[05:26:12] [DOC: 9246210] ℹ️  DOB normalized: 08/28/1938
[05:26:12] [DOC: 9246210] ℹ️  Episode startOfCare normalized: 12/31/2024
[05:26:12] [DOC: 9246210] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[05:26:12] [DOC: 9246210] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[05:26:12] [DOC: 9246210] ✅ Patient date processing completed successfully
[05:26:12] ✅    ✅ Date processing completed
[05:26:12] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:26:12] 🔄 
🔄 Step 4: Extracting order data...
[05:26:14] ℹ️  Order extraction - MRN: ''
[05:26:14] ℹ️  Order extraction - Sex: 'MALE'
[05:26:14] ℹ️  Order extraction - Service Line: 'OT, PT'
[05:26:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:26:14] ✅ Order data extraction completed successfully
[05:26:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:26:14] ℹ️  Using MRN from patient data: '1396009'
[05:26:14] ℹ️  Combined service lines: Patient='PT, OT' + Order='OT, PT' = 'OT, PT'
[05:26:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:26:14] ✅ Patient name cross-validation successful
[05:26:14] ✅    ✅ Data merged successfully
[05:26:16] ✅    ✅ Order data extracted and validated
[05:26:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:26:16] [DOC: 9246210] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[05:26:16] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[05:26:16] 🔄 
🔄 Step 6: Pushing order to API...
[05:26:16] [DOC: 9246210] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[05:26:17] [DOC: 9246210] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13134"}
[05:26:17] ❌    ❌ Failed to push order
[05:26:17] 🔄 
🔄 Step 7: Writing to CSV...
[05:26:17] [DOC: 9246210] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[05:26:17] [DOC: 9246210] ℹ️  Service Line extracted: 'OT, PT'
[05:26:17] [DOC: 9246210] ℹ️  Payer Source extracted: 'Medicare'
[05:26:17] [DOC: 9246210] ℹ️  Diagnosis codes being written:
[05:26:17] [DOC: 9246210] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:26:17] [DOC: 9246210] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:26:17] [DOC: 9246210] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:26:17] [DOC: 9246210] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:26:17] [DOC: 9246210] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:26:17] [DOC: 9246210] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:26:17] [DOC: 9246210] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: OT, PT | Payer: Medicare | MRN: 1396009
[05:26:17] ✅    ✅ Document 9246210 processed and saved successfully
[05:26:17] 🔄 
🔄 Step 8: Saving API details...
[05:26:17] [DOC: 9246210] ℹ️  API push details saved for document 9246210
[05:26:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246208                         ║
================================================================================
[05:26:17] ℹ️  Agency: Enhabit OF NEW ENGLAND - (SPR)
[05:26:17] ℹ️  Date: 04/17/2025
[05:26:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:26:20] [DOC: 9246208] ✅ Text extracted using pdfplumber (117 chars)
[05:26:20] ✅    ✅ Text extracted using pdfplumber (117 chars)
[05:26:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:22] ℹ️  AI extracted raw sex value: ''
[05:26:22] ℹ️  AI extracted service line: ''
[05:26:22] ℹ️  AI extracted payer source: ''
[05:26:22] ℹ️  AI extracted diagnoses:
[05:26:22] ℹ️    - Diagnosis 1: ''
[05:26:22] ℹ️    - Diagnosis 2: ''
[05:26:22] ℹ️    - Diagnosis 3: ''
[05:26:22] ℹ️    - Diagnosis 4: ''
[05:26:22] ℹ️    - Diagnosis 5: ''
[05:26:22] ℹ️    - Diagnosis 6: ''
[05:26:22] ℹ️  Final extracted MRN: ''
[05:26:22] ℹ️  Final extracted Sex: ''
[05:26:22] ℹ️  Final extracted Service Line: ''
[05:26:22] ℹ️  Final extracted Payer Source: ''
[05:26:22] ✅ Patient data extraction completed successfully
[05:26:22] ✅    ✅ Patient data extracted successfully
[05:26:22] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:26:22] ⚠️     ❌ Insufficient patient data extracted
[05:26:22] [DOC: 9246208] ℹ️  API push details saved for document 9246208
================================================================================
║                        Processing Document ID: 9246171                         ║
================================================================================
[05:26:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:26:22] ℹ️  Date: 04/17/2025
[05:26:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:26:25] [DOC: 9246171] ✅ Text extracted using pdfplumber (13084 chars)
[05:26:25] ✅    ✅ Text extracted using pdfplumber (13084 chars)
[05:26:25] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:28] ℹ️  AI extracted raw sex value: 'F'
[05:26:28] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:26:28] ℹ️  AI extracted payer source: 'Humana'
[05:26:28] ℹ️  AI extracted diagnoses:
[05:26:28] ℹ️    - Diagnosis 1: 'G20.A1'
[05:26:28] ℹ️    - Diagnosis 2: 'I11.9'
[05:26:28] ℹ️    - Diagnosis 3: 'E11.40'
[05:26:28] ℹ️    - Diagnosis 4: 'I44.7'
[05:26:28] ℹ️    - Diagnosis 5: 'I42.9'
[05:26:28] ℹ️    - Diagnosis 6: 'J44.9'
[05:26:28] ℹ️  Final extracted MRN: 'MA241007025405'
[05:26:28] ℹ️  Final extracted Sex: 'FEMALE'
[05:26:28] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:26:28] ℹ️  Final extracted Payer Source: 'Humana'
[05:26:28] ✅ Patient data extraction completed successfully
[05:26:28] ✅    ✅ Patient data extracted successfully
[05:26:28] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 1881923936
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 175 Caroline St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 438-2823
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Humana
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I44.7', 'fifthDiagnosis': 'I42.9', 'sixthDiagnosis': 'J44.9'}]
[05:26:28] ✅    ✅ Patient identified: Gordonna Walker
[05:26:28] ✅    ✅ Patient name validation passed
[05:26:28] 🔄 
🔄 Step 3: Processing patient dates...
[05:26:28] [DOC: 9246171] ℹ️  DOB normalized: 02/21/1954
[05:26:28] [DOC: 9246171] ℹ️  Episode startOfCare normalized: 03/24/2025
[05:26:28] [DOC: 9246171] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[05:26:28] [DOC: 9246171] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[05:26:28] [DOC: 9246171] ✅ Patient date processing completed successfully
[05:26:28] ✅    ✅ Date processing completed
[05:26:28] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 1881923936
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 175 Caroline St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 438-2823
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Humana
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I44.7', 'fifthDiagnosis': 'I42.9', 'sixthDiagnosis': 'J44.9'}]
[05:26:28] 🔄 
🔄 Step 4: Extracting order data...
[05:26:31] ℹ️  Order extraction - MRN: 'MA241007025405'
[05:26:31] ℹ️  Order extraction - Sex: 'FEMALE'
[05:26:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:26:31] ℹ️  Order extraction - Payer Source: 'Humana'
[05:26:31] ✅ Order data extraction completed successfully
[05:26:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:26:31] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[05:26:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:26:31] ℹ️  Payer source consistent in both sources: 'Humana'
[05:26:31] ✅ Patient name cross-validation successful
[05:26:31] ✅    ✅ Data merged successfully
[05:26:32] ✅    ✅ Order data extracted and validated
[05:26:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:26:37] [DOC: 9246171] ✅ Patient exists in API: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[05:26:37] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[05:26:37] 🔄 
🔄 Step 6: Pushing order to API...
[05:26:37] [DOC: 9246171] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[05:26:38] [DOC: 9246171] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14403"}
[05:26:38] ❌    ❌ Failed to push order
[05:26:38] 🔄 
🔄 Step 7: Writing to CSV...
[05:26:38] [DOC: 9246171] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[05:26:38] [DOC: 9246171] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:26:38] [DOC: 9246171] ℹ️  Payer Source extracted: 'Humana'
[05:26:38] [DOC: 9246171] ℹ️  Diagnosis codes being written:
[05:26:38] [DOC: 9246171] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[05:26:38] [DOC: 9246171] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[05:26:38] [DOC: 9246171] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[05:26:38] [DOC: 9246171] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I44.7'
[05:26:38] [DOC: 9246171] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I42.9'
[05:26:38] [DOC: 9246171] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J44.9'
[05:26:38] [DOC: 9246171] ✅ Patient data written to CSV: Gordonna Walker | Sex: FEMALE | Age: 71 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Humana | MRN: MA241007025405
[05:26:38] ✅    ✅ Document 9246171 processed and saved successfully
[05:26:38] 🔄 
🔄 Step 8: Saving API details...
[05:26:38] [DOC: 9246171] ℹ️  API push details saved for document 9246171
[05:26:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246136                         ║
================================================================================
[05:26:38] ℹ️  Agency: Enhabit OF NEW ENGLAND - (SPR)
[05:26:38] ℹ️  Date: 04/17/2025
[05:26:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:26:48] [DOC: 9246136] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[05:26:55] [DOC: 9246136] ✅ Text extracted using tesseract_ocr (14139 chars)
[05:26:55] ✅    ✅ Text extracted using tesseract_ocr (14092 chars)
[05:26:55] 🔄 
🔄 Step 2: Extracting patient data...
[05:26:58] ℹ️  AI extracted raw sex value: 'M'
[05:26:58] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:26:58] ℹ️  AI extracted payer source: 'Medicare'
[05:26:58] ℹ️  AI extracted diagnoses:
[05:26:58] ℹ️    - Diagnosis 1: '7471'
[05:26:58] ℹ️    - Diagnosis 2: '296.651'
[05:26:58] ℹ️    - Diagnosis 3: 'I10'
[05:26:58] ℹ️    - Diagnosis 4: 'E03.9'
[05:26:58] ℹ️    - Diagnosis 5: '182.402'
[05:26:58] ℹ️    - Diagnosis 6: '279.82'
[05:26:58] ℹ️  Final extracted MRN: 'WES00145237101'
[05:26:58] ℹ️  Final extracted Sex: 'MALE'
[05:26:58] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:26:58] ℹ️  Final extracted Payer Source: 'Medicare'
[05:26:58] ✅ Patient data extraction completed successfully
[05:26:58] ✅    ✅ Patient data extracted successfully
[05:26:58] 📊 Patient Response
     └─ patientFName: OLIMPIO
     └─ patientLName: MASSA
     └─ dob: 04/01/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: WES00145237101
     └─ billingProvider: ENHABIT HOME HEALTH (WES)
     └─ npi: 227570
     └─ physicianNPI: 
     └─ nameOfAgency: ENHABIT HOME HEALTH (WES)
     └─ address: 88 TOWER HILL RD
     └─ city: LAKEVILLE
     └─ state: MA
     └─ zip: 02347
     └─ email: 
     └─ phoneNumber: (774) 9927068
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2024', 'startOfEpisode': '03/27/2024', 'endOfEpisode': '05/25/2024', 'firstDiagnosis': '7471', 'secondDiagnosis': '296.651', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': '182.402', 'sixthDiagnosis': '279.82'}]
[05:26:58] ✅    ✅ Patient identified: OLIMPIO MASSA
[05:26:58] ✅    ✅ Patient name validation passed
[05:26:58] 🔄 
🔄 Step 3: Processing patient dates...
[05:26:58] [DOC: 9246136] ℹ️  DOB normalized: 04/01/1948
[05:26:58] [DOC: 9246136] ℹ️  Episode startOfCare normalized: 03/27/2024
[05:26:58] [DOC: 9246136] ℹ️  Episode startOfEpisode normalized: 03/27/2024
[05:26:58] [DOC: 9246136] ℹ️  Episode endOfEpisode normalized: 05/25/2024
[05:26:58] [DOC: 9246136] ✅ Patient date processing completed successfully
[05:26:58] ✅    ✅ Date processing completed
[05:26:58] 📊 Processed Patient Data
     └─ patientFName: OLIMPIO
     └─ patientLName: MASSA
     └─ dob: 04/01/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: WES00145237101
     └─ billingProvider: ENHABIT HOME HEALTH (WES)
     └─ npi: 227570
     └─ physicianNPI: 
     └─ nameOfAgency: ENHABIT HOME HEALTH (WES)
     └─ address: 88 TOWER HILL RD
     └─ city: LAKEVILLE
     └─ state: MA
     └─ zip: 02347
     └─ email: 
     └─ phoneNumber: (774) 9927068
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2024', 'startOfEpisode': '03/27/2024', 'endOfEpisode': '05/25/2024', 'firstDiagnosis': '7471', 'secondDiagnosis': '296.651', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': '182.402', 'sixthDiagnosis': '279.82'}]
[05:26:58] 🔄 
🔄 Step 4: Extracting order data...
[05:27:01] ℹ️  Order extraction - MRN: '312712024'
[05:27:01] ℹ️  Order extraction - Sex: 'MALE'
[05:27:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:27:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:27:01] ✅ Order data extraction completed successfully
[05:27:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:27:01] ℹ️  Using MRN from patient data: 'WES00145237101' over '312712024'
[05:27:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[05:27:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:27:01] ✅ Patient name cross-validation successful
[05:27:01] ✅    ✅ Data merged successfully
[05:27:02] ✅    ✅ Order data extracted and validated
[05:27:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:27:07] [DOC: 9246136] ℹ️  Patient not found in cache or API: OLIMPIO MASSA
[05:27:07] [DOC: 9246136] ℹ️  Patient not found, creating new patient via API...
[05:27:07] [DOC: 9246136] ℹ️  Creating patient via API: OLIMPIO MASSA
[05:27:08] [DOC: 9246136] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:27:08] ❌    ❌ Failed to create patient
[05:27:08] [DOC: 9246136] ℹ️  API push details saved for document 9246136
================================================================================
║                        Processing Document ID: 9246037                         ║
================================================================================
[05:27:08] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:27:08] ℹ️  Date: 04/17/2025
[05:27:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:27:12] [DOC: 9246037] ✅ Text extracted using pdfplumber (33671 chars)
[05:27:12] ✅    ✅ Text extracted using pdfplumber (33563 chars)
[05:27:12] 🔄 
🔄 Step 2: Extracting patient data...
[05:27:15] ℹ️  AI extracted raw sex value: 'F'
[05:27:15] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:27:15] ℹ️  AI extracted payer source: 'Medicare'
[05:27:15] ℹ️  AI extracted diagnoses:
[05:27:15] ℹ️    - Diagnosis 1: 'M80.0AXD'
[05:27:15] ℹ️    - Diagnosis 2: 'I48.91'
[05:27:15] ℹ️    - Diagnosis 3: 'I11.0'
[05:27:15] ℹ️    - Diagnosis 4: 'I50.30'
[05:27:15] ℹ️    - Diagnosis 5: 'I73.9'
[05:27:15] ℹ️    - Diagnosis 6: 'I83.93'
[05:27:15] ℹ️  Final extracted MRN: '28700124296001'
[05:27:15] ℹ️  Final extracted Sex: 'FEMALE'
[05:27:15] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:27:15] ℹ️  Final extracted Payer Source: 'Medicare'
[05:27:15] ✅ Patient data extraction completed successfully
[05:27:15] ✅    ✅ Patient data extracted successfully
[05:27:15] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: VASSALO
     └─ dob: 11/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700124296001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 278 HILLMAN ST APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'M80.0AXD', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.30', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'I83.93'}]
[05:27:15] ✅    ✅ Patient identified: MARIA VASSALO
[05:27:15] ✅    ✅ Patient name validation passed
[05:27:15] 🔄 
🔄 Step 3: Processing patient dates...
[05:27:15] [DOC: 9246037] ℹ️  DOB normalized: 11/26/1940
[05:27:15] [DOC: 9246037] ℹ️  Episode startOfCare normalized: 03/28/2025
[05:27:15] [DOC: 9246037] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[05:27:15] [DOC: 9246037] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[05:27:15] [DOC: 9246037] ✅ Patient date processing completed successfully
[05:27:15] ✅    ✅ Date processing completed
[05:27:15] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: VASSALO
     └─ dob: 11/26/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700124296001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 278 HILLMAN ST APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'M80.0AXD', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.30', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'I83.93'}]
[05:27:15] 🔄 
🔄 Step 4: Extracting order data...
[05:27:18] ℹ️  Order extraction - MRN: '28700124296001'
[05:27:18] ℹ️  Order extraction - Sex: 'FEMALE'
[05:27:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:27:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:27:18] ✅ Order data extraction completed successfully
[05:27:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:27:18] ℹ️  Using MRN from patient data: '28700124296001' over '28700124296001'
[05:27:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:27:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:27:18] ✅ Patient name cross-validation successful
[05:27:18] ✅    ✅ Data merged successfully
[05:27:20] ✅    ✅ Order data extracted and validated
[05:27:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:27:33] [DOC: 9246037] ✅ Patient exists in API: MARIA VASSALO, ID: fd9ff3c2-cda6-48c9-9b38-4a63440c2fd4
[05:27:33] ✅    ✅ Existing patient found with ID: fd9ff3c2-cda6-48c9-9b38-4a63440c2fd4
[05:27:33] 🔄 
🔄 Step 6: Pushing order to API...
[05:27:33] [DOC: 9246037] ℹ️  Pushing order via API for patient ID: fd9ff3c2-cda6-48c9-9b38-4a63440c2fd4
[05:27:35] [DOC: 9246037] ❌ Order push failed with status 201: {"id":"00e3676e-ac5d-4dd9-9855-e0adaa6f3512","orderWAVId":"ORD20021","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 12310974","orderDate":"03/28/2025","startOfCare":"03/28/2025","episodeStartDate":"03/28/2025","episodeEndDate":"05/26/2025","documentID":"9246037","mrn":"28700124296001","patientName":"MARIA VASSALO","sentToPhysicianDate":"04/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/24/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"fd9ff3c2-cda6-48c9-9b38-4a63440c2fd4","companyId":"532ae690-17f2-4fb0-b9ec-e3ef8634f57d","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:27:35] ❌    ❌ Failed to push order
[05:27:35] 🔄 
🔄 Step 7: Writing to CSV...
[05:27:35] [DOC: 9246037] ℹ️  Calculated age: 84 from DOB: 11/26/1940
[05:27:35] [DOC: 9246037] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:27:35] [DOC: 9246037] ℹ️  Payer Source extracted: 'Medicare'
[05:27:35] [DOC: 9246037] ℹ️  Diagnosis codes being written:
[05:27:35] [DOC: 9246037] ℹ️    - Latest_Episode_Firstdiagnosis: 'M80.0AXD'
[05:27:35] [DOC: 9246037] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.91'
[05:27:35] [DOC: 9246037] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[05:27:35] [DOC: 9246037] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.30'
[05:27:35] [DOC: 9246037] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I73.9'
[05:27:35] [DOC: 9246037] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I83.93'
[05:27:35] [DOC: 9246037] ✅ Patient data written to CSV: MARIA VASSALO | Sex: FEMALE | Age: 84 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 28700124296001
[05:27:35] ✅    ✅ Document 9246037 processed and saved successfully
[05:27:35] 🔄 
🔄 Step 8: Saving API details...
[05:27:35] [DOC: 9246037] ℹ️  API push details saved for document 9246037
[05:27:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246104                         ║
================================================================================
[05:27:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:27:35] ℹ️  Date: 04/17/2025
[05:27:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:27:37] [DOC: 9246104] ✅ Text extracted using pdfplumber (3274 chars)
[05:27:37] ✅    ✅ Text extracted using pdfplumber (3274 chars)
[05:27:37] 🔄 
🔄 Step 2: Extracting patient data...
[05:27:39] ℹ️  AI extracted raw sex value: 'F'
[05:27:39] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy'
[05:27:39] ℹ️  AI extracted payer source: ''
[05:27:39] ℹ️  AI extracted diagnoses:
[05:27:39] ℹ️    - Diagnosis 1: ''
[05:27:39] ℹ️    - Diagnosis 2: ''
[05:27:39] ℹ️    - Diagnosis 3: ''
[05:27:39] ℹ️    - Diagnosis 4: ''
[05:27:39] ℹ️    - Diagnosis 5: ''
[05:27:39] ℹ️    - Diagnosis 6: ''
[05:27:39] ℹ️  Final extracted MRN: '2153963'
[05:27:39] ℹ️  Final extracted Sex: 'FEMALE'
[05:27:39] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy'
[05:27:39] ℹ️  Final extracted Payer Source: ''
[05:27:39] ✅ Patient data extraction completed successfully
[05:27:39] ✅    ✅ Patient data extracted successfully
[05:27:39] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: Tapper
     └─ dob: 02/15/1982
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2153963
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:27:39] ✅    ✅ Patient identified: Elizabeth Tapper
[05:27:39] ✅    ✅ Patient name validation passed
[05:27:39] 🔄 
🔄 Step 3: Processing patient dates...
[05:27:39] [DOC: 9246104] ℹ️  DOB normalized: 02/15/1982
[05:27:39] [DOC: 9246104] ✅ Patient date processing completed successfully
[05:27:39] ✅    ✅ Date processing completed
[05:27:39] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: Tapper
     └─ dob: 02/15/1982
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2153963
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:27:39] 🔄 
🔄 Step 4: Extracting order data...
[05:27:42] ℹ️  Order extraction - MRN: '2153963'
[05:27:42] ℹ️  Order extraction - Sex: 'FEMALE'
[05:27:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:27:42] ℹ️  Order extraction - Payer Source: ''
[05:27:42] ✅ Order data extraction completed successfully
[05:27:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:27:42] ℹ️  Using MRN from patient data: '2153963' over '2153963'
[05:27:42] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy' + Order='Skilled Nursing, Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[05:27:42] ✅ Patient name cross-validation successful
[05:27:42] ✅    ✅ Data merged successfully
[05:27:43] ✅    ✅ Order data extracted and validated
[05:27:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:27:56] [DOC: 9246104] ℹ️  Patient not found in cache or API: Elizabeth Tapper
[05:27:56] [DOC: 9246104] ℹ️  Patient not found, creating new patient via API...
[05:27:56] [DOC: 9246104] ℹ️  Creating patient via API: Elizabeth Tapper
[05:27:57] [DOC: 9246104] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:27:57] ❌    ❌ Failed to create patient
[05:27:57] [DOC: 9246104] ℹ️  API push details saved for document 9246104
================================================================================
║                        Processing Document ID: 9246074                         ║
================================================================================
[05:27:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:27:57] ℹ️  Date: 04/17/2025
[05:27:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:27:58] [DOC: 9246074] ✅ Text extracted using pdfplumber (810 chars)
[05:27:58] ✅    ✅ Text extracted using pdfplumber (810 chars)
[05:27:58] 🔄 
🔄 Step 2: Extracting patient data...
[05:28:01] ℹ️  AI extracted raw sex value: 'M'
[05:28:01] ℹ️  AI extracted service line: ''
[05:28:01] ℹ️  AI extracted payer source: ''
[05:28:01] ℹ️  AI extracted diagnoses:
[05:28:01] ℹ️    - Diagnosis 1: ''
[05:28:01] ℹ️    - Diagnosis 2: ''
[05:28:01] ℹ️    - Diagnosis 3: ''
[05:28:01] ℹ️    - Diagnosis 4: ''
[05:28:01] ℹ️    - Diagnosis 5: ''
[05:28:01] ℹ️    - Diagnosis 6: ''
[05:28:01] ℹ️  Final extracted MRN: '2108620'
[05:28:01] ℹ️  Final extracted Sex: 'MALE'
[05:28:01] ℹ️  Final extracted Service Line: ''
[05:28:01] ℹ️  Final extracted Payer Source: ''
[05:28:01] ✅ Patient data extraction completed successfully
[05:28:01] ✅    ✅ Patient data extracted successfully
[05:28:01] 📊 Patient Response
     └─ patientFName: Marc
     └─ patientLName: Warrington
     └─ dob: 08/10/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 2108620
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:28:01] ✅    ✅ Patient identified: Marc Warrington
[05:28:01] ✅    ✅ Patient name validation passed
[05:28:01] 🔄 
🔄 Step 3: Processing patient dates...
[05:28:01] [DOC: 9246074] ℹ️  DOB normalized: 08/10/1962
[05:28:01] [DOC: 9246074] ℹ️  Episode startOfCare normalized: 03/23/2025
[05:28:01] [DOC: 9246074] ✅ Patient date processing completed successfully
[05:28:01] ✅    ✅ Date processing completed
[05:28:01] 📊 Processed Patient Data
     └─ patientFName: Marc
     └─ patientLName: Warrington
     └─ dob: 08/10/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 2108620
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:28:01] 🔄 
🔄 Step 4: Extracting order data...
[05:28:03] ℹ️  Order extraction - MRN: '2108620'
[05:28:03] ℹ️  Order extraction - Sex: 'MALE'
[05:28:03] ℹ️  Order extraction - Service Line: ''
[05:28:03] ℹ️  Order extraction - Payer Source: ''
[05:28:03] ✅ Order data extraction completed successfully
[05:28:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:28:03] ℹ️  Using MRN from patient data: '2108620' over '2108620'
[05:28:03] ✅ Patient name cross-validation successful
[05:28:03] ✅    ✅ Data merged successfully
[05:28:04] ⚠️     ❌ Skipping - missing episode start date
[05:28:04] [DOC: 9246074] ℹ️  API push details saved for document 9246074
================================================================================
║                        Processing Document ID: 9245849                         ║
================================================================================
[05:28:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:28:04] ℹ️  Date: 04/17/2025
[05:28:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:28:07] [DOC: 9245849] ✅ Text extracted using pdfplumber (18816 chars)
[05:28:07] ✅    ✅ Text extracted using pdfplumber (18816 chars)
[05:28:07] 🔄 
🔄 Step 2: Extracting patient data...
[05:28:10] ℹ️  AI extracted raw sex value: 'M'
[05:28:10] ℹ️  AI extracted service line: 'Physical Therapy'
[05:28:10] ℹ️  AI extracted payer source: ''
[05:28:10] ℹ️  AI extracted diagnoses:
[05:28:10] ℹ️    - Diagnosis 1: 'N39.0'
[05:28:10] ℹ️    - Diagnosis 2: 'B96.20'
[05:28:10] ℹ️    - Diagnosis 3: 'M79.89'
[05:28:10] ℹ️    - Diagnosis 4: 'R29.898'
[05:28:10] ℹ️    - Diagnosis 5: 'I10'
[05:28:10] ℹ️    - Diagnosis 6: 'C32.0'
[05:28:10] ℹ️  Final extracted MRN: '3027881'
[05:28:10] ℹ️  Final extracted Sex: 'MALE'
[05:28:10] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:28:10] ℹ️  Final extracted Payer Source: ''
[05:28:10] ✅ Patient data extraction completed successfully
[05:28:10] ✅    ✅ Patient data extracted successfully
[05:28:10] 📊 Patient Response
     └─ patientFName: Francisco
     └─ patientLName: Tavares
     └─ dob: 02/10/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 3027881
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'M79.89', 'fourthDiagnosis': 'R29.898', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'C32.0'}]
[05:28:10] ✅    ✅ Patient identified: Francisco Tavares
[05:28:10] ✅    ✅ Patient name validation passed
[05:28:10] 🔄 
🔄 Step 3: Processing patient dates...
[05:28:10] [DOC: 9245849] ℹ️  DOB normalized: 02/10/1955
[05:28:10] [DOC: 9245849] ℹ️  Episode startOfCare normalized: 04/05/2025
[05:28:10] [DOC: 9245849] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[05:28:10] [DOC: 9245849] ℹ️  Episode endOfEpisode normalized: 06/04/2025
[05:28:10] [DOC: 9245849] ✅ Patient date processing completed successfully
[05:28:10] ✅    ✅ Date processing completed
[05:28:10] 📊 Processed Patient Data
     └─ patientFName: Francisco
     └─ patientLName: Tavares
     └─ dob: 02/10/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 3027881
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'M79.89', 'fourthDiagnosis': 'R29.898', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'C32.0'}]
[05:28:10] 🔄 
🔄 Step 4: Extracting order data...
[05:28:13] ℹ️  Order extraction - MRN: '3027881'
[05:28:13] ℹ️  Order extraction - Sex: 'MALE'
[05:28:13] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:28:13] ℹ️  Order extraction - Payer Source: ''
[05:28:13] ✅ Order data extraction completed successfully
[05:28:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:28:13] ℹ️  Using MRN from patient data: '3027881' over '3027881'
[05:28:13] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:28:13] ✅ Patient name cross-validation successful
[05:28:13] ✅    ✅ Data merged successfully
[05:28:14] ✅    ✅ Order data extracted and validated
[05:28:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:28:20] [DOC: 9245849] ℹ️  Patient not found in cache or API: Francisco Tavares
[05:28:20] [DOC: 9245849] ℹ️  Patient not found, creating new patient via API...
[05:28:20] [DOC: 9245849] ℹ️  Creating patient via API: Francisco Tavares
[05:28:21] [DOC: 9245849] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:28:21] ❌    ❌ Failed to create patient
[05:28:21] [DOC: 9245849] ℹ️  API push details saved for document 9245849
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[05:28:21] ℹ️  Total Processed: 49
[05:28:21] ℹ️  CSV Success: 36
[05:28:21] ℹ️  CSV Errors: 2
[05:28:21] ℹ️  API Success: 0
[05:28:21] ℹ️  API Errors: 47
[05:28:21] ℹ️  CSV Success Rate: 73.5%
[05:28:21] ℹ️  API Success Rate: 0.0%
[05:28:21] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_051317.csv
[05:28:21] ℹ️  API Details File: api_outputs/api_push_details_20250608_051317.csv
================================================================================
║          ============================================================          ║
================================================================================
