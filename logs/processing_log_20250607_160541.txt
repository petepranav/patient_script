================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[16:05:41] ℹ️  CSV Data Extraction & API Push Tool
[16:05:41] ℹ️  
[16:05:41] ℹ️  Features:
[16:05:41] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[16:05:41] ℹ️  - AI-powered patient and order data extraction
[16:05:41] ℹ️  - Enhanced error handling and logging
[16:05:41] ℹ️  - Full API integration (patient creation + order pushing)
[16:05:41] ℹ️  - CSV output with comprehensive patient data
[16:05:41] ℹ️  - Detailed API tracking with remarks for every document
[16:05:41] ℹ️  - Complete audit trail of all processing attempts
[16:05:41] ℹ️  
[16:05:41] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[16:05:41] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_160541.csv
[16:05:41] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_160541.csv
================================================================================
║                        Processing Document ID: 9266164                         ║
================================================================================
[16:05:41] ℹ️  Agency: Dartmouth HH
[16:05:41] ℹ️  Date: 04/29/2025
[16:05:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:05:45] [DOC: 9266164] ✅ Text extracted using pdfplumber (13880 chars)
[16:05:45] ✅    ✅ Text extracted using pdfplumber (13868 chars)
[16:05:45] 🔄 
🔄 Step 2: Extracting patient data...
[16:05:49] ℹ️  AI extracted raw sex value: 'F'
[16:05:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:05:49] ℹ️  AI extracted payer source: ''
[16:05:49] ℹ️  AI extracted diagnoses:
[16:05:49] ℹ️    - Diagnosis 1: 'K83.09'
[16:05:49] ℹ️    - Diagnosis 2: 'K85.90'
[16:05:49] ℹ️    - Diagnosis 3: 'A09'
[16:05:49] ℹ️    - Diagnosis 4: 'C25.0'
[16:05:49] ℹ️    - Diagnosis 5: 'E11.65'
[16:05:49] ℹ️    - Diagnosis 6: 'D63.0'
[16:05:49] ℹ️  Final extracted MRN: '2429011'
[16:05:49] ℹ️  Final extracted Sex: 'FEMALE'
[16:05:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:05:49] ℹ️  Final extracted Payer Source: ''
[16:05:49] ✅ Patient data extraction completed successfully
[16:05:49] ✅    ✅ Patient data extracted successfully
[16:05:49] 📊 Patient Response
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2024', 'startOfEpisode': '11/04/2024', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'K83.09', 'secondDiagnosis': 'K85.90', 'thirdDiagnosis': 'A09', 'fourthDiagnosis': 'C25.0', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'D63.0'}]
[16:05:49] ✅    ✅ Patient identified: Eduarda Demello
[16:05:49] ✅    ✅ Patient name validation passed
[16:05:49] 🔄 
🔄 Step 3: Processing patient dates...
[16:05:49] [DOC: 9266164] ℹ️  DOB normalized: 09/29/1942
[16:05:49] [DOC: 9266164] ℹ️  Episode startOfCare normalized: 11/03/2024
[16:05:49] [DOC: 9266164] ℹ️  Episode startOfEpisode normalized: 11/04/2024
[16:05:49] [DOC: 9266164] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[16:05:49] [DOC: 9266164] ✅ Patient date processing completed successfully
[16:05:49] ✅    ✅ Date processing completed
[16:05:49] 📊 Processed Patient Data
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/03/2024', 'startOfEpisode': '11/04/2024', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'K83.09', 'secondDiagnosis': 'K85.90', 'thirdDiagnosis': 'A09', 'fourthDiagnosis': 'C25.0', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'D63.0'}]
[16:05:49] 🔄 
🔄 Step 4: Extracting order data...
[16:05:51] ℹ️  Order extraction - MRN: '2429011'
[16:05:51] ℹ️  Order extraction - Sex: 'FEMALE'
[16:05:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:05:51] ℹ️  Order extraction - Payer Source: ''
[16:05:51] ✅ Order data extraction completed successfully
[16:05:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:05:51] ℹ️  Using MRN from patient data: '2429011' over '2429011'
[16:05:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:05:51] ✅ Patient name cross-validation successful
[16:05:51] ✅    ✅ Data merged successfully
[16:05:52] ✅    ✅ Order data extracted and validated
[16:05:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:05:52] [DOC: 9266164] ✅ Patient found in local cache: Eduarda Demello, ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[16:05:52] ✅    ✅ Existing patient found with ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[16:05:52] 🔄 
🔄 Step 6: Pushing order to API...
[16:05:52] [DOC: 9266164] ℹ️  Pushing order via API for patient ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[16:05:54] [DOC: 9266164] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:05:54] ❌    ❌ Failed to push order
[16:05:54] 🔄 
🔄 Step 7: Writing to CSV...
[16:05:54] [DOC: 9266164] ℹ️  Calculated age: 82 from DOB: 09/29/1942
[16:05:54] [DOC: 9266164] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:05:54] [DOC: 9266164] ℹ️  Payer Source extracted: ''
[16:05:54] [DOC: 9266164] ℹ️  Diagnosis codes being written:
[16:05:54] [DOC: 9266164] ℹ️    - Latest_Episode_Firstdiagnosis: 'K83.09'
[16:05:54] [DOC: 9266164] ℹ️    - Latest_Episode_Seconddiagnosis: 'K85.90'
[16:05:54] [DOC: 9266164] ℹ️    - Latest_Episode_Thirddiagnosis: 'A09'
[16:05:54] [DOC: 9266164] ℹ️    - Latest_Episode_Fourthdiagnosis: 'C25.0'
[16:05:54] [DOC: 9266164] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.65'
[16:05:54] [DOC: 9266164] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D63.0'
[16:05:54] [DOC: 9266164] ✅ Patient data written to CSV: Eduarda Demello | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 2429011
[16:05:54] ✅    ✅ Document 9266164 processed and saved successfully
[16:05:54] 🔄 
🔄 Step 8: Saving API details...
[16:05:54] [DOC: 9266164] ℹ️  API push details saved for document 9266164
[16:05:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266159                         ║
================================================================================
[16:05:54] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:05:54] ℹ️  Date: 04/29/2025
[16:05:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:05:57] [DOC: 9266159] ✅ Text extracted using pdfplumber (12382 chars)
[16:05:57] ✅    ✅ Text extracted using pdfplumber (12382 chars)
[16:05:57] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:00] ℹ️  AI extracted raw sex value: 'M'
[16:06:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:06:00] ℹ️  AI extracted payer source: ''
[16:06:00] ℹ️  AI extracted diagnoses:
[16:06:00] ℹ️    - Diagnosis 1: 'F32.A'
[16:06:00] ℹ️    - Diagnosis 2: 'I48.0'
[16:06:00] ℹ️    - Diagnosis 3: 'I13.0'
[16:06:00] ℹ️    - Diagnosis 4: 'I50.42'
[16:06:00] ℹ️    - Diagnosis 5: 'N18.31'
[16:06:00] ℹ️    - Diagnosis 6: 'I35.8'
[16:06:00] ℹ️  Final extracted MRN: '114004'
[16:06:00] ℹ️  Final extracted Sex: 'MALE'
[16:06:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:06:00] ℹ️  Final extracted Payer Source: ''
[16:06:00] ✅ Patient data extraction completed successfully
[16:06:00] ✅    ✅ Patient data extracted successfully
[16:06:00] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100011906383
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': '12/01/2018', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.42', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'I35.8'}]
[16:06:00] ✅    ✅ Patient identified: Donald Brown
[16:06:00] ✅    ✅ Patient name validation passed
[16:06:00] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:00] [DOC: 9266159] ℹ️  DOB normalized: 06/18/1949
[16:06:00] [DOC: 9266159] ℹ️  Episode startOfCare normalized: 12/01/2018
[16:06:00] [DOC: 9266159] ℹ️  Episode startOfEpisode normalized: 12/01/2018
[16:06:00] [DOC: 9266159] ℹ️  Episode endOfEpisode normalized: 06/26/2025
[16:06:00] [DOC: 9266159] ✅ Patient date processing completed successfully
[16:06:00] ✅    ✅ Date processing completed
[16:06:00] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100011906383
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': '12/01/2018', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'I48.0', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.42', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'I35.8'}]
[16:06:00] 🔄 
🔄 Step 4: Extracting order data...
[16:06:03] ℹ️  Order extraction - MRN: '114004'
[16:06:03] ℹ️  Order extraction - Sex: 'MALE'
[16:06:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:06:03] ℹ️  Order extraction - Payer Source: ''
[16:06:03] ✅ Order data extraction completed successfully
[16:06:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:06:03] ℹ️  Using MRN from patient data: '114004' over '114004'
[16:06:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:06:03] ✅ Patient name cross-validation successful
[16:06:03] ✅    ✅ Data merged successfully
[16:06:05] ✅    ✅ Order data extracted and validated
[16:06:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:06:18] [DOC: 9266159] ✅ Patient exists in API: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[16:06:18] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[16:06:18] 🔄 
🔄 Step 6: Pushing order to API...
[16:06:18] [DOC: 9266159] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[16:06:20] [DOC: 9266159] ❌ Order push failed with status 201: {"id":"08b50e69-4396-49b8-95f2-b38f9f7948a5","orderWAVId":"ORD19958","orderNo":"114004","orderDate":"04/25/2025","startOfCare":"12/01/2018","episodeStartDate":"12/01/2018","episodeEndDate":"06/26/2025","documentID":"9266159","mrn":"114004","patientName":"Brown, Donald R","sentToPhysicianDate":"04/29/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/30/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"475b933b-2f10-4471-a1da-b798c6232ab6","companyId":"0f46ebbe-720c-4abb-8809-892864387620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[16:06:20] ❌    ❌ Failed to push order
[16:06:20] 🔄 
🔄 Step 7: Writing to CSV...
[16:06:20] [DOC: 9266159] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[16:06:20] [DOC: 9266159] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:06:20] [DOC: 9266159] ℹ️  Payer Source extracted: ''
[16:06:20] [DOC: 9266159] ℹ️  Diagnosis codes being written:
[16:06:20] [DOC: 9266159] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.A'
[16:06:20] [DOC: 9266159] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.0'
[16:06:20] [DOC: 9266159] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[16:06:20] [DOC: 9266159] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.42'
[16:06:20] [DOC: 9266159] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.31'
[16:06:20] [DOC: 9266159] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I35.8'
[16:06:20] [DOC: 9266159] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: Skilled Nursing | Payer:  | MRN: 114004
[16:06:20] ✅    ✅ Document 9266159 processed and saved successfully
[16:06:20] 🔄 
🔄 Step 8: Saving API details...
[16:06:20] [DOC: 9266159] ℹ️  API push details saved for document 9266159
[16:06:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266143                         ║
================================================================================
[16:06:20] ℹ️  Agency: Nizhoni Health-Stoughton
[16:06:20] ℹ️  Date: 04/29/2025
[16:06:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:06:24] [DOC: 9266143] ✅ Text extracted using pdfplumber (14281 chars)
[16:06:24] ✅    ✅ Text extracted using pdfplumber (14281 chars)
[16:06:24] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:27] ℹ️  AI extracted raw sex value: 'M'
[16:06:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:06:27] ℹ️  AI extracted payer source: ''
[16:06:27] ℹ️  AI extracted diagnoses:
[16:06:27] ℹ️    - Diagnosis 1: 'E11.9'
[16:06:27] ℹ️    - Diagnosis 2: 'F20.0'
[16:06:27] ℹ️    - Diagnosis 3: 'F31.9'
[16:06:27] ℹ️    - Diagnosis 4: 'K86.1'
[16:06:27] ℹ️    - Diagnosis 5: 'K80.80'
[16:06:27] ℹ️    - Diagnosis 6: 'J44.9'
[16:06:27] ℹ️  Final extracted MRN: '1664020'
[16:06:27] ℹ️  Final extracted Sex: 'MALE'
[16:06:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:06:27] ℹ️  Final extracted Payer Source: ''
[16:06:27] ✅ Patient data extraction completed successfully
[16:06:27] ✅    ✅ Patient data extracted successfully
[16:06:27] 📊 Patient Response
     └─ patientFName: Shaun
     └─ patientLName: Rivers
     └─ dob: 07/25/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 1664020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/18/2022', 'startOfEpisode': '10/19/2022', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'F20.0', 'thirdDiagnosis': 'F31.9', 'fourthDiagnosis': 'K86.1', 'fifthDiagnosis': 'K80.80', 'sixthDiagnosis': 'J44.9'}]
[16:06:27] ✅    ✅ Patient identified: Shaun Rivers
[16:06:27] ✅    ✅ Patient name validation passed
[16:06:27] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:27] [DOC: 9266143] ℹ️  DOB normalized: 07/25/1962
[16:06:27] [DOC: 9266143] ℹ️  Episode startOfCare normalized: 10/18/2022
[16:06:27] [DOC: 9266143] ℹ️  Episode startOfEpisode normalized: 10/19/2022
[16:06:27] [DOC: 9266143] ℹ️  Episode endOfEpisode normalized: 06/04/2025
[16:06:27] [DOC: 9266143] ✅ Patient date processing completed successfully
[16:06:27] ✅    ✅ Date processing completed
[16:06:27] 📊 Processed Patient Data
     └─ patientFName: Shaun
     └─ patientLName: Rivers
     └─ dob: 07/25/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 1664020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/18/2022', 'startOfEpisode': '10/19/2022', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'F20.0', 'thirdDiagnosis': 'F31.9', 'fourthDiagnosis': 'K86.1', 'fifthDiagnosis': 'K80.80', 'sixthDiagnosis': 'J44.9'}]
[16:06:27] 🔄 
🔄 Step 4: Extracting order data...
[16:06:29] ℹ️  Order extraction - MRN: '1664020'
[16:06:29] ℹ️  Order extraction - Sex: 'MALE'
[16:06:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:06:29] ℹ️  Order extraction - Payer Source: ''
[16:06:29] ✅ Order data extraction completed successfully
[16:06:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:06:29] ℹ️  Using MRN from patient data: '1664020' over '1664020'
[16:06:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:06:29] ✅ Patient name cross-validation successful
[16:06:29] ✅    ✅ Data merged successfully
[16:06:31] ✅    ✅ Order data extracted and validated
[16:06:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:06:36] [DOC: 9266143] ℹ️  Patient not found in cache or API: Shaun Rivers
[16:06:36] [DOC: 9266143] ℹ️  Patient not found, creating new patient via API...
[16:06:36] [DOC: 9266143] ℹ️  Creating patient via API: Shaun Rivers
[16:06:37] [DOC: 9266143] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:06:37] ❌    ❌ Failed to create patient
[16:06:37] [DOC: 9266143] ℹ️  API push details saved for document 9266143
================================================================================
║                        Processing Document ID: 9266132                         ║
================================================================================
[16:06:37] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[16:06:37] ℹ️  Date: 04/29/2025
[16:06:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:06:39] [DOC: 9266132] ✅ Text extracted using pdfplumber (9408 chars)
[16:06:39] ✅    ✅ Text extracted using pdfplumber (9408 chars)
[16:06:39] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:42] ℹ️  AI extracted raw sex value: 'F'
[16:06:42] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[16:06:42] ℹ️  AI extracted payer source: 'None'
[16:06:42] ℹ️  AI extracted diagnoses:
[16:06:42] ℹ️    - Diagnosis 1: 'F25.0'
[16:06:42] ℹ️    - Diagnosis 2: 'F41.9'
[16:06:42] ℹ️    - Diagnosis 3: 'F43.10'
[16:06:42] ℹ️    - Diagnosis 4: 'I65.21'
[16:06:42] ℹ️    - Diagnosis 5: 'T82.855D'
[16:06:42] ℹ️    - Diagnosis 6: 'G21.11'
[16:06:42] ℹ️  Final extracted MRN: '658'
[16:06:42] ℹ️  Final extracted Sex: 'FEMALE'
[16:06:42] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[16:06:42] ℹ️  Final extracted Payer Source: ''
[16:06:42] ✅ Patient data extraction completed successfully
[16:06:42] ✅    ✅ Patient data extracted successfully
[16:06:42] 📊 Patient Response
     └─ patientFName: Deborah
     └─ patientLName: Raposo
     └─ dob: 03/15/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 658
     └─ billingProvider: Guardian Home Health Care, ACPLLC
     └─ npi: 1730593195
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACPLLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/13/2022', 'startOfEpisode': '09/13/2022', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'I65.21', 'fifthDiagnosis': 'T82.855D', 'sixthDiagnosis': 'G21.11'}]
[16:06:42] ✅    ✅ Patient identified: Deborah Raposo
[16:06:42] ✅    ✅ Patient name validation passed
[16:06:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:42] [DOC: 9266132] ℹ️  DOB normalized: 03/15/1958
[16:06:42] [DOC: 9266132] ℹ️  Episode startOfCare normalized: 09/13/2022
[16:06:42] [DOC: 9266132] ℹ️  Episode startOfEpisode normalized: 09/13/2022
[16:06:42] [DOC: 9266132] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[16:06:42] [DOC: 9266132] ✅ Patient date processing completed successfully
[16:06:42] ✅    ✅ Date processing completed
[16:06:42] 📊 Processed Patient Data
     └─ patientFName: Deborah
     └─ patientLName: Raposo
     └─ dob: 03/15/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 658
     └─ billingProvider: Guardian Home Health Care, ACPLLC
     └─ npi: 1730593195
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACPLLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/13/2022', 'startOfEpisode': '09/13/2022', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'I65.21', 'fifthDiagnosis': 'T82.855D', 'sixthDiagnosis': 'G21.11'}]
[16:06:42] 🔄 
🔄 Step 4: Extracting order data...
[16:06:45] ℹ️  Order extraction - MRN: '658'
[16:06:45] ℹ️  Order extraction - Sex: 'FEMALE'
[16:06:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[16:06:45] ℹ️  Order extraction - Payer Source: ''
[16:06:45] ✅ Order data extraction completed successfully
[16:06:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:06:45] ℹ️  Using MRN from patient data: '658' over '658'
[16:06:45] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[16:06:45] ✅ Patient name cross-validation successful
[16:06:45] ✅    ✅ Data merged successfully
[16:06:46] ✅    ✅ Order data extracted and validated
[16:06:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:06:52] [DOC: 9266132] ✅ Patient exists in API: Deborah Raposo, ID: bd24d6c5-fe2e-4fd6-8f90-dc2b009f2ba3
[16:06:52] ✅    ✅ Existing patient found with ID: bd24d6c5-fe2e-4fd6-8f90-dc2b009f2ba3
[16:06:52] 🔄 
🔄 Step 6: Pushing order to API...
[16:06:52] [DOC: 9266132] ℹ️  Pushing order via API for patient ID: bd24d6c5-fe2e-4fd6-8f90-dc2b009f2ba3
[16:06:53] [DOC: 9266132] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:06:53] ❌    ❌ Failed to push order
[16:06:53] 🔄 
🔄 Step 7: Writing to CSV...
[16:06:53] [DOC: 9266132] ℹ️  Calculated age: 67 from DOB: 03/15/1958
[16:06:53] [DOC: 9266132] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[16:06:53] [DOC: 9266132] ℹ️  Payer Source extracted: ''
[16:06:53] [DOC: 9266132] ℹ️  Diagnosis codes being written:
[16:06:53] [DOC: 9266132] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[16:06:53] [DOC: 9266132] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[16:06:53] [DOC: 9266132] ℹ️    - Latest_Episode_Thirddiagnosis: 'F43.10'
[16:06:53] [DOC: 9266132] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I65.21'
[16:06:53] [DOC: 9266132] ℹ️    - Latest_Episode_Fifthdiagnosis: 'T82.855D'
[16:06:53] [DOC: 9266132] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G21.11'
[16:06:53] [DOC: 9266132] ✅ Patient data written to CSV: Deborah Raposo | Sex: FEMALE | Age: 67 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 658
[16:06:53] ✅    ✅ Document 9266132 processed and saved successfully
[16:06:53] 🔄 
🔄 Step 8: Saving API details...
[16:06:53] [DOC: 9266132] ℹ️  API push details saved for document 9266132
[16:06:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265954                         ║
================================================================================
[16:06:53] ℹ️  Agency: Dartmouth HH
[16:06:53] ℹ️  Date: 04/29/2025
[16:06:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:06:55] [DOC: 9265954] ✅ Text extracted using pdfplumber (1352 chars)
[16:06:55] ✅    ✅ Text extracted using pdfplumber (1352 chars)
[16:06:55] 🔄 
🔄 Step 2: Extracting patient data...
[16:06:58] ℹ️  AI extracted raw sex value: 'M'
[16:06:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:06:58] ℹ️  AI extracted payer source: 'Medicare'
[16:06:58] ℹ️  AI extracted diagnoses:
[16:06:58] ℹ️    - Diagnosis 1: ''
[16:06:58] ℹ️    - Diagnosis 2: ''
[16:06:58] ℹ️    - Diagnosis 3: ''
[16:06:58] ℹ️    - Diagnosis 4: ''
[16:06:58] ℹ️    - Diagnosis 5: ''
[16:06:58] ℹ️    - Diagnosis 6: ''
[16:06:58] ℹ️  Final extracted MRN: '3745015'
[16:06:58] ℹ️  Final extracted Sex: 'MALE'
[16:06:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:06:58] ℹ️  Final extracted Payer Source: 'Medicare'
[16:06:58] ✅ Patient data extraction completed successfully
[16:06:58] ✅    ✅ Patient data extracted successfully
[16:06:58] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:06:58] ✅    ✅ Patient identified: Stanley Waters
[16:06:58] ✅    ✅ Patient name validation passed
[16:06:58] 🔄 
🔄 Step 3: Processing patient dates...
[16:06:58] [DOC: 9265954] ℹ️  DOB normalized: 08/19/1941
[16:06:58] [DOC: 9265954] ℹ️  Episode startOfCare normalized: 03/13/2025
[16:06:58] [DOC: 9265954] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:06:58] [DOC: 9265954] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:06:58] [DOC: 9265954] ✅ Patient date processing completed successfully
[16:06:58] ✅    ✅ Date processing completed
[16:06:58] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:06:58] 🔄 
🔄 Step 4: Extracting order data...
[16:07:00] ℹ️  Order extraction - MRN: '3745015'
[16:07:00] ℹ️  Order extraction - Sex: 'MALE'
[16:07:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:07:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:07:00] ✅ Order data extraction completed successfully
[16:07:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:07:00] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[16:07:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:07:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:07:00] ✅ Patient name cross-validation successful
[16:07:00] ✅    ✅ Data merged successfully
[16:07:01] ✅    ✅ Order data extracted and validated
[16:07:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:01] [DOC: 9265954] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[16:07:01] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[16:07:01] 🔄 
🔄 Step 6: Pushing order to API...
[16:07:01] [DOC: 9265954] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[16:07:02] [DOC: 9265954] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:07:02] ❌    ❌ Failed to push order
[16:07:02] 🔄 
🔄 Step 7: Writing to CSV...
[16:07:02] [DOC: 9265954] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[16:07:02] [DOC: 9265954] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:07:02] [DOC: 9265954] ℹ️  Payer Source extracted: 'Medicare'
[16:07:02] [DOC: 9265954] ℹ️  Diagnosis codes being written:
[16:07:02] [DOC: 9265954] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:07:02] [DOC: 9265954] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:07:02] [DOC: 9265954] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:07:02] [DOC: 9265954] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:07:02] [DOC: 9265954] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:07:02] [DOC: 9265954] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:07:02] [DOC: 9265954] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 3745015
[16:07:02] ✅    ✅ Document 9265954 processed and saved successfully
[16:07:02] 🔄 
🔄 Step 8: Saving API details...
[16:07:02] [DOC: 9265954] ℹ️  API push details saved for document 9265954
[16:07:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265952                         ║
================================================================================
[16:07:02] ℹ️  Agency: Dartmouth HH
[16:07:02] ℹ️  Date: 04/29/2025
[16:07:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:04] [DOC: 9265952] ✅ Text extracted using pdfplumber (2183 chars)
[16:07:04] ✅    ✅ Text extracted using pdfplumber (2183 chars)
[16:07:04] 🔄 
🔄 Step 2: Extracting patient data...
[16:07:07] ℹ️  AI extracted raw sex value: 'F'
[16:07:07] ℹ️  AI extracted service line: 'Skilled Nursing, Speech Therapy'
[16:07:07] ℹ️  AI extracted payer source: 'Medicare'
[16:07:07] ℹ️  AI extracted diagnoses:
[16:07:07] ℹ️    - Diagnosis 1: ''
[16:07:07] ℹ️    - Diagnosis 2: ''
[16:07:07] ℹ️    - Diagnosis 3: ''
[16:07:07] ℹ️    - Diagnosis 4: ''
[16:07:07] ℹ️    - Diagnosis 5: ''
[16:07:07] ℹ️    - Diagnosis 6: ''
[16:07:07] ℹ️  Final extracted MRN: '1013011'
[16:07:07] ℹ️  Final extracted Sex: 'FEMALE'
[16:07:07] ℹ️  Final extracted Service Line: 'Skilled Nursing, Speech Therapy'
[16:07:07] ℹ️  Final extracted Payer Source: 'Medicare'
[16:07:07] ✅ Patient data extraction completed successfully
[16:07:07] ✅    ✅ Patient data extracted successfully
[16:07:07] 📊 Patient Response
     └─ patientFName: Bernice
     └─ patientLName: Russo
     └─ dob: 03/02/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1013011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:07] ✅    ✅ Patient identified: Bernice Russo
[16:07:07] ✅    ✅ Patient name validation passed
[16:07:07] 🔄 
🔄 Step 3: Processing patient dates...
[16:07:07] [DOC: 9265952] ℹ️  DOB normalized: 03/02/1932
[16:07:07] [DOC: 9265952] ℹ️  Episode startOfCare normalized: 04/11/2025
[16:07:07] [DOC: 9265952] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[16:07:07] [DOC: 9265952] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[16:07:07] [DOC: 9265952] ✅ Patient date processing completed successfully
[16:07:07] ✅    ✅ Date processing completed
[16:07:07] 📊 Processed Patient Data
     └─ patientFName: Bernice
     └─ patientLName: Russo
     └─ dob: 03/02/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1013011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:07] 🔄 
🔄 Step 4: Extracting order data...
[16:07:09] ℹ️  Order extraction - MRN: ''
[16:07:09] ℹ️  Order extraction - Sex: 'FEMALE'
[16:07:09] ℹ️  Order extraction - Service Line: 'RN, ST'
[16:07:09] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:07:09] ✅ Order data extraction completed successfully
[16:07:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:07:09] ℹ️  Using MRN from patient data: '1013011'
[16:07:09] ℹ️  Combined service lines: Patient='Skilled Nursing, Speech Therapy' + Order='RN, ST' = 'RN, ST, Skilled Nursing, Speech Therapy'
[16:07:09] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:07:09] ✅ Patient name cross-validation successful
[16:07:09] ✅    ✅ Data merged successfully
[16:07:11] ✅    ✅ Order data extracted and validated
[16:07:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:16] [DOC: 9265952] ✅ Patient exists in API: Bernice Russo, ID: 7c4f54da-25b8-482f-b3e4-69506cedc17b
[16:07:16] ✅    ✅ Existing patient found with ID: 7c4f54da-25b8-482f-b3e4-69506cedc17b
[16:07:16] 🔄 
🔄 Step 6: Pushing order to API...
[16:07:16] [DOC: 9265952] ℹ️  Pushing order via API for patient ID: 7c4f54da-25b8-482f-b3e4-69506cedc17b
[16:07:17] [DOC: 9265952] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14284"}
[16:07:17] ❌    ❌ Failed to push order
[16:07:17] 🔄 
🔄 Step 7: Writing to CSV...
[16:07:17] [DOC: 9265952] ℹ️  Calculated age: 93 from DOB: 03/02/1932
[16:07:17] [DOC: 9265952] ℹ️  Service Line extracted: 'RN, ST, Skilled Nursing, Speech Therapy'
[16:07:17] [DOC: 9265952] ℹ️  Payer Source extracted: 'Medicare'
[16:07:17] [DOC: 9265952] ℹ️  Diagnosis codes being written:
[16:07:17] [DOC: 9265952] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:07:17] [DOC: 9265952] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:07:17] [DOC: 9265952] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:07:17] [DOC: 9265952] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:07:17] [DOC: 9265952] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:07:17] [DOC: 9265952] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:07:17] [DOC: 9265952] ✅ Patient data written to CSV: Bernice Russo | Sex: FEMALE | Age: 93 | Service: RN, ST, Skilled Nursing, Speech Therapy | Payer: Medicare | MRN: 1013011
[16:07:17] ✅    ✅ Document 9265952 processed and saved successfully
[16:07:17] 🔄 
🔄 Step 8: Saving API details...
[16:07:17] [DOC: 9265952] ℹ️  API push details saved for document 9265952
[16:07:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265948                         ║
================================================================================
[16:07:17] ℹ️  Agency: Dartmouth HH
[16:07:17] ℹ️  Date: 04/29/2025
[16:07:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:19] [DOC: 9265948] ✅ Text extracted using pdfplumber (1264 chars)
[16:07:19] ✅    ✅ Text extracted using pdfplumber (1264 chars)
[16:07:19] 🔄 
🔄 Step 2: Extracting patient data...
[16:07:22] ℹ️  AI extracted raw sex value: 'M'
[16:07:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:07:22] ℹ️  AI extracted payer source: 'Medicare'
[16:07:22] ℹ️  AI extracted diagnoses:
[16:07:22] ℹ️    - Diagnosis 1: ''
[16:07:22] ℹ️    - Diagnosis 2: ''
[16:07:22] ℹ️    - Diagnosis 3: ''
[16:07:22] ℹ️    - Diagnosis 4: ''
[16:07:22] ℹ️    - Diagnosis 5: ''
[16:07:22] ℹ️    - Diagnosis 6: ''
[16:07:22] ℹ️  Final extracted MRN: '6396009'
[16:07:22] ℹ️  Final extracted Sex: 'MALE'
[16:07:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:07:22] ℹ️  Final extracted Payer Source: 'Medicare'
[16:07:22] ✅ Patient data extraction completed successfully
[16:07:22] ✅    ✅ Patient data extracted successfully
[16:07:22] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:22] ✅    ✅ Patient identified: Frank Edwards
[16:07:22] ✅    ✅ Patient name validation passed
[16:07:22] 🔄 
🔄 Step 3: Processing patient dates...
[16:07:22] [DOC: 9265948] ℹ️  DOB normalized: 04/08/1942
[16:07:22] [DOC: 9265948] ℹ️  Episode startOfCare normalized: 03/13/2025
[16:07:22] [DOC: 9265948] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:07:22] [DOC: 9265948] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:07:22] [DOC: 9265948] ✅ Patient date processing completed successfully
[16:07:22] ✅    ✅ Date processing completed
[16:07:22] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:22] 🔄 
🔄 Step 4: Extracting order data...
[16:07:24] ℹ️  Order extraction - MRN: ''
[16:07:24] ℹ️  Order extraction - Sex: 'MALE'
[16:07:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:07:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:07:24] ✅ Order data extraction completed successfully
[16:07:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:07:24] ℹ️  Using MRN from patient data: '6396009'
[16:07:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:07:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:07:24] ✅ Patient name cross-validation successful
[16:07:24] ✅    ✅ Data merged successfully
[16:07:25] ✅    ✅ Order data extracted and validated
[16:07:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:31] [DOC: 9265948] ✅ Patient exists in API: Frank Edwards, ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[16:07:31] ✅    ✅ Existing patient found with ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[16:07:31] 🔄 
🔄 Step 6: Pushing order to API...
[16:07:31] [DOC: 9265948] ℹ️  Pushing order via API for patient ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[16:07:32] [DOC: 9265948] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13905"}
[16:07:32] ❌    ❌ Failed to push order
[16:07:32] 🔄 
🔄 Step 7: Writing to CSV...
[16:07:32] [DOC: 9265948] ℹ️  Calculated age: 83 from DOB: 04/08/1942
[16:07:32] [DOC: 9265948] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:07:32] [DOC: 9265948] ℹ️  Payer Source extracted: 'Medicare'
[16:07:32] [DOC: 9265948] ℹ️  Diagnosis codes being written:
[16:07:32] [DOC: 9265948] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:07:32] [DOC: 9265948] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:07:32] [DOC: 9265948] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:07:32] [DOC: 9265948] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:07:32] [DOC: 9265948] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:07:32] [DOC: 9265948] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:07:32] [DOC: 9265948] ✅ Patient data written to CSV: Frank Edwards | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 6396009
[16:07:32] ✅    ✅ Document 9265948 processed and saved successfully
[16:07:32] 🔄 
🔄 Step 8: Saving API details...
[16:07:32] [DOC: 9265948] ℹ️  API push details saved for document 9265948
[16:07:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265947                         ║
================================================================================
[16:07:32] ℹ️  Agency: Dartmouth HH
[16:07:32] ℹ️  Date: 04/29/2025
[16:07:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:34] [DOC: 9265947] ✅ Text extracted using pdfplumber (2063 chars)
[16:07:34] ✅    ✅ Text extracted using pdfplumber (2063 chars)
[16:07:34] 🔄 
🔄 Step 2: Extracting patient data...
[16:07:37] ℹ️  AI extracted raw sex value: 'F'
[16:07:37] ℹ️  AI extracted service line: 'PT'
[16:07:37] ℹ️  AI extracted payer source: 'Medicare'
[16:07:37] ℹ️  AI extracted diagnoses:
[16:07:37] ℹ️    - Diagnosis 1: ''
[16:07:37] ℹ️    - Diagnosis 2: ''
[16:07:37] ℹ️    - Diagnosis 3: ''
[16:07:37] ℹ️    - Diagnosis 4: ''
[16:07:37] ℹ️    - Diagnosis 5: ''
[16:07:37] ℹ️    - Diagnosis 6: ''
[16:07:37] ℹ️  Final extracted MRN: '6112015'
[16:07:37] ℹ️  Final extracted Sex: 'FEMALE'
[16:07:37] ℹ️  Final extracted Service Line: 'PT'
[16:07:37] ℹ️  Final extracted Payer Source: 'Medicare'
[16:07:37] ✅ Patient data extraction completed successfully
[16:07:37] ✅    ✅ Patient data extracted successfully
[16:07:37] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Schoen
     └─ dob: 12/14/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6112015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:37] ✅    ✅ Patient identified: Beverly Schoen
[16:07:37] ✅    ✅ Patient name validation passed
[16:07:37] 🔄 
🔄 Step 3: Processing patient dates...
[16:07:37] [DOC: 9265947] ℹ️  DOB normalized: 12/14/1946
[16:07:37] [DOC: 9265947] ℹ️  Episode startOfCare normalized: 03/27/2025
[16:07:37] [DOC: 9265947] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[16:07:37] [DOC: 9265947] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[16:07:37] [DOC: 9265947] ✅ Patient date processing completed successfully
[16:07:37] ✅    ✅ Date processing completed
[16:07:37] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Schoen
     └─ dob: 12/14/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6112015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:07:37] 🔄 
🔄 Step 4: Extracting order data...
[16:07:40] ℹ️  Order extraction - MRN: ''
[16:07:40] ℹ️  Order extraction - Sex: 'FEMALE'
[16:07:40] ℹ️  Order extraction - Service Line: 'PT'
[16:07:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:07:40] ✅ Order data extraction completed successfully
[16:07:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:07:40] ℹ️  Using MRN from patient data: '6112015'
[16:07:40] ℹ️  Service line consistent in both sources: 'PT'
[16:07:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:07:40] ✅ Patient name cross-validation successful
[16:07:40] ✅    ✅ Data merged successfully
[16:07:41] ✅    ✅ Order data extracted and validated
[16:07:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:07:51] [DOC: 9265947] ✅ Patient exists in API: Beverly Schoen, ID: d8ab59f6-e53d-4690-a132-0c8e7e1fae17
[16:07:51] ✅    ✅ Existing patient found with ID: d8ab59f6-e53d-4690-a132-0c8e7e1fae17
[16:07:51] 🔄 
🔄 Step 6: Pushing order to API...
[16:07:51] [DOC: 9265947] ℹ️  Pushing order via API for patient ID: d8ab59f6-e53d-4690-a132-0c8e7e1fae17
[16:07:53] [DOC: 9265947] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14402"}
[16:07:53] ❌    ❌ Failed to push order
[16:07:53] 🔄 
🔄 Step 7: Writing to CSV...
[16:07:53] [DOC: 9265947] ℹ️  Calculated age: 78 from DOB: 12/14/1946
[16:07:53] [DOC: 9265947] ℹ️  Service Line extracted: 'PT'
[16:07:53] [DOC: 9265947] ℹ️  Payer Source extracted: 'Medicare'
[16:07:53] [DOC: 9265947] ℹ️  Diagnosis codes being written:
[16:07:53] [DOC: 9265947] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:07:53] [DOC: 9265947] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:07:53] [DOC: 9265947] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:07:53] [DOC: 9265947] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:07:53] [DOC: 9265947] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:07:53] [DOC: 9265947] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:07:53] [DOC: 9265947] ✅ Patient data written to CSV: Beverly Schoen | Sex: FEMALE | Age: 78 | Service: PT | Payer: Medicare | MRN: 6112015
[16:07:53] ✅    ✅ Document 9265947 processed and saved successfully
[16:07:53] 🔄 
🔄 Step 8: Saving API details...
[16:07:53] [DOC: 9265947] ℹ️  API push details saved for document 9265947
[16:07:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265944                         ║
================================================================================
[16:07:53] ℹ️  Agency: Dartmouth HH
[16:07:53] ℹ️  Date: 04/29/2025
[16:07:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:07:59] [DOC: 9265944] ✅ Text extracted using pdfplumber (14416 chars)
[16:07:59] ✅    ✅ Text extracted using pdfplumber (14404 chars)
[16:07:59] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:02] ℹ️  AI extracted raw sex value: 'F'
[16:08:02] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[16:08:02] ℹ️  AI extracted payer source: 'None'
[16:08:02] ℹ️  AI extracted diagnoses:
[16:08:02] ℹ️    - Diagnosis 1: 'I13.0'
[16:08:02] ℹ️    - Diagnosis 2: 'I50.33'
[16:08:02] ℹ️    - Diagnosis 3: 'N18.31'
[16:08:02] ℹ️    - Diagnosis 4: 'D63.1'
[16:08:02] ℹ️    - Diagnosis 5: 'N39.0'
[16:08:02] ℹ️    - Diagnosis 6: 'B96.89'
[16:08:02] ℹ️  Final extracted MRN: '1013011'
[16:08:02] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[16:08:02] ℹ️  Final extracted Payer Source: ''
[16:08:02] ✅ Patient data extraction completed successfully
[16:08:02] ✅    ✅ Patient data extracted successfully
[16:08:02] 📊 Patient Response
     └─ patientFName: Bernice
     └─ patientLName: Russo
     └─ dob: 03/02/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1013011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'D63.1', 'fifthDiagnosis': 'N39.0', 'sixthDiagnosis': 'B96.89'}]
[16:08:02] ✅    ✅ Patient identified: Bernice Russo
[16:08:02] ✅    ✅ Patient name validation passed
[16:08:02] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:02] [DOC: 9265944] ℹ️  DOB normalized: 03/02/1932
[16:08:02] [DOC: 9265944] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[16:08:02] [DOC: 9265944] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[16:08:02] [DOC: 9265944] ✅ Patient date processing completed successfully
[16:08:02] ✅    ✅ Date processing completed
[16:08:02] 📊 Processed Patient Data
     └─ patientFName: Bernice
     └─ patientLName: Russo
     └─ dob: 03/02/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1013011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'D63.1', 'fifthDiagnosis': 'N39.0', 'sixthDiagnosis': 'B96.89'}]
[16:08:02] 🔄 
🔄 Step 4: Extracting order data...
[16:08:05] ℹ️  Order extraction - MRN: '1013011'
[16:08:05] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[16:08:05] ℹ️  Order extraction - Payer Source: ''
[16:08:05] ✅ Order data extraction completed successfully
[16:08:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:05] ℹ️  Using MRN from patient data: '1013011' over '1013011'
[16:08:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[16:08:05] ✅ Patient name cross-validation successful
[16:08:05] ✅    ✅ Data merged successfully
[16:08:06] ✅    ✅ Order data extracted and validated
[16:08:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:06] [DOC: 9265944] ✅ Patient found in local cache: Bernice Russo, ID: 7c4f54da-25b8-482f-b3e4-69506cedc17b
[16:08:06] ✅    ✅ Existing patient found with ID: 7c4f54da-25b8-482f-b3e4-69506cedc17b
[16:08:06] 🔄 
🔄 Step 6: Pushing order to API...
[16:08:06] [DOC: 9265944] ℹ️  Pushing order via API for patient ID: 7c4f54da-25b8-482f-b3e4-69506cedc17b
[16:08:07] [DOC: 9265944] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:08:07] ❌    ❌ Failed to push order
[16:08:07] 🔄 
🔄 Step 7: Writing to CSV...
[16:08:07] [DOC: 9265944] ℹ️  Calculated age: 93 from DOB: 03/02/1932
[16:08:07] [DOC: 9265944] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[16:08:07] [DOC: 9265944] ℹ️  Payer Source extracted: ''
[16:08:07] [DOC: 9265944] ℹ️  Diagnosis codes being written:
[16:08:07] [DOC: 9265944] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[16:08:07] [DOC: 9265944] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[16:08:07] [DOC: 9265944] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[16:08:07] [DOC: 9265944] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D63.1'
[16:08:07] [DOC: 9265944] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N39.0'
[16:08:07] [DOC: 9265944] ℹ️    - Latest_Episode_Sixthdiagnosis: 'B96.89'
[16:08:07] [DOC: 9265944] ✅ Patient data written to CSV: Bernice Russo | Sex: FEMALE | Age: 93 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 1013011
[16:08:07] ✅    ✅ Document 9265944 processed and saved successfully
[16:08:07] 🔄 
🔄 Step 8: Saving API details...
[16:08:07] [DOC: 9265944] ℹ️  API push details saved for document 9265944
[16:08:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265933                         ║
================================================================================
[16:08:07] ℹ️  Agency: Dartmouth HH
[16:08:07] ℹ️  Date: 04/29/2025
[16:08:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:10] [DOC: 9265933] ✅ Text extracted using pdfplumber (8960 chars)
[16:08:10] ✅    ✅ Text extracted using pdfplumber (8960 chars)
[16:08:10] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:13] ℹ️  AI extracted raw sex value: 'F'
[16:08:13] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy'
[16:08:13] ℹ️  AI extracted payer source: ''
[16:08:13] ℹ️  AI extracted diagnoses:
[16:08:13] ℹ️    - Diagnosis 1: 'D51.0'
[16:08:13] ℹ️    - Diagnosis 2: 'I48.91'
[16:08:13] ℹ️    - Diagnosis 3: 'I13.0'
[16:08:13] ℹ️    - Diagnosis 4: 'I50.43'
[16:08:13] ℹ️    - Diagnosis 5: 'E11.22'
[16:08:13] ℹ️    - Diagnosis 6: 'N18.30'
[16:08:13] ℹ️  Final extracted MRN: '227027'
[16:08:13] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:13] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy'
[16:08:13] ℹ️  Final extracted Payer Source: ''
[16:08:13] ✅ Patient data extraction completed successfully
[16:08:13] ✅    ✅ Patient data extracted successfully
[16:08:13] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'D51.0', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.43', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[16:08:13] ✅    ✅ Patient identified: Lois Fernandes
[16:08:13] ✅    ✅ Patient name validation passed
[16:08:13] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:13] [DOC: 9265933] ℹ️  DOB normalized: 05/15/1941
[16:08:13] [DOC: 9265933] ℹ️  Episode startOfCare normalized: 02/22/2025
[16:08:13] [DOC: 9265933] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[16:08:13] [DOC: 9265933] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[16:08:13] [DOC: 9265933] ✅ Patient date processing completed successfully
[16:08:13] ✅    ✅ Date processing completed
[16:08:13] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'D51.0', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.43', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[16:08:13] 🔄 
🔄 Step 4: Extracting order data...
[16:08:16] ℹ️  Order extraction - MRN: '227027'
[16:08:16] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[16:08:16] ℹ️  Order extraction - Payer Source: ''
[16:08:16] ✅ Order data extraction completed successfully
[16:08:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:16] ℹ️  Using MRN from patient data: '227027' over '227027'
[16:08:16] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[16:08:16] ✅ Patient name cross-validation successful
[16:08:16] ✅    ✅ Data merged successfully
[16:08:17] ✅    ✅ Order data extracted and validated
[16:08:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:23] [DOC: 9265933] ✅ Patient exists in API: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[16:08:23] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[16:08:23] 🔄 
🔄 Step 6: Pushing order to API...
[16:08:23] [DOC: 9265933] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[16:08:25] [DOC: 9265933] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:08:25] ❌    ❌ Failed to push order
[16:08:25] 🔄 
🔄 Step 7: Writing to CSV...
[16:08:25] [DOC: 9265933] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[16:08:25] [DOC: 9265933] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[16:08:25] [DOC: 9265933] ℹ️  Payer Source extracted: ''
[16:08:25] [DOC: 9265933] ℹ️  Diagnosis codes being written:
[16:08:25] [DOC: 9265933] ℹ️    - Latest_Episode_Firstdiagnosis: 'D51.0'
[16:08:25] [DOC: 9265933] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.91'
[16:08:25] [DOC: 9265933] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.0'
[16:08:25] [DOC: 9265933] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.43'
[16:08:25] [DOC: 9265933] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[16:08:25] [DOC: 9265933] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.30'
[16:08:25] [DOC: 9265933] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 227027
[16:08:25] ✅    ✅ Document 9265933 processed and saved successfully
[16:08:25] 🔄 
🔄 Step 8: Saving API details...
[16:08:25] [DOC: 9265933] ℹ️  API push details saved for document 9265933
[16:08:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265928                         ║
================================================================================
[16:08:25] ℹ️  Agency: Dartmouth HH
[16:08:25] ℹ️  Date: 04/29/2025
[16:08:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:27] [DOC: 9265928] ✅ Text extracted using pdfplumber (1579 chars)
[16:08:27] ✅    ✅ Text extracted using pdfplumber (1579 chars)
[16:08:27] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:29] ℹ️  AI extracted raw sex value: 'F'
[16:08:29] ℹ️  AI extracted service line: 'RN'
[16:08:29] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[16:08:29] ℹ️  AI extracted diagnoses:
[16:08:29] ℹ️    - Diagnosis 1: ''
[16:08:29] ℹ️    - Diagnosis 2: ''
[16:08:29] ℹ️    - Diagnosis 3: ''
[16:08:29] ℹ️    - Diagnosis 4: ''
[16:08:29] ℹ️    - Diagnosis 5: ''
[16:08:29] ℹ️    - Diagnosis 6: ''
[16:08:29] ℹ️  Final extracted MRN: '6066015'
[16:08:29] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:29] ℹ️  Final extracted Service Line: 'RN'
[16:08:29] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[16:08:29] ✅ Patient data extraction completed successfully
[16:08:29] ✅    ✅ Patient data extracted successfully
[16:08:29] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:29] ✅    ✅ Patient identified: Lois Fernandes
[16:08:29] ✅    ✅ Patient name validation passed
[16:08:29] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:29] [DOC: 9265928] ℹ️  DOB normalized: 05/15/1941
[16:08:29] [DOC: 9265928] ℹ️  Episode startOfCare normalized: 02/22/2025
[16:08:29] [DOC: 9265928] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[16:08:29] [DOC: 9265928] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[16:08:29] [DOC: 9265928] ✅ Patient date processing completed successfully
[16:08:29] ✅    ✅ Date processing completed
[16:08:29] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Fernandes
     └─ dob: 05/15/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6066015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:29] 🔄 
🔄 Step 4: Extracting order data...
[16:08:32] ℹ️  Order extraction - MRN: '6066015'
[16:08:32] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:32] ℹ️  Order extraction - Service Line: 'RN'
[16:08:32] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[16:08:32] ✅ Order data extraction completed successfully
[16:08:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:32] ℹ️  Using MRN from patient data: '6066015' over '6066015'
[16:08:32] ℹ️  Service line consistent in both sources: 'RN'
[16:08:32] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[16:08:32] ✅ Patient name cross-validation successful
[16:08:32] ✅    ✅ Data merged successfully
[16:08:33] ✅    ✅ Order data extracted and validated
[16:08:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:33] [DOC: 9265928] ✅ Patient found in local cache: Lois Fernandes, ID: fb3153c6-8885-4f29-bb91-457928d11401
[16:08:33] ✅    ✅ Existing patient found with ID: fb3153c6-8885-4f29-bb91-457928d11401
[16:08:33] 🔄 
🔄 Step 6: Pushing order to API...
[16:08:33] [DOC: 9265928] ℹ️  Pushing order via API for patient ID: fb3153c6-8885-4f29-bb91-457928d11401
[16:08:36] [DOC: 9265928] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:08:36] ❌    ❌ Failed to push order
[16:08:36] 🔄 
🔄 Step 7: Writing to CSV...
[16:08:36] [DOC: 9265928] ℹ️  Calculated age: 84 from DOB: 05/15/1941
[16:08:36] [DOC: 9265928] ℹ️  Service Line extracted: 'RN'
[16:08:36] [DOC: 9265928] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[16:08:36] [DOC: 9265928] ℹ️  Diagnosis codes being written:
[16:08:36] [DOC: 9265928] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:08:36] [DOC: 9265928] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:08:36] [DOC: 9265928] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:08:36] [DOC: 9265928] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:08:36] [DOC: 9265928] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:08:36] [DOC: 9265928] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:08:36] [DOC: 9265928] ✅ Patient data written to CSV: Lois Fernandes | Sex: FEMALE | Age: 84 | Service: RN | Payer: Blue Cross Medicare Adv | MRN: 6066015
[16:08:36] ✅    ✅ Document 9265928 processed and saved successfully
[16:08:36] 🔄 
🔄 Step 8: Saving API details...
[16:08:36] [DOC: 9265928] ℹ️  API push details saved for document 9265928
[16:08:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265922                         ║
================================================================================
[16:08:36] ℹ️  Agency: Dartmouth HH
[16:08:36] ℹ️  Date: 04/29/2025
[16:08:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:38] [DOC: 9265922] ✅ Text extracted using pdfplumber (1266 chars)
[16:08:38] ✅    ✅ Text extracted using pdfplumber (1266 chars)
[16:08:38] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:41] ℹ️  AI extracted raw sex value: 'M'
[16:08:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:08:41] ℹ️  AI extracted payer source: 'Fallon Health'
[16:08:41] ℹ️  AI extracted diagnoses:
[16:08:41] ℹ️    - Diagnosis 1: ''
[16:08:41] ℹ️    - Diagnosis 2: ''
[16:08:41] ℹ️    - Diagnosis 3: ''
[16:08:41] ℹ️    - Diagnosis 4: ''
[16:08:41] ℹ️    - Diagnosis 5: ''
[16:08:41] ℹ️    - Diagnosis 6: ''
[16:08:41] ℹ️  Final extracted MRN: '5334009'
[16:08:41] ℹ️  Final extracted Sex: 'MALE'
[16:08:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:08:41] ℹ️  Final extracted Payer Source: 'Fallon Health'
[16:08:41] ✅ Patient data extraction completed successfully
[16:08:41] ✅    ✅ Patient data extracted successfully
[16:08:41] 📊 Patient Response
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:41] ✅    ✅ Patient identified: Jeremias Teixeira
[16:08:41] ✅    ✅ Patient name validation passed
[16:08:41] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:41] [DOC: 9265922] ℹ️  DOB normalized: 12/26/1931
[16:08:41] [DOC: 9265922] ℹ️  Episode startOfCare normalized: 03/25/2025
[16:08:41] [DOC: 9265922] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[16:08:41] [DOC: 9265922] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[16:08:41] [DOC: 9265922] ✅ Patient date processing completed successfully
[16:08:41] ✅    ✅ Date processing completed
[16:08:41] 📊 Processed Patient Data
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:41] 🔄 
🔄 Step 4: Extracting order data...
[16:08:43] ℹ️  Order extraction - MRN: '5334009'
[16:08:43] ℹ️  Order extraction - Sex: 'MALE'
[16:08:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:08:43] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[16:08:43] ✅ Order data extraction completed successfully
[16:08:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:43] ℹ️  Using MRN from patient data: '5334009' over '5334009'
[16:08:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:08:43] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[16:08:43] ✅ Patient name cross-validation successful
[16:08:43] ✅    ✅ Data merged successfully
[16:08:45] ✅    ✅ Order data extracted and validated
[16:08:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:08:50] [DOC: 9265922] ✅ Patient exists in API: Jeremias Teixeira, ID: b4f73061-83ef-486e-b374-3b920247ea12
[16:08:50] ✅    ✅ Existing patient found with ID: b4f73061-83ef-486e-b374-3b920247ea12
[16:08:50] 🔄 
🔄 Step 6: Pushing order to API...
[16:08:50] [DOC: 9265922] ℹ️  Pushing order via API for patient ID: b4f73061-83ef-486e-b374-3b920247ea12
[16:08:51] [DOC: 9265922] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:08:51] ❌    ❌ Failed to push order
[16:08:51] 🔄 
🔄 Step 7: Writing to CSV...
[16:08:51] [DOC: 9265922] ℹ️  Calculated age: 93 from DOB: 12/26/1931
[16:08:51] [DOC: 9265922] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:08:51] [DOC: 9265922] ℹ️  Payer Source extracted: 'Fallon Health'
[16:08:51] [DOC: 9265922] ℹ️  Diagnosis codes being written:
[16:08:51] [DOC: 9265922] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:08:51] [DOC: 9265922] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:08:51] [DOC: 9265922] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:08:51] [DOC: 9265922] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:08:51] [DOC: 9265922] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:08:51] [DOC: 9265922] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:08:51] [DOC: 9265922] ✅ Patient data written to CSV: Jeremias Teixeira | Sex: MALE | Age: 93 | Service: Skilled Nursing | Payer: Fallon Health | MRN: 5334009
[16:08:51] ✅    ✅ Document 9265922 processed and saved successfully
[16:08:51] 🔄 
🔄 Step 8: Saving API details...
[16:08:51] [DOC: 9265922] ℹ️  API push details saved for document 9265922
[16:08:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265920                         ║
================================================================================
[16:08:51] ℹ️  Agency: Dartmouth HH
[16:08:51] ℹ️  Date: 04/29/2025
[16:08:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:08:54] [DOC: 9265920] ✅ Text extracted using pdfplumber (5646 chars)
[16:08:54] ✅    ✅ Text extracted using pdfplumber (5646 chars)
[16:08:54] 🔄 
🔄 Step 2: Extracting patient data...
[16:08:56] ℹ️  AI extracted raw sex value: 'F'
[16:08:56] ℹ️  AI extracted service line: 'PT, OT'
[16:08:56] ℹ️  AI extracted payer source: 'Medicare'
[16:08:56] ℹ️  AI extracted diagnoses:
[16:08:56] ℹ️    - Diagnosis 1: ''
[16:08:56] ℹ️    - Diagnosis 2: ''
[16:08:56] ℹ️    - Diagnosis 3: ''
[16:08:56] ℹ️    - Diagnosis 4: ''
[16:08:56] ℹ️    - Diagnosis 5: ''
[16:08:56] ℹ️    - Diagnosis 6: ''
[16:08:56] ℹ️  Final extracted MRN: '3649009'
[16:08:56] ℹ️  Final extracted Sex: 'FEMALE'
[16:08:56] ℹ️  Final extracted Service Line: 'PT, OT'
[16:08:56] ℹ️  Final extracted Payer Source: 'Medicare'
[16:08:56] ✅ Patient data extraction completed successfully
[16:08:56] ✅    ✅ Patient data extracted successfully
[16:08:56] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:56] ✅    ✅ Patient identified: Dorothy Fernandes
[16:08:56] ✅    ✅ Patient name validation passed
[16:08:56] 🔄 
🔄 Step 3: Processing patient dates...
[16:08:56] [DOC: 9265920] ℹ️  DOB normalized: 10/01/1937
[16:08:56] [DOC: 9265920] ℹ️  Episode startOfCare normalized: 03/22/2025
[16:08:56] [DOC: 9265920] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[16:08:56] [DOC: 9265920] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[16:08:56] [DOC: 9265920] ✅ Patient date processing completed successfully
[16:08:56] ✅    ✅ Date processing completed
[16:08:56] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:08:56] 🔄 
🔄 Step 4: Extracting order data...
[16:08:59] ℹ️  Order extraction - MRN: ''
[16:08:59] ℹ️  Order extraction - Sex: 'FEMALE'
[16:08:59] ℹ️  Order extraction - Service Line: 'PT'
[16:08:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:08:59] ✅ Order data extraction completed successfully
[16:08:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:08:59] ℹ️  Using MRN from patient data: '3649009'
[16:08:59] ℹ️  Combined service lines: Patient='PT, OT' + Order='PT' = 'OT, PT'
[16:08:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:08:59] ✅ Patient name cross-validation successful
[16:08:59] ✅    ✅ Data merged successfully
[16:09:00] ✅    ✅ Order data extracted and validated
[16:09:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:00] [DOC: 9265920] ✅ Patient found in local cache: Dorothy Fernandes, ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[16:09:00] ✅    ✅ Existing patient found with ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[16:09:00] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:00] [DOC: 9265920] ℹ️  Pushing order via API for patient ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[16:09:01] [DOC: 9265920] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:09:01] ❌    ❌ Failed to push order
[16:09:01] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:01] [DOC: 9265920] ℹ️  Calculated age: 87 from DOB: 10/01/1937
[16:09:01] [DOC: 9265920] ℹ️  Service Line extracted: 'OT, PT'
[16:09:01] [DOC: 9265920] ℹ️  Payer Source extracted: 'Medicare'
[16:09:01] [DOC: 9265920] ℹ️  Diagnosis codes being written:
[16:09:01] [DOC: 9265920] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:01] [DOC: 9265920] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:01] [DOC: 9265920] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:01] [DOC: 9265920] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:01] [DOC: 9265920] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:01] [DOC: 9265920] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:01] [DOC: 9265920] ✅ Patient data written to CSV: Dorothy Fernandes | Sex: FEMALE | Age: 87 | Service: OT, PT | Payer: Medicare | MRN: 3649009
[16:09:01] ✅    ✅ Document 9265920 processed and saved successfully
[16:09:01] 🔄 
🔄 Step 8: Saving API details...
[16:09:01] [DOC: 9265920] ℹ️  API push details saved for document 9265920
[16:09:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265918                         ║
================================================================================
[16:09:01] ℹ️  Agency: Dartmouth HH
[16:09:01] ℹ️  Date: 04/29/2025
[16:09:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:03] [DOC: 9265918] ✅ Text extracted using pdfplumber (1298 chars)
[16:09:03] ✅    ✅ Text extracted using pdfplumber (1298 chars)
[16:09:03] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:06] ℹ️  AI extracted raw sex value: 'F'
[16:09:06] ℹ️  AI extracted service line: 'RN'
[16:09:06] ℹ️  AI extracted payer source: 'Medicare'
[16:09:06] ℹ️  AI extracted diagnoses:
[16:09:06] ℹ️    - Diagnosis 1: 'None'
[16:09:06] ℹ️    - Diagnosis 2: 'None'
[16:09:06] ℹ️    - Diagnosis 3: 'None'
[16:09:06] ℹ️    - Diagnosis 4: 'None'
[16:09:06] ℹ️    - Diagnosis 5: 'None'
[16:09:06] ℹ️    - Diagnosis 6: 'None'
[16:09:06] ℹ️  Final extracted MRN: '2429011'
[16:09:06] ℹ️  Final extracted Sex: 'FEMALE'
[16:09:06] ℹ️  Final extracted Service Line: 'RN'
[16:09:06] ℹ️  Final extracted Payer Source: 'Medicare'
[16:09:06] ✅ Patient data extraction completed successfully
[16:09:06] ✅    ✅ Patient data extracted successfully
[16:09:06] 📊 Patient Response
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:09:06] ✅    ✅ Patient identified: Eduarda Demello
[16:09:06] ✅    ✅ Patient name validation passed
[16:09:06] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:06] [DOC: 9265918] ℹ️  DOB normalized: 09/29/1942
[16:09:06] [DOC: 9265918] ℹ️  Episode startOfCare normalized: 11/04/2024
[16:09:06] [DOC: 9265918] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[16:09:06] [DOC: 9265918] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[16:09:06] [DOC: 9265918] ✅ Patient date processing completed successfully
[16:09:06] ✅    ✅ Date processing completed
[16:09:06] 📊 Processed Patient Data
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025'}]
[16:09:06] 🔄 
🔄 Step 4: Extracting order data...
[16:09:08] ℹ️  Order extraction - MRN: ''
[16:09:08] ℹ️  Order extraction - Sex: 'FEMALE'
[16:09:08] ℹ️  Order extraction - Service Line: 'RN'
[16:09:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:09:08] ✅ Order data extraction completed successfully
[16:09:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:08] ℹ️  Using MRN from patient data: '2429011'
[16:09:08] ℹ️  Service line consistent in both sources: 'RN'
[16:09:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:09:08] ✅ Patient name cross-validation successful
[16:09:08] ✅    ✅ Data merged successfully
[16:09:09] ✅    ✅ Order data extracted and validated
[16:09:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:09] [DOC: 9265918] ✅ Patient found in local cache: Eduarda Demello, ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[16:09:09] ✅    ✅ Existing patient found with ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[16:09:09] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:09] [DOC: 9265918] ℹ️  Pushing order via API for patient ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[16:09:11] [DOC: 9265918] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13804"}
[16:09:11] ❌    ❌ Failed to push order
[16:09:11] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:11] [DOC: 9265918] ℹ️  Calculated age: 82 from DOB: 09/29/1942
[16:09:11] [DOC: 9265918] ℹ️  Service Line extracted: 'RN'
[16:09:11] [DOC: 9265918] ℹ️  Payer Source extracted: 'Medicare'
[16:09:11] [DOC: 9265918] ℹ️  Diagnosis codes being written:
[16:09:11] [DOC: 9265918] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:11] [DOC: 9265918] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:11] [DOC: 9265918] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:11] [DOC: 9265918] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:11] [DOC: 9265918] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:11] [DOC: 9265918] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:11] [DOC: 9265918] ✅ Patient data written to CSV: Eduarda Demello | Sex: FEMALE | Age: 82 | Service: RN | Payer: Medicare | MRN: 2429011
[16:09:11] ✅    ✅ Document 9265918 processed and saved successfully
[16:09:11] 🔄 
🔄 Step 8: Saving API details...
[16:09:11] [DOC: 9265918] ℹ️  API push details saved for document 9265918
[16:09:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265916                         ║
================================================================================
[16:09:11] ℹ️  Agency: Dartmouth HH
[16:09:11] ℹ️  Date: 04/29/2025
[16:09:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:13] [DOC: 9265916] ✅ Text extracted using pdfplumber (1480 chars)
[16:09:13] ✅    ✅ Text extracted using pdfplumber (1480 chars)
[16:09:13] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:15] ℹ️  AI extracted raw sex value: 'M'
[16:09:15] ℹ️  AI extracted service line: 'RN, LPN'
[16:09:15] ℹ️  AI extracted payer source: 'Fallon Health'
[16:09:15] ℹ️  AI extracted diagnoses:
[16:09:15] ℹ️    - Diagnosis 1: ''
[16:09:15] ℹ️    - Diagnosis 2: ''
[16:09:15] ℹ️    - Diagnosis 3: ''
[16:09:15] ℹ️    - Diagnosis 4: ''
[16:09:15] ℹ️    - Diagnosis 5: ''
[16:09:15] ℹ️    - Diagnosis 6: ''
[16:09:15] ℹ️  Final extracted MRN: '5334009'
[16:09:15] ℹ️  Final extracted Sex: 'MALE'
[16:09:15] ℹ️  Final extracted Service Line: 'RN, LPN'
[16:09:15] ℹ️  Final extracted Payer Source: 'Fallon Health'
[16:09:15] ✅ Patient data extraction completed successfully
[16:09:15] ✅    ✅ Patient data extracted successfully
[16:09:15] 📊 Patient Response
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:15] ✅    ✅ Patient identified: Jeremias Teixeira
[16:09:15] ✅    ✅ Patient name validation passed
[16:09:15] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:15] [DOC: 9265916] ℹ️  DOB normalized: 12/26/1931
[16:09:15] [DOC: 9265916] ℹ️  Episode startOfCare normalized: 03/25/2025
[16:09:15] [DOC: 9265916] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[16:09:15] [DOC: 9265916] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[16:09:15] [DOC: 9265916] ✅ Patient date processing completed successfully
[16:09:15] ✅    ✅ Date processing completed
[16:09:15] 📊 Processed Patient Data
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:15] 🔄 
🔄 Step 4: Extracting order data...
[16:09:18] ℹ️  Order extraction - MRN: '5334009'
[16:09:18] ℹ️  Order extraction - Sex: 'MALE'
[16:09:18] ℹ️  Order extraction - Service Line: 'RN, LPN'
[16:09:18] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[16:09:18] ✅ Order data extraction completed successfully
[16:09:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:18] ℹ️  Using MRN from patient data: '5334009' over '5334009'
[16:09:18] ℹ️  Service line consistent in both sources: 'RN, LPN'
[16:09:18] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[16:09:18] ✅ Patient name cross-validation successful
[16:09:18] ✅    ✅ Data merged successfully
[16:09:19] ✅    ✅ Order data extracted and validated
[16:09:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:19] [DOC: 9265916] ✅ Patient found in local cache: Jeremias Teixeira, ID: b4f73061-83ef-486e-b374-3b920247ea12
[16:09:19] ✅    ✅ Existing patient found with ID: b4f73061-83ef-486e-b374-3b920247ea12
[16:09:19] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:19] [DOC: 9265916] ℹ️  Pushing order via API for patient ID: b4f73061-83ef-486e-b374-3b920247ea12
[16:09:20] [DOC: 9265916] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:09:20] ❌    ❌ Failed to push order
[16:09:20] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:20] [DOC: 9265916] ℹ️  Calculated age: 93 from DOB: 12/26/1931
[16:09:20] [DOC: 9265916] ℹ️  Service Line extracted: 'RN, LPN'
[16:09:20] [DOC: 9265916] ℹ️  Payer Source extracted: 'Fallon Health'
[16:09:20] [DOC: 9265916] ℹ️  Diagnosis codes being written:
[16:09:20] [DOC: 9265916] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:20] [DOC: 9265916] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:20] [DOC: 9265916] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:20] [DOC: 9265916] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:20] [DOC: 9265916] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:20] [DOC: 9265916] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:20] [DOC: 9265916] ✅ Patient data written to CSV: Jeremias Teixeira | Sex: MALE | Age: 93 | Service: RN, LPN | Payer: Fallon Health | MRN: 5334009
[16:09:20] ✅    ✅ Document 9265916 processed and saved successfully
[16:09:20] 🔄 
🔄 Step 8: Saving API details...
[16:09:20] [DOC: 9265916] ℹ️  API push details saved for document 9265916
[16:09:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265894                         ║
================================================================================
[16:09:20] ℹ️  Agency: Dartmouth HH
[16:09:20] ℹ️  Date: 04/29/2025
[16:09:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:24] [DOC: 9265894] ✅ Text extracted using pdfplumber (10584 chars)
[16:09:24] ✅    ✅ Text extracted using pdfplumber (10572 chars)
[16:09:24] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:27] ℹ️  AI extracted raw sex value: 'M'
[16:09:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:09:27] ℹ️  AI extracted payer source: ''
[16:09:27] ℹ️  AI extracted diagnoses:
[16:09:27] ℹ️    - Diagnosis 1: 'N39.0'
[16:09:27] ℹ️    - Diagnosis 2: 'Z43.6'
[16:09:27] ℹ️    - Diagnosis 3: 'N13.1'
[16:09:27] ℹ️    - Diagnosis 4: 'I12.9'
[16:09:27] ℹ️    - Diagnosis 5: 'E11.22'
[16:09:27] ℹ️    - Diagnosis 6: 'N18.32'
[16:09:27] ℹ️  Final extracted MRN: '6570009'
[16:09:27] ℹ️  Final extracted Sex: 'MALE'
[16:09:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:09:27] ℹ️  Final extracted Payer Source: ''
[16:09:27] ✅ Patient data extraction completed successfully
[16:09:27] ✅    ✅ Patient data extracted successfully
[16:09:27] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'Z43.6', 'thirdDiagnosis': 'N13.1', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.32'}]
[16:09:27] ✅    ✅ Patient identified: James Wood
[16:09:27] ✅    ✅ Patient name validation passed
[16:09:27] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:27] [DOC: 9265894] ℹ️  DOB normalized: 01/29/1944
[16:09:27] [DOC: 9265894] ℹ️  Episode startOfCare normalized: 10/29/2024
[16:09:27] [DOC: 9265894] ℹ️  Episode startOfEpisode normalized: 04/27/2025
[16:09:27] [DOC: 9265894] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[16:09:27] [DOC: 9265894] ✅ Patient date processing completed successfully
[16:09:27] ✅    ✅ Date processing completed
[16:09:27] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'Z43.6', 'thirdDiagnosis': 'N13.1', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.32'}]
[16:09:27] 🔄 
🔄 Step 4: Extracting order data...
[16:09:29] ℹ️  Order extraction - MRN: '6570009'
[16:09:29] ℹ️  Order extraction - Sex: 'MALE'
[16:09:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:09:29] ℹ️  Order extraction - Payer Source: ''
[16:09:29] ✅ Order data extraction completed successfully
[16:09:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:29] ℹ️  Using MRN from patient data: '6570009' over '6570009'
[16:09:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:09:29] ✅ Patient name cross-validation successful
[16:09:29] ✅    ✅ Data merged successfully
[16:09:31] ✅    ✅ Order data extracted and validated
[16:09:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:31] [DOC: 9265894] ✅ Patient found in local cache: James Wood, ID: b532915a-79b5-4b9d-9458-683e03933774
[16:09:31] ✅    ✅ Existing patient found with ID: b532915a-79b5-4b9d-9458-683e03933774
[16:09:31] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:31] [DOC: 9265894] ℹ️  Pushing order via API for patient ID: b532915a-79b5-4b9d-9458-683e03933774
[16:09:32] [DOC: 9265894] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:09:32] ❌    ❌ Failed to push order
[16:09:32] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:32] [DOC: 9265894] ℹ️  Calculated age: 81 from DOB: 01/29/1944
[16:09:32] [DOC: 9265894] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:09:32] [DOC: 9265894] ℹ️  Payer Source extracted: ''
[16:09:32] [DOC: 9265894] ℹ️  Diagnosis codes being written:
[16:09:32] [DOC: 9265894] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[16:09:32] [DOC: 9265894] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z43.6'
[16:09:32] [DOC: 9265894] ℹ️    - Latest_Episode_Thirddiagnosis: 'N13.1'
[16:09:32] [DOC: 9265894] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I12.9'
[16:09:32] [DOC: 9265894] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[16:09:32] [DOC: 9265894] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.32'
[16:09:32] [DOC: 9265894] ✅ Patient data written to CSV: James Wood | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer:  | MRN: 6570009
[16:09:32] ✅    ✅ Document 9265894 processed and saved successfully
[16:09:32] 🔄 
🔄 Step 8: Saving API details...
[16:09:32] [DOC: 9265894] ℹ️  API push details saved for document 9265894
[16:09:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265892                         ║
================================================================================
[16:09:32] ℹ️  Agency: Dartmouth HH
[16:09:32] ℹ️  Date: 04/29/2025
[16:09:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:34] [DOC: 9265892] ✅ Text extracted using pdfplumber (1156 chars)
[16:09:34] ✅    ✅ Text extracted using pdfplumber (1156 chars)
[16:09:34] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:37] ℹ️  AI extracted raw sex value: 'M'
[16:09:37] ℹ️  AI extracted service line: 'HHA'
[16:09:37] ℹ️  AI extracted payer source: 'Medicare'
[16:09:37] ℹ️  AI extracted diagnoses:
[16:09:37] ℹ️    - Diagnosis 1: ''
[16:09:37] ℹ️    - Diagnosis 2: ''
[16:09:37] ℹ️    - Diagnosis 3: ''
[16:09:37] ℹ️    - Diagnosis 4: ''
[16:09:37] ℹ️    - Diagnosis 5: ''
[16:09:37] ℹ️    - Diagnosis 6: ''
[16:09:37] ℹ️  Final extracted MRN: '6570009'
[16:09:37] ℹ️  Final extracted Sex: 'MALE'
[16:09:37] ℹ️  Final extracted Service Line: 'HHA'
[16:09:37] ℹ️  Final extracted Payer Source: 'Medicare'
[16:09:37] ✅ Patient data extraction completed successfully
[16:09:37] ✅    ✅ Patient data extracted successfully
[16:09:37] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:37] ✅    ✅ Patient identified: James Wood
[16:09:37] ✅    ✅ Patient name validation passed
[16:09:37] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:37] [DOC: 9265892] ℹ️  DOB normalized: 01/29/1944
[16:09:37] [DOC: 9265892] ℹ️  Episode startOfCare normalized: 10/29/2024
[16:09:37] [DOC: 9265892] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[16:09:37] [DOC: 9265892] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[16:09:37] [DOC: 9265892] ✅ Patient date processing completed successfully
[16:09:37] ✅    ✅ Date processing completed
[16:09:37] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:37] 🔄 
🔄 Step 4: Extracting order data...
[16:09:39] ℹ️  Order extraction - MRN: ''
[16:09:39] ℹ️  Order extraction - Sex: 'MALE'
[16:09:39] ℹ️  Order extraction - Service Line: 'HHA'
[16:09:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:09:39] ✅ Order data extraction completed successfully
[16:09:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:39] ℹ️  Using MRN from patient data: '6570009'
[16:09:39] ℹ️  Service line consistent in both sources: 'HHA'
[16:09:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:09:39] ✅ Patient name cross-validation successful
[16:09:39] ✅    ✅ Data merged successfully
[16:09:40] ✅    ✅ Order data extracted and validated
[16:09:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:40] [DOC: 9265892] ✅ Patient found in local cache: James Wood, ID: b532915a-79b5-4b9d-9458-683e03933774
[16:09:40] ✅    ✅ Existing patient found with ID: b532915a-79b5-4b9d-9458-683e03933774
[16:09:40] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:40] [DOC: 9265892] ℹ️  Pushing order via API for patient ID: b532915a-79b5-4b9d-9458-683e03933774
[16:09:41] [DOC: 9265892] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:09:41] ❌    ❌ Failed to push order
[16:09:41] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:41] [DOC: 9265892] ℹ️  Calculated age: 81 from DOB: 01/29/1944
[16:09:41] [DOC: 9265892] ℹ️  Service Line extracted: 'HHA'
[16:09:41] [DOC: 9265892] ℹ️  Payer Source extracted: 'Medicare'
[16:09:41] [DOC: 9265892] ℹ️  Diagnosis codes being written:
[16:09:41] [DOC: 9265892] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:41] [DOC: 9265892] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:41] [DOC: 9265892] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:41] [DOC: 9265892] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:41] [DOC: 9265892] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:41] [DOC: 9265892] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:41] [DOC: 9265892] ✅ Patient data written to CSV: James Wood | Sex: MALE | Age: 81 | Service: HHA | Payer: Medicare | MRN: 6570009
[16:09:41] ✅    ✅ Document 9265892 processed and saved successfully
[16:09:41] 🔄 
🔄 Step 8: Saving API details...
[16:09:41] [DOC: 9265892] ℹ️  API push details saved for document 9265892
[16:09:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265890                         ║
================================================================================
[16:09:41] ℹ️  Agency: Dartmouth HH
[16:09:41] ℹ️  Date: 04/29/2025
[16:09:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:44] [DOC: 9265890] ✅ Text extracted using pdfplumber (4491 chars)
[16:09:44] ✅    ✅ Text extracted using pdfplumber (4491 chars)
[16:09:44] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:46] ℹ️  AI extracted raw sex value: 'M'
[16:09:46] ℹ️  AI extracted service line: 'Physical Therapy'
[16:09:46] ℹ️  AI extracted payer source: 'Medicare'
[16:09:46] ℹ️  AI extracted diagnoses:
[16:09:46] ℹ️    - Diagnosis 1: ''
[16:09:46] ℹ️    - Diagnosis 2: ''
[16:09:46] ℹ️    - Diagnosis 3: ''
[16:09:46] ℹ️    - Diagnosis 4: ''
[16:09:46] ℹ️    - Diagnosis 5: ''
[16:09:46] ℹ️    - Diagnosis 6: ''
[16:09:46] ℹ️  Final extracted MRN: '6129015'
[16:09:46] ℹ️  Final extracted Sex: 'MALE'
[16:09:46] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:09:46] ℹ️  Final extracted Payer Source: 'Medicare'
[16:09:46] ✅ Patient data extraction completed successfully
[16:09:46] ✅    ✅ Patient data extracted successfully
[16:09:46] 📊 Patient Response
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:46] ✅    ✅ Patient identified: Theodore Small
[16:09:46] ✅    ✅ Patient name validation passed
[16:09:46] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:46] [DOC: 9265890] ℹ️  DOB normalized: 09/25/1931
[16:09:46] [DOC: 9265890] ℹ️  Episode startOfCare normalized: 02/28/2025
[16:09:46] [DOC: 9265890] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[16:09:46] [DOC: 9265890] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[16:09:46] [DOC: 9265890] ✅ Patient date processing completed successfully
[16:09:46] ✅    ✅ Date processing completed
[16:09:46] 📊 Processed Patient Data
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:46] 🔄 
🔄 Step 4: Extracting order data...
[16:09:49] ℹ️  Order extraction - MRN: ''
[16:09:49] ℹ️  Order extraction - Sex: 'MALE'
[16:09:49] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:09:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:09:49] ✅ Order data extraction completed successfully
[16:09:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:09:49] ℹ️  Using MRN from patient data: '6129015'
[16:09:49] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:09:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:09:49] ✅ Patient name cross-validation successful
[16:09:49] ✅    ✅ Data merged successfully
[16:09:50] ✅    ✅ Order data extracted and validated
[16:09:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:09:50] [DOC: 9265890] ✅ Patient found in local cache: Theodore Small, ID: 8c849805-1775-4653-aa7c-ce211697fc95
[16:09:50] ✅    ✅ Existing patient found with ID: 8c849805-1775-4653-aa7c-ce211697fc95
[16:09:50] 🔄 
🔄 Step 6: Pushing order to API...
[16:09:50] [DOC: 9265890] ℹ️  Pushing order via API for patient ID: 8c849805-1775-4653-aa7c-ce211697fc95
[16:09:51] [DOC: 9265890] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:09:51] ❌    ❌ Failed to push order
[16:09:51] 🔄 
🔄 Step 7: Writing to CSV...
[16:09:51] [DOC: 9265890] ℹ️  Calculated age: 93 from DOB: 09/25/1931
[16:09:51] [DOC: 9265890] ℹ️  Service Line extracted: 'Physical Therapy'
[16:09:51] [DOC: 9265890] ℹ️  Payer Source extracted: 'Medicare'
[16:09:51] [DOC: 9265890] ℹ️  Diagnosis codes being written:
[16:09:51] [DOC: 9265890] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:09:51] [DOC: 9265890] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:09:51] [DOC: 9265890] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:09:51] [DOC: 9265890] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:09:51] [DOC: 9265890] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:09:51] [DOC: 9265890] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:09:51] [DOC: 9265890] ✅ Patient data written to CSV: Theodore Small | Sex: MALE | Age: 93 | Service: Physical Therapy | Payer: Medicare | MRN: 6129015
[16:09:51] ✅    ✅ Document 9265890 processed and saved successfully
[16:09:51] 🔄 
🔄 Step 8: Saving API details...
[16:09:51] [DOC: 9265890] ℹ️  API push details saved for document 9265890
[16:09:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265888                         ║
================================================================================
[16:09:51] ℹ️  Agency: Dartmouth HH
[16:09:51] ℹ️  Date: 04/29/2025
[16:09:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:09:55] [DOC: 9265888] ✅ Text extracted using pdfplumber (1214 chars)
[16:09:55] ✅    ✅ Text extracted using pdfplumber (1214 chars)
[16:09:55] 🔄 
🔄 Step 2: Extracting patient data...
[16:09:58] ℹ️  AI extracted raw sex value: 'M'
[16:09:58] ℹ️  AI extracted service line: 'RN'
[16:09:58] ℹ️  AI extracted payer source: 'Fallon Health'
[16:09:58] ℹ️  AI extracted diagnoses:
[16:09:58] ℹ️    - Diagnosis 1: ''
[16:09:58] ℹ️    - Diagnosis 2: ''
[16:09:58] ℹ️    - Diagnosis 3: ''
[16:09:58] ℹ️    - Diagnosis 4: ''
[16:09:58] ℹ️    - Diagnosis 5: ''
[16:09:58] ℹ️    - Diagnosis 6: ''
[16:09:58] ℹ️  Final extracted MRN: '6310015'
[16:09:58] ℹ️  Final extracted Sex: 'MALE'
[16:09:58] ℹ️  Final extracted Service Line: 'RN'
[16:09:58] ℹ️  Final extracted Payer Source: 'Fallon Health'
[16:09:58] ✅ Patient data extraction completed successfully
[16:09:58] ✅    ✅ Patient data extracted successfully
[16:09:58] 📊 Patient Response
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 6310015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 28 Manhattan Avenue
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:58] ✅    ✅ Patient identified: Augusto Dejesus
[16:09:58] ✅    ✅ Patient name validation passed
[16:09:58] 🔄 
🔄 Step 3: Processing patient dates...
[16:09:58] [DOC: 9265888] ℹ️  DOB normalized: 02/02/1940
[16:09:58] [DOC: 9265888] ℹ️  Episode startOfCare normalized: 03/30/2025
[16:09:58] [DOC: 9265888] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[16:09:58] [DOC: 9265888] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[16:09:58] [DOC: 9265888] ✅ Patient date processing completed successfully
[16:09:58] ✅    ✅ Date processing completed
[16:09:58] 📊 Processed Patient Data
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 6310015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 28 Manhattan Avenue
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:09:58] 🔄 
🔄 Step 4: Extracting order data...
[16:10:01] ℹ️  Order extraction - MRN: ''
[16:10:01] ℹ️  Order extraction - Sex: 'MALE'
[16:10:01] ℹ️  Order extraction - Service Line: ''
[16:10:01] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[16:10:01] ✅ Order data extraction completed successfully
[16:10:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:10:01] ℹ️  Using MRN from patient data: '6310015'
[16:10:01] ℹ️  Using service line from patient data: 'RN'
[16:10:01] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[16:10:01] ✅ Patient name cross-validation successful
[16:10:01] ✅    ✅ Data merged successfully
[16:10:03] ✅    ✅ Order data extracted and validated
[16:10:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:10:10] [DOC: 9265888] ✅ Patient exists in API: Augusto Dejesus, ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[16:10:10] ✅    ✅ Existing patient found with ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[16:10:10] 🔄 
🔄 Step 6: Pushing order to API...
[16:10:10] [DOC: 9265888] ℹ️  Pushing order via API for patient ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[16:10:12] [DOC: 9265888] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13798"}
[16:10:12] ❌    ❌ Failed to push order
[16:10:12] 🔄 
🔄 Step 7: Writing to CSV...
[16:10:12] [DOC: 9265888] ℹ️  Calculated age: 85 from DOB: 02/02/1940
[16:10:12] [DOC: 9265888] ℹ️  Service Line extracted: 'RN'
[16:10:12] [DOC: 9265888] ℹ️  Payer Source extracted: 'Fallon Health'
[16:10:12] [DOC: 9265888] ℹ️  Diagnosis codes being written:
[16:10:12] [DOC: 9265888] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:10:12] [DOC: 9265888] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:10:12] [DOC: 9265888] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:10:12] [DOC: 9265888] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:10:12] [DOC: 9265888] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:10:12] [DOC: 9265888] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:10:12] [DOC: 9265888] ✅ Patient data written to CSV: Augusto Dejesus | Sex: MALE | Age: 85 | Service: RN | Payer: Fallon Health | MRN: 6310015
[16:10:12] ✅    ✅ Document 9265888 processed and saved successfully
[16:10:12] 🔄 
🔄 Step 8: Saving API details...
[16:10:12] [DOC: 9265888] ℹ️  API push details saved for document 9265888
[16:10:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265885                         ║
================================================================================
[16:10:12] ℹ️  Agency: Dartmouth HH
[16:10:12] ℹ️  Date: 04/29/2025
[16:10:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:10:14] [DOC: 9265885] ✅ Text extracted using pdfplumber (3249 chars)
[16:10:14] ✅    ✅ Text extracted using pdfplumber (3249 chars)
[16:10:14] 🔄 
🔄 Step 2: Extracting patient data...
[16:10:17] ℹ️  AI extracted raw sex value: 'F'
[16:10:17] ℹ️  AI extracted service line: 'PT'
[16:10:17] ℹ️  AI extracted payer source: 'United Health Care'
[16:10:17] ℹ️  AI extracted diagnoses:
[16:10:17] ℹ️    - Diagnosis 1: ''
[16:10:17] ℹ️    - Diagnosis 2: ''
[16:10:17] ℹ️    - Diagnosis 3: ''
[16:10:17] ℹ️    - Diagnosis 4: ''
[16:10:17] ℹ️    - Diagnosis 5: ''
[16:10:17] ℹ️    - Diagnosis 6: ''
[16:10:17] ℹ️  Final extracted MRN: '6920009'
[16:10:17] ℹ️  Final extracted Sex: 'FEMALE'
[16:10:17] ℹ️  Final extracted Service Line: 'PT'
[16:10:17] ℹ️  Final extracted Payer Source: 'United Health Care'
[16:10:17] ✅ Patient data extraction completed successfully
[16:10:17] ✅    ✅ Patient data extracted successfully
[16:10:17] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Oliver
     └─ dob: 04/17/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6920009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:10:17] ✅    ✅ Patient identified: Shirley Oliver
[16:10:17] ✅    ✅ Patient name validation passed
[16:10:17] 🔄 
🔄 Step 3: Processing patient dates...
[16:10:17] [DOC: 9265885] ℹ️  DOB normalized: 04/17/1934
[16:10:17] [DOC: 9265885] ℹ️  Episode startOfCare normalized: 03/26/2025
[16:10:17] [DOC: 9265885] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[16:10:17] [DOC: 9265885] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[16:10:17] [DOC: 9265885] ✅ Patient date processing completed successfully
[16:10:17] ✅    ✅ Date processing completed
[16:10:17] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Oliver
     └─ dob: 04/17/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6920009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:10:17] 🔄 
🔄 Step 4: Extracting order data...
[16:10:19] ℹ️  Order extraction - MRN: ''
[16:10:19] ℹ️  Order extraction - Sex: 'FEMALE'
[16:10:19] ℹ️  Order extraction - Service Line: 'PT'
[16:10:19] ℹ️  Order extraction - Payer Source: 'United Health Care'
[16:10:19] ✅ Order data extraction completed successfully
[16:10:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:10:19] ℹ️  Using MRN from patient data: '6920009'
[16:10:19] ℹ️  Service line consistent in both sources: 'PT'
[16:10:19] ℹ️  Payer source consistent in both sources: 'United Health Care'
[16:10:19] ✅ Patient name cross-validation successful
[16:10:19] ✅    ✅ Data merged successfully
[16:10:20] ✅    ✅ Order data extracted and validated
[16:10:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:10:25] [DOC: 9265885] ✅ Patient exists in API: Shirley Oliver, ID: 587ee5d1-c176-4a81-b2df-c2ced317687c
[16:10:25] ✅    ✅ Existing patient found with ID: 587ee5d1-c176-4a81-b2df-c2ced317687c
[16:10:25] 🔄 
🔄 Step 6: Pushing order to API...
[16:10:25] [DOC: 9265885] ℹ️  Pushing order via API for patient ID: 587ee5d1-c176-4a81-b2df-c2ced317687c
[16:10:26] [DOC: 9265885] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12962"}
[16:10:26] ❌    ❌ Failed to push order
[16:10:26] 🔄 
🔄 Step 7: Writing to CSV...
[16:10:26] [DOC: 9265885] ℹ️  Calculated age: 91 from DOB: 04/17/1934
[16:10:26] [DOC: 9265885] ℹ️  Service Line extracted: 'PT'
[16:10:26] [DOC: 9265885] ℹ️  Payer Source extracted: 'United Health Care'
[16:10:26] [DOC: 9265885] ℹ️  Diagnosis codes being written:
[16:10:26] [DOC: 9265885] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:10:26] [DOC: 9265885] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:10:26] [DOC: 9265885] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:10:26] [DOC: 9265885] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:10:26] [DOC: 9265885] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:10:26] [DOC: 9265885] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:10:26] [DOC: 9265885] ✅ Patient data written to CSV: Shirley Oliver | Sex: FEMALE | Age: 91 | Service: PT | Payer: United Health Care | MRN: 6920009
[16:10:26] ✅    ✅ Document 9265885 processed and saved successfully
[16:10:26] 🔄 
🔄 Step 8: Saving API details...
[16:10:26] [DOC: 9265885] ℹ️  API push details saved for document 9265885
[16:10:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265882                         ║
================================================================================
[16:10:26] ℹ️  Agency: Dartmouth HH
[16:10:26] ℹ️  Date: 04/29/2025
[16:10:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:10:39] [DOC: 9265882] ✅ Text extracted using pdfplumber (19929 chars)
[16:10:39] ✅    ✅ Text extracted using pdfplumber (19917 chars)
[16:10:39] 🔄 
🔄 Step 2: Extracting patient data...
[16:10:42] ℹ️  AI extracted raw sex value: 'F'
[16:10:42] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[16:10:42] ℹ️  AI extracted payer source: 'None'
[16:10:42] ℹ️  AI extracted diagnoses:
[16:10:42] ℹ️    - Diagnosis 1: 'I50.32'
[16:10:42] ℹ️    - Diagnosis 2: 'I13.0'
[16:10:42] ℹ️    - Diagnosis 3: 'E10.22'
[16:10:42] ℹ️    - Diagnosis 4: 'N18.30'
[16:10:42] ℹ️    - Diagnosis 5: 'I25.10'
[16:10:42] ℹ️    - Diagnosis 6: 'I08.0'
[16:10:42] ℹ️  Final extracted MRN: '2324001'
[16:10:42] ℹ️  Final extracted Sex: 'FEMALE'
[16:10:42] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[16:10:42] ℹ️  Final extracted Payer Source: ''
[16:10:42] ✅ Patient data extraction completed successfully
[16:10:42] ✅    ✅ Patient data extracted successfully
[16:10:42] 📊 Patient Response
     └─ patientFName: Gloria J
     └─ patientLName: Rose
     └─ dob: 05/16/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2324001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'E10.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I08.0'}]
[16:10:42] ✅    ✅ Patient identified: Gloria J Rose
[16:10:42] ✅    ✅ Patient name validation passed
[16:10:42] 🔄 
🔄 Step 3: Processing patient dates...
[16:10:42] [DOC: 9265882] ℹ️  DOB normalized: 05/16/1938
[16:10:42] [DOC: 9265882] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[16:10:42] [DOC: 9265882] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[16:10:42] [DOC: 9265882] ✅ Patient date processing completed successfully
[16:10:42] ✅    ✅ Date processing completed
[16:10:42] 📊 Processed Patient Data
     └─ patientFName: Gloria J
     └─ patientLName: Rose
     └─ dob: 05/16/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2324001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'E10.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I08.0'}]
[16:10:42] 🔄 
🔄 Step 4: Extracting order data...
[16:10:45] ℹ️  Order extraction - MRN: '2324001'
[16:10:45] ℹ️  Order extraction - Sex: 'FEMALE'
[16:10:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[16:10:45] ℹ️  Order extraction - Payer Source: ''
[16:10:45] ✅ Order data extraction completed successfully
[16:10:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:10:45] ℹ️  Using MRN from patient data: '2324001' over '2324001'
[16:10:45] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[16:10:45] ✅ Patient name cross-validation successful
[16:10:45] ✅    ✅ Data merged successfully
[16:10:46] ✅    ✅ Order data extracted and validated
[16:10:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:11:02] [DOC: 9265882] ✅ Patient exists in API: Gloria J Rose, ID: 7628117e-6823-47ea-91ea-425899d8f074
[16:11:02] ✅    ✅ Existing patient found with ID: 7628117e-6823-47ea-91ea-425899d8f074
[16:11:02] 🔄 
🔄 Step 6: Pushing order to API...
[16:11:02] [DOC: 9265882] ℹ️  Pushing order via API for patient ID: 7628117e-6823-47ea-91ea-425899d8f074
[16:11:04] [DOC: 9265882] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:11:04] ❌    ❌ Failed to push order
[16:11:04] 🔄 
🔄 Step 7: Writing to CSV...
[16:11:04] [DOC: 9265882] ℹ️  Calculated age: 87 from DOB: 05/16/1938
[16:11:04] [DOC: 9265882] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[16:11:04] [DOC: 9265882] ℹ️  Payer Source extracted: ''
[16:11:04] [DOC: 9265882] ℹ️  Diagnosis codes being written:
[16:11:04] [DOC: 9265882] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50.32'
[16:11:04] [DOC: 9265882] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[16:11:04] [DOC: 9265882] ℹ️    - Latest_Episode_Thirddiagnosis: 'E10.22'
[16:11:04] [DOC: 9265882] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[16:11:04] [DOC: 9265882] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[16:11:04] [DOC: 9265882] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I08.0'
[16:11:04] [DOC: 9265882] ✅ Patient data written to CSV: Gloria J Rose | Sex: FEMALE | Age: 87 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2324001
[16:11:04] ✅    ✅ Document 9265882 processed and saved successfully
[16:11:04] 🔄 
🔄 Step 8: Saving API details...
[16:11:04] [DOC: 9265882] ℹ️  API push details saved for document 9265882
[16:11:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265867                         ║
================================================================================
[16:11:04] ℹ️  Agency: Dartmouth HH
[16:11:04] ℹ️  Date: 04/29/2025
[16:11:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:11:06] [DOC: 9265867] ✅ Text extracted using pdfplumber (1605 chars)
[16:11:06] ✅    ✅ Text extracted using pdfplumber (1605 chars)
[16:11:06] 🔄 
🔄 Step 2: Extracting patient data...
[16:11:09] ℹ️  AI extracted raw sex value: 'F'
[16:11:09] ℹ️  AI extracted service line: 'PT'
[16:11:09] ℹ️  AI extracted payer source: 'Fallon Navicare'
[16:11:09] ℹ️  AI extracted diagnoses:
[16:11:09] ℹ️    - Diagnosis 1: ''
[16:11:09] ℹ️    - Diagnosis 2: ''
[16:11:09] ℹ️    - Diagnosis 3: ''
[16:11:09] ℹ️    - Diagnosis 4: ''
[16:11:09] ℹ️    - Diagnosis 5: ''
[16:11:09] ℹ️    - Diagnosis 6: ''
[16:11:09] ℹ️  Final extracted MRN: '7544009'
[16:11:09] ℹ️  Final extracted Sex: 'FEMALE'
[16:11:09] ℹ️  Final extracted Service Line: 'PT'
[16:11:09] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[16:11:09] ✅ Patient data extraction completed successfully
[16:11:09] ✅    ✅ Patient data extracted successfully
[16:11:09] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:11:09] ✅    ✅ Patient identified: Sandra Knickerbocker
[16:11:09] ✅    ✅ Patient name validation passed
[16:11:09] 🔄 
🔄 Step 3: Processing patient dates...
[16:11:09] [DOC: 9265867] ℹ️  DOB normalized: 07/22/1948
[16:11:09] [DOC: 9265867] ℹ️  Episode startOfCare normalized: 03/26/2025
[16:11:09] [DOC: 9265867] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[16:11:09] [DOC: 9265867] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[16:11:09] [DOC: 9265867] ✅ Patient date processing completed successfully
[16:11:09] ✅    ✅ Date processing completed
[16:11:09] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:11:09] 🔄 
🔄 Step 4: Extracting order data...
[16:11:11] ℹ️  Order extraction - MRN: '7544009'
[16:11:11] ℹ️  Order extraction - Sex: 'FEMALE'
[16:11:11] ℹ️  Order extraction - Service Line: 'PT'
[16:11:11] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[16:11:11] ✅ Order data extraction completed successfully
[16:11:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:11:11] ℹ️  Using MRN from patient data: '7544009' over '7544009'
[16:11:11] ℹ️  Service line consistent in both sources: 'PT'
[16:11:11] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[16:11:11] ✅ Patient name cross-validation successful
[16:11:11] ✅    ✅ Data merged successfully
[16:11:12] ✅    ✅ Order data extracted and validated
[16:11:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:11:12] [DOC: 9265867] ✅ Patient found in local cache: Sandra Knickerbocker, ID: 72b6d189-6994-4d0a-9e48-56e329440311
[16:11:12] ✅    ✅ Existing patient found with ID: 72b6d189-6994-4d0a-9e48-56e329440311
[16:11:12] 🔄 
🔄 Step 6: Pushing order to API...
[16:11:12] [DOC: 9265867] ℹ️  Pushing order via API for patient ID: 72b6d189-6994-4d0a-9e48-56e329440311
[16:11:14] [DOC: 9265867] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:11:14] ❌    ❌ Failed to push order
[16:11:14] 🔄 
🔄 Step 7: Writing to CSV...
[16:11:14] [DOC: 9265867] ℹ️  Calculated age: 76 from DOB: 07/22/1948
[16:11:14] [DOC: 9265867] ℹ️  Service Line extracted: 'PT'
[16:11:14] [DOC: 9265867] ℹ️  Payer Source extracted: 'Fallon Navicare'
[16:11:14] [DOC: 9265867] ℹ️  Diagnosis codes being written:
[16:11:14] [DOC: 9265867] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:11:14] [DOC: 9265867] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:11:14] [DOC: 9265867] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:11:14] [DOC: 9265867] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:11:14] [DOC: 9265867] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:11:14] [DOC: 9265867] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:11:14] [DOC: 9265867] ✅ Patient data written to CSV: Sandra Knickerbocker | Sex: FEMALE | Age: 76 | Service: PT | Payer: Fallon Navicare | MRN: 7544009
[16:11:14] ✅    ✅ Document 9265867 processed and saved successfully
[16:11:14] 🔄 
🔄 Step 8: Saving API details...
[16:11:14] [DOC: 9265867] ℹ️  API push details saved for document 9265867
[16:11:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265866                         ║
================================================================================
[16:11:14] ℹ️  Agency: Dartmouth HH
[16:11:14] ℹ️  Date: 04/29/2025
[16:11:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:11:16] [DOC: 9265866] ✅ Text extracted using pdfplumber (6173 chars)
[16:11:16] ✅    ✅ Text extracted using pdfplumber (6173 chars)
[16:11:16] 🔄 
🔄 Step 2: Extracting patient data...
[16:11:19] ℹ️  AI extracted raw sex value: 'F'
[16:11:19] ℹ️  AI extracted service line: 'OT'
[16:11:19] ℹ️  AI extracted payer source: 'Fallon Navicare'
[16:11:19] ℹ️  AI extracted diagnoses:
[16:11:19] ℹ️    - Diagnosis 1: 'Back pain'
[16:11:19] ℹ️    - Diagnosis 2: 'Lumbosacral radiculopathy'
[16:11:19] ℹ️    - Diagnosis 3: 'Falls'
[16:11:19] ℹ️    - Diagnosis 4: 'Malignant Neoplasm of the Bone'
[16:11:19] ℹ️    - Diagnosis 5: 'DM'
[16:11:19] ℹ️    - Diagnosis 6: 'Hyperlipidemia'
[16:11:19] ℹ️  Final extracted MRN: '3537009'
[16:11:19] ℹ️  Final extracted Sex: 'FEMALE'
[16:11:19] ℹ️  Final extracted Service Line: 'OT'
[16:11:19] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[16:11:19] ✅ Patient data extraction completed successfully
[16:11:19] ✅    ✅ Patient data extracted successfully
[16:11:19] 📊 Patient Response
     └─ patientFName: Leonette
     └─ patientLName: Bourbeau
     └─ dob: 07/15/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3537009
     └─ billingProvider: Fallon Navicare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'Back pain', 'secondDiagnosis': 'Lumbosacral radiculopathy', 'thirdDiagnosis': 'Falls', 'fourthDiagnosis': 'Malignant Neoplasm of the Bone', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'Hyperlipidemia'}]
[16:11:19] ✅    ✅ Patient identified: Leonette Bourbeau
[16:11:19] ✅    ✅ Patient name validation passed
[16:11:19] 🔄 
🔄 Step 3: Processing patient dates...
[16:11:19] [DOC: 9265866] ℹ️  DOB normalized: 07/15/1948
[16:11:19] [DOC: 9265866] ℹ️  Episode startOfCare normalized: 04/14/2025
[16:11:19] [DOC: 9265866] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[16:11:19] [DOC: 9265866] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[16:11:19] [DOC: 9265866] ✅ Patient date processing completed successfully
[16:11:19] ✅    ✅ Date processing completed
[16:11:19] 📊 Processed Patient Data
     └─ patientFName: Leonette
     └─ patientLName: Bourbeau
     └─ dob: 07/15/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3537009
     └─ billingProvider: Fallon Navicare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'Back pain', 'secondDiagnosis': 'Lumbosacral radiculopathy', 'thirdDiagnosis': 'Falls', 'fourthDiagnosis': 'Malignant Neoplasm of the Bone', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'Hyperlipidemia'}]
[16:11:19] 🔄 
🔄 Step 4: Extracting order data...
[16:11:22] ℹ️  Order extraction - MRN: '3537009'
[16:11:22] ℹ️  Order extraction - Sex: 'FEMALE'
[16:11:22] ℹ️  Order extraction - Service Line: 'OT'
[16:11:22] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[16:11:22] ✅ Order data extraction completed successfully
[16:11:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:11:22] ℹ️  Using MRN from patient data: '3537009' over '3537009'
[16:11:22] ℹ️  Service line consistent in both sources: 'OT'
[16:11:22] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[16:11:22] ✅ Patient name cross-validation successful
[16:11:22] ✅    ✅ Data merged successfully
[16:11:23] ✅    ✅ Order data extracted and validated
[16:11:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:11:29] [DOC: 9265866] ✅ Patient exists in API: Leonette Bourbeau, ID: 8a413ee5-d64b-44e4-93fe-9da4285ed63b
[16:11:29] ✅    ✅ Existing patient found with ID: 8a413ee5-d64b-44e4-93fe-9da4285ed63b
[16:11:29] 🔄 
🔄 Step 6: Pushing order to API...
[16:11:29] [DOC: 9265866] ℹ️  Pushing order via API for patient ID: 8a413ee5-d64b-44e4-93fe-9da4285ed63b
[16:11:30] [DOC: 9265866] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:11:30] ❌    ❌ Failed to push order
[16:11:30] 🔄 
🔄 Step 7: Writing to CSV...
[16:11:30] [DOC: 9265866] ℹ️  Calculated age: 76 from DOB: 07/15/1948
[16:11:30] [DOC: 9265866] ℹ️  Service Line extracted: 'OT'
[16:11:30] [DOC: 9265866] ℹ️  Payer Source extracted: 'Fallon Navicare'
[16:11:30] [DOC: 9265866] ℹ️  Diagnosis codes being written:
[16:11:30] [DOC: 9265866] ℹ️    - Latest_Episode_Firstdiagnosis: 'Back pain'
[16:11:30] [DOC: 9265866] ℹ️    - Latest_Episode_Seconddiagnosis: 'Lumbosacral radiculopathy'
[16:11:30] [DOC: 9265866] ℹ️    - Latest_Episode_Thirddiagnosis: 'Falls'
[16:11:30] [DOC: 9265866] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Malignant Neoplasm of the Bone'
[16:11:30] [DOC: 9265866] ℹ️    - Latest_Episode_Fifthdiagnosis: 'DM'
[16:11:30] [DOC: 9265866] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Hyperlipidemia'
[16:11:30] [DOC: 9265866] ✅ Patient data written to CSV: Leonette Bourbeau | Sex: FEMALE | Age: 76 | Service: OT | Payer: Fallon Navicare | MRN: 3537009
[16:11:30] ✅    ✅ Document 9265866 processed and saved successfully
[16:11:30] 🔄 
🔄 Step 8: Saving API details...
[16:11:30] [DOC: 9265866] ℹ️  API push details saved for document 9265866
[16:11:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265861                         ║
================================================================================
[16:11:30] ℹ️  Agency: Dartmouth HH
[16:11:30] ℹ️  Date: 04/29/2025
[16:11:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:11:32] [DOC: 9265861] ✅ Text extracted using pdfplumber (1082 chars)
[16:11:32] ✅    ✅ Text extracted using pdfplumber (1082 chars)
[16:11:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:11:34] ℹ️  AI extracted raw sex value: 'M'
[16:11:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:11:34] ℹ️  AI extracted payer source: 'Medicare'
[16:11:34] ℹ️  AI extracted diagnoses:
[16:11:34] ℹ️    - Diagnosis 1: 'None'
[16:11:34] ℹ️    - Diagnosis 2: 'None'
[16:11:34] ℹ️    - Diagnosis 3: 'None'
[16:11:34] ℹ️    - Diagnosis 4: 'None'
[16:11:34] ℹ️    - Diagnosis 5: 'None'
[16:11:34] ℹ️    - Diagnosis 6: 'None'
[16:11:34] ℹ️  Final extracted MRN: '6142015'
[16:11:34] ℹ️  Final extracted Sex: 'MALE'
[16:11:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:11:34] ℹ️  Final extracted Payer Source: 'Medicare'
[16:11:34] ✅ Patient data extraction completed successfully
[16:11:34] ✅    ✅ Patient data extracted successfully
[16:11:34] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1044 Victoria Street C33
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:11:34] ✅    ✅ Patient identified: Raymond Sleight
[16:11:34] ✅    ✅ Patient name validation passed
[16:11:34] 🔄 
🔄 Step 3: Processing patient dates...
[16:11:34] [DOC: 9265861] ℹ️  DOB normalized: 07/10/1942
[16:11:34] [DOC: 9265861] ℹ️  Episode startOfCare normalized: 03/13/2025
[16:11:35] [DOC: 9265861] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[16:11:35] [DOC: 9265861] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[16:11:35] [DOC: 9265861] ✅ Patient date processing completed successfully
[16:11:35] ✅    ✅ Date processing completed
[16:11:35] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1044 Victoria Street C33
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025'}]
[16:11:35] 🔄 
🔄 Step 4: Extracting order data...
[16:11:37] ℹ️  Order extraction - MRN: ''
[16:11:37] ℹ️  Order extraction - Sex: 'MALE'
[16:11:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:11:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:11:37] ✅ Order data extraction completed successfully
[16:11:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:11:37] ℹ️  Using MRN from patient data: '6142015'
[16:11:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:11:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:11:37] ✅ Patient name cross-validation successful
[16:11:37] ✅    ✅ Data merged successfully
[16:11:38] ✅    ✅ Order data extracted and validated
[16:11:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:11:49] [DOC: 9265861] ✅ Patient exists in API: Raymond Sleight, ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[16:11:49] ✅    ✅ Existing patient found with ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[16:11:49] 🔄 
🔄 Step 6: Pushing order to API...
[16:11:49] [DOC: 9265861] ℹ️  Pushing order via API for patient ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[16:11:50] [DOC: 9265861] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:11:50] ❌    ❌ Failed to push order
[16:11:50] 🔄 
🔄 Step 7: Writing to CSV...
[16:11:50] [DOC: 9265861] ℹ️  Calculated age: 82 from DOB: 07/10/1942
[16:11:50] [DOC: 9265861] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:11:50] [DOC: 9265861] ℹ️  Payer Source extracted: 'Medicare'
[16:11:50] [DOC: 9265861] ℹ️  Diagnosis codes being written:
[16:11:50] [DOC: 9265861] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:11:50] [DOC: 9265861] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:11:50] [DOC: 9265861] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:11:50] [DOC: 9265861] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:11:50] [DOC: 9265861] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:11:50] [DOC: 9265861] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:11:50] [DOC: 9265861] ✅ Patient data written to CSV: Raymond Sleight | Sex: MALE | Age: 82 | Service: Skilled Nursing | Payer: Medicare | MRN: 6142015
[16:11:50] ✅    ✅ Document 9265861 processed and saved successfully
[16:11:50] 🔄 
🔄 Step 8: Saving API details...
[16:11:50] [DOC: 9265861] ℹ️  API push details saved for document 9265861
[16:11:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265857                         ║
================================================================================
[16:11:50] ℹ️  Agency: Dartmouth HH
[16:11:50] ℹ️  Date: 04/29/2025
[16:11:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:11:53] [DOC: 9265857] ✅ Text extracted using pdfplumber (11540 chars)
[16:11:53] ✅    ✅ Text extracted using pdfplumber (11540 chars)
[16:11:53] 🔄 
🔄 Step 2: Extracting patient data...
[16:11:56] ℹ️  AI extracted raw sex value: 'M'
[16:11:56] ℹ️  AI extracted service line: 'PT, OT'
[16:11:56] ℹ️  AI extracted payer source: 'None'
[16:11:56] ℹ️  AI extracted diagnoses:
[16:11:56] ℹ️    - Diagnosis 1: 'M19.011'
[16:11:56] ℹ️    - Diagnosis 2: 'M25.511'
[16:11:56] ℹ️    - Diagnosis 3: 'M19.012'
[16:11:56] ℹ️    - Diagnosis 4: 'M62.81'
[16:11:56] ℹ️    - Diagnosis 5: 'M25.562'
[16:11:56] ℹ️    - Diagnosis 6: 'I12.9'
[16:11:56] ℹ️  Final extracted MRN: '4031011'
[16:11:56] ℹ️  Final extracted Sex: 'MALE'
[16:11:56] ℹ️  Final extracted Service Line: 'PT, OT'
[16:11:56] ℹ️  Final extracted Payer Source: ''
[16:11:56] ✅ Patient data extraction completed successfully
[16:11:56] ✅    ✅ Patient data extracted successfully
[16:11:56] 📊 Patient Response
     └─ patientFName: Gilberto
     └─ patientLName: Tavares
     └─ dob: 03/04/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 4031011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'M19.011', 'secondDiagnosis': 'M25.511', 'thirdDiagnosis': 'M19.012', 'fourthDiagnosis': 'M62.81', 'fifthDiagnosis': 'M25.562', 'sixthDiagnosis': 'I12.9'}]
[16:11:56] ✅    ✅ Patient identified: Gilberto Tavares
[16:11:56] ✅    ✅ Patient name validation passed
[16:11:56] 🔄 
🔄 Step 3: Processing patient dates...
[16:11:56] [DOC: 9265857] ℹ️  DOB normalized: 03/04/1941
[16:11:56] [DOC: 9265857] ℹ️  Episode startOfCare normalized: 04/18/2025
[16:11:56] [DOC: 9265857] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[16:11:56] [DOC: 9265857] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[16:11:56] [DOC: 9265857] ✅ Patient date processing completed successfully
[16:11:56] ✅    ✅ Date processing completed
[16:11:56] 📊 Processed Patient Data
     └─ patientFName: Gilberto
     └─ patientLName: Tavares
     └─ dob: 03/04/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 4031011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'M19.011', 'secondDiagnosis': 'M25.511', 'thirdDiagnosis': 'M19.012', 'fourthDiagnosis': 'M62.81', 'fifthDiagnosis': 'M25.562', 'sixthDiagnosis': 'I12.9'}]
[16:11:56] 🔄 
🔄 Step 4: Extracting order data...
[16:11:58] ℹ️  Order extraction - MRN: '4031011'
[16:11:58] ℹ️  Order extraction - Sex: 'MALE'
[16:11:58] ℹ️  Order extraction - Service Line: 'PT, OT'
[16:11:58] ℹ️  Order extraction - Payer Source: ''
[16:11:58] ✅ Order data extraction completed successfully
[16:11:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:11:58] ℹ️  Using MRN from patient data: '4031011' over '4031011'
[16:11:58] ℹ️  Service line consistent in both sources: 'PT, OT'
[16:11:58] ✅ Patient name cross-validation successful
[16:11:58] ✅    ✅ Data merged successfully
[16:11:59] ✅    ✅ Order data extracted and validated
[16:11:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:18] [DOC: 9265857] ℹ️  Patient not found in cache or API: Gilberto Tavares
[16:12:18] [DOC: 9265857] ℹ️  Patient not found, creating new patient via API...
[16:12:18] [DOC: 9265857] ℹ️  Creating patient via API: Gilberto Tavares
[16:12:20] [DOC: 9265857] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:12:20] ❌    ❌ Failed to create patient
[16:12:20] [DOC: 9265857] ℹ️  API push details saved for document 9265857
================================================================================
║                        Processing Document ID: 9265854                         ║
================================================================================
[16:12:20] ℹ️  Agency: Dartmouth HH
[16:12:20] ℹ️  Date: 04/29/2025
[16:12:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:12:21] [DOC: 9265854] ✅ Text extracted using pdfplumber (1165 chars)
[16:12:21] ✅    ✅ Text extracted using pdfplumber (1165 chars)
[16:12:21] 🔄 
🔄 Step 2: Extracting patient data...
[16:12:24] ℹ️  AI extracted raw sex value: 'F'
[16:12:24] ℹ️  AI extracted service line: 'RN, LPN'
[16:12:24] ℹ️  AI extracted payer source: 'Medicare'
[16:12:24] ℹ️  AI extracted diagnoses:
[16:12:24] ℹ️    - Diagnosis 1: ''
[16:12:24] ℹ️    - Diagnosis 2: ''
[16:12:24] ℹ️    - Diagnosis 3: ''
[16:12:24] ℹ️    - Diagnosis 4: ''
[16:12:24] ℹ️    - Diagnosis 5: ''
[16:12:24] ℹ️    - Diagnosis 6: ''
[16:12:24] ℹ️  Final extracted MRN: '5662015'
[16:12:24] ℹ️  Final extracted Sex: 'FEMALE'
[16:12:24] ℹ️  Final extracted Service Line: 'RN, LPN'
[16:12:24] ℹ️  Final extracted Payer Source: 'Medicare'
[16:12:24] ✅ Patient data extraction completed successfully
[16:12:24] ✅    ✅ Patient data extracted successfully
[16:12:24] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:24] ✅    ✅ Patient identified: Betty Mendonca
[16:12:24] ✅    ✅ Patient name validation passed
[16:12:24] 🔄 
🔄 Step 3: Processing patient dates...
[16:12:24] [DOC: 9265854] ℹ️  DOB normalized: 04/08/1948
[16:12:24] [DOC: 9265854] ℹ️  Episode startOfCare normalized: 12/08/2024
[16:12:24] [DOC: 9265854] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[16:12:24] [DOC: 9265854] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[16:12:24] [DOC: 9265854] ✅ Patient date processing completed successfully
[16:12:24] ✅    ✅ Date processing completed
[16:12:24] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:24] 🔄 
🔄 Step 4: Extracting order data...
[16:12:26] ℹ️  Order extraction - MRN: ''
[16:12:26] ℹ️  Order extraction - Sex: 'FEMALE'
[16:12:26] ℹ️  Order extraction - Service Line: 'RN, LPN'
[16:12:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:12:26] ✅ Order data extraction completed successfully
[16:12:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:12:26] ℹ️  Using MRN from patient data: '5662015'
[16:12:26] ℹ️  Service line consistent in both sources: 'RN, LPN'
[16:12:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:12:26] ✅ Patient name cross-validation successful
[16:12:26] ✅    ✅ Data merged successfully
[16:12:28] ✅    ✅ Order data extracted and validated
[16:12:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:28] [DOC: 9265854] ✅ Patient found in local cache: Betty Mendonca, ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[16:12:28] ✅    ✅ Existing patient found with ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[16:12:28] 🔄 
🔄 Step 6: Pushing order to API...
[16:12:28] [DOC: 9265854] ℹ️  Pushing order via API for patient ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[16:12:29] [DOC: 9265854] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14093"}
[16:12:29] ❌    ❌ Failed to push order
[16:12:29] 🔄 
🔄 Step 7: Writing to CSV...
[16:12:29] [DOC: 9265854] ℹ️  Calculated age: 77 from DOB: 04/08/1948
[16:12:29] [DOC: 9265854] ℹ️  Service Line extracted: 'RN, LPN'
[16:12:29] [DOC: 9265854] ℹ️  Payer Source extracted: 'Medicare'
[16:12:29] [DOC: 9265854] ℹ️  Diagnosis codes being written:
[16:12:29] [DOC: 9265854] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:12:29] [DOC: 9265854] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:12:29] [DOC: 9265854] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:12:29] [DOC: 9265854] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:12:29] [DOC: 9265854] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:12:29] [DOC: 9265854] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:12:29] [DOC: 9265854] ✅ Patient data written to CSV: Betty Mendonca | Sex: FEMALE | Age: 77 | Service: RN, LPN | Payer: Medicare | MRN: 5662015
[16:12:29] ✅    ✅ Document 9265854 processed and saved successfully
[16:12:29] 🔄 
🔄 Step 8: Saving API details...
[16:12:29] [DOC: 9265854] ℹ️  API push details saved for document 9265854
[16:12:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265832                         ║
================================================================================
[16:12:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[16:12:29] ℹ️  Date: 04/29/2025
[16:12:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:12:32] [DOC: 9265832] ✅ Text extracted using pdfplumber (13675 chars)
[16:12:32] ✅    ✅ Text extracted using pdfplumber (13675 chars)
[16:12:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:12:35] ℹ️  AI extracted raw sex value: ''
[16:12:35] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:12:35] ℹ️  AI extracted payer source: ''
[16:12:35] ℹ️  AI extracted diagnoses:
[16:12:35] ℹ️    - Diagnosis 1: 'M6259'
[16:12:35] ℹ️    - Diagnosis 2: 'R270'
[16:12:35] ℹ️    - Diagnosis 3: ''
[16:12:35] ℹ️    - Diagnosis 4: ''
[16:12:35] ℹ️    - Diagnosis 5: ''
[16:12:35] ℹ️    - Diagnosis 6: ''
[16:12:35] ℹ️  Final extracted MRN: 'MA221116116005'
[16:12:35] ℹ️  Final extracted Sex: ''
[16:12:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:12:35] ℹ️  Final extracted Payer Source: ''
[16:12:35] ✅ Patient data extraction completed successfully
[16:12:35] ✅    ✅ Patient data extracted successfully
[16:12:35] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'M6259', 'secondDiagnosis': 'R270', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:35] ✅    ✅ Patient identified: Kelly Medeiros
[16:12:35] ✅    ✅ Patient name validation passed
[16:12:35] 🔄 
🔄 Step 3: Processing patient dates...
[16:12:35] [DOC: 9265832] ℹ️  DOB normalized: 11/23/1960
[16:12:35] [DOC: 9265832] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[16:12:35] [DOC: 9265832] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[16:12:35] [DOC: 9265832] ✅ Patient date processing completed successfully
[16:12:35] ✅    ✅ Date processing completed
[16:12:35] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'M6259', 'secondDiagnosis': 'R270', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:35] 🔄 
🔄 Step 4: Extracting order data...
[16:12:37] ℹ️  Order extraction - MRN: 'MA221116116005'
[16:12:37] ℹ️  Order extraction - Sex: ''
[16:12:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:12:37] ℹ️  Order extraction - Payer Source: ''
[16:12:37] ✅ Order data extraction completed successfully
[16:12:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:12:37] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[16:12:37] ⚠️  Could not determine sex using any available method
[16:12:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:12:37] ✅ Patient name cross-validation successful
[16:12:37] ✅    ✅ Data merged successfully
[16:12:38] ✅    ✅ Order data extracted and validated
[16:12:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:44] [DOC: 9265832] ℹ️  Patient not found in cache or API: Kelly Medeiros
[16:12:44] [DOC: 9265832] ℹ️  Patient not found, creating new patient via API...
[16:12:44] [DOC: 9265832] ℹ️  Creating patient via API: Kelly Medeiros
[16:12:45] [DOC: 9265832] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:12:45] ❌    ❌ Failed to create patient
[16:12:45] [DOC: 9265832] ℹ️  API push details saved for document 9265832
================================================================================
║                        Processing Document ID: 9265808                         ║
================================================================================
[16:12:45] ℹ️  Agency: All At Home Health Care-Allston
[16:12:45] ℹ️  Date: 04/29/2025
[16:12:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:12:47] [DOC: 9265808] ✅ Text extracted using pdfplumber (2104 chars)
[16:12:47] ✅    ✅ Text extracted using pdfplumber (2104 chars)
[16:12:47] 🔄 
🔄 Step 2: Extracting patient data...
[16:12:50] ℹ️  AI extracted raw sex value: ''
[16:12:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:12:50] ℹ️  AI extracted payer source: ''
[16:12:50] ℹ️  AI extracted diagnoses:
[16:12:50] ℹ️    - Diagnosis 1: ''
[16:12:50] ℹ️    - Diagnosis 2: ''
[16:12:50] ℹ️    - Diagnosis 3: ''
[16:12:50] ℹ️    - Diagnosis 4: ''
[16:12:50] ℹ️    - Diagnosis 5: ''
[16:12:50] ℹ️    - Diagnosis 6: ''
[16:12:50] ℹ️  Final extracted MRN: ''
[16:12:50] ℹ️  Final extracted Sex: ''
[16:12:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:12:50] ℹ️  Final extracted Payer Source: ''
[16:12:50] ✅ Patient data extraction completed successfully
[16:12:50] ✅    ✅ Patient data extracted successfully
[16:12:50] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Richardson
     └─ dob: 05/03/1955
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Colm McCarthy, MD
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (508) 933-4956
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:50] ✅    ✅ Patient identified: David Richardson
[16:12:50] ✅    ✅ Patient name validation passed
[16:12:50] 🔄 
🔄 Step 3: Processing patient dates...
[16:12:50] [DOC: 9265808] ℹ️  DOB normalized: 05/03/1955
[16:12:50] [DOC: 9265808] ℹ️  Episode startOfCare normalized: 04/25/2025
[16:12:50] [DOC: 9265808] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[16:12:50] [DOC: 9265808] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[16:12:50] [DOC: 9265808] ✅ Patient date processing completed successfully
[16:12:50] ✅    ✅ Date processing completed
[16:12:50] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Richardson
     └─ dob: 05/03/1955
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Colm McCarthy, MD
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (508) 933-4956
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:12:50] 🔄 
🔄 Step 4: Extracting order data...
[16:12:53] ℹ️  Order extraction - MRN: ''
[16:12:53] ℹ️  Order extraction - Sex: ''
[16:12:53] ℹ️  Order extraction - Service Line: 'SN'
[16:12:53] ℹ️  Order extraction - Payer Source: ''
[16:12:53] ✅ Order data extraction completed successfully
[16:12:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:12:53] ⚠️  No MRN found in either patient or order data
[16:12:53] ℹ️  Inferred sex as MALE from name: David
[16:12:53] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[16:12:53] ✅ Patient name cross-validation successful
[16:12:53] ✅    ✅ Data merged successfully
[16:12:57] ✅    ✅ Order data extracted and validated
[16:12:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:12:57] [DOC: 9265808] ✅ Patient found in local cache: David Richardson, ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[16:12:57] ✅    ✅ Existing patient found with ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[16:12:57] 🔄 
🔄 Step 6: Pushing order to API...
[16:12:57] [DOC: 9265808] ℹ️  Pushing order via API for patient ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[16:12:58] [DOC: 9265808] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:12:58] ❌    ❌ Failed to push order
[16:12:58] 🔄 
🔄 Step 7: Writing to CSV...
[16:12:58] [DOC: 9265808] ℹ️  Calculated age: 70 from DOB: 05/03/1955
[16:12:58] [DOC: 9265808] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[16:12:58] [DOC: 9265808] ℹ️  Payer Source extracted: ''
[16:12:58] [DOC: 9265808] ℹ️  Diagnosis codes being written:
[16:12:58] [DOC: 9265808] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:12:58] [DOC: 9265808] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:12:58] [DOC: 9265808] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:12:58] [DOC: 9265808] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:12:58] [DOC: 9265808] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:12:58] [DOC: 9265808] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:12:58] [DOC: 9265808] ✅ Patient data written to CSV: David Richardson | Sex: MALE | Age: 70 | Service: SN, Skilled Nursing | Payer:  | MRN: 
[16:12:58] ✅    ✅ Document 9265808 processed and saved successfully
[16:12:58] 🔄 
🔄 Step 8: Saving API details...
[16:12:58] [DOC: 9265808] ℹ️  API push details saved for document 9265808
[16:12:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265805                         ║
================================================================================
[16:12:58] ℹ️  Agency: All At Home Health Care-Allston
[16:12:58] ℹ️  Date: 04/29/2025
[16:12:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:01] [DOC: 9265805] ✅ Text extracted using pdfplumber (22240 chars)
[16:13:01] ✅    ✅ Text extracted using pdfplumber (22240 chars)
[16:13:01] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:05] ℹ️  AI extracted raw sex value: 'M'
[16:13:05] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[16:13:05] ℹ️  AI extracted payer source: ''
[16:13:05] ℹ️  AI extracted diagnoses:
[16:13:05] ℹ️    - Diagnosis 1: 'Z47.1'
[16:13:05] ℹ️    - Diagnosis 2: 'I12.9'
[16:13:05] ℹ️    - Diagnosis 3: 'N18.30'
[16:13:05] ℹ️    - Diagnosis 4: 'J44.9'
[16:13:05] ℹ️    - Diagnosis 5: 'Z96.642'
[16:13:05] ℹ️    - Diagnosis 6: 'Z79.82'
[16:13:05] ℹ️  Final extracted MRN: '1822'
[16:13:05] ℹ️  Final extracted Sex: 'MALE'
[16:13:05] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[16:13:05] ℹ️  Final extracted Payer Source: ''
[16:13:05] ✅ Patient data extraction completed successfully
[16:13:05] ✅    ✅ Patient data extracted successfully
[16:13:05] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Richardson
     └─ dob: 05/03/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 1822
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 458 Maxfield St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 933-4956
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.30', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'Z96.642', 'sixthDiagnosis': 'Z79.82'}]
[16:13:05] ✅    ✅ Patient identified: David Richardson
[16:13:05] ✅    ✅ Patient name validation passed
[16:13:05] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:05] [DOC: 9265805] ℹ️  DOB normalized: 05/03/1955
[16:13:05] [DOC: 9265805] ℹ️  Episode startOfCare normalized: 04/25/2025
[16:13:05] [DOC: 9265805] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[16:13:05] [DOC: 9265805] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[16:13:05] [DOC: 9265805] ✅ Patient date processing completed successfully
[16:13:05] ✅    ✅ Date processing completed
[16:13:05] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Richardson
     └─ dob: 05/03/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 1822
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 458 Maxfield St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 933-4956
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.30', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'Z96.642', 'sixthDiagnosis': 'Z79.82'}]
[16:13:05] 🔄 
🔄 Step 4: Extracting order data...
[16:13:08] ℹ️  Order extraction - MRN: '1822'
[16:13:08] ℹ️  Order extraction - Sex: 'MALE'
[16:13:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[16:13:08] ℹ️  Order extraction - Payer Source: ''
[16:13:08] ✅ Order data extraction completed successfully
[16:13:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:08] ℹ️  Using MRN from patient data: '1822' over '1822'
[16:13:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[16:13:08] ✅ Patient name cross-validation successful
[16:13:08] ✅    ✅ Data merged successfully
[16:13:09] ✅    ✅ Order data extracted and validated
[16:13:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:09] [DOC: 9265805] ✅ Patient found in local cache: David Richardson, ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[16:13:09] ✅    ✅ Existing patient found with ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[16:13:09] 🔄 
🔄 Step 6: Pushing order to API...
[16:13:09] [DOC: 9265805] ℹ️  Pushing order via API for patient ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[16:13:10] [DOC: 9265805] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:13:10] ❌    ❌ Failed to push order
[16:13:10] 🔄 
🔄 Step 7: Writing to CSV...
[16:13:10] [DOC: 9265805] ℹ️  Calculated age: 70 from DOB: 05/03/1955
[16:13:10] [DOC: 9265805] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[16:13:10] [DOC: 9265805] ℹ️  Payer Source extracted: ''
[16:13:10] [DOC: 9265805] ℹ️  Diagnosis codes being written:
[16:13:10] [DOC: 9265805] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[16:13:10] [DOC: 9265805] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[16:13:10] [DOC: 9265805] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.30'
[16:13:10] [DOC: 9265805] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[16:13:10] [DOC: 9265805] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z96.642'
[16:13:10] [DOC: 9265805] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z79.82'
[16:13:10] [DOC: 9265805] ✅ Patient data written to CSV: David Richardson | Sex: MALE | Age: 70 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 1822
[16:13:10] ✅    ✅ Document 9265805 processed and saved successfully
[16:13:10] 🔄 
🔄 Step 8: Saving API details...
[16:13:10] [DOC: 9265805] ℹ️  API push details saved for document 9265805
[16:13:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265783                         ║
================================================================================
[16:13:10] ℹ️  Agency: Dartmouth HH
[16:13:10] ℹ️  Date: 04/29/2025
[16:13:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:12] [DOC: 9265783] ✅ Text extracted using pdfplumber (1264 chars)
[16:13:12] ✅    ✅ Text extracted using pdfplumber (1264 chars)
[16:13:12] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:14] ℹ️  AI extracted raw sex value: 'F'
[16:13:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:13:14] ℹ️  AI extracted payer source: 'Medicare'
[16:13:14] ℹ️  AI extracted diagnoses:
[16:13:14] ℹ️    - Diagnosis 1: 'None'
[16:13:14] ℹ️    - Diagnosis 2: 'None'
[16:13:14] ℹ️    - Diagnosis 3: 'None'
[16:13:14] ℹ️    - Diagnosis 4: 'None'
[16:13:14] ℹ️    - Diagnosis 5: 'None'
[16:13:14] ℹ️    - Diagnosis 6: 'None'
[16:13:14] ℹ️  Final extracted MRN: '1033009'
[16:13:14] ℹ️  Final extracted Sex: 'FEMALE'
[16:13:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:13:14] ℹ️  Final extracted Payer Source: 'Medicare'
[16:13:14] ✅ Patient data extraction completed successfully
[16:13:14] ✅    ✅ Patient data extracted successfully
[16:13:14] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1341 Ashley Boulevard
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:13:14] ✅    ✅ Patient identified: Irene Gauthier
[16:13:14] ✅    ✅ Patient name validation passed
[16:13:14] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:14] [DOC: 9265783] ℹ️  DOB normalized: 05/12/1942
[16:13:14] [DOC: 9265783] ℹ️  Episode startOfCare normalized: 08/20/2024
[16:13:14] [DOC: 9265783] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[16:13:14] [DOC: 9265783] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[16:13:14] [DOC: 9265783] ✅ Patient date processing completed successfully
[16:13:14] ✅    ✅ Date processing completed
[16:13:14] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1341 Ashley Boulevard
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025'}]
[16:13:14] 🔄 
🔄 Step 4: Extracting order data...
[16:13:17] ℹ️  Order extraction - MRN: '1033009'
[16:13:17] ℹ️  Order extraction - Sex: 'FEMALE'
[16:13:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:13:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:13:17] ✅ Order data extraction completed successfully
[16:13:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:17] ℹ️  Using MRN from patient data: '1033009' over '1033009'
[16:13:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:13:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:13:17] ✅ Patient name cross-validation successful
[16:13:17] ✅    ✅ Data merged successfully
[16:13:18] ✅    ✅ Order data extracted and validated
[16:13:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:25] [DOC: 9265783] ✅ Patient exists in API: Irene Gauthier, ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:13:25] ✅    ✅ Existing patient found with ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:13:25] 🔄 
🔄 Step 6: Pushing order to API...
[16:13:25] [DOC: 9265783] ℹ️  Pushing order via API for patient ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:13:26] [DOC: 9265783] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:13:26] ❌    ❌ Failed to push order
[16:13:26] 🔄 
🔄 Step 7: Writing to CSV...
[16:13:26] [DOC: 9265783] ℹ️  Calculated age: 83 from DOB: 05/12/1942
[16:13:26] [DOC: 9265783] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:13:26] [DOC: 9265783] ℹ️  Payer Source extracted: 'Medicare'
[16:13:26] [DOC: 9265783] ℹ️  Diagnosis codes being written:
[16:13:26] [DOC: 9265783] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:13:26] [DOC: 9265783] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:13:26] [DOC: 9265783] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:13:26] [DOC: 9265783] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:13:26] [DOC: 9265783] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:13:26] [DOC: 9265783] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:13:26] [DOC: 9265783] ✅ Patient data written to CSV: Irene Gauthier | Sex: FEMALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 1033009
[16:13:26] ✅    ✅ Document 9265783 processed and saved successfully
[16:13:26] 🔄 
🔄 Step 8: Saving API details...
[16:13:26] [DOC: 9265783] ℹ️  API push details saved for document 9265783
[16:13:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265782                         ║
================================================================================
[16:13:26] ℹ️  Agency: Dartmouth HH
[16:13:26] ℹ️  Date: 04/29/2025
[16:13:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:28] [DOC: 9265782] ✅ Text extracted using pdfplumber (1250 chars)
[16:13:28] ✅    ✅ Text extracted using pdfplumber (1250 chars)
[16:13:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:31] ℹ️  AI extracted raw sex value: 'F'
[16:13:31] ℹ️  AI extracted service line: 'HHA'
[16:13:31] ℹ️  AI extracted payer source: 'Medicare'
[16:13:31] ℹ️  AI extracted diagnoses:
[16:13:31] ℹ️    - Diagnosis 1: 'None'
[16:13:31] ℹ️    - Diagnosis 2: 'None'
[16:13:31] ℹ️    - Diagnosis 3: 'None'
[16:13:31] ℹ️    - Diagnosis 4: 'None'
[16:13:31] ℹ️    - Diagnosis 5: 'None'
[16:13:31] ℹ️    - Diagnosis 6: 'None'
[16:13:31] ℹ️  Final extracted MRN: '1033009'
[16:13:31] ℹ️  Final extracted Sex: 'FEMALE'
[16:13:31] ℹ️  Final extracted Service Line: 'HHA'
[16:13:31] ℹ️  Final extracted Payer Source: 'Medicare'
[16:13:31] ✅ Patient data extraction completed successfully
[16:13:31] ✅    ✅ Patient data extracted successfully
[16:13:31] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1341 Ashley Boulevard
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:13:31] ✅    ✅ Patient identified: Irene Gauthier
[16:13:31] ✅    ✅ Patient name validation passed
[16:13:31] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:31] [DOC: 9265782] ℹ️  DOB normalized: 05/12/1942
[16:13:31] [DOC: 9265782] ℹ️  Episode startOfCare normalized: 08/20/2024
[16:13:31] [DOC: 9265782] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[16:13:31] [DOC: 9265782] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[16:13:31] [DOC: 9265782] ✅ Patient date processing completed successfully
[16:13:31] ✅    ✅ Date processing completed
[16:13:31] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Gauthier
     └─ dob: 05/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1033009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1341 Ashley Boulevard
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/20/2024', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '04/16/2025'}]
[16:13:31] 🔄 
🔄 Step 4: Extracting order data...
[16:13:33] ℹ️  Order extraction - MRN: ''
[16:13:33] ℹ️  Order extraction - Sex: 'FEMALE'
[16:13:33] ℹ️  Order extraction - Service Line: 'HHA'
[16:13:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:13:33] ✅ Order data extraction completed successfully
[16:13:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:33] ℹ️  Using MRN from patient data: '1033009'
[16:13:33] ℹ️  Service line consistent in both sources: 'HHA'
[16:13:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:13:33] ✅ Patient name cross-validation successful
[16:13:33] ✅    ✅ Data merged successfully
[16:13:34] ✅    ✅ Order data extracted and validated
[16:13:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:34] [DOC: 9265782] ✅ Patient found in local cache: Irene Gauthier, ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:13:34] ✅    ✅ Existing patient found with ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:13:34] 🔄 
🔄 Step 6: Pushing order to API...
[16:13:34] [DOC: 9265782] ℹ️  Pushing order via API for patient ID: 7960ccf2-0abf-4c03-8efc-88df1aa249e6
[16:13:36] [DOC: 9265782] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13776"}
[16:13:36] ❌    ❌ Failed to push order
[16:13:36] 🔄 
🔄 Step 7: Writing to CSV...
[16:13:36] [DOC: 9265782] ℹ️  Calculated age: 83 from DOB: 05/12/1942
[16:13:36] [DOC: 9265782] ℹ️  Service Line extracted: 'HHA'
[16:13:36] [DOC: 9265782] ℹ️  Payer Source extracted: 'Medicare'
[16:13:36] [DOC: 9265782] ℹ️  Diagnosis codes being written:
[16:13:36] [DOC: 9265782] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:13:36] [DOC: 9265782] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:13:36] [DOC: 9265782] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:13:36] [DOC: 9265782] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:13:36] [DOC: 9265782] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:13:36] [DOC: 9265782] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:13:36] [DOC: 9265782] ✅ Patient data written to CSV: Irene Gauthier | Sex: FEMALE | Age: 83 | Service: HHA | Payer: Medicare | MRN: 1033009
[16:13:36] ✅    ✅ Document 9265782 processed and saved successfully
[16:13:36] 🔄 
🔄 Step 8: Saving API details...
[16:13:36] [DOC: 9265782] ℹ️  API push details saved for document 9265782
[16:13:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265776                         ║
================================================================================
[16:13:36] ℹ️  Agency: Dartmouth HH
[16:13:36] ℹ️  Date: 04/29/2025
[16:13:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:37] [DOC: 9265776] ✅ Text extracted using pdfplumber (1747 chars)
[16:13:37] ✅    ✅ Text extracted using pdfplumber (1747 chars)
[16:13:37] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:40] ℹ️  AI extracted raw sex value: 'F'
[16:13:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:13:40] ℹ️  AI extracted payer source: 'Medicare'
[16:13:40] ℹ️  AI extracted diagnoses:
[16:13:40] ℹ️    - Diagnosis 1: ''
[16:13:40] ℹ️    - Diagnosis 2: ''
[16:13:40] ℹ️    - Diagnosis 3: ''
[16:13:40] ℹ️    - Diagnosis 4: ''
[16:13:40] ℹ️    - Diagnosis 5: ''
[16:13:40] ℹ️    - Diagnosis 6: ''
[16:13:40] ℹ️  Final extracted MRN: '5025015'
[16:13:40] ℹ️  Final extracted Sex: 'FEMALE'
[16:13:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:13:40] ℹ️  Final extracted Payer Source: 'Medicare'
[16:13:40] ✅ Patient data extraction completed successfully
[16:13:40] ✅    ✅ Patient data extracted successfully
[16:13:40] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Harrington
     └─ dob: 09/29/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5025015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:13:40] ✅    ✅ Patient identified: Lorraine Harrington
[16:13:40] ✅    ✅ Patient name validation passed
[16:13:40] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:40] [DOC: 9265776] ℹ️  DOB normalized: 09/29/1940
[16:13:40] [DOC: 9265776] ℹ️  Episode startOfCare normalized: 02/28/2025
[16:13:40] [DOC: 9265776] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[16:13:40] [DOC: 9265776] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[16:13:40] [DOC: 9265776] ✅ Patient date processing completed successfully
[16:13:40] ✅    ✅ Date processing completed
[16:13:40] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Harrington
     └─ dob: 09/29/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5025015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:13:40] 🔄 
🔄 Step 4: Extracting order data...
[16:13:43] ℹ️  Order extraction - MRN: ''
[16:13:43] ℹ️  Order extraction - Sex: 'FEMALE'
[16:13:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:13:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:13:43] ✅ Order data extraction completed successfully
[16:13:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:13:43] ℹ️  Using MRN from patient data: '5025015'
[16:13:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:13:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:13:43] ✅ Patient name cross-validation successful
[16:13:43] ✅    ✅ Data merged successfully
[16:13:44] ✅    ✅ Order data extracted and validated
[16:13:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:13:53] [DOC: 9265776] ℹ️  Patient not found in cache or API: Lorraine Harrington
[16:13:54] [DOC: 9265776] ℹ️  Patient not found, creating new patient via API...
[16:13:54] [DOC: 9265776] ℹ️  Creating patient via API: Lorraine Harrington
[16:13:55] [DOC: 9265776] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:13:55] ❌    ❌ Failed to create patient
[16:13:55] [DOC: 9265776] ℹ️  API push details saved for document 9265776
================================================================================
║                        Processing Document ID: 9265774                         ║
================================================================================
[16:13:55] ℹ️  Agency: Dartmouth HH
[16:13:55] ℹ️  Date: 04/29/2025
[16:13:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:13:57] [DOC: 9265774] ✅ Text extracted using pdfplumber (1916 chars)
[16:13:57] ✅    ✅ Text extracted using pdfplumber (1916 chars)
[16:13:57] 🔄 
🔄 Step 2: Extracting patient data...
[16:13:59] ℹ️  AI extracted raw sex value: 'F'
[16:13:59] ℹ️  AI extracted service line: 'RN'
[16:13:59] ℹ️  AI extracted payer source: 'United Health Care'
[16:13:59] ℹ️  AI extracted diagnoses:
[16:13:59] ℹ️    - Diagnosis 1: ''
[16:13:59] ℹ️    - Diagnosis 2: ''
[16:13:59] ℹ️    - Diagnosis 3: ''
[16:13:59] ℹ️    - Diagnosis 4: ''
[16:13:59] ℹ️    - Diagnosis 5: ''
[16:13:59] ℹ️    - Diagnosis 6: ''
[16:13:59] ℹ️  Final extracted MRN: '6024015'
[16:13:59] ℹ️  Final extracted Sex: 'FEMALE'
[16:13:59] ℹ️  Final extracted Service Line: 'RN'
[16:13:59] ℹ️  Final extracted Payer Source: 'United Health Care'
[16:13:59] ✅ Patient data extraction completed successfully
[16:13:59] ✅    ✅ Patient data extracted successfully
[16:13:59] 📊 Patient Response
     └─ patientFName: Martha
     └─ patientLName: Muldoon
     └─ dob: 05/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6024015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 35 Willis St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:13:59] ✅    ✅ Patient identified: Martha Muldoon
[16:13:59] ✅    ✅ Patient name validation passed
[16:13:59] 🔄 
🔄 Step 3: Processing patient dates...
[16:13:59] [DOC: 9265774] ℹ️  DOB normalized: 05/14/1952
[16:13:59] [DOC: 9265774] ℹ️  Episode startOfCare normalized: 03/31/2025
[16:13:59] [DOC: 9265774] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[16:13:59] [DOC: 9265774] ✅ Patient date processing completed successfully
[16:13:59] ✅    ✅ Date processing completed
[16:13:59] 📊 Processed Patient Data
     └─ patientFName: Martha
     └─ patientLName: Muldoon
     └─ dob: 05/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6024015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 35 Willis St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:13:59] 🔄 
🔄 Step 4: Extracting order data...
[16:14:02] ℹ️  Order extraction - MRN: '6024015'
[16:14:02] ℹ️  Order extraction - Sex: 'FEMALE'
[16:14:02] ℹ️  Order extraction - Service Line: 'RN'
[16:14:02] ℹ️  Order extraction - Payer Source: 'United Health Care'
[16:14:02] ✅ Order data extraction completed successfully
[16:14:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:02] ℹ️  Using MRN from patient data: '6024015' over '6024015'
[16:14:02] ℹ️  Service line consistent in both sources: 'RN'
[16:14:02] ℹ️  Payer source consistent in both sources: 'United Health Care'
[16:14:02] ✅ Patient name cross-validation successful
[16:14:02] ✅    ✅ Data merged successfully
[16:14:03] ✅    ✅ Order data extracted and validated
[16:14:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:14:08] [DOC: 9265774] ℹ️  Patient not found in cache or API: Martha Muldoon
[16:14:08] [DOC: 9265774] ℹ️  Patient not found, creating new patient via API...
[16:14:08] [DOC: 9265774] ℹ️  Creating patient via API: Martha Muldoon
[16:14:09] [DOC: 9265774] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:14:09] ❌    ❌ Failed to create patient
[16:14:09] [DOC: 9265774] ℹ️  API push details saved for document 9265774
================================================================================
║                        Processing Document ID: 9265773                         ║
================================================================================
[16:14:09] ℹ️  Agency: Dartmouth HH
[16:14:09] ℹ️  Date: 04/29/2025
[16:14:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:14:11] [DOC: 9265773] ✅ Text extracted using pdfplumber (4495 chars)
[16:14:11] ✅    ✅ Text extracted using pdfplumber (4495 chars)
[16:14:11] 🔄 
🔄 Step 2: Extracting patient data...
[16:14:14] ℹ️  AI extracted raw sex value: 'F'
[16:14:14] ℹ️  AI extracted service line: 'PT'
[16:14:14] ℹ️  AI extracted payer source: 'Fallon Navicare'
[16:14:14] ℹ️  AI extracted diagnoses:
[16:14:14] ℹ️    - Diagnosis 1: ''
[16:14:14] ℹ️    - Diagnosis 2: ''
[16:14:14] ℹ️    - Diagnosis 3: ''
[16:14:14] ℹ️    - Diagnosis 4: ''
[16:14:14] ℹ️    - Diagnosis 5: ''
[16:14:14] ℹ️    - Diagnosis 6: ''
[16:14:14] ℹ️  Final extracted MRN: '6149015'
[16:14:14] ℹ️  Final extracted Sex: 'FEMALE'
[16:14:14] ℹ️  Final extracted Service Line: 'PT'
[16:14:14] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[16:14:14] ✅ Patient data extraction completed successfully
[16:14:14] ✅    ✅ Patient data extracted successfully
[16:14:14] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:14] ✅    ✅ Patient identified: Margaret Rapoza
[16:14:14] ✅    ✅ Patient name validation passed
[16:14:14] 🔄 
🔄 Step 3: Processing patient dates...
[16:14:14] [DOC: 9265773] ℹ️  DOB normalized: 05/05/1936
[16:14:14] [DOC: 9265773] ℹ️  Episode startOfCare normalized: 03/06/2025
[16:14:14] [DOC: 9265773] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[16:14:14] [DOC: 9265773] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[16:14:14] [DOC: 9265773] ✅ Patient date processing completed successfully
[16:14:14] ✅    ✅ Date processing completed
[16:14:14] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rapoza
     └─ dob: 05/05/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6149015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:14] 🔄 
🔄 Step 4: Extracting order data...
[16:14:16] ℹ️  Order extraction - MRN: '6149015'
[16:14:16] ℹ️  Order extraction - Sex: 'FEMALE'
[16:14:16] ℹ️  Order extraction - Service Line: 'PT'
[16:14:16] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[16:14:16] ✅ Order data extraction completed successfully
[16:14:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:16] ℹ️  Using MRN from patient data: '6149015' over '6149015'
[16:14:16] ℹ️  Service line consistent in both sources: 'PT'
[16:14:16] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[16:14:16] ✅ Patient name cross-validation successful
[16:14:16] ✅    ✅ Data merged successfully
[16:14:17] ✅    ✅ Order data extracted and validated
[16:14:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:14:25] [DOC: 9265773] ✅ Patient exists in API: Margaret Rapoza, ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[16:14:25] ✅    ✅ Existing patient found with ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[16:14:25] 🔄 
🔄 Step 6: Pushing order to API...
[16:14:25] [DOC: 9265773] ℹ️  Pushing order via API for patient ID: b453daf5-a00a-4b0b-90bf-47d14191186a
[16:14:26] [DOC: 9265773] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:14:26] ❌    ❌ Failed to push order
[16:14:26] 🔄 
🔄 Step 7: Writing to CSV...
[16:14:26] [DOC: 9265773] ℹ️  Calculated age: 89 from DOB: 05/05/1936
[16:14:26] [DOC: 9265773] ℹ️  Service Line extracted: 'PT'
[16:14:26] [DOC: 9265773] ℹ️  Payer Source extracted: 'Fallon Navicare'
[16:14:26] [DOC: 9265773] ℹ️  Diagnosis codes being written:
[16:14:26] [DOC: 9265773] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:14:26] [DOC: 9265773] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:14:26] [DOC: 9265773] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:14:26] [DOC: 9265773] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:14:26] [DOC: 9265773] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:14:26] [DOC: 9265773] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:14:26] [DOC: 9265773] ✅ Patient data written to CSV: Margaret Rapoza | Sex: FEMALE | Age: 89 | Service: PT | Payer: Fallon Navicare | MRN: 6149015
[16:14:26] ✅    ✅ Document 9265773 processed and saved successfully
[16:14:26] 🔄 
🔄 Step 8: Saving API details...
[16:14:26] [DOC: 9265773] ℹ️  API push details saved for document 9265773
[16:14:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265770                         ║
================================================================================
[16:14:26] ℹ️  Agency: Dartmouth HH
[16:14:26] ℹ️  Date: 04/29/2025
[16:14:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:14:28] [DOC: 9265770] ✅ Text extracted using pdfplumber (4721 chars)
[16:14:28] ✅    ✅ Text extracted using pdfplumber (4721 chars)
[16:14:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:14:31] ℹ️  AI extracted raw sex value: 'F'
[16:14:31] ℹ️  AI extracted service line: 'Physical Therapy'
[16:14:31] ℹ️  AI extracted payer source: 'Senior Whole Health'
[16:14:31] ℹ️  AI extracted diagnoses:
[16:14:31] ℹ️    - Diagnosis 1: ''
[16:14:31] ℹ️    - Diagnosis 2: ''
[16:14:31] ℹ️    - Diagnosis 3: ''
[16:14:31] ℹ️    - Diagnosis 4: ''
[16:14:31] ℹ️    - Diagnosis 5: ''
[16:14:31] ℹ️    - Diagnosis 6: ''
[16:14:31] ℹ️  Final extracted MRN: '5610015'
[16:14:31] ℹ️  Final extracted Sex: 'FEMALE'
[16:14:31] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:14:31] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[16:14:31] ✅ Patient data extraction completed successfully
[16:14:31] ✅    ✅ Patient data extracted successfully
[16:14:31] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Miranda
     └─ dob: 02/19/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5610015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:31] ✅    ✅ Patient identified: Elaine Miranda
[16:14:31] ✅    ✅ Patient name validation passed
[16:14:31] 🔄 
🔄 Step 3: Processing patient dates...
[16:14:31] [DOC: 9265770] ℹ️  DOB normalized: 02/19/1959
[16:14:31] [DOC: 9265770] ℹ️  Episode startOfCare normalized: 03/25/2025
[16:14:31] [DOC: 9265770] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[16:14:31] [DOC: 9265770] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[16:14:31] [DOC: 9265770] ✅ Patient date processing completed successfully
[16:14:31] ✅    ✅ Date processing completed
[16:14:31] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Miranda
     └─ dob: 02/19/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5610015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:14:31] 🔄 
🔄 Step 4: Extracting order data...
[16:14:33] ℹ️  Order extraction - MRN: ''
[16:14:33] ℹ️  Order extraction - Sex: 'FEMALE'
[16:14:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[16:14:33] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[16:14:33] ✅ Order data extraction completed successfully
[16:14:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:33] ℹ️  Using MRN from patient data: '5610015'
[16:14:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[16:14:33] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[16:14:33] ✅ Patient name cross-validation successful
[16:14:33] ✅    ✅ Data merged successfully
[16:14:35] ✅    ✅ Order data extracted and validated
[16:14:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:14:43] [DOC: 9265770] ✅ Patient exists in API: Elaine Miranda, ID: 68c9da11-eed8-438a-a027-146bf04743d0
[16:14:43] ✅    ✅ Existing patient found with ID: 68c9da11-eed8-438a-a027-146bf04743d0
[16:14:43] 🔄 
🔄 Step 6: Pushing order to API...
[16:14:43] [DOC: 9265770] ℹ️  Pushing order via API for patient ID: 68c9da11-eed8-438a-a027-146bf04743d0
[16:14:44] [DOC: 9265770] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:14:44] ❌    ❌ Failed to push order
[16:14:44] 🔄 
🔄 Step 7: Writing to CSV...
[16:14:44] [DOC: 9265770] ℹ️  Calculated age: 66 from DOB: 02/19/1959
[16:14:44] [DOC: 9265770] ℹ️  Service Line extracted: 'Physical Therapy'
[16:14:44] [DOC: 9265770] ℹ️  Payer Source extracted: 'Senior Whole Health'
[16:14:44] [DOC: 9265770] ℹ️  Diagnosis codes being written:
[16:14:44] [DOC: 9265770] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:14:44] [DOC: 9265770] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:14:44] [DOC: 9265770] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:14:44] [DOC: 9265770] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:14:44] [DOC: 9265770] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:14:44] [DOC: 9265770] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:14:44] [DOC: 9265770] ✅ Patient data written to CSV: Elaine Miranda | Sex: FEMALE | Age: 66 | Service: Physical Therapy | Payer: Senior Whole Health | MRN: 5610015
[16:14:44] ✅    ✅ Document 9265770 processed and saved successfully
[16:14:44] 🔄 
🔄 Step 8: Saving API details...
[16:14:44] [DOC: 9265770] ℹ️  API push details saved for document 9265770
[16:14:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265768                         ║
================================================================================
[16:14:44] ℹ️  Agency: Dartmouth HH
[16:14:44] ℹ️  Date: 04/29/2025
[16:14:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:14:46] [DOC: 9265768] ✅ Text extracted using pdfplumber (10014 chars)
[16:14:46] ✅    ✅ Text extracted using pdfplumber (10014 chars)
[16:14:46] 🔄 
🔄 Step 2: Extracting patient data...
[16:14:49] ℹ️  AI extracted raw sex value: 'F'
[16:14:49] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[16:14:49] ℹ️  AI extracted payer source: 'None'
[16:14:49] ℹ️  AI extracted diagnoses:
[16:14:49] ℹ️    - Diagnosis 1: 'K57.20'
[16:14:49] ℹ️    - Diagnosis 2: 'G35'
[16:14:49] ℹ️    - Diagnosis 3: 'D86.9'
[16:14:49] ℹ️    - Diagnosis 4: 'E03.9'
[16:14:49] ℹ️    - Diagnosis 5: 'E78.5'
[16:14:49] ℹ️    - Diagnosis 6: 'G47.00'
[16:14:49] ℹ️  Final extracted MRN: '227027'
[16:14:49] ℹ️  Final extracted Sex: 'FEMALE'
[16:14:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[16:14:49] ℹ️  Final extracted Payer Source: ''
[16:14:49] ✅ Patient data extraction completed successfully
[16:14:49] ✅    ✅ Patient data extracted successfully
[16:14:49] 📊 Patient Response
     └─ patientFName: Martha
     └─ patientLName: Muldoon
     └─ dob: 05/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'K57.20', 'secondDiagnosis': 'G35', 'thirdDiagnosis': 'D86.9', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'G47.00'}]
[16:14:49] ✅    ✅ Patient identified: Martha Muldoon
[16:14:49] ✅    ✅ Patient name validation passed
[16:14:49] 🔄 
🔄 Step 3: Processing patient dates...
[16:14:49] [DOC: 9265768] ℹ️  DOB normalized: 05/14/1952
[16:14:49] [DOC: 9265768] ℹ️  Episode startOfCare normalized: 03/31/2025
[16:14:49] [DOC: 9265768] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[16:14:49] [DOC: 9265768] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[16:14:49] [DOC: 9265768] ✅ Patient date processing completed successfully
[16:14:49] ✅    ✅ Date processing completed
[16:14:49] 📊 Processed Patient Data
     └─ patientFName: Martha
     └─ patientLName: Muldoon
     └─ dob: 05/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'K57.20', 'secondDiagnosis': 'G35', 'thirdDiagnosis': 'D86.9', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'G47.00'}]
[16:14:49] 🔄 
🔄 Step 4: Extracting order data...
[16:14:52] ℹ️  Order extraction - MRN: '6024015'
[16:14:52] ℹ️  Order extraction - Sex: 'FEMALE'
[16:14:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[16:14:52] ℹ️  Order extraction - Payer Source: ''
[16:14:52] ✅ Order data extraction completed successfully
[16:14:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:14:52] ℹ️  Using longer MRN from order data: '6024015' over '227027'
[16:14:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[16:14:52] ✅ Patient name cross-validation successful
[16:14:52] ✅    ✅ Data merged successfully
[16:14:53] ✅    ✅ Order data extracted and validated
[16:14:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:00] [DOC: 9265768] ℹ️  Patient not found in cache or API: Martha Muldoon
[16:15:00] [DOC: 9265768] ℹ️  Patient not found, creating new patient via API...
[16:15:00] [DOC: 9265768] ℹ️  Creating patient via API: Martha Muldoon
[16:15:02] [DOC: 9265768] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:15:02] ❌    ❌ Failed to create patient
[16:15:02] [DOC: 9265768] ℹ️  API push details saved for document 9265768
================================================================================
║                        Processing Document ID: 9265762                         ║
================================================================================
[16:15:02] ℹ️  Agency: Dartmouth HH
[16:15:02] ℹ️  Date: 04/29/2025
[16:15:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:07] [DOC: 9265762] ✅ Text extracted using pdfplumber (10394 chars)
[16:15:07] ✅    ✅ Text extracted using pdfplumber (10394 chars)
[16:15:07] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:10] ℹ️  AI extracted raw sex value: 'F'
[16:15:10] ℹ️  AI extracted service line: 'RN, SN'
[16:15:10] ℹ️  AI extracted payer source: 'Fallon Navicare'
[16:15:10] ℹ️  AI extracted diagnoses:
[16:15:10] ℹ️    - Diagnosis 1: 'N30.00'
[16:15:10] ℹ️    - Diagnosis 2: 'I25.119'
[16:15:10] ℹ️    - Diagnosis 3: 'K44.9'
[16:15:10] ℹ️    - Diagnosis 4: 'K21.9'
[16:15:10] ℹ️    - Diagnosis 5: 'I10'
[16:15:10] ℹ️    - Diagnosis 6: 'K59.09'
[16:15:10] ℹ️  Final extracted MRN: '301015'
[16:15:10] ℹ️  Final extracted Sex: 'FEMALE'
[16:15:10] ℹ️  Final extracted Service Line: 'RN, SN'
[16:15:10] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[16:15:10] ✅ Patient data extraction completed successfully
[16:15:10] ✅    ✅ Patient data extracted successfully
[16:15:10] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, SN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'I25.119', 'thirdDiagnosis': 'K44.9', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'K59.09'}]
[16:15:10] ✅    ✅ Patient identified: Maria Dacosta
[16:15:10] ✅    ✅ Patient name validation passed
[16:15:10] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:10] [DOC: 9265762] ℹ️  DOB normalized: 10/10/1943
[16:15:10] [DOC: 9265762] ℹ️  Episode startOfCare normalized: 04/19/2024
[16:15:10] [DOC: 9265762] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[16:15:10] [DOC: 9265762] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[16:15:10] [DOC: 9265762] ✅ Patient date processing completed successfully
[16:15:10] ✅    ✅ Date processing completed
[16:15:10] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, SN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'I25.119', 'thirdDiagnosis': 'K44.9', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'K59.09'}]
[16:15:10] 🔄 
🔄 Step 4: Extracting order data...
[16:15:13] ℹ️  Order extraction - MRN: ''
[16:15:13] ℹ️  Order extraction - Sex: 'FEMALE'
[16:15:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:15:13] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[16:15:13] ✅ Order data extraction completed successfully
[16:15:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:13] ℹ️  Using MRN from patient data: '301015'
[16:15:13] ℹ️  Combined service lines: Patient='RN, SN' + Order='Skilled Nursing' = 'RN, SN, Skilled Nursing'
[16:15:13] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[16:15:13] ✅ Patient name cross-validation successful
[16:15:13] ✅    ✅ Data merged successfully
[16:15:17] ✅    ✅ Order data extracted and validated
[16:15:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:17] [DOC: 9265762] ✅ Patient found in local cache: Maria Dacosta, ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[16:15:17] ✅    ✅ Existing patient found with ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[16:15:17] 🔄 
🔄 Step 6: Pushing order to API...
[16:15:17] [DOC: 9265762] ℹ️  Pushing order via API for patient ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[16:15:18] [DOC: 9265762] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:15:18] ❌    ❌ Failed to push order
[16:15:18] 🔄 
🔄 Step 7: Writing to CSV...
[16:15:18] [DOC: 9265762] ℹ️  Calculated age: 81 from DOB: 10/10/1943
[16:15:18] [DOC: 9265762] ℹ️  Service Line extracted: 'RN, SN, Skilled Nursing'
[16:15:18] [DOC: 9265762] ℹ️  Payer Source extracted: 'Fallon Navicare'
[16:15:18] [DOC: 9265762] ℹ️  Diagnosis codes being written:
[16:15:18] [DOC: 9265762] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[16:15:18] [DOC: 9265762] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.119'
[16:15:18] [DOC: 9265762] ℹ️    - Latest_Episode_Thirddiagnosis: 'K44.9'
[16:15:18] [DOC: 9265762] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K21.9'
[16:15:18] [DOC: 9265762] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[16:15:18] [DOC: 9265762] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.09'
[16:15:18] [DOC: 9265762] ✅ Patient data written to CSV: Maria Dacosta | Sex: FEMALE | Age: 81 | Service: RN, SN, Skilled Nursing | Payer: Fallon Navicare | MRN: 301015
[16:15:18] ✅    ✅ Document 9265762 processed and saved successfully
[16:15:18] 🔄 
🔄 Step 8: Saving API details...
[16:15:18] [DOC: 9265762] ℹ️  API push details saved for document 9265762
[16:15:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265761                         ║
================================================================================
[16:15:18] ℹ️  Agency: Dartmouth HH
[16:15:18] ℹ️  Date: 04/29/2025
[16:15:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:20] [DOC: 9265761] ✅ Text extracted using pdfplumber (2429 chars)
[16:15:20] ✅    ✅ Text extracted using pdfplumber (2429 chars)
[16:15:20] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:23] ℹ️  AI extracted raw sex value: 'F'
[16:15:23] ℹ️  AI extracted service line: 'Physical Therapy'
[16:15:23] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[16:15:23] ℹ️  AI extracted diagnoses:
[16:15:23] ℹ️    - Diagnosis 1: ''
[16:15:23] ℹ️    - Diagnosis 2: ''
[16:15:23] ℹ️    - Diagnosis 3: ''
[16:15:23] ℹ️    - Diagnosis 4: ''
[16:15:23] ℹ️    - Diagnosis 5: ''
[16:15:23] ℹ️    - Diagnosis 6: ''
[16:15:23] ℹ️  Final extracted MRN: '2660015'
[16:15:23] ℹ️  Final extracted Sex: 'FEMALE'
[16:15:23] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:15:23] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[16:15:23] ✅ Patient data extraction completed successfully
[16:15:23] ✅    ✅ Patient data extracted successfully
[16:15:23] 📊 Patient Response
     └─ patientFName: Pamela
     └─ patientLName: Melo
     └─ dob: 12/19/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2660015
     └─ billingProvider: Blue Cross Blue Shield
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 295 W Mccabe St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:15:23] ✅    ✅ Patient identified: Pamela Melo
[16:15:23] ✅    ✅ Patient name validation passed
[16:15:23] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:23] [DOC: 9265761] ℹ️  DOB normalized: 12/19/1964
[16:15:23] [DOC: 9265761] ℹ️  Episode startOfCare normalized: 03/27/2025
[16:15:23] [DOC: 9265761] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[16:15:23] [DOC: 9265761] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[16:15:23] [DOC: 9265761] ✅ Patient date processing completed successfully
[16:15:23] ✅    ✅ Date processing completed
[16:15:23] 📊 Processed Patient Data
     └─ patientFName: Pamela
     └─ patientLName: Melo
     └─ dob: 12/19/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2660015
     └─ billingProvider: Blue Cross Blue Shield
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 295 W Mccabe St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:15:23] 🔄 
🔄 Step 4: Extracting order data...
[16:15:25] ℹ️  Order extraction - MRN: '2660015'
[16:15:25] ℹ️  Order extraction - Sex: 'FEMALE'
[16:15:25] ℹ️  Order extraction - Service Line: 'PT'
[16:15:25] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[16:15:25] ✅ Order data extraction completed successfully
[16:15:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:25] ℹ️  Using MRN from patient data: '2660015' over '2660015'
[16:15:25] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[16:15:25] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[16:15:25] ✅ Patient name cross-validation successful
[16:15:25] ✅    ✅ Data merged successfully
[16:15:27] ✅    ✅ Order data extracted and validated
[16:15:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:32] [DOC: 9265761] ✅ Patient exists in API: Pamela Melo, ID: 6b043e6c-5fe0-4ac9-a378-1ca308dc01ba
[16:15:32] ✅    ✅ Existing patient found with ID: 6b043e6c-5fe0-4ac9-a378-1ca308dc01ba
[16:15:32] 🔄 
🔄 Step 6: Pushing order to API...
[16:15:32] [DOC: 9265761] ℹ️  Pushing order via API for patient ID: 6b043e6c-5fe0-4ac9-a378-1ca308dc01ba
[16:15:34] [DOC: 9265761] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:15:34] ❌    ❌ Failed to push order
[16:15:34] 🔄 
🔄 Step 7: Writing to CSV...
[16:15:34] [DOC: 9265761] ℹ️  Calculated age: 60 from DOB: 12/19/1964
[16:15:34] [DOC: 9265761] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[16:15:34] [DOC: 9265761] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[16:15:34] [DOC: 9265761] ℹ️  Diagnosis codes being written:
[16:15:34] [DOC: 9265761] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:15:34] [DOC: 9265761] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:15:34] [DOC: 9265761] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:15:34] [DOC: 9265761] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:15:34] [DOC: 9265761] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:15:34] [DOC: 9265761] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:15:34] [DOC: 9265761] ✅ Patient data written to CSV: Pamela Melo | Sex: FEMALE | Age: 60 | Service: PT, Physical Therapy | Payer: Blue Cross Blue Shield | MRN: 2660015
[16:15:34] ✅    ✅ Document 9265761 processed and saved successfully
[16:15:34] 🔄 
🔄 Step 8: Saving API details...
[16:15:34] [DOC: 9265761] ℹ️  API push details saved for document 9265761
[16:15:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265749                         ║
================================================================================
[16:15:34] ℹ️  Agency: Dartmouth HH
[16:15:34] ℹ️  Date: 04/29/2025
[16:15:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:35] [DOC: 9265749] ✅ Text extracted using pdfplumber (1090 chars)
[16:15:35] ✅    ✅ Text extracted using pdfplumber (1090 chars)
[16:15:35] 🔄 
🔄 Step 2: Extracting patient data...
[16:15:38] ℹ️  AI extracted raw sex value: 'F'
[16:15:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:15:38] ℹ️  AI extracted payer source: 'United Health/ HPHC'
[16:15:38] ℹ️  AI extracted diagnoses:
[16:15:38] ℹ️    - Diagnosis 1: ''
[16:15:38] ℹ️    - Diagnosis 2: ''
[16:15:38] ℹ️    - Diagnosis 3: ''
[16:15:38] ℹ️    - Diagnosis 4: ''
[16:15:38] ℹ️    - Diagnosis 5: ''
[16:15:38] ℹ️    - Diagnosis 6: ''
[16:15:38] ℹ️  Final extracted MRN: '6037015'
[16:15:38] ℹ️  Final extracted Sex: 'FEMALE'
[16:15:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:15:38] ℹ️  Final extracted Payer Source: 'United Health/ HPHC'
[16:15:38] ✅ Patient data extraction completed successfully
[16:15:38] ✅    ✅ Patient data extracted successfully
[16:15:38] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Gomes
     └─ dob: 04/01/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6037015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health/ HPHC
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2025', 'startOfEpisode': '02/12/2025', 'endOfEpisode': '04/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:15:38] ✅    ✅ Patient identified: Frances Gomes
[16:15:38] ✅    ✅ Patient name validation passed
[16:15:38] 🔄 
🔄 Step 3: Processing patient dates...
[16:15:38] [DOC: 9265749] ℹ️  DOB normalized: 04/01/1971
[16:15:38] [DOC: 9265749] ℹ️  Episode startOfCare normalized: 02/12/2025
[16:15:38] [DOC: 9265749] ℹ️  Episode startOfEpisode normalized: 02/12/2025
[16:15:38] [DOC: 9265749] ℹ️  Episode endOfEpisode normalized: 04/12/2025
[16:15:38] [DOC: 9265749] ✅ Patient date processing completed successfully
[16:15:38] ✅    ✅ Date processing completed
[16:15:38] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Gomes
     └─ dob: 04/01/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6037015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health/ HPHC
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2025', 'startOfEpisode': '02/12/2025', 'endOfEpisode': '04/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:15:38] 🔄 
🔄 Step 4: Extracting order data...
[16:15:40] ℹ️  Order extraction - MRN: ''
[16:15:40] ℹ️  Order extraction - Sex: 'FEMALE'
[16:15:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:15:40] ℹ️  Order extraction - Payer Source: 'United Health/ HPHC'
[16:15:40] ✅ Order data extraction completed successfully
[16:15:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:15:40] ℹ️  Using MRN from patient data: '6037015'
[16:15:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:15:40] ℹ️  Payer source consistent in both sources: 'United Health/ HPHC'
[16:15:40] ✅ Patient name cross-validation successful
[16:15:40] ✅    ✅ Data merged successfully
[16:15:42] ✅    ✅ Order data extracted and validated
[16:15:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:15:54] [DOC: 9265749] ✅ Patient exists in API: Frances Gomes, ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:15:54] ✅    ✅ Existing patient found with ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:15:54] 🔄 
🔄 Step 6: Pushing order to API...
[16:15:54] [DOC: 9265749] ℹ️  Pushing order via API for patient ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:15:55] [DOC: 9265749] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:15:55] ❌    ❌ Failed to push order
[16:15:55] 🔄 
🔄 Step 7: Writing to CSV...
[16:15:55] [DOC: 9265749] ℹ️  Calculated age: 54 from DOB: 04/01/1971
[16:15:55] [DOC: 9265749] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:15:55] [DOC: 9265749] ℹ️  Payer Source extracted: 'United Health/ HPHC'
[16:15:55] [DOC: 9265749] ℹ️  Diagnosis codes being written:
[16:15:55] [DOC: 9265749] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:15:55] [DOC: 9265749] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:15:55] [DOC: 9265749] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:15:55] [DOC: 9265749] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:15:55] [DOC: 9265749] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:15:55] [DOC: 9265749] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:15:55] [DOC: 9265749] ✅ Patient data written to CSV: Frances Gomes | Sex: FEMALE | Age: 54 | Service: Skilled Nursing | Payer: United Health/ HPHC | MRN: 6037015
[16:15:55] ✅    ✅ Document 9265749 processed and saved successfully
[16:15:55] 🔄 
🔄 Step 8: Saving API details...
[16:15:55] [DOC: 9265749] ℹ️  API push details saved for document 9265749
[16:15:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265748                         ║
================================================================================
[16:15:55] ℹ️  Agency: Dartmouth HH
[16:15:55] ℹ️  Date: 04/29/2025
[16:15:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:15:58] [DOC: 9265748] ✅ Text extracted using pdfplumber (1158 chars)
[16:15:58] ✅    ✅ Text extracted using pdfplumber (1158 chars)
[16:15:58] 🔄 
🔄 Step 2: Extracting patient data...
[16:16:00] ℹ️  AI extracted raw sex value: 'F'
[16:16:00] ℹ️  AI extracted service line: 'RN, LPN'
[16:16:00] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:16:00] ℹ️  AI extracted diagnoses:
[16:16:00] ℹ️    - Diagnosis 1: 'None'
[16:16:00] ℹ️    - Diagnosis 2: 'None'
[16:16:00] ℹ️    - Diagnosis 3: 'None'
[16:16:00] ℹ️    - Diagnosis 4: 'None'
[16:16:00] ℹ️    - Diagnosis 5: 'None'
[16:16:00] ℹ️    - Diagnosis 6: 'None'
[16:16:00] ℹ️  Final extracted MRN: '6341015'
[16:16:00] ℹ️  Final extracted Sex: 'FEMALE'
[16:16:00] ℹ️  Final extracted Service Line: 'RN, LPN'
[16:16:00] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:16:00] ✅ Patient data extraction completed successfully
[16:16:00] ✅    ✅ Patient data extracted successfully
[16:16:00] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Seaman
     └─ dob: 06/21/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6341015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:16:00] ✅    ✅ Patient identified: Mary Seaman
[16:16:00] ✅    ✅ Patient name validation passed
[16:16:00] 🔄 
🔄 Step 3: Processing patient dates...
[16:16:00] [DOC: 9265748] ℹ️  DOB normalized: 06/21/1944
[16:16:00] [DOC: 9265748] ℹ️  Episode startOfCare normalized: 04/07/2025
[16:16:00] [DOC: 9265748] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[16:16:00] [DOC: 9265748] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[16:16:00] [DOC: 9265748] ✅ Patient date processing completed successfully
[16:16:00] ✅    ✅ Date processing completed
[16:16:00] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Seaman
     └─ dob: 06/21/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6341015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025'}]
[16:16:00] 🔄 
🔄 Step 4: Extracting order data...
[16:16:03] ℹ️  Order extraction - MRN: '6341015'
[16:16:03] ℹ️  Order extraction - Sex: 'FEMALE'
[16:16:03] ℹ️  Order extraction - Service Line: 'Nursing'
[16:16:03] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:16:03] ✅ Order data extraction completed successfully
[16:16:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:16:03] ℹ️  Using MRN from patient data: '6341015' over '6341015'
[16:16:03] ℹ️  Combined service lines: Patient='RN, LPN' + Order='Nursing' = 'LPN, Nursing, RN'
[16:16:03] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:16:03] ✅ Patient name cross-validation successful
[16:16:03] ✅    ✅ Data merged successfully
[16:16:04] ✅    ✅ Order data extracted and validated
[16:16:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:16:25] [DOC: 9265748] ℹ️  Patient not found in cache or API: Mary Seaman
[16:16:25] [DOC: 9265748] ℹ️  Patient not found, creating new patient via API...
[16:16:25] [DOC: 9265748] ℹ️  Creating patient via API: Mary Seaman
[16:16:26] [DOC: 9265748] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:16:26] ❌    ❌ Failed to create patient
[16:16:26] [DOC: 9265748] ℹ️  API push details saved for document 9265748
================================================================================
║                        Processing Document ID: 9265747                         ║
================================================================================
[16:16:26] ℹ️  Agency: Dartmouth HH
[16:16:26] ℹ️  Date: 04/29/2025
[16:16:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:16:28] [DOC: 9265747] ✅ Text extracted using pdfplumber (5091 chars)
[16:16:28] ✅    ✅ Text extracted using pdfplumber (5091 chars)
[16:16:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:16:30] ℹ️  AI extracted raw sex value: 'F'
[16:16:30] ℹ️  AI extracted service line: 'Physical Therapy'
[16:16:30] ℹ️  AI extracted payer source: 'Medicare'
[16:16:30] ℹ️  AI extracted diagnoses:
[16:16:30] ℹ️    - Diagnosis 1: ''
[16:16:30] ℹ️    - Diagnosis 2: ''
[16:16:30] ℹ️    - Diagnosis 3: ''
[16:16:30] ℹ️    - Diagnosis 4: ''
[16:16:30] ℹ️    - Diagnosis 5: ''
[16:16:30] ℹ️    - Diagnosis 6: ''
[16:16:30] ℹ️  Final extracted MRN: '421008'
[16:16:30] ℹ️  Final extracted Sex: 'FEMALE'
[16:16:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[16:16:30] ℹ️  Final extracted Payer Source: 'Medicare'
[16:16:30] ✅ Patient data extraction completed successfully
[16:16:30] ✅    ✅ Patient data extracted successfully
[16:16:30] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:16:30] ✅    ✅ Patient identified: Nancy Mulcare
[16:16:30] ✅    ✅ Patient name validation passed
[16:16:30] 🔄 
🔄 Step 3: Processing patient dates...
[16:16:30] [DOC: 9265747] ℹ️  DOB normalized: 10/20/1945
[16:16:30] [DOC: 9265747] ℹ️  Episode startOfCare normalized: 03/25/2025
[16:16:30] [DOC: 9265747] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[16:16:30] [DOC: 9265747] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[16:16:30] [DOC: 9265747] ✅ Patient date processing completed successfully
[16:16:30] ✅    ✅ Date processing completed
[16:16:30] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:16:30] 🔄 
🔄 Step 4: Extracting order data...
[16:16:33] ℹ️  Order extraction - MRN: ''
[16:16:33] ℹ️  Order extraction - Sex: 'FEMALE'
[16:16:33] ℹ️  Order extraction - Service Line: 'PT'
[16:16:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:16:33] ✅ Order data extraction completed successfully
[16:16:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:16:33] ℹ️  Using MRN from patient data: '421008'
[16:16:33] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[16:16:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:16:33] ✅ Patient name cross-validation successful
[16:16:33] ✅    ✅ Data merged successfully
[16:16:34] ✅    ✅ Order data extracted and validated
[16:16:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:16:53] [DOC: 9265747] ℹ️  Patient not found in cache or API: Nancy Mulcare
[16:16:53] [DOC: 9265747] ℹ️  Patient not found, creating new patient via API...
[16:16:53] [DOC: 9265747] ℹ️  Creating patient via API: Nancy Mulcare
[16:16:54] [DOC: 9265747] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:16:54] ❌    ❌ Failed to create patient
[16:16:54] [DOC: 9265747] ℹ️  API push details saved for document 9265747
================================================================================
║                        Processing Document ID: 9265746                         ║
================================================================================
[16:16:54] ℹ️  Agency: Dartmouth HH
[16:16:54] ℹ️  Date: 04/29/2025
[16:16:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:16:56] [DOC: 9265746] ✅ Text extracted using pdfplumber (1491 chars)
[16:16:56] ✅    ✅ Text extracted using pdfplumber (1491 chars)
[16:16:56] 🔄 
🔄 Step 2: Extracting patient data...
[16:16:58] ℹ️  AI extracted raw sex value: 'F'
[16:16:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:16:58] ℹ️  AI extracted payer source: 'United Health/ HPHC'
[16:16:58] ℹ️  AI extracted diagnoses:
[16:16:58] ℹ️    - Diagnosis 1: ''
[16:16:58] ℹ️    - Diagnosis 2: ''
[16:16:58] ℹ️    - Diagnosis 3: ''
[16:16:58] ℹ️    - Diagnosis 4: ''
[16:16:58] ℹ️    - Diagnosis 5: ''
[16:16:58] ℹ️    - Diagnosis 6: ''
[16:16:58] ℹ️  Final extracted MRN: '6037015'
[16:16:58] ℹ️  Final extracted Sex: 'FEMALE'
[16:16:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:16:58] ℹ️  Final extracted Payer Source: 'United Health/ HPHC'
[16:16:58] ✅ Patient data extraction completed successfully
[16:16:58] ✅    ✅ Patient data extracted successfully
[16:16:58] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Gomes
     └─ dob: 04/01/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6037015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health/ HPHC
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:16:58] ✅    ✅ Patient identified: Frances Gomes
[16:16:58] ✅    ✅ Patient name validation passed
[16:16:58] 🔄 
🔄 Step 3: Processing patient dates...
[16:16:58] [DOC: 9265746] ℹ️  DOB normalized: 04/01/1971
[16:16:58] [DOC: 9265746] ℹ️  Episode startOfCare normalized: 02/12/2025
[16:16:58] [DOC: 9265746] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[16:16:58] [DOC: 9265746] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[16:16:58] [DOC: 9265746] ✅ Patient date processing completed successfully
[16:16:58] ✅    ✅ Date processing completed
[16:16:58] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Gomes
     └─ dob: 04/01/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6037015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health/ HPHC
     └─ episodeDiagnoses: [{'startOfCare': '02/12/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:16:58] 🔄 
🔄 Step 4: Extracting order data...
[16:17:01] ℹ️  Order extraction - MRN: ''
[16:17:01] ℹ️  Order extraction - Sex: 'FEMALE'
[16:17:01] ℹ️  Order extraction - Service Line: 'RN'
[16:17:01] ℹ️  Order extraction - Payer Source: 'United Health/ HPHC'
[16:17:01] ✅ Order data extraction completed successfully
[16:17:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:01] ℹ️  Using MRN from patient data: '6037015'
[16:17:01] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[16:17:01] ℹ️  Payer source consistent in both sources: 'United Health/ HPHC'
[16:17:01] ✅ Patient name cross-validation successful
[16:17:01] ✅    ✅ Data merged successfully
[16:17:02] ✅    ✅ Order data extracted and validated
[16:17:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:17:02] [DOC: 9265746] ✅ Patient found in local cache: Frances Gomes, ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:17:02] ✅    ✅ Existing patient found with ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:17:02] 🔄 
🔄 Step 6: Pushing order to API...
[16:17:02] [DOC: 9265746] ℹ️  Pushing order via API for patient ID: e68ddb08-1807-4e0d-88ed-5dfd0868c13b
[16:17:04] [DOC: 9265746] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13792"}
[16:17:04] ❌    ❌ Failed to push order
[16:17:04] 🔄 
🔄 Step 7: Writing to CSV...
[16:17:04] [DOC: 9265746] ℹ️  Calculated age: 54 from DOB: 04/01/1971
[16:17:04] [DOC: 9265746] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[16:17:04] [DOC: 9265746] ℹ️  Payer Source extracted: 'United Health/ HPHC'
[16:17:04] [DOC: 9265746] ℹ️  Diagnosis codes being written:
[16:17:04] [DOC: 9265746] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:17:04] [DOC: 9265746] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:17:04] [DOC: 9265746] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:17:04] [DOC: 9265746] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:17:04] [DOC: 9265746] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:17:04] [DOC: 9265746] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:17:04] [DOC: 9265746] ✅ Patient data written to CSV: Frances Gomes | Sex: FEMALE | Age: 54 | Service: RN, Skilled Nursing | Payer: United Health/ HPHC | MRN: 6037015
[16:17:04] ✅    ✅ Document 9265746 processed and saved successfully
[16:17:04] 🔄 
🔄 Step 8: Saving API details...
[16:17:04] [DOC: 9265746] ℹ️  API push details saved for document 9265746
[16:17:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265742                         ║
================================================================================
[16:17:04] ℹ️  Agency: Dartmouth HH
[16:17:04] ℹ️  Date: 04/29/2025
[16:17:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:06] [DOC: 9265742] ✅ Text extracted using pdfplumber (7064 chars)
[16:17:06] ✅    ✅ Text extracted using pdfplumber (7064 chars)
[16:17:06] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:09] ℹ️  AI extracted raw sex value: 'F'
[16:17:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:17:09] ℹ️  AI extracted payer source: 'Medicaid/MA'
[16:17:09] ℹ️  AI extracted diagnoses:
[16:17:09] ℹ️    - Diagnosis 1: 'G89.3'
[16:17:09] ℹ️    - Diagnosis 2: 'C49.21'
[16:17:09] ℹ️    - Diagnosis 3: 'C79.31'
[16:17:09] ℹ️    - Diagnosis 4: 'C77.2'
[16:17:09] ℹ️    - Diagnosis 5: ''
[16:17:09] ℹ️    - Diagnosis 6: ''
[16:17:09] ℹ️  Final extracted MRN: '5391015'
[16:17:09] ℹ️  Final extracted Sex: 'FEMALE'
[16:17:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:17:09] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[16:17:09] ✅ Patient data extraction completed successfully
[16:17:09] ✅    ✅ Patient data extracted successfully
[16:17:09] 📊 Patient Response
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G89.3', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'C79.31', 'fourthDiagnosis': 'C77.2', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:09] ✅    ✅ Patient identified: Maribel Pena
[16:17:09] ✅    ✅ Patient name validation passed
[16:17:09] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:09] [DOC: 9265742] ℹ️  DOB normalized: 09/16/1994
[16:17:09] [DOC: 9265742] ℹ️  Episode startOfCare normalized: 10/17/2024
[16:17:09] [DOC: 9265742] ℹ️  Episode startOfEpisode normalized: 10/17/2024
[16:17:09] [DOC: 9265742] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[16:17:09] [DOC: 9265742] ✅ Patient date processing completed successfully
[16:17:09] ✅    ✅ Date processing completed
[16:17:09] 📊 Processed Patient Data
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G89.3', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'C79.31', 'fourthDiagnosis': 'C77.2', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:09] 🔄 
🔄 Step 4: Extracting order data...
[16:17:11] ℹ️  Order extraction - MRN: '5391015'
[16:17:11] ℹ️  Order extraction - Sex: 'FEMALE'
[16:17:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:17:11] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[16:17:11] ✅ Order data extraction completed successfully
[16:17:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:11] ℹ️  Using MRN from patient data: '5391015' over '5391015'
[16:17:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:17:11] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[16:17:11] ✅ Patient name cross-validation successful
[16:17:11] ✅    ✅ Data merged successfully
[16:17:12] ✅    ✅ Order data extracted and validated
[16:17:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:17:12] [DOC: 9265742] ✅ Patient found in local cache: Maribel Pena, ID: 21aca991-bba7-4f19-828f-34b178408fd4
[16:17:12] ✅    ✅ Existing patient found with ID: 21aca991-bba7-4f19-828f-34b178408fd4
[16:17:12] 🔄 
🔄 Step 6: Pushing order to API...
[16:17:12] [DOC: 9265742] ℹ️  Pushing order via API for patient ID: 21aca991-bba7-4f19-828f-34b178408fd4
[16:17:14] [DOC: 9265742] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:17:14] ❌    ❌ Failed to push order
[16:17:14] 🔄 
🔄 Step 7: Writing to CSV...
[16:17:14] [DOC: 9265742] ℹ️  Calculated age: 30 from DOB: 09/16/1994
[16:17:14] [DOC: 9265742] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:17:14] [DOC: 9265742] ℹ️  Payer Source extracted: 'Medicaid/MA'
[16:17:14] [DOC: 9265742] ℹ️  Diagnosis codes being written:
[16:17:14] [DOC: 9265742] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.3'
[16:17:14] [DOC: 9265742] ℹ️    - Latest_Episode_Seconddiagnosis: 'C49.21'
[16:17:14] [DOC: 9265742] ℹ️    - Latest_Episode_Thirddiagnosis: 'C79.31'
[16:17:14] [DOC: 9265742] ℹ️    - Latest_Episode_Fourthdiagnosis: 'C77.2'
[16:17:14] [DOC: 9265742] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:17:14] [DOC: 9265742] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:17:14] [DOC: 9265742] ✅ Patient data written to CSV: Maribel Pena | Sex: FEMALE | Age: 30 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 5391015
[16:17:14] ✅    ✅ Document 9265742 processed and saved successfully
[16:17:14] 🔄 
🔄 Step 8: Saving API details...
[16:17:14] [DOC: 9265742] ℹ️  API push details saved for document 9265742
[16:17:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265741                         ║
================================================================================
[16:17:14] ℹ️  Agency: Dartmouth HH
[16:17:14] ℹ️  Date: 04/29/2025
[16:17:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:16] [DOC: 9265741] ✅ Text extracted using pdfplumber (1435 chars)
[16:17:16] ✅    ✅ Text extracted using pdfplumber (1435 chars)
[16:17:16] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:19] ℹ️  AI extracted raw sex value: 'M'
[16:17:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[16:17:19] ℹ️  AI extracted payer source: 'Medicare'
[16:17:19] ℹ️  AI extracted diagnoses:
[16:17:19] ℹ️    - Diagnosis 1: ''
[16:17:19] ℹ️    - Diagnosis 2: ''
[16:17:19] ℹ️    - Diagnosis 3: ''
[16:17:19] ℹ️    - Diagnosis 4: ''
[16:17:19] ℹ️    - Diagnosis 5: ''
[16:17:19] ℹ️    - Diagnosis 6: ''
[16:17:19] ℹ️  Final extracted MRN: '1396009'
[16:17:19] ℹ️  Final extracted Sex: 'MALE'
[16:17:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[16:17:19] ℹ️  Final extracted Payer Source: 'Medicare'
[16:17:19] ✅ Patient data extraction completed successfully
[16:17:19] ✅    ✅ Patient data extracted successfully
[16:17:19] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:19] ✅    ✅ Patient identified: Elias Ramos
[16:17:19] ✅    ✅ Patient name validation passed
[16:17:19] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:19] [DOC: 9265741] ℹ️  DOB normalized: 08/28/1938
[16:17:19] [DOC: 9265741] ℹ️  Episode startOfCare normalized: 03/01/2025
[16:17:19] [DOC: 9265741] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[16:17:19] [DOC: 9265741] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[16:17:19] [DOC: 9265741] ✅ Patient date processing completed successfully
[16:17:19] ✅    ✅ Date processing completed
[16:17:19] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:19] 🔄 
🔄 Step 4: Extracting order data...
[16:17:21] ℹ️  Order extraction - MRN: ''
[16:17:21] ℹ️  Order extraction - Sex: 'MALE'
[16:17:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[16:17:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:17:21] ✅ Order data extraction completed successfully
[16:17:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:21] ℹ️  Using MRN from patient data: '1396009'
[16:17:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[16:17:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:17:21] ✅ Patient name cross-validation successful
[16:17:21] ✅    ✅ Data merged successfully
[16:17:23] ✅    ✅ Order data extracted and validated
[16:17:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:17:23] [DOC: 9265741] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[16:17:23] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[16:17:23] 🔄 
🔄 Step 6: Pushing order to API...
[16:17:23] [DOC: 9265741] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[16:17:26] [DOC: 9265741] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:17:26] ❌    ❌ Failed to push order
[16:17:26] 🔄 
🔄 Step 7: Writing to CSV...
[16:17:26] [DOC: 9265741] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[16:17:26] [DOC: 9265741] ℹ️  Service Line extracted: 'Skilled Nursing'
[16:17:26] [DOC: 9265741] ℹ️  Payer Source extracted: 'Medicare'
[16:17:26] [DOC: 9265741] ℹ️  Diagnosis codes being written:
[16:17:26] [DOC: 9265741] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:17:26] [DOC: 9265741] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:17:26] [DOC: 9265741] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:17:26] [DOC: 9265741] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:17:26] [DOC: 9265741] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:17:26] [DOC: 9265741] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:17:26] [DOC: 9265741] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: Skilled Nursing | Payer: Medicare | MRN: 1396009
[16:17:26] ✅    ✅ Document 9265741 processed and saved successfully
[16:17:26] 🔄 
🔄 Step 8: Saving API details...
[16:17:26] [DOC: 9265741] ℹ️  API push details saved for document 9265741
[16:17:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265739                         ║
================================================================================
[16:17:26] ℹ️  Agency: Dartmouth HH
[16:17:26] ℹ️  Date: 04/29/2025
[16:17:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:28] [DOC: 9265739] ✅ Text extracted using pdfplumber (1262 chars)
[16:17:28] ✅    ✅ Text extracted using pdfplumber (1262 chars)
[16:17:28] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:31] ℹ️  AI extracted raw sex value: 'M'
[16:17:31] ℹ️  AI extracted service line: 'RN'
[16:17:31] ℹ️  AI extracted payer source: 'United Health Care'
[16:17:31] ℹ️  AI extracted diagnoses:
[16:17:31] ℹ️    - Diagnosis 1: ''
[16:17:31] ℹ️    - Diagnosis 2: ''
[16:17:31] ℹ️    - Diagnosis 3: ''
[16:17:31] ℹ️    - Diagnosis 4: ''
[16:17:31] ℹ️    - Diagnosis 5: ''
[16:17:31] ℹ️    - Diagnosis 6: ''
[16:17:31] ℹ️  Final extracted MRN: '7046009'
[16:17:31] ℹ️  Final extracted Sex: 'MALE'
[16:17:31] ℹ️  Final extracted Service Line: 'RN'
[16:17:31] ℹ️  Final extracted Payer Source: 'United Health Care'
[16:17:31] ✅ Patient data extraction completed successfully
[16:17:31] ✅    ✅ Patient data extracted successfully
[16:17:31] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:31] ✅    ✅ Patient identified: Julio Demelo
[16:17:31] ✅    ✅ Patient name validation passed
[16:17:31] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:31] [DOC: 9265739] ℹ️  DOB normalized: 02/23/1950
[16:17:31] [DOC: 9265739] ℹ️  Episode startOfCare normalized: 10/31/2024
[16:17:31] [DOC: 9265739] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[16:17:31] [DOC: 9265739] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[16:17:31] [DOC: 9265739] ✅ Patient date processing completed successfully
[16:17:31] ✅    ✅ Date processing completed
[16:17:31] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:17:31] 🔄 
🔄 Step 4: Extracting order data...
[16:17:33] ℹ️  Order extraction - MRN: ''
[16:17:33] ℹ️  Order extraction - Sex: 'MALE'
[16:17:33] ℹ️  Order extraction - Service Line: 'RN'
[16:17:33] ℹ️  Order extraction - Payer Source: 'United Health Care'
[16:17:33] ✅ Order data extraction completed successfully
[16:17:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:33] ℹ️  Using MRN from patient data: '7046009'
[16:17:33] ℹ️  Service line consistent in both sources: 'RN'
[16:17:33] ℹ️  Payer source consistent in both sources: 'United Health Care'
[16:17:33] ✅ Patient name cross-validation successful
[16:17:33] ✅    ✅ Data merged successfully
[16:17:35] ✅    ✅ Order data extracted and validated
[16:17:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:17:46] [DOC: 9265739] ℹ️  Patient not found in cache or API: Julio Demelo
[16:17:46] [DOC: 9265739] ℹ️  Patient not found, creating new patient via API...
[16:17:46] [DOC: 9265739] ℹ️  Creating patient via API: Julio Demelo
[16:17:48] [DOC: 9265739] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:17:48] ❌    ❌ Failed to create patient
[16:17:48] [DOC: 9265739] ℹ️  API push details saved for document 9265739
================================================================================
║                        Processing Document ID: 9265738                         ║
================================================================================
[16:17:48] ℹ️  Agency: Dartmouth HH
[16:17:48] ℹ️  Date: 04/29/2025
[16:17:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:17:53] [DOC: 9265738] ✅ Text extracted using pdfplumber (14646 chars)
[16:17:53] ✅    ✅ Text extracted using pdfplumber (14646 chars)
[16:17:53] 🔄 
🔄 Step 2: Extracting patient data...
[16:17:56] ℹ️  AI extracted raw sex value: 'M'
[16:17:56] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:17:56] ℹ️  AI extracted payer source: ''
[16:17:56] ℹ️  AI extracted diagnoses:
[16:17:56] ℹ️    - Diagnosis 1: 'L89.620'
[16:17:56] ℹ️    - Diagnosis 2: 'E11.65'
[16:17:56] ℹ️    - Diagnosis 3: 'I12.9'
[16:17:56] ℹ️    - Diagnosis 4: 'E11.22'
[16:17:56] ℹ️    - Diagnosis 5: 'N18.4'
[16:17:56] ℹ️    - Diagnosis 6: 'D63.1'
[16:17:56] ℹ️  Final extracted MRN: '7046009'
[16:17:56] ℹ️  Final extracted Sex: 'MALE'
[16:17:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[16:17:56] ℹ️  Final extracted Payer Source: ''
[16:17:56] ✅ Patient data extraction completed successfully
[16:17:56] ✅    ✅ Patient data extracted successfully
[16:17:56] 📊 Patient Response
     └─ patientFName: Demelo
     └─ patientLName: Julio
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/01/2024', 'startOfEpisode': '10/31/2024', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'L89.620', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'D63.1'}]
[16:17:56] ✅    ✅ Patient identified: Demelo Julio
[16:17:56] ✅    ✅ Patient name validation passed
[16:17:56] 🔄 
🔄 Step 3: Processing patient dates...
[16:17:56] [DOC: 9265738] ℹ️  DOB normalized: 02/23/1950
[16:17:56] [DOC: 9265738] ℹ️  Episode startOfCare normalized: 10/01/2024
[16:17:56] [DOC: 9265738] ℹ️  Episode startOfEpisode normalized: 10/31/2024
[16:17:56] [DOC: 9265738] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[16:17:56] [DOC: 9265738] ✅ Patient date processing completed successfully
[16:17:56] ✅    ✅ Date processing completed
[16:17:56] 📊 Processed Patient Data
     └─ patientFName: Demelo
     └─ patientLName: Julio
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/01/2024', 'startOfEpisode': '10/31/2024', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'L89.620', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'D63.1'}]
[16:17:56] 🔄 
🔄 Step 4: Extracting order data...
[16:17:59] ℹ️  Order extraction - MRN: '7046009'
[16:17:59] ℹ️  Order extraction - Sex: 'MALE'
[16:17:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[16:17:59] ℹ️  Order extraction - Payer Source: ''
[16:17:59] ✅ Order data extraction completed successfully
[16:17:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:17:59] ℹ️  Using MRN from patient data: '7046009' over '7046009'
[16:17:59] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing, PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[16:17:59] ✅ Patient name cross-validation successful
[16:17:59] ✅    ✅ Data merged successfully
[16:18:00] ✅    ✅ Order data extracted and validated
[16:18:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:18:11] [DOC: 9265738] ✅ Patient exists in API: Demelo Julio, ID: 70fecfa4-c0f7-4028-86d5-a4d6a693ed37
[16:18:11] ✅    ✅ Existing patient found with ID: 70fecfa4-c0f7-4028-86d5-a4d6a693ed37
[16:18:11] 🔄 
🔄 Step 6: Pushing order to API...
[16:18:11] [DOC: 9265738] ℹ️  Pushing order via API for patient ID: 70fecfa4-c0f7-4028-86d5-a4d6a693ed37
[16:18:12] [DOC: 9265738] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[16:18:12] ❌    ❌ Failed to push order
[16:18:12] 🔄 
🔄 Step 7: Writing to CSV...
[16:18:12] [DOC: 9265738] ℹ️  Calculated age: 75 from DOB: 02/23/1950
[16:18:12] [DOC: 9265738] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[16:18:12] [DOC: 9265738] ℹ️  Payer Source extracted: ''
[16:18:12] [DOC: 9265738] ℹ️  Diagnosis codes being written:
[16:18:12] [DOC: 9265738] ℹ️    - Latest_Episode_Firstdiagnosis: 'L89.620'
[16:18:12] [DOC: 9265738] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.65'
[16:18:12] [DOC: 9265738] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[16:18:12] [DOC: 9265738] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[16:18:12] [DOC: 9265738] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.4'
[16:18:12] [DOC: 9265738] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D63.1'
[16:18:12] [DOC: 9265738] ✅ Patient data written to CSV: Demelo Julio | Sex: MALE | Age: 75 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 7046009
[16:18:12] ✅    ✅ Document 9265738 processed and saved successfully
[16:18:12] 🔄 
🔄 Step 8: Saving API details...
[16:18:12] [DOC: 9265738] ℹ️  API push details saved for document 9265738
[16:18:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265737                         ║
================================================================================
[16:18:12] ℹ️  Agency: Dartmouth HH
[16:18:12] ℹ️  Date: 04/29/2025
[16:18:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:18:14] [DOC: 9265737] ✅ Text extracted using pdfplumber (1125 chars)
[16:18:14] ✅    ✅ Text extracted using pdfplumber (1125 chars)
[16:18:14] 🔄 
🔄 Step 2: Extracting patient data...
[16:18:16] ℹ️  AI extracted raw sex value: 'M'
[16:18:16] ℹ️  AI extracted service line: 'Skilled Nursing, telehealth'
[16:18:16] ℹ️  AI extracted payer source: 'Medicare'
[16:18:16] ℹ️  AI extracted diagnoses:
[16:18:16] ℹ️    - Diagnosis 1: 'None'
[16:18:16] ℹ️    - Diagnosis 2: 'None'
[16:18:16] ℹ️    - Diagnosis 3: 'None'
[16:18:16] ℹ️    - Diagnosis 4: 'None'
[16:18:16] ℹ️    - Diagnosis 5: 'None'
[16:18:16] ℹ️    - Diagnosis 6: 'None'
[16:18:16] ℹ️  Final extracted MRN: '1293009'
[16:18:16] ℹ️  Final extracted Sex: 'MALE'
[16:18:16] ℹ️  Final extracted Service Line: 'Skilled Nursing, telehealth'
[16:18:16] ℹ️  Final extracted Payer Source: 'Medicare'
[16:18:16] ✅ Patient data extraction completed successfully
[16:18:16] ✅    ✅ Patient data extracted successfully
[16:18:16] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Pereira
     └─ dob: 08/10/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 1293009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, telehealth
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:18:16] ✅    ✅ Patient identified: Antonio Pereira
[16:18:16] ✅    ✅ Patient name validation passed
[16:18:16] 🔄 
🔄 Step 3: Processing patient dates...
[16:18:16] [DOC: 9265737] ℹ️  DOB normalized: 08/10/1939
[16:18:16] [DOC: 9265737] ℹ️  Episode startOfCare normalized: 04/25/2025
[16:18:16] [DOC: 9265737] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[16:18:16] [DOC: 9265737] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[16:18:16] [DOC: 9265737] ✅ Patient date processing completed successfully
[16:18:16] ✅    ✅ Date processing completed
[16:18:16] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Pereira
     └─ dob: 08/10/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 1293009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, telehealth
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025'}]
[16:18:16] 🔄 
🔄 Step 4: Extracting order data...
[16:18:19] ℹ️  Order extraction - MRN: ''
[16:18:19] ℹ️  Order extraction - Sex: 'MALE'
[16:18:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing, telehealth'
[16:18:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:18:19] ✅ Order data extraction completed successfully
[16:18:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:18:19] ℹ️  Using MRN from patient data: '1293009'
[16:18:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing, telehealth'
[16:18:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:18:19] ✅ Patient name cross-validation successful
[16:18:19] ✅    ✅ Data merged successfully
[16:18:20] ✅    ✅ Order data extracted and validated
[16:18:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:18:29] [DOC: 9265737] ✅ Patient exists in API: Antonio Pereira, ID: e6a94631-41f1-4a50-907a-285f7d30c9ae
[16:18:29] ✅    ✅ Existing patient found with ID: e6a94631-41f1-4a50-907a-285f7d30c9ae
[16:18:29] 🔄 
🔄 Step 6: Pushing order to API...
[16:18:29] [DOC: 9265737] ℹ️  Pushing order via API for patient ID: e6a94631-41f1-4a50-907a-285f7d30c9ae
[16:18:30] [DOC: 9265737] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13012"}
[16:18:30] ❌    ❌ Failed to push order
[16:18:30] 🔄 
🔄 Step 7: Writing to CSV...
[16:18:30] [DOC: 9265737] ℹ️  Calculated age: 85 from DOB: 08/10/1939
[16:18:30] [DOC: 9265737] ℹ️  Service Line extracted: 'Skilled Nursing, telehealth'
[16:18:30] [DOC: 9265737] ℹ️  Payer Source extracted: 'Medicare'
[16:18:30] [DOC: 9265737] ℹ️  Diagnosis codes being written:
[16:18:30] [DOC: 9265737] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[16:18:30] [DOC: 9265737] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[16:18:30] [DOC: 9265737] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[16:18:30] [DOC: 9265737] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[16:18:30] [DOC: 9265737] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[16:18:30] [DOC: 9265737] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[16:18:30] [DOC: 9265737] ✅ Patient data written to CSV: Antonio Pereira | Sex: MALE | Age: 85 | Service: Skilled Nursing, telehealth | Payer: Medicare | MRN: 1293009
[16:18:30] ✅    ✅ Document 9265737 processed and saved successfully
[16:18:30] 🔄 
🔄 Step 8: Saving API details...
[16:18:30] [DOC: 9265737] ℹ️  API push details saved for document 9265737
[16:18:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265736                         ║
================================================================================
[16:18:30] ℹ️  Agency: Dartmouth HH
[16:18:30] ℹ️  Date: 04/29/2025
[16:18:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:18:32] [DOC: 9265736] ✅ Text extracted using pdfplumber (3902 chars)
[16:18:32] ✅    ✅ Text extracted using pdfplumber (3902 chars)
[16:18:32] 🔄 
🔄 Step 2: Extracting patient data...
[16:18:35] ℹ️  AI extracted raw sex value: 'F'
[16:18:35] ℹ️  AI extracted service line: 'OT'
[16:18:35] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[16:18:35] ℹ️  AI extracted diagnoses:
[16:18:35] ℹ️    - Diagnosis 1: ''
[16:18:35] ℹ️    - Diagnosis 2: ''
[16:18:35] ℹ️    - Diagnosis 3: ''
[16:18:35] ℹ️    - Diagnosis 4: ''
[16:18:35] ℹ️    - Diagnosis 5: ''
[16:18:35] ℹ️    - Diagnosis 6: ''
[16:18:35] ℹ️  Final extracted MRN: '5843015'
[16:18:35] ℹ️  Final extracted Sex: 'FEMALE'
[16:18:35] ℹ️  Final extracted Service Line: 'OT'
[16:18:35] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[16:18:35] ✅ Patient data extraction completed successfully
[16:18:35] ✅    ✅ Patient data extracted successfully
[16:18:35] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:18:35] ✅    ✅ Patient identified: Joanne Medeiros
[16:18:35] ✅    ✅ Patient name validation passed
[16:18:35] 🔄 
🔄 Step 3: Processing patient dates...
[16:18:35] [DOC: 9265736] ℹ️  DOB normalized: 12/09/1952
[16:18:35] [DOC: 9265736] ℹ️  Episode startOfCare normalized: 01/15/2025
[16:18:35] [DOC: 9265736] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[16:18:35] [DOC: 9265736] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[16:18:35] [DOC: 9265736] ✅ Patient date processing completed successfully
[16:18:35] ✅    ✅ Date processing completed
[16:18:35] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[16:18:35] 🔄 
🔄 Step 4: Extracting order data...
[16:18:37] ℹ️  Order extraction - MRN: '5843015'
[16:18:37] ℹ️  Order extraction - Sex: 'FEMALE'
[16:18:37] ℹ️  Order extraction - Service Line: 'OT'
[16:18:37] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[16:18:37] ✅ Order data extraction completed successfully
[16:18:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:18:37] ℹ️  Using MRN from patient data: '5843015' over '5843015'
[16:18:37] ℹ️  Service line consistent in both sources: 'OT'
[16:18:37] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[16:18:37] ✅ Patient name cross-validation successful
[16:18:37] ✅    ✅ Data merged successfully
[16:18:38] ✅    ✅ Order data extracted and validated
[16:18:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:18:47] [DOC: 9265736] ℹ️  Patient not found in cache or API: Joanne Medeiros
[16:18:47] [DOC: 9265736] ℹ️  Patient not found, creating new patient via API...
[16:18:47] [DOC: 9265736] ℹ️  Creating patient via API: Joanne Medeiros
[16:18:48] [DOC: 9265736] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:18:48] ❌    ❌ Failed to create patient
[16:18:48] [DOC: 9265736] ℹ️  API push details saved for document 9265736
================================================================================
║                        Processing Document ID: 9265734                         ║
================================================================================
[16:18:48] ℹ️  Agency: Dartmouth HH
[16:18:48] ℹ️  Date: 04/29/2025
[16:18:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[16:18:50] [DOC: 9265734] ✅ Text extracted using pdfplumber (3491 chars)
[16:18:50] ✅    ✅ Text extracted using pdfplumber (3491 chars)
[16:18:50] 🔄 
🔄 Step 2: Extracting patient data...
[16:18:53] ℹ️  AI extracted raw sex value: 'M'
[16:18:53] ℹ️  AI extracted service line: 'OT, RN, HHA'
[16:18:53] ℹ️  AI extracted payer source: 'Medicare'
[16:18:53] ℹ️  AI extracted diagnoses:
[16:18:53] ℹ️    - Diagnosis 1: 'None'
[16:18:53] ℹ️    - Diagnosis 2: 'None'
[16:18:53] ℹ️    - Diagnosis 3: 'None'
[16:18:53] ℹ️    - Diagnosis 4: 'None'
[16:18:53] ℹ️    - Diagnosis 5: 'None'
[16:18:53] ℹ️    - Diagnosis 6: 'None'
[16:18:53] ℹ️  Final extracted MRN: '864008'
[16:18:53] ℹ️  Final extracted Sex: 'MALE'
[16:18:53] ℹ️  Final extracted Service Line: 'OT, RN, HHA'
[16:18:53] ℹ️  Final extracted Payer Source: 'Medicare'
[16:18:53] ✅ Patient data extraction completed successfully
[16:18:53] ✅    ✅ Patient data extracted successfully
[16:18:53] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[16:18:53] ✅    ✅ Patient identified: Robert Lawton
[16:18:53] ✅    ✅ Patient name validation passed
[16:18:53] 🔄 
🔄 Step 3: Processing patient dates...
[16:18:53] [DOC: 9265734] ℹ️  DOB normalized: 06/15/1943
[16:18:53] [DOC: 9265734] ℹ️  Episode startOfCare normalized: 03/18/2025
[16:18:53] [DOC: 9265734] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[16:18:53] [DOC: 9265734] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[16:18:53] [DOC: 9265734] ✅ Patient date processing completed successfully
[16:18:53] ✅    ✅ Date processing completed
[16:18:53] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025'}]
[16:18:53] 🔄 
🔄 Step 4: Extracting order data...
[16:18:55] ℹ️  Order extraction - MRN: ''
[16:18:55] ℹ️  Order extraction - Sex: 'MALE'
[16:18:55] ℹ️  Order extraction - Service Line: 'OT, RN'
[16:18:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[16:18:55] ✅ Order data extraction completed successfully
[16:18:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[16:18:55] ℹ️  Using MRN from patient data: '864008'
[16:18:55] ℹ️  Combined service lines: Patient='OT, RN, HHA' + Order='OT, RN' = 'HHA, OT, RN'
[16:18:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[16:18:55] ✅ Patient name cross-validation successful
[16:18:55] ✅    ✅ Data merged successfully
[16:18:57] ✅    ✅ Order data extracted and validated
[16:18:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[16:19:05] [DOC: 9265734] ℹ️  Patient not found in cache or API: Robert Lawton
[16:19:05] [DOC: 9265734] ℹ️  Patient not found, creating new patient via API...
[16:19:05] [DOC: 9265734] ℹ️  Creating patient via API: Robert Lawton
[16:19:06] [DOC: 9265734] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[16:19:06] ❌    ❌ Failed to create patient
[16:19:06] [DOC: 9265734] ℹ️  API push details saved for document 9265734
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[16:19:06] ℹ️  Total Processed: 49
[16:19:06] ℹ️  CSV Success: 38
[16:19:06] ℹ️  CSV Errors: 0
[16:19:06] ℹ️  API Success: 0
[16:19:06] ℹ️  API Errors: 49
[16:19:06] ℹ️  CSV Success Rate: 77.6%
[16:19:06] ℹ️  API Success Rate: 0.0%
[16:19:06] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_160541.csv
[16:19:06] ℹ️  API Details File: api_outputs/api_push_details_20250607_160541.csv
================================================================================
║          ============================================================          ║
================================================================================
