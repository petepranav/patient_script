================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[14:26:42] ℹ️  CSV Data Extraction & API Push Tool
[14:26:42] ℹ️  
[14:26:42] ℹ️  Features:
[14:26:42] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[14:26:42] ℹ️  - AI-powered patient and order data extraction
[14:26:42] ℹ️  - Enhanced error handling and logging
[14:26:42] ℹ️  - Full API integration (patient creation + order pushing)
[14:26:42] ℹ️  - CSV output with comprehensive patient data
[14:26:42] ℹ️  - Detailed API tracking with remarks for every document
[14:26:42] ℹ️  - Complete audit trail of all processing attempts
[14:26:42] ℹ️  
[14:26:42] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[14:26:42] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_142642.csv
[14:26:42] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_142642.csv
================================================================================
║                        Processing Document ID: 9230377                         ║
================================================================================
[14:26:42] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:26:42] ℹ️  Date: 04/09/2025
[14:26:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:26:44] [DOC: 9230377] ✅ Text extracted using pdfplumber (1651 chars)
[14:26:44] ✅    ✅ Text extracted using pdfplumber (1651 chars)
[14:26:44] 🔄 
🔄 Step 2: Extracting patient data...
[14:26:48] ℹ️  AI extracted raw sex value: 'M'
[14:26:48] ℹ️  AI extracted service line: 'RN'
[14:26:48] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:26:48] ℹ️  AI extracted diagnoses:
[14:26:48] ℹ️    - Diagnosis 1: 'None'
[14:26:48] ℹ️    - Diagnosis 2: 'None'
[14:26:48] ℹ️    - Diagnosis 3: 'None'
[14:26:48] ℹ️    - Diagnosis 4: 'None'
[14:26:48] ℹ️    - Diagnosis 5: 'None'
[14:26:48] ℹ️    - Diagnosis 6: 'None'
[14:26:48] ℹ️  Final extracted MRN: '114004'
[14:26:48] ℹ️  Final extracted Sex: 'MALE'
[14:26:48] ℹ️  Final extracted Service Line: 'RN'
[14:26:48] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:26:48] ✅ Patient data extraction completed successfully
[14:26:48] ✅    ✅ Patient data extracted successfully
[14:26:48] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: Justin D Etter, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:26:48] ✅    ✅ Patient identified: Donald Brown
[14:26:48] ✅    ✅ Patient name validation passed
[14:26:48] 🔄 
🔄 Step 3: Processing patient dates...
[14:26:48] [DOC: 9230377] ℹ️  DOB normalized: 06/18/1949
[14:26:48] [DOC: 9230377] ℹ️  Episode startOfCare normalized: 12/01/2018
[14:26:48] [DOC: 9230377] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[14:26:48] [DOC: 9230377] ✅ Patient date processing completed successfully
[14:26:48] ✅    ✅ Date processing completed
[14:26:48] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: Justin D Etter, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'endOfEpisode': '04/27/2025'}]
[14:26:48] 🔄 
🔄 Step 4: Extracting order data...
[14:26:51] ℹ️  Order extraction - MRN: '114004'
[14:26:51] ℹ️  Order extraction - Sex: 'MALE'
[14:26:51] ℹ️  Order extraction - Service Line: ''
[14:26:51] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:26:51] ✅ Order data extraction completed successfully
[14:26:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:26:51] ℹ️  Using MRN from patient data: '114004' over '114004'
[14:26:51] ℹ️  Using service line from patient data: 'RN'
[14:26:51] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:26:51] ✅ Patient name cross-validation successful
[14:26:51] ✅    ✅ Data merged successfully
[14:26:52] ✅    ✅ Order data extracted and validated
[14:26:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:26:52] [DOC: 9230377] ✅ Patient found in local cache: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[14:26:52] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[14:26:52] 🔄 
🔄 Step 6: Pushing order to API...
[14:26:52] [DOC: 9230377] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[14:26:53] [DOC: 9230377] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:26:53] ❌    ❌ Failed to push order
[14:26:53] 🔄 
🔄 Step 7: Writing to CSV...
[14:26:53] [DOC: 9230377] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[14:26:53] [DOC: 9230377] ℹ️  Service Line extracted: 'RN'
[14:26:53] [DOC: 9230377] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:26:53] [DOC: 9230377] ℹ️  Diagnosis codes being written:
[14:26:53] [DOC: 9230377] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:26:53] [DOC: 9230377] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:26:53] [DOC: 9230377] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:26:53] [DOC: 9230377] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:26:53] [DOC: 9230377] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:26:53] [DOC: 9230377] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:26:53] [DOC: 9230377] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: RN | Payer: Senior Whole Health | MRN: 114004
[14:26:53] ✅    ✅ Document 9230377 processed and saved successfully
[14:26:53] 🔄 
🔄 Step 8: Saving API details...
[14:26:53] [DOC: 9230377] ℹ️  API push details saved for document 9230377
[14:26:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230328                         ║
================================================================================
[14:26:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:26:53] ℹ️  Date: 04/09/2025
[14:26:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:26:55] [DOC: 9230328] ✅ Text extracted using pdfplumber (11217 chars)
[14:26:55] ✅    ✅ Text extracted using pdfplumber (11205 chars)
[14:26:55] 🔄 
🔄 Step 2: Extracting patient data...
[14:26:58] ℹ️  AI extracted raw sex value: 'M'
[14:26:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:26:58] ℹ️  AI extracted payer source: 'Medicare'
[14:26:58] ℹ️  AI extracted diagnoses:
[14:26:58] ℹ️    - Diagnosis 1: 'F20.9'
[14:26:58] ℹ️    - Diagnosis 2: 'E11.69'
[14:26:58] ℹ️    - Diagnosis 3: 'I10'
[14:26:58] ℹ️    - Diagnosis 4: 'I48.0'
[14:26:58] ℹ️    - Diagnosis 5: 'None'
[14:26:58] ℹ️    - Diagnosis 6: 'None'
[14:26:58] ℹ️  Final extracted MRN: 'MA210924045601'
[14:26:58] ℹ️  Final extracted Sex: 'MALE'
[14:26:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:26:58] ℹ️  Final extracted Payer Source: 'Medicare'
[14:26:58] ✅ Patient data extraction completed successfully
[14:26:58] ✅    ✅ Patient data extracted successfully
[14:26:58] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:26:58] ✅    ✅ Patient identified: Richard Rocheleau
[14:26:58] ✅    ✅ Patient name validation passed
[14:26:58] 🔄 
🔄 Step 3: Processing patient dates...
[14:26:58] [DOC: 9230328] ℹ️  DOB normalized: 04/08/1956
[14:26:58] [DOC: 9230328] ℹ️  Episode startOfCare normalized: 05/29/2024
[14:26:58] [DOC: 9230328] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:26:58] [DOC: 9230328] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:26:58] [DOC: 9230328] ✅ Patient date processing completed successfully
[14:26:58] ✅    ✅ Date processing completed
[14:26:58] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0'}]
[14:26:58] 🔄 
🔄 Step 4: Extracting order data...
[14:27:01] ℹ️  Order extraction - MRN: 'MA210924045601'
[14:27:01] ℹ️  Order extraction - Sex: 'MALE'
[14:27:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:27:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:27:01] ✅ Order data extraction completed successfully
[14:27:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:27:01] ℹ️  Using MRN from patient data: 'MA210924045601' over 'MA210924045601'
[14:27:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:27:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:27:01] ✅ Patient name cross-validation successful
[14:27:01] ✅    ✅ Data merged successfully
[14:27:02] ✅    ✅ Order data extracted and validated
[14:27:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:27:02] [DOC: 9230328] ✅ Patient found in local cache: Richard Rocheleau, ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[14:27:02] ✅    ✅ Existing patient found with ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[14:27:02] 🔄 
🔄 Step 6: Pushing order to API...
[14:27:02] [DOC: 9230328] ℹ️  Pushing order via API for patient ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[14:27:06] [DOC: 9230328] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14265"}
[14:27:06] ❌    ❌ Failed to push order
[14:27:06] 🔄 
🔄 Step 7: Writing to CSV...
[14:27:06] [DOC: 9230328] ℹ️  Calculated age: 69 from DOB: 04/08/1956
[14:27:06] [DOC: 9230328] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:27:06] [DOC: 9230328] ℹ️  Payer Source extracted: 'Medicare'
[14:27:06] [DOC: 9230328] ℹ️  Diagnosis codes being written:
[14:27:06] [DOC: 9230328] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[14:27:06] [DOC: 9230328] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.69'
[14:27:06] [DOC: 9230328] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[14:27:06] [DOC: 9230328] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[14:27:06] [DOC: 9230328] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:27:06] [DOC: 9230328] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:27:06] [DOC: 9230328] ✅ Patient data written to CSV: Richard Rocheleau | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer: Medicare | MRN: MA210924045601
[14:27:06] ✅    ✅ Document 9230328 processed and saved successfully
[14:27:06] 🔄 
🔄 Step 8: Saving API details...
[14:27:06] [DOC: 9230328] ℹ️  API push details saved for document 9230328
[14:27:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230322                         ║
================================================================================
[14:27:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:27:06] ℹ️  Date: 04/09/2025
[14:27:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:27:08] [DOC: 9230322] ✅ Text extracted using pdfplumber (1367 chars)
[14:27:08] ✅    ✅ Text extracted using pdfplumber (1367 chars)
[14:27:08] 🔄 
🔄 Step 2: Extracting patient data...
[14:27:11] ℹ️  AI extracted raw sex value: ''
[14:27:11] ℹ️  AI extracted service line: 'Physical Therapy'
[14:27:11] ℹ️  AI extracted payer source: ''
[14:27:11] ℹ️  AI extracted diagnoses:
[14:27:11] ℹ️    - Diagnosis 1: 'S81.801'
[14:27:11] ℹ️    - Diagnosis 2: 'E11.51'
[14:27:11] ℹ️    - Diagnosis 3: 'I70.209'
[14:27:11] ℹ️    - Diagnosis 4: 'None'
[14:27:11] ℹ️    - Diagnosis 5: 'None'
[14:27:11] ℹ️    - Diagnosis 6: 'None'
[14:27:11] ℹ️  Final extracted MRN: 'MA200528053701'
[14:27:11] ℹ️  Final extracted Sex: ''
[14:27:11] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:27:11] ℹ️  Final extracted Payer Source: ''
[14:27:11] ✅ Patient data extraction completed successfully
[14:27:11] ✅    ✅ Patient data extracted successfully
[14:27:11] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:27:11] ✅    ✅ Patient identified: Roderick Lopez
[14:27:11] ✅    ✅ Patient name validation passed
[14:27:11] 🔄 
🔄 Step 3: Processing patient dates...
[14:27:11] [DOC: 9230322] ℹ️  DOB normalized: 05/21/1937
[14:27:11] [DOC: 9230322] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[14:27:11] [DOC: 9230322] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[14:27:11] [DOC: 9230322] ✅ Patient date processing completed successfully
[14:27:11] ✅    ✅ Date processing completed
[14:27:11] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209'}]
[14:27:11] 🔄 
🔄 Step 4: Extracting order data...
[14:27:14] ℹ️  Order extraction - MRN: 'MA200528053701'
[14:27:14] ℹ️  Order extraction - Sex: ''
[14:27:14] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:27:14] ℹ️  Order extraction - Payer Source: ''
[14:27:14] ✅ Order data extraction completed successfully
[14:27:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:27:14] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[14:27:14] ℹ️  Inferred sex as MALE from name: Roderick
[14:27:14] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:27:14] ✅ Patient name cross-validation successful
[14:27:14] ✅    ✅ Data merged successfully
[14:27:15] ✅    ✅ Order data extracted and validated
[14:27:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:27:35] [DOC: 9230322] ℹ️  Patient not found in cache or API: Roderick Lopez
[14:27:35] [DOC: 9230322] ℹ️  Patient not found, creating new patient via API...
[14:27:35] [DOC: 9230322] ℹ️  Creating patient via API: Roderick Lopez
[14:27:36] [DOC: 9230322] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:27:36] ❌    ❌ Failed to create patient
[14:27:36] [DOC: 9230322] ℹ️  API push details saved for document 9230322
================================================================================
║                        Processing Document ID: 9230316                         ║
================================================================================
[14:27:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:27:36] ℹ️  Date: 04/09/2025
[14:27:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:27:40] [DOC: 9230316] ✅ Text extracted using pdfplumber (1332 chars)
[14:27:40] ✅    ✅ Text extracted using pdfplumber (1332 chars)
[14:27:40] 🔄 
🔄 Step 2: Extracting patient data...
[14:27:42] ℹ️  AI extracted raw sex value: ''
[14:27:42] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:27:42] ℹ️  AI extracted payer source: ''
[14:27:42] ℹ️  AI extracted diagnoses:
[14:27:42] ℹ️    - Diagnosis 1: 'F03.90'
[14:27:42] ℹ️    - Diagnosis 2: 'R60.9'
[14:27:42] ℹ️    - Diagnosis 3: 'G47.9'
[14:27:42] ℹ️    - Diagnosis 4: ''
[14:27:42] ℹ️    - Diagnosis 5: ''
[14:27:42] ℹ️    - Diagnosis 6: ''
[14:27:42] ℹ️  Final extracted MRN: 'MA221012023702'
[14:27:42] ℹ️  Final extracted Sex: ''
[14:27:42] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:27:42] ℹ️  Final extracted Payer Source: ''
[14:27:42] ✅ Patient data extraction completed successfully
[14:27:42] ✅    ✅ Patient data extracted successfully
[14:27:42] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:27:42] ✅    ✅ Patient identified: Mary Pedra
[14:27:42] ✅    ✅ Patient name validation passed
[14:27:42] 🔄 
🔄 Step 3: Processing patient dates...
[14:27:42] [DOC: 9230316] ℹ️  DOB normalized: 02/27/1937
[14:27:42] [DOC: 9230316] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[14:27:42] [DOC: 9230316] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[14:27:42] [DOC: 9230316] ✅ Patient date processing completed successfully
[14:27:42] ✅    ✅ Date processing completed
[14:27:42] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:27:42] 🔄 
🔄 Step 4: Extracting order data...
[14:27:45] ℹ️  Order extraction - MRN: 'MA221012023702'
[14:27:45] ℹ️  Order extraction - Sex: ''
[14:27:45] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:27:45] ℹ️  Order extraction - Payer Source: ''
[14:27:45] ✅ Order data extraction completed successfully
[14:27:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:27:45] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[14:27:45] ℹ️  Inferred sex as FEMALE from name: Mary
[14:27:45] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:27:45] ✅ Patient name cross-validation successful
[14:27:45] ✅    ✅ Data merged successfully
[14:27:46] ✅    ✅ Order data extracted and validated
[14:27:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:27:46] [DOC: 9230316] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[14:27:46] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[14:27:46] 🔄 
🔄 Step 6: Pushing order to API...
[14:27:46] [DOC: 9230316] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[14:27:48] [DOC: 9230316] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12995"}
[14:27:48] ❌    ❌ Failed to push order
[14:27:48] 🔄 
🔄 Step 7: Writing to CSV...
[14:27:48] [DOC: 9230316] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[14:27:48] [DOC: 9230316] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:27:48] [DOC: 9230316] ℹ️  Payer Source extracted: ''
[14:27:48] [DOC: 9230316] ℹ️  Diagnosis codes being written:
[14:27:48] [DOC: 9230316] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[14:27:48] [DOC: 9230316] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[14:27:48] [DOC: 9230316] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[14:27:48] [DOC: 9230316] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:27:48] [DOC: 9230316] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:27:48] [DOC: 9230316] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:27:48] [DOC: 9230316] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA221012023702
[14:27:48] ✅    ✅ Document 9230316 processed and saved successfully
[14:27:48] 🔄 
🔄 Step 8: Saving API details...
[14:27:48] [DOC: 9230316] ℹ️  API push details saved for document 9230316
[14:27:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230315                         ║
================================================================================
[14:27:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:27:48] ℹ️  Date: 04/09/2025
[14:27:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:27:52] [DOC: 9230315] ✅ Text extracted using pdfplumber (1324 chars)
[14:27:52] ✅    ✅ Text extracted using pdfplumber (1324 chars)
[14:27:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:27:55] ℹ️  AI extracted raw sex value: ''
[14:27:55] ℹ️  AI extracted service line: 'Physical Therapy'
[14:27:55] ℹ️  AI extracted payer source: ''
[14:27:55] ℹ️  AI extracted diagnoses:
[14:27:55] ℹ️    - Diagnosis 1: 'F03.90'
[14:27:55] ℹ️    - Diagnosis 2: 'R60.9'
[14:27:55] ℹ️    - Diagnosis 3: 'G47.9'
[14:27:55] ℹ️    - Diagnosis 4: ''
[14:27:55] ℹ️    - Diagnosis 5: ''
[14:27:55] ℹ️    - Diagnosis 6: ''
[14:27:55] ℹ️  Final extracted MRN: 'MA221012023702'
[14:27:55] ℹ️  Final extracted Sex: ''
[14:27:55] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:27:55] ℹ️  Final extracted Payer Source: ''
[14:27:55] ✅ Patient data extraction completed successfully
[14:27:55] ✅    ✅ Patient data extracted successfully
[14:27:55] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:27:55] ✅    ✅ Patient identified: Mary Pedra
[14:27:55] ✅    ✅ Patient name validation passed
[14:27:55] 🔄 
🔄 Step 3: Processing patient dates...
[14:27:55] [DOC: 9230315] ℹ️  DOB normalized: 02/27/1937
[14:27:55] [DOC: 9230315] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[14:27:55] [DOC: 9230315] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[14:27:55] [DOC: 9230315] ✅ Patient date processing completed successfully
[14:27:55] ✅    ✅ Date processing completed
[14:27:55] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:27:55] 🔄 
🔄 Step 4: Extracting order data...
[14:27:57] ℹ️  Order extraction - MRN: 'MA221012023702'
[14:27:57] ℹ️  Order extraction - Sex: ''
[14:27:57] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:27:57] ℹ️  Order extraction - Payer Source: ''
[14:27:57] ✅ Order data extraction completed successfully
[14:27:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:27:57] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[14:27:57] ℹ️  Inferred sex as FEMALE from name: Mary
[14:27:57] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:27:57] ✅ Patient name cross-validation successful
[14:27:57] ✅    ✅ Data merged successfully
[14:27:59] ✅    ✅ Order data extracted and validated
[14:27:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:27:59] [DOC: 9230315] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[14:27:59] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[14:27:59] 🔄 
🔄 Step 6: Pushing order to API...
[14:27:59] [DOC: 9230315] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[14:28:00] [DOC: 9230315] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12996"}
[14:28:00] ❌    ❌ Failed to push order
[14:28:00] 🔄 
🔄 Step 7: Writing to CSV...
[14:28:00] [DOC: 9230315] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[14:28:00] [DOC: 9230315] ℹ️  Service Line extracted: 'Physical Therapy'
[14:28:00] [DOC: 9230315] ℹ️  Payer Source extracted: ''
[14:28:00] [DOC: 9230315] ℹ️  Diagnosis codes being written:
[14:28:00] [DOC: 9230315] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[14:28:00] [DOC: 9230315] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[14:28:00] [DOC: 9230315] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[14:28:00] [DOC: 9230315] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:28:00] [DOC: 9230315] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:28:00] [DOC: 9230315] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:28:00] [DOC: 9230315] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA221012023702
[14:28:00] ✅    ✅ Document 9230315 processed and saved successfully
[14:28:00] 🔄 
🔄 Step 8: Saving API details...
[14:28:00] [DOC: 9230315] ℹ️  API push details saved for document 9230315
[14:28:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230296                         ║
================================================================================
[14:28:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:28:00] ℹ️  Date: 04/09/2025
[14:28:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:28:02] [DOC: 9230296] ✅ Text extracted using pdfplumber (12973 chars)
[14:28:02] ✅    ✅ Text extracted using pdfplumber (12973 chars)
[14:28:02] 🔄 
🔄 Step 2: Extracting patient data...
[14:28:05] ℹ️  AI extracted raw sex value: 'F'
[14:28:05] ℹ️  AI extracted service line: 'OT'
[14:28:05] ℹ️  AI extracted payer source: ''
[14:28:05] ℹ️  AI extracted diagnoses:
[14:28:05] ℹ️    - Diagnosis 1: 'PNA from COVID-19'
[14:28:05] ℹ️    - Diagnosis 2: ''
[14:28:05] ℹ️    - Diagnosis 3: ''
[14:28:05] ℹ️    - Diagnosis 4: ''
[14:28:05] ℹ️    - Diagnosis 5: ''
[14:28:05] ℹ️    - Diagnosis 6: ''
[14:28:05] ℹ️  Final extracted MRN: 'MA250110074701'
[14:28:05] ℹ️  Final extracted Sex: 'FEMALE'
[14:28:05] ℹ️  Final extracted Service Line: 'OT'
[14:28:05] ℹ️  Final extracted Payer Source: ''
[14:28:05] ✅ Patient data extraction completed successfully
[14:28:05] ✅    ✅ Patient data extracted successfully
[14:28:05] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': 'PNA from COVID-19', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:28:05] ✅    ✅ Patient identified: Gloria Couto
[14:28:05] ✅    ✅ Patient name validation passed
[14:28:05] 🔄 
🔄 Step 3: Processing patient dates...
[14:28:05] [DOC: 9230296] ℹ️  DOB normalized: 07/30/1947
[14:28:05] [DOC: 9230296] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[14:28:05] [DOC: 9230296] ℹ️  Episode endOfEpisode normalized: 02/26/2025
[14:28:05] [DOC: 9230296] ✅ Patient date processing completed successfully
[14:28:05] ✅    ✅ Date processing completed
[14:28:05] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: Dr. Potts, Earl
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': 'PNA from COVID-19', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:28:05] 🔄 
🔄 Step 4: Extracting order data...
[14:28:08] ℹ️  Order extraction - MRN: 'MA250110074701'
[14:28:08] ℹ️  Order extraction - Sex: 'FEMALE'
[14:28:08] ℹ️  Order extraction - Service Line: 'OT'
[14:28:08] ℹ️  Order extraction - Payer Source: ''
[14:28:08] ✅ Order data extraction completed successfully
[14:28:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:28:08] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[14:28:08] ℹ️  Service line consistent in both sources: 'OT'
[14:28:08] ✅ Patient name cross-validation successful
[14:28:08] ✅    ✅ Data merged successfully
[14:28:09] ✅    ✅ Order data extracted and validated
[14:28:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:28:09] [DOC: 9230296] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[14:28:09] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[14:28:09] 🔄 
🔄 Step 6: Pushing order to API...
[14:28:09] [DOC: 9230296] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[14:28:10] [DOC: 9230296] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:28:10] ❌    ❌ Failed to push order
[14:28:10] 🔄 
🔄 Step 7: Writing to CSV...
[14:28:10] [DOC: 9230296] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[14:28:10] [DOC: 9230296] ℹ️  Service Line extracted: 'OT'
[14:28:10] [DOC: 9230296] ℹ️  Payer Source extracted: ''
[14:28:10] [DOC: 9230296] ℹ️  Diagnosis codes being written:
[14:28:10] [DOC: 9230296] ℹ️    - Latest_Episode_Firstdiagnosis: 'PNA from COVID-19'
[14:28:10] [DOC: 9230296] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:28:10] [DOC: 9230296] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:28:10] [DOC: 9230296] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:28:10] [DOC: 9230296] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:28:10] [DOC: 9230296] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:28:10] [DOC: 9230296] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT | Payer:  | MRN: MA250110074701
[14:28:10] ✅    ✅ Document 9230296 processed and saved successfully
[14:28:10] 🔄 
🔄 Step 8: Saving API details...
[14:28:10] [DOC: 9230296] ℹ️  API push details saved for document 9230296
[14:28:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230221                         ║
================================================================================
[14:28:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:28:10] ℹ️  Date: 04/09/2025
[14:28:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:28:12] [DOC: 9230221] ✅ Text extracted using pdfplumber (1259 chars)
[14:28:12] ✅    ✅ Text extracted using pdfplumber (1247 chars)
[14:28:12] 🔄 
🔄 Step 2: Extracting patient data...
[14:28:15] ℹ️  AI extracted raw sex value: ''
[14:28:15] ℹ️  AI extracted service line: 'RN'
[14:28:15] ℹ️  AI extracted payer source: ''
[14:28:15] ℹ️  AI extracted diagnoses:
[14:28:15] ℹ️    - Diagnosis 1: 'F32.A'
[14:28:15] ℹ️    - Diagnosis 2: 'F41.9'
[14:28:15] ℹ️    - Diagnosis 3: 'J44.9'
[14:28:15] ℹ️    - Diagnosis 4: ''
[14:28:15] ℹ️    - Diagnosis 5: ''
[14:28:15] ℹ️    - Diagnosis 6: ''
[14:28:15] ℹ️  Final extracted MRN: 'MA230315023303'
[14:28:15] ℹ️  Final extracted Sex: ''
[14:28:15] ℹ️  Final extracted Service Line: 'RN'
[14:28:15] ℹ️  Final extracted Payer Source: ''
[14:28:15] ✅ Patient data extraction completed successfully
[14:28:15] ✅    ✅ Patient data extracted successfully
[14:28:15] 📊 Patient Response
     └─ patientFName: Alice
     └─ patientLName: Frates
     └─ dob: 02/13/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA230315023303
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:28:15] ✅    ✅ Patient identified: Alice Frates
[14:28:15] ✅    ✅ Patient name validation passed
[14:28:15] 🔄 
🔄 Step 3: Processing patient dates...
[14:28:15] [DOC: 9230221] ℹ️  DOB normalized: 02/13/1933
[14:28:15] [DOC: 9230221] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[14:28:15] [DOC: 9230221] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[14:28:15] [DOC: 9230221] ✅ Patient date processing completed successfully
[14:28:15] ✅    ✅ Date processing completed
[14:28:15] 📊 Processed Patient Data
     └─ patientFName: Alice
     └─ patientLName: Frates
     └─ dob: 02/13/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA230315023303
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'F32.A', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:28:15] 🔄 
🔄 Step 4: Extracting order data...
[14:28:18] ℹ️  Order extraction - MRN: 'MA230315023303'
[14:28:18] ℹ️  Order extraction - Sex: ''
[14:28:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:28:18] ℹ️  Order extraction - Payer Source: ''
[14:28:18] ✅ Order data extraction completed successfully
[14:28:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:28:18] ℹ️  Using MRN from patient data: 'MA230315023303' over 'MA230315023303'
[14:28:18] ⚠️  Could not determine sex using any available method
[14:28:18] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[14:28:18] ✅ Patient name cross-validation successful
[14:28:18] ✅    ✅ Data merged successfully
[14:28:19] ✅    ✅ Order data extracted and validated
[14:28:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:28:19] [DOC: 9230221] ✅ Patient found in local cache: Alice Frates, ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[14:28:19] ✅    ✅ Existing patient found with ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[14:28:19] 🔄 
🔄 Step 6: Pushing order to API...
[14:28:19] [DOC: 9230221] ℹ️  Pushing order via API for patient ID: cbfbad22-0f9a-45e1-92c5-4b239b4ea390
[14:28:20] [DOC: 9230221] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12908"}
[14:28:20] ❌    ❌ Failed to push order
[14:28:20] 🔄 
🔄 Step 7: Writing to CSV...
[14:28:20] [DOC: 9230221] ℹ️  Calculated age: 92 from DOB: 02/13/1933
[14:28:20] [DOC: 9230221] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[14:28:20] [DOC: 9230221] ℹ️  Payer Source extracted: ''
[14:28:20] [DOC: 9230221] ℹ️  Diagnosis codes being written:
[14:28:20] [DOC: 9230221] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.A'
[14:28:20] [DOC: 9230221] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[14:28:20] [DOC: 9230221] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[14:28:20] [DOC: 9230221] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:28:20] [DOC: 9230221] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:28:20] [DOC: 9230221] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:28:20] [DOC: 9230221] ✅ Patient data written to CSV: Alice Frates | Sex:  | Age: 92 | Service: RN, Skilled Nursing | Payer:  | MRN: MA230315023303
[14:28:20] ✅    ✅ Document 9230221 processed and saved successfully
[14:28:20] 🔄 
🔄 Step 8: Saving API details...
[14:28:20] [DOC: 9230221] ℹ️  API push details saved for document 9230221
[14:28:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230216                         ║
================================================================================
[14:28:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:28:20] ℹ️  Date: 04/09/2025
[14:28:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:28:22] [DOC: 9230216] ✅ Text extracted using pdfplumber (1547 chars)
[14:28:22] ✅    ✅ Text extracted using pdfplumber (1535 chars)
[14:28:22] 🔄 
🔄 Step 2: Extracting patient data...
[14:28:25] ℹ️  AI extracted raw sex value: ''
[14:28:25] ℹ️  AI extracted service line: 'Physical Therapy'
[14:28:25] ℹ️  AI extracted payer source: ''
[14:28:25] ℹ️  AI extracted diagnoses:
[14:28:25] ℹ️    - Diagnosis 1: 'S72.001'
[14:28:25] ℹ️    - Diagnosis 2: 'I48.91'
[14:28:25] ℹ️    - Diagnosis 3: 'I12.9'
[14:28:25] ℹ️    - Diagnosis 4: 'None'
[14:28:25] ℹ️    - Diagnosis 5: 'None'
[14:28:25] ℹ️    - Diagnosis 6: 'None'
[14:28:25] ℹ️  Final extracted MRN: 'MA250324024402'
[14:28:25] ℹ️  Final extracted Sex: ''
[14:28:25] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:28:25] ℹ️  Final extracted Payer Source: ''
[14:28:25] ✅ Patient data extraction completed successfully
[14:28:25] ✅    ✅ Patient data extracted successfully
[14:28:25] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'S72.001', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:28:25] ✅    ✅ Patient identified: Ronald Ferreira
[14:28:25] ✅    ✅ Patient name validation passed
[14:28:25] 🔄 
🔄 Step 3: Processing patient dates...
[14:28:25] [DOC: 9230216] ℹ️  DOB normalized: 02/01/1944
[14:28:25] [DOC: 9230216] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[14:28:25] [DOC: 9230216] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[14:28:25] [DOC: 9230216] ✅ Patient date processing completed successfully
[14:28:25] ✅    ✅ Date processing completed
[14:28:25] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'S72.001', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I12.9'}]
[14:28:25] 🔄 
🔄 Step 4: Extracting order data...
[14:28:28] ℹ️  Order extraction - MRN: 'MA250324024402'
[14:28:28] ℹ️  Order extraction - Sex: ''
[14:28:28] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:28:28] ℹ️  Order extraction - Payer Source: ''
[14:28:28] ✅ Order data extraction completed successfully
[14:28:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:28:28] ℹ️  Using MRN from patient data: 'MA250324024402' over 'MA250324024402'
[14:28:28] ℹ️  Inferred sex as MALE from name: Ronald
[14:28:28] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:28:28] ✅ Patient name cross-validation successful
[14:28:28] ✅    ✅ Data merged successfully
[14:28:29] ✅    ✅ Order data extracted and validated
[14:28:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:28:29] [DOC: 9230216] ✅ Patient found in local cache: Ronald Ferreira, ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:29] ✅    ✅ Existing patient found with ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:28:29] [DOC: 9230216] ℹ️  Pushing order via API for patient ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:31] [DOC: 9230216] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14012"}
[14:28:31] ❌    ❌ Failed to push order
[14:28:31] 🔄 
🔄 Step 7: Writing to CSV...
[14:28:31] [DOC: 9230216] ℹ️  Calculated age: 81 from DOB: 02/01/1944
[14:28:31] [DOC: 9230216] ℹ️  Service Line extracted: 'Physical Therapy'
[14:28:31] [DOC: 9230216] ℹ️  Payer Source extracted: ''
[14:28:31] [DOC: 9230216] ℹ️  Diagnosis codes being written:
[14:28:31] [DOC: 9230216] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.001'
[14:28:31] [DOC: 9230216] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.91'
[14:28:31] [DOC: 9230216] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[14:28:31] [DOC: 9230216] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:28:31] [DOC: 9230216] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:28:31] [DOC: 9230216] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:28:31] [DOC: 9230216] ✅ Patient data written to CSV: Ronald Ferreira | Sex: MALE | Age: 81 | Service: Physical Therapy | Payer:  | MRN: MA250324024402
[14:28:31] ✅    ✅ Document 9230216 processed and saved successfully
[14:28:31] 🔄 
🔄 Step 8: Saving API details...
[14:28:31] [DOC: 9230216] ℹ️  API push details saved for document 9230216
[14:28:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230214                         ║
================================================================================
[14:28:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:28:31] ℹ️  Date: 04/09/2025
[14:28:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:28:33] [DOC: 9230214] ✅ Text extracted using pdfplumber (1630 chars)
[14:28:33] ✅    ✅ Text extracted using pdfplumber (1618 chars)
[14:28:33] 🔄 
🔄 Step 2: Extracting patient data...
[14:28:37] ℹ️  AI extracted raw sex value: ''
[14:28:37] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:28:37] ℹ️  AI extracted payer source: ''
[14:28:37] ℹ️  AI extracted diagnoses:
[14:28:37] ℹ️    - Diagnosis 1: 'S72.001'
[14:28:37] ℹ️    - Diagnosis 2: 'I48.91'
[14:28:37] ℹ️    - Diagnosis 3: 'I12.9'
[14:28:37] ℹ️    - Diagnosis 4: 'None'
[14:28:37] ℹ️    - Diagnosis 5: 'None'
[14:28:37] ℹ️    - Diagnosis 6: 'None'
[14:28:37] ℹ️  Final extracted MRN: 'MA250324024402'
[14:28:37] ℹ️  Final extracted Sex: ''
[14:28:37] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:28:37] ℹ️  Final extracted Payer Source: ''
[14:28:37] ✅ Patient data extraction completed successfully
[14:28:37] ✅    ✅ Patient data extracted successfully
[14:28:37] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'S72.001', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:28:37] ✅    ✅ Patient identified: Ronald Ferreira
[14:28:37] ✅    ✅ Patient name validation passed
[14:28:37] 🔄 
🔄 Step 3: Processing patient dates...
[14:28:37] [DOC: 9230214] ℹ️  DOB normalized: 02/01/1944
[14:28:37] [DOC: 9230214] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[14:28:37] [DOC: 9230214] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[14:28:37] [DOC: 9230214] ✅ Patient date processing completed successfully
[14:28:37] ✅    ✅ Date processing completed
[14:28:37] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'S72.001', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I12.9'}]
[14:28:37] 🔄 
🔄 Step 4: Extracting order data...
[14:28:39] ℹ️  Order extraction - MRN: 'MA250324024402'
[14:28:39] ℹ️  Order extraction - Sex: ''
[14:28:39] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:28:39] ℹ️  Order extraction - Payer Source: ''
[14:28:39] ✅ Order data extraction completed successfully
[14:28:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:28:39] ℹ️  Using MRN from patient data: 'MA250324024402' over 'MA250324024402'
[14:28:39] ℹ️  Inferred sex as MALE from name: Ronald
[14:28:39] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:28:39] ✅ Patient name cross-validation successful
[14:28:39] ✅    ✅ Data merged successfully
[14:28:40] ✅    ✅ Order data extracted and validated
[14:28:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:28:40] [DOC: 9230214] ✅ Patient found in local cache: Ronald Ferreira, ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:40] ✅    ✅ Existing patient found with ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:40] 🔄 
🔄 Step 6: Pushing order to API...
[14:28:40] [DOC: 9230214] ℹ️  Pushing order via API for patient ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:41] [DOC: 9230214] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14013"}
[14:28:41] ❌    ❌ Failed to push order
[14:28:41] 🔄 
🔄 Step 7: Writing to CSV...
[14:28:41] [DOC: 9230214] ℹ️  Calculated age: 81 from DOB: 02/01/1944
[14:28:41] [DOC: 9230214] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:28:41] [DOC: 9230214] ℹ️  Payer Source extracted: ''
[14:28:41] [DOC: 9230214] ℹ️  Diagnosis codes being written:
[14:28:41] [DOC: 9230214] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.001'
[14:28:41] [DOC: 9230214] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.91'
[14:28:41] [DOC: 9230214] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[14:28:41] [DOC: 9230214] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:28:41] [DOC: 9230214] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:28:41] [DOC: 9230214] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:28:41] [DOC: 9230214] ✅ Patient data written to CSV: Ronald Ferreira | Sex: MALE | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: MA250324024402
[14:28:41] ✅    ✅ Document 9230214 processed and saved successfully
[14:28:41] 🔄 
🔄 Step 8: Saving API details...
[14:28:41] [DOC: 9230214] ℹ️  API push details saved for document 9230214
[14:28:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230213                         ║
================================================================================
[14:28:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:28:41] ℹ️  Date: 04/09/2025
[14:28:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:28:48] [DOC: 9230213] ✅ Text extracted using pdfplumber (13975 chars)
[14:28:48] ✅    ✅ Text extracted using pdfplumber (13975 chars)
[14:28:48] 🔄 
🔄 Step 2: Extracting patient data...
[14:28:51] ℹ️  AI extracted raw sex value: 'M'
[14:28:51] ℹ️  AI extracted service line: 'OT'
[14:28:51] ℹ️  AI extracted payer source: ''
[14:28:51] ℹ️  AI extracted diagnoses:
[14:28:51] ℹ️    - Diagnosis 1: 'Right Femur ORIF'
[14:28:51] ℹ️    - Diagnosis 2: 'muscle weakness'
[14:28:51] ℹ️    - Diagnosis 3: 'None'
[14:28:51] ℹ️    - Diagnosis 4: 'None'
[14:28:51] ℹ️    - Diagnosis 5: 'None'
[14:28:51] ℹ️    - Diagnosis 6: 'None'
[14:28:51] ℹ️  Final extracted MRN: 'MA250324024402'
[14:28:51] ℹ️  Final extracted Sex: 'MALE'
[14:28:51] ℹ️  Final extracted Service Line: 'OT'
[14:28:51] ℹ️  Final extracted Payer Source: ''
[14:28:51] ✅ Patient data extraction completed successfully
[14:28:51] ✅    ✅ Patient data extracted successfully
[14:28:51] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Right Femur ORIF', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:28:51] ✅    ✅ Patient identified: Ronald Ferreira
[14:28:51] ✅    ✅ Patient name validation passed
[14:28:51] 🔄 
🔄 Step 3: Processing patient dates...
[14:28:51] [DOC: 9230213] ℹ️  DOB normalized: 02/01/1944
[14:28:51] [DOC: 9230213] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[14:28:51] [DOC: 9230213] ✅ Patient date processing completed successfully
[14:28:51] ✅    ✅ Date processing completed
[14:28:51] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'firstDiagnosis': 'Right Femur ORIF', 'secondDiagnosis': 'muscle weakness'}]
[14:28:51] 🔄 
🔄 Step 4: Extracting order data...
[14:28:54] ℹ️  Order extraction - MRN: 'MA250324024402'
[14:28:54] ℹ️  Order extraction - Sex: 'MALE'
[14:28:54] ℹ️  Order extraction - Service Line: 'OT'
[14:28:54] ℹ️  Order extraction - Payer Source: ''
[14:28:54] ✅ Order data extraction completed successfully
[14:28:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:28:54] ℹ️  Using MRN from patient data: 'MA250324024402' over 'MA250324024402'
[14:28:54] ℹ️  Service line consistent in both sources: 'OT'
[14:28:54] ✅ Patient name cross-validation successful
[14:28:54] ✅    ✅ Data merged successfully
[14:28:55] ✅    ✅ Order data extracted and validated
[14:28:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:28:55] [DOC: 9230213] ✅ Patient found in local cache: Ronald Ferreira, ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:55] ✅    ✅ Existing patient found with ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:55] 🔄 
🔄 Step 6: Pushing order to API...
[14:28:55] [DOC: 9230213] ℹ️  Pushing order via API for patient ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:28:56] [DOC: 9230213] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:28:56] ❌    ❌ Failed to push order
[14:28:56] 🔄 
🔄 Step 7: Writing to CSV...
[14:28:56] [DOC: 9230213] ℹ️  Calculated age: 81 from DOB: 02/01/1944
[14:28:56] [DOC: 9230213] ℹ️  Service Line extracted: 'OT'
[14:28:56] [DOC: 9230213] ℹ️  Payer Source extracted: ''
[14:28:56] [DOC: 9230213] ℹ️  Diagnosis codes being written:
[14:28:56] [DOC: 9230213] ℹ️    - Latest_Episode_Firstdiagnosis: 'Right Femur ORIF'
[14:28:56] [DOC: 9230213] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[14:28:56] [DOC: 9230213] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:28:56] [DOC: 9230213] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:28:56] [DOC: 9230213] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:28:56] [DOC: 9230213] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:28:56] [DOC: 9230213] ✅ Patient data written to CSV: Ronald Ferreira | Sex: MALE | Age: 81 | Service: OT | Payer:  | MRN: MA250324024402
[14:28:56] ✅    ✅ Document 9230213 processed and saved successfully
[14:28:56] 🔄 
🔄 Step 8: Saving API details...
[14:28:56] [DOC: 9230213] ℹ️  API push details saved for document 9230213
[14:28:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230209                         ║
================================================================================
[14:28:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:28:56] ℹ️  Date: 04/09/2025
[14:28:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:28:59] [DOC: 9230209] ✅ Text extracted using pdfplumber (18767 chars)
[14:28:59] ✅    ✅ Text extracted using pdfplumber (18755 chars)
[14:28:59] 🔄 
🔄 Step 2: Extracting patient data...
[14:29:02] ℹ️  AI extracted raw sex value: 'M'
[14:29:02] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:29:02] ℹ️  AI extracted payer source: 'Medicare'
[14:29:02] ℹ️  AI extracted diagnoses:
[14:29:02] ℹ️    - Diagnosis 1: 'S72.001'
[14:29:02] ℹ️    - Diagnosis 2: 'I48.91'
[14:29:02] ℹ️    - Diagnosis 3: 'I12.9'
[14:29:02] ℹ️    - Diagnosis 4: 'N18.9'
[14:29:02] ℹ️    - Diagnosis 5: 'N40.0'
[14:29:02] ℹ️    - Diagnosis 6: 'F32.A'
[14:29:02] ℹ️  Final extracted MRN: 'MA250324024402'
[14:29:02] ℹ️  Final extracted Sex: 'MALE'
[14:29:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:29:02] ℹ️  Final extracted Payer Source: 'Medicare'
[14:29:02] ✅ Patient data extraction completed successfully
[14:29:02] ✅    ✅ Patient data extracted successfully
[14:29:02] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: POTHIER, JAHN MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 415 County St, Apt 314
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 840-5592
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'S72.001', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'N40.0', 'sixthDiagnosis': 'F32.A'}]
[14:29:02] ✅    ✅ Patient identified: Ronald Ferreira
[14:29:02] ✅    ✅ Patient name validation passed
[14:29:02] 🔄 
🔄 Step 3: Processing patient dates...
[14:29:02] [DOC: 9230209] ℹ️  DOB normalized: 02/01/1944
[14:29:02] [DOC: 9230209] ℹ️  Episode startOfCare normalized: 03/28/2025
[14:29:02] [DOC: 9230209] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[14:29:02] [DOC: 9230209] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[14:29:02] [DOC: 9230209] ✅ Patient date processing completed successfully
[14:29:02] ✅    ✅ Date processing completed
[14:29:02] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: POTHIER, JAHN MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 415 County St, Apt 314
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 840-5592
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'S72.001', 'secondDiagnosis': 'I48.91', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'N40.0', 'sixthDiagnosis': 'F32.A'}]
[14:29:02] 🔄 
🔄 Step 4: Extracting order data...
[14:29:05] ℹ️  Order extraction - MRN: 'MA250324024402'
[14:29:05] ℹ️  Order extraction - Sex: 'MALE'
[14:29:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:29:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:29:05] ✅ Order data extraction completed successfully
[14:29:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:29:05] ℹ️  Using MRN from patient data: 'MA250324024402' over 'MA250324024402'
[14:29:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:29:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:29:05] ✅ Patient name cross-validation successful
[14:29:05] ✅    ✅ Data merged successfully
[14:29:06] ✅    ✅ Order data extracted and validated
[14:29:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:29:06] [DOC: 9230209] ✅ Patient found in local cache: Ronald Ferreira, ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:29:06] ✅    ✅ Existing patient found with ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:29:06] 🔄 
🔄 Step 6: Pushing order to API...
[14:29:06] [DOC: 9230209] ℹ️  Pushing order via API for patient ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[14:29:07] [DOC: 9230209] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14016"}
[14:29:07] ❌    ❌ Failed to push order
[14:29:07] 🔄 
🔄 Step 7: Writing to CSV...
[14:29:07] [DOC: 9230209] ℹ️  Calculated age: 81 from DOB: 02/01/1944
[14:29:07] [DOC: 9230209] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:29:07] [DOC: 9230209] ℹ️  Payer Source extracted: 'Medicare'
[14:29:07] [DOC: 9230209] ℹ️  Diagnosis codes being written:
[14:29:07] [DOC: 9230209] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.001'
[14:29:07] [DOC: 9230209] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48.91'
[14:29:07] [DOC: 9230209] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[14:29:07] [DOC: 9230209] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.9'
[14:29:07] [DOC: 9230209] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N40.0'
[14:29:07] [DOC: 9230209] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.A'
[14:29:07] [DOC: 9230209] ✅ Patient data written to CSV: Ronald Ferreira | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA250324024402
[14:29:07] ✅    ✅ Document 9230209 processed and saved successfully
[14:29:07] 🔄 
🔄 Step 8: Saving API details...
[14:29:07] [DOC: 9230209] ℹ️  API push details saved for document 9230209
[14:29:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230175                         ║
================================================================================
[14:29:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:29:07] ℹ️  Date: 04/09/2025
[14:29:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:29:11] [DOC: 9230175] ✅ Text extracted using pdfplumber (19815 chars)
[14:29:11] ✅    ✅ Text extracted using pdfplumber (19815 chars)
[14:29:11] 🔄 
🔄 Step 2: Extracting patient data...
[14:29:14] ℹ️  AI extracted raw sex value: 'M'
[14:29:14] ℹ️  AI extracted service line: 'OT'
[14:29:14] ℹ️  AI extracted payer source: 'None'
[14:29:14] ℹ️  AI extracted diagnoses:
[14:29:14] ℹ️    - Diagnosis 1: 'COPD exacerbation'
[14:29:14] ℹ️    - Diagnosis 2: 'Weakness'
[14:29:14] ℹ️    - Diagnosis 3: 'post laminectomy syndrome'
[14:29:14] ℹ️    - Diagnosis 4: 'spinal stenosis with neurogenic claudication'
[14:29:14] ℹ️    - Diagnosis 5: 'UTI'
[14:29:14] ℹ️    - Diagnosis 6: 'COPD'
[14:29:14] ℹ️  Final extracted MRN: 'MA250210123603'
[14:29:14] ℹ️  Final extracted Sex: 'MALE'
[14:29:14] ℹ️  Final extracted Service Line: 'OT'
[14:29:14] ℹ️  Final extracted Payer Source: ''
[14:29:14] ✅ Patient data extraction completed successfully
[14:29:14] ✅    ✅ Patient data extracted successfully
[14:29:14] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/27/2025', 'endOfEpisode': None, 'firstDiagnosis': 'COPD exacerbation', 'secondDiagnosis': 'Weakness', 'thirdDiagnosis': 'post laminectomy syndrome', 'fourthDiagnosis': 'spinal stenosis with neurogenic claudication', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COPD'}]
[14:29:14] ✅    ✅ Patient identified: David Boswell
[14:29:14] ✅    ✅ Patient name validation passed
[14:29:14] 🔄 
🔄 Step 3: Processing patient dates...
[14:29:14] [DOC: 9230175] ℹ️  DOB normalized: 12/29/1936
[14:29:14] [DOC: 9230175] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[14:29:14] [DOC: 9230175] ✅ Patient date processing completed successfully
[14:29:14] ✅    ✅ Date processing completed
[14:29:14] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'firstDiagnosis': 'COPD exacerbation', 'secondDiagnosis': 'Weakness', 'thirdDiagnosis': 'post laminectomy syndrome', 'fourthDiagnosis': 'spinal stenosis with neurogenic claudication', 'fifthDiagnosis': 'UTI', 'sixthDiagnosis': 'COPD'}]
[14:29:14] 🔄 
🔄 Step 4: Extracting order data...
[14:29:17] ℹ️  Order extraction - MRN: 'MA250210123603'
[14:29:17] ℹ️  Order extraction - Sex: 'MALE'
[14:29:17] ℹ️  Order extraction - Service Line: 'OT'
[14:29:17] ℹ️  Order extraction - Payer Source: ''
[14:29:17] ✅ Order data extraction completed successfully
[14:29:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:29:17] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[14:29:17] ℹ️  Service line consistent in both sources: 'OT'
[14:29:17] ✅ Patient name cross-validation successful
[14:29:17] ✅    ✅ Data merged successfully
[14:29:18] ⚠️     ❌ Skipping - missing episode start date
[14:29:18] [DOC: 9230175] ℹ️  API push details saved for document 9230175
================================================================================
║                        Processing Document ID: 9230173                         ║
================================================================================
[14:29:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:29:18] ℹ️  Date: 04/09/2025
[14:29:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:29:22] [DOC: 9230173] ✅ Text extracted using pdfplumber (1492 chars)
[14:29:22] ✅    ✅ Text extracted using pdfplumber (1492 chars)
[14:29:22] 🔄 
🔄 Step 2: Extracting patient data...
[14:29:25] ℹ️  AI extracted raw sex value: ''
[14:29:25] ℹ️  AI extracted service line: 'Physical Therapy'
[14:29:25] ℹ️  AI extracted payer source: ''
[14:29:25] ℹ️  AI extracted diagnoses:
[14:29:25] ℹ️    - Diagnosis 1: 'B37.81'
[14:29:25] ℹ️    - Diagnosis 2: 'J44.1'
[14:29:25] ℹ️    - Diagnosis 3: 'J18.9'
[14:29:25] ℹ️    - Diagnosis 4: ''
[14:29:25] ℹ️    - Diagnosis 5: ''
[14:29:25] ℹ️    - Diagnosis 6: ''
[14:29:25] ℹ️  Final extracted MRN: 'MA250210123603'
[14:29:25] ℹ️  Final extracted Sex: ''
[14:29:25] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:29:25] ℹ️  Final extracted Payer Source: ''
[14:29:25] ✅ Patient data extraction completed successfully
[14:29:25] ✅    ✅ Patient data extracted successfully
[14:29:25] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:29:25] ✅    ✅ Patient identified: David Boswell
[14:29:25] ✅    ✅ Patient name validation passed
[14:29:25] 🔄 
🔄 Step 3: Processing patient dates...
[14:29:25] [DOC: 9230173] ℹ️  DOB normalized: 12/29/1936
[14:29:25] [DOC: 9230173] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[14:29:25] [DOC: 9230173] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[14:29:25] [DOC: 9230173] ✅ Patient date processing completed successfully
[14:29:25] ✅    ✅ Date processing completed
[14:29:25] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B37.81', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:29:25] 🔄 
🔄 Step 4: Extracting order data...
[14:29:28] ℹ️  Order extraction - MRN: 'MA250210123603'
[14:29:28] ℹ️  Order extraction - Sex: ''
[14:29:28] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:29:28] ℹ️  Order extraction - Payer Source: ''
[14:29:28] ✅ Order data extraction completed successfully
[14:29:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:29:28] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[14:29:28] ℹ️  Inferred sex as MALE from name: David
[14:29:28] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:29:28] ✅ Patient name cross-validation successful
[14:29:28] ✅    ✅ Data merged successfully
[14:29:29] ✅    ✅ Order data extracted and validated
[14:29:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:29:29] [DOC: 9230173] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:29] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:29:29] [DOC: 9230173] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:30] [DOC: 9230173] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13206"}
[14:29:30] ❌    ❌ Failed to push order
[14:29:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:29:30] [DOC: 9230173] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[14:29:30] [DOC: 9230173] ℹ️  Service Line extracted: 'Physical Therapy'
[14:29:30] [DOC: 9230173] ℹ️  Payer Source extracted: ''
[14:29:30] [DOC: 9230173] ℹ️  Diagnosis codes being written:
[14:29:30] [DOC: 9230173] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.81'
[14:29:30] [DOC: 9230173] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.1'
[14:29:30] [DOC: 9230173] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[14:29:30] [DOC: 9230173] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:29:30] [DOC: 9230173] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:29:30] [DOC: 9230173] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:29:30] [DOC: 9230173] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA250210123603
[14:29:30] ✅    ✅ Document 9230173 processed and saved successfully
[14:29:30] 🔄 
🔄 Step 8: Saving API details...
[14:29:30] [DOC: 9230173] ℹ️  API push details saved for document 9230173
[14:29:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230168                         ║
================================================================================
[14:29:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:29:30] ℹ️  Date: 04/09/2025
[14:29:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:29:36] [DOC: 9230168] ✅ Text extracted using pdfplumber (15512 chars)
[14:29:36] ✅    ✅ Text extracted using pdfplumber (15512 chars)
[14:29:36] 🔄 
🔄 Step 2: Extracting patient data...
[14:29:39] ℹ️  AI extracted raw sex value: ''
[14:29:39] ℹ️  AI extracted service line: 'PT'
[14:29:39] ℹ️  AI extracted payer source: ''
[14:29:39] ℹ️  AI extracted diagnoses:
[14:29:39] ℹ️    - Diagnosis 1: 'Candidal esophagitis'
[14:29:39] ℹ️    - Diagnosis 2: 'Muscle weakness'
[14:29:39] ℹ️    - Diagnosis 3: ''
[14:29:39] ℹ️    - Diagnosis 4: ''
[14:29:39] ℹ️    - Diagnosis 5: ''
[14:29:39] ℹ️    - Diagnosis 6: ''
[14:29:39] ℹ️  Final extracted MRN: 'MA250210123603'
[14:29:39] ℹ️  Final extracted Sex: ''
[14:29:39] ℹ️  Final extracted Service Line: 'PT'
[14:29:39] ℹ️  Final extracted Payer Source: ''
[14:29:39] ✅ Patient data extraction completed successfully
[14:29:39] ✅    ✅ Patient data extracted successfully
[14:29:39] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Candidal esophagitis', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:29:39] ✅    ✅ Patient identified: David Boswell
[14:29:39] ✅    ✅ Patient name validation passed
[14:29:39] 🔄 
🔄 Step 3: Processing patient dates...
[14:29:39] [DOC: 9230168] ℹ️  DOB normalized: 12/29/1936
[14:29:39] [DOC: 9230168] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[14:29:39] [DOC: 9230168] ✅ Patient date processing completed successfully
[14:29:39] ✅    ✅ Date processing completed
[14:29:39] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Candidal esophagitis', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:29:39] 🔄 
🔄 Step 4: Extracting order data...
[14:29:43] ℹ️  Order extraction - MRN: 'MA250210123603'
[14:29:43] ℹ️  Order extraction - Sex: ''
[14:29:43] ℹ️  Order extraction - Service Line: 'PT'
[14:29:43] ℹ️  Order extraction - Payer Source: ''
[14:29:43] ✅ Order data extraction completed successfully
[14:29:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:29:43] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[14:29:43] ℹ️  Inferred sex as MALE from name: David
[14:29:43] ℹ️  Service line consistent in both sources: 'PT'
[14:29:43] ✅ Patient name cross-validation successful
[14:29:43] ✅    ✅ Data merged successfully
[14:29:44] ✅    ✅ Order data extracted and validated
[14:29:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:29:44] [DOC: 9230168] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:44] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:44] 🔄 
🔄 Step 6: Pushing order to API...
[14:29:44] [DOC: 9230168] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:45] [DOC: 9230168] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:29:45] ❌    ❌ Failed to push order
[14:29:45] 🔄 
🔄 Step 7: Writing to CSV...
[14:29:45] [DOC: 9230168] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[14:29:45] [DOC: 9230168] ℹ️  Service Line extracted: 'PT'
[14:29:45] [DOC: 9230168] ℹ️  Payer Source extracted: ''
[14:29:45] [DOC: 9230168] ℹ️  Diagnosis codes being written:
[14:29:45] [DOC: 9230168] ℹ️    - Latest_Episode_Firstdiagnosis: 'Candidal esophagitis'
[14:29:45] [DOC: 9230168] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[14:29:45] [DOC: 9230168] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:29:45] [DOC: 9230168] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:29:45] [DOC: 9230168] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:29:45] [DOC: 9230168] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:29:45] [DOC: 9230168] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: PT | Payer:  | MRN: MA250210123603
[14:29:45] ✅    ✅ Document 9230168 processed and saved successfully
[14:29:45] 🔄 
🔄 Step 8: Saving API details...
[14:29:45] [DOC: 9230168] ℹ️  API push details saved for document 9230168
[14:29:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230165                         ║
================================================================================
[14:29:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:29:45] ℹ️  Date: 04/09/2025
[14:29:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:29:49] [DOC: 9230165] ✅ Text extracted using pdfplumber (15260 chars)
[14:29:49] ✅    ✅ Text extracted using pdfplumber (15260 chars)
[14:29:49] 🔄 
🔄 Step 2: Extracting patient data...
[14:29:52] ℹ️  AI extracted raw sex value: 'M'
[14:29:52] ℹ️  AI extracted service line: 'RN, PT, OT, SLP'
[14:29:52] ℹ️  AI extracted payer source: ''
[14:29:52] ℹ️  AI extracted diagnoses:
[14:29:52] ℹ️    - Diagnosis 1: 'B3781'
[14:29:52] ℹ️    - Diagnosis 2: 'J441'
[14:29:52] ℹ️    - Diagnosis 3: ''
[14:29:52] ℹ️    - Diagnosis 4: ''
[14:29:52] ℹ️    - Diagnosis 5: ''
[14:29:52] ℹ️    - Diagnosis 6: ''
[14:29:52] ℹ️  Final extracted MRN: 'MA250210123603'
[14:29:52] ℹ️  Final extracted Sex: 'MALE'
[14:29:52] ℹ️  Final extracted Service Line: 'RN, PT, OT, SLP'
[14:29:52] ℹ️  Final extracted Payer Source: ''
[14:29:52] ✅ Patient data extraction completed successfully
[14:29:52] ✅    ✅ Patient data extracted successfully
[14:29:52] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN, PT, OT, SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/03/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B3781', 'secondDiagnosis': 'J441', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:29:52] ✅    ✅ Patient identified: David Boswell
[14:29:52] ✅    ✅ Patient name validation passed
[14:29:52] 🔄 
🔄 Step 3: Processing patient dates...
[14:29:52] [DOC: 9230165] ℹ️  DOB normalized: 12/29/1936
[14:29:52] [DOC: 9230165] ℹ️  Episode startOfCare normalized: 03/03/2025
[14:29:52] [DOC: 9230165] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[14:29:52] [DOC: 9230165] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[14:29:52] [DOC: 9230165] ✅ Patient date processing completed successfully
[14:29:52] ✅    ✅ Date processing completed
[14:29:52] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN, PT, OT, SLP
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/03/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'B3781', 'secondDiagnosis': 'J441', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:29:52] 🔄 
🔄 Step 4: Extracting order data...
[14:29:55] ℹ️  Order extraction - MRN: 'MA250210123603'
[14:29:55] ℹ️  Order extraction - Sex: 'MALE'
[14:29:55] ℹ️  Order extraction - Service Line: 'RN, PT, OT, SLP'
[14:29:55] ℹ️  Order extraction - Payer Source: ''
[14:29:55] ✅ Order data extraction completed successfully
[14:29:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:29:55] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[14:29:55] ℹ️  Service line consistent in both sources: 'RN, PT, OT, SLP'
[14:29:55] ✅ Patient name cross-validation successful
[14:29:55] ✅    ✅ Data merged successfully
[14:29:56] ✅    ✅ Order data extracted and validated
[14:29:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:29:56] [DOC: 9230165] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:56] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:56] 🔄 
🔄 Step 6: Pushing order to API...
[14:29:56] [DOC: 9230165] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[14:29:57] [DOC: 9230165] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13208"}
[14:29:57] ❌    ❌ Failed to push order
[14:29:57] 🔄 
🔄 Step 7: Writing to CSV...
[14:29:57] [DOC: 9230165] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[14:29:57] [DOC: 9230165] ℹ️  Service Line extracted: 'RN, PT, OT, SLP'
[14:29:57] [DOC: 9230165] ℹ️  Payer Source extracted: ''
[14:29:57] [DOC: 9230165] ℹ️  Diagnosis codes being written:
[14:29:57] [DOC: 9230165] ℹ️    - Latest_Episode_Firstdiagnosis: 'B3781'
[14:29:57] [DOC: 9230165] ℹ️    - Latest_Episode_Seconddiagnosis: 'J441'
[14:29:57] [DOC: 9230165] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:29:57] [DOC: 9230165] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:29:57] [DOC: 9230165] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:29:57] [DOC: 9230165] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:29:57] [DOC: 9230165] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: RN, PT, OT, SLP | Payer:  | MRN: MA250210123603
[14:29:57] ✅    ✅ Document 9230165 processed and saved successfully
[14:29:57] 🔄 
🔄 Step 8: Saving API details...
[14:29:57] [DOC: 9230165] ℹ️  API push details saved for document 9230165
[14:29:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230118                         ║
================================================================================
[14:29:57] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:29:57] ℹ️  Date: 04/09/2025
[14:29:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:29:59] [DOC: 9230118] ✅ Text extracted using pdfplumber (1273 chars)
[14:29:59] ✅    ✅ Text extracted using pdfplumber (1273 chars)
[14:29:59] 🔄 
🔄 Step 2: Extracting patient data...
[14:30:02] ℹ️  AI extracted raw sex value: 'M'
[14:30:02] ℹ️  AI extracted service line: 'HHA'
[14:30:02] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:30:02] ℹ️  AI extracted diagnoses:
[14:30:02] ℹ️    - Diagnosis 1: ''
[14:30:02] ℹ️    - Diagnosis 2: ''
[14:30:02] ℹ️    - Diagnosis 3: ''
[14:30:02] ℹ️    - Diagnosis 4: ''
[14:30:02] ℹ️    - Diagnosis 5: ''
[14:30:02] ℹ️    - Diagnosis 6: ''
[14:30:02] ℹ️  Final extracted MRN: '343005'
[14:30:02] ℹ️  Final extracted Sex: 'MALE'
[14:30:02] ℹ️  Final extracted Service Line: 'HHA'
[14:30:02] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:30:02] ✅ Patient data extraction completed successfully
[14:30:02] ✅    ✅ Patient data extracted successfully
[14:30:02] 📊 Patient Response
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Karine A Maalouf-Kaleshian, MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:30:02] ✅    ✅ Patient identified: Kevin Livramento
[14:30:02] ✅    ✅ Patient name validation passed
[14:30:02] 🔄 
🔄 Step 3: Processing patient dates...
[14:30:02] [DOC: 9230118] ℹ️  DOB normalized: 08/25/1966
[14:30:02] [DOC: 9230118] ℹ️  Episode startOfCare normalized: 09/27/2022
[14:30:02] [DOC: 9230118] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:30:02] [DOC: 9230118] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[14:30:02] [DOC: 9230118] ✅ Patient date processing completed successfully
[14:30:02] ✅    ✅ Date processing completed
[14:30:02] 📊 Processed Patient Data
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Karine A Maalouf-Kaleshian, MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:30:02] 🔄 
🔄 Step 4: Extracting order data...
[14:30:05] ℹ️  Order extraction - MRN: '343005'
[14:30:05] ℹ️  Order extraction - Sex: 'MALE'
[14:30:05] ℹ️  Order extraction - Service Line: 'HHA'
[14:30:05] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:30:05] ✅ Order data extraction completed successfully
[14:30:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:30:05] ℹ️  Using MRN from patient data: '343005' over '343005'
[14:30:05] ℹ️  Service line consistent in both sources: 'HHA'
[14:30:05] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:30:05] ✅ Patient name cross-validation successful
[14:30:05] ✅    ✅ Data merged successfully
[14:30:06] ✅    ✅ Order data extracted and validated
[14:30:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:30:06] [DOC: 9230118] ✅ Patient found in local cache: Kevin Livramento, ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[14:30:06] ✅    ✅ Existing patient found with ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[14:30:06] 🔄 
🔄 Step 6: Pushing order to API...
[14:30:06] [DOC: 9230118] ℹ️  Pushing order via API for patient ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[14:30:08] [DOC: 9230118] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:30:08] ❌    ❌ Failed to push order
[14:30:08] 🔄 
🔄 Step 7: Writing to CSV...
[14:30:08] [DOC: 9230118] ℹ️  Calculated age: 58 from DOB: 08/25/1966
[14:30:08] [DOC: 9230118] ℹ️  Service Line extracted: 'HHA'
[14:30:08] [DOC: 9230118] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:30:08] [DOC: 9230118] ℹ️  Diagnosis codes being written:
[14:30:08] [DOC: 9230118] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:30:08] [DOC: 9230118] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:30:08] [DOC: 9230118] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:30:08] [DOC: 9230118] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:30:08] [DOC: 9230118] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:30:08] [DOC: 9230118] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:30:08] [DOC: 9230118] ✅ Patient data written to CSV: Kevin Livramento | Sex: MALE | Age: 58 | Service: HHA | Payer: Medicaid/MA | MRN: 343005
[14:30:08] ✅    ✅ Document 9230118 processed and saved successfully
[14:30:08] 🔄 
🔄 Step 8: Saving API details...
[14:30:08] [DOC: 9230118] ℹ️  API push details saved for document 9230118
[14:30:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229870                         ║
================================================================================
[14:30:08] ℹ️  Agency: Dartmouth HH
[14:30:08] ℹ️  Date: 04/09/2025
[14:30:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:30:11] [DOC: 9229870] ✅ Text extracted using pdfplumber (14340 chars)
[14:30:11] ✅    ✅ Text extracted using pdfplumber (14328 chars)
[14:30:11] 🔄 
🔄 Step 2: Extracting patient data...
[14:30:14] ℹ️  AI extracted raw sex value: 'M'
[14:30:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:30:14] ℹ️  AI extracted payer source: 'None'
[14:30:14] ℹ️  AI extracted diagnoses:
[14:30:14] ℹ️    - Diagnosis 1: 'I13.0'
[14:30:14] ℹ️    - Diagnosis 2: 'I50.32'
[14:30:14] ℹ️    - Diagnosis 3: 'E11.22'
[14:30:14] ℹ️    - Diagnosis 4: 'N18.31'
[14:30:14] ℹ️    - Diagnosis 5: 'I48.0'
[14:30:14] ℹ️    - Diagnosis 6: 'K74.60'
[14:30:14] ℹ️  Final extracted MRN: '3778011'
[14:30:14] ℹ️  Final extracted Sex: 'MALE'
[14:30:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:30:14] ℹ️  Final extracted Payer Source: ''
[14:30:14] ✅ Patient data extraction completed successfully
[14:30:14] ✅    ✅ Patient data extracted successfully
[14:30:14] 📊 Patient Response
     └─ patientFName: Saulnier
     └─ patientLName: Roy
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2024', 'startOfEpisode': '08/07/2024', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'K74.60'}]
[14:30:14] ✅    ✅ Patient identified: Saulnier Roy
[14:30:14] ✅    ✅ Patient name validation passed
[14:30:14] 🔄 
🔄 Step 3: Processing patient dates...
[14:30:14] [DOC: 9229870] ℹ️  DOB normalized: 10/26/1936
[14:30:14] [DOC: 9229870] ℹ️  Episode startOfCare normalized: 07/15/2024
[14:30:14] [DOC: 9229870] ℹ️  Episode startOfEpisode normalized: 08/07/2024
[14:30:14] [DOC: 9229870] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:30:14] [DOC: 9229870] ✅ Patient date processing completed successfully
[14:30:14] ✅    ✅ Date processing completed
[14:30:14] 📊 Processed Patient Data
     └─ patientFName: Saulnier
     └─ patientLName: Roy
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2024', 'startOfEpisode': '08/07/2024', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'K74.60'}]
[14:30:14] 🔄 
🔄 Step 4: Extracting order data...
[14:30:16] ℹ️  Order extraction - MRN: '3778011'
[14:30:16] ℹ️  Order extraction - Sex: 'MALE'
[14:30:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[14:30:16] ℹ️  Order extraction - Payer Source: ''
[14:30:16] ✅ Order data extraction completed successfully
[14:30:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:30:16] ℹ️  Using MRN from patient data: '3778011' over '3778011'
[14:30:16] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[14:30:16] ✅ Patient name cross-validation successful
[14:30:16] ✅    ✅ Data merged successfully
[14:30:18] ✅    ✅ Order data extracted and validated
[14:30:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:30:29] [DOC: 9229870] ✅ Patient exists in API: Saulnier Roy, ID: e7b4162b-4dbf-41e2-947a-2c2579aa8586
[14:30:29] ✅    ✅ Existing patient found with ID: e7b4162b-4dbf-41e2-947a-2c2579aa8586
[14:30:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:30:29] [DOC: 9229870] ℹ️  Pushing order via API for patient ID: e7b4162b-4dbf-41e2-947a-2c2579aa8586
[14:30:30] [DOC: 9229870] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:30:30] ❌    ❌ Failed to push order
[14:30:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:30:30] [DOC: 9229870] ℹ️  Calculated age: 88 from DOB: 10/26/1936
[14:30:30] [DOC: 9229870] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[14:30:30] [DOC: 9229870] ℹ️  Payer Source extracted: ''
[14:30:30] [DOC: 9229870] ℹ️  Diagnosis codes being written:
[14:30:30] [DOC: 9229870] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[14:30:30] [DOC: 9229870] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[14:30:30] [DOC: 9229870] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[14:30:30] [DOC: 9229870] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[14:30:30] [DOC: 9229870] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.0'
[14:30:30] [DOC: 9229870] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K74.60'
[14:30:30] [DOC: 9229870] ✅ Patient data written to CSV: Saulnier Roy | Sex: MALE | Age: 88 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 3778011
[14:30:30] ✅    ✅ Document 9229870 processed and saved successfully
[14:30:30] 🔄 
🔄 Step 8: Saving API details...
[14:30:30] [DOC: 9229870] ℹ️  API push details saved for document 9229870
[14:30:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229860                         ║
================================================================================
[14:30:30] ℹ️  Agency: Dartmouth HH
[14:30:30] ℹ️  Date: 04/09/2025
[14:30:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:30:36] [DOC: 9229860] ✅ Text extracted using pdfplumber (24856 chars)
[14:30:36] ✅    ✅ Text extracted using pdfplumber (24844 chars)
[14:30:36] 🔄 
🔄 Step 2: Extracting patient data...
[14:30:39] ℹ️  AI extracted raw sex value: 'M'
[14:30:39] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, ST'
[14:30:39] ℹ️  AI extracted payer source: 'None'
[14:30:39] ℹ️  AI extracted diagnoses:
[14:30:39] ℹ️    - Diagnosis 1: 'N17.9'
[14:30:39] ℹ️    - Diagnosis 2: 'I12.9'
[14:30:39] ℹ️    - Diagnosis 3: 'E11.22'
[14:30:39] ℹ️    - Diagnosis 4: 'N18.32'
[14:30:39] ℹ️    - Diagnosis 5: 'N28.89'
[14:30:39] ℹ️    - Diagnosis 6: 'E87.5'
[14:30:39] ℹ️  Final extracted MRN: '1556015'
[14:30:39] ℹ️  Final extracted Sex: 'MALE'
[14:30:39] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, ST'
[14:30:39] ℹ️  Final extracted Payer Source: ''
[14:30:39] ✅ Patient data extraction completed successfully
[14:30:39] ✅    ✅ Patient data extracted successfully
[14:30:39] 📊 Patient Response
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'N17.9', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N28.89', 'sixthDiagnosis': 'E87.5'}]
[14:30:39] ✅    ✅ Patient identified: Andrew Reuter
[14:30:39] ✅    ✅ Patient name validation passed
[14:30:39] 🔄 
🔄 Step 3: Processing patient dates...
[14:30:39] [DOC: 9229860] ℹ️  DOB normalized: 07/06/1927
[14:30:39] [DOC: 9229860] ℹ️  Episode startOfCare normalized: 03/24/2025
[14:30:39] [DOC: 9229860] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:30:39] [DOC: 9229860] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:30:39] [DOC: 9229860] ✅ Patient date processing completed successfully
[14:30:39] ✅    ✅ Date processing completed
[14:30:39] 📊 Processed Patient Data
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'N17.9', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N28.89', 'sixthDiagnosis': 'E87.5'}]
[14:30:39] 🔄 
🔄 Step 4: Extracting order data...
[14:30:42] ℹ️  Order extraction - MRN: '1556015'
[14:30:42] ℹ️  Order extraction - Sex: 'MALE'
[14:30:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy'
[14:30:42] ℹ️  Order extraction - Payer Source: ''
[14:30:42] ✅ Order data extraction completed successfully
[14:30:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:30:42] ℹ️  Using MRN from patient data: '1556015' over '1556015'
[14:30:42] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT, ST' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy'
[14:30:42] ✅ Patient name cross-validation successful
[14:30:42] ✅    ✅ Data merged successfully
[14:30:43] ✅    ✅ Order data extracted and validated
[14:30:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:30:43] [DOC: 9229860] ✅ Patient found in local cache: Andrew Reuter, ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[14:30:43] ✅    ✅ Existing patient found with ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[14:30:43] 🔄 
🔄 Step 6: Pushing order to API...
[14:30:43] [DOC: 9229860] ℹ️  Pushing order via API for patient ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[14:30:44] [DOC: 9229860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:30:44] ❌    ❌ Failed to push order
[14:30:44] 🔄 
🔄 Step 7: Writing to CSV...
[14:30:44] [DOC: 9229860] ℹ️  Calculated age: 97 from DOB: 07/06/1927
[14:30:44] [DOC: 9229860] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy'
[14:30:44] [DOC: 9229860] ℹ️  Payer Source extracted: ''
[14:30:44] [DOC: 9229860] ℹ️  Diagnosis codes being written:
[14:30:44] [DOC: 9229860] ℹ️    - Latest_Episode_Firstdiagnosis: 'N17.9'
[14:30:44] [DOC: 9229860] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[14:30:44] [DOC: 9229860] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[14:30:44] [DOC: 9229860] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.32'
[14:30:44] [DOC: 9229860] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N28.89'
[14:30:44] [DOC: 9229860] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.5'
[14:30:44] [DOC: 9229860] ✅ Patient data written to CSV: Andrew Reuter | Sex: MALE | Age: 97 | Service: OT, Occupational Therapy, PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy | Payer:  | MRN: 1556015
[14:30:44] ✅    ✅ Document 9229860 processed and saved successfully
[14:30:44] 🔄 
🔄 Step 8: Saving API details...
[14:30:44] [DOC: 9229860] ℹ️  API push details saved for document 9229860
[14:30:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229859                         ║
================================================================================
[14:30:44] ℹ️  Agency: Dartmouth HH
[14:30:44] ℹ️  Date: 04/09/2025
[14:30:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:30:46] [DOC: 9229859] ✅ Text extracted using pdfplumber (2828 chars)
[14:30:46] ✅    ✅ Text extracted using pdfplumber (2828 chars)
[14:30:46] 🔄 
🔄 Step 2: Extracting patient data...
[14:30:49] ℹ️  AI extracted raw sex value: 'M'
[14:30:49] ℹ️  AI extracted service line: 'Skilled Nursing, Telehealth'
[14:30:49] ℹ️  AI extracted payer source: 'Fallon Health'
[14:30:49] ℹ️  AI extracted diagnoses:
[14:30:49] ℹ️    - Diagnosis 1: ''
[14:30:49] ℹ️    - Diagnosis 2: ''
[14:30:49] ℹ️    - Diagnosis 3: ''
[14:30:49] ℹ️    - Diagnosis 4: ''
[14:30:49] ℹ️    - Diagnosis 5: ''
[14:30:49] ℹ️    - Diagnosis 6: ''
[14:30:49] ℹ️  Final extracted MRN: '5334009'
[14:30:49] ℹ️  Final extracted Sex: 'MALE'
[14:30:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, Telehealth'
[14:30:49] ℹ️  Final extracted Payer Source: 'Fallon Health'
[14:30:49] ✅ Patient data extraction completed successfully
[14:30:49] ✅    ✅ Patient data extracted successfully
[14:30:49] 📊 Patient Response
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Telehealth
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:30:49] ✅    ✅ Patient identified: Jeremias Teixeira
[14:30:49] ✅    ✅ Patient name validation passed
[14:30:49] 🔄 
🔄 Step 3: Processing patient dates...
[14:30:49] [DOC: 9229859] ℹ️  DOB normalized: 12/26/1931
[14:30:49] [DOC: 9229859] ℹ️  Episode startOfCare normalized: 03/25/2025
[14:30:49] [DOC: 9229859] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:30:49] [DOC: 9229859] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:30:49] [DOC: 9229859] ✅ Patient date processing completed successfully
[14:30:49] ✅    ✅ Date processing completed
[14:30:49] 📊 Processed Patient Data
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Telehealth
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:30:49] 🔄 
🔄 Step 4: Extracting order data...
[14:30:51] ℹ️  Order extraction - MRN: '5334009'
[14:30:51] ℹ️  Order extraction - Sex: 'MALE'
[14:30:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Telehealth'
[14:30:51] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[14:30:51] ✅ Order data extraction completed successfully
[14:30:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:30:51] ℹ️  Using MRN from patient data: '5334009' over '5334009'
[14:30:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Telehealth'
[14:30:51] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[14:30:51] ✅ Patient name cross-validation successful
[14:30:51] ✅    ✅ Data merged successfully
[14:30:53] ✅    ✅ Order data extracted and validated
[14:30:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:30:53] [DOC: 9229859] ✅ Patient found in local cache: Jeremias Teixeira, ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:30:53] ✅    ✅ Existing patient found with ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:30:53] 🔄 
🔄 Step 6: Pushing order to API...
[14:30:53] [DOC: 9229859] ℹ️  Pushing order via API for patient ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:30:54] [DOC: 9229859] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:30:54] ❌    ❌ Failed to push order
[14:30:54] 🔄 
🔄 Step 7: Writing to CSV...
[14:30:54] [DOC: 9229859] ℹ️  Calculated age: 93 from DOB: 12/26/1931
[14:30:54] [DOC: 9229859] ℹ️  Service Line extracted: 'Skilled Nursing, Telehealth'
[14:30:54] [DOC: 9229859] ℹ️  Payer Source extracted: 'Fallon Health'
[14:30:54] [DOC: 9229859] ℹ️  Diagnosis codes being written:
[14:30:54] [DOC: 9229859] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:30:54] [DOC: 9229859] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:30:54] [DOC: 9229859] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:30:54] [DOC: 9229859] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:30:54] [DOC: 9229859] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:30:54] [DOC: 9229859] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:30:54] [DOC: 9229859] ✅ Patient data written to CSV: Jeremias Teixeira | Sex: MALE | Age: 93 | Service: Skilled Nursing, Telehealth | Payer: Fallon Health | MRN: 5334009
[14:30:54] ✅    ✅ Document 9229859 processed and saved successfully
[14:30:54] 🔄 
🔄 Step 8: Saving API details...
[14:30:54] [DOC: 9229859] ℹ️  API push details saved for document 9229859
[14:30:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229857                         ║
================================================================================
[14:30:54] ℹ️  Agency: Dartmouth HH
[14:30:54] ℹ️  Date: 04/09/2025
[14:30:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:30:58] [DOC: 9229857] ✅ Text extracted using pdfplumber (1330 chars)
[14:30:58] ✅    ✅ Text extracted using pdfplumber (1330 chars)
[14:30:58] 🔄 
🔄 Step 2: Extracting patient data...
[14:31:01] ℹ️  AI extracted raw sex value: 'M'
[14:31:01] ℹ️  AI extracted service line: 'RN, LPN'
[14:31:01] ℹ️  AI extracted payer source: 'Fallon Health'
[14:31:01] ℹ️  AI extracted diagnoses:
[14:31:01] ℹ️    - Diagnosis 1: ''
[14:31:01] ℹ️    - Diagnosis 2: ''
[14:31:01] ℹ️    - Diagnosis 3: ''
[14:31:01] ℹ️    - Diagnosis 4: ''
[14:31:01] ℹ️    - Diagnosis 5: ''
[14:31:01] ℹ️    - Diagnosis 6: ''
[14:31:01] ℹ️  Final extracted MRN: '5334009'
[14:31:01] ℹ️  Final extracted Sex: 'MALE'
[14:31:01] ℹ️  Final extracted Service Line: 'RN, LPN'
[14:31:01] ℹ️  Final extracted Payer Source: 'Fallon Health'
[14:31:01] ✅ Patient data extraction completed successfully
[14:31:01] ✅    ✅ Patient data extracted successfully
[14:31:01] 📊 Patient Response
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:31:01] ✅    ✅ Patient identified: Jeremias Teixeira
[14:31:01] ✅    ✅ Patient name validation passed
[14:31:01] 🔄 
🔄 Step 3: Processing patient dates...
[14:31:01] [DOC: 9229857] ℹ️  DOB normalized: 12/26/1931
[14:31:01] [DOC: 9229857] ℹ️  Episode startOfCare normalized: 03/25/2025
[14:31:01] [DOC: 9229857] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:31:01] [DOC: 9229857] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:31:01] [DOC: 9229857] ✅ Patient date processing completed successfully
[14:31:01] ✅    ✅ Date processing completed
[14:31:01] 📊 Processed Patient Data
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 5334009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:31:01] 🔄 
🔄 Step 4: Extracting order data...
[14:31:03] ℹ️  Order extraction - MRN: ''
[14:31:03] ℹ️  Order extraction - Sex: 'MALE'
[14:31:03] ℹ️  Order extraction - Service Line: 'RN, LPN'
[14:31:03] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[14:31:03] ✅ Order data extraction completed successfully
[14:31:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:31:03] ℹ️  Using MRN from patient data: '5334009'
[14:31:03] ℹ️  Service line consistent in both sources: 'RN, LPN'
[14:31:03] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[14:31:03] ✅ Patient name cross-validation successful
[14:31:03] ✅    ✅ Data merged successfully
[14:31:04] ✅    ✅ Order data extracted and validated
[14:31:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:31:04] [DOC: 9229857] ✅ Patient found in local cache: Jeremias Teixeira, ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:31:04] ✅    ✅ Existing patient found with ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:31:04] 🔄 
🔄 Step 6: Pushing order to API...
[14:31:04] [DOC: 9229857] ℹ️  Pushing order via API for patient ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:31:05] [DOC: 9229857] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14271"}
[14:31:05] ❌    ❌ Failed to push order
[14:31:05] 🔄 
🔄 Step 7: Writing to CSV...
[14:31:05] [DOC: 9229857] ℹ️  Calculated age: 93 from DOB: 12/26/1931
[14:31:05] [DOC: 9229857] ℹ️  Service Line extracted: 'RN, LPN'
[14:31:05] [DOC: 9229857] ℹ️  Payer Source extracted: 'Fallon Health'
[14:31:05] [DOC: 9229857] ℹ️  Diagnosis codes being written:
[14:31:05] [DOC: 9229857] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:31:05] [DOC: 9229857] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:31:05] [DOC: 9229857] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:31:05] [DOC: 9229857] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:31:05] [DOC: 9229857] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:31:05] [DOC: 9229857] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:31:05] [DOC: 9229857] ✅ Patient data written to CSV: Jeremias Teixeira | Sex: MALE | Age: 93 | Service: RN, LPN | Payer: Fallon Health | MRN: 5334009
[14:31:05] ✅    ✅ Document 9229857 processed and saved successfully
[14:31:05] 🔄 
🔄 Step 8: Saving API details...
[14:31:05] [DOC: 9229857] ℹ️  API push details saved for document 9229857
[14:31:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229855                         ║
================================================================================
[14:31:05] ℹ️  Agency: Dartmouth HH
[14:31:05] ℹ️  Date: 04/09/2025
[14:31:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:31:09] [DOC: 9229855] ✅ Text extracted using pdfplumber (25770 chars)
[14:31:09] ✅    ✅ Text extracted using pdfplumber (25770 chars)
[14:31:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:31:12] ℹ️  AI extracted raw sex value: 'M'
[14:31:12] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[14:31:12] ℹ️  AI extracted payer source: ''
[14:31:12] ℹ️  AI extracted diagnoses:
[14:31:12] ℹ️    - Diagnosis 1: 'I13.0'
[14:31:12] ℹ️    - Diagnosis 2: 'I50.33'
[14:31:12] ℹ️    - Diagnosis 3: 'E11.22'
[14:31:12] ℹ️    - Diagnosis 4: 'N18.32'
[14:31:12] ℹ️    - Diagnosis 5: 'J44.9'
[14:31:12] ℹ️    - Diagnosis 6: 'J90'
[14:31:12] ℹ️  Final extracted MRN: '227027'
[14:31:12] ℹ️  Final extracted Sex: 'MALE'
[14:31:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[14:31:12] ℹ️  Final extracted Payer Source: ''
[14:31:12] ✅ Patient data extraction completed successfully
[14:31:12] ✅    ✅ Patient data extracted successfully
[14:31:12] 📊 Patient Response
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'J90'}]
[14:31:12] ✅    ✅ Patient identified: Jeremias Teixeira
[14:31:12] ✅    ✅ Patient name validation passed
[14:31:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:31:12] [DOC: 9229855] ℹ️  DOB normalized: 12/26/1931
[14:31:12] [DOC: 9229855] ℹ️  Episode startOfCare normalized: 03/25/2025
[14:31:12] [DOC: 9229855] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:31:12] [DOC: 9229855] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:31:12] [DOC: 9229855] ✅ Patient date processing completed successfully
[14:31:12] ✅    ✅ Date processing completed
[14:31:12] 📊 Processed Patient Data
     └─ patientFName: Jeremias
     └─ patientLName: Teixeira
     └─ dob: 12/26/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'J90'}]
[14:31:12] 🔄 
🔄 Step 4: Extracting order data...
[14:31:15] ℹ️  Order extraction - MRN: '227027'
[14:31:15] ℹ️  Order extraction - Sex: 'MALE'
[14:31:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing,PT,OT'
[14:31:15] ℹ️  Order extraction - Payer Source: ''
[14:31:15] ✅ Order data extraction completed successfully
[14:31:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:31:15] ℹ️  Using MRN from patient data: '227027' over '227027'
[14:31:15] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing,PT,OT' = 'OT, PT, Skilled Nursing'
[14:31:15] ✅ Patient name cross-validation successful
[14:31:15] ✅    ✅ Data merged successfully
[14:31:18] ✅    ✅ Order data extracted and validated
[14:31:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:31:18] [DOC: 9229855] ✅ Patient found in local cache: Jeremias Teixeira, ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:31:18] ✅    ✅ Existing patient found with ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:31:18] 🔄 
🔄 Step 6: Pushing order to API...
[14:31:18] [DOC: 9229855] ℹ️  Pushing order via API for patient ID: b4f73061-83ef-486e-b374-3b920247ea12
[14:31:19] [DOC: 9229855] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:31:19] ❌    ❌ Failed to push order
[14:31:19] 🔄 
🔄 Step 7: Writing to CSV...
[14:31:19] [DOC: 9229855] ℹ️  Calculated age: 93 from DOB: 12/26/1931
[14:31:19] [DOC: 9229855] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[14:31:19] [DOC: 9229855] ℹ️  Payer Source extracted: ''
[14:31:19] [DOC: 9229855] ℹ️  Diagnosis codes being written:
[14:31:19] [DOC: 9229855] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[14:31:19] [DOC: 9229855] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[14:31:19] [DOC: 9229855] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[14:31:19] [DOC: 9229855] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.32'
[14:31:19] [DOC: 9229855] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.9'
[14:31:19] [DOC: 9229855] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J90'
[14:31:19] [DOC: 9229855] ✅ Patient data written to CSV: Jeremias Teixeira | Sex: MALE | Age: 93 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 227027
[14:31:19] ✅    ✅ Document 9229855 processed and saved successfully
[14:31:19] 🔄 
🔄 Step 8: Saving API details...
[14:31:19] [DOC: 9229855] ℹ️  API push details saved for document 9229855
[14:31:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229830                         ║
================================================================================
[14:31:19] ℹ️  Agency: AccentCare Fall River
[14:31:19] ℹ️  Date: 04/09/2025
[14:31:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:31:22] [DOC: 9229830] ✅ Text extracted using pdfplumber (1471 chars)
[14:31:22] ✅    ✅ Text extracted using pdfplumber (1471 chars)
[14:31:22] 🔄 
🔄 Step 2: Extracting patient data...
[14:31:25] ℹ️  AI extracted raw sex value: ''
[14:31:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:31:25] ℹ️  AI extracted payer source: ''
[14:31:25] ℹ️  AI extracted diagnoses:
[14:31:25] ℹ️    - Diagnosis 1: 'K56.0'
[14:31:25] ℹ️    - Diagnosis 2: 'I21.09'
[14:31:25] ℹ️    - Diagnosis 3: ''
[14:31:25] ℹ️    - Diagnosis 4: ''
[14:31:25] ℹ️    - Diagnosis 5: ''
[14:31:25] ℹ️    - Diagnosis 6: ''
[14:31:25] ℹ️  Final extracted MRN: 'C0200233174201'
[14:31:25] ℹ️  Final extracted Sex: ''
[14:31:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:31:25] ℹ️  Final extracted Payer Source: ''
[14:31:25] ✅ Patient data extraction completed successfully
[14:31:25] ✅    ✅ Patient data extracted successfully
[14:31:25] 📊 Patient Response
     └─ patientFName: CLAUDETTE
     └─ patientLName: LEMOS
     └─ dob: 08/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: C0200233174201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': 'K56.0', 'secondDiagnosis': 'I21.09', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:31:25] ✅    ✅ Patient identified: CLAUDETTE LEMOS
[14:31:25] ✅    ✅ Patient name validation passed
[14:31:25] 🔄 
🔄 Step 3: Processing patient dates...
[14:31:25] [DOC: 9229830] ℹ️  DOB normalized: 08/17/1948
[14:31:25] [DOC: 9229830] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[14:31:25] [DOC: 9229830] ℹ️  Episode endOfEpisode normalized: 03/08/2025
[14:31:25] [DOC: 9229830] ✅ Patient date processing completed successfully
[14:31:25] ✅    ✅ Date processing completed
[14:31:25] 📊 Processed Patient Data
     └─ patientFName: CLAUDETTE
     └─ patientLName: LEMOS
     └─ dob: 08/17/1948
     └─ patientSex: 
     └─ medicalRecordNo: C0200233174201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': 'K56.0', 'secondDiagnosis': 'I21.09', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:31:25] 🔄 
🔄 Step 4: Extracting order data...
[14:31:28] ℹ️  Order extraction - MRN: 'C0200233174201'
[14:31:28] ℹ️  Order extraction - Sex: ''
[14:31:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:31:28] ℹ️  Order extraction - Payer Source: ''
[14:31:28] ✅ Order data extraction completed successfully
[14:31:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:31:28] ℹ️  Using MRN from patient data: 'C0200233174201' over 'C0200233174201'
[14:31:28] ⚠️  Could not determine sex using any available method
[14:31:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:31:28] ✅ Patient name cross-validation successful
[14:31:28] ✅    ✅ Data merged successfully
[14:31:29] ✅    ✅ Order data extracted and validated
[14:31:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:32:40] [DOC: 9229830] ✅ Patient exists in API: CLAUDETTE LEMOS, ID: b50ff72b-362d-4117-be74-da5fd5b5ed5f
[14:32:40] ✅    ✅ Existing patient found with ID: b50ff72b-362d-4117-be74-da5fd5b5ed5f
[14:32:40] 🔄 
🔄 Step 6: Pushing order to API...
[14:32:40] [DOC: 9229830] ℹ️  Pushing order via API for patient ID: b50ff72b-362d-4117-be74-da5fd5b5ed5f
[14:32:41] [DOC: 9229830] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13933"}
[14:32:41] ❌    ❌ Failed to push order
[14:32:41] 🔄 
🔄 Step 7: Writing to CSV...
[14:32:41] [DOC: 9229830] ℹ️  Calculated age: 76 from DOB: 08/17/1948
[14:32:41] [DOC: 9229830] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:32:41] [DOC: 9229830] ℹ️  Payer Source extracted: ''
[14:32:41] [DOC: 9229830] ℹ️  Diagnosis codes being written:
[14:32:41] [DOC: 9229830] ℹ️    - Latest_Episode_Firstdiagnosis: 'K56.0'
[14:32:41] [DOC: 9229830] ℹ️    - Latest_Episode_Seconddiagnosis: 'I21.09'
[14:32:41] [DOC: 9229830] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:32:41] [DOC: 9229830] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:32:41] [DOC: 9229830] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:32:41] [DOC: 9229830] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:32:41] [DOC: 9229830] ✅ Patient data written to CSV: CLAUDETTE LEMOS | Sex:  | Age: 76 | Service: Skilled Nursing | Payer:  | MRN: C0200233174201
[14:32:41] ✅    ✅ Document 9229830 processed and saved successfully
[14:32:41] 🔄 
🔄 Step 8: Saving API details...
[14:32:41] [DOC: 9229830] ℹ️  API push details saved for document 9229830
[14:32:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229804                         ║
================================================================================
[14:32:41] ℹ️  Agency: Dartmouth HH
[14:32:41] ℹ️  Date: 04/09/2025
[14:32:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:32:44] [DOC: 9229804] ✅ Text extracted using pdfplumber (12411 chars)
[14:32:44] ✅    ✅ Text extracted using pdfplumber (12399 chars)
[14:32:44] 🔄 
🔄 Step 2: Extracting patient data...
[14:32:47] ℹ️  AI extracted raw sex value: 'F'
[14:32:47] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, HHA'
[14:32:47] ℹ️  AI extracted payer source: 'None'
[14:32:47] ℹ️  AI extracted diagnoses:
[14:32:47] ℹ️    - Diagnosis 1: 'L89.322'
[14:32:47] ℹ️    - Diagnosis 2: 'R26.89'
[14:32:47] ℹ️    - Diagnosis 3: 'F03.94'
[14:32:47] ℹ️    - Diagnosis 4: 'I12.9'
[14:32:47] ℹ️    - Diagnosis 5: 'E11.22'
[14:32:47] ℹ️    - Diagnosis 6: 'N18.31'
[14:32:47] ℹ️  Final extracted MRN: '2042001'
[14:32:47] ℹ️  Final extracted Sex: 'FEMALE'
[14:32:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, HHA'
[14:32:47] ℹ️  Final extracted Payer Source: ''
[14:32:47] ✅ Patient data extraction completed successfully
[14:32:47] ✅    ✅ Patient data extracted successfully
[14:32:47] 📊 Patient Response
     └─ patientFName: Perry
     └─ patientLName: Anile
     └─ dob: 03/27/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2042001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'L89.322', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'F03.94', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.31'}]
[14:32:47] ✅    ✅ Patient identified: Perry Anile
[14:32:47] ✅    ✅ Patient name validation passed
[14:32:47] 🔄 
🔄 Step 3: Processing patient dates...
[14:32:47] [DOC: 9229804] ℹ️  DOB normalized: 03/27/1934
[14:32:47] [DOC: 9229804] ℹ️  Episode startOfCare normalized: 04/01/2025
[14:32:47] [DOC: 9229804] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[14:32:47] [DOC: 9229804] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[14:32:47] [DOC: 9229804] ✅ Patient date processing completed successfully
[14:32:47] ✅    ✅ Date processing completed
[14:32:47] 📊 Processed Patient Data
     └─ patientFName: Perry
     └─ patientLName: Anile
     └─ dob: 03/27/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2042001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'L89.322', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'F03.94', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.31'}]
[14:32:47] 🔄 
🔄 Step 4: Extracting order data...
[14:32:50] ℹ️  Order extraction - MRN: '2042001'
[14:32:50] ℹ️  Order extraction - Sex: 'FEMALE'
[14:32:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:32:50] ℹ️  Order extraction - Payer Source: ''
[14:32:50] ✅ Order data extraction completed successfully
[14:32:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:32:50] ℹ️  Using MRN from patient data: '2042001' over '2042001'
[14:32:50] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT, HHA' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'HHA, OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[14:32:50] ✅ Patient name cross-validation successful
[14:32:50] ✅    ✅ Data merged successfully
[14:32:51] ✅    ✅ Order data extracted and validated
[14:32:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:32:58] [DOC: 9229804] ℹ️  Patient not found in cache or API: Perry Anile
[14:32:58] [DOC: 9229804] ℹ️  Patient not found, creating new patient via API...
[14:32:58] [DOC: 9229804] ℹ️  Creating patient via API: Perry Anile
[14:32:59] [DOC: 9229804] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:32:59] ❌    ❌ Failed to create patient
[14:32:59] [DOC: 9229804] ℹ️  API push details saved for document 9229804
================================================================================
║                        Processing Document ID: 9228216                         ║
================================================================================
[14:32:59] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:32:59] ℹ️  Date: 04/08/2025
[14:32:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:33:01] [DOC: 9228216] ✅ Text extracted using pdfplumber (1217 chars)
[14:33:01] ✅    ✅ Text extracted using pdfplumber (1217 chars)
[14:33:01] 🔄 
🔄 Step 2: Extracting patient data...
[14:33:04] ℹ️  AI extracted raw sex value: 'M'
[14:33:04] ℹ️  AI extracted service line: 'HHA'
[14:33:04] ℹ️  AI extracted payer source: 'UHC One Care'
[14:33:04] ℹ️  AI extracted diagnoses:
[14:33:04] ℹ️    - Diagnosis 1: ''
[14:33:04] ℹ️    - Diagnosis 2: ''
[14:33:04] ℹ️    - Diagnosis 3: ''
[14:33:04] ℹ️    - Diagnosis 4: ''
[14:33:04] ℹ️    - Diagnosis 5: ''
[14:33:04] ℹ️    - Diagnosis 6: ''
[14:33:04] ℹ️  Final extracted MRN: '17005'
[14:33:04] ℹ️  Final extracted Sex: 'MALE'
[14:33:04] ℹ️  Final extracted Service Line: 'HHA'
[14:33:04] ℹ️  Final extracted Payer Source: 'UHC One Care'
[14:33:04] ✅ Patient data extraction completed successfully
[14:33:04] ✅    ✅ Patient data extracted successfully
[14:33:04] 📊 Patient Response
     └─ patientFName: Daniel
     └─ patientLName: Medeiros
     └─ dob: 02/19/1967
     └─ patientSex: MALE
     └─ medicalRecordNo: 17005
     └─ billingProvider: Eshan A Patvardhan, MD
     └─ npi: 1497076046
     └─ physicianNPI: 1497076046
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: UHC One Care
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2019', 'startOfEpisode': '', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:33:04] ✅    ✅ Patient identified: Daniel Medeiros
[14:33:04] ✅    ✅ Patient name validation passed
[14:33:04] 🔄 
🔄 Step 3: Processing patient dates...
[14:33:04] [DOC: 9228216] ℹ️  DOB normalized: 02/19/1967
[14:33:04] [DOC: 9228216] ℹ️  Episode startOfCare normalized: 12/19/2019
[14:33:04] [DOC: 9228216] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[14:33:04] [DOC: 9228216] ✅ Patient date processing completed successfully
[14:33:04] ✅    ✅ Date processing completed
[14:33:04] 📊 Processed Patient Data
     └─ patientFName: Daniel
     └─ patientLName: Medeiros
     └─ dob: 02/19/1967
     └─ patientSex: MALE
     └─ medicalRecordNo: 17005
     └─ billingProvider: Eshan A Patvardhan, MD
     └─ npi: 1497076046
     └─ physicianNPI: 1497076046
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: UHC One Care
     └─ episodeDiagnoses: [{'startOfCare': '12/19/2019', 'startOfEpisode': '', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:33:04] 🔄 
🔄 Step 4: Extracting order data...
[14:33:06] ℹ️  Order extraction - MRN: '17005'
[14:33:06] ℹ️  Order extraction - Sex: 'MALE'
[14:33:06] ℹ️  Order extraction - Service Line: 'HHA'
[14:33:06] ℹ️  Order extraction - Payer Source: 'UHC One Care'
[14:33:06] ✅ Order data extraction completed successfully
[14:33:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:33:06] ℹ️  Using MRN from patient data: '17005' over '17005'
[14:33:06] ℹ️  Service line consistent in both sources: 'HHA'
[14:33:06] ℹ️  Payer source consistent in both sources: 'UHC One Care'
[14:33:06] ✅ Patient name cross-validation successful
[14:33:06] ✅    ✅ Data merged successfully
[14:33:11] ✅    ✅ Order data extracted and validated
[14:33:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:35:12] [DOC: 9228216] ✅ Patient exists in API: Daniel Medeiros, ID: 25f9a8bb-cfea-4835-97f7-facaa3749107
[14:35:12] ✅    ✅ Existing patient found with ID: 25f9a8bb-cfea-4835-97f7-facaa3749107
[14:35:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:35:12] [DOC: 9228216] ℹ️  Pushing order via API for patient ID: 25f9a8bb-cfea-4835-97f7-facaa3749107
[14:35:13] [DOC: 9228216] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:35:13] ❌    ❌ Failed to push order
[14:35:13] 🔄 
🔄 Step 7: Writing to CSV...
[14:35:13] [DOC: 9228216] ℹ️  Calculated age: 58 from DOB: 02/19/1967
[14:35:13] [DOC: 9228216] ℹ️  Service Line extracted: 'HHA'
[14:35:13] [DOC: 9228216] ℹ️  Payer Source extracted: 'UHC One Care'
[14:35:13] [DOC: 9228216] ℹ️  Diagnosis codes being written:
[14:35:13] [DOC: 9228216] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:35:13] [DOC: 9228216] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:35:13] [DOC: 9228216] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:35:13] [DOC: 9228216] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:35:13] [DOC: 9228216] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:35:13] [DOC: 9228216] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:35:13] [DOC: 9228216] ✅ Patient data written to CSV: Daniel Medeiros | Sex: MALE | Age: 58 | Service: HHA | Payer: UHC One Care | MRN: 17005
[14:35:13] ✅    ✅ Document 9228216 processed and saved successfully
[14:35:13] 🔄 
🔄 Step 8: Saving API details...
[14:35:13] [DOC: 9228216] ℹ️  API push details saved for document 9228216
[14:35:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228108                         ║
================================================================================
[14:35:13] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:35:13] ℹ️  Date: 04/08/2025
[14:35:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:35:25] [DOC: 9228108] ✅ Text extracted using pdfplumber (4013 chars)
[14:35:25] ✅    ✅ Text extracted using pdfplumber (4013 chars)
[14:35:25] 🔄 
🔄 Step 2: Extracting patient data...
[14:35:28] ℹ️  AI extracted raw sex value: 'M'
[14:35:28] ℹ️  AI extracted service line: 'PT, RN'
[14:35:28] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:35:28] ℹ️  AI extracted diagnoses:
[14:35:28] ℹ️    - Diagnosis 1: 'F32.9'
[14:35:28] ℹ️    - Diagnosis 2: 'I10'
[14:35:28] ℹ️    - Diagnosis 3: 'E78.5'
[14:35:28] ℹ️    - Diagnosis 4: 'Z95.820'
[14:35:28] ℹ️    - Diagnosis 5: 'Z72.0'
[14:35:28] ℹ️    - Diagnosis 6: 'F10.11'
[14:35:28] ℹ️  Final extracted MRN: '648005'
[14:35:28] ℹ️  Final extracted Sex: 'MALE'
[14:35:28] ℹ️  Final extracted Service Line: 'PT, RN'
[14:35:28] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:35:28] ✅ Patient data extraction completed successfully
[14:35:28] ✅    ✅ Patient data extracted successfully
[14:35:28] 📊 Patient Response
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Theophilus Addo, MD
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT, RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'Z95.820', 'fifthDiagnosis': 'Z72.0', 'sixthDiagnosis': 'F10.11'}]
[14:35:28] ✅    ✅ Patient identified: Pedro Sousa
[14:35:28] ✅    ✅ Patient name validation passed
[14:35:28] 🔄 
🔄 Step 3: Processing patient dates...
[14:35:28] [DOC: 9228108] ℹ️  DOB normalized: 03/29/1964
[14:35:28] [DOC: 9228108] ℹ️  Episode startOfCare normalized: 03/25/2025
[14:35:28] [DOC: 9228108] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:35:28] [DOC: 9228108] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:35:28] [DOC: 9228108] ✅ Patient date processing completed successfully
[14:35:28] ✅    ✅ Date processing completed
[14:35:28] 📊 Processed Patient Data
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Theophilus Addo, MD
     └─ npi: 1750479283
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT, RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'Z95.820', 'fifthDiagnosis': 'Z72.0', 'sixthDiagnosis': 'F10.11'}]
[14:35:28] 🔄 
🔄 Step 4: Extracting order data...
[14:35:31] ℹ️  Order extraction - MRN: '648005'
[14:35:31] ℹ️  Order extraction - Sex: 'MALE'
[14:35:31] ℹ️  Order extraction - Service Line: 'PT'
[14:35:31] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:35:31] ✅ Order data extraction completed successfully
[14:35:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:35:31] ℹ️  Using MRN from patient data: '648005' over '648005'
[14:35:31] ℹ️  Combined service lines: Patient='PT, RN' + Order='PT' = 'PT, RN'
[14:35:31] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:35:31] ✅ Patient name cross-validation successful
[14:35:31] ✅    ✅ Data merged successfully
[14:35:32] ✅    ✅ Order data extracted and validated
[14:35:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:35:32] [DOC: 9228108] ✅ Patient found in local cache: Pedro Sousa, ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:35:32] ✅    ✅ Existing patient found with ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:35:32] 🔄 
🔄 Step 6: Pushing order to API...
[14:35:32] [DOC: 9228108] ℹ️  Pushing order via API for patient ID: 2dc51ce5-9447-429a-994f-bc659210b701
[14:35:33] [DOC: 9228108] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:35:33] ❌    ❌ Failed to push order
[14:35:33] 🔄 
🔄 Step 7: Writing to CSV...
[14:35:33] [DOC: 9228108] ℹ️  Calculated age: 61 from DOB: 03/29/1964
[14:35:33] [DOC: 9228108] ℹ️  Service Line extracted: 'PT, RN'
[14:35:33] [DOC: 9228108] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:35:33] [DOC: 9228108] ℹ️  Diagnosis codes being written:
[14:35:33] [DOC: 9228108] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.9'
[14:35:33] [DOC: 9228108] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[14:35:33] [DOC: 9228108] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[14:35:33] [DOC: 9228108] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z95.820'
[14:35:33] [DOC: 9228108] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z72.0'
[14:35:33] [DOC: 9228108] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F10.11'
[14:35:33] [DOC: 9228108] ✅ Patient data written to CSV: Pedro Sousa | Sex: MALE | Age: 61 | Service: PT, RN | Payer: Medicaid/MA | MRN: 648005
[14:35:33] ✅    ✅ Document 9228108 processed and saved successfully
[14:35:33] 🔄 
🔄 Step 8: Saving API details...
[14:35:33] [DOC: 9228108] ℹ️  API push details saved for document 9228108
[14:35:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229728                         ║
================================================================================
[14:35:33] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[14:35:33] ℹ️  Date: 04/08/2025
[14:35:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:35:39] [DOC: 9229728] ✅ Text extracted using pdfplumber (1417 chars)
[14:35:39] ✅    ✅ Text extracted using pdfplumber (1417 chars)
[14:35:39] 🔄 
🔄 Step 2: Extracting patient data...
[14:35:43] ℹ️  AI extracted raw sex value: ''
[14:35:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:35:43] ℹ️  AI extracted payer source: 'Medicare'
[14:35:43] ℹ️  AI extracted diagnoses:
[14:35:43] ℹ️    - Diagnosis 1: 'None'
[14:35:43] ℹ️    - Diagnosis 2: 'None'
[14:35:43] ℹ️    - Diagnosis 3: 'None'
[14:35:43] ℹ️    - Diagnosis 4: 'None'
[14:35:43] ℹ️    - Diagnosis 5: 'None'
[14:35:43] ℹ️    - Diagnosis 6: 'None'
[14:35:43] ℹ️  Final extracted MRN: '28700194813801'
[14:35:43] ℹ️  Final extracted Sex: ''
[14:35:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:35:43] ℹ️  Final extracted Payer Source: 'Medicare'
[14:35:43] ✅ Patient data extraction completed successfully
[14:35:43] ✅    ✅ Patient data extracted successfully
[14:35:43] 📊 Patient Response
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:35:43] ✅    ✅ Patient identified: MANUEL DEMELLO
[14:35:43] ✅    ✅ Patient name validation passed
[14:35:43] 🔄 
🔄 Step 3: Processing patient dates...
[14:35:43] [DOC: 9229728] ℹ️  DOB normalized: 03/22/1945
[14:35:43] [DOC: 9229728] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[14:35:43] [DOC: 9229728] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[14:35:43] [DOC: 9229728] ✅ Patient date processing completed successfully
[14:35:43] ✅    ✅ Date processing completed
[14:35:43] 📊 Processed Patient Data
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '03/22/2025'}]
[14:35:43] 🔄 
🔄 Step 4: Extracting order data...
[14:35:45] ℹ️  Order extraction - MRN: '28700194813801'
[14:35:45] ℹ️  Order extraction - Sex: ''
[14:35:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:35:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:35:45] ✅ Order data extraction completed successfully
[14:35:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:35:45] ℹ️  Using MRN from patient data: '28700194813801' over '28700194813801'
[14:35:45] ⚠️  Could not determine sex using any available method
[14:35:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:35:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:35:45] ✅ Patient name cross-validation successful
[14:35:45] ✅    ✅ Data merged successfully
[14:35:46] ✅    ✅ Order data extracted and validated
[14:35:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:35:46] [DOC: 9229728] ✅ Patient found in local cache: MANUEL DEMELLO, ID: 54784569-a65e-445e-be68-20a38f0b9a63
[14:35:46] ✅    ✅ Existing patient found with ID: 54784569-a65e-445e-be68-20a38f0b9a63
[14:35:46] 🔄 
🔄 Step 6: Pushing order to API...
[14:35:46] [DOC: 9229728] ℹ️  Pushing order via API for patient ID: 54784569-a65e-445e-be68-20a38f0b9a63
[14:35:53] [DOC: 9229728] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13813"}
[14:35:53] ❌    ❌ Failed to push order
[14:35:53] 🔄 
🔄 Step 7: Writing to CSV...
[14:35:53] [DOC: 9229728] ℹ️  Calculated age: 80 from DOB: 03/22/1945
[14:35:53] [DOC: 9229728] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:35:53] [DOC: 9229728] ℹ️  Payer Source extracted: 'Medicare'
[14:35:53] [DOC: 9229728] ℹ️  Diagnosis codes being written:
[14:35:53] [DOC: 9229728] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:35:53] [DOC: 9229728] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:35:53] [DOC: 9229728] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:35:53] [DOC: 9229728] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:35:53] [DOC: 9229728] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:35:53] [DOC: 9229728] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:35:53] [DOC: 9229728] ✅ Patient data written to CSV: MANUEL DEMELLO | Sex:  | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700194813801
[14:35:53] ✅    ✅ Document 9229728 processed and saved successfully
[14:35:53] 🔄 
🔄 Step 8: Saving API details...
[14:35:53] [DOC: 9229728] ℹ️  API push details saved for document 9229728
[14:35:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229070                         ║
================================================================================
[14:35:53] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:35:53] ℹ️  Date: 04/08/2025
[14:35:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:35:56] [DOC: 9229070] ✅ Text extracted using pdfplumber (1380 chars)
[14:35:56] ✅    ✅ Text extracted using pdfplumber (1380 chars)
[14:35:56] 🔄 
🔄 Step 2: Extracting patient data...
[14:35:59] ℹ️  AI extracted raw sex value: 'F'
[14:35:59] ℹ️  AI extracted service line: 'HHA'
[14:35:59] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:35:59] ℹ️  AI extracted diagnoses:
[14:35:59] ℹ️    - Diagnosis 1: 'None'
[14:35:59] ℹ️    - Diagnosis 2: 'None'
[14:35:59] ℹ️    - Diagnosis 3: 'None'
[14:35:59] ℹ️    - Diagnosis 4: 'None'
[14:35:59] ℹ️    - Diagnosis 5: 'None'
[14:35:59] ℹ️    - Diagnosis 6: 'None'
[14:35:59] ℹ️  Final extracted MRN: '253005'
[14:35:59] ℹ️  Final extracted Sex: 'FEMALE'
[14:35:59] ℹ️  Final extracted Service Line: 'HHA'
[14:35:59] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:35:59] ✅ Patient data extraction completed successfully
[14:35:59] ✅    ✅ Patient data extracted successfully
[14:35:59] 📊 Patient Response
     └─ patientFName: Versana
     └─ patientLName: Fernandes
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': None, 'endOfEpisode': '05/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:35:59] ✅    ✅ Patient identified: Versana Fernandes
[14:35:59] ✅    ✅ Patient name validation passed
[14:35:59] 🔄 
🔄 Step 3: Processing patient dates...
[14:35:59] [DOC: 9229070] ℹ️  DOB normalized: 04/22/1971
[14:35:59] [DOC: 9229070] ℹ️  Episode startOfCare normalized: 12/16/2021
[14:35:59] [DOC: 9229070] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[14:35:59] [DOC: 9229070] ✅ Patient date processing completed successfully
[14:35:59] ✅    ✅ Date processing completed
[14:35:59] 📊 Processed Patient Data
     └─ patientFName: Versana
     └─ patientLName: Fernandes
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'endOfEpisode': '05/28/2025'}]
[14:35:59] 🔄 
🔄 Step 4: Extracting order data...
[14:36:01] ℹ️  Order extraction - MRN: '253005'
[14:36:01] ℹ️  Order extraction - Sex: 'FEMALE'
[14:36:01] ℹ️  Order extraction - Service Line: 'HHA'
[14:36:01] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:36:01] ✅ Order data extraction completed successfully
[14:36:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:36:01] ℹ️  Using MRN from patient data: '253005' over '253005'
[14:36:01] ℹ️  Service line consistent in both sources: 'HHA'
[14:36:01] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:36:01] ✅ Patient name cross-validation successful
[14:36:01] ✅    ✅ Data merged successfully
[14:36:02] ✅    ✅ Order data extracted and validated
[14:36:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:38:19] [DOC: 9229070] ✅ Patient exists in API: Versana Fernandes, ID: b30b374a-c6a5-47cf-8358-62624caba394
[14:38:19] ✅    ✅ Existing patient found with ID: b30b374a-c6a5-47cf-8358-62624caba394
[14:38:19] 🔄 
🔄 Step 6: Pushing order to API...
[14:38:19] [DOC: 9229070] ℹ️  Pushing order via API for patient ID: b30b374a-c6a5-47cf-8358-62624caba394
[14:38:21] [DOC: 9229070] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:38:21] ❌    ❌ Failed to push order
[14:38:21] 🔄 
🔄 Step 7: Writing to CSV...
[14:38:21] [DOC: 9229070] ℹ️  Calculated age: 54 from DOB: 04/22/1971
[14:38:21] [DOC: 9229070] ℹ️  Service Line extracted: 'HHA'
[14:38:21] [DOC: 9229070] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:38:21] [DOC: 9229070] ℹ️  Diagnosis codes being written:
[14:38:21] [DOC: 9229070] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:38:21] [DOC: 9229070] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:38:21] [DOC: 9229070] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:38:21] [DOC: 9229070] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:38:21] [DOC: 9229070] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:38:21] [DOC: 9229070] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:38:21] [DOC: 9229070] ✅ Patient data written to CSV: Versana Fernandes | Sex: FEMALE | Age: 54 | Service: HHA | Payer: Medicaid/MA | MRN: 253005
[14:38:21] ✅    ✅ Document 9229070 processed and saved successfully
[14:38:21] 🔄 
🔄 Step 8: Saving API details...
[14:38:21] [DOC: 9229070] ℹ️  API push details saved for document 9229070
[14:38:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229052                         ║
================================================================================
[14:38:21] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:38:21] ℹ️  Date: 04/08/2025
[14:38:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:38:23] [DOC: 9229052] ✅ Text extracted using pdfplumber (3031 chars)
[14:38:23] ✅    ✅ Text extracted using pdfplumber (3031 chars)
[14:38:23] 🔄 
🔄 Step 2: Extracting patient data...
[14:38:26] ℹ️  AI extracted raw sex value: 'F'
[14:38:26] ℹ️  AI extracted service line: 'PT'
[14:38:26] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:38:26] ℹ️  AI extracted diagnoses:
[14:38:26] ℹ️    - Diagnosis 1: ''
[14:38:26] ℹ️    - Diagnosis 2: ''
[14:38:26] ℹ️    - Diagnosis 3: ''
[14:38:26] ℹ️    - Diagnosis 4: ''
[14:38:26] ℹ️    - Diagnosis 5: ''
[14:38:26] ℹ️    - Diagnosis 6: ''
[14:38:26] ℹ️  Final extracted MRN: '225004'
[14:38:26] ℹ️  Final extracted Sex: 'FEMALE'
[14:38:26] ℹ️  Final extracted Service Line: 'PT'
[14:38:26] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:38:26] ✅ Patient data extraction completed successfully
[14:38:26] ✅    ✅ Patient data extracted successfully
[14:38:26] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Desousa
     └─ dob: 01/21/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 225004
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2024', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:38:26] ✅    ✅ Patient identified: Maria Desousa
[14:38:26] ✅    ✅ Patient name validation passed
[14:38:26] 🔄 
🔄 Step 3: Processing patient dates...
[14:38:26] [DOC: 9229052] ℹ️  DOB normalized: 01/21/1959
[14:38:26] [DOC: 9229052] ℹ️  Episode startOfCare normalized: 09/04/2024
[14:38:26] [DOC: 9229052] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[14:38:26] [DOC: 9229052] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[14:38:26] [DOC: 9229052] ✅ Patient date processing completed successfully
[14:38:26] ✅    ✅ Date processing completed
[14:38:26] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Desousa
     └─ dob: 01/21/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 225004
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2024', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:38:26] 🔄 
🔄 Step 4: Extracting order data...
[14:38:29] ℹ️  Order extraction - MRN: '225004'
[14:38:29] ℹ️  Order extraction - Sex: 'FEMALE'
[14:38:29] ℹ️  Order extraction - Service Line: 'PT'
[14:38:29] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:38:29] ✅ Order data extraction completed successfully
[14:38:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:38:29] ℹ️  Using MRN from patient data: '225004' over '225004'
[14:38:29] ℹ️  Service line consistent in both sources: 'PT'
[14:38:29] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:38:29] ✅ Patient name cross-validation successful
[14:38:29] ✅    ✅ Data merged successfully
[14:38:30] ✅    ✅ Order data extracted and validated
[14:38:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:41:06] [DOC: 9229052] ℹ️  Patient not found in cache or API: Maria Desousa
[14:41:06] [DOC: 9229052] ℹ️  Patient not found, creating new patient via API...
[14:41:06] [DOC: 9229052] ℹ️  Creating patient via API: Maria Desousa
[14:41:07] [DOC: 9229052] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:41:07] ❌    ❌ Failed to create patient
[14:41:07] [DOC: 9229052] ℹ️  API push details saved for document 9229052
================================================================================
║                        Processing Document ID: 9229029                         ║
================================================================================
[14:41:07] ℹ️  Agency: Brockton Home Health Care
[14:41:07] ℹ️  Date: 04/08/2025
[14:41:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:41:09] [DOC: 9229029] ✅ Text extracted using pdfplumber (1205 chars)
[14:41:09] ✅    ✅ Text extracted using pdfplumber (1193 chars)
[14:41:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:41:12] ℹ️  AI extracted raw sex value: 'M'
[14:41:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:41:12] ℹ️  AI extracted payer source: ''
[14:41:12] ℹ️  AI extracted diagnoses:
[14:41:12] ℹ️    - Diagnosis 1: ''
[14:41:12] ℹ️    - Diagnosis 2: ''
[14:41:12] ℹ️    - Diagnosis 3: ''
[14:41:12] ℹ️    - Diagnosis 4: ''
[14:41:12] ℹ️    - Diagnosis 5: ''
[14:41:12] ℹ️    - Diagnosis 6: ''
[14:41:12] ℹ️  Final extracted MRN: 'BHHA1887764'
[14:41:12] ℹ️  Final extracted Sex: 'MALE'
[14:41:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:41:12] ℹ️  Final extracted Payer Source: ''
[14:41:12] ✅ Patient data extraction completed successfully
[14:41:12] ✅    ✅ Patient data extracted successfully
[14:41:12] 📊 Patient Response
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SOC SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:41:12] ✅    ✅ Patient identified: EARL THOMPSON
[14:41:12] ✅    ✅ Patient name validation passed
[14:41:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:41:12] [DOC: 9229029] ℹ️  DOB normalized: 05/31/2002
[14:41:12] [DOC: 9229029] ℹ️  Episode startOfCare normalized: 04/29/2024
[14:41:12] [DOC: 9229029] ℹ️  Episode startOfEpisode normalized: 04/29/2024
[14:41:12] [DOC: 9229029] ℹ️  Episode endOfEpisode normalized: 06/27/2024
[14:41:12] [DOC: 9229029] ✅ Patient date processing completed successfully
[14:41:12] ✅    ✅ Date processing completed
[14:41:12] 📊 Processed Patient Data
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SOC SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:41:12] 🔄 
🔄 Step 4: Extracting order data...
[14:41:14] ℹ️  Order extraction - MRN: 'BHHA1887764'
[14:41:14] ℹ️  Order extraction - Sex: 'MALE'
[14:41:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:41:14] ℹ️  Order extraction - Payer Source: ''
[14:41:14] ✅ Order data extraction completed successfully
[14:41:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:41:14] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[14:41:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:41:14] ✅ Patient name cross-validation successful
[14:41:14] ✅    ✅ Data merged successfully
[14:41:15] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[14:41:15] [DOC: 9229029] ℹ️  API push details saved for document 9229029
================================================================================
║                        Processing Document ID: 9229028                         ║
================================================================================
[14:41:15] ℹ️  Agency: Brockton Home Health Care
[14:41:15] ℹ️  Date: 04/08/2025
[14:41:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:41:17] [DOC: 9229028] ✅ Text extracted using pdfplumber (2994 chars)
[14:41:17] ✅    ✅ Text extracted using pdfplumber (2970 chars)
[14:41:17] 🔄 
🔄 Step 2: Extracting patient data...
[14:41:20] ℹ️  AI extracted raw sex value: 'M'
[14:41:20] ℹ️  AI extracted service line: 'RN'
[14:41:20] ℹ️  AI extracted payer source: ''
[14:41:20] ℹ️  AI extracted diagnoses:
[14:41:20] ℹ️    - Diagnosis 1: ''
[14:41:20] ℹ️    - Diagnosis 2: ''
[14:41:20] ℹ️    - Diagnosis 3: ''
[14:41:20] ℹ️    - Diagnosis 4: ''
[14:41:20] ℹ️    - Diagnosis 5: ''
[14:41:20] ℹ️    - Diagnosis 6: ''
[14:41:20] ℹ️  Final extracted MRN: 'BHHA1887764'
[14:41:20] ℹ️  Final extracted Sex: 'MALE'
[14:41:20] ℹ️  Final extracted Service Line: 'RN'
[14:41:20] ℹ️  Final extracted Payer Source: ''
[14:41:20] ✅ Patient data extraction completed successfully
[14:41:20] ✅    ✅ Patient data extracted successfully
[14:41:20] 📊 Patient Response
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:41:20] ✅    ✅ Patient identified: EARL THOMPSON
[14:41:20] ✅    ✅ Patient name validation passed
[14:41:20] 🔄 
🔄 Step 3: Processing patient dates...
[14:41:20] [DOC: 9229028] ℹ️  DOB normalized: 05/31/2002
[14:41:20] [DOC: 9229028] ℹ️  Episode startOfEpisode normalized: 04/29/2024
[14:41:20] [DOC: 9229028] ℹ️  Episode endOfEpisode normalized: 06/27/2024
[14:41:20] [DOC: 9229028] ✅ Patient date processing completed successfully
[14:41:20] ✅    ✅ Date processing completed
[14:41:20] 📊 Processed Patient Data
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:41:20] 🔄 
🔄 Step 4: Extracting order data...
[14:41:23] ℹ️  Order extraction - MRN: 'BHHA1887764'
[14:41:23] ℹ️  Order extraction - Sex: 'MALE'
[14:41:23] ℹ️  Order extraction - Service Line: 'RN'
[14:41:23] ℹ️  Order extraction - Payer Source: ''
[14:41:23] ✅ Order data extraction completed successfully
[14:41:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:41:23] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[14:41:23] ℹ️  Service line consistent in both sources: 'RN'
[14:41:23] ✅ Patient name cross-validation successful
[14:41:23] ✅    ✅ Data merged successfully
[14:41:25] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[14:41:25] [DOC: 9229028] ℹ️  API push details saved for document 9229028
================================================================================
║                        Processing Document ID: 9229030                         ║
================================================================================
[14:41:25] ℹ️  Agency: Brockton Home Health Care
[14:41:25] ℹ️  Date: 04/08/2025
[14:41:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:41:28] [DOC: 9229030] ✅ Text extracted using pdfplumber (17035 chars)
[14:41:28] ✅    ✅ Text extracted using pdfplumber (17035 chars)
[14:41:28] 🔄 
🔄 Step 2: Extracting patient data...
[14:41:31] ℹ️  AI extracted raw sex value: 'M'
[14:41:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:41:31] ℹ️  AI extracted payer source: ''
[14:41:31] ℹ️  AI extracted diagnoses:
[14:41:31] ℹ️    - Diagnosis 1: 'F25.0'
[14:41:31] ℹ️    - Diagnosis 2: 'F32.A'
[14:41:31] ℹ️    - Diagnosis 3: 'G47.9'
[14:41:31] ℹ️    - Diagnosis 4: 'Z91.51'
[14:41:31] ℹ️    - Diagnosis 5: 'K21.9'
[14:41:31] ℹ️    - Diagnosis 6: 'J45.909'
[14:41:31] ℹ️  Final extracted MRN: 'BHHA1887764'
[14:41:31] ℹ️  Final extracted Sex: 'MALE'
[14:41:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:41:31] ℹ️  Final extracted Payer Source: ''
[14:41:31] ✅ Patient data extraction completed successfully
[14:41:31] ✅    ✅ Patient data extracted successfully
[14:41:31] 📊 Patient Response
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': 'Z91.51', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'J45.909'}]
[14:41:31] ✅    ✅ Patient identified: Earl Thompson
[14:41:31] ✅    ✅ Patient name validation passed
[14:41:31] 🔄 
🔄 Step 3: Processing patient dates...
[14:41:31] [DOC: 9229030] ℹ️  DOB normalized: 05/31/2002
[14:41:31] [DOC: 9229030] ℹ️  Episode startOfCare normalized: 04/29/2024
[14:41:31] [DOC: 9229030] ℹ️  Episode startOfEpisode normalized: 04/29/2024
[14:41:31] [DOC: 9229030] ℹ️  Episode endOfEpisode normalized: 06/27/2024
[14:41:31] [DOC: 9229030] ✅ Patient date processing completed successfully
[14:41:31] ✅    ✅ Date processing completed
[14:41:31] 📊 Processed Patient Data
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': 'Z91.51', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'J45.909'}]
[14:41:31] 🔄 
🔄 Step 4: Extracting order data...
[14:41:34] ℹ️  Order extraction - MRN: 'BHHA1887764'
[14:41:34] ℹ️  Order extraction - Sex: 'MALE'
[14:41:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:41:34] ℹ️  Order extraction - Payer Source: ''
[14:41:34] ✅ Order data extraction completed successfully
[14:41:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:41:34] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[14:41:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:41:34] ✅ Patient name cross-validation successful
[14:41:34] ✅    ✅ Data merged successfully
[14:41:39] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[14:41:39] [DOC: 9229030] ℹ️  API push details saved for document 9229030
================================================================================
║                        Processing Document ID: 9228902                         ║
================================================================================
[14:41:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:41:39] ℹ️  Date: 04/08/2025
[14:41:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:41:55] [DOC: 9228902] ✅ Text extracted using pdfplumber (24105 chars)
[14:41:55] ✅    ✅ Text extracted using pdfplumber (24105 chars)
[14:41:55] 🔄 
🔄 Step 2: Extracting patient data...
[14:41:58] ℹ️  AI extracted raw sex value: 'F'
[14:41:58] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:41:58] ℹ️  AI extracted payer source: ''
[14:41:58] ℹ️  AI extracted diagnoses:
[14:41:58] ℹ️    - Diagnosis 1: 'Z48.3'
[14:41:58] ℹ️    - Diagnosis 2: 'C50.912'
[14:41:58] ℹ️    - Diagnosis 3: 'E11.40'
[14:41:58] ℹ️    - Diagnosis 4: 'I10'
[14:41:58] ℹ️    - Diagnosis 5: 'J45.40'
[14:41:58] ℹ️    - Diagnosis 6: 'E05.90'
[14:41:58] ℹ️  Final extracted MRN: '2916045'
[14:41:58] ℹ️  Final extracted Sex: 'FEMALE'
[14:41:58] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:41:58] ℹ️  Final extracted Payer Source: ''
[14:41:58] ✅ Patient data extraction completed successfully
[14:41:58] ✅    ✅ Patient data extracted successfully
[14:41:58] 📊 Patient Response
     └─ patientFName: Madalena
     └─ patientLName: Rodrigues
     └─ dob: 11/03/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2916045
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'Z48.3', 'secondDiagnosis': 'C50.912', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J45.40', 'sixthDiagnosis': 'E05.90'}]
[14:41:58] ✅    ✅ Patient identified: Madalena Rodrigues
[14:41:58] ✅    ✅ Patient name validation passed
[14:41:58] 🔄 
🔄 Step 3: Processing patient dates...
[14:41:58] [DOC: 9228902] ℹ️  DOB normalized: 11/03/1931
[14:41:58] [DOC: 9228902] ℹ️  Episode startOfCare normalized: 03/21/2025
[14:41:58] [DOC: 9228902] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:41:58] [DOC: 9228902] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:41:58] [DOC: 9228902] ✅ Patient date processing completed successfully
[14:41:58] ✅    ✅ Date processing completed
[14:41:58] 📊 Processed Patient Data
     └─ patientFName: Madalena
     └─ patientLName: Rodrigues
     └─ dob: 11/03/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2916045
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'Z48.3', 'secondDiagnosis': 'C50.912', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J45.40', 'sixthDiagnosis': 'E05.90'}]
[14:41:58] 🔄 
🔄 Step 4: Extracting order data...
[14:42:01] ℹ️  Order extraction - MRN: '2916045'
[14:42:01] ℹ️  Order extraction - Sex: 'FEMALE'
[14:42:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:42:01] ℹ️  Order extraction - Payer Source: ''
[14:42:01] ✅ Order data extraction completed successfully
[14:42:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:42:01] ℹ️  Using MRN from patient data: '2916045' over '2916045'
[14:42:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:42:01] ✅ Patient name cross-validation successful
[14:42:01] ✅    ✅ Data merged successfully
[14:42:03] ✅    ✅ Order data extracted and validated
[14:42:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:44:54] [DOC: 9228902] ℹ️  Patient not found in cache or API: Madalena Rodrigues
[14:44:54] [DOC: 9228902] ℹ️  Patient not found, creating new patient via API...
[14:44:54] [DOC: 9228902] ℹ️  Creating patient via API: Madalena Rodrigues
[14:44:55] [DOC: 9228902] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:44:55] ❌    ❌ Failed to create patient
[14:44:55] [DOC: 9228902] ℹ️  API push details saved for document 9228902
================================================================================
║                        Processing Document ID: 9228895                         ║
================================================================================
[14:44:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:44:55] ℹ️  Date: 04/08/2025
[14:44:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:45:00] [DOC: 9228895] ✅ Text extracted using pdfplumber (8786 chars)
[14:45:00] ✅    ✅ Text extracted using pdfplumber (8786 chars)
[14:45:00] 🔄 
🔄 Step 2: Extracting patient data...
[14:45:03] ℹ️  AI extracted raw sex value: 'F'
[14:45:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:45:03] ℹ️  AI extracted payer source: ''
[14:45:03] ℹ️  AI extracted diagnoses:
[14:45:03] ℹ️    - Diagnosis 1: 'E53.8'
[14:45:03] ℹ️    - Diagnosis 2: 'E11.9'
[14:45:03] ℹ️    - Diagnosis 3: 'I10'
[14:45:03] ℹ️    - Diagnosis 4: 'G89.4'
[14:45:03] ℹ️    - Diagnosis 5: 'I47.10'
[14:45:03] ℹ️    - Diagnosis 6: 'F32.9'
[14:45:03] ℹ️  Final extracted MRN: '2121459'
[14:45:03] ℹ️  Final extracted Sex: 'FEMALE'
[14:45:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:45:03] ℹ️  Final extracted Payer Source: ''
[14:45:03] ✅ Patient data extraction completed successfully
[14:45:03] ✅    ✅ Patient data extracted successfully
[14:45:03] 📊 Patient Response
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'E53.8', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'I47.10', 'sixthDiagnosis': 'F32.9'}]
[14:45:03] ✅    ✅ Patient identified: Anita Rodrigues
[14:45:03] ✅    ✅ Patient name validation passed
[14:45:03] 🔄 
🔄 Step 3: Processing patient dates...
[14:45:03] [DOC: 9228895] ℹ️  DOB normalized: 09/12/1942
[14:45:03] [DOC: 9228895] ℹ️  Episode startOfCare normalized: 03/26/2025
[14:45:03] [DOC: 9228895] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[14:45:03] [DOC: 9228895] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[14:45:03] [DOC: 9228895] ✅ Patient date processing completed successfully
[14:45:03] ✅    ✅ Date processing completed
[14:45:03] 📊 Processed Patient Data
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'E53.8', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'I47.10', 'sixthDiagnosis': 'F32.9'}]
[14:45:03] 🔄 
🔄 Step 4: Extracting order data...
[14:45:06] ℹ️  Order extraction - MRN: '2121459'
[14:45:06] ℹ️  Order extraction - Sex: 'FEMALE'
[14:45:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:45:06] ℹ️  Order extraction - Payer Source: ''
[14:45:06] ✅ Order data extraction completed successfully
[14:45:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:45:06] ℹ️  Using MRN from patient data: '2121459' over '2121459'
[14:45:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:45:06] ✅ Patient name cross-validation successful
[14:45:06] ✅    ✅ Data merged successfully
[14:45:46] ✅    ✅ Order data extracted and validated
[14:45:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:48:34] [DOC: 9228895] ℹ️  Patient not found in cache or API: Anita Rodrigues
[14:48:34] [DOC: 9228895] ℹ️  Patient not found, creating new patient via API...
[14:48:34] [DOC: 9228895] ℹ️  Creating patient via API: Anita Rodrigues
[14:48:35] [DOC: 9228895] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:48:35] ❌    ❌ Failed to create patient
[14:48:35] [DOC: 9228895] ℹ️  API push details saved for document 9228895
================================================================================
║                        Processing Document ID: 9228888                         ║
================================================================================
[14:48:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:48:35] ℹ️  Date: 04/08/2025
[14:48:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:49:02] [DOC: 9228888] ✅ Text extracted using pdfplumber (18633 chars)
[14:49:02] ✅    ✅ Text extracted using pdfplumber (18633 chars)
[14:49:02] 🔄 
🔄 Step 2: Extracting patient data...
[14:49:06] ℹ️  AI extracted raw sex value: 'M'
[14:49:06] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:49:06] ℹ️  AI extracted payer source: ''
[14:49:06] ℹ️  AI extracted diagnoses:
[14:49:06] ℹ️    - Diagnosis 1: 'I11.0'
[14:49:06] ℹ️    - Diagnosis 2: 'I50.31'
[14:49:06] ℹ️    - Diagnosis 3: 'J18.9'
[14:49:06] ℹ️    - Diagnosis 4: 'J44.0'
[14:49:06] ℹ️    - Diagnosis 5: 'J96.01'
[14:49:06] ℹ️    - Diagnosis 6: 'I48.20'
[14:49:06] ℹ️  Final extracted MRN: '2060640'
[14:49:06] ℹ️  Final extracted Sex: 'MALE'
[14:49:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:49:06] ℹ️  Final extracted Payer Source: ''
[14:49:06] ✅ Patient data extraction completed successfully
[14:49:06] ✅    ✅ Patient data extracted successfully
[14:49:06] 📊 Patient Response
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.31', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'J44.0', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'I48.20'}]
[14:49:06] ✅    ✅ Patient identified: Elisio Pimental
[14:49:06] ✅    ✅ Patient name validation passed
[14:49:06] 🔄 
🔄 Step 3: Processing patient dates...
[14:49:06] [DOC: 9228888] ℹ️  DOB normalized: 05/17/1944
[14:49:06] [DOC: 9228888] ℹ️  Episode startOfCare normalized: 03/24/2025
[14:49:06] [DOC: 9228888] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:49:06] [DOC: 9228888] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:49:06] [DOC: 9228888] ✅ Patient date processing completed successfully
[14:49:06] ✅    ✅ Date processing completed
[14:49:06] 📊 Processed Patient Data
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.31', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'J44.0', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'I48.20'}]
[14:49:06] 🔄 
🔄 Step 4: Extracting order data...
[14:49:08] ℹ️  Order extraction - MRN: '2060640'
[14:49:08] ℹ️  Order extraction - Sex: 'MALE'
[14:49:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:49:08] ℹ️  Order extraction - Payer Source: ''
[14:49:08] ✅ Order data extraction completed successfully
[14:49:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:49:08] ℹ️  Using MRN from patient data: '2060640' over '2060640'
[14:49:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:49:08] ✅ Patient name cross-validation successful
[14:49:08] ✅    ✅ Data merged successfully
[14:49:10] ✅    ✅ Order data extracted and validated
[14:49:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:49:10] [DOC: 9228888] ✅ Patient found in local cache: Elisio Pimental, ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[14:49:10] ✅    ✅ Existing patient found with ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[14:49:10] 🔄 
🔄 Step 6: Pushing order to API...
[14:49:10] [DOC: 9228888] ℹ️  Pushing order via API for patient ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[14:49:14] [DOC: 9228888] ❌ Order push failed with status 201: {"id":"06c9328a-9f44-44ed-b799-86a2af2ed56a","orderWAVId":"ORD20049","orderNo":"1079422","orderDate":"04/07/2025","startOfCare":"03/24/2025","episodeStartDate":"03/26/2025","episodeEndDate":"05/24/2025","documentID":"9228888","mrn":"2060640","patientName":"Pimental,Elisio C","sentToPhysicianDate":"04/08/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/15/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Plan of Care","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"5abd79cf-ab92-43b9-8f9e-55ba862ed92b","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:49:14] ❌    ❌ Failed to push order
[14:49:14] 🔄 
🔄 Step 7: Writing to CSV...
[14:49:14] [DOC: 9228888] ℹ️  Calculated age: 81 from DOB: 05/17/1944
[14:49:14] [DOC: 9228888] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:49:14] [DOC: 9228888] ℹ️  Payer Source extracted: ''
[14:49:14] [DOC: 9228888] ℹ️  Diagnosis codes being written:
[14:49:14] [DOC: 9228888] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[14:49:14] [DOC: 9228888] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.31'
[14:49:14] [DOC: 9228888] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[14:49:14] [DOC: 9228888] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.0'
[14:49:14] [DOC: 9228888] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J96.01'
[14:49:14] [DOC: 9228888] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.20'
[14:49:14] [DOC: 9228888] ✅ Patient data written to CSV: Elisio Pimental | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2060640
[14:49:14] ✅    ✅ Document 9228888 processed and saved successfully
[14:49:14] 🔄 
🔄 Step 8: Saving API details...
[14:49:14] [DOC: 9228888] ℹ️  API push details saved for document 9228888
[14:49:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228885                         ║
================================================================================
[14:49:14] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:49:14] ℹ️  Date: 04/08/2025
[14:49:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:49:19] [DOC: 9228885] ✅ Text extracted using pdfplumber (1246 chars)
[14:49:19] ✅    ✅ Text extracted using pdfplumber (1246 chars)
[14:49:19] 🔄 
🔄 Step 2: Extracting patient data...
[14:49:22] ℹ️  AI extracted raw sex value: 'F'
[14:49:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:49:22] ℹ️  AI extracted payer source: ''
[14:49:22] ℹ️  AI extracted diagnoses:
[14:49:22] ℹ️    - Diagnosis 1: ''
[14:49:22] ℹ️    - Diagnosis 2: ''
[14:49:22] ℹ️    - Diagnosis 3: ''
[14:49:22] ℹ️    - Diagnosis 4: ''
[14:49:22] ℹ️    - Diagnosis 5: ''
[14:49:22] ℹ️    - Diagnosis 6: ''
[14:49:22] ℹ️  Final extracted MRN: '2750591'
[14:49:22] ℹ️  Final extracted Sex: 'FEMALE'
[14:49:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:49:22] ℹ️  Final extracted Payer Source: ''
[14:49:22] ✅ Patient data extraction completed successfully
[14:49:22] ✅    ✅ Patient data extracted successfully
[14:49:22] 📊 Patient Response
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:49:22] ✅    ✅ Patient identified: Valentina Miguel
[14:49:22] ✅    ✅ Patient name validation passed
[14:49:22] 🔄 
🔄 Step 3: Processing patient dates...
[14:49:22] [DOC: 9228885] ℹ️  DOB normalized: 11/24/1951
[14:49:22] [DOC: 9228885] ✅ Patient date processing completed successfully
[14:49:22] ✅    ✅ Date processing completed
[14:49:22] 📊 Processed Patient Data
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:49:22] 🔄 
🔄 Step 4: Extracting order data...
[14:49:24] ℹ️  Order extraction - MRN: '2750591'
[14:49:24] ℹ️  Order extraction - Sex: 'FEMALE'
[14:49:24] ℹ️  Order extraction - Service Line: ''
[14:49:24] ℹ️  Order extraction - Payer Source: ''
[14:49:24] ✅ Order data extraction completed successfully
[14:49:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:49:24] ℹ️  Using MRN from patient data: '2750591' over '2750591'
[14:49:24] ℹ️  Using service line from patient data: 'Skilled Nursing'
[14:49:24] ✅ Patient name cross-validation successful
[14:49:24] ✅    ✅ Data merged successfully
[14:49:26] ✅    ✅ Order data extracted and validated
[14:49:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:49:26] [DOC: 9228885] ✅ Patient found in local cache: Valentina Miguel, ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[14:49:26] ✅    ✅ Existing patient found with ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[14:49:26] 🔄 
🔄 Step 6: Pushing order to API...
[14:49:26] [DOC: 9228885] ℹ️  Pushing order via API for patient ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[14:49:27] [DOC: 9228885] ❌ Order push failed with status 201: {"id":"6c420b6e-d975-4e2b-a717-f0d9a279e2cb","orderWAVId":"ORD20050","orderNo":"1079527, 1079528","orderDate":"04/07/2025","startOfCare":"03/16/2018","episodeStartDate":"03/16/2018","episodeEndDate":"05/14/2018","documentID":"9228885","mrn":"2750591","patientName":"Miguel,Valentina B","sentToPhysicianDate":"04/08/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6ab7401d-5ff1-4b54-9813-ac77ababb99e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:49:27] ❌    ❌ Failed to push order
[14:49:27] 🔄 
🔄 Step 7: Writing to CSV...
[14:49:27] [DOC: 9228885] ℹ️  Calculated age: 73 from DOB: 11/24/1951
[14:49:27] [DOC: 9228885] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:49:27] [DOC: 9228885] ℹ️  Payer Source extracted: ''
[14:49:27] [DOC: 9228885] ℹ️  Diagnosis codes being written:
[14:49:27] [DOC: 9228885] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:49:27] [DOC: 9228885] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:49:27] [DOC: 9228885] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:49:27] [DOC: 9228885] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:49:27] [DOC: 9228885] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:49:27] [DOC: 9228885] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:49:27] [DOC: 9228885] ✅ Patient data written to CSV: Valentina Miguel | Sex: FEMALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2750591
[14:49:27] ✅    ✅ Document 9228885 processed and saved successfully
[14:49:27] 🔄 
🔄 Step 8: Saving API details...
[14:49:27] [DOC: 9228885] ℹ️  API push details saved for document 9228885
[14:49:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228879                         ║
================================================================================
[14:49:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:49:27] ℹ️  Date: 04/08/2025
[14:49:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:49:33] [DOC: 9228879] ✅ Text extracted using pdfplumber (970 chars)
[14:49:33] ✅    ✅ Text extracted using pdfplumber (970 chars)
[14:49:33] 🔄 
🔄 Step 2: Extracting patient data...
[14:49:35] ℹ️  AI extracted raw sex value: 'M'
[14:49:35] ℹ️  AI extracted service line: 'RN'
[14:49:35] ℹ️  AI extracted payer source: ''
[14:49:35] ℹ️  AI extracted diagnoses:
[14:49:35] ℹ️    - Diagnosis 1: ''
[14:49:35] ℹ️    - Diagnosis 2: ''
[14:49:35] ℹ️    - Diagnosis 3: ''
[14:49:35] ℹ️    - Diagnosis 4: ''
[14:49:35] ℹ️    - Diagnosis 5: ''
[14:49:35] ℹ️    - Diagnosis 6: ''
[14:49:35] ℹ️  Final extracted MRN: '2716471'
[14:49:35] ℹ️  Final extracted Sex: 'MALE'
[14:49:35] ℹ️  Final extracted Service Line: 'RN'
[14:49:35] ℹ️  Final extracted Payer Source: ''
[14:49:35] ✅ Patient data extraction completed successfully
[14:49:35] ✅    ✅ Patient data extracted successfully
[14:49:35] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:49:35] ✅    ✅ Patient identified: Thomas McCormack
[14:49:35] ✅    ✅ Patient name validation passed
[14:49:35] 🔄 
🔄 Step 3: Processing patient dates...
[14:49:35] [DOC: 9228879] ℹ️  DOB normalized: 03/17/1944
[14:49:35] [DOC: 9228879] ✅ Patient date processing completed successfully
[14:49:35] ✅    ✅ Date processing completed
[14:49:35] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:49:35] 🔄 
🔄 Step 4: Extracting order data...
[14:49:37] ℹ️  Order extraction - MRN: '2716471'
[14:49:37] ℹ️  Order extraction - Sex: 'MALE'
[14:49:37] ℹ️  Order extraction - Service Line: ''
[14:49:37] ℹ️  Order extraction - Payer Source: ''
[14:49:37] ✅ Order data extraction completed successfully
[14:49:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:49:37] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[14:49:37] ℹ️  Using service line from patient data: 'RN'
[14:49:37] ✅ Patient name cross-validation successful
[14:49:37] ✅    ✅ Data merged successfully
[14:49:39] ⚠️     ❌ Skipping - missing episode start date
[14:49:39] [DOC: 9228879] ℹ️  API push details saved for document 9228879
================================================================================
║                        Processing Document ID: 9228878                         ║
================================================================================
[14:49:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:49:39] ℹ️  Date: 04/08/2025
[14:49:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:49:45] [DOC: 9228878] ✅ Text extracted using pdfplumber (28373 chars)
[14:49:45] ✅    ✅ Text extracted using pdfplumber (28373 chars)
[14:49:45] 🔄 
🔄 Step 2: Extracting patient data...
[14:49:49] ℹ️  AI extracted raw sex value: 'F'
[14:49:49] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:49:49] ℹ️  AI extracted payer source: ''
[14:49:49] ℹ️  AI extracted diagnoses:
[14:49:49] ℹ️    - Diagnosis 1: 'J18.9'
[14:49:49] ℹ️    - Diagnosis 2: 'J44.1'
[14:49:49] ℹ️    - Diagnosis 3: 'J96.11'
[14:49:49] ℹ️    - Diagnosis 4: 'I13.0'
[14:49:49] ℹ️    - Diagnosis 5: 'I50.32'
[14:49:49] ℹ️    - Diagnosis 6: 'E11.22'
[14:49:49] ℹ️  Final extracted MRN: '2607201'
[14:49:49] ℹ️  Final extracted Sex: 'FEMALE'
[14:49:49] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:49:49] ℹ️  Final extracted Payer Source: ''
[14:49:49] ✅ Patient data extraction completed successfully
[14:49:49] ✅    ✅ Patient data extracted successfully
[14:49:49] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J96.11', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.22'}]
[14:49:49] ✅    ✅ Patient identified: Theresa Kamm
[14:49:49] ✅    ✅ Patient name validation passed
[14:49:49] 🔄 
🔄 Step 3: Processing patient dates...
[14:49:49] [DOC: 9228878] ℹ️  DOB normalized: 08/02/1939
[14:49:49] [DOC: 9228878] ℹ️  Episode startOfCare normalized: 03/12/2025
[14:49:49] [DOC: 9228878] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:49:49] [DOC: 9228878] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[14:49:49] [DOC: 9228878] ✅ Patient date processing completed successfully
[14:49:49] ✅    ✅ Date processing completed
[14:49:49] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J96.11', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.22'}]
[14:49:49] 🔄 
🔄 Step 4: Extracting order data...
[14:49:52] ℹ️  Order extraction - MRN: '2607201'
[14:49:52] ℹ️  Order extraction - Sex: 'FEMALE'
[14:49:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:49:52] ℹ️  Order extraction - Payer Source: ''
[14:49:52] ✅ Order data extraction completed successfully
[14:49:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:49:52] ℹ️  Using MRN from patient data: '2607201' over '2607201'
[14:49:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:49:52] ✅ Patient name cross-validation successful
[14:49:52] ✅    ✅ Data merged successfully
[14:49:53] ✅    ✅ Order data extracted and validated
[14:49:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:50:33] [DOC: 9228878] ℹ️  Patient not found in cache or API: Theresa Kamm
[14:50:33] [DOC: 9228878] ℹ️  Patient not found, creating new patient via API...
[14:50:33] [DOC: 9228878] ℹ️  Creating patient via API: Theresa Kamm
[14:50:34] [DOC: 9228878] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:50:34] ❌    ❌ Failed to create patient
[14:50:34] [DOC: 9228878] ℹ️  API push details saved for document 9228878
================================================================================
║                        Processing Document ID: 9228867                         ║
================================================================================
[14:50:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:50:34] ℹ️  Date: 04/08/2025
[14:50:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:50:40] [DOC: 9228867] ✅ Text extracted using pdfplumber (16861 chars)
[14:50:40] ✅    ✅ Text extracted using pdfplumber (16861 chars)
[14:50:40] 🔄 
🔄 Step 2: Extracting patient data...
[14:50:43] ℹ️  AI extracted raw sex value: 'M'
[14:50:43] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:50:43] ℹ️  AI extracted payer source: ''
[14:50:43] ℹ️  AI extracted diagnoses:
[14:50:43] ℹ️    - Diagnosis 1: 'J44.89'
[14:50:43] ℹ️    - Diagnosis 2: 'J45.20'
[14:50:43] ℹ️    - Diagnosis 3: 'R07.9'
[14:50:43] ℹ️    - Diagnosis 4: 'I12.0'
[14:50:43] ℹ️    - Diagnosis 5: 'N18.6'
[14:50:43] ℹ️    - Diagnosis 6: 'D63.1'
[14:50:43] ℹ️  Final extracted MRN: '2571325'
[14:50:43] ℹ️  Final extracted Sex: 'MALE'
[14:50:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:50:43] ℹ️  Final extracted Payer Source: ''
[14:50:43] ✅ Patient data extraction completed successfully
[14:50:43] ✅    ✅ Patient data extracted successfully
[14:50:43] 📊 Patient Response
     └─ patientFName: Rodney
     └─ patientLName: Hill
     └─ dob: 08/12/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2571325
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'J44.89', 'secondDiagnosis': 'J45.20', 'thirdDiagnosis': 'R07.9', 'fourthDiagnosis': 'I12.0', 'fifthDiagnosis': 'N18.6', 'sixthDiagnosis': 'D63.1'}]
[14:50:43] ✅    ✅ Patient identified: Rodney Hill
[14:50:43] ✅    ✅ Patient name validation passed
[14:50:43] 🔄 
🔄 Step 3: Processing patient dates...
[14:50:43] [DOC: 9228867] ℹ️  DOB normalized: 08/12/1960
[14:50:43] [DOC: 9228867] ℹ️  Episode startOfCare normalized: 03/19/2025
[14:50:43] [DOC: 9228867] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:50:43] [DOC: 9228867] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:50:43] [DOC: 9228867] ✅ Patient date processing completed successfully
[14:50:43] ✅    ✅ Date processing completed
[14:50:43] 📊 Processed Patient Data
     └─ patientFName: Rodney
     └─ patientLName: Hill
     └─ dob: 08/12/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2571325
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'J44.89', 'secondDiagnosis': 'J45.20', 'thirdDiagnosis': 'R07.9', 'fourthDiagnosis': 'I12.0', 'fifthDiagnosis': 'N18.6', 'sixthDiagnosis': 'D63.1'}]
[14:50:43] 🔄 
🔄 Step 4: Extracting order data...
[14:50:46] ℹ️  Order extraction - MRN: '2571325'
[14:50:46] ℹ️  Order extraction - Sex: 'MALE'
[14:50:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:50:46] ℹ️  Order extraction - Payer Source: ''
[14:50:46] ✅ Order data extraction completed successfully
[14:50:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:50:46] ℹ️  Using MRN from patient data: '2571325' over '2571325'
[14:50:46] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:50:46] ✅ Patient name cross-validation successful
[14:50:46] ✅    ✅ Data merged successfully
[14:50:47] ✅    ✅ Order data extracted and validated
[14:50:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:50:52] [DOC: 9228867] ℹ️  Patient not found in cache or API: Rodney Hill
[14:50:52] [DOC: 9228867] ℹ️  Patient not found, creating new patient via API...
[14:50:52] [DOC: 9228867] ℹ️  Creating patient via API: Rodney Hill
[14:50:53] [DOC: 9228867] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:50:53] ❌    ❌ Failed to create patient
[14:50:53] [DOC: 9228867] ℹ️  API push details saved for document 9228867
================================================================================
║                        Processing Document ID: 9228861                         ║
================================================================================
[14:50:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:50:53] ℹ️  Date: 04/08/2025
[14:50:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:50:55] [DOC: 9228861] ✅ Text extracted using pdfplumber (1233 chars)
[14:50:55] ✅    ✅ Text extracted using pdfplumber (1233 chars)
[14:50:55] 🔄 
🔄 Step 2: Extracting patient data...
[14:50:58] ℹ️  AI extracted raw sex value: 'M'
[14:50:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:50:58] ℹ️  AI extracted payer source: ''
[14:50:58] ℹ️  AI extracted diagnoses:
[14:50:58] ℹ️    - Diagnosis 1: ''
[14:50:58] ℹ️    - Diagnosis 2: ''
[14:50:58] ℹ️    - Diagnosis 3: ''
[14:50:58] ℹ️    - Diagnosis 4: ''
[14:50:58] ℹ️    - Diagnosis 5: ''
[14:50:58] ℹ️    - Diagnosis 6: ''
[14:50:58] ℹ️  Final extracted MRN: '2312121'
[14:50:58] ℹ️  Final extracted Sex: 'MALE'
[14:50:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:50:58] ℹ️  Final extracted Payer Source: ''
[14:50:58] ✅ Patient data extraction completed successfully
[14:50:58] ✅    ✅ Patient data extracted successfully
[14:50:58] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:50:58] ✅    ✅ Patient identified: Antonio Carvalho
[14:50:58] ✅    ✅ Patient name validation passed
[14:50:58] 🔄 
🔄 Step 3: Processing patient dates...
[14:50:58] [DOC: 9228861] ℹ️  DOB normalized: 07/01/1933
[14:50:58] [DOC: 9228861] ✅ Patient date processing completed successfully
[14:50:58] ✅    ✅ Date processing completed
[14:50:58] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:50:58] 🔄 
🔄 Step 4: Extracting order data...
[14:51:00] ℹ️  Order extraction - MRN: '2312121'
[14:51:00] ℹ️  Order extraction - Sex: 'MALE'
[14:51:00] ℹ️  Order extraction - Service Line: ''
[14:51:00] ℹ️  Order extraction - Payer Source: ''
[14:51:00] ✅ Order data extraction completed successfully
[14:51:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:51:00] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[14:51:00] ℹ️  Using service line from patient data: 'Skilled Nursing'
[14:51:00] ✅ Patient name cross-validation successful
[14:51:00] ✅    ✅ Data merged successfully
[14:51:01] ✅    ✅ Order data extracted and validated
[14:51:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:51:07] [DOC: 9228861] ℹ️  Patient not found in cache or API: Antonio Carvalho
[14:51:07] [DOC: 9228861] ℹ️  Patient not found, creating new patient via API...
[14:51:07] [DOC: 9228861] ℹ️  Creating patient via API: Antonio Carvalho
[14:51:09] [DOC: 9228861] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:51:09] ❌    ❌ Failed to create patient
[14:51:09] [DOC: 9228861] ℹ️  API push details saved for document 9228861
================================================================================
║                        Processing Document ID: 9228859                         ║
================================================================================
[14:51:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:51:09] ℹ️  Date: 04/08/2025
[14:51:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:51:11] [DOC: 9228859] ✅ Text extracted using pdfplumber (1376 chars)
[14:51:11] ✅    ✅ Text extracted using pdfplumber (1376 chars)
[14:51:11] 🔄 
🔄 Step 2: Extracting patient data...
[14:51:14] ℹ️  AI extracted raw sex value: 'F'
[14:51:14] ℹ️  AI extracted service line: 'PT'
[14:51:14] ℹ️  AI extracted payer source: ''
[14:51:14] ℹ️  AI extracted diagnoses:
[14:51:14] ℹ️    - Diagnosis 1: 'None'
[14:51:14] ℹ️    - Diagnosis 2: 'None'
[14:51:14] ℹ️    - Diagnosis 3: 'None'
[14:51:14] ℹ️    - Diagnosis 4: 'None'
[14:51:14] ℹ️    - Diagnosis 5: 'None'
[14:51:14] ℹ️    - Diagnosis 6: 'None'
[14:51:14] ℹ️  Final extracted MRN: '2079984'
[14:51:14] ℹ️  Final extracted Sex: 'FEMALE'
[14:51:14] ℹ️  Final extracted Service Line: 'PT'
[14:51:14] ℹ️  Final extracted Payer Source: ''
[14:51:14] ✅ Patient data extraction completed successfully
[14:51:14] ✅    ✅ Patient data extracted successfully
[14:51:14] 📊 Patient Response
     └─ patientFName: Kayla
     └─ patientLName: Bailey
     └─ dob: 04/27/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2079984
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:51:14] ✅    ✅ Patient identified: Kayla Bailey
[14:51:14] ✅    ✅ Patient name validation passed
[14:51:14] 🔄 
🔄 Step 3: Processing patient dates...
[14:51:14] [DOC: 9228859] ℹ️  DOB normalized: 04/27/1994
[14:51:14] [DOC: 9228859] ✅ Patient date processing completed successfully
[14:51:14] ✅    ✅ Date processing completed
[14:51:14] 📊 Processed Patient Data
     └─ patientFName: Kayla
     └─ patientLName: Bailey
     └─ dob: 04/27/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2079984
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:51:14] 🔄 
🔄 Step 4: Extracting order data...
[14:51:16] ℹ️  Order extraction - MRN: '2079984'
[14:51:16] ℹ️  Order extraction - Sex: 'FEMALE'
[14:51:16] ℹ️  Order extraction - Service Line: ''
[14:51:16] ℹ️  Order extraction - Payer Source: ''
[14:51:16] ✅ Order data extraction completed successfully
[14:51:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:51:16] ℹ️  Using MRN from patient data: '2079984' over '2079984'
[14:51:16] ℹ️  Using service line from patient data: 'PT'
[14:51:16] ✅ Patient name cross-validation successful
[14:51:16] ✅    ✅ Data merged successfully
[14:51:18] ⚠️     ❌ Skipping - missing episode start date
[14:51:18] [DOC: 9228859] ℹ️  API push details saved for document 9228859
================================================================================
║                        Processing Document ID: 9228832                         ║
================================================================================
[14:51:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:51:18] ℹ️  Date: 04/08/2025
[14:51:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:51:19] [DOC: 9228832] ✅ Text extracted using pdfplumber (1025 chars)
[14:51:19] ✅    ✅ Text extracted using pdfplumber (1025 chars)
[14:51:19] 🔄 
🔄 Step 2: Extracting patient data...
[14:51:22] ℹ️  AI extracted raw sex value: 'F'
[14:51:22] ℹ️  AI extracted service line: 'Physical Therapy'
[14:51:22] ℹ️  AI extracted payer source: ''
[14:51:22] ℹ️  AI extracted diagnoses:
[14:51:22] ℹ️    - Diagnosis 1: ''
[14:51:22] ℹ️    - Diagnosis 2: ''
[14:51:22] ℹ️    - Diagnosis 3: ''
[14:51:22] ℹ️    - Diagnosis 4: ''
[14:51:22] ℹ️    - Diagnosis 5: ''
[14:51:22] ℹ️    - Diagnosis 6: ''
[14:51:22] ℹ️  Final extracted MRN: '2188842'
[14:51:22] ℹ️  Final extracted Sex: 'FEMALE'
[14:51:22] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:51:22] ℹ️  Final extracted Payer Source: ''
[14:51:22] ✅ Patient data extraction completed successfully
[14:51:22] ✅    ✅ Patient data extracted successfully
[14:51:22] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:51:22] ✅    ✅ Patient identified: Nancy Anderson
[14:51:22] ✅    ✅ Patient name validation passed
[14:51:22] 🔄 
🔄 Step 3: Processing patient dates...
[14:51:22] [DOC: 9228832] ℹ️  DOB normalized: 07/12/1954
[14:51:22] [DOC: 9228832] ✅ Patient date processing completed successfully
[14:51:22] ✅    ✅ Date processing completed
[14:51:22] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:51:22] 🔄 
🔄 Step 4: Extracting order data...
[14:51:24] ℹ️  Order extraction - MRN: '2188842'
[14:51:24] ℹ️  Order extraction - Sex: 'FEMALE'
[14:51:24] ℹ️  Order extraction - Service Line: ''
[14:51:24] ℹ️  Order extraction - Payer Source: ''
[14:51:24] ✅ Order data extraction completed successfully
[14:51:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:51:24] ℹ️  Using MRN from patient data: '2188842' over '2188842'
[14:51:24] ℹ️  Using service line from patient data: 'Physical Therapy'
[14:51:24] ✅ Patient name cross-validation successful
[14:51:24] ✅    ✅ Data merged successfully
[14:51:25] ⚠️     ❌ Skipping - missing episode start date
[14:51:25] [DOC: 9228832] ℹ️  API push details saved for document 9228832
================================================================================
║                        Processing Document ID: 9228791                         ║
================================================================================
[14:51:25] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:51:25] ℹ️  Date: 04/08/2025
[14:51:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:51:30] [DOC: 9228791] ✅ Text extracted using pdfplumber (1281 chars)
[14:51:30] ✅    ✅ Text extracted using pdfplumber (1281 chars)
[14:51:30] 🔄 
🔄 Step 2: Extracting patient data...
[14:51:33] ℹ️  AI extracted raw sex value: 'M'
[14:51:33] ℹ️  AI extracted service line: 'PT'
[14:51:33] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:51:33] ℹ️  AI extracted diagnoses:
[14:51:33] ℹ️    - Diagnosis 1: ''
[14:51:33] ℹ️    - Diagnosis 2: ''
[14:51:33] ℹ️    - Diagnosis 3: ''
[14:51:33] ℹ️    - Diagnosis 4: ''
[14:51:33] ℹ️    - Diagnosis 5: ''
[14:51:33] ℹ️    - Diagnosis 6: ''
[14:51:33] ℹ️  Final extracted MRN: '532005'
[14:51:33] ℹ️  Final extracted Sex: 'MALE'
[14:51:33] ℹ️  Final extracted Service Line: 'PT'
[14:51:33] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:51:33] ✅ Patient data extraction completed successfully
[14:51:33] ✅    ✅ Patient data extracted successfully
[14:51:33] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Nelson
     └─ dob: 08/12/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 532005
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:51:33] ✅    ✅ Patient identified: James Nelson
[14:51:33] ✅    ✅ Patient name validation passed
[14:51:33] 🔄 
🔄 Step 3: Processing patient dates...
[14:51:33] [DOC: 9228791] ℹ️  DOB normalized: 08/12/1966
[14:51:33] [DOC: 9228791] ℹ️  Episode startOfCare normalized: 02/26/2025
[14:51:33] [DOC: 9228791] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[14:51:33] [DOC: 9228791] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[14:51:33] [DOC: 9228791] ✅ Patient date processing completed successfully
[14:51:33] ✅    ✅ Date processing completed
[14:51:33] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Nelson
     └─ dob: 08/12/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 532005
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '02/26/2025', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:51:33] 🔄 
🔄 Step 4: Extracting order data...
[14:51:35] ℹ️  Order extraction - MRN: '532005'
[14:51:35] ℹ️  Order extraction - Sex: 'MALE'
[14:51:35] ℹ️  Order extraction - Service Line: 'PT'
[14:51:35] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:51:35] ✅ Order data extraction completed successfully
[14:51:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:51:35] ℹ️  Using MRN from patient data: '532005' over '532005'
[14:51:35] ℹ️  Service line consistent in both sources: 'PT'
[14:51:35] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:51:35] ✅ Patient name cross-validation successful
[14:51:35] ✅    ✅ Data merged successfully
[14:51:37] ✅    ✅ Order data extracted and validated
[14:51:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:51:51] [DOC: 9228791] ℹ️  Patient not found in cache or API: James Nelson
[14:51:51] [DOC: 9228791] ℹ️  Patient not found, creating new patient via API...
[14:51:51] [DOC: 9228791] ℹ️  Creating patient via API: James Nelson
[14:51:52] [DOC: 9228791] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:51:52] ❌    ❌ Failed to create patient
[14:51:52] [DOC: 9228791] ℹ️  API push details saved for document 9228791
================================================================================
║                        Processing Document ID: 9228753                         ║
================================================================================
[14:51:52] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:51:52] ℹ️  Date: 04/08/2025
[14:51:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:51:54] [DOC: 9228753] ✅ Text extracted using pdfplumber (1734 chars)
[14:51:54] ✅    ✅ Text extracted using pdfplumber (1734 chars)
[14:51:54] 🔄 
🔄 Step 2: Extracting patient data...
[14:51:57] ℹ️  AI extracted raw sex value: 'F'
[14:51:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:51:57] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance-One Care'
[14:51:57] ℹ️  AI extracted diagnoses:
[14:51:57] ℹ️    - Diagnosis 1: 'None'
[14:51:57] ℹ️    - Diagnosis 2: 'None'
[14:51:57] ℹ️    - Diagnosis 3: 'None'
[14:51:57] ℹ️    - Diagnosis 4: 'None'
[14:51:57] ℹ️    - Diagnosis 5: 'None'
[14:51:57] ℹ️    - Diagnosis 6: 'None'
[14:51:57] ℹ️  Final extracted MRN: '523'
[14:51:57] ℹ️  Final extracted Sex: 'FEMALE'
[14:51:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:51:57] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance-One Care'
[14:51:57] ✅ Patient data extraction completed successfully
[14:51:57] ✅    ✅ Patient data extracted successfully
[14:51:57] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Gomes
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 523
     └─ billingProvider: None
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Commonwealth Care Alliance-One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2010', 'startOfEpisode': None, 'endOfEpisode': '06/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:51:57] ✅    ✅ Patient identified: Dorothy Gomes
[14:51:57] ✅    ✅ Patient name validation passed
[14:51:57] 🔄 
🔄 Step 3: Processing patient dates...
[14:51:57] [DOC: 9228753] ℹ️  DOB normalized: 02/15/1959
[14:51:57] [DOC: 9228753] ℹ️  Episode startOfCare normalized: 10/19/2010
[14:51:57] [DOC: 9228753] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[14:51:57] [DOC: 9228753] ✅ Patient date processing completed successfully
[14:51:57] ✅    ✅ Date processing completed
[14:51:57] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Gomes
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 523
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Commonwealth Care Alliance-One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2010', 'endOfEpisode': '06/01/2025'}]
[14:51:57] 🔄 
🔄 Step 4: Extracting order data...
[14:52:00] ℹ️  Order extraction - MRN: '523'
[14:52:00] ℹ️  Order extraction - Sex: 'FEMALE'
[14:52:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:52:00] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance-One Care'
[14:52:00] ✅ Order data extraction completed successfully
[14:52:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:52:00] ℹ️  Using MRN from patient data: '523' over '523'
[14:52:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:52:00] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance-One Care'
[14:52:00] ✅ Patient name cross-validation successful
[14:52:00] ✅    ✅ Data merged successfully
[14:52:01] ✅    ✅ Order data extracted and validated
[14:52:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:52:01] [DOC: 9228753] ✅ Patient found in local cache: Dorothy Gomes, ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[14:52:01] ✅    ✅ Existing patient found with ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[14:52:01] 🔄 
🔄 Step 6: Pushing order to API...
[14:52:01] [DOC: 9228753] ℹ️  Pushing order via API for patient ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[14:52:02] [DOC: 9228753] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:52:02] ❌    ❌ Failed to push order
[14:52:02] 🔄 
🔄 Step 7: Writing to CSV...
[14:52:02] [DOC: 9228753] ℹ️  Calculated age: 66 from DOB: 02/15/1959
[14:52:02] [DOC: 9228753] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:52:02] [DOC: 9228753] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance-One Care'
[14:52:02] [DOC: 9228753] ℹ️  Diagnosis codes being written:
[14:52:02] [DOC: 9228753] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:52:02] [DOC: 9228753] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:52:02] [DOC: 9228753] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:52:02] [DOC: 9228753] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:52:02] [DOC: 9228753] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:52:02] [DOC: 9228753] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:52:02] [DOC: 9228753] ✅ Patient data written to CSV: Dorothy Gomes | Sex: FEMALE | Age: 66 | Service: Skilled Nursing | Payer: Commonwealth Care Alliance-One Care | MRN: 523
[14:52:02] ✅    ✅ Document 9228753 processed and saved successfully
[14:52:02] 🔄 
🔄 Step 8: Saving API details...
[14:52:02] [DOC: 9228753] ℹ️  API push details saved for document 9228753
[14:52:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228749                         ║
================================================================================
[14:52:02] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:52:02] ℹ️  Date: 04/08/2025
[14:52:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:52:04] [DOC: 9228749] ✅ Text extracted using pdfplumber (1371 chars)
[14:52:04] ✅    ✅ Text extracted using pdfplumber (1371 chars)
[14:52:04] 🔄 
🔄 Step 2: Extracting patient data...
[14:52:07] ℹ️  AI extracted raw sex value: 'F'
[14:52:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:52:07] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:52:07] ℹ️  AI extracted diagnoses:
[14:52:07] ℹ️    - Diagnosis 1: ''
[14:52:07] ℹ️    - Diagnosis 2: ''
[14:52:07] ℹ️    - Diagnosis 3: ''
[14:52:07] ℹ️    - Diagnosis 4: ''
[14:52:07] ℹ️    - Diagnosis 5: ''
[14:52:07] ℹ️    - Diagnosis 6: ''
[14:52:07] ℹ️  Final extracted MRN: '283005'
[14:52:07] ℹ️  Final extracted Sex: 'FEMALE'
[14:52:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:52:07] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:52:07] ✅ Patient data extraction completed successfully
[14:52:07] ✅    ✅ Patient data extracted successfully
[14:52:07] 📊 Patient Response
     └─ patientFName: Fatima
     └─ patientLName: Correia
     └─ dob: 06/30/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 283005
     └─ billingProvider: Gloriane Afonso Fede, MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:52:07] ✅    ✅ Patient identified: Fatima Correia
[14:52:07] ✅    ✅ Patient name validation passed
[14:52:07] 🔄 
🔄 Step 3: Processing patient dates...
[14:52:07] [DOC: 9228749] ℹ️  DOB normalized: 06/30/1942
[14:52:07] [DOC: 9228749] ℹ️  Episode startOfCare normalized: 05/29/2024
[14:52:07] [DOC: 9228749] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:52:07] [DOC: 9228749] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[14:52:07] [DOC: 9228749] ✅ Patient date processing completed successfully
[14:52:07] ✅    ✅ Date processing completed
[14:52:07] 📊 Processed Patient Data
     └─ patientFName: Fatima
     └─ patientLName: Correia
     └─ dob: 06/30/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 283005
     └─ billingProvider: Gloriane Afonso Fede, MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:52:07] 🔄 
🔄 Step 4: Extracting order data...
[14:52:10] ℹ️  Order extraction - MRN: '283005'
[14:52:10] ℹ️  Order extraction - Sex: 'FEMALE'
[14:52:10] ℹ️  Order extraction - Service Line: 'HHA'
[14:52:10] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:52:10] ✅ Order data extraction completed successfully
[14:52:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:52:10] ℹ️  Using MRN from patient data: '283005' over '283005'
[14:52:10] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='HHA' = 'HHA, Skilled Nursing'
[14:52:10] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:52:10] ✅ Patient name cross-validation successful
[14:52:10] ✅    ✅ Data merged successfully
[14:52:11] ✅    ✅ Order data extracted and validated
[14:52:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:52:17] [DOC: 9228749] ✅ Patient exists in API: Fatima Correia, ID: 3cf90aad-62c0-4b52-a46f-2c326a3f6af9
[14:52:17] ✅    ✅ Existing patient found with ID: 3cf90aad-62c0-4b52-a46f-2c326a3f6af9
[14:52:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:52:17] [DOC: 9228749] ℹ️  Pushing order via API for patient ID: 3cf90aad-62c0-4b52-a46f-2c326a3f6af9
[14:52:18] [DOC: 9228749] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:52:18] ❌    ❌ Failed to push order
[14:52:18] 🔄 
🔄 Step 7: Writing to CSV...
[14:52:18] [DOC: 9228749] ℹ️  Calculated age: 82 from DOB: 06/30/1942
[14:52:18] [DOC: 9228749] ℹ️  Service Line extracted: 'HHA, Skilled Nursing'
[14:52:18] [DOC: 9228749] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:52:18] [DOC: 9228749] ℹ️  Diagnosis codes being written:
[14:52:18] [DOC: 9228749] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:52:18] [DOC: 9228749] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:52:18] [DOC: 9228749] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:52:18] [DOC: 9228749] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:52:18] [DOC: 9228749] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:52:18] [DOC: 9228749] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:52:18] [DOC: 9228749] ✅ Patient data written to CSV: Fatima Correia | Sex: FEMALE | Age: 82 | Service: HHA, Skilled Nursing | Payer: Senior Whole Health | MRN: 283005
[14:52:18] ✅    ✅ Document 9228749 processed and saved successfully
[14:52:18] 🔄 
🔄 Step 8: Saving API details...
[14:52:18] [DOC: 9228749] ℹ️  API push details saved for document 9228749
[14:52:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228741                         ║
================================================================================
[14:52:18] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:52:18] ℹ️  Date: 04/08/2025
[14:52:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:52:20] [DOC: 9228741] ✅ Text extracted using pdfplumber (1378 chars)
[14:52:20] ✅    ✅ Text extracted using pdfplumber (1378 chars)
[14:52:20] 🔄 
🔄 Step 2: Extracting patient data...
[14:52:23] ℹ️  AI extracted raw sex value: 'M'
[14:52:23] ℹ️  AI extracted service line: 'RN'
[14:52:23] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:52:23] ℹ️  AI extracted diagnoses:
[14:52:23] ℹ️    - Diagnosis 1: 'None'
[14:52:23] ℹ️    - Diagnosis 2: 'None'
[14:52:23] ℹ️    - Diagnosis 3: 'None'
[14:52:23] ℹ️    - Diagnosis 4: 'None'
[14:52:23] ℹ️    - Diagnosis 5: 'None'
[14:52:23] ℹ️    - Diagnosis 6: 'None'
[14:52:23] ℹ️  Final extracted MRN: '1859'
[14:52:23] ℹ️  Final extracted Sex: 'MALE'
[14:52:23] ℹ️  Final extracted Service Line: 'RN'
[14:52:23] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:52:23] ✅ Patient data extraction completed successfully
[14:52:23] ✅    ✅ Patient data extracted successfully
[14:52:23] 📊 Patient Response
     └─ patientFName: Santos
     └─ patientLName: Serrano
     └─ dob: 09/12/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 1859
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/11/2015', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:52:23] ✅    ✅ Patient identified: Santos Serrano
[14:52:23] ✅    ✅ Patient name validation passed
[14:52:23] 🔄 
🔄 Step 3: Processing patient dates...
[14:52:23] [DOC: 9228741] ℹ️  DOB normalized: 09/12/1950
[14:52:23] [DOC: 9228741] ℹ️  Episode startOfCare normalized: 03/11/2015
[14:52:23] [DOC: 9228741] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[14:52:23] [DOC: 9228741] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[14:52:23] [DOC: 9228741] ✅ Patient date processing completed successfully
[14:52:23] ✅    ✅ Date processing completed
[14:52:23] 📊 Processed Patient Data
     └─ patientFName: Santos
     └─ patientLName: Serrano
     └─ dob: 09/12/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 1859
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/11/2015', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025'}]
[14:52:23] 🔄 
🔄 Step 4: Extracting order data...
[14:52:26] ℹ️  Order extraction - MRN: '1859'
[14:52:26] ℹ️  Order extraction - Sex: 'MALE'
[14:52:26] ℹ️  Order extraction - Service Line: ''
[14:52:26] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:52:26] ✅ Order data extraction completed successfully
[14:52:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:52:26] ℹ️  Using MRN from patient data: '1859' over '1859'
[14:52:26] ℹ️  Using service line from patient data: 'RN'
[14:52:26] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:52:26] ✅ Patient name cross-validation successful
[14:52:26] ✅    ✅ Data merged successfully
[14:52:27] ✅    ✅ Order data extracted and validated
[14:52:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:52:27] [DOC: 9228741] ✅ Patient found in local cache: Santos Serrano, ID: 61360068-b28b-42ce-bb3a-37a13f90cd0b
[14:52:27] ✅    ✅ Existing patient found with ID: 61360068-b28b-42ce-bb3a-37a13f90cd0b
[14:52:27] 🔄 
🔄 Step 6: Pushing order to API...
[14:52:27] [DOC: 9228741] ℹ️  Pushing order via API for patient ID: 61360068-b28b-42ce-bb3a-37a13f90cd0b
[14:52:28] [DOC: 9228741] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14394"}
[14:52:28] ❌    ❌ Failed to push order
[14:52:28] 🔄 
🔄 Step 7: Writing to CSV...
[14:52:28] [DOC: 9228741] ℹ️  Calculated age: 74 from DOB: 09/12/1950
[14:52:28] [DOC: 9228741] ℹ️  Service Line extracted: 'RN'
[14:52:28] [DOC: 9228741] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:52:28] [DOC: 9228741] ℹ️  Diagnosis codes being written:
[14:52:28] [DOC: 9228741] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:52:28] [DOC: 9228741] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:52:28] [DOC: 9228741] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:52:28] [DOC: 9228741] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:52:28] [DOC: 9228741] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:52:28] [DOC: 9228741] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:52:28] [DOC: 9228741] ✅ Patient data written to CSV: Santos Serrano | Sex: MALE | Age: 74 | Service: RN | Payer: Senior Whole Health | MRN: 1859
[14:52:28] ✅    ✅ Document 9228741 processed and saved successfully
[14:52:28] 🔄 
🔄 Step 8: Saving API details...
[14:52:28] [DOC: 9228741] ℹ️  API push details saved for document 9228741
[14:52:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228563                         ║
================================================================================
[14:52:28] ℹ️  Agency: Beacon Hospice Care, an Amedisys Company (4420) Fall River
[14:52:28] ℹ️  Date: 04/08/2025
[14:52:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:52:30] [DOC: 9228563] ❌ Critical failure in get_pdf_text: Invalid response format
[14:52:30] ❌ Failed to extract text for Doc ID 9228563
[14:52:30] [DOC: 9228563] ℹ️  API push details saved for document 9228563
================================================================================
║                        Processing Document ID: 9228565                         ║
================================================================================
[14:52:30] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:52:30] ℹ️  Date: 04/08/2025
[14:52:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:52:32] [DOC: 9228565] ✅ Text extracted using pdfplumber (1710 chars)
[14:52:32] ✅    ✅ Text extracted using pdfplumber (1710 chars)
[14:52:32] 🔄 
🔄 Step 2: Extracting patient data...
[14:52:35] ℹ️  AI extracted raw sex value: 'M'
[14:52:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:52:35] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:52:35] ℹ️  AI extracted diagnoses:
[14:52:35] ℹ️    - Diagnosis 1: 'None'
[14:52:35] ℹ️    - Diagnosis 2: 'None'
[14:52:35] ℹ️    - Diagnosis 3: 'None'
[14:52:35] ℹ️    - Diagnosis 4: 'None'
[14:52:35] ℹ️    - Diagnosis 5: 'None'
[14:52:35] ℹ️    - Diagnosis 6: 'None'
[14:52:35] ℹ️  Final extracted MRN: '385'
[14:52:35] ℹ️  Final extracted Sex: 'MALE'
[14:52:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:52:35] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:52:35] ✅ Patient data extraction completed successfully
[14:52:35] ✅    ✅ Patient data extracted successfully
[14:52:35] 📊 Patient Response
     └─ patientFName: Peter
     └─ patientLName: Martens
     └─ dob: 09/17/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 385
     └─ billingProvider: None
     └─ npi: 1922093210
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/04/2010', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:52:35] ✅    ✅ Patient identified: Peter Martens
[14:52:35] ✅    ✅ Patient name validation passed
[14:52:35] 🔄 
🔄 Step 3: Processing patient dates...
[14:52:35] [DOC: 9228565] ℹ️  DOB normalized: 09/17/1957
[14:52:35] [DOC: 9228565] ℹ️  Episode startOfCare normalized: 08/04/2010
[14:52:35] [DOC: 9228565] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[14:52:35] [DOC: 9228565] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[14:52:35] [DOC: 9228565] ✅ Patient date processing completed successfully
[14:52:35] ✅    ✅ Date processing completed
[14:52:35] 📊 Processed Patient Data
     └─ patientFName: Peter
     └─ patientLName: Martens
     └─ dob: 09/17/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 385
     └─ npi: 1922093210
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/04/2010', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025'}]
[14:52:35] 🔄 
🔄 Step 4: Extracting order data...
[14:52:38] ℹ️  Order extraction - MRN: '385'
[14:52:38] ℹ️  Order extraction - Sex: 'MALE'
[14:52:38] ℹ️  Order extraction - Service Line: 'HHA'
[14:52:38] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:52:38] ✅ Order data extraction completed successfully
[14:52:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:52:38] ℹ️  Using MRN from patient data: '385' over '385'
[14:52:38] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='HHA' = 'HHA, Skilled Nursing'
[14:52:38] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:52:38] ✅ Patient name cross-validation successful
[14:52:38] ✅    ✅ Data merged successfully
[14:52:39] ✅    ✅ Order data extracted and validated
[14:52:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:52:39] [DOC: 9228565] ✅ Patient found in local cache: Peter Martens, ID: 906c0aeb-755d-46a4-860b-b47661a8ff8f
[14:52:39] ✅    ✅ Existing patient found with ID: 906c0aeb-755d-46a4-860b-b47661a8ff8f
[14:52:39] 🔄 
🔄 Step 6: Pushing order to API...
[14:52:39] [DOC: 9228565] ℹ️  Pushing order via API for patient ID: 906c0aeb-755d-46a4-860b-b47661a8ff8f
[14:52:40] [DOC: 9228565] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:52:40] ❌    ❌ Failed to push order
[14:52:40] 🔄 
🔄 Step 7: Writing to CSV...
[14:52:40] [DOC: 9228565] ℹ️  Calculated age: 67 from DOB: 09/17/1957
[14:52:40] [DOC: 9228565] ℹ️  Service Line extracted: 'HHA, Skilled Nursing'
[14:52:40] [DOC: 9228565] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:52:40] [DOC: 9228565] ℹ️  Diagnosis codes being written:
[14:52:40] [DOC: 9228565] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:52:40] [DOC: 9228565] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:52:40] [DOC: 9228565] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:52:40] [DOC: 9228565] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:52:40] [DOC: 9228565] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:52:40] [DOC: 9228565] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:52:40] [DOC: 9228565] ✅ Patient data written to CSV: Peter Martens | Sex: MALE | Age: 67 | Service: HHA, Skilled Nursing | Payer: Medicaid/MA | MRN: 385
[14:52:40] ✅    ✅ Document 9228565 processed and saved successfully
[14:52:40] 🔄 
🔄 Step 8: Saving API details...
[14:52:40] [DOC: 9228565] ℹ️  API push details saved for document 9228565
[14:52:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228521                         ║
================================================================================
[14:52:40] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:52:40] ℹ️  Date: 04/08/2025
[14:52:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:52:42] [DOC: 9228521] ✅ Text extracted using pdfplumber (1693 chars)
[14:52:42] ✅    ✅ Text extracted using pdfplumber (1693 chars)
[14:52:42] 🔄 
🔄 Step 2: Extracting patient data...
[14:52:45] ℹ️  AI extracted raw sex value: 'F'
[14:52:45] ℹ️  AI extracted service line: 'RN'
[14:52:45] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:52:45] ℹ️  AI extracted diagnoses:
[14:52:45] ℹ️    - Diagnosis 1: ''
[14:52:45] ℹ️    - Diagnosis 2: ''
[14:52:45] ℹ️    - Diagnosis 3: ''
[14:52:45] ℹ️    - Diagnosis 4: ''
[14:52:45] ℹ️    - Diagnosis 5: ''
[14:52:45] ℹ️    - Diagnosis 6: ''
[14:52:45] ℹ️  Final extracted MRN: '76003'
[14:52:45] ℹ️  Final extracted Sex: 'FEMALE'
[14:52:45] ℹ️  Final extracted Service Line: 'RN'
[14:52:45] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:52:45] ✅ Patient data extraction completed successfully
[14:52:45] ✅    ✅ Patient data extracted successfully
[14:52:45] 📊 Patient Response
     └─ patientFName: Aquilina
     └─ patientLName: Gili
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:52:45] ✅    ✅ Patient identified: Aquilina Gili
[14:52:45] ✅    ✅ Patient name validation passed
[14:52:45] 🔄 
🔄 Step 3: Processing patient dates...
[14:52:45] [DOC: 9228521] ℹ️  DOB normalized: 06/13/1934
[14:52:45] [DOC: 9228521] ℹ️  Episode startOfCare normalized: 08/07/2023
[14:52:45] [DOC: 9228521] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[14:52:45] [DOC: 9228521] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[14:52:45] [DOC: 9228521] ✅ Patient date processing completed successfully
[14:52:45] ✅    ✅ Date processing completed
[14:52:45] 📊 Processed Patient Data
     └─ patientFName: Aquilina
     └─ patientLName: Gili
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:52:45] 🔄 
🔄 Step 4: Extracting order data...
[14:52:48] ℹ️  Order extraction - MRN: '76003'
[14:52:48] ℹ️  Order extraction - Sex: 'FEMALE'
[14:52:48] ℹ️  Order extraction - Service Line: 'ENDOCRINE'
[14:52:48] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:52:48] ✅ Order data extraction completed successfully
[14:52:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:52:48] ℹ️  Using MRN from patient data: '76003' over '76003'
[14:52:48] ℹ️  Combined service lines: Patient='RN' + Order='ENDOCRINE' = 'ENDOCRINE, RN'
[14:52:48] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:52:48] ✅ Patient name cross-validation successful
[14:52:48] ✅    ✅ Data merged successfully
[14:52:51] ✅    ✅ Order data extracted and validated
[14:52:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:00] [DOC: 9228521] ✅ Patient exists in API: Aquilina Gili, ID: bd5013e4-2a19-4308-920d-f340e388a93d
[14:53:00] ✅    ✅ Existing patient found with ID: bd5013e4-2a19-4308-920d-f340e388a93d
[14:53:00] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:00] [DOC: 9228521] ℹ️  Pushing order via API for patient ID: bd5013e4-2a19-4308-920d-f340e388a93d
[14:53:01] [DOC: 9228521] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:53:01] ❌    ❌ Failed to push order
[14:53:01] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:01] [DOC: 9228521] ℹ️  Calculated age: 90 from DOB: 06/13/1934
[14:53:01] [DOC: 9228521] ℹ️  Service Line extracted: 'ENDOCRINE, RN'
[14:53:01] [DOC: 9228521] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:53:01] [DOC: 9228521] ℹ️  Diagnosis codes being written:
[14:53:01] [DOC: 9228521] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:01] [DOC: 9228521] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:01] [DOC: 9228521] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:01] [DOC: 9228521] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:01] [DOC: 9228521] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:01] [DOC: 9228521] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:01] [DOC: 9228521] ✅ Patient data written to CSV: Aquilina Gili | Sex: FEMALE | Age: 90 | Service: ENDOCRINE, RN | Payer: Senior Whole Health | MRN: 76003
[14:53:01] ✅    ✅ Document 9228521 processed and saved successfully
[14:53:01] 🔄 
🔄 Step 8: Saving API details...
[14:53:01] [DOC: 9228521] ℹ️  API push details saved for document 9228521
[14:53:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228472                         ║
================================================================================
[14:53:01] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:53:01] ℹ️  Date: 04/08/2025
[14:53:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:03] [DOC: 9228472] ✅ Text extracted using pdfplumber (1340 chars)
[14:53:03] ✅    ✅ Text extracted using pdfplumber (1340 chars)
[14:53:03] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:06] ℹ️  AI extracted raw sex value: 'M'
[14:53:06] ℹ️  AI extracted service line: 'HHA'
[14:53:06] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:53:06] ℹ️  AI extracted diagnoses:
[14:53:06] ℹ️    - Diagnosis 1: 'None'
[14:53:06] ℹ️    - Diagnosis 2: 'None'
[14:53:06] ℹ️    - Diagnosis 3: 'None'
[14:53:06] ℹ️    - Diagnosis 4: 'None'
[14:53:06] ℹ️    - Diagnosis 5: 'None'
[14:53:06] ℹ️    - Diagnosis 6: 'None'
[14:53:06] ℹ️  Final extracted MRN: '114004'
[14:53:06] ℹ️  Final extracted Sex: 'MALE'
[14:53:06] ℹ️  Final extracted Service Line: 'HHA'
[14:53:06] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:53:06] ✅ Patient data extraction completed successfully
[14:53:06] ✅    ✅ Patient data extracted successfully
[14:53:06] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:53:06] ✅    ✅ Patient identified: Donald Brown
[14:53:06] ✅    ✅ Patient name validation passed
[14:53:06] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:06] [DOC: 9228472] ℹ️  DOB normalized: 06/18/1949
[14:53:06] [DOC: 9228472] ℹ️  Episode startOfCare normalized: 12/01/2018
[14:53:06] [DOC: 9228472] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[14:53:06] [DOC: 9228472] ✅ Patient date processing completed successfully
[14:53:06] ✅    ✅ Date processing completed
[14:53:06] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'endOfEpisode': '04/27/2025'}]
[14:53:06] 🔄 
🔄 Step 4: Extracting order data...
[14:53:08] ℹ️  Order extraction - MRN: '114004'
[14:53:08] ℹ️  Order extraction - Sex: 'MALE'
[14:53:08] ℹ️  Order extraction - Service Line: 'HHA'
[14:53:08] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:53:08] ✅ Order data extraction completed successfully
[14:53:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:08] ℹ️  Using MRN from patient data: '114004' over '114004'
[14:53:08] ℹ️  Service line consistent in both sources: 'HHA'
[14:53:08] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:53:08] ✅ Patient name cross-validation successful
[14:53:08] ✅    ✅ Data merged successfully
[14:53:09] ✅    ✅ Order data extracted and validated
[14:53:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:09] [DOC: 9228472] ✅ Patient found in local cache: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[14:53:09] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[14:53:09] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:09] [DOC: 9228472] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[14:53:11] [DOC: 9228472] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:53:11] ❌    ❌ Failed to push order
[14:53:11] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:11] [DOC: 9228472] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[14:53:11] [DOC: 9228472] ℹ️  Service Line extracted: 'HHA'
[14:53:11] [DOC: 9228472] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:53:11] [DOC: 9228472] ℹ️  Diagnosis codes being written:
[14:53:11] [DOC: 9228472] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:11] [DOC: 9228472] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:11] [DOC: 9228472] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:11] [DOC: 9228472] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:11] [DOC: 9228472] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:11] [DOC: 9228472] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:11] [DOC: 9228472] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: HHA | Payer: Senior Whole Health | MRN: 114004
[14:53:11] ✅    ✅ Document 9228472 processed and saved successfully
[14:53:11] 🔄 
🔄 Step 8: Saving API details...
[14:53:11] [DOC: 9228472] ℹ️  API push details saved for document 9228472
[14:53:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228387                         ║
================================================================================
[14:53:11] ℹ️  Agency: Beacon Hospice Care, an Amedisys Company (4420) Fall River
[14:53:11] ℹ️  Date: 04/08/2025
[14:53:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:12] [DOC: 9228387] ❌ Critical failure in get_pdf_text: Invalid response format
[14:53:12] ❌ Failed to extract text for Doc ID 9228387
[14:53:12] [DOC: 9228387] ℹ️  API push details saved for document 9228387
================================================================================
║                        Processing Document ID: 9228332                         ║
================================================================================
[14:53:12] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:53:12] ℹ️  Date: 04/08/2025
[14:53:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:15] [DOC: 9228332] ✅ Text extracted using pdfplumber (1312 chars)
[14:53:15] ✅    ✅ Text extracted using pdfplumber (1312 chars)
[14:53:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:18] ℹ️  AI extracted raw sex value: 'M'
[14:53:18] ℹ️  AI extracted service line: 'HHA'
[14:53:18] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:53:18] ℹ️  AI extracted diagnoses:
[14:53:18] ℹ️    - Diagnosis 1: ''
[14:53:18] ℹ️    - Diagnosis 2: ''
[14:53:18] ℹ️    - Diagnosis 3: ''
[14:53:18] ℹ️    - Diagnosis 4: ''
[14:53:18] ℹ️    - Diagnosis 5: ''
[14:53:18] ℹ️    - Diagnosis 6: ''
[14:53:18] ℹ️  Final extracted MRN: '385'
[14:53:18] ℹ️  Final extracted Sex: 'MALE'
[14:53:18] ℹ️  Final extracted Service Line: 'HHA'
[14:53:18] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:53:18] ✅ Patient data extraction completed successfully
[14:53:18] ✅    ✅ Patient data extracted successfully
[14:53:18] 📊 Patient Response
     └─ patientFName: Peter
     └─ patientLName: Martens
     └─ dob: 09/17/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 385
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/04/2010', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:18] ✅    ✅ Patient identified: Peter Martens
[14:53:18] ✅    ✅ Patient name validation passed
[14:53:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:18] [DOC: 9228332] ℹ️  DOB normalized: 09/17/1957
[14:53:18] [DOC: 9228332] ℹ️  Episode startOfCare normalized: 08/04/2010
[14:53:18] [DOC: 9228332] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[14:53:18] [DOC: 9228332] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[14:53:18] [DOC: 9228332] ✅ Patient date processing completed successfully
[14:53:18] ✅    ✅ Date processing completed
[14:53:18] 📊 Processed Patient Data
     └─ patientFName: Peter
     └─ patientLName: Martens
     └─ dob: 09/17/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 385
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/04/2010', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:18] 🔄 
🔄 Step 4: Extracting order data...
[14:53:20] ℹ️  Order extraction - MRN: '385'
[14:53:20] ℹ️  Order extraction - Sex: 'MALE'
[14:53:20] ℹ️  Order extraction - Service Line: 'HHA'
[14:53:20] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:53:20] ✅ Order data extraction completed successfully
[14:53:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:20] ℹ️  Using MRN from patient data: '385' over '385'
[14:53:20] ℹ️  Service line consistent in both sources: 'HHA'
[14:53:20] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:53:20] ✅ Patient name cross-validation successful
[14:53:20] ✅    ✅ Data merged successfully
[14:53:22] ✅    ✅ Order data extracted and validated
[14:53:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:22] [DOC: 9228332] ✅ Patient found in local cache: Peter Martens, ID: 906c0aeb-755d-46a4-860b-b47661a8ff8f
[14:53:22] ✅    ✅ Existing patient found with ID: 906c0aeb-755d-46a4-860b-b47661a8ff8f
[14:53:22] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:22] [DOC: 9228332] ℹ️  Pushing order via API for patient ID: 906c0aeb-755d-46a4-860b-b47661a8ff8f
[14:53:23] [DOC: 9228332] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:53:23] ❌    ❌ Failed to push order
[14:53:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:23] [DOC: 9228332] ℹ️  Calculated age: 67 from DOB: 09/17/1957
[14:53:23] [DOC: 9228332] ℹ️  Service Line extracted: 'HHA'
[14:53:23] [DOC: 9228332] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:53:23] [DOC: 9228332] ℹ️  Diagnosis codes being written:
[14:53:23] [DOC: 9228332] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:23] [DOC: 9228332] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:23] [DOC: 9228332] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:23] [DOC: 9228332] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:23] [DOC: 9228332] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:23] [DOC: 9228332] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:23] [DOC: 9228332] ✅ Patient data written to CSV: Peter Martens | Sex: MALE | Age: 67 | Service: HHA | Payer: Medicaid/MA | MRN: 385
[14:53:23] ✅    ✅ Document 9228332 processed and saved successfully
[14:53:23] 🔄 
🔄 Step 8: Saving API details...
[14:53:23] [DOC: 9228332] ℹ️  API push details saved for document 9228332
[14:53:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228314                         ║
================================================================================
[14:53:23] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:53:23] ℹ️  Date: 04/08/2025
[14:53:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:25] [DOC: 9228314] ✅ Text extracted using pdfplumber (1311 chars)
[14:53:25] ✅    ✅ Text extracted using pdfplumber (1311 chars)
[14:53:25] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:28] ℹ️  AI extracted raw sex value: 'F'
[14:53:28] ℹ️  AI extracted service line: 'HHA'
[14:53:28] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:53:28] ℹ️  AI extracted diagnoses:
[14:53:28] ℹ️    - Diagnosis 1: ''
[14:53:28] ℹ️    - Diagnosis 2: ''
[14:53:28] ℹ️    - Diagnosis 3: ''
[14:53:28] ℹ️    - Diagnosis 4: ''
[14:53:28] ℹ️    - Diagnosis 5: ''
[14:53:28] ℹ️    - Diagnosis 6: ''
[14:53:28] ℹ️  Final extracted MRN: '1005'
[14:53:28] ℹ️  Final extracted Sex: 'FEMALE'
[14:53:28] ℹ️  Final extracted Service Line: 'HHA'
[14:53:28] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:53:28] ✅ Patient data extraction completed successfully
[14:53:28] ✅    ✅ Patient data extracted successfully
[14:53:28] 📊 Patient Response
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:28] ✅    ✅ Patient identified: Christina Bosworth
[14:53:28] ✅    ✅ Patient name validation passed
[14:53:28] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:28] [DOC: 9228314] ℹ️  DOB normalized: 07/02/1990
[14:53:28] [DOC: 9228314] ℹ️  Episode startOfCare normalized: 08/17/2022
[14:53:28] [DOC: 9228314] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[14:53:28] [DOC: 9228314] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[14:53:28] [DOC: 9228314] ✅ Patient date processing completed successfully
[14:53:28] ✅    ✅ Date processing completed
[14:53:28] 📊 Processed Patient Data
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:28] 🔄 
🔄 Step 4: Extracting order data...
[14:53:31] ℹ️  Order extraction - MRN: '1005'
[14:53:31] ℹ️  Order extraction - Sex: 'FEMALE'
[14:53:31] ℹ️  Order extraction - Service Line: 'HHA'
[14:53:31] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:53:31] ✅ Order data extraction completed successfully
[14:53:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:31] ℹ️  Using MRN from patient data: '1005' over '1005'
[14:53:31] ℹ️  Service line consistent in both sources: 'HHA'
[14:53:31] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:53:31] ✅ Patient name cross-validation successful
[14:53:31] ✅    ✅ Data merged successfully
[14:53:32] ✅    ✅ Order data extracted and validated
[14:53:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:32] [DOC: 9228314] ✅ Patient found in local cache: Christina Bosworth, ID: 189e87b4-7506-4371-aa11-46e767bb1879
[14:53:32] ✅    ✅ Existing patient found with ID: 189e87b4-7506-4371-aa11-46e767bb1879
[14:53:32] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:32] [DOC: 9228314] ℹ️  Pushing order via API for patient ID: 189e87b4-7506-4371-aa11-46e767bb1879
[14:53:33] [DOC: 9228314] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:53:33] ❌    ❌ Failed to push order
[14:53:33] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:33] [DOC: 9228314] ℹ️  Calculated age: 34 from DOB: 07/02/1990
[14:53:33] [DOC: 9228314] ℹ️  Service Line extracted: 'HHA'
[14:53:33] [DOC: 9228314] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:53:33] [DOC: 9228314] ℹ️  Diagnosis codes being written:
[14:53:33] [DOC: 9228314] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:33] [DOC: 9228314] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:33] [DOC: 9228314] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:33] [DOC: 9228314] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:33] [DOC: 9228314] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:33] [DOC: 9228314] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:33] [DOC: 9228314] ✅ Patient data written to CSV: Christina Bosworth | Sex: FEMALE | Age: 34 | Service: HHA | Payer: Medicaid/MA | MRN: 1005
[14:53:33] ✅    ✅ Document 9228314 processed and saved successfully
[14:53:33] 🔄 
🔄 Step 8: Saving API details...
[14:53:33] [DOC: 9228314] ℹ️  API push details saved for document 9228314
[14:53:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228230                         ║
================================================================================
[14:53:33] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:53:33] ℹ️  Date: 04/08/2025
[14:53:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:35] [DOC: 9228230] ✅ Text extracted using pdfplumber (2170 chars)
[14:53:35] ✅    ✅ Text extracted using pdfplumber (2170 chars)
[14:53:35] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:38] ℹ️  AI extracted raw sex value: 'F'
[14:53:38] ℹ️  AI extracted service line: 'RN'
[14:53:38] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:53:38] ℹ️  AI extracted diagnoses:
[14:53:38] ℹ️    - Diagnosis 1: ''
[14:53:38] ℹ️    - Diagnosis 2: ''
[14:53:38] ℹ️    - Diagnosis 3: ''
[14:53:38] ℹ️    - Diagnosis 4: ''
[14:53:38] ℹ️    - Diagnosis 5: ''
[14:53:38] ℹ️    - Diagnosis 6: ''
[14:53:38] ℹ️  Final extracted MRN: '25'
[14:53:38] ℹ️  Final extracted Sex: 'FEMALE'
[14:53:38] ℹ️  Final extracted Service Line: 'RN'
[14:53:38] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:53:38] ✅ Patient data extraction completed successfully
[14:53:38] ✅    ✅ Patient data extracted successfully
[14:53:38] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Blake
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 31B Sea Breeze Dr 2 d buzzer from the top
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/31/2010', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:38] ✅    ✅ Patient identified: Patricia Blake
[14:53:38] ✅    ✅ Patient name validation passed
[14:53:38] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:38] [DOC: 9228230] ℹ️  DOB normalized: 07/06/1953
[14:53:38] [DOC: 9228230] ℹ️  Episode startOfCare normalized: 08/31/2010
[14:53:38] [DOC: 9228230] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[14:53:38] [DOC: 9228230] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[14:53:38] [DOC: 9228230] ✅ Patient date processing completed successfully
[14:53:38] ✅    ✅ Date processing completed
[14:53:38] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Blake
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 31B Sea Breeze Dr 2 d buzzer from the top
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/31/2010', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:38] 🔄 
🔄 Step 4: Extracting order data...
[14:53:40] ℹ️  Order extraction - MRN: '25'
[14:53:40] ℹ️  Order extraction - Sex: 'FEMALE'
[14:53:40] ℹ️  Order extraction - Service Line: 'HHA'
[14:53:40] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:53:40] ✅ Order data extraction completed successfully
[14:53:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:40] ℹ️  Using MRN from patient data: '25' over '25'
[14:53:40] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[14:53:40] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:53:40] ✅ Patient name cross-validation successful
[14:53:40] ✅    ✅ Data merged successfully
[14:53:42] ✅    ✅ Order data extracted and validated
[14:53:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:42] [DOC: 9228230] ✅ Patient found in local cache: Patricia Blake, ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[14:53:42] ✅    ✅ Existing patient found with ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[14:53:42] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:42] [DOC: 9228230] ℹ️  Pushing order via API for patient ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[14:53:43] [DOC: 9228230] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:53:43] ❌    ❌ Failed to push order
[14:53:43] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:43] [DOC: 9228230] ℹ️  Calculated age: 71 from DOB: 07/06/1953
[14:53:43] [DOC: 9228230] ℹ️  Service Line extracted: 'HHA, RN'
[14:53:43] [DOC: 9228230] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:53:43] [DOC: 9228230] ℹ️  Diagnosis codes being written:
[14:53:43] [DOC: 9228230] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:43] [DOC: 9228230] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:43] [DOC: 9228230] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:43] [DOC: 9228230] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:43] [DOC: 9228230] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:43] [DOC: 9228230] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:43] [DOC: 9228230] ✅ Patient data written to CSV: Patricia Blake | Sex: FEMALE | Age: 71 | Service: HHA, RN | Payer: Senior Whole Health | MRN: 25
[14:53:43] ✅    ✅ Document 9228230 processed and saved successfully
[14:53:43] 🔄 
🔄 Step 8: Saving API details...
[14:53:43] [DOC: 9228230] ℹ️  API push details saved for document 9228230
[14:53:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228136                         ║
================================================================================
[14:53:43] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:53:43] ℹ️  Date: 04/08/2025
[14:53:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:45] [DOC: 9228136] ✅ Text extracted using pdfplumber (1758 chars)
[14:53:45] ✅    ✅ Text extracted using pdfplumber (1758 chars)
[14:53:45] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:47] ℹ️  AI extracted raw sex value: 'M'
[14:53:47] ℹ️  AI extracted service line: 'HHA'
[14:53:47] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:53:47] ℹ️  AI extracted diagnoses:
[14:53:47] ℹ️    - Diagnosis 1: ''
[14:53:47] ℹ️    - Diagnosis 2: ''
[14:53:47] ℹ️    - Diagnosis 3: ''
[14:53:47] ℹ️    - Diagnosis 4: ''
[14:53:47] ℹ️    - Diagnosis 5: ''
[14:53:47] ℹ️    - Diagnosis 6: ''
[14:53:47] ℹ️  Final extracted MRN: '174003'
[14:53:47] ℹ️  Final extracted Sex: 'MALE'
[14:53:47] ℹ️  Final extracted Service Line: 'HHA'
[14:53:47] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:53:47] ✅ Patient data extraction completed successfully
[14:53:47] ✅    ✅ Patient data extracted successfully
[14:53:47] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 67 Hunter St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:47] ✅    ✅ Patient identified: Julio Philogene
[14:53:47] ✅    ✅ Patient name validation passed
[14:53:47] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:47] [DOC: 9228136] ℹ️  DOB normalized: 07/29/1980
[14:53:47] [DOC: 9228136] ℹ️  Episode startOfCare normalized: 09/08/2017
[14:53:47] [DOC: 9228136] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[14:53:47] [DOC: 9228136] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[14:53:47] [DOC: 9228136] ✅ Patient date processing completed successfully
[14:53:47] ✅    ✅ Date processing completed
[14:53:47] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 67 Hunter St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:47] 🔄 
🔄 Step 4: Extracting order data...
[14:53:50] ℹ️  Order extraction - MRN: '174003'
[14:53:50] ℹ️  Order extraction - Sex: 'MALE'
[14:53:50] ℹ️  Order extraction - Service Line: 'HHA'
[14:53:50] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:53:50] ✅ Order data extraction completed successfully
[14:53:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:50] ℹ️  Using MRN from patient data: '174003' over '174003'
[14:53:50] ℹ️  Service line consistent in both sources: 'HHA'
[14:53:50] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:53:50] ✅ Patient name cross-validation successful
[14:53:50] ✅    ✅ Data merged successfully
[14:53:51] ✅    ✅ Order data extracted and validated
[14:53:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:51] [DOC: 9228136] ✅ Patient found in local cache: Julio Philogene, ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[14:53:51] ✅    ✅ Existing patient found with ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[14:53:51] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:51] [DOC: 9228136] ℹ️  Pushing order via API for patient ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[14:53:52] [DOC: 9228136] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:53:52] ❌    ❌ Failed to push order
[14:53:52] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:52] [DOC: 9228136] ℹ️  Calculated age: 44 from DOB: 07/29/1980
[14:53:52] [DOC: 9228136] ℹ️  Service Line extracted: 'HHA'
[14:53:52] [DOC: 9228136] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:53:52] [DOC: 9228136] ℹ️  Diagnosis codes being written:
[14:53:52] [DOC: 9228136] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:52] [DOC: 9228136] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:52] [DOC: 9228136] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:52] [DOC: 9228136] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:52] [DOC: 9228136] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:52] [DOC: 9228136] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:52] [DOC: 9228136] ✅ Patient data written to CSV: Julio Philogene | Sex: MALE | Age: 44 | Service: HHA | Payer: Medicaid/MA | MRN: 174003
[14:53:52] ✅    ✅ Document 9228136 processed and saved successfully
[14:53:52] 🔄 
🔄 Step 8: Saving API details...
[14:53:52] [DOC: 9228136] ℹ️  API push details saved for document 9228136
[14:53:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227910                         ║
================================================================================
[14:53:52] ℹ️  Agency: Relief Home Health Services
[14:53:52] ℹ️  Date: 04/08/2025
[14:53:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:54] [DOC: 9227910] ✅ Text extracted using pdfplumber (9269 chars)
[14:53:54] ✅    ✅ Text extracted using pdfplumber (9269 chars)
[14:53:54] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:57] ℹ️  AI extracted raw sex value: ''
[14:53:57] ℹ️  AI extracted service line: 'SN, HHA, PT, OT'
[14:53:57] ℹ️  AI extracted payer source: ''
[14:53:57] ℹ️  AI extracted diagnoses:
[14:53:57] ℹ️    - Diagnosis 1: 'E11.9'
[14:53:57] ℹ️    - Diagnosis 2: ''
[14:53:57] ℹ️    - Diagnosis 3: ''
[14:53:57] ℹ️    - Diagnosis 4: ''
[14:53:57] ℹ️    - Diagnosis 5: ''
[14:53:57] ℹ️    - Diagnosis 6: ''
[14:53:57] ℹ️  Final extracted MRN: 'S0049671801'
[14:53:57] ℹ️  Final extracted Sex: ''
[14:53:57] ℹ️  Final extracted Service Line: 'SN, HHA, PT, OT'
[14:53:57] ℹ️  Final extracted Payer Source: ''
[14:53:57] ✅ Patient data extraction completed successfully
[14:53:57] ✅    ✅ Patient data extracted successfully
[14:53:57] 📊 Patient Response
     └─ patientFName: YVONNE
     └─ patientLName: VARIEUR
     └─ dob: 12/27/1936
     └─ patientSex: 
     └─ medicalRecordNo: S0049671801
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 35 Winter Street
     └─ city: Hyannis
     └─ state: MA
     └─ zip: 02601
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: SN, HHA, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:57] ✅    ✅ Patient identified: YVONNE VARIEUR
[14:53:57] ✅    ✅ Patient name validation passed
[14:53:57] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:57] [DOC: 9227910] ℹ️  DOB normalized: 12/27/1936
[14:53:57] [DOC: 9227910] ℹ️  Episode startOfCare normalized: 01/30/2025
[14:53:57] [DOC: 9227910] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[14:53:57] [DOC: 9227910] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[14:53:57] [DOC: 9227910] ✅ Patient date processing completed successfully
[14:53:57] ✅    ✅ Date processing completed
[14:53:57] 📊 Processed Patient Data
     └─ patientFName: YVONNE
     └─ patientLName: VARIEUR
     └─ dob: 12/27/1936
     └─ patientSex: 
     └─ medicalRecordNo: S0049671801
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 35 Winter Street
     └─ city: Hyannis
     └─ state: MA
     └─ zip: 02601
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: SN, HHA, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/30/2025', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:57] 🔄 
🔄 Step 4: Extracting order data...
[14:54:00] ℹ️  Order extraction - MRN: 'S0049671801'
[14:54:00] ℹ️  Order extraction - Sex: ''
[14:54:00] ℹ️  Order extraction - Service Line: 'SN, HHA, PT'
[14:54:00] ℹ️  Order extraction - Payer Source: ''
[14:54:00] ✅ Order data extraction completed successfully
[14:54:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:00] ℹ️  Using MRN from patient data: 'S0049671801' over 'S0049671801'
[14:54:00] ⚠️  Could not determine sex using any available method
[14:54:00] ℹ️  Combined service lines: Patient='SN, HHA, PT, OT' + Order='SN, HHA, PT' = 'HHA, OT, PT, SN'
[14:54:00] ✅ Patient name cross-validation successful
[14:54:00] ✅    ✅ Data merged successfully
[14:54:02] ✅    ✅ Order data extracted and validated
[14:54:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:09] [DOC: 9227910] ✅ Patient exists in API: YVONNE VARIEUR, ID: d5a9fa13-bcce-4148-9256-54aba74afc56
[14:54:09] ✅    ✅ Existing patient found with ID: d5a9fa13-bcce-4148-9256-54aba74afc56
[14:54:09] 🔄 
🔄 Step 6: Pushing order to API...
[14:54:09] [DOC: 9227910] ℹ️  Pushing order via API for patient ID: d5a9fa13-bcce-4148-9256-54aba74afc56
[14:54:10] [DOC: 9227910] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:54:10] ❌    ❌ Failed to push order
[14:54:10] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:10] [DOC: 9227910] ℹ️  Calculated age: 88 from DOB: 12/27/1936
[14:54:10] [DOC: 9227910] ℹ️  Service Line extracted: 'HHA, OT, PT, SN'
[14:54:10] [DOC: 9227910] ℹ️  Payer Source extracted: ''
[14:54:10] [DOC: 9227910] ℹ️  Diagnosis codes being written:
[14:54:10] [DOC: 9227910] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[14:54:10] [DOC: 9227910] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:54:10] [DOC: 9227910] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:54:10] [DOC: 9227910] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:10] [DOC: 9227910] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:10] [DOC: 9227910] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:10] [DOC: 9227910] ✅ Patient data written to CSV: YVONNE VARIEUR | Sex:  | Age: 88 | Service: HHA, OT, PT, SN | Payer:  | MRN: S0049671801
[14:54:10] ✅    ✅ Document 9227910 processed and saved successfully
[14:54:10] 🔄 
🔄 Step 8: Saving API details...
[14:54:10] [DOC: 9227910] ℹ️  API push details saved for document 9227910
[14:54:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227493                         ║
================================================================================
[14:54:10] ℹ️  Agency: Brigham Home Care Services.Inc
[14:54:10] ℹ️  Date: 04/08/2025
[14:54:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:14] [DOC: 9227493] ✅ Text extracted using pdfplumber (18763 chars)
[14:54:14] ✅    ✅ Text extracted using pdfplumber (18763 chars)
[14:54:14] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:17] ℹ️  AI extracted raw sex value: 'F'
[14:54:17] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[14:54:17] ℹ️  AI extracted payer source: ''
[14:54:17] ℹ️  AI extracted diagnoses:
[14:54:17] ℹ️    - Diagnosis 1: 'F32.1'
[14:54:17] ℹ️    - Diagnosis 2: 'F41.1'
[14:54:17] ℹ️    - Diagnosis 3: 'F31.61'
[14:54:17] ℹ️    - Diagnosis 4: 'M19.90'
[14:54:17] ℹ️    - Diagnosis 5: 'G56.03'
[14:54:17] ℹ️    - Diagnosis 6: 'M54.30'
[14:54:17] ℹ️  Final extracted MRN: '2304'
[14:54:17] ℹ️  Final extracted Sex: 'FEMALE'
[14:54:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[14:54:17] ℹ️  Final extracted Payer Source: ''
[14:54:17] ✅ Patient data extraction completed successfully
[14:54:17] ✅    ✅ Patient data extracted successfully
[14:54:17] 📊 Patient Response
     └─ patientFName: RASHELL
     └─ patientLName: ARNUM
     └─ dob: 10/23/1973
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2304
     └─ billingProvider: Brigham Home Care Services, Inc
     └─ npi: 227605
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343-1171
     └─ email: 
     └─ phoneNumber: 5088570627
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/06/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'F32.1', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F31.61', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'G56.03', 'sixthDiagnosis': 'M54.30'}]
[14:54:17] ✅    ✅ Patient identified: RASHELL ARNUM
[14:54:17] ✅    ✅ Patient name validation passed
[14:54:17] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:17] [DOC: 9227493] ℹ️  DOB normalized: 10/23/1973
[14:54:17] [DOC: 9227493] ℹ️  Episode startOfCare normalized: 02/06/2024
[14:54:17] [DOC: 9227493] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[14:54:17] [DOC: 9227493] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[14:54:17] [DOC: 9227493] ✅ Patient date processing completed successfully
[14:54:17] ✅    ✅ Date processing completed
[14:54:17] 📊 Processed Patient Data
     └─ patientFName: RASHELL
     └─ patientLName: ARNUM
     └─ dob: 10/23/1973
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2304
     └─ billingProvider: Brigham Home Care Services, Inc
     └─ npi: 227605
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343-1171
     └─ email: 
     └─ phoneNumber: 5088570627
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/06/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'F32.1', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F31.61', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'G56.03', 'sixthDiagnosis': 'M54.30'}]
[14:54:17] 🔄 
🔄 Step 4: Extracting order data...
[14:54:20] ℹ️  Order extraction - MRN: '2304'
[14:54:20] ℹ️  Order extraction - Sex: 'FEMALE'
[14:54:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[14:54:20] ℹ️  Order extraction - Payer Source: ''
[14:54:20] ✅ Order data extraction completed successfully
[14:54:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:20] ℹ️  Using MRN from patient data: '2304' over '2304'
[14:54:20] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide' + Order='Skilled Nursing, Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:54:20] ✅ Patient name cross-validation successful
[14:54:20] ✅    ✅ Data merged successfully
[14:54:21] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[14:54:21] [DOC: 9227493] ℹ️  API push details saved for document 9227493
================================================================================
║                        Processing Document ID: 9227691                         ║
================================================================================
[14:54:21] ℹ️  Agency: Dartmouth HH
[14:54:21] ℹ️  Date: 04/08/2025
[14:54:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:23] [DOC: 9227691] ✅ Text extracted using pdfplumber (1544 chars)
[14:54:23] ✅    ✅ Text extracted using pdfplumber (1544 chars)
[14:54:23] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:25] ℹ️  AI extracted raw sex value: 'M'
[14:54:25] ℹ️  AI extracted service line: 'RN, LPN'
[14:54:25] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[14:54:25] ℹ️  AI extracted diagnoses:
[14:54:25] ℹ️    - Diagnosis 1: ''
[14:54:25] ℹ️    - Diagnosis 2: ''
[14:54:25] ℹ️    - Diagnosis 3: ''
[14:54:25] ℹ️    - Diagnosis 4: ''
[14:54:25] ℹ️    - Diagnosis 5: ''
[14:54:25] ℹ️    - Diagnosis 6: ''
[14:54:25] ℹ️  Final extracted MRN: '551011'
[14:54:25] ℹ️  Final extracted Sex: 'MALE'
[14:54:25] ℹ️  Final extracted Service Line: 'RN, LPN'
[14:54:25] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[14:54:25] ✅ Patient data extraction completed successfully
[14:54:25] ✅    ✅ Patient data extracted successfully
[14:54:25] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:25] ✅    ✅ Patient identified: James Travers
[14:54:25] ✅    ✅ Patient name validation passed
[14:54:25] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:25] [DOC: 9227691] ℹ️  DOB normalized: 07/02/1944
[14:54:25] [DOC: 9227691] ℹ️  Episode startOfCare normalized: 03/23/2025
[14:54:25] [DOC: 9227691] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[14:54:25] [DOC: 9227691] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[14:54:25] [DOC: 9227691] ✅ Patient date processing completed successfully
[14:54:25] ✅    ✅ Date processing completed
[14:54:25] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:25] 🔄 
🔄 Step 4: Extracting order data...
[14:54:28] ℹ️  Order extraction - MRN: ''
[14:54:28] ℹ️  Order extraction - Sex: 'MALE'
[14:54:28] ℹ️  Order extraction - Service Line: 'RN, LPN'
[14:54:28] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[14:54:28] ✅ Order data extraction completed successfully
[14:54:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:28] ℹ️  Using MRN from patient data: '551011'
[14:54:28] ℹ️  Service line consistent in both sources: 'RN, LPN'
[14:54:28] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[14:54:28] ✅ Patient name cross-validation successful
[14:54:28] ✅    ✅ Data merged successfully
[14:54:29] ✅    ✅ Order data extracted and validated
[14:54:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:29] [DOC: 9227691] ✅ Patient found in local cache: James Travers, ID: c5103623-be0f-42b5-97de-217d9f008d54
[14:54:29] ✅    ✅ Existing patient found with ID: c5103623-be0f-42b5-97de-217d9f008d54
[14:54:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:54:29] [DOC: 9227691] ℹ️  Pushing order via API for patient ID: c5103623-be0f-42b5-97de-217d9f008d54
[14:54:30] [DOC: 9227691] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:54:30] ❌    ❌ Failed to push order
[14:54:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:30] [DOC: 9227691] ℹ️  Calculated age: 80 from DOB: 07/02/1944
[14:54:30] [DOC: 9227691] ℹ️  Service Line extracted: 'RN, LPN'
[14:54:30] [DOC: 9227691] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[14:54:30] [DOC: 9227691] ℹ️  Diagnosis codes being written:
[14:54:30] [DOC: 9227691] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:54:30] [DOC: 9227691] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:54:30] [DOC: 9227691] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:54:30] [DOC: 9227691] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:30] [DOC: 9227691] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:30] [DOC: 9227691] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:30] [DOC: 9227691] ✅ Patient data written to CSV: James Travers | Sex: MALE | Age: 80 | Service: RN, LPN | Payer: Blue Cross Blue Shield | MRN: 551011
[14:54:30] ✅    ✅ Document 9227691 processed and saved successfully
[14:54:30] 🔄 
🔄 Step 8: Saving API details...
[14:54:30] [DOC: 9227691] ℹ️  API push details saved for document 9227691
[14:54:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227687                         ║
================================================================================
[14:54:30] ℹ️  Agency: Dartmouth HH
[14:54:30] ℹ️  Date: 04/08/2025
[14:54:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:33] [DOC: 9227687] ✅ Text extracted using pdfplumber (3892 chars)
[14:54:33] ✅    ✅ Text extracted using pdfplumber (3892 chars)
[14:54:33] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:35] ℹ️  AI extracted raw sex value: 'F'
[14:54:35] ℹ️  AI extracted service line: 'RN, MSW'
[14:54:35] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[14:54:35] ℹ️  AI extracted diagnoses:
[14:54:35] ℹ️    - Diagnosis 1: ''
[14:54:35] ℹ️    - Diagnosis 2: ''
[14:54:35] ℹ️    - Diagnosis 3: ''
[14:54:35] ℹ️    - Diagnosis 4: ''
[14:54:35] ℹ️    - Diagnosis 5: ''
[14:54:35] ℹ️    - Diagnosis 6: ''
[14:54:35] ℹ️  Final extracted MRN: '651015'
[14:54:35] ℹ️  Final extracted Sex: 'FEMALE'
[14:54:35] ℹ️  Final extracted Service Line: 'RN, MSW'
[14:54:35] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[14:54:35] ✅ Patient data extraction completed successfully
[14:54:35] ✅    ✅ Patient data extracted successfully
[14:54:35] 📊 Patient Response
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, MSW
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '03/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:35] ✅    ✅ Patient identified: A Shirley Jadlowe
[14:54:35] ✅    ✅ Patient name validation passed
[14:54:35] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:35] [DOC: 9227687] ℹ️  DOB normalized: 01/19/1935
[14:54:35] [DOC: 9227687] ℹ️  Episode startOfCare normalized: 05/23/2024
[14:54:35] [DOC: 9227687] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[14:54:35] [DOC: 9227687] ℹ️  Episode endOfEpisode normalized: 03/18/2025
[14:54:35] [DOC: 9227687] ✅ Patient date processing completed successfully
[14:54:35] ✅    ✅ Date processing completed
[14:54:35] 📊 Processed Patient Data
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, MSW
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '03/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:35] 🔄 
🔄 Step 4: Extracting order data...
[14:54:38] ℹ️  Order extraction - MRN: ''
[14:54:38] ℹ️  Order extraction - Sex: 'FEMALE'
[14:54:38] ℹ️  Order extraction - Service Line: 'RN, MSW'
[14:54:38] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[14:54:38] ✅ Order data extraction completed successfully
[14:54:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:38] ℹ️  Using MRN from patient data: '651015'
[14:54:38] ℹ️  Service line consistent in both sources: 'RN, MSW'
[14:54:38] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[14:54:38] ✅ Patient name cross-validation successful
[14:54:38] ✅    ✅ Data merged successfully
[14:54:39] ✅    ✅ Order data extracted and validated
[14:54:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:39] [DOC: 9227687] ✅ Patient found in local cache: A Shirley Jadlowe, ID: f434f7e2-b2e3-4187-b677-c68e57142970
[14:54:39] ✅    ✅ Existing patient found with ID: f434f7e2-b2e3-4187-b677-c68e57142970
[14:54:39] 🔄 
🔄 Step 6: Pushing order to API...
[14:54:39] [DOC: 9227687] ℹ️  Pushing order via API for patient ID: f434f7e2-b2e3-4187-b677-c68e57142970
[14:54:40] [DOC: 9227687] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:54:40] ❌    ❌ Failed to push order
[14:54:40] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:40] [DOC: 9227687] ℹ️  Calculated age: 90 from DOB: 01/19/1935
[14:54:40] [DOC: 9227687] ℹ️  Service Line extracted: 'RN, MSW'
[14:54:40] [DOC: 9227687] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[14:54:40] [DOC: 9227687] ℹ️  Diagnosis codes being written:
[14:54:40] [DOC: 9227687] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:54:40] [DOC: 9227687] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:54:40] [DOC: 9227687] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:54:40] [DOC: 9227687] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:40] [DOC: 9227687] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:40] [DOC: 9227687] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:40] [DOC: 9227687] ✅ Patient data written to CSV: A Shirley Jadlowe | Sex: FEMALE | Age: 90 | Service: RN, MSW | Payer: Blue Cross Blue Shield | MRN: 651015
[14:54:40] ✅    ✅ Document 9227687 processed and saved successfully
[14:54:40] 🔄 
🔄 Step 8: Saving API details...
[14:54:40] [DOC: 9227687] ℹ️  API push details saved for document 9227687
[14:54:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227681                         ║
================================================================================
[14:54:40] ℹ️  Agency: Dartmouth HH
[14:54:40] ℹ️  Date: 04/08/2025
[14:54:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:42] [DOC: 9227681] ✅ Text extracted using pdfplumber (1498 chars)
[14:54:42] ✅    ✅ Text extracted using pdfplumber (1498 chars)
[14:54:42] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:45] ℹ️  AI extracted raw sex value: 'F'
[14:54:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:54:45] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[14:54:45] ℹ️  AI extracted diagnoses:
[14:54:45] ℹ️    - Diagnosis 1: ''
[14:54:45] ℹ️    - Diagnosis 2: ''
[14:54:45] ℹ️    - Diagnosis 3: ''
[14:54:45] ℹ️    - Diagnosis 4: ''
[14:54:45] ℹ️    - Diagnosis 5: ''
[14:54:45] ℹ️    - Diagnosis 6: ''
[14:54:45] ℹ️  Final extracted MRN: '651015'
[14:54:45] ℹ️  Final extracted Sex: 'FEMALE'
[14:54:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:54:45] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[14:54:45] ✅ Patient data extraction completed successfully
[14:54:45] ✅    ✅ Patient data extracted successfully
[14:54:45] 📊 Patient Response
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:45] ✅    ✅ Patient identified: A Shirley Jadlowe
[14:54:45] ✅    ✅ Patient name validation passed
[14:54:45] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:45] [DOC: 9227681] ℹ️  DOB normalized: 01/19/1935
[14:54:45] [DOC: 9227681] ℹ️  Episode startOfCare normalized: 05/23/2024
[14:54:45] [DOC: 9227681] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[14:54:45] [DOC: 9227681] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[14:54:45] [DOC: 9227681] ✅ Patient date processing completed successfully
[14:54:45] ✅    ✅ Date processing completed
[14:54:45] 📊 Processed Patient Data
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:45] 🔄 
🔄 Step 4: Extracting order data...
[14:54:48] ℹ️  Order extraction - MRN: ''
[14:54:48] ℹ️  Order extraction - Sex: 'FEMALE'
[14:54:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:54:48] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[14:54:48] ✅ Order data extraction completed successfully
[14:54:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:48] ℹ️  Using MRN from patient data: '651015'
[14:54:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:54:48] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[14:54:48] ✅ Patient name cross-validation successful
[14:54:48] ✅    ✅ Data merged successfully
[14:54:49] ✅    ✅ Order data extracted and validated
[14:54:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:49] [DOC: 9227681] ✅ Patient found in local cache: A Shirley Jadlowe, ID: f434f7e2-b2e3-4187-b677-c68e57142970
[14:54:49] ✅    ✅ Existing patient found with ID: f434f7e2-b2e3-4187-b677-c68e57142970
[14:54:49] 🔄 
🔄 Step 6: Pushing order to API...
[14:54:49] [DOC: 9227681] ℹ️  Pushing order via API for patient ID: f434f7e2-b2e3-4187-b677-c68e57142970
[14:54:52] [DOC: 9227681] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13843"}
[14:54:52] ❌    ❌ Failed to push order
[14:54:52] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:52] [DOC: 9227681] ℹ️  Calculated age: 90 from DOB: 01/19/1935
[14:54:52] [DOC: 9227681] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:54:52] [DOC: 9227681] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[14:54:52] [DOC: 9227681] ℹ️  Diagnosis codes being written:
[14:54:52] [DOC: 9227681] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:54:52] [DOC: 9227681] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:54:52] [DOC: 9227681] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:54:52] [DOC: 9227681] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:52] [DOC: 9227681] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:52] [DOC: 9227681] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:52] [DOC: 9227681] ✅ Patient data written to CSV: A Shirley Jadlowe | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 651015
[14:54:52] ✅    ✅ Document 9227681 processed and saved successfully
[14:54:52] 🔄 
🔄 Step 8: Saving API details...
[14:54:52] [DOC: 9227681] ℹ️  API push details saved for document 9227681
[14:54:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227677                         ║
================================================================================
[14:54:52] ℹ️  Agency: Dartmouth HH
[14:54:52] ℹ️  Date: 04/08/2025
[14:54:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:55] [DOC: 9227677] ✅ Text extracted using pdfplumber (20466 chars)
[14:54:55] ✅    ✅ Text extracted using pdfplumber (20466 chars)
[14:54:55] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:58] ℹ️  AI extracted raw sex value: 'M'
[14:54:58] ℹ️  AI extracted service line: 'Speech Therapy, Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:54:58] ℹ️  AI extracted payer source: 'Medicare'
[14:54:58] ℹ️  AI extracted diagnoses:
[14:54:58] ℹ️    - Diagnosis 1: 'subarachnoid hemorrhage'
[14:54:58] ℹ️    - Diagnosis 2: 'HTN'
[14:54:58] ℹ️    - Diagnosis 3: 'wound'
[14:54:58] ℹ️    - Diagnosis 4: 'None'
[14:54:58] ℹ️    - Diagnosis 5: 'None'
[14:54:58] ℹ️    - Diagnosis 6: 'None'
[14:54:58] ℹ️  Final extracted MRN: '2194001'
[14:54:58] ℹ️  Final extracted Sex: 'MALE'
[14:54:58] ℹ️  Final extracted Service Line: 'Speech Therapy, Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:54:58] ℹ️  Final extracted Payer Source: 'Medicare'
[14:54:58] ✅ Patient data extraction completed successfully
[14:54:58] ✅    ✅ Patient data extracted successfully
[14:54:58] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Desnoyers
     └─ dob: 06/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2194001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy, Occupational Therapy, Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': 'subarachnoid hemorrhage', 'secondDiagnosis': 'HTN', 'thirdDiagnosis': 'wound', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:54:58] ✅    ✅ Patient identified: Dennis Desnoyers
[14:54:58] ✅    ✅ Patient name validation passed
[14:54:58] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:58] [DOC: 9227677] ℹ️  DOB normalized: 06/09/1950
[14:54:58] [DOC: 9227677] ℹ️  Episode startOfCare normalized: 03/06/2025
[14:54:58] [DOC: 9227677] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[14:54:58] [DOC: 9227677] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[14:54:58] [DOC: 9227677] ✅ Patient date processing completed successfully
[14:54:58] ✅    ✅ Date processing completed
[14:54:58] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Desnoyers
     └─ dob: 06/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2194001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy, Occupational Therapy, Physical Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': 'subarachnoid hemorrhage', 'secondDiagnosis': 'HTN', 'thirdDiagnosis': 'wound'}]
[14:54:58] 🔄 
🔄 Step 4: Extracting order data...
[14:55:01] ℹ️  Order extraction - MRN: ''
[14:55:01] ℹ️  Order extraction - Sex: 'MALE'
[14:55:01] ℹ️  Order extraction - Service Line: 'PT, OT, ST, RN'
[14:55:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:01] ✅ Order data extraction completed successfully
[14:55:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:01] ℹ️  Using MRN from patient data: '2194001'
[14:55:01] ℹ️  Combined service lines: Patient='Speech Therapy, Occupational Therapy, Physical Therapy, Skilled Nursing' + Order='PT, OT, ST, RN' = 'OT, Occupational Therapy, PT, Physical Therapy, RN, ST, Skilled Nursing, Speech Therapy'
[14:55:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:01] ✅ Patient name cross-validation successful
[14:55:01] ✅    ✅ Data merged successfully
[14:55:02] ✅    ✅ Order data extracted and validated
[14:55:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:02] [DOC: 9227677] ✅ Patient found in local cache: Dennis Desnoyers, ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[14:55:02] ✅    ✅ Existing patient found with ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[14:55:02] 🔄 
🔄 Step 6: Pushing order to API...
[14:55:02] [DOC: 9227677] ℹ️  Pushing order via API for patient ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[14:55:03] [DOC: 9227677] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:55:03] ❌    ❌ Failed to push order
[14:55:03] 🔄 
🔄 Step 7: Writing to CSV...
[14:55:03] [DOC: 9227677] ℹ️  Calculated age: 74 from DOB: 06/09/1950
[14:55:03] [DOC: 9227677] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, RN, ST, Skilled Nursing, Speech Therapy'
[14:55:03] [DOC: 9227677] ℹ️  Payer Source extracted: 'Medicare'
[14:55:03] [DOC: 9227677] ℹ️  Diagnosis codes being written:
[14:55:03] [DOC: 9227677] ℹ️    - Latest_Episode_Firstdiagnosis: 'subarachnoid hemorrhage'
[14:55:03] [DOC: 9227677] ℹ️    - Latest_Episode_Seconddiagnosis: 'HTN'
[14:55:03] [DOC: 9227677] ℹ️    - Latest_Episode_Thirddiagnosis: 'wound'
[14:55:03] [DOC: 9227677] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:55:03] [DOC: 9227677] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:55:03] [DOC: 9227677] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:55:03] [DOC: 9227677] ✅ Patient data written to CSV: Dennis Desnoyers | Sex: MALE | Age: 74 | Service: OT, Occupational Therapy, PT, Physical Therapy, RN, ST, Skilled Nursing, Speech Therapy | Payer: Medicare | MRN: 2194001
[14:55:03] ✅    ✅ Document 9227677 processed and saved successfully
[14:55:03] 🔄 
🔄 Step 8: Saving API details...
[14:55:03] [DOC: 9227677] ℹ️  API push details saved for document 9227677
[14:55:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227676                         ║
================================================================================
[14:55:03] ℹ️  Agency: Dartmouth HH
[14:55:03] ℹ️  Date: 04/08/2025
[14:55:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:05] [DOC: 9227676] ✅ Text extracted using pdfplumber (1326 chars)
[14:55:05] ✅    ✅ Text extracted using pdfplumber (1326 chars)
[14:55:05] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:08] ℹ️  AI extracted raw sex value: 'M'
[14:55:08] ℹ️  AI extracted service line: 'RN, LPN'
[14:55:08] ℹ️  AI extracted payer source: 'Medicare'
[14:55:08] ℹ️  AI extracted diagnoses:
[14:55:08] ℹ️    - Diagnosis 1: ''
[14:55:08] ℹ️    - Diagnosis 2: ''
[14:55:08] ℹ️    - Diagnosis 3: ''
[14:55:08] ℹ️    - Diagnosis 4: ''
[14:55:08] ℹ️    - Diagnosis 5: ''
[14:55:08] ℹ️    - Diagnosis 6: ''
[14:55:08] ℹ️  Final extracted MRN: '6208015'
[14:55:08] ℹ️  Final extracted Sex: 'MALE'
[14:55:08] ℹ️  Final extracted Service Line: 'RN, LPN'
[14:55:08] ℹ️  Final extracted Payer Source: 'Medicare'
[14:55:08] ✅ Patient data extraction completed successfully
[14:55:08] ✅    ✅ Patient data extracted successfully
[14:55:08] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:08] ✅    ✅ Patient identified: Stephen Hanna Jr,
[14:55:08] ✅    ✅ Patient name validation passed
[14:55:08] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:08] [DOC: 9227676] ℹ️  DOB normalized: 03/11/1936
[14:55:08] [DOC: 9227676] ℹ️  Episode startOfCare normalized: 03/15/2025
[14:55:08] [DOC: 9227676] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:55:08] [DOC: 9227676] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[14:55:08] [DOC: 9227676] ✅ Patient date processing completed successfully
[14:55:08] ✅    ✅ Date processing completed
[14:55:08] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:08] 🔄 
🔄 Step 4: Extracting order data...
[14:55:10] ℹ️  Order extraction - MRN: ''
[14:55:10] ℹ️  Order extraction - Sex: 'MALE'
[14:55:10] ℹ️  Order extraction - Service Line: 'RN, LPN'
[14:55:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:10] ✅ Order data extraction completed successfully
[14:55:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:10] ℹ️  Using MRN from patient data: '6208015'
[14:55:10] ℹ️  Service line consistent in both sources: 'RN, LPN'
[14:55:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:10] ✅ Patient name cross-validation successful
[14:55:10] ✅    ✅ Data merged successfully
[14:55:12] ✅    ✅ Order data extracted and validated
[14:55:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:12] [DOC: 9227676] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:55:12] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:55:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:55:12] [DOC: 9227676] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:55:13] [DOC: 9227676] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13829"}
[14:55:13] ❌    ❌ Failed to push order
[14:55:13] 🔄 
🔄 Step 7: Writing to CSV...
[14:55:13] [DOC: 9227676] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[14:55:13] [DOC: 9227676] ℹ️  Service Line extracted: 'RN, LPN'
[14:55:13] [DOC: 9227676] ℹ️  Payer Source extracted: 'Medicare'
[14:55:13] [DOC: 9227676] ℹ️  Diagnosis codes being written:
[14:55:13] [DOC: 9227676] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:55:13] [DOC: 9227676] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:55:13] [DOC: 9227676] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:55:13] [DOC: 9227676] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:55:13] [DOC: 9227676] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:55:13] [DOC: 9227676] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:55:13] [DOC: 9227676] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: RN, LPN | Payer: Medicare | MRN: 6208015
[14:55:13] ✅    ✅ Document 9227676 processed and saved successfully
[14:55:13] 🔄 
🔄 Step 8: Saving API details...
[14:55:13] [DOC: 9227676] ℹ️  API push details saved for document 9227676
[14:55:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227675                         ║
================================================================================
[14:55:13] ℹ️  Agency: Dartmouth HH
[14:55:13] ℹ️  Date: 04/08/2025
[14:55:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:15] [DOC: 9227675] ✅ Text extracted using pdfplumber (2323 chars)
[14:55:15] ✅    ✅ Text extracted using pdfplumber (2323 chars)
[14:55:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:18] ℹ️  AI extracted raw sex value: 'F'
[14:55:18] ℹ️  AI extracted service line: 'PT'
[14:55:18] ℹ️  AI extracted payer source: 'Medicare'
[14:55:18] ℹ️  AI extracted diagnoses:
[14:55:18] ℹ️    - Diagnosis 1: ''
[14:55:18] ℹ️    - Diagnosis 2: ''
[14:55:18] ℹ️    - Diagnosis 3: ''
[14:55:18] ℹ️    - Diagnosis 4: ''
[14:55:18] ℹ️    - Diagnosis 5: ''
[14:55:18] ℹ️    - Diagnosis 6: ''
[14:55:18] ℹ️  Final extracted MRN: '6029015'
[14:55:18] ℹ️  Final extracted Sex: 'FEMALE'
[14:55:18] ℹ️  Final extracted Service Line: 'PT'
[14:55:18] ℹ️  Final extracted Payer Source: 'Medicare'
[14:55:18] ✅ Patient data extraction completed successfully
[14:55:18] ✅    ✅ Patient data extracted successfully
[14:55:18] 📊 Patient Response
     └─ patientFName: Michele
     └─ patientLName: Santos
     └─ dob: 06/08/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6029015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:18] ✅    ✅ Patient identified: Michele Santos
[14:55:18] ✅    ✅ Patient name validation passed
[14:55:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:18] [DOC: 9227675] ℹ️  DOB normalized: 06/08/1959
[14:55:18] [DOC: 9227675] ℹ️  Episode startOfCare normalized: 03/06/2025
[14:55:18] [DOC: 9227675] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[14:55:18] [DOC: 9227675] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[14:55:18] [DOC: 9227675] ✅ Patient date processing completed successfully
[14:55:18] ✅    ✅ Date processing completed
[14:55:18] 📊 Processed Patient Data
     └─ patientFName: Michele
     └─ patientLName: Santos
     └─ dob: 06/08/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6029015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:18] 🔄 
🔄 Step 4: Extracting order data...
[14:55:20] ℹ️  Order extraction - MRN: ''
[14:55:20] ℹ️  Order extraction - Sex: 'FEMALE'
[14:55:20] ℹ️  Order extraction - Service Line: 'PT'
[14:55:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:20] ✅ Order data extraction completed successfully
[14:55:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:20] ℹ️  Using MRN from patient data: '6029015'
[14:55:20] ℹ️  Service line consistent in both sources: 'PT'
[14:55:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:20] ✅ Patient name cross-validation successful
[14:55:20] ✅    ✅ Data merged successfully
[14:55:21] ✅    ✅ Order data extracted and validated
[14:55:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:38] [DOC: 9227675] ℹ️  Patient not found in cache or API: Michele Santos
[14:55:38] [DOC: 9227675] ℹ️  Patient not found, creating new patient via API...
[14:55:38] [DOC: 9227675] ℹ️  Creating patient via API: Michele Santos
[14:55:39] [DOC: 9227675] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:55:39] ❌    ❌ Failed to create patient
[14:55:39] [DOC: 9227675] ℹ️  API push details saved for document 9227675
================================================================================
║                        Processing Document ID: 9227672                         ║
================================================================================
[14:55:39] ℹ️  Agency: Dartmouth HH
[14:55:39] ℹ️  Date: 04/08/2025
[14:55:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:42] [DOC: 9227672] ✅ Text extracted using pdfplumber (4763 chars)
[14:55:42] ✅    ✅ Text extracted using pdfplumber (4763 chars)
[14:55:42] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:44] ℹ️  AI extracted raw sex value: 'F'
[14:55:44] ℹ️  AI extracted service line: 'Physical Therapy'
[14:55:44] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[14:55:44] ℹ️  AI extracted diagnoses:
[14:55:44] ℹ️    - Diagnosis 1: ''
[14:55:44] ℹ️    - Diagnosis 2: ''
[14:55:44] ℹ️    - Diagnosis 3: ''
[14:55:44] ℹ️    - Diagnosis 4: ''
[14:55:44] ℹ️    - Diagnosis 5: ''
[14:55:44] ℹ️    - Diagnosis 6: ''
[14:55:44] ℹ️  Final extracted MRN: '667011'
[14:55:44] ℹ️  Final extracted Sex: 'FEMALE'
[14:55:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:55:44] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[14:55:44] ✅ Patient data extraction completed successfully
[14:55:44] ✅    ✅ Patient data extracted successfully
[14:55:44] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:44] ✅    ✅ Patient identified: Linda Hotte
[14:55:44] ✅    ✅ Patient name validation passed
[14:55:44] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:44] [DOC: 9227672] ℹ️  DOB normalized: 09/14/1952
[14:55:44] [DOC: 9227672] ℹ️  Episode startOfCare normalized: 02/23/2025
[14:55:44] [DOC: 9227672] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[14:55:44] [DOC: 9227672] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[14:55:44] [DOC: 9227672] ✅ Patient date processing completed successfully
[14:55:44] ✅    ✅ Date processing completed
[14:55:44] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:44] 🔄 
🔄 Step 4: Extracting order data...
[14:55:47] ℹ️  Order extraction - MRN: ''
[14:55:47] ℹ️  Order extraction - Sex: 'FEMALE'
[14:55:47] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:55:47] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[14:55:47] ✅ Order data extraction completed successfully
[14:55:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:47] ℹ️  Using MRN from patient data: '667011'
[14:55:47] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:55:47] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[14:55:47] ✅ Patient name cross-validation successful
[14:55:47] ✅    ✅ Data merged successfully
[14:55:48] ✅    ✅ Order data extracted and validated
[14:55:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:56:14] [DOC: 9227672] ℹ️  Patient not found in cache or API: Linda Hotte
[14:56:14] [DOC: 9227672] ℹ️  Patient not found, creating new patient via API...
[14:56:14] [DOC: 9227672] ℹ️  Creating patient via API: Linda Hotte
[14:56:16] [DOC: 9227672] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:56:16] ❌    ❌ Failed to create patient
[14:56:16] [DOC: 9227672] ℹ️  API push details saved for document 9227672
================================================================================
║                        Processing Document ID: 9227671                         ║
================================================================================
[14:56:16] ℹ️  Agency: Dartmouth HH
[14:56:16] ℹ️  Date: 04/08/2025
[14:56:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:18] [DOC: 9227671] ✅ Text extracted using pdfplumber (1089 chars)
[14:56:18] ✅    ✅ Text extracted using pdfplumber (1089 chars)
[14:56:18] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:21] ℹ️  AI extracted raw sex value: 'F'
[14:56:21] ℹ️  AI extracted service line: 'OT, HHA'
[14:56:21] ℹ️  AI extracted payer source: 'Medicare'
[14:56:21] ℹ️  AI extracted diagnoses:
[14:56:21] ℹ️    - Diagnosis 1: ''
[14:56:21] ℹ️    - Diagnosis 2: ''
[14:56:21] ℹ️    - Diagnosis 3: ''
[14:56:21] ℹ️    - Diagnosis 4: ''
[14:56:21] ℹ️    - Diagnosis 5: ''
[14:56:21] ℹ️    - Diagnosis 6: ''
[14:56:21] ℹ️  Final extracted MRN: '6203015'
[14:56:21] ℹ️  Final extracted Sex: 'FEMALE'
[14:56:21] ℹ️  Final extracted Service Line: 'OT, HHA'
[14:56:21] ℹ️  Final extracted Payer Source: 'Medicare'
[14:56:21] ✅ Patient data extraction completed successfully
[14:56:21] ✅    ✅ Patient data extracted successfully
[14:56:21] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Lemieux
     └─ dob: 06/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6203015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 850 Pleasant Street Apt 423
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:56:21] ✅    ✅ Patient identified: Sylvia Lemieux
[14:56:21] ✅    ✅ Patient name validation passed
[14:56:21] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:21] [DOC: 9227671] ℹ️  DOB normalized: 06/08/1941
[14:56:21] [DOC: 9227671] ℹ️  Episode startOfCare normalized: 03/14/2025
[14:56:21] [DOC: 9227671] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[14:56:21] [DOC: 9227671] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[14:56:21] [DOC: 9227671] ✅ Patient date processing completed successfully
[14:56:21] ✅    ✅ Date processing completed
[14:56:21] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Lemieux
     └─ dob: 06/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6203015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 850 Pleasant Street Apt 423
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:56:21] 🔄 
🔄 Step 4: Extracting order data...
[14:56:23] ℹ️  Order extraction - MRN: ''
[14:56:23] ℹ️  Order extraction - Sex: 'FEMALE'
[14:56:23] ℹ️  Order extraction - Service Line: 'HHA'
[14:56:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:56:23] ✅ Order data extraction completed successfully
[14:56:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:23] ℹ️  Using MRN from patient data: '6203015'
[14:56:23] ℹ️  Combined service lines: Patient='OT, HHA' + Order='HHA' = 'HHA, OT'
[14:56:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:56:23] ✅ Patient name cross-validation successful
[14:56:23] ✅    ✅ Data merged successfully
[14:56:25] ✅    ✅ Order data extracted and validated
[14:56:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:56:33] [DOC: 9227671] ℹ️  Patient not found in cache or API: Sylvia Lemieux
[14:56:33] [DOC: 9227671] ℹ️  Patient not found, creating new patient via API...
[14:56:33] [DOC: 9227671] ℹ️  Creating patient via API: Sylvia Lemieux
[14:56:34] [DOC: 9227671] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:56:34] ❌    ❌ Failed to create patient
[14:56:34] [DOC: 9227671] ℹ️  API push details saved for document 9227671
================================================================================
║                        Processing Document ID: 9227668                         ║
================================================================================
[14:56:34] ℹ️  Agency: Dartmouth HH
[14:56:34] ℹ️  Date: 04/08/2025
[14:56:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:36] [DOC: 9227668] ✅ Text extracted using pdfplumber (2002 chars)
[14:56:36] ✅    ✅ Text extracted using pdfplumber (2002 chars)
[14:56:36] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:39] ℹ️  AI extracted raw sex value: 'F'
[14:56:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:56:39] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[14:56:39] ℹ️  AI extracted diagnoses:
[14:56:39] ℹ️    - Diagnosis 1: ''
[14:56:39] ℹ️    - Diagnosis 2: ''
[14:56:39] ℹ️    - Diagnosis 3: ''
[14:56:39] ℹ️    - Diagnosis 4: ''
[14:56:39] ℹ️    - Diagnosis 5: ''
[14:56:39] ℹ️    - Diagnosis 6: ''
[14:56:39] ℹ️  Final extracted MRN: '6201015'
[14:56:39] ℹ️  Final extracted Sex: 'FEMALE'
[14:56:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:56:39] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[14:56:39] ✅ Patient data extraction completed successfully
[14:56:39] ✅    ✅ Patient data extracted successfully
[14:56:39] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:56:39] ✅    ✅ Patient identified: Maria Laborinho
[14:56:39] ✅    ✅ Patient name validation passed
[14:56:39] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:39] [DOC: 9227668] ℹ️  DOB normalized: 02/08/1951
[14:56:39] [DOC: 9227668] ℹ️  Episode startOfCare normalized: 03/13/2025
[14:56:39] [DOC: 9227668] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[14:56:39] [DOC: 9227668] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[14:56:39] [DOC: 9227668] ✅ Patient date processing completed successfully
[14:56:39] ✅    ✅ Date processing completed
[14:56:39] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:56:39] 🔄 
🔄 Step 4: Extracting order data...
[14:56:41] ℹ️  Order extraction - MRN: ''
[14:56:41] ℹ️  Order extraction - Sex: 'FEMALE'
[14:56:41] ℹ️  Order extraction - Service Line: 'RN'
[14:56:41] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[14:56:41] ✅ Order data extraction completed successfully
[14:56:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:41] ℹ️  Using MRN from patient data: '6201015'
[14:56:41] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[14:56:41] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[14:56:41] ✅ Patient name cross-validation successful
[14:56:41] ✅    ✅ Data merged successfully
[14:56:43] ✅    ✅ Order data extracted and validated
[14:56:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:56:49] [DOC: 9227668] ℹ️  Patient not found in cache or API: Maria Laborinho
[14:56:49] [DOC: 9227668] ℹ️  Patient not found, creating new patient via API...
[14:56:49] [DOC: 9227668] ℹ️  Creating patient via API: Maria Laborinho
[14:56:50] [DOC: 9227668] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:56:50] ❌    ❌ Failed to create patient
[14:56:50] [DOC: 9227668] ℹ️  API push details saved for document 9227668
================================================================================
║                        Processing Document ID: 9227666                         ║
================================================================================
[14:56:50] ℹ️  Agency: Dartmouth HH
[14:56:50] ℹ️  Date: 04/08/2025
[14:56:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:52] [DOC: 9227666] ✅ Text extracted using pdfplumber (1847 chars)
[14:56:52] ✅    ✅ Text extracted using pdfplumber (1847 chars)
[14:56:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:54] ℹ️  AI extracted raw sex value: 'F'
[14:56:54] ℹ️  AI extracted service line: 'PT'
[14:56:54] ℹ️  AI extracted payer source: 'Medicare'
[14:56:54] ℹ️  AI extracted diagnoses:
[14:56:54] ℹ️    - Diagnosis 1: 'None'
[14:56:54] ℹ️    - Diagnosis 2: 'None'
[14:56:54] ℹ️    - Diagnosis 3: 'None'
[14:56:54] ℹ️    - Diagnosis 4: 'None'
[14:56:54] ℹ️    - Diagnosis 5: 'None'
[14:56:54] ℹ️    - Diagnosis 6: 'None'
[14:56:54] ℹ️  Final extracted MRN: '5811015'
[14:56:54] ℹ️  Final extracted Sex: 'FEMALE'
[14:56:54] ℹ️  Final extracted Service Line: 'PT'
[14:56:54] ℹ️  Final extracted Payer Source: 'Medicare'
[14:56:54] ✅ Patient data extraction completed successfully
[14:56:54] ✅    ✅ Patient data extracted successfully
[14:56:54] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Ostler
     └─ dob: 12/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5811015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/11/2025', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:56:54] ✅    ✅ Patient identified: Judith Ostler
[14:56:54] ✅    ✅ Patient name validation passed
[14:56:54] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:54] [DOC: 9227666] ℹ️  DOB normalized: 12/28/1942
[14:56:54] [DOC: 9227666] ℹ️  Episode startOfCare normalized: 02/11/2025
[14:56:54] [DOC: 9227666] ℹ️  Episode startOfEpisode normalized: 02/11/2025
[14:56:54] [DOC: 9227666] ℹ️  Episode endOfEpisode normalized: 04/11/2025
[14:56:54] [DOC: 9227666] ✅ Patient date processing completed successfully
[14:56:54] ✅    ✅ Date processing completed
[14:56:54] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Ostler
     └─ dob: 12/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5811015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/11/2025', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025'}]
[14:56:54] 🔄 
🔄 Step 4: Extracting order data...
[14:56:57] ℹ️  Order extraction - MRN: ''
[14:56:57] ℹ️  Order extraction - Sex: 'FEMALE'
[14:56:57] ℹ️  Order extraction - Service Line: 'PT'
[14:56:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:56:57] ✅ Order data extraction completed successfully
[14:56:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:57] ℹ️  Using MRN from patient data: '5811015'
[14:56:57] ℹ️  Service line consistent in both sources: 'PT'
[14:56:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:56:57] ✅ Patient name cross-validation successful
[14:56:57] ✅    ✅ Data merged successfully
[14:56:58] ✅    ✅ Order data extracted and validated
[14:56:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:14] [DOC: 9227666] ✅ Patient exists in API: Judith Ostler, ID: 28827423-cd3d-4c01-a205-c6ff32e90080
[14:57:14] ✅    ✅ Existing patient found with ID: 28827423-cd3d-4c01-a205-c6ff32e90080
[14:57:14] 🔄 
🔄 Step 6: Pushing order to API...
[14:57:14] [DOC: 9227666] ℹ️  Pushing order via API for patient ID: 28827423-cd3d-4c01-a205-c6ff32e90080
[14:57:15] [DOC: 9227666] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12967"}
[14:57:15] ❌    ❌ Failed to push order
[14:57:15] 🔄 
🔄 Step 7: Writing to CSV...
[14:57:15] [DOC: 9227666] ℹ️  Calculated age: 82 from DOB: 12/28/1942
[14:57:15] [DOC: 9227666] ℹ️  Service Line extracted: 'PT'
[14:57:15] [DOC: 9227666] ℹ️  Payer Source extracted: 'Medicare'
[14:57:15] [DOC: 9227666] ℹ️  Diagnosis codes being written:
[14:57:15] [DOC: 9227666] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:57:15] [DOC: 9227666] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:57:15] [DOC: 9227666] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:57:15] [DOC: 9227666] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:57:15] [DOC: 9227666] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:57:15] [DOC: 9227666] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:57:15] [DOC: 9227666] ✅ Patient data written to CSV: Judith Ostler | Sex: FEMALE | Age: 82 | Service: PT | Payer: Medicare | MRN: 5811015
[14:57:15] ✅    ✅ Document 9227666 processed and saved successfully
[14:57:15] 🔄 
🔄 Step 8: Saving API details...
[14:57:15] [DOC: 9227666] ℹ️  API push details saved for document 9227666
[14:57:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227661                         ║
================================================================================
[14:57:15] ℹ️  Agency: Dartmouth HH
[14:57:15] ℹ️  Date: 04/08/2025
[14:57:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:18] [DOC: 9227661] ✅ Text extracted using pdfplumber (7496 chars)
[14:57:18] ✅    ✅ Text extracted using pdfplumber (7496 chars)
[14:57:18] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:21] ℹ️  AI extracted raw sex value: 'F'
[14:57:21] ℹ️  AI extracted service line: 'SN, PT, OT'
[14:57:21] ℹ️  AI extracted payer source: 'Medicare'
[14:57:21] ℹ️  AI extracted diagnoses:
[14:57:21] ℹ️    - Diagnosis 1: 'I49.5'
[14:57:21] ℹ️    - Diagnosis 2: 'D63.1'
[14:57:21] ℹ️    - Diagnosis 3: 'N18.31'
[14:57:21] ℹ️    - Diagnosis 4: 'I10'
[14:57:21] ℹ️    - Diagnosis 5: ''
[14:57:21] ℹ️    - Diagnosis 6: ''
[14:57:21] ℹ️  Final extracted MRN: '672008'
[14:57:21] ℹ️  Final extracted Sex: 'FEMALE'
[14:57:21] ℹ️  Final extracted Service Line: 'SN, PT, OT'
[14:57:21] ℹ️  Final extracted Payer Source: 'Medicare'
[14:57:21] ✅ Patient data extraction completed successfully
[14:57:21] ✅    ✅ Patient data extracted successfully
[14:57:21] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: SN, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I49.5', 'secondDiagnosis': 'D63.1', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:21] ✅    ✅ Patient identified: Jane Lonsdale
[14:57:21] ✅    ✅ Patient name validation passed
[14:57:21] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:21] [DOC: 9227661] ℹ️  DOB normalized: 02/20/1930
[14:57:21] [DOC: 9227661] ℹ️  Episode startOfCare normalized: 03/09/2025
[14:57:21] [DOC: 9227661] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[14:57:21] [DOC: 9227661] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[14:57:21] [DOC: 9227661] ✅ Patient date processing completed successfully
[14:57:21] ✅    ✅ Date processing completed
[14:57:21] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: SN, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'I49.5', 'secondDiagnosis': 'D63.1', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:21] 🔄 
🔄 Step 4: Extracting order data...
[14:57:23] ℹ️  Order extraction - MRN: ''
[14:57:23] ℹ️  Order extraction - Sex: 'FEMALE'
[14:57:23] ℹ️  Order extraction - Service Line: 'SN, PT, OT'
[14:57:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:57:23] ✅ Order data extraction completed successfully
[14:57:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:57:23] ℹ️  Using MRN from patient data: '672008'
[14:57:23] ℹ️  Service line consistent in both sources: 'SN, PT, OT'
[14:57:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:57:23] ✅ Patient name cross-validation successful
[14:57:23] ✅    ✅ Data merged successfully
[14:57:25] ✅    ✅ Order data extracted and validated
[14:57:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:30] [DOC: 9227661] ℹ️  Patient not found in cache or API: Jane Lonsdale
[14:57:30] [DOC: 9227661] ℹ️  Patient not found, creating new patient via API...
[14:57:30] [DOC: 9227661] ℹ️  Creating patient via API: Jane Lonsdale
[14:57:32] [DOC: 9227661] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:57:32] ❌    ❌ Failed to create patient
[14:57:32] [DOC: 9227661] ℹ️  API push details saved for document 9227661
================================================================================
║                        Processing Document ID: 9227648                         ║
================================================================================
[14:57:32] ℹ️  Agency: Dartmouth HH
[14:57:32] ℹ️  Date: 04/08/2025
[14:57:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:35] [DOC: 9227648] ✅ Text extracted using pdfplumber (7522 chars)
[14:57:35] ✅    ✅ Text extracted using pdfplumber (7522 chars)
[14:57:35] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:38] ℹ️  AI extracted raw sex value: 'M'
[14:57:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:57:38] ℹ️  AI extracted payer source: 'Medicare'
[14:57:38] ℹ️  AI extracted diagnoses:
[14:57:38] ℹ️    - Diagnosis 1: ''
[14:57:38] ℹ️    - Diagnosis 2: ''
[14:57:38] ℹ️    - Diagnosis 3: ''
[14:57:38] ℹ️    - Diagnosis 4: ''
[14:57:38] ℹ️    - Diagnosis 5: ''
[14:57:38] ℹ️    - Diagnosis 6: ''
[14:57:38] ℹ️  Final extracted MRN: '2496015'
[14:57:38] ℹ️  Final extracted Sex: 'MALE'
[14:57:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:57:38] ℹ️  Final extracted Payer Source: 'Medicare'
[14:57:38] ✅ Patient data extraction completed successfully
[14:57:38] ✅    ✅ Patient data extracted successfully
[14:57:38] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:38] ✅    ✅ Patient identified: Dana Theodore
[14:57:38] ✅    ✅ Patient name validation passed
[14:57:38] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:38] [DOC: 9227648] ℹ️  DOB normalized: 03/16/1954
[14:57:38] [DOC: 9227648] ℹ️  Episode startOfCare normalized: 03/02/2025
[14:57:38] [DOC: 9227648] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[14:57:38] [DOC: 9227648] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[14:57:38] [DOC: 9227648] ✅ Patient date processing completed successfully
[14:57:38] ✅    ✅ Date processing completed
[14:57:38] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:38] 🔄 
🔄 Step 4: Extracting order data...
[14:57:40] ℹ️  Order extraction - MRN: '2496015'
[14:57:40] ℹ️  Order extraction - Sex: 'MALE'
[14:57:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:57:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:57:40] ✅ Order data extraction completed successfully
[14:57:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:57:40] ℹ️  Using MRN from patient data: '2496015' over '2496015'
[14:57:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:57:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:57:40] ✅ Patient name cross-validation successful
[14:57:40] ✅    ✅ Data merged successfully
[14:57:41] ✅    ✅ Order data extracted and validated
[14:57:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:41] [DOC: 9227648] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[14:57:41] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[14:57:41] 🔄 
🔄 Step 6: Pushing order to API...
[14:57:41] [DOC: 9227648] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[14:57:43] [DOC: 9227648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:57:43] ❌    ❌ Failed to push order
[14:57:43] 🔄 
🔄 Step 7: Writing to CSV...
[14:57:43] [DOC: 9227648] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[14:57:43] [DOC: 9227648] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:57:43] [DOC: 9227648] ℹ️  Payer Source extracted: 'Medicare'
[14:57:43] [DOC: 9227648] ℹ️  Diagnosis codes being written:
[14:57:43] [DOC: 9227648] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:57:43] [DOC: 9227648] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:57:43] [DOC: 9227648] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:57:43] [DOC: 9227648] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:57:43] [DOC: 9227648] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:57:43] [DOC: 9227648] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:57:43] [DOC: 9227648] ✅ Patient data written to CSV: Dana Theodore | Sex: MALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[14:57:43] ✅    ✅ Document 9227648 processed and saved successfully
[14:57:43] 🔄 
🔄 Step 8: Saving API details...
[14:57:43] [DOC: 9227648] ℹ️  API push details saved for document 9227648
[14:57:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227645                         ║
================================================================================
[14:57:43] ℹ️  Agency: Dartmouth HH
[14:57:43] ℹ️  Date: 04/08/2025
[14:57:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:45] [DOC: 9227645] ✅ Text extracted using pdfplumber (1711 chars)
[14:57:45] ✅    ✅ Text extracted using pdfplumber (1711 chars)
[14:57:45] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:48] ℹ️  AI extracted raw sex value: 'F'
[14:57:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:57:48] ℹ️  AI extracted payer source: 'Senior Whole Health'
[14:57:48] ℹ️  AI extracted diagnoses:
[14:57:48] ℹ️    - Diagnosis 1: 'None'
[14:57:48] ℹ️    - Diagnosis 2: 'None'
[14:57:48] ℹ️    - Diagnosis 3: 'None'
[14:57:48] ℹ️    - Diagnosis 4: 'None'
[14:57:48] ℹ️    - Diagnosis 5: 'None'
[14:57:48] ℹ️    - Diagnosis 6: 'None'
[14:57:48] ℹ️  Final extracted MRN: '3177001'
[14:57:48] ℹ️  Final extracted Sex: 'FEMALE'
[14:57:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:57:48] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[14:57:48] ✅ Patient data extraction completed successfully
[14:57:48] ✅    ✅ Patient data extracted successfully
[14:57:48] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 68 Chancery Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:57:48] ✅    ✅ Patient identified: Dorothy Lynch
[14:57:48] ✅    ✅ Patient name validation passed
[14:57:48] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:48] [DOC: 9227645] ℹ️  DOB normalized: 03/16/1932
[14:57:48] [DOC: 9227645] ℹ️  Episode startOfCare normalized: 03/12/2025
[14:57:48] [DOC: 9227645] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[14:57:48] [DOC: 9227645] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[14:57:48] [DOC: 9227645] ✅ Patient date processing completed successfully
[14:57:48] ✅    ✅ Date processing completed
[14:57:48] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 68 Chancery Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025'}]
[14:57:48] 🔄 
🔄 Step 4: Extracting order data...
[14:57:50] ℹ️  Order extraction - MRN: ''
[14:57:50] ℹ️  Order extraction - Sex: 'FEMALE'
[14:57:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:57:50] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[14:57:50] ✅ Order data extraction completed successfully
[14:57:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:57:50] ℹ️  Using MRN from patient data: '3177001'
[14:57:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:57:50] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[14:57:50] ✅ Patient name cross-validation successful
[14:57:50] ✅    ✅ Data merged successfully
[14:57:51] ✅    ✅ Order data extracted and validated
[14:57:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:51] [DOC: 9227645] ✅ Patient found in local cache: Dorothy Lynch, ID: d21b3eef-f066-47f0-b26e-3663176af82f
[14:57:51] ✅    ✅ Existing patient found with ID: d21b3eef-f066-47f0-b26e-3663176af82f
[14:57:51] 🔄 
🔄 Step 6: Pushing order to API...
[14:57:51] [DOC: 9227645] ℹ️  Pushing order via API for patient ID: d21b3eef-f066-47f0-b26e-3663176af82f
[14:57:53] [DOC: 9227645] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13997"}
[14:57:53] ❌    ❌ Failed to push order
[14:57:53] 🔄 
🔄 Step 7: Writing to CSV...
[14:57:53] [DOC: 9227645] ℹ️  Calculated age: 93 from DOB: 03/16/1932
[14:57:53] [DOC: 9227645] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:57:53] [DOC: 9227645] ℹ️  Payer Source extracted: 'Senior Whole Health'
[14:57:53] [DOC: 9227645] ℹ️  Diagnosis codes being written:
[14:57:53] [DOC: 9227645] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:57:53] [DOC: 9227645] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:57:53] [DOC: 9227645] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:57:53] [DOC: 9227645] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:57:53] [DOC: 9227645] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:57:53] [DOC: 9227645] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:57:53] [DOC: 9227645] ✅ Patient data written to CSV: Dorothy Lynch | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer: Senior Whole Health | MRN: 3177001
[14:57:53] ✅    ✅ Document 9227645 processed and saved successfully
[14:57:53] 🔄 
🔄 Step 8: Saving API details...
[14:57:53] [DOC: 9227645] ℹ️  API push details saved for document 9227645
[14:57:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227642                         ║
================================================================================
[14:57:53] ℹ️  Agency: Dartmouth HH
[14:57:53] ℹ️  Date: 04/08/2025
[14:57:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:55] [DOC: 9227642] ✅ Text extracted using pdfplumber (4003 chars)
[14:57:55] ✅    ✅ Text extracted using pdfplumber (4003 chars)
[14:57:55] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:58] ℹ️  AI extracted raw sex value: 'M'
[14:57:58] ℹ️  AI extracted service line: 'MSW'
[14:57:58] ℹ️  AI extracted payer source: 'Medicare'
[14:57:58] ℹ️  AI extracted diagnoses:
[14:57:58] ℹ️    - Diagnosis 1: 'None'
[14:57:58] ℹ️    - Diagnosis 2: 'None'
[14:57:58] ℹ️    - Diagnosis 3: 'None'
[14:57:58] ℹ️    - Diagnosis 4: 'None'
[14:57:58] ℹ️    - Diagnosis 5: 'None'
[14:57:58] ℹ️    - Diagnosis 6: 'None'
[14:57:58] ℹ️  Final extracted MRN: '6164015'
[14:57:58] ℹ️  Final extracted Sex: 'MALE'
[14:57:58] ℹ️  Final extracted Service Line: 'MSW'
[14:57:58] ℹ️  Final extracted Payer Source: 'Medicare'
[14:57:58] ✅ Patient data extraction completed successfully
[14:57:58] ✅    ✅ Patient data extracted successfully
[14:57:58] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Lucas
     └─ dob: 08/18/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 6164015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/16/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:57:58] ✅    ✅ Patient identified: William Lucas
[14:57:58] ✅    ✅ Patient name validation passed
[14:57:58] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:58] [DOC: 9227642] ℹ️  DOB normalized: 08/18/1951
[14:57:58] [DOC: 9227642] ℹ️  Episode startOfCare normalized: 03/16/2025
[14:57:58] [DOC: 9227642] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[14:57:58] [DOC: 9227642] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[14:57:58] [DOC: 9227642] ✅ Patient date processing completed successfully
[14:57:58] ✅    ✅ Date processing completed
[14:57:58] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Lucas
     └─ dob: 08/18/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 6164015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/16/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025'}]
[14:57:58] 🔄 
🔄 Step 4: Extracting order data...
[14:58:00] ℹ️  Order extraction - MRN: ''
[14:58:00] ℹ️  Order extraction - Sex: 'MALE'
[14:58:00] ℹ️  Order extraction - Service Line: 'MSW'
[14:58:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:58:00] ✅ Order data extraction completed successfully
[14:58:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:00] ℹ️  Using MRN from patient data: '6164015'
[14:58:00] ℹ️  Service line consistent in both sources: 'MSW'
[14:58:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:58:00] ✅ Patient name cross-validation successful
[14:58:00] ✅    ✅ Data merged successfully
[14:58:01] ✅    ✅ Order data extracted and validated
[14:58:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:07] [DOC: 9227642] ✅ Patient exists in API: William Lucas, ID: 8fb7a78f-8284-4d97-97aa-c9a23c11add9
[14:58:07] ✅    ✅ Existing patient found with ID: 8fb7a78f-8284-4d97-97aa-c9a23c11add9
[14:58:07] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:07] [DOC: 9227642] ℹ️  Pushing order via API for patient ID: 8fb7a78f-8284-4d97-97aa-c9a23c11add9
[14:58:09] [DOC: 9227642] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:58:09] ❌    ❌ Failed to push order
[14:58:09] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:09] [DOC: 9227642] ℹ️  Calculated age: 73 from DOB: 08/18/1951
[14:58:09] [DOC: 9227642] ℹ️  Service Line extracted: 'MSW'
[14:58:09] [DOC: 9227642] ℹ️  Payer Source extracted: 'Medicare'
[14:58:09] [DOC: 9227642] ℹ️  Diagnosis codes being written:
[14:58:09] [DOC: 9227642] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:09] [DOC: 9227642] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:09] [DOC: 9227642] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:09] [DOC: 9227642] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:09] [DOC: 9227642] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:09] [DOC: 9227642] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:09] [DOC: 9227642] ✅ Patient data written to CSV: William Lucas | Sex: MALE | Age: 73 | Service: MSW | Payer: Medicare | MRN: 6164015
[14:58:09] ✅    ✅ Document 9227642 processed and saved successfully
[14:58:09] 🔄 
🔄 Step 8: Saving API details...
[14:58:09] [DOC: 9227642] ℹ️  API push details saved for document 9227642
[14:58:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227640                         ║
================================================================================
[14:58:09] ℹ️  Agency: Dartmouth HH
[14:58:09] ℹ️  Date: 04/08/2025
[14:58:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:10] [DOC: 9227640] ✅ Text extracted using pdfplumber (1356 chars)
[14:58:10] ✅    ✅ Text extracted using pdfplumber (1356 chars)
[14:58:10] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:13] ℹ️  AI extracted raw sex value: 'F'
[14:58:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:58:13] ℹ️  AI extracted payer source: 'Medicare'
[14:58:13] ℹ️  AI extracted diagnoses:
[14:58:13] ℹ️    - Diagnosis 1: 'None'
[14:58:13] ℹ️    - Diagnosis 2: 'None'
[14:58:13] ℹ️    - Diagnosis 3: 'None'
[14:58:13] ℹ️    - Diagnosis 4: 'None'
[14:58:13] ℹ️    - Diagnosis 5: 'None'
[14:58:13] ℹ️    - Diagnosis 6: 'None'
[14:58:13] ℹ️  Final extracted MRN: '5094015'
[14:58:13] ℹ️  Final extracted Sex: 'FEMALE'
[14:58:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:58:13] ℹ️  Final extracted Payer Source: 'Medicare'
[14:58:13] ✅ Patient data extraction completed successfully
[14:58:13] ✅    ✅ Patient data extracted successfully
[14:58:13] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:58:13] ✅    ✅ Patient identified: Laura Gregoire
[14:58:13] ✅    ✅ Patient name validation passed
[14:58:13] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:13] [DOC: 9227640] ℹ️  DOB normalized: 12/06/1944
[14:58:13] [DOC: 9227640] ℹ️  Episode startOfCare normalized: 08/26/2024
[14:58:13] [DOC: 9227640] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[14:58:13] [DOC: 9227640] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[14:58:13] [DOC: 9227640] ✅ Patient date processing completed successfully
[14:58:13] ✅    ✅ Date processing completed
[14:58:13] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025'}]
[14:58:13] 🔄 
🔄 Step 4: Extracting order data...
[14:58:16] ℹ️  Order extraction - MRN: ''
[14:58:16] ℹ️  Order extraction - Sex: 'FEMALE'
[14:58:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:58:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:58:16] ✅ Order data extraction completed successfully
[14:58:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:16] ℹ️  Using MRN from patient data: '5094015'
[14:58:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:58:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:58:16] ✅ Patient name cross-validation successful
[14:58:16] ✅    ✅ Data merged successfully
[14:58:17] ✅    ✅ Order data extracted and validated
[14:58:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:17] [DOC: 9227640] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[14:58:17] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[14:58:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:17] [DOC: 9227640] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[14:58:18] [DOC: 9227640] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:58:18] ❌    ❌ Failed to push order
[14:58:18] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:18] [DOC: 9227640] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[14:58:18] [DOC: 9227640] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:58:18] [DOC: 9227640] ℹ️  Payer Source extracted: 'Medicare'
[14:58:18] [DOC: 9227640] ℹ️  Diagnosis codes being written:
[14:58:18] [DOC: 9227640] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:18] [DOC: 9227640] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:18] [DOC: 9227640] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:18] [DOC: 9227640] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:18] [DOC: 9227640] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:18] [DOC: 9227640] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:18] [DOC: 9227640] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 5094015
[14:58:18] ✅    ✅ Document 9227640 processed and saved successfully
[14:58:18] 🔄 
🔄 Step 8: Saving API details...
[14:58:18] [DOC: 9227640] ℹ️  API push details saved for document 9227640
[14:58:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227638                         ║
================================================================================
[14:58:18] ℹ️  Agency: Dartmouth HH
[14:58:18] ℹ️  Date: 04/08/2025
[14:58:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:20] [DOC: 9227638] ✅ Text extracted using pdfplumber (1087 chars)
[14:58:20] ✅    ✅ Text extracted using pdfplumber (1087 chars)
[14:58:20] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:23] ℹ️  AI extracted raw sex value: 'F'
[14:58:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:58:23] ℹ️  AI extracted payer source: 'Medicare'
[14:58:23] ℹ️  AI extracted diagnoses:
[14:58:23] ℹ️    - Diagnosis 1: ''
[14:58:23] ℹ️    - Diagnosis 2: ''
[14:58:23] ℹ️    - Diagnosis 3: ''
[14:58:23] ℹ️    - Diagnosis 4: ''
[14:58:23] ℹ️    - Diagnosis 5: ''
[14:58:23] ℹ️    - Diagnosis 6: ''
[14:58:23] ℹ️  Final extracted MRN: '1341002'
[14:58:23] ℹ️  Final extracted Sex: 'FEMALE'
[14:58:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:58:23] ℹ️  Final extracted Payer Source: 'Medicare'
[14:58:23] ✅ Patient data extraction completed successfully
[14:58:23] ✅    ✅ Patient data extracted successfully
[14:58:23] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Lafleur
     └─ dob: 12/14/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1341002
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 3299 Acushnet Avenue APT 16
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:23] ✅    ✅ Patient identified: Patricia Lafleur
[14:58:23] ✅    ✅ Patient name validation passed
[14:58:23] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:23] [DOC: 9227638] ℹ️  DOB normalized: 12/14/1956
[14:58:23] [DOC: 9227638] ℹ️  Episode startOfCare normalized: 03/19/2025
[14:58:23] [DOC: 9227638] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[14:58:23] [DOC: 9227638] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[14:58:23] [DOC: 9227638] ✅ Patient date processing completed successfully
[14:58:23] ✅    ✅ Date processing completed
[14:58:23] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Lafleur
     └─ dob: 12/14/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1341002
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 3299 Acushnet Avenue APT 16
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:23] 🔄 
🔄 Step 4: Extracting order data...
[14:58:25] ℹ️  Order extraction - MRN: ''
[14:58:25] ℹ️  Order extraction - Sex: 'FEMALE'
[14:58:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:58:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:58:25] ✅ Order data extraction completed successfully
[14:58:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:25] ℹ️  Using MRN from patient data: '1341002'
[14:58:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:58:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:58:25] ✅ Patient name cross-validation successful
[14:58:25] ✅    ✅ Data merged successfully
[14:58:26] ✅    ✅ Order data extracted and validated
[14:58:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:31] [DOC: 9227638] ✅ Patient exists in API: Patricia Lafleur, ID: 6fd97b99-f777-484b-99cc-adef33e61d6b
[14:58:31] ✅    ✅ Existing patient found with ID: 6fd97b99-f777-484b-99cc-adef33e61d6b
[14:58:31] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:31] [DOC: 9227638] ℹ️  Pushing order via API for patient ID: 6fd97b99-f777-484b-99cc-adef33e61d6b
[14:58:32] [DOC: 9227638] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:58:32] ❌    ❌ Failed to push order
[14:58:32] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:32] [DOC: 9227638] ℹ️  Calculated age: 68 from DOB: 12/14/1956
[14:58:32] [DOC: 9227638] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:58:32] [DOC: 9227638] ℹ️  Payer Source extracted: 'Medicare'
[14:58:32] [DOC: 9227638] ℹ️  Diagnosis codes being written:
[14:58:32] [DOC: 9227638] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:32] [DOC: 9227638] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:32] [DOC: 9227638] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:32] [DOC: 9227638] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:32] [DOC: 9227638] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:32] [DOC: 9227638] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:32] [DOC: 9227638] ✅ Patient data written to CSV: Patricia Lafleur | Sex: FEMALE | Age: 68 | Service: Skilled Nursing | Payer: Medicare | MRN: 1341002
[14:58:32] ✅    ✅ Document 9227638 processed and saved successfully
[14:58:32] 🔄 
🔄 Step 8: Saving API details...
[14:58:32] [DOC: 9227638] ℹ️  API push details saved for document 9227638
[14:58:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227636                         ║
================================================================================
[14:58:32] ℹ️  Agency: Dartmouth HH
[14:58:32] ℹ️  Date: 04/08/2025
[14:58:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:34] [DOC: 9227636] ✅ Text extracted using pdfplumber (1411 chars)
[14:58:34] ✅    ✅ Text extracted using pdfplumber (1411 chars)
[14:58:34] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:36] ℹ️  AI extracted raw sex value: 'F'
[14:58:36] ℹ️  AI extracted service line: 'PT'
[14:58:36] ℹ️  AI extracted payer source: 'Medicare'
[14:58:36] ℹ️  AI extracted diagnoses:
[14:58:36] ℹ️    - Diagnosis 1: ''
[14:58:36] ℹ️    - Diagnosis 2: ''
[14:58:36] ℹ️    - Diagnosis 3: ''
[14:58:36] ℹ️    - Diagnosis 4: ''
[14:58:36] ℹ️    - Diagnosis 5: ''
[14:58:36] ℹ️    - Diagnosis 6: ''
[14:58:36] ℹ️  Final extracted MRN: '5681015'
[14:58:36] ℹ️  Final extracted Sex: 'FEMALE'
[14:58:36] ℹ️  Final extracted Service Line: 'PT'
[14:58:36] ℹ️  Final extracted Payer Source: 'Medicare'
[14:58:36] ✅ Patient data extraction completed successfully
[14:58:36] ✅    ✅ Patient data extracted successfully
[14:58:36] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Almeida
     └─ dob: 11/01/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5681015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 125 Metropolitan St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:36] ✅    ✅ Patient identified: Janice Almeida
[14:58:36] ✅    ✅ Patient name validation passed
[14:58:36] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:36] [DOC: 9227636] ℹ️  DOB normalized: 11/01/1950
[14:58:36] [DOC: 9227636] ℹ️  Episode startOfCare normalized: 03/29/2025
[14:58:36] [DOC: 9227636] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[14:58:36] [DOC: 9227636] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[14:58:36] [DOC: 9227636] ✅ Patient date processing completed successfully
[14:58:36] ✅    ✅ Date processing completed
[14:58:36] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Almeida
     └─ dob: 11/01/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5681015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 125 Metropolitan St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:36] 🔄 
🔄 Step 4: Extracting order data...
[14:58:39] ℹ️  Order extraction - MRN: '5681015'
[14:58:39] ℹ️  Order extraction - Sex: 'FEMALE'
[14:58:39] ℹ️  Order extraction - Service Line: 'PT'
[14:58:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:58:39] ✅ Order data extraction completed successfully
[14:58:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:39] ℹ️  Using MRN from patient data: '5681015' over '5681015'
[14:58:39] ℹ️  Service line consistent in both sources: 'PT'
[14:58:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:58:39] ✅ Patient name cross-validation successful
[14:58:39] ✅    ✅ Data merged successfully
[14:58:40] ✅    ✅ Order data extracted and validated
[14:58:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:46] [DOC: 9227636] ℹ️  Patient not found in cache or API: Janice Almeida
[14:58:46] [DOC: 9227636] ℹ️  Patient not found, creating new patient via API...
[14:58:46] [DOC: 9227636] ℹ️  Creating patient via API: Janice Almeida
[14:58:47] [DOC: 9227636] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:58:47] ❌    ❌ Failed to create patient
[14:58:47] [DOC: 9227636] ℹ️  API push details saved for document 9227636
================================================================================
║                        Processing Document ID: 9227634                         ║
================================================================================
[14:58:47] ℹ️  Agency: Dartmouth HH
[14:58:47] ℹ️  Date: 04/08/2025
[14:58:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:48] [DOC: 9227634] ✅ Text extracted using pdfplumber (1273 chars)
[14:58:48] ✅    ✅ Text extracted using pdfplumber (1273 chars)
[14:58:48] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:51] ℹ️  AI extracted raw sex value: 'M'
[14:58:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:58:51] ℹ️  AI extracted payer source: 'Medicare'
[14:58:51] ℹ️  AI extracted diagnoses:
[14:58:51] ℹ️    - Diagnosis 1: ''
[14:58:51] ℹ️    - Diagnosis 2: ''
[14:58:51] ℹ️    - Diagnosis 3: ''
[14:58:51] ℹ️    - Diagnosis 4: ''
[14:58:51] ℹ️    - Diagnosis 5: ''
[14:58:51] ℹ️    - Diagnosis 6: ''
[14:58:51] ℹ️  Final extracted MRN: '3745015'
[14:58:51] ℹ️  Final extracted Sex: 'MALE'
[14:58:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:58:51] ℹ️  Final extracted Payer Source: 'Medicare'
[14:58:51] ✅ Patient data extraction completed successfully
[14:58:51] ✅    ✅ Patient data extracted successfully
[14:58:51] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:51] ✅    ✅ Patient identified: Stanley Waters
[14:58:51] ✅    ✅ Patient name validation passed
[14:58:51] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:51] [DOC: 9227634] ℹ️  DOB normalized: 08/19/1941
[14:58:51] [DOC: 9227634] ℹ️  Episode startOfCare normalized: 03/13/2025
[14:58:51] [DOC: 9227634] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[14:58:51] [DOC: 9227634] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[14:58:51] [DOC: 9227634] ✅ Patient date processing completed successfully
[14:58:51] ✅    ✅ Date processing completed
[14:58:51] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:51] 🔄 
🔄 Step 4: Extracting order data...
[14:58:53] ℹ️  Order extraction - MRN: '3745015'
[14:58:53] ℹ️  Order extraction - Sex: 'MALE'
[14:58:53] ℹ️  Order extraction - Service Line: 'RN'
[14:58:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:58:53] ✅ Order data extraction completed successfully
[14:58:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:53] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[14:58:53] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[14:58:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:58:53] ✅ Patient name cross-validation successful
[14:58:53] ✅    ✅ Data merged successfully
[14:58:55] ✅    ✅ Order data extracted and validated
[14:58:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:55] [DOC: 9227634] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:58:55] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:58:55] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:55] [DOC: 9227634] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[14:58:56] [DOC: 9227634] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:58:56] ❌    ❌ Failed to push order
[14:58:56] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:56] [DOC: 9227634] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[14:58:56] [DOC: 9227634] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[14:58:56] [DOC: 9227634] ℹ️  Payer Source extracted: 'Medicare'
[14:58:56] [DOC: 9227634] ℹ️  Diagnosis codes being written:
[14:58:56] [DOC: 9227634] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:56] [DOC: 9227634] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:56] [DOC: 9227634] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:56] [DOC: 9227634] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:56] [DOC: 9227634] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:56] [DOC: 9227634] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:56] [DOC: 9227634] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 3745015
[14:58:56] ✅    ✅ Document 9227634 processed and saved successfully
[14:58:56] 🔄 
🔄 Step 8: Saving API details...
[14:58:56] [DOC: 9227634] ℹ️  API push details saved for document 9227634
[14:58:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227633                         ║
================================================================================
[14:58:56] ℹ️  Agency: Dartmouth HH
[14:58:56] ℹ️  Date: 04/08/2025
[14:58:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:58] [DOC: 9227633] ✅ Text extracted using pdfplumber (8548 chars)
[14:58:58] ✅    ✅ Text extracted using pdfplumber (8548 chars)
[14:58:58] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:01] ℹ️  AI extracted raw sex value: 'M'
[14:59:01] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[14:59:01] ℹ️  AI extracted payer source: 'Medicare'
[14:59:01] ℹ️  AI extracted diagnoses:
[14:59:01] ℹ️    - Diagnosis 1: 'I62.9'
[14:59:01] ℹ️    - Diagnosis 2: 'I70.213'
[14:59:01] ℹ️    - Diagnosis 3: 'E11.40'
[14:59:01] ℹ️    - Diagnosis 4: 'N18.2'
[14:59:01] ℹ️    - Diagnosis 5: 'I12.9'
[14:59:01] ℹ️    - Diagnosis 6: 'G47.33'
[14:59:01] ℹ️  Final extracted MRN: '6396009'
[14:59:01] ℹ️  Final extracted Sex: 'MALE'
[14:59:01] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[14:59:01] ℹ️  Final extracted Payer Source: 'Medicare'
[14:59:01] ✅ Patient data extraction completed successfully
[14:59:01] ✅    ✅ Patient data extracted successfully
[14:59:01] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I62.9', 'secondDiagnosis': 'I70.213', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'N18.2', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'G47.33'}]
[14:59:01] ✅    ✅ Patient identified: Frank Edwards
[14:59:01] ✅    ✅ Patient name validation passed
[14:59:01] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:01] [DOC: 9227633] ℹ️  DOB normalized: 04/08/1942
[14:59:01] [DOC: 9227633] ℹ️  Episode startOfCare normalized: 03/13/2025
[14:59:01] [DOC: 9227633] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[14:59:01] [DOC: 9227633] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[14:59:01] [DOC: 9227633] ✅ Patient date processing completed successfully
[14:59:01] ✅    ✅ Date processing completed
[14:59:01] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I62.9', 'secondDiagnosis': 'I70.213', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'N18.2', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'G47.33'}]
[14:59:01] 🔄 
🔄 Step 4: Extracting order data...
[14:59:04] ℹ️  Order extraction - MRN: ''
[14:59:04] ℹ️  Order extraction - Sex: 'MALE'
[14:59:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[14:59:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:59:04] ✅ Order data extraction completed successfully
[14:59:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:04] ℹ️  Using MRN from patient data: '6396009'
[14:59:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[14:59:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:59:04] ✅ Patient name cross-validation successful
[14:59:04] ✅    ✅ Data merged successfully
[14:59:05] ✅    ✅ Order data extracted and validated
[14:59:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:05] [DOC: 9227633] ✅ Patient found in local cache: Frank Edwards, ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[14:59:05] ✅    ✅ Existing patient found with ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[14:59:05] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:05] [DOC: 9227633] ℹ️  Pushing order via API for patient ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[14:59:06] [DOC: 9227633] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:59:06] ❌    ❌ Failed to push order
[14:59:06] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:06] [DOC: 9227633] ℹ️  Calculated age: 83 from DOB: 04/08/1942
[14:59:06] [DOC: 9227633] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[14:59:06] [DOC: 9227633] ℹ️  Payer Source extracted: 'Medicare'
[14:59:06] [DOC: 9227633] ℹ️  Diagnosis codes being written:
[14:59:06] [DOC: 9227633] ℹ️    - Latest_Episode_Firstdiagnosis: 'I62.9'
[14:59:06] [DOC: 9227633] ℹ️    - Latest_Episode_Seconddiagnosis: 'I70.213'
[14:59:06] [DOC: 9227633] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[14:59:06] [DOC: 9227633] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.2'
[14:59:06] [DOC: 9227633] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[14:59:06] [DOC: 9227633] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[14:59:06] [DOC: 9227633] ✅ Patient data written to CSV: Frank Edwards | Sex: MALE | Age: 83 | Service: Skilled Nursing, PT | Payer: Medicare | MRN: 6396009
[14:59:06] ✅    ✅ Document 9227633 processed and saved successfully
[14:59:06] 🔄 
🔄 Step 8: Saving API details...
[14:59:06] [DOC: 9227633] ℹ️  API push details saved for document 9227633
[14:59:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227629                         ║
================================================================================
[14:59:06] ℹ️  Agency: Dartmouth HH
[14:59:06] ℹ️  Date: 04/08/2025
[14:59:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:08] [DOC: 9227629] ✅ Text extracted using pdfplumber (1076 chars)
[14:59:08] ✅    ✅ Text extracted using pdfplumber (1076 chars)
[14:59:08] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:11] ℹ️  AI extracted raw sex value: 'F'
[14:59:11] ℹ️  AI extracted service line: 'RN'
[14:59:11] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:59:11] ℹ️  AI extracted diagnoses:
[14:59:11] ℹ️    - Diagnosis 1: ''
[14:59:11] ℹ️    - Diagnosis 2: ''
[14:59:11] ℹ️    - Diagnosis 3: ''
[14:59:11] ℹ️    - Diagnosis 4: ''
[14:59:11] ℹ️    - Diagnosis 5: ''
[14:59:11] ℹ️    - Diagnosis 6: ''
[14:59:11] ℹ️  Final extracted MRN: '5559015'
[14:59:11] ℹ️  Final extracted Sex: 'FEMALE'
[14:59:11] ℹ️  Final extracted Service Line: 'RN'
[14:59:11] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:59:11] ✅ Patient data extraction completed successfully
[14:59:11] ✅    ✅ Patient data extracted successfully
[14:59:11] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Pena
     └─ dob: 09/03/1968
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5559015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:59:11] ✅    ✅ Patient identified: Tina Pena
[14:59:11] ✅    ✅ Patient name validation passed
[14:59:11] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:11] [DOC: 9227629] ℹ️  DOB normalized: 09/03/1968
[14:59:11] [DOC: 9227629] ℹ️  Episode startOfCare normalized: 11/13/2024
[14:59:11] [DOC: 9227629] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[14:59:11] [DOC: 9227629] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[14:59:11] [DOC: 9227629] ✅ Patient date processing completed successfully
[14:59:11] ✅    ✅ Date processing completed
[14:59:11] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Pena
     └─ dob: 09/03/1968
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5559015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:59:11] 🔄 
🔄 Step 4: Extracting order data...
[14:59:13] ℹ️  Order extraction - MRN: ''
[14:59:13] ℹ️  Order extraction - Sex: 'FEMALE'
[14:59:13] ℹ️  Order extraction - Service Line: 'RN'
[14:59:13] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:59:13] ✅ Order data extraction completed successfully
[14:59:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:13] ℹ️  Using MRN from patient data: '5559015'
[14:59:13] ℹ️  Service line consistent in both sources: 'RN'
[14:59:13] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:59:13] ✅ Patient name cross-validation successful
[14:59:13] ✅    ✅ Data merged successfully
[14:59:14] ✅    ✅ Order data extracted and validated
[14:59:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:24] [DOC: 9227629] ✅ Patient exists in API: Tina Pena, ID: a86c6a8a-06f8-495e-be55-9369ee2df30f
[14:59:24] ✅    ✅ Existing patient found with ID: a86c6a8a-06f8-495e-be55-9369ee2df30f
[14:59:24] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:24] [DOC: 9227629] ℹ️  Pushing order via API for patient ID: a86c6a8a-06f8-495e-be55-9369ee2df30f
[14:59:25] [DOC: 9227629] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13009"}
[14:59:25] ❌    ❌ Failed to push order
[14:59:25] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:25] [DOC: 9227629] ℹ️  Calculated age: 56 from DOB: 09/03/1968
[14:59:25] [DOC: 9227629] ℹ️  Service Line extracted: 'RN'
[14:59:25] [DOC: 9227629] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:59:25] [DOC: 9227629] ℹ️  Diagnosis codes being written:
[14:59:25] [DOC: 9227629] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:59:25] [DOC: 9227629] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:59:25] [DOC: 9227629] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:59:25] [DOC: 9227629] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:59:25] [DOC: 9227629] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:59:25] [DOC: 9227629] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:59:25] [DOC: 9227629] ✅ Patient data written to CSV: Tina Pena | Sex: FEMALE | Age: 56 | Service: RN | Payer: Medicaid/MA | MRN: 5559015
[14:59:25] ✅    ✅ Document 9227629 processed and saved successfully
[14:59:25] 🔄 
🔄 Step 8: Saving API details...
[14:59:25] [DOC: 9227629] ℹ️  API push details saved for document 9227629
[14:59:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227617                         ║
================================================================================
[14:59:25] ℹ️  Agency: Dartmouth HH
[14:59:25] ℹ️  Date: 04/08/2025
[14:59:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:27] [DOC: 9227617] ✅ Text extracted using pdfplumber (1440 chars)
[14:59:27] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[14:59:27] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:30] ℹ️  AI extracted raw sex value: 'M'
[14:59:30] ℹ️  AI extracted service line: 'RN'
[14:59:30] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[14:59:30] ℹ️  AI extracted diagnoses:
[14:59:30] ℹ️    - Diagnosis 1: ''
[14:59:30] ℹ️    - Diagnosis 2: ''
[14:59:30] ℹ️    - Diagnosis 3: ''
[14:59:30] ℹ️    - Diagnosis 4: ''
[14:59:30] ℹ️    - Diagnosis 5: ''
[14:59:30] ℹ️    - Diagnosis 6: ''
[14:59:30] ℹ️  Final extracted MRN: '4777015'
[14:59:30] ℹ️  Final extracted Sex: 'MALE'
[14:59:30] ℹ️  Final extracted Service Line: 'RN'
[14:59:30] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[14:59:30] ✅ Patient data extraction completed successfully
[14:59:30] ✅    ✅ Patient data extracted successfully
[14:59:30] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 916 Bristol Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:59:30] ✅    ✅ Patient identified: Dennis Langevin
[14:59:30] ✅    ✅ Patient name validation passed
[14:59:30] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:30] [DOC: 9227617] ℹ️  DOB normalized: 04/22/1944
[14:59:30] [DOC: 9227617] ℹ️  Episode startOfCare normalized: 08/21/2024
[14:59:30] [DOC: 9227617] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[14:59:30] [DOC: 9227617] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[14:59:30] [DOC: 9227617] ✅ Patient date processing completed successfully
[14:59:30] ✅    ✅ Date processing completed
[14:59:30] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 916 Bristol Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:59:30] 🔄 
🔄 Step 4: Extracting order data...
[14:59:33] ℹ️  Order extraction - MRN: '4777015'
[14:59:33] ℹ️  Order extraction - Sex: 'MALE'
[14:59:33] ℹ️  Order extraction - Service Line: 'RN'
[14:59:33] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[14:59:33] ✅ Order data extraction completed successfully
[14:59:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:33] ℹ️  Using MRN from patient data: '4777015' over '4777015'
[14:59:33] ℹ️  Service line consistent in both sources: 'RN'
[14:59:33] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[14:59:33] ✅ Patient name cross-validation successful
[14:59:33] ✅    ✅ Data merged successfully
[14:59:34] ✅    ✅ Order data extracted and validated
[14:59:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:34] [DOC: 9227617] ✅ Patient found in local cache: Dennis Langevin, ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[14:59:34] ✅    ✅ Existing patient found with ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[14:59:34] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:34] [DOC: 9227617] ℹ️  Pushing order via API for patient ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[14:59:35] [DOC: 9227617] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:59:35] ❌    ❌ Failed to push order
[14:59:35] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:35] [DOC: 9227617] ℹ️  Calculated age: 81 from DOB: 04/22/1944
[14:59:35] [DOC: 9227617] ℹ️  Service Line extracted: 'RN'
[14:59:35] [DOC: 9227617] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[14:59:35] [DOC: 9227617] ℹ️  Diagnosis codes being written:
[14:59:35] [DOC: 9227617] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:59:35] [DOC: 9227617] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:59:35] [DOC: 9227617] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:59:35] [DOC: 9227617] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:59:35] [DOC: 9227617] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:59:35] [DOC: 9227617] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:59:35] [DOC: 9227617] ✅ Patient data written to CSV: Dennis Langevin | Sex: MALE | Age: 81 | Service: RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 4777015
[14:59:35] ✅    ✅ Document 9227617 processed and saved successfully
[14:59:35] 🔄 
🔄 Step 8: Saving API details...
[14:59:35] [DOC: 9227617] ℹ️  API push details saved for document 9227617
[14:59:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227609                         ║
================================================================================
[14:59:35] ℹ️  Agency: Dartmouth HH
[14:59:35] ℹ️  Date: 04/08/2025
[14:59:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:38] [DOC: 9227609] ✅ Text extracted using pdfplumber (21958 chars)
[14:59:38] ✅    ✅ Text extracted using pdfplumber (21946 chars)
[14:59:38] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:42] ℹ️  AI extracted raw sex value: 'F'
[14:59:42] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[14:59:42] ℹ️  AI extracted payer source: ''
[14:59:42] ℹ️  AI extracted diagnoses:
[14:59:42] ℹ️    - Diagnosis 1: 'C50.912'
[14:59:42] ℹ️    - Diagnosis 2: 'C77.3'
[14:59:42] ℹ️    - Diagnosis 3: 'J44.9'
[14:59:42] ℹ️    - Diagnosis 4: 'I11.0'
[14:59:42] ℹ️    - Diagnosis 5: 'I50.9'
[14:59:42] ℹ️    - Diagnosis 6: 'E11.9'
[14:59:42] ℹ️  Final extracted MRN: '7544009'
[14:59:42] ℹ️  Final extracted Sex: 'FEMALE'
[14:59:42] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[14:59:42] ℹ️  Final extracted Payer Source: ''
[14:59:42] ✅ Patient data extraction completed successfully
[14:59:42] ✅    ✅ Patient data extracted successfully
[14:59:42] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'C50.912', 'secondDiagnosis': 'C77.3', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'E11.9'}]
[14:59:42] ✅    ✅ Patient identified: Sandra Knickerbocker
[14:59:42] ✅    ✅ Patient name validation passed
[14:59:42] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:42] [DOC: 9227609] ℹ️  DOB normalized: 07/22/1948
[14:59:42] [DOC: 9227609] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:59:42] [DOC: 9227609] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:59:42] [DOC: 9227609] ✅ Patient date processing completed successfully
[14:59:42] ✅    ✅ Date processing completed
[14:59:42] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'C50.912', 'secondDiagnosis': 'C77.3', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'E11.9'}]
[14:59:42] 🔄 
🔄 Step 4: Extracting order data...
[14:59:44] ℹ️  Order extraction - MRN: '7544009'
[14:59:44] ℹ️  Order extraction - Sex: 'FEMALE'
[14:59:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:59:44] ℹ️  Order extraction - Payer Source: ''
[14:59:44] ✅ Order data extraction completed successfully
[14:59:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:44] ℹ️  Using MRN from patient data: '7544009' over '7544009'
[14:59:44] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[14:59:44] ✅ Patient name cross-validation successful
[14:59:44] ✅    ✅ Data merged successfully
[14:59:46] ✅    ✅ Order data extracted and validated
[14:59:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:46] [DOC: 9227609] ✅ Patient found in local cache: Sandra Knickerbocker, ID: 72b6d189-6994-4d0a-9e48-56e329440311
[14:59:46] ✅    ✅ Existing patient found with ID: 72b6d189-6994-4d0a-9e48-56e329440311
[14:59:46] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:46] [DOC: 9227609] ℹ️  Pushing order via API for patient ID: 72b6d189-6994-4d0a-9e48-56e329440311
[14:59:47] [DOC: 9227609] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:59:47] ❌    ❌ Failed to push order
[14:59:47] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:47] [DOC: 9227609] ℹ️  Calculated age: 76 from DOB: 07/22/1948
[14:59:47] [DOC: 9227609] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[14:59:47] [DOC: 9227609] ℹ️  Payer Source extracted: ''
[14:59:47] [DOC: 9227609] ℹ️  Diagnosis codes being written:
[14:59:47] [DOC: 9227609] ℹ️    - Latest_Episode_Firstdiagnosis: 'C50.912'
[14:59:47] [DOC: 9227609] ℹ️    - Latest_Episode_Seconddiagnosis: 'C77.3'
[14:59:47] [DOC: 9227609] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[14:59:47] [DOC: 9227609] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[14:59:47] [DOC: 9227609] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.9'
[14:59:47] [DOC: 9227609] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[14:59:47] [DOC: 9227609] ✅ Patient data written to CSV: Sandra Knickerbocker | Sex: FEMALE | Age: 76 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 7544009
[14:59:47] ✅    ✅ Document 9227609 processed and saved successfully
[14:59:47] 🔄 
🔄 Step 8: Saving API details...
[14:59:47] [DOC: 9227609] ℹ️  API push details saved for document 9227609
[14:59:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227602                         ║
================================================================================
[14:59:47] ℹ️  Agency: Dartmouth HH
[14:59:47] ℹ️  Date: 04/08/2025
[14:59:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:49] [DOC: 9227602] ✅ Text extracted using pdfplumber (8174 chars)
[14:59:49] ✅    ✅ Text extracted using pdfplumber (8174 chars)
[14:59:49] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:53] ℹ️  AI extracted raw sex value: 'F'
[14:59:53] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:59:53] ℹ️  AI extracted payer source: 'Medicare'
[14:59:53] ℹ️  AI extracted diagnoses:
[14:59:53] ℹ️    - Diagnosis 1: 'J96.21'
[14:59:53] ℹ️    - Diagnosis 2: 'J84.9'
[14:59:53] ℹ️    - Diagnosis 3: 'E87.0'
[14:59:53] ℹ️    - Diagnosis 4: 'R13.10'
[14:59:53] ℹ️    - Diagnosis 5: 'K59.00'
[14:59:53] ℹ️    - Diagnosis 6: 'R33.9'
[14:59:53] ℹ️  Final extracted MRN: '4799015'
[14:59:53] ℹ️  Final extracted Sex: 'FEMALE'
[14:59:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:59:53] ℹ️  Final extracted Payer Source: 'Medicare'
[14:59:53] ✅ Patient data extraction completed successfully
[14:59:53] ✅    ✅ Patient data extracted successfully
[14:59:53] 📊 Patient Response
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J96.21', 'secondDiagnosis': 'J84.9', 'thirdDiagnosis': 'E87.0', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'K59.00', 'sixthDiagnosis': 'R33.9'}]
[14:59:53] ✅    ✅ Patient identified: Agatina Manna
[14:59:53] ✅    ✅ Patient name validation passed
[14:59:53] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:53] [DOC: 9227602] ℹ️  DOB normalized: 03/10/1937
[14:59:53] [DOC: 9227602] ℹ️  Episode startOfCare normalized: 11/17/2024
[14:59:53] [DOC: 9227602] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[14:59:53] [DOC: 9227602] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[14:59:53] [DOC: 9227602] ✅ Patient date processing completed successfully
[14:59:53] ✅    ✅ Date processing completed
[14:59:53] 📊 Processed Patient Data
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J96.21', 'secondDiagnosis': 'J84.9', 'thirdDiagnosis': 'E87.0', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'K59.00', 'sixthDiagnosis': 'R33.9'}]
[14:59:53] 🔄 
🔄 Step 4: Extracting order data...
[14:59:55] ℹ️  Order extraction - MRN: '4799015'
[14:59:55] ℹ️  Order extraction - Sex: 'FEMALE'
[14:59:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:59:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:59:55] ✅ Order data extraction completed successfully
[14:59:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:55] ℹ️  Using MRN from patient data: '4799015' over '4799015'
[14:59:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:59:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:59:55] ✅ Patient name cross-validation successful
[14:59:55] ✅    ✅ Data merged successfully
[14:59:57] ✅    ✅ Order data extracted and validated
[14:59:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:57] [DOC: 9227602] ✅ Patient found in local cache: Agatina Manna, ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[14:59:57] ✅    ✅ Existing patient found with ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[14:59:57] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:57] [DOC: 9227602] ℹ️  Pushing order via API for patient ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[14:59:58] [DOC: 9227602] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:59:58] ❌    ❌ Failed to push order
[14:59:58] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:58] [DOC: 9227602] ℹ️  Calculated age: 88 from DOB: 03/10/1937
[14:59:58] [DOC: 9227602] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[14:59:58] [DOC: 9227602] ℹ️  Payer Source extracted: 'Medicare'
[14:59:58] [DOC: 9227602] ℹ️  Diagnosis codes being written:
[14:59:58] [DOC: 9227602] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.21'
[14:59:58] [DOC: 9227602] ℹ️    - Latest_Episode_Seconddiagnosis: 'J84.9'
[14:59:58] [DOC: 9227602] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.0'
[14:59:58] [DOC: 9227602] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R13.10'
[14:59:58] [DOC: 9227602] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K59.00'
[14:59:58] [DOC: 9227602] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R33.9'
[14:59:58] [DOC: 9227602] ✅ Patient data written to CSV: Agatina Manna | Sex: FEMALE | Age: 88 | Service: Skilled Nursing, Physical Therapy, Speech Therapy | Payer: Medicare | MRN: 4799015
[14:59:58] ✅    ✅ Document 9227602 processed and saved successfully
[14:59:58] 🔄 
🔄 Step 8: Saving API details...
[14:59:58] [DOC: 9227602] ℹ️  API push details saved for document 9227602
[14:59:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227570                         ║
================================================================================
[14:59:58] ℹ️  Agency: Dartmouth HH
[14:59:58] ℹ️  Date: 04/08/2025
[14:59:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:00] [DOC: 9227570] ✅ Text extracted using pdfplumber (1110 chars)
[15:00:00] ✅    ✅ Text extracted using pdfplumber (1110 chars)
[15:00:00] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:02] ℹ️  AI extracted raw sex value: 'F'
[15:00:02] ℹ️  AI extracted service line: 'PT'
[15:00:02] ℹ️  AI extracted payer source: 'Medicare'
[15:00:02] ℹ️  AI extracted diagnoses:
[15:00:02] ℹ️    - Diagnosis 1: ''
[15:00:02] ℹ️    - Diagnosis 2: ''
[15:00:02] ℹ️    - Diagnosis 3: ''
[15:00:02] ℹ️    - Diagnosis 4: ''
[15:00:02] ℹ️    - Diagnosis 5: ''
[15:00:02] ℹ️    - Diagnosis 6: ''
[15:00:02] ℹ️  Final extracted MRN: '5025015'
[15:00:02] ℹ️  Final extracted Sex: 'FEMALE'
[15:00:02] ℹ️  Final extracted Service Line: 'PT'
[15:00:02] ℹ️  Final extracted Payer Source: 'Medicare'
[15:00:02] ✅ Patient data extraction completed successfully
[15:00:02] ✅    ✅ Patient data extracted successfully
[15:00:02] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Harrington
     └─ dob: 09/29/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5025015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 233 Palmer St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:00:02] ✅    ✅ Patient identified: Lorraine Harrington
[15:00:02] ✅    ✅ Patient name validation passed
[15:00:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:02] [DOC: 9227570] ℹ️  DOB normalized: 09/29/1940
[15:00:02] [DOC: 9227570] ℹ️  Episode startOfCare normalized: 02/28/2025
[15:00:02] [DOC: 9227570] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:00:02] [DOC: 9227570] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:00:02] [DOC: 9227570] ✅ Patient date processing completed successfully
[15:00:02] ✅    ✅ Date processing completed
[15:00:02] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Harrington
     └─ dob: 09/29/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5025015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 233 Palmer St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:00:02] 🔄 
🔄 Step 4: Extracting order data...
[15:00:05] ℹ️  Order extraction - MRN: ''
[15:00:05] ℹ️  Order extraction - Sex: 'FEMALE'
[15:00:05] ℹ️  Order extraction - Service Line: 'PT'
[15:00:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:00:05] ✅ Order data extraction completed successfully
[15:00:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:05] ℹ️  Using MRN from patient data: '5025015'
[15:00:05] ℹ️  Service line consistent in both sources: 'PT'
[15:00:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:00:05] ✅ Patient name cross-validation successful
[15:00:05] ✅    ✅ Data merged successfully
[15:00:06] ✅    ✅ Order data extracted and validated
[15:00:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:27] [DOC: 9227570] ℹ️  Patient not found in cache or API: Lorraine Harrington
[15:00:27] [DOC: 9227570] ℹ️  Patient not found, creating new patient via API...
[15:00:27] [DOC: 9227570] ℹ️  Creating patient via API: Lorraine Harrington
[15:00:29] [DOC: 9227570] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:00:29] ❌    ❌ Failed to create patient
[15:00:29] [DOC: 9227570] ℹ️  API push details saved for document 9227570
================================================================================
║                        Processing Document ID: 9227404                         ║
================================================================================
[15:00:29] ℹ️  Agency: Dartmouth HH
[15:00:29] ℹ️  Date: 04/08/2025
[15:00:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:30] [DOC: 9227404] ✅ Text extracted using pdfplumber (1136 chars)
[15:00:30] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[15:00:30] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:33] ℹ️  AI extracted raw sex value: 'F'
[15:00:33] ℹ️  AI extracted service line: 'OT'
[15:00:33] ℹ️  AI extracted payer source: 'Medicare'
[15:00:33] ℹ️  AI extracted diagnoses:
[15:00:33] ℹ️    - Diagnosis 1: ''
[15:00:33] ℹ️    - Diagnosis 2: ''
[15:00:33] ℹ️    - Diagnosis 3: ''
[15:00:33] ℹ️    - Diagnosis 4: ''
[15:00:33] ℹ️    - Diagnosis 5: ''
[15:00:33] ℹ️    - Diagnosis 6: ''
[15:00:33] ℹ️  Final extracted MRN: '2929009'
[15:00:33] ℹ️  Final extracted Sex: 'FEMALE'
[15:00:33] ℹ️  Final extracted Service Line: 'OT'
[15:00:33] ℹ️  Final extracted Payer Source: 'Medicare'
[15:00:33] ✅ Patient data extraction completed successfully
[15:00:33] ✅    ✅ Patient data extracted successfully
[15:00:33] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Tavares
     └─ dob: 09/03/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:00:33] ✅    ✅ Patient identified: Maria Tavares
[15:00:33] ✅    ✅ Patient name validation passed
[15:00:33] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:33] [DOC: 9227404] ℹ️  DOB normalized: 09/03/1948
[15:00:33] [DOC: 9227404] ℹ️  Episode startOfCare normalized: 03/19/2025
[15:00:33] [DOC: 9227404] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:00:33] [DOC: 9227404] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[15:00:33] [DOC: 9227404] ✅ Patient date processing completed successfully
[15:00:33] ✅    ✅ Date processing completed
[15:00:33] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Tavares
     └─ dob: 09/03/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:00:33] 🔄 
🔄 Step 4: Extracting order data...
[15:00:36] ℹ️  Order extraction - MRN: ''
[15:00:36] ℹ️  Order extraction - Sex: 'FEMALE'
[15:00:36] ℹ️  Order extraction - Service Line: 'OT'
[15:00:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:00:36] ✅ Order data extraction completed successfully
[15:00:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:36] ℹ️  Using MRN from patient data: '2929009'
[15:00:36] ℹ️  Service line consistent in both sources: 'OT'
[15:00:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:00:36] ✅ Patient name cross-validation successful
[15:00:36] ✅    ✅ Data merged successfully
[15:00:37] ✅    ✅ Order data extracted and validated
[15:00:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:37] [DOC: 9227404] ✅ Patient found in local cache: Maria Tavares, ID: 1c258f9c-405c-497c-94d6-e50c3e251b72
[15:00:37] ✅    ✅ Existing patient found with ID: 1c258f9c-405c-497c-94d6-e50c3e251b72
[15:00:37] 🔄 
🔄 Step 6: Pushing order to API...
[15:00:37] [DOC: 9227404] ℹ️  Pushing order via API for patient ID: 1c258f9c-405c-497c-94d6-e50c3e251b72
[15:00:38] [DOC: 9227404] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:00:38] ❌    ❌ Failed to push order
[15:00:38] 🔄 
🔄 Step 7: Writing to CSV...
[15:00:38] [DOC: 9227404] ℹ️  Calculated age: 76 from DOB: 09/03/1948
[15:00:38] [DOC: 9227404] ℹ️  Service Line extracted: 'OT'
[15:00:38] [DOC: 9227404] ℹ️  Payer Source extracted: 'Medicare'
[15:00:38] [DOC: 9227404] ℹ️  Diagnosis codes being written:
[15:00:38] [DOC: 9227404] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:00:38] [DOC: 9227404] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:00:38] [DOC: 9227404] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:00:38] [DOC: 9227404] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:00:38] [DOC: 9227404] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:00:38] [DOC: 9227404] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:00:38] [DOC: 9227404] ✅ Patient data written to CSV: Maria Tavares | Sex: FEMALE | Age: 76 | Service: OT | Payer: Medicare | MRN: 2929009
[15:00:38] ✅    ✅ Document 9227404 processed and saved successfully
[15:00:38] 🔄 
🔄 Step 8: Saving API details...
[15:00:38] [DOC: 9227404] ℹ️  API push details saved for document 9227404
[15:00:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227399                         ║
================================================================================
[15:00:38] ℹ️  Agency: Dartmouth HH
[15:00:38] ℹ️  Date: 04/08/2025
[15:00:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:44] [DOC: 9227399] ✅ Text extracted using pdfplumber (10503 chars)
[15:00:44] ✅    ✅ Text extracted using pdfplumber (10503 chars)
[15:00:44] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:47] ℹ️  AI extracted raw sex value: 'F'
[15:00:47] ℹ️  AI extracted service line: 'PT, RN'
[15:00:47] ℹ️  AI extracted payer source: 'None'
[15:00:47] ℹ️  AI extracted diagnoses:
[15:00:47] ℹ️    - Diagnosis 1: 'Z47.1'
[15:00:47] ℹ️    - Diagnosis 2: 'M17.12'
[15:00:47] ℹ️    - Diagnosis 3: 'E66.01'
[15:00:47] ℹ️    - Diagnosis 4: 'Z68.41'
[15:00:47] ℹ️    - Diagnosis 5: 'B35.1'
[15:00:47] ℹ️    - Diagnosis 6: 'E78.00'
[15:00:47] ℹ️  Final extracted MRN: '2660015'
[15:00:47] ℹ️  Final extracted Sex: 'FEMALE'
[15:00:47] ℹ️  Final extracted Service Line: 'PT, RN'
[15:00:47] ℹ️  Final extracted Payer Source: ''
[15:00:47] ✅ Patient data extraction completed successfully
[15:00:47] ✅    ✅ Patient data extracted successfully
[15:00:47] 📊 Patient Response
     └─ patientFName: Melo
     └─ patientLName: Pamela
     └─ dob: 12/19/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2660015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M17.12', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': 'Z68.41', 'fifthDiagnosis': 'B35.1', 'sixthDiagnosis': 'E78.00'}]
[15:00:47] ✅    ✅ Patient identified: Melo Pamela
[15:00:47] ✅    ✅ Patient name validation passed
[15:00:47] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:47] [DOC: 9227399] ℹ️  DOB normalized: 12/19/1964
[15:00:47] [DOC: 9227399] ℹ️  Episode startOfCare normalized: 03/27/2025
[15:00:47] [DOC: 9227399] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[15:00:47] [DOC: 9227399] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[15:00:47] [DOC: 9227399] ✅ Patient date processing completed successfully
[15:00:47] ✅    ✅ Date processing completed
[15:00:47] 📊 Processed Patient Data
     └─ patientFName: Melo
     └─ patientLName: Pamela
     └─ dob: 12/19/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2660015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M17.12', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': 'Z68.41', 'fifthDiagnosis': 'B35.1', 'sixthDiagnosis': 'E78.00'}]
[15:00:47] 🔄 
🔄 Step 4: Extracting order data...
[15:00:49] ℹ️  Order extraction - MRN: '2660015'
[15:00:49] ℹ️  Order extraction - Sex: 'FEMALE'
[15:00:49] ℹ️  Order extraction - Service Line: 'PT, RN'
[15:00:49] ℹ️  Order extraction - Payer Source: ''
[15:00:49] ✅ Order data extraction completed successfully
[15:00:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:49] ℹ️  Using MRN from patient data: '2660015' over '2660015'
[15:00:49] ℹ️  Service line consistent in both sources: 'PT, RN'
[15:00:49] ✅ Patient name cross-validation successful
[15:00:49] ✅    ✅ Data merged successfully
[15:00:51] ✅    ✅ Order data extracted and validated
[15:00:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:58] [DOC: 9227399] ✅ Patient exists in API: Melo Pamela, ID: a67576a8-e07f-4d57-8405-474a1978b06e
[15:00:58] ✅    ✅ Existing patient found with ID: a67576a8-e07f-4d57-8405-474a1978b06e
[15:00:58] 🔄 
🔄 Step 6: Pushing order to API...
[15:00:58] [DOC: 9227399] ℹ️  Pushing order via API for patient ID: a67576a8-e07f-4d57-8405-474a1978b06e
[15:01:00] [DOC: 9227399] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:01:00] ❌    ❌ Failed to push order
[15:01:00] 🔄 
🔄 Step 7: Writing to CSV...
[15:01:00] [DOC: 9227399] ℹ️  Calculated age: 60 from DOB: 12/19/1964
[15:01:00] [DOC: 9227399] ℹ️  Service Line extracted: 'PT, RN'
[15:01:00] [DOC: 9227399] ℹ️  Payer Source extracted: ''
[15:01:00] [DOC: 9227399] ℹ️  Diagnosis codes being written:
[15:01:00] [DOC: 9227399] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[15:01:00] [DOC: 9227399] ℹ️    - Latest_Episode_Seconddiagnosis: 'M17.12'
[15:01:00] [DOC: 9227399] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.01'
[15:01:00] [DOC: 9227399] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z68.41'
[15:01:00] [DOC: 9227399] ℹ️    - Latest_Episode_Fifthdiagnosis: 'B35.1'
[15:01:00] [DOC: 9227399] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.00'
[15:01:00] [DOC: 9227399] ✅ Patient data written to CSV: Melo Pamela | Sex: FEMALE | Age: 60 | Service: PT, RN | Payer:  | MRN: 2660015
[15:01:00] ✅    ✅ Document 9227399 processed and saved successfully
[15:01:00] 🔄 
🔄 Step 8: Saving API details...
[15:01:00] [DOC: 9227399] ℹ️  API push details saved for document 9227399
[15:01:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227394                         ║
================================================================================
[15:01:00] ℹ️  Agency: Dartmouth HH
[15:01:00] ℹ️  Date: 04/08/2025
[15:01:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:01:02] [DOC: 9227394] ✅ Text extracted using pdfplumber (1197 chars)
[15:01:02] ✅    ✅ Text extracted using pdfplumber (1197 chars)
[15:01:02] 🔄 
🔄 Step 2: Extracting patient data...
[15:01:04] ℹ️  AI extracted raw sex value: 'M'
[15:01:04] ℹ️  AI extracted service line: 'RN'
[15:01:04] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[15:01:04] ℹ️  AI extracted diagnoses:
[15:01:04] ℹ️    - Diagnosis 1: ''
[15:01:04] ℹ️    - Diagnosis 2: ''
[15:01:04] ℹ️    - Diagnosis 3: ''
[15:01:04] ℹ️    - Diagnosis 4: ''
[15:01:04] ℹ️    - Diagnosis 5: ''
[15:01:04] ℹ️    - Diagnosis 6: ''
[15:01:04] ℹ️  Final extracted MRN: '2833015'
[15:01:04] ℹ️  Final extracted Sex: 'MALE'
[15:01:04] ℹ️  Final extracted Service Line: 'RN'
[15:01:04] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[15:01:04] ✅ Patient data extraction completed successfully
[15:01:04] ✅    ✅ Patient data extracted successfully
[15:01:04] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Barrett Jr,
     └─ dob: 12/28/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2833015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2024', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:01:04] ✅    ✅ Patient identified: Paul Barrett Jr,
[15:01:04] ✅    ✅ Patient name validation passed
[15:01:04] 🔄 
🔄 Step 3: Processing patient dates...
[15:01:04] [DOC: 9227394] ℹ️  DOB normalized: 12/28/1947
[15:01:04] [DOC: 9227394] ℹ️  Episode startOfCare normalized: 04/09/2024
[15:01:04] [DOC: 9227394] ℹ️  Episode startOfEpisode normalized: 02/03/2025
[15:01:04] [DOC: 9227394] ℹ️  Episode endOfEpisode normalized: 04/03/2025
[15:01:04] [DOC: 9227394] ✅ Patient date processing completed successfully
[15:01:04] ✅    ✅ Date processing completed
[15:01:04] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Barrett Jr,
     └─ dob: 12/28/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2833015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2024', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:01:04] 🔄 
🔄 Step 4: Extracting order data...
[15:01:07] ℹ️  Order extraction - MRN: ''
[15:01:07] ℹ️  Order extraction - Sex: 'MALE'
[15:01:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:01:07] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[15:01:07] ✅ Order data extraction completed successfully
[15:01:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:01:07] ℹ️  Using MRN from patient data: '2833015'
[15:01:07] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[15:01:07] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[15:01:07] ✅ Patient name cross-validation successful
[15:01:07] ✅    ✅ Data merged successfully
[15:01:08] ✅    ✅ Order data extracted and validated
[15:01:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:01:46] [DOC: 9227394] ℹ️  Patient not found in cache or API: Paul Barrett Jr,
[15:01:46] [DOC: 9227394] ℹ️  Patient not found, creating new patient via API...
[15:01:46] [DOC: 9227394] ℹ️  Creating patient via API: Paul Barrett Jr,
[15:01:47] [DOC: 9227394] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:01:47] ❌    ❌ Failed to create patient
[15:01:47] [DOC: 9227394] ℹ️  API push details saved for document 9227394
================================================================================
║                        Processing Document ID: 9227393                         ║
================================================================================
[15:01:47] ℹ️  Agency: Dartmouth HH
[15:01:47] ℹ️  Date: 04/08/2025
[15:01:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:01:50] [DOC: 9227393] ✅ Text extracted using pdfplumber (6089 chars)
[15:01:50] ✅    ✅ Text extracted using pdfplumber (6089 chars)
[15:01:50] 🔄 
🔄 Step 2: Extracting patient data...
[15:01:52] ℹ️  AI extracted raw sex value: 'F'
[15:01:52] ℹ️  AI extracted service line: 'OT'
[15:01:52] ℹ️  AI extracted payer source: 'Medicare'
[15:01:52] ℹ️  AI extracted diagnoses:
[15:01:52] ℹ️    - Diagnosis 1: ''
[15:01:52] ℹ️    - Diagnosis 2: ''
[15:01:52] ℹ️    - Diagnosis 3: ''
[15:01:52] ℹ️    - Diagnosis 4: ''
[15:01:52] ℹ️    - Diagnosis 5: ''
[15:01:52] ℹ️    - Diagnosis 6: ''
[15:01:52] ℹ️  Final extracted MRN: '421008'
[15:01:52] ℹ️  Final extracted Sex: 'FEMALE'
[15:01:52] ℹ️  Final extracted Service Line: 'OT'
[15:01:52] ℹ️  Final extracted Payer Source: 'Medicare'
[15:01:52] ✅ Patient data extraction completed successfully
[15:01:52] ✅    ✅ Patient data extracted successfully
[15:01:52] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:01:52] ✅    ✅ Patient identified: Nancy Mulcare
[15:01:52] ✅    ✅ Patient name validation passed
[15:01:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:01:52] [DOC: 9227393] ℹ️  DOB normalized: 10/20/1945
[15:01:52] [DOC: 9227393] ℹ️  Episode startOfCare normalized: 03/25/2025
[15:01:52] [DOC: 9227393] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:01:52] [DOC: 9227393] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:01:52] [DOC: 9227393] ✅ Patient date processing completed successfully
[15:01:52] ✅    ✅ Date processing completed
[15:01:52] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:01:52] 🔄 
🔄 Step 4: Extracting order data...
[15:01:55] ℹ️  Order extraction - MRN: '421008'
[15:01:55] ℹ️  Order extraction - Sex: 'FEMALE'
[15:01:55] ℹ️  Order extraction - Service Line: 'OT'
[15:01:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:01:55] ✅ Order data extraction completed successfully
[15:01:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:01:55] ℹ️  Using MRN from patient data: '421008' over '421008'
[15:01:55] ℹ️  Service line consistent in both sources: 'OT'
[15:01:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:01:55] ✅ Patient name cross-validation successful
[15:01:55] ✅    ✅ Data merged successfully
[15:01:56] ✅    ✅ Order data extracted and validated
[15:01:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:04] [DOC: 9227393] ℹ️  Patient not found in cache or API: Nancy Mulcare
[15:02:04] [DOC: 9227393] ℹ️  Patient not found, creating new patient via API...
[15:02:04] [DOC: 9227393] ℹ️  Creating patient via API: Nancy Mulcare
[15:02:05] [DOC: 9227393] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:02:05] ❌    ❌ Failed to create patient
[15:02:05] [DOC: 9227393] ℹ️  API push details saved for document 9227393
================================================================================
║                        Processing Document ID: 9227390                         ║
================================================================================
[15:02:05] ℹ️  Agency: Dartmouth HH
[15:02:05] ℹ️  Date: 04/08/2025
[15:02:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:07] [DOC: 9227390] ✅ Text extracted using pdfplumber (1316 chars)
[15:02:07] ✅    ✅ Text extracted using pdfplumber (1316 chars)
[15:02:07] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:10] ℹ️  AI extracted raw sex value: 'M'
[15:02:10] ℹ️  AI extracted service line: 'HHA'
[15:02:10] ℹ️  AI extracted payer source: 'Medicare'
[15:02:10] ℹ️  AI extracted diagnoses:
[15:02:10] ℹ️    - Diagnosis 1: 'None'
[15:02:10] ℹ️    - Diagnosis 2: 'None'
[15:02:10] ℹ️    - Diagnosis 3: 'None'
[15:02:10] ℹ️    - Diagnosis 4: 'None'
[15:02:10] ℹ️    - Diagnosis 5: 'None'
[15:02:10] ℹ️    - Diagnosis 6: 'None'
[15:02:10] ℹ️  Final extracted MRN: '1742011'
[15:02:10] ℹ️  Final extracted Sex: 'MALE'
[15:02:10] ℹ️  Final extracted Service Line: 'HHA'
[15:02:10] ℹ️  Final extracted Payer Source: 'Medicare'
[15:02:10] ✅ Patient data extraction completed successfully
[15:02:10] ✅    ✅ Patient data extracted successfully
[15:02:10] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Macdonald
     └─ dob: 09/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 1742011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 490 Loftus Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:02:10] ✅    ✅ Patient identified: George Macdonald
[15:02:10] ✅    ✅ Patient name validation passed
[15:02:10] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:10] [DOC: 9227390] ℹ️  DOB normalized: 09/17/1941
[15:02:10] [DOC: 9227390] ℹ️  Episode startOfCare normalized: 03/01/2025
[15:02:10] [DOC: 9227390] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[15:02:10] [DOC: 9227390] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[15:02:10] [DOC: 9227390] ✅ Patient date processing completed successfully
[15:02:10] ✅    ✅ Date processing completed
[15:02:10] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Macdonald
     └─ dob: 09/17/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 1742011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 490 Loftus Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025'}]
[15:02:10] 🔄 
🔄 Step 4: Extracting order data...
[15:02:12] ℹ️  Order extraction - MRN: ''
[15:02:12] ℹ️  Order extraction - Sex: 'MALE'
[15:02:12] ℹ️  Order extraction - Service Line: ''
[15:02:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:02:12] ✅ Order data extraction completed successfully
[15:02:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:12] ℹ️  Using MRN from patient data: '1742011'
[15:02:12] ℹ️  Using service line from patient data: 'HHA'
[15:02:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:02:12] ✅ Patient name cross-validation successful
[15:02:12] ✅    ✅ Data merged successfully
[15:02:14] ✅    ✅ Order data extracted and validated
[15:02:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:21] [DOC: 9227390] ℹ️  Patient not found in cache or API: George Macdonald
[15:02:21] [DOC: 9227390] ℹ️  Patient not found, creating new patient via API...
[15:02:21] [DOC: 9227390] ℹ️  Creating patient via API: George Macdonald
[15:02:22] [DOC: 9227390] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:02:22] ❌    ❌ Failed to create patient
[15:02:22] [DOC: 9227390] ℹ️  API push details saved for document 9227390
================================================================================
║                        Processing Document ID: 9227389                         ║
================================================================================
[15:02:22] ℹ️  Agency: Dartmouth HH
[15:02:22] ℹ️  Date: 04/08/2025
[15:02:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:24] [DOC: 9227389] ✅ Text extracted using pdfplumber (1168 chars)
[15:02:24] ✅    ✅ Text extracted using pdfplumber (1168 chars)
[15:02:24] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:27] ℹ️  AI extracted raw sex value: 'F'
[15:02:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:02:27] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[15:02:27] ℹ️  AI extracted diagnoses:
[15:02:27] ℹ️    - Diagnosis 1: 'hypercholesteremia'
[15:02:27] ℹ️    - Diagnosis 2: ''
[15:02:27] ℹ️    - Diagnosis 3: ''
[15:02:27] ℹ️    - Diagnosis 4: ''
[15:02:27] ℹ️    - Diagnosis 5: ''
[15:02:27] ℹ️    - Diagnosis 6: ''
[15:02:27] ℹ️  Final extracted MRN: '6204015'
[15:02:27] ℹ️  Final extracted Sex: 'FEMALE'
[15:02:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:02:27] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[15:02:27] ✅ Patient data extraction completed successfully
[15:02:27] ✅    ✅ Patient data extracted successfully
[15:02:27] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'hypercholesteremia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:02:27] ✅    ✅ Patient identified: Rita Costa
[15:02:27] ✅    ✅ Patient name validation passed
[15:02:27] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:27] [DOC: 9227389] ℹ️  DOB normalized: 10/16/1930
[15:02:27] [DOC: 9227389] ℹ️  Episode startOfCare normalized: 03/17/2025
[15:02:27] [DOC: 9227389] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[15:02:27] [DOC: 9227389] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[15:02:27] [DOC: 9227389] ✅ Patient date processing completed successfully
[15:02:27] ✅    ✅ Date processing completed
[15:02:27] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'hypercholesteremia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:02:27] 🔄 
🔄 Step 4: Extracting order data...
[15:02:29] ℹ️  Order extraction - MRN: ''
[15:02:29] ℹ️  Order extraction - Sex: 'FEMALE'
[15:02:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:02:29] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[15:02:29] ✅ Order data extraction completed successfully
[15:02:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:29] ℹ️  Using MRN from patient data: '6204015'
[15:02:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:02:29] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[15:02:29] ✅ Patient name cross-validation successful
[15:02:29] ✅    ✅ Data merged successfully
[15:02:30] ✅    ✅ Order data extracted and validated
[15:02:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:30] [DOC: 9227389] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[15:02:30] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[15:02:30] 🔄 
🔄 Step 6: Pushing order to API...
[15:02:30] [DOC: 9227389] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[15:02:32] [DOC: 9227389] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12877"}
[15:02:32] ❌    ❌ Failed to push order
[15:02:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:02:32] [DOC: 9227389] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[15:02:32] [DOC: 9227389] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:02:32] [DOC: 9227389] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[15:02:32] [DOC: 9227389] ℹ️  Diagnosis codes being written:
[15:02:32] [DOC: 9227389] ℹ️    - Latest_Episode_Firstdiagnosis: 'hypercholesteremia'
[15:02:32] [DOC: 9227389] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:02:32] [DOC: 9227389] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:02:32] [DOC: 9227389] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:02:32] [DOC: 9227389] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:02:32] [DOC: 9227389] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:02:32] [DOC: 9227389] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: Skilled Nursing | Payer: Aetna- Mcare | MRN: 6204015
[15:02:32] ✅    ✅ Document 9227389 processed and saved successfully
[15:02:32] 🔄 
🔄 Step 8: Saving API details...
[15:02:32] [DOC: 9227389] ℹ️  API push details saved for document 9227389
[15:02:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227383                         ║
================================================================================
[15:02:32] ℹ️  Agency: Dartmouth HH
[15:02:32] ℹ️  Date: 04/08/2025
[15:02:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:34] [DOC: 9227383] ✅ Text extracted using pdfplumber (18993 chars)
[15:02:34] ✅    ✅ Text extracted using pdfplumber (18981 chars)
[15:02:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:37] ℹ️  AI extracted raw sex value: 'F'
[15:02:37] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[15:02:37] ℹ️  AI extracted payer source: ''
[15:02:37] ℹ️  AI extracted diagnoses:
[15:02:37] ℹ️    - Diagnosis 1: 'K21.00'
[15:02:37] ℹ️    - Diagnosis 2: 'K26.9'
[15:02:37] ℹ️    - Diagnosis 3: 'K44.9'
[15:02:37] ℹ️    - Diagnosis 4: 'I12.9'
[15:02:37] ℹ️    - Diagnosis 5: 'E11.22'
[15:02:37] ℹ️    - Diagnosis 6: 'N18.30'
[15:02:37] ℹ️  Final extracted MRN: '421008'
[15:02:37] ℹ️  Final extracted Sex: 'FEMALE'
[15:02:37] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[15:02:37] ℹ️  Final extracted Payer Source: ''
[15:02:37] ✅ Patient data extraction completed successfully
[15:02:37] ✅    ✅ Patient data extracted successfully
[15:02:37] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'K21.00', 'secondDiagnosis': 'K26.9', 'thirdDiagnosis': 'K44.9', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[15:02:37] ✅    ✅ Patient identified: Nancy Mulcare
[15:02:37] ✅    ✅ Patient name validation passed
[15:02:37] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:37] [DOC: 9227383] ℹ️  DOB normalized: 10/20/1945
[15:02:37] [DOC: 9227383] ℹ️  Episode startOfCare normalized: 03/25/2025
[15:02:37] [DOC: 9227383] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:02:37] [DOC: 9227383] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:02:37] [DOC: 9227383] ✅ Patient date processing completed successfully
[15:02:37] ✅    ✅ Date processing completed
[15:02:37] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Mulcare
     └─ dob: 10/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'K21.00', 'secondDiagnosis': 'K26.9', 'thirdDiagnosis': 'K44.9', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[15:02:37] 🔄 
🔄 Step 4: Extracting order data...
[15:02:40] ℹ️  Order extraction - MRN: '421008'
[15:02:40] ℹ️  Order extraction - Sex: 'FEMALE'
[15:02:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[15:02:40] ℹ️  Order extraction - Payer Source: ''
[15:02:40] ✅ Order data extraction completed successfully
[15:02:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:40] ℹ️  Using MRN from patient data: '421008' over '421008'
[15:02:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[15:02:40] ✅ Patient name cross-validation successful
[15:02:40] ✅    ✅ Data merged successfully
[15:02:41] ✅    ✅ Order data extracted and validated
[15:02:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:56] [DOC: 9227383] ℹ️  Patient not found in cache or API: Nancy Mulcare
[15:02:56] [DOC: 9227383] ℹ️  Patient not found, creating new patient via API...
[15:02:56] [DOC: 9227383] ℹ️  Creating patient via API: Nancy Mulcare
[15:02:58] [DOC: 9227383] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:02:58] ❌    ❌ Failed to create patient
[15:02:58] [DOC: 9227383] ℹ️  API push details saved for document 9227383
================================================================================
║                        Processing Document ID: 9227370                         ║
================================================================================
[15:02:58] ℹ️  Agency: Dartmouth HH
[15:02:58] ℹ️  Date: 04/08/2025
[15:02:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:59] [DOC: 9227370] ✅ Text extracted using pdfplumber (1169 chars)
[15:02:59] ✅    ✅ Text extracted using pdfplumber (1169 chars)
[15:02:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:02] ℹ️  AI extracted raw sex value: 'F'
[15:03:02] ℹ️  AI extracted service line: 'SN, telehealth'
[15:03:02] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[15:03:02] ℹ️  AI extracted diagnoses:
[15:03:02] ℹ️    - Diagnosis 1: ''
[15:03:02] ℹ️    - Diagnosis 2: ''
[15:03:02] ℹ️    - Diagnosis 3: ''
[15:03:02] ℹ️    - Diagnosis 4: ''
[15:03:02] ℹ️    - Diagnosis 5: ''
[15:03:02] ℹ️    - Diagnosis 6: ''
[15:03:02] ℹ️  Final extracted MRN: '5843015'
[15:03:02] ℹ️  Final extracted Sex: 'FEMALE'
[15:03:02] ℹ️  Final extracted Service Line: 'SN, telehealth'
[15:03:02] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[15:03:02] ✅ Patient data extraction completed successfully
[15:03:02] ✅    ✅ Patient data extracted successfully
[15:03:02] 📊 Patient Response
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: SN, telehealth
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:02] ✅    ✅ Patient identified: Joanne Medeiros
[15:03:02] ✅    ✅ Patient name validation passed
[15:03:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:02] [DOC: 9227370] ℹ️  DOB normalized: 12/09/1952
[15:03:02] [DOC: 9227370] ℹ️  Episode startOfCare normalized: 01/15/2025
[15:03:02] [DOC: 9227370] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[15:03:02] [DOC: 9227370] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[15:03:02] [DOC: 9227370] ✅ Patient date processing completed successfully
[15:03:02] ✅    ✅ Date processing completed
[15:03:02] 📊 Processed Patient Data
     └─ patientFName: Joanne
     └─ patientLName: Medeiros
     └─ dob: 12/09/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5843015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: SN, telehealth
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:02] 🔄 
🔄 Step 4: Extracting order data...
[15:03:05] ℹ️  Order extraction - MRN: ''
[15:03:05] ℹ️  Order extraction - Sex: 'FEMALE'
[15:03:05] ℹ️  Order extraction - Service Line: 'SN'
[15:03:05] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[15:03:05] ✅ Order data extraction completed successfully
[15:03:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:05] ℹ️  Using MRN from patient data: '5843015'
[15:03:05] ℹ️  Combined service lines: Patient='SN, telehealth' + Order='SN' = 'SN, telehealth'
[15:03:05] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[15:03:05] ✅ Patient name cross-validation successful
[15:03:05] ✅    ✅ Data merged successfully
[15:03:06] ✅    ✅ Order data extracted and validated
[15:03:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:12] [DOC: 9227370] ℹ️  Patient not found in cache or API: Joanne Medeiros
[15:03:12] [DOC: 9227370] ℹ️  Patient not found, creating new patient via API...
[15:03:12] [DOC: 9227370] ℹ️  Creating patient via API: Joanne Medeiros
[15:03:13] [DOC: 9227370] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:03:13] ❌    ❌ Failed to create patient
[15:03:13] [DOC: 9227370] ℹ️  API push details saved for document 9227370
================================================================================
║                        Processing Document ID: 9227368                         ║
================================================================================
[15:03:13] ℹ️  Agency: Dartmouth HH
[15:03:13] ℹ️  Date: 04/08/2025
[15:03:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:16] [DOC: 9227368] ✅ Text extracted using pdfplumber (4052 chars)
[15:03:16] ✅    ✅ Text extracted using pdfplumber (4052 chars)
[15:03:16] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:18] ℹ️  AI extracted raw sex value: 'M'
[15:03:18] ℹ️  AI extracted service line: 'OT, MSW, RN'
[15:03:18] ℹ️  AI extracted payer source: 'Medicare'
[15:03:18] ℹ️  AI extracted diagnoses:
[15:03:18] ℹ️    - Diagnosis 1: 'A04.7'
[15:03:18] ℹ️    - Diagnosis 2: ''
[15:03:18] ℹ️    - Diagnosis 3: ''
[15:03:18] ℹ️    - Diagnosis 4: ''
[15:03:18] ℹ️    - Diagnosis 5: ''
[15:03:18] ℹ️    - Diagnosis 6: ''
[15:03:18] ℹ️  Final extracted MRN: '1396009'
[15:03:18] ℹ️  Final extracted Sex: 'MALE'
[15:03:18] ℹ️  Final extracted Service Line: 'OT, MSW, RN'
[15:03:18] ℹ️  Final extracted Payer Source: 'Medicare'
[15:03:18] ✅ Patient data extraction completed successfully
[15:03:18] ✅    ✅ Patient data extracted successfully
[15:03:18] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, MSW, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'A04.7', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:18] ✅    ✅ Patient identified: Elias Ramos
[15:03:18] ✅    ✅ Patient name validation passed
[15:03:18] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:18] [DOC: 9227368] ℹ️  DOB normalized: 08/28/1938
[15:03:18] [DOC: 9227368] ℹ️  Episode startOfCare normalized: 03/01/2025
[15:03:18] [DOC: 9227368] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[15:03:18] [DOC: 9227368] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[15:03:18] [DOC: 9227368] ✅ Patient date processing completed successfully
[15:03:18] ✅    ✅ Date processing completed
[15:03:18] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, MSW, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'A04.7', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:18] 🔄 
🔄 Step 4: Extracting order data...
[15:03:21] ℹ️  Order extraction - MRN: '1396009'
[15:03:21] ℹ️  Order extraction - Sex: 'MALE'
[15:03:21] ℹ️  Order extraction - Service Line: 'OT, MSW'
[15:03:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:03:21] ✅ Order data extraction completed successfully
[15:03:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:21] ℹ️  Using MRN from patient data: '1396009' over '1396009'
[15:03:21] ℹ️  Combined service lines: Patient='OT, MSW, RN' + Order='OT, MSW' = 'MSW, OT, RN'
[15:03:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:03:21] ✅ Patient name cross-validation successful
[15:03:21] ✅    ✅ Data merged successfully
[15:03:22] ✅    ✅ Order data extracted and validated
[15:03:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:22] [DOC: 9227368] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[15:03:22] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[15:03:22] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:22] [DOC: 9227368] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[15:03:23] [DOC: 9227368] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:03:23] ❌    ❌ Failed to push order
[15:03:23] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:23] [DOC: 9227368] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[15:03:23] [DOC: 9227368] ℹ️  Service Line extracted: 'MSW, OT, RN'
[15:03:23] [DOC: 9227368] ℹ️  Payer Source extracted: 'Medicare'
[15:03:23] [DOC: 9227368] ℹ️  Diagnosis codes being written:
[15:03:23] [DOC: 9227368] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.7'
[15:03:23] [DOC: 9227368] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:03:23] [DOC: 9227368] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:03:23] [DOC: 9227368] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:03:23] [DOC: 9227368] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:23] [DOC: 9227368] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:23] [DOC: 9227368] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: MSW, OT, RN | Payer: Medicare | MRN: 1396009
[15:03:23] ✅    ✅ Document 9227368 processed and saved successfully
[15:03:23] 🔄 
🔄 Step 8: Saving API details...
[15:03:23] [DOC: 9227368] ℹ️  API push details saved for document 9227368
[15:03:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227362                         ║
================================================================================
[15:03:23] ℹ️  Agency: Dartmouth HH
[15:03:23] ℹ️  Date: 04/08/2025
[15:03:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:28] [DOC: 9227362] ✅ Text extracted using pdfplumber (6580 chars)
[15:03:28] ✅    ✅ Text extracted using pdfplumber (6580 chars)
[15:03:28] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:31] ℹ️  AI extracted raw sex value: 'F'
[15:03:31] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[15:03:31] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[15:03:31] ℹ️  AI extracted diagnoses:
[15:03:31] ℹ️    - Diagnosis 1: ''
[15:03:31] ℹ️    - Diagnosis 2: ''
[15:03:31] ℹ️    - Diagnosis 3: ''
[15:03:31] ℹ️    - Diagnosis 4: ''
[15:03:31] ℹ️    - Diagnosis 5: ''
[15:03:31] ℹ️    - Diagnosis 6: ''
[15:03:31] ℹ️  Final extracted MRN: '5711015'
[15:03:31] ℹ️  Final extracted Sex: 'FEMALE'
[15:03:31] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[15:03:31] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:03:31] ✅ Patient data extraction completed successfully
[15:03:31] ✅    ✅ Patient data extracted successfully
[15:03:31] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ascensao
     └─ dob: 11/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5711015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:31] ✅    ✅ Patient identified: Maria Ascensao
[15:03:31] ✅    ✅ Patient name validation passed
[15:03:31] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:31] [DOC: 9227362] ℹ️  DOB normalized: 11/21/1941
[15:03:31] [DOC: 9227362] ℹ️  Episode startOfCare normalized: 03/28/2025
[15:03:31] [DOC: 9227362] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[15:03:31] [DOC: 9227362] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[15:03:31] [DOC: 9227362] ✅ Patient date processing completed successfully
[15:03:31] ✅    ✅ Date processing completed
[15:03:31] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ascensao
     └─ dob: 11/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5711015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:31] 🔄 
🔄 Step 4: Extracting order data...
[15:03:34] ℹ️  Order extraction - MRN: '5711015'
[15:03:34] ℹ️  Order extraction - Sex: 'FEMALE'
[15:03:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[15:03:34] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:03:34] ✅ Order data extraction completed successfully
[15:03:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:34] ℹ️  Using MRN from patient data: '5711015' over '5711015'
[15:03:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[15:03:34] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[15:03:34] ✅ Patient name cross-validation successful
[15:03:34] ✅    ✅ Data merged successfully
[15:03:35] ✅    ✅ Order data extracted and validated
[15:03:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:35] [DOC: 9227362] ✅ Patient found in local cache: Maria Ascensao, ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[15:03:35] ✅    ✅ Existing patient found with ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[15:03:35] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:35] [DOC: 9227362] ℹ️  Pushing order via API for patient ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[15:03:36] [DOC: 9227362] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:03:36] ❌    ❌ Failed to push order
[15:03:36] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:36] [DOC: 9227362] ℹ️  Calculated age: 83 from DOB: 11/21/1941
[15:03:36] [DOC: 9227362] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[15:03:36] [DOC: 9227362] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[15:03:36] [DOC: 9227362] ℹ️  Diagnosis codes being written:
[15:03:36] [DOC: 9227362] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:03:36] [DOC: 9227362] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:03:36] [DOC: 9227362] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:03:36] [DOC: 9227362] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:03:36] [DOC: 9227362] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:36] [DOC: 9227362] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:36] [DOC: 9227362] ✅ Patient data written to CSV: Maria Ascensao | Sex: FEMALE | Age: 83 | Service: Skilled Nursing, Physical Therapy | Payer: Tufts Health Plan Medicare Preferred | MRN: 5711015
[15:03:36] ✅    ✅ Document 9227362 processed and saved successfully
[15:03:36] 🔄 
🔄 Step 8: Saving API details...
[15:03:36] [DOC: 9227362] ℹ️  API push details saved for document 9227362
[15:03:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227359                         ║
================================================================================
[15:03:36] ℹ️  Agency: Dartmouth HH
[15:03:36] ℹ️  Date: 04/08/2025
[15:03:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:38] [DOC: 9227359] ✅ Text extracted using pdfplumber (4777 chars)
[15:03:38] ✅    ✅ Text extracted using pdfplumber (4777 chars)
[15:03:38] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:41] ℹ️  AI extracted raw sex value: 'F'
[15:03:41] ℹ️  AI extracted service line: 'ST, RN'
[15:03:41] ℹ️  AI extracted payer source: 'Medicare'
[15:03:41] ℹ️  AI extracted diagnoses:
[15:03:41] ℹ️    - Diagnosis 1: 'J10.1'
[15:03:41] ℹ️    - Diagnosis 2: 'J18.9'
[15:03:41] ℹ️    - Diagnosis 3: 'J44.1'
[15:03:41] ℹ️    - Diagnosis 4: 'Rhabdomyolysis'
[15:03:41] ℹ️    - Diagnosis 5: ''
[15:03:41] ℹ️    - Diagnosis 6: ''
[15:03:41] ℹ️  Final extracted MRN: '6222015'
[15:03:41] ℹ️  Final extracted Sex: 'FEMALE'
[15:03:41] ℹ️  Final extracted Service Line: 'ST, RN'
[15:03:41] ℹ️  Final extracted Payer Source: 'Medicare'
[15:03:41] ✅ Patient data extraction completed successfully
[15:03:41] ✅    ✅ Patient data extracted successfully
[15:03:41] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Vieira
     └─ dob: 10/23/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6222015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: ST, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '03/10/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'Rhabdomyolysis', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:41] ✅    ✅ Patient identified: Theresa Vieira
[15:03:41] ✅    ✅ Patient name validation passed
[15:03:41] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:41] [DOC: 9227359] ℹ️  DOB normalized: 10/23/1953
[15:03:41] [DOC: 9227359] ℹ️  Episode startOfCare normalized: 03/20/2025
[15:03:41] [DOC: 9227359] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[15:03:41] [DOC: 9227359] ℹ️  Episode endOfEpisode normalized: 03/10/2025
[15:03:41] [DOC: 9227359] ✅ Patient date processing completed successfully
[15:03:41] ✅    ✅ Date processing completed
[15:03:41] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Vieira
     └─ dob: 10/23/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6222015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: ST, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '03/10/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'Rhabdomyolysis', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:41] 🔄 
🔄 Step 4: Extracting order data...
[15:03:44] ℹ️  Order extraction - MRN: ''
[15:03:44] ℹ️  Order extraction - Sex: 'FEMALE'
[15:03:44] ℹ️  Order extraction - Service Line: 'ST, RN'
[15:03:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:03:44] ✅ Order data extraction completed successfully
[15:03:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:44] ℹ️  Using MRN from patient data: '6222015'
[15:03:44] ℹ️  Service line consistent in both sources: 'ST, RN'
[15:03:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:03:44] ✅ Patient name cross-validation successful
[15:03:44] ✅    ✅ Data merged successfully
[15:03:45] ✅    ✅ Order data extracted and validated
[15:03:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:45] [DOC: 9227359] ✅ Patient found in local cache: Theresa Vieira, ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[15:03:45] ✅    ✅ Existing patient found with ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[15:03:45] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:45] [DOC: 9227359] ℹ️  Pushing order via API for patient ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[15:03:46] [DOC: 9227359] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14258"}
[15:03:46] ❌    ❌ Failed to push order
[15:03:46] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:46] [DOC: 9227359] ℹ️  Calculated age: 71 from DOB: 10/23/1953
[15:03:46] [DOC: 9227359] ℹ️  Service Line extracted: 'ST, RN'
[15:03:46] [DOC: 9227359] ℹ️  Payer Source extracted: 'Medicare'
[15:03:46] [DOC: 9227359] ℹ️  Diagnosis codes being written:
[15:03:46] [DOC: 9227359] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.1'
[15:03:46] [DOC: 9227359] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[15:03:46] [DOC: 9227359] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[15:03:46] [DOC: 9227359] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Rhabdomyolysis'
[15:03:46] [DOC: 9227359] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:46] [DOC: 9227359] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:46] [DOC: 9227359] ✅ Patient data written to CSV: Theresa Vieira | Sex: FEMALE | Age: 71 | Service: ST, RN | Payer: Medicare | MRN: 6222015
[15:03:46] ✅    ✅ Document 9227359 processed and saved successfully
[15:03:46] 🔄 
🔄 Step 8: Saving API details...
[15:03:46] [DOC: 9227359] ℹ️  API push details saved for document 9227359
[15:03:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227353                         ║
================================================================================
[15:03:46] ℹ️  Agency: Dartmouth HH
[15:03:46] ℹ️  Date: 04/08/2025
[15:03:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:49] [DOC: 9227353] ✅ Text extracted using pdfplumber (1121 chars)
[15:03:49] ✅    ✅ Text extracted using pdfplumber (1121 chars)
[15:03:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:52] ℹ️  AI extracted raw sex value: 'F'
[15:03:52] ℹ️  AI extracted service line: 'OT'
[15:03:52] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[15:03:52] ℹ️  AI extracted diagnoses:
[15:03:52] ℹ️    - Diagnosis 1: ''
[15:03:52] ℹ️    - Diagnosis 2: ''
[15:03:52] ℹ️    - Diagnosis 3: ''
[15:03:52] ℹ️    - Diagnosis 4: ''
[15:03:52] ℹ️    - Diagnosis 5: ''
[15:03:52] ℹ️    - Diagnosis 6: ''
[15:03:52] ℹ️  Final extracted MRN: '6073015'
[15:03:52] ℹ️  Final extracted Sex: 'FEMALE'
[15:03:52] ℹ️  Final extracted Service Line: 'OT'
[15:03:52] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[15:03:52] ✅ Patient data extraction completed successfully
[15:03:52] ✅    ✅ Patient data extracted successfully
[15:03:52] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:52] ✅    ✅ Patient identified: Marilyn Valle
[15:03:52] ✅    ✅ Patient name validation passed
[15:03:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:52] [DOC: 9227353] ℹ️  DOB normalized: 12/24/1947
[15:03:52] [DOC: 9227353] ℹ️  Episode startOfCare normalized: 02/22/2025
[15:03:52] [DOC: 9227353] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[15:03:52] [DOC: 9227353] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[15:03:52] [DOC: 9227353] ✅ Patient date processing completed successfully
[15:03:52] ✅    ✅ Date processing completed
[15:03:52] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Aetna- Mcare
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:52] 🔄 
🔄 Step 4: Extracting order data...
[15:03:54] ℹ️  Order extraction - MRN: ''
[15:03:54] ℹ️  Order extraction - Sex: 'FEMALE'
[15:03:54] ℹ️  Order extraction - Service Line: 'OT'
[15:03:54] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[15:03:54] ✅ Order data extraction completed successfully
[15:03:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:54] ℹ️  Using MRN from patient data: '6073015'
[15:03:54] ℹ️  Service line consistent in both sources: 'OT'
[15:03:54] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[15:03:54] ✅ Patient name cross-validation successful
[15:03:54] ✅    ✅ Data merged successfully
[15:03:55] ✅    ✅ Order data extracted and validated
[15:03:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:55] [DOC: 9227353] ✅ Patient found in local cache: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[15:03:55] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[15:03:55] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:55] [DOC: 9227353] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[15:03:57] [DOC: 9227353] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:03:57] ❌    ❌ Failed to push order
[15:03:57] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:57] [DOC: 9227353] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[15:03:57] [DOC: 9227353] ℹ️  Service Line extracted: 'OT'
[15:03:57] [DOC: 9227353] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[15:03:57] [DOC: 9227353] ℹ️  Diagnosis codes being written:
[15:03:57] [DOC: 9227353] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:03:57] [DOC: 9227353] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:03:57] [DOC: 9227353] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:03:57] [DOC: 9227353] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:03:57] [DOC: 9227353] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:57] [DOC: 9227353] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:57] [DOC: 9227353] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT | Payer: Aetna- Mcare | MRN: 6073015
[15:03:57] ✅    ✅ Document 9227353 processed and saved successfully
[15:03:57] 🔄 
🔄 Step 8: Saving API details...
[15:03:57] [DOC: 9227353] ℹ️  API push details saved for document 9227353
[15:03:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227352                         ║
================================================================================
[15:03:57] ℹ️  Agency: Dartmouth HH
[15:03:57] ℹ️  Date: 04/08/2025
[15:03:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:59] [DOC: 9227352] ✅ Text extracted using pdfplumber (8263 chars)
[15:03:59] ✅    ✅ Text extracted using pdfplumber (8263 chars)
[15:03:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:04:02] ℹ️  AI extracted raw sex value: 'M'
[15:04:02] ℹ️  AI extracted service line: 'OT'
[15:04:02] ℹ️  AI extracted payer source: 'Medicare'
[15:04:02] ℹ️  AI extracted diagnoses:
[15:04:02] ℹ️    - Diagnosis 1: 'None'
[15:04:02] ℹ️    - Diagnosis 2: 'None'
[15:04:02] ℹ️    - Diagnosis 3: 'None'
[15:04:02] ℹ️    - Diagnosis 4: 'None'
[15:04:02] ℹ️    - Diagnosis 5: 'None'
[15:04:02] ℹ️    - Diagnosis 6: 'None'
[15:04:02] ℹ️  Final extracted MRN: '6190015'
[15:04:02] ℹ️  Final extracted Sex: 'MALE'
[15:04:02] ℹ️  Final extracted Service Line: 'OT'
[15:04:02] ℹ️  Final extracted Payer Source: 'Medicare'
[15:04:02] ✅ Patient data extraction completed successfully
[15:04:02] ✅    ✅ Patient data extracted successfully
[15:04:02] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:04:02] ✅    ✅ Patient identified: John Ostapow
[15:04:02] ✅    ✅ Patient name validation passed
[15:04:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:04:02] [DOC: 9227352] ℹ️  DOB normalized: 11/23/1935
[15:04:02] [DOC: 9227352] ℹ️  Episode startOfCare normalized: 03/12/2025
[15:04:02] [DOC: 9227352] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[15:04:02] [DOC: 9227352] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[15:04:02] [DOC: 9227352] ✅ Patient date processing completed successfully
[15:04:02] ✅    ✅ Date processing completed
[15:04:02] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025'}]
[15:04:02] 🔄 
🔄 Step 4: Extracting order data...
[15:04:05] ℹ️  Order extraction - MRN: ''
[15:04:05] ℹ️  Order extraction - Sex: 'MALE'
[15:04:05] ℹ️  Order extraction - Service Line: 'OT'
[15:04:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:04:05] ✅ Order data extraction completed successfully
[15:04:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:04:05] ℹ️  Using MRN from patient data: '6190015'
[15:04:05] ℹ️  Service line consistent in both sources: 'OT'
[15:04:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:04:05] ✅ Patient name cross-validation successful
[15:04:05] ✅    ✅ Data merged successfully
[15:04:06] ✅    ✅ Order data extracted and validated
[15:04:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:04:06] [DOC: 9227352] ✅ Patient found in local cache: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[15:04:06] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[15:04:06] 🔄 
🔄 Step 6: Pushing order to API...
[15:04:06] [DOC: 9227352] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[15:04:08] [DOC: 9227352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:04:08] ❌    ❌ Failed to push order
[15:04:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:04:08] [DOC: 9227352] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[15:04:08] [DOC: 9227352] ℹ️  Service Line extracted: 'OT'
[15:04:08] [DOC: 9227352] ℹ️  Payer Source extracted: 'Medicare'
[15:04:08] [DOC: 9227352] ℹ️  Diagnosis codes being written:
[15:04:08] [DOC: 9227352] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:04:08] [DOC: 9227352] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:04:08] [DOC: 9227352] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:04:08] [DOC: 9227352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:04:08] [DOC: 9227352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:04:08] [DOC: 9227352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:04:08] [DOC: 9227352] ✅ Patient data written to CSV: John Ostapow | Sex: MALE | Age: 89 | Service: OT | Payer: Medicare | MRN: 6190015
[15:04:08] ✅    ✅ Document 9227352 processed and saved successfully
[15:04:08] 🔄 
🔄 Step 8: Saving API details...
[15:04:08] [DOC: 9227352] ℹ️  API push details saved for document 9227352
[15:04:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227349                         ║
================================================================================
[15:04:08] ℹ️  Agency: Dartmouth HH
[15:04:08] ℹ️  Date: 04/08/2025
[15:04:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:04:10] [DOC: 9227349] ✅ Text extracted using pdfplumber (1117 chars)
[15:04:10] ✅    ✅ Text extracted using pdfplumber (1117 chars)
[15:04:10] 🔄 
🔄 Step 2: Extracting patient data...
[15:04:12] ℹ️  AI extracted raw sex value: 'M'
[15:04:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:04:12] ℹ️  AI extracted payer source: 'Medicare'
[15:04:12] ℹ️  AI extracted diagnoses:
[15:04:12] ℹ️    - Diagnosis 1: 'None'
[15:04:12] ℹ️    - Diagnosis 2: 'None'
[15:04:12] ℹ️    - Diagnosis 3: 'None'
[15:04:12] ℹ️    - Diagnosis 4: 'None'
[15:04:12] ℹ️    - Diagnosis 5: 'None'
[15:04:12] ℹ️    - Diagnosis 6: 'None'
[15:04:12] ℹ️  Final extracted MRN: '1396009'
[15:04:12] ℹ️  Final extracted Sex: 'MALE'
[15:04:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:04:12] ℹ️  Final extracted Payer Source: 'Medicare'
[15:04:12] ✅ Patient data extraction completed successfully
[15:04:12] ✅    ✅ Patient data extracted successfully
[15:04:12] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': None, 'endOfEpisode': '02/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:04:12] ✅    ✅ Patient identified: Elias Ramos
[15:04:12] ✅    ✅ Patient name validation passed
[15:04:12] 🔄 
🔄 Step 3: Processing patient dates...
[15:04:12] [DOC: 9227349] ℹ️  DOB normalized: 08/28/1938
[15:04:12] [DOC: 9227349] ℹ️  Episode startOfCare normalized: 12/31/2024
[15:04:12] [DOC: 9227349] ℹ️  Episode endOfEpisode normalized: 02/28/2025
[15:04:12] [DOC: 9227349] ✅ Patient date processing completed successfully
[15:04:12] ✅    ✅ Date processing completed
[15:04:12] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'endOfEpisode': '02/28/2025'}]
[15:04:12] 🔄 
🔄 Step 4: Extracting order data...
[15:04:15] ℹ️  Order extraction - MRN: '1396009'
[15:04:15] ℹ️  Order extraction - Sex: 'MALE'
[15:04:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:04:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:04:15] ✅ Order data extraction completed successfully
[15:04:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:04:15] ℹ️  Using MRN from patient data: '1396009' over '1396009'
[15:04:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:04:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:04:15] ✅ Patient name cross-validation successful
[15:04:15] ✅    ✅ Data merged successfully
[15:04:16] ✅    ✅ Order data extracted and validated
[15:04:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:04:16] [DOC: 9227349] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[15:04:16] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[15:04:16] 🔄 
🔄 Step 6: Pushing order to API...
[15:04:16] [DOC: 9227349] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[15:04:17] [DOC: 9227349] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:04:17] ❌    ❌ Failed to push order
[15:04:17] 🔄 
🔄 Step 7: Writing to CSV...
[15:04:17] [DOC: 9227349] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[15:04:17] [DOC: 9227349] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:04:17] [DOC: 9227349] ℹ️  Payer Source extracted: 'Medicare'
[15:04:17] [DOC: 9227349] ℹ️  Diagnosis codes being written:
[15:04:17] [DOC: 9227349] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:04:17] [DOC: 9227349] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:04:17] [DOC: 9227349] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:04:17] [DOC: 9227349] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:04:17] [DOC: 9227349] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:04:17] [DOC: 9227349] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:04:17] [DOC: 9227349] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: Skilled Nursing | Payer: Medicare | MRN: 1396009
[15:04:17] ✅    ✅ Document 9227349 processed and saved successfully
[15:04:17] 🔄 
🔄 Step 8: Saving API details...
[15:04:17] [DOC: 9227349] ℹ️  API push details saved for document 9227349
[15:04:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227340                         ║
================================================================================
[15:04:17] ℹ️  Agency: Fairhaven HH&H
[15:04:17] ℹ️  Date: 04/08/2025
[15:04:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:04:20] [DOC: 9227340] ✅ Text extracted using pdfplumber (1311 chars)
[15:04:20] ✅    ✅ Text extracted using pdfplumber (1311 chars)
[15:04:20] 🔄 
🔄 Step 2: Extracting patient data...
[15:04:22] ℹ️  AI extracted raw sex value: 'F'
[15:04:22] ℹ️  AI extracted service line: 'HOSPICE'
[15:04:22] ℹ️  AI extracted payer source: 'Medicare'
[15:04:22] ℹ️  AI extracted diagnoses:
[15:04:22] ℹ️    - Diagnosis 1: ''
[15:04:22] ℹ️    - Diagnosis 2: ''
[15:04:22] ℹ️    - Diagnosis 3: ''
[15:04:22] ℹ️    - Diagnosis 4: ''
[15:04:22] ℹ️    - Diagnosis 5: ''
[15:04:22] ℹ️    - Diagnosis 6: ''
[15:04:22] ℹ️  Final extracted MRN: '2406002'
[15:04:22] ℹ️  Final extracted Sex: 'FEMALE'
[15:04:22] ℹ️  Final extracted Service Line: 'HOSPICE'
[15:04:22] ℹ️  Final extracted Payer Source: 'Medicare'
[15:04:22] ✅ Patient data extraction completed successfully
[15:04:22] ✅    ✅ Patient data extracted successfully
[15:04:22] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HOSPICE
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:04:22] ✅    ✅ Patient identified: Patricia Lobo
[15:04:22] ✅    ✅ Patient name validation passed
[15:04:22] 🔄 
🔄 Step 3: Processing patient dates...
[15:04:22] [DOC: 9227340] ℹ️  DOB normalized: 02/06/1938
[15:04:22] [DOC: 9227340] ℹ️  Episode startOfCare normalized: 06/05/2024
[15:04:22] [DOC: 9227340] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[15:04:22] [DOC: 9227340] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[15:04:22] [DOC: 9227340] ✅ Patient date processing completed successfully
[15:04:22] ✅    ✅ Date processing completed
[15:04:22] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HOSPICE
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:04:22] 🔄 
🔄 Step 4: Extracting order data...
[15:04:25] ℹ️  Order extraction - MRN: ''
[15:04:25] ℹ️  Order extraction - Sex: 'FEMALE'
[15:04:25] ℹ️  Order extraction - Service Line: 'Hospice'
[15:04:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:04:25] ✅ Order data extraction completed successfully
[15:04:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:04:25] ℹ️  Using MRN from patient data: '2406002'
[15:04:25] ℹ️  Service line consistent in both sources: 'HOSPICE'
[15:04:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:04:25] ✅ Patient name cross-validation successful
[15:04:25] ✅    ✅ Data merged successfully
[15:04:26] ✅    ✅ Order data extracted and validated
[15:04:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:04:26] [DOC: 9227340] ✅ Patient found in local cache: Patricia Lobo, ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[15:04:26] ✅    ✅ Existing patient found with ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[15:04:26] 🔄 
🔄 Step 6: Pushing order to API...
[15:04:26] [DOC: 9227340] ℹ️  Pushing order via API for patient ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[15:04:27] [DOC: 9227340] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13949"}
[15:04:27] ❌    ❌ Failed to push order
[15:04:27] 🔄 
🔄 Step 7: Writing to CSV...
[15:04:27] [DOC: 9227340] ℹ️  Calculated age: 87 from DOB: 02/06/1938
[15:04:27] [DOC: 9227340] ℹ️  Service Line extracted: 'HOSPICE'
[15:04:27] [DOC: 9227340] ℹ️  Payer Source extracted: 'Medicare'
[15:04:27] [DOC: 9227340] ℹ️  Diagnosis codes being written:
[15:04:27] [DOC: 9227340] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:04:27] [DOC: 9227340] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:04:27] [DOC: 9227340] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:04:27] [DOC: 9227340] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:04:27] [DOC: 9227340] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:04:27] [DOC: 9227340] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:04:27] [DOC: 9227340] ✅ Patient data written to CSV: Patricia Lobo | Sex: FEMALE | Age: 87 | Service: HOSPICE | Payer: Medicare | MRN: 2406002
[15:04:27] ✅    ✅ Document 9227340 processed and saved successfully
[15:04:27] 🔄 
🔄 Step 8: Saving API details...
[15:04:27] [DOC: 9227340] ℹ️  API push details saved for document 9227340
[15:04:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227275                         ║
================================================================================
[15:04:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:04:27] ℹ️  Date: 04/08/2025
[15:04:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:04:29] [DOC: 9227275] ✅ Text extracted using pdfplumber (1569 chars)
[15:04:29] ✅    ✅ Text extracted using pdfplumber (1569 chars)
[15:04:29] 🔄 
🔄 Step 2: Extracting patient data...
[15:04:32] ℹ️  AI extracted raw sex value: 'M'
[15:04:32] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[15:04:32] ℹ️  AI extracted payer source: ''
[15:04:32] ℹ️  AI extracted diagnoses:
[15:04:32] ℹ️    - Diagnosis 1: 'None'
[15:04:32] ℹ️    - Diagnosis 2: 'None'
[15:04:32] ℹ️    - Diagnosis 3: 'None'
[15:04:32] ℹ️    - Diagnosis 4: 'None'
[15:04:32] ℹ️    - Diagnosis 5: 'None'
[15:04:32] ℹ️    - Diagnosis 6: 'None'
[15:04:32] ℹ️  Final extracted MRN: '2773750'
[15:04:32] ℹ️  Final extracted Sex: 'MALE'
[15:04:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[15:04:32] ℹ️  Final extracted Payer Source: ''
[15:04:32] ✅ Patient data extraction completed successfully
[15:04:32] ✅    ✅ Patient data extracted successfully
[15:04:32] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:04:32] ✅    ✅ Patient identified: Luis Mota
[15:04:32] ✅    ✅ Patient name validation passed
[15:04:32] 🔄 
🔄 Step 3: Processing patient dates...
[15:04:32] [DOC: 9227275] ℹ️  DOB normalized: 12/02/1942
[15:04:32] [DOC: 9227275] ✅ Patient date processing completed successfully
[15:04:32] ✅    ✅ Date processing completed
[15:04:32] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:04:32] 🔄 
🔄 Step 4: Extracting order data...
[15:04:34] ℹ️  Order extraction - MRN: '2773750'
[15:04:34] ℹ️  Order extraction - Sex: 'MALE'
[15:04:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[15:04:34] ℹ️  Order extraction - Payer Source: ''
[15:04:34] ✅ Order data extraction completed successfully
[15:04:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:04:34] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[15:04:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide'
[15:04:34] ✅ Patient name cross-validation successful
[15:04:34] ✅    ✅ Data merged successfully
[15:04:36] ✅    ✅ Order data extracted and validated
[15:04:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:04:43] [DOC: 9227275] ℹ️  Patient not found in cache or API: Luis Mota
[15:04:43] [DOC: 9227275] ℹ️  Patient not found, creating new patient via API...
[15:04:43] [DOC: 9227275] ℹ️  Creating patient via API: Luis Mota
[15:04:44] [DOC: 9227275] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:04:44] ❌    ❌ Failed to create patient
[15:04:44] [DOC: 9227275] ℹ️  API push details saved for document 9227275
================================================================================
║                        Processing Document ID: 9227271                         ║
================================================================================
[15:04:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:04:44] ℹ️  Date: 04/08/2025
[15:04:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:04:45] [DOC: 9227271] ✅ Text extracted using pdfplumber (1110 chars)
[15:04:45] ✅    ✅ Text extracted using pdfplumber (1110 chars)
[15:04:45] 🔄 
🔄 Step 2: Extracting patient data...
[15:04:48] ℹ️  AI extracted raw sex value: 'M'
[15:04:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:04:48] ℹ️  AI extracted payer source: ''
[15:04:48] ℹ️  AI extracted diagnoses:
[15:04:48] ℹ️    - Diagnosis 1: ''
[15:04:48] ℹ️    - Diagnosis 2: ''
[15:04:48] ℹ️    - Diagnosis 3: ''
[15:04:48] ℹ️    - Diagnosis 4: ''
[15:04:48] ℹ️    - Diagnosis 5: ''
[15:04:48] ℹ️    - Diagnosis 6: ''
[15:04:48] ℹ️  Final extracted MRN: '2714441'
[15:04:48] ℹ️  Final extracted Sex: 'MALE'
[15:04:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:04:48] ℹ️  Final extracted Payer Source: ''
[15:04:48] ✅ Patient data extraction completed successfully
[15:04:48] ✅    ✅ Patient data extracted successfully
[15:04:48] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: McCarthy
     └─ dob: 02/04/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2714441
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:04:48] ✅    ✅ Patient identified: Dennis McCarthy
[15:04:48] ✅    ✅ Patient name validation passed
[15:04:48] 🔄 
🔄 Step 3: Processing patient dates...
[15:04:48] [DOC: 9227271] ℹ️  DOB normalized: 02/04/1943
[15:04:48] [DOC: 9227271] ✅ Patient date processing completed successfully
[15:04:48] ✅    ✅ Date processing completed
[15:04:48] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: McCarthy
     └─ dob: 02/04/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 2714441
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:04:48] 🔄 
🔄 Step 4: Extracting order data...
[15:04:50] ℹ️  Order extraction - MRN: '2714441'
[15:04:50] ℹ️  Order extraction - Sex: 'MALE'
[15:04:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:04:50] ℹ️  Order extraction - Payer Source: ''
[15:04:50] ✅ Order data extraction completed successfully
[15:04:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:04:50] ℹ️  Using MRN from patient data: '2714441' over '2714441'
[15:04:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:04:50] ✅ Patient name cross-validation successful
[15:04:50] ✅    ✅ Data merged successfully
[15:04:52] ✅    ✅ Order data extracted and validated
[15:04:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:04:56] [DOC: 9227271] ℹ️  Patient not found in cache or API: Dennis McCarthy
[15:04:56] [DOC: 9227271] ℹ️  Patient not found, creating new patient via API...
[15:04:56] [DOC: 9227271] ℹ️  Creating patient via API: Dennis McCarthy
[15:04:57] [DOC: 9227271] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:04:57] ❌    ❌ Failed to create patient
[15:04:57] [DOC: 9227271] ℹ️  API push details saved for document 9227271
================================================================================
║                        Processing Document ID: 9227268                         ║
================================================================================
[15:04:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:04:57] ℹ️  Date: 04/08/2025
[15:04:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:04:59] [DOC: 9227268] ✅ Text extracted using pdfplumber (3498 chars)
[15:04:59] ✅    ✅ Text extracted using pdfplumber (3498 chars)
[15:04:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:05:02] ℹ️  AI extracted raw sex value: 'F'
[15:05:02] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[15:05:02] ℹ️  AI extracted payer source: ''
[15:05:02] ℹ️  AI extracted diagnoses:
[15:05:02] ℹ️    - Diagnosis 1: ''
[15:05:02] ℹ️    - Diagnosis 2: ''
[15:05:02] ℹ️    - Diagnosis 3: ''
[15:05:02] ℹ️    - Diagnosis 4: ''
[15:05:02] ℹ️    - Diagnosis 5: ''
[15:05:02] ℹ️    - Diagnosis 6: ''
[15:05:02] ℹ️  Final extracted MRN: '2687695'
[15:05:02] ℹ️  Final extracted Sex: 'FEMALE'
[15:05:02] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[15:05:02] ℹ️  Final extracted Payer Source: ''
[15:05:02] ✅ Patient data extraction completed successfully
[15:05:02] ✅    ✅ Patient data extracted successfully
[15:05:02] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:05:02] ✅    ✅ Patient identified: Maria Maiato
[15:05:02] ✅    ✅ Patient name validation passed
[15:05:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:05:02] [DOC: 9227268] ℹ️  DOB normalized: 03/29/1952
[15:05:02] [DOC: 9227268] ✅ Patient date processing completed successfully
[15:05:02] ✅    ✅ Date processing completed
[15:05:02] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:05:02] 🔄 
🔄 Step 4: Extracting order data...
[15:05:05] ℹ️  Order extraction - MRN: '2687695'
[15:05:05] ℹ️  Order extraction - Sex: 'FEMALE'
[15:05:05] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[15:05:05] ℹ️  Order extraction - Payer Source: ''
[15:05:05] ✅ Order data extraction completed successfully
[15:05:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:05:05] ℹ️  Using MRN from patient data: '2687695' over '2687695'
[15:05:05] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing'
[15:05:05] ✅ Patient name cross-validation successful
[15:05:05] ✅    ✅ Data merged successfully
[15:05:06] ✅    ✅ Order data extracted and validated
[15:05:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:05:06] [DOC: 9227268] ✅ Patient found in local cache: Maria Maiato, ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[15:05:06] ✅    ✅ Existing patient found with ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[15:05:06] 🔄 
🔄 Step 6: Pushing order to API...
[15:05:06] [DOC: 9227268] ℹ️  Pushing order via API for patient ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[15:05:08] [DOC: 9227268] ❌ Order push failed with status 201: {"id":"40aaf23e-e4a3-4465-8fb6-953983b3f2b1","orderWAVId":"ORD20051","orderNo":"1078998, 1078999, 1079201, 1079344, 1079503","orderDate":"04/05/2025","startOfCare":"04/04/2025","episodeStartDate":"04/04/2025","episodeEndDate":"05/03/2025","documentID":"9227268","mrn":"2687695","patientName":"Maiato,Maria A.","sentToPhysicianDate":"04/08/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/15/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"a92d350b-6287-4f07-a2c9-09b4c329691a","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:05:08] ❌    ❌ Failed to push order
[15:05:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:05:08] [DOC: 9227268] ℹ️  Calculated age: 73 from DOB: 03/29/1952
[15:05:08] [DOC: 9227268] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[15:05:08] [DOC: 9227268] ℹ️  Payer Source extracted: ''
[15:05:08] [DOC: 9227268] ℹ️  Diagnosis codes being written:
[15:05:08] [DOC: 9227268] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:05:08] [DOC: 9227268] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:05:08] [DOC: 9227268] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:05:08] [DOC: 9227268] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:05:08] [DOC: 9227268] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:05:08] [DOC: 9227268] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:05:08] [DOC: 9227268] ✅ Patient data written to CSV: Maria Maiato | Sex: FEMALE | Age: 73 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 2687695
[15:05:08] ✅    ✅ Document 9227268 processed and saved successfully
[15:05:08] 🔄 
🔄 Step 8: Saving API details...
[15:05:08] [DOC: 9227268] ℹ️  API push details saved for document 9227268
[15:05:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9227267                         ║
================================================================================
[15:05:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:05:08] ℹ️  Date: 04/08/2025
[15:05:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:05:09] [DOC: 9227267] ✅ Text extracted using pdfplumber (1053 chars)
[15:05:09] ✅    ✅ Text extracted using pdfplumber (1053 chars)
[15:05:09] 🔄 
🔄 Step 2: Extracting patient data...
[15:05:12] ℹ️  AI extracted raw sex value: 'F'
[15:05:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:05:12] ℹ️  AI extracted payer source: ''
[15:05:12] ℹ️  AI extracted diagnoses:
[15:05:12] ℹ️    - Diagnosis 1: ''
[15:05:12] ℹ️    - Diagnosis 2: ''
[15:05:12] ℹ️    - Diagnosis 3: ''
[15:05:12] ℹ️    - Diagnosis 4: ''
[15:05:12] ℹ️    - Diagnosis 5: ''
[15:05:12] ℹ️    - Diagnosis 6: ''
[15:05:12] ℹ️  Final extracted MRN: '3132958'
[15:05:12] ℹ️  Final extracted Sex: 'FEMALE'
[15:05:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:05:12] ℹ️  Final extracted Payer Source: ''
[15:05:12] ✅ Patient data extraction completed successfully
[15:05:12] ✅    ✅ Patient data extracted successfully
[15:05:12] 📊 Patient Response
     └─ patientFName: Sally
     └─ patientLName: Mabray
     └─ dob: 05/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3132958
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:05:12] ✅    ✅ Patient identified: Sally Mabray
[15:05:12] ✅    ✅ Patient name validation passed
[15:05:12] 🔄 
🔄 Step 3: Processing patient dates...
[15:05:12] [DOC: 9227267] ℹ️  DOB normalized: 05/06/1938
[15:05:12] [DOC: 9227267] ✅ Patient date processing completed successfully
[15:05:12] ✅    ✅ Date processing completed
[15:05:12] 📊 Processed Patient Data
     └─ patientFName: Sally
     └─ patientLName: Mabray
     └─ dob: 05/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3132958
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:05:12] 🔄 
🔄 Step 4: Extracting order data...
[15:05:14] ℹ️  Order extraction - MRN: '3132958'
[15:05:14] ℹ️  Order extraction - Sex: 'FEMALE'
[15:05:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:05:14] ℹ️  Order extraction - Payer Source: ''
[15:05:14] ✅ Order data extraction completed successfully
[15:05:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:05:14] ℹ️  Using MRN from patient data: '3132958' over '3132958'
[15:05:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:05:14] ✅ Patient name cross-validation successful
[15:05:14] ✅    ✅ Data merged successfully
[15:05:15] ✅    ✅ Order data extracted and validated
[15:05:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:05:21] [DOC: 9227267] ℹ️  Patient not found in cache or API: Sally Mabray
[15:05:21] [DOC: 9227267] ℹ️  Patient not found, creating new patient via API...
[15:05:21] [DOC: 9227267] ℹ️  Creating patient via API: Sally Mabray
[15:05:22] [DOC: 9227267] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:05:22] ❌    ❌ Failed to create patient
[15:05:22] [DOC: 9227267] ℹ️  API push details saved for document 9227267
================================================================================
║                        Processing Document ID: 9227239                         ║
================================================================================
[15:05:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:05:22] ℹ️  Date: 04/08/2025
[15:05:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:05:23] [DOC: 9227239] ✅ Text extracted using pdfplumber (1038 chars)
[15:05:23] ✅    ✅ Text extracted using pdfplumber (1038 chars)
[15:05:23] 🔄 
🔄 Step 2: Extracting patient data...
[15:05:26] ℹ️  AI extracted raw sex value: 'F'
[15:05:26] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:05:26] ℹ️  AI extracted payer source: ''
[15:05:26] ℹ️  AI extracted diagnoses:
[15:05:26] ℹ️    - Diagnosis 1: ''
[15:05:26] ℹ️    - Diagnosis 2: ''
[15:05:26] ℹ️    - Diagnosis 3: ''
[15:05:26] ℹ️    - Diagnosis 4: ''
[15:05:26] ℹ️    - Diagnosis 5: ''
[15:05:26] ℹ️    - Diagnosis 6: ''
[15:05:26] ℹ️  Final extracted MRN: '2102046'
[15:05:26] ℹ️  Final extracted Sex: 'FEMALE'
[15:05:26] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:05:26] ℹ️  Final extracted Payer Source: ''
[15:05:26] ✅ Patient data extraction completed successfully
[15:05:26] ✅    ✅ Patient data extracted successfully
[15:05:26] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:05:26] ✅    ✅ Patient identified: Maria Cunha
[15:05:26] ✅    ✅ Patient name validation passed
[15:05:26] 🔄 
🔄 Step 3: Processing patient dates...
[15:05:26] [DOC: 9227239] ℹ️  DOB normalized: 06/04/1930
[15:05:26] [DOC: 9227239] ✅ Patient date processing completed successfully
[15:05:26] ✅    ✅ Date processing completed
[15:05:26] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:05:26] 🔄 
🔄 Step 4: Extracting order data...
[15:05:29] ℹ️  Order extraction - MRN: '2102046'
[15:05:29] ℹ️  Order extraction - Sex: 'FEMALE'
[15:05:29] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:05:29] ℹ️  Order extraction - Payer Source: ''
[15:05:29] ✅ Order data extraction completed successfully
[15:05:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:05:29] ℹ️  Using MRN from patient data: '2102046' over '2102046'
[15:05:29] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:05:29] ✅ Patient name cross-validation successful
[15:05:29] ✅    ✅ Data merged successfully
[15:05:30] ✅    ✅ Order data extracted and validated
[15:05:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:05:54] [DOC: 9227239] ℹ️  Patient not found in cache or API: Maria Cunha
[15:05:54] [DOC: 9227239] ℹ️  Patient not found, creating new patient via API...
[15:05:54] [DOC: 9227239] ℹ️  Creating patient via API: Maria Cunha
[15:05:55] [DOC: 9227239] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:05:55] ❌    ❌ Failed to create patient
[15:05:55] [DOC: 9227239] ℹ️  API push details saved for document 9227239
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[15:05:55] ℹ️  Total Processed: 100
[15:05:55] ℹ️  CSV Success: 65
[15:05:55] ℹ️  CSV Errors: 10
[15:05:55] ℹ️  API Success: 0
[15:05:55] ℹ️  API Errors: 90
[15:05:55] ℹ️  CSV Success Rate: 65.0%
[15:05:55] ℹ️  API Success Rate: 0.0%
[15:05:55] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_142642.csv
[15:05:55] ℹ️  API Details File: api_outputs/api_push_details_20250608_142642.csv
================================================================================
║          ============================================================          ║
================================================================================
