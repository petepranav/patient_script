================================================================================
â•‘                   PATIENT DATA PIPELINE - PROCESSING STARTED                   â•‘
================================================================================
[19:25:53] â„¹ï¸  Processing CSV file: orders.csv
================================================================================
â•‘                          PROCESSING DOCUMENT 9269173                           â•‘
================================================================================
[19:25:53] [DOC: 9269173] â„¹ï¸  Facility/Agency: Brockton Home Health Care | Received Date: 04/30/2025
[19:25:53] [DOC: 9269173] âš ï¸  Agency 'Brockton Home Health Care' not found in company mapping
[19:25:53] [DOC: 9269173] ğŸ“‹ [1/4] Extracting text from PDF
[19:25:56] â„¹ï¸  Document appears to be scanned - using OCR pipeline
[19:25:56] â„¹ï¸  Document is text-based - using pdfplumber for extraction
[19:25:56] [DOC: 9269173] âœ… Text extraction completed
[19:25:56] [DOC: 9269173] ğŸ“„ NON-FAXED DOCUMENT | Type: ORDER
[19:25:56] [DOC: 9269173] ğŸ“Š Document Information
     â””â”€ Faxed: No
     â””â”€ Fax Source: N/A
     â””â”€ Document Type: ORDER
[19:25:56] [DOC: 9269173] ğŸ“‹ [2/6] Extracting patient data using AI
[19:25:59] [DOC: 9269173] ğŸ“Š AI-Extracted Patient Data
     â””â”€ patientFName: Christine
     â””â”€ patientLName: Thompson
     â””â”€ dob: 08/05/1973
     â””â”€ patientSex: Female
     â””â”€ medicalRecordNo: BHHA1887826
     â””â”€ billingProvider: Thorpe, Bianca D.O.
     â””â”€ physicianNPI: 1518278449
     â””â”€ nameOfAgency: Brockton Home Health Agency
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[19:25:59] [DOC: 9269173] ğŸ“Š Raw Episode Dates from Document
     â””â”€ Start of Care: Not found
     â””â”€ Start of Episode: 04/09/2025
     â””â”€ End of Episode: 06/07/2025
[19:25:59] [DOC: 9269173] ğŸ“Š Parsed Episode Dates
     â””â”€ Start of Care: 04/09/2025
     â””â”€ Start of Episode: 04/09/2025
     â””â”€ End of Episode: 06/07/2025
[19:25:59] [DOC: 9269173] ğŸ“Š Patient Data After Date Processing
     â””â”€ patientFName: Christine
     â””â”€ patientLName: Thompson
     â””â”€ dob: 08/05/1973
     â””â”€ patientSex: Female
     â””â”€ medicalRecordNo: BHHA1887826
     â””â”€ billingProvider: Thorpe, Bianca D.O.
     â””â”€ physicianNPI: 1518278449
     â””â”€ nameOfAgency: Brockton Home Health Agency
     â””â”€ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[19:25:59] [DOC: 9269173] ğŸ“‹ [3/6] Fetching accurate physician NPI using selenium
[19:25:59] [DOC: 9269173] â„¹ï¸  Starting selenium NPI extraction for document ID: 9269173
[19:26:01] [DOC: 9269173] ğŸ”„ Logging into Doctor Alliance...
[19:26:15] [DOC: 9269173] ğŸ”„ Navigating to search section...
[19:26:37] [DOC: 9269173] âš ï¸  Trying alternative search link selectors...
[19:27:18] [DOC: 9269173] âŒ Selenium NPI extraction failed: Message: 
Stacktrace:
#0 0x5b192207d71a <unknown>
#1 0x5b1921b200a0 <unknown>
#2 0x5b1921b719b0 <unknown>
#3 0x5b1921b71ba1 <unknown>
#4 0x5b1921bbfea4 <unknown>
#5 0x5b1921b973cd <unknown>
#6 0x5b1921bbd2a0 <unknown>
#7 0x5b1921b97173 <unknown>
#8 0x5b1921b63d4b <unknown>
#9 0x5b1921b649b1 <unknown>
#10 0x5b19220428cb <unknown>
#11 0x5b19220467ca <unknown>
#12 0x5b192202a622 <unknown>
#13 0x5b1922047354 <unknown>
#14 0x5b192200f45f <unknown>
#15 0x5b192206b4f8 <unknown>
#16 0x5b192206b6d6 <unknown>
#17 0x5b192207c586 <unknown>
#18 0x791c370ba7eb <unknown>
#19 0x791c3713e18c <unknown>

[19:27:18] [DOC: 9269173] âš ï¸  Selenium NPI extraction failed, using AI-extracted NPI
[19:27:18] [DOC: 9269173] ğŸ“‹ [4/6] Processing order data
[19:27:20] [DOC: 9269173] ğŸ“‹ [4.5/6] Synchronizing MRN between patient and order data
[19:27:20] [DOC: 9269173] ğŸ“Š MRN Synchronization
     â””â”€ Patient MRN (extracted): BHHA1887826
     â””â”€ Order MRN (extracted): BHHA1887826
     â””â”€ Final MRN: BHHA1887826
     â””â”€ Source: patient_extracted
     â””â”€ Applied to: Both patient and order
[19:27:20] [DOC: 9269173] ğŸ“‹ [5/6] Creating or finding patient
[19:27:20] ğŸ“Š Patient Data for Processing
     â””â”€ First Name: Christine
     â””â”€ Last Name: Thompson
     â””â”€ DOB: 08/05/1973
     â””â”€ MRN: BHHA1887826
[19:27:20] âŒ Agency 'Brockton Home Health Care' not found in company mapping
[19:27:20] [DOC: 9269173] âœ… Patient ID obtained: None
[19:27:20] [DOC: 9269173] ğŸ“‹ [6/6] Completing order processing
[19:27:20] [DOC: 9269173] âŒ Skipping order push - Agency 'Brockton Home Health Care' not found in company mapping
================================================================================
â•‘                          PROCESSING DOCUMENT 9287534                           â•‘
================================================================================
[19:27:20] [DOC: 9287534] â„¹ï¸  Facility/Agency: All At Home Health Care-Allston | Received Date: 05/12/2025
[19:27:20] [DOC: 9287534] â„¹ï¸  Agency mapping found: All At Home Health Care-Allston -> 7e086962-c3a1-4653-bcaf-f43a9213c0ae
[19:27:20] [DOC: 9287534] ğŸ“‹ [1/4] Extracting text from PDF
[19:27:24] â„¹ï¸  Document appears to be scanned - using OCR pipeline
[19:27:24] â„¹ï¸  Document is text-based - using pdfplumber for extraction
[19:27:24] [DOC: 9287534] âœ… Text extraction completed
[19:27:24] [DOC: 9287534] ğŸ“„ NON-FAXED DOCUMENT | Type: ORDER
[19:27:24] [DOC: 9287534] ğŸ“Š Document Information
     â””â”€ Faxed: No
     â””â”€ Fax Source: N/A
     â””â”€ Document Type: ORDER
[19:27:24] [DOC: 9287534] ğŸ“‹ [2/6] Extracting patient data using AI
[19:27:27] [DOC: 9287534] ğŸ“Š AI-Extracted Patient Data
     â””â”€ patientFName: James
     â””â”€ patientLName: DeCosta
     â””â”€ dob: 06/03/1942
     â””â”€ patientSex: None
     â””â”€ medicalRecordNo: None
     â””â”€ billingProvider: Jennifer Kabak, MD
     â””â”€ physicianNPI: 1720386378
     â””â”€ nameOfAgency: All At Home Health Care
     â””â”€ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I25.119', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[19:27:27] [DOC: 9287534] ğŸ“Š Raw Episode Dates from Document
     â””â”€ Start of Care: 03/29/2025
     â””â”€ Start of Episode: 03/29/2025
     â””â”€ End of Episode: 05/27/2025
[19:27:27] [DOC: 9287534] ğŸ“Š Parsed Episode Dates
     â””â”€ Start of Care: 03/29/2025
     â””â”€ Start of Episode: 03/29/2025
     â””â”€ End of Episode: 05/27/2025
[19:27:27] [DOC: 9287534] ğŸ“Š Patient Data After Date Processing
     â””â”€ patientFName: James
     â””â”€ patientLName: DeCosta
     â””â”€ dob: 06/03/1942
     â””â”€ patientSex: None
     â””â”€ medicalRecordNo: None
     â””â”€ billingProvider: Jennifer Kabak, MD
     â””â”€ physicianNPI: 1720386378
     â””â”€ nameOfAgency: All At Home Health Care
     â””â”€ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I25.119', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[19:27:27] [DOC: 9287534] ğŸ“‹ [3/6] Fetching accurate physician NPI using selenium
[19:27:27] [DOC: 9287534] â„¹ï¸  Starting selenium NPI extraction for document ID: 9287534
[19:27:28] [DOC: 9287534] ğŸ”„ Logging into Doctor Alliance...
[19:27:42] [DOC: 9287534] ğŸ”„ Navigating to search section...
[19:28:05] [DOC: 9287534] âš ï¸  Trying alternative search link selectors...
[19:28:46] [DOC: 9287534] âŒ Selenium NPI extraction failed: Message: 
Stacktrace:
#0 0x5f8a6c4d671a <unknown>
#1 0x5f8a6bf790a0 <unknown>
#2 0x5f8a6bfca9b0 <unknown>
#3 0x5f8a6bfcaba1 <unknown>
#4 0x5f8a6c018ea4 <unknown>
#5 0x5f8a6bff03cd <unknown>
#6 0x5f8a6c0162a0 <unknown>
#7 0x5f8a6bff0173 <unknown>
#8 0x5f8a6bfbcd4b <unknown>
#9 0x5f8a6bfbd9b1 <unknown>
#10 0x5f8a6c49b8cb <unknown>
#11 0x5f8a6c49f7ca <unknown>
#12 0x5f8a6c483622 <unknown>
#13 0x5f8a6c4a0354 <unknown>
#14 0x5f8a6c46845f <unknown>
#15 0x5f8a6c4c44f8 <unknown>
#16 0x5f8a6c4c46d6 <unknown>
#17 0x5f8a6c4d5586 <unknown>
#18 0x739b5329f7eb <unknown>
#19 0x739b5332318c <unknown>

[19:28:46] [DOC: 9287534] âš ï¸  Selenium NPI extraction failed, using AI-extracted NPI
[19:28:46] [DOC: 9287534] ğŸ“‹ [4/6] Processing order data
[19:28:48] [DOC: 9287534] ğŸ“‹ [4.5/6] Synchronizing MRN between patient and order data
[19:28:48] âŒ Error processing document 9287534: 'NoneType' object has no attribute 'strip'
================================================================================
â•‘                          PROCESSING DOCUMENT 9287408                           â•‘
================================================================================
[19:28:48] [DOC: 9287408] â„¹ï¸  Facility/Agency: All At Home Health Care-Allston | Received Date: 05/12/2025
[19:28:48] [DOC: 9287408] â„¹ï¸  Agency mapping found: All At Home Health Care-Allston -> 7e086962-c3a1-4653-bcaf-f43a9213c0ae
[19:28:48] [DOC: 9287408] ğŸ“‹ [1/4] Extracting text from PDF
[19:28:53] â„¹ï¸  Document appears to be scanned - using OCR pipeline
[19:28:53] â„¹ï¸  Document is text-based - using pdfplumber for extraction
[19:28:53] [DOC: 9287408] âœ… Text extraction completed
[19:28:53] [DOC: 9287408] ğŸ“„ NON-FAXED DOCUMENT | Type: ORDER
[19:28:53] [DOC: 9287408] ğŸ“Š Document Information
     â””â”€ Faxed: No
     â””â”€ Fax Source: N/A
     â””â”€ Document Type: ORDER
[19:28:53] [DOC: 9287408] ğŸ“‹ [2/6] Extracting patient data using AI
[19:28:56] [DOC: 9287408] ğŸ“Š AI-Extracted Patient Data
     â””â”€ patientFName: STACY
     â””â”€ patientLName: HEFFNER
     â””â”€ dob: 09/27/1973
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: I-45668
     â””â”€ billingProvider: Dr. Thorpe, Bianca
     â””â”€ physicianNPI: 1720386378
     â””â”€ nameOfAgency: All At Home Health Care
     â””â”€ episodeDiagnoses: [{'startOfCare': '09/14/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I25.118', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[19:28:56] [DOC: 9287408] ğŸ“Š Raw Episode Dates from Document
     â””â”€ Start of Care: 09/14/2024
     â””â”€ Start of Episode: 03/13/2025
     â””â”€ End of Episode: 05/11/2025
[19:28:56] [DOC: 9287408] ğŸ“Š Parsed Episode Dates
     â””â”€ Start of Care: 09/14/2024
     â””â”€ Start of Episode: 03/13/2025
     â””â”€ End of Episode: 05/11/2025
[19:28:56] [DOC: 9287408] ğŸ“Š Patient Data After Date Processing
     â””â”€ patientFName: STACY
     â””â”€ patientLName: HEFFNER
     â””â”€ dob: 09/27/1973
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: I-45668
     â””â”€ billingProvider: Dr. Thorpe, Bianca
     â””â”€ physicianNPI: 1720386378
     â””â”€ nameOfAgency: All At Home Health Care
     â””â”€ episodeDiagnoses: [{'startOfCare': '09/14/2024', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I25.118', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[19:28:56] [DOC: 9287408] ğŸ“‹ [3/6] Fetching accurate physician NPI using selenium
[19:28:56] [DOC: 9287408] â„¹ï¸  Starting selenium NPI extraction for document ID: 9287408
[19:28:57] [DOC: 9287408] ğŸ”„ Logging into Doctor Alliance...
[19:29:13] [DOC: 9287408] ğŸ”„ Navigating to search section...
[19:29:35] [DOC: 9287408] âš ï¸  Trying alternative search link selectors...
[19:30:15] [DOC: 9287408] âŒ Selenium NPI extraction failed: Message: 
Stacktrace:
#0 0x5cbc0bcfd71a <unknown>
#1 0x5cbc0b7a00a0 <unknown>
#2 0x5cbc0b7f19b0 <unknown>
#3 0x5cbc0b7f1ba1 <unknown>
#4 0x5cbc0b83fea4 <unknown>
#5 0x5cbc0b8173cd <unknown>
#6 0x5cbc0b83d2a0 <unknown>
#7 0x5cbc0b817173 <unknown>
#8 0x5cbc0b7e3d4b <unknown>
#9 0x5cbc0b7e49b1 <unknown>
#10 0x5cbc0bcc28cb <unknown>
#11 0x5cbc0bcc67ca <unknown>
#12 0x5cbc0bcaa622 <unknown>
#13 0x5cbc0bcc7354 <unknown>
#14 0x5cbc0bc8f45f <unknown>
#15 0x5cbc0bceb4f8 <unknown>
#16 0x5cbc0bceb6d6 <unknown>
#17 0x5cbc0bcfc586 <unknown>
#18 0x7c7ebb6b07eb <unknown>
#19 0x7c7ebb73418c <unknown>

[19:30:15] [DOC: 9287408] âš ï¸  Selenium NPI extraction failed, using AI-extracted NPI
[19:30:15] [DOC: 9287408] ğŸ“‹ [4/6] Processing order data
[19:30:18] [DOC: 9287408] ğŸ“‹ [4.5/6] Synchronizing MRN between patient and order data
[19:30:18] âŒ Error processing document 9287408: 'NoneType' object has no attribute 'strip'
================================================================================
â•‘                             PROCESSING STATISTICS                              â•‘
================================================================================
[19:30:18] ğŸ“Š Document Processing Summary
     â””â”€ Total Documents: 49
     â””â”€ Successfully Processed: 0
     â””â”€ Failed Documents: 3
     â””â”€ Success Rate: 0.0%
================================================================================
â•‘                  PATIENT DATA PIPELINE - PROCESSING COMPLETED                  â•‘
================================================================================
