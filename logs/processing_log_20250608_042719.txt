================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[04:27:19] ℹ️  CSV Data Extraction & API Push Tool
[04:27:19] ℹ️  
[04:27:19] ℹ️  Features:
[04:27:19] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[04:27:19] ℹ️  - AI-powered patient and order data extraction
[04:27:19] ℹ️  - Enhanced error handling and logging
[04:27:19] ℹ️  - Full API integration (patient creation + order pushing)
[04:27:19] ℹ️  - CSV output with comprehensive patient data
[04:27:19] ℹ️  - Detailed API tracking with remarks for every document
[04:27:19] ℹ️  - Complete audit trail of all processing attempts
[04:27:19] ℹ️  
[04:27:19] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[04:27:19] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_042719.csv
[04:27:19] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_042719.csv
================================================================================
║                        Processing Document ID: 9251829                         ║
================================================================================
[04:27:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:27:19] ℹ️  Date: 04/21/2025
[04:27:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:27:21] [DOC: 9251829] ✅ Text extracted using pdfplumber (1338 chars)
[04:27:21] ✅    ✅ Text extracted using pdfplumber (1338 chars)
[04:27:21] 🔄 
🔄 Step 2: Extracting patient data...
[04:27:25] ℹ️  AI extracted raw sex value: ''
[04:27:25] ℹ️  AI extracted service line: 'Occupational Therapy'
[04:27:25] ℹ️  AI extracted payer source: ''
[04:27:25] ℹ️  AI extracted diagnoses:
[04:27:25] ℹ️    - Diagnosis 1: 'I95.1'
[04:27:25] ℹ️    - Diagnosis 2: 'E86.0'
[04:27:25] ℹ️    - Diagnosis 3: 'G30.1'
[04:27:25] ℹ️    - Diagnosis 4: ''
[04:27:25] ℹ️    - Diagnosis 5: ''
[04:27:25] ℹ️    - Diagnosis 6: ''
[04:27:25] ℹ️  Final extracted MRN: 'MA231101014802'
[04:27:25] ℹ️  Final extracted Sex: ''
[04:27:25] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[04:27:25] ℹ️  Final extracted Payer Source: ''
[04:27:25] ✅ Patient data extraction completed successfully
[04:27:25] ✅    ✅ Patient data extracted successfully
[04:27:25] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:27:25] ✅    ✅ Patient identified: Eduardo Medeiros
[04:27:25] ✅    ✅ Patient name validation passed
[04:27:25] 🔄 
🔄 Step 3: Processing patient dates...
[04:27:25] [DOC: 9251829] ℹ️  DOB normalized: 01/08/1948
[04:27:25] [DOC: 9251829] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:27:25] [DOC: 9251829] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:27:25] [DOC: 9251829] ✅ Patient date processing completed successfully
[04:27:25] ✅    ✅ Date processing completed
[04:27:25] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:27:25] 🔄 
🔄 Step 4: Extracting order data...
[04:27:28] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:27:28] ℹ️  Order extraction - Sex: ''
[04:27:28] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[04:27:28] ℹ️  Order extraction - Payer Source: ''
[04:27:28] ✅ Order data extraction completed successfully
[04:27:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:27:28] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:27:28] ⚠️  Could not determine sex using any available method
[04:27:28] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[04:27:28] ✅ Patient name cross-validation successful
[04:27:28] ✅    ✅ Data merged successfully
[04:27:29] ✅    ✅ Order data extracted and validated
[04:27:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:27:35] [DOC: 9251829] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:27:35] [DOC: 9251829] ℹ️  Patient not found, creating new patient via API...
[04:27:35] [DOC: 9251829] ℹ️  Creating patient via API: Eduardo Medeiros
[04:27:36] [DOC: 9251829] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:27:36] ❌    ❌ Failed to create patient
[04:27:36] [DOC: 9251829] ℹ️  API push details saved for document 9251829
================================================================================
║                        Processing Document ID: 9251822                         ║
================================================================================
[04:27:36] ℹ️  Agency: Compassionate Care Hospice-Taunton
[04:27:36] ℹ️  Date: 04/21/2025
[04:27:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:27:37] [DOC: 9251822] ❌ Critical failure in get_pdf_text: Invalid response format
[04:27:37] ❌ Failed to extract text for Doc ID 9251822
[04:27:37] [DOC: 9251822] ℹ️  API push details saved for document 9251822
================================================================================
║                        Processing Document ID: 9251824                         ║
================================================================================
[04:27:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:27:37] ℹ️  Date: 04/21/2025
[04:27:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:27:40] [DOC: 9251824] ✅ Text extracted using pdfplumber (1269 chars)
[04:27:40] ✅    ✅ Text extracted using pdfplumber (1269 chars)
[04:27:40] 🔄 
🔄 Step 2: Extracting patient data...
[04:27:43] ℹ️  AI extracted raw sex value: ''
[04:27:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:27:43] ℹ️  AI extracted payer source: ''
[04:27:43] ℹ️  AI extracted diagnoses:
[04:27:43] ℹ️    - Diagnosis 1: 'I95.1'
[04:27:43] ℹ️    - Diagnosis 2: 'E86.0'
[04:27:43] ℹ️    - Diagnosis 3: 'G30.1'
[04:27:43] ℹ️    - Diagnosis 4: ''
[04:27:43] ℹ️    - Diagnosis 5: ''
[04:27:43] ℹ️    - Diagnosis 6: ''
[04:27:43] ℹ️  Final extracted MRN: 'MA231101014802'
[04:27:43] ℹ️  Final extracted Sex: ''
[04:27:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:27:43] ℹ️  Final extracted Payer Source: ''
[04:27:43] ✅ Patient data extraction completed successfully
[04:27:43] ✅    ✅ Patient data extracted successfully
[04:27:43] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:27:43] ✅    ✅ Patient identified: Eduardo Medeiros
[04:27:43] ✅    ✅ Patient name validation passed
[04:27:43] 🔄 
🔄 Step 3: Processing patient dates...
[04:27:43] [DOC: 9251824] ℹ️  DOB normalized: 01/08/1948
[04:27:43] [DOC: 9251824] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:27:43] [DOC: 9251824] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:27:43] [DOC: 9251824] ✅ Patient date processing completed successfully
[04:27:43] ✅    ✅ Date processing completed
[04:27:43] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:27:43] 🔄 
🔄 Step 4: Extracting order data...
[04:27:46] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:27:46] ℹ️  Order extraction - Sex: ''
[04:27:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:27:46] ℹ️  Order extraction - Payer Source: ''
[04:27:46] ✅ Order data extraction completed successfully
[04:27:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:27:46] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:27:46] ⚠️  Could not determine sex using any available method
[04:27:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:27:46] ✅ Patient name cross-validation successful
[04:27:46] ✅    ✅ Data merged successfully
[04:27:47] ✅    ✅ Order data extracted and validated
[04:27:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:28:14] [DOC: 9251824] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:28:14] [DOC: 9251824] ℹ️  Patient not found, creating new patient via API...
[04:28:14] [DOC: 9251824] ℹ️  Creating patient via API: Eduardo Medeiros
[04:28:16] [DOC: 9251824] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:28:16] ❌    ❌ Failed to create patient
[04:28:16] [DOC: 9251824] ℹ️  API push details saved for document 9251824
================================================================================
║                        Processing Document ID: 9251821                         ║
================================================================================
[04:28:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:28:16] ℹ️  Date: 04/21/2025
[04:28:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:28:17] [DOC: 9251821] ✅ Text extracted using pdfplumber (1461 chars)
[04:28:17] ✅    ✅ Text extracted using pdfplumber (1461 chars)
[04:28:17] 🔄 
🔄 Step 2: Extracting patient data...
[04:28:20] ℹ️  AI extracted raw sex value: ''
[04:28:20] ℹ️  AI extracted service line: 'Occupational Therapy'
[04:28:20] ℹ️  AI extracted payer source: ''
[04:28:20] ℹ️  AI extracted diagnoses:
[04:28:20] ℹ️    - Diagnosis 1: 'K29.01'
[04:28:20] ℹ️    - Diagnosis 2: 'K20.91'
[04:28:20] ℹ️    - Diagnosis 3: 'E11.65'
[04:28:20] ℹ️    - Diagnosis 4: ''
[04:28:20] ℹ️    - Diagnosis 5: ''
[04:28:20] ℹ️    - Diagnosis 6: ''
[04:28:20] ℹ️  Final extracted MRN: 'MA231101014802'
[04:28:20] ℹ️  Final extracted Sex: ''
[04:28:20] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[04:28:20] ℹ️  Final extracted Payer Source: ''
[04:28:20] ✅ Patient data extraction completed successfully
[04:28:20] ✅    ✅ Patient data extracted successfully
[04:28:20] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:28:20] ✅    ✅ Patient identified: Eduardo Medeiros
[04:28:20] ✅    ✅ Patient name validation passed
[04:28:20] 🔄 
🔄 Step 3: Processing patient dates...
[04:28:20] [DOC: 9251821] ℹ️  DOB normalized: 01/08/1948
[04:28:20] [DOC: 9251821] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:28:20] [DOC: 9251821] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:28:20] [DOC: 9251821] ✅ Patient date processing completed successfully
[04:28:20] ✅    ✅ Date processing completed
[04:28:20] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:28:20] 🔄 
🔄 Step 4: Extracting order data...
[04:28:23] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:28:23] ℹ️  Order extraction - Sex: ''
[04:28:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[04:28:23] ℹ️  Order extraction - Payer Source: ''
[04:28:23] ✅ Order data extraction completed successfully
[04:28:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:28:23] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:28:23] ⚠️  Could not determine sex using any available method
[04:28:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[04:28:23] ✅ Patient name cross-validation successful
[04:28:23] ✅    ✅ Data merged successfully
[04:28:24] ✅    ✅ Order data extracted and validated
[04:28:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:28:54] [DOC: 9251821] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:28:54] [DOC: 9251821] ℹ️  Patient not found, creating new patient via API...
[04:28:54] [DOC: 9251821] ℹ️  Creating patient via API: Eduardo Medeiros
[04:28:55] [DOC: 9251821] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:28:55] ❌    ❌ Failed to create patient
[04:28:55] [DOC: 9251821] ℹ️  API push details saved for document 9251821
================================================================================
║                        Processing Document ID: 9251816                         ║
================================================================================
[04:28:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:28:55] ℹ️  Date: 04/21/2025
[04:28:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:28:57] [DOC: 9251816] ✅ Text extracted using pdfplumber (1352 chars)
[04:28:57] ✅    ✅ Text extracted using pdfplumber (1352 chars)
[04:28:57] 🔄 
🔄 Step 2: Extracting patient data...
[04:29:00] ℹ️  AI extracted raw sex value: ''
[04:29:00] ℹ️  AI extracted service line: 'Occupational Therapy'
[04:29:00] ℹ️  AI extracted payer source: ''
[04:29:00] ℹ️  AI extracted diagnoses:
[04:29:00] ℹ️    - Diagnosis 1: 'K29.01'
[04:29:00] ℹ️    - Diagnosis 2: 'K20.91'
[04:29:00] ℹ️    - Diagnosis 3: 'E11.65'
[04:29:00] ℹ️    - Diagnosis 4: 'None'
[04:29:00] ℹ️    - Diagnosis 5: 'None'
[04:29:00] ℹ️    - Diagnosis 6: 'None'
[04:29:00] ℹ️  Final extracted MRN: 'MA231101014802'
[04:29:00] ℹ️  Final extracted Sex: ''
[04:29:00] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[04:29:00] ℹ️  Final extracted Payer Source: ''
[04:29:00] ✅ Patient data extraction completed successfully
[04:29:00] ✅    ✅ Patient data extracted successfully
[04:29:00] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:29:00] ✅    ✅ Patient identified: Eduardo Medeiros
[04:29:00] ✅    ✅ Patient name validation passed
[04:29:00] 🔄 
🔄 Step 3: Processing patient dates...
[04:29:00] [DOC: 9251816] ℹ️  DOB normalized: 01/08/1948
[04:29:00] [DOC: 9251816] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:29:00] [DOC: 9251816] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:29:00] [DOC: 9251816] ✅ Patient date processing completed successfully
[04:29:00] ✅    ✅ Date processing completed
[04:29:00] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65'}]
[04:29:00] 🔄 
🔄 Step 4: Extracting order data...
[04:29:03] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:29:03] ℹ️  Order extraction - Sex: ''
[04:29:03] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[04:29:03] ℹ️  Order extraction - Payer Source: ''
[04:29:03] ✅ Order data extraction completed successfully
[04:29:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:29:03] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:29:03] ⚠️  Could not determine sex using any available method
[04:29:03] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[04:29:03] ✅ Patient name cross-validation successful
[04:29:03] ✅    ✅ Data merged successfully
[04:29:04] ✅    ✅ Order data extracted and validated
[04:29:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:29:10] [DOC: 9251816] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:29:10] [DOC: 9251816] ℹ️  Patient not found, creating new patient via API...
[04:29:10] [DOC: 9251816] ℹ️  Creating patient via API: Eduardo Medeiros
[04:29:11] [DOC: 9251816] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:29:11] ❌    ❌ Failed to create patient
[04:29:11] [DOC: 9251816] ℹ️  API push details saved for document 9251816
================================================================================
║                        Processing Document ID: 9251812                         ║
================================================================================
[04:29:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:29:11] ℹ️  Date: 04/21/2025
[04:29:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:29:13] [DOC: 9251812] ✅ Text extracted using pdfplumber (1508 chars)
[04:29:13] ✅    ✅ Text extracted using pdfplumber (1508 chars)
[04:29:13] 🔄 
🔄 Step 2: Extracting patient data...
[04:29:16] ℹ️  AI extracted raw sex value: ''
[04:29:16] ℹ️  AI extracted service line: 'Occupational Therapy'
[04:29:16] ℹ️  AI extracted payer source: ''
[04:29:16] ℹ️  AI extracted diagnoses:
[04:29:16] ℹ️    - Diagnosis 1: 'K29.01'
[04:29:16] ℹ️    - Diagnosis 2: 'K20.91'
[04:29:16] ℹ️    - Diagnosis 3: 'E11.65'
[04:29:16] ℹ️    - Diagnosis 4: 'None'
[04:29:16] ℹ️    - Diagnosis 5: 'None'
[04:29:16] ℹ️    - Diagnosis 6: 'None'
[04:29:16] ℹ️  Final extracted MRN: 'MA231101014802'
[04:29:16] ℹ️  Final extracted Sex: ''
[04:29:16] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[04:29:16] ℹ️  Final extracted Payer Source: ''
[04:29:16] ✅ Patient data extraction completed successfully
[04:29:16] ✅    ✅ Patient data extracted successfully
[04:29:16] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:29:16] ✅    ✅ Patient identified: Eduardo Medeiros
[04:29:16] ✅    ✅ Patient name validation passed
[04:29:16] 🔄 
🔄 Step 3: Processing patient dates...
[04:29:16] [DOC: 9251812] ℹ️  DOB normalized: 01/08/1948
[04:29:16] [DOC: 9251812] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:29:16] [DOC: 9251812] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:29:16] [DOC: 9251812] ✅ Patient date processing completed successfully
[04:29:16] ✅    ✅ Date processing completed
[04:29:16] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65'}]
[04:29:16] 🔄 
🔄 Step 4: Extracting order data...
[04:29:18] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:29:18] ℹ️  Order extraction - Sex: ''
[04:29:18] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[04:29:18] ℹ️  Order extraction - Payer Source: ''
[04:29:18] ✅ Order data extraction completed successfully
[04:29:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:29:18] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:29:18] ⚠️  Could not determine sex using any available method
[04:29:18] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[04:29:18] ✅ Patient name cross-validation successful
[04:29:18] ✅    ✅ Data merged successfully
[04:29:20] ✅    ✅ Order data extracted and validated
[04:29:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:29:36] [DOC: 9251812] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:29:36] [DOC: 9251812] ℹ️  Patient not found, creating new patient via API...
[04:29:36] [DOC: 9251812] ℹ️  Creating patient via API: Eduardo Medeiros
[04:29:37] [DOC: 9251812] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:29:37] ❌    ❌ Failed to create patient
[04:29:37] [DOC: 9251812] ℹ️  API push details saved for document 9251812
================================================================================
║                        Processing Document ID: 9251803                         ║
================================================================================
[04:29:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:29:37] ℹ️  Date: 04/21/2025
[04:29:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:29:42] [DOC: 9251803] ✅ Text extracted using pdfplumber (1338 chars)
[04:29:42] ✅    ✅ Text extracted using pdfplumber (1338 chars)
[04:29:42] 🔄 
🔄 Step 2: Extracting patient data...
[04:29:45] ℹ️  AI extracted raw sex value: ''
[04:29:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:29:45] ℹ️  AI extracted payer source: ''
[04:29:45] ℹ️  AI extracted diagnoses:
[04:29:45] ℹ️    - Diagnosis 1: 'K29.01'
[04:29:45] ℹ️    - Diagnosis 2: 'K20.91'
[04:29:45] ℹ️    - Diagnosis 3: 'E11.65'
[04:29:45] ℹ️    - Diagnosis 4: ''
[04:29:45] ℹ️    - Diagnosis 5: ''
[04:29:45] ℹ️    - Diagnosis 6: ''
[04:29:45] ℹ️  Final extracted MRN: 'MA231101014802'
[04:29:45] ℹ️  Final extracted Sex: ''
[04:29:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:29:45] ℹ️  Final extracted Payer Source: ''
[04:29:45] ✅ Patient data extraction completed successfully
[04:29:45] ✅    ✅ Patient data extracted successfully
[04:29:45] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:29:45] ✅    ✅ Patient identified: Eduardo Medeiros
[04:29:45] ✅    ✅ Patient name validation passed
[04:29:45] 🔄 
🔄 Step 3: Processing patient dates...
[04:29:45] [DOC: 9251803] ℹ️  DOB normalized: 01/08/1948
[04:29:45] [DOC: 9251803] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:29:45] [DOC: 9251803] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:29:45] [DOC: 9251803] ✅ Patient date processing completed successfully
[04:29:45] ✅    ✅ Date processing completed
[04:29:45] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:29:45] 🔄 
🔄 Step 4: Extracting order data...
[04:29:48] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:29:48] ℹ️  Order extraction - Sex: ''
[04:29:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:29:48] ℹ️  Order extraction - Payer Source: ''
[04:29:48] ✅ Order data extraction completed successfully
[04:29:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:29:48] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:29:48] ⚠️  Could not determine sex using any available method
[04:29:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:29:48] ✅ Patient name cross-validation successful
[04:29:48] ✅    ✅ Data merged successfully
[04:29:49] ✅    ✅ Order data extracted and validated
[04:29:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:29:56] [DOC: 9251803] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:29:56] [DOC: 9251803] ℹ️  Patient not found, creating new patient via API...
[04:29:56] [DOC: 9251803] ℹ️  Creating patient via API: Eduardo Medeiros
[04:29:57] [DOC: 9251803] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:29:57] ❌    ❌ Failed to create patient
[04:29:57] [DOC: 9251803] ℹ️  API push details saved for document 9251803
================================================================================
║                        Processing Document ID: 9251798                         ║
================================================================================
[04:29:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:29:57] ℹ️  Date: 04/21/2025
[04:29:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:30:00] [DOC: 9251798] ✅ Text extracted using pdfplumber (1275 chars)
[04:30:00] ✅    ✅ Text extracted using pdfplumber (1275 chars)
[04:30:00] 🔄 
🔄 Step 2: Extracting patient data...
[04:30:03] ℹ️  AI extracted raw sex value: ''
[04:30:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:30:03] ℹ️  AI extracted payer source: ''
[04:30:03] ℹ️  AI extracted diagnoses:
[04:30:03] ℹ️    - Diagnosis 1: 'K29.01'
[04:30:03] ℹ️    - Diagnosis 2: 'K20.91'
[04:30:03] ℹ️    - Diagnosis 3: 'E11.65'
[04:30:03] ℹ️    - Diagnosis 4: ''
[04:30:03] ℹ️    - Diagnosis 5: ''
[04:30:03] ℹ️    - Diagnosis 6: ''
[04:30:03] ℹ️  Final extracted MRN: 'MA231101014802'
[04:30:03] ℹ️  Final extracted Sex: ''
[04:30:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:30:03] ℹ️  Final extracted Payer Source: ''
[04:30:03] ✅ Patient data extraction completed successfully
[04:30:03] ✅    ✅ Patient data extracted successfully
[04:30:03] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:30:03] ✅    ✅ Patient identified: Eduardo Medeiros
[04:30:03] ✅    ✅ Patient name validation passed
[04:30:03] 🔄 
🔄 Step 3: Processing patient dates...
[04:30:03] [DOC: 9251798] ℹ️  DOB normalized: 01/08/1948
[04:30:03] [DOC: 9251798] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:30:03] [DOC: 9251798] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:30:03] [DOC: 9251798] ✅ Patient date processing completed successfully
[04:30:03] ✅    ✅ Date processing completed
[04:30:03] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:30:03] 🔄 
🔄 Step 4: Extracting order data...
[04:30:06] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:30:06] ℹ️  Order extraction - Sex: ''
[04:30:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:30:06] ℹ️  Order extraction - Payer Source: ''
[04:30:06] ✅ Order data extraction completed successfully
[04:30:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:30:06] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:30:06] ⚠️  Could not determine sex using any available method
[04:30:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:30:06] ✅ Patient name cross-validation successful
[04:30:06] ✅    ✅ Data merged successfully
[04:30:07] ✅    ✅ Order data extracted and validated
[04:30:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:30:24] [DOC: 9251798] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:30:24] [DOC: 9251798] ℹ️  Patient not found, creating new patient via API...
[04:30:24] [DOC: 9251798] ℹ️  Creating patient via API: Eduardo Medeiros
[04:30:25] [DOC: 9251798] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:30:25] ❌    ❌ Failed to create patient
[04:30:25] [DOC: 9251798] ℹ️  API push details saved for document 9251798
================================================================================
║                        Processing Document ID: 9251791                         ║
================================================================================
[04:30:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:30:25] ℹ️  Date: 04/21/2025
[04:30:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:30:27] [DOC: 9251791] ✅ Text extracted using pdfplumber (1328 chars)
[04:30:27] ✅    ✅ Text extracted using pdfplumber (1328 chars)
[04:30:27] 🔄 
🔄 Step 2: Extracting patient data...
[04:30:30] ℹ️  AI extracted raw sex value: ''
[04:30:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:30:30] ℹ️  AI extracted payer source: ''
[04:30:30] ℹ️  AI extracted diagnoses:
[04:30:30] ℹ️    - Diagnosis 1: 'K29.01'
[04:30:30] ℹ️    - Diagnosis 2: 'K20.91'
[04:30:30] ℹ️    - Diagnosis 3: 'E11.65'
[04:30:30] ℹ️    - Diagnosis 4: ''
[04:30:30] ℹ️    - Diagnosis 5: ''
[04:30:30] ℹ️    - Diagnosis 6: ''
[04:30:30] ℹ️  Final extracted MRN: 'MA231101014802'
[04:30:30] ℹ️  Final extracted Sex: ''
[04:30:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:30:30] ℹ️  Final extracted Payer Source: ''
[04:30:30] ✅ Patient data extraction completed successfully
[04:30:30] ✅    ✅ Patient data extracted successfully
[04:30:30] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:30:30] ✅    ✅ Patient identified: Eduardo Medeiros
[04:30:30] ✅    ✅ Patient name validation passed
[04:30:30] 🔄 
🔄 Step 3: Processing patient dates...
[04:30:30] [DOC: 9251791] ℹ️  DOB normalized: 01/08/1948
[04:30:30] [DOC: 9251791] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:30:30] [DOC: 9251791] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:30:30] [DOC: 9251791] ✅ Patient date processing completed successfully
[04:30:30] ✅    ✅ Date processing completed
[04:30:30] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:30:30] 🔄 
🔄 Step 4: Extracting order data...
[04:30:33] ℹ️  Order extraction - MRN: 'MA231101014802'
[04:30:33] ℹ️  Order extraction - Sex: ''
[04:30:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:30:33] ℹ️  Order extraction - Payer Source: ''
[04:30:33] ✅ Order data extraction completed successfully
[04:30:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:30:33] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[04:30:33] ⚠️  Could not determine sex using any available method
[04:30:33] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:30:33] ✅ Patient name cross-validation successful
[04:30:33] ✅    ✅ Data merged successfully
[04:30:34] ✅    ✅ Order data extracted and validated
[04:30:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:30:40] [DOC: 9251791] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:30:40] [DOC: 9251791] ℹ️  Patient not found, creating new patient via API...
[04:30:40] [DOC: 9251791] ℹ️  Creating patient via API: Eduardo Medeiros
[04:30:41] [DOC: 9251791] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:30:41] ❌    ❌ Failed to create patient
[04:30:41] [DOC: 9251791] ℹ️  API push details saved for document 9251791
================================================================================
║                        Processing Document ID: 9251784                         ║
================================================================================
[04:30:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:30:41] ℹ️  Date: 04/21/2025
[04:30:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:30:44] [DOC: 9251784] ✅ Text extracted using pdfplumber (13717 chars)
[04:30:44] ✅    ✅ Text extracted using pdfplumber (13717 chars)
[04:30:44] 🔄 
🔄 Step 2: Extracting patient data...
[04:30:47] ℹ️  AI extracted raw sex value: 'M'
[04:30:47] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy'
[04:30:47] ℹ️  AI extracted payer source: 'Medicare'
[04:30:47] ℹ️  AI extracted diagnoses:
[04:30:47] ℹ️    - Diagnosis 1: 'K29.01'
[04:30:47] ℹ️    - Diagnosis 2: 'K20.91'
[04:30:47] ℹ️    - Diagnosis 3: 'E11.65'
[04:30:47] ℹ️    - Diagnosis 4: 'E87.0'
[04:30:47] ℹ️    - Diagnosis 5: 'I13.0'
[04:30:47] ℹ️    - Diagnosis 6: 'I50.20'
[04:30:47] ℹ️  Final extracted MRN: '817795413770'
[04:30:47] ℹ️  Final extracted Sex: 'MALE'
[04:30:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy'
[04:30:47] ℹ️  Final extracted Payer Source: 'Medicare'
[04:30:47] ✅ Patient data extraction completed successfully
[04:30:47] ✅    ✅ Patient data extracted successfully
[04:30:47] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 817795413770
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1376525063
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 244 Rivet St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (774) 202-2801
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E87.0', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.20'}]
[04:30:47] ✅    ✅ Patient identified: Eduardo Medeiros
[04:30:47] ✅    ✅ Patient name validation passed
[04:30:47] 🔄 
🔄 Step 3: Processing patient dates...
[04:30:47] [DOC: 9251784] ℹ️  DOB normalized: 01/08/1948
[04:30:47] [DOC: 9251784] ℹ️  Episode startOfCare normalized: 03/26/2025
[04:30:47] [DOC: 9251784] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[04:30:47] [DOC: 9251784] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[04:30:47] [DOC: 9251784] ✅ Patient date processing completed successfully
[04:30:47] ✅    ✅ Date processing completed
[04:30:47] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 817795413770
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1376525063
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 244 Rivet St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (774) 202-2801
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'K29.01', 'secondDiagnosis': 'K20.91', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'E87.0', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.20'}]
[04:30:47] 🔄 
🔄 Step 4: Extracting order data...
[04:30:50] ℹ️  Order extraction - MRN: '817795413770'
[04:30:50] ℹ️  Order extraction - Sex: 'MALE'
[04:30:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy'
[04:30:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:30:50] ✅ Order data extraction completed successfully
[04:30:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:30:50] ℹ️  Using MRN from patient data: '817795413770' over '817795413770'
[04:30:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy'
[04:30:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:30:50] ✅ Patient name cross-validation successful
[04:30:50] ✅    ✅ Data merged successfully
[04:30:51] ✅    ✅ Order data extracted and validated
[04:30:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:30:58] [DOC: 9251784] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[04:30:58] [DOC: 9251784] ℹ️  Patient not found, creating new patient via API...
[04:30:58] [DOC: 9251784] ℹ️  Creating patient via API: Eduardo Medeiros
[04:30:59] [DOC: 9251784] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:30:59] ❌    ❌ Failed to create patient
[04:30:59] [DOC: 9251784] ℹ️  API push details saved for document 9251784
================================================================================
║                        Processing Document ID: 9251774                         ║
================================================================================
[04:30:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:30:59] ℹ️  Date: 04/21/2025
[04:30:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:31:02] [DOC: 9251774] ✅ Text extracted using pdfplumber (14374 chars)
[04:31:02] ✅    ✅ Text extracted using pdfplumber (14374 chars)
[04:31:02] 🔄 
🔄 Step 2: Extracting patient data...
[04:31:05] ℹ️  AI extracted raw sex value: 'F'
[04:31:05] ℹ️  AI extracted service line: 'OT'
[04:31:05] ℹ️  AI extracted payer source: ''
[04:31:05] ℹ️  AI extracted diagnoses:
[04:31:05] ℹ️    - Diagnosis 1: ''
[04:31:05] ℹ️    - Diagnosis 2: ''
[04:31:05] ℹ️    - Diagnosis 3: ''
[04:31:05] ℹ️    - Diagnosis 4: ''
[04:31:05] ℹ️    - Diagnosis 5: ''
[04:31:05] ℹ️    - Diagnosis 6: ''
[04:31:05] ℹ️  Final extracted MRN: 'MA241216044603'
[04:31:05] ℹ️  Final extracted Sex: 'FEMALE'
[04:31:05] ℹ️  Final extracted Service Line: 'OT'
[04:31:05] ℹ️  Final extracted Payer Source: ''
[04:31:05] ✅ Patient data extraction completed successfully
[04:31:05] ✅    ✅ Patient data extracted successfully
[04:31:05] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:31:05] ✅    ✅ Patient identified: Leonor Gomes
[04:31:05] ✅    ✅ Patient name validation passed
[04:31:05] 🔄 
🔄 Step 3: Processing patient dates...
[04:31:05] [DOC: 9251774] ℹ️  DOB normalized: 04/15/1946
[04:31:05] [DOC: 9251774] ✅ Patient date processing completed successfully
[04:31:05] ✅    ✅ Date processing completed
[04:31:05] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:31:05] 🔄 
🔄 Step 4: Extracting order data...
[04:31:07] ℹ️  Order extraction - MRN: 'MA241216044603'
[04:31:07] ℹ️  Order extraction - Sex: 'FEMALE'
[04:31:07] ℹ️  Order extraction - Service Line: 'OT'
[04:31:07] ℹ️  Order extraction - Payer Source: ''
[04:31:07] ✅ Order data extraction completed successfully
[04:31:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:31:07] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[04:31:07] ℹ️  Service line consistent in both sources: 'OT'
[04:31:07] ✅ Patient name cross-validation successful
[04:31:07] ✅    ✅ Data merged successfully
[04:31:09] ⚠️     ❌ Skipping - missing episode start date
[04:31:09] [DOC: 9251774] ℹ️  API push details saved for document 9251774
================================================================================
║                        Processing Document ID: 9251770                         ║
================================================================================
[04:31:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:31:09] ℹ️  Date: 04/21/2025
[04:31:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:31:12] [DOC: 9251770] ✅ Text extracted using pdfplumber (15017 chars)
[04:31:12] ✅    ✅ Text extracted using pdfplumber (15017 chars)
[04:31:12] 🔄 
🔄 Step 2: Extracting patient data...
[04:31:15] ℹ️  AI extracted raw sex value: 'F'
[04:31:15] ℹ️  AI extracted service line: 'PT'
[04:31:15] ℹ️  AI extracted payer source: 'None'
[04:31:15] ℹ️  AI extracted diagnoses:
[04:31:15] ℹ️    - Diagnosis 1: 'M47.816'
[04:31:15] ℹ️    - Diagnosis 2: 'R26.2'
[04:31:15] ℹ️    - Diagnosis 3: 'None'
[04:31:15] ℹ️    - Diagnosis 4: 'None'
[04:31:15] ℹ️    - Diagnosis 5: 'None'
[04:31:15] ℹ️    - Diagnosis 6: 'None'
[04:31:15] ℹ️  Final extracted MRN: 'MA241216044603'
[04:31:15] ℹ️  Final extracted Sex: 'FEMALE'
[04:31:15] ℹ️  Final extracted Service Line: 'PT'
[04:31:15] ℹ️  Final extracted Payer Source: ''
[04:31:15] ✅ Patient data extraction completed successfully
[04:31:15] ✅    ✅ Patient data extracted successfully
[04:31:15] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'R26.2', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:31:15] ✅    ✅ Patient identified: Leonor Gomes
[04:31:15] ✅    ✅ Patient name validation passed
[04:31:15] 🔄 
🔄 Step 3: Processing patient dates...
[04:31:15] [DOC: 9251770] ℹ️  DOB normalized: 04/15/1946
[04:31:15] [DOC: 9251770] ✅ Patient date processing completed successfully
[04:31:15] ✅    ✅ Date processing completed
[04:31:15] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'R26.2'}]
[04:31:15] 🔄 
🔄 Step 4: Extracting order data...
[04:31:18] ℹ️  Order extraction - MRN: 'MA241216044603'
[04:31:18] ℹ️  Order extraction - Sex: 'FEMALE'
[04:31:18] ℹ️  Order extraction - Service Line: 'PT'
[04:31:18] ℹ️  Order extraction - Payer Source: ''
[04:31:18] ✅ Order data extraction completed successfully
[04:31:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:31:18] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[04:31:18] ℹ️  Service line consistent in both sources: 'PT'
[04:31:18] ✅ Patient name cross-validation successful
[04:31:18] ✅    ✅ Data merged successfully
[04:31:19] ⚠️     ❌ Skipping - missing episode start date
[04:31:19] [DOC: 9251770] ℹ️  API push details saved for document 9251770
================================================================================
║                        Processing Document ID: 9251764                         ║
================================================================================
[04:31:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:31:19] ℹ️  Date: 04/21/2025
[04:31:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:31:21] [DOC: 9251764] ✅ Text extracted using pdfplumber (10138 chars)
[04:31:21] ✅    ✅ Text extracted using pdfplumber (10138 chars)
[04:31:21] 🔄 
🔄 Step 2: Extracting patient data...
[04:31:25] ℹ️  AI extracted raw sex value: 'F'
[04:31:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:31:25] ℹ️  AI extracted payer source: 'Medicare'
[04:31:25] ℹ️  AI extracted diagnoses:
[04:31:25] ℹ️    - Diagnosis 1: 'I10'
[04:31:25] ℹ️    - Diagnosis 2: 'I50.30'
[04:31:25] ℹ️    - Diagnosis 3: 'I47.10'
[04:31:25] ℹ️    - Diagnosis 4: 'E78.5'
[04:31:25] ℹ️    - Diagnosis 5: 'F03.90'
[04:31:25] ℹ️    - Diagnosis 6: 'None'
[04:31:25] ℹ️  Final extracted MRN: '100990115'
[04:31:25] ℹ️  Final extracted Sex: 'FEMALE'
[04:31:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:31:25] ℹ️  Final extracted Payer Source: 'Medicare'
[04:31:25] ✅ Patient data extraction completed successfully
[04:31:25] ✅    ✅ Patient data extracted successfully
[04:31:25] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Carreiro
     └─ dob: 06/26/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990115
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 130 Whitman St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (774) 202-0442
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/01/2023', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'I47.10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F03.90', 'sixthDiagnosis': None}]
[04:31:25] ✅    ✅ Patient identified: Maria Carreiro
[04:31:25] ✅    ✅ Patient name validation passed
[04:31:25] 🔄 
🔄 Step 3: Processing patient dates...
[04:31:25] [DOC: 9251764] ℹ️  DOB normalized: 06/26/1937
[04:31:25] [DOC: 9251764] ℹ️  Episode startOfCare normalized: 10/01/2023
[04:31:25] [DOC: 9251764] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[04:31:25] [DOC: 9251764] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[04:31:25] [DOC: 9251764] ✅ Patient date processing completed successfully
[04:31:25] ✅    ✅ Date processing completed
[04:31:25] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Carreiro
     └─ dob: 06/26/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990115
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 130 Whitman St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (774) 202-0442
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/01/2023', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'I47.10', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F03.90'}]
[04:31:25] 🔄 
🔄 Step 4: Extracting order data...
[04:31:27] ℹ️  Order extraction - MRN: '100990115'
[04:31:27] ℹ️  Order extraction - Sex: 'FEMALE'
[04:31:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:31:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:31:27] ✅ Order data extraction completed successfully
[04:31:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:31:27] ℹ️  Using MRN from patient data: '100990115' over '100990115'
[04:31:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:31:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:31:27] ✅ Patient name cross-validation successful
[04:31:27] ✅    ✅ Data merged successfully
[04:31:29] ✅    ✅ Order data extracted and validated
[04:31:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:31:46] [DOC: 9251764] ✅ Patient exists in API: Maria Carreiro, ID: 6aec569b-b875-4d6a-84f6-67adf52d7649
[04:31:46] ✅    ✅ Existing patient found with ID: 6aec569b-b875-4d6a-84f6-67adf52d7649
[04:31:46] 🔄 
🔄 Step 6: Pushing order to API...
[04:31:46] [DOC: 9251764] ℹ️  Pushing order via API for patient ID: 6aec569b-b875-4d6a-84f6-67adf52d7649
[04:31:47] [DOC: 9251764] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13452"}
[04:31:47] ❌    ❌ Failed to push order
[04:31:47] 🔄 
🔄 Step 7: Writing to CSV...
[04:31:47] [DOC: 9251764] ℹ️  Calculated age: 87 from DOB: 06/26/1937
[04:31:47] [DOC: 9251764] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:31:47] [DOC: 9251764] ℹ️  Payer Source extracted: 'Medicare'
[04:31:47] [DOC: 9251764] ℹ️  Diagnosis codes being written:
[04:31:47] [DOC: 9251764] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[04:31:47] [DOC: 9251764] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.30'
[04:31:47] [DOC: 9251764] ℹ️    - Latest_Episode_Thirddiagnosis: 'I47.10'
[04:31:47] [DOC: 9251764] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[04:31:47] [DOC: 9251764] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F03.90'
[04:31:47] [DOC: 9251764] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:31:47] [DOC: 9251764] ✅ Patient data written to CSV: Maria Carreiro | Sex: FEMALE | Age: 87 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990115
[04:31:47] ✅    ✅ Document 9251764 processed and saved successfully
[04:31:47] 🔄 
🔄 Step 8: Saving API details...
[04:31:47] [DOC: 9251764] ℹ️  API push details saved for document 9251764
[04:31:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251754                         ║
================================================================================
[04:31:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:31:47] ℹ️  Date: 04/21/2025
[04:31:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:31:50] [DOC: 9251754] ✅ Text extracted using pdfplumber (1833 chars)
[04:31:50] ✅    ✅ Text extracted using pdfplumber (1833 chars)
[04:31:50] 🔄 
🔄 Step 2: Extracting patient data...
[04:31:53] ℹ️  AI extracted raw sex value: ''
[04:31:53] ℹ️  AI extracted service line: 'LPN'
[04:31:53] ℹ️  AI extracted payer source: ''
[04:31:53] ℹ️  AI extracted diagnoses:
[04:31:53] ℹ️    - Diagnosis 1: 'E11.65'
[04:31:53] ℹ️    - Diagnosis 2: 'N39.0'
[04:31:53] ℹ️    - Diagnosis 3: 'B96.20'
[04:31:53] ℹ️    - Diagnosis 4: ''
[04:31:53] ℹ️    - Diagnosis 5: ''
[04:31:53] ℹ️    - Diagnosis 6: ''
[04:31:53] ℹ️  Final extracted MRN: '100990452'
[04:31:53] ℹ️  Final extracted Sex: ''
[04:31:53] ℹ️  Final extracted Service Line: 'LPN'
[04:31:53] ℹ️  Final extracted Payer Source: ''
[04:31:53] ✅ Patient data extraction completed successfully
[04:31:53] ✅    ✅ Patient data extracted successfully
[04:31:53] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Camara
     └─ dob: 08/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100990452
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'B96.20', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:31:53] ✅    ✅ Patient identified: Maria Camara
[04:31:53] ✅    ✅ Patient name validation passed
[04:31:53] 🔄 
🔄 Step 3: Processing patient dates...
[04:31:53] [DOC: 9251754] ℹ️  DOB normalized: 08/20/1945
[04:31:53] [DOC: 9251754] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[04:31:53] [DOC: 9251754] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[04:31:53] [DOC: 9251754] ✅ Patient date processing completed successfully
[04:31:53] ✅    ✅ Date processing completed
[04:31:53] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Camara
     └─ dob: 08/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: 100990452
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'B96.20', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:31:53] 🔄 
🔄 Step 4: Extracting order data...
[04:31:55] ℹ️  Order extraction - MRN: '100990452'
[04:31:55] ℹ️  Order extraction - Sex: ''
[04:31:55] ℹ️  Order extraction - Service Line: 'Nursing'
[04:31:55] ℹ️  Order extraction - Payer Source: ''
[04:31:55] ✅ Order data extraction completed successfully
[04:31:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:31:55] ℹ️  Using MRN from patient data: '100990452' over '100990452'
[04:31:55] ℹ️  Inferred sex as FEMALE from name: Maria
[04:31:55] ℹ️  Combined service lines: Patient='LPN' + Order='Nursing' = 'LPN, Nursing'
[04:31:55] ✅ Patient name cross-validation successful
[04:31:55] ✅    ✅ Data merged successfully
[04:31:56] ✅    ✅ Order data extracted and validated
[04:31:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:32:16] [DOC: 9251754] ✅ Patient exists in API: Maria Camara, ID: 5aa4fcff-d179-4173-991e-9069147a97c4
[04:32:16] ✅    ✅ Existing patient found with ID: 5aa4fcff-d179-4173-991e-9069147a97c4
[04:32:16] 🔄 
🔄 Step 6: Pushing order to API...
[04:32:16] [DOC: 9251754] ℹ️  Pushing order via API for patient ID: 5aa4fcff-d179-4173-991e-9069147a97c4
[04:32:18] [DOC: 9251754] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13436"}
[04:32:18] ❌    ❌ Failed to push order
[04:32:18] 🔄 
🔄 Step 7: Writing to CSV...
[04:32:18] [DOC: 9251754] ℹ️  Calculated age: 79 from DOB: 08/20/1945
[04:32:18] [DOC: 9251754] ℹ️  Service Line extracted: 'LPN, Nursing'
[04:32:18] [DOC: 9251754] ℹ️  Payer Source extracted: ''
[04:32:18] [DOC: 9251754] ℹ️  Diagnosis codes being written:
[04:32:18] [DOC: 9251754] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[04:32:18] [DOC: 9251754] ℹ️    - Latest_Episode_Seconddiagnosis: 'N39.0'
[04:32:18] [DOC: 9251754] ℹ️    - Latest_Episode_Thirddiagnosis: 'B96.20'
[04:32:18] [DOC: 9251754] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:32:18] [DOC: 9251754] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:32:18] [DOC: 9251754] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:32:18] [DOC: 9251754] ✅ Patient data written to CSV: Maria Camara | Sex: FEMALE | Age: 79 | Service: LPN, Nursing | Payer:  | MRN: 100990452
[04:32:18] ✅    ✅ Document 9251754 processed and saved successfully
[04:32:18] 🔄 
🔄 Step 8: Saving API details...
[04:32:18] [DOC: 9251754] ℹ️  API push details saved for document 9251754
[04:32:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251744                         ║
================================================================================
[04:32:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:32:18] ℹ️  Date: 04/21/2025
[04:32:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:32:20] [DOC: 9251744] ✅ Text extracted using pdfplumber (9747 chars)
[04:32:20] ✅    ✅ Text extracted using pdfplumber (9747 chars)
[04:32:20] 🔄 
🔄 Step 2: Extracting patient data...
[04:32:24] ℹ️  AI extracted raw sex value: 'F'
[04:32:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:32:24] ℹ️  AI extracted payer source: 'SWH'
[04:32:24] ℹ️  AI extracted diagnoses:
[04:32:24] ℹ️    - Diagnosis 1: 'I10'
[04:32:24] ℹ️    - Diagnosis 2: 'F41.1'
[04:32:24] ℹ️    - Diagnosis 3: 'R00.2'
[04:32:24] ℹ️    - Diagnosis 4: 'E78.5'
[04:32:24] ℹ️    - Diagnosis 5: 'F10.10'
[04:32:24] ℹ️    - Diagnosis 6: 'None'
[04:32:24] ℹ️  Final extracted MRN: 'MA240801104402'
[04:32:24] ℹ️  Final extracted Sex: 'FEMALE'
[04:32:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:32:24] ℹ️  Final extracted Payer Source: 'SWH'
[04:32:24] ✅ Patient data extraction completed successfully
[04:32:24] ✅    ✅ Patient data extracted successfully
[04:32:24] 📊 Patient Response
     └─ patientFName: Nalia
     └─ patientLName: Barcelos
     └─ dob: 10/24/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240801104402
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 139 Earle St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 995-9006
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '08/09/2024', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'R00.2', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F10.10', 'sixthDiagnosis': None}]
[04:32:24] ✅    ✅ Patient identified: Nalia Barcelos
[04:32:24] ✅    ✅ Patient name validation passed
[04:32:24] 🔄 
🔄 Step 3: Processing patient dates...
[04:32:24] [DOC: 9251744] ℹ️  DOB normalized: 10/24/1944
[04:32:24] [DOC: 9251744] ℹ️  Episode startOfCare normalized: 08/09/2024
[04:32:24] [DOC: 9251744] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[04:32:24] [DOC: 9251744] ℹ️  Episode endOfEpisode normalized: 06/04/2025
[04:32:24] [DOC: 9251744] ✅ Patient date processing completed successfully
[04:32:24] ✅    ✅ Date processing completed
[04:32:24] 📊 Processed Patient Data
     └─ patientFName: Nalia
     └─ patientLName: Barcelos
     └─ dob: 10/24/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240801104402
     └─ billingProvider: Afonso Fede, Gloriane MD
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 139 Earle St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 995-9006
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '08/09/2024', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'R00.2', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'F10.10'}]
[04:32:24] 🔄 
🔄 Step 4: Extracting order data...
[04:32:26] ℹ️  Order extraction - MRN: 'MA240801104402'
[04:32:26] ℹ️  Order extraction - Sex: 'FEMALE'
[04:32:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:32:26] ℹ️  Order extraction - Payer Source: 'SWH'
[04:32:26] ✅ Order data extraction completed successfully
[04:32:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:32:26] ℹ️  Using MRN from patient data: 'MA240801104402' over 'MA240801104402'
[04:32:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:32:26] ℹ️  Payer source consistent in both sources: 'SWH'
[04:32:26] ✅ Patient name cross-validation successful
[04:32:26] ✅    ✅ Data merged successfully
[04:32:28] ✅    ✅ Order data extracted and validated
[04:32:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:32:50] [DOC: 9251744] ✅ Patient exists in API: Nalia Barcelos, ID: da29c183-c2cf-4a44-a939-f337352feefd
[04:32:50] ✅    ✅ Existing patient found with ID: da29c183-c2cf-4a44-a939-f337352feefd
[04:32:50] 🔄 
🔄 Step 6: Pushing order to API...
[04:32:50] [DOC: 9251744] ℹ️  Pushing order via API for patient ID: da29c183-c2cf-4a44-a939-f337352feefd
[04:32:51] [DOC: 9251744] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13018"}
[04:32:51] ❌    ❌ Failed to push order
[04:32:51] 🔄 
🔄 Step 7: Writing to CSV...
[04:32:51] [DOC: 9251744] ℹ️  Calculated age: 80 from DOB: 10/24/1944
[04:32:51] [DOC: 9251744] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:32:51] [DOC: 9251744] ℹ️  Payer Source extracted: 'SWH'
[04:32:51] [DOC: 9251744] ℹ️  Diagnosis codes being written:
[04:32:51] [DOC: 9251744] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[04:32:51] [DOC: 9251744] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[04:32:51] [DOC: 9251744] ℹ️    - Latest_Episode_Thirddiagnosis: 'R00.2'
[04:32:51] [DOC: 9251744] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[04:32:51] [DOC: 9251744] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F10.10'
[04:32:51] [DOC: 9251744] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:32:51] [DOC: 9251744] ✅ Patient data written to CSV: Nalia Barcelos | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: SWH | MRN: MA240801104402
[04:32:51] ✅    ✅ Document 9251744 processed and saved successfully
[04:32:51] 🔄 
🔄 Step 8: Saving API details...
[04:32:51] [DOC: 9251744] ℹ️  API push details saved for document 9251744
[04:32:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251738                         ║
================================================================================
[04:32:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:32:51] ℹ️  Date: 04/21/2025
[04:32:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:32:54] [DOC: 9251738] ✅ Text extracted using pdfplumber (13284 chars)
[04:32:54] ✅    ✅ Text extracted using pdfplumber (13284 chars)
[04:32:54] 🔄 
🔄 Step 2: Extracting patient data...
[04:32:57] ℹ️  AI extracted raw sex value: 'M'
[04:32:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:32:57] ℹ️  AI extracted payer source: 'SWH'
[04:32:57] ℹ️  AI extracted diagnoses:
[04:32:57] ℹ️    - Diagnosis 1: 'F03.A3'
[04:32:57] ℹ️    - Diagnosis 2: 'F03.A4'
[04:32:57] ℹ️    - Diagnosis 3: 'E11.51'
[04:32:57] ℹ️    - Diagnosis 4: 'I10'
[04:32:57] ℹ️    - Diagnosis 5: 'J44.9'
[04:32:57] ℹ️    - Diagnosis 6: 'M47.816'
[04:32:57] ℹ️  Final extracted MRN: '101001663'
[04:32:57] ℹ️  Final extracted Sex: 'MALE'
[04:32:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:32:57] ℹ️  Final extracted Payer Source: 'SWH'
[04:32:57] ✅ Patient data extraction completed successfully
[04:32:57] ✅    ✅ Patient data extracted successfully
[04:32:57] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Alves
     └─ dob: 06/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 101001663
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2023', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'F03.A3', 'secondDiagnosis': 'F03.A4', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'M47.816'}]
[04:32:57] ✅    ✅ Patient identified: Luis Alves
[04:32:57] ✅    ✅ Patient name validation passed
[04:32:57] 🔄 
🔄 Step 3: Processing patient dates...
[04:32:57] [DOC: 9251738] ℹ️  DOB normalized: 06/22/1939
[04:32:57] [DOC: 9251738] ℹ️  Episode startOfCare normalized: 04/01/2023
[04:32:57] [DOC: 9251738] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[04:32:57] [DOC: 9251738] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[04:32:57] [DOC: 9251738] ✅ Patient date processing completed successfully
[04:32:57] ✅    ✅ Date processing completed
[04:32:57] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Alves
     └─ dob: 06/22/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 101001663
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2023', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'F03.A3', 'secondDiagnosis': 'F03.A4', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'M47.816'}]
[04:32:57] 🔄 
🔄 Step 4: Extracting order data...
[04:33:00] ℹ️  Order extraction - MRN: '101001663'
[04:33:00] ℹ️  Order extraction - Sex: 'MALE'
[04:33:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:33:00] ℹ️  Order extraction - Payer Source: 'SWH'
[04:33:00] ✅ Order data extraction completed successfully
[04:33:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:33:00] ℹ️  Using MRN from patient data: '101001663' over '101001663'
[04:33:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:33:00] ℹ️  Payer source consistent in both sources: 'SWH'
[04:33:00] ✅ Patient name cross-validation successful
[04:33:00] ✅    ✅ Data merged successfully
[04:33:01] ✅    ✅ Order data extracted and validated
[04:33:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:33:09] [DOC: 9251738] ✅ Patient exists in API: Luis Alves, ID: 20be7d0d-dfea-405b-9bed-a172e1b472b6
[04:33:09] ✅    ✅ Existing patient found with ID: 20be7d0d-dfea-405b-9bed-a172e1b472b6
[04:33:09] 🔄 
🔄 Step 6: Pushing order to API...
[04:33:09] [DOC: 9251738] ℹ️  Pushing order via API for patient ID: 20be7d0d-dfea-405b-9bed-a172e1b472b6
[04:33:10] [DOC: 9251738] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12872"}
[04:33:10] ❌    ❌ Failed to push order
[04:33:10] 🔄 
🔄 Step 7: Writing to CSV...
[04:33:10] [DOC: 9251738] ℹ️  Calculated age: 85 from DOB: 06/22/1939
[04:33:10] [DOC: 9251738] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:33:10] [DOC: 9251738] ℹ️  Payer Source extracted: 'SWH'
[04:33:10] [DOC: 9251738] ℹ️  Diagnosis codes being written:
[04:33:10] [DOC: 9251738] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.A3'
[04:33:10] [DOC: 9251738] ℹ️    - Latest_Episode_Seconddiagnosis: 'F03.A4'
[04:33:10] [DOC: 9251738] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.51'
[04:33:10] [DOC: 9251738] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[04:33:10] [DOC: 9251738] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.9'
[04:33:10] [DOC: 9251738] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M47.816'
[04:33:10] [DOC: 9251738] ✅ Patient data written to CSV: Luis Alves | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer: SWH | MRN: 101001663
[04:33:10] ✅    ✅ Document 9251738 processed and saved successfully
[04:33:10] 🔄 
🔄 Step 8: Saving API details...
[04:33:10] [DOC: 9251738] ℹ️  API push details saved for document 9251738
[04:33:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251575                         ║
================================================================================
[04:33:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:33:10] ℹ️  Date: 04/21/2025
[04:33:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:33:13] [DOC: 9251575] ✅ Text extracted using pdfplumber (1375 chars)
[04:33:13] ✅    ✅ Text extracted using pdfplumber (1363 chars)
[04:33:13] 🔄 
🔄 Step 2: Extracting patient data...
[04:33:16] ℹ️  AI extracted raw sex value: ''
[04:33:16] ℹ️  AI extracted service line: 'PT'
[04:33:16] ℹ️  AI extracted payer source: ''
[04:33:16] ℹ️  AI extracted diagnoses:
[04:33:16] ℹ️    - Diagnosis 1: 'L03.115'
[04:33:16] ℹ️    - Diagnosis 2: 'L97.411'
[04:33:16] ℹ️    - Diagnosis 3: 'E78.1'
[04:33:16] ℹ️    - Diagnosis 4: ''
[04:33:16] ℹ️    - Diagnosis 5: ''
[04:33:16] ℹ️    - Diagnosis 6: ''
[04:33:16] ℹ️  Final extracted MRN: 'MA250410047607'
[04:33:16] ℹ️  Final extracted Sex: ''
[04:33:16] ℹ️  Final extracted Service Line: 'PT'
[04:33:16] ℹ️  Final extracted Payer Source: ''
[04:33:16] ✅ Patient data extraction completed successfully
[04:33:16] ✅    ✅ Patient data extracted successfully
[04:33:16] 📊 Patient Response
     └─ patientFName: Barry
     └─ patientLName: Williams
     └─ dob: 04/24/1976
     └─ patientSex: 
     └─ medicalRecordNo: MA250410047607
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'L03.115', 'secondDiagnosis': 'L97.411', 'thirdDiagnosis': 'E78.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:33:16] ✅    ✅ Patient identified: Barry Williams
[04:33:16] ✅    ✅ Patient name validation passed
[04:33:16] 🔄 
🔄 Step 3: Processing patient dates...
[04:33:16] [DOC: 9251575] ℹ️  DOB normalized: 04/24/1976
[04:33:16] [DOC: 9251575] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[04:33:16] [DOC: 9251575] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[04:33:16] [DOC: 9251575] ✅ Patient date processing completed successfully
[04:33:16] ✅    ✅ Date processing completed
[04:33:16] 📊 Processed Patient Data
     └─ patientFName: Barry
     └─ patientLName: Williams
     └─ dob: 04/24/1976
     └─ patientSex: 
     └─ medicalRecordNo: MA250410047607
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'L03.115', 'secondDiagnosis': 'L97.411', 'thirdDiagnosis': 'E78.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:33:16] 🔄 
🔄 Step 4: Extracting order data...
[04:33:18] ℹ️  Order extraction - MRN: 'MA250410047607'
[04:33:18] ℹ️  Order extraction - Sex: ''
[04:33:18] ℹ️  Order extraction - Service Line: 'PT'
[04:33:18] ℹ️  Order extraction - Payer Source: ''
[04:33:18] ✅ Order data extraction completed successfully
[04:33:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:33:18] ℹ️  Using MRN from patient data: 'MA250410047607' over 'MA250410047607'
[04:33:18] ⚠️  Could not determine sex using any available method
[04:33:18] ℹ️  Service line consistent in both sources: 'PT'
[04:33:18] ✅ Patient name cross-validation successful
[04:33:18] ✅    ✅ Data merged successfully
[04:33:20] ✅    ✅ Order data extracted and validated
[04:33:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:33:43] [DOC: 9251575] ✅ Patient exists in API: Barry Williams, ID: af17f13a-ffac-4215-be0d-eb8b7be87062
[04:33:43] ✅    ✅ Existing patient found with ID: af17f13a-ffac-4215-be0d-eb8b7be87062
[04:33:43] 🔄 
🔄 Step 6: Pushing order to API...
[04:33:43] [DOC: 9251575] ℹ️  Pushing order via API for patient ID: af17f13a-ffac-4215-be0d-eb8b7be87062
[04:33:45] [DOC: 9251575] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14424"}
[04:33:45] ❌    ❌ Failed to push order
[04:33:45] 🔄 
🔄 Step 7: Writing to CSV...
[04:33:45] [DOC: 9251575] ℹ️  Calculated age: 49 from DOB: 04/24/1976
[04:33:45] [DOC: 9251575] ℹ️  Service Line extracted: 'PT'
[04:33:45] [DOC: 9251575] ℹ️  Payer Source extracted: ''
[04:33:45] [DOC: 9251575] ℹ️  Diagnosis codes being written:
[04:33:45] [DOC: 9251575] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.115'
[04:33:45] [DOC: 9251575] ℹ️    - Latest_Episode_Seconddiagnosis: 'L97.411'
[04:33:45] [DOC: 9251575] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.1'
[04:33:45] [DOC: 9251575] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:33:45] [DOC: 9251575] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:33:45] [DOC: 9251575] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:33:45] [DOC: 9251575] ✅ Patient data written to CSV: Barry Williams | Sex:  | Age: 49 | Service: PT | Payer:  | MRN: MA250410047607
[04:33:45] ✅    ✅ Document 9251575 processed and saved successfully
[04:33:45] 🔄 
🔄 Step 8: Saving API details...
[04:33:45] [DOC: 9251575] ℹ️  API push details saved for document 9251575
[04:33:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251574                         ║
================================================================================
[04:33:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:33:45] ℹ️  Date: 04/21/2025
[04:33:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:33:48] [DOC: 9251574] ✅ Text extracted using pdfplumber (17749 chars)
[04:33:48] ✅    ✅ Text extracted using pdfplumber (17737 chars)
[04:33:48] 🔄 
🔄 Step 2: Extracting patient data...
[04:33:52] ℹ️  AI extracted raw sex value: 'M'
[04:33:52] ℹ️  AI extracted service line: 'Physical Therapy'
[04:33:52] ℹ️  AI extracted payer source: 'Medicare'
[04:33:52] ℹ️  AI extracted diagnoses:
[04:33:52] ℹ️    - Diagnosis 1: 'L03.115'
[04:33:52] ℹ️    - Diagnosis 2: 'L97.411'
[04:33:52] ℹ️    - Diagnosis 3: 'E78.1'
[04:33:52] ℹ️    - Diagnosis 4: 'E72.20'
[04:33:52] ℹ️    - Diagnosis 5: 'E66.01'
[04:33:52] ℹ️    - Diagnosis 6: 'F79'
[04:33:52] ℹ️  Final extracted MRN: 'MA250410047607'
[04:33:52] ℹ️  Final extracted Sex: 'MALE'
[04:33:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[04:33:52] ℹ️  Final extracted Payer Source: 'Medicare'
[04:33:52] ✅ Patient data extraction completed successfully
[04:33:52] ✅    ✅ Patient data extracted successfully
[04:33:52] 📊 Patient Response
     └─ patientFName: Barry
     └─ patientLName: Williams
     └─ dob: 04/24/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250410047607
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 331 Durfee St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 636-8240
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'L03.115', 'secondDiagnosis': 'L97.411', 'thirdDiagnosis': 'E78.1', 'fourthDiagnosis': 'E72.20', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'F79'}]
[04:33:52] ✅    ✅ Patient identified: Barry Williams
[04:33:52] ✅    ✅ Patient name validation passed
[04:33:52] 🔄 
🔄 Step 3: Processing patient dates...
[04:33:52] [DOC: 9251574] ℹ️  DOB normalized: 04/24/1976
[04:33:52] [DOC: 9251574] ℹ️  Episode startOfCare normalized: 04/14/2025
[04:33:52] [DOC: 9251574] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[04:33:52] [DOC: 9251574] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[04:33:52] [DOC: 9251574] ✅ Patient date processing completed successfully
[04:33:52] ✅    ✅ Date processing completed
[04:33:52] 📊 Processed Patient Data
     └─ patientFName: Barry
     └─ patientLName: Williams
     └─ dob: 04/24/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250410047607
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 331 Durfee St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 636-8240
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'L03.115', 'secondDiagnosis': 'L97.411', 'thirdDiagnosis': 'E78.1', 'fourthDiagnosis': 'E72.20', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'F79'}]
[04:33:52] 🔄 
🔄 Step 4: Extracting order data...
[04:33:54] ℹ️  Order extraction - MRN: 'MA250410047607'
[04:33:54] ℹ️  Order extraction - Sex: 'MALE'
[04:33:54] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[04:33:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:33:54] ✅ Order data extraction completed successfully
[04:33:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:33:54] ℹ️  Using MRN from patient data: 'MA250410047607' over 'MA250410047607'
[04:33:54] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[04:33:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:33:54] ✅ Patient name cross-validation successful
[04:33:54] ✅    ✅ Data merged successfully
[04:33:56] ✅    ✅ Order data extracted and validated
[04:33:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:33:56] [DOC: 9251574] ✅ Patient found in local cache: Barry Williams, ID: af17f13a-ffac-4215-be0d-eb8b7be87062
[04:33:56] ✅    ✅ Existing patient found with ID: af17f13a-ffac-4215-be0d-eb8b7be87062
[04:33:56] 🔄 
🔄 Step 6: Pushing order to API...
[04:33:56] [DOC: 9251574] ℹ️  Pushing order via API for patient ID: af17f13a-ffac-4215-be0d-eb8b7be87062
[04:33:58] [DOC: 9251574] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14425"}
[04:33:58] ❌    ❌ Failed to push order
[04:33:58] 🔄 
🔄 Step 7: Writing to CSV...
[04:33:58] [DOC: 9251574] ℹ️  Calculated age: 49 from DOB: 04/24/1976
[04:33:58] [DOC: 9251574] ℹ️  Service Line extracted: 'Physical Therapy'
[04:33:58] [DOC: 9251574] ℹ️  Payer Source extracted: 'Medicare'
[04:33:58] [DOC: 9251574] ℹ️  Diagnosis codes being written:
[04:33:58] [DOC: 9251574] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.115'
[04:33:58] [DOC: 9251574] ℹ️    - Latest_Episode_Seconddiagnosis: 'L97.411'
[04:33:58] [DOC: 9251574] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.1'
[04:33:58] [DOC: 9251574] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E72.20'
[04:33:58] [DOC: 9251574] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.01'
[04:33:58] [DOC: 9251574] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F79'
[04:33:58] [DOC: 9251574] ✅ Patient data written to CSV: Barry Williams | Sex: MALE | Age: 49 | Service: Physical Therapy | Payer: Medicare | MRN: MA250410047607
[04:33:58] ✅    ✅ Document 9251574 processed and saved successfully
[04:33:58] 🔄 
🔄 Step 8: Saving API details...
[04:33:58] [DOC: 9251574] ℹ️  API push details saved for document 9251574
[04:33:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251566                         ║
================================================================================
[04:33:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:33:58] ℹ️  Date: 04/21/2025
[04:33:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:34:00] [DOC: 9251566] ✅ Text extracted using pdfplumber (7089 chars)
[04:34:00] ✅    ✅ Text extracted using pdfplumber (7089 chars)
[04:34:00] 🔄 
🔄 Step 2: Extracting patient data...
[04:34:04] ℹ️  AI extracted raw sex value: 'M'
[04:34:04] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[04:34:04] ℹ️  AI extracted payer source: 'Medicare'
[04:34:04] ℹ️  AI extracted diagnoses:
[04:34:04] ℹ️    - Diagnosis 1: 'J96.01'
[04:34:04] ℹ️    - Diagnosis 2: 'Q90.9'
[04:34:04] ℹ️    - Diagnosis 3: 'E66.01'
[04:34:04] ℹ️    - Diagnosis 4: 'J39.8'
[04:34:04] ℹ️    - Diagnosis 5: 'None'
[04:34:04] ℹ️    - Diagnosis 6: 'None'
[04:34:04] ℹ️  Final extracted MRN: 'MA240808027001'
[04:34:04] ℹ️  Final extracted Sex: 'MALE'
[04:34:04] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[04:34:04] ℹ️  Final extracted Payer Source: 'Medicare'
[04:34:04] ✅ Patient data extraction completed successfully
[04:34:04] ✅    ✅ Patient data extracted successfully
[04:34:04] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 192 Thompson St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 328-4225
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': 'J39.8', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:34:04] ✅    ✅ Patient identified: Rafael Talavera
[04:34:04] ✅    ✅ Patient name validation passed
[04:34:04] 🔄 
🔄 Step 3: Processing patient dates...
[04:34:04] [DOC: 9251566] ℹ️  DOB normalized: 02/10/1970
[04:34:04] [DOC: 9251566] ℹ️  Episode startOfCare normalized: 02/03/2025
[04:34:04] [DOC: 9251566] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[04:34:04] [DOC: 9251566] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[04:34:04] [DOC: 9251566] ✅ Patient date processing completed successfully
[04:34:04] ✅    ✅ Date processing completed
[04:34:04] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 192 Thompson St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 328-4225
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': 'J39.8'}]
[04:34:04] 🔄 
🔄 Step 4: Extracting order data...
[04:34:06] ℹ️  Order extraction - MRN: 'MA240808027001'
[04:34:06] ℹ️  Order extraction - Sex: 'MALE'
[04:34:06] ℹ️  Order extraction - Service Line: 'PT, Skilled Nursing'
[04:34:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:34:06] ✅ Order data extraction completed successfully
[04:34:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:34:06] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[04:34:06] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='PT, Skilled Nursing' = 'OT, PT, Skilled Nursing'
[04:34:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:34:06] ✅ Patient name cross-validation successful
[04:34:06] ✅    ✅ Data merged successfully
[04:34:08] ✅    ✅ Order data extracted and validated
[04:34:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:34:08] [DOC: 9251566] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[04:34:08] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[04:34:08] 🔄 
🔄 Step 6: Pushing order to API...
[04:34:08] [DOC: 9251566] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[04:34:09] [DOC: 9251566] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14480"}
[04:34:09] ❌    ❌ Failed to push order
[04:34:09] 🔄 
🔄 Step 7: Writing to CSV...
[04:34:09] [DOC: 9251566] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[04:34:09] [DOC: 9251566] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[04:34:09] [DOC: 9251566] ℹ️  Payer Source extracted: 'Medicare'
[04:34:09] [DOC: 9251566] ℹ️  Diagnosis codes being written:
[04:34:09] [DOC: 9251566] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.01'
[04:34:09] [DOC: 9251566] ℹ️    - Latest_Episode_Seconddiagnosis: 'Q90.9'
[04:34:09] [DOC: 9251566] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.01'
[04:34:09] [DOC: 9251566] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J39.8'
[04:34:09] [DOC: 9251566] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:34:09] [DOC: 9251566] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:34:09] [DOC: 9251566] ✅ Patient data written to CSV: Rafael Talavera | Sex: MALE | Age: 55 | Service: OT, PT, Skilled Nursing | Payer: Medicare | MRN: MA240808027001
[04:34:09] ✅    ✅ Document 9251566 processed and saved successfully
[04:34:09] 🔄 
🔄 Step 8: Saving API details...
[04:34:09] [DOC: 9251566] ℹ️  API push details saved for document 9251566
[04:34:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251561                         ║
================================================================================
[04:34:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:34:09] ℹ️  Date: 04/21/2025
[04:34:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:34:14] [DOC: 9251561] ✅ Text extracted using pdfplumber (10751 chars)
[04:34:14] ✅    ✅ Text extracted using pdfplumber (10751 chars)
[04:34:14] 🔄 
🔄 Step 2: Extracting patient data...
[04:34:17] ℹ️  AI extracted raw sex value: 'M'
[04:34:17] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[04:34:17] ℹ️  AI extracted payer source: 'Medicare'
[04:34:17] ℹ️  AI extracted diagnoses:
[04:34:17] ℹ️    - Diagnosis 1: 'N39.0'
[04:34:17] ℹ️    - Diagnosis 2: 'B96.20'
[04:34:17] ℹ️    - Diagnosis 3: 'J45.901'
[04:34:17] ℹ️    - Diagnosis 4: 'J96.01'
[04:34:17] ℹ️    - Diagnosis 5: 'Q90.9'
[04:34:17] ℹ️    - Diagnosis 6: 'E66.01'
[04:34:17] ℹ️  Final extracted MRN: 'MA240808027001'
[04:34:17] ℹ️  Final extracted Sex: 'MALE'
[04:34:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[04:34:17] ℹ️  Final extracted Payer Source: 'Medicare'
[04:34:17] ✅ Patient data extraction completed successfully
[04:34:17] ✅    ✅ Patient data extracted successfully
[04:34:17] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 192 Thompson St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 328-4225
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'J45.901', 'fourthDiagnosis': 'J96.01', 'fifthDiagnosis': 'Q90.9', 'sixthDiagnosis': 'E66.01'}]
[04:34:17] ✅    ✅ Patient identified: Rafael Talavera
[04:34:17] ✅    ✅ Patient name validation passed
[04:34:17] 🔄 
🔄 Step 3: Processing patient dates...
[04:34:17] [DOC: 9251561] ℹ️  DOB normalized: 02/10/1970
[04:34:17] [DOC: 9251561] ℹ️  Episode startOfCare normalized: 02/03/2025
[04:34:17] [DOC: 9251561] ℹ️  Episode startOfEpisode normalized: 02/03/2025
[04:34:17] [DOC: 9251561] ℹ️  Episode endOfEpisode normalized: 04/03/2025
[04:34:17] [DOC: 9251561] ✅ Patient date processing completed successfully
[04:34:17] ✅    ✅ Date processing completed
[04:34:17] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 192 Thompson St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 328-4225
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.20', 'thirdDiagnosis': 'J45.901', 'fourthDiagnosis': 'J96.01', 'fifthDiagnosis': 'Q90.9', 'sixthDiagnosis': 'E66.01'}]
[04:34:17] 🔄 
🔄 Step 4: Extracting order data...
[04:34:20] ℹ️  Order extraction - MRN: 'MA240808027001'
[04:34:20] ℹ️  Order extraction - Sex: 'MALE'
[04:34:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[04:34:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:34:20] ✅ Order data extraction completed successfully
[04:34:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:34:20] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[04:34:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[04:34:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:34:20] ✅ Patient name cross-validation successful
[04:34:20] ✅    ✅ Data merged successfully
[04:34:21] ✅    ✅ Order data extracted and validated
[04:34:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:34:21] [DOC: 9251561] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[04:34:21] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[04:34:21] 🔄 
🔄 Step 6: Pushing order to API...
[04:34:21] [DOC: 9251561] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[04:34:23] [DOC: 9251561] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14481"}
[04:34:23] ❌    ❌ Failed to push order
[04:34:23] 🔄 
🔄 Step 7: Writing to CSV...
[04:34:23] [DOC: 9251561] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[04:34:23] [DOC: 9251561] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[04:34:23] [DOC: 9251561] ℹ️  Payer Source extracted: 'Medicare'
[04:34:23] [DOC: 9251561] ℹ️  Diagnosis codes being written:
[04:34:23] [DOC: 9251561] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[04:34:23] [DOC: 9251561] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.20'
[04:34:23] [DOC: 9251561] ℹ️    - Latest_Episode_Thirddiagnosis: 'J45.901'
[04:34:23] [DOC: 9251561] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.01'
[04:34:23] [DOC: 9251561] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Q90.9'
[04:34:23] [DOC: 9251561] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[04:34:23] [DOC: 9251561] ✅ Patient data written to CSV: Rafael Talavera | Sex: MALE | Age: 55 | Service: Skilled Nursing, Physical Therapy | Payer: Medicare | MRN: MA240808027001
[04:34:23] ✅    ✅ Document 9251561 processed and saved successfully
[04:34:23] 🔄 
🔄 Step 8: Saving API details...
[04:34:23] [DOC: 9251561] ℹ️  API push details saved for document 9251561
[04:34:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9250807                         ║
================================================================================
[04:34:23] ℹ️  Agency: Nizhoni Health-Fall River
[04:34:23] ℹ️  Date: 04/21/2025
[04:34:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:34:29] [DOC: 9250807] ✅ Text extracted using pdfplumber (10147 chars)
[04:34:29] ✅    ✅ Text extracted using pdfplumber (10147 chars)
[04:34:29] 🔄 
🔄 Step 2: Extracting patient data...
[04:34:33] ℹ️  AI extracted raw sex value: 'F'
[04:34:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:34:33] ℹ️  AI extracted payer source: 'None'
[04:34:33] ℹ️  AI extracted diagnoses:
[04:34:33] ℹ️    - Diagnosis 1: 'F32.9'
[04:34:33] ℹ️    - Diagnosis 2: 'F41.1'
[04:34:33] ℹ️    - Diagnosis 3: 'F43.10'
[04:34:33] ℹ️    - Diagnosis 4: 'I10'
[04:34:33] ℹ️    - Diagnosis 5: 'E11.9'
[04:34:33] ℹ️    - Diagnosis 6: 'E66.9'
[04:34:33] ℹ️  Final extracted MRN: '3761020'
[04:34:33] ℹ️  Final extracted Sex: 'FEMALE'
[04:34:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:34:33] ℹ️  Final extracted Payer Source: ''
[04:34:33] ✅ Patient data extraction completed successfully
[04:34:33] ✅    ✅ Patient data extracted successfully
[04:34:33] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100007365347
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'E66.9'}]
[04:34:33] ✅    ✅ Patient identified: Carol Jimon-Ajqui
[04:34:33] ✅    ✅ Patient name validation passed
[04:34:33] 🔄 
🔄 Step 3: Processing patient dates...
[04:34:33] [DOC: 9250807] ℹ️  DOB normalized: 08/23/1974
[04:34:33] [DOC: 9250807] ℹ️  Episode startOfCare normalized: 01/04/2023
[04:34:33] [DOC: 9250807] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[04:34:33] [DOC: 9250807] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[04:34:33] [DOC: 9250807] ✅ Patient date processing completed successfully
[04:34:33] ✅    ✅ Date processing completed
[04:34:33] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100007365347
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'E66.9'}]
[04:34:33] 🔄 
🔄 Step 4: Extracting order data...
[04:34:35] ℹ️  Order extraction - MRN: '3761020'
[04:34:35] ℹ️  Order extraction - Sex: 'FEMALE'
[04:34:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:34:35] ℹ️  Order extraction - Payer Source: ''
[04:34:35] ✅ Order data extraction completed successfully
[04:34:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:34:35] ℹ️  Using MRN from patient data: '3761020' over '3761020'
[04:34:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:34:35] ✅ Patient name cross-validation successful
[04:34:35] ✅    ✅ Data merged successfully
[04:34:37] ✅    ✅ Order data extracted and validated
[04:34:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:34:45] [DOC: 9250807] ℹ️  Patient not found in cache or API: Carol Jimon-Ajqui
[04:34:45] [DOC: 9250807] ℹ️  Patient not found, creating new patient via API...
[04:34:45] [DOC: 9250807] ℹ️  Creating patient via API: Carol Jimon-Ajqui
[04:34:46] [DOC: 9250807] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:34:46] ❌    ❌ Failed to create patient
[04:34:46] [DOC: 9250807] ℹ️  API push details saved for document 9250807
================================================================================
║                        Processing Document ID: 9250816                         ║
================================================================================
[04:34:46] ℹ️  Agency: Visiting Rehab & Nursing Services
[04:34:46] ℹ️  Date: 04/21/2025
[04:34:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:34:48] [DOC: 9250816] ✅ Text extracted using pdfplumber (4379 chars)
[04:34:48] ✅    ✅ Text extracted using pdfplumber (4379 chars)
[04:34:48] 🔄 
🔄 Step 2: Extracting patient data...
[04:34:50] ℹ️  AI extracted raw sex value: 'None'
[04:34:50] ℹ️  AI extracted service line: 'None'
[04:34:50] ℹ️  AI extracted payer source: 'None'
[04:34:50] ℹ️  AI extracted diagnoses:
[04:34:50] ℹ️    - Diagnosis 1: ''
[04:34:50] ℹ️    - Diagnosis 2: ''
[04:34:50] ℹ️    - Diagnosis 3: ''
[04:34:50] ℹ️    - Diagnosis 4: ''
[04:34:50] ℹ️    - Diagnosis 5: ''
[04:34:50] ℹ️    - Diagnosis 6: ''
[04:34:50] ℹ️  Final extracted MRN: ''
[04:34:50] ℹ️  Final extracted Sex: ''
[04:34:50] ℹ️  Final extracted Service Line: ''
[04:34:50] ℹ️  Final extracted Payer Source: ''
[04:34:50] ✅ Patient data extraction completed successfully
[04:34:50] ✅    ✅ Patient data extracted successfully
[04:34:50] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[04:34:50] ⚠️     ❌ Insufficient patient data extracted
[04:34:50] [DOC: 9250816] ℹ️  API push details saved for document 9250816
================================================================================
║                        Processing Document ID: 9250373                         ║
================================================================================
[04:34:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:34:50] ℹ️  Date: 04/21/2025
[04:34:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:34:53] [DOC: 9250373] ✅ Text extracted using pdfplumber (12326 chars)
[04:34:53] ✅    ✅ Text extracted using pdfplumber (12326 chars)
[04:34:53] 🔄 
🔄 Step 2: Extracting patient data...
[04:34:56] ℹ️  AI extracted raw sex value: 'F'
[04:34:56] ℹ️  AI extracted service line: 'OT'
[04:34:56] ℹ️  AI extracted payer source: ''
[04:34:56] ℹ️  AI extracted diagnoses:
[04:34:56] ℹ️    - Diagnosis 1: ''
[04:34:56] ℹ️    - Diagnosis 2: ''
[04:34:56] ℹ️    - Diagnosis 3: ''
[04:34:56] ℹ️    - Diagnosis 4: ''
[04:34:56] ℹ️    - Diagnosis 5: ''
[04:34:56] ℹ️    - Diagnosis 6: ''
[04:34:56] ℹ️  Final extracted MRN: '1258286710'
[04:34:56] ℹ️  Final extracted Sex: 'FEMALE'
[04:34:56] ℹ️  Final extracted Service Line: 'OT'
[04:34:56] ℹ️  Final extracted Payer Source: ''
[04:34:56] ✅ Patient data extraction completed successfully
[04:34:56] ✅    ✅ Patient data extracted successfully
[04:34:56] 📊 Patient Response
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1258286710
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:34:56] ✅    ✅ Patient identified: Carmen Nunes
[04:34:56] ✅    ✅ Patient name validation passed
[04:34:56] 🔄 
🔄 Step 3: Processing patient dates...
[04:34:56] [DOC: 9250373] ℹ️  DOB normalized: 05/24/1941
[04:34:56] [DOC: 9250373] ✅ Patient date processing completed successfully
[04:34:56] ✅    ✅ Date processing completed
[04:34:56] 📊 Processed Patient Data
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1258286710
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:34:56] 🔄 
🔄 Step 4: Extracting order data...
[04:34:58] ℹ️  Order extraction - MRN: 'MA210707054107'
[04:34:58] ℹ️  Order extraction - Sex: 'FEMALE'
[04:34:58] ℹ️  Order extraction - Service Line: 'OT'
[04:34:58] ℹ️  Order extraction - Payer Source: ''
[04:34:58] ✅ Order data extraction completed successfully
[04:34:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:34:58] ℹ️  Using longer MRN from order data: 'MA210707054107' over '1258286710'
[04:34:58] ℹ️  Service line consistent in both sources: 'OT'
[04:34:58] ✅ Patient name cross-validation successful
[04:34:58] ✅    ✅ Data merged successfully
[04:34:59] ⚠️     ❌ Skipping - missing episode start date
[04:34:59] [DOC: 9250373] ℹ️  API push details saved for document 9250373
================================================================================
║                        Processing Document ID: 9249974                         ║
================================================================================
[04:34:59] ℹ️  Agency: AccentCare Fall River
[04:34:59] ℹ️  Date: 04/21/2025
[04:34:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:35:08] [DOC: 9249974] ✅ Text extracted using pdfplumber (7814 chars)
[04:35:08] ✅    ✅ Text extracted using pdfplumber (7814 chars)
[04:35:08] 🔄 
🔄 Step 2: Extracting patient data...
[04:35:11] ℹ️  AI extracted raw sex value: 'F'
[04:35:11] ℹ️  AI extracted service line: 'Skilled Nursing, BH RN'
[04:35:11] ℹ️  AI extracted payer source: ''
[04:35:11] ℹ️  AI extracted diagnoses:
[04:35:11] ℹ️    - Diagnosis 1: 'F03.90'
[04:35:11] ℹ️    - Diagnosis 2: ''
[04:35:11] ℹ️    - Diagnosis 3: ''
[04:35:11] ℹ️    - Diagnosis 4: ''
[04:35:11] ℹ️    - Diagnosis 5: ''
[04:35:11] ℹ️    - Diagnosis 6: ''
[04:35:11] ℹ️  Final extracted MRN: 'C0200225049201'
[04:35:11] ℹ️  Final extracted Sex: 'FEMALE'
[04:35:11] ℹ️  Final extracted Service Line: 'Skilled Nursing, BH RN'
[04:35:11] ℹ️  Final extracted Payer Source: ''
[04:35:11] ✅ Patient data extraction completed successfully
[04:35:11] ✅    ✅ Patient data extracted successfully
[04:35:11] 📊 Patient Response
     └─ patientFName: Brunilda
     └─ patientLName: Jorge
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, BH RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:35:11] ✅    ✅ Patient identified: Brunilda Jorge
[04:35:11] ✅    ✅ Patient name validation passed
[04:35:11] 🔄 
🔄 Step 3: Processing patient dates...
[04:35:11] [DOC: 9249974] ℹ️  DOB normalized: 11/15/1938
[04:35:11] [DOC: 9249974] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[04:35:11] [DOC: 9249974] ✅ Patient date processing completed successfully
[04:35:11] ✅    ✅ Date processing completed
[04:35:11] 📊 Processed Patient Data
     └─ patientFName: Brunilda
     └─ patientLName: Jorge
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, BH RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:35:11] 🔄 
🔄 Step 4: Extracting order data...
[04:35:14] ℹ️  Order extraction - MRN: 'C0200225049201'
[04:35:14] ℹ️  Order extraction - Sex: 'FEMALE'
[04:35:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Psych RN'
[04:35:14] ℹ️  Order extraction - Payer Source: ''
[04:35:14] ✅ Order data extraction completed successfully
[04:35:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:35:14] ℹ️  Using MRN from patient data: 'C0200225049201' over 'C0200225049201'
[04:35:14] ℹ️  Combined service lines: Patient='Skilled Nursing, BH RN' + Order='Skilled Nursing, Psych RN' = 'BH RN, Psych RN, Skilled Nursing'
[04:35:14] ✅ Patient name cross-validation successful
[04:35:14] ✅    ✅ Data merged successfully
[04:35:15] ✅    ✅ Order data extracted and validated
[04:35:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:35:15] [DOC: 9249974] ✅ Patient found in local cache: Brunilda Jorge, ID: be097701-4784-41f4-8780-f2f69c6e2485
[04:35:15] ✅    ✅ Existing patient found with ID: be097701-4784-41f4-8780-f2f69c6e2485
[04:35:15] 🔄 
🔄 Step 6: Pushing order to API...
[04:35:15] [DOC: 9249974] ℹ️  Pushing order via API for patient ID: be097701-4784-41f4-8780-f2f69c6e2485
[04:35:16] [DOC: 9249974] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13874"}
[04:35:16] ❌    ❌ Failed to push order
[04:35:16] 🔄 
🔄 Step 7: Writing to CSV...
[04:35:16] [DOC: 9249974] ℹ️  Calculated age: 86 from DOB: 11/15/1938
[04:35:16] [DOC: 9249974] ℹ️  Service Line extracted: 'BH RN, Psych RN, Skilled Nursing'
[04:35:16] [DOC: 9249974] ℹ️  Payer Source extracted: ''
[04:35:16] [DOC: 9249974] ℹ️  Diagnosis codes being written:
[04:35:16] [DOC: 9249974] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[04:35:16] [DOC: 9249974] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:35:16] [DOC: 9249974] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:35:16] [DOC: 9249974] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:35:16] [DOC: 9249974] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:35:16] [DOC: 9249974] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:35:16] [DOC: 9249974] ✅ Patient data written to CSV: Brunilda Jorge | Sex: FEMALE | Age: 86 | Service: BH RN, Psych RN, Skilled Nursing | Payer:  | MRN: C0200225049201
[04:35:16] ✅    ✅ Document 9249974 processed and saved successfully
[04:35:16] 🔄 
🔄 Step 8: Saving API details...
[04:35:16] [DOC: 9249974] ℹ️  API push details saved for document 9249974
[04:35:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249734                         ║
================================================================================
[04:35:16] ℹ️  Agency: AccentCare Fall River
[04:35:16] ℹ️  Date: 04/21/2025
[04:35:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:35:19] [DOC: 9249734] ✅ Text extracted using pdfplumber (1183 chars)
[04:35:19] ✅    ✅ Text extracted using pdfplumber (1183 chars)
[04:35:19] 🔄 
🔄 Step 2: Extracting patient data...
[04:35:22] ℹ️  AI extracted raw sex value: ''
[04:35:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:35:22] ℹ️  AI extracted payer source: ''
[04:35:22] ℹ️  AI extracted diagnoses:
[04:35:22] ℹ️    - Diagnosis 1: ''
[04:35:22] ℹ️    - Diagnosis 2: ''
[04:35:22] ℹ️    - Diagnosis 3: ''
[04:35:22] ℹ️    - Diagnosis 4: ''
[04:35:22] ℹ️    - Diagnosis 5: ''
[04:35:22] ℹ️    - Diagnosis 6: ''
[04:35:22] ℹ️  Final extracted MRN: 'C0200237608801'
[04:35:22] ℹ️  Final extracted Sex: ''
[04:35:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:35:22] ℹ️  Final extracted Payer Source: ''
[04:35:22] ✅ Patient data extraction completed successfully
[04:35:22] ✅    ✅ Patient data extracted successfully
[04:35:22] 📊 Patient Response
     └─ patientFName: JOHANNES
     └─ patientLName: NAGTEGAAL
     └─ dob: 11/10/1947
     └─ patientSex: 
     └─ medicalRecordNo: C0200237608801
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:35:22] ✅    ✅ Patient identified: JOHANNES NAGTEGAAL
[04:35:22] ✅    ✅ Patient name validation passed
[04:35:22] 🔄 
🔄 Step 3: Processing patient dates...
[04:35:22] [DOC: 9249734] ℹ️  DOB normalized: 11/10/1947
[04:35:22] [DOC: 9249734] ✅ Patient date processing completed successfully
[04:35:22] ✅    ✅ Date processing completed
[04:35:22] 📊 Processed Patient Data
     └─ patientFName: JOHANNES
     └─ patientLName: NAGTEGAAL
     └─ dob: 11/10/1947
     └─ patientSex: 
     └─ medicalRecordNo: C0200237608801
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:35:22] 🔄 
🔄 Step 4: Extracting order data...
[04:35:25] ℹ️  Order extraction - MRN: 'C0200237608801'
[04:35:25] ℹ️  Order extraction - Sex: ''
[04:35:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:35:25] ℹ️  Order extraction - Payer Source: ''
[04:35:25] ✅ Order data extraction completed successfully
[04:35:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:35:25] ℹ️  Using MRN from patient data: 'C0200237608801' over 'C0200237608801'
[04:35:25] ⚠️  Could not determine sex using any available method
[04:35:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:35:25] ✅ Patient name cross-validation successful
[04:35:25] ✅    ✅ Data merged successfully
[04:35:26] ✅    ✅ Order data extracted and validated
[04:35:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:35:44] [DOC: 9249734] ℹ️  Patient not found in cache or API: JOHANNES NAGTEGAAL
[04:35:44] [DOC: 9249734] ℹ️  Patient not found, creating new patient via API...
[04:35:44] [DOC: 9249734] ℹ️  Creating patient via API: JOHANNES NAGTEGAAL
[04:35:51] [DOC: 9249734] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:35:51] ❌    ❌ Failed to create patient
[04:35:51] [DOC: 9249734] ℹ️  API push details saved for document 9249734
================================================================================
║                        Processing Document ID: 9249731                         ║
================================================================================
[04:35:51] ℹ️  Agency: AccentCare Fall River
[04:35:51] ℹ️  Date: 04/21/2025
[04:35:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:35:53] [DOC: 9249731] ✅ Text extracted using pdfplumber (1186 chars)
[04:35:53] ✅    ✅ Text extracted using pdfplumber (1186 chars)
[04:35:53] 🔄 
🔄 Step 2: Extracting patient data...
[04:35:56] ℹ️  AI extracted raw sex value: ''
[04:35:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:35:56] ℹ️  AI extracted payer source: ''
[04:35:56] ℹ️  AI extracted diagnoses:
[04:35:56] ℹ️    - Diagnosis 1: ''
[04:35:56] ℹ️    - Diagnosis 2: ''
[04:35:56] ℹ️    - Diagnosis 3: ''
[04:35:56] ℹ️    - Diagnosis 4: ''
[04:35:56] ℹ️    - Diagnosis 5: ''
[04:35:56] ℹ️    - Diagnosis 6: ''
[04:35:56] ℹ️  Final extracted MRN: 'C0200237608801'
[04:35:56] ℹ️  Final extracted Sex: ''
[04:35:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:35:56] ℹ️  Final extracted Payer Source: ''
[04:35:56] ✅ Patient data extraction completed successfully
[04:35:56] ✅    ✅ Patient data extracted successfully
[04:35:56] 📊 Patient Response
     └─ patientFName: JOHANNES
     └─ patientLName: NAGTEGAAL
     └─ dob: 11/10/1947
     └─ patientSex: 
     └─ medicalRecordNo: C0200237608801
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:35:56] ✅    ✅ Patient identified: JOHANNES NAGTEGAAL
[04:35:56] ✅    ✅ Patient name validation passed
[04:35:56] 🔄 
🔄 Step 3: Processing patient dates...
[04:35:56] [DOC: 9249731] ℹ️  DOB normalized: 11/10/1947
[04:35:56] [DOC: 9249731] ✅ Patient date processing completed successfully
[04:35:56] ✅    ✅ Date processing completed
[04:35:56] 📊 Processed Patient Data
     └─ patientFName: JOHANNES
     └─ patientLName: NAGTEGAAL
     └─ dob: 11/10/1947
     └─ patientSex: 
     └─ medicalRecordNo: C0200237608801
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:35:56] 🔄 
🔄 Step 4: Extracting order data...
[04:35:59] ℹ️  Order extraction - MRN: 'C0200237608801'
[04:35:59] ℹ️  Order extraction - Sex: ''
[04:35:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:35:59] ℹ️  Order extraction - Payer Source: ''
[04:35:59] ✅ Order data extraction completed successfully
[04:35:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:35:59] ℹ️  Using MRN from patient data: 'C0200237608801' over 'C0200237608801'
[04:35:59] ⚠️  Could not determine sex using any available method
[04:35:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:35:59] ✅ Patient name cross-validation successful
[04:35:59] ✅    ✅ Data merged successfully
[04:36:00] ✅    ✅ Order data extracted and validated
[04:36:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:36:14] [DOC: 9249731] ℹ️  Patient not found in cache or API: JOHANNES NAGTEGAAL
[04:36:14] [DOC: 9249731] ℹ️  Patient not found, creating new patient via API...
[04:36:14] [DOC: 9249731] ℹ️  Creating patient via API: JOHANNES NAGTEGAAL
[04:36:15] [DOC: 9249731] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:36:15] ❌    ❌ Failed to create patient
[04:36:15] [DOC: 9249731] ℹ️  API push details saved for document 9249731
================================================================================
║                        Processing Document ID: 9249623                         ║
================================================================================
[04:36:15] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[04:36:15] ℹ️  Date: 04/18/2025
[04:36:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:36:20] [DOC: 9249623] ✅ Text extracted using pdfplumber (1740 chars)
[04:36:20] ✅    ✅ Text extracted using pdfplumber (1728 chars)
[04:36:20] 🔄 
🔄 Step 2: Extracting patient data...
[04:36:23] ℹ️  AI extracted raw sex value: ''
[04:36:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:36:23] ℹ️  AI extracted payer source: 'Medicare'
[04:36:23] ℹ️  AI extracted diagnoses:
[04:36:23] ℹ️    - Diagnosis 1: 'None'
[04:36:23] ℹ️    - Diagnosis 2: 'None'
[04:36:23] ℹ️    - Diagnosis 3: 'None'
[04:36:23] ℹ️    - Diagnosis 4: 'None'
[04:36:23] ℹ️    - Diagnosis 5: 'None'
[04:36:23] ℹ️    - Diagnosis 6: 'None'
[04:36:23] ℹ️  Final extracted MRN: '28700211667001'
[04:36:23] ℹ️  Final extracted Sex: ''
[04:36:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:36:23] ℹ️  Final extracted Payer Source: 'Medicare'
[04:36:23] ✅ Patient data extraction completed successfully
[04:36:23] ✅    ✅ Patient data extracted successfully
[04:36:23] 📊 Patient Response
     └─ patientFName: HOLLY
     └─ patientLName: VOGEL
     └─ dob: 09/09/1947
     └─ patientSex: 
     └─ medicalRecordNo: 28700211667001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:36:23] ✅    ✅ Patient identified: HOLLY VOGEL
[04:36:23] ✅    ✅ Patient name validation passed
[04:36:23] 🔄 
🔄 Step 3: Processing patient dates...
[04:36:23] [DOC: 9249623] ℹ️  DOB normalized: 09/09/1947
[04:36:23] [DOC: 9249623] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[04:36:23] [DOC: 9249623] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[04:36:23] [DOC: 9249623] ✅ Patient date processing completed successfully
[04:36:23] ✅    ✅ Date processing completed
[04:36:23] 📊 Processed Patient Data
     └─ patientFName: HOLLY
     └─ patientLName: VOGEL
     └─ dob: 09/09/1947
     └─ patientSex: 
     └─ medicalRecordNo: 28700211667001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/07/2025'}]
[04:36:23] 🔄 
🔄 Step 4: Extracting order data...
[04:36:26] ℹ️  Order extraction - MRN: '28700211667001'
[04:36:26] ℹ️  Order extraction - Sex: ''
[04:36:26] ℹ️  Order extraction - Service Line: 'RN'
[04:36:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:36:26] ✅ Order data extraction completed successfully
[04:36:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:36:26] ℹ️  Using MRN from patient data: '28700211667001' over '28700211667001'
[04:36:26] ⚠️  Could not determine sex using any available method
[04:36:26] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[04:36:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:36:26] ✅ Patient name cross-validation successful
[04:36:26] ✅    ✅ Data merged successfully
[04:36:28] ✅    ✅ Order data extracted and validated
[04:36:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:36:28] [DOC: 9249623] ✅ Patient found in local cache: HOLLY VOGEL, ID: e7fe7813-a7d0-4ab7-92ff-e32304f75064
[04:36:28] ✅    ✅ Existing patient found with ID: e7fe7813-a7d0-4ab7-92ff-e32304f75064
[04:36:28] 🔄 
🔄 Step 6: Pushing order to API...
[04:36:28] [DOC: 9249623] ℹ️  Pushing order via API for patient ID: e7fe7813-a7d0-4ab7-92ff-e32304f75064
[04:36:29] [DOC: 9249623] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14261"}
[04:36:29] ❌    ❌ Failed to push order
[04:36:29] 🔄 
🔄 Step 7: Writing to CSV...
[04:36:29] [DOC: 9249623] ℹ️  Calculated age: 77 from DOB: 09/09/1947
[04:36:29] [DOC: 9249623] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[04:36:29] [DOC: 9249623] ℹ️  Payer Source extracted: 'Medicare'
[04:36:29] [DOC: 9249623] ℹ️  Diagnosis codes being written:
[04:36:29] [DOC: 9249623] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:36:29] [DOC: 9249623] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:36:29] [DOC: 9249623] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:36:29] [DOC: 9249623] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:36:29] [DOC: 9249623] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:36:29] [DOC: 9249623] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:36:29] [DOC: 9249623] ✅ Patient data written to CSV: HOLLY VOGEL | Sex:  | Age: 77 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 28700211667001
[04:36:29] ✅    ✅ Document 9249623 processed and saved successfully
[04:36:29] 🔄 
🔄 Step 8: Saving API details...
[04:36:29] [DOC: 9249623] ℹ️  API push details saved for document 9249623
[04:36:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249622                         ║
================================================================================
[04:36:29] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[04:36:29] ℹ️  Date: 04/18/2025
[04:36:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:36:32] [DOC: 9249622] ✅ Text extracted using pdfplumber (1994 chars)
[04:36:32] ✅    ✅ Text extracted using pdfplumber (1994 chars)
[04:36:32] 🔄 
🔄 Step 2: Extracting patient data...
[04:36:35] ℹ️  AI extracted raw sex value: ''
[04:36:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:36:35] ℹ️  AI extracted payer source: 'Medicare'
[04:36:35] ℹ️  AI extracted diagnoses:
[04:36:35] ℹ️    - Diagnosis 1: 'None'
[04:36:35] ℹ️    - Diagnosis 2: 'None'
[04:36:35] ℹ️    - Diagnosis 3: 'None'
[04:36:35] ℹ️    - Diagnosis 4: 'None'
[04:36:35] ℹ️    - Diagnosis 5: 'None'
[04:36:35] ℹ️    - Diagnosis 6: 'None'
[04:36:35] ℹ️  Final extracted MRN: '28700209267201'
[04:36:35] ℹ️  Final extracted Sex: ''
[04:36:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:36:35] ℹ️  Final extracted Payer Source: 'Medicare'
[04:36:35] ✅ Patient data extraction completed successfully
[04:36:35] ✅    ✅ Patient data extracted successfully
[04:36:35] 📊 Patient Response
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:36:35] ✅    ✅ Patient identified: ROGER VARIEUR
[04:36:35] ✅    ✅ Patient name validation passed
[04:36:35] 🔄 
🔄 Step 3: Processing patient dates...
[04:36:35] [DOC: 9249622] ℹ️  DOB normalized: 05/12/1938
[04:36:35] [DOC: 9249622] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[04:36:35] [DOC: 9249622] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[04:36:35] [DOC: 9249622] ✅ Patient date processing completed successfully
[04:36:35] ✅    ✅ Date processing completed
[04:36:35] 📊 Processed Patient Data
     └─ patientFName: ROGER
     └─ patientLName: VARIEUR
     └─ dob: 05/12/1938
     └─ patientSex: 
     └─ medicalRecordNo: 28700209267201
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/13/2025'}]
[04:36:35] 🔄 
🔄 Step 4: Extracting order data...
[04:36:37] ℹ️  Order extraction - MRN: '28700209267201'
[04:36:37] ℹ️  Order extraction - Sex: ''
[04:36:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:36:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:36:37] ✅ Order data extraction completed successfully
[04:36:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:36:37] ℹ️  Using MRN from patient data: '28700209267201' over '28700209267201'
[04:36:37] ⚠️  Could not determine sex using any available method
[04:36:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:36:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:36:37] ✅ Patient name cross-validation successful
[04:36:37] ✅    ✅ Data merged successfully
[04:36:38] ✅    ✅ Order data extracted and validated
[04:36:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:36:44] [DOC: 9249622] ℹ️  Patient not found in cache or API: ROGER VARIEUR
[04:36:44] [DOC: 9249622] ℹ️  Patient not found, creating new patient via API...
[04:36:44] [DOC: 9249622] ℹ️  Creating patient via API: ROGER VARIEUR
[04:36:45] [DOC: 9249622] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:36:45] ❌    ❌ Failed to create patient
[04:36:45] [DOC: 9249622] ℹ️  API push details saved for document 9249622
================================================================================
║                        Processing Document ID: 9249424                         ║
================================================================================
[04:36:45] ℹ️  Agency: Compassionate Care Hospice-Taunton
[04:36:45] ℹ️  Date: 04/18/2025
[04:36:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:36:48] [DOC: 9249424] ✅ Text extracted using pdfplumber (1499 chars)
[04:36:48] ✅    ✅ Text extracted using pdfplumber (1487 chars)
[04:36:48] 🔄 
🔄 Step 2: Extracting patient data...
[04:36:50] ℹ️  AI extracted raw sex value: ''
[04:36:50] ℹ️  AI extracted service line: 'Hospice'
[04:36:50] ℹ️  AI extracted payer source: 'Medicare'
[04:36:50] ℹ️  AI extracted diagnoses:
[04:36:50] ℹ️    - Diagnosis 1: ''
[04:36:50] ℹ️    - Diagnosis 2: ''
[04:36:50] ℹ️    - Diagnosis 3: ''
[04:36:50] ℹ️    - Diagnosis 4: ''
[04:36:50] ℹ️    - Diagnosis 5: ''
[04:36:50] ℹ️    - Diagnosis 6: ''
[04:36:50] ℹ️  Final extracted MRN: 'B3700255994202'
[04:36:50] ℹ️  Final extracted Sex: ''
[04:36:50] ℹ️  Final extracted Service Line: 'Hospice'
[04:36:50] ℹ️  Final extracted Payer Source: 'Medicare'
[04:36:50] ✅ Patient data extraction completed successfully
[04:36:50] ✅    ✅ Patient data extracted successfully
[04:36:50] 📊 Patient Response
     └─ patientFName: PATRICIA
     └─ patientLName: SWANSON
     └─ dob: 09/16/1940
     └─ patientSex: 
     └─ medicalRecordNo: B3700255994202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:36:50] ✅    ✅ Patient identified: PATRICIA SWANSON
[04:36:50] ✅    ✅ Patient name validation passed
[04:36:50] 🔄 
🔄 Step 3: Processing patient dates...
[04:36:50] [DOC: 9249424] ℹ️  DOB normalized: 09/16/1940
[04:36:50] [DOC: 9249424] ✅ Patient date processing completed successfully
[04:36:50] ✅    ✅ Date processing completed
[04:36:50] 📊 Processed Patient Data
     └─ patientFName: PATRICIA
     └─ patientLName: SWANSON
     └─ dob: 09/16/1940
     └─ patientSex: 
     └─ medicalRecordNo: B3700255994202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:36:50] 🔄 
🔄 Step 4: Extracting order data...
[04:36:53] ℹ️  Order extraction - MRN: 'B3700255994202'
[04:36:53] ℹ️  Order extraction - Sex: ''
[04:36:53] ℹ️  Order extraction - Service Line: 'Hospice'
[04:36:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:36:53] ✅ Order data extraction completed successfully
[04:36:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:36:53] ℹ️  Using MRN from patient data: 'B3700255994202' over 'B3700255994202'
[04:36:53] ℹ️  Inferred sex as FEMALE from name: PATRICIA
[04:36:53] ℹ️  Service line consistent in both sources: 'Hospice'
[04:36:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:36:53] ✅ Patient name cross-validation successful
[04:36:53] ✅    ✅ Data merged successfully
[04:36:55] ✅    ✅ Order data extracted and validated
[04:36:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:37:24] [DOC: 9249424] ℹ️  Patient not found in cache or API: PATRICIA SWANSON
[04:37:24] [DOC: 9249424] ℹ️  Patient not found, creating new patient via API...
[04:37:24] [DOC: 9249424] ℹ️  Creating patient via API: PATRICIA SWANSON
[04:37:26] [DOC: 9249424] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:37:26] ❌    ❌ Failed to create patient
[04:37:26] [DOC: 9249424] ℹ️  API push details saved for document 9249424
================================================================================
║                        Processing Document ID: 9249290                         ║
================================================================================
[04:37:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:37:26] ℹ️  Date: 04/18/2025
[04:37:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:37:27] [DOC: 9249290] ✅ Text extracted using pdfplumber (1236 chars)
[04:37:27] ✅    ✅ Text extracted using pdfplumber (1236 chars)
[04:37:27] 🔄 
🔄 Step 2: Extracting patient data...
[04:37:30] ℹ️  AI extracted raw sex value: 'F'
[04:37:30] ℹ️  AI extracted service line: 'RN'
[04:37:30] ℹ️  AI extracted payer source: ''
[04:37:30] ℹ️  AI extracted diagnoses:
[04:37:30] ℹ️    - Diagnosis 1: ''
[04:37:30] ℹ️    - Diagnosis 2: ''
[04:37:30] ℹ️    - Diagnosis 3: ''
[04:37:30] ℹ️    - Diagnosis 4: ''
[04:37:30] ℹ️    - Diagnosis 5: ''
[04:37:30] ℹ️    - Diagnosis 6: ''
[04:37:30] ℹ️  Final extracted MRN: '3071654'
[04:37:30] ℹ️  Final extracted Sex: 'FEMALE'
[04:37:30] ℹ️  Final extracted Service Line: 'RN'
[04:37:30] ℹ️  Final extracted Payer Source: ''
[04:37:30] ✅ Patient data extraction completed successfully
[04:37:30] ✅    ✅ Patient data extracted successfully
[04:37:30] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:37:30] ✅    ✅ Patient identified: Tina Viera
[04:37:30] ✅    ✅ Patient name validation passed
[04:37:30] 🔄 
🔄 Step 3: Processing patient dates...
[04:37:30] [DOC: 9249290] ℹ️  DOB normalized: 08/17/1964
[04:37:30] [DOC: 9249290] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[04:37:30] [DOC: 9249290] ✅ Patient date processing completed successfully
[04:37:30] ✅    ✅ Date processing completed
[04:37:30] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:37:30] 🔄 
🔄 Step 4: Extracting order data...
[04:37:32] ℹ️  Order extraction - MRN: '3071654'
[04:37:32] ℹ️  Order extraction - Sex: 'FEMALE'
[04:37:32] ℹ️  Order extraction - Service Line: 'SN'
[04:37:32] ℹ️  Order extraction - Payer Source: ''
[04:37:32] ✅ Order data extraction completed successfully
[04:37:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:37:32] ℹ️  Using MRN from patient data: '3071654' over '3071654'
[04:37:32] ℹ️  Combined service lines: Patient='RN' + Order='SN' = 'RN, SN'
[04:37:32] ✅ Patient name cross-validation successful
[04:37:32] ✅    ✅ Data merged successfully
[04:37:33] ✅    ✅ Order data extracted and validated
[04:37:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:37:51] [DOC: 9249290] ℹ️  Patient not found in cache or API: Tina Viera
[04:37:51] [DOC: 9249290] ℹ️  Patient not found, creating new patient via API...
[04:37:51] [DOC: 9249290] ℹ️  Creating patient via API: Tina Viera
[04:37:52] [DOC: 9249290] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:37:52] ❌    ❌ Failed to create patient
[04:37:52] [DOC: 9249290] ℹ️  API push details saved for document 9249290
================================================================================
║                        Processing Document ID: 9249288                         ║
================================================================================
[04:37:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:37:52] ℹ️  Date: 04/18/2025
[04:37:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:37:53] [DOC: 9249288] ✅ Text extracted using pdfplumber (1317 chars)
[04:37:53] ✅    ✅ Text extracted using pdfplumber (1317 chars)
[04:37:53] 🔄 
🔄 Step 2: Extracting patient data...
[04:37:56] ℹ️  AI extracted raw sex value: 'F'
[04:37:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:37:56] ℹ️  AI extracted payer source: ''
[04:37:56] ℹ️  AI extracted diagnoses:
[04:37:56] ℹ️    - Diagnosis 1: 'None'
[04:37:56] ℹ️    - Diagnosis 2: 'None'
[04:37:56] ℹ️    - Diagnosis 3: 'None'
[04:37:56] ℹ️    - Diagnosis 4: 'None'
[04:37:56] ℹ️    - Diagnosis 5: 'None'
[04:37:56] ℹ️    - Diagnosis 6: 'None'
[04:37:56] ℹ️  Final extracted MRN: '3052261'
[04:37:56] ℹ️  Final extracted Sex: 'FEMALE'
[04:37:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:37:56] ℹ️  Final extracted Payer Source: ''
[04:37:56] ✅ Patient data extraction completed successfully
[04:37:56] ✅    ✅ Patient data extracted successfully
[04:37:56] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:37:56] ✅    ✅ Patient identified: Donna Trott
[04:37:56] ✅    ✅ Patient name validation passed
[04:37:56] 🔄 
🔄 Step 3: Processing patient dates...
[04:37:56] [DOC: 9249288] ℹ️  DOB normalized: 04/22/1943
[04:37:56] [DOC: 9249288] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[04:37:56] [DOC: 9249288] ✅ Patient date processing completed successfully
[04:37:56] ✅    ✅ Date processing completed
[04:37:56] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025'}]
[04:37:56] 🔄 
🔄 Step 4: Extracting order data...
[04:37:58] ℹ️  Order extraction - MRN: '3052261'
[04:37:58] ℹ️  Order extraction - Sex: 'FEMALE'
[04:37:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:37:58] ℹ️  Order extraction - Payer Source: ''
[04:37:58] ✅ Order data extraction completed successfully
[04:37:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:37:58] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[04:37:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:37:58] ✅ Patient name cross-validation successful
[04:37:58] ✅    ✅ Data merged successfully
[04:38:01] ✅    ✅ Order data extracted and validated
[04:38:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:38:01] [DOC: 9249288] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[04:38:01] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[04:38:01] 🔄 
🔄 Step 6: Pushing order to API...
[04:38:01] [DOC: 9249288] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[04:38:03] [DOC: 9249288] ❌ Order push failed with status 201: {"id":"31d25718-2ae3-409e-8214-f76ab3be4726","orderWAVId":"ORD20016","orderNo":"1082909","orderDate":"04/08/2025","startOfCare":"04/08/2025","episodeStartDate":"04/08/2025","episodeEndDate":"06/06/2025","documentID":"9249288","mrn":"3052261","patientName":"Trott,Donna L","sentToPhysicianDate":"04/18/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/22/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"35c8b502-60ae-4cbb-b57d-d65de599a3da","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:38:03] ❌    ❌ Failed to push order
[04:38:03] 🔄 
🔄 Step 7: Writing to CSV...
[04:38:03] [DOC: 9249288] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[04:38:03] [DOC: 9249288] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:38:03] [DOC: 9249288] ℹ️  Payer Source extracted: ''
[04:38:03] [DOC: 9249288] ℹ️  Diagnosis codes being written:
[04:38:03] [DOC: 9249288] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:38:03] [DOC: 9249288] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:38:03] [DOC: 9249288] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:38:03] [DOC: 9249288] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:38:03] [DOC: 9249288] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:38:03] [DOC: 9249288] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:38:03] [DOC: 9249288] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 3052261
[04:38:03] ✅    ✅ Document 9249288 processed and saved successfully
[04:38:03] 🔄 
🔄 Step 8: Saving API details...
[04:38:03] [DOC: 9249288] ℹ️  API push details saved for document 9249288
[04:38:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249285                         ║
================================================================================
[04:38:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:38:03] ℹ️  Date: 04/18/2025
[04:38:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:38:05] [DOC: 9249285] ✅ Text extracted using pdfplumber (1118 chars)
[04:38:05] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[04:38:05] 🔄 
🔄 Step 2: Extracting patient data...
[04:38:07] ℹ️  AI extracted raw sex value: 'F'
[04:38:07] ℹ️  AI extracted service line: 'Nursing'
[04:38:07] ℹ️  AI extracted payer source: ''
[04:38:07] ℹ️  AI extracted diagnoses:
[04:38:07] ℹ️    - Diagnosis 1: 'None'
[04:38:07] ℹ️    - Diagnosis 2: 'None'
[04:38:07] ℹ️    - Diagnosis 3: 'None'
[04:38:07] ℹ️    - Diagnosis 4: 'None'
[04:38:07] ℹ️    - Diagnosis 5: 'None'
[04:38:07] ℹ️    - Diagnosis 6: 'None'
[04:38:07] ℹ️  Final extracted MRN: '3028554'
[04:38:07] ℹ️  Final extracted Sex: 'FEMALE'
[04:38:07] ℹ️  Final extracted Service Line: 'Nursing'
[04:38:07] ℹ️  Final extracted Payer Source: ''
[04:38:07] ✅ Patient data extraction completed successfully
[04:38:07] ✅    ✅ Patient data extracted successfully
[04:38:07] 📊 Patient Response
     └─ patientFName: Ligia
     └─ patientLName: Tavares
     └─ dob: 06/07/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3028554
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:38:07] ✅    ✅ Patient identified: Ligia Tavares
[04:38:07] ✅    ✅ Patient name validation passed
[04:38:07] 🔄 
🔄 Step 3: Processing patient dates...
[04:38:07] [DOC: 9249285] ℹ️  DOB normalized: 06/07/1935
[04:38:07] [DOC: 9249285] ✅ Patient date processing completed successfully
[04:38:07] ✅    ✅ Date processing completed
[04:38:07] 📊 Processed Patient Data
     └─ patientFName: Ligia
     └─ patientLName: Tavares
     └─ dob: 06/07/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3028554
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:38:07] 🔄 
🔄 Step 4: Extracting order data...
[04:38:10] ℹ️  Order extraction - MRN: '3028554'
[04:38:10] ℹ️  Order extraction - Sex: 'FEMALE'
[04:38:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:38:10] ℹ️  Order extraction - Payer Source: ''
[04:38:10] ✅ Order data extraction completed successfully
[04:38:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:38:10] ℹ️  Using MRN from patient data: '3028554' over '3028554'
[04:38:10] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[04:38:10] ✅ Patient name cross-validation successful
[04:38:10] ✅    ✅ Data merged successfully
[04:38:11] ⚠️     ❌ Skipping - missing episode start date
[04:38:11] [DOC: 9249285] ℹ️  API push details saved for document 9249285
================================================================================
║                        Processing Document ID: 9249281                         ║
================================================================================
[04:38:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:38:11] ℹ️  Date: 04/18/2025
[04:38:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:38:16] [DOC: 9249281] ✅ Text extracted using pdfplumber (14193 chars)
[04:38:16] ✅    ✅ Text extracted using pdfplumber (14183 chars)
[04:38:16] 🔄 
🔄 Step 2: Extracting patient data...
[04:38:19] ℹ️  AI extracted raw sex value: 'M'
[04:38:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:38:19] ℹ️  AI extracted payer source: ''
[04:38:19] ℹ️  AI extracted diagnoses:
[04:38:19] ℹ️    - Diagnosis 1: 'N13.30'
[04:38:19] ℹ️    - Diagnosis 2: 'C61'
[04:38:19] ℹ️    - Diagnosis 3: 'N17.9'
[04:38:19] ℹ️    - Diagnosis 4: 'D12.6'
[04:38:19] ℹ️    - Diagnosis 5: 'K76.89'
[04:38:19] ℹ️    - Diagnosis 6: 'R59.0'
[04:38:19] ℹ️  Final extracted MRN: '2958745'
[04:38:19] ℹ️  Final extracted Sex: 'MALE'
[04:38:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:38:19] ℹ️  Final extracted Payer Source: ''
[04:38:19] ✅ Patient data extraction completed successfully
[04:38:19] ✅    ✅ Patient data extracted successfully
[04:38:19] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Servais
     └─ dob: 01/21/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 2958745
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N13.30', 'secondDiagnosis': 'C61', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'D12.6', 'fifthDiagnosis': 'K76.89', 'sixthDiagnosis': 'R59.0'}]
[04:38:19] ✅    ✅ Patient identified: Jean Servais
[04:38:19] ✅    ✅ Patient name validation passed
[04:38:19] 🔄 
🔄 Step 3: Processing patient dates...
[04:38:19] [DOC: 9249281] ℹ️  DOB normalized: 01/21/1953
[04:38:19] [DOC: 9249281] ℹ️  Episode startOfCare normalized: 04/07/2025
[04:38:19] [DOC: 9249281] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[04:38:19] [DOC: 9249281] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[04:38:19] [DOC: 9249281] ✅ Patient date processing completed successfully
[04:38:19] ✅    ✅ Date processing completed
[04:38:19] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Servais
     └─ dob: 01/21/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 2958745
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N13.30', 'secondDiagnosis': 'C61', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'D12.6', 'fifthDiagnosis': 'K76.89', 'sixthDiagnosis': 'R59.0'}]
[04:38:19] 🔄 
🔄 Step 4: Extracting order data...
[04:38:22] ℹ️  Order extraction - MRN: '2958745'
[04:38:22] ℹ️  Order extraction - Sex: 'MALE'
[04:38:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:38:22] ℹ️  Order extraction - Payer Source: ''
[04:38:22] ✅ Order data extraction completed successfully
[04:38:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:38:22] ℹ️  Using MRN from patient data: '2958745' over '2958745'
[04:38:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:38:22] ✅ Patient name cross-validation successful
[04:38:22] ✅    ✅ Data merged successfully
[04:38:23] ✅    ✅ Order data extracted and validated
[04:38:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:39:10] [DOC: 9249281] ℹ️  Patient not found in cache or API: Jean Servais
[04:39:10] [DOC: 9249281] ℹ️  Patient not found, creating new patient via API...
[04:39:10] [DOC: 9249281] ℹ️  Creating patient via API: Jean Servais
[04:39:11] [DOC: 9249281] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:39:11] ❌    ❌ Failed to create patient
[04:39:11] [DOC: 9249281] ℹ️  API push details saved for document 9249281
================================================================================
║                        Processing Document ID: 9249277                         ║
================================================================================
[04:39:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:39:11] ℹ️  Date: 04/18/2025
[04:39:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:39:18] [DOC: 9249277] ✅ Text extracted using pdfplumber (1916 chars)
[04:39:18] ✅    ✅ Text extracted using pdfplumber (1916 chars)
[04:39:18] 🔄 
🔄 Step 2: Extracting patient data...
[04:39:20] ℹ️  AI extracted raw sex value: 'F'
[04:39:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:39:20] ℹ️  AI extracted payer source: ''
[04:39:20] ℹ️  AI extracted diagnoses:
[04:39:20] ℹ️    - Diagnosis 1: 'None'
[04:39:20] ℹ️    - Diagnosis 2: 'None'
[04:39:20] ℹ️    - Diagnosis 3: 'None'
[04:39:20] ℹ️    - Diagnosis 4: 'None'
[04:39:20] ℹ️    - Diagnosis 5: 'None'
[04:39:20] ℹ️    - Diagnosis 6: 'None'
[04:39:20] ℹ️  Final extracted MRN: '2936720'
[04:39:20] ℹ️  Final extracted Sex: 'FEMALE'
[04:39:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:39:20] ℹ️  Final extracted Payer Source: ''
[04:39:20] ✅ Patient data extraction completed successfully
[04:39:20] ✅    ✅ Patient data extracted successfully
[04:39:20] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:39:20] ✅    ✅ Patient identified: Stella Saint
[04:39:20] ✅    ✅ Patient name validation passed
[04:39:20] 🔄 
🔄 Step 3: Processing patient dates...
[04:39:20] [DOC: 9249277] ℹ️  DOB normalized: 07/02/1928
[04:39:20] [DOC: 9249277] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[04:39:20] [DOC: 9249277] ✅ Patient date processing completed successfully
[04:39:20] ✅    ✅ Date processing completed
[04:39:20] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025'}]
[04:39:20] 🔄 
🔄 Step 4: Extracting order data...
[04:39:23] ℹ️  Order extraction - MRN: '2936720'
[04:39:23] ℹ️  Order extraction - Sex: 'FEMALE'
[04:39:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:39:23] ℹ️  Order extraction - Payer Source: ''
[04:39:23] ✅ Order data extraction completed successfully
[04:39:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:39:23] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[04:39:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:39:23] ✅ Patient name cross-validation successful
[04:39:23] ✅    ✅ Data merged successfully
[04:39:24] ✅    ✅ Order data extracted and validated
[04:39:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:39:24] [DOC: 9249277] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[04:39:24] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[04:39:24] 🔄 
🔄 Step 6: Pushing order to API...
[04:39:24] [DOC: 9249277] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[04:39:26] [DOC: 9249277] ❌ Order push failed with status 201: {"id":"fda0b75a-c0ec-452c-9a3f-8ce81aeff7f9","orderWAVId":"ORD20017","orderNo":"1083183, 1083184","orderDate":"03/31/2025","startOfCare":"03/31/2025","episodeStartDate":"03/31/2025","episodeEndDate":"05/29/2025","documentID":"9249277","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"04/18/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:39:26] ❌    ❌ Failed to push order
[04:39:26] 🔄 
🔄 Step 7: Writing to CSV...
[04:39:26] [DOC: 9249277] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[04:39:26] [DOC: 9249277] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:39:26] [DOC: 9249277] ℹ️  Payer Source extracted: ''
[04:39:26] [DOC: 9249277] ℹ️  Diagnosis codes being written:
[04:39:26] [DOC: 9249277] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:39:26] [DOC: 9249277] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:39:26] [DOC: 9249277] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:39:26] [DOC: 9249277] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:39:26] [DOC: 9249277] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:39:26] [DOC: 9249277] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:39:26] [DOC: 9249277] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Skilled Nursing | Payer:  | MRN: 2936720
[04:39:26] ✅    ✅ Document 9249277 processed and saved successfully
[04:39:26] 🔄 
🔄 Step 8: Saving API details...
[04:39:26] [DOC: 9249277] ℹ️  API push details saved for document 9249277
[04:39:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249275                         ║
================================================================================
[04:39:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:39:26] ℹ️  Date: 04/18/2025
[04:39:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:39:27] [DOC: 9249275] ✅ Text extracted using pdfplumber (1328 chars)
[04:39:27] ✅    ✅ Text extracted using pdfplumber (1328 chars)
[04:39:27] 🔄 
🔄 Step 2: Extracting patient data...
[04:39:30] ℹ️  AI extracted raw sex value: 'M'
[04:39:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:39:30] ℹ️  AI extracted payer source: ''
[04:39:30] ℹ️  AI extracted diagnoses:
[04:39:30] ℹ️    - Diagnosis 1: ''
[04:39:30] ℹ️    - Diagnosis 2: ''
[04:39:30] ℹ️    - Diagnosis 3: ''
[04:39:30] ℹ️    - Diagnosis 4: ''
[04:39:30] ℹ️    - Diagnosis 5: ''
[04:39:30] ℹ️    - Diagnosis 6: ''
[04:39:30] ℹ️  Final extracted MRN: '2858411'
[04:39:30] ℹ️  Final extracted Sex: 'MALE'
[04:39:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:39:30] ℹ️  Final extracted Payer Source: ''
[04:39:30] ✅ Patient data extraction completed successfully
[04:39:30] ✅    ✅ Patient data extracted successfully
[04:39:30] 📊 Patient Response
     └─ patientFName: Alcides
     └─ patientLName: Pires
     └─ dob: 09/11/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 2858411
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:39:30] ✅    ✅ Patient identified: Alcides Pires
[04:39:30] ✅    ✅ Patient name validation passed
[04:39:30] 🔄 
🔄 Step 3: Processing patient dates...
[04:39:30] [DOC: 9249275] ℹ️  DOB normalized: 09/11/1966
[04:39:30] [DOC: 9249275] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[04:39:30] [DOC: 9249275] ✅ Patient date processing completed successfully
[04:39:30] ✅    ✅ Date processing completed
[04:39:30] 📊 Processed Patient Data
     └─ patientFName: Alcides
     └─ patientLName: Pires
     └─ dob: 09/11/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 2858411
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:39:30] 🔄 
🔄 Step 4: Extracting order data...
[04:39:32] ℹ️  Order extraction - MRN: '2858411'
[04:39:32] ℹ️  Order extraction - Sex: 'MALE'
[04:39:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:39:32] ℹ️  Order extraction - Payer Source: ''
[04:39:32] ✅ Order data extraction completed successfully
[04:39:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:39:32] ℹ️  Using MRN from patient data: '2858411' over '2858411'
[04:39:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:39:32] ✅ Patient name cross-validation successful
[04:39:32] ✅    ✅ Data merged successfully
[04:39:34] ✅    ✅ Order data extracted and validated
[04:39:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:39:53] [DOC: 9249275] ℹ️  Patient not found in cache or API: Alcides Pires
[04:39:53] [DOC: 9249275] ℹ️  Patient not found, creating new patient via API...
[04:39:53] [DOC: 9249275] ℹ️  Creating patient via API: Alcides Pires
[04:39:54] [DOC: 9249275] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:39:54] ❌    ❌ Failed to create patient
[04:39:54] [DOC: 9249275] ℹ️  API push details saved for document 9249275
================================================================================
║                        Processing Document ID: 9249272                         ║
================================================================================
[04:39:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:39:54] ℹ️  Date: 04/18/2025
[04:39:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:39:56] [DOC: 9249272] ✅ Text extracted using pdfplumber (1105 chars)
[04:39:56] ✅    ✅ Text extracted using pdfplumber (1105 chars)
[04:39:56] 🔄 
🔄 Step 2: Extracting patient data...
[04:39:58] ℹ️  AI extracted raw sex value: 'F'
[04:39:58] ℹ️  AI extracted service line: 'PT'
[04:39:58] ℹ️  AI extracted payer source: ''
[04:39:58] ℹ️  AI extracted diagnoses:
[04:39:58] ℹ️    - Diagnosis 1: 'None'
[04:39:58] ℹ️    - Diagnosis 2: 'None'
[04:39:58] ℹ️    - Diagnosis 3: 'None'
[04:39:58] ℹ️    - Diagnosis 4: 'None'
[04:39:58] ℹ️    - Diagnosis 5: 'None'
[04:39:58] ℹ️    - Diagnosis 6: 'None'
[04:39:58] ℹ️  Final extracted MRN: '2794259'
[04:39:58] ℹ️  Final extracted Sex: 'FEMALE'
[04:39:58] ℹ️  Final extracted Service Line: 'PT'
[04:39:58] ℹ️  Final extracted Payer Source: ''
[04:39:58] ✅ Patient data extraction completed successfully
[04:39:58] ✅    ✅ Patient data extracted successfully
[04:39:58] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:39:58] ✅    ✅ Patient identified: Joyce Normandin
[04:39:58] ✅    ✅ Patient name validation passed
[04:39:58] 🔄 
🔄 Step 3: Processing patient dates...
[04:39:58] [DOC: 9249272] ℹ️  DOB normalized: 09/26/1950
[04:39:58] [DOC: 9249272] ✅ Patient date processing completed successfully
[04:39:58] ✅    ✅ Date processing completed
[04:39:58] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:39:58] 🔄 
🔄 Step 4: Extracting order data...
[04:40:00] ℹ️  Order extraction - MRN: '2794259'
[04:40:00] ℹ️  Order extraction - Sex: 'FEMALE'
[04:40:00] ℹ️  Order extraction - Service Line: ''
[04:40:00] ℹ️  Order extraction - Payer Source: ''
[04:40:00] ✅ Order data extraction completed successfully
[04:40:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:40:00] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[04:40:00] ℹ️  Using service line from patient data: 'PT'
[04:40:00] ✅ Patient name cross-validation successful
[04:40:00] ✅    ✅ Data merged successfully
[04:40:02] ⚠️     ❌ Skipping - missing episode start date
[04:40:02] [DOC: 9249272] ℹ️  API push details saved for document 9249272
================================================================================
║                        Processing Document ID: 9249271                         ║
================================================================================
[04:40:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:40:02] ℹ️  Date: 04/18/2025
[04:40:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:40:05] [DOC: 9249271] ✅ Text extracted using pdfplumber (1394 chars)
[04:40:05] ✅    ✅ Text extracted using pdfplumber (1382 chars)
[04:40:05] 🔄 
🔄 Step 2: Extracting patient data...
[04:40:08] ℹ️  AI extracted raw sex value: ''
[04:40:08] ℹ️  AI extracted service line: 'Physical Therapy'
[04:40:08] ℹ️  AI extracted payer source: ''
[04:40:08] ℹ️  AI extracted diagnoses:
[04:40:08] ℹ️    - Diagnosis 1: 'L03.116'
[04:40:08] ℹ️    - Diagnosis 2: 'B96.5'
[04:40:08] ℹ️    - Diagnosis 3: 'E11.51'
[04:40:08] ℹ️    - Diagnosis 4: ''
[04:40:08] ℹ️    - Diagnosis 5: ''
[04:40:08] ℹ️    - Diagnosis 6: ''
[04:40:08] ℹ️  Final extracted MRN: 'MA221025055606'
[04:40:08] ℹ️  Final extracted Sex: ''
[04:40:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[04:40:08] ℹ️  Final extracted Payer Source: ''
[04:40:08] ✅ Patient data extraction completed successfully
[04:40:08] ✅    ✅ Patient data extracted successfully
[04:40:08] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: Ahmet Dirican MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:40:08] ✅    ✅ Patient identified: Donald Santos
[04:40:08] ✅    ✅ Patient name validation passed
[04:40:08] 🔄 
🔄 Step 3: Processing patient dates...
[04:40:08] [DOC: 9249271] ℹ️  DOB normalized: 05/04/1956
[04:40:08] [DOC: 9249271] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[04:40:08] [DOC: 9249271] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[04:40:08] [DOC: 9249271] ✅ Patient date processing completed successfully
[04:40:08] ✅    ✅ Date processing completed
[04:40:08] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: Ahmet Dirican MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:40:08] 🔄 
🔄 Step 4: Extracting order data...
[04:40:10] ℹ️  Order extraction - MRN: 'MA221025055606'
[04:40:10] ℹ️  Order extraction - Sex: ''
[04:40:10] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[04:40:10] ℹ️  Order extraction - Payer Source: ''
[04:40:10] ✅ Order data extraction completed successfully
[04:40:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:40:10] ℹ️  Using MRN from patient data: 'MA221025055606' over 'MA221025055606'
[04:40:10] ℹ️  Inferred sex as MALE from name: Donald
[04:40:10] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[04:40:10] ✅ Patient name cross-validation successful
[04:40:10] ✅    ✅ Data merged successfully
[04:40:12] ✅    ✅ Order data extracted and validated
[04:40:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:40:21] [DOC: 9249271] ✅ Patient exists in API: Donald Santos, ID: 598d9260-7728-4455-8713-61626ca9d576
[04:40:21] ✅    ✅ Existing patient found with ID: 598d9260-7728-4455-8713-61626ca9d576
[04:40:21] 🔄 
🔄 Step 6: Pushing order to API...
[04:40:21] [DOC: 9249271] ℹ️  Pushing order via API for patient ID: 598d9260-7728-4455-8713-61626ca9d576
[04:40:23] [DOC: 9249271] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14372"}
[04:40:23] ❌    ❌ Failed to push order
[04:40:23] 🔄 
🔄 Step 7: Writing to CSV...
[04:40:23] [DOC: 9249271] ℹ️  Calculated age: 69 from DOB: 05/04/1956
[04:40:23] [DOC: 9249271] ℹ️  Service Line extracted: 'Physical Therapy'
[04:40:23] [DOC: 9249271] ℹ️  Payer Source extracted: ''
[04:40:23] [DOC: 9249271] ℹ️  Diagnosis codes being written:
[04:40:23] [DOC: 9249271] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.116'
[04:40:23] [DOC: 9249271] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.5'
[04:40:23] [DOC: 9249271] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.51'
[04:40:23] [DOC: 9249271] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:40:23] [DOC: 9249271] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:40:23] [DOC: 9249271] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:40:23] [DOC: 9249271] ✅ Patient data written to CSV: Donald Santos | Sex: MALE | Age: 69 | Service: Physical Therapy | Payer:  | MRN: MA221025055606
[04:40:23] ✅    ✅ Document 9249271 processed and saved successfully
[04:40:23] 🔄 
🔄 Step 8: Saving API details...
[04:40:23] [DOC: 9249271] ℹ️  API push details saved for document 9249271
[04:40:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249268                         ║
================================================================================
[04:40:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:40:23] ℹ️  Date: 04/18/2025
[04:40:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:40:24] [DOC: 9249268] ✅ Text extracted using pdfplumber (1272 chars)
[04:40:24] ✅    ✅ Text extracted using pdfplumber (1272 chars)
[04:40:24] 🔄 
🔄 Step 2: Extracting patient data...
[04:40:27] ℹ️  AI extracted raw sex value: 'M'
[04:40:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:40:27] ℹ️  AI extracted payer source: ''
[04:40:27] ℹ️  AI extracted diagnoses:
[04:40:27] ℹ️    - Diagnosis 1: ''
[04:40:27] ℹ️    - Diagnosis 2: ''
[04:40:27] ℹ️    - Diagnosis 3: ''
[04:40:27] ℹ️    - Diagnosis 4: ''
[04:40:27] ℹ️    - Diagnosis 5: ''
[04:40:27] ℹ️    - Diagnosis 6: ''
[04:40:27] ℹ️  Final extracted MRN: '2773750'
[04:40:27] ℹ️  Final extracted Sex: 'MALE'
[04:40:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:40:27] ℹ️  Final extracted Payer Source: ''
[04:40:27] ✅ Patient data extraction completed successfully
[04:40:27] ✅    ✅ Patient data extracted successfully
[04:40:27] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:40:27] ✅    ✅ Patient identified: Luis Mota
[04:40:27] ✅    ✅ Patient name validation passed
[04:40:27] 🔄 
🔄 Step 3: Processing patient dates...
[04:40:27] [DOC: 9249268] ℹ️  DOB normalized: 12/02/1942
[04:40:27] [DOC: 9249268] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[04:40:27] [DOC: 9249268] ✅ Patient date processing completed successfully
[04:40:27] ✅    ✅ Date processing completed
[04:40:27] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Mota
     └─ dob: 12/02/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2773750
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:40:27] 🔄 
🔄 Step 4: Extracting order data...
[04:40:29] ℹ️  Order extraction - MRN: '2773750'
[04:40:29] ℹ️  Order extraction - Sex: 'MALE'
[04:40:29] ℹ️  Order extraction - Service Line: 'SN'
[04:40:29] ℹ️  Order extraction - Payer Source: ''
[04:40:29] ✅ Order data extraction completed successfully
[04:40:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:40:29] ℹ️  Using MRN from patient data: '2773750' over '2773750'
[04:40:29] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[04:40:29] ✅ Patient name cross-validation successful
[04:40:29] ✅    ✅ Data merged successfully
[04:40:30] ✅    ✅ Order data extracted and validated
[04:40:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:40:37] [DOC: 9249268] ℹ️  Patient not found in cache or API: Luis Mota
[04:40:37] [DOC: 9249268] ℹ️  Patient not found, creating new patient via API...
[04:40:37] [DOC: 9249268] ℹ️  Creating patient via API: Luis Mota
[04:40:38] [DOC: 9249268] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:40:38] ❌    ❌ Failed to create patient
[04:40:38] [DOC: 9249268] ℹ️  API push details saved for document 9249268
================================================================================
║                        Processing Document ID: 9249267                         ║
================================================================================
[04:40:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:40:38] ℹ️  Date: 04/18/2025
[04:40:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:40:43] [DOC: 9249267] ✅ Text extracted using pdfplumber (14668 chars)
[04:40:43] ✅    ✅ Text extracted using pdfplumber (14668 chars)
[04:40:43] 🔄 
🔄 Step 2: Extracting patient data...
[04:40:46] ℹ️  AI extracted raw sex value: 'M'
[04:40:46] ℹ️  AI extracted service line: 'PT'
[04:40:46] ℹ️  AI extracted payer source: ''
[04:40:46] ℹ️  AI extracted diagnoses:
[04:40:46] ℹ️    - Diagnosis 1: ''
[04:40:46] ℹ️    - Diagnosis 2: ''
[04:40:46] ℹ️    - Diagnosis 3: ''
[04:40:46] ℹ️    - Diagnosis 4: ''
[04:40:46] ℹ️    - Diagnosis 5: ''
[04:40:46] ℹ️    - Diagnosis 6: ''
[04:40:46] ℹ️  Final extracted MRN: 'MA221025055606'
[04:40:46] ℹ️  Final extracted Sex: 'MALE'
[04:40:46] ℹ️  Final extracted Service Line: 'PT'
[04:40:46] ℹ️  Final extracted Payer Source: ''
[04:40:46] ✅ Patient data extraction completed successfully
[04:40:46] ✅    ✅ Patient data extracted successfully
[04:40:46] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: DIAS-REGUS, MARY R. NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:40:46] ✅    ✅ Patient identified: Donald Santos
[04:40:46] ✅    ✅ Patient name validation passed
[04:40:46] 🔄 
🔄 Step 3: Processing patient dates...
[04:40:46] [DOC: 9249267] ℹ️  DOB normalized: 05/04/1956
[04:40:46] [DOC: 9249267] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[04:40:46] [DOC: 9249267] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[04:40:46] [DOC: 9249267] ✅ Patient date processing completed successfully
[04:40:46] ✅    ✅ Date processing completed
[04:40:46] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: DIAS-REGUS, MARY R. NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:40:46] 🔄 
🔄 Step 4: Extracting order data...
[04:40:49] ℹ️  Order extraction - MRN: 'MA221025055606'
[04:40:49] ℹ️  Order extraction - Sex: 'MALE'
[04:40:49] ℹ️  Order extraction - Service Line: 'PT'
[04:40:49] ℹ️  Order extraction - Payer Source: ''
[04:40:49] ✅ Order data extraction completed successfully
[04:40:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:40:49] ℹ️  Using MRN from patient data: 'MA221025055606' over 'MA221025055606'
[04:40:49] ℹ️  Service line consistent in both sources: 'PT'
[04:40:49] ✅ Patient name cross-validation successful
[04:40:49] ✅    ✅ Data merged successfully
[04:40:51] ✅    ✅ Order data extracted and validated
[04:40:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:40:51] [DOC: 9249267] ✅ Patient found in local cache: Donald Santos, ID: 598d9260-7728-4455-8713-61626ca9d576
[04:40:51] ✅    ✅ Existing patient found with ID: 598d9260-7728-4455-8713-61626ca9d576
[04:40:51] 🔄 
🔄 Step 6: Pushing order to API...
[04:40:51] [DOC: 9249267] ℹ️  Pushing order via API for patient ID: 598d9260-7728-4455-8713-61626ca9d576
[04:40:52] [DOC: 9249267] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[04:40:52] ❌    ❌ Failed to push order
[04:40:52] 🔄 
🔄 Step 7: Writing to CSV...
[04:40:52] [DOC: 9249267] ℹ️  Calculated age: 69 from DOB: 05/04/1956
[04:40:52] [DOC: 9249267] ℹ️  Service Line extracted: 'PT'
[04:40:52] [DOC: 9249267] ℹ️  Payer Source extracted: ''
[04:40:52] [DOC: 9249267] ℹ️  Diagnosis codes being written:
[04:40:52] [DOC: 9249267] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:40:52] [DOC: 9249267] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:40:52] [DOC: 9249267] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:40:52] [DOC: 9249267] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:40:52] [DOC: 9249267] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:40:52] [DOC: 9249267] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:40:52] [DOC: 9249267] ✅ Patient data written to CSV: Donald Santos | Sex: MALE | Age: 69 | Service: PT | Payer:  | MRN: MA221025055606
[04:40:52] ✅    ✅ Document 9249267 processed and saved successfully
[04:40:52] 🔄 
🔄 Step 8: Saving API details...
[04:40:52] [DOC: 9249267] ℹ️  API push details saved for document 9249267
[04:40:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249265                         ║
================================================================================
[04:40:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[04:40:52] ℹ️  Date: 04/18/2025
[04:40:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:40:56] [DOC: 9249265] ✅ Text extracted using pdfplumber (3104 chars)
[04:40:56] ✅    ✅ Text extracted using pdfplumber (3092 chars)
[04:40:56] 🔄 
🔄 Step 2: Extracting patient data...
[04:40:59] ℹ️  AI extracted raw sex value: ''
[04:40:59] ℹ️  AI extracted service line: 'Physical Therapy'
[04:40:59] ℹ️  AI extracted payer source: ''
[04:40:59] ℹ️  AI extracted diagnoses:
[04:40:59] ℹ️    - Diagnosis 1: 'L03.116'
[04:40:59] ℹ️    - Diagnosis 2: 'B96.5'
[04:40:59] ℹ️    - Diagnosis 3: 'E11.51'
[04:40:59] ℹ️    - Diagnosis 4: 'None'
[04:40:59] ℹ️    - Diagnosis 5: 'None'
[04:40:59] ℹ️    - Diagnosis 6: 'None'
[04:40:59] ℹ️  Final extracted MRN: 'MA221025055606'
[04:40:59] ℹ️  Final extracted Sex: ''
[04:40:59] ℹ️  Final extracted Service Line: 'Physical Therapy'
[04:40:59] ℹ️  Final extracted Payer Source: ''
[04:40:59] ✅ Patient data extraction completed successfully
[04:40:59] ✅    ✅ Patient data extracted successfully
[04:40:59] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: DIAS-REGUS, MARY R. NP
     └─ npi: 
     └─ physicianNPI: 1396723813
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:40:59] ✅    ✅ Patient identified: Donald Santos
[04:40:59] ✅    ✅ Patient name validation passed
[04:40:59] 🔄 
🔄 Step 3: Processing patient dates...
[04:40:59] [DOC: 9249265] ℹ️  DOB normalized: 05/04/1956
[04:40:59] [DOC: 9249265] ℹ️  Episode startOfEpisode normalized: 02/03/2025
[04:40:59] [DOC: 9249265] ℹ️  Episode endOfEpisode normalized: 04/03/2025
[04:40:59] [DOC: 9249265] ✅ Patient date processing completed successfully
[04:40:59] ✅    ✅ Date processing completed
[04:40:59] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: DIAS-REGUS, MARY R. NP
     └─ npi: 
     └─ physicianNPI: 1396723813
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/03/2025', 'endOfEpisode': '04/03/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51'}]
[04:40:59] 🔄 
🔄 Step 4: Extracting order data...
[04:41:01] ℹ️  Order extraction - MRN: 'MA221025055606'
[04:41:01] ℹ️  Order extraction - Sex: ''
[04:41:01] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[04:41:01] ℹ️  Order extraction - Payer Source: ''
[04:41:01] ✅ Order data extraction completed successfully
[04:41:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:41:01] ℹ️  Using MRN from patient data: 'MA221025055606' over 'MA221025055606'
[04:41:01] ℹ️  Inferred sex as MALE from name: Donald
[04:41:01] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[04:41:01] ✅ Patient name cross-validation successful
[04:41:01] ✅    ✅ Data merged successfully
[04:41:03] ✅    ✅ Order data extracted and validated
[04:41:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:41:03] [DOC: 9249265] ✅ Patient found in local cache: Donald Santos, ID: 598d9260-7728-4455-8713-61626ca9d576
[04:41:03] ✅    ✅ Existing patient found with ID: 598d9260-7728-4455-8713-61626ca9d576
[04:41:03] 🔄 
🔄 Step 6: Pushing order to API...
[04:41:03] [DOC: 9249265] ℹ️  Pushing order via API for patient ID: 598d9260-7728-4455-8713-61626ca9d576
[04:41:04] [DOC: 9249265] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14374"}
[04:41:04] ❌    ❌ Failed to push order
[04:41:04] 🔄 
🔄 Step 7: Writing to CSV...
[04:41:04] [DOC: 9249265] ℹ️  Calculated age: 69 from DOB: 05/04/1956
[04:41:04] [DOC: 9249265] ℹ️  Service Line extracted: 'Physical Therapy'
[04:41:04] [DOC: 9249265] ℹ️  Payer Source extracted: ''
[04:41:04] [DOC: 9249265] ℹ️  Diagnosis codes being written:
[04:41:04] [DOC: 9249265] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.116'
[04:41:04] [DOC: 9249265] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.5'
[04:41:04] [DOC: 9249265] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.51'
[04:41:04] [DOC: 9249265] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:41:04] [DOC: 9249265] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:41:04] [DOC: 9249265] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:41:04] [DOC: 9249265] ✅ Patient data written to CSV: Donald Santos | Sex: MALE | Age: 69 | Service: Physical Therapy | Payer:  | MRN: MA221025055606
[04:41:04] ✅    ✅ Document 9249265 processed and saved successfully
[04:41:04] 🔄 
🔄 Step 8: Saving API details...
[04:41:04] [DOC: 9249265] ℹ️  API push details saved for document 9249265
[04:41:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249235                         ║
================================================================================
[04:41:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:41:04] ℹ️  Date: 04/18/2025
[04:41:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:41:06] [DOC: 9249235] ✅ Text extracted using pdfplumber (1770 chars)
[04:41:06] ✅    ✅ Text extracted using pdfplumber (1770 chars)
[04:41:06] 🔄 
🔄 Step 2: Extracting patient data...
[04:41:08] ℹ️  AI extracted raw sex value: 'M'
[04:41:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:41:08] ℹ️  AI extracted payer source: ''
[04:41:08] ℹ️  AI extracted diagnoses:
[04:41:08] ℹ️    - Diagnosis 1: ''
[04:41:08] ℹ️    - Diagnosis 2: ''
[04:41:08] ℹ️    - Diagnosis 3: ''
[04:41:08] ℹ️    - Diagnosis 4: ''
[04:41:08] ℹ️    - Diagnosis 5: ''
[04:41:08] ℹ️    - Diagnosis 6: ''
[04:41:08] ℹ️  Final extracted MRN: '2145411'
[04:41:08] ℹ️  Final extracted Sex: 'MALE'
[04:41:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:41:08] ℹ️  Final extracted Payer Source: ''
[04:41:08] ✅ Patient data extraction completed successfully
[04:41:08] ✅    ✅ Patient data extracted successfully
[04:41:08] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Mannes
     └─ dob: 05/18/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2145411
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:41:08] ✅    ✅ Patient identified: John Mannes
[04:41:08] ✅    ✅ Patient name validation passed
[04:41:08] 🔄 
🔄 Step 3: Processing patient dates...
[04:41:08] [DOC: 9249235] ℹ️  DOB normalized: 05/18/1946
[04:41:08] [DOC: 9249235] ✅ Patient date processing completed successfully
[04:41:08] ✅    ✅ Date processing completed
[04:41:08] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Mannes
     └─ dob: 05/18/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2145411
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:41:08] 🔄 
🔄 Step 4: Extracting order data...
[04:41:11] ℹ️  Order extraction - MRN: '2145411'
[04:41:11] ℹ️  Order extraction - Sex: 'MALE'
[04:41:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:41:11] ℹ️  Order extraction - Payer Source: ''
[04:41:11] ✅ Order data extraction completed successfully
[04:41:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:41:11] ℹ️  Using MRN from patient data: '2145411' over '2145411'
[04:41:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:41:11] ✅ Patient name cross-validation successful
[04:41:11] ✅    ✅ Data merged successfully
[04:41:12] ⚠️     ❌ Skipping - missing episode start date
[04:41:12] [DOC: 9249235] ℹ️  API push details saved for document 9249235
================================================================================
║                        Processing Document ID: 9249233                         ║
================================================================================
[04:41:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:41:12] ℹ️  Date: 04/18/2025
[04:41:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:41:14] [DOC: 9249233] ✅ Text extracted using pdfplumber (1682 chars)
[04:41:14] ✅    ✅ Text extracted using pdfplumber (1682 chars)
[04:41:14] 🔄 
🔄 Step 2: Extracting patient data...
[04:41:16] ℹ️  AI extracted raw sex value: 'F'
[04:41:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:41:16] ℹ️  AI extracted payer source: ''
[04:41:16] ℹ️  AI extracted diagnoses:
[04:41:16] ℹ️    - Diagnosis 1: 'None'
[04:41:16] ℹ️    - Diagnosis 2: 'None'
[04:41:16] ℹ️    - Diagnosis 3: 'None'
[04:41:16] ℹ️    - Diagnosis 4: 'None'
[04:41:16] ℹ️    - Diagnosis 5: 'None'
[04:41:16] ℹ️    - Diagnosis 6: 'None'
[04:41:16] ℹ️  Final extracted MRN: '2687695'
[04:41:16] ℹ️  Final extracted Sex: 'FEMALE'
[04:41:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:41:16] ℹ️  Final extracted Payer Source: ''
[04:41:16] ✅ Patient data extraction completed successfully
[04:41:16] ✅    ✅ Patient data extracted successfully
[04:41:16] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:41:16] ✅    ✅ Patient identified: Maria Maiato
[04:41:16] ✅    ✅ Patient name validation passed
[04:41:16] 🔄 
🔄 Step 3: Processing patient dates...
[04:41:16] [DOC: 9249233] ℹ️  DOB normalized: 03/29/1952
[04:41:16] [DOC: 9249233] ✅ Patient date processing completed successfully
[04:41:16] ✅    ✅ Date processing completed
[04:41:16] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:41:16] 🔄 
🔄 Step 4: Extracting order data...
[04:41:19] ℹ️  Order extraction - MRN: '2687695'
[04:41:19] ℹ️  Order extraction - Sex: 'FEMALE'
[04:41:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:41:19] ℹ️  Order extraction - Payer Source: ''
[04:41:19] ✅ Order data extraction completed successfully
[04:41:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:41:19] ℹ️  Using MRN from patient data: '2687695' over '2687695'
[04:41:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:41:19] ✅ Patient name cross-validation successful
[04:41:19] ✅    ✅ Data merged successfully
[04:41:20] ✅    ✅ Order data extracted and validated
[04:41:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:41:20] [DOC: 9249233] ✅ Patient found in local cache: Maria Maiato, ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[04:41:20] ✅    ✅ Existing patient found with ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[04:41:20] 🔄 
🔄 Step 6: Pushing order to API...
[04:41:20] [DOC: 9249233] ℹ️  Pushing order via API for patient ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[04:41:21] [DOC: 9249233] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13326"}
[04:41:21] ❌    ❌ Failed to push order
[04:41:21] 🔄 
🔄 Step 7: Writing to CSV...
[04:41:21] [DOC: 9249233] ℹ️  Calculated age: 73 from DOB: 03/29/1952
[04:41:21] [DOC: 9249233] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:41:21] [DOC: 9249233] ℹ️  Payer Source extracted: ''
[04:41:21] [DOC: 9249233] ℹ️  Diagnosis codes being written:
[04:41:21] [DOC: 9249233] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:41:21] [DOC: 9249233] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:41:21] [DOC: 9249233] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:41:21] [DOC: 9249233] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:41:21] [DOC: 9249233] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:41:21] [DOC: 9249233] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:41:21] [DOC: 9249233] ✅ Patient data written to CSV: Maria Maiato | Sex: FEMALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2687695
[04:41:21] ✅    ✅ Document 9249233 processed and saved successfully
[04:41:21] 🔄 
🔄 Step 8: Saving API details...
[04:41:21] [DOC: 9249233] ℹ️  API push details saved for document 9249233
[04:41:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249232                         ║
================================================================================
[04:41:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:41:21] ℹ️  Date: 04/18/2025
[04:41:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:41:23] [DOC: 9249232] ✅ Text extracted using pdfplumber (1213 chars)
[04:41:23] ✅    ✅ Text extracted using pdfplumber (1213 chars)
[04:41:23] 🔄 
🔄 Step 2: Extracting patient data...
[04:41:25] ℹ️  AI extracted raw sex value: 'F'
[04:41:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:41:25] ℹ️  AI extracted payer source: ''
[04:41:25] ℹ️  AI extracted diagnoses:
[04:41:25] ℹ️    - Diagnosis 1: ''
[04:41:25] ℹ️    - Diagnosis 2: ''
[04:41:25] ℹ️    - Diagnosis 3: ''
[04:41:25] ℹ️    - Diagnosis 4: ''
[04:41:25] ℹ️    - Diagnosis 5: ''
[04:41:25] ℹ️    - Diagnosis 6: ''
[04:41:25] ℹ️  Final extracted MRN: '3132958'
[04:41:25] ℹ️  Final extracted Sex: 'FEMALE'
[04:41:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:41:25] ℹ️  Final extracted Payer Source: ''
[04:41:25] ✅ Patient data extraction completed successfully
[04:41:25] ✅    ✅ Patient data extracted successfully
[04:41:25] 📊 Patient Response
     └─ patientFName: Sally
     └─ patientLName: Mabray
     └─ dob: 05/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3132958
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:41:25] ✅    ✅ Patient identified: Sally Mabray
[04:41:25] ✅    ✅ Patient name validation passed
[04:41:25] 🔄 
🔄 Step 3: Processing patient dates...
[04:41:25] [DOC: 9249232] ℹ️  DOB normalized: 05/06/1938
[04:41:25] [DOC: 9249232] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[04:41:25] [DOC: 9249232] ✅ Patient date processing completed successfully
[04:41:25] ✅    ✅ Date processing completed
[04:41:25] 📊 Processed Patient Data
     └─ patientFName: Sally
     └─ patientLName: Mabray
     └─ dob: 05/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3132958
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:41:25] 🔄 
🔄 Step 4: Extracting order data...
[04:41:27] ℹ️  Order extraction - MRN: '3132958'
[04:41:27] ℹ️  Order extraction - Sex: 'FEMALE'
[04:41:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:41:27] ℹ️  Order extraction - Payer Source: ''
[04:41:27] ✅ Order data extraction completed successfully
[04:41:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:41:27] ℹ️  Using MRN from patient data: '3132958' over '3132958'
[04:41:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:41:27] ✅ Patient name cross-validation successful
[04:41:27] ✅    ✅ Data merged successfully
[04:41:29] ✅    ✅ Order data extracted and validated
[04:41:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:41:42] [DOC: 9249232] ℹ️  Patient not found in cache or API: Sally Mabray
[04:41:42] [DOC: 9249232] ℹ️  Patient not found, creating new patient via API...
[04:41:42] [DOC: 9249232] ℹ️  Creating patient via API: Sally Mabray
[04:41:44] [DOC: 9249232] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:41:44] ❌    ❌ Failed to create patient
[04:41:44] [DOC: 9249232] ℹ️  API push details saved for document 9249232
================================================================================
║                        Processing Document ID: 9249230                         ║
================================================================================
[04:41:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:41:44] ℹ️  Date: 04/18/2025
[04:41:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:41:45] [DOC: 9249230] ✅ Text extracted using pdfplumber (1630 chars)
[04:41:45] ✅    ✅ Text extracted using pdfplumber (1630 chars)
[04:41:45] 🔄 
🔄 Step 2: Extracting patient data...
[04:41:48] ℹ️  AI extracted raw sex value: 'M'
[04:41:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:41:48] ℹ️  AI extracted payer source: ''
[04:41:48] ℹ️  AI extracted diagnoses:
[04:41:48] ℹ️    - Diagnosis 1: 'None'
[04:41:48] ℹ️    - Diagnosis 2: 'None'
[04:41:48] ℹ️    - Diagnosis 3: 'None'
[04:41:48] ℹ️    - Diagnosis 4: 'None'
[04:41:48] ℹ️    - Diagnosis 5: 'None'
[04:41:48] ℹ️    - Diagnosis 6: 'None'
[04:41:48] ℹ️  Final extracted MRN: '2007941'
[04:41:48] ℹ️  Final extracted Sex: 'MALE'
[04:41:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:41:48] ℹ️  Final extracted Payer Source: ''
[04:41:48] ✅ Patient data extraction completed successfully
[04:41:48] ✅    ✅ Patient data extracted successfully
[04:41:48] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Landry
     └─ dob: 07/19/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2007941
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:41:48] ✅    ✅ Patient identified: John Landry
[04:41:48] ✅    ✅ Patient name validation passed
[04:41:48] 🔄 
🔄 Step 3: Processing patient dates...
[04:41:48] [DOC: 9249230] ℹ️  DOB normalized: 07/19/1951
[04:41:48] [DOC: 9249230] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[04:41:48] [DOC: 9249230] ✅ Patient date processing completed successfully
[04:41:48] ✅    ✅ Date processing completed
[04:41:48] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Landry
     └─ dob: 07/19/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2007941
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025'}]
[04:41:48] 🔄 
🔄 Step 4: Extracting order data...
[04:41:50] ℹ️  Order extraction - MRN: '2007941'
[04:41:50] ℹ️  Order extraction - Sex: 'MALE'
[04:41:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:41:50] ℹ️  Order extraction - Payer Source: ''
[04:41:50] ✅ Order data extraction completed successfully
[04:41:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:41:50] ℹ️  Using MRN from patient data: '2007941' over '2007941'
[04:41:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:41:50] ✅ Patient name cross-validation successful
[04:41:50] ✅    ✅ Data merged successfully
[04:41:51] ✅    ✅ Order data extracted and validated
[04:41:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:42:09] [DOC: 9249230] ✅ Patient exists in API: John Landry, ID: bde2c2e9-5c07-4d54-962d-c30b14c232ac
[04:42:09] ✅    ✅ Existing patient found with ID: bde2c2e9-5c07-4d54-962d-c30b14c232ac
[04:42:09] 🔄 
🔄 Step 6: Pushing order to API...
[04:42:09] [DOC: 9249230] ℹ️  Pushing order via API for patient ID: bde2c2e9-5c07-4d54-962d-c30b14c232ac
[04:42:10] [DOC: 9249230] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13168"}
[04:42:10] ❌    ❌ Failed to push order
[04:42:10] 🔄 
🔄 Step 7: Writing to CSV...
[04:42:10] [DOC: 9249230] ℹ️  Calculated age: 73 from DOB: 07/19/1951
[04:42:10] [DOC: 9249230] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:42:10] [DOC: 9249230] ℹ️  Payer Source extracted: ''
[04:42:10] [DOC: 9249230] ℹ️  Diagnosis codes being written:
[04:42:10] [DOC: 9249230] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:42:10] [DOC: 9249230] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:42:10] [DOC: 9249230] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:42:10] [DOC: 9249230] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:42:10] [DOC: 9249230] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:42:10] [DOC: 9249230] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:42:10] [DOC: 9249230] ✅ Patient data written to CSV: John Landry | Sex: MALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2007941
[04:42:10] ✅    ✅ Document 9249230 processed and saved successfully
[04:42:10] 🔄 
🔄 Step 8: Saving API details...
[04:42:10] [DOC: 9249230] ℹ️  API push details saved for document 9249230
[04:42:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249226                         ║
================================================================================
[04:42:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:42:10] ℹ️  Date: 04/18/2025
[04:42:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:42:12] [DOC: 9249226] ✅ Text extracted using pdfplumber (1366 chars)
[04:42:12] ✅    ✅ Text extracted using pdfplumber (1366 chars)
[04:42:12] 🔄 
🔄 Step 2: Extracting patient data...
[04:42:14] ℹ️  AI extracted raw sex value: 'M'
[04:42:14] ℹ️  AI extracted service line: 'Nursing'
[04:42:14] ℹ️  AI extracted payer source: ''
[04:42:14] ℹ️  AI extracted diagnoses:
[04:42:14] ℹ️    - Diagnosis 1: ''
[04:42:14] ℹ️    - Diagnosis 2: ''
[04:42:14] ℹ️    - Diagnosis 3: ''
[04:42:14] ℹ️    - Diagnosis 4: ''
[04:42:14] ℹ️    - Diagnosis 5: ''
[04:42:14] ℹ️    - Diagnosis 6: ''
[04:42:14] ℹ️  Final extracted MRN: '2611249'
[04:42:14] ℹ️  Final extracted Sex: 'MALE'
[04:42:14] ℹ️  Final extracted Service Line: 'Nursing'
[04:42:14] ℹ️  Final extracted Payer Source: ''
[04:42:14] ✅ Patient data extraction completed successfully
[04:42:14] ✅    ✅ Patient data extracted successfully
[04:42:14] 📊 Patient Response
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:42:14] ✅    ✅ Patient identified: Kelada Sobhy
[04:42:14] ✅    ✅ Patient name validation passed
[04:42:14] 🔄 
🔄 Step 3: Processing patient dates...
[04:42:14] [DOC: 9249226] ℹ️  DOB normalized: 10/02/1947
[04:42:14] [DOC: 9249226] ✅ Patient date processing completed successfully
[04:42:14] ✅    ✅ Date processing completed
[04:42:14] 📊 Processed Patient Data
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:42:14] 🔄 
🔄 Step 4: Extracting order data...
[04:42:16] ℹ️  Order extraction - MRN: '2611249'
[04:42:16] ℹ️  Order extraction - Sex: 'MALE'
[04:42:16] ℹ️  Order extraction - Service Line: ''
[04:42:16] ℹ️  Order extraction - Payer Source: ''
[04:42:16] ✅ Order data extraction completed successfully
[04:42:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:42:16] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[04:42:16] ℹ️  Using service line from patient data: 'Nursing'
[04:42:16] ✅ Patient name cross-validation successful
[04:42:16] ✅    ✅ Data merged successfully
[04:42:18] ✅    ✅ Order data extracted and validated
[04:42:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:42:50] [DOC: 9249226] ✅ Patient exists in API: Kelada Sobhy, ID: 8a6b616d-5563-4a72-b09b-bf5e7e90595e
[04:42:50] ✅    ✅ Existing patient found with ID: 8a6b616d-5563-4a72-b09b-bf5e7e90595e
[04:42:50] 🔄 
🔄 Step 6: Pushing order to API...
[04:42:50] [DOC: 9249226] ℹ️  Pushing order via API for patient ID: 8a6b616d-5563-4a72-b09b-bf5e7e90595e
[04:42:51] [DOC: 9249226] ❌ Order push failed with status 201: {"id":"1d7cf56f-bb60-4f71-bd43-56c5f78e818a","orderWAVId":"ORD20018","orderNo":"1083130, 1083131","orderDate":"04/18/2025","startOfCare":"04/10/2025","episodeStartDate":"04/10/2025","episodeEndDate":"04/17/2025","documentID":"9249226","mrn":"2611249","patientName":"Kelada,Sobhy","sentToPhysicianDate":"04/18/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/22/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"8a6b616d-5563-4a72-b09b-bf5e7e90595e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:42:51] ❌    ❌ Failed to push order
[04:42:51] 🔄 
🔄 Step 7: Writing to CSV...
[04:42:51] [DOC: 9249226] ℹ️  Calculated age: 77 from DOB: 10/02/1947
[04:42:51] [DOC: 9249226] ℹ️  Service Line extracted: 'Nursing'
[04:42:51] [DOC: 9249226] ℹ️  Payer Source extracted: ''
[04:42:51] [DOC: 9249226] ℹ️  Diagnosis codes being written:
[04:42:51] [DOC: 9249226] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:42:51] [DOC: 9249226] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:42:51] [DOC: 9249226] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:42:51] [DOC: 9249226] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:42:51] [DOC: 9249226] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:42:51] [DOC: 9249226] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:42:51] [DOC: 9249226] ✅ Patient data written to CSV: Kelada Sobhy | Sex: MALE | Age: 77 | Service: Nursing | Payer:  | MRN: 2611249
[04:42:51] ✅    ✅ Document 9249226 processed and saved successfully
[04:42:51] 🔄 
🔄 Step 8: Saving API details...
[04:42:51] [DOC: 9249226] ℹ️  API push details saved for document 9249226
[04:42:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249225                         ║
================================================================================
[04:42:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:42:51] ℹ️  Date: 04/18/2025
[04:42:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:42:53] [DOC: 9249225] ✅ Text extracted using pdfplumber (1103 chars)
[04:42:53] ✅    ✅ Text extracted using pdfplumber (1103 chars)
[04:42:53] 🔄 
🔄 Step 2: Extracting patient data...
[04:42:55] ℹ️  AI extracted raw sex value: 'F'
[04:42:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:42:55] ℹ️  AI extracted payer source: ''
[04:42:55] ℹ️  AI extracted diagnoses:
[04:42:55] ℹ️    - Diagnosis 1: ''
[04:42:55] ℹ️    - Diagnosis 2: ''
[04:42:55] ℹ️    - Diagnosis 3: ''
[04:42:55] ℹ️    - Diagnosis 4: ''
[04:42:55] ℹ️    - Diagnosis 5: ''
[04:42:55] ℹ️    - Diagnosis 6: ''
[04:42:55] ℹ️  Final extracted MRN: '2092477'
[04:42:55] ℹ️  Final extracted Sex: 'FEMALE'
[04:42:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:42:55] ℹ️  Final extracted Payer Source: ''
[04:42:55] ✅ Patient data extraction completed successfully
[04:42:55] ✅    ✅ Patient data extracted successfully
[04:42:55] 📊 Patient Response
     └─ patientFName: Michelle
     └─ patientLName: Gonsalves
     └─ dob: 02/09/1972
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2092477
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:42:55] ✅    ✅ Patient identified: Michelle Gonsalves
[04:42:55] ✅    ✅ Patient name validation passed
[04:42:55] 🔄 
🔄 Step 3: Processing patient dates...
[04:42:55] [DOC: 9249225] ℹ️  DOB normalized: 02/09/1972
[04:42:55] [DOC: 9249225] ✅ Patient date processing completed successfully
[04:42:55] ✅    ✅ Date processing completed
[04:42:55] 📊 Processed Patient Data
     └─ patientFName: Michelle
     └─ patientLName: Gonsalves
     └─ dob: 02/09/1972
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2092477
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:42:55] 🔄 
🔄 Step 4: Extracting order data...
[04:42:57] ℹ️  Order extraction - MRN: '2092477'
[04:42:57] ℹ️  Order extraction - Sex: 'FEMALE'
[04:42:57] ℹ️  Order extraction - Service Line: 'SN'
[04:42:57] ℹ️  Order extraction - Payer Source: ''
[04:42:57] ✅ Order data extraction completed successfully
[04:42:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:42:57] ℹ️  Using MRN from patient data: '2092477' over '2092477'
[04:42:57] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[04:42:57] ✅ Patient name cross-validation successful
[04:42:57] ✅    ✅ Data merged successfully
[04:42:59] ✅    ✅ Order data extracted and validated
[04:42:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:43:17] [DOC: 9249225] ℹ️  Patient not found in cache or API: Michelle Gonsalves
[04:43:17] [DOC: 9249225] ℹ️  Patient not found, creating new patient via API...
[04:43:17] [DOC: 9249225] ℹ️  Creating patient via API: Michelle Gonsalves
[04:43:19] [DOC: 9249225] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[04:43:19] ❌    ❌ Failed to create patient
[04:43:19] [DOC: 9249225] ℹ️  API push details saved for document 9249225
================================================================================
║                        Processing Document ID: 9249216                         ║
================================================================================
[04:43:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:43:19] ℹ️  Date: 04/18/2025
[04:43:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:43:20] [DOC: 9249216] ✅ Text extracted using pdfplumber (1139 chars)
[04:43:20] ✅    ✅ Text extracted using pdfplumber (1139 chars)
[04:43:20] 🔄 
🔄 Step 2: Extracting patient data...
[04:43:23] ℹ️  AI extracted raw sex value: 'F'
[04:43:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:43:23] ℹ️  AI extracted payer source: ''
[04:43:23] ℹ️  AI extracted diagnoses:
[04:43:23] ℹ️    - Diagnosis 1: ''
[04:43:23] ℹ️    - Diagnosis 2: ''
[04:43:23] ℹ️    - Diagnosis 3: ''
[04:43:23] ℹ️    - Diagnosis 4: ''
[04:43:23] ℹ️    - Diagnosis 5: ''
[04:43:23] ℹ️    - Diagnosis 6: ''
[04:43:23] ℹ️  Final extracted MRN: '2455123'
[04:43:23] ℹ️  Final extracted Sex: 'FEMALE'
[04:43:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:43:23] ℹ️  Final extracted Payer Source: ''
[04:43:23] ✅ Patient data extraction completed successfully
[04:43:23] ✅    ✅ Patient data extracted successfully
[04:43:23] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:43:23] ✅    ✅ Patient identified: Donna Faria
[04:43:23] ✅    ✅ Patient name validation passed
[04:43:23] 🔄 
🔄 Step 3: Processing patient dates...
[04:43:23] [DOC: 9249216] ℹ️  DOB normalized: 04/27/1958
[04:43:23] [DOC: 9249216] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[04:43:23] [DOC: 9249216] ✅ Patient date processing completed successfully
[04:43:23] ✅    ✅ Date processing completed
[04:43:23] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:43:23] 🔄 
🔄 Step 4: Extracting order data...
[04:43:25] ℹ️  Order extraction - MRN: '2455123'
[04:43:25] ℹ️  Order extraction - Sex: 'FEMALE'
[04:43:25] ℹ️  Order extraction - Service Line: 'SN'
[04:43:25] ℹ️  Order extraction - Payer Source: ''
[04:43:25] ✅ Order data extraction completed successfully
[04:43:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:43:25] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[04:43:25] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[04:43:25] ✅ Patient name cross-validation successful
[04:43:25] ✅    ✅ Data merged successfully
[04:43:26] ✅    ✅ Order data extracted and validated
[04:43:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:43:26] [DOC: 9249216] ✅ Patient found in local cache: Donna Faria, ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[04:43:26] ✅    ✅ Existing patient found with ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[04:43:26] 🔄 
🔄 Step 6: Pushing order to API...
[04:43:26] [DOC: 9249216] ℹ️  Pushing order via API for patient ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[04:43:27] [DOC: 9249216] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14144"}
[04:43:27] ❌    ❌ Failed to push order
[04:43:27] 🔄 
🔄 Step 7: Writing to CSV...
[04:43:27] [DOC: 9249216] ℹ️  Calculated age: 67 from DOB: 04/27/1958
[04:43:27] [DOC: 9249216] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[04:43:27] [DOC: 9249216] ℹ️  Payer Source extracted: ''
[04:43:27] [DOC: 9249216] ℹ️  Diagnosis codes being written:
[04:43:27] [DOC: 9249216] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:43:27] [DOC: 9249216] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:43:27] [DOC: 9249216] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:43:27] [DOC: 9249216] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:43:27] [DOC: 9249216] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:43:27] [DOC: 9249216] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:43:27] [DOC: 9249216] ✅ Patient data written to CSV: Donna Faria | Sex: FEMALE | Age: 67 | Service: SN, Skilled Nursing | Payer:  | MRN: 2455123
[04:43:27] ✅    ✅ Document 9249216 processed and saved successfully
[04:43:27] 🔄 
🔄 Step 8: Saving API details...
[04:43:27] [DOC: 9249216] ℹ️  API push details saved for document 9249216
[04:43:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249205                         ║
================================================================================
[04:43:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:43:27] ℹ️  Date: 04/18/2025
[04:43:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:43:29] [DOC: 9249205] ✅ Text extracted using pdfplumber (1348 chars)
[04:43:29] ✅    ✅ Text extracted using pdfplumber (1348 chars)
[04:43:29] 🔄 
🔄 Step 2: Extracting patient data...
[04:43:32] ℹ️  AI extracted raw sex value: 'M'
[04:43:32] ℹ️  AI extracted service line: 'Physical Therapy'
[04:43:32] ℹ️  AI extracted payer source: ''
[04:43:32] ℹ️  AI extracted diagnoses:
[04:43:32] ℹ️    - Diagnosis 1: 'None'
[04:43:32] ℹ️    - Diagnosis 2: 'None'
[04:43:32] ℹ️    - Diagnosis 3: 'None'
[04:43:32] ℹ️    - Diagnosis 4: 'None'
[04:43:32] ℹ️    - Diagnosis 5: 'None'
[04:43:32] ℹ️    - Diagnosis 6: 'None'
[04:43:32] ℹ️  Final extracted MRN: '2094562'
[04:43:32] ℹ️  Final extracted Sex: 'MALE'
[04:43:32] ℹ️  Final extracted Service Line: 'Physical Therapy'
[04:43:32] ℹ️  Final extracted Payer Source: ''
[04:43:32] ✅ Patient data extraction completed successfully
[04:43:32] ✅    ✅ Patient data extracted successfully
[04:43:32] 📊 Patient Response
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:43:32] ✅    ✅ Patient identified: Edward Correia
[04:43:32] ✅    ✅ Patient name validation passed
[04:43:32] 🔄 
🔄 Step 3: Processing patient dates...
[04:43:32] [DOC: 9249205] ℹ️  DOB normalized: 07/27/1950
[04:43:32] [DOC: 9249205] ✅ Patient date processing completed successfully
[04:43:32] ✅    ✅ Date processing completed
[04:43:32] 📊 Processed Patient Data
     └─ patientFName: Edward
     └─ patientLName: Correia
     └─ dob: 07/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2094562
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:43:32] 🔄 
🔄 Step 4: Extracting order data...
[04:43:34] ℹ️  Order extraction - MRN: '2094562'
[04:43:34] ℹ️  Order extraction - Sex: 'MALE'
[04:43:34] ℹ️  Order extraction - Service Line: ''
[04:43:34] ℹ️  Order extraction - Payer Source: ''
[04:43:34] ✅ Order data extraction completed successfully
[04:43:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:43:34] ℹ️  Using MRN from patient data: '2094562' over '2094562'
[04:43:34] ℹ️  Using service line from patient data: 'Physical Therapy'
[04:43:34] ✅ Patient name cross-validation successful
[04:43:34] ✅    ✅ Data merged successfully
[04:43:35] ⚠️     ❌ Skipping - missing episode start date
[04:43:35] [DOC: 9249205] ℹ️  API push details saved for document 9249205
================================================================================
║                        Processing Document ID: 9249200                         ║
================================================================================
[04:43:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:43:35] ℹ️  Date: 04/18/2025
[04:43:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:43:36] [DOC: 9249200] ✅ Text extracted using pdfplumber (1419 chars)
[04:43:36] ✅    ✅ Text extracted using pdfplumber (1419 chars)
[04:43:36] 🔄 
🔄 Step 2: Extracting patient data...
[04:43:39] ℹ️  AI extracted raw sex value: 'F'
[04:43:39] ℹ️  AI extracted service line: 'RN'
[04:43:39] ℹ️  AI extracted payer source: ''
[04:43:39] ℹ️  AI extracted diagnoses:
[04:43:39] ℹ️    - Diagnosis 1: 'None'
[04:43:39] ℹ️    - Diagnosis 2: 'None'
[04:43:39] ℹ️    - Diagnosis 3: 'None'
[04:43:39] ℹ️    - Diagnosis 4: 'None'
[04:43:39] ℹ️    - Diagnosis 5: 'None'
[04:43:39] ℹ️    - Diagnosis 6: 'None'
[04:43:39] ℹ️  Final extracted MRN: '2316868'
[04:43:39] ℹ️  Final extracted Sex: 'FEMALE'
[04:43:39] ℹ️  Final extracted Service Line: 'RN'
[04:43:39] ℹ️  Final extracted Payer Source: ''
[04:43:39] ✅ Patient data extraction completed successfully
[04:43:39] ✅    ✅ Patient data extracted successfully
[04:43:39] 📊 Patient Response
     └─ patientFName: Manuela
     └─ patientLName: Castro
     └─ dob: 08/19/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2316868
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:43:39] ✅    ✅ Patient identified: Manuela Castro
[04:43:39] ✅    ✅ Patient name validation passed
[04:43:39] 🔄 
🔄 Step 3: Processing patient dates...
[04:43:39] [DOC: 9249200] ℹ️  DOB normalized: 08/19/1946
[04:43:39] [DOC: 9249200] ✅ Patient date processing completed successfully
[04:43:39] ✅    ✅ Date processing completed
[04:43:39] 📊 Processed Patient Data
     └─ patientFName: Manuela
     └─ patientLName: Castro
     └─ dob: 08/19/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2316868
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:43:39] 🔄 
🔄 Step 4: Extracting order data...
[04:43:41] ℹ️  Order extraction - MRN: '2316868'
[04:43:41] ℹ️  Order extraction - Sex: 'FEMALE'
[04:43:41] ℹ️  Order extraction - Service Line: ''
[04:43:41] ℹ️  Order extraction - Payer Source: ''
[04:43:41] ✅ Order data extraction completed successfully
[04:43:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:43:41] ℹ️  Using MRN from patient data: '2316868' over '2316868'
[04:43:41] ℹ️  Using service line from patient data: 'RN'
[04:43:41] ✅ Patient name cross-validation successful
[04:43:41] ✅    ✅ Data merged successfully
[04:43:42] ⚠️     ❌ Skipping - missing episode start date
[04:43:42] [DOC: 9249200] ℹ️  API push details saved for document 9249200
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[04:43:42] ℹ️  Total Processed: 49
[04:43:42] ℹ️  CSV Success: 19
[04:43:42] ℹ️  CSV Errors: 10
[04:43:42] ℹ️  API Success: 0
[04:43:42] ℹ️  API Errors: 39
[04:43:42] ℹ️  CSV Success Rate: 38.8%
[04:43:42] ℹ️  API Success Rate: 0.0%
[04:43:42] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_042719.csv
[04:43:42] ℹ️  API Details File: api_outputs/api_push_details_20250608_042719.csv
================================================================================
║          ============================================================          ║
================================================================================
