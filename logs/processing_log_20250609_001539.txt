================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[00:15:39] ℹ️  CSV Data Extraction & API Push Tool
[00:15:39] ℹ️  
[00:15:39] ℹ️  Features:
[00:15:39] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[00:15:39] ℹ️  - AI-powered patient and order data extraction
[00:15:39] ℹ️  - Enhanced error handling and logging
[00:15:39] ℹ️  - Full API integration (patient creation + order pushing)
[00:15:39] ℹ️  - CSV output with comprehensive patient data
[00:15:39] ℹ️  - Detailed API tracking with remarks for every document
[00:15:39] ℹ️  - Complete audit trail of all processing attempts
[00:15:39] ℹ️  
[00:15:39] ℹ️  Starting CSV processing with API integration: nephrology - tableExport (26).csv
[00:15:39] ✅ Created output CSV file: csv_outputs/extracted_patients_20250609_001539.csv
[00:15:39] ✅ Created API details CSV file: api_outputs/api_push_details_20250609_001539.csv
================================================================================
║                        Processing Document ID: 9326932                         ║
================================================================================
[00:15:39] ℹ️  Agency: Dartmouth HH
[00:15:39] ℹ️  Date: 06/04/2025
[00:15:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:15:45] [DOC: 9326932] ✅ Text extracted using pdfplumber (11371 chars)
[00:15:45] ✅    ✅ Text extracted using pdfplumber (11359 chars)
[00:15:45] 🔄 
🔄 Step 2: Extracting patient data...
[00:15:48] ℹ️  AI extracted raw sex value: 'F'
[00:15:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:15:48] ℹ️  AI extracted payer source: ''
[00:15:48] ℹ️  AI extracted diagnoses:
[00:15:48] ℹ️    - Diagnosis 1: 'Z48.812'
[00:15:48] ℹ️    - Diagnosis 2: 'Z98.62'
[00:15:48] ℹ️    - Diagnosis 3: 'I12.0'
[00:15:48] ℹ️    - Diagnosis 4: 'N18.5'
[00:15:48] ℹ️    - Diagnosis 5: 'N17.9'
[00:15:48] ℹ️    - Diagnosis 6: 'E22.2'
[00:15:48] ℹ️  Final extracted MRN: '323014'
[00:15:48] ℹ️  Final extracted Sex: 'FEMALE'
[00:15:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:15:48] ℹ️  Final extracted Payer Source: ''
[00:15:48] ✅ Patient data extraction completed successfully
[00:15:48] ✅    ✅ Patient data extracted successfully
[00:15:48] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/05/2024', 'startOfEpisode': '10/07/2024', 'endOfEpisode': '08/02/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'Z98.62', 'thirdDiagnosis': 'I12.0', 'fourthDiagnosis': 'N18.5', 'fifthDiagnosis': 'N17.9', 'sixthDiagnosis': 'E22.2'}]
[00:15:48] ✅    ✅ Patient identified: Sandra Plissey
[00:15:48] ✅    ✅ Patient name validation passed
[00:15:48] 🔄 
🔄 Step 3: Processing patient dates...
[00:15:48] [DOC: 9326932] ℹ️  DOB normalized: 11/19/1943
[00:15:48] [DOC: 9326932] ℹ️  Episode startOfCare normalized: 10/05/2024
[00:15:48] [DOC: 9326932] ℹ️  Episode startOfEpisode normalized: 10/07/2024
[00:15:48] [DOC: 9326932] ℹ️  Episode endOfEpisode normalized: 08/02/2025
[00:15:48] [DOC: 9326932] ✅ Patient date processing completed successfully
[00:15:48] ✅    ✅ Date processing completed
[00:15:48] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/05/2024', 'startOfEpisode': '10/07/2024', 'endOfEpisode': '08/02/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'Z98.62', 'thirdDiagnosis': 'I12.0', 'fourthDiagnosis': 'N18.5', 'fifthDiagnosis': 'N17.9', 'sixthDiagnosis': 'E22.2'}]
[00:15:48] 🔄 
🔄 Step 4: Extracting order data...
[00:15:52] ℹ️  Order extraction - MRN: '323014'
[00:15:52] ℹ️  Order extraction - Sex: 'FEMALE'
[00:15:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:15:52] ℹ️  Order extraction - Payer Source: ''
[00:15:52] ✅ Order data extraction completed successfully
[00:15:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:15:52] ℹ️  Using MRN from patient data: '323014' over '323014'
[00:15:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:15:52] ✅ Patient name cross-validation successful
[00:15:52] ✅    ✅ Data merged successfully
[00:15:53] ✅    ✅ Order data extracted and validated
[00:15:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:15:53] [DOC: 9326932] ✅ Patient found in local cache: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:15:53] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:15:53] 🔄 
🔄 Step 6: Pushing order to API...
[00:15:53] [DOC: 9326932] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:15:55] [DOC: 9326932] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:15:55] ❌    ❌ Failed to push order
[00:15:55] 🔄 
🔄 Step 7: Writing to CSV...
[00:15:55] [DOC: 9326932] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[00:15:55] [DOC: 9326932] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:15:55] [DOC: 9326932] ℹ️  Payer Source extracted: ''
[00:15:55] [DOC: 9326932] ℹ️  Diagnosis codes being written:
[00:15:55] [DOC: 9326932] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.812'
[00:15:55] [DOC: 9326932] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z98.62'
[00:15:55] [DOC: 9326932] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.0'
[00:15:55] [DOC: 9326932] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.5'
[00:15:55] [DOC: 9326932] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N17.9'
[00:15:55] [DOC: 9326932] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E22.2'
[00:15:55] [DOC: 9326932] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: Skilled Nursing | Payer:  | MRN: 323014
[00:15:55] ✅    ✅ Document 9326932 processed and saved successfully
[00:15:55] 🔄 
🔄 Step 8: Saving API details...
[00:15:55] [DOC: 9326932] ℹ️  API push details saved for document 9326932
[00:15:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9327369                         ║
================================================================================
[00:15:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:15:55] ℹ️  Date: 06/04/2025
[00:15:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:15:58] [DOC: 9327369] ✅ Text extracted using pdfplumber (16549 chars)
[00:15:58] ✅    ✅ Text extracted using pdfplumber (16539 chars)
[00:15:58] 🔄 
🔄 Step 2: Extracting patient data...
[00:16:01] ℹ️  AI extracted raw sex value: 'M'
[00:16:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:16:01] ℹ️  AI extracted payer source: ''
[00:16:01] ℹ️  AI extracted diagnoses:
[00:16:01] ℹ️    - Diagnosis 1: 'A41.51'
[00:16:01] ℹ️    - Diagnosis 2: 'L02.212'
[00:16:01] ℹ️    - Diagnosis 3: 'Z16.12'
[00:16:01] ℹ️    - Diagnosis 4: 'Z45.2'
[00:16:01] ℹ️    - Diagnosis 5: 'Z79.2'
[00:16:01] ℹ️    - Diagnosis 6: 'I12.9'
[00:16:01] ℹ️  Final extracted MRN: '2621702'
[00:16:01] ℹ️  Final extracted Sex: 'MALE'
[00:16:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:16:01] ℹ️  Final extracted Payer Source: ''
[00:16:01] ✅ Patient data extraction completed successfully
[00:16:01] ✅    ✅ Patient data extracted successfully
[00:16:01] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/13/2025', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'L02.212', 'thirdDiagnosis': 'Z16.12', 'fourthDiagnosis': 'Z45.2', 'fifthDiagnosis': 'Z79.2', 'sixthDiagnosis': 'I12.9'}]
[00:16:01] ✅    ✅ Patient identified: Bernard Klim
[00:16:01] ✅    ✅ Patient name validation passed
[00:16:01] 🔄 
🔄 Step 3: Processing patient dates...
[00:16:01] [DOC: 9327369] ℹ️  DOB normalized: 09/20/1957
[00:16:01] [DOC: 9327369] ℹ️  Episode startOfCare normalized: 05/13/2025
[00:16:01] [DOC: 9327369] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[00:16:01] [DOC: 9327369] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[00:16:01] [DOC: 9327369] ✅ Patient date processing completed successfully
[00:16:01] ✅    ✅ Date processing completed
[00:16:01] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/13/2025', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'L02.212', 'thirdDiagnosis': 'Z16.12', 'fourthDiagnosis': 'Z45.2', 'fifthDiagnosis': 'Z79.2', 'sixthDiagnosis': 'I12.9'}]
[00:16:01] 🔄 
🔄 Step 4: Extracting order data...
[00:16:04] ℹ️  Order extraction - MRN: '2621702'
[00:16:04] ℹ️  Order extraction - Sex: 'MALE'
[00:16:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:16:04] ℹ️  Order extraction - Payer Source: ''
[00:16:04] ✅ Order data extraction completed successfully
[00:16:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:16:04] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[00:16:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:16:04] ✅ Patient name cross-validation successful
[00:16:04] ✅    ✅ Data merged successfully
[00:16:05] ✅    ✅ Order data extracted and validated
[00:16:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:16:08] [DOC: 9327369] ℹ️  Patient not found in cache or API: Bernard Klim
[00:16:08] [DOC: 9327369] ℹ️  Patient not found, creating new patient via API...
[00:16:08] [DOC: 9327369] ℹ️  Creating patient via API: Bernard Klim
[00:16:09] [DOC: 9327369] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:16:09] ❌    ❌ Failed to create patient
[00:16:09] [DOC: 9327369] ℹ️  API push details saved for document 9327369
================================================================================
║                        Processing Document ID: 9326927                         ║
================================================================================
[00:16:09] ℹ️  Agency: Dartmouth HH
[00:16:09] ℹ️  Date: 06/04/2025
[00:16:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:16:12] [DOC: 9326927] ✅ Text extracted using pdfplumber (6461 chars)
[00:16:12] ✅    ✅ Text extracted using pdfplumber (6461 chars)
[00:16:12] 🔄 
🔄 Step 2: Extracting patient data...
[00:16:15] ℹ️  AI extracted raw sex value: 'F'
[00:16:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:16:15] ℹ️  AI extracted payer source: 'Medicare'
[00:16:15] ℹ️  AI extracted diagnoses:
[00:16:15] ℹ️    - Diagnosis 1: 'Z48.812'
[00:16:15] ℹ️    - Diagnosis 2: 'N18.5'
[00:16:15] ℹ️    - Diagnosis 3: 'I12.0'
[00:16:15] ℹ️    - Diagnosis 4: 'N17.9'
[00:16:15] ℹ️    - Diagnosis 5: 'E22.2'
[00:16:15] ℹ️    - Diagnosis 6: 'I48.91'
[00:16:15] ℹ️  Final extracted MRN: '323014'
[00:16:15] ℹ️  Final extracted Sex: 'FEMALE'
[00:16:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:16:15] ℹ️  Final extracted Payer Source: 'Medicare'
[00:16:15] ✅ Patient data extraction completed successfully
[00:16:15] ✅    ✅ Patient data extracted successfully
[00:16:15] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '10/02/2024', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'N18.5', 'thirdDiagnosis': 'I12.0', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'E22.2', 'sixthDiagnosis': 'I48.91'}]
[00:16:15] ✅    ✅ Patient identified: Sandra Plissey
[00:16:15] ✅    ✅ Patient name validation passed
[00:16:15] 🔄 
🔄 Step 3: Processing patient dates...
[00:16:15] [DOC: 9326927] ℹ️  DOB normalized: 11/19/1943
[00:16:15] [DOC: 9326927] ℹ️  Episode startOfCare normalized: 10/07/2024
[00:16:15] [DOC: 9326927] ℹ️  Episode startOfEpisode normalized: 10/02/2024
[00:16:15] [DOC: 9326927] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[00:16:15] [DOC: 9326927] ✅ Patient date processing completed successfully
[00:16:15] ✅    ✅ Date processing completed
[00:16:15] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '10/02/2024', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'N18.5', 'thirdDiagnosis': 'I12.0', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'E22.2', 'sixthDiagnosis': 'I48.91'}]
[00:16:15] 🔄 
🔄 Step 4: Extracting order data...
[00:16:18] ℹ️  Order extraction - MRN: ''
[00:16:18] ℹ️  Order extraction - Sex: 'FEMALE'
[00:16:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:16:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:16:18] ✅ Order data extraction completed successfully
[00:16:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:16:18] ℹ️  Using MRN from patient data: '323014'
[00:16:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:16:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:16:18] ✅ Patient name cross-validation successful
[00:16:18] ✅    ✅ Data merged successfully
[00:16:19] ✅    ✅ Order data extracted and validated
[00:16:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:16:19] [DOC: 9326927] ✅ Patient found in local cache: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:16:19] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:16:19] 🔄 
🔄 Step 6: Pushing order to API...
[00:16:19] [DOC: 9326927] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:16:20] [DOC: 9326927] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:16:20] ❌    ❌ Failed to push order
[00:16:20] 🔄 
🔄 Step 7: Writing to CSV...
[00:16:20] [DOC: 9326927] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[00:16:20] [DOC: 9326927] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:16:20] [DOC: 9326927] ℹ️  Payer Source extracted: 'Medicare'
[00:16:20] [DOC: 9326927] ℹ️  Diagnosis codes being written:
[00:16:20] [DOC: 9326927] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.812'
[00:16:20] [DOC: 9326927] ℹ️    - Latest_Episode_Seconddiagnosis: 'N18.5'
[00:16:20] [DOC: 9326927] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.0'
[00:16:20] [DOC: 9326927] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N17.9'
[00:16:20] [DOC: 9326927] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E22.2'
[00:16:20] [DOC: 9326927] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.91'
[00:16:20] [DOC: 9326927] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: 323014
[00:16:20] ✅    ✅ Document 9326927 processed and saved successfully
[00:16:20] 🔄 
🔄 Step 8: Saving API details...
[00:16:20] [DOC: 9326927] ℹ️  API push details saved for document 9326927
[00:16:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2190717                         ║
================================================================================
[00:16:20] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:16:20] ℹ️  Date: 06/03/2025
[00:16:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:16:22] [DOC: 2190717] ❌ Critical failure in get_pdf_text: Invalid response format
[00:16:22] ❌ Failed to extract text for Doc ID 2190717
[00:16:22] [DOC: 2190717] ℹ️  API push details saved for document 2190717
================================================================================
║                        Processing Document ID: 9323798                         ║
================================================================================
[00:16:22] ℹ️  Agency: Dartmouth HH
[00:16:22] ℹ️  Date: 06/03/2025
[00:16:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:16:24] [DOC: 9323798] ✅ Text extracted using pdfplumber (1124 chars)
[00:16:24] ✅    ✅ Text extracted using pdfplumber (1124 chars)
[00:16:24] 🔄 
🔄 Step 2: Extracting patient data...
[00:16:27] ℹ️  AI extracted raw sex value: 'F'
[00:16:27] ℹ️  AI extracted service line: 'HHA'
[00:16:27] ℹ️  AI extracted payer source: 'Medicare'
[00:16:27] ℹ️  AI extracted diagnoses:
[00:16:27] ℹ️    - Diagnosis 1: ''
[00:16:27] ℹ️    - Diagnosis 2: ''
[00:16:27] ℹ️    - Diagnosis 3: ''
[00:16:27] ℹ️    - Diagnosis 4: ''
[00:16:27] ℹ️    - Diagnosis 5: ''
[00:16:27] ℹ️    - Diagnosis 6: ''
[00:16:27] ℹ️  Final extracted MRN: '6115015'
[00:16:27] ℹ️  Final extracted Sex: 'FEMALE'
[00:16:27] ℹ️  Final extracted Service Line: 'HHA'
[00:16:27] ℹ️  Final extracted Payer Source: 'Medicare'
[00:16:27] ✅ Patient data extraction completed successfully
[00:16:27] ✅    ✅ Patient data extracted successfully
[00:16:27] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 41 Mill Street Apt 102
     └─ city: Marion
     └─ state: MA
     └─ zip: 02738
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:16:27] ✅    ✅ Patient identified: Nancy Silva
[00:16:27] ✅    ✅ Patient name validation passed
[00:16:27] 🔄 
🔄 Step 3: Processing patient dates...
[00:16:27] [DOC: 9323798] ℹ️  DOB normalized: 11/18/1936
[00:16:27] [DOC: 9323798] ℹ️  Episode startOfCare normalized: 03/01/2025
[00:16:27] [DOC: 9323798] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[00:16:27] [DOC: 9323798] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[00:16:27] [DOC: 9323798] ✅ Patient date processing completed successfully
[00:16:27] ✅    ✅ Date processing completed
[00:16:27] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 41 Mill Street Apt 102
     └─ city: Marion
     └─ state: MA
     └─ zip: 02738
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:16:27] 🔄 
🔄 Step 4: Extracting order data...
[00:16:29] ℹ️  Order extraction - MRN: ''
[00:16:29] ℹ️  Order extraction - Sex: 'FEMALE'
[00:16:29] ℹ️  Order extraction - Service Line: 'Wound Healing'
[00:16:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:16:29] ✅ Order data extraction completed successfully
[00:16:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:16:29] ℹ️  Using MRN from patient data: '6115015'
[00:16:29] ℹ️  Combined service lines: Patient='HHA' + Order='Wound Healing' = 'HHA, Wound Healing'
[00:16:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:16:29] ✅ Patient name cross-validation successful
[00:16:29] ✅    ✅ Data merged successfully
[00:16:31] ✅    ✅ Order data extracted and validated
[00:16:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:16:31] [DOC: 9323798] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:16:31] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:16:31] 🔄 
🔄 Step 6: Pushing order to API...
[00:16:31] [DOC: 9323798] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:16:32] [DOC: 9323798] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14401"}
[00:16:32] ❌    ❌ Failed to push order
[00:16:32] 🔄 
🔄 Step 7: Writing to CSV...
[00:16:32] [DOC: 9323798] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[00:16:32] [DOC: 9323798] ℹ️  Service Line extracted: 'HHA, Wound Healing'
[00:16:32] [DOC: 9323798] ℹ️  Payer Source extracted: 'Medicare'
[00:16:32] [DOC: 9323798] ℹ️  Diagnosis codes being written:
[00:16:32] [DOC: 9323798] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:16:32] [DOC: 9323798] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:16:32] [DOC: 9323798] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:16:32] [DOC: 9323798] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:16:32] [DOC: 9323798] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:16:32] [DOC: 9323798] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:16:32] [DOC: 9323798] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: HHA, Wound Healing | Payer: Medicare | MRN: 6115015
[00:16:32] ✅    ✅ Document 9323798 processed and saved successfully
[00:16:32] 🔄 
🔄 Step 8: Saving API details...
[00:16:32] [DOC: 9323798] ℹ️  API push details saved for document 9323798
[00:16:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9323789                         ║
================================================================================
[00:16:32] ℹ️  Agency: Dartmouth HH
[00:16:32] ℹ️  Date: 06/03/2025
[00:16:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:16:34] [DOC: 9323789] ✅ Text extracted using pdfplumber (1140 chars)
[00:16:34] ✅    ✅ Text extracted using pdfplumber (1140 chars)
[00:16:34] 🔄 
🔄 Step 2: Extracting patient data...
[00:16:36] ℹ️  AI extracted raw sex value: 'F'
[00:16:36] ℹ️  AI extracted service line: 'PT'
[00:16:36] ℹ️  AI extracted payer source: 'Medicare'
[00:16:36] ℹ️  AI extracted diagnoses:
[00:16:36] ℹ️    - Diagnosis 1: ''
[00:16:36] ℹ️    - Diagnosis 2: ''
[00:16:36] ℹ️    - Diagnosis 3: ''
[00:16:36] ℹ️    - Diagnosis 4: ''
[00:16:36] ℹ️    - Diagnosis 5: ''
[00:16:36] ℹ️    - Diagnosis 6: ''
[00:16:36] ℹ️  Final extracted MRN: '711015'
[00:16:36] ℹ️  Final extracted Sex: 'FEMALE'
[00:16:36] ℹ️  Final extracted Service Line: 'PT'
[00:16:36] ℹ️  Final extracted Payer Source: 'Medicare'
[00:16:36] ✅ Patient data extraction completed successfully
[00:16:36] ✅    ✅ Patient data extracted successfully
[00:16:36] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:16:36] ✅    ✅ Patient identified: Eileen Roddy
[00:16:36] ✅    ✅ Patient name validation passed
[00:16:36] 🔄 
🔄 Step 3: Processing patient dates...
[00:16:36] [DOC: 9323789] ℹ️  DOB normalized: 02/29/1948
[00:16:36] [DOC: 9323789] ℹ️  Episode startOfCare normalized: 04/02/2025
[00:16:36] [DOC: 9323789] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:16:36] [DOC: 9323789] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:16:36] [DOC: 9323789] ✅ Patient date processing completed successfully
[00:16:36] ✅    ✅ Date processing completed
[00:16:36] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:16:36] 🔄 
🔄 Step 4: Extracting order data...
[00:16:39] ℹ️  Order extraction - MRN: ''
[00:16:39] ℹ️  Order extraction - Sex: 'FEMALE'
[00:16:39] ℹ️  Order extraction - Service Line: 'PT'
[00:16:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:16:39] ✅ Order data extraction completed successfully
[00:16:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:16:39] ℹ️  Using MRN from patient data: '711015'
[00:16:39] ℹ️  Service line consistent in both sources: 'PT'
[00:16:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:16:39] ✅ Patient name cross-validation successful
[00:16:39] ✅    ✅ Data merged successfully
[00:16:40] ✅    ✅ Order data extracted and validated
[00:16:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:16:40] [DOC: 9323789] ✅ Patient found in local cache: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:16:40] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:16:40] 🔄 
🔄 Step 6: Pushing order to API...
[00:16:40] [DOC: 9323789] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:16:41] [DOC: 9323789] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:16:41] ❌    ❌ Failed to push order
[00:16:41] 🔄 
🔄 Step 7: Writing to CSV...
[00:16:41] [DOC: 9323789] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[00:16:41] [DOC: 9323789] ℹ️  Service Line extracted: 'PT'
[00:16:41] [DOC: 9323789] ℹ️  Payer Source extracted: 'Medicare'
[00:16:41] [DOC: 9323789] ℹ️  Diagnosis codes being written:
[00:16:41] [DOC: 9323789] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:16:41] [DOC: 9323789] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:16:41] [DOC: 9323789] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:16:41] [DOC: 9323789] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:16:41] [DOC: 9323789] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:16:41] [DOC: 9323789] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:16:41] [DOC: 9323789] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: PT | Payer: Medicare | MRN: 711015
[00:16:41] ✅    ✅ Document 9323789 processed and saved successfully
[00:16:41] 🔄 
🔄 Step 8: Saving API details...
[00:16:41] [DOC: 9323789] ℹ️  API push details saved for document 9323789
[00:16:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321772                         ║
================================================================================
[00:16:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:16:41] ℹ️  Date: 06/02/2025
[00:16:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:16:44] [DOC: 9321772] ✅ Text extracted using pdfplumber (1522 chars)
[00:16:44] ✅    ✅ Text extracted using pdfplumber (1510 chars)
[00:16:44] 🔄 
🔄 Step 2: Extracting patient data...
[00:16:46] ℹ️  AI extracted raw sex value: ''
[00:16:46] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:16:46] ℹ️  AI extracted payer source: ''
[00:16:46] ℹ️  AI extracted diagnoses:
[00:16:46] ℹ️    - Diagnosis 1: 'S22.41X'
[00:16:46] ℹ️    - Diagnosis 2: 'E11.9'
[00:16:46] ℹ️    - Diagnosis 3: 'E78.5'
[00:16:46] ℹ️    - Diagnosis 4: ''
[00:16:46] ℹ️    - Diagnosis 5: ''
[00:16:46] ℹ️    - Diagnosis 6: ''
[00:16:46] ℹ️  Final extracted MRN: 'MA250505104501'
[00:16:46] ℹ️  Final extracted Sex: ''
[00:16:46] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:16:46] ℹ️  Final extracted Payer Source: ''
[00:16:46] ✅ Patient data extraction completed successfully
[00:16:46] ✅    ✅ Patient data extracted successfully
[00:16:46] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:16:46] ✅    ✅ Patient identified: Joseph Reis
[00:16:46] ✅    ✅ Patient name validation passed
[00:16:46] 🔄 
🔄 Step 3: Processing patient dates...
[00:16:46] [DOC: 9321772] ℹ️  DOB normalized: 10/20/1945
[00:16:46] [DOC: 9321772] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[00:16:46] [DOC: 9321772] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[00:16:46] [DOC: 9321772] ✅ Patient date processing completed successfully
[00:16:46] ✅    ✅ Date processing completed
[00:16:46] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:16:46] 🔄 
🔄 Step 4: Extracting order data...
[00:16:49] ℹ️  Order extraction - MRN: 'MA250505104501'
[00:16:49] ℹ️  Order extraction - Sex: ''
[00:16:49] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:16:49] ℹ️  Order extraction - Payer Source: ''
[00:16:49] ✅ Order data extraction completed successfully
[00:16:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:16:49] ℹ️  Using MRN from patient data: 'MA250505104501' over 'MA250505104501'
[00:16:49] ℹ️  Inferred sex as MALE from name: Joseph
[00:16:49] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:16:49] ✅ Patient name cross-validation successful
[00:16:49] ✅    ✅ Data merged successfully
[00:16:50] ✅    ✅ Order data extracted and validated
[00:16:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:16:50] [DOC: 9321772] ✅ Patient found in local cache: Joseph Reis, ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[00:16:50] ✅    ✅ Existing patient found with ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[00:16:50] 🔄 
🔄 Step 6: Pushing order to API...
[00:16:50] [DOC: 9321772] ℹ️  Pushing order via API for patient ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[00:16:52] [DOC: 9321772] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18763"}
[00:16:52] ❌    ❌ Failed to push order
[00:16:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:16:52] [DOC: 9321772] ℹ️  Calculated age: 79 from DOB: 10/20/1945
[00:16:52] [DOC: 9321772] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:16:52] [DOC: 9321772] ℹ️  Payer Source extracted: ''
[00:16:52] [DOC: 9321772] ℹ️  Diagnosis codes being written:
[00:16:52] [DOC: 9321772] ℹ️    - Latest_Episode_Firstdiagnosis: 'S22.41X'
[00:16:52] [DOC: 9321772] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:16:52] [DOC: 9321772] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[00:16:52] [DOC: 9321772] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:16:52] [DOC: 9321772] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:16:52] [DOC: 9321772] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:16:52] [DOC: 9321772] ✅ Patient data written to CSV: Joseph Reis | Sex: MALE | Age: 79 | Service: Occupational Therapy | Payer:  | MRN: MA250505104501
[00:16:52] ✅    ✅ Document 9321772 processed and saved successfully
[00:16:52] 🔄 
🔄 Step 8: Saving API details...
[00:16:52] [DOC: 9321772] ℹ️  API push details saved for document 9321772
[00:16:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321771                         ║
================================================================================
[00:16:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:16:52] ℹ️  Date: 06/02/2025
[00:16:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:16:54] [DOC: 9321771] ✅ Text extracted using pdfplumber (1639 chars)
[00:16:54] ✅    ✅ Text extracted using pdfplumber (1627 chars)
[00:16:54] 🔄 
🔄 Step 2: Extracting patient data...
[00:16:57] ℹ️  AI extracted raw sex value: ''
[00:16:57] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:16:57] ℹ️  AI extracted payer source: ''
[00:16:57] ℹ️  AI extracted diagnoses:
[00:16:57] ℹ️    - Diagnosis 1: 'S22.41X'
[00:16:57] ℹ️    - Diagnosis 2: 'E11.9'
[00:16:57] ℹ️    - Diagnosis 3: 'E78.5'
[00:16:57] ℹ️    - Diagnosis 4: 'None'
[00:16:57] ℹ️    - Diagnosis 5: 'None'
[00:16:57] ℹ️    - Diagnosis 6: 'None'
[00:16:57] ℹ️  Final extracted MRN: 'MA250505104501'
[00:16:57] ℹ️  Final extracted Sex: ''
[00:16:57] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:16:57] ℹ️  Final extracted Payer Source: ''
[00:16:57] ✅ Patient data extraction completed successfully
[00:16:57] ✅    ✅ Patient data extracted successfully
[00:16:57] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:16:57] ✅    ✅ Patient identified: Joseph Reis
[00:16:57] ✅    ✅ Patient name validation passed
[00:16:57] 🔄 
🔄 Step 3: Processing patient dates...
[00:16:57] [DOC: 9321771] ℹ️  DOB normalized: 10/20/1945
[00:16:57] [DOC: 9321771] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[00:16:57] [DOC: 9321771] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[00:16:57] [DOC: 9321771] ✅ Patient date processing completed successfully
[00:16:57] ✅    ✅ Date processing completed
[00:16:57] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5'}]
[00:16:57] 🔄 
🔄 Step 4: Extracting order data...
[00:16:59] ℹ️  Order extraction - MRN: 'MA250505104501'
[00:16:59] ℹ️  Order extraction - Sex: ''
[00:16:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:16:59] ℹ️  Order extraction - Payer Source: ''
[00:16:59] ✅ Order data extraction completed successfully
[00:16:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:16:59] ℹ️  Using MRN from patient data: 'MA250505104501' over 'MA250505104501'
[00:16:59] ℹ️  Inferred sex as MALE from name: Joseph
[00:16:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:16:59] ✅ Patient name cross-validation successful
[00:16:59] ✅    ✅ Data merged successfully
[00:17:01] ✅    ✅ Order data extracted and validated
[00:17:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:17:01] [DOC: 9321771] ✅ Patient found in local cache: Joseph Reis, ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[00:17:01] ✅    ✅ Existing patient found with ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[00:17:01] 🔄 
🔄 Step 6: Pushing order to API...
[00:17:01] [DOC: 9321771] ℹ️  Pushing order via API for patient ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[00:17:02] [DOC: 9321771] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18764"}
[00:17:02] ❌    ❌ Failed to push order
[00:17:02] 🔄 
🔄 Step 7: Writing to CSV...
[00:17:02] [DOC: 9321771] ℹ️  Calculated age: 79 from DOB: 10/20/1945
[00:17:02] [DOC: 9321771] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:17:02] [DOC: 9321771] ℹ️  Payer Source extracted: ''
[00:17:02] [DOC: 9321771] ℹ️  Diagnosis codes being written:
[00:17:02] [DOC: 9321771] ℹ️    - Latest_Episode_Firstdiagnosis: 'S22.41X'
[00:17:02] [DOC: 9321771] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:17:02] [DOC: 9321771] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[00:17:02] [DOC: 9321771] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:17:02] [DOC: 9321771] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:17:02] [DOC: 9321771] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:17:02] [DOC: 9321771] ✅ Patient data written to CSV: Joseph Reis | Sex: MALE | Age: 79 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA250505104501
[00:17:02] ✅    ✅ Document 9321771 processed and saved successfully
[00:17:02] 🔄 
🔄 Step 8: Saving API details...
[00:17:02] [DOC: 9321771] ℹ️  API push details saved for document 9321771
[00:17:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321544                         ║
================================================================================
[00:17:02] ℹ️  Agency: Dartmouth HH
[00:17:02] ℹ️  Date: 06/02/2025
[00:17:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:17:04] [DOC: 9321544] ✅ Text extracted using pdfplumber (16796 chars)
[00:17:04] ✅    ✅ Text extracted using pdfplumber (16784 chars)
[00:17:04] 🔄 
🔄 Step 2: Extracting patient data...
[00:17:08] ℹ️  AI extracted raw sex value: 'F'
[00:17:08] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[00:17:08] ℹ️  AI extracted payer source: ''
[00:17:08] ℹ️  AI extracted diagnoses:
[00:17:08] ℹ️    - Diagnosis 1: 'Z47.89'
[00:17:08] ℹ️    - Diagnosis 2: 'M47.27'
[00:17:08] ℹ️    - Diagnosis 3: 'R26.89'
[00:17:08] ℹ️    - Diagnosis 4: 'M54.9'
[00:17:08] ℹ️    - Diagnosis 5: 'G90.09'
[00:17:08] ℹ️    - Diagnosis 6: 'M48.061'
[00:17:08] ℹ️  Final extracted MRN: '711015'
[00:17:08] ℹ️  Final extracted Sex: 'FEMALE'
[00:17:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[00:17:08] ℹ️  Final extracted Payer Source: ''
[00:17:08] ✅ Patient data extraction completed successfully
[00:17:08] ✅    ✅ Patient data extracted successfully
[00:17:08] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M47.27', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'M54.9', 'fifthDiagnosis': 'G90.09', 'sixthDiagnosis': 'M48.061'}]
[00:17:08] ✅    ✅ Patient identified: Eileen Roddy
[00:17:08] ✅    ✅ Patient name validation passed
[00:17:08] 🔄 
🔄 Step 3: Processing patient dates...
[00:17:08] [DOC: 9321544] ℹ️  DOB normalized: 02/29/1948
[00:17:08] [DOC: 9321544] ℹ️  Episode startOfCare normalized: 04/01/2025
[00:17:08] [DOC: 9321544] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:17:08] [DOC: 9321544] ℹ️  Episode endOfEpisode normalized: 07/30/2025
[00:17:08] [DOC: 9321544] ✅ Patient date processing completed successfully
[00:17:08] ✅    ✅ Date processing completed
[00:17:08] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M47.27', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'M54.9', 'fifthDiagnosis': 'G90.09', 'sixthDiagnosis': 'M48.061'}]
[00:17:08] 🔄 
🔄 Step 4: Extracting order data...
[00:17:10] ℹ️  Order extraction - MRN: '711015'
[00:17:10] ℹ️  Order extraction - Sex: 'FEMALE'
[00:17:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[00:17:10] ℹ️  Order extraction - Payer Source: ''
[00:17:10] ✅ Order data extraction completed successfully
[00:17:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:17:10] ℹ️  Using MRN from patient data: '711015' over '711015'
[00:17:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[00:17:10] ✅ Patient name cross-validation successful
[00:17:10] ✅    ✅ Data merged successfully
[00:17:12] ✅    ✅ Order data extracted and validated
[00:17:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:17:12] [DOC: 9321544] ✅ Patient found in local cache: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:17:12] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:17:12] 🔄 
🔄 Step 6: Pushing order to API...
[00:17:12] [DOC: 9321544] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:17:13] [DOC: 9321544] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:17:13] ❌    ❌ Failed to push order
[00:17:13] 🔄 
🔄 Step 7: Writing to CSV...
[00:17:13] [DOC: 9321544] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[00:17:13] [DOC: 9321544] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[00:17:13] [DOC: 9321544] ℹ️  Payer Source extracted: ''
[00:17:13] [DOC: 9321544] ℹ️  Diagnosis codes being written:
[00:17:13] [DOC: 9321544] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.89'
[00:17:13] [DOC: 9321544] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.27'
[00:17:13] [DOC: 9321544] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.89'
[00:17:13] [DOC: 9321544] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.9'
[00:17:13] [DOC: 9321544] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G90.09'
[00:17:13] [DOC: 9321544] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M48.061'
[00:17:13] [DOC: 9321544] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 711015
[00:17:13] ✅    ✅ Document 9321544 processed and saved successfully
[00:17:13] 🔄 
🔄 Step 8: Saving API details...
[00:17:13] [DOC: 9321544] ℹ️  API push details saved for document 9321544
[00:17:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320670                         ║
================================================================================
[00:17:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:17:13] ℹ️  Date: 05/30/2025
[00:17:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:17:15] [DOC: 9320670] ✅ Text extracted using pdfplumber (1329 chars)
[00:17:15] ✅    ✅ Text extracted using pdfplumber (1317 chars)
[00:17:15] 🔄 
🔄 Step 2: Extracting patient data...
[00:17:18] ℹ️  AI extracted raw sex value: ''
[00:17:18] ℹ️  AI extracted service line: 'Physical Therapy'
[00:17:18] ℹ️  AI extracted payer source: ''
[00:17:18] ℹ️  AI extracted diagnoses:
[00:17:18] ℹ️    - Diagnosis 1: 'E11.65'
[00:17:18] ℹ️    - Diagnosis 2: 'E03.9'
[00:17:18] ℹ️    - Diagnosis 3: 'E55.9'
[00:17:18] ℹ️    - Diagnosis 4: ''
[00:17:18] ℹ️    - Diagnosis 5: ''
[00:17:18] ℹ️    - Diagnosis 6: ''
[00:17:18] ℹ️  Final extracted MRN: 'MA241011025604'
[00:17:18] ℹ️  Final extracted Sex: ''
[00:17:18] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:17:18] ℹ️  Final extracted Payer Source: ''
[00:17:18] ✅ Patient data extraction completed successfully
[00:17:18] ✅    ✅ Patient data extracted successfully
[00:17:18] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:17:18] ✅    ✅ Patient identified: Maria Medeiros
[00:17:18] ✅    ✅ Patient name validation passed
[00:17:18] 🔄 
🔄 Step 3: Processing patient dates...
[00:17:18] [DOC: 9320670] ℹ️  DOB normalized: 02/04/1956
[00:17:18] [DOC: 9320670] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:17:18] [DOC: 9320670] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:17:18] [DOC: 9320670] ✅ Patient date processing completed successfully
[00:17:18] ✅    ✅ Date processing completed
[00:17:18] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:17:18] 🔄 
🔄 Step 4: Extracting order data...
[00:17:21] ℹ️  Order extraction - MRN: 'MA241011025604'
[00:17:21] ℹ️  Order extraction - Sex: ''
[00:17:21] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:17:21] ℹ️  Order extraction - Payer Source: ''
[00:17:21] ✅ Order data extraction completed successfully
[00:17:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:17:21] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[00:17:21] ℹ️  Inferred sex as FEMALE from name: Maria
[00:17:21] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:17:21] ✅ Patient name cross-validation successful
[00:17:21] ✅    ✅ Data merged successfully
[00:17:23] ✅    ✅ Order data extracted and validated
[00:17:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:17:25] [DOC: 9320670] ✅ Patient exists in API: Maria Medeiros, ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:17:25] ✅    ✅ Existing patient found with ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:17:25] 🔄 
🔄 Step 6: Pushing order to API...
[00:17:25] [DOC: 9320670] ℹ️  Pushing order via API for patient ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:17:26] [DOC: 9320670] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18933"}
[00:17:26] ❌    ❌ Failed to push order
[00:17:26] 🔄 
🔄 Step 7: Writing to CSV...
[00:17:26] [DOC: 9320670] ℹ️  Calculated age: 69 from DOB: 02/04/1956
[00:17:26] [DOC: 9320670] ℹ️  Service Line extracted: 'Physical Therapy'
[00:17:26] [DOC: 9320670] ℹ️  Payer Source extracted: ''
[00:17:26] [DOC: 9320670] ℹ️  Diagnosis codes being written:
[00:17:26] [DOC: 9320670] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[00:17:26] [DOC: 9320670] ℹ️    - Latest_Episode_Seconddiagnosis: 'E03.9'
[00:17:26] [DOC: 9320670] ℹ️    - Latest_Episode_Thirddiagnosis: 'E55.9'
[00:17:26] [DOC: 9320670] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:17:26] [DOC: 9320670] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:17:26] [DOC: 9320670] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:17:26] [DOC: 9320670] ✅ Patient data written to CSV: Maria Medeiros | Sex: FEMALE | Age: 69 | Service: Physical Therapy | Payer:  | MRN: MA241011025604
[00:17:26] ✅    ✅ Document 9320670 processed and saved successfully
[00:17:26] 🔄 
🔄 Step 8: Saving API details...
[00:17:26] [DOC: 9320670] ℹ️  API push details saved for document 9320670
[00:17:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320669                         ║
================================================================================
[00:17:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:17:26] ℹ️  Date: 05/30/2025
[00:17:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:17:29] [DOC: 9320669] ✅ Text extracted using pdfplumber (1316 chars)
[00:17:29] ✅    ✅ Text extracted using pdfplumber (1304 chars)
[00:17:29] 🔄 
🔄 Step 2: Extracting patient data...
[00:17:31] ℹ️  AI extracted raw sex value: ''
[00:17:31] ℹ️  AI extracted service line: 'Physical Therapy'
[00:17:31] ℹ️  AI extracted payer source: ''
[00:17:31] ℹ️  AI extracted diagnoses:
[00:17:31] ℹ️    - Diagnosis 1: 'E11.65'
[00:17:31] ℹ️    - Diagnosis 2: 'E03.9'
[00:17:31] ℹ️    - Diagnosis 3: 'E55.9'
[00:17:31] ℹ️    - Diagnosis 4: 'None'
[00:17:31] ℹ️    - Diagnosis 5: 'None'
[00:17:31] ℹ️    - Diagnosis 6: 'None'
[00:17:31] ℹ️  Final extracted MRN: 'MA241011025604'
[00:17:31] ℹ️  Final extracted Sex: ''
[00:17:31] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:17:31] ℹ️  Final extracted Payer Source: ''
[00:17:31] ✅ Patient data extraction completed successfully
[00:17:31] ✅    ✅ Patient data extracted successfully
[00:17:31] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:17:31] ✅    ✅ Patient identified: Maria Medeiros
[00:17:31] ✅    ✅ Patient name validation passed
[00:17:31] 🔄 
🔄 Step 3: Processing patient dates...
[00:17:31] [DOC: 9320669] ℹ️  DOB normalized: 02/04/1956
[00:17:31] [DOC: 9320669] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:17:31] [DOC: 9320669] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:17:31] [DOC: 9320669] ✅ Patient date processing completed successfully
[00:17:31] ✅    ✅ Date processing completed
[00:17:31] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9'}]
[00:17:31] 🔄 
🔄 Step 4: Extracting order data...
[00:17:34] ℹ️  Order extraction - MRN: 'MA241011025604'
[00:17:34] ℹ️  Order extraction - Sex: ''
[00:17:34] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:17:34] ℹ️  Order extraction - Payer Source: ''
[00:17:34] ✅ Order data extraction completed successfully
[00:17:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:17:34] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[00:17:34] ℹ️  Inferred sex as FEMALE from name: Maria
[00:17:34] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:17:34] ✅ Patient name cross-validation successful
[00:17:34] ✅    ✅ Data merged successfully
[00:17:35] ✅    ✅ Order data extracted and validated
[00:17:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:17:35] [DOC: 9320669] ✅ Patient found in local cache: Maria Medeiros, ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:17:35] ✅    ✅ Existing patient found with ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:17:35] 🔄 
🔄 Step 6: Pushing order to API...
[00:17:35] [DOC: 9320669] ℹ️  Pushing order via API for patient ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:17:36] [DOC: 9320669] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18934"}
[00:17:36] ❌    ❌ Failed to push order
[00:17:36] 🔄 
🔄 Step 7: Writing to CSV...
[00:17:36] [DOC: 9320669] ℹ️  Calculated age: 69 from DOB: 02/04/1956
[00:17:36] [DOC: 9320669] ℹ️  Service Line extracted: 'Physical Therapy'
[00:17:36] [DOC: 9320669] ℹ️  Payer Source extracted: ''
[00:17:36] [DOC: 9320669] ℹ️  Diagnosis codes being written:
[00:17:36] [DOC: 9320669] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[00:17:36] [DOC: 9320669] ℹ️    - Latest_Episode_Seconddiagnosis: 'E03.9'
[00:17:36] [DOC: 9320669] ℹ️    - Latest_Episode_Thirddiagnosis: 'E55.9'
[00:17:36] [DOC: 9320669] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:17:36] [DOC: 9320669] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:17:36] [DOC: 9320669] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:17:36] [DOC: 9320669] ✅ Patient data written to CSV: Maria Medeiros | Sex: FEMALE | Age: 69 | Service: Physical Therapy | Payer:  | MRN: MA241011025604
[00:17:36] ✅    ✅ Document 9320669 processed and saved successfully
[00:17:36] 🔄 
🔄 Step 8: Saving API details...
[00:17:36] [DOC: 9320669] ℹ️  API push details saved for document 9320669
[00:17:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320634                         ║
================================================================================
[00:17:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:17:36] ℹ️  Date: 05/30/2025
[00:17:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:17:39] [DOC: 9320634] ✅ Text extracted using pdfplumber (1510 chars)
[00:17:39] ✅    ✅ Text extracted using pdfplumber (1510 chars)
[00:17:39] 🔄 
🔄 Step 2: Extracting patient data...
[00:17:41] ℹ️  AI extracted raw sex value: ''
[00:17:41] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:17:41] ℹ️  AI extracted payer source: ''
[00:17:41] ℹ️  AI extracted diagnoses:
[00:17:41] ℹ️    - Diagnosis 1: 'F39'
[00:17:41] ℹ️    - Diagnosis 2: 'F32.A'
[00:17:41] ℹ️    - Diagnosis 3: 'E11.42'
[00:17:41] ℹ️    - Diagnosis 4: 'None'
[00:17:41] ℹ️    - Diagnosis 5: 'None'
[00:17:41] ℹ️    - Diagnosis 6: 'None'
[00:17:41] ℹ️  Final extracted MRN: 'MA221103064405'
[00:17:41] ℹ️  Final extracted Sex: ''
[00:17:41] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:17:41] ℹ️  Final extracted Payer Source: ''
[00:17:41] ✅ Patient data extraction completed successfully
[00:17:41] ✅    ✅ Patient data extracted successfully
[00:17:41] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:17:41] ✅    ✅ Patient identified: Marie Mendoza
[00:17:41] ✅    ✅ Patient name validation passed
[00:17:41] 🔄 
🔄 Step 3: Processing patient dates...
[00:17:41] [DOC: 9320634] ℹ️  DOB normalized: 06/25/1944
[00:17:41] [DOC: 9320634] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[00:17:41] [DOC: 9320634] ℹ️  Episode endOfEpisode normalized: 06/20/2025
[00:17:41] [DOC: 9320634] ✅ Patient date processing completed successfully
[00:17:41] ✅    ✅ Date processing completed
[00:17:41] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42'}]
[00:17:41] 🔄 
🔄 Step 4: Extracting order data...
[00:17:44] ℹ️  Order extraction - MRN: 'MA221103064405'
[00:17:44] ℹ️  Order extraction - Sex: ''
[00:17:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:17:44] ℹ️  Order extraction - Payer Source: ''
[00:17:44] ✅ Order data extraction completed successfully
[00:17:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:17:44] ℹ️  Using MRN from patient data: 'MA221103064405' over 'MA221103064405'
[00:17:44] ℹ️  Inferred sex as FEMALE from name: Marie
[00:17:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:17:44] ✅ Patient name cross-validation successful
[00:17:44] ✅    ✅ Data merged successfully
[00:17:45] ✅    ✅ Order data extracted and validated
[00:17:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:17:48] [DOC: 9320634] ✅ Patient exists in API: Marie Mendoza, ID: 64382b4d-decf-4031-a04d-ca4fa8f82a37
[00:17:48] ✅    ✅ Existing patient found with ID: 64382b4d-decf-4031-a04d-ca4fa8f82a37
[00:17:48] 🔄 
🔄 Step 6: Pushing order to API...
[00:17:48] [DOC: 9320634] ℹ️  Pushing order via API for patient ID: 64382b4d-decf-4031-a04d-ca4fa8f82a37
[00:17:49] [DOC: 9320634] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18796"}
[00:17:49] ❌    ❌ Failed to push order
[00:17:49] 🔄 
🔄 Step 7: Writing to CSV...
[00:17:49] [DOC: 9320634] ℹ️  Calculated age: 80 from DOB: 06/25/1944
[00:17:49] [DOC: 9320634] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:17:49] [DOC: 9320634] ℹ️  Payer Source extracted: ''
[00:17:49] [DOC: 9320634] ℹ️  Diagnosis codes being written:
[00:17:49] [DOC: 9320634] ℹ️    - Latest_Episode_Firstdiagnosis: 'F39'
[00:17:49] [DOC: 9320634] ℹ️    - Latest_Episode_Seconddiagnosis: 'F32.A'
[00:17:49] [DOC: 9320634] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.42'
[00:17:49] [DOC: 9320634] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:17:49] [DOC: 9320634] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:17:49] [DOC: 9320634] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:17:49] [DOC: 9320634] ✅ Patient data written to CSV: Marie Mendoza | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: MA221103064405
[00:17:49] ✅    ✅ Document 9320634 processed and saved successfully
[00:17:49] 🔄 
🔄 Step 8: Saving API details...
[00:17:49] [DOC: 9320634] ℹ️  API push details saved for document 9320634
[00:17:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320632                         ║
================================================================================
[00:17:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:17:49] ℹ️  Date: 05/30/2025
[00:17:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:17:55] [DOC: 9320632] ✅ Text extracted using pdfplumber (16318 chars)
[00:17:55] ✅    ✅ Text extracted using pdfplumber (16318 chars)
[00:17:55] 🔄 
🔄 Step 2: Extracting patient data...
[00:17:58] ℹ️  AI extracted raw sex value: ''
[00:17:58] ℹ️  AI extracted service line: 'PT'
[00:17:58] ℹ️  AI extracted payer source: ''
[00:17:58] ℹ️  AI extracted diagnoses:
[00:17:58] ℹ️    - Diagnosis 1: 'DM'
[00:17:58] ℹ️    - Diagnosis 2: 'CHF'
[00:17:58] ℹ️    - Diagnosis 3: 'None'
[00:17:58] ℹ️    - Diagnosis 4: 'None'
[00:17:58] ℹ️    - Diagnosis 5: 'None'
[00:17:58] ℹ️    - Diagnosis 6: 'None'
[00:17:58] ℹ️  Final extracted MRN: 'MA200528053701'
[00:17:58] ℹ️  Final extracted Sex: ''
[00:17:58] ℹ️  Final extracted Service Line: 'PT'
[00:17:58] ℹ️  Final extracted Payer Source: ''
[00:17:58] ✅ Patient data extraction completed successfully
[00:17:58] ✅    ✅ Patient data extracted successfully
[00:17:58] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/18/2025', 'endOfEpisode': None, 'firstDiagnosis': 'DM', 'secondDiagnosis': 'CHF', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:17:58] ✅    ✅ Patient identified: Roderick Lopez
[00:17:58] ✅    ✅ Patient name validation passed
[00:17:58] 🔄 
🔄 Step 3: Processing patient dates...
[00:17:58] [DOC: 9320632] ℹ️  DOB normalized: 05/21/1937
[00:17:58] [DOC: 9320632] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[00:17:58] [DOC: 9320632] ✅ Patient date processing completed successfully
[00:17:58] ✅    ✅ Date processing completed
[00:17:58] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'CHF'}]
[00:17:58] 🔄 
🔄 Step 4: Extracting order data...
[00:18:00] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:18:00] ℹ️  Order extraction - Sex: 'MALE'
[00:18:00] ℹ️  Order extraction - Service Line: 'PT'
[00:18:00] ℹ️  Order extraction - Payer Source: ''
[00:18:00] ✅ Order data extraction completed successfully
[00:18:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:18:00] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:18:00] ℹ️  Service line consistent in both sources: 'PT'
[00:18:00] ✅ Patient name cross-validation successful
[00:18:00] ✅    ✅ Data merged successfully
[00:18:01] ⚠️     ❌ Skipping - missing episode start date
[00:18:01] [DOC: 9320632] ℹ️  API push details saved for document 9320632
================================================================================
║                        Processing Document ID: 9320631                         ║
================================================================================
[00:18:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:18:01] ℹ️  Date: 05/30/2025
[00:18:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:18:05] [DOC: 9320631] ✅ Text extracted using pdfplumber (13919 chars)
[00:18:05] ✅    ✅ Text extracted using pdfplumber (13919 chars)
[00:18:05] 🔄 
🔄 Step 2: Extracting patient data...
[00:18:08] ℹ️  AI extracted raw sex value: ''
[00:18:08] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:18:08] ℹ️  AI extracted payer source: ''
[00:18:08] ℹ️  AI extracted diagnoses:
[00:18:08] ℹ️    - Diagnosis 1: 'I2699'
[00:18:08] ℹ️    - Diagnosis 2: 'M4856XD'
[00:18:08] ℹ️    - Diagnosis 3: ''
[00:18:08] ℹ️    - Diagnosis 4: ''
[00:18:08] ℹ️    - Diagnosis 5: ''
[00:18:08] ℹ️    - Diagnosis 6: ''
[00:18:08] ℹ️  Final extracted MRN: 'MA200528053701'
[00:18:08] ℹ️  Final extracted Sex: ''
[00:18:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:18:08] ℹ️  Final extracted Payer Source: ''
[00:18:08] ✅ Patient data extraction completed successfully
[00:18:08] ✅    ✅ Patient data extracted successfully
[00:18:08] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I2699', 'secondDiagnosis': 'M4856XD', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:18:08] ✅    ✅ Patient identified: Roderick Lopez
[00:18:08] ✅    ✅ Patient name validation passed
[00:18:08] 🔄 
🔄 Step 3: Processing patient dates...
[00:18:08] [DOC: 9320631] ℹ️  DOB normalized: 05/21/1937
[00:18:08] [DOC: 9320631] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[00:18:08] [DOC: 9320631] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[00:18:08] [DOC: 9320631] ✅ Patient date processing completed successfully
[00:18:08] ✅    ✅ Date processing completed
[00:18:08] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I2699', 'secondDiagnosis': 'M4856XD', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:18:08] 🔄 
🔄 Step 4: Extracting order data...
[00:18:11] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:18:11] ℹ️  Order extraction - Sex: ''
[00:18:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:18:11] ℹ️  Order extraction - Payer Source: ''
[00:18:11] ✅ Order data extraction completed successfully
[00:18:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:18:11] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:18:11] ℹ️  Inferred sex as MALE from name: Roderick
[00:18:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:18:11] ✅ Patient name cross-validation successful
[00:18:11] ✅    ✅ Data merged successfully
[00:18:12] ✅    ✅ Order data extracted and validated
[00:18:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:18:14] [DOC: 9320631] ✅ Patient exists in API: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:14] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:14] 🔄 
🔄 Step 6: Pushing order to API...
[00:18:14] [DOC: 9320631] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:15] [DOC: 9320631] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18798"}
[00:18:15] ❌    ❌ Failed to push order
[00:18:15] 🔄 
🔄 Step 7: Writing to CSV...
[00:18:15] [DOC: 9320631] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:18:15] [DOC: 9320631] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:18:15] [DOC: 9320631] ℹ️  Payer Source extracted: ''
[00:18:15] [DOC: 9320631] ℹ️  Diagnosis codes being written:
[00:18:15] [DOC: 9320631] ℹ️    - Latest_Episode_Firstdiagnosis: 'I2699'
[00:18:15] [DOC: 9320631] ℹ️    - Latest_Episode_Seconddiagnosis: 'M4856XD'
[00:18:15] [DOC: 9320631] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:18:15] [DOC: 9320631] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:18:15] [DOC: 9320631] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:18:15] [DOC: 9320631] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:18:15] [DOC: 9320631] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA200528053701
[00:18:15] ✅    ✅ Document 9320631 processed and saved successfully
[00:18:15] 🔄 
🔄 Step 8: Saving API details...
[00:18:15] [DOC: 9320631] ℹ️  API push details saved for document 9320631
[00:18:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320629                         ║
================================================================================
[00:18:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:18:15] ℹ️  Date: 05/30/2025
[00:18:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:18:18] [DOC: 9320629] ✅ Text extracted using pdfplumber (1489 chars)
[00:18:18] ✅    ✅ Text extracted using pdfplumber (1489 chars)
[00:18:18] 🔄 
🔄 Step 2: Extracting patient data...
[00:18:21] ℹ️  AI extracted raw sex value: ''
[00:18:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:18:21] ℹ️  AI extracted payer source: ''
[00:18:21] ℹ️  AI extracted diagnoses:
[00:18:21] ℹ️    - Diagnosis 1: 'I26.99'
[00:18:21] ℹ️    - Diagnosis 2: 'M48.56X'
[00:18:21] ℹ️    - Diagnosis 3: 'I11.0'
[00:18:21] ℹ️    - Diagnosis 4: ''
[00:18:21] ℹ️    - Diagnosis 5: ''
[00:18:21] ℹ️    - Diagnosis 6: ''
[00:18:21] ℹ️  Final extracted MRN: 'MA200528053701'
[00:18:21] ℹ️  Final extracted Sex: ''
[00:18:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:18:21] ℹ️  Final extracted Payer Source: ''
[00:18:21] ✅ Patient data extraction completed successfully
[00:18:21] ✅    ✅ Patient data extracted successfully
[00:18:21] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'M48.56X', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:18:21] ✅    ✅ Patient identified: Roderick Lopez
[00:18:21] ✅    ✅ Patient name validation passed
[00:18:21] 🔄 
🔄 Step 3: Processing patient dates...
[00:18:21] [DOC: 9320629] ℹ️  DOB normalized: 05/21/1937
[00:18:21] [DOC: 9320629] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[00:18:21] [DOC: 9320629] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[00:18:21] [DOC: 9320629] ✅ Patient date processing completed successfully
[00:18:21] ✅    ✅ Date processing completed
[00:18:21] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'M48.56X', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:18:21] 🔄 
🔄 Step 4: Extracting order data...
[00:18:24] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:18:24] ℹ️  Order extraction - Sex: ''
[00:18:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:18:24] ℹ️  Order extraction - Payer Source: ''
[00:18:24] ✅ Order data extraction completed successfully
[00:18:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:18:24] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:18:24] ℹ️  Inferred sex as MALE from name: Roderick
[00:18:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:18:24] ✅ Patient name cross-validation successful
[00:18:24] ✅    ✅ Data merged successfully
[00:18:25] ✅    ✅ Order data extracted and validated
[00:18:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:18:25] [DOC: 9320629] ✅ Patient found in local cache: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:25] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:25] 🔄 
🔄 Step 6: Pushing order to API...
[00:18:25] [DOC: 9320629] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:27] [DOC: 9320629] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18799"}
[00:18:27] ❌    ❌ Failed to push order
[00:18:27] 🔄 
🔄 Step 7: Writing to CSV...
[00:18:27] [DOC: 9320629] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:18:27] [DOC: 9320629] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:18:27] [DOC: 9320629] ℹ️  Payer Source extracted: ''
[00:18:27] [DOC: 9320629] ℹ️  Diagnosis codes being written:
[00:18:27] [DOC: 9320629] ℹ️    - Latest_Episode_Firstdiagnosis: 'I26.99'
[00:18:27] [DOC: 9320629] ℹ️    - Latest_Episode_Seconddiagnosis: 'M48.56X'
[00:18:27] [DOC: 9320629] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[00:18:27] [DOC: 9320629] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:18:27] [DOC: 9320629] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:18:27] [DOC: 9320629] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:18:27] [DOC: 9320629] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: Skilled Nursing | Payer:  | MRN: MA200528053701
[00:18:27] ✅    ✅ Document 9320629 processed and saved successfully
[00:18:27] 🔄 
🔄 Step 8: Saving API details...
[00:18:27] [DOC: 9320629] ℹ️  API push details saved for document 9320629
[00:18:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320628                         ║
================================================================================
[00:18:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:18:27] ℹ️  Date: 05/30/2025
[00:18:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:18:29] [DOC: 9320628] ✅ Text extracted using pdfplumber (12205 chars)
[00:18:29] ✅    ✅ Text extracted using pdfplumber (12205 chars)
[00:18:29] 🔄 
🔄 Step 2: Extracting patient data...
[00:18:32] ℹ️  AI extracted raw sex value: ''
[00:18:32] ℹ️  AI extracted service line: 'OT'
[00:18:32] ℹ️  AI extracted payer source: ''
[00:18:32] ℹ️  AI extracted diagnoses:
[00:18:32] ℹ️    - Diagnosis 1: 'J44.1'
[00:18:32] ℹ️    - Diagnosis 2: 'I50.9'
[00:18:32] ℹ️    - Diagnosis 3: ''
[00:18:32] ℹ️    - Diagnosis 4: ''
[00:18:32] ℹ️    - Diagnosis 5: ''
[00:18:32] ℹ️    - Diagnosis 6: ''
[00:18:32] ℹ️  Final extracted MRN: 'MA200528053701'
[00:18:32] ℹ️  Final extracted Sex: ''
[00:18:32] ℹ️  Final extracted Service Line: 'OT'
[00:18:32] ℹ️  Final extracted Payer Source: ''
[00:18:32] ✅ Patient data extraction completed successfully
[00:18:32] ✅    ✅ Patient data extracted successfully
[00:18:32] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:18:32] ✅    ✅ Patient identified: Roderick Lopez
[00:18:32] ✅    ✅ Patient name validation passed
[00:18:32] 🔄 
🔄 Step 3: Processing patient dates...
[00:18:32] [DOC: 9320628] ℹ️  DOB normalized: 05/21/1937
[00:18:32] [DOC: 9320628] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[00:18:32] [DOC: 9320628] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[00:18:32] [DOC: 9320628] ✅ Patient date processing completed successfully
[00:18:32] ✅    ✅ Date processing completed
[00:18:32] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:18:32] 🔄 
🔄 Step 4: Extracting order data...
[00:18:35] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:18:35] ℹ️  Order extraction - Sex: 'MALE'
[00:18:35] ℹ️  Order extraction - Service Line: 'OT'
[00:18:35] ℹ️  Order extraction - Payer Source: ''
[00:18:35] ✅ Order data extraction completed successfully
[00:18:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:18:35] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:18:35] ℹ️  Service line consistent in both sources: 'OT'
[00:18:35] ✅ Patient name cross-validation successful
[00:18:35] ✅    ✅ Data merged successfully
[00:18:37] ✅    ✅ Order data extracted and validated
[00:18:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:18:37] [DOC: 9320628] ✅ Patient found in local cache: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:37] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:37] 🔄 
🔄 Step 6: Pushing order to API...
[00:18:37] [DOC: 9320628] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:18:38] [DOC: 9320628] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:18:38] ❌    ❌ Failed to push order
[00:18:38] 🔄 
🔄 Step 7: Writing to CSV...
[00:18:38] [DOC: 9320628] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:18:38] [DOC: 9320628] ℹ️  Service Line extracted: 'OT'
[00:18:38] [DOC: 9320628] ℹ️  Payer Source extracted: ''
[00:18:38] [DOC: 9320628] ℹ️  Diagnosis codes being written:
[00:18:38] [DOC: 9320628] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[00:18:38] [DOC: 9320628] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[00:18:38] [DOC: 9320628] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:18:38] [DOC: 9320628] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:18:38] [DOC: 9320628] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:18:38] [DOC: 9320628] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:18:38] [DOC: 9320628] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: OT | Payer:  | MRN: MA200528053701
[00:18:38] ✅    ✅ Document 9320628 processed and saved successfully
[00:18:38] 🔄 
🔄 Step 8: Saving API details...
[00:18:38] [DOC: 9320628] ℹ️  API push details saved for document 9320628
[00:18:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320626                         ║
================================================================================
[00:18:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:18:38] ℹ️  Date: 05/30/2025
[00:18:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:18:44] [DOC: 9320626] ✅ Text extracted using pdfplumber (17363 chars)
[00:18:44] ✅    ✅ Text extracted using pdfplumber (17363 chars)
[00:18:44] 🔄 
🔄 Step 2: Extracting patient data...
[00:18:47] ℹ️  AI extracted raw sex value: 'F'
[00:18:47] ℹ️  AI extracted service line: 'PT'
[00:18:47] ℹ️  AI extracted payer source: ''
[00:18:47] ℹ️  AI extracted diagnoses:
[00:18:47] ℹ️    - Diagnosis 1: 'UTI'
[00:18:47] ℹ️    - Diagnosis 2: 'Vertigo'
[00:18:47] ℹ️    - Diagnosis 3: 'Generalized weakness'
[00:18:47] ℹ️    - Diagnosis 4: 'None'
[00:18:47] ℹ️    - Diagnosis 5: 'None'
[00:18:47] ℹ️    - Diagnosis 6: 'None'
[00:18:47] ℹ️  Final extracted MRN: '101002392'
[00:18:47] ℹ️  Final extracted Sex: 'FEMALE'
[00:18:47] ℹ️  Final extracted Service Line: 'PT'
[00:18:47] ℹ️  Final extracted Payer Source: ''
[00:18:47] ✅ Patient data extraction completed successfully
[00:18:47] ✅    ✅ Patient data extracted successfully
[00:18:47] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/17/2025', 'endOfEpisode': None, 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': 'Generalized weakness', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:18:47] ✅    ✅ Patient identified: Virginia Brunton
[00:18:47] ✅    ✅ Patient name validation passed
[00:18:47] 🔄 
🔄 Step 3: Processing patient dates...
[00:18:47] [DOC: 9320626] ℹ️  DOB normalized: 06/05/1940
[00:18:47] [DOC: 9320626] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[00:18:47] [DOC: 9320626] ✅ Patient date processing completed successfully
[00:18:47] ✅    ✅ Date processing completed
[00:18:47] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/17/2025', 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': 'Generalized weakness'}]
[00:18:47] 🔄 
🔄 Step 4: Extracting order data...
[00:18:49] ℹ️  Order extraction - MRN: '101002392'
[00:18:49] ℹ️  Order extraction - Sex: 'FEMALE'
[00:18:49] ℹ️  Order extraction - Service Line: 'PT'
[00:18:49] ℹ️  Order extraction - Payer Source: ''
[00:18:49] ✅ Order data extraction completed successfully
[00:18:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:18:49] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:18:49] ℹ️  Service line consistent in both sources: 'PT'
[00:18:49] ✅ Patient name cross-validation successful
[00:18:49] ✅    ✅ Data merged successfully
[00:18:51] ⚠️     ❌ Skipping - missing episode start date
[00:18:51] [DOC: 9320626] ℹ️  API push details saved for document 9320626
================================================================================
║                        Processing Document ID: 9319086                         ║
================================================================================
[00:18:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:18:51] ℹ️  Date: 05/30/2025
[00:18:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:18:53] [DOC: 9319086] ✅ Text extracted using pdfplumber (19476 chars)
[00:18:53] ✅    ✅ Text extracted using pdfplumber (19464 chars)
[00:18:53] 🔄 
🔄 Step 2: Extracting patient data...
[00:18:57] ℹ️  AI extracted raw sex value: 'F'
[00:18:57] ℹ️  AI extracted service line: 'PT, OT'
[00:18:57] ℹ️  AI extracted payer source: 'Medicare'
[00:18:57] ℹ️  AI extracted diagnoses:
[00:18:57] ℹ️    - Diagnosis 1: 'I12.0'
[00:18:57] ℹ️    - Diagnosis 2: 'N18.5'
[00:18:57] ℹ️    - Diagnosis 3: 'D63.1'
[00:18:57] ℹ️    - Diagnosis 4: 'G25.81'
[00:18:57] ℹ️    - Diagnosis 5: 'M54.2'
[00:18:57] ℹ️    - Diagnosis 6: 'J47.9'
[00:18:57] ℹ️  Final extracted MRN: 'MA220308043601'
[00:18:57] ℹ️  Final extracted Sex: 'FEMALE'
[00:18:57] ℹ️  Final extracted Service Line: 'PT, OT'
[00:18:57] ℹ️  Final extracted Payer Source: 'Medicare'
[00:18:57] ✅ Patient data extraction completed successfully
[00:18:57] ✅    ✅ Patient data extracted successfully
[00:18:57] 📊 Patient Response
     └─ patientFName: Charlotte
     └─ patientLName: Lefrancois
     └─ dob: 04/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220308043601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033476627
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 491-6233
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/30/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18.5', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'G25.81', 'fifthDiagnosis': 'M54.2', 'sixthDiagnosis': 'J47.9'}]
[00:18:57] ✅    ✅ Patient identified: Charlotte Lefrancois
[00:18:57] ✅    ✅ Patient name validation passed
[00:18:57] 🔄 
🔄 Step 3: Processing patient dates...
[00:18:57] [DOC: 9319086] ℹ️  DOB normalized: 04/08/1936
[00:18:57] [DOC: 9319086] ℹ️  Episode startOfCare normalized: 12/30/2024
[00:18:57] [DOC: 9319086] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[00:18:57] [DOC: 9319086] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[00:18:57] [DOC: 9319086] ✅ Patient date processing completed successfully
[00:18:57] ✅    ✅ Date processing completed
[00:18:57] 📊 Processed Patient Data
     └─ patientFName: Charlotte
     └─ patientLName: Lefrancois
     └─ dob: 04/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220308043601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033476627
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 491-6233
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/30/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18.5', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'G25.81', 'fifthDiagnosis': 'M54.2', 'sixthDiagnosis': 'J47.9'}]
[00:18:57] 🔄 
🔄 Step 4: Extracting order data...
[00:19:00] ℹ️  Order extraction - MRN: 'MA220308043601'
[00:19:00] ℹ️  Order extraction - Sex: 'FEMALE'
[00:19:00] ℹ️  Order extraction - Service Line: 'PT, OT'
[00:19:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:19:00] ✅ Order data extraction completed successfully
[00:19:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:19:00] ℹ️  Using MRN from patient data: 'MA220308043601' over 'MA220308043601'
[00:19:00] ℹ️  Service line consistent in both sources: 'PT, OT'
[00:19:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:19:00] ✅ Patient name cross-validation successful
[00:19:00] ✅    ✅ Data merged successfully
[00:19:01] ✅    ✅ Order data extracted and validated
[00:19:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:19:03] [DOC: 9319086] ✅ Patient exists in API: Charlotte Lefrancois, ID: 405a83d6-c2bd-43bd-9432-42e1acecafca
[00:19:03] ✅    ✅ Existing patient found with ID: 405a83d6-c2bd-43bd-9432-42e1acecafca
[00:19:03] 🔄 
🔄 Step 6: Pushing order to API...
[00:19:03] [DOC: 9319086] ℹ️  Pushing order via API for patient ID: 405a83d6-c2bd-43bd-9432-42e1acecafca
[00:19:05] [DOC: 9319086] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18916"}
[00:19:05] ❌    ❌ Failed to push order
[00:19:05] 🔄 
🔄 Step 7: Writing to CSV...
[00:19:05] [DOC: 9319086] ℹ️  Calculated age: 89 from DOB: 04/08/1936
[00:19:05] [DOC: 9319086] ℹ️  Service Line extracted: 'PT, OT'
[00:19:05] [DOC: 9319086] ℹ️  Payer Source extracted: 'Medicare'
[00:19:05] [DOC: 9319086] ℹ️  Diagnosis codes being written:
[00:19:05] [DOC: 9319086] ℹ️    - Latest_Episode_Firstdiagnosis: 'I12.0'
[00:19:05] [DOC: 9319086] ℹ️    - Latest_Episode_Seconddiagnosis: 'N18.5'
[00:19:05] [DOC: 9319086] ℹ️    - Latest_Episode_Thirddiagnosis: 'D63.1'
[00:19:05] [DOC: 9319086] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G25.81'
[00:19:05] [DOC: 9319086] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.2'
[00:19:05] [DOC: 9319086] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J47.9'
[00:19:05] [DOC: 9319086] ✅ Patient data written to CSV: Charlotte Lefrancois | Sex: FEMALE | Age: 89 | Service: PT, OT | Payer: Medicare | MRN: MA220308043601
[00:19:05] ✅    ✅ Document 9319086 processed and saved successfully
[00:19:05] 🔄 
🔄 Step 8: Saving API details...
[00:19:05] [DOC: 9319086] ℹ️  API push details saved for document 9319086
[00:19:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317463                         ║
================================================================================
[00:19:05] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[00:19:05] ℹ️  Date: 05/29/2025
[00:19:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:19:08] [DOC: 9317463] ✅ Text extracted using pdfplumber (1390 chars)
[00:19:08] ✅    ✅ Text extracted using pdfplumber (1390 chars)
[00:19:08] 🔄 
🔄 Step 2: Extracting patient data...
[00:19:11] ℹ️  AI extracted raw sex value: 'M'
[00:19:11] ℹ️  AI extracted service line: 'HHA'
[00:19:11] ℹ️  AI extracted payer source: 'Medicaid/MA'
[00:19:11] ℹ️  AI extracted diagnoses:
[00:19:11] ℹ️    - Diagnosis 1: ''
[00:19:11] ℹ️    - Diagnosis 2: ''
[00:19:11] ℹ️    - Diagnosis 3: ''
[00:19:11] ℹ️    - Diagnosis 4: ''
[00:19:11] ℹ️    - Diagnosis 5: ''
[00:19:11] ℹ️    - Diagnosis 6: ''
[00:19:11] ℹ️  Final extracted MRN: '457'
[00:19:11] ℹ️  Final extracted Sex: 'MALE'
[00:19:11] ℹ️  Final extracted Service Line: 'HHA'
[00:19:11] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[00:19:11] ✅ Patient data extraction completed successfully
[00:19:11] ✅    ✅ Patient data extracted successfully
[00:19:11] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:19:11] ✅    ✅ Patient identified: Manuel Varela
[00:19:11] ✅    ✅ Patient name validation passed
[00:19:11] 🔄 
🔄 Step 3: Processing patient dates...
[00:19:11] [DOC: 9317463] ℹ️  DOB normalized: 02/08/1969
[00:19:11] [DOC: 9317463] ℹ️  Episode startOfCare normalized: 11/07/2024
[00:19:11] [DOC: 9317463] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[00:19:11] [DOC: 9317463] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[00:19:11] [DOC: 9317463] ✅ Patient date processing completed successfully
[00:19:11] ✅    ✅ Date processing completed
[00:19:11] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:19:11] 🔄 
🔄 Step 4: Extracting order data...
[00:19:14] ℹ️  Order extraction - MRN: '457'
[00:19:14] ℹ️  Order extraction - Sex: 'MALE'
[00:19:14] ℹ️  Order extraction - Service Line: 'HHA'
[00:19:14] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[00:19:14] ✅ Order data extraction completed successfully
[00:19:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:19:14] ℹ️  Using MRN from patient data: '457' over '457'
[00:19:14] ℹ️  Service line consistent in both sources: 'HHA'
[00:19:14] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[00:19:14] ✅ Patient name cross-validation successful
[00:19:14] ✅    ✅ Data merged successfully
[00:19:15] ✅    ✅ Order data extracted and validated
[00:19:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:19:15] [DOC: 9317463] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:19:15] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:19:15] 🔄 
🔄 Step 6: Pushing order to API...
[00:19:15] [DOC: 9317463] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:19:16] [DOC: 9317463] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14373"}
[00:19:16] ❌    ❌ Failed to push order
[00:19:16] 🔄 
🔄 Step 7: Writing to CSV...
[00:19:16] [DOC: 9317463] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[00:19:16] [DOC: 9317463] ℹ️  Service Line extracted: 'HHA'
[00:19:16] [DOC: 9317463] ℹ️  Payer Source extracted: 'Medicaid/MA'
[00:19:16] [DOC: 9317463] ℹ️  Diagnosis codes being written:
[00:19:16] [DOC: 9317463] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:19:16] [DOC: 9317463] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:19:16] [DOC: 9317463] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:19:16] [DOC: 9317463] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:19:16] [DOC: 9317463] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:19:16] [DOC: 9317463] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:19:16] [DOC: 9317463] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: HHA | Payer: Medicaid/MA | MRN: 457
[00:19:16] ✅    ✅ Document 9317463 processed and saved successfully
[00:19:16] 🔄 
🔄 Step 8: Saving API details...
[00:19:16] [DOC: 9317463] ℹ️  API push details saved for document 9317463
[00:19:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313692                         ║
================================================================================
[00:19:16] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:19:16] ℹ️  Date: 05/28/2025
[00:19:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:19:24] [DOC: 9313692] ✅ Text extracted using pdfplumber (1333 chars)
[00:19:24] ✅    ✅ Text extracted using pdfplumber (1333 chars)
[00:19:24] 🔄 
🔄 Step 2: Extracting patient data...
[00:19:27] ℹ️  AI extracted raw sex value: ''
[00:19:27] ℹ️  AI extracted service line: 'Home healthcare'
[00:19:27] ℹ️  AI extracted payer source: 'Medicare'
[00:19:27] ℹ️  AI extracted diagnoses:
[00:19:27] ℹ️    - Diagnosis 1: ''
[00:19:27] ℹ️    - Diagnosis 2: ''
[00:19:27] ℹ️    - Diagnosis 3: ''
[00:19:27] ℹ️    - Diagnosis 4: ''
[00:19:27] ℹ️    - Diagnosis 5: ''
[00:19:27] ℹ️    - Diagnosis 6: ''
[00:19:27] ℹ️  Final extracted MRN: ''
[00:19:27] ℹ️  Final extracted Sex: ''
[00:19:27] ℹ️  Final extracted Service Line: 'Home healthcare'
[00:19:27] ℹ️  Final extracted Payer Source: 'Medicare'
[00:19:27] ✅ Patient data extraction completed successfully
[00:19:27] ✅    ✅ Patient data extracted successfully
[00:19:27] 📊 Patient Response
     └─ patientFName: Terry
     └─ patientLName: Hill
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing Services
     └─ address: 125 High Street, Suite 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: jmartinez@vrnshh.com
     └─ phoneNumber: (774) 581-9986
     └─ serviceLine: Home healthcare
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:19:27] ⚠️     ❌ Insufficient patient data extracted
[00:19:27] [DOC: 9313692] ℹ️  API push details saved for document 9313692
================================================================================
║                        Processing Document ID: 9309432                         ║
================================================================================
[00:19:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:19:27] ℹ️  Date: 05/23/2025
[00:19:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:19:30] [DOC: 9309432] ✅ Text extracted using pdfplumber (3983 chars)
[00:19:30] ✅    ✅ Text extracted using pdfplumber (3983 chars)
[00:19:30] 🔄 
🔄 Step 2: Extracting patient data...
[00:19:33] ℹ️  AI extracted raw sex value: 'F'
[00:19:33] ℹ️  AI extracted service line: 'PT, OT'
[00:19:33] ℹ️  AI extracted payer source: ''
[00:19:33] ℹ️  AI extracted diagnoses:
[00:19:33] ℹ️    - Diagnosis 1: 'M16.11'
[00:19:33] ℹ️    - Diagnosis 2: 'M85.851'
[00:19:33] ℹ️    - Diagnosis 3: 'E11.9'
[00:19:33] ℹ️    - Diagnosis 4: ''
[00:19:33] ℹ️    - Diagnosis 5: ''
[00:19:33] ℹ️    - Diagnosis 6: ''
[00:19:33] ℹ️  Final extracted MRN: 'MA240802044803'
[00:19:33] ℹ️  Final extracted Sex: 'FEMALE'
[00:19:33] ℹ️  Final extracted Service Line: 'PT, OT'
[00:19:33] ℹ️  Final extracted Payer Source: ''
[00:19:33] ✅ Patient data extraction completed successfully
[00:19:33] ✅    ✅ Patient data extracted successfully
[00:19:33] 📊 Patient Response
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:19:33] ✅    ✅ Patient identified: Sheena Fonseca
[00:19:33] ✅    ✅ Patient name validation passed
[00:19:33] 🔄 
🔄 Step 3: Processing patient dates...
[00:19:33] [DOC: 9309432] ℹ️  DOB normalized: 04/23/1948
[00:19:33] [DOC: 9309432] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[00:19:33] [DOC: 9309432] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[00:19:33] [DOC: 9309432] ✅ Patient date processing completed successfully
[00:19:33] ✅    ✅ Date processing completed
[00:19:33] 📊 Processed Patient Data
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:19:33] 🔄 
🔄 Step 4: Extracting order data...
[00:19:35] ℹ️  Order extraction - MRN: 'MA240802044803'
[00:19:35] ℹ️  Order extraction - Sex: 'FEMALE'
[00:19:35] ℹ️  Order extraction - Service Line: 'PT, OT'
[00:19:35] ℹ️  Order extraction - Payer Source: ''
[00:19:35] ✅ Order data extraction completed successfully
[00:19:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:19:35] ℹ️  Using MRN from patient data: 'MA240802044803' over 'MA240802044803'
[00:19:35] ℹ️  Service line consistent in both sources: 'PT, OT'
[00:19:35] ✅ Patient name cross-validation successful
[00:19:35] ✅    ✅ Data merged successfully
[00:19:37] ✅    ✅ Order data extracted and validated
[00:19:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:19:40] [DOC: 9309432] ℹ️  Patient not found in cache or API: Sheena Fonseca
[00:19:40] [DOC: 9309432] ℹ️  Patient not found, creating new patient via API...
[00:19:40] [DOC: 9309432] ℹ️  Creating patient via API: Sheena Fonseca
[00:19:41] [DOC: 9309432] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:19:41] ❌    ❌ Failed to create patient
[00:19:41] [DOC: 9309432] ℹ️  API push details saved for document 9309432
================================================================================
║                        Processing Document ID: 9309431                         ║
================================================================================
[00:19:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:19:41] ℹ️  Date: 05/23/2025
[00:19:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:19:45] [DOC: 9309431] ✅ Text extracted using pdfplumber (13710 chars)
[00:19:45] ✅    ✅ Text extracted using pdfplumber (13710 chars)
[00:19:45] 🔄 
🔄 Step 2: Extracting patient data...
[00:19:49] ℹ️  AI extracted raw sex value: 'F'
[00:19:49] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[00:19:49] ℹ️  AI extracted payer source: 'Medicare'
[00:19:49] ℹ️  AI extracted diagnoses:
[00:19:49] ℹ️    - Diagnosis 1: 'M16.11'
[00:19:49] ℹ️    - Diagnosis 2: 'M85.851'
[00:19:49] ℹ️    - Diagnosis 3: 'E11.9'
[00:19:49] ℹ️    - Diagnosis 4: 'J45.909'
[00:19:49] ℹ️    - Diagnosis 5: 'I10'
[00:19:49] ℹ️    - Diagnosis 6: 'G43.909'
[00:19:49] ℹ️  Final extracted MRN: 'MA240802044803'
[00:19:49] ℹ️  Final extracted Sex: 'FEMALE'
[00:19:49] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[00:19:49] ℹ️  Final extracted Payer Source: 'Medicare'
[00:19:49] ✅ Patient data extraction completed successfully
[00:19:49] ✅    ✅ Patient data extracted successfully
[00:19:49] 📊 Patient Response
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 304 Crossroads Dr
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (774) 929-0930
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/27/2025', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G43.909'}]
[00:19:49] ✅    ✅ Patient identified: Sheena Fonseca
[00:19:49] ✅    ✅ Patient name validation passed
[00:19:49] 🔄 
🔄 Step 3: Processing patient dates...
[00:19:49] [DOC: 9309431] ℹ️  DOB normalized: 04/23/1948
[00:19:49] [DOC: 9309431] ℹ️  Episode startOfCare normalized: 01/27/2025
[00:19:49] [DOC: 9309431] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[00:19:49] [DOC: 9309431] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[00:19:49] [DOC: 9309431] ✅ Patient date processing completed successfully
[00:19:49] ✅    ✅ Date processing completed
[00:19:49] 📊 Processed Patient Data
     └─ patientFName: Sheena
     └─ patientLName: Fonseca
     └─ dob: 04/23/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240802044803
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 304 Crossroads Dr
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (774) 929-0930
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/27/2025', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'M16.11', 'secondDiagnosis': 'M85.851', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'J45.909', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'G43.909'}]
[00:19:49] 🔄 
🔄 Step 4: Extracting order data...
[00:19:52] ℹ️  Order extraction - MRN: 'MA240802044803'
[00:19:52] ℹ️  Order extraction - Sex: 'FEMALE'
[00:19:52] ℹ️  Order extraction - Service Line: 'PT, OT'
[00:19:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:19:52] ✅ Order data extraction completed successfully
[00:19:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:19:52] ℹ️  Using MRN from patient data: 'MA240802044803' over 'MA240802044803'
[00:19:52] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[00:19:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:19:52] ✅ Patient name cross-validation successful
[00:19:52] ✅    ✅ Data merged successfully
[00:19:53] ✅    ✅ Order data extracted and validated
[00:19:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:19:55] [DOC: 9309431] ℹ️  Patient not found in cache or API: Sheena Fonseca
[00:19:55] [DOC: 9309431] ℹ️  Patient not found, creating new patient via API...
[00:19:55] [DOC: 9309431] ℹ️  Creating patient via API: Sheena Fonseca
[00:19:57] [DOC: 9309431] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:19:57] ❌    ❌ Failed to create patient
[00:19:57] [DOC: 9309431] ℹ️  API push details saved for document 9309431
================================================================================
║                        Processing Document ID: 9309429                         ║
================================================================================
[00:19:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:19:57] ℹ️  Date: 05/23/2025
[00:19:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:20:00] [DOC: 9309429] ✅ Text extracted using pdfplumber (1164 chars)
[00:20:00] ✅    ✅ Text extracted using pdfplumber (1164 chars)
[00:20:00] 🔄 
🔄 Step 2: Extracting patient data...
[00:20:03] ℹ️  AI extracted raw sex value: ''
[00:20:03] ℹ️  AI extracted service line: 'Physical Therapy'
[00:20:03] ℹ️  AI extracted payer source: ''
[00:20:03] ℹ️  AI extracted diagnoses:
[00:20:03] ℹ️    - Diagnosis 1: 'N30.00'
[00:20:03] ℹ️    - Diagnosis 2: 'E11.9'
[00:20:03] ℹ️    - Diagnosis 3: 'F41.1'
[00:20:03] ℹ️    - Diagnosis 4: 'None'
[00:20:03] ℹ️    - Diagnosis 5: 'None'
[00:20:03] ℹ️    - Diagnosis 6: 'None'
[00:20:03] ℹ️  Final extracted MRN: '101002392'
[00:20:03] ℹ️  Final extracted Sex: ''
[00:20:03] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:20:03] ℹ️  Final extracted Payer Source: ''
[00:20:03] ✅ Patient data extraction completed successfully
[00:20:03] ✅    ✅ Patient data extracted successfully
[00:20:03] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:20:03] ✅    ✅ Patient identified: Virginia Brunton
[00:20:03] ✅    ✅ Patient name validation passed
[00:20:03] 🔄 
🔄 Step 3: Processing patient dates...
[00:20:03] [DOC: 9309429] ℹ️  DOB normalized: 06/05/1940
[00:20:03] [DOC: 9309429] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:20:03] [DOC: 9309429] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:20:03] [DOC: 9309429] ✅ Patient date processing completed successfully
[00:20:03] ✅    ✅ Date processing completed
[00:20:03] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[00:20:03] 🔄 
🔄 Step 4: Extracting order data...
[00:20:06] ℹ️  Order extraction - MRN: '101002392'
[00:20:06] ℹ️  Order extraction - Sex: ''
[00:20:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:20:06] ℹ️  Order extraction - Payer Source: ''
[00:20:06] ✅ Order data extraction completed successfully
[00:20:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:20:06] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:20:06] ℹ️  Inferred sex as FEMALE from name: Virginia
[00:20:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:20:06] ✅ Patient name cross-validation successful
[00:20:06] ✅    ✅ Data merged successfully
[00:20:07] ✅    ✅ Order data extracted and validated
[00:20:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:20:07] [DOC: 9309429] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:07] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:20:07] [DOC: 9309429] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:09] [DOC: 9309429] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13405"}
[00:20:09] ❌    ❌ Failed to push order
[00:20:09] 🔄 
🔄 Step 7: Writing to CSV...
[00:20:09] [DOC: 9309429] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:20:09] [DOC: 9309429] ℹ️  Service Line extracted: 'Physical Therapy'
[00:20:09] [DOC: 9309429] ℹ️  Payer Source extracted: ''
[00:20:09] [DOC: 9309429] ℹ️  Diagnosis codes being written:
[00:20:09] [DOC: 9309429] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:20:09] [DOC: 9309429] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:20:09] [DOC: 9309429] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:20:09] [DOC: 9309429] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:20:09] [DOC: 9309429] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:20:09] [DOC: 9309429] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:20:09] [DOC: 9309429] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Physical Therapy | Payer:  | MRN: 101002392
[00:20:09] ✅    ✅ Document 9309429 processed and saved successfully
[00:20:09] 🔄 
🔄 Step 8: Saving API details...
[00:20:09] [DOC: 9309429] ℹ️  API push details saved for document 9309429
[00:20:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309428                         ║
================================================================================
[00:20:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:20:09] ℹ️  Date: 05/23/2025
[00:20:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:20:11] [DOC: 9309428] ✅ Text extracted using pdfplumber (1446 chars)
[00:20:11] ✅    ✅ Text extracted using pdfplumber (1446 chars)
[00:20:11] 🔄 
🔄 Step 2: Extracting patient data...
[00:20:13] ℹ️  AI extracted raw sex value: ''
[00:20:13] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:20:13] ℹ️  AI extracted payer source: ''
[00:20:13] ℹ️  AI extracted diagnoses:
[00:20:13] ℹ️    - Diagnosis 1: 'N30.00'
[00:20:13] ℹ️    - Diagnosis 2: 'E11.9'
[00:20:13] ℹ️    - Diagnosis 3: 'F41.1'
[00:20:13] ℹ️    - Diagnosis 4: ''
[00:20:13] ℹ️    - Diagnosis 5: ''
[00:20:13] ℹ️    - Diagnosis 6: ''
[00:20:13] ℹ️  Final extracted MRN: '101002392'
[00:20:13] ℹ️  Final extracted Sex: ''
[00:20:13] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:20:13] ℹ️  Final extracted Payer Source: ''
[00:20:13] ✅ Patient data extraction completed successfully
[00:20:13] ✅    ✅ Patient data extracted successfully
[00:20:13] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:20:13] ✅    ✅ Patient identified: Virginia Brunton
[00:20:13] ✅    ✅ Patient name validation passed
[00:20:13] 🔄 
🔄 Step 3: Processing patient dates...
[00:20:13] [DOC: 9309428] ℹ️  DOB normalized: 06/05/1940
[00:20:13] [DOC: 9309428] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:20:13] [DOC: 9309428] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:20:13] [DOC: 9309428] ✅ Patient date processing completed successfully
[00:20:13] ✅    ✅ Date processing completed
[00:20:13] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:20:13] 🔄 
🔄 Step 4: Extracting order data...
[00:20:16] ℹ️  Order extraction - MRN: '101002392'
[00:20:16] ℹ️  Order extraction - Sex: ''
[00:20:16] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:20:16] ℹ️  Order extraction - Payer Source: ''
[00:20:16] ✅ Order data extraction completed successfully
[00:20:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:20:16] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:20:16] ℹ️  Inferred sex as FEMALE from name: Virginia
[00:20:16] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:20:16] ✅ Patient name cross-validation successful
[00:20:16] ✅    ✅ Data merged successfully
[00:20:17] ✅    ✅ Order data extracted and validated
[00:20:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:20:17] [DOC: 9309428] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:17] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:17] 🔄 
🔄 Step 6: Pushing order to API...
[00:20:17] [DOC: 9309428] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:19] [DOC: 9309428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13406"}
[00:20:19] ❌    ❌ Failed to push order
[00:20:19] 🔄 
🔄 Step 7: Writing to CSV...
[00:20:19] [DOC: 9309428] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:20:19] [DOC: 9309428] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:20:19] [DOC: 9309428] ℹ️  Payer Source extracted: ''
[00:20:19] [DOC: 9309428] ℹ️  Diagnosis codes being written:
[00:20:19] [DOC: 9309428] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:20:19] [DOC: 9309428] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:20:19] [DOC: 9309428] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:20:19] [DOC: 9309428] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:20:19] [DOC: 9309428] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:20:19] [DOC: 9309428] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:20:19] [DOC: 9309428] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Occupational Therapy | Payer:  | MRN: 101002392
[00:20:19] ✅    ✅ Document 9309428 processed and saved successfully
[00:20:19] 🔄 
🔄 Step 8: Saving API details...
[00:20:19] [DOC: 9309428] ℹ️  API push details saved for document 9309428
[00:20:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9309425                         ║
================================================================================
[00:20:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:20:19] ℹ️  Date: 05/23/2025
[00:20:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:20:28] [DOC: 9309425] ✅ Text extracted using pdfplumber (11322 chars)
[00:20:28] ✅    ✅ Text extracted using pdfplumber (11322 chars)
[00:20:28] 🔄 
🔄 Step 2: Extracting patient data...
[00:20:31] ℹ️  AI extracted raw sex value: 'F'
[00:20:31] ℹ️  AI extracted service line: 'OT'
[00:20:31] ℹ️  AI extracted payer source: 'None'
[00:20:31] ℹ️  AI extracted diagnoses:
[00:20:31] ℹ️    - Diagnosis 1: 'None'
[00:20:31] ℹ️    - Diagnosis 2: 'None'
[00:20:31] ℹ️    - Diagnosis 3: 'None'
[00:20:31] ℹ️    - Diagnosis 4: 'None'
[00:20:31] ℹ️    - Diagnosis 5: 'None'
[00:20:31] ℹ️    - Diagnosis 6: 'None'
[00:20:31] ℹ️  Final extracted MRN: '101002392'
[00:20:31] ℹ️  Final extracted Sex: 'FEMALE'
[00:20:31] ℹ️  Final extracted Service Line: 'OT'
[00:20:31] ℹ️  Final extracted Payer Source: ''
[00:20:31] ✅ Patient data extraction completed successfully
[00:20:31] ✅    ✅ Patient data extracted successfully
[00:20:31] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:20:31] ✅    ✅ Patient identified: Virginia Brunton
[00:20:31] ✅    ✅ Patient name validation passed
[00:20:31] 🔄 
🔄 Step 3: Processing patient dates...
[00:20:31] [DOC: 9309425] ℹ️  DOB normalized: 06/05/1940
[00:20:31] [DOC: 9309425] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[00:20:31] [DOC: 9309425] ✅ Patient date processing completed successfully
[00:20:31] ✅    ✅ Date processing completed
[00:20:31] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025'}]
[00:20:31] 🔄 
🔄 Step 4: Extracting order data...
[00:20:34] ℹ️  Order extraction - MRN: '101002392'
[00:20:34] ℹ️  Order extraction - Sex: 'FEMALE'
[00:20:34] ℹ️  Order extraction - Service Line: 'OT'
[00:20:34] ℹ️  Order extraction - Payer Source: ''
[00:20:34] ✅ Order data extraction completed successfully
[00:20:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:20:34] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:20:34] ℹ️  Service line consistent in both sources: 'OT'
[00:20:34] ✅ Patient name cross-validation successful
[00:20:34] ✅    ✅ Data merged successfully
[00:20:35] ✅    ✅ Order data extracted and validated
[00:20:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:20:35] [DOC: 9309425] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:35] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:35] 🔄 
🔄 Step 6: Pushing order to API...
[00:20:35] [DOC: 9309425] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:20:36] [DOC: 9309425] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:20:36] ❌    ❌ Failed to push order
[00:20:36] 🔄 
🔄 Step 7: Writing to CSV...
[00:20:36] [DOC: 9309425] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:20:36] [DOC: 9309425] ℹ️  Service Line extracted: 'OT'
[00:20:36] [DOC: 9309425] ℹ️  Payer Source extracted: ''
[00:20:36] [DOC: 9309425] ℹ️  Diagnosis codes being written:
[00:20:36] [DOC: 9309425] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:20:36] [DOC: 9309425] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:20:36] [DOC: 9309425] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:20:36] [DOC: 9309425] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:20:36] [DOC: 9309425] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:20:36] [DOC: 9309425] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:20:36] [DOC: 9309425] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: OT | Payer:  | MRN: 101002392
[00:20:36] ✅    ✅ Document 9309425 processed and saved successfully
[00:20:36] 🔄 
🔄 Step 8: Saving API details...
[00:20:36] [DOC: 9309425] ℹ️  API push details saved for document 9309425
[00:20:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9308962                         ║
================================================================================
[00:20:36] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:20:36] ℹ️  Date: 05/23/2025
[00:20:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:20:39] [DOC: 9308962] ✅ Text extracted using pdfplumber (5005 chars)
[00:20:39] ✅    ✅ Text extracted using pdfplumber (5005 chars)
[00:20:39] 🔄 
🔄 Step 2: Extracting patient data...
[00:20:41] ℹ️  AI extracted raw sex value: 'None'
[00:20:41] ℹ️  AI extracted service line: 'None'
[00:20:41] ℹ️  AI extracted payer source: 'None'
[00:20:41] ℹ️  AI extracted diagnoses:
[00:20:41] ℹ️    - Diagnosis 1: ''
[00:20:41] ℹ️    - Diagnosis 2: ''
[00:20:41] ℹ️    - Diagnosis 3: ''
[00:20:41] ℹ️    - Diagnosis 4: ''
[00:20:41] ℹ️    - Diagnosis 5: ''
[00:20:41] ℹ️    - Diagnosis 6: ''
[00:20:41] ℹ️  Final extracted MRN: ''
[00:20:41] ℹ️  Final extracted Sex: ''
[00:20:41] ℹ️  Final extracted Service Line: ''
[00:20:41] ℹ️  Final extracted Payer Source: ''
[00:20:41] ✅ Patient data extraction completed successfully
[00:20:41] ✅    ✅ Patient data extracted successfully
[00:20:41] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[00:20:41] ⚠️     ❌ Insufficient patient data extracted
[00:20:41] [DOC: 9308962] ℹ️  API push details saved for document 9308962
================================================================================
║                        Processing Document ID: 9307426                         ║
================================================================================
[00:20:41] ℹ️  Agency: Dartmouth HH
[00:20:41] ℹ️  Date: 05/22/2025
[00:20:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:20:43] [DOC: 9307426] ✅ Text extracted using pdfplumber (1022 chars)
[00:20:43] ✅    ✅ Text extracted using pdfplumber (1022 chars)
[00:20:43] 🔄 
🔄 Step 2: Extracting patient data...
[00:20:46] ℹ️  AI extracted raw sex value: 'F'
[00:20:46] ℹ️  AI extracted service line: 'HHA'
[00:20:46] ℹ️  AI extracted payer source: 'Medicare'
[00:20:46] ℹ️  AI extracted diagnoses:
[00:20:46] ℹ️    - Diagnosis 1: ''
[00:20:46] ℹ️    - Diagnosis 2: ''
[00:20:46] ℹ️    - Diagnosis 3: ''
[00:20:46] ℹ️    - Diagnosis 4: ''
[00:20:46] ℹ️    - Diagnosis 5: ''
[00:20:46] ℹ️    - Diagnosis 6: ''
[00:20:46] ℹ️  Final extracted MRN: '323014'
[00:20:46] ℹ️  Final extracted Sex: 'FEMALE'
[00:20:46] ℹ️  Final extracted Service Line: 'HHA'
[00:20:46] ℹ️  Final extracted Payer Source: 'Medicare'
[00:20:46] ✅ Patient data extraction completed successfully
[00:20:46] ✅    ✅ Patient data extracted successfully
[00:20:46] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:20:46] ✅    ✅ Patient identified: Sandra Plissey
[00:20:46] ✅    ✅ Patient name validation passed
[00:20:46] 🔄 
🔄 Step 3: Processing patient dates...
[00:20:46] [DOC: 9307426] ℹ️  DOB normalized: 11/19/1943
[00:20:46] [DOC: 9307426] ℹ️  Episode startOfCare normalized: 10/07/2024
[00:20:46] [DOC: 9307426] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[00:20:46] [DOC: 9307426] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[00:20:46] [DOC: 9307426] ✅ Patient date processing completed successfully
[00:20:46] ✅    ✅ Date processing completed
[00:20:46] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:20:46] 🔄 
🔄 Step 4: Extracting order data...
[00:20:48] ℹ️  Order extraction - MRN: ''
[00:20:48] ℹ️  Order extraction - Sex: 'FEMALE'
[00:20:48] ℹ️  Order extraction - Service Line: ''
[00:20:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:20:48] ✅ Order data extraction completed successfully
[00:20:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:20:48] ℹ️  Using MRN from patient data: '323014'
[00:20:48] ℹ️  Using service line from patient data: 'HHA'
[00:20:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:20:48] ✅ Patient name cross-validation successful
[00:20:48] ✅    ✅ Data merged successfully
[00:20:50] ✅    ✅ Order data extracted and validated
[00:20:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:20:50] [DOC: 9307426] ✅ Patient found in local cache: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:20:50] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:20:50] 🔄 
🔄 Step 6: Pushing order to API...
[00:20:50] [DOC: 9307426] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:20:51] [DOC: 9307426] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13081"}
[00:20:51] ❌    ❌ Failed to push order
[00:20:51] 🔄 
🔄 Step 7: Writing to CSV...
[00:20:51] [DOC: 9307426] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[00:20:51] [DOC: 9307426] ℹ️  Service Line extracted: 'HHA'
[00:20:51] [DOC: 9307426] ℹ️  Payer Source extracted: 'Medicare'
[00:20:51] [DOC: 9307426] ℹ️  Diagnosis codes being written:
[00:20:51] [DOC: 9307426] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:20:51] [DOC: 9307426] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:20:51] [DOC: 9307426] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:20:51] [DOC: 9307426] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:20:51] [DOC: 9307426] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:20:51] [DOC: 9307426] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:20:51] [DOC: 9307426] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: HHA | Payer: Medicare | MRN: 323014
[00:20:51] ✅    ✅ Document 9307426 processed and saved successfully
[00:20:51] 🔄 
🔄 Step 8: Saving API details...
[00:20:51] [DOC: 9307426] ℹ️  API push details saved for document 9307426
[00:20:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9307422                         ║
================================================================================
[00:20:51] ℹ️  Agency: Dartmouth HH
[00:20:51] ℹ️  Date: 05/22/2025
[00:20:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:20:53] [DOC: 9307422] ✅ Text extracted using pdfplumber (9561 chars)
[00:20:53] ✅    ✅ Text extracted using pdfplumber (9561 chars)
[00:20:53] 🔄 
🔄 Step 2: Extracting patient data...
[00:20:56] ℹ️  AI extracted raw sex value: 'F'
[00:20:56] ℹ️  AI extracted service line: 'OT'
[00:20:56] ℹ️  AI extracted payer source: 'Medicare'
[00:20:56] ℹ️  AI extracted diagnoses:
[00:20:56] ℹ️    - Diagnosis 1: ''
[00:20:56] ℹ️    - Diagnosis 2: ''
[00:20:56] ℹ️    - Diagnosis 3: ''
[00:20:56] ℹ️    - Diagnosis 4: ''
[00:20:56] ℹ️    - Diagnosis 5: ''
[00:20:56] ℹ️    - Diagnosis 6: ''
[00:20:56] ℹ️  Final extracted MRN: '3134011'
[00:20:56] ℹ️  Final extracted Sex: 'FEMALE'
[00:20:56] ℹ️  Final extracted Service Line: 'OT'
[00:20:56] ℹ️  Final extracted Payer Source: 'Medicare'
[00:20:56] ✅ Patient data extraction completed successfully
[00:20:56] ✅    ✅ Patient data extracted successfully
[00:20:56] 📊 Patient Response
     └─ patientFName: Florence
     └─ patientLName: Dugal
     └─ dob: 06/25/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3134011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:20:56] ✅    ✅ Patient identified: Florence Dugal
[00:20:56] ✅    ✅ Patient name validation passed
[00:20:56] 🔄 
🔄 Step 3: Processing patient dates...
[00:20:56] [DOC: 9307422] ℹ️  DOB normalized: 06/25/1930
[00:20:56] [DOC: 9307422] ℹ️  Episode startOfCare normalized: 05/07/2025
[00:20:56] [DOC: 9307422] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[00:20:56] [DOC: 9307422] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[00:20:56] [DOC: 9307422] ✅ Patient date processing completed successfully
[00:20:56] ✅    ✅ Date processing completed
[00:20:56] 📊 Processed Patient Data
     └─ patientFName: Florence
     └─ patientLName: Dugal
     └─ dob: 06/25/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3134011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:20:56] 🔄 
🔄 Step 4: Extracting order data...
[00:20:59] ℹ️  Order extraction - MRN: ''
[00:20:59] ℹ️  Order extraction - Sex: 'FEMALE'
[00:20:59] ℹ️  Order extraction - Service Line: 'OT'
[00:20:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:20:59] ✅ Order data extraction completed successfully
[00:20:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:20:59] ℹ️  Using MRN from patient data: '3134011'
[00:20:59] ℹ️  Service line consistent in both sources: 'OT'
[00:20:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:20:59] ✅ Patient name cross-validation successful
[00:20:59] ✅    ✅ Data merged successfully
[00:21:00] ✅    ✅ Order data extracted and validated
[00:21:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:21:00] [DOC: 9307422] ✅ Patient found in local cache: Florence Dugal, ID: 66fbf2e7-4547-48c7-90af-626ad2b8f076
[00:21:00] ✅    ✅ Existing patient found with ID: 66fbf2e7-4547-48c7-90af-626ad2b8f076
[00:21:00] 🔄 
🔄 Step 6: Pushing order to API...
[00:21:00] [DOC: 9307422] ℹ️  Pushing order via API for patient ID: 66fbf2e7-4547-48c7-90af-626ad2b8f076
[00:21:01] [DOC: 9307422] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:21:01] ❌    ❌ Failed to push order
[00:21:01] 🔄 
🔄 Step 7: Writing to CSV...
[00:21:01] [DOC: 9307422] ℹ️  Calculated age: 94 from DOB: 06/25/1930
[00:21:01] [DOC: 9307422] ℹ️  Service Line extracted: 'OT'
[00:21:01] [DOC: 9307422] ℹ️  Payer Source extracted: 'Medicare'
[00:21:01] [DOC: 9307422] ℹ️  Diagnosis codes being written:
[00:21:01] [DOC: 9307422] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:21:01] [DOC: 9307422] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:21:01] [DOC: 9307422] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:21:01] [DOC: 9307422] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:21:01] [DOC: 9307422] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:21:01] [DOC: 9307422] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:21:01] [DOC: 9307422] ✅ Patient data written to CSV: Florence Dugal | Sex: FEMALE | Age: 94 | Service: OT | Payer: Medicare | MRN: 3134011
[00:21:01] ✅    ✅ Document 9307422 processed and saved successfully
[00:21:01] 🔄 
🔄 Step 8: Saving API details...
[00:21:01] [DOC: 9307422] ℹ️  API push details saved for document 9307422
[00:21:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9306803                         ║
================================================================================
[00:21:01] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[00:21:01] ℹ️  Date: 05/22/2025
[00:21:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:21:04] [DOC: 9306803] ✅ Text extracted using pdfplumber (1643 chars)
[00:21:04] ✅    ✅ Text extracted using pdfplumber (1643 chars)
[00:21:04] 🔄 
🔄 Step 2: Extracting patient data...
[00:21:07] ℹ️  AI extracted raw sex value: 'M'
[00:21:07] ℹ️  AI extracted service line: 'HHA'
[00:21:07] ℹ️  AI extracted payer source: 'Medicaid/MA'
[00:21:07] ℹ️  AI extracted diagnoses:
[00:21:07] ℹ️    - Diagnosis 1: ''
[00:21:07] ℹ️    - Diagnosis 2: ''
[00:21:07] ℹ️    - Diagnosis 3: ''
[00:21:07] ℹ️    - Diagnosis 4: ''
[00:21:07] ℹ️    - Diagnosis 5: ''
[00:21:07] ℹ️    - Diagnosis 6: ''
[00:21:07] ℹ️  Final extracted MRN: '457'
[00:21:07] ℹ️  Final extracted Sex: 'MALE'
[00:21:07] ℹ️  Final extracted Service Line: 'HHA'
[00:21:07] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[00:21:07] ✅ Patient data extraction completed successfully
[00:21:07] ✅    ✅ Patient data extracted successfully
[00:21:07] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1982632006
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:07] ✅    ✅ Patient identified: Manuel Varela
[00:21:07] ✅    ✅ Patient name validation passed
[00:21:07] 🔄 
🔄 Step 3: Processing patient dates...
[00:21:07] [DOC: 9306803] ℹ️  DOB normalized: 02/08/1969
[00:21:07] [DOC: 9306803] ℹ️  Episode startOfCare normalized: 11/07/2024
[00:21:07] [DOC: 9306803] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[00:21:07] [DOC: 9306803] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[00:21:07] [DOC: 9306803] ✅ Patient date processing completed successfully
[00:21:07] ✅    ✅ Date processing completed
[00:21:07] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1982632006
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:07] 🔄 
🔄 Step 4: Extracting order data...
[00:21:10] ℹ️  Order extraction - MRN: '457'
[00:21:10] ℹ️  Order extraction - Sex: 'MALE'
[00:21:10] ℹ️  Order extraction - Service Line: 'HHA'
[00:21:10] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[00:21:10] ✅ Order data extraction completed successfully
[00:21:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:21:10] ℹ️  Using MRN from patient data: '457' over '457'
[00:21:10] ℹ️  Service line consistent in both sources: 'HHA'
[00:21:10] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[00:21:10] ✅ Patient name cross-validation successful
[00:21:10] ✅    ✅ Data merged successfully
[00:21:11] ✅    ✅ Order data extracted and validated
[00:21:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:21:11] [DOC: 9306803] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:21:11] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:21:11] 🔄 
🔄 Step 6: Pushing order to API...
[00:21:11] [DOC: 9306803] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:21:12] [DOC: 9306803] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:21:12] ❌    ❌ Failed to push order
[00:21:12] 🔄 
🔄 Step 7: Writing to CSV...
[00:21:12] [DOC: 9306803] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[00:21:12] [DOC: 9306803] ℹ️  Service Line extracted: 'HHA'
[00:21:12] [DOC: 9306803] ℹ️  Payer Source extracted: 'Medicaid/MA'
[00:21:12] [DOC: 9306803] ℹ️  Diagnosis codes being written:
[00:21:12] [DOC: 9306803] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:21:12] [DOC: 9306803] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:21:12] [DOC: 9306803] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:21:12] [DOC: 9306803] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:21:12] [DOC: 9306803] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:21:12] [DOC: 9306803] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:21:12] [DOC: 9306803] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: HHA | Payer: Medicaid/MA | MRN: 457
[00:21:12] ✅    ✅ Document 9306803 processed and saved successfully
[00:21:12] 🔄 
🔄 Step 8: Saving API details...
[00:21:12] [DOC: 9306803] ℹ️  API push details saved for document 9306803
[00:21:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305816                         ║
================================================================================
[00:21:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:21:12] ℹ️  Date: 05/21/2025
[00:21:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:21:14] [DOC: 9305816] ✅ Text extracted using pdfplumber (1582 chars)
[00:21:14] ✅    ✅ Text extracted using pdfplumber (1570 chars)
[00:21:14] 🔄 
🔄 Step 2: Extracting patient data...
[00:21:17] ℹ️  AI extracted raw sex value: ''
[00:21:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:21:17] ℹ️  AI extracted payer source: ''
[00:21:17] ℹ️  AI extracted diagnoses:
[00:21:17] ℹ️    - Diagnosis 1: 'F20.9'
[00:21:17] ℹ️    - Diagnosis 2: 'E11.69'
[00:21:17] ℹ️    - Diagnosis 3: 'I10'
[00:21:17] ℹ️    - Diagnosis 4: ''
[00:21:17] ℹ️    - Diagnosis 5: ''
[00:21:17] ℹ️    - Diagnosis 6: ''
[00:21:17] ℹ️  Final extracted MRN: 'MA210924045601'
[00:21:17] ℹ️  Final extracted Sex: ''
[00:21:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:21:17] ℹ️  Final extracted Payer Source: ''
[00:21:17] ✅ Patient data extraction completed successfully
[00:21:17] ✅    ✅ Patient data extracted successfully
[00:21:17] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:17] ✅    ✅ Patient identified: Richard Rocheleau
[00:21:17] ✅    ✅ Patient name validation passed
[00:21:17] 🔄 
🔄 Step 3: Processing patient dates...
[00:21:17] [DOC: 9305816] ℹ️  DOB normalized: 04/08/1956
[00:21:17] [DOC: 9305816] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[00:21:17] [DOC: 9305816] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[00:21:17] [DOC: 9305816] ✅ Patient date processing completed successfully
[00:21:17] ✅    ✅ Date processing completed
[00:21:17] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:17] 🔄 
🔄 Step 4: Extracting order data...
[00:21:20] ℹ️  Order extraction - MRN: 'MA210924045601'
[00:21:20] ℹ️  Order extraction - Sex: ''
[00:21:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:21:20] ℹ️  Order extraction - Payer Source: ''
[00:21:20] ✅ Order data extraction completed successfully
[00:21:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:21:20] ℹ️  Using MRN from patient data: 'MA210924045601' over 'MA210924045601'
[00:21:20] ℹ️  Inferred sex as MALE from name: Richard
[00:21:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:21:20] ✅ Patient name cross-validation successful
[00:21:20] ✅    ✅ Data merged successfully
[00:21:21] ✅    ✅ Order data extracted and validated
[00:21:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:21:21] [DOC: 9305816] ✅ Patient found in local cache: Richard Rocheleau, ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[00:21:21] ✅    ✅ Existing patient found with ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[00:21:21] 🔄 
🔄 Step 6: Pushing order to API...
[00:21:21] [DOC: 9305816] ℹ️  Pushing order via API for patient ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[00:21:22] [DOC: 9305816] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19032"}
[00:21:22] ❌    ❌ Failed to push order
[00:21:22] 🔄 
🔄 Step 7: Writing to CSV...
[00:21:22] [DOC: 9305816] ℹ️  Calculated age: 69 from DOB: 04/08/1956
[00:21:22] [DOC: 9305816] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:21:22] [DOC: 9305816] ℹ️  Payer Source extracted: ''
[00:21:22] [DOC: 9305816] ℹ️  Diagnosis codes being written:
[00:21:22] [DOC: 9305816] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[00:21:22] [DOC: 9305816] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.69'
[00:21:22] [DOC: 9305816] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:21:22] [DOC: 9305816] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:21:22] [DOC: 9305816] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:21:22] [DOC: 9305816] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:21:22] [DOC: 9305816] ✅ Patient data written to CSV: Richard Rocheleau | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer:  | MRN: MA210924045601
[00:21:22] ✅    ✅ Document 9305816 processed and saved successfully
[00:21:22] 🔄 
🔄 Step 8: Saving API details...
[00:21:22] [DOC: 9305816] ℹ️  API push details saved for document 9305816
[00:21:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305814                         ║
================================================================================
[00:21:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:21:22] ℹ️  Date: 05/21/2025
[00:21:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:21:28] [DOC: 9305814] ✅ Text extracted using pdfplumber (13443 chars)
[00:21:28] ✅    ✅ Text extracted using pdfplumber (13443 chars)
[00:21:28] 🔄 
🔄 Step 2: Extracting patient data...
[00:21:31] ℹ️  AI extracted raw sex value: 'F'
[00:21:31] ℹ️  AI extracted service line: 'OT'
[00:21:31] ℹ️  AI extracted payer source: ''
[00:21:31] ℹ️  AI extracted diagnoses:
[00:21:31] ℹ️    - Diagnosis 1: 'vertigo'
[00:21:31] ℹ️    - Diagnosis 2: 'muscle weakness'
[00:21:31] ℹ️    - Diagnosis 3: ''
[00:21:31] ℹ️    - Diagnosis 4: ''
[00:21:31] ℹ️    - Diagnosis 5: ''
[00:21:31] ℹ️    - Diagnosis 6: ''
[00:21:31] ℹ️  Final extracted MRN: '101002392'
[00:21:31] ℹ️  Final extracted Sex: 'FEMALE'
[00:21:31] ℹ️  Final extracted Service Line: 'OT'
[00:21:31] ℹ️  Final extracted Payer Source: ''
[00:21:31] ✅ Patient data extraction completed successfully
[00:21:31] ✅    ✅ Patient data extracted successfully
[00:21:31] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:31] ✅    ✅ Patient identified: Virginia Brunton
[00:21:31] ✅    ✅ Patient name validation passed
[00:21:31] 🔄 
🔄 Step 3: Processing patient dates...
[00:21:31] [DOC: 9305814] ℹ️  DOB normalized: 06/05/1940
[00:21:31] [DOC: 9305814] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[00:21:31] [DOC: 9305814] ✅ Patient date processing completed successfully
[00:21:31] ✅    ✅ Date processing completed
[00:21:31] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:31] 🔄 
🔄 Step 4: Extracting order data...
[00:21:34] ℹ️  Order extraction - MRN: '101002392'
[00:21:34] ℹ️  Order extraction - Sex: 'FEMALE'
[00:21:34] ℹ️  Order extraction - Service Line: 'OT'
[00:21:34] ℹ️  Order extraction - Payer Source: ''
[00:21:34] ✅ Order data extraction completed successfully
[00:21:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:21:34] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:21:34] ℹ️  Service line consistent in both sources: 'OT'
[00:21:34] ✅ Patient name cross-validation successful
[00:21:34] ✅    ✅ Data merged successfully
[00:21:35] ✅    ✅ Order data extracted and validated
[00:21:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:21:35] [DOC: 9305814] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:21:35] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:21:35] 🔄 
🔄 Step 6: Pushing order to API...
[00:21:35] [DOC: 9305814] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:21:36] [DOC: 9305814] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:21:36] ❌    ❌ Failed to push order
[00:21:36] 🔄 
🔄 Step 7: Writing to CSV...
[00:21:36] [DOC: 9305814] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:21:36] [DOC: 9305814] ℹ️  Service Line extracted: 'OT'
[00:21:36] [DOC: 9305814] ℹ️  Payer Source extracted: ''
[00:21:36] [DOC: 9305814] ℹ️  Diagnosis codes being written:
[00:21:36] [DOC: 9305814] ℹ️    - Latest_Episode_Firstdiagnosis: 'vertigo'
[00:21:36] [DOC: 9305814] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[00:21:36] [DOC: 9305814] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:21:36] [DOC: 9305814] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:21:36] [DOC: 9305814] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:21:36] [DOC: 9305814] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:21:36] [DOC: 9305814] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: OT | Payer:  | MRN: 101002392
[00:21:36] ✅    ✅ Document 9305814 processed and saved successfully
[00:21:36] 🔄 
🔄 Step 8: Saving API details...
[00:21:36] [DOC: 9305814] ℹ️  API push details saved for document 9305814
[00:21:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9305809                         ║
================================================================================
[00:21:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:21:36] ℹ️  Date: 05/21/2025
[00:21:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:21:41] [DOC: 9305809] ✅ Text extracted using pdfplumber (18552 chars)
[00:21:41] ✅    ✅ Text extracted using pdfplumber (18552 chars)
[00:21:41] 🔄 
🔄 Step 2: Extracting patient data...
[00:21:44] ℹ️  AI extracted raw sex value: 'M'
[00:21:44] ℹ️  AI extracted service line: 'OT'
[00:21:44] ℹ️  AI extracted payer source: 'None'
[00:21:44] ℹ️  AI extracted diagnoses:
[00:21:44] ℹ️    - Diagnosis 1: 'constipation'
[00:21:44] ℹ️    - Diagnosis 2: 'failure to thrive'
[00:21:44] ℹ️    - Diagnosis 3: 'None'
[00:21:44] ℹ️    - Diagnosis 4: 'None'
[00:21:44] ℹ️    - Diagnosis 5: 'None'
[00:21:44] ℹ️    - Diagnosis 6: 'None'
[00:21:44] ℹ️  Final extracted MRN: 'MA241126016807'
[00:21:44] ℹ️  Final extracted Sex: 'MALE'
[00:21:44] ℹ️  Final extracted Service Line: 'OT'
[00:21:44] ℹ️  Final extracted Payer Source: ''
[00:21:44] ✅ Patient data extraction completed successfully
[00:21:44] ✅    ✅ Patient data extracted successfully
[00:21:44] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/10/2025', 'endOfEpisode': None, 'firstDiagnosis': 'constipation', 'secondDiagnosis': 'failure to thrive', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:21:44] ✅    ✅ Patient identified: Frank Ferreira
[00:21:44] ✅    ✅ Patient name validation passed
[00:21:44] 🔄 
🔄 Step 3: Processing patient dates...
[00:21:44] [DOC: 9305809] ℹ️  DOB normalized: 01/07/1968
[00:21:44] [DOC: 9305809] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[00:21:44] [DOC: 9305809] ✅ Patient date processing completed successfully
[00:21:44] ✅    ✅ Date processing completed
[00:21:44] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'firstDiagnosis': 'constipation', 'secondDiagnosis': 'failure to thrive'}]
[00:21:44] 🔄 
🔄 Step 4: Extracting order data...
[00:21:48] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:21:48] ℹ️  Order extraction - Sex: 'MALE'
[00:21:48] ℹ️  Order extraction - Service Line: 'OT'
[00:21:48] ℹ️  Order extraction - Payer Source: ''
[00:21:48] ✅ Order data extraction completed successfully
[00:21:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:21:48] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:21:48] ℹ️  Service line consistent in both sources: 'OT'
[00:21:48] ✅ Patient name cross-validation successful
[00:21:48] ✅    ✅ Data merged successfully
[00:21:49] ✅    ✅ Order data extracted and validated
[00:21:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:21:51] [DOC: 9305809] ✅ Patient exists in API: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:21:51] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:21:51] 🔄 
🔄 Step 6: Pushing order to API...
[00:21:51] [DOC: 9305809] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:21:52] [DOC: 9305809] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:21:52] ❌    ❌ Failed to push order
[00:21:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:21:52] [DOC: 9305809] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:21:52] [DOC: 9305809] ℹ️  Service Line extracted: 'OT'
[00:21:52] [DOC: 9305809] ℹ️  Payer Source extracted: ''
[00:21:52] [DOC: 9305809] ℹ️  Diagnosis codes being written:
[00:21:52] [DOC: 9305809] ℹ️    - Latest_Episode_Firstdiagnosis: 'constipation'
[00:21:52] [DOC: 9305809] ℹ️    - Latest_Episode_Seconddiagnosis: 'failure to thrive'
[00:21:52] [DOC: 9305809] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:21:52] [DOC: 9305809] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:21:52] [DOC: 9305809] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:21:52] [DOC: 9305809] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:21:52] [DOC: 9305809] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: OT | Payer:  | MRN: MA241126016807
[00:21:52] ✅    ✅ Document 9305809 processed and saved successfully
[00:21:52] 🔄 
🔄 Step 8: Saving API details...
[00:21:52] [DOC: 9305809] ℹ️  API push details saved for document 9305809
[00:21:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278348                         ║
================================================================================
[00:21:52] ℹ️  Agency: Dartmouth HH
[00:21:52] ℹ️  Date: 05/06/2025
[00:21:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:21:54] [DOC: 9278348] ✅ Text extracted using pdfplumber (1139 chars)
[00:21:54] ✅    ✅ Text extracted using pdfplumber (1139 chars)
[00:21:54] 🔄 
🔄 Step 2: Extracting patient data...
[00:21:57] ℹ️  AI extracted raw sex value: 'F'
[00:21:57] ℹ️  AI extracted service line: 'RN'
[00:21:57] ℹ️  AI extracted payer source: 'Medicare'
[00:21:57] ℹ️  AI extracted diagnoses:
[00:21:57] ℹ️    - Diagnosis 1: ''
[00:21:57] ℹ️    - Diagnosis 2: ''
[00:21:57] ℹ️    - Diagnosis 3: ''
[00:21:57] ℹ️    - Diagnosis 4: ''
[00:21:57] ℹ️    - Diagnosis 5: ''
[00:21:57] ℹ️    - Diagnosis 6: ''
[00:21:57] ℹ️  Final extracted MRN: '5915015'
[00:21:57] ℹ️  Final extracted Sex: 'FEMALE'
[00:21:57] ℹ️  Final extracted Service Line: 'RN'
[00:21:57] ℹ️  Final extracted Payer Source: 'Medicare'
[00:21:57] ✅ Patient data extraction completed successfully
[00:21:57] ✅    ✅ Patient data extracted successfully
[00:21:57] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:57] ✅    ✅ Patient identified: Suzanne Fawcett
[00:21:57] ✅    ✅ Patient name validation passed
[00:21:57] 🔄 
🔄 Step 3: Processing patient dates...
[00:21:57] [DOC: 9278348] ℹ️  DOB normalized: 12/08/1939
[00:21:57] [DOC: 9278348] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:21:57] [DOC: 9278348] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[00:21:57] [DOC: 9278348] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[00:21:57] [DOC: 9278348] ✅ Patient date processing completed successfully
[00:21:57] ✅    ✅ Date processing completed
[00:21:57] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:21:57] 🔄 
🔄 Step 4: Extracting order data...
[00:21:59] ℹ️  Order extraction - MRN: ''
[00:21:59] ℹ️  Order extraction - Sex: 'FEMALE'
[00:21:59] ℹ️  Order extraction - Service Line: 'RN'
[00:21:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:21:59] ✅ Order data extraction completed successfully
[00:21:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:21:59] ℹ️  Using MRN from patient data: '5915015'
[00:21:59] ℹ️  Service line consistent in both sources: 'RN'
[00:21:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:21:59] ✅ Patient name cross-validation successful
[00:21:59] ✅    ✅ Data merged successfully
[00:22:01] ✅    ✅ Order data extracted and validated
[00:22:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:22:03] [DOC: 9278348] ✅ Patient exists in API: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:22:03] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:22:03] 🔄 
🔄 Step 6: Pushing order to API...
[00:22:03] [DOC: 9278348] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:22:05] [DOC: 9278348] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13932"}
[00:22:05] ❌    ❌ Failed to push order
[00:22:05] 🔄 
🔄 Step 7: Writing to CSV...
[00:22:05] [DOC: 9278348] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:22:05] [DOC: 9278348] ℹ️  Service Line extracted: 'RN'
[00:22:05] [DOC: 9278348] ℹ️  Payer Source extracted: 'Medicare'
[00:22:05] [DOC: 9278348] ℹ️  Diagnosis codes being written:
[00:22:05] [DOC: 9278348] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:22:05] [DOC: 9278348] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:22:05] [DOC: 9278348] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:22:05] [DOC: 9278348] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:22:05] [DOC: 9278348] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:22:05] [DOC: 9278348] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:22:05] [DOC: 9278348] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: RN | Payer: Medicare | MRN: 5915015
[00:22:05] ✅    ✅ Document 9278348 processed and saved successfully
[00:22:05] 🔄 
🔄 Step 8: Saving API details...
[00:22:05] [DOC: 9278348] ℹ️  API push details saved for document 9278348
[00:22:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9274454                         ║
================================================================================
[00:22:05] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[00:22:05] ℹ️  Date: 05/02/2025
[00:22:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:22:11] [DOC: 9274454] ✅ Text extracted using pdfplumber (11417 chars)
[00:22:11] ✅    ✅ Text extracted using pdfplumber (11417 chars)
[00:22:11] 🔄 
🔄 Step 2: Extracting patient data...
[00:22:14] ℹ️  AI extracted raw sex value: 'M'
[00:22:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:22:14] ℹ️  AI extracted payer source: 'None'
[00:22:14] ℹ️  AI extracted diagnoses:
[00:22:14] ℹ️    - Diagnosis 1: 'E11.43'
[00:22:14] ℹ️    - Diagnosis 2: 'K31.84'
[00:22:14] ℹ️    - Diagnosis 3: 'K59.89'
[00:22:14] ℹ️    - Diagnosis 4: 'F20.0'
[00:22:14] ℹ️    - Diagnosis 5: 'I10'
[00:22:14] ℹ️    - Diagnosis 6: 'E66.01'
[00:22:14] ℹ️  Final extracted MRN: '457'
[00:22:14] ℹ️  Final extracted Sex: 'MALE'
[00:22:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:22:14] ℹ️  Final extracted Payer Source: ''
[00:22:14] ✅ Patient data extraction completed successfully
[00:22:14] ✅    ✅ Patient data extracted successfully
[00:22:14] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[00:22:14] ✅    ✅ Patient identified: Manuel Varela
[00:22:14] ✅    ✅ Patient name validation passed
[00:22:14] 🔄 
🔄 Step 3: Processing patient dates...
[00:22:14] [DOC: 9274454] ℹ️  DOB normalized: 02/08/1969
[00:22:14] [DOC: 9274454] ℹ️  Episode startOfCare normalized: 05/02/2025
[00:22:14] [DOC: 9274454] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:22:14] [DOC: 9274454] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[00:22:14] [DOC: 9274454] ✅ Patient date processing completed successfully
[00:22:14] ✅    ✅ Date processing completed
[00:22:14] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[00:22:14] 🔄 
🔄 Step 4: Extracting order data...
[00:22:17] ℹ️  Order extraction - MRN: '457'
[00:22:17] ℹ️  Order extraction - Sex: 'MALE'
[00:22:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:22:17] ℹ️  Order extraction - Payer Source: ''
[00:22:17] ✅ Order data extraction completed successfully
[00:22:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:22:17] ℹ️  Using MRN from patient data: '457' over '457'
[00:22:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:22:17] ✅ Patient name cross-validation successful
[00:22:17] ✅    ✅ Data merged successfully
[00:22:18] ✅    ✅ Order data extracted and validated
[00:22:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:22:18] [DOC: 9274454] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:22:18] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:22:18] 🔄 
🔄 Step 6: Pushing order to API...
[00:22:18] [DOC: 9274454] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:22:20] [DOC: 9274454] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:22:20] ❌    ❌ Failed to push order
[00:22:20] 🔄 
🔄 Step 7: Writing to CSV...
[00:22:20] [DOC: 9274454] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[00:22:20] [DOC: 9274454] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:22:20] [DOC: 9274454] ℹ️  Payer Source extracted: ''
[00:22:20] [DOC: 9274454] ℹ️  Diagnosis codes being written:
[00:22:20] [DOC: 9274454] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.43'
[00:22:20] [DOC: 9274454] ℹ️    - Latest_Episode_Seconddiagnosis: 'K31.84'
[00:22:20] [DOC: 9274454] ℹ️    - Latest_Episode_Thirddiagnosis: 'K59.89'
[00:22:20] [DOC: 9274454] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F20.0'
[00:22:20] [DOC: 9274454] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[00:22:20] [DOC: 9274454] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[00:22:20] [DOC: 9274454] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: Skilled Nursing | Payer:  | MRN: 457
[00:22:20] ✅    ✅ Document 9274454 processed and saved successfully
[00:22:20] 🔄 
🔄 Step 8: Saving API details...
[00:22:20] [DOC: 9274454] ℹ️  API push details saved for document 9274454
[00:22:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9272998                         ║
================================================================================
[00:22:20] ℹ️  Agency: Dartmouth HH
[00:22:20] ℹ️  Date: 05/02/2025
[00:22:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:22:22] [DOC: 9272998] ✅ Text extracted using pdfplumber (1316 chars)
[00:22:22] ✅    ✅ Text extracted using pdfplumber (1316 chars)
[00:22:22] 🔄 
🔄 Step 2: Extracting patient data...
[00:22:24] ℹ️  AI extracted raw sex value: 'F'
[00:22:24] ℹ️  AI extracted service line: 'RN'
[00:22:24] ℹ️  AI extracted payer source: 'Medicare'
[00:22:24] ℹ️  AI extracted diagnoses:
[00:22:24] ℹ️    - Diagnosis 1: 'None'
[00:22:24] ℹ️    - Diagnosis 2: 'None'
[00:22:24] ℹ️    - Diagnosis 3: 'None'
[00:22:24] ℹ️    - Diagnosis 4: 'None'
[00:22:24] ℹ️    - Diagnosis 5: 'None'
[00:22:24] ℹ️    - Diagnosis 6: 'None'
[00:22:24] ℹ️  Final extracted MRN: '3320011'
[00:22:24] ℹ️  Final extracted Sex: 'FEMALE'
[00:22:24] ℹ️  Final extracted Service Line: 'RN'
[00:22:24] ℹ️  Final extracted Payer Source: 'Medicare'
[00:22:24] ✅ Patient data extraction completed successfully
[00:22:24] ✅    ✅ Patient data extracted successfully
[00:22:24] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': None, 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:22:24] ✅    ✅ Patient identified: Bonnie Werly
[00:22:24] ✅    ✅ Patient name validation passed
[00:22:24] 🔄 
🔄 Step 3: Processing patient dates...
[00:22:24] [DOC: 9272998] ℹ️  DOB normalized: 06/16/1939
[00:22:24] [DOC: 9272998] ℹ️  Episode startOfCare normalized: 09/01/2024
[00:22:24] [DOC: 9272998] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[00:22:24] [DOC: 9272998] ✅ Patient date processing completed successfully
[00:22:24] ✅    ✅ Date processing completed
[00:22:24] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'endOfEpisode': '04/28/2025'}]
[00:22:24] 🔄 
🔄 Step 4: Extracting order data...
[00:22:27] ℹ️  Order extraction - MRN: ''
[00:22:27] ℹ️  Order extraction - Sex: 'FEMALE'
[00:22:27] ℹ️  Order extraction - Service Line: 'RN'
[00:22:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:22:27] ✅ Order data extraction completed successfully
[00:22:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:22:27] ℹ️  Using MRN from patient data: '3320011'
[00:22:27] ℹ️  Service line consistent in both sources: 'RN'
[00:22:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:22:27] ✅ Patient name cross-validation successful
[00:22:27] ✅    ✅ Data merged successfully
[00:22:29] ✅    ✅ Order data extracted and validated
[00:22:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:22:29] [DOC: 9272998] ✅ Patient found in local cache: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[00:22:29] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[00:22:29] 🔄 
🔄 Step 6: Pushing order to API...
[00:22:29] [DOC: 9272998] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[00:22:30] [DOC: 9272998] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14422"}
[00:22:30] ❌    ❌ Failed to push order
[00:22:30] 🔄 
🔄 Step 7: Writing to CSV...
[00:22:30] [DOC: 9272998] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[00:22:30] [DOC: 9272998] ℹ️  Service Line extracted: 'RN'
[00:22:30] [DOC: 9272998] ℹ️  Payer Source extracted: 'Medicare'
[00:22:30] [DOC: 9272998] ℹ️  Diagnosis codes being written:
[00:22:30] [DOC: 9272998] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:22:30] [DOC: 9272998] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:22:30] [DOC: 9272998] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:22:30] [DOC: 9272998] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:22:30] [DOC: 9272998] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:22:30] [DOC: 9272998] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:22:30] [DOC: 9272998] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: RN | Payer: Medicare | MRN: 3320011
[00:22:30] ✅    ✅ Document 9272998 processed and saved successfully
[00:22:30] 🔄 
🔄 Step 8: Saving API details...
[00:22:30] [DOC: 9272998] ℹ️  API push details saved for document 9272998
[00:22:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9272597                         ║
================================================================================
[00:22:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:22:30] ℹ️  Date: 05/01/2025
[00:22:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:22:33] [DOC: 9272597] ✅ Text extracted using pdfplumber (1460 chars)
[00:22:33] ✅    ✅ Text extracted using pdfplumber (1460 chars)
[00:22:33] 🔄 
🔄 Step 2: Extracting patient data...
[00:22:36] ℹ️  AI extracted raw sex value: ''
[00:22:36] ℹ️  AI extracted service line: 'Physical Therapy'
[00:22:36] ℹ️  AI extracted payer source: ''
[00:22:36] ℹ️  AI extracted diagnoses:
[00:22:36] ℹ️    - Diagnosis 1: 'J44.1'
[00:22:36] ℹ️    - Diagnosis 2: 'I11.0'
[00:22:36] ℹ️    - Diagnosis 3: 'I50.42'
[00:22:36] ℹ️    - Diagnosis 4: 'None'
[00:22:36] ℹ️    - Diagnosis 5: 'None'
[00:22:36] ℹ️    - Diagnosis 6: 'None'
[00:22:36] ℹ️  Final extracted MRN: 'MA200528053701'
[00:22:36] ℹ️  Final extracted Sex: ''
[00:22:36] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:22:36] ℹ️  Final extracted Payer Source: ''
[00:22:36] ✅ Patient data extraction completed successfully
[00:22:36] ✅    ✅ Patient data extracted successfully
[00:22:36] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:22:36] ✅    ✅ Patient identified: Roderick Lopez
[00:22:36] ✅    ✅ Patient name validation passed
[00:22:36] 🔄 
🔄 Step 3: Processing patient dates...
[00:22:36] [DOC: 9272597] ℹ️  DOB normalized: 05/21/1937
[00:22:36] [DOC: 9272597] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[00:22:36] [DOC: 9272597] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[00:22:36] [DOC: 9272597] ✅ Patient date processing completed successfully
[00:22:36] ✅    ✅ Date processing completed
[00:22:36] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42'}]
[00:22:36] 🔄 
🔄 Step 4: Extracting order data...
[00:22:38] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:22:38] ℹ️  Order extraction - Sex: ''
[00:22:38] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:22:38] ℹ️  Order extraction - Payer Source: ''
[00:22:38] ✅ Order data extraction completed successfully
[00:22:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:22:38] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:22:38] ℹ️  Inferred sex as MALE from name: Roderick
[00:22:38] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:22:38] ✅ Patient name cross-validation successful
[00:22:38] ✅    ✅ Data merged successfully
[00:22:40] ✅    ✅ Order data extracted and validated
[00:22:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:22:40] [DOC: 9272597] ✅ Patient found in local cache: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:22:40] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:22:40] 🔄 
🔄 Step 6: Pushing order to API...
[00:22:40] [DOC: 9272597] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:22:41] [DOC: 9272597] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13968"}
[00:22:41] ❌    ❌ Failed to push order
[00:22:41] 🔄 
🔄 Step 7: Writing to CSV...
[00:22:41] [DOC: 9272597] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:22:41] [DOC: 9272597] ℹ️  Service Line extracted: 'Physical Therapy'
[00:22:41] [DOC: 9272597] ℹ️  Payer Source extracted: ''
[00:22:41] [DOC: 9272597] ℹ️  Diagnosis codes being written:
[00:22:41] [DOC: 9272597] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[00:22:41] [DOC: 9272597] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[00:22:41] [DOC: 9272597] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.42'
[00:22:41] [DOC: 9272597] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:22:41] [DOC: 9272597] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:22:41] [DOC: 9272597] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:22:41] [DOC: 9272597] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA200528053701
[00:22:41] ✅    ✅ Document 9272597 processed and saved successfully
[00:22:41] 🔄 
🔄 Step 8: Saving API details...
[00:22:41] [DOC: 9272597] ℹ️  API push details saved for document 9272597
[00:22:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2173693                         ║
================================================================================
[00:22:41] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:22:41] ℹ️  Date: 04/30/2025
[00:22:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:22:43] [DOC: 2173693] ❌ Critical failure in get_pdf_text: Invalid response format
[00:22:43] ❌ Failed to extract text for Doc ID 2173693
[00:22:43] [DOC: 2173693] ℹ️  API push details saved for document 2173693
================================================================================
║                        Processing Document ID: 9266990                         ║
================================================================================
[00:22:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:22:43] ℹ️  Date: 04/29/2025
[00:22:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:22:45] [DOC: 9266990] ✅ Text extracted using pdfplumber (13231 chars)
[00:22:45] ✅    ✅ Text extracted using pdfplumber (13231 chars)
[00:22:45] 🔄 
🔄 Step 2: Extracting patient data...
[00:22:49] ℹ️  AI extracted raw sex value: 'F'
[00:22:49] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:22:49] ℹ️  AI extracted payer source: 'Medicare'
[00:22:49] ℹ️  AI extracted diagnoses:
[00:22:49] ℹ️    - Diagnosis 1: 'N30.00'
[00:22:49] ℹ️    - Diagnosis 2: 'E11.9'
[00:22:49] ℹ️    - Diagnosis 3: 'F41.1'
[00:22:49] ℹ️    - Diagnosis 4: 'I95.1'
[00:22:49] ℹ️    - Diagnosis 5: 'M13.849'
[00:22:49] ℹ️    - Diagnosis 6: 'M51.87'
[00:22:49] ℹ️  Final extracted MRN: '101002392'
[00:22:49] ℹ️  Final extracted Sex: 'FEMALE'
[00:22:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:22:49] ℹ️  Final extracted Payer Source: 'Medicare'
[00:22:49] ✅ Patient data extraction completed successfully
[00:22:49] ✅    ✅ Patient data extracted successfully
[00:22:49] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'I95.1', 'fifthDiagnosis': 'M13.849', 'sixthDiagnosis': 'M51.87'}]
[00:22:49] ✅    ✅ Patient identified: Virginia Brunton
[00:22:49] ✅    ✅ Patient name validation passed
[00:22:49] 🔄 
🔄 Step 3: Processing patient dates...
[00:22:49] [DOC: 9266990] ℹ️  DOB normalized: 06/05/1940
[00:22:49] [DOC: 9266990] ℹ️  Episode startOfCare normalized: 04/08/2025
[00:22:49] [DOC: 9266990] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:22:49] [DOC: 9266990] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:22:49] [DOC: 9266990] ✅ Patient date processing completed successfully
[00:22:49] ✅    ✅ Date processing completed
[00:22:49] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'I95.1', 'fifthDiagnosis': 'M13.849', 'sixthDiagnosis': 'M51.87'}]
[00:22:49] 🔄 
🔄 Step 4: Extracting order data...
[00:22:51] ℹ️  Order extraction - MRN: '101002392'
[00:22:51] ℹ️  Order extraction - Sex: 'FEMALE'
[00:22:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:22:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:22:51] ✅ Order data extraction completed successfully
[00:22:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:22:51] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:22:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:22:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:22:51] ✅ Patient name cross-validation successful
[00:22:51] ✅    ✅ Data merged successfully
[00:22:53] ✅    ✅ Order data extracted and validated
[00:22:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:22:53] [DOC: 9266990] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:22:53] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:22:53] 🔄 
🔄 Step 6: Pushing order to API...
[00:22:53] [DOC: 9266990] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:22:54] [DOC: 9266990] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13402"}
[00:22:54] ❌    ❌ Failed to push order
[00:22:54] 🔄 
🔄 Step 7: Writing to CSV...
[00:22:54] [DOC: 9266990] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:22:54] [DOC: 9266990] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:22:54] [DOC: 9266990] ℹ️  Payer Source extracted: 'Medicare'
[00:22:54] [DOC: 9266990] ℹ️  Diagnosis codes being written:
[00:22:54] [DOC: 9266990] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:22:54] [DOC: 9266990] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:22:54] [DOC: 9266990] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:22:54] [DOC: 9266990] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I95.1'
[00:22:54] [DOC: 9266990] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M13.849'
[00:22:54] [DOC: 9266990] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M51.87'
[00:22:54] [DOC: 9266990] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 101002392
[00:22:54] ✅    ✅ Document 9266990 processed and saved successfully
[00:22:54] 🔄 
🔄 Step 8: Saving API details...
[00:22:54] [DOC: 9266990] ℹ️  API push details saved for document 9266990
[00:22:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266606                         ║
================================================================================
[00:22:54] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[00:22:54] ℹ️  Date: 04/29/2025
[00:22:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:22:57] [DOC: 9266606] ✅ Text extracted using pdfplumber (3595 chars)
[00:22:57] ✅    ✅ Text extracted using pdfplumber (3595 chars)
[00:22:57] 🔄 
🔄 Step 2: Extracting patient data...
[00:23:00] ℹ️  AI extracted raw sex value: 'M'
[00:23:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:23:00] ℹ️  AI extracted payer source: 'Medicaid/MA'
[00:23:00] ℹ️  AI extracted diagnoses:
[00:23:00] ℹ️    - Diagnosis 1: 'E11.43'
[00:23:00] ℹ️    - Diagnosis 2: 'K31.84'
[00:23:00] ℹ️    - Diagnosis 3: 'K59.89'
[00:23:00] ℹ️    - Diagnosis 4: 'F20.0'
[00:23:00] ℹ️    - Diagnosis 5: 'I10'
[00:23:00] ℹ️    - Diagnosis 6: 'E66.01'
[00:23:00] ℹ️  Final extracted MRN: '457'
[00:23:00] ℹ️  Final extracted Sex: 'MALE'
[00:23:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:23:00] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[00:23:00] ✅ Patient data extraction completed successfully
[00:23:00] ✅    ✅ Patient data extracted successfully
[00:23:00] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[00:23:00] ✅    ✅ Patient identified: Manuel Varela
[00:23:00] ✅    ✅ Patient name validation passed
[00:23:00] 🔄 
🔄 Step 3: Processing patient dates...
[00:23:00] [DOC: 9266606] ℹ️  DOB normalized: 02/08/1969
[00:23:00] [DOC: 9266606] ℹ️  Episode startOfCare normalized: 11/07/2024
[00:23:00] [DOC: 9266606] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:23:00] [DOC: 9266606] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[00:23:00] [DOC: 9266606] ✅ Patient date processing completed successfully
[00:23:00] ✅    ✅ Date processing completed
[00:23:00] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[00:23:00] 🔄 
🔄 Step 4: Extracting order data...
[00:23:02] ℹ️  Order extraction - MRN: '457'
[00:23:02] ℹ️  Order extraction - Sex: 'MALE'
[00:23:02] ℹ️  Order extraction - Service Line: 'RN'
[00:23:02] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[00:23:02] ✅ Order data extraction completed successfully
[00:23:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:23:02] ℹ️  Using MRN from patient data: '457' over '457'
[00:23:02] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[00:23:02] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[00:23:02] ✅ Patient name cross-validation successful
[00:23:02] ✅    ✅ Data merged successfully
[00:23:04] ✅    ✅ Order data extracted and validated
[00:23:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:23:04] [DOC: 9266606] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:23:04] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:23:04] 🔄 
🔄 Step 6: Pushing order to API...
[00:23:04] [DOC: 9266606] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[00:23:05] [DOC: 9266606] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:23:05] ❌    ❌ Failed to push order
[00:23:05] 🔄 
🔄 Step 7: Writing to CSV...
[00:23:05] [DOC: 9266606] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[00:23:05] [DOC: 9266606] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[00:23:05] [DOC: 9266606] ℹ️  Payer Source extracted: 'Medicaid/MA'
[00:23:05] [DOC: 9266606] ℹ️  Diagnosis codes being written:
[00:23:05] [DOC: 9266606] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.43'
[00:23:05] [DOC: 9266606] ℹ️    - Latest_Episode_Seconddiagnosis: 'K31.84'
[00:23:05] [DOC: 9266606] ℹ️    - Latest_Episode_Thirddiagnosis: 'K59.89'
[00:23:05] [DOC: 9266606] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F20.0'
[00:23:05] [DOC: 9266606] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[00:23:05] [DOC: 9266606] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[00:23:05] [DOC: 9266606] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: RN, Skilled Nursing | Payer: Medicaid/MA | MRN: 457
[00:23:05] ✅    ✅ Document 9266606 processed and saved successfully
[00:23:05] 🔄 
🔄 Step 8: Saving API details...
[00:23:05] [DOC: 9266606] ℹ️  API push details saved for document 9266606
[00:23:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266400                         ║
================================================================================
[00:23:05] ℹ️  Agency: Dartmouth HH
[00:23:05] ℹ️  Date: 04/29/2025
[00:23:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:23:07] [DOC: 9266400] ✅ Text extracted using pdfplumber (1886 chars)
[00:23:07] ✅    ✅ Text extracted using pdfplumber (1886 chars)
[00:23:07] 🔄 
🔄 Step 2: Extracting patient data...
[00:23:10] ℹ️  AI extracted raw sex value: 'F'
[00:23:10] ℹ️  AI extracted service line: 'RN'
[00:23:10] ℹ️  AI extracted payer source: 'Medicare'
[00:23:10] ℹ️  AI extracted diagnoses:
[00:23:10] ℹ️    - Diagnosis 1: ''
[00:23:10] ℹ️    - Diagnosis 2: ''
[00:23:10] ℹ️    - Diagnosis 3: ''
[00:23:10] ℹ️    - Diagnosis 4: ''
[00:23:10] ℹ️    - Diagnosis 5: ''
[00:23:10] ℹ️    - Diagnosis 6: ''
[00:23:10] ℹ️  Final extracted MRN: '6115015'
[00:23:10] ℹ️  Final extracted Sex: 'FEMALE'
[00:23:10] ℹ️  Final extracted Service Line: 'RN'
[00:23:10] ℹ️  Final extracted Payer Source: 'Medicare'
[00:23:10] ✅ Patient data extraction completed successfully
[00:23:10] ✅    ✅ Patient data extracted successfully
[00:23:10] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:23:10] ✅    ✅ Patient identified: Nancy Silva
[00:23:10] ✅    ✅ Patient name validation passed
[00:23:10] 🔄 
🔄 Step 3: Processing patient dates...
[00:23:10] [DOC: 9266400] ℹ️  DOB normalized: 11/18/1936
[00:23:10] [DOC: 9266400] ℹ️  Episode startOfCare normalized: 03/01/2025
[00:23:10] [DOC: 9266400] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[00:23:10] [DOC: 9266400] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[00:23:10] [DOC: 9266400] ✅ Patient date processing completed successfully
[00:23:10] ✅    ✅ Date processing completed
[00:23:10] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:23:10] 🔄 
🔄 Step 4: Extracting order data...
[00:23:13] ℹ️  Order extraction - MRN: ''
[00:23:13] ℹ️  Order extraction - Sex: 'FEMALE'
[00:23:13] ℹ️  Order extraction - Service Line: 'RN'
[00:23:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:23:13] ✅ Order data extraction completed successfully
[00:23:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:23:13] ℹ️  Using MRN from patient data: '6115015'
[00:23:13] ℹ️  Service line consistent in both sources: 'RN'
[00:23:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:23:13] ✅ Patient name cross-validation successful
[00:23:13] ✅    ✅ Data merged successfully
[00:23:14] ✅    ✅ Order data extracted and validated
[00:23:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:23:14] [DOC: 9266400] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:23:14] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:23:14] 🔄 
🔄 Step 6: Pushing order to API...
[00:23:14] [DOC: 9266400] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:23:15] [DOC: 9266400] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14401"}
[00:23:15] ❌    ❌ Failed to push order
[00:23:15] 🔄 
🔄 Step 7: Writing to CSV...
[00:23:15] [DOC: 9266400] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[00:23:15] [DOC: 9266400] ℹ️  Service Line extracted: 'RN'
[00:23:15] [DOC: 9266400] ℹ️  Payer Source extracted: 'Medicare'
[00:23:15] [DOC: 9266400] ℹ️  Diagnosis codes being written:
[00:23:15] [DOC: 9266400] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:23:15] [DOC: 9266400] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:23:15] [DOC: 9266400] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:23:15] [DOC: 9266400] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:23:15] [DOC: 9266400] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:23:15] [DOC: 9266400] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:23:15] [DOC: 9266400] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: RN | Payer: Medicare | MRN: 6115015
[00:23:15] ✅    ✅ Document 9266400 processed and saved successfully
[00:23:15] 🔄 
🔄 Step 8: Saving API details...
[00:23:15] [DOC: 9266400] ℹ️  API push details saved for document 9266400
[00:23:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266383                         ║
================================================================================
[00:23:15] ℹ️  Agency: Dartmouth HH
[00:23:15] ℹ️  Date: 04/29/2025
[00:23:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:23:20] [DOC: 9266383] ✅ Text extracted using pdfplumber (5439 chars)
[00:23:20] ✅    ✅ Text extracted using pdfplumber (5439 chars)
[00:23:20] 🔄 
🔄 Step 2: Extracting patient data...
[00:23:23] ℹ️  AI extracted raw sex value: 'F'
[00:23:23] ℹ️  AI extracted service line: 'OT'
[00:23:23] ℹ️  AI extracted payer source: 'Medicare'
[00:23:23] ℹ️  AI extracted diagnoses:
[00:23:23] ℹ️    - Diagnosis 1: 'None'
[00:23:23] ℹ️    - Diagnosis 2: 'None'
[00:23:23] ℹ️    - Diagnosis 3: 'None'
[00:23:23] ℹ️    - Diagnosis 4: 'None'
[00:23:23] ℹ️    - Diagnosis 5: 'None'
[00:23:23] ℹ️    - Diagnosis 6: 'None'
[00:23:23] ℹ️  Final extracted MRN: '6338015'
[00:23:23] ℹ️  Final extracted Sex: 'FEMALE'
[00:23:23] ℹ️  Final extracted Service Line: 'OT'
[00:23:23] ℹ️  Final extracted Payer Source: 'Medicare'
[00:23:23] ✅ Patient data extraction completed successfully
[00:23:23] ✅    ✅ Patient data extracted successfully
[00:23:23] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6338015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:23:23] ✅    ✅ Patient identified: Margaret Grassi
[00:23:23] ✅    ✅ Patient name validation passed
[00:23:23] 🔄 
🔄 Step 3: Processing patient dates...
[00:23:23] [DOC: 9266383] ℹ️  DOB normalized: 06/01/1936
[00:23:23] [DOC: 9266383] ℹ️  Episode startOfCare normalized: 04/12/2025
[00:23:23] [DOC: 9266383] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:23:23] [DOC: 9266383] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:23:23] [DOC: 9266383] ✅ Patient date processing completed successfully
[00:23:23] ✅    ✅ Date processing completed
[00:23:23] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6338015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025'}]
[00:23:23] 🔄 
🔄 Step 4: Extracting order data...
[00:23:25] ℹ️  Order extraction - MRN: ''
[00:23:25] ℹ️  Order extraction - Sex: 'FEMALE'
[00:23:25] ℹ️  Order extraction - Service Line: 'OT'
[00:23:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:23:25] ✅ Order data extraction completed successfully
[00:23:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:23:25] ℹ️  Using MRN from patient data: '6338015'
[00:23:25] ℹ️  Service line consistent in both sources: 'OT'
[00:23:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:23:25] ✅ Patient name cross-validation successful
[00:23:25] ✅    ✅ Data merged successfully
[00:23:26] ✅    ✅ Order data extracted and validated
[00:23:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:23:26] [DOC: 9266383] ✅ Patient found in local cache: Margaret Grassi, ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[00:23:26] ✅    ✅ Existing patient found with ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[00:23:26] 🔄 
🔄 Step 6: Pushing order to API...
[00:23:26] [DOC: 9266383] ℹ️  Pushing order via API for patient ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[00:23:28] [DOC: 9266383] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:23:28] ❌    ❌ Failed to push order
[00:23:28] 🔄 
🔄 Step 7: Writing to CSV...
[00:23:28] [DOC: 9266383] ℹ️  Calculated age: 89 from DOB: 06/01/1936
[00:23:28] [DOC: 9266383] ℹ️  Service Line extracted: 'OT'
[00:23:28] [DOC: 9266383] ℹ️  Payer Source extracted: 'Medicare'
[00:23:28] [DOC: 9266383] ℹ️  Diagnosis codes being written:
[00:23:28] [DOC: 9266383] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:23:28] [DOC: 9266383] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:23:28] [DOC: 9266383] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:23:28] [DOC: 9266383] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:23:28] [DOC: 9266383] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:23:28] [DOC: 9266383] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:23:28] [DOC: 9266383] ✅ Patient data written to CSV: Margaret Grassi | Sex: FEMALE | Age: 89 | Service: OT | Payer: Medicare | MRN: 6338015
[00:23:28] ✅    ✅ Document 9266383 processed and saved successfully
[00:23:28] 🔄 
🔄 Step 8: Saving API details...
[00:23:28] [DOC: 9266383] ℹ️  API push details saved for document 9266383
[00:23:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266373                         ║
================================================================================
[00:23:28] ℹ️  Agency: Dartmouth HH
[00:23:28] ℹ️  Date: 04/29/2025
[00:23:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:23:33] [DOC: 9266373] ✅ Text extracted using pdfplumber (18089 chars)
[00:23:33] ✅    ✅ Text extracted using pdfplumber (18077 chars)
[00:23:33] 🔄 
🔄 Step 2: Extracting patient data...
[00:23:36] ℹ️  AI extracted raw sex value: 'F'
[00:23:36] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[00:23:36] ℹ️  AI extracted payer source: ''
[00:23:36] ℹ️  AI extracted diagnoses:
[00:23:36] ℹ️    - Diagnosis 1: 'F03.B3'
[00:23:36] ℹ️    - Diagnosis 2: 'I12.9'
[00:23:36] ℹ️    - Diagnosis 3: 'E11.22'
[00:23:36] ℹ️    - Diagnosis 4: 'N18.31'
[00:23:36] ℹ️    - Diagnosis 5: 'M54.50'
[00:23:36] ℹ️    - Diagnosis 6: 'K86.2'
[00:23:36] ℹ️  Final extracted MRN: '227027'
[00:23:36] ℹ️  Final extracted Sex: 'FEMALE'
[00:23:36] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[00:23:36] ℹ️  Final extracted Payer Source: ''
[00:23:36] ✅ Patient data extraction completed successfully
[00:23:36] ✅    ✅ Patient data extracted successfully
[00:23:36] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F03.B3', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'K86.2'}]
[00:23:36] ✅    ✅ Patient identified: Margaret Grassi
[00:23:36] ✅    ✅ Patient name validation passed
[00:23:36] 🔄 
🔄 Step 3: Processing patient dates...
[00:23:36] [DOC: 9266373] ℹ️  DOB normalized: 06/01/1936
[00:23:36] [DOC: 9266373] ℹ️  Episode startOfCare normalized: 04/12/2025
[00:23:36] [DOC: 9266373] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:23:36] [DOC: 9266373] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:23:36] [DOC: 9266373] ✅ Patient date processing completed successfully
[00:23:36] ✅    ✅ Date processing completed
[00:23:36] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F03.B3', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'K86.2'}]
[00:23:36] 🔄 
🔄 Step 4: Extracting order data...
[00:23:39] ℹ️  Order extraction - MRN: '6338015'
[00:23:39] ℹ️  Order extraction - Sex: 'FEMALE'
[00:23:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:23:39] ℹ️  Order extraction - Payer Source: ''
[00:23:39] ✅ Order data extraction completed successfully
[00:23:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:23:39] ℹ️  Using longer MRN from order data: '6338015' over '227027'
[00:23:39] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[00:23:39] ✅ Patient name cross-validation successful
[00:23:39] ✅    ✅ Data merged successfully
[00:23:41] ✅    ✅ Order data extracted and validated
[00:23:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:23:41] [DOC: 9266373] ✅ Patient found in local cache: Margaret Grassi, ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[00:23:41] ✅    ✅ Existing patient found with ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[00:23:41] 🔄 
🔄 Step 6: Pushing order to API...
[00:23:41] [DOC: 9266373] ℹ️  Pushing order via API for patient ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[00:23:42] [DOC: 9266373] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:23:42] ❌    ❌ Failed to push order
[00:23:42] 🔄 
🔄 Step 7: Writing to CSV...
[00:23:42] [DOC: 9266373] ℹ️  Calculated age: 89 from DOB: 06/01/1936
[00:23:42] [DOC: 9266373] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[00:23:42] [DOC: 9266373] ℹ️  Payer Source extracted: ''
[00:23:42] [DOC: 9266373] ℹ️  Diagnosis codes being written:
[00:23:42] [DOC: 9266373] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.B3'
[00:23:42] [DOC: 9266373] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[00:23:42] [DOC: 9266373] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[00:23:42] [DOC: 9266373] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[00:23:42] [DOC: 9266373] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.50'
[00:23:42] [DOC: 9266373] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K86.2'
[00:23:42] [DOC: 9266373] ✅ Patient data written to CSV: Margaret Grassi | Sex: FEMALE | Age: 89 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 6338015
[00:23:42] ✅    ✅ Document 9266373 processed and saved successfully
[00:23:42] 🔄 
🔄 Step 8: Saving API details...
[00:23:42] [DOC: 9266373] ℹ️  API push details saved for document 9266373
[00:23:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266355                         ║
================================================================================
[00:23:42] ℹ️  Agency: Dartmouth HH
[00:23:42] ℹ️  Date: 04/29/2025
[00:23:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:23:44] [DOC: 9266355] ✅ Text extracted using pdfplumber (1159 chars)
[00:23:44] ✅    ✅ Text extracted using pdfplumber (1159 chars)
[00:23:44] 🔄 
🔄 Step 2: Extracting patient data...
[00:23:47] ℹ️  AI extracted raw sex value: 'F'
[00:23:47] ℹ️  AI extracted service line: 'Physical Therapy'
[00:23:47] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[00:23:47] ℹ️  AI extracted diagnoses:
[00:23:47] ℹ️    - Diagnosis 1: ''
[00:23:47] ℹ️    - Diagnosis 2: ''
[00:23:47] ℹ️    - Diagnosis 3: ''
[00:23:47] ℹ️    - Diagnosis 4: ''
[00:23:47] ℹ️    - Diagnosis 5: ''
[00:23:47] ℹ️    - Diagnosis 6: ''
[00:23:47] ℹ️  Final extracted MRN: '6133015'
[00:23:47] ℹ️  Final extracted Sex: 'FEMALE'
[00:23:47] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:23:47] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[00:23:47] ✅ Patient data extraction completed successfully
[00:23:47] ✅    ✅ Patient data extracted successfully
[00:23:47] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:23:47] ✅    ✅ Patient identified: Jacqueline DeTerra
[00:23:47] ✅    ✅ Patient name validation passed
[00:23:47] 🔄 
🔄 Step 3: Processing patient dates...
[00:23:47] [DOC: 9266355] ℹ️  DOB normalized: 11/04/1976
[00:23:47] [DOC: 9266355] ℹ️  Episode startOfCare normalized: 04/03/2025
[00:23:47] [DOC: 9266355] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[00:23:47] [DOC: 9266355] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[00:23:47] [DOC: 9266355] ✅ Patient date processing completed successfully
[00:23:47] ✅    ✅ Date processing completed
[00:23:47] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:23:47] 🔄 
🔄 Step 4: Extracting order data...
[00:23:50] ℹ️  Order extraction - MRN: '6133015'
[00:23:50] ℹ️  Order extraction - Sex: 'FEMALE'
[00:23:50] ℹ️  Order extraction - Service Line: 'PT'
[00:23:50] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[00:23:50] ✅ Order data extraction completed successfully
[00:23:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:23:50] ℹ️  Using MRN from patient data: '6133015' over '6133015'
[00:23:50] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[00:23:50] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[00:23:50] ✅ Patient name cross-validation successful
[00:23:50] ✅    ✅ Data merged successfully
[00:23:51] ✅    ✅ Order data extracted and validated
[00:23:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:23:51] [DOC: 9266355] ✅ Patient found in local cache: Jacqueline DeTerra, ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:23:51] ✅    ✅ Existing patient found with ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:23:51] 🔄 
🔄 Step 6: Pushing order to API...
[00:23:51] [DOC: 9266355] ℹ️  Pushing order via API for patient ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:23:52] [DOC: 9266355] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:23:52] ❌    ❌ Failed to push order
[00:23:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:23:52] [DOC: 9266355] ℹ️  Calculated age: 48 from DOB: 11/04/1976
[00:23:52] [DOC: 9266355] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[00:23:52] [DOC: 9266355] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[00:23:52] [DOC: 9266355] ℹ️  Diagnosis codes being written:
[00:23:52] [DOC: 9266355] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:23:52] [DOC: 9266355] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:23:52] [DOC: 9266355] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:23:52] [DOC: 9266355] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:23:52] [DOC: 9266355] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:23:52] [DOC: 9266355] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:23:52] [DOC: 9266355] ✅ Patient data written to CSV: Jacqueline DeTerra | Sex: FEMALE | Age: 48 | Service: PT, Physical Therapy | Payer: Blue Cross Blue Shield | MRN: 6133015
[00:23:52] ✅    ✅ Document 9266355 processed and saved successfully
[00:23:52] 🔄 
🔄 Step 8: Saving API details...
[00:23:52] [DOC: 9266355] ℹ️  API push details saved for document 9266355
[00:23:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266352                         ║
================================================================================
[00:23:52] ℹ️  Agency: Dartmouth HH
[00:23:52] ℹ️  Date: 04/29/2025
[00:23:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:23:55] [DOC: 9266352] ✅ Text extracted using pdfplumber (2967 chars)
[00:23:55] ✅    ✅ Text extracted using pdfplumber (2967 chars)
[00:23:55] 🔄 
🔄 Step 2: Extracting patient data...
[00:23:57] ℹ️  AI extracted raw sex value: 'F'
[00:23:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:23:57] ℹ️  AI extracted payer source: 'Medicare'
[00:23:57] ℹ️  AI extracted diagnoses:
[00:23:57] ℹ️    - Diagnosis 1: ''
[00:23:57] ℹ️    - Diagnosis 2: ''
[00:23:57] ℹ️    - Diagnosis 3: ''
[00:23:57] ℹ️    - Diagnosis 4: ''
[00:23:57] ℹ️    - Diagnosis 5: ''
[00:23:57] ℹ️    - Diagnosis 6: ''
[00:23:57] ℹ️  Final extracted MRN: '2496015'
[00:23:57] ℹ️  Final extracted Sex: 'FEMALE'
[00:23:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:23:57] ℹ️  Final extracted Payer Source: 'Medicare'
[00:23:57] ✅ Patient data extraction completed successfully
[00:23:57] ✅    ✅ Patient data extracted successfully
[00:23:57] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:23:57] ✅    ✅ Patient identified: Dana Theodore
[00:23:57] ✅    ✅ Patient name validation passed
[00:23:57] 🔄 
🔄 Step 3: Processing patient dates...
[00:23:57] [DOC: 9266352] ℹ️  DOB normalized: 03/16/1954
[00:23:57] [DOC: 9266352] ℹ️  Episode startOfCare normalized: 03/02/2025
[00:23:57] [DOC: 9266352] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[00:23:57] [DOC: 9266352] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[00:23:57] [DOC: 9266352] ✅ Patient date processing completed successfully
[00:23:57] ✅    ✅ Date processing completed
[00:23:57] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:23:57] 🔄 
🔄 Step 4: Extracting order data...
[00:24:00] ℹ️  Order extraction - MRN: '2496015'
[00:24:00] ℹ️  Order extraction - Sex: 'FEMALE'
[00:24:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:24:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:24:00] ✅ Order data extraction completed successfully
[00:24:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:24:00] ℹ️  Using MRN from patient data: '2496015' over '2496015'
[00:24:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:24:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:24:00] ✅ Patient name cross-validation successful
[00:24:00] ✅    ✅ Data merged successfully
[00:24:01] ✅    ✅ Order data extracted and validated
[00:24:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:24:01] [DOC: 9266352] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:24:01] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:24:01] 🔄 
🔄 Step 6: Pushing order to API...
[00:24:01] [DOC: 9266352] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:24:03] [DOC: 9266352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:24:03] ❌    ❌ Failed to push order
[00:24:03] 🔄 
🔄 Step 7: Writing to CSV...
[00:24:03] [DOC: 9266352] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[00:24:03] [DOC: 9266352] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:24:03] [DOC: 9266352] ℹ️  Payer Source extracted: 'Medicare'
[00:24:03] [DOC: 9266352] ℹ️  Diagnosis codes being written:
[00:24:03] [DOC: 9266352] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:24:03] [DOC: 9266352] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:24:03] [DOC: 9266352] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:24:03] [DOC: 9266352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:24:03] [DOC: 9266352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:24:03] [DOC: 9266352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:24:03] [DOC: 9266352] ✅ Patient data written to CSV: Dana Theodore | Sex: FEMALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[00:24:03] ✅    ✅ Document 9266352 processed and saved successfully
[00:24:03] 🔄 
🔄 Step 8: Saving API details...
[00:24:03] [DOC: 9266352] ℹ️  API push details saved for document 9266352
[00:24:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266346                         ║
================================================================================
[00:24:03] ℹ️  Agency: Dartmouth HH
[00:24:03] ℹ️  Date: 04/29/2025
[00:24:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:24:05] [DOC: 9266346] ✅ Text extracted using pdfplumber (4692 chars)
[00:24:05] ✅    ✅ Text extracted using pdfplumber (4692 chars)
[00:24:05] 🔄 
🔄 Step 2: Extracting patient data...
[00:24:08] ℹ️  AI extracted raw sex value: 'F'
[00:24:08] ℹ️  AI extracted service line: 'PT'
[00:24:08] ℹ️  AI extracted payer source: 'Fallon Navicare'
[00:24:08] ℹ️  AI extracted diagnoses:
[00:24:08] ℹ️    - Diagnosis 1: ''
[00:24:08] ℹ️    - Diagnosis 2: ''
[00:24:08] ℹ️    - Diagnosis 3: ''
[00:24:08] ℹ️    - Diagnosis 4: ''
[00:24:08] ℹ️    - Diagnosis 5: ''
[00:24:08] ℹ️    - Diagnosis 6: ''
[00:24:08] ℹ️  Final extracted MRN: '6046015'
[00:24:08] ℹ️  Final extracted Sex: 'FEMALE'
[00:24:08] ℹ️  Final extracted Service Line: 'PT'
[00:24:08] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[00:24:08] ✅ Patient data extraction completed successfully
[00:24:08] ✅    ✅ Patient data extracted successfully
[00:24:08] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:24:08] ✅    ✅ Patient identified: Joan Marion
[00:24:08] ✅    ✅ Patient name validation passed
[00:24:08] 🔄 
🔄 Step 3: Processing patient dates...
[00:24:08] [DOC: 9266346] ℹ️  DOB normalized: 01/04/1955
[00:24:08] [DOC: 9266346] ℹ️  Episode startOfCare normalized: 03/25/2025
[00:24:08] [DOC: 9266346] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[00:24:08] [DOC: 9266346] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[00:24:08] [DOC: 9266346] ✅ Patient date processing completed successfully
[00:24:08] ✅    ✅ Date processing completed
[00:24:08] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:24:08] 🔄 
🔄 Step 4: Extracting order data...
[00:24:10] ℹ️  Order extraction - MRN: '6046015'
[00:24:10] ℹ️  Order extraction - Sex: 'FEMALE'
[00:24:10] ℹ️  Order extraction - Service Line: 'PT'
[00:24:10] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[00:24:10] ✅ Order data extraction completed successfully
[00:24:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:24:10] ℹ️  Using MRN from patient data: '6046015' over '6046015'
[00:24:10] ℹ️  Service line consistent in both sources: 'PT'
[00:24:10] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[00:24:10] ✅ Patient name cross-validation successful
[00:24:10] ✅    ✅ Data merged successfully
[00:24:12] ✅    ✅ Order data extracted and validated
[00:24:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:24:17] [DOC: 9266346] ✅ Patient exists in API: Joan Marion, ID: 6b1f1a06-b1c5-4b8c-b7be-a10c134c6d6d
[00:24:17] ✅    ✅ Existing patient found with ID: 6b1f1a06-b1c5-4b8c-b7be-a10c134c6d6d
[00:24:17] 🔄 
🔄 Step 6: Pushing order to API...
[00:24:17] [DOC: 9266346] ℹ️  Pushing order via API for patient ID: 6b1f1a06-b1c5-4b8c-b7be-a10c134c6d6d
[00:24:18] [DOC: 9266346] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:24:18] ❌    ❌ Failed to push order
[00:24:18] 🔄 
🔄 Step 7: Writing to CSV...
[00:24:18] [DOC: 9266346] ℹ️  Calculated age: 70 from DOB: 01/04/1955
[00:24:18] [DOC: 9266346] ℹ️  Service Line extracted: 'PT'
[00:24:18] [DOC: 9266346] ℹ️  Payer Source extracted: 'Fallon Navicare'
[00:24:18] [DOC: 9266346] ℹ️  Diagnosis codes being written:
[00:24:18] [DOC: 9266346] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:24:18] [DOC: 9266346] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:24:18] [DOC: 9266346] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:24:18] [DOC: 9266346] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:24:18] [DOC: 9266346] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:24:18] [DOC: 9266346] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:24:18] [DOC: 9266346] ✅ Patient data written to CSV: Joan Marion | Sex: FEMALE | Age: 70 | Service: PT | Payer: Fallon Navicare | MRN: 6046015
[00:24:18] ✅    ✅ Document 9266346 processed and saved successfully
[00:24:18] 🔄 
🔄 Step 8: Saving API details...
[00:24:18] [DOC: 9266346] ℹ️  API push details saved for document 9266346
[00:24:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266341                         ║
================================================================================
[00:24:18] ℹ️  Agency: Dartmouth HH
[00:24:18] ℹ️  Date: 04/29/2025
[00:24:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:24:21] [DOC: 9266341] ✅ Text extracted using pdfplumber (1378 chars)
[00:24:21] ✅    ✅ Text extracted using pdfplumber (1378 chars)
[00:24:21] 🔄 
🔄 Step 2: Extracting patient data...
[00:24:24] ℹ️  AI extracted raw sex value: 'F'
[00:24:24] ℹ️  AI extracted service line: 'Physical Therapy'
[00:24:24] ℹ️  AI extracted payer source: 'Harvard Pilgrim Health Care'
[00:24:24] ℹ️  AI extracted diagnoses:
[00:24:24] ℹ️    - Diagnosis 1: 'None'
[00:24:24] ℹ️    - Diagnosis 2: 'None'
[00:24:24] ℹ️    - Diagnosis 3: 'None'
[00:24:24] ℹ️    - Diagnosis 4: 'None'
[00:24:24] ℹ️    - Diagnosis 5: 'None'
[00:24:24] ℹ️    - Diagnosis 6: 'None'
[00:24:24] ℹ️  Final extracted MRN: '6275015'
[00:24:24] ℹ️  Final extracted Sex: 'FEMALE'
[00:24:24] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:24:24] ℹ️  Final extracted Payer Source: 'Harvard Pilgrim Health Care'
[00:24:24] ✅ Patient data extraction completed successfully
[00:24:24] ✅    ✅ Patient data extracted successfully
[00:24:24] 📊 Patient Response
     └─ patientFName: Annette
     └─ patientLName: Agrella
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6275015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Harvard Pilgrim Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:24:24] ✅    ✅ Patient identified: Annette Agrella
[00:24:24] ✅    ✅ Patient name validation passed
[00:24:24] 🔄 
🔄 Step 3: Processing patient dates...
[00:24:24] [DOC: 9266341] ℹ️  DOB normalized: 03/01/1959
[00:24:24] [DOC: 9266341] ℹ️  Episode startOfCare normalized: 03/26/2025
[00:24:24] [DOC: 9266341] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[00:24:24] [DOC: 9266341] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[00:24:24] [DOC: 9266341] ✅ Patient date processing completed successfully
[00:24:24] ✅    ✅ Date processing completed
[00:24:24] 📊 Processed Patient Data
     └─ patientFName: Annette
     └─ patientLName: Agrella
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6275015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Harvard Pilgrim Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025'}]
[00:24:24] 🔄 
🔄 Step 4: Extracting order data...
[00:24:26] ℹ️  Order extraction - MRN: ''
[00:24:26] ℹ️  Order extraction - Sex: 'FEMALE'
[00:24:26] ℹ️  Order extraction - Service Line: 'PT'
[00:24:26] ℹ️  Order extraction - Payer Source: 'Harvard Pilgrim Health Care'
[00:24:26] ✅ Order data extraction completed successfully
[00:24:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:24:26] ℹ️  Using MRN from patient data: '6275015'
[00:24:26] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[00:24:26] ℹ️  Payer source consistent in both sources: 'Harvard Pilgrim Health Care'
[00:24:26] ✅ Patient name cross-validation successful
[00:24:26] ✅    ✅ Data merged successfully
[00:24:27] ✅    ✅ Order data extracted and validated
[00:24:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:24:27] [DOC: 9266341] ✅ Patient found in local cache: Annette Agrella, ID: 9c8e5242-b427-4173-ad39-442e9229c97a
[00:24:27] ✅    ✅ Existing patient found with ID: 9c8e5242-b427-4173-ad39-442e9229c97a
[00:24:27] 🔄 
🔄 Step 6: Pushing order to API...
[00:24:27] [DOC: 9266341] ℹ️  Pushing order via API for patient ID: 9c8e5242-b427-4173-ad39-442e9229c97a
[00:24:29] [DOC: 9266341] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12853"}
[00:24:29] ❌    ❌ Failed to push order
[00:24:29] 🔄 
🔄 Step 7: Writing to CSV...
[00:24:29] [DOC: 9266341] ℹ️  Calculated age: 66 from DOB: 03/01/1959
[00:24:29] [DOC: 9266341] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[00:24:29] [DOC: 9266341] ℹ️  Payer Source extracted: 'Harvard Pilgrim Health Care'
[00:24:29] [DOC: 9266341] ℹ️  Diagnosis codes being written:
[00:24:29] [DOC: 9266341] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:24:29] [DOC: 9266341] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:24:29] [DOC: 9266341] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:24:29] [DOC: 9266341] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:24:29] [DOC: 9266341] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:24:29] [DOC: 9266341] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:24:29] [DOC: 9266341] ✅ Patient data written to CSV: Annette Agrella | Sex: FEMALE | Age: 66 | Service: PT, Physical Therapy | Payer: Harvard Pilgrim Health Care | MRN: 6275015
[00:24:29] ✅    ✅ Document 9266341 processed and saved successfully
[00:24:29] 🔄 
🔄 Step 8: Saving API details...
[00:24:29] [DOC: 9266341] ℹ️  API push details saved for document 9266341
[00:24:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266332                         ║
================================================================================
[00:24:29] ℹ️  Agency: Dartmouth HH
[00:24:29] ℹ️  Date: 04/29/2025
[00:24:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:24:36] [DOC: 9266332] ✅ Text extracted using pdfplumber (10899 chars)
[00:24:36] ✅    ✅ Text extracted using pdfplumber (10899 chars)
[00:24:36] 🔄 
🔄 Step 2: Extracting patient data...
[00:24:40] ℹ️  AI extracted raw sex value: 'M'
[00:24:40] ℹ️  AI extracted service line: 'PT, RN'
[00:24:40] ℹ️  AI extracted payer source: 'None'
[00:24:40] ℹ️  AI extracted diagnoses:
[00:24:40] ℹ️    - Diagnosis 1: 'Z47.1'
[00:24:40] ℹ️    - Diagnosis 2: 'E66.3'
[00:24:40] ℹ️    - Diagnosis 3: 'Z68.28'
[00:24:40] ℹ️    - Diagnosis 4: 'I10'
[00:24:40] ℹ️    - Diagnosis 5: 'F41.9'
[00:24:40] ℹ️    - Diagnosis 6: 'R94.31'
[00:24:40] ℹ️  Final extracted MRN: '6171015'
[00:24:40] ℹ️  Final extracted Sex: 'MALE'
[00:24:40] ℹ️  Final extracted Service Line: 'PT, RN'
[00:24:40] ℹ️  Final extracted Payer Source: ''
[00:24:40] ✅ Patient data extraction completed successfully
[00:24:40] ✅    ✅ Patient data extracted successfully
[00:24:40] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Twardzik
     └─ dob: 03/04/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6171015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.3', 'thirdDiagnosis': 'Z68.28', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'R94.31'}]
[00:24:40] ✅    ✅ Patient identified: John Twardzik
[00:24:40] ✅    ✅ Patient name validation passed
[00:24:40] 🔄 
🔄 Step 3: Processing patient dates...
[00:24:40] [DOC: 9266332] ℹ️  DOB normalized: 03/04/1952
[00:24:40] [DOC: 9266332] ℹ️  Episode startOfCare normalized: 04/12/2025
[00:24:40] [DOC: 9266332] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:24:40] [DOC: 9266332] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:24:40] [DOC: 9266332] ✅ Patient date processing completed successfully
[00:24:40] ✅    ✅ Date processing completed
[00:24:40] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Twardzik
     └─ dob: 03/04/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6171015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.3', 'thirdDiagnosis': 'Z68.28', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'R94.31'}]
[00:24:40] 🔄 
🔄 Step 4: Extracting order data...
[00:24:42] ℹ️  Order extraction - MRN: '6171015'
[00:24:42] ℹ️  Order extraction - Sex: 'MALE'
[00:24:42] ℹ️  Order extraction - Service Line: 'PT'
[00:24:42] ℹ️  Order extraction - Payer Source: ''
[00:24:42] ✅ Order data extraction completed successfully
[00:24:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:24:42] ℹ️  Using MRN from patient data: '6171015' over '6171015'
[00:24:42] ℹ️  Combined service lines: Patient='PT, RN' + Order='PT' = 'PT, RN'
[00:24:42] ✅ Patient name cross-validation successful
[00:24:42] ✅    ✅ Data merged successfully
[00:24:44] ✅    ✅ Order data extracted and validated
[00:24:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:24:44] [DOC: 9266332] ✅ Patient found in local cache: John Twardzik, ID: 93692471-18b5-4de2-81ea-7b4be65fc767
[00:24:44] ✅    ✅ Existing patient found with ID: 93692471-18b5-4de2-81ea-7b4be65fc767
[00:24:44] 🔄 
🔄 Step 6: Pushing order to API...
[00:24:44] [DOC: 9266332] ℹ️  Pushing order via API for patient ID: 93692471-18b5-4de2-81ea-7b4be65fc767
[00:24:45] [DOC: 9266332] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:24:45] ❌    ❌ Failed to push order
[00:24:45] 🔄 
🔄 Step 7: Writing to CSV...
[00:24:45] [DOC: 9266332] ℹ️  Calculated age: 73 from DOB: 03/04/1952
[00:24:45] [DOC: 9266332] ℹ️  Service Line extracted: 'PT, RN'
[00:24:45] [DOC: 9266332] ℹ️  Payer Source extracted: ''
[00:24:45] [DOC: 9266332] ℹ️  Diagnosis codes being written:
[00:24:45] [DOC: 9266332] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[00:24:45] [DOC: 9266332] ℹ️    - Latest_Episode_Seconddiagnosis: 'E66.3'
[00:24:45] [DOC: 9266332] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z68.28'
[00:24:45] [DOC: 9266332] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[00:24:45] [DOC: 9266332] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[00:24:45] [DOC: 9266332] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R94.31'
[00:24:45] [DOC: 9266332] ✅ Patient data written to CSV: John Twardzik | Sex: MALE | Age: 73 | Service: PT, RN | Payer:  | MRN: 6171015
[00:24:45] ✅    ✅ Document 9266332 processed and saved successfully
[00:24:45] 🔄 
🔄 Step 8: Saving API details...
[00:24:45] [DOC: 9266332] ℹ️  API push details saved for document 9266332
[00:24:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9264860                         ║
================================================================================
[00:24:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:24:45] ℹ️  Date: 04/28/2025
[00:24:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:24:46] [DOC: 9264860] ✅ Text extracted using pdfplumber (1012 chars)
[00:24:46] ✅    ✅ Text extracted using pdfplumber (1012 chars)
[00:24:46] 🔄 
🔄 Step 2: Extracting patient data...
[00:24:49] ℹ️  AI extracted raw sex value: 'F'
[00:24:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:24:49] ℹ️  AI extracted payer source: ''
[00:24:49] ℹ️  AI extracted diagnoses:
[00:24:49] ℹ️    - Diagnosis 1: ''
[00:24:49] ℹ️    - Diagnosis 2: ''
[00:24:49] ℹ️    - Diagnosis 3: ''
[00:24:49] ℹ️    - Diagnosis 4: ''
[00:24:49] ℹ️    - Diagnosis 5: ''
[00:24:49] ℹ️    - Diagnosis 6: ''
[00:24:49] ℹ️  Final extracted MRN: '2258674'
[00:24:49] ℹ️  Final extracted Sex: 'FEMALE'
[00:24:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:24:49] ℹ️  Final extracted Payer Source: ''
[00:24:49] ✅ Patient data extraction completed successfully
[00:24:49] ✅    ✅ Patient data extracted successfully
[00:24:49] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:24:49] ✅    ✅ Patient identified: Maryann Boucher
[00:24:49] ✅    ✅ Patient name validation passed
[00:24:49] 🔄 
🔄 Step 3: Processing patient dates...
[00:24:49] [DOC: 9264860] ℹ️  DOB normalized: 03/22/1946
[00:24:49] [DOC: 9264860] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[00:24:49] [DOC: 9264860] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[00:24:49] [DOC: 9264860] ✅ Patient date processing completed successfully
[00:24:49] ✅    ✅ Date processing completed
[00:24:49] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:24:49] 🔄 
🔄 Step 4: Extracting order data...
[00:24:51] ℹ️  Order extraction - MRN: '2258674'
[00:24:51] ℹ️  Order extraction - Sex: 'FEMALE'
[00:24:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:24:51] ℹ️  Order extraction - Payer Source: ''
[00:24:51] ✅ Order data extraction completed successfully
[00:24:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:24:51] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[00:24:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:24:51] ✅ Patient name cross-validation successful
[00:24:51] ✅    ✅ Data merged successfully
[00:24:52] ✅    ✅ Order data extracted and validated
[00:24:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:24:55] [DOC: 9264860] ✅ Patient exists in API: Maryann Boucher, ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:24:55] ✅    ✅ Existing patient found with ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:24:55] 🔄 
🔄 Step 6: Pushing order to API...
[00:24:55] [DOC: 9264860] ℹ️  Pushing order via API for patient ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:24:56] [DOC: 9264860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13312"}
[00:24:56] ❌    ❌ Failed to push order
[00:24:56] 🔄 
🔄 Step 7: Writing to CSV...
[00:24:56] [DOC: 9264860] ℹ️  Calculated age: 79 from DOB: 03/22/1946
[00:24:56] [DOC: 9264860] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:24:56] [DOC: 9264860] ℹ️  Payer Source extracted: ''
[00:24:56] [DOC: 9264860] ℹ️  Diagnosis codes being written:
[00:24:56] [DOC: 9264860] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:24:56] [DOC: 9264860] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:24:56] [DOC: 9264860] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:24:56] [DOC: 9264860] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:24:56] [DOC: 9264860] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:24:56] [DOC: 9264860] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:24:56] [DOC: 9264860] ✅ Patient data written to CSV: Maryann Boucher | Sex: FEMALE | Age: 79 | Service: Skilled Nursing | Payer:  | MRN: 2258674
[00:24:56] ✅    ✅ Document 9264860 processed and saved successfully
[00:24:56] 🔄 
🔄 Step 8: Saving API details...
[00:24:56] [DOC: 9264860] ℹ️  API push details saved for document 9264860
[00:24:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9262872                         ║
================================================================================
[00:24:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:24:56] ℹ️  Date: 04/28/2025
[00:24:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:25:00] [DOC: 9262872] ✅ Text extracted using pdfplumber (17675 chars)
[00:25:00] ✅    ✅ Text extracted using pdfplumber (17675 chars)
[00:25:00] 🔄 
🔄 Step 2: Extracting patient data...
[00:25:03] ℹ️  AI extracted raw sex value: 'F'
[00:25:03] ℹ️  AI extracted service line: 'PT, OT'
[00:25:03] ℹ️  AI extracted payer source: ''
[00:25:03] ℹ️  AI extracted diagnoses:
[00:25:03] ℹ️    - Diagnosis 1: 'I120'
[00:25:03] ℹ️    - Diagnosis 2: 'N185'
[00:25:03] ℹ️    - Diagnosis 3: ''
[00:25:03] ℹ️    - Diagnosis 4: ''
[00:25:03] ℹ️    - Diagnosis 5: ''
[00:25:03] ℹ️    - Diagnosis 6: ''
[00:25:03] ℹ️  Final extracted MRN: 'MA220308043601'
[00:25:03] ℹ️  Final extracted Sex: 'FEMALE'
[00:25:03] ℹ️  Final extracted Service Line: 'PT, OT'
[00:25:03] ℹ️  Final extracted Payer Source: ''
[00:25:03] ✅ Patient data extraction completed successfully
[00:25:03] ✅    ✅ Patient data extracted successfully
[00:25:03] 📊 Patient Response
     └─ patientFName: Charlotte
     └─ patientLName: Lefrancois
     └─ dob: 04/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220308043601
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'I120', 'secondDiagnosis': 'N185', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:25:03] ✅    ✅ Patient identified: Charlotte Lefrancois
[00:25:03] ✅    ✅ Patient name validation passed
[00:25:03] 🔄 
🔄 Step 3: Processing patient dates...
[00:25:03] [DOC: 9262872] ℹ️  DOB normalized: 04/08/1936
[00:25:03] [DOC: 9262872] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[00:25:03] [DOC: 9262872] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[00:25:03] [DOC: 9262872] ✅ Patient date processing completed successfully
[00:25:03] ✅    ✅ Date processing completed
[00:25:03] 📊 Processed Patient Data
     └─ patientFName: Charlotte
     └─ patientLName: Lefrancois
     └─ dob: 04/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220308043601
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'I120', 'secondDiagnosis': 'N185', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:25:03] 🔄 
🔄 Step 4: Extracting order data...
[00:25:06] ℹ️  Order extraction - MRN: 'MA220308043601'
[00:25:06] ℹ️  Order extraction - Sex: 'FEMALE'
[00:25:06] ℹ️  Order extraction - Service Line: 'PT, OT'
[00:25:06] ℹ️  Order extraction - Payer Source: ''
[00:25:06] ✅ Order data extraction completed successfully
[00:25:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:25:06] ℹ️  Using MRN from patient data: 'MA220308043601' over 'MA220308043601'
[00:25:06] ℹ️  Service line consistent in both sources: 'PT, OT'
[00:25:06] ✅ Patient name cross-validation successful
[00:25:06] ✅    ✅ Data merged successfully
[00:25:07] ✅    ✅ Order data extracted and validated
[00:25:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:25:07] [DOC: 9262872] ✅ Patient found in local cache: Charlotte Lefrancois, ID: 405a83d6-c2bd-43bd-9432-42e1acecafca
[00:25:07] ✅    ✅ Existing patient found with ID: 405a83d6-c2bd-43bd-9432-42e1acecafca
[00:25:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:25:07] [DOC: 9262872] ℹ️  Pushing order via API for patient ID: 405a83d6-c2bd-43bd-9432-42e1acecafca
[00:25:09] [DOC: 9262872] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13923"}
[00:25:09] ❌    ❌ Failed to push order
[00:25:09] 🔄 
🔄 Step 7: Writing to CSV...
[00:25:09] [DOC: 9262872] ℹ️  Calculated age: 89 from DOB: 04/08/1936
[00:25:09] [DOC: 9262872] ℹ️  Service Line extracted: 'PT, OT'
[00:25:09] [DOC: 9262872] ℹ️  Payer Source extracted: ''
[00:25:09] [DOC: 9262872] ℹ️  Diagnosis codes being written:
[00:25:09] [DOC: 9262872] ℹ️    - Latest_Episode_Firstdiagnosis: 'I120'
[00:25:09] [DOC: 9262872] ℹ️    - Latest_Episode_Seconddiagnosis: 'N185'
[00:25:09] [DOC: 9262872] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:25:09] [DOC: 9262872] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:25:09] [DOC: 9262872] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:25:09] [DOC: 9262872] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:25:09] [DOC: 9262872] ✅ Patient data written to CSV: Charlotte Lefrancois | Sex: FEMALE | Age: 89 | Service: PT, OT | Payer:  | MRN: MA220308043601
[00:25:09] ✅    ✅ Document 9262872 processed and saved successfully
[00:25:09] 🔄 
🔄 Step 8: Saving API details...
[00:25:09] [DOC: 9262872] ℹ️  API push details saved for document 9262872
[00:25:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261908                         ║
================================================================================
[00:25:09] ℹ️  Agency: Nizhoni Health-Fall River
[00:25:09] ℹ️  Date: 04/25/2025
[00:25:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:25:19] [DOC: 9261908] ✅ Text extracted using pdfplumber (1015 chars)
[00:25:19] ✅    ✅ Text extracted using pdfplumber (1015 chars)
[00:25:19] 🔄 
🔄 Step 2: Extracting patient data...
[00:25:21] ℹ️  AI extracted raw sex value: 'F'
[00:25:21] ℹ️  AI extracted service line: 'HHA'
[00:25:21] ℹ️  AI extracted payer source: 'Medicaid/MA'
[00:25:21] ℹ️  AI extracted diagnoses:
[00:25:21] ℹ️    - Diagnosis 1: 'None'
[00:25:21] ℹ️    - Diagnosis 2: 'None'
[00:25:21] ℹ️    - Diagnosis 3: 'None'
[00:25:21] ℹ️    - Diagnosis 4: 'None'
[00:25:21] ℹ️    - Diagnosis 5: 'None'
[00:25:21] ℹ️    - Diagnosis 6: 'None'
[00:25:21] ℹ️  Final extracted MRN: '3761020'
[00:25:21] ℹ️  Final extracted Sex: 'FEMALE'
[00:25:21] ℹ️  Final extracted Service Line: 'HHA'
[00:25:21] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[00:25:21] ✅ Patient data extraction completed successfully
[00:25:21] ✅    ✅ Patient data extracted successfully
[00:25:21] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': None, 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:25:21] ✅    ✅ Patient identified: Carol Jimon-Ajqui
[00:25:21] ✅    ✅ Patient name validation passed
[00:25:21] 🔄 
🔄 Step 3: Processing patient dates...
[00:25:21] [DOC: 9261908] ℹ️  DOB normalized: 08/23/1974
[00:25:21] [DOC: 9261908] ℹ️  Episode startOfCare normalized: 01/04/2023
[00:25:21] [DOC: 9261908] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[00:25:21] [DOC: 9261908] ✅ Patient date processing completed successfully
[00:25:21] ✅    ✅ Date processing completed
[00:25:21] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'endOfEpisode': '06/21/2025'}]
[00:25:21] 🔄 
🔄 Step 4: Extracting order data...
[00:25:24] ℹ️  Order extraction - MRN: '3761020'
[00:25:24] ℹ️  Order extraction - Sex: 'FEMALE'
[00:25:24] ℹ️  Order extraction - Service Line: ''
[00:25:24] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[00:25:24] ✅ Order data extraction completed successfully
[00:25:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:25:24] ℹ️  Using MRN from patient data: '3761020' over '3761020'
[00:25:24] ℹ️  Using service line from patient data: 'HHA'
[00:25:24] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[00:25:24] ✅ Patient name cross-validation successful
[00:25:24] ✅    ✅ Data merged successfully
[00:25:25] ✅    ✅ Order data extracted and validated
[00:25:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:25:27] [DOC: 9261908] ✅ Patient exists in API: Carol Jimon-Ajqui, ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:25:27] ✅    ✅ Existing patient found with ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:25:27] 🔄 
🔄 Step 6: Pushing order to API...
[00:25:27] [DOC: 9261908] ℹ️  Pushing order via API for patient ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:25:29] [DOC: 9261908] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:25:29] ❌    ❌ Failed to push order
[00:25:29] 🔄 
🔄 Step 7: Writing to CSV...
[00:25:29] [DOC: 9261908] ℹ️  Calculated age: 50 from DOB: 08/23/1974
[00:25:29] [DOC: 9261908] ℹ️  Service Line extracted: 'HHA'
[00:25:29] [DOC: 9261908] ℹ️  Payer Source extracted: 'Medicaid/MA'
[00:25:29] [DOC: 9261908] ℹ️  Diagnosis codes being written:
[00:25:29] [DOC: 9261908] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:25:29] [DOC: 9261908] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:25:29] [DOC: 9261908] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:25:29] [DOC: 9261908] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:25:29] [DOC: 9261908] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:25:29] [DOC: 9261908] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:25:29] [DOC: 9261908] ✅ Patient data written to CSV: Carol Jimon-Ajqui | Sex: FEMALE | Age: 50 | Service: HHA | Payer: Medicaid/MA | MRN: 3761020
[00:25:29] ✅    ✅ Document 9261908 processed and saved successfully
[00:25:29] 🔄 
🔄 Step 8: Saving API details...
[00:25:29] [DOC: 9261908] ℹ️  API push details saved for document 9261908
[00:25:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261100                         ║
================================================================================
[00:25:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:25:29] ℹ️  Date: 04/25/2025
[00:25:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:25:31] [DOC: 9261100] ✅ Text extracted using pdfplumber (1431 chars)
[00:25:31] ✅    ✅ Text extracted using pdfplumber (1431 chars)
[00:25:31] 🔄 
🔄 Step 2: Extracting patient data...
[00:25:34] ℹ️  AI extracted raw sex value: ''
[00:25:34] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:25:34] ℹ️  AI extracted payer source: ''
[00:25:34] ℹ️  AI extracted diagnoses:
[00:25:34] ℹ️    - Diagnosis 1: 'J44.1'
[00:25:34] ℹ️    - Diagnosis 2: 'I11.0'
[00:25:34] ℹ️    - Diagnosis 3: 'I50.42'
[00:25:34] ℹ️    - Diagnosis 4: ''
[00:25:34] ℹ️    - Diagnosis 5: ''
[00:25:34] ℹ️    - Diagnosis 6: ''
[00:25:34] ℹ️  Final extracted MRN: 'MA200528053701'
[00:25:34] ℹ️  Final extracted Sex: ''
[00:25:34] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:25:34] ℹ️  Final extracted Payer Source: ''
[00:25:34] ✅ Patient data extraction completed successfully
[00:25:34] ✅    ✅ Patient data extracted successfully
[00:25:34] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:25:34] ✅    ✅ Patient identified: Roderick Lopez
[00:25:34] ✅    ✅ Patient name validation passed
[00:25:34] 🔄 
🔄 Step 3: Processing patient dates...
[00:25:34] [DOC: 9261100] ℹ️  DOB normalized: 05/21/1937
[00:25:34] [DOC: 9261100] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[00:25:34] [DOC: 9261100] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[00:25:34] [DOC: 9261100] ✅ Patient date processing completed successfully
[00:25:34] ✅    ✅ Date processing completed
[00:25:34] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:25:34] 🔄 
🔄 Step 4: Extracting order data...
[00:25:37] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:25:37] ℹ️  Order extraction - Sex: ''
[00:25:37] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:25:37] ℹ️  Order extraction - Payer Source: ''
[00:25:37] ✅ Order data extraction completed successfully
[00:25:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:25:37] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:25:37] ℹ️  Inferred sex as MALE from name: Roderick
[00:25:37] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:25:37] ✅ Patient name cross-validation successful
[00:25:37] ✅    ✅ Data merged successfully
[00:25:38] ✅    ✅ Order data extracted and validated
[00:25:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:25:38] [DOC: 9261100] ✅ Patient found in local cache: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:25:38] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:25:38] 🔄 
🔄 Step 6: Pushing order to API...
[00:25:38] [DOC: 9261100] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:25:39] [DOC: 9261100] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13962"}
[00:25:39] ❌    ❌ Failed to push order
[00:25:39] 🔄 
🔄 Step 7: Writing to CSV...
[00:25:39] [DOC: 9261100] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:25:39] [DOC: 9261100] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:25:39] [DOC: 9261100] ℹ️  Payer Source extracted: ''
[00:25:39] [DOC: 9261100] ℹ️  Diagnosis codes being written:
[00:25:39] [DOC: 9261100] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[00:25:39] [DOC: 9261100] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[00:25:39] [DOC: 9261100] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.42'
[00:25:39] [DOC: 9261100] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:25:39] [DOC: 9261100] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:25:39] [DOC: 9261100] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:25:39] [DOC: 9261100] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA200528053701
[00:25:39] ✅    ✅ Document 9261100 processed and saved successfully
[00:25:39] 🔄 
🔄 Step 8: Saving API details...
[00:25:39] [DOC: 9261100] ℹ️  API push details saved for document 9261100
[00:25:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261092                         ║
================================================================================
[00:25:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:25:39] ℹ️  Date: 04/25/2025
[00:25:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:25:43] [DOC: 9261092] ✅ Text extracted using pdfplumber (1331 chars)
[00:25:43] ✅    ✅ Text extracted using pdfplumber (1331 chars)
[00:25:43] 🔄 
🔄 Step 2: Extracting patient data...
[00:25:46] ℹ️  AI extracted raw sex value: ''
[00:25:46] ℹ️  AI extracted service line: 'Physical Therapy'
[00:25:46] ℹ️  AI extracted payer source: ''
[00:25:46] ℹ️  AI extracted diagnoses:
[00:25:46] ℹ️    - Diagnosis 1: 'N30.00'
[00:25:46] ℹ️    - Diagnosis 2: 'E11.9'
[00:25:46] ℹ️    - Diagnosis 3: 'F41.1'
[00:25:46] ℹ️    - Diagnosis 4: 'None'
[00:25:46] ℹ️    - Diagnosis 5: 'None'
[00:25:46] ℹ️    - Diagnosis 6: 'None'
[00:25:46] ℹ️  Final extracted MRN: '101002392'
[00:25:46] ℹ️  Final extracted Sex: ''
[00:25:46] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:25:46] ℹ️  Final extracted Payer Source: ''
[00:25:46] ✅ Patient data extraction completed successfully
[00:25:46] ✅    ✅ Patient data extracted successfully
[00:25:46] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:25:46] ✅    ✅ Patient identified: Virginia Brunton
[00:25:46] ✅    ✅ Patient name validation passed
[00:25:46] 🔄 
🔄 Step 3: Processing patient dates...
[00:25:46] [DOC: 9261092] ℹ️  DOB normalized: 06/05/1940
[00:25:46] [DOC: 9261092] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:25:46] [DOC: 9261092] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:25:46] [DOC: 9261092] ✅ Patient date processing completed successfully
[00:25:46] ✅    ✅ Date processing completed
[00:25:46] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[00:25:46] 🔄 
🔄 Step 4: Extracting order data...
[00:25:49] ℹ️  Order extraction - MRN: '101002392'
[00:25:49] ℹ️  Order extraction - Sex: ''
[00:25:49] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:25:49] ℹ️  Order extraction - Payer Source: ''
[00:25:49] ✅ Order data extraction completed successfully
[00:25:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:25:49] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:25:49] ℹ️  Inferred sex as FEMALE from name: Virginia
[00:25:49] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:25:49] ✅ Patient name cross-validation successful
[00:25:49] ✅    ✅ Data merged successfully
[00:25:50] ✅    ✅ Order data extracted and validated
[00:25:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:25:50] [DOC: 9261092] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:25:50] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:25:50] 🔄 
🔄 Step 6: Pushing order to API...
[00:25:50] [DOC: 9261092] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:25:52] [DOC: 9261092] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13404"}
[00:25:52] ❌    ❌ Failed to push order
[00:25:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:25:52] [DOC: 9261092] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:25:52] [DOC: 9261092] ℹ️  Service Line extracted: 'Physical Therapy'
[00:25:52] [DOC: 9261092] ℹ️  Payer Source extracted: ''
[00:25:52] [DOC: 9261092] ℹ️  Diagnosis codes being written:
[00:25:52] [DOC: 9261092] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:25:52] [DOC: 9261092] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:25:52] [DOC: 9261092] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:25:52] [DOC: 9261092] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:25:52] [DOC: 9261092] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:25:52] [DOC: 9261092] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:25:52] [DOC: 9261092] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Physical Therapy | Payer:  | MRN: 101002392
[00:25:52] ✅    ✅ Document 9261092 processed and saved successfully
[00:25:52] 🔄 
🔄 Step 8: Saving API details...
[00:25:52] [DOC: 9261092] ℹ️  API push details saved for document 9261092
[00:25:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261089                         ║
================================================================================
[00:25:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:25:52] ℹ️  Date: 04/25/2025
[00:25:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:25:56] [DOC: 9261089] ✅ Text extracted using pdfplumber (17224 chars)
[00:25:56] ✅    ✅ Text extracted using pdfplumber (17224 chars)
[00:25:56] 🔄 
🔄 Step 2: Extracting patient data...
[00:25:59] ℹ️  AI extracted raw sex value: 'F'
[00:25:59] ℹ️  AI extracted service line: 'PT'
[00:25:59] ℹ️  AI extracted payer source: 'None'
[00:25:59] ℹ️  AI extracted diagnoses:
[00:25:59] ℹ️    - Diagnosis 1: 'UTI'
[00:25:59] ℹ️    - Diagnosis 2: 'Vertigo'
[00:25:59] ℹ️    - Diagnosis 3: 'None'
[00:25:59] ℹ️    - Diagnosis 4: 'None'
[00:25:59] ℹ️    - Diagnosis 5: 'None'
[00:25:59] ℹ️    - Diagnosis 6: 'None'
[00:25:59] ℹ️  Final extracted MRN: '101002392'
[00:25:59] ℹ️  Final extracted Sex: 'FEMALE'
[00:25:59] ℹ️  Final extracted Service Line: 'PT'
[00:25:59] ℹ️  Final extracted Payer Source: ''
[00:25:59] ✅ Patient data extraction completed successfully
[00:25:59] ✅    ✅ Patient data extracted successfully
[00:25:59] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/17/2025', 'endOfEpisode': None, 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:25:59] ✅    ✅ Patient identified: Virginia Brunton
[00:25:59] ✅    ✅ Patient name validation passed
[00:25:59] 🔄 
🔄 Step 3: Processing patient dates...
[00:25:59] [DOC: 9261089] ℹ️  DOB normalized: 06/05/1940
[00:25:59] [DOC: 9261089] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[00:25:59] [DOC: 9261089] ✅ Patient date processing completed successfully
[00:25:59] ✅    ✅ Date processing completed
[00:25:59] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/17/2025', 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo'}]
[00:25:59] 🔄 
🔄 Step 4: Extracting order data...
[00:26:02] ℹ️  Order extraction - MRN: '101002392'
[00:26:02] ℹ️  Order extraction - Sex: 'FEMALE'
[00:26:02] ℹ️  Order extraction - Service Line: 'PT'
[00:26:02] ℹ️  Order extraction - Payer Source: ''
[00:26:02] ✅ Order data extraction completed successfully
[00:26:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:26:02] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:26:02] ℹ️  Service line consistent in both sources: 'PT'
[00:26:02] ✅ Patient name cross-validation successful
[00:26:02] ✅    ✅ Data merged successfully
[00:26:04] ✅    ✅ Order data extracted and validated
[00:26:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:26:04] [DOC: 9261089] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:26:04] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:26:04] 🔄 
🔄 Step 6: Pushing order to API...
[00:26:04] [DOC: 9261089] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:26:05] [DOC: 9261089] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:26:05] ❌    ❌ Failed to push order
[00:26:05] 🔄 
🔄 Step 7: Writing to CSV...
[00:26:05] [DOC: 9261089] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:26:05] [DOC: 9261089] ℹ️  Service Line extracted: 'PT'
[00:26:05] [DOC: 9261089] ℹ️  Payer Source extracted: ''
[00:26:05] [DOC: 9261089] ℹ️  Diagnosis codes being written:
[00:26:05] [DOC: 9261089] ℹ️    - Latest_Episode_Firstdiagnosis: 'UTI'
[00:26:05] [DOC: 9261089] ℹ️    - Latest_Episode_Seconddiagnosis: 'Vertigo'
[00:26:05] [DOC: 9261089] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:26:05] [DOC: 9261089] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:26:05] [DOC: 9261089] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:26:05] [DOC: 9261089] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:26:05] [DOC: 9261089] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: PT | Payer:  | MRN: 101002392
[00:26:05] ✅    ✅ Document 9261089 processed and saved successfully
[00:26:05] 🔄 
🔄 Step 8: Saving API details...
[00:26:05] [DOC: 9261089] ℹ️  API push details saved for document 9261089
[00:26:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261080                         ║
================================================================================
[00:26:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:26:05] ℹ️  Date: 04/25/2025
[00:26:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:26:08] [DOC: 9261080] ✅ Text extracted using pdfplumber (1475 chars)
[00:26:08] ✅    ✅ Text extracted using pdfplumber (1475 chars)
[00:26:08] 🔄 
🔄 Step 2: Extracting patient data...
[00:26:11] ℹ️  AI extracted raw sex value: ''
[00:26:11] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:26:11] ℹ️  AI extracted payer source: ''
[00:26:11] ℹ️  AI extracted diagnoses:
[00:26:11] ℹ️    - Diagnosis 1: 'F03.90'
[00:26:11] ℹ️    - Diagnosis 2: 'R60.9'
[00:26:11] ℹ️    - Diagnosis 3: 'G47.9'
[00:26:11] ℹ️    - Diagnosis 4: 'None'
[00:26:11] ℹ️    - Diagnosis 5: 'None'
[00:26:11] ℹ️    - Diagnosis 6: 'None'
[00:26:11] ℹ️  Final extracted MRN: 'MA221012023702'
[00:26:11] ℹ️  Final extracted Sex: ''
[00:26:11] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:26:11] ℹ️  Final extracted Payer Source: ''
[00:26:11] ✅ Patient data extraction completed successfully
[00:26:11] ✅    ✅ Patient data extracted successfully
[00:26:11] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:26:11] ✅    ✅ Patient identified: Mary Pedra
[00:26:11] ✅    ✅ Patient name validation passed
[00:26:11] 🔄 
🔄 Step 3: Processing patient dates...
[00:26:11] [DOC: 9261080] ℹ️  DOB normalized: 02/27/1937
[00:26:11] [DOC: 9261080] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[00:26:11] [DOC: 9261080] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[00:26:11] [DOC: 9261080] ✅ Patient date processing completed successfully
[00:26:11] ✅    ✅ Date processing completed
[00:26:11] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9'}]
[00:26:11] 🔄 
🔄 Step 4: Extracting order data...
[00:26:14] ℹ️  Order extraction - MRN: 'MA221012023702'
[00:26:14] ℹ️  Order extraction - Sex: ''
[00:26:14] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:26:14] ℹ️  Order extraction - Payer Source: ''
[00:26:14] ✅ Order data extraction completed successfully
[00:26:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:26:14] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[00:26:14] ℹ️  Inferred sex as FEMALE from name: Mary
[00:26:14] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:26:14] ✅ Patient name cross-validation successful
[00:26:14] ✅    ✅ Data merged successfully
[00:26:15] ✅    ✅ Order data extracted and validated
[00:26:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:26:15] [DOC: 9261080] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:15] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:15] 🔄 
🔄 Step 6: Pushing order to API...
[00:26:15] [DOC: 9261080] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:17] [DOC: 9261080] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12991"}
[00:26:17] ❌    ❌ Failed to push order
[00:26:17] 🔄 
🔄 Step 7: Writing to CSV...
[00:26:17] [DOC: 9261080] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[00:26:17] [DOC: 9261080] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:26:17] [DOC: 9261080] ℹ️  Payer Source extracted: ''
[00:26:17] [DOC: 9261080] ℹ️  Diagnosis codes being written:
[00:26:17] [DOC: 9261080] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:26:17] [DOC: 9261080] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[00:26:17] [DOC: 9261080] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[00:26:17] [DOC: 9261080] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:26:17] [DOC: 9261080] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:26:17] [DOC: 9261080] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:26:17] [DOC: 9261080] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA221012023702
[00:26:17] ✅    ✅ Document 9261080 processed and saved successfully
[00:26:17] 🔄 
🔄 Step 8: Saving API details...
[00:26:17] [DOC: 9261080] ℹ️  API push details saved for document 9261080
[00:26:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261076                         ║
================================================================================
[00:26:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:26:17] ℹ️  Date: 04/25/2025
[00:26:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:26:19] [DOC: 9261076] ✅ Text extracted using pdfplumber (1471 chars)
[00:26:19] ✅    ✅ Text extracted using pdfplumber (1471 chars)
[00:26:19] 🔄 
🔄 Step 2: Extracting patient data...
[00:26:22] ℹ️  AI extracted raw sex value: ''
[00:26:22] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:26:22] ℹ️  AI extracted payer source: ''
[00:26:22] ℹ️  AI extracted diagnoses:
[00:26:22] ℹ️    - Diagnosis 1: 'F03.90'
[00:26:22] ℹ️    - Diagnosis 2: 'R60.9'
[00:26:22] ℹ️    - Diagnosis 3: 'G47.9'
[00:26:22] ℹ️    - Diagnosis 4: ''
[00:26:22] ℹ️    - Diagnosis 5: ''
[00:26:22] ℹ️    - Diagnosis 6: ''
[00:26:22] ℹ️  Final extracted MRN: 'MA221012023702'
[00:26:22] ℹ️  Final extracted Sex: ''
[00:26:22] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:26:22] ℹ️  Final extracted Payer Source: ''
[00:26:22] ✅ Patient data extraction completed successfully
[00:26:22] ✅    ✅ Patient data extracted successfully
[00:26:22] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:26:22] ✅    ✅ Patient identified: Mary Pedra
[00:26:22] ✅    ✅ Patient name validation passed
[00:26:22] 🔄 
🔄 Step 3: Processing patient dates...
[00:26:22] [DOC: 9261076] ℹ️  DOB normalized: 02/27/1937
[00:26:22] [DOC: 9261076] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[00:26:22] [DOC: 9261076] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[00:26:22] [DOC: 9261076] ✅ Patient date processing completed successfully
[00:26:22] ✅    ✅ Date processing completed
[00:26:22] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:26:22] 🔄 
🔄 Step 4: Extracting order data...
[00:26:25] ℹ️  Order extraction - MRN: 'MA221012023702'
[00:26:25] ℹ️  Order extraction - Sex: ''
[00:26:25] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:26:25] ℹ️  Order extraction - Payer Source: ''
[00:26:25] ✅ Order data extraction completed successfully
[00:26:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:26:25] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[00:26:25] ℹ️  Inferred sex as FEMALE from name: Mary
[00:26:25] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:26:25] ✅ Patient name cross-validation successful
[00:26:25] ✅    ✅ Data merged successfully
[00:26:26] ✅    ✅ Order data extracted and validated
[00:26:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:26:26] [DOC: 9261076] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:26] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:26] 🔄 
🔄 Step 6: Pushing order to API...
[00:26:26] [DOC: 9261076] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:28] [DOC: 9261076] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12992"}
[00:26:28] ❌    ❌ Failed to push order
[00:26:28] 🔄 
🔄 Step 7: Writing to CSV...
[00:26:28] [DOC: 9261076] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[00:26:28] [DOC: 9261076] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:26:28] [DOC: 9261076] ℹ️  Payer Source extracted: ''
[00:26:28] [DOC: 9261076] ℹ️  Diagnosis codes being written:
[00:26:28] [DOC: 9261076] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:26:28] [DOC: 9261076] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[00:26:28] [DOC: 9261076] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[00:26:28] [DOC: 9261076] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:26:28] [DOC: 9261076] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:26:28] [DOC: 9261076] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:26:28] [DOC: 9261076] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA221012023702
[00:26:28] ✅    ✅ Document 9261076 processed and saved successfully
[00:26:28] 🔄 
🔄 Step 8: Saving API details...
[00:26:28] [DOC: 9261076] ℹ️  API push details saved for document 9261076
[00:26:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261073                         ║
================================================================================
[00:26:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:26:28] ℹ️  Date: 04/25/2025
[00:26:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:26:30] [DOC: 9261073] ✅ Text extracted using pdfplumber (1491 chars)
[00:26:30] ✅    ✅ Text extracted using pdfplumber (1491 chars)
[00:26:30] 🔄 
🔄 Step 2: Extracting patient data...
[00:26:33] ℹ️  AI extracted raw sex value: ''
[00:26:33] ℹ️  AI extracted service line: 'Physical Therapy'
[00:26:33] ℹ️  AI extracted payer source: ''
[00:26:33] ℹ️  AI extracted diagnoses:
[00:26:33] ℹ️    - Diagnosis 1: 'F03.90'
[00:26:33] ℹ️    - Diagnosis 2: 'R60.9'
[00:26:33] ℹ️    - Diagnosis 3: 'G47.9'
[00:26:33] ℹ️    - Diagnosis 4: 'None'
[00:26:33] ℹ️    - Diagnosis 5: 'None'
[00:26:33] ℹ️    - Diagnosis 6: 'None'
[00:26:33] ℹ️  Final extracted MRN: 'MA221012023702'
[00:26:33] ℹ️  Final extracted Sex: ''
[00:26:33] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:26:33] ℹ️  Final extracted Payer Source: ''
[00:26:33] ✅ Patient data extraction completed successfully
[00:26:33] ✅    ✅ Patient data extracted successfully
[00:26:33] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:26:33] ✅    ✅ Patient identified: Mary Pedra
[00:26:33] ✅    ✅ Patient name validation passed
[00:26:33] 🔄 
🔄 Step 3: Processing patient dates...
[00:26:33] [DOC: 9261073] ℹ️  DOB normalized: 02/27/1937
[00:26:33] [DOC: 9261073] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[00:26:33] [DOC: 9261073] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[00:26:33] [DOC: 9261073] ✅ Patient date processing completed successfully
[00:26:33] ✅    ✅ Date processing completed
[00:26:33] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9'}]
[00:26:33] 🔄 
🔄 Step 4: Extracting order data...
[00:26:35] ℹ️  Order extraction - MRN: 'MA221012023702'
[00:26:35] ℹ️  Order extraction - Sex: ''
[00:26:35] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:26:35] ℹ️  Order extraction - Payer Source: ''
[00:26:35] ✅ Order data extraction completed successfully
[00:26:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:26:35] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[00:26:35] ℹ️  Inferred sex as FEMALE from name: Mary
[00:26:35] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:26:35] ✅ Patient name cross-validation successful
[00:26:35] ✅    ✅ Data merged successfully
[00:26:36] ✅    ✅ Order data extracted and validated
[00:26:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:26:36] [DOC: 9261073] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:36] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:36] 🔄 
🔄 Step 6: Pushing order to API...
[00:26:36] [DOC: 9261073] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:26:37] [DOC: 9261073] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12993"}
[00:26:37] ❌    ❌ Failed to push order
[00:26:37] 🔄 
🔄 Step 7: Writing to CSV...
[00:26:37] [DOC: 9261073] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[00:26:37] [DOC: 9261073] ℹ️  Service Line extracted: 'Physical Therapy'
[00:26:37] [DOC: 9261073] ℹ️  Payer Source extracted: ''
[00:26:37] [DOC: 9261073] ℹ️  Diagnosis codes being written:
[00:26:37] [DOC: 9261073] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:26:37] [DOC: 9261073] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[00:26:37] [DOC: 9261073] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[00:26:37] [DOC: 9261073] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:26:37] [DOC: 9261073] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:26:37] [DOC: 9261073] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:26:37] [DOC: 9261073] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA221012023702
[00:26:37] ✅    ✅ Document 9261073 processed and saved successfully
[00:26:37] 🔄 
🔄 Step 8: Saving API details...
[00:26:37] [DOC: 9261073] ℹ️  API push details saved for document 9261073
[00:26:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258525                         ║
================================================================================
[00:26:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:26:37] ℹ️  Date: 04/24/2025
[00:26:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:26:44] [DOC: 9258525] ✅ Text extracted using pdfplumber (4255 chars)
[00:26:44] ✅    ✅ Text extracted using pdfplumber (4243 chars)
[00:26:44] 🔄 
🔄 Step 2: Extracting patient data...
[00:26:47] ℹ️  AI extracted raw sex value: ''
[00:26:47] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:26:47] ℹ️  AI extracted payer source: ''
[00:26:47] ℹ️  AI extracted diagnoses:
[00:26:47] ℹ️    - Diagnosis 1: 'E11.65'
[00:26:47] ℹ️    - Diagnosis 2: 'E03.9'
[00:26:47] ℹ️    - Diagnosis 3: 'E55.9'
[00:26:47] ℹ️    - Diagnosis 4: 'None'
[00:26:47] ℹ️    - Diagnosis 5: 'None'
[00:26:47] ℹ️    - Diagnosis 6: 'None'
[00:26:47] ℹ️  Final extracted MRN: 'MA241011025604'
[00:26:47] ℹ️  Final extracted Sex: ''
[00:26:47] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:26:47] ℹ️  Final extracted Payer Source: ''
[00:26:47] ✅ Patient data extraction completed successfully
[00:26:47] ✅    ✅ Patient data extracted successfully
[00:26:47] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:26:47] ✅    ✅ Patient identified: Maria Medeiros
[00:26:47] ✅    ✅ Patient name validation passed
[00:26:47] 🔄 
🔄 Step 3: Processing patient dates...
[00:26:47] [DOC: 9258525] ℹ️  DOB normalized: 02/04/1956
[00:26:47] [DOC: 9258525] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:26:47] [DOC: 9258525] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:26:47] [DOC: 9258525] ✅ Patient date processing completed successfully
[00:26:47] ✅    ✅ Date processing completed
[00:26:47] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9'}]
[00:26:47] 🔄 
🔄 Step 4: Extracting order data...
[00:26:50] ℹ️  Order extraction - MRN: 'MA241011025604'
[00:26:50] ℹ️  Order extraction - Sex: ''
[00:26:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:26:50] ℹ️  Order extraction - Payer Source: ''
[00:26:50] ✅ Order data extraction completed successfully
[00:26:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:26:50] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[00:26:50] ℹ️  Inferred sex as FEMALE from name: Maria
[00:26:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:26:50] ✅ Patient name cross-validation successful
[00:26:50] ✅    ✅ Data merged successfully
[00:26:51] ✅    ✅ Order data extracted and validated
[00:26:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:26:51] [DOC: 9258525] ✅ Patient found in local cache: Maria Medeiros, ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:26:51] ✅    ✅ Existing patient found with ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:26:51] 🔄 
🔄 Step 6: Pushing order to API...
[00:26:51] [DOC: 9258525] ℹ️  Pushing order via API for patient ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:26:52] [DOC: 9258525] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14079"}
[00:26:52] ❌    ❌ Failed to push order
[00:26:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:26:52] [DOC: 9258525] ℹ️  Calculated age: 69 from DOB: 02/04/1956
[00:26:52] [DOC: 9258525] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:26:52] [DOC: 9258525] ℹ️  Payer Source extracted: ''
[00:26:52] [DOC: 9258525] ℹ️  Diagnosis codes being written:
[00:26:52] [DOC: 9258525] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[00:26:52] [DOC: 9258525] ℹ️    - Latest_Episode_Seconddiagnosis: 'E03.9'
[00:26:52] [DOC: 9258525] ℹ️    - Latest_Episode_Thirddiagnosis: 'E55.9'
[00:26:52] [DOC: 9258525] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:26:52] [DOC: 9258525] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:26:52] [DOC: 9258525] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:26:52] [DOC: 9258525] ✅ Patient data written to CSV: Maria Medeiros | Sex: FEMALE | Age: 69 | Service: Skilled Nursing | Payer:  | MRN: MA241011025604
[00:26:52] ✅    ✅ Document 9258525 processed and saved successfully
[00:26:52] 🔄 
🔄 Step 8: Saving API details...
[00:26:52] [DOC: 9258525] ℹ️  API push details saved for document 9258525
[00:26:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258524                         ║
================================================================================
[00:26:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:26:52] ℹ️  Date: 04/24/2025
[00:26:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:26:55] [DOC: 9258524] ✅ Text extracted using pdfplumber (1488 chars)
[00:26:55] ✅    ✅ Text extracted using pdfplumber (1476 chars)
[00:26:55] 🔄 
🔄 Step 2: Extracting patient data...
[00:26:58] ℹ️  AI extracted raw sex value: ''
[00:26:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:26:58] ℹ️  AI extracted payer source: ''
[00:26:58] ℹ️  AI extracted diagnoses:
[00:26:58] ℹ️    - Diagnosis 1: 'E11.65'
[00:26:58] ℹ️    - Diagnosis 2: 'E03.9'
[00:26:58] ℹ️    - Diagnosis 3: 'E55.9'
[00:26:58] ℹ️    - Diagnosis 4: ''
[00:26:58] ℹ️    - Diagnosis 5: ''
[00:26:58] ℹ️    - Diagnosis 6: ''
[00:26:58] ℹ️  Final extracted MRN: 'MA241011025604'
[00:26:58] ℹ️  Final extracted Sex: ''
[00:26:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:26:58] ℹ️  Final extracted Payer Source: ''
[00:26:58] ✅ Patient data extraction completed successfully
[00:26:58] ✅    ✅ Patient data extracted successfully
[00:26:58] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:26:58] ✅    ✅ Patient identified: Maria Medeiros
[00:26:58] ✅    ✅ Patient name validation passed
[00:26:58] 🔄 
🔄 Step 3: Processing patient dates...
[00:26:58] [DOC: 9258524] ℹ️  DOB normalized: 02/04/1956
[00:26:58] [DOC: 9258524] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:26:58] [DOC: 9258524] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:26:58] [DOC: 9258524] ✅ Patient date processing completed successfully
[00:26:58] ✅    ✅ Date processing completed
[00:26:58] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:26:58] 🔄 
🔄 Step 4: Extracting order data...
[00:27:01] ℹ️  Order extraction - MRN: 'MA241011025604'
[00:27:01] ℹ️  Order extraction - Sex: ''
[00:27:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:27:01] ℹ️  Order extraction - Payer Source: ''
[00:27:01] ✅ Order data extraction completed successfully
[00:27:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:27:01] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[00:27:01] ℹ️  Inferred sex as FEMALE from name: Maria
[00:27:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:27:01] ✅ Patient name cross-validation successful
[00:27:01] ✅    ✅ Data merged successfully
[00:27:02] ✅    ✅ Order data extracted and validated
[00:27:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:27:02] [DOC: 9258524] ✅ Patient found in local cache: Maria Medeiros, ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:27:02] ✅    ✅ Existing patient found with ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:27:02] 🔄 
🔄 Step 6: Pushing order to API...
[00:27:02] [DOC: 9258524] ℹ️  Pushing order via API for patient ID: 1930f44b-291e-4aad-a56f-dcede72670be
[00:27:04] [DOC: 9258524] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14081"}
[00:27:04] ❌    ❌ Failed to push order
[00:27:04] 🔄 
🔄 Step 7: Writing to CSV...
[00:27:04] [DOC: 9258524] ℹ️  Calculated age: 69 from DOB: 02/04/1956
[00:27:04] [DOC: 9258524] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:27:04] [DOC: 9258524] ℹ️  Payer Source extracted: ''
[00:27:04] [DOC: 9258524] ℹ️  Diagnosis codes being written:
[00:27:04] [DOC: 9258524] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[00:27:04] [DOC: 9258524] ℹ️    - Latest_Episode_Seconddiagnosis: 'E03.9'
[00:27:04] [DOC: 9258524] ℹ️    - Latest_Episode_Thirddiagnosis: 'E55.9'
[00:27:04] [DOC: 9258524] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:27:04] [DOC: 9258524] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:27:04] [DOC: 9258524] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:27:04] [DOC: 9258524] ✅ Patient data written to CSV: Maria Medeiros | Sex: FEMALE | Age: 69 | Service: Skilled Nursing | Payer:  | MRN: MA241011025604
[00:27:04] ✅    ✅ Document 9258524 processed and saved successfully
[00:27:04] 🔄 
🔄 Step 8: Saving API details...
[00:27:04] [DOC: 9258524] ℹ️  API push details saved for document 9258524
[00:27:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9255635                         ║
================================================================================
[00:27:04] ℹ️  Agency: Nizhoni Health-Fall River
[00:27:04] ℹ️  Date: 04/23/2025
[00:27:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:27:10] [DOC: 9255635] ✅ Text extracted using pdfplumber (1642 chars)
[00:27:10] ✅    ✅ Text extracted using pdfplumber (1642 chars)
[00:27:10] 🔄 
🔄 Step 2: Extracting patient data...
[00:27:13] ℹ️  AI extracted raw sex value: 'M'
[00:27:13] ℹ️  AI extracted service line: 'HHA'
[00:27:13] ℹ️  AI extracted payer source: 'Self Pay'
[00:27:13] ℹ️  AI extracted diagnoses:
[00:27:13] ℹ️    - Diagnosis 1: ''
[00:27:13] ℹ️    - Diagnosis 2: ''
[00:27:13] ℹ️    - Diagnosis 3: ''
[00:27:13] ℹ️    - Diagnosis 4: ''
[00:27:13] ℹ️    - Diagnosis 5: ''
[00:27:13] ℹ️    - Diagnosis 6: ''
[00:27:13] ℹ️  Final extracted MRN: '3947012'
[00:27:13] ℹ️  Final extracted Sex: 'MALE'
[00:27:13] ℹ️  Final extracted Service Line: 'HHA'
[00:27:13] ℹ️  Final extracted Payer Source: 'Self Pay'
[00:27:13] ✅ Patient data extraction completed successfully
[00:27:13] ✅    ✅ Patient data extracted successfully
[00:27:13] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Bartley
     └─ dob: 10/08/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 3947012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 498 County Rd West
     └─ city: Wareham
     └─ state: MA
     └─ zip: 02576
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Self Pay
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:27:13] ✅    ✅ Patient identified: Richard Bartley
[00:27:13] ✅    ✅ Patient name validation passed
[00:27:13] 🔄 
🔄 Step 3: Processing patient dates...
[00:27:13] [DOC: 9255635] ℹ️  DOB normalized: 10/08/1962
[00:27:13] [DOC: 9255635] ℹ️  Episode startOfCare normalized: 10/20/2023
[00:27:13] [DOC: 9255635] ℹ️  Episode startOfEpisode normalized: 02/11/2025
[00:27:13] [DOC: 9255635] ℹ️  Episode endOfEpisode normalized: 04/11/2025
[00:27:13] [DOC: 9255635] ✅ Patient date processing completed successfully
[00:27:13] ✅    ✅ Date processing completed
[00:27:13] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Bartley
     └─ dob: 10/08/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 3947012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 498 County Rd West
     └─ city: Wareham
     └─ state: MA
     └─ zip: 02576
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Self Pay
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:27:13] 🔄 
🔄 Step 4: Extracting order data...
[00:27:15] ℹ️  Order extraction - MRN: '3947012'
[00:27:15] ℹ️  Order extraction - Sex: 'MALE'
[00:27:15] ℹ️  Order extraction - Service Line: 'HHA'
[00:27:15] ℹ️  Order extraction - Payer Source: 'Self Pay'
[00:27:15] ✅ Order data extraction completed successfully
[00:27:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:27:15] ℹ️  Using MRN from patient data: '3947012' over '3947012'
[00:27:15] ℹ️  Service line consistent in both sources: 'HHA'
[00:27:15] ℹ️  Payer source consistent in both sources: 'Self Pay'
[00:27:15] ✅ Patient name cross-validation successful
[00:27:15] ✅    ✅ Data merged successfully
[00:27:17] ✅    ✅ Order data extracted and validated
[00:27:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:27:17] [DOC: 9255635] ✅ Patient found in local cache: Richard Bartley, ID: 92b45a6e-a736-4268-8194-cda2951c948d
[00:27:17] ✅    ✅ Existing patient found with ID: 92b45a6e-a736-4268-8194-cda2951c948d
[00:27:17] 🔄 
🔄 Step 6: Pushing order to API...
[00:27:17] [DOC: 9255635] ℹ️  Pushing order via API for patient ID: 92b45a6e-a736-4268-8194-cda2951c948d
[00:27:18] [DOC: 9255635] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:27:18] ❌    ❌ Failed to push order
[00:27:18] 🔄 
🔄 Step 7: Writing to CSV...
[00:27:18] [DOC: 9255635] ℹ️  Calculated age: 62 from DOB: 10/08/1962
[00:27:18] [DOC: 9255635] ℹ️  Service Line extracted: 'HHA'
[00:27:18] [DOC: 9255635] ℹ️  Payer Source extracted: 'Self Pay'
[00:27:18] [DOC: 9255635] ℹ️  Diagnosis codes being written:
[00:27:18] [DOC: 9255635] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:27:18] [DOC: 9255635] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:27:18] [DOC: 9255635] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:27:18] [DOC: 9255635] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:27:18] [DOC: 9255635] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:27:18] [DOC: 9255635] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:27:18] [DOC: 9255635] ✅ Patient data written to CSV: Richard Bartley | Sex: MALE | Age: 62 | Service: HHA | Payer: Self Pay | MRN: 3947012
[00:27:18] ✅    ✅ Document 9255635 processed and saved successfully
[00:27:18] 🔄 
🔄 Step 8: Saving API details...
[00:27:18] [DOC: 9255635] ℹ️  API push details saved for document 9255635
[00:27:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9254802                         ║
================================================================================
[00:27:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:27:18] ℹ️  Date: 04/22/2025
[00:27:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:27:19] [DOC: 9254802] ✅ Text extracted using pdfplumber (1213 chars)
[00:27:19] ✅    ✅ Text extracted using pdfplumber (1213 chars)
[00:27:19] 🔄 
🔄 Step 2: Extracting patient data...
[00:27:22] ℹ️  AI extracted raw sex value: 'M'
[00:27:22] ℹ️  AI extracted service line: 'PT'
[00:27:22] ℹ️  AI extracted payer source: ''
[00:27:22] ℹ️  AI extracted diagnoses:
[00:27:22] ℹ️    - Diagnosis 1: 'None'
[00:27:22] ℹ️    - Diagnosis 2: 'None'
[00:27:22] ℹ️    - Diagnosis 3: 'None'
[00:27:22] ℹ️    - Diagnosis 4: 'None'
[00:27:22] ℹ️    - Diagnosis 5: 'None'
[00:27:22] ℹ️    - Diagnosis 6: 'None'
[00:27:22] ℹ️  Final extracted MRN: '2126718'
[00:27:22] ℹ️  Final extracted Sex: 'MALE'
[00:27:22] ℹ️  Final extracted Service Line: 'PT'
[00:27:22] ℹ️  Final extracted Payer Source: ''
[00:27:22] ✅ Patient data extraction completed successfully
[00:27:22] ✅    ✅ Patient data extracted successfully
[00:27:22] 📊 Patient Response
     └─ patientFName: Gabriel
     └─ patientLName: Ditata
     └─ dob: 03/18/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2126718
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:27:22] ✅    ✅ Patient identified: Gabriel Ditata
[00:27:22] ✅    ✅ Patient name validation passed
[00:27:22] 🔄 
🔄 Step 3: Processing patient dates...
[00:27:22] [DOC: 9254802] ℹ️  DOB normalized: 03/18/1933
[00:27:22] [DOC: 9254802] ✅ Patient date processing completed successfully
[00:27:22] ✅    ✅ Date processing completed
[00:27:22] 📊 Processed Patient Data
     └─ patientFName: Gabriel
     └─ patientLName: Ditata
     └─ dob: 03/18/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2126718
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[00:27:22] 🔄 
🔄 Step 4: Extracting order data...
[00:27:24] ℹ️  Order extraction - MRN: '2126718'
[00:27:24] ℹ️  Order extraction - Sex: 'MALE'
[00:27:24] ℹ️  Order extraction - Service Line: ''
[00:27:24] ℹ️  Order extraction - Payer Source: ''
[00:27:24] ✅ Order data extraction completed successfully
[00:27:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:27:24] ℹ️  Using MRN from patient data: '2126718' over '2126718'
[00:27:24] ℹ️  Using service line from patient data: 'PT'
[00:27:24] ✅ Patient name cross-validation successful
[00:27:24] ✅    ✅ Data merged successfully
[00:27:26] ⚠️     ❌ Skipping - missing episode start date
[00:27:26] [DOC: 9254802] ℹ️  API push details saved for document 9254802
================================================================================
║                        Processing Document ID: 9254748                         ║
================================================================================
[00:27:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:27:26] ℹ️  Date: 04/22/2025
[00:27:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:27:27] [DOC: 9254748] ✅ Text extracted using pdfplumber (1324 chars)
[00:27:27] ✅    ✅ Text extracted using pdfplumber (1324 chars)
[00:27:27] 🔄 
🔄 Step 2: Extracting patient data...
[00:27:30] ℹ️  AI extracted raw sex value: 'F'
[00:27:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:27:30] ℹ️  AI extracted payer source: ''
[00:27:30] ℹ️  AI extracted diagnoses:
[00:27:30] ℹ️    - Diagnosis 1: 'None'
[00:27:30] ℹ️    - Diagnosis 2: 'None'
[00:27:30] ℹ️    - Diagnosis 3: 'None'
[00:27:30] ℹ️    - Diagnosis 4: 'None'
[00:27:30] ℹ️    - Diagnosis 5: 'None'
[00:27:30] ℹ️    - Diagnosis 6: 'None'
[00:27:30] ℹ️  Final extracted MRN: '2258674'
[00:27:30] ℹ️  Final extracted Sex: 'FEMALE'
[00:27:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:27:30] ℹ️  Final extracted Payer Source: ''
[00:27:30] ✅ Patient data extraction completed successfully
[00:27:30] ✅    ✅ Patient data extracted successfully
[00:27:30] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:27:30] ✅    ✅ Patient identified: Maryann Boucher
[00:27:30] ✅    ✅ Patient name validation passed
[00:27:30] 🔄 
🔄 Step 3: Processing patient dates...
[00:27:30] [DOC: 9254748] ℹ️  DOB normalized: 03/22/1946
[00:27:30] [DOC: 9254748] ✅ Patient date processing completed successfully
[00:27:30] ✅    ✅ Date processing completed
[00:27:30] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[00:27:30] 🔄 
🔄 Step 4: Extracting order data...
[00:27:32] ℹ️  Order extraction - MRN: '2258674'
[00:27:32] ℹ️  Order extraction - Sex: 'FEMALE'
[00:27:32] ℹ️  Order extraction - Service Line: ''
[00:27:32] ℹ️  Order extraction - Payer Source: ''
[00:27:32] ✅ Order data extraction completed successfully
[00:27:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:27:32] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[00:27:32] ℹ️  Using service line from patient data: 'Skilled Nursing'
[00:27:32] ✅ Patient name cross-validation successful
[00:27:32] ✅    ✅ Data merged successfully
[00:27:33] ✅    ✅ Order data extracted and validated
[00:27:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:27:33] [DOC: 9254748] ✅ Patient found in local cache: Maryann Boucher, ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:27:33] ✅    ✅ Existing patient found with ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:27:33] 🔄 
🔄 Step 6: Pushing order to API...
[00:27:33] [DOC: 9254748] ℹ️  Pushing order via API for patient ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:27:35] [DOC: 9254748] ❌ Order push failed with status 201: {"id":"aa203c0a-c84f-4c8c-ad18-d619e6f32584","orderWAVId":"ORD20087","orderNo":"1084150, 1084149","orderDate":"04/21/2025","startOfCare":"04/16/2025","episodeStartDate":"04/16/2025","episodeEndDate":"04/21/2025","documentID":"9254748","mrn":"2258674","patientName":"Boucher,Maryann","sentToPhysicianDate":"04/22/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/24/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"3bef7fdb-bf2d-49d6-944c-4edfecd704b7","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[00:27:35] ❌    ❌ Failed to push order
[00:27:35] 🔄 
🔄 Step 7: Writing to CSV...
[00:27:35] [DOC: 9254748] ℹ️  Calculated age: 79 from DOB: 03/22/1946
[00:27:35] [DOC: 9254748] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:27:35] [DOC: 9254748] ℹ️  Payer Source extracted: ''
[00:27:35] [DOC: 9254748] ℹ️  Diagnosis codes being written:
[00:27:35] [DOC: 9254748] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:27:35] [DOC: 9254748] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:27:35] [DOC: 9254748] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:27:35] [DOC: 9254748] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:27:35] [DOC: 9254748] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:27:35] [DOC: 9254748] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:27:35] [DOC: 9254748] ✅ Patient data written to CSV: Maryann Boucher | Sex: FEMALE | Age: 79 | Service: Skilled Nursing | Payer:  | MRN: 2258674
[00:27:35] ✅    ✅ Document 9254748 processed and saved successfully
[00:27:35] 🔄 
🔄 Step 8: Saving API details...
[00:27:35] [DOC: 9254748] ℹ️  API push details saved for document 9254748
[00:27:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9253213                         ║
================================================================================
[00:27:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:27:35] ℹ️  Date: 04/22/2025
[00:27:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:27:38] [DOC: 9253213] ✅ Text extracted using pdfplumber (1427 chars)
[00:27:38] ✅    ✅ Text extracted using pdfplumber (1427 chars)
[00:27:38] 🔄 
🔄 Step 2: Extracting patient data...
[00:27:40] ℹ️  AI extracted raw sex value: ''
[00:27:40] ℹ️  AI extracted service line: 'Nursing'
[00:27:40] ℹ️  AI extracted payer source: ''
[00:27:40] ℹ️  AI extracted diagnoses:
[00:27:40] ℹ️    - Diagnosis 1: 'E11.40'
[00:27:40] ℹ️    - Diagnosis 2: 'R55'
[00:27:40] ℹ️    - Diagnosis 3: 'M62.81'
[00:27:40] ℹ️    - Diagnosis 4: ''
[00:27:40] ℹ️    - Diagnosis 5: ''
[00:27:40] ℹ️    - Diagnosis 6: ''
[00:27:40] ℹ️  Final extracted MRN: '100991175'
[00:27:40] ℹ️  Final extracted Sex: ''
[00:27:40] ℹ️  Final extracted Service Line: 'Nursing'
[00:27:40] ℹ️  Final extracted Payer Source: ''
[00:27:40] ✅ Patient data extraction completed successfully
[00:27:40] ✅    ✅ Patient data extracted successfully
[00:27:40] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Aguiar
     └─ dob: 09/05/1946
     └─ patientSex: 
     └─ medicalRecordNo: 100991175
     └─ billingProvider: EHAB SORIAL MD
     └─ npi: 1083608442
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'E11.40', 'secondDiagnosis': 'R55', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:27:40] ✅    ✅ Patient identified: Maria Aguiar
[00:27:40] ✅    ✅ Patient name validation passed
[00:27:40] 🔄 
🔄 Step 3: Processing patient dates...
[00:27:40] [DOC: 9253213] ℹ️  DOB normalized: 09/05/1946
[00:27:40] [DOC: 9253213] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[00:27:40] [DOC: 9253213] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[00:27:40] [DOC: 9253213] ✅ Patient date processing completed successfully
[00:27:40] ✅    ✅ Date processing completed
[00:27:40] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Aguiar
     └─ dob: 09/05/1946
     └─ patientSex: 
     └─ medicalRecordNo: 100991175
     └─ billingProvider: EHAB SORIAL MD
     └─ npi: 1083608442
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'E11.40', 'secondDiagnosis': 'R55', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:27:40] 🔄 
🔄 Step 4: Extracting order data...
[00:27:43] ℹ️  Order extraction - MRN: '100991175'
[00:27:43] ℹ️  Order extraction - Sex: ''
[00:27:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:27:43] ℹ️  Order extraction - Payer Source: ''
[00:27:43] ✅ Order data extraction completed successfully
[00:27:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:27:43] ℹ️  Using MRN from patient data: '100991175' over '100991175'
[00:27:43] ℹ️  Inferred sex as FEMALE from name: Maria
[00:27:43] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[00:27:43] ✅ Patient name cross-validation successful
[00:27:43] ✅    ✅ Data merged successfully
[00:27:44] ✅    ✅ Order data extracted and validated
[00:27:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:27:44] [DOC: 9253213] ✅ Patient found in local cache: Maria Aguiar, ID: b9965767-0ab4-478e-ae42-6485c2df49c5
[00:27:44] ✅    ✅ Existing patient found with ID: b9965767-0ab4-478e-ae42-6485c2df49c5
[00:27:44] 🔄 
🔄 Step 6: Pushing order to API...
[00:27:44] [DOC: 9253213] ℹ️  Pushing order via API for patient ID: b9965767-0ab4-478e-ae42-6485c2df49c5
[00:27:45] [DOC: 9253213] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14082"}
[00:27:45] ❌    ❌ Failed to push order
[00:27:45] 🔄 
🔄 Step 7: Writing to CSV...
[00:27:45] [DOC: 9253213] ℹ️  Calculated age: 78 from DOB: 09/05/1946
[00:27:45] [DOC: 9253213] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[00:27:45] [DOC: 9253213] ℹ️  Payer Source extracted: ''
[00:27:45] [DOC: 9253213] ℹ️  Diagnosis codes being written:
[00:27:45] [DOC: 9253213] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.40'
[00:27:45] [DOC: 9253213] ℹ️    - Latest_Episode_Seconddiagnosis: 'R55'
[00:27:45] [DOC: 9253213] ℹ️    - Latest_Episode_Thirddiagnosis: 'M62.81'
[00:27:45] [DOC: 9253213] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:27:45] [DOC: 9253213] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:27:45] [DOC: 9253213] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:27:45] [DOC: 9253213] ✅ Patient data written to CSV: Maria Aguiar | Sex: FEMALE | Age: 78 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 100991175
[00:27:45] ✅    ✅ Document 9253213 processed and saved successfully
[00:27:45] 🔄 
🔄 Step 8: Saving API details...
[00:27:45] [DOC: 9253213] ℹ️  API push details saved for document 9253213
[00:27:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9253210                         ║
================================================================================
[00:27:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:27:45] ℹ️  Date: 04/22/2025
[00:27:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:27:48] [DOC: 9253210] ✅ Text extracted using pdfplumber (1276 chars)
[00:27:48] ✅    ✅ Text extracted using pdfplumber (1264 chars)
[00:27:48] 🔄 
🔄 Step 2: Extracting patient data...
[00:27:51] ℹ️  AI extracted raw sex value: ''
[00:27:51] ℹ️  AI extracted service line: 'LPN'
[00:27:51] ℹ️  AI extracted payer source: ''
[00:27:51] ℹ️  AI extracted diagnoses:
[00:27:51] ℹ️    - Diagnosis 1: 'J10.00'
[00:27:51] ℹ️    - Diagnosis 2: 'J10.1'
[00:27:51] ℹ️    - Diagnosis 3: 'J20.8'
[00:27:51] ℹ️    - Diagnosis 4: 'None'
[00:27:51] ℹ️    - Diagnosis 5: 'None'
[00:27:51] ℹ️    - Diagnosis 6: 'None'
[00:27:51] ℹ️  Final extracted MRN: 'MA210420124503'
[00:27:51] ℹ️  Final extracted Sex: ''
[00:27:51] ℹ️  Final extracted Service Line: 'LPN'
[00:27:51] ℹ️  Final extracted Payer Source: ''
[00:27:51] ✅ Patient data extraction completed successfully
[00:27:51] ✅    ✅ Patient data extracted successfully
[00:27:51] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Saude
     └─ dob: 12/03/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA210420124503
     └─ billingProvider: DEBBY ALMEIDA MD
     └─ npi: 1134289127
     └─ physicianNPI: 1134289127
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J20.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:27:51] ✅    ✅ Patient identified: Maria Saude
[00:27:51] ✅    ✅ Patient name validation passed
[00:27:51] 🔄 
🔄 Step 3: Processing patient dates...
[00:27:51] [DOC: 9253210] ℹ️  DOB normalized: 12/03/1945
[00:27:51] [DOC: 9253210] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[00:27:51] [DOC: 9253210] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[00:27:51] [DOC: 9253210] ✅ Patient date processing completed successfully
[00:27:51] ✅    ✅ Date processing completed
[00:27:51] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Saude
     └─ dob: 12/03/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA210420124503
     └─ billingProvider: DEBBY ALMEIDA MD
     └─ npi: 1134289127
     └─ physicianNPI: 1134289127
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J20.8'}]
[00:27:51] 🔄 
🔄 Step 4: Extracting order data...
[00:27:53] ℹ️  Order extraction - MRN: 'MA210420124503'
[00:27:53] ℹ️  Order extraction - Sex: ''
[00:27:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:27:53] ℹ️  Order extraction - Payer Source: ''
[00:27:53] ✅ Order data extraction completed successfully
[00:27:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:27:53] ℹ️  Using MRN from patient data: 'MA210420124503' over 'MA210420124503'
[00:27:53] ℹ️  Inferred sex as FEMALE from name: Maria
[00:27:53] ℹ️  Combined service lines: Patient='LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[00:27:53] ✅ Patient name cross-validation successful
[00:27:53] ✅    ✅ Data merged successfully
[00:27:55] ✅    ✅ Order data extracted and validated
[00:27:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:27:55] [DOC: 9253210] ✅ Patient found in local cache: Maria Saude, ID: cac5a300-1fae-4dab-aa9c-e9c386640a8d
[00:27:55] ✅    ✅ Existing patient found with ID: cac5a300-1fae-4dab-aa9c-e9c386640a8d
[00:27:55] 🔄 
🔄 Step 6: Pushing order to API...
[00:27:55] [DOC: 9253210] ℹ️  Pushing order via API for patient ID: cac5a300-1fae-4dab-aa9c-e9c386640a8d
[00:27:56] [DOC: 9253210] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14083"}
[00:27:56] ❌    ❌ Failed to push order
[00:27:56] 🔄 
🔄 Step 7: Writing to CSV...
[00:27:56] [DOC: 9253210] ℹ️  Calculated age: 79 from DOB: 12/03/1945
[00:27:56] [DOC: 9253210] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[00:27:56] [DOC: 9253210] ℹ️  Payer Source extracted: ''
[00:27:56] [DOC: 9253210] ℹ️  Diagnosis codes being written:
[00:27:56] [DOC: 9253210] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[00:27:56] [DOC: 9253210] ℹ️    - Latest_Episode_Seconddiagnosis: 'J10.1'
[00:27:56] [DOC: 9253210] ℹ️    - Latest_Episode_Thirddiagnosis: 'J20.8'
[00:27:56] [DOC: 9253210] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:27:56] [DOC: 9253210] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:27:56] [DOC: 9253210] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:27:56] [DOC: 9253210] ✅ Patient data written to CSV: Maria Saude | Sex: FEMALE | Age: 79 | Service: LPN, Skilled Nursing | Payer:  | MRN: MA210420124503
[00:27:56] ✅    ✅ Document 9253210 processed and saved successfully
[00:27:56] 🔄 
🔄 Step 8: Saving API details...
[00:27:56] [DOC: 9253210] ℹ️  API push details saved for document 9253210
[00:27:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252878                         ║
================================================================================
[00:27:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:27:56] ℹ️  Date: 04/22/2025
[00:27:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:28:00] [DOC: 9252878] ✅ Text extracted using pdfplumber (17361 chars)
[00:28:00] ✅    ✅ Text extracted using pdfplumber (17361 chars)
[00:28:00] 🔄 
🔄 Step 2: Extracting patient data...
[00:28:02] ℹ️  AI extracted raw sex value: ''
[00:28:02] ℹ️  AI extracted service line: 'PT'
[00:28:02] ℹ️  AI extracted payer source: 'None'
[00:28:02] ℹ️  AI extracted diagnoses:
[00:28:02] ℹ️    - Diagnosis 1: 'DM'
[00:28:02] ℹ️    - Diagnosis 2: 'Difficulty gait'
[00:28:02] ℹ️    - Diagnosis 3: 'None'
[00:28:02] ℹ️    - Diagnosis 4: 'None'
[00:28:02] ℹ️    - Diagnosis 5: 'None'
[00:28:02] ℹ️    - Diagnosis 6: 'None'
[00:28:02] ℹ️  Final extracted MRN: 'MA200528053701'
[00:28:02] ℹ️  Final extracted Sex: ''
[00:28:02] ℹ️  Final extracted Service Line: 'PT'
[00:28:02] ℹ️  Final extracted Payer Source: ''
[00:28:02] ✅ Patient data extraction completed successfully
[00:28:02] ✅    ✅ Patient data extracted successfully
[00:28:02] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/18/2025', 'endOfEpisode': None, 'firstDiagnosis': 'DM', 'secondDiagnosis': 'Difficulty gait', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:28:02] ✅    ✅ Patient identified: Roderick Lopez
[00:28:02] ✅    ✅ Patient name validation passed
[00:28:02] 🔄 
🔄 Step 3: Processing patient dates...
[00:28:02] [DOC: 9252878] ℹ️  DOB normalized: 05/21/1937
[00:28:02] [DOC: 9252878] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[00:28:02] [DOC: 9252878] ✅ Patient date processing completed successfully
[00:28:02] ✅    ✅ Date processing completed
[00:28:02] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'Difficulty gait'}]
[00:28:02] 🔄 
🔄 Step 4: Extracting order data...
[00:28:05] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:28:05] ℹ️  Order extraction - Sex: 'MALE'
[00:28:05] ℹ️  Order extraction - Service Line: 'PT'
[00:28:05] ℹ️  Order extraction - Payer Source: ''
[00:28:05] ✅ Order data extraction completed successfully
[00:28:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:28:05] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:28:05] ℹ️  Service line consistent in both sources: 'PT'
[00:28:05] ✅ Patient name cross-validation successful
[00:28:05] ✅    ✅ Data merged successfully
[00:28:07] ✅    ✅ Order data extracted and validated
[00:28:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:28:07] [DOC: 9252878] ✅ Patient found in local cache: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:28:07] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:28:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:28:07] [DOC: 9252878] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:28:08] [DOC: 9252878] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:28:08] ❌    ❌ Failed to push order
[00:28:08] 🔄 
🔄 Step 7: Writing to CSV...
[00:28:08] [DOC: 9252878] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:28:08] [DOC: 9252878] ℹ️  Service Line extracted: 'PT'
[00:28:08] [DOC: 9252878] ℹ️  Payer Source extracted: ''
[00:28:08] [DOC: 9252878] ℹ️  Diagnosis codes being written:
[00:28:08] [DOC: 9252878] ℹ️    - Latest_Episode_Firstdiagnosis: 'DM'
[00:28:08] [DOC: 9252878] ℹ️    - Latest_Episode_Seconddiagnosis: 'Difficulty gait'
[00:28:08] [DOC: 9252878] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:28:08] [DOC: 9252878] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:28:08] [DOC: 9252878] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:28:08] [DOC: 9252878] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:28:08] [DOC: 9252878] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: PT | Payer:  | MRN: MA200528053701
[00:28:08] ✅    ✅ Document 9252878 processed and saved successfully
[00:28:08] 🔄 
🔄 Step 8: Saving API details...
[00:28:08] [DOC: 9252878] ℹ️  API push details saved for document 9252878
[00:28:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252868                         ║
================================================================================
[00:28:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:28:08] ℹ️  Date: 04/22/2025
[00:28:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:28:10] [DOC: 9252868] ✅ Text extracted using pdfplumber (2267 chars)
[00:28:10] ✅    ✅ Text extracted using pdfplumber (2267 chars)
[00:28:10] 🔄 
🔄 Step 2: Extracting patient data...
[00:28:13] ℹ️  AI extracted raw sex value: ''
[00:28:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:28:13] ℹ️  AI extracted payer source: ''
[00:28:13] ℹ️  AI extracted diagnoses:
[00:28:13] ℹ️    - Diagnosis 1: 'F03.90'
[00:28:13] ℹ️    - Diagnosis 2: 'R60.9'
[00:28:13] ℹ️    - Diagnosis 3: 'G47.9'
[00:28:13] ℹ️    - Diagnosis 4: ''
[00:28:13] ℹ️    - Diagnosis 5: ''
[00:28:13] ℹ️    - Diagnosis 6: ''
[00:28:13] ℹ️  Final extracted MRN: 'MA221012023702'
[00:28:13] ℹ️  Final extracted Sex: ''
[00:28:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:28:13] ℹ️  Final extracted Payer Source: ''
[00:28:13] ✅ Patient data extraction completed successfully
[00:28:13] ✅    ✅ Patient data extracted successfully
[00:28:13] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:28:13] ✅    ✅ Patient identified: Mary Pedra
[00:28:13] ✅    ✅ Patient name validation passed
[00:28:13] 🔄 
🔄 Step 3: Processing patient dates...
[00:28:13] [DOC: 9252868] ℹ️  DOB normalized: 02/27/1937
[00:28:13] [DOC: 9252868] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[00:28:13] [DOC: 9252868] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[00:28:13] [DOC: 9252868] ✅ Patient date processing completed successfully
[00:28:13] ✅    ✅ Date processing completed
[00:28:13] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:28:13] 🔄 
🔄 Step 4: Extracting order data...
[00:28:16] ℹ️  Order extraction - MRN: 'MA221012023702'
[00:28:16] ℹ️  Order extraction - Sex: ''
[00:28:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:28:16] ℹ️  Order extraction - Payer Source: ''
[00:28:16] ✅ Order data extraction completed successfully
[00:28:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:28:16] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[00:28:16] ℹ️  Inferred sex as FEMALE from name: Mary
[00:28:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:28:16] ✅ Patient name cross-validation successful
[00:28:16] ✅    ✅ Data merged successfully
[00:28:17] ✅    ✅ Order data extracted and validated
[00:28:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:28:17] [DOC: 9252868] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:28:17] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:28:17] 🔄 
🔄 Step 6: Pushing order to API...
[00:28:17] [DOC: 9252868] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:28:19] [DOC: 9252868] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12994"}
[00:28:19] ❌    ❌ Failed to push order
[00:28:19] 🔄 
🔄 Step 7: Writing to CSV...
[00:28:19] [DOC: 9252868] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[00:28:19] [DOC: 9252868] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:28:19] [DOC: 9252868] ℹ️  Payer Source extracted: ''
[00:28:19] [DOC: 9252868] ℹ️  Diagnosis codes being written:
[00:28:19] [DOC: 9252868] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:28:19] [DOC: 9252868] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[00:28:19] [DOC: 9252868] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[00:28:19] [DOC: 9252868] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:28:19] [DOC: 9252868] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:28:19] [DOC: 9252868] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:28:19] [DOC: 9252868] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer:  | MRN: MA221012023702
[00:28:19] ✅    ✅ Document 9252868 processed and saved successfully
[00:28:19] 🔄 
🔄 Step 8: Saving API details...
[00:28:19] [DOC: 9252868] ℹ️  API push details saved for document 9252868
[00:28:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252860                         ║
================================================================================
[00:28:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:28:19] ℹ️  Date: 04/22/2025
[00:28:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:28:23] [DOC: 9252860] ✅ Text extracted using pdfplumber (1452 chars)
[00:28:23] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[00:28:23] 🔄 
🔄 Step 2: Extracting patient data...
[00:28:26] ℹ️  AI extracted raw sex value: ''
[00:28:26] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:28:26] ℹ️  AI extracted payer source: ''
[00:28:26] ℹ️  AI extracted diagnoses:
[00:28:26] ℹ️    - Diagnosis 1: 'I69.398'
[00:28:26] ℹ️    - Diagnosis 2: 'R53.1'
[00:28:26] ℹ️    - Diagnosis 3: 'I69.322'
[00:28:26] ℹ️    - Diagnosis 4: 'None'
[00:28:26] ℹ️    - Diagnosis 5: 'None'
[00:28:26] ℹ️    - Diagnosis 6: 'None'
[00:28:26] ℹ️  Final extracted MRN: 'MA241126016807'
[00:28:26] ℹ️  Final extracted Sex: ''
[00:28:26] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:28:26] ℹ️  Final extracted Payer Source: ''
[00:28:26] ✅ Patient data extraction completed successfully
[00:28:26] ✅    ✅ Patient data extracted successfully
[00:28:26] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:28:26] ✅    ✅ Patient identified: Frank Ferreira
[00:28:26] ✅    ✅ Patient name validation passed
[00:28:26] 🔄 
🔄 Step 3: Processing patient dates...
[00:28:26] [DOC: 9252860] ℹ️  DOB normalized: 01/07/1968
[00:28:26] [DOC: 9252860] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:28:26] [DOC: 9252860] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:28:26] [DOC: 9252860] ✅ Patient date processing completed successfully
[00:28:26] ✅    ✅ Date processing completed
[00:28:26] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322'}]
[00:28:26] 🔄 
🔄 Step 4: Extracting order data...
[00:28:28] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:28:28] ℹ️  Order extraction - Sex: ''
[00:28:28] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:28:28] ℹ️  Order extraction - Payer Source: ''
[00:28:28] ✅ Order data extraction completed successfully
[00:28:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:28:28] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:28:28] ℹ️  Inferred sex as MALE from name: Frank
[00:28:28] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:28:28] ✅ Patient name cross-validation successful
[00:28:28] ✅    ✅ Data merged successfully
[00:28:30] ✅    ✅ Order data extracted and validated
[00:28:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:28:30] [DOC: 9252860] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:30] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:30] 🔄 
🔄 Step 6: Pushing order to API...
[00:28:30] [DOC: 9252860] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:31] [DOC: 9252860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13977"}
[00:28:31] ❌    ❌ Failed to push order
[00:28:31] 🔄 
🔄 Step 7: Writing to CSV...
[00:28:31] [DOC: 9252860] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:28:31] [DOC: 9252860] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:28:31] [DOC: 9252860] ℹ️  Payer Source extracted: ''
[00:28:31] [DOC: 9252860] ℹ️  Diagnosis codes being written:
[00:28:31] [DOC: 9252860] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[00:28:31] [DOC: 9252860] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[00:28:31] [DOC: 9252860] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[00:28:31] [DOC: 9252860] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:28:31] [DOC: 9252860] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:28:31] [DOC: 9252860] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:28:31] [DOC: 9252860] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: Occupational Therapy | Payer:  | MRN: MA241126016807
[00:28:31] ✅    ✅ Document 9252860 processed and saved successfully
[00:28:31] 🔄 
🔄 Step 8: Saving API details...
[00:28:31] [DOC: 9252860] ℹ️  API push details saved for document 9252860
[00:28:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252858                         ║
================================================================================
[00:28:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:28:31] ℹ️  Date: 04/22/2025
[00:28:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:28:34] [DOC: 9252858] ✅ Text extracted using pdfplumber (1452 chars)
[00:28:34] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[00:28:34] 🔄 
🔄 Step 2: Extracting patient data...
[00:28:37] ℹ️  AI extracted raw sex value: ''
[00:28:37] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:28:37] ℹ️  AI extracted payer source: ''
[00:28:37] ℹ️  AI extracted diagnoses:
[00:28:37] ℹ️    - Diagnosis 1: 'I69.398'
[00:28:37] ℹ️    - Diagnosis 2: 'R53.1'
[00:28:37] ℹ️    - Diagnosis 3: 'I69.322'
[00:28:37] ℹ️    - Diagnosis 4: ''
[00:28:37] ℹ️    - Diagnosis 5: ''
[00:28:37] ℹ️    - Diagnosis 6: ''
[00:28:37] ℹ️  Final extracted MRN: 'MA241126016807'
[00:28:37] ℹ️  Final extracted Sex: ''
[00:28:37] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:28:37] ℹ️  Final extracted Payer Source: ''
[00:28:37] ✅ Patient data extraction completed successfully
[00:28:37] ✅    ✅ Patient data extracted successfully
[00:28:37] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:28:37] ✅    ✅ Patient identified: Frank Ferreira
[00:28:37] ✅    ✅ Patient name validation passed
[00:28:37] 🔄 
🔄 Step 3: Processing patient dates...
[00:28:37] [DOC: 9252858] ℹ️  DOB normalized: 01/07/1968
[00:28:37] [DOC: 9252858] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:28:37] [DOC: 9252858] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:28:37] [DOC: 9252858] ✅ Patient date processing completed successfully
[00:28:37] ✅    ✅ Date processing completed
[00:28:37] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:28:37] 🔄 
🔄 Step 4: Extracting order data...
[00:28:40] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:28:40] ℹ️  Order extraction - Sex: ''
[00:28:40] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:28:40] ℹ️  Order extraction - Payer Source: ''
[00:28:40] ✅ Order data extraction completed successfully
[00:28:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:28:40] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:28:40] ℹ️  Inferred sex as MALE from name: Frank
[00:28:40] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:28:40] ✅ Patient name cross-validation successful
[00:28:40] ✅    ✅ Data merged successfully
[00:28:41] ✅    ✅ Order data extracted and validated
[00:28:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:28:41] [DOC: 9252858] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:41] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:41] 🔄 
🔄 Step 6: Pushing order to API...
[00:28:41] [DOC: 9252858] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:42] [DOC: 9252858] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13977"}
[00:28:42] ❌    ❌ Failed to push order
[00:28:42] 🔄 
🔄 Step 7: Writing to CSV...
[00:28:42] [DOC: 9252858] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:28:42] [DOC: 9252858] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:28:42] [DOC: 9252858] ℹ️  Payer Source extracted: ''
[00:28:42] [DOC: 9252858] ℹ️  Diagnosis codes being written:
[00:28:42] [DOC: 9252858] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[00:28:42] [DOC: 9252858] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[00:28:42] [DOC: 9252858] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[00:28:42] [DOC: 9252858] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:28:42] [DOC: 9252858] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:28:42] [DOC: 9252858] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:28:42] [DOC: 9252858] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: Occupational Therapy | Payer:  | MRN: MA241126016807
[00:28:42] ✅    ✅ Document 9252858 processed and saved successfully
[00:28:42] 🔄 
🔄 Step 8: Saving API details...
[00:28:42] [DOC: 9252858] ℹ️  API push details saved for document 9252858
[00:28:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252855                         ║
================================================================================
[00:28:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:28:42] ℹ️  Date: 04/22/2025
[00:28:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:28:46] [DOC: 9252855] ✅ Text extracted using pdfplumber (1340 chars)
[00:28:46] ✅    ✅ Text extracted using pdfplumber (1328 chars)
[00:28:46] 🔄 
🔄 Step 2: Extracting patient data...
[00:28:49] ℹ️  AI extracted raw sex value: ''
[00:28:49] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:28:49] ℹ️  AI extracted payer source: ''
[00:28:49] ℹ️  AI extracted diagnoses:
[00:28:49] ℹ️    - Diagnosis 1: 'I69.398'
[00:28:49] ℹ️    - Diagnosis 2: 'R53.1'
[00:28:49] ℹ️    - Diagnosis 3: 'I69.322'
[00:28:49] ℹ️    - Diagnosis 4: ''
[00:28:49] ℹ️    - Diagnosis 5: ''
[00:28:49] ℹ️    - Diagnosis 6: ''
[00:28:49] ℹ️  Final extracted MRN: 'MA241126016807'
[00:28:49] ℹ️  Final extracted Sex: ''
[00:28:49] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:28:49] ℹ️  Final extracted Payer Source: ''
[00:28:49] ✅ Patient data extraction completed successfully
[00:28:49] ✅    ✅ Patient data extracted successfully
[00:28:49] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:28:49] ✅    ✅ Patient identified: Frank Ferreira
[00:28:49] ✅    ✅ Patient name validation passed
[00:28:49] 🔄 
🔄 Step 3: Processing patient dates...
[00:28:49] [DOC: 9252855] ℹ️  DOB normalized: 01/07/1968
[00:28:49] [DOC: 9252855] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:28:49] [DOC: 9252855] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:28:49] [DOC: 9252855] ✅ Patient date processing completed successfully
[00:28:49] ✅    ✅ Date processing completed
[00:28:49] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:28:49] 🔄 
🔄 Step 4: Extracting order data...
[00:28:52] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:28:52] ℹ️  Order extraction - Sex: ''
[00:28:52] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:28:52] ℹ️  Order extraction - Payer Source: ''
[00:28:52] ✅ Order data extraction completed successfully
[00:28:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:28:52] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:28:52] ℹ️  Inferred sex as MALE from name: Frank
[00:28:52] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:28:52] ✅ Patient name cross-validation successful
[00:28:52] ✅    ✅ Data merged successfully
[00:28:53] ✅    ✅ Order data extracted and validated
[00:28:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:28:53] [DOC: 9252855] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:53] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:53] 🔄 
🔄 Step 6: Pushing order to API...
[00:28:53] [DOC: 9252855] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:28:54] [DOC: 9252855] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13978"}
[00:28:54] ❌    ❌ Failed to push order
[00:28:54] 🔄 
🔄 Step 7: Writing to CSV...
[00:28:54] [DOC: 9252855] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:28:54] [DOC: 9252855] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:28:54] [DOC: 9252855] ℹ️  Payer Source extracted: ''
[00:28:54] [DOC: 9252855] ℹ️  Diagnosis codes being written:
[00:28:54] [DOC: 9252855] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[00:28:54] [DOC: 9252855] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[00:28:54] [DOC: 9252855] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[00:28:54] [DOC: 9252855] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:28:54] [DOC: 9252855] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:28:54] [DOC: 9252855] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:28:54] [DOC: 9252855] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: Occupational Therapy | Payer:  | MRN: MA241126016807
[00:28:54] ✅    ✅ Document 9252855 processed and saved successfully
[00:28:54] 🔄 
🔄 Step 8: Saving API details...
[00:28:54] [DOC: 9252855] ℹ️  API push details saved for document 9252855
[00:28:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252854                         ║
================================================================================
[00:28:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:28:54] ℹ️  Date: 04/22/2025
[00:28:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:28:58] [DOC: 9252854] ✅ Text extracted using pdfplumber (1312 chars)
[00:28:58] ✅    ✅ Text extracted using pdfplumber (1300 chars)
[00:28:58] 🔄 
🔄 Step 2: Extracting patient data...
[00:29:01] ℹ️  AI extracted raw sex value: ''
[00:29:01] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:29:01] ℹ️  AI extracted payer source: ''
[00:29:01] ℹ️  AI extracted diagnoses:
[00:29:01] ℹ️    - Diagnosis 1: 'I69.398'
[00:29:01] ℹ️    - Diagnosis 2: 'R53.1'
[00:29:01] ℹ️    - Diagnosis 3: 'I69.322'
[00:29:01] ℹ️    - Diagnosis 4: 'None'
[00:29:01] ℹ️    - Diagnosis 5: 'None'
[00:29:01] ℹ️    - Diagnosis 6: 'None'
[00:29:01] ℹ️  Final extracted MRN: 'MA241126016807'
[00:29:01] ℹ️  Final extracted Sex: ''
[00:29:01] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:29:01] ℹ️  Final extracted Payer Source: ''
[00:29:01] ✅ Patient data extraction completed successfully
[00:29:01] ✅    ✅ Patient data extracted successfully
[00:29:01] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:29:01] ✅    ✅ Patient identified: Frank Ferreira
[00:29:01] ✅    ✅ Patient name validation passed
[00:29:01] 🔄 
🔄 Step 3: Processing patient dates...
[00:29:01] [DOC: 9252854] ℹ️  DOB normalized: 01/07/1968
[00:29:01] [DOC: 9252854] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:29:01] [DOC: 9252854] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:29:01] [DOC: 9252854] ✅ Patient date processing completed successfully
[00:29:01] ✅    ✅ Date processing completed
[00:29:01] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322'}]
[00:29:01] 🔄 
🔄 Step 4: Extracting order data...
[00:29:04] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:29:04] ℹ️  Order extraction - Sex: ''
[00:29:04] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:29:04] ℹ️  Order extraction - Payer Source: ''
[00:29:04] ✅ Order data extraction completed successfully
[00:29:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:29:04] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:29:04] ℹ️  Inferred sex as MALE from name: Frank
[00:29:04] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:29:04] ✅ Patient name cross-validation successful
[00:29:04] ✅    ✅ Data merged successfully
[00:29:05] ✅    ✅ Order data extracted and validated
[00:29:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:29:05] [DOC: 9252854] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:05] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:05] 🔄 
🔄 Step 6: Pushing order to API...
[00:29:05] [DOC: 9252854] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:06] [DOC: 9252854] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13979"}
[00:29:06] ❌    ❌ Failed to push order
[00:29:06] 🔄 
🔄 Step 7: Writing to CSV...
[00:29:06] [DOC: 9252854] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:29:06] [DOC: 9252854] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:29:06] [DOC: 9252854] ℹ️  Payer Source extracted: ''
[00:29:06] [DOC: 9252854] ℹ️  Diagnosis codes being written:
[00:29:06] [DOC: 9252854] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[00:29:06] [DOC: 9252854] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[00:29:06] [DOC: 9252854] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[00:29:06] [DOC: 9252854] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:29:06] [DOC: 9252854] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:29:06] [DOC: 9252854] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:29:06] [DOC: 9252854] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: Occupational Therapy | Payer:  | MRN: MA241126016807
[00:29:06] ✅    ✅ Document 9252854 processed and saved successfully
[00:29:06] 🔄 
🔄 Step 8: Saving API details...
[00:29:06] [DOC: 9252854] ℹ️  API push details saved for document 9252854
[00:29:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252853                         ║
================================================================================
[00:29:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:29:06] ℹ️  Date: 04/22/2025
[00:29:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:29:08] [DOC: 9252853] ✅ Text extracted using pdfplumber (1449 chars)
[00:29:08] ✅    ✅ Text extracted using pdfplumber (1437 chars)
[00:29:08] 🔄 
🔄 Step 2: Extracting patient data...
[00:29:11] ℹ️  AI extracted raw sex value: ''
[00:29:11] ℹ️  AI extracted service line: 'Physical Therapy'
[00:29:11] ℹ️  AI extracted payer source: ''
[00:29:11] ℹ️  AI extracted diagnoses:
[00:29:11] ℹ️    - Diagnosis 1: 'I69.398'
[00:29:11] ℹ️    - Diagnosis 2: 'R53.1'
[00:29:11] ℹ️    - Diagnosis 3: 'I69.322'
[00:29:11] ℹ️    - Diagnosis 4: 'None'
[00:29:11] ℹ️    - Diagnosis 5: 'None'
[00:29:11] ℹ️    - Diagnosis 6: 'None'
[00:29:11] ℹ️  Final extracted MRN: 'MA241126016807'
[00:29:11] ℹ️  Final extracted Sex: ''
[00:29:11] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:29:11] ℹ️  Final extracted Payer Source: ''
[00:29:11] ✅ Patient data extraction completed successfully
[00:29:11] ✅    ✅ Patient data extracted successfully
[00:29:11] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:29:11] ✅    ✅ Patient identified: Frank Ferreira
[00:29:11] ✅    ✅ Patient name validation passed
[00:29:11] 🔄 
🔄 Step 3: Processing patient dates...
[00:29:11] [DOC: 9252853] ℹ️  DOB normalized: 01/07/1968
[00:29:11] [DOC: 9252853] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:29:11] [DOC: 9252853] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:29:11] [DOC: 9252853] ✅ Patient date processing completed successfully
[00:29:11] ✅    ✅ Date processing completed
[00:29:11] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322'}]
[00:29:11] 🔄 
🔄 Step 4: Extracting order data...
[00:29:14] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:29:14] ℹ️  Order extraction - Sex: ''
[00:29:14] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:29:14] ℹ️  Order extraction - Payer Source: ''
[00:29:14] ✅ Order data extraction completed successfully
[00:29:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:29:14] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:29:14] ℹ️  Inferred sex as MALE from name: Frank
[00:29:14] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:29:14] ✅ Patient name cross-validation successful
[00:29:14] ✅    ✅ Data merged successfully
[00:29:15] ✅    ✅ Order data extracted and validated
[00:29:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:29:15] [DOC: 9252853] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:15] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:15] 🔄 
🔄 Step 6: Pushing order to API...
[00:29:15] [DOC: 9252853] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:17] [DOC: 9252853] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13980"}
[00:29:17] ❌    ❌ Failed to push order
[00:29:17] 🔄 
🔄 Step 7: Writing to CSV...
[00:29:17] [DOC: 9252853] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:29:17] [DOC: 9252853] ℹ️  Service Line extracted: 'Physical Therapy'
[00:29:17] [DOC: 9252853] ℹ️  Payer Source extracted: ''
[00:29:17] [DOC: 9252853] ℹ️  Diagnosis codes being written:
[00:29:17] [DOC: 9252853] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[00:29:17] [DOC: 9252853] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[00:29:17] [DOC: 9252853] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[00:29:17] [DOC: 9252853] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:29:17] [DOC: 9252853] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:29:17] [DOC: 9252853] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:29:17] [DOC: 9252853] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: Physical Therapy | Payer:  | MRN: MA241126016807
[00:29:17] ✅    ✅ Document 9252853 processed and saved successfully
[00:29:17] 🔄 
🔄 Step 8: Saving API details...
[00:29:17] [DOC: 9252853] ℹ️  API push details saved for document 9252853
[00:29:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252851                         ║
================================================================================
[00:29:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:29:17] ℹ️  Date: 04/22/2025
[00:29:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:29:27] [DOC: 9252851] ✅ Text extracted using pdfplumber (17667 chars)
[00:29:27] ✅    ✅ Text extracted using pdfplumber (17667 chars)
[00:29:27] 🔄 
🔄 Step 2: Extracting patient data...
[00:29:30] ℹ️  AI extracted raw sex value: 'M'
[00:29:30] ℹ️  AI extracted service line: 'PT'
[00:29:30] ℹ️  AI extracted payer source: ''
[00:29:30] ℹ️  AI extracted diagnoses:
[00:29:30] ℹ️    - Diagnosis 1: ''
[00:29:30] ℹ️    - Diagnosis 2: ''
[00:29:30] ℹ️    - Diagnosis 3: ''
[00:29:30] ℹ️    - Diagnosis 4: ''
[00:29:30] ℹ️    - Diagnosis 5: ''
[00:29:30] ℹ️    - Diagnosis 6: ''
[00:29:30] ℹ️  Final extracted MRN: 'MA241126016807'
[00:29:30] ℹ️  Final extracted Sex: 'MALE'
[00:29:30] ℹ️  Final extracted Service Line: 'PT'
[00:29:30] ℹ️  Final extracted Payer Source: ''
[00:29:30] ✅ Patient data extraction completed successfully
[00:29:30] ✅    ✅ Patient data extracted successfully
[00:29:30] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:29:30] ✅    ✅ Patient identified: Frank Ferreira
[00:29:30] ✅    ✅ Patient name validation passed
[00:29:30] 🔄 
🔄 Step 3: Processing patient dates...
[00:29:30] [DOC: 9252851] ℹ️  DOB normalized: 01/07/1968
[00:29:30] [DOC: 9252851] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[00:29:30] [DOC: 9252851] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:29:30] [DOC: 9252851] ✅ Patient date processing completed successfully
[00:29:30] ✅    ✅ Date processing completed
[00:29:30] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:29:30] 🔄 
🔄 Step 4: Extracting order data...
[00:29:33] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:29:33] ℹ️  Order extraction - Sex: 'MALE'
[00:29:33] ℹ️  Order extraction - Service Line: 'PT'
[00:29:33] ℹ️  Order extraction - Payer Source: ''
[00:29:33] ✅ Order data extraction completed successfully
[00:29:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:29:33] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:29:33] ℹ️  Service line consistent in both sources: 'PT'
[00:29:33] ✅ Patient name cross-validation successful
[00:29:33] ✅    ✅ Data merged successfully
[00:29:35] ✅    ✅ Order data extracted and validated
[00:29:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:29:35] [DOC: 9252851] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:35] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:35] 🔄 
🔄 Step 6: Pushing order to API...
[00:29:35] [DOC: 9252851] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:36] [DOC: 9252851] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:29:36] ❌    ❌ Failed to push order
[00:29:36] 🔄 
🔄 Step 7: Writing to CSV...
[00:29:36] [DOC: 9252851] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:29:36] [DOC: 9252851] ℹ️  Service Line extracted: 'PT'
[00:29:36] [DOC: 9252851] ℹ️  Payer Source extracted: ''
[00:29:36] [DOC: 9252851] ℹ️  Diagnosis codes being written:
[00:29:36] [DOC: 9252851] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:29:36] [DOC: 9252851] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:29:36] [DOC: 9252851] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:29:36] [DOC: 9252851] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:29:36] [DOC: 9252851] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:29:36] [DOC: 9252851] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:29:36] [DOC: 9252851] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: PT | Payer:  | MRN: MA241126016807
[00:29:36] ✅    ✅ Document 9252851 processed and saved successfully
[00:29:36] 🔄 
🔄 Step 8: Saving API details...
[00:29:36] [DOC: 9252851] ℹ️  API push details saved for document 9252851
[00:29:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252848                         ║
================================================================================
[00:29:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:29:36] ℹ️  Date: 04/22/2025
[00:29:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:29:39] [DOC: 9252848] ✅ Text extracted using pdfplumber (12117 chars)
[00:29:39] ✅    ✅ Text extracted using pdfplumber (12105 chars)
[00:29:39] 🔄 
🔄 Step 2: Extracting patient data...
[00:29:43] ℹ️  AI extracted raw sex value: 'M'
[00:29:43] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[00:29:43] ℹ️  AI extracted payer source: 'Medicare'
[00:29:43] ℹ️  AI extracted diagnoses:
[00:29:43] ℹ️    - Diagnosis 1: 'I69.398'
[00:29:43] ℹ️    - Diagnosis 2: 'R53.1'
[00:29:43] ℹ️    - Diagnosis 3: 'I69.322'
[00:29:43] ℹ️    - Diagnosis 4: 'E11.9'
[00:29:43] ℹ️    - Diagnosis 5: 'I11.0'
[00:29:43] ℹ️    - Diagnosis 6: 'I50.9'
[00:29:43] ℹ️  Final extracted MRN: 'MA241126016807'
[00:29:43] ℹ️  Final extracted Sex: 'MALE'
[00:29:43] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[00:29:43] ℹ️  Final extracted Payer Source: 'Medicare'
[00:29:43] ✅ Patient data extraction completed successfully
[00:29:43] ✅    ✅ Patient data extracted successfully
[00:29:43] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 96 Division St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 997-0616
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.9'}]
[00:29:43] ✅    ✅ Patient identified: Frank Ferreira
[00:29:43] ✅    ✅ Patient name validation passed
[00:29:43] 🔄 
🔄 Step 3: Processing patient dates...
[00:29:43] [DOC: 9252848] ℹ️  DOB normalized: 01/07/1968
[00:29:43] [DOC: 9252848] ℹ️  Episode startOfCare normalized: 04/12/2025
[00:29:43] [DOC: 9252848] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:29:43] [DOC: 9252848] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:29:43] [DOC: 9252848] ✅ Patient date processing completed successfully
[00:29:43] ✅    ✅ Date processing completed
[00:29:43] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 96 Division St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 997-0616
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.9'}]
[00:29:43] 🔄 
🔄 Step 4: Extracting order data...
[00:29:45] ℹ️  Order extraction - MRN: 'MA241126016807'
[00:29:45] ℹ️  Order extraction - Sex: 'MALE'
[00:29:45] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[00:29:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:29:45] ✅ Order data extraction completed successfully
[00:29:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:29:45] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[00:29:45] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[00:29:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:29:45] ✅ Patient name cross-validation successful
[00:29:45] ✅    ✅ Data merged successfully
[00:29:47] ✅    ✅ Order data extracted and validated
[00:29:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:29:47] [DOC: 9252848] ✅ Patient found in local cache: Frank Ferreira, ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:47] ✅    ✅ Existing patient found with ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:47] 🔄 
🔄 Step 6: Pushing order to API...
[00:29:47] [DOC: 9252848] ℹ️  Pushing order via API for patient ID: c27a4d78-236d-4bf0-822d-db09aee298ce
[00:29:48] [DOC: 9252848] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13981"}
[00:29:48] ❌    ❌ Failed to push order
[00:29:48] 🔄 
🔄 Step 7: Writing to CSV...
[00:29:48] [DOC: 9252848] ℹ️  Calculated age: 57 from DOB: 01/07/1968
[00:29:48] [DOC: 9252848] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[00:29:48] [DOC: 9252848] ℹ️  Payer Source extracted: 'Medicare'
[00:29:48] [DOC: 9252848] ℹ️  Diagnosis codes being written:
[00:29:48] [DOC: 9252848] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.398'
[00:29:48] [DOC: 9252848] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[00:29:48] [DOC: 9252848] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.322'
[00:29:48] [DOC: 9252848] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[00:29:48] [DOC: 9252848] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I11.0'
[00:29:48] [DOC: 9252848] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.9'
[00:29:48] [DOC: 9252848] ✅ Patient data written to CSV: Frank Ferreira | Sex: MALE | Age: 57 | Service: Physical Therapy, Occupational Therapy, Skilled Nursing | Payer: Medicare | MRN: MA241126016807
[00:29:48] ✅    ✅ Document 9252848 processed and saved successfully
[00:29:48] 🔄 
🔄 Step 8: Saving API details...
[00:29:48] [DOC: 9252848] ℹ️  API push details saved for document 9252848
[00:29:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252801                         ║
================================================================================
[00:29:48] ℹ️  Agency: Dartmouth HH
[00:29:48] ℹ️  Date: 04/22/2025
[00:29:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:29:50] [DOC: 9252801] ✅ Text extracted using pdfplumber (1004 chars)
[00:29:50] ✅    ✅ Text extracted using pdfplumber (1004 chars)
[00:29:50] 🔄 
🔄 Step 2: Extracting patient data...
[00:29:53] ℹ️  AI extracted raw sex value: 'F'
[00:29:53] ℹ️  AI extracted service line: 'HHA'
[00:29:53] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[00:29:53] ℹ️  AI extracted diagnoses:
[00:29:53] ℹ️    - Diagnosis 1: ''
[00:29:53] ℹ️    - Diagnosis 2: ''
[00:29:53] ℹ️    - Diagnosis 3: ''
[00:29:53] ℹ️    - Diagnosis 4: ''
[00:29:53] ℹ️    - Diagnosis 5: ''
[00:29:53] ℹ️    - Diagnosis 6: ''
[00:29:53] ℹ️  Final extracted MRN: '6133015'
[00:29:53] ℹ️  Final extracted Sex: 'FEMALE'
[00:29:53] ℹ️  Final extracted Service Line: 'HHA'
[00:29:53] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[00:29:53] ✅ Patient data extraction completed successfully
[00:29:53] ✅    ✅ Patient data extracted successfully
[00:29:53] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:29:53] ✅    ✅ Patient identified: Jacqueline DeTerra
[00:29:53] ✅    ✅ Patient name validation passed
[00:29:53] 🔄 
🔄 Step 3: Processing patient dates...
[00:29:53] [DOC: 9252801] ℹ️  DOB normalized: 11/04/1976
[00:29:53] [DOC: 9252801] ℹ️  Episode startOfCare normalized: 04/03/2025
[00:29:53] [DOC: 9252801] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[00:29:53] [DOC: 9252801] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[00:29:53] [DOC: 9252801] ✅ Patient date processing completed successfully
[00:29:53] ✅    ✅ Date processing completed
[00:29:53] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:29:53] 🔄 
🔄 Step 4: Extracting order data...
[00:29:55] ℹ️  Order extraction - MRN: '6133015'
[00:29:55] ℹ️  Order extraction - Sex: 'FEMALE'
[00:29:55] ℹ️  Order extraction - Service Line: ''
[00:29:55] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[00:29:55] ✅ Order data extraction completed successfully
[00:29:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:29:55] ℹ️  Using MRN from patient data: '6133015' over '6133015'
[00:29:55] ℹ️  Using service line from patient data: 'HHA'
[00:29:55] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[00:29:55] ✅ Patient name cross-validation successful
[00:29:55] ✅    ✅ Data merged successfully
[00:29:57] ✅    ✅ Order data extracted and validated
[00:29:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:29:57] [DOC: 9252801] ✅ Patient found in local cache: Jacqueline DeTerra, ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:29:57] ✅    ✅ Existing patient found with ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:29:57] 🔄 
🔄 Step 6: Pushing order to API...
[00:29:57] [DOC: 9252801] ℹ️  Pushing order via API for patient ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:29:58] [DOC: 9252801] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:29:58] ❌    ❌ Failed to push order
[00:29:58] 🔄 
🔄 Step 7: Writing to CSV...
[00:29:58] [DOC: 9252801] ℹ️  Calculated age: 48 from DOB: 11/04/1976
[00:29:58] [DOC: 9252801] ℹ️  Service Line extracted: 'HHA'
[00:29:58] [DOC: 9252801] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[00:29:58] [DOC: 9252801] ℹ️  Diagnosis codes being written:
[00:29:58] [DOC: 9252801] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:29:58] [DOC: 9252801] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:29:58] [DOC: 9252801] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:29:58] [DOC: 9252801] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:29:58] [DOC: 9252801] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:29:58] [DOC: 9252801] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:29:58] [DOC: 9252801] ✅ Patient data written to CSV: Jacqueline DeTerra | Sex: FEMALE | Age: 48 | Service: HHA | Payer: Blue Cross Blue Shield | MRN: 6133015
[00:29:58] ✅    ✅ Document 9252801 processed and saved successfully
[00:29:58] 🔄 
🔄 Step 8: Saving API details...
[00:29:58] [DOC: 9252801] ℹ️  API push details saved for document 9252801
[00:29:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252797                         ║
================================================================================
[00:29:58] ℹ️  Agency: Dartmouth HH
[00:29:58] ℹ️  Date: 04/22/2025
[00:29:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:30:01] [DOC: 9252797] ✅ Text extracted using pdfplumber (4800 chars)
[00:30:01] ✅    ✅ Text extracted using pdfplumber (4800 chars)
[00:30:01] 🔄 
🔄 Step 2: Extracting patient data...
[00:30:04] ℹ️  AI extracted raw sex value: 'M'
[00:30:04] ℹ️  AI extracted service line: 'Physical Therapy'
[00:30:04] ℹ️  AI extracted payer source: 'Medicare'
[00:30:04] ℹ️  AI extracted diagnoses:
[00:30:04] ℹ️    - Diagnosis 1: 'None'
[00:30:04] ℹ️    - Diagnosis 2: 'None'
[00:30:04] ℹ️    - Diagnosis 3: 'None'
[00:30:04] ℹ️    - Diagnosis 4: 'None'
[00:30:04] ℹ️    - Diagnosis 5: 'None'
[00:30:04] ℹ️    - Diagnosis 6: 'None'
[00:30:04] ℹ️  Final extracted MRN: '5642015'
[00:30:04] ℹ️  Final extracted Sex: 'MALE'
[00:30:04] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:30:04] ℹ️  Final extracted Payer Source: 'Medicare'
[00:30:04] ✅ Patient data extraction completed successfully
[00:30:04] ✅    ✅ Patient data extracted successfully
[00:30:04] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Los
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5642015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:30:04] ✅    ✅ Patient identified: Paul Los
[00:30:04] ✅    ✅ Patient name validation passed
[00:30:04] 🔄 
🔄 Step 3: Processing patient dates...
[00:30:04] [DOC: 9252797] ℹ️  DOB normalized: 12/28/1944
[00:30:04] [DOC: 9252797] ℹ️  Episode startOfCare normalized: 01/04/2025
[00:30:04] [DOC: 9252797] ℹ️  Episode startOfEpisode normalized: 01/04/2025
[00:30:04] [DOC: 9252797] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[00:30:04] [DOC: 9252797] ✅ Patient date processing completed successfully
[00:30:04] ✅    ✅ Date processing completed
[00:30:04] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Los
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5642015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2025', 'startOfEpisode': '01/04/2025', 'endOfEpisode': '05/03/2025'}]
[00:30:04] 🔄 
🔄 Step 4: Extracting order data...
[00:30:06] ℹ️  Order extraction - MRN: ''
[00:30:06] ℹ️  Order extraction - Sex: 'MALE'
[00:30:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:30:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:30:06] ✅ Order data extraction completed successfully
[00:30:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:30:06] ℹ️  Using MRN from patient data: '5642015'
[00:30:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:30:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:30:06] ✅ Patient name cross-validation successful
[00:30:06] ✅    ✅ Data merged successfully
[00:30:08] ✅    ✅ Order data extracted and validated
[00:30:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:30:11] [DOC: 9252797] ✅ Patient exists in API: Paul Los, ID: 0d013489-dcfe-4a5a-9aea-640c378b6dc0
[00:30:11] ✅    ✅ Existing patient found with ID: 0d013489-dcfe-4a5a-9aea-640c378b6dc0
[00:30:11] 🔄 
🔄 Step 6: Pushing order to API...
[00:30:11] [DOC: 9252797] ℹ️  Pushing order via API for patient ID: 0d013489-dcfe-4a5a-9aea-640c378b6dc0
[00:30:12] [DOC: 9252797] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:30:12] ❌    ❌ Failed to push order
[00:30:12] 🔄 
🔄 Step 7: Writing to CSV...
[00:30:12] [DOC: 9252797] ℹ️  Calculated age: 80 from DOB: 12/28/1944
[00:30:12] [DOC: 9252797] ℹ️  Service Line extracted: 'Physical Therapy'
[00:30:12] [DOC: 9252797] ℹ️  Payer Source extracted: 'Medicare'
[00:30:12] [DOC: 9252797] ℹ️  Diagnosis codes being written:
[00:30:12] [DOC: 9252797] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:30:12] [DOC: 9252797] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:30:12] [DOC: 9252797] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:30:12] [DOC: 9252797] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:30:12] [DOC: 9252797] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:30:12] [DOC: 9252797] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:30:12] [DOC: 9252797] ✅ Patient data written to CSV: Paul Los | Sex: MALE | Age: 80 | Service: Physical Therapy | Payer: Medicare | MRN: 5642015
[00:30:12] ✅    ✅ Document 9252797 processed and saved successfully
[00:30:12] 🔄 
🔄 Step 8: Saving API details...
[00:30:12] [DOC: 9252797] ℹ️  API push details saved for document 9252797
[00:30:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252793                         ║
================================================================================
[00:30:12] ℹ️  Agency: Dartmouth HH
[00:30:12] ℹ️  Date: 04/22/2025
[00:30:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:30:14] [DOC: 9252793] ✅ Text extracted using pdfplumber (2281 chars)
[00:30:14] ✅    ✅ Text extracted using pdfplumber (2281 chars)
[00:30:14] 🔄 
🔄 Step 2: Extracting patient data...
[00:30:17] ℹ️  AI extracted raw sex value: 'F'
[00:30:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:30:17] ℹ️  AI extracted payer source: 'Medicare'
[00:30:17] ℹ️  AI extracted diagnoses:
[00:30:17] ℹ️    - Diagnosis 1: 'None'
[00:30:17] ℹ️    - Diagnosis 2: 'None'
[00:30:17] ℹ️    - Diagnosis 3: 'None'
[00:30:17] ℹ️    - Diagnosis 4: 'None'
[00:30:17] ℹ️    - Diagnosis 5: 'None'
[00:30:17] ℹ️    - Diagnosis 6: 'None'
[00:30:17] ℹ️  Final extracted MRN: '2496015'
[00:30:17] ℹ️  Final extracted Sex: 'FEMALE'
[00:30:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:30:17] ℹ️  Final extracted Payer Source: 'Medicare'
[00:30:17] ✅ Patient data extraction completed successfully
[00:30:17] ✅    ✅ Patient data extracted successfully
[00:30:17] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:30:17] ✅    ✅ Patient identified: Dana Theodore
[00:30:17] ✅    ✅ Patient name validation passed
[00:30:17] 🔄 
🔄 Step 3: Processing patient dates...
[00:30:17] [DOC: 9252793] ℹ️  DOB normalized: 03/16/1954
[00:30:17] [DOC: 9252793] ℹ️  Episode startOfCare normalized: 03/02/2025
[00:30:17] [DOC: 9252793] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[00:30:17] [DOC: 9252793] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[00:30:17] [DOC: 9252793] ✅ Patient date processing completed successfully
[00:30:17] ✅    ✅ Date processing completed
[00:30:17] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025'}]
[00:30:17] 🔄 
🔄 Step 4: Extracting order data...
[00:30:19] ℹ️  Order extraction - MRN: ''
[00:30:19] ℹ️  Order extraction - Sex: 'FEMALE'
[00:30:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:30:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:30:19] ✅ Order data extraction completed successfully
[00:30:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:30:19] ℹ️  Using MRN from patient data: '2496015'
[00:30:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:30:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:30:19] ✅ Patient name cross-validation successful
[00:30:19] ✅    ✅ Data merged successfully
[00:30:20] ✅    ✅ Order data extracted and validated
[00:30:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:30:20] [DOC: 9252793] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:30:20] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:30:20] 🔄 
🔄 Step 6: Pushing order to API...
[00:30:20] [DOC: 9252793] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:30:22] [DOC: 9252793] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:30:22] ❌    ❌ Failed to push order
[00:30:22] 🔄 
🔄 Step 7: Writing to CSV...
[00:30:22] [DOC: 9252793] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[00:30:22] [DOC: 9252793] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:30:22] [DOC: 9252793] ℹ️  Payer Source extracted: 'Medicare'
[00:30:22] [DOC: 9252793] ℹ️  Diagnosis codes being written:
[00:30:22] [DOC: 9252793] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:30:22] [DOC: 9252793] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:30:22] [DOC: 9252793] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:30:22] [DOC: 9252793] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:30:22] [DOC: 9252793] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:30:22] [DOC: 9252793] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:30:22] [DOC: 9252793] ✅ Patient data written to CSV: Dana Theodore | Sex: FEMALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[00:30:22] ✅    ✅ Document 9252793 processed and saved successfully
[00:30:22] 🔄 
🔄 Step 8: Saving API details...
[00:30:22] [DOC: 9252793] ℹ️  API push details saved for document 9252793
[00:30:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252784                         ║
================================================================================
[00:30:22] ℹ️  Agency: Dartmouth HH
[00:30:22] ℹ️  Date: 04/22/2025
[00:30:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:30:24] [DOC: 9252784] ✅ Text extracted using pdfplumber (4798 chars)
[00:30:24] ✅    ✅ Text extracted using pdfplumber (4798 chars)
[00:30:24] 🔄 
🔄 Step 2: Extracting patient data...
[00:30:28] ℹ️  AI extracted raw sex value: 'F'
[00:30:28] ℹ️  AI extracted service line: 'PT'
[00:30:28] ℹ️  AI extracted payer source: 'Medicare'
[00:30:28] ℹ️  AI extracted diagnoses:
[00:30:28] ℹ️    - Diagnosis 1: 'RSV'
[00:30:28] ℹ️    - Diagnosis 2: ''
[00:30:28] ℹ️    - Diagnosis 3: ''
[00:30:28] ℹ️    - Diagnosis 4: ''
[00:30:28] ℹ️    - Diagnosis 5: ''
[00:30:28] ℹ️    - Diagnosis 6: ''
[00:30:28] ℹ️  Final extracted MRN: '5915015'
[00:30:28] ℹ️  Final extracted Sex: 'FEMALE'
[00:30:28] ℹ️  Final extracted Service Line: 'PT'
[00:30:28] ℹ️  Final extracted Payer Source: 'Medicare'
[00:30:28] ✅ Patient data extraction completed successfully
[00:30:28] ✅    ✅ Patient data extracted successfully
[00:30:28] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'afib', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:30:28] ✅    ✅ Patient identified: Suzanne Fawcett
[00:30:28] ✅    ✅ Patient name validation passed
[00:30:28] 🔄 
🔄 Step 3: Processing patient dates...
[00:30:28] [DOC: 9252784] ℹ️  DOB normalized: 12/08/1939
[00:30:28] [DOC: 9252784] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:30:28] [DOC: 9252784] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[00:30:28] [DOC: 9252784] ℹ️  Episode endOfEpisode normalized: 01/25/2025
[00:30:28] [DOC: 9252784] ✅ Patient date processing completed successfully
[00:30:28] ✅    ✅ Date processing completed
[00:30:28] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'afib', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:30:28] 🔄 
🔄 Step 4: Extracting order data...
[00:30:31] ℹ️  Order extraction - MRN: '5915015'
[00:30:31] ℹ️  Order extraction - Sex: 'FEMALE'
[00:30:31] ℹ️  Order extraction - Service Line: 'PT'
[00:30:31] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:30:31] ✅ Order data extraction completed successfully
[00:30:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:30:31] ℹ️  Using MRN from patient data: '5915015' over '5915015'
[00:30:31] ℹ️  Service line consistent in both sources: 'PT'
[00:30:31] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:30:31] ✅ Patient name cross-validation successful
[00:30:31] ✅    ✅ Data merged successfully
[00:30:32] ✅    ✅ Order data extracted and validated
[00:30:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:30:32] [DOC: 9252784] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:30:32] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:30:32] 🔄 
🔄 Step 6: Pushing order to API...
[00:30:32] [DOC: 9252784] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:30:34] [DOC: 9252784] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:30:34] ❌    ❌ Failed to push order
[00:30:34] 🔄 
🔄 Step 7: Writing to CSV...
[00:30:34] [DOC: 9252784] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:30:34] [DOC: 9252784] ℹ️  Service Line extracted: 'PT'
[00:30:34] [DOC: 9252784] ℹ️  Payer Source extracted: 'Medicare'
[00:30:34] [DOC: 9252784] ℹ️  Diagnosis codes being written:
[00:30:34] [DOC: 9252784] ℹ️    - Latest_Episode_Firstdiagnosis: 'RSV'
[00:30:34] [DOC: 9252784] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:30:34] [DOC: 9252784] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:30:34] [DOC: 9252784] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:30:34] [DOC: 9252784] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:30:34] [DOC: 9252784] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:30:34] [DOC: 9252784] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: PT | Payer: Medicare | MRN: 5915015
[00:30:34] ✅    ✅ Document 9252784 processed and saved successfully
[00:30:34] 🔄 
🔄 Step 8: Saving API details...
[00:30:34] [DOC: 9252784] ℹ️  API push details saved for document 9252784
[00:30:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252649                         ║
================================================================================
[00:30:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:30:34] ℹ️  Date: 04/22/2025
[00:30:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:30:35] [DOC: 9252649] ✅ Text extracted using pdfplumber (1127 chars)
[00:30:35] ✅    ✅ Text extracted using pdfplumber (1127 chars)
[00:30:35] 🔄 
🔄 Step 2: Extracting patient data...
[00:30:38] ℹ️  AI extracted raw sex value: 'F'
[00:30:38] ℹ️  AI extracted service line: 'Medical Social Work'
[00:30:38] ℹ️  AI extracted payer source: ''
[00:30:38] ℹ️  AI extracted diagnoses:
[00:30:38] ℹ️    - Diagnosis 1: 'None'
[00:30:38] ℹ️    - Diagnosis 2: 'None'
[00:30:38] ℹ️    - Diagnosis 3: 'None'
[00:30:38] ℹ️    - Diagnosis 4: 'None'
[00:30:38] ℹ️    - Diagnosis 5: 'None'
[00:30:38] ℹ️    - Diagnosis 6: 'None'
[00:30:38] ℹ️  Final extracted MRN: '2258674'
[00:30:38] ℹ️  Final extracted Sex: 'FEMALE'
[00:30:38] ℹ️  Final extracted Service Line: 'Medical Social Work'
[00:30:38] ℹ️  Final extracted Payer Source: ''
[00:30:38] ✅ Patient data extraction completed successfully
[00:30:38] ✅    ✅ Patient data extracted successfully
[00:30:38] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/21/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:30:38] ✅    ✅ Patient identified: Maryann Boucher
[00:30:38] ✅    ✅ Patient name validation passed
[00:30:38] 🔄 
🔄 Step 3: Processing patient dates...
[00:30:38] [DOC: 9252649] ℹ️  DOB normalized: 03/22/1946
[00:30:38] [DOC: 9252649] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[00:30:38] [DOC: 9252649] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[00:30:38] [DOC: 9252649] ✅ Patient date processing completed successfully
[00:30:38] ✅    ✅ Date processing completed
[00:30:38] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '07/12/2025'}]
[00:30:38] 🔄 
🔄 Step 4: Extracting order data...
[00:30:40] ℹ️  Order extraction - MRN: '2258674'
[00:30:40] ℹ️  Order extraction - Sex: 'FEMALE'
[00:30:40] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[00:30:40] ℹ️  Order extraction - Payer Source: ''
[00:30:40] ✅ Order data extraction completed successfully
[00:30:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:30:40] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[00:30:40] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[00:30:40] ✅ Patient name cross-validation successful
[00:30:40] ✅    ✅ Data merged successfully
[00:30:42] ✅    ✅ Order data extracted and validated
[00:30:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:30:42] [DOC: 9252649] ✅ Patient found in local cache: Maryann Boucher, ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:30:42] ✅    ✅ Existing patient found with ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:30:42] 🔄 
🔄 Step 6: Pushing order to API...
[00:30:42] [DOC: 9252649] ℹ️  Pushing order via API for patient ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:30:43] [DOC: 9252649] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13313"}
[00:30:43] ❌    ❌ Failed to push order
[00:30:43] 🔄 
🔄 Step 7: Writing to CSV...
[00:30:43] [DOC: 9252649] ℹ️  Calculated age: 79 from DOB: 03/22/1946
[00:30:43] [DOC: 9252649] ℹ️  Service Line extracted: 'Medical Social Work'
[00:30:43] [DOC: 9252649] ℹ️  Payer Source extracted: ''
[00:30:43] [DOC: 9252649] ℹ️  Diagnosis codes being written:
[00:30:43] [DOC: 9252649] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:30:43] [DOC: 9252649] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:30:43] [DOC: 9252649] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:30:43] [DOC: 9252649] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:30:43] [DOC: 9252649] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:30:43] [DOC: 9252649] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:30:43] [DOC: 9252649] ✅ Patient data written to CSV: Maryann Boucher | Sex: FEMALE | Age: 79 | Service: Medical Social Work | Payer:  | MRN: 2258674
[00:30:43] ✅    ✅ Document 9252649 processed and saved successfully
[00:30:43] 🔄 
🔄 Step 8: Saving API details...
[00:30:43] [DOC: 9252649] ℹ️  API push details saved for document 9252649
[00:30:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251961                         ║
================================================================================
[00:30:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:30:43] ℹ️  Date: 04/21/2025
[00:30:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:30:45] [DOC: 9251961] ✅ Text extracted using pdfplumber (1332 chars)
[00:30:45] ✅    ✅ Text extracted using pdfplumber (1332 chars)
[00:30:45] 🔄 
🔄 Step 2: Extracting patient data...
[00:30:48] ℹ️  AI extracted raw sex value: ''
[00:30:48] ℹ️  AI extracted service line: 'Physical Therapy'
[00:30:48] ℹ️  AI extracted payer source: ''
[00:30:48] ℹ️  AI extracted diagnoses:
[00:30:48] ℹ️    - Diagnosis 1: 'N30.00'
[00:30:48] ℹ️    - Diagnosis 2: 'E11.9'
[00:30:48] ℹ️    - Diagnosis 3: 'F41.1'
[00:30:48] ℹ️    - Diagnosis 4: 'None'
[00:30:48] ℹ️    - Diagnosis 5: 'None'
[00:30:48] ℹ️    - Diagnosis 6: 'None'
[00:30:48] ℹ️  Final extracted MRN: '101002392'
[00:30:48] ℹ️  Final extracted Sex: ''
[00:30:48] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:30:48] ℹ️  Final extracted Payer Source: ''
[00:30:48] ✅ Patient data extraction completed successfully
[00:30:48] ✅    ✅ Patient data extracted successfully
[00:30:48] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:30:48] ✅    ✅ Patient identified: Virginia Brunton
[00:30:48] ✅    ✅ Patient name validation passed
[00:30:48] 🔄 
🔄 Step 3: Processing patient dates...
[00:30:48] [DOC: 9251961] ℹ️  DOB normalized: 06/05/1940
[00:30:48] [DOC: 9251961] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:30:48] [DOC: 9251961] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:30:48] [DOC: 9251961] ✅ Patient date processing completed successfully
[00:30:48] ✅    ✅ Date processing completed
[00:30:48] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[00:30:48] 🔄 
🔄 Step 4: Extracting order data...
[00:30:51] ℹ️  Order extraction - MRN: '101002392'
[00:30:51] ℹ️  Order extraction - Sex: ''
[00:30:51] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:30:51] ℹ️  Order extraction - Payer Source: ''
[00:30:51] ✅ Order data extraction completed successfully
[00:30:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:30:51] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:30:51] ℹ️  Inferred sex as FEMALE from name: Virginia
[00:30:51] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:30:51] ✅ Patient name cross-validation successful
[00:30:51] ✅    ✅ Data merged successfully
[00:30:52] ✅    ✅ Order data extracted and validated
[00:30:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:30:52] [DOC: 9251961] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:30:52] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:30:52] 🔄 
🔄 Step 6: Pushing order to API...
[00:30:52] [DOC: 9251961] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:30:53] [DOC: 9251961] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13405"}
[00:30:53] ❌    ❌ Failed to push order
[00:30:53] 🔄 
🔄 Step 7: Writing to CSV...
[00:30:53] [DOC: 9251961] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:30:53] [DOC: 9251961] ℹ️  Service Line extracted: 'Physical Therapy'
[00:30:53] [DOC: 9251961] ℹ️  Payer Source extracted: ''
[00:30:53] [DOC: 9251961] ℹ️  Diagnosis codes being written:
[00:30:53] [DOC: 9251961] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:30:53] [DOC: 9251961] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:30:53] [DOC: 9251961] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:30:53] [DOC: 9251961] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:30:53] [DOC: 9251961] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:30:53] [DOC: 9251961] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:30:53] [DOC: 9251961] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Physical Therapy | Payer:  | MRN: 101002392
[00:30:53] ✅    ✅ Document 9251961 processed and saved successfully
[00:30:53] 🔄 
🔄 Step 8: Saving API details...
[00:30:53] [DOC: 9251961] ℹ️  API push details saved for document 9251961
[00:30:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251957                         ║
================================================================================
[00:30:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:30:53] ℹ️  Date: 04/21/2025
[00:30:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:30:56] [DOC: 9251957] ✅ Text extracted using pdfplumber (1614 chars)
[00:30:56] ✅    ✅ Text extracted using pdfplumber (1614 chars)
[00:30:56] 🔄 
🔄 Step 2: Extracting patient data...
[00:30:59] ℹ️  AI extracted raw sex value: ''
[00:30:59] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:30:59] ℹ️  AI extracted payer source: ''
[00:30:59] ℹ️  AI extracted diagnoses:
[00:30:59] ℹ️    - Diagnosis 1: 'N30.00'
[00:30:59] ℹ️    - Diagnosis 2: 'E11.9'
[00:30:59] ℹ️    - Diagnosis 3: 'F41.1'
[00:30:59] ℹ️    - Diagnosis 4: 'None'
[00:30:59] ℹ️    - Diagnosis 5: 'None'
[00:30:59] ℹ️    - Diagnosis 6: 'None'
[00:30:59] ℹ️  Final extracted MRN: '101002392'
[00:30:59] ℹ️  Final extracted Sex: ''
[00:30:59] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:30:59] ℹ️  Final extracted Payer Source: ''
[00:30:59] ✅ Patient data extraction completed successfully
[00:30:59] ✅    ✅ Patient data extracted successfully
[00:30:59] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:30:59] ✅    ✅ Patient identified: Virginia Brunton
[00:30:59] ✅    ✅ Patient name validation passed
[00:30:59] 🔄 
🔄 Step 3: Processing patient dates...
[00:30:59] [DOC: 9251957] ℹ️  DOB normalized: 06/05/1940
[00:30:59] [DOC: 9251957] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:30:59] [DOC: 9251957] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:30:59] [DOC: 9251957] ✅ Patient date processing completed successfully
[00:30:59] ✅    ✅ Date processing completed
[00:30:59] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[00:30:59] 🔄 
🔄 Step 4: Extracting order data...
[00:31:02] ℹ️  Order extraction - MRN: '101002392'
[00:31:02] ℹ️  Order extraction - Sex: ''
[00:31:02] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:31:02] ℹ️  Order extraction - Payer Source: ''
[00:31:02] ✅ Order data extraction completed successfully
[00:31:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:31:02] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:31:02] ℹ️  Inferred sex as FEMALE from name: Virginia
[00:31:02] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:31:02] ✅ Patient name cross-validation successful
[00:31:02] ✅    ✅ Data merged successfully
[00:31:03] ✅    ✅ Order data extracted and validated
[00:31:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:31:03] [DOC: 9251957] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:03] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:03] 🔄 
🔄 Step 6: Pushing order to API...
[00:31:03] [DOC: 9251957] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:04] [DOC: 9251957] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13406"}
[00:31:04] ❌    ❌ Failed to push order
[00:31:04] 🔄 
🔄 Step 7: Writing to CSV...
[00:31:04] [DOC: 9251957] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:31:04] [DOC: 9251957] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:31:04] [DOC: 9251957] ℹ️  Payer Source extracted: ''
[00:31:04] [DOC: 9251957] ℹ️  Diagnosis codes being written:
[00:31:04] [DOC: 9251957] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:31:04] [DOC: 9251957] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:31:04] [DOC: 9251957] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:31:04] [DOC: 9251957] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:31:04] [DOC: 9251957] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:31:04] [DOC: 9251957] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:31:04] [DOC: 9251957] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Occupational Therapy | Payer:  | MRN: 101002392
[00:31:04] ✅    ✅ Document 9251957 processed and saved successfully
[00:31:04] 🔄 
🔄 Step 8: Saving API details...
[00:31:04] [DOC: 9251957] ℹ️  API push details saved for document 9251957
[00:31:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251947                         ║
================================================================================
[00:31:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:31:04] ℹ️  Date: 04/21/2025
[00:31:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:31:08] [DOC: 9251947] ✅ Text extracted using pdfplumber (12667 chars)
[00:31:08] ✅    ✅ Text extracted using pdfplumber (12667 chars)
[00:31:08] 🔄 
🔄 Step 2: Extracting patient data...
[00:31:11] ℹ️  AI extracted raw sex value: 'F'
[00:31:11] ℹ️  AI extracted service line: 'OT'
[00:31:11] ℹ️  AI extracted payer source: ''
[00:31:11] ℹ️  AI extracted diagnoses:
[00:31:11] ℹ️    - Diagnosis 1: 'vertigo'
[00:31:11] ℹ️    - Diagnosis 2: 'muscle weakness'
[00:31:11] ℹ️    - Diagnosis 3: ''
[00:31:11] ℹ️    - Diagnosis 4: ''
[00:31:11] ℹ️    - Diagnosis 5: ''
[00:31:11] ℹ️    - Diagnosis 6: ''
[00:31:11] ℹ️  Final extracted MRN: '101002392'
[00:31:11] ℹ️  Final extracted Sex: 'FEMALE'
[00:31:11] ℹ️  Final extracted Service Line: 'OT'
[00:31:11] ℹ️  Final extracted Payer Source: ''
[00:31:11] ✅ Patient data extraction completed successfully
[00:31:11] ✅    ✅ Patient data extracted successfully
[00:31:11] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:31:11] ✅    ✅ Patient identified: Virginia Brunton
[00:31:11] ✅    ✅ Patient name validation passed
[00:31:11] 🔄 
🔄 Step 3: Processing patient dates...
[00:31:11] [DOC: 9251947] ℹ️  DOB normalized: 06/05/1940
[00:31:11] [DOC: 9251947] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[00:31:11] [DOC: 9251947] ✅ Patient date processing completed successfully
[00:31:11] ✅    ✅ Date processing completed
[00:31:11] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:31:11] 🔄 
🔄 Step 4: Extracting order data...
[00:31:13] ℹ️  Order extraction - MRN: '101002392'
[00:31:13] ℹ️  Order extraction - Sex: 'FEMALE'
[00:31:13] ℹ️  Order extraction - Service Line: 'OT'
[00:31:13] ℹ️  Order extraction - Payer Source: ''
[00:31:13] ✅ Order data extraction completed successfully
[00:31:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:31:13] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:31:13] ℹ️  Service line consistent in both sources: 'OT'
[00:31:13] ✅ Patient name cross-validation successful
[00:31:13] ✅    ✅ Data merged successfully
[00:31:14] ✅    ✅ Order data extracted and validated
[00:31:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:31:14] [DOC: 9251947] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:14] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:14] 🔄 
🔄 Step 6: Pushing order to API...
[00:31:14] [DOC: 9251947] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:16] [DOC: 9251947] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:31:16] ❌    ❌ Failed to push order
[00:31:16] 🔄 
🔄 Step 7: Writing to CSV...
[00:31:16] [DOC: 9251947] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:31:16] [DOC: 9251947] ℹ️  Service Line extracted: 'OT'
[00:31:16] [DOC: 9251947] ℹ️  Payer Source extracted: ''
[00:31:16] [DOC: 9251947] ℹ️  Diagnosis codes being written:
[00:31:16] [DOC: 9251947] ℹ️    - Latest_Episode_Firstdiagnosis: 'vertigo'
[00:31:16] [DOC: 9251947] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[00:31:16] [DOC: 9251947] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:31:16] [DOC: 9251947] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:31:16] [DOC: 9251947] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:31:16] [DOC: 9251947] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:31:16] [DOC: 9251947] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: OT | Payer:  | MRN: 101002392
[00:31:16] ✅    ✅ Document 9251947 processed and saved successfully
[00:31:16] 🔄 
🔄 Step 8: Saving API details...
[00:31:16] [DOC: 9251947] ℹ️  API push details saved for document 9251947
[00:31:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251936                         ║
================================================================================
[00:31:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:31:16] ℹ️  Date: 04/21/2025
[00:31:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:31:18] [DOC: 9251936] ✅ Text extracted using pdfplumber (1469 chars)
[00:31:18] ✅    ✅ Text extracted using pdfplumber (1469 chars)
[00:31:18] 🔄 
🔄 Step 2: Extracting patient data...
[00:31:21] ℹ️  AI extracted raw sex value: ''
[00:31:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:31:21] ℹ️  AI extracted payer source: ''
[00:31:21] ℹ️  AI extracted diagnoses:
[00:31:21] ℹ️    - Diagnosis 1: 'N30.00'
[00:31:21] ℹ️    - Diagnosis 2: 'E11.9'
[00:31:21] ℹ️    - Diagnosis 3: 'F41.1'
[00:31:21] ℹ️    - Diagnosis 4: 'None'
[00:31:21] ℹ️    - Diagnosis 5: 'None'
[00:31:21] ℹ️    - Diagnosis 6: 'None'
[00:31:21] ℹ️  Final extracted MRN: '101002392'
[00:31:21] ℹ️  Final extracted Sex: ''
[00:31:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:31:21] ℹ️  Final extracted Payer Source: ''
[00:31:21] ✅ Patient data extraction completed successfully
[00:31:21] ✅    ✅ Patient data extracted successfully
[00:31:21] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:31:21] ✅    ✅ Patient identified: Virginia Brunton
[00:31:21] ✅    ✅ Patient name validation passed
[00:31:21] 🔄 
🔄 Step 3: Processing patient dates...
[00:31:21] [DOC: 9251936] ℹ️  DOB normalized: 06/05/1940
[00:31:21] [DOC: 9251936] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[00:31:21] [DOC: 9251936] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[00:31:21] [DOC: 9251936] ✅ Patient date processing completed successfully
[00:31:21] ✅    ✅ Date processing completed
[00:31:21] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[00:31:21] 🔄 
🔄 Step 4: Extracting order data...
[00:31:24] ℹ️  Order extraction - MRN: '101002392'
[00:31:24] ℹ️  Order extraction - Sex: ''
[00:31:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:31:24] ℹ️  Order extraction - Payer Source: ''
[00:31:24] ✅ Order data extraction completed successfully
[00:31:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:31:24] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[00:31:24] ℹ️  Inferred sex as FEMALE from name: Virginia
[00:31:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:31:24] ✅ Patient name cross-validation successful
[00:31:24] ✅    ✅ Data merged successfully
[00:31:25] ✅    ✅ Order data extracted and validated
[00:31:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:31:25] [DOC: 9251936] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:25] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:25] 🔄 
🔄 Step 6: Pushing order to API...
[00:31:25] [DOC: 9251936] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[00:31:27] [DOC: 9251936] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13408"}
[00:31:27] ❌    ❌ Failed to push order
[00:31:27] 🔄 
🔄 Step 7: Writing to CSV...
[00:31:27] [DOC: 9251936] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[00:31:27] [DOC: 9251936] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:31:27] [DOC: 9251936] ℹ️  Payer Source extracted: ''
[00:31:27] [DOC: 9251936] ℹ️  Diagnosis codes being written:
[00:31:27] [DOC: 9251936] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[00:31:27] [DOC: 9251936] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[00:31:27] [DOC: 9251936] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[00:31:27] [DOC: 9251936] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:31:27] [DOC: 9251936] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:31:27] [DOC: 9251936] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:31:27] [DOC: 9251936] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer:  | MRN: 101002392
[00:31:27] ✅    ✅ Document 9251936 processed and saved successfully
[00:31:27] 🔄 
🔄 Step 8: Saving API details...
[00:31:27] [DOC: 9251936] ℹ️  API push details saved for document 9251936
[00:31:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9250807                         ║
================================================================================
[00:31:27] ℹ️  Agency: Nizhoni Health-Fall River
[00:31:27] ℹ️  Date: 04/21/2025
[00:31:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:31:41] [DOC: 9250807] ✅ Text extracted using pdfplumber (10147 chars)
[00:31:41] ✅    ✅ Text extracted using pdfplumber (10147 chars)
[00:31:41] 🔄 
🔄 Step 2: Extracting patient data...
[00:31:44] ℹ️  AI extracted raw sex value: 'F'
[00:31:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:31:44] ℹ️  AI extracted payer source: 'None'
[00:31:44] ℹ️  AI extracted diagnoses:
[00:31:44] ℹ️    - Diagnosis 1: 'F32.9'
[00:31:44] ℹ️    - Diagnosis 2: 'F41.1'
[00:31:44] ℹ️    - Diagnosis 3: 'F43.10'
[00:31:44] ℹ️    - Diagnosis 4: 'I10'
[00:31:44] ℹ️    - Diagnosis 5: 'E11.9'
[00:31:44] ℹ️    - Diagnosis 6: 'E66.9'
[00:31:44] ℹ️  Final extracted MRN: '3761020'
[00:31:44] ℹ️  Final extracted Sex: 'FEMALE'
[00:31:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:31:44] ℹ️  Final extracted Payer Source: ''
[00:31:44] ✅ Patient data extraction completed successfully
[00:31:44] ✅    ✅ Patient data extracted successfully
[00:31:44] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100007365347
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'E66.9'}]
[00:31:44] ✅    ✅ Patient identified: Carol Jimon-Ajqui
[00:31:44] ✅    ✅ Patient name validation passed
[00:31:44] 🔄 
🔄 Step 3: Processing patient dates...
[00:31:44] [DOC: 9250807] ℹ️  DOB normalized: 08/23/1974
[00:31:44] [DOC: 9250807] ℹ️  Episode startOfCare normalized: 01/04/2023
[00:31:44] [DOC: 9250807] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[00:31:44] [DOC: 9250807] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[00:31:44] [DOC: 9250807] ✅ Patient date processing completed successfully
[00:31:44] ✅    ✅ Date processing completed
[00:31:44] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100007365347
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'E66.9'}]
[00:31:44] 🔄 
🔄 Step 4: Extracting order data...
[00:31:47] ℹ️  Order extraction - MRN: '3761020'
[00:31:47] ℹ️  Order extraction - Sex: 'FEMALE'
[00:31:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:31:47] ℹ️  Order extraction - Payer Source: ''
[00:31:47] ✅ Order data extraction completed successfully
[00:31:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:31:47] ℹ️  Using MRN from patient data: '3761020' over '3761020'
[00:31:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:31:47] ✅ Patient name cross-validation successful
[00:31:47] ✅    ✅ Data merged successfully
[00:31:48] ✅    ✅ Order data extracted and validated
[00:31:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:31:48] [DOC: 9250807] ✅ Patient found in local cache: Carol Jimon-Ajqui, ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:31:48] ✅    ✅ Existing patient found with ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:31:48] 🔄 
🔄 Step 6: Pushing order to API...
[00:31:48] [DOC: 9250807] ℹ️  Pushing order via API for patient ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:31:49] [DOC: 9250807] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:31:49] ❌    ❌ Failed to push order
[00:31:49] 🔄 
🔄 Step 7: Writing to CSV...
[00:31:49] [DOC: 9250807] ℹ️  Calculated age: 50 from DOB: 08/23/1974
[00:31:49] [DOC: 9250807] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:31:49] [DOC: 9250807] ℹ️  Payer Source extracted: ''
[00:31:49] [DOC: 9250807] ℹ️  Diagnosis codes being written:
[00:31:49] [DOC: 9250807] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.9'
[00:31:49] [DOC: 9250807] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[00:31:49] [DOC: 9250807] ℹ️    - Latest_Episode_Thirddiagnosis: 'F43.10'
[00:31:49] [DOC: 9250807] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[00:31:49] [DOC: 9250807] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.9'
[00:31:49] [DOC: 9250807] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.9'
[00:31:49] [DOC: 9250807] ✅ Patient data written to CSV: Carol Jimon-Ajqui | Sex: FEMALE | Age: 50 | Service: Skilled Nursing | Payer:  | MRN: 3761020
[00:31:49] ✅    ✅ Document 9250807 processed and saved successfully
[00:31:49] 🔄 
🔄 Step 8: Saving API details...
[00:31:49] [DOC: 9250807] ℹ️  API push details saved for document 9250807
[00:31:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249183                         ║
================================================================================
[00:31:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:31:49] ℹ️  Date: 04/18/2025
[00:31:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:31:57] [DOC: 9249183] ✅ Text extracted using pdfplumber (35626 chars)
[00:31:57] ✅    ✅ Text extracted using pdfplumber (35626 chars)
[00:31:57] 🔄 
🔄 Step 2: Extracting patient data...
[00:32:01] ℹ️  AI extracted raw sex value: 'F'
[00:32:01] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[00:32:01] ℹ️  AI extracted payer source: ''
[00:32:01] ℹ️  AI extracted diagnoses:
[00:32:01] ℹ️    - Diagnosis 1: 'C22.0'
[00:32:01] ℹ️    - Diagnosis 2: 'K74.69'
[00:32:01] ℹ️    - Diagnosis 3: 'N17.9'
[00:32:01] ℹ️    - Diagnosis 4: 'N18.9'
[00:32:01] ℹ️    - Diagnosis 5: 'D64.9'
[00:32:01] ℹ️    - Diagnosis 6: 'K21.9'
[00:32:01] ℹ️  Final extracted MRN: '2258674'
[00:32:01] ℹ️  Final extracted Sex: 'FEMALE'
[00:32:01] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[00:32:01] ℹ️  Final extracted Payer Source: ''
[00:32:01] ✅ Patient data extraction completed successfully
[00:32:01] ✅    ✅ Patient data extracted successfully
[00:32:01] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[00:32:01] ✅    ✅ Patient identified: Maryann Boucher
[00:32:01] ✅    ✅ Patient name validation passed
[00:32:01] 🔄 
🔄 Step 3: Processing patient dates...
[00:32:01] [DOC: 9249183] ℹ️  DOB normalized: 03/22/1946
[00:32:01] [DOC: 9249183] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[00:32:01] [DOC: 9249183] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[00:32:01] [DOC: 9249183] ✅ Patient date processing completed successfully
[00:32:01] ✅    ✅ Date processing completed
[00:32:01] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[00:32:01] 🔄 
🔄 Step 4: Extracting order data...
[00:32:04] ℹ️  Order extraction - MRN: '2258674'
[00:32:04] ℹ️  Order extraction - Sex: 'FEMALE'
[00:32:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[00:32:04] ℹ️  Order extraction - Payer Source: ''
[00:32:04] ✅ Order data extraction completed successfully
[00:32:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:32:04] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[00:32:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, HHA'
[00:32:04] ✅ Patient name cross-validation successful
[00:32:04] ✅    ✅ Data merged successfully
[00:32:05] ✅    ✅ Order data extracted and validated
[00:32:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:32:05] [DOC: 9249183] ✅ Patient found in local cache: Maryann Boucher, ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:32:05] ✅    ✅ Existing patient found with ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:32:05] 🔄 
🔄 Step 6: Pushing order to API...
[00:32:05] [DOC: 9249183] ℹ️  Pushing order via API for patient ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:32:06] [DOC: 9249183] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13314"}
[00:32:06] ❌    ❌ Failed to push order
[00:32:06] 🔄 
🔄 Step 7: Writing to CSV...
[00:32:06] [DOC: 9249183] ℹ️  Calculated age: 79 from DOB: 03/22/1946
[00:32:06] [DOC: 9249183] ℹ️  Service Line extracted: 'Skilled Nursing, MSW, Clergy, HHA'
[00:32:06] [DOC: 9249183] ℹ️  Payer Source extracted: ''
[00:32:06] [DOC: 9249183] ℹ️  Diagnosis codes being written:
[00:32:06] [DOC: 9249183] ℹ️    - Latest_Episode_Firstdiagnosis: 'C22.0'
[00:32:06] [DOC: 9249183] ℹ️    - Latest_Episode_Seconddiagnosis: 'K74.69'
[00:32:06] [DOC: 9249183] ℹ️    - Latest_Episode_Thirddiagnosis: 'N17.9'
[00:32:06] [DOC: 9249183] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.9'
[00:32:06] [DOC: 9249183] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D64.9'
[00:32:06] [DOC: 9249183] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[00:32:06] [DOC: 9249183] ✅ Patient data written to CSV: Maryann Boucher | Sex: FEMALE | Age: 79 | Service: Skilled Nursing, MSW, Clergy, HHA | Payer:  | MRN: 2258674
[00:32:06] ✅    ✅ Document 9249183 processed and saved successfully
[00:32:06] 🔄 
🔄 Step 8: Saving API details...
[00:32:06] [DOC: 9249183] ℹ️  API push details saved for document 9249183
[00:32:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9249182                         ║
================================================================================
[00:32:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:32:06] ℹ️  Date: 04/18/2025
[00:32:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:32:09] [DOC: 9249182] ✅ Text extracted using pdfplumber (9192 chars)
[00:32:09] ✅    ✅ Text extracted using pdfplumber (9192 chars)
[00:32:09] 🔄 
🔄 Step 2: Extracting patient data...
[00:32:12] ℹ️  AI extracted raw sex value: 'F'
[00:32:12] ℹ️  AI extracted service line: 'Hospice'
[00:32:12] ℹ️  AI extracted payer source: ''
[00:32:12] ℹ️  AI extracted diagnoses:
[00:32:12] ℹ️    - Diagnosis 1: 'C22.0'
[00:32:12] ℹ️    - Diagnosis 2: 'K74.69'
[00:32:12] ℹ️    - Diagnosis 3: 'N17.9'
[00:32:12] ℹ️    - Diagnosis 4: 'N18.9'
[00:32:12] ℹ️    - Diagnosis 5: 'D64.9'
[00:32:12] ℹ️    - Diagnosis 6: 'K21.9'
[00:32:12] ℹ️  Final extracted MRN: '2258674'
[00:32:12] ℹ️  Final extracted Sex: 'FEMALE'
[00:32:12] ℹ️  Final extracted Service Line: 'Hospice'
[00:32:12] ℹ️  Final extracted Payer Source: ''
[00:32:12] ✅ Patient data extraction completed successfully
[00:32:12] ✅    ✅ Patient data extracted successfully
[00:32:12] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[00:32:12] ✅    ✅ Patient identified: Maryann Boucher
[00:32:12] ✅    ✅ Patient name validation passed
[00:32:12] 🔄 
🔄 Step 3: Processing patient dates...
[00:32:12] [DOC: 9249182] ℹ️  DOB normalized: 03/22/1946
[00:32:12] [DOC: 9249182] ℹ️  Episode startOfCare normalized: 04/16/2025
[00:32:12] [DOC: 9249182] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[00:32:12] [DOC: 9249182] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[00:32:12] [DOC: 9249182] ✅ Patient date processing completed successfully
[00:32:12] ✅    ✅ Date processing completed
[00:32:12] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'C22.0', 'secondDiagnosis': 'K74.69', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'N18.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'K21.9'}]
[00:32:12] 🔄 
🔄 Step 4: Extracting order data...
[00:32:15] ℹ️  Order extraction - MRN: '2258674'
[00:32:15] ℹ️  Order extraction - Sex: 'FEMALE'
[00:32:15] ℹ️  Order extraction - Service Line: 'Nursing'
[00:32:15] ℹ️  Order extraction - Payer Source: ''
[00:32:15] ✅ Order data extraction completed successfully
[00:32:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:32:15] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[00:32:15] ℹ️  Combined service lines: Patient='Hospice' + Order='Nursing' = 'Hospice, Nursing'
[00:32:15] ✅ Patient name cross-validation successful
[00:32:15] ✅    ✅ Data merged successfully
[00:32:16] ✅    ✅ Order data extracted and validated
[00:32:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:32:16] [DOC: 9249182] ✅ Patient found in local cache: Maryann Boucher, ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:32:16] ✅    ✅ Existing patient found with ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:32:16] 🔄 
🔄 Step 6: Pushing order to API...
[00:32:16] [DOC: 9249182] ℹ️  Pushing order via API for patient ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:32:17] [DOC: 9249182] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13315"}
[00:32:17] ❌    ❌ Failed to push order
[00:32:17] 🔄 
🔄 Step 7: Writing to CSV...
[00:32:17] [DOC: 9249182] ℹ️  Calculated age: 79 from DOB: 03/22/1946
[00:32:17] [DOC: 9249182] ℹ️  Service Line extracted: 'Hospice, Nursing'
[00:32:17] [DOC: 9249182] ℹ️  Payer Source extracted: ''
[00:32:17] [DOC: 9249182] ℹ️  Diagnosis codes being written:
[00:32:17] [DOC: 9249182] ℹ️    - Latest_Episode_Firstdiagnosis: 'C22.0'
[00:32:17] [DOC: 9249182] ℹ️    - Latest_Episode_Seconddiagnosis: 'K74.69'
[00:32:17] [DOC: 9249182] ℹ️    - Latest_Episode_Thirddiagnosis: 'N17.9'
[00:32:17] [DOC: 9249182] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.9'
[00:32:17] [DOC: 9249182] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D64.9'
[00:32:17] [DOC: 9249182] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[00:32:17] [DOC: 9249182] ✅ Patient data written to CSV: Maryann Boucher | Sex: FEMALE | Age: 79 | Service: Hospice, Nursing | Payer:  | MRN: 2258674
[00:32:17] ✅    ✅ Document 9249182 processed and saved successfully
[00:32:17] 🔄 
🔄 Step 8: Saving API details...
[00:32:17] [DOC: 9249182] ℹ️  API push details saved for document 9249182
[00:32:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247936                         ║
================================================================================
[00:32:17] ℹ️  Agency: Dartmouth HH
[00:32:17] ℹ️  Date: 04/18/2025
[00:32:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:32:19] [DOC: 9247936] ✅ Text extracted using pdfplumber (1470 chars)
[00:32:19] ✅    ✅ Text extracted using pdfplumber (1470 chars)
[00:32:19] 🔄 
🔄 Step 2: Extracting patient data...
[00:32:22] ℹ️  AI extracted raw sex value: 'F'
[00:32:22] ℹ️  AI extracted service line: 'OT'
[00:32:22] ℹ️  AI extracted payer source: 'Medicare'
[00:32:22] ℹ️  AI extracted diagnoses:
[00:32:22] ℹ️    - Diagnosis 1: 'None'
[00:32:22] ℹ️    - Diagnosis 2: 'None'
[00:32:22] ℹ️    - Diagnosis 3: 'None'
[00:32:22] ℹ️    - Diagnosis 4: 'None'
[00:32:22] ℹ️    - Diagnosis 5: 'None'
[00:32:22] ℹ️    - Diagnosis 6: 'None'
[00:32:22] ℹ️  Final extracted MRN: '711015'
[00:32:22] ℹ️  Final extracted Sex: 'FEMALE'
[00:32:22] ℹ️  Final extracted Service Line: 'OT'
[00:32:22] ℹ️  Final extracted Payer Source: 'Medicare'
[00:32:22] ✅ Patient data extraction completed successfully
[00:32:22] ✅    ✅ Patient data extracted successfully
[00:32:22] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:32:22] ✅    ✅ Patient identified: Eileen Roddy
[00:32:22] ✅    ✅ Patient name validation passed
[00:32:22] 🔄 
🔄 Step 3: Processing patient dates...
[00:32:22] [DOC: 9247936] ℹ️  DOB normalized: 02/29/1948
[00:32:22] [DOC: 9247936] ℹ️  Episode startOfCare normalized: 04/02/2025
[00:32:22] [DOC: 9247936] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[00:32:22] [DOC: 9247936] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:32:22] [DOC: 9247936] ✅ Patient date processing completed successfully
[00:32:22] ✅    ✅ Date processing completed
[00:32:22] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: David J Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '05/31/2025'}]
[00:32:22] 🔄 
🔄 Step 4: Extracting order data...
[00:32:24] ℹ️  Order extraction - MRN: ''
[00:32:24] ℹ️  Order extraction - Sex: 'FEMALE'
[00:32:24] ℹ️  Order extraction - Service Line: 'OT'
[00:32:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:32:24] ✅ Order data extraction completed successfully
[00:32:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:32:24] ℹ️  Using MRN from patient data: '711015'
[00:32:24] ℹ️  Service line consistent in both sources: 'OT'
[00:32:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:32:24] ✅ Patient name cross-validation successful
[00:32:24] ✅    ✅ Data merged successfully
[00:32:26] ✅    ✅ Order data extracted and validated
[00:32:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:32:26] [DOC: 9247936] ✅ Patient found in local cache: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:32:26] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:32:26] 🔄 
🔄 Step 6: Pushing order to API...
[00:32:26] [DOC: 9247936] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:32:27] [DOC: 9247936] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:32:27] ❌    ❌ Failed to push order
[00:32:27] 🔄 
🔄 Step 7: Writing to CSV...
[00:32:27] [DOC: 9247936] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[00:32:27] [DOC: 9247936] ℹ️  Service Line extracted: 'OT'
[00:32:27] [DOC: 9247936] ℹ️  Payer Source extracted: 'Medicare'
[00:32:27] [DOC: 9247936] ℹ️  Diagnosis codes being written:
[00:32:27] [DOC: 9247936] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:32:27] [DOC: 9247936] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:32:27] [DOC: 9247936] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:32:27] [DOC: 9247936] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:32:27] [DOC: 9247936] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:32:27] [DOC: 9247936] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:32:27] [DOC: 9247936] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: OT | Payer: Medicare | MRN: 711015
[00:32:27] ✅    ✅ Document 9247936 processed and saved successfully
[00:32:27] 🔄 
🔄 Step 8: Saving API details...
[00:32:27] [DOC: 9247936] ℹ️  API push details saved for document 9247936
[00:32:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247931                         ║
================================================================================
[00:32:27] ℹ️  Agency: Dartmouth HH
[00:32:27] ℹ️  Date: 04/18/2025
[00:32:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:32:29] [DOC: 9247931] ✅ Text extracted using pdfplumber (1662 chars)
[00:32:29] ✅    ✅ Text extracted using pdfplumber (1662 chars)
[00:32:29] 🔄 
🔄 Step 2: Extracting patient data...
[00:32:32] ℹ️  AI extracted raw sex value: 'F'
[00:32:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:32:32] ℹ️  AI extracted payer source: 'Medicare'
[00:32:32] ℹ️  AI extracted diagnoses:
[00:32:32] ℹ️    - Diagnosis 1: ''
[00:32:32] ℹ️    - Diagnosis 2: ''
[00:32:32] ℹ️    - Diagnosis 3: ''
[00:32:32] ℹ️    - Diagnosis 4: ''
[00:32:32] ℹ️    - Diagnosis 5: ''
[00:32:32] ℹ️    - Diagnosis 6: ''
[00:32:32] ℹ️  Final extracted MRN: '6115015'
[00:32:32] ℹ️  Final extracted Sex: 'FEMALE'
[00:32:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:32:32] ℹ️  Final extracted Payer Source: 'Medicare'
[00:32:32] ✅ Patient data extraction completed successfully
[00:32:32] ✅    ✅ Patient data extracted successfully
[00:32:32] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:32:32] ✅    ✅ Patient identified: Nancy Silva
[00:32:32] ✅    ✅ Patient name validation passed
[00:32:32] 🔄 
🔄 Step 3: Processing patient dates...
[00:32:32] [DOC: 9247931] ℹ️  DOB normalized: 11/18/1936
[00:32:32] [DOC: 9247931] ℹ️  Episode startOfCare normalized: 03/01/2025
[00:32:32] [DOC: 9247931] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[00:32:32] [DOC: 9247931] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[00:32:32] [DOC: 9247931] ✅ Patient date processing completed successfully
[00:32:32] ✅    ✅ Date processing completed
[00:32:32] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:32:32] 🔄 
🔄 Step 4: Extracting order data...
[00:32:34] ℹ️  Order extraction - MRN: ''
[00:32:34] ℹ️  Order extraction - Sex: 'FEMALE'
[00:32:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:32:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:32:34] ✅ Order data extraction completed successfully
[00:32:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:32:34] ℹ️  Using MRN from patient data: '6115015'
[00:32:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:32:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:32:34] ✅ Patient name cross-validation successful
[00:32:34] ✅    ✅ Data merged successfully
[00:32:36] ✅    ✅ Order data extracted and validated
[00:32:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:32:36] [DOC: 9247931] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:32:36] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:32:36] 🔄 
🔄 Step 6: Pushing order to API...
[00:32:36] [DOC: 9247931] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:32:37] [DOC: 9247931] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:32:37] ❌    ❌ Failed to push order
[00:32:37] 🔄 
🔄 Step 7: Writing to CSV...
[00:32:37] [DOC: 9247931] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[00:32:37] [DOC: 9247931] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:32:37] [DOC: 9247931] ℹ️  Payer Source extracted: 'Medicare'
[00:32:37] [DOC: 9247931] ℹ️  Diagnosis codes being written:
[00:32:37] [DOC: 9247931] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:32:37] [DOC: 9247931] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:32:37] [DOC: 9247931] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:32:37] [DOC: 9247931] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:32:37] [DOC: 9247931] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:32:37] [DOC: 9247931] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:32:37] [DOC: 9247931] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6115015
[00:32:37] ✅    ✅ Document 9247931 processed and saved successfully
[00:32:37] 🔄 
🔄 Step 8: Saving API details...
[00:32:37] [DOC: 9247931] ℹ️  API push details saved for document 9247931
[00:32:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247924                         ║
================================================================================
[00:32:37] ℹ️  Agency: Dartmouth HH
[00:32:37] ℹ️  Date: 04/18/2025
[00:32:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:32:40] [DOC: 9247924] ✅ Text extracted using pdfplumber (15324 chars)
[00:32:40] ✅    ✅ Text extracted using pdfplumber (15312 chars)
[00:32:40] 🔄 
🔄 Step 2: Extracting patient data...
[00:32:44] ℹ️  AI extracted raw sex value: 'F'
[00:32:44] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[00:32:44] ℹ️  AI extracted payer source: ''
[00:32:44] ℹ️  AI extracted diagnoses:
[00:32:44] ℹ️    - Diagnosis 1: 'M47.27'
[00:32:44] ℹ️    - Diagnosis 2: 'R26.89'
[00:32:44] ℹ️    - Diagnosis 3: 'G90.09'
[00:32:44] ℹ️    - Diagnosis 4: 'I10'
[00:32:44] ℹ️    - Diagnosis 5: 'F41.9'
[00:32:44] ℹ️    - Diagnosis 6: 'F32.9'
[00:32:44] ℹ️  Final extracted MRN: '711015'
[00:32:44] ℹ️  Final extracted Sex: 'FEMALE'
[00:32:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[00:32:44] ℹ️  Final extracted Payer Source: ''
[00:32:44] ✅ Patient data extraction completed successfully
[00:32:44] ✅    ✅ Patient data extracted successfully
[00:32:44] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'M47.27', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'G90.09', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.9'}]
[00:32:44] ✅    ✅ Patient identified: Eileen Roddy
[00:32:44] ✅    ✅ Patient name validation passed
[00:32:44] 🔄 
🔄 Step 3: Processing patient dates...
[00:32:44] [DOC: 9247924] ℹ️  DOB normalized: 02/29/1948
[00:32:44] [DOC: 9247924] ℹ️  Episode startOfCare normalized: 04/02/2025
[00:32:44] [DOC: 9247924] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[00:32:44] [DOC: 9247924] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[00:32:44] [DOC: 9247924] ✅ Patient date processing completed successfully
[00:32:44] ✅    ✅ Date processing completed
[00:32:44] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'M47.27', 'secondDiagnosis': 'R26.89', 'thirdDiagnosis': 'G90.09', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.9'}]
[00:32:44] 🔄 
🔄 Step 4: Extracting order data...
[00:32:46] ℹ️  Order extraction - MRN: '711015'
[00:32:46] ℹ️  Order extraction - Sex: 'FEMALE'
[00:32:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[00:32:46] ℹ️  Order extraction - Payer Source: ''
[00:32:46] ✅ Order data extraction completed successfully
[00:32:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:32:46] ℹ️  Using MRN from patient data: '711015' over '711015'
[00:32:46] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='Skilled Nursing, Physical Therapy' = 'PT, Physical Therapy, Skilled Nursing'
[00:32:46] ✅ Patient name cross-validation successful
[00:32:46] ✅    ✅ Data merged successfully
[00:32:47] ✅    ✅ Order data extracted and validated
[00:32:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:32:47] [DOC: 9247924] ✅ Patient found in local cache: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:32:47] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:32:47] 🔄 
🔄 Step 6: Pushing order to API...
[00:32:47] [DOC: 9247924] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[00:32:48] [DOC: 9247924] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:32:48] ❌    ❌ Failed to push order
[00:32:48] 🔄 
🔄 Step 7: Writing to CSV...
[00:32:48] [DOC: 9247924] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[00:32:48] [DOC: 9247924] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[00:32:48] [DOC: 9247924] ℹ️  Payer Source extracted: ''
[00:32:48] [DOC: 9247924] ℹ️  Diagnosis codes being written:
[00:32:48] [DOC: 9247924] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.27'
[00:32:48] [DOC: 9247924] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.89'
[00:32:48] [DOC: 9247924] ℹ️    - Latest_Episode_Thirddiagnosis: 'G90.09'
[00:32:48] [DOC: 9247924] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[00:32:48] [DOC: 9247924] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[00:32:48] [DOC: 9247924] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.9'
[00:32:48] [DOC: 9247924] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 711015
[00:32:48] ✅    ✅ Document 9247924 processed and saved successfully
[00:32:48] 🔄 
🔄 Step 8: Saving API details...
[00:32:48] [DOC: 9247924] ℹ️  API push details saved for document 9247924
[00:32:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247858                         ║
================================================================================
[00:32:48] ℹ️  Agency: Dartmouth HH
[00:32:48] ℹ️  Date: 04/18/2025
[00:32:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:32:51] [DOC: 9247858] ✅ Text extracted using pdfplumber (1079 chars)
[00:32:51] ✅    ✅ Text extracted using pdfplumber (1079 chars)
[00:32:51] 🔄 
🔄 Step 2: Extracting patient data...
[00:32:53] ℹ️  AI extracted raw sex value: 'F'
[00:32:53] ℹ️  AI extracted service line: 'Physical Therapy'
[00:32:53] ℹ️  AI extracted payer source: 'Medicare'
[00:32:53] ℹ️  AI extracted diagnoses:
[00:32:53] ℹ️    - Diagnosis 1: 'None'
[00:32:53] ℹ️    - Diagnosis 2: 'None'
[00:32:53] ℹ️    - Diagnosis 3: 'None'
[00:32:53] ℹ️    - Diagnosis 4: 'None'
[00:32:53] ℹ️    - Diagnosis 5: 'None'
[00:32:53] ℹ️    - Diagnosis 6: 'None'
[00:32:53] ℹ️  Final extracted MRN: '6267009'
[00:32:53] ℹ️  Final extracted Sex: 'FEMALE'
[00:32:53] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:32:53] ℹ️  Final extracted Payer Source: 'Medicare'
[00:32:53] ✅ Patient data extraction completed successfully
[00:32:53] ✅    ✅ Patient data extracted successfully
[00:32:53] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 17 Junior Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:32:53] ✅    ✅ Patient identified: Donna Finni
[00:32:53] ✅    ✅ Patient name validation passed
[00:32:53] 🔄 
🔄 Step 3: Processing patient dates...
[00:32:53] [DOC: 9247858] ℹ️  DOB normalized: 04/04/1955
[00:32:53] [DOC: 9247858] ℹ️  Episode startOfCare normalized: 03/19/2025
[00:32:53] [DOC: 9247858] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[00:32:53] [DOC: 9247858] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[00:32:53] [DOC: 9247858] ✅ Patient date processing completed successfully
[00:32:53] ✅    ✅ Date processing completed
[00:32:53] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 17 Junior Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025'}]
[00:32:53] 🔄 
🔄 Step 4: Extracting order data...
[00:32:56] ℹ️  Order extraction - MRN: ''
[00:32:56] ℹ️  Order extraction - Sex: 'FEMALE'
[00:32:56] ℹ️  Order extraction - Service Line: 'PT'
[00:32:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:32:56] ✅ Order data extraction completed successfully
[00:32:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:32:56] ℹ️  Using MRN from patient data: '6267009'
[00:32:56] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[00:32:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:32:56] ✅ Patient name cross-validation successful
[00:32:56] ✅    ✅ Data merged successfully
[00:32:57] ✅    ✅ Order data extracted and validated
[00:32:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:33:00] [DOC: 9247858] ✅ Patient exists in API: Donna Finni, ID: b65d9a94-f3a4-4249-9789-eba56300631b
[00:33:00] ✅    ✅ Existing patient found with ID: b65d9a94-f3a4-4249-9789-eba56300631b
[00:33:00] 🔄 
🔄 Step 6: Pushing order to API...
[00:33:00] [DOC: 9247858] ℹ️  Pushing order via API for patient ID: b65d9a94-f3a4-4249-9789-eba56300631b
[00:33:01] [DOC: 9247858] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14048"}
[00:33:01] ❌    ❌ Failed to push order
[00:33:01] 🔄 
🔄 Step 7: Writing to CSV...
[00:33:01] [DOC: 9247858] ℹ️  Calculated age: 70 from DOB: 04/04/1955
[00:33:01] [DOC: 9247858] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[00:33:01] [DOC: 9247858] ℹ️  Payer Source extracted: 'Medicare'
[00:33:01] [DOC: 9247858] ℹ️  Diagnosis codes being written:
[00:33:01] [DOC: 9247858] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:33:01] [DOC: 9247858] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:33:01] [DOC: 9247858] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:33:01] [DOC: 9247858] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:33:01] [DOC: 9247858] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:33:01] [DOC: 9247858] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:33:01] [DOC: 9247858] ✅ Patient data written to CSV: Donna Finni | Sex: FEMALE | Age: 70 | Service: PT, Physical Therapy | Payer: Medicare | MRN: 6267009
[00:33:01] ✅    ✅ Document 9247858 processed and saved successfully
[00:33:01] 🔄 
🔄 Step 8: Saving API details...
[00:33:01] [DOC: 9247858] ℹ️  API push details saved for document 9247858
[00:33:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247822                         ║
================================================================================
[00:33:01] ℹ️  Agency: Dartmouth HH
[00:33:01] ℹ️  Date: 04/18/2025
[00:33:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:33:03] [DOC: 9247822] ✅ Text extracted using pdfplumber (2608 chars)
[00:33:03] ✅    ✅ Text extracted using pdfplumber (2608 chars)
[00:33:03] 🔄 
🔄 Step 2: Extracting patient data...
[00:33:06] ℹ️  AI extracted raw sex value: 'M'
[00:33:06] ℹ️  AI extracted service line: 'Physical Therapy'
[00:33:06] ℹ️  AI extracted payer source: 'Medicare'
[00:33:06] ℹ️  AI extracted diagnoses:
[00:33:06] ℹ️    - Diagnosis 1: ''
[00:33:06] ℹ️    - Diagnosis 2: ''
[00:33:06] ℹ️    - Diagnosis 3: ''
[00:33:06] ℹ️    - Diagnosis 4: ''
[00:33:06] ℹ️    - Diagnosis 5: ''
[00:33:06] ℹ️    - Diagnosis 6: ''
[00:33:06] ℹ️  Final extracted MRN: '5979015'
[00:33:06] ℹ️  Final extracted Sex: 'MALE'
[00:33:06] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:33:06] ℹ️  Final extracted Payer Source: 'Medicare'
[00:33:06] ✅ Patient data extraction completed successfully
[00:33:06] ✅    ✅ Patient data extracted successfully
[00:33:06] 📊 Patient Response
     └─ patientFName: Fernando
     └─ patientLName: Dasilva
     └─ dob: 09/07/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5979015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/27/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:33:06] ✅    ✅ Patient identified: Fernando Dasilva
[00:33:06] ✅    ✅ Patient name validation passed
[00:33:06] 🔄 
🔄 Step 3: Processing patient dates...
[00:33:06] [DOC: 9247822] ℹ️  DOB normalized: 09/07/1944
[00:33:06] [DOC: 9247822] ℹ️  Episode startOfCare normalized: 02/27/2025
[00:33:06] [DOC: 9247822] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[00:33:06] [DOC: 9247822] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[00:33:06] [DOC: 9247822] ✅ Patient date processing completed successfully
[00:33:06] ✅    ✅ Date processing completed
[00:33:06] 📊 Processed Patient Data
     └─ patientFName: Fernando
     └─ patientLName: Dasilva
     └─ dob: 09/07/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5979015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/27/2025', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:33:06] 🔄 
🔄 Step 4: Extracting order data...
[00:33:08] ℹ️  Order extraction - MRN: '5979015'
[00:33:08] ℹ️  Order extraction - Sex: 'MALE'
[00:33:08] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:33:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:33:08] ✅ Order data extraction completed successfully
[00:33:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:33:08] ℹ️  Using MRN from patient data: '5979015' over '5979015'
[00:33:08] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:33:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:33:08] ✅ Patient name cross-validation successful
[00:33:08] ✅    ✅ Data merged successfully
[00:33:10] ✅    ✅ Order data extracted and validated
[00:33:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:33:12] [DOC: 9247822] ✅ Patient exists in API: Fernando Dasilva, ID: dd932524-b29a-47e8-8e9c-679160ebe489
[00:33:12] ✅    ✅ Existing patient found with ID: dd932524-b29a-47e8-8e9c-679160ebe489
[00:33:12] 🔄 
🔄 Step 6: Pushing order to API...
[00:33:12] [DOC: 9247822] ℹ️  Pushing order via API for patient ID: dd932524-b29a-47e8-8e9c-679160ebe489
[00:33:13] [DOC: 9247822] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:33:13] ❌    ❌ Failed to push order
[00:33:13] 🔄 
🔄 Step 7: Writing to CSV...
[00:33:13] [DOC: 9247822] ℹ️  Calculated age: 80 from DOB: 09/07/1944
[00:33:13] [DOC: 9247822] ℹ️  Service Line extracted: 'Physical Therapy'
[00:33:13] [DOC: 9247822] ℹ️  Payer Source extracted: 'Medicare'
[00:33:13] [DOC: 9247822] ℹ️  Diagnosis codes being written:
[00:33:13] [DOC: 9247822] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:33:13] [DOC: 9247822] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:33:13] [DOC: 9247822] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:33:13] [DOC: 9247822] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:33:13] [DOC: 9247822] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:33:13] [DOC: 9247822] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:33:13] [DOC: 9247822] ✅ Patient data written to CSV: Fernando Dasilva | Sex: MALE | Age: 80 | Service: Physical Therapy | Payer: Medicare | MRN: 5979015
[00:33:13] ✅    ✅ Document 9247822 processed and saved successfully
[00:33:13] 🔄 
🔄 Step 8: Saving API details...
[00:33:13] [DOC: 9247822] ℹ️  API push details saved for document 9247822
[00:33:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247817                         ║
================================================================================
[00:33:13] ℹ️  Agency: Dartmouth HH
[00:33:13] ℹ️  Date: 04/18/2025
[00:33:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:33:16] [DOC: 9247817] ✅ Text extracted using pdfplumber (12307 chars)
[00:33:16] ✅    ✅ Text extracted using pdfplumber (12295 chars)
[00:33:16] 🔄 
🔄 Step 2: Extracting patient data...
[00:33:19] ℹ️  AI extracted raw sex value: 'F'
[00:33:19] ℹ️  AI extracted service line: 'PT, RN'
[00:33:19] ℹ️  AI extracted payer source: 'None'
[00:33:19] ℹ️  AI extracted diagnoses:
[00:33:19] ℹ️    - Diagnosis 1: 'M25.851'
[00:33:19] ℹ️    - Diagnosis 2: 'M25.551'
[00:33:19] ℹ️    - Diagnosis 3: 'M79.7'
[00:33:19] ℹ️    - Diagnosis 4: 'G90.09'
[00:33:19] ℹ️    - Diagnosis 5: 'M81.0'
[00:33:19] ℹ️    - Diagnosis 6: 'M54.16'
[00:33:19] ℹ️  Final extracted MRN: '227027'
[00:33:19] ℹ️  Final extracted Sex: 'FEMALE'
[00:33:19] ℹ️  Final extracted Service Line: 'PT, RN'
[00:33:19] ℹ️  Final extracted Payer Source: ''
[00:33:19] ✅ Patient data extraction completed successfully
[00:33:19] ✅    ✅ Patient data extracted successfully
[00:33:19] 📊 Patient Response
     └─ patientFName: Agrella
     └─ patientLName: Annette
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'M25.851', 'secondDiagnosis': 'M25.551', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': 'G90.09', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'M54.16'}]
[00:33:19] ✅    ✅ Patient identified: Agrella Annette
[00:33:19] ✅    ✅ Patient name validation passed
[00:33:19] 🔄 
🔄 Step 3: Processing patient dates...
[00:33:19] [DOC: 9247817] ℹ️  DOB normalized: 03/01/1959
[00:33:19] [DOC: 9247817] ℹ️  Episode startOfCare normalized: 03/26/2025
[00:33:19] [DOC: 9247817] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[00:33:19] [DOC: 9247817] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[00:33:19] [DOC: 9247817] ✅ Patient date processing completed successfully
[00:33:19] ✅    ✅ Date processing completed
[00:33:19] 📊 Processed Patient Data
     └─ patientFName: Agrella
     └─ patientLName: Annette
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'M25.851', 'secondDiagnosis': 'M25.551', 'thirdDiagnosis': 'M79.7', 'fourthDiagnosis': 'G90.09', 'fifthDiagnosis': 'M81.0', 'sixthDiagnosis': 'M54.16'}]
[00:33:19] 🔄 
🔄 Step 4: Extracting order data...
[00:33:22] ℹ️  Order extraction - MRN: '227027'
[00:33:22] ℹ️  Order extraction - Sex: 'FEMALE'
[00:33:22] ℹ️  Order extraction - Service Line: 'PT, Skilled Nursing'
[00:33:22] ℹ️  Order extraction - Payer Source: ''
[00:33:22] ✅ Order data extraction completed successfully
[00:33:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:33:22] ℹ️  Using MRN from patient data: '227027' over '227027'
[00:33:22] ℹ️  Combined service lines: Patient='PT, RN' + Order='PT, Skilled Nursing' = 'PT, RN, Skilled Nursing'
[00:33:22] ✅ Patient name cross-validation successful
[00:33:22] ✅    ✅ Data merged successfully
[00:33:23] ✅    ✅ Order data extracted and validated
[00:33:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:33:25] [DOC: 9247817] ✅ Patient exists in API: Agrella Annette, ID: 7ea1de60-1ae0-4b6b-a2d0-c961083f7770
[00:33:25] ✅    ✅ Existing patient found with ID: 7ea1de60-1ae0-4b6b-a2d0-c961083f7770
[00:33:25] 🔄 
🔄 Step 6: Pushing order to API...
[00:33:25] [DOC: 9247817] ℹ️  Pushing order via API for patient ID: 7ea1de60-1ae0-4b6b-a2d0-c961083f7770
[00:33:27] [DOC: 9247817] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:33:27] ❌    ❌ Failed to push order
[00:33:27] 🔄 
🔄 Step 7: Writing to CSV...
[00:33:27] [DOC: 9247817] ℹ️  Calculated age: 66 from DOB: 03/01/1959
[00:33:27] [DOC: 9247817] ℹ️  Service Line extracted: 'PT, RN, Skilled Nursing'
[00:33:27] [DOC: 9247817] ℹ️  Payer Source extracted: ''
[00:33:27] [DOC: 9247817] ℹ️  Diagnosis codes being written:
[00:33:27] [DOC: 9247817] ℹ️    - Latest_Episode_Firstdiagnosis: 'M25.851'
[00:33:27] [DOC: 9247817] ℹ️    - Latest_Episode_Seconddiagnosis: 'M25.551'
[00:33:27] [DOC: 9247817] ℹ️    - Latest_Episode_Thirddiagnosis: 'M79.7'
[00:33:27] [DOC: 9247817] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G90.09'
[00:33:27] [DOC: 9247817] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M81.0'
[00:33:27] [DOC: 9247817] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.16'
[00:33:27] [DOC: 9247817] ✅ Patient data written to CSV: Agrella Annette | Sex: FEMALE | Age: 66 | Service: PT, RN, Skilled Nursing | Payer:  | MRN: 227027
[00:33:27] ✅    ✅ Document 9247817 processed and saved successfully
[00:33:27] 🔄 
🔄 Step 8: Saving API details...
[00:33:27] [DOC: 9247817] ℹ️  API push details saved for document 9247817
[00:33:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247780                         ║
================================================================================
[00:33:27] ℹ️  Agency: Nizhoni Health-Fall River
[00:33:27] ℹ️  Date: 04/18/2025
[00:33:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:33:34] [DOC: 9247780] ✅ Text extracted using pdfplumber (1017 chars)
[00:33:34] ✅    ✅ Text extracted using pdfplumber (1017 chars)
[00:33:34] 🔄 
🔄 Step 2: Extracting patient data...
[00:33:36] ℹ️  AI extracted raw sex value: 'F'
[00:33:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:33:36] ℹ️  AI extracted payer source: 'Medicaid/MA'
[00:33:36] ℹ️  AI extracted diagnoses:
[00:33:36] ℹ️    - Diagnosis 1: ''
[00:33:36] ℹ️    - Diagnosis 2: ''
[00:33:36] ℹ️    - Diagnosis 3: ''
[00:33:36] ℹ️    - Diagnosis 4: ''
[00:33:36] ℹ️    - Diagnosis 5: ''
[00:33:36] ℹ️    - Diagnosis 6: ''
[00:33:36] ℹ️  Final extracted MRN: '3761020'
[00:33:36] ℹ️  Final extracted Sex: 'FEMALE'
[00:33:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:33:36] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[00:33:36] ✅ Patient data extraction completed successfully
[00:33:36] ✅    ✅ Patient data extracted successfully
[00:33:36] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:33:36] ✅    ✅ Patient identified: Carol Jimon-Ajqui
[00:33:36] ✅    ✅ Patient name validation passed
[00:33:36] 🔄 
🔄 Step 3: Processing patient dates...
[00:33:36] [DOC: 9247780] ℹ️  DOB normalized: 08/23/1974
[00:33:36] [DOC: 9247780] ℹ️  Episode startOfCare normalized: 01/04/2023
[00:33:36] [DOC: 9247780] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[00:33:36] [DOC: 9247780] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[00:33:36] [DOC: 9247780] ✅ Patient date processing completed successfully
[00:33:36] ✅    ✅ Date processing completed
[00:33:36] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:33:36] 🔄 
🔄 Step 4: Extracting order data...
[00:33:39] ℹ️  Order extraction - MRN: '3761020'
[00:33:39] ℹ️  Order extraction - Sex: 'FEMALE'
[00:33:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:33:39] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[00:33:39] ✅ Order data extraction completed successfully
[00:33:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:33:39] ℹ️  Using MRN from patient data: '3761020' over '3761020'
[00:33:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:33:39] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[00:33:39] ✅ Patient name cross-validation successful
[00:33:39] ✅    ✅ Data merged successfully
[00:33:40] ✅    ✅ Order data extracted and validated
[00:33:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:33:40] [DOC: 9247780] ✅ Patient found in local cache: Carol Jimon-Ajqui, ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:33:40] ✅    ✅ Existing patient found with ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:33:40] 🔄 
🔄 Step 6: Pushing order to API...
[00:33:40] [DOC: 9247780] ℹ️  Pushing order via API for patient ID: f08eafa7-a564-4df2-a653-f4ef833929a0
[00:33:42] [DOC: 9247780] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:33:42] ❌    ❌ Failed to push order
[00:33:42] 🔄 
🔄 Step 7: Writing to CSV...
[00:33:42] [DOC: 9247780] ℹ️  Calculated age: 50 from DOB: 08/23/1974
[00:33:42] [DOC: 9247780] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:33:42] [DOC: 9247780] ℹ️  Payer Source extracted: 'Medicaid/MA'
[00:33:42] [DOC: 9247780] ℹ️  Diagnosis codes being written:
[00:33:42] [DOC: 9247780] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:33:42] [DOC: 9247780] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:33:42] [DOC: 9247780] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:33:42] [DOC: 9247780] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:33:42] [DOC: 9247780] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:33:42] [DOC: 9247780] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:33:42] [DOC: 9247780] ✅ Patient data written to CSV: Carol Jimon-Ajqui | Sex: FEMALE | Age: 50 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 3761020
[00:33:42] ✅    ✅ Document 9247780 processed and saved successfully
[00:33:42] 🔄 
🔄 Step 8: Saving API details...
[00:33:42] [DOC: 9247780] ℹ️  API push details saved for document 9247780
[00:33:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247415                         ║
================================================================================
[00:33:42] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[00:33:42] ℹ️  Date: 04/17/2025
[00:33:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:33:46] [DOC: 9247415] ✅ Text extracted using pdfplumber (25154 chars)
[00:33:46] ✅    ✅ Text extracted using pdfplumber (25154 chars)
[00:33:46] 🔄 
🔄 Step 2: Extracting patient data...
[00:33:49] ℹ️  AI extracted raw sex value: 'M'
[00:33:49] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:33:49] ℹ️  AI extracted payer source: 'Medicare'
[00:33:49] ℹ️  AI extracted diagnoses:
[00:33:49] ℹ️    - Diagnosis 1: 'I13.0'
[00:33:49] ℹ️    - Diagnosis 2: 'I50.33'
[00:33:49] ℹ️    - Diagnosis 3: 'N18.32'
[00:33:49] ℹ️    - Diagnosis 4: 'I48.19'
[00:33:49] ℹ️    - Diagnosis 5: 'J15.9'
[00:33:49] ℹ️    - Diagnosis 6: 'N40.0'
[00:33:49] ℹ️  Final extracted MRN: '28700179206001'
[00:33:49] ℹ️  Final extracted Sex: 'MALE'
[00:33:49] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:33:49] ℹ️  Final extracted Payer Source: 'Medicare'
[00:33:49] ✅ Patient data extraction completed successfully
[00:33:49] ✅    ✅ Patient data extracted successfully
[00:33:49] 📊 Patient Response
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 60 COULOMBE ST
     └─ city: ACUSHNET
     └─ state: MA
     └─ zip: 02743-
     └─ email: 
     └─ phoneNumber: (508)994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'I48.19', 'fifthDiagnosis': 'J15.9', 'sixthDiagnosis': 'N40.0'}]
[00:33:49] ✅    ✅ Patient identified: JOSEPH LEDOUX
[00:33:49] ✅    ✅ Patient name validation passed
[00:33:49] 🔄 
🔄 Step 3: Processing patient dates...
[00:33:49] [DOC: 9247415] ℹ️  DOB normalized: 04/26/1941
[00:33:49] [DOC: 9247415] ℹ️  Episode startOfCare normalized: 04/05/2025
[00:33:49] [DOC: 9247415] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[00:33:49] [DOC: 9247415] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[00:33:49] [DOC: 9247415] ✅ Patient date processing completed successfully
[00:33:49] ✅    ✅ Date processing completed
[00:33:49] 📊 Processed Patient Data
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 60 COULOMBE ST
     └─ city: ACUSHNET
     └─ state: MA
     └─ zip: 02743-
     └─ email: 
     └─ phoneNumber: (508)994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'I48.19', 'fifthDiagnosis': 'J15.9', 'sixthDiagnosis': 'N40.0'}]
[00:33:49] 🔄 
🔄 Step 4: Extracting order data...
[00:33:52] ℹ️  Order extraction - MRN: '28700179206001'
[00:33:52] ℹ️  Order extraction - Sex: 'MALE'
[00:33:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:33:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:33:52] ✅ Order data extraction completed successfully
[00:33:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:33:52] ℹ️  Using MRN from patient data: '28700179206001' over '28700179206001'
[00:33:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:33:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:33:52] ✅ Patient name cross-validation successful
[00:33:52] ✅    ✅ Data merged successfully
[00:33:53] ✅    ✅ Order data extracted and validated
[00:33:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:33:53] [DOC: 9247415] ✅ Patient found in local cache: JOSEPH LEDOUX, ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[00:33:53] ✅    ✅ Existing patient found with ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[00:33:53] 🔄 
🔄 Step 6: Pushing order to API...
[00:33:53] [DOC: 9247415] ℹ️  Pushing order via API for patient ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[00:33:55] [DOC: 9247415] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20020"}
[00:33:55] ❌    ❌ Failed to push order
[00:33:55] 🔄 
🔄 Step 7: Writing to CSV...
[00:33:55] [DOC: 9247415] ℹ️  Calculated age: 84 from DOB: 04/26/1941
[00:33:55] [DOC: 9247415] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:33:55] [DOC: 9247415] ℹ️  Payer Source extracted: 'Medicare'
[00:33:55] [DOC: 9247415] ℹ️  Diagnosis codes being written:
[00:33:55] [DOC: 9247415] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[00:33:55] [DOC: 9247415] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[00:33:55] [DOC: 9247415] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.32'
[00:33:55] [DOC: 9247415] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.19'
[00:33:55] [DOC: 9247415] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J15.9'
[00:33:55] [DOC: 9247415] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.0'
[00:33:55] [DOC: 9247415] ✅ Patient data written to CSV: JOSEPH LEDOUX | Sex: MALE | Age: 84 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 28700179206001
[00:33:55] ✅    ✅ Document 9247415 processed and saved successfully
[00:33:55] 🔄 
🔄 Step 8: Saving API details...
[00:33:55] [DOC: 9247415] ℹ️  API push details saved for document 9247415
[00:33:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9247414                         ║
================================================================================
[00:33:55] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[00:33:55] ℹ️  Date: 04/17/2025
[00:33:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:33:57] [DOC: 9247414] ✅ Text extracted using pdfplumber (1588 chars)
[00:33:57] ✅    ✅ Text extracted using pdfplumber (1588 chars)
[00:33:57] 🔄 
🔄 Step 2: Extracting patient data...
[00:34:00] ℹ️  AI extracted raw sex value: ''
[00:34:00] ℹ️  AI extracted service line: 'RN, LPN'
[00:34:00] ℹ️  AI extracted payer source: 'Medicare'
[00:34:00] ℹ️  AI extracted diagnoses:
[00:34:00] ℹ️    - Diagnosis 1: 'None'
[00:34:00] ℹ️    - Diagnosis 2: 'None'
[00:34:00] ℹ️    - Diagnosis 3: 'None'
[00:34:00] ℹ️    - Diagnosis 4: 'None'
[00:34:00] ℹ️    - Diagnosis 5: 'None'
[00:34:00] ℹ️    - Diagnosis 6: 'None'
[00:34:00] ℹ️  Final extracted MRN: '28700179206001'
[00:34:00] ℹ️  Final extracted Sex: ''
[00:34:00] ℹ️  Final extracted Service Line: 'RN, LPN'
[00:34:00] ℹ️  Final extracted Payer Source: 'Medicare'
[00:34:00] ✅ Patient data extraction completed successfully
[00:34:00] ✅    ✅ Patient data extracted successfully
[00:34:00] 📊 Patient Response
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: 
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:34:00] ✅    ✅ Patient identified: JOSEPH LEDOUX
[00:34:00] ✅    ✅ Patient name validation passed
[00:34:00] 🔄 
🔄 Step 3: Processing patient dates...
[00:34:00] [DOC: 9247414] ℹ️  DOB normalized: 04/26/1941
[00:34:00] [DOC: 9247414] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[00:34:00] [DOC: 9247414] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[00:34:00] [DOC: 9247414] ✅ Patient date processing completed successfully
[00:34:00] ✅    ✅ Date processing completed
[00:34:00] 📊 Processed Patient Data
     └─ patientFName: JOSEPH
     └─ patientLName: LEDOUX
     └─ dob: 04/26/1941
     └─ patientSex: 
     └─ medicalRecordNo: 28700179206001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/04/2025'}]
[00:34:00] 🔄 
🔄 Step 4: Extracting order data...
[00:34:02] ℹ️  Order extraction - MRN: '28700179206001'
[00:34:02] ℹ️  Order extraction - Sex: ''
[00:34:02] ℹ️  Order extraction - Service Line: 'RN'
[00:34:02] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:34:02] ✅ Order data extraction completed successfully
[00:34:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:34:02] ℹ️  Using MRN from patient data: '28700179206001' over '28700179206001'
[00:34:02] ℹ️  Inferred sex as MALE from name: JOSEPH
[00:34:02] ℹ️  Combined service lines: Patient='RN, LPN' + Order='RN' = 'LPN, RN'
[00:34:02] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:34:02] ✅ Patient name cross-validation successful
[00:34:02] ✅    ✅ Data merged successfully
[00:34:04] ✅    ✅ Order data extracted and validated
[00:34:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:34:04] [DOC: 9247414] ✅ Patient found in local cache: JOSEPH LEDOUX, ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[00:34:04] ✅    ✅ Existing patient found with ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[00:34:04] 🔄 
🔄 Step 6: Pushing order to API...
[00:34:04] [DOC: 9247414] ℹ️  Pushing order via API for patient ID: a649b1f9-a81a-4d88-abca-33596b2b2d88
[00:34:05] [DOC: 9247414] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13918"}
[00:34:05] ❌    ❌ Failed to push order
[00:34:05] 🔄 
🔄 Step 7: Writing to CSV...
[00:34:05] [DOC: 9247414] ℹ️  Calculated age: 84 from DOB: 04/26/1941
[00:34:05] [DOC: 9247414] ℹ️  Service Line extracted: 'LPN, RN'
[00:34:05] [DOC: 9247414] ℹ️  Payer Source extracted: 'Medicare'
[00:34:05] [DOC: 9247414] ℹ️  Diagnosis codes being written:
[00:34:05] [DOC: 9247414] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:34:05] [DOC: 9247414] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:34:05] [DOC: 9247414] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:34:05] [DOC: 9247414] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:34:05] [DOC: 9247414] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:34:05] [DOC: 9247414] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:34:05] [DOC: 9247414] ✅ Patient data written to CSV: JOSEPH LEDOUX | Sex: MALE | Age: 84 | Service: LPN, RN | Payer: Medicare | MRN: 28700179206001
[00:34:05] ✅    ✅ Document 9247414 processed and saved successfully
[00:34:05] 🔄 
🔄 Step 8: Saving API details...
[00:34:05] [DOC: 9247414] ℹ️  API push details saved for document 9247414
[00:34:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9246171                         ║
================================================================================
[00:34:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:34:05] ℹ️  Date: 04/17/2025
[00:34:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:34:12] [DOC: 9246171] ✅ Text extracted using pdfplumber (13084 chars)
[00:34:12] ✅    ✅ Text extracted using pdfplumber (13084 chars)
[00:34:12] 🔄 
🔄 Step 2: Extracting patient data...
[00:34:15] ℹ️  AI extracted raw sex value: 'F'
[00:34:15] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:34:15] ℹ️  AI extracted payer source: 'Humana'
[00:34:15] ℹ️  AI extracted diagnoses:
[00:34:15] ℹ️    - Diagnosis 1: 'G20.A1'
[00:34:15] ℹ️    - Diagnosis 2: 'I11.9'
[00:34:15] ℹ️    - Diagnosis 3: 'E11.40'
[00:34:15] ℹ️    - Diagnosis 4: 'I44.7'
[00:34:15] ℹ️    - Diagnosis 5: 'I42.9'
[00:34:15] ℹ️    - Diagnosis 6: 'J44.9'
[00:34:15] ℹ️  Final extracted MRN: 'MA241007025405'
[00:34:15] ℹ️  Final extracted Sex: 'FEMALE'
[00:34:15] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:34:15] ℹ️  Final extracted Payer Source: 'Humana'
[00:34:15] ✅ Patient data extraction completed successfully
[00:34:15] ✅    ✅ Patient data extracted successfully
[00:34:15] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 1881923936
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 175 Caroline St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 438-2823
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Humana
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I44.7', 'fifthDiagnosis': 'I42.9', 'sixthDiagnosis': 'J44.9'}]
[00:34:15] ✅    ✅ Patient identified: Gordonna Walker
[00:34:15] ✅    ✅ Patient name validation passed
[00:34:15] 🔄 
🔄 Step 3: Processing patient dates...
[00:34:15] [DOC: 9246171] ℹ️  DOB normalized: 02/21/1954
[00:34:15] [DOC: 9246171] ℹ️  Episode startOfCare normalized: 03/24/2025
[00:34:15] [DOC: 9246171] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[00:34:15] [DOC: 9246171] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[00:34:15] [DOC: 9246171] ✅ Patient date processing completed successfully
[00:34:15] ✅    ✅ Date processing completed
[00:34:15] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 1881923936
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 175 Caroline St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 438-2823
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Humana
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I44.7', 'fifthDiagnosis': 'I42.9', 'sixthDiagnosis': 'J44.9'}]
[00:34:15] 🔄 
🔄 Step 4: Extracting order data...
[00:34:18] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:34:18] ℹ️  Order extraction - Sex: 'FEMALE'
[00:34:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:34:18] ℹ️  Order extraction - Payer Source: 'Humana'
[00:34:18] ✅ Order data extraction completed successfully
[00:34:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:34:18] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:34:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:34:18] ℹ️  Payer source consistent in both sources: 'Humana'
[00:34:18] ✅ Patient name cross-validation successful
[00:34:18] ✅    ✅ Data merged successfully
[00:34:20] ✅    ✅ Order data extracted and validated
[00:34:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:34:20] [DOC: 9246171] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:34:20] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:34:20] 🔄 
🔄 Step 6: Pushing order to API...
[00:34:20] [DOC: 9246171] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:34:21] [DOC: 9246171] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14403"}
[00:34:21] ❌    ❌ Failed to push order
[00:34:21] 🔄 
🔄 Step 7: Writing to CSV...
[00:34:21] [DOC: 9246171] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:34:21] [DOC: 9246171] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:34:21] [DOC: 9246171] ℹ️  Payer Source extracted: 'Humana'
[00:34:21] [DOC: 9246171] ℹ️  Diagnosis codes being written:
[00:34:21] [DOC: 9246171] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[00:34:21] [DOC: 9246171] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[00:34:21] [DOC: 9246171] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[00:34:21] [DOC: 9246171] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I44.7'
[00:34:21] [DOC: 9246171] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I42.9'
[00:34:21] [DOC: 9246171] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J44.9'
[00:34:21] [DOC: 9246171] ✅ Patient data written to CSV: Gordonna Walker | Sex: FEMALE | Age: 71 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Humana | MRN: MA241007025405
[00:34:21] ✅    ✅ Document 9246171 processed and saved successfully
[00:34:21] 🔄 
🔄 Step 8: Saving API details...
[00:34:21] [DOC: 9246171] ℹ️  API push details saved for document 9246171
[00:34:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245810                         ║
================================================================================
[00:34:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:34:21] ℹ️  Date: 04/17/2025
[00:34:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:34:23] [DOC: 9245810] ✅ Text extracted using pdfplumber (1574 chars)
[00:34:23] ✅    ✅ Text extracted using pdfplumber (1574 chars)
[00:34:23] 🔄 
🔄 Step 2: Extracting patient data...
[00:34:25] ℹ️  AI extracted raw sex value: 'F'
[00:34:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:34:25] ℹ️  AI extracted payer source: ''
[00:34:25] ℹ️  AI extracted diagnoses:
[00:34:25] ℹ️    - Diagnosis 1: ''
[00:34:25] ℹ️    - Diagnosis 2: ''
[00:34:25] ℹ️    - Diagnosis 3: ''
[00:34:25] ℹ️    - Diagnosis 4: ''
[00:34:25] ℹ️    - Diagnosis 5: ''
[00:34:25] ℹ️    - Diagnosis 6: ''
[00:34:25] ℹ️  Final extracted MRN: '2258674'
[00:34:25] ℹ️  Final extracted Sex: 'FEMALE'
[00:34:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:34:25] ℹ️  Final extracted Payer Source: ''
[00:34:25] ✅ Patient data extraction completed successfully
[00:34:25] ✅    ✅ Patient data extracted successfully
[00:34:25] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:34:25] ✅    ✅ Patient identified: Maryann Boucher
[00:34:25] ✅    ✅ Patient name validation passed
[00:34:25] 🔄 
🔄 Step 3: Processing patient dates...
[00:34:25] [DOC: 9245810] ℹ️  DOB normalized: 03/22/1946
[00:34:25] [DOC: 9245810] ✅ Patient date processing completed successfully
[00:34:25] ✅    ✅ Date processing completed
[00:34:25] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:34:25] 🔄 
🔄 Step 4: Extracting order data...
[00:34:28] ℹ️  Order extraction - MRN: '2258674'
[00:34:28] ℹ️  Order extraction - Sex: 'FEMALE'
[00:34:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:34:28] ℹ️  Order extraction - Payer Source: ''
[00:34:28] ✅ Order data extraction completed successfully
[00:34:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:34:28] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[00:34:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:34:28] ✅ Patient name cross-validation successful
[00:34:28] ✅    ✅ Data merged successfully
[00:34:29] ✅    ✅ Order data extracted and validated
[00:34:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:34:29] [DOC: 9245810] ✅ Patient found in local cache: Maryann Boucher, ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:34:29] ✅    ✅ Existing patient found with ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:34:29] 🔄 
🔄 Step 6: Pushing order to API...
[00:34:29] [DOC: 9245810] ℹ️  Pushing order via API for patient ID: fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1
[00:34:31] [DOC: 9245810] ❌ Order push failed with status 201: {"id":"652b9836-295c-4441-afcd-d258fab3180c","orderWAVId":"ORD20088","orderNo":"1082593, 1082594","orderDate":"04/16/2025","startOfCare":"03/16/2025","episodeStartDate":"03/16/2025","episodeEndDate":"05/14/2025","documentID":"9245810","mrn":"2258674","patientName":"Boucher,Maryann","sentToPhysicianDate":"04/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/18/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"fc56ee9a-e7cf-4d9f-9ade-acd80b0401e1","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"3bef7fdb-bf2d-49d6-944c-4edfecd704b7","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[00:34:31] ❌    ❌ Failed to push order
[00:34:31] 🔄 
🔄 Step 7: Writing to CSV...
[00:34:31] [DOC: 9245810] ℹ️  Calculated age: 79 from DOB: 03/22/1946
[00:34:31] [DOC: 9245810] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:34:31] [DOC: 9245810] ℹ️  Payer Source extracted: ''
[00:34:31] [DOC: 9245810] ℹ️  Diagnosis codes being written:
[00:34:31] [DOC: 9245810] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:34:31] [DOC: 9245810] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:34:31] [DOC: 9245810] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:34:31] [DOC: 9245810] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:34:31] [DOC: 9245810] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:34:31] [DOC: 9245810] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:34:31] [DOC: 9245810] ✅ Patient data written to CSV: Maryann Boucher | Sex: FEMALE | Age: 79 | Service: Skilled Nursing | Payer:  | MRN: 2258674
[00:34:31] ✅    ✅ Document 9245810 processed and saved successfully
[00:34:31] 🔄 
🔄 Step 8: Saving API details...
[00:34:31] [DOC: 9245810] ℹ️  API push details saved for document 9245810
[00:34:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244476                         ║
================================================================================
[00:34:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:34:31] ℹ️  Date: 04/16/2025
[00:34:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:34:33] [DOC: 9244476] ✅ Text extracted using pdfplumber (10847 chars)
[00:34:33] ✅    ✅ Text extracted using pdfplumber (10847 chars)
[00:34:33] 🔄 
🔄 Step 2: Extracting patient data...
[00:34:37] ℹ️  AI extracted raw sex value: 'M'
[00:34:37] ℹ️  AI extracted service line: 'Physical Therapy'
[00:34:37] ℹ️  AI extracted payer source: ''
[00:34:37] ℹ️  AI extracted diagnoses:
[00:34:37] ℹ️    - Diagnosis 1: 'D61.818'
[00:34:37] ℹ️    - Diagnosis 2: 'I12.0'
[00:34:37] ℹ️    - Diagnosis 3: 'E11.22'
[00:34:37] ℹ️    - Diagnosis 4: 'N18.6'
[00:34:37] ℹ️    - Diagnosis 5: 'C62.92'
[00:34:37] ℹ️    - Diagnosis 6: 'I95.1'
[00:34:37] ℹ️  Final extracted MRN: '3054251'
[00:34:37] ℹ️  Final extracted Sex: 'MALE'
[00:34:37] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:34:37] ℹ️  Final extracted Payer Source: ''
[00:34:37] ✅ Patient data extraction completed successfully
[00:34:37] ✅    ✅ Patient data extracted successfully
[00:34:37] 📊 Patient Response
     └─ patientFName: Michael
     └─ patientLName: Turek
     └─ dob: 05/22/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: 3054251
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'D61.818', 'secondDiagnosis': 'I12.0', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.6', 'fifthDiagnosis': 'C62.92', 'sixthDiagnosis': 'I95.1'}]
[00:34:37] ✅    ✅ Patient identified: Michael Turek
[00:34:37] ✅    ✅ Patient name validation passed
[00:34:37] 🔄 
🔄 Step 3: Processing patient dates...
[00:34:37] [DOC: 9244476] ℹ️  DOB normalized: 05/22/1976
[00:34:37] [DOC: 9244476] ℹ️  Episode startOfCare normalized: 04/01/2025
[00:34:37] [DOC: 9244476] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[00:34:37] [DOC: 9244476] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[00:34:37] [DOC: 9244476] ✅ Patient date processing completed successfully
[00:34:37] ✅    ✅ Date processing completed
[00:34:37] 📊 Processed Patient Data
     └─ patientFName: Michael
     └─ patientLName: Turek
     └─ dob: 05/22/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: 3054251
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'D61.818', 'secondDiagnosis': 'I12.0', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.6', 'fifthDiagnosis': 'C62.92', 'sixthDiagnosis': 'I95.1'}]
[00:34:37] 🔄 
🔄 Step 4: Extracting order data...
[00:34:39] ℹ️  Order extraction - MRN: '3054251'
[00:34:39] ℹ️  Order extraction - Sex: 'MALE'
[00:34:39] ℹ️  Order extraction - Service Line: 'PT'
[00:34:39] ℹ️  Order extraction - Payer Source: ''
[00:34:39] ✅ Order data extraction completed successfully
[00:34:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:34:39] ℹ️  Using MRN from patient data: '3054251' over '3054251'
[00:34:39] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[00:34:39] ✅ Patient name cross-validation successful
[00:34:39] ✅    ✅ Data merged successfully
[00:34:41] ✅    ✅ Order data extracted and validated
[00:34:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:34:43] [DOC: 9244476] ℹ️  Patient not found in cache or API: Michael Turek
[00:34:43] [DOC: 9244476] ℹ️  Patient not found, creating new patient via API...
[00:34:43] [DOC: 9244476] ℹ️  Creating patient via API: Michael Turek
[00:34:44] [DOC: 9244476] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:34:44] ❌    ❌ Failed to create patient
[00:34:44] [DOC: 9244476] ℹ️  API push details saved for document 9244476
================================================================================
║                        Processing Document ID: 9243014                         ║
================================================================================
[00:34:44] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:34:44] ℹ️  Date: 04/16/2025
[00:34:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:34:57] [DOC: 9243014] ✅ Text extracted using pdfplumber (51200 chars)
[00:34:57] ✅    ✅ Text extracted using pdfplumber (51200 chars)
[00:34:57] 🔄 
🔄 Step 2: Extracting patient data...
[00:35:02] ℹ️  AI extracted raw sex value: 'None'
[00:35:02] ℹ️  AI extracted service line: 'None'
[00:35:02] ℹ️  AI extracted payer source: 'None'
[00:35:02] ℹ️  AI extracted diagnoses:
[00:35:02] ℹ️    - Diagnosis 1: ''
[00:35:02] ℹ️    - Diagnosis 2: ''
[00:35:02] ℹ️    - Diagnosis 3: ''
[00:35:02] ℹ️    - Diagnosis 4: ''
[00:35:02] ℹ️    - Diagnosis 5: ''
[00:35:02] ℹ️    - Diagnosis 6: ''
[00:35:02] ℹ️  Final extracted MRN: ''
[00:35:02] ℹ️  Final extracted Sex: ''
[00:35:02] ℹ️  Final extracted Service Line: ''
[00:35:02] ℹ️  Final extracted Payer Source: ''
[00:35:02] ✅ Patient data extraction completed successfully
[00:35:02] ✅    ✅ Patient data extracted successfully
[00:35:02] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[00:35:02] ⚠️     ❌ Insufficient patient data extracted
[00:35:02] [DOC: 9243014] ℹ️  API push details saved for document 9243014
================================================================================
║                        Processing Document ID: 2170190                         ║
================================================================================
[00:35:02] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:35:02] ℹ️  Date: 04/15/2025
[00:35:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:35:03] [DOC: 2170190] ❌ Critical failure in get_pdf_text: Invalid response format
[00:35:03] ❌ Failed to extract text for Doc ID 2170190
[00:35:03] [DOC: 2170190] ℹ️  API push details saved for document 2170190
================================================================================
║                        Processing Document ID: 9241428                         ║
================================================================================
[00:35:03] ℹ️  Agency: Dartmouth HH
[00:35:03] ℹ️  Date: 04/15/2025
[00:35:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:35:05] [DOC: 9241428] ✅ Text extracted using pdfplumber (1206 chars)
[00:35:05] ✅    ✅ Text extracted using pdfplumber (1206 chars)
[00:35:05] 🔄 
🔄 Step 2: Extracting patient data...
[00:35:08] ℹ️  AI extracted raw sex value: 'M'
[00:35:08] ℹ️  AI extracted service line: 'Skilled Nursing, LPN, RN'
[00:35:08] ℹ️  AI extracted payer source: 'Medicare'
[00:35:08] ℹ️  AI extracted diagnoses:
[00:35:08] ℹ️    - Diagnosis 1: 'None'
[00:35:08] ℹ️    - Diagnosis 2: 'None'
[00:35:08] ℹ️    - Diagnosis 3: 'None'
[00:35:08] ℹ️    - Diagnosis 4: 'None'
[00:35:08] ℹ️    - Diagnosis 5: 'None'
[00:35:08] ℹ️    - Diagnosis 6: 'None'
[00:35:08] ℹ️  Final extracted MRN: '3778011'
[00:35:08] ℹ️  Final extracted Sex: 'MALE'
[00:35:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN, RN'
[00:35:08] ℹ️  Final extracted Payer Source: 'Medicare'
[00:35:08] ✅ Patient data extraction completed successfully
[00:35:08] ✅    ✅ Patient data extracted successfully
[00:35:08] 📊 Patient Response
     └─ patientFName: Roy
     └─ patientLName: Saulnier
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Stephen Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, LPN, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2024', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:35:08] ✅    ✅ Patient identified: Roy Saulnier
[00:35:08] ✅    ✅ Patient name validation passed
[00:35:08] 🔄 
🔄 Step 3: Processing patient dates...
[00:35:08] [DOC: 9241428] ℹ️  DOB normalized: 10/26/1936
[00:35:08] [DOC: 9241428] ℹ️  Episode startOfCare normalized: 08/07/2024
[00:35:08] [DOC: 9241428] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[00:35:08] [DOC: 9241428] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[00:35:08] [DOC: 9241428] ✅ Patient date processing completed successfully
[00:35:08] ✅    ✅ Date processing completed
[00:35:08] 📊 Processed Patient Data
     └─ patientFName: Roy
     └─ patientLName: Saulnier
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Stephen Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, LPN, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2024', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025'}]
[00:35:08] 🔄 
🔄 Step 4: Extracting order data...
[00:35:11] ℹ️  Order extraction - MRN: ''
[00:35:11] ℹ️  Order extraction - Sex: 'MALE'
[00:35:11] ℹ️  Order extraction - Service Line: 'RN, LPN'
[00:35:11] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:35:11] ✅ Order data extraction completed successfully
[00:35:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:35:11] ℹ️  Using MRN from patient data: '3778011'
[00:35:11] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN, RN' + Order='RN, LPN' = 'LPN, RN, Skilled Nursing'
[00:35:11] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:35:11] ✅ Patient name cross-validation successful
[00:35:11] ✅    ✅ Data merged successfully
[00:35:12] ✅    ✅ Order data extracted and validated
[00:35:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:35:12] [DOC: 9241428] ✅ Patient found in local cache: Roy Saulnier, ID: 470463a7-b0e4-4597-a3f7-6eaf2dc13d57
[00:35:12] ✅    ✅ Existing patient found with ID: 470463a7-b0e4-4597-a3f7-6eaf2dc13d57
[00:35:12] 🔄 
🔄 Step 6: Pushing order to API...
[00:35:12] [DOC: 9241428] ℹ️  Pushing order via API for patient ID: 470463a7-b0e4-4597-a3f7-6eaf2dc13d57
[00:35:14] [DOC: 9241428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14383"}
[00:35:14] ❌    ❌ Failed to push order
[00:35:14] 🔄 
🔄 Step 7: Writing to CSV...
[00:35:14] [DOC: 9241428] ℹ️  Calculated age: 88 from DOB: 10/26/1936
[00:35:14] [DOC: 9241428] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing'
[00:35:14] [DOC: 9241428] ℹ️  Payer Source extracted: 'Medicare'
[00:35:14] [DOC: 9241428] ℹ️  Diagnosis codes being written:
[00:35:14] [DOC: 9241428] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:35:14] [DOC: 9241428] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:35:14] [DOC: 9241428] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:35:14] [DOC: 9241428] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:35:14] [DOC: 9241428] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:35:14] [DOC: 9241428] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:35:14] [DOC: 9241428] ✅ Patient data written to CSV: Roy Saulnier | Sex: MALE | Age: 88 | Service: LPN, RN, Skilled Nursing | Payer: Medicare | MRN: 3778011
[00:35:14] ✅    ✅ Document 9241428 processed and saved successfully
[00:35:14] 🔄 
🔄 Step 8: Saving API details...
[00:35:14] [DOC: 9241428] ℹ️  API push details saved for document 9241428
[00:35:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241423                         ║
================================================================================
[00:35:14] ℹ️  Agency: Dartmouth HH
[00:35:14] ℹ️  Date: 04/15/2025
[00:35:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:35:16] [DOC: 9241423] ✅ Text extracted using pdfplumber (1196 chars)
[00:35:16] ✅    ✅ Text extracted using pdfplumber (1196 chars)
[00:35:16] 🔄 
🔄 Step 2: Extracting patient data...
[00:35:19] ℹ️  AI extracted raw sex value: 'F'
[00:35:19] ℹ️  AI extracted service line: 'RN, LPN'
[00:35:19] ℹ️  AI extracted payer source: 'Medicare'
[00:35:19] ℹ️  AI extracted diagnoses:
[00:35:19] ℹ️    - Diagnosis 1: ''
[00:35:19] ℹ️    - Diagnosis 2: ''
[00:35:19] ℹ️    - Diagnosis 3: ''
[00:35:19] ℹ️    - Diagnosis 4: ''
[00:35:19] ℹ️    - Diagnosis 5: ''
[00:35:19] ℹ️    - Diagnosis 6: ''
[00:35:19] ℹ️  Final extracted MRN: '5915015'
[00:35:19] ℹ️  Final extracted Sex: 'FEMALE'
[00:35:19] ℹ️  Final extracted Service Line: 'RN, LPN'
[00:35:19] ℹ️  Final extracted Payer Source: 'Medicare'
[00:35:19] ✅ Patient data extraction completed successfully
[00:35:19] ✅    ✅ Patient data extracted successfully
[00:35:19] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:35:19] ✅    ✅ Patient identified: Suzanne Fawcett
[00:35:19] ✅    ✅ Patient name validation passed
[00:35:19] 🔄 
🔄 Step 3: Processing patient dates...
[00:35:19] [DOC: 9241423] ℹ️  DOB normalized: 12/08/1939
[00:35:19] [DOC: 9241423] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:35:19] [DOC: 9241423] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[00:35:19] [DOC: 9241423] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[00:35:19] [DOC: 9241423] ✅ Patient date processing completed successfully
[00:35:19] ✅    ✅ Date processing completed
[00:35:19] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:35:19] 🔄 
🔄 Step 4: Extracting order data...
[00:35:21] ℹ️  Order extraction - MRN: ''
[00:35:21] ℹ️  Order extraction - Sex: 'FEMALE'
[00:35:21] ℹ️  Order extraction - Service Line: 'RN, LPN'
[00:35:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:35:21] ✅ Order data extraction completed successfully
[00:35:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:35:21] ℹ️  Using MRN from patient data: '5915015'
[00:35:21] ℹ️  Service line consistent in both sources: 'RN, LPN'
[00:35:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:35:21] ✅ Patient name cross-validation successful
[00:35:21] ✅    ✅ Data merged successfully
[00:35:22] ✅    ✅ Order data extracted and validated
[00:35:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:35:22] [DOC: 9241423] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:35:22] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:35:22] 🔄 
🔄 Step 6: Pushing order to API...
[00:35:22] [DOC: 9241423] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:35:24] [DOC: 9241423] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13932"}
[00:35:24] ❌    ❌ Failed to push order
[00:35:24] 🔄 
🔄 Step 7: Writing to CSV...
[00:35:24] [DOC: 9241423] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:35:24] [DOC: 9241423] ℹ️  Service Line extracted: 'RN, LPN'
[00:35:24] [DOC: 9241423] ℹ️  Payer Source extracted: 'Medicare'
[00:35:24] [DOC: 9241423] ℹ️  Diagnosis codes being written:
[00:35:24] [DOC: 9241423] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:35:24] [DOC: 9241423] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:35:24] [DOC: 9241423] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:35:24] [DOC: 9241423] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:35:24] [DOC: 9241423] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:35:24] [DOC: 9241423] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:35:24] [DOC: 9241423] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: RN, LPN | Payer: Medicare | MRN: 5915015
[00:35:24] ✅    ✅ Document 9241423 processed and saved successfully
[00:35:24] 🔄 
🔄 Step 8: Saving API details...
[00:35:24] [DOC: 9241423] ℹ️  API push details saved for document 9241423
[00:35:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240754                         ║
================================================================================
[00:35:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:35:24] ℹ️  Date: 04/15/2025
[00:35:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:35:25] [DOC: 9240754] ✅ Text extracted using pdfplumber (1676 chars)
[00:35:25] ✅    ✅ Text extracted using pdfplumber (1676 chars)
[00:35:25] 🔄 
🔄 Step 2: Extracting patient data...
[00:35:28] ℹ️  AI extracted raw sex value: 'M'
[00:35:28] ℹ️  AI extracted service line: 'Nursing'
[00:35:28] ℹ️  AI extracted payer source: ''
[00:35:28] ℹ️  AI extracted diagnoses:
[00:35:28] ℹ️    - Diagnosis 1: ''
[00:35:28] ℹ️    - Diagnosis 2: ''
[00:35:28] ℹ️    - Diagnosis 3: ''
[00:35:28] ℹ️    - Diagnosis 4: ''
[00:35:28] ℹ️    - Diagnosis 5: ''
[00:35:28] ℹ️    - Diagnosis 6: ''
[00:35:28] ℹ️  Final extracted MRN: '2716471'
[00:35:28] ℹ️  Final extracted Sex: 'MALE'
[00:35:28] ℹ️  Final extracted Service Line: 'Nursing'
[00:35:28] ℹ️  Final extracted Payer Source: ''
[00:35:28] ✅ Patient data extraction completed successfully
[00:35:28] ✅    ✅ Patient data extracted successfully
[00:35:28] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:35:28] ✅    ✅ Patient identified: Thomas McCormack
[00:35:28] ✅    ✅ Patient name validation passed
[00:35:28] 🔄 
🔄 Step 3: Processing patient dates...
[00:35:28] [DOC: 9240754] ℹ️  DOB normalized: 03/17/1944
[00:35:28] [DOC: 9240754] ✅ Patient date processing completed successfully
[00:35:28] ✅    ✅ Date processing completed
[00:35:28] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:35:28] 🔄 
🔄 Step 4: Extracting order data...
[00:35:30] ℹ️  Order extraction - MRN: '2716471'
[00:35:30] ℹ️  Order extraction - Sex: 'MALE'
[00:35:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:35:30] ℹ️  Order extraction - Payer Source: ''
[00:35:30] ✅ Order data extraction completed successfully
[00:35:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:35:30] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[00:35:30] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[00:35:30] ✅ Patient name cross-validation successful
[00:35:30] ✅    ✅ Data merged successfully
[00:35:32] ✅    ✅ Order data extracted and validated
[00:35:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:35:32] [DOC: 9240754] ✅ Patient found in local cache: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[00:35:32] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[00:35:32] 🔄 
🔄 Step 6: Pushing order to API...
[00:35:32] [DOC: 9240754] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[00:35:33] [DOC: 9240754] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20031"}
[00:35:33] ❌    ❌ Failed to push order
[00:35:33] 🔄 
🔄 Step 7: Writing to CSV...
[00:35:33] [DOC: 9240754] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[00:35:33] [DOC: 9240754] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[00:35:33] [DOC: 9240754] ℹ️  Payer Source extracted: ''
[00:35:33] [DOC: 9240754] ℹ️  Diagnosis codes being written:
[00:35:33] [DOC: 9240754] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:35:33] [DOC: 9240754] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:35:33] [DOC: 9240754] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:35:33] [DOC: 9240754] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:35:33] [DOC: 9240754] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:35:33] [DOC: 9240754] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:35:33] [DOC: 9240754] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2716471
[00:35:33] ✅    ✅ Document 9240754 processed and saved successfully
[00:35:33] 🔄 
🔄 Step 8: Saving API details...
[00:35:33] [DOC: 9240754] ℹ️  API push details saved for document 9240754
[00:35:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240142                         ║
================================================================================
[00:35:33] ℹ️  Agency: Nizhoni Health-Fall River
[00:35:33] ℹ️  Date: 04/15/2025
[00:35:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:35:40] [DOC: 9240142] ✅ Text extracted using pdfplumber (1610 chars)
[00:35:40] ✅    ✅ Text extracted using pdfplumber (1610 chars)
[00:35:40] 🔄 
🔄 Step 2: Extracting patient data...
[00:35:43] ℹ️  AI extracted raw sex value: 'F'
[00:35:43] ℹ️  AI extracted service line: 'HHA'
[00:35:43] ℹ️  AI extracted payer source: 'Medicaid/MA'
[00:35:43] ℹ️  AI extracted diagnoses:
[00:35:43] ℹ️    - Diagnosis 1: 'None'
[00:35:43] ℹ️    - Diagnosis 2: 'None'
[00:35:43] ℹ️    - Diagnosis 3: 'None'
[00:35:43] ℹ️    - Diagnosis 4: 'None'
[00:35:43] ℹ️    - Diagnosis 5: 'None'
[00:35:43] ℹ️    - Diagnosis 6: 'None'
[00:35:43] ℹ️  Final extracted MRN: '1376012'
[00:35:43] ℹ️  Final extracted Sex: 'FEMALE'
[00:35:43] ℹ️  Final extracted Service Line: 'HHA'
[00:35:43] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[00:35:43] ✅ Patient data extraction completed successfully
[00:35:43] ✅    ✅ Patient data extracted successfully
[00:35:43] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Sanders
     └─ dob: 09/16/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1376012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 850 Pleasant St Apt 1006
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2021', 'startOfEpisode': None, 'endOfEpisode': '05/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:35:43] ✅    ✅ Patient identified: Patricia Sanders
[00:35:43] ✅    ✅ Patient name validation passed
[00:35:43] 🔄 
🔄 Step 3: Processing patient dates...
[00:35:43] [DOC: 9240142] ℹ️  DOB normalized: 09/16/1960
[00:35:43] [DOC: 9240142] ℹ️  Episode startOfCare normalized: 11/25/2021
[00:35:43] [DOC: 9240142] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[00:35:43] [DOC: 9240142] ✅ Patient date processing completed successfully
[00:35:43] ✅    ✅ Date processing completed
[00:35:43] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Sanders
     └─ dob: 09/16/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1376012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 850 Pleasant St Apt 1006
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2021', 'endOfEpisode': '05/07/2025'}]
[00:35:43] 🔄 
🔄 Step 4: Extracting order data...
[00:35:45] ℹ️  Order extraction - MRN: '1376012'
[00:35:45] ℹ️  Order extraction - Sex: 'FEMALE'
[00:35:45] ℹ️  Order extraction - Service Line: ''
[00:35:45] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[00:35:45] ✅ Order data extraction completed successfully
[00:35:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:35:45] ℹ️  Using MRN from patient data: '1376012' over '1376012'
[00:35:45] ℹ️  Using service line from patient data: 'HHA'
[00:35:45] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[00:35:45] ✅ Patient name cross-validation successful
[00:35:45] ✅    ✅ Data merged successfully
[00:35:47] ✅    ✅ Order data extracted and validated
[00:35:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:35:47] [DOC: 9240142] ✅ Patient found in local cache: Patricia Sanders, ID: b8c2206a-4b0e-48e7-bdf1-2f28933bba0a
[00:35:47] ✅    ✅ Existing patient found with ID: b8c2206a-4b0e-48e7-bdf1-2f28933bba0a
[00:35:47] 🔄 
🔄 Step 6: Pushing order to API...
[00:35:47] [DOC: 9240142] ℹ️  Pushing order via API for patient ID: b8c2206a-4b0e-48e7-bdf1-2f28933bba0a
[00:35:48] [DOC: 9240142] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:35:48] ❌    ❌ Failed to push order
[00:35:48] 🔄 
🔄 Step 7: Writing to CSV...
[00:35:48] [DOC: 9240142] ℹ️  Calculated age: 64 from DOB: 09/16/1960
[00:35:48] [DOC: 9240142] ℹ️  Service Line extracted: 'HHA'
[00:35:48] [DOC: 9240142] ℹ️  Payer Source extracted: 'Medicaid/MA'
[00:35:48] [DOC: 9240142] ℹ️  Diagnosis codes being written:
[00:35:48] [DOC: 9240142] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:35:48] [DOC: 9240142] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:35:48] [DOC: 9240142] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:35:48] [DOC: 9240142] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:35:48] [DOC: 9240142] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:35:48] [DOC: 9240142] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:35:48] [DOC: 9240142] ✅ Patient data written to CSV: Patricia Sanders | Sex: FEMALE | Age: 64 | Service: HHA | Payer: Medicaid/MA | MRN: 1376012
[00:35:48] ✅    ✅ Document 9240142 processed and saved successfully
[00:35:48] 🔄 
🔄 Step 8: Saving API details...
[00:35:48] [DOC: 9240142] ℹ️  API push details saved for document 9240142
[00:35:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240089                         ║
================================================================================
[00:35:48] ℹ️  Agency: Dartmouth HH
[00:35:48] ℹ️  Date: 04/15/2025
[00:35:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:35:50] [DOC: 9240089] ✅ Text extracted using pdfplumber (4576 chars)
[00:35:50] ✅    ✅ Text extracted using pdfplumber (4576 chars)
[00:35:50] 🔄 
🔄 Step 2: Extracting patient data...
[00:35:53] ℹ️  AI extracted raw sex value: 'M'
[00:35:53] ℹ️  AI extracted service line: 'PT'
[00:35:53] ℹ️  AI extracted payer source: 'Medicare'
[00:35:53] ℹ️  AI extracted diagnoses:
[00:35:53] ℹ️    - Diagnosis 1: ''
[00:35:53] ℹ️    - Diagnosis 2: ''
[00:35:53] ℹ️    - Diagnosis 3: ''
[00:35:53] ℹ️    - Diagnosis 4: ''
[00:35:53] ℹ️    - Diagnosis 5: ''
[00:35:53] ℹ️    - Diagnosis 6: ''
[00:35:53] ℹ️  Final extracted MRN: '6039015'
[00:35:53] ℹ️  Final extracted Sex: 'MALE'
[00:35:53] ℹ️  Final extracted Service Line: 'PT'
[00:35:53] ℹ️  Final extracted Payer Source: 'Medicare'
[00:35:53] ✅ Patient data extraction completed successfully
[00:35:53] ✅    ✅ Patient data extracted successfully
[00:35:53] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Mello
     └─ dob: 03/04/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 6039015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:35:53] ✅    ✅ Patient identified: Philip Mello
[00:35:53] ✅    ✅ Patient name validation passed
[00:35:53] 🔄 
🔄 Step 3: Processing patient dates...
[00:35:53] [DOC: 9240089] ℹ️  DOB normalized: 03/04/1953
[00:35:53] [DOC: 9240089] ℹ️  Episode startOfCare normalized: 03/15/2025
[00:35:53] [DOC: 9240089] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[00:35:53] [DOC: 9240089] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[00:35:53] [DOC: 9240089] ✅ Patient date processing completed successfully
[00:35:53] ✅    ✅ Date processing completed
[00:35:53] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Mello
     └─ dob: 03/04/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 6039015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:35:53] 🔄 
🔄 Step 4: Extracting order data...
[00:35:55] ℹ️  Order extraction - MRN: '6039015'
[00:35:55] ℹ️  Order extraction - Sex: 'MALE'
[00:35:55] ℹ️  Order extraction - Service Line: 'PT'
[00:35:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:35:55] ✅ Order data extraction completed successfully
[00:35:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:35:55] ℹ️  Using MRN from patient data: '6039015' over '6039015'
[00:35:55] ℹ️  Service line consistent in both sources: 'PT'
[00:35:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:35:55] ✅ Patient name cross-validation successful
[00:35:55] ✅    ✅ Data merged successfully
[00:35:57] ✅    ✅ Order data extracted and validated
[00:35:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:35:59] [DOC: 9240089] ✅ Patient exists in API: Philip Mello, ID: 47f9c12a-1ffe-4e2d-b070-46c838993e3b
[00:35:59] ✅    ✅ Existing patient found with ID: 47f9c12a-1ffe-4e2d-b070-46c838993e3b
[00:35:59] 🔄 
🔄 Step 6: Pushing order to API...
[00:35:59] [DOC: 9240089] ℹ️  Pushing order via API for patient ID: 47f9c12a-1ffe-4e2d-b070-46c838993e3b
[00:36:00] [DOC: 9240089] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:36:00] ❌    ❌ Failed to push order
[00:36:00] 🔄 
🔄 Step 7: Writing to CSV...
[00:36:00] [DOC: 9240089] ℹ️  Calculated age: 72 from DOB: 03/04/1953
[00:36:00] [DOC: 9240089] ℹ️  Service Line extracted: 'PT'
[00:36:00] [DOC: 9240089] ℹ️  Payer Source extracted: 'Medicare'
[00:36:00] [DOC: 9240089] ℹ️  Diagnosis codes being written:
[00:36:00] [DOC: 9240089] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:36:00] [DOC: 9240089] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:36:00] [DOC: 9240089] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:36:00] [DOC: 9240089] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:36:00] [DOC: 9240089] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:36:00] [DOC: 9240089] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:36:00] [DOC: 9240089] ✅ Patient data written to CSV: Philip Mello | Sex: MALE | Age: 72 | Service: PT | Payer: Medicare | MRN: 6039015
[00:36:00] ✅    ✅ Document 9240089 processed and saved successfully
[00:36:00] 🔄 
🔄 Step 8: Saving API details...
[00:36:00] [DOC: 9240089] ℹ️  API push details saved for document 9240089
[00:36:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240085                         ║
================================================================================
[00:36:00] ℹ️  Agency: Dartmouth HH
[00:36:00] ℹ️  Date: 04/15/2025
[00:36:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:36:03] [DOC: 9240085] ✅ Text extracted using pdfplumber (994 chars)
[00:36:03] ✅    ✅ Text extracted using pdfplumber (994 chars)
[00:36:03] 🔄 
🔄 Step 2: Extracting patient data...
[00:36:05] ℹ️  AI extracted raw sex value: 'F'
[00:36:05] ℹ️  AI extracted service line: 'HHA'
[00:36:05] ℹ️  AI extracted payer source: 'Medicare'
[00:36:05] ℹ️  AI extracted diagnoses:
[00:36:05] ℹ️    - Diagnosis 1: ''
[00:36:05] ℹ️    - Diagnosis 2: ''
[00:36:05] ℹ️    - Diagnosis 3: ''
[00:36:05] ℹ️    - Diagnosis 4: ''
[00:36:05] ℹ️    - Diagnosis 5: ''
[00:36:05] ℹ️    - Diagnosis 6: ''
[00:36:05] ℹ️  Final extracted MRN: '5915015'
[00:36:05] ℹ️  Final extracted Sex: 'FEMALE'
[00:36:05] ℹ️  Final extracted Service Line: 'HHA'
[00:36:05] ℹ️  Final extracted Payer Source: 'Medicare'
[00:36:05] ✅ Patient data extraction completed successfully
[00:36:05] ✅    ✅ Patient data extracted successfully
[00:36:05] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:36:05] ✅    ✅ Patient identified: Suzanne Fawcett
[00:36:05] ✅    ✅ Patient name validation passed
[00:36:05] 🔄 
🔄 Step 3: Processing patient dates...
[00:36:05] [DOC: 9240085] ℹ️  DOB normalized: 12/08/1939
[00:36:05] [DOC: 9240085] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:36:05] [DOC: 9240085] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[00:36:05] [DOC: 9240085] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[00:36:05] [DOC: 9240085] ✅ Patient date processing completed successfully
[00:36:05] ✅    ✅ Date processing completed
[00:36:05] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:36:05] 🔄 
🔄 Step 4: Extracting order data...
[00:36:08] ℹ️  Order extraction - MRN: ''
[00:36:08] ℹ️  Order extraction - Sex: 'FEMALE'
[00:36:08] ℹ️  Order extraction - Service Line: 'HHA'
[00:36:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:36:08] ✅ Order data extraction completed successfully
[00:36:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:36:08] ℹ️  Using MRN from patient data: '5915015'
[00:36:08] ℹ️  Service line consistent in both sources: 'HHA'
[00:36:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:36:08] ✅ Patient name cross-validation successful
[00:36:08] ✅    ✅ Data merged successfully
[00:36:09] ✅    ✅ Order data extracted and validated
[00:36:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:36:09] [DOC: 9240085] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:36:09] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:36:09] 🔄 
🔄 Step 6: Pushing order to API...
[00:36:09] [DOC: 9240085] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:36:10] [DOC: 9240085] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13932"}
[00:36:10] ❌    ❌ Failed to push order
[00:36:10] 🔄 
🔄 Step 7: Writing to CSV...
[00:36:10] [DOC: 9240085] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:36:10] [DOC: 9240085] ℹ️  Service Line extracted: 'HHA'
[00:36:10] [DOC: 9240085] ℹ️  Payer Source extracted: 'Medicare'
[00:36:10] [DOC: 9240085] ℹ️  Diagnosis codes being written:
[00:36:10] [DOC: 9240085] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:36:10] [DOC: 9240085] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:36:10] [DOC: 9240085] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:36:10] [DOC: 9240085] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:36:10] [DOC: 9240085] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:36:10] [DOC: 9240085] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:36:10] [DOC: 9240085] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: HHA | Payer: Medicare | MRN: 5915015
[00:36:10] ✅    ✅ Document 9240085 processed and saved successfully
[00:36:10] 🔄 
🔄 Step 8: Saving API details...
[00:36:10] [DOC: 9240085] ℹ️  API push details saved for document 9240085
[00:36:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240084                         ║
================================================================================
[00:36:10] ℹ️  Agency: Dartmouth HH
[00:36:10] ℹ️  Date: 04/15/2025
[00:36:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:36:13] [DOC: 9240084] ✅ Text extracted using pdfplumber (1644 chars)
[00:36:13] ✅    ✅ Text extracted using pdfplumber (1644 chars)
[00:36:13] 🔄 
🔄 Step 2: Extracting patient data...
[00:36:16] ℹ️  AI extracted raw sex value: 'F'
[00:36:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:36:16] ℹ️  AI extracted payer source: 'Medicare'
[00:36:16] ℹ️  AI extracted diagnoses:
[00:36:16] ℹ️    - Diagnosis 1: 'None'
[00:36:16] ℹ️    - Diagnosis 2: 'None'
[00:36:16] ℹ️    - Diagnosis 3: 'None'
[00:36:16] ℹ️    - Diagnosis 4: 'None'
[00:36:16] ℹ️    - Diagnosis 5: 'None'
[00:36:16] ℹ️    - Diagnosis 6: 'None'
[00:36:16] ℹ️  Final extracted MRN: '5915015'
[00:36:16] ℹ️  Final extracted Sex: 'FEMALE'
[00:36:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:36:16] ℹ️  Final extracted Payer Source: 'Medicare'
[00:36:16] ✅ Patient data extraction completed successfully
[00:36:16] ✅    ✅ Patient data extracted successfully
[00:36:16] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:36:16] ✅    ✅ Patient identified: Suzanne Fawcett
[00:36:16] ✅    ✅ Patient name validation passed
[00:36:16] 🔄 
🔄 Step 3: Processing patient dates...
[00:36:16] [DOC: 9240084] ℹ️  DOB normalized: 12/08/1939
[00:36:16] [DOC: 9240084] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:36:16] [DOC: 9240084] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[00:36:16] [DOC: 9240084] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[00:36:16] [DOC: 9240084] ✅ Patient date processing completed successfully
[00:36:16] ✅    ✅ Date processing completed
[00:36:16] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025'}]
[00:36:16] 🔄 
🔄 Step 4: Extracting order data...
[00:36:18] ℹ️  Order extraction - MRN: ''
[00:36:18] ℹ️  Order extraction - Sex: 'FEMALE'
[00:36:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:36:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:36:18] ✅ Order data extraction completed successfully
[00:36:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:36:18] ℹ️  Using MRN from patient data: '5915015'
[00:36:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:36:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:36:18] ✅ Patient name cross-validation successful
[00:36:18] ✅    ✅ Data merged successfully
[00:36:19] ✅    ✅ Order data extracted and validated
[00:36:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:36:19] [DOC: 9240084] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:36:19] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:36:19] 🔄 
🔄 Step 6: Pushing order to API...
[00:36:19] [DOC: 9240084] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:36:21] [DOC: 9240084] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:36:21] ❌    ❌ Failed to push order
[00:36:21] 🔄 
🔄 Step 7: Writing to CSV...
[00:36:21] [DOC: 9240084] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:36:21] [DOC: 9240084] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:36:21] [DOC: 9240084] ℹ️  Payer Source extracted: 'Medicare'
[00:36:21] [DOC: 9240084] ℹ️  Diagnosis codes being written:
[00:36:21] [DOC: 9240084] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:36:21] [DOC: 9240084] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:36:21] [DOC: 9240084] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:36:21] [DOC: 9240084] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:36:21] [DOC: 9240084] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:36:21] [DOC: 9240084] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:36:21] [DOC: 9240084] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: 5915015
[00:36:21] ✅    ✅ Document 9240084 processed and saved successfully
[00:36:21] 🔄 
🔄 Step 8: Saving API details...
[00:36:21] [DOC: 9240084] ℹ️  API push details saved for document 9240084
[00:36:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235166                         ║
================================================================================
[00:36:21] ℹ️  Agency: Dartmouth HH
[00:36:21] ℹ️  Date: 04/11/2025
[00:36:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:36:29] [DOC: 9235166] ✅ Text extracted using pdfplumber (2346 chars)
[00:36:29] ✅    ✅ Text extracted using pdfplumber (2346 chars)
[00:36:29] 🔄 
🔄 Step 2: Extracting patient data...
[00:36:32] ℹ️  AI extracted raw sex value: 'F'
[00:36:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:36:32] ℹ️  AI extracted payer source: 'Medicare'
[00:36:32] ℹ️  AI extracted diagnoses:
[00:36:32] ℹ️    - Diagnosis 1: ''
[00:36:32] ℹ️    - Diagnosis 2: ''
[00:36:32] ℹ️    - Diagnosis 3: ''
[00:36:32] ℹ️    - Diagnosis 4: ''
[00:36:32] ℹ️    - Diagnosis 5: ''
[00:36:32] ℹ️    - Diagnosis 6: ''
[00:36:32] ℹ️  Final extracted MRN: '2496015'
[00:36:32] ℹ️  Final extracted Sex: 'FEMALE'
[00:36:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:36:32] ℹ️  Final extracted Payer Source: 'Medicare'
[00:36:32] ✅ Patient data extraction completed successfully
[00:36:32] ✅    ✅ Patient data extracted successfully
[00:36:32] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:36:32] ✅    ✅ Patient identified: Dana Theodore
[00:36:32] ✅    ✅ Patient name validation passed
[00:36:32] 🔄 
🔄 Step 3: Processing patient dates...
[00:36:32] [DOC: 9235166] ℹ️  DOB normalized: 03/16/1954
[00:36:32] [DOC: 9235166] ℹ️  Episode startOfCare normalized: 03/02/2025
[00:36:32] [DOC: 9235166] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[00:36:32] [DOC: 9235166] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[00:36:32] [DOC: 9235166] ✅ Patient date processing completed successfully
[00:36:32] ✅    ✅ Date processing completed
[00:36:32] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:36:32] 🔄 
🔄 Step 4: Extracting order data...
[00:36:34] ℹ️  Order extraction - MRN: ''
[00:36:34] ℹ️  Order extraction - Sex: 'FEMALE'
[00:36:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:36:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:36:34] ✅ Order data extraction completed successfully
[00:36:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:36:34] ℹ️  Using MRN from patient data: '2496015'
[00:36:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:36:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:36:34] ✅ Patient name cross-validation successful
[00:36:34] ✅    ✅ Data merged successfully
[00:36:36] ✅    ✅ Order data extracted and validated
[00:36:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:36:36] [DOC: 9235166] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:36:36] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:36:36] 🔄 
🔄 Step 6: Pushing order to API...
[00:36:36] [DOC: 9235166] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:36:37] [DOC: 9235166] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:36:37] ❌    ❌ Failed to push order
[00:36:37] 🔄 
🔄 Step 7: Writing to CSV...
[00:36:37] [DOC: 9235166] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[00:36:37] [DOC: 9235166] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:36:37] [DOC: 9235166] ℹ️  Payer Source extracted: 'Medicare'
[00:36:37] [DOC: 9235166] ℹ️  Diagnosis codes being written:
[00:36:37] [DOC: 9235166] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:36:37] [DOC: 9235166] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:36:37] [DOC: 9235166] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:36:37] [DOC: 9235166] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:36:37] [DOC: 9235166] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:36:37] [DOC: 9235166] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:36:37] [DOC: 9235166] ✅ Patient data written to CSV: Dana Theodore | Sex: FEMALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[00:36:37] ✅    ✅ Document 9235166 processed and saved successfully
[00:36:37] 🔄 
🔄 Step 8: Saving API details...
[00:36:37] [DOC: 9235166] ℹ️  API push details saved for document 9235166
[00:36:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235163                         ║
================================================================================
[00:36:37] ℹ️  Agency: Dartmouth HH
[00:36:37] ℹ️  Date: 04/11/2025
[00:36:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:36:40] [DOC: 9235163] ✅ Text extracted using pdfplumber (1676 chars)
[00:36:40] ✅    ✅ Text extracted using pdfplumber (1676 chars)
[00:36:40] 🔄 
🔄 Step 2: Extracting patient data...
[00:36:42] ℹ️  AI extracted raw sex value: 'F'
[00:36:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:36:42] ℹ️  AI extracted payer source: 'Medicare'
[00:36:42] ℹ️  AI extracted diagnoses:
[00:36:42] ℹ️    - Diagnosis 1: ''
[00:36:42] ℹ️    - Diagnosis 2: ''
[00:36:42] ℹ️    - Diagnosis 3: ''
[00:36:42] ℹ️    - Diagnosis 4: ''
[00:36:42] ℹ️    - Diagnosis 5: ''
[00:36:42] ℹ️    - Diagnosis 6: ''
[00:36:42] ℹ️  Final extracted MRN: '6115015'
[00:36:42] ℹ️  Final extracted Sex: 'FEMALE'
[00:36:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:36:42] ℹ️  Final extracted Payer Source: 'Medicare'
[00:36:42] ✅ Patient data extraction completed successfully
[00:36:42] ✅    ✅ Patient data extracted successfully
[00:36:42] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:36:42] ✅    ✅ Patient identified: Nancy Silva
[00:36:42] ✅    ✅ Patient name validation passed
[00:36:42] 🔄 
🔄 Step 3: Processing patient dates...
[00:36:42] [DOC: 9235163] ℹ️  DOB normalized: 11/18/1936
[00:36:42] [DOC: 9235163] ℹ️  Episode startOfCare normalized: 03/01/2025
[00:36:42] [DOC: 9235163] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[00:36:42] [DOC: 9235163] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[00:36:42] [DOC: 9235163] ✅ Patient date processing completed successfully
[00:36:42] ✅    ✅ Date processing completed
[00:36:42] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:36:42] 🔄 
🔄 Step 4: Extracting order data...
[00:36:45] ℹ️  Order extraction - MRN: ''
[00:36:45] ℹ️  Order extraction - Sex: 'FEMALE'
[00:36:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:36:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:36:45] ✅ Order data extraction completed successfully
[00:36:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:36:45] ℹ️  Using MRN from patient data: '6115015'
[00:36:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:36:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:36:45] ✅ Patient name cross-validation successful
[00:36:45] ✅    ✅ Data merged successfully
[00:36:47] ✅    ✅ Order data extracted and validated
[00:36:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:36:47] [DOC: 9235163] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:36:47] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:36:47] 🔄 
🔄 Step 6: Pushing order to API...
[00:36:47] [DOC: 9235163] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:36:48] [DOC: 9235163] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14401"}
[00:36:48] ❌    ❌ Failed to push order
[00:36:48] 🔄 
🔄 Step 7: Writing to CSV...
[00:36:48] [DOC: 9235163] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[00:36:48] [DOC: 9235163] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:36:48] [DOC: 9235163] ℹ️  Payer Source extracted: 'Medicare'
[00:36:48] [DOC: 9235163] ℹ️  Diagnosis codes being written:
[00:36:48] [DOC: 9235163] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:36:48] [DOC: 9235163] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:36:48] [DOC: 9235163] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:36:48] [DOC: 9235163] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:36:48] [DOC: 9235163] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:36:48] [DOC: 9235163] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:36:48] [DOC: 9235163] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6115015
[00:36:48] ✅    ✅ Document 9235163 processed and saved successfully
[00:36:48] 🔄 
🔄 Step 8: Saving API details...
[00:36:48] [DOC: 9235163] ℹ️  API push details saved for document 9235163
[00:36:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235161                         ║
================================================================================
[00:36:48] ℹ️  Agency: Dartmouth HH
[00:36:48] ℹ️  Date: 04/11/2025
[00:36:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:36:49] [DOC: 9235161] ✅ Text extracted using pdfplumber (1075 chars)
[00:36:49] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[00:36:49] 🔄 
🔄 Step 2: Extracting patient data...
[00:36:52] ℹ️  AI extracted raw sex value: 'F'
[00:36:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:36:52] ℹ️  AI extracted payer source: 'Medicare'
[00:36:52] ℹ️  AI extracted diagnoses:
[00:36:52] ℹ️    - Diagnosis 1: 'None'
[00:36:52] ℹ️    - Diagnosis 2: 'None'
[00:36:52] ℹ️    - Diagnosis 3: 'None'
[00:36:52] ℹ️    - Diagnosis 4: 'None'
[00:36:52] ℹ️    - Diagnosis 5: 'None'
[00:36:52] ℹ️    - Diagnosis 6: 'None'
[00:36:52] ℹ️  Final extracted MRN: '6095015'
[00:36:52] ℹ️  Final extracted Sex: 'FEMALE'
[00:36:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:36:52] ℹ️  Final extracted Payer Source: 'Medicare'
[00:36:52] ✅ Patient data extraction completed successfully
[00:36:52] ✅    ✅ Patient data extracted successfully
[00:36:52] 📊 Patient Response
     └─ patientFName: Gabriel
     └─ patientLName: Ditata
     └─ dob: 03/18/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6095015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:36:52] ✅    ✅ Patient identified: Gabriel Ditata
[00:36:52] ✅    ✅ Patient name validation passed
[00:36:52] 🔄 
🔄 Step 3: Processing patient dates...
[00:36:52] [DOC: 9235161] ℹ️  DOB normalized: 03/18/1933
[00:36:52] [DOC: 9235161] ℹ️  Episode startOfCare normalized: 02/23/2025
[00:36:52] [DOC: 9235161] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[00:36:52] [DOC: 9235161] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[00:36:52] [DOC: 9235161] ✅ Patient date processing completed successfully
[00:36:52] ✅    ✅ Date processing completed
[00:36:52] 📊 Processed Patient Data
     └─ patientFName: Gabriel
     └─ patientLName: Ditata
     └─ dob: 03/18/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6095015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025'}]
[00:36:52] 🔄 
🔄 Step 4: Extracting order data...
[00:36:55] ℹ️  Order extraction - MRN: '6095015'
[00:36:55] ℹ️  Order extraction - Sex: 'FEMALE'
[00:36:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:36:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:36:55] ✅ Order data extraction completed successfully
[00:36:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:36:55] ℹ️  Using MRN from patient data: '6095015' over '6095015'
[00:36:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:36:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:36:55] ✅ Patient name cross-validation successful
[00:36:55] ✅    ✅ Data merged successfully
[00:36:56] ✅    ✅ Order data extracted and validated
[00:36:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:36:58] [DOC: 9235161] ✅ Patient exists in API: Gabriel Ditata, ID: c7367401-e45e-4436-ae06-988c6f8f69d6
[00:36:58] ✅    ✅ Existing patient found with ID: c7367401-e45e-4436-ae06-988c6f8f69d6
[00:36:58] 🔄 
🔄 Step 6: Pushing order to API...
[00:36:58] [DOC: 9235161] ℹ️  Pushing order via API for patient ID: c7367401-e45e-4436-ae06-988c6f8f69d6
[00:36:59] [DOC: 9235161] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:36:59] ❌    ❌ Failed to push order
[00:36:59] 🔄 
🔄 Step 7: Writing to CSV...
[00:36:59] [DOC: 9235161] ℹ️  Calculated age: 92 from DOB: 03/18/1933
[00:36:59] [DOC: 9235161] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:36:59] [DOC: 9235161] ℹ️  Payer Source extracted: 'Medicare'
[00:36:59] [DOC: 9235161] ℹ️  Diagnosis codes being written:
[00:36:59] [DOC: 9235161] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:36:59] [DOC: 9235161] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:36:59] [DOC: 9235161] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:36:59] [DOC: 9235161] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:36:59] [DOC: 9235161] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:36:59] [DOC: 9235161] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:36:59] [DOC: 9235161] ✅ Patient data written to CSV: Gabriel Ditata | Sex: FEMALE | Age: 92 | Service: Skilled Nursing | Payer: Medicare | MRN: 6095015
[00:36:59] ✅    ✅ Document 9235161 processed and saved successfully
[00:36:59] 🔄 
🔄 Step 8: Saving API details...
[00:36:59] [DOC: 9235161] ℹ️  API push details saved for document 9235161
[00:36:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235156                         ║
================================================================================
[00:36:59] ℹ️  Agency: Dartmouth HH
[00:36:59] ℹ️  Date: 04/11/2025
[00:36:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:37:01] [DOC: 9235156] ✅ Text extracted using pdfplumber (1165 chars)
[00:37:01] ✅    ✅ Text extracted using pdfplumber (1165 chars)
[00:37:01] 🔄 
🔄 Step 2: Extracting patient data...
[00:37:04] ℹ️  AI extracted raw sex value: 'M'
[00:37:04] ℹ️  AI extracted service line: 'RN, LPN'
[00:37:04] ℹ️  AI extracted payer source: 'Medicare'
[00:37:04] ℹ️  AI extracted diagnoses:
[00:37:04] ℹ️    - Diagnosis 1: ''
[00:37:04] ℹ️    - Diagnosis 2: ''
[00:37:04] ℹ️    - Diagnosis 3: ''
[00:37:04] ℹ️    - Diagnosis 4: ''
[00:37:04] ℹ️    - Diagnosis 5: ''
[00:37:04] ℹ️    - Diagnosis 6: ''
[00:37:04] ℹ️  Final extracted MRN: '6396009'
[00:37:04] ℹ️  Final extracted Sex: 'MALE'
[00:37:04] ℹ️  Final extracted Service Line: 'RN, LPN'
[00:37:04] ℹ️  Final extracted Payer Source: 'Medicare'
[00:37:04] ✅ Patient data extraction completed successfully
[00:37:04] ✅    ✅ Patient data extracted successfully
[00:37:04] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 12 Hathaway Road
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:04] ✅    ✅ Patient identified: Frank Edwards
[00:37:04] ✅    ✅ Patient name validation passed
[00:37:04] 🔄 
🔄 Step 3: Processing patient dates...
[00:37:04] [DOC: 9235156] ℹ️  DOB normalized: 04/08/1942
[00:37:04] [DOC: 9235156] ℹ️  Episode startOfCare normalized: 03/13/2025
[00:37:04] [DOC: 9235156] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[00:37:04] [DOC: 9235156] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[00:37:04] [DOC: 9235156] ✅ Patient date processing completed successfully
[00:37:04] ✅    ✅ Date processing completed
[00:37:04] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 12 Hathaway Road
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:04] 🔄 
🔄 Step 4: Extracting order data...
[00:37:06] ℹ️  Order extraction - MRN: ''
[00:37:06] ℹ️  Order extraction - Sex: 'MALE'
[00:37:06] ℹ️  Order extraction - Service Line: 'RN, LPN'
[00:37:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:37:06] ✅ Order data extraction completed successfully
[00:37:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:37:06] ℹ️  Using MRN from patient data: '6396009'
[00:37:06] ℹ️  Service line consistent in both sources: 'RN, LPN'
[00:37:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:37:06] ✅ Patient name cross-validation successful
[00:37:06] ✅    ✅ Data merged successfully
[00:37:07] ✅    ✅ Order data extracted and validated
[00:37:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:37:07] [DOC: 9235156] ✅ Patient found in local cache: Frank Edwards, ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[00:37:07] ✅    ✅ Existing patient found with ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[00:37:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:37:07] [DOC: 9235156] ℹ️  Pushing order via API for patient ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[00:37:09] [DOC: 9235156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13905"}
[00:37:09] ❌    ❌ Failed to push order
[00:37:09] 🔄 
🔄 Step 7: Writing to CSV...
[00:37:09] [DOC: 9235156] ℹ️  Calculated age: 83 from DOB: 04/08/1942
[00:37:09] [DOC: 9235156] ℹ️  Service Line extracted: 'RN, LPN'
[00:37:09] [DOC: 9235156] ℹ️  Payer Source extracted: 'Medicare'
[00:37:09] [DOC: 9235156] ℹ️  Diagnosis codes being written:
[00:37:09] [DOC: 9235156] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:37:09] [DOC: 9235156] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:37:09] [DOC: 9235156] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:37:09] [DOC: 9235156] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:37:09] [DOC: 9235156] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:37:09] [DOC: 9235156] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:37:09] [DOC: 9235156] ✅ Patient data written to CSV: Frank Edwards | Sex: MALE | Age: 83 | Service: RN, LPN | Payer: Medicare | MRN: 6396009
[00:37:09] ✅    ✅ Document 9235156 processed and saved successfully
[00:37:09] 🔄 
🔄 Step 8: Saving API details...
[00:37:09] [DOC: 9235156] ℹ️  API push details saved for document 9235156
[00:37:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235153                         ║
================================================================================
[00:37:09] ℹ️  Agency: Dartmouth HH
[00:37:09] ℹ️  Date: 04/11/2025
[00:37:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:37:11] [DOC: 9235153] ✅ Text extracted using pdfplumber (1785 chars)
[00:37:11] ✅    ✅ Text extracted using pdfplumber (1785 chars)
[00:37:11] 🔄 
🔄 Step 2: Extracting patient data...
[00:37:14] ℹ️  AI extracted raw sex value: 'M'
[00:37:14] ℹ️  AI extracted service line: 'OT, RN, LPN'
[00:37:14] ℹ️  AI extracted payer source: 'Medicare'
[00:37:14] ℹ️  AI extracted diagnoses:
[00:37:14] ℹ️    - Diagnosis 1: ''
[00:37:14] ℹ️    - Diagnosis 2: ''
[00:37:14] ℹ️    - Diagnosis 3: ''
[00:37:14] ℹ️    - Diagnosis 4: ''
[00:37:14] ℹ️    - Diagnosis 5: ''
[00:37:14] ℹ️    - Diagnosis 6: ''
[00:37:14] ℹ️  Final extracted MRN: '1556015'
[00:37:14] ℹ️  Final extracted Sex: 'MALE'
[00:37:14] ℹ️  Final extracted Service Line: 'OT, RN, LPN'
[00:37:14] ℹ️  Final extracted Payer Source: 'Medicare'
[00:37:14] ✅ Patient data extraction completed successfully
[00:37:14] ✅    ✅ Patient data extracted successfully
[00:37:14] 📊 Patient Response
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:14] ✅    ✅ Patient identified: Andrew Reuter
[00:37:14] ✅    ✅ Patient name validation passed
[00:37:14] 🔄 
🔄 Step 3: Processing patient dates...
[00:37:14] [DOC: 9235153] ℹ️  DOB normalized: 07/06/1927
[00:37:14] [DOC: 9235153] ℹ️  Episode startOfCare normalized: 03/26/2025
[00:37:14] [DOC: 9235153] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[00:37:14] [DOC: 9235153] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[00:37:14] [DOC: 9235153] ✅ Patient date processing completed successfully
[00:37:14] ✅    ✅ Date processing completed
[00:37:14] 📊 Processed Patient Data
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:14] 🔄 
🔄 Step 4: Extracting order data...
[00:37:16] ℹ️  Order extraction - MRN: ''
[00:37:16] ℹ️  Order extraction - Sex: 'MALE'
[00:37:16] ℹ️  Order extraction - Service Line: 'OT, RN, LPN'
[00:37:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:37:16] ✅ Order data extraction completed successfully
[00:37:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:37:16] ℹ️  Using MRN from patient data: '1556015'
[00:37:16] ℹ️  Service line consistent in both sources: 'OT, RN, LPN'
[00:37:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:37:16] ✅ Patient name cross-validation successful
[00:37:16] ✅    ✅ Data merged successfully
[00:37:17] ✅    ✅ Order data extracted and validated
[00:37:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:37:17] [DOC: 9235153] ✅ Patient found in local cache: Andrew Reuter, ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[00:37:17] ✅    ✅ Existing patient found with ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[00:37:17] 🔄 
🔄 Step 6: Pushing order to API...
[00:37:17] [DOC: 9235153] ℹ️  Pushing order via API for patient ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[00:37:19] [DOC: 9235153] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13164"}
[00:37:19] ❌    ❌ Failed to push order
[00:37:19] 🔄 
🔄 Step 7: Writing to CSV...
[00:37:19] [DOC: 9235153] ℹ️  Calculated age: 97 from DOB: 07/06/1927
[00:37:19] [DOC: 9235153] ℹ️  Service Line extracted: 'OT, RN, LPN'
[00:37:19] [DOC: 9235153] ℹ️  Payer Source extracted: 'Medicare'
[00:37:19] [DOC: 9235153] ℹ️  Diagnosis codes being written:
[00:37:19] [DOC: 9235153] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:37:19] [DOC: 9235153] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:37:19] [DOC: 9235153] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:37:19] [DOC: 9235153] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:37:19] [DOC: 9235153] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:37:19] [DOC: 9235153] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:37:19] [DOC: 9235153] ✅ Patient data written to CSV: Andrew Reuter | Sex: MALE | Age: 97 | Service: OT, RN, LPN | Payer: Medicare | MRN: 1556015
[00:37:19] ✅    ✅ Document 9235153 processed and saved successfully
[00:37:19] 🔄 
🔄 Step 8: Saving API details...
[00:37:19] [DOC: 9235153] ℹ️  API push details saved for document 9235153
[00:37:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235119                         ║
================================================================================
[00:37:19] ℹ️  Agency: Dartmouth HH
[00:37:19] ℹ️  Date: 04/11/2025
[00:37:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:37:20] [DOC: 9235119] ✅ Text extracted using pdfplumber (1034 chars)
[00:37:20] ✅    ✅ Text extracted using pdfplumber (1034 chars)
[00:37:20] 🔄 
🔄 Step 2: Extracting patient data...
[00:37:23] ℹ️  AI extracted raw sex value: 'F'
[00:37:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:37:23] ℹ️  AI extracted payer source: 'Medicare'
[00:37:23] ℹ️  AI extracted diagnoses:
[00:37:23] ℹ️    - Diagnosis 1: ''
[00:37:23] ℹ️    - Diagnosis 2: ''
[00:37:23] ℹ️    - Diagnosis 3: ''
[00:37:23] ℹ️    - Diagnosis 4: ''
[00:37:23] ℹ️    - Diagnosis 5: ''
[00:37:23] ℹ️    - Diagnosis 6: ''
[00:37:23] ℹ️  Final extracted MRN: '323014'
[00:37:23] ℹ️  Final extracted Sex: 'FEMALE'
[00:37:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:37:23] ℹ️  Final extracted Payer Source: 'Medicare'
[00:37:23] ✅ Patient data extraction completed successfully
[00:37:23] ✅    ✅ Patient data extracted successfully
[00:37:23] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Shan Qin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:23] ✅    ✅ Patient identified: Sandra Plissey
[00:37:23] ✅    ✅ Patient name validation passed
[00:37:23] 🔄 
🔄 Step 3: Processing patient dates...
[00:37:23] [DOC: 9235119] ℹ️  DOB normalized: 11/19/1943
[00:37:23] [DOC: 9235119] ℹ️  Episode startOfCare normalized: 10/07/2024
[00:37:23] [DOC: 9235119] ℹ️  Episode startOfEpisode normalized: 02/04/2025
[00:37:23] [DOC: 9235119] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[00:37:23] [DOC: 9235119] ✅ Patient date processing completed successfully
[00:37:23] ✅    ✅ Date processing completed
[00:37:23] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Shan Qin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:23] 🔄 
🔄 Step 4: Extracting order data...
[00:37:26] ℹ️  Order extraction - MRN: ''
[00:37:26] ℹ️  Order extraction - Sex: 'FEMALE'
[00:37:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:37:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:37:26] ✅ Order data extraction completed successfully
[00:37:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:37:26] ℹ️  Using MRN from patient data: '323014'
[00:37:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:37:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:37:26] ✅ Patient name cross-validation successful
[00:37:26] ✅    ✅ Data merged successfully
[00:37:27] ✅    ✅ Order data extracted and validated
[00:37:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:37:27] [DOC: 9235119] ✅ Patient found in local cache: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:37:27] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:37:27] 🔄 
🔄 Step 6: Pushing order to API...
[00:37:27] [DOC: 9235119] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[00:37:28] [DOC: 9235119] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13081"}
[00:37:28] ❌    ❌ Failed to push order
[00:37:28] 🔄 
🔄 Step 7: Writing to CSV...
[00:37:28] [DOC: 9235119] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[00:37:28] [DOC: 9235119] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:37:28] [DOC: 9235119] ℹ️  Payer Source extracted: 'Medicare'
[00:37:28] [DOC: 9235119] ℹ️  Diagnosis codes being written:
[00:37:28] [DOC: 9235119] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:37:28] [DOC: 9235119] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:37:28] [DOC: 9235119] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:37:28] [DOC: 9235119] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:37:28] [DOC: 9235119] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:37:28] [DOC: 9235119] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:37:28] [DOC: 9235119] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: 323014
[00:37:28] ✅    ✅ Document 9235119 processed and saved successfully
[00:37:28] 🔄 
🔄 Step 8: Saving API details...
[00:37:28] [DOC: 9235119] ℹ️  API push details saved for document 9235119
[00:37:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235095                         ║
================================================================================
[00:37:28] ℹ️  Agency: Dartmouth HH
[00:37:28] ℹ️  Date: 04/11/2025
[00:37:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:37:31] [DOC: 9235095] ✅ Text extracted using pdfplumber (1091 chars)
[00:37:31] ✅    ✅ Text extracted using pdfplumber (1091 chars)
[00:37:31] 🔄 
🔄 Step 2: Extracting patient data...
[00:37:34] ℹ️  AI extracted raw sex value: 'F'
[00:37:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:37:34] ℹ️  AI extracted payer source: 'Medicare'
[00:37:34] ℹ️  AI extracted diagnoses:
[00:37:34] ℹ️    - Diagnosis 1: ''
[00:37:34] ℹ️    - Diagnosis 2: ''
[00:37:34] ℹ️    - Diagnosis 3: ''
[00:37:34] ℹ️    - Diagnosis 4: ''
[00:37:34] ℹ️    - Diagnosis 5: ''
[00:37:34] ℹ️    - Diagnosis 6: ''
[00:37:34] ℹ️  Final extracted MRN: '3320011'
[00:37:34] ℹ️  Final extracted Sex: 'FEMALE'
[00:37:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:37:34] ℹ️  Final extracted Payer Source: 'Medicare'
[00:37:34] ✅ Patient data extraction completed successfully
[00:37:34] ✅    ✅ Patient data extracted successfully
[00:37:34] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:34] ✅    ✅ Patient identified: Bonnie Werly
[00:37:34] ✅    ✅ Patient name validation passed
[00:37:34] 🔄 
🔄 Step 3: Processing patient dates...
[00:37:34] [DOC: 9235095] ℹ️  DOB normalized: 06/16/1939
[00:37:34] [DOC: 9235095] ℹ️  Episode startOfCare normalized: 09/01/2024
[00:37:34] [DOC: 9235095] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[00:37:34] [DOC: 9235095] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[00:37:34] [DOC: 9235095] ✅ Patient date processing completed successfully
[00:37:34] ✅    ✅ Date processing completed
[00:37:34] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:34] 🔄 
🔄 Step 4: Extracting order data...
[00:37:36] ℹ️  Order extraction - MRN: ''
[00:37:36] ℹ️  Order extraction - Sex: 'FEMALE'
[00:37:36] ℹ️  Order extraction - Service Line: 'RN'
[00:37:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:37:36] ✅ Order data extraction completed successfully
[00:37:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:37:36] ℹ️  Using MRN from patient data: '3320011'
[00:37:36] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[00:37:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:37:36] ✅ Patient name cross-validation successful
[00:37:36] ✅    ✅ Data merged successfully
[00:37:38] ✅    ✅ Order data extracted and validated
[00:37:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:37:38] [DOC: 9235095] ✅ Patient found in local cache: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[00:37:38] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[00:37:38] 🔄 
🔄 Step 6: Pushing order to API...
[00:37:38] [DOC: 9235095] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[00:37:39] [DOC: 9235095] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14422"}
[00:37:39] ❌    ❌ Failed to push order
[00:37:39] 🔄 
🔄 Step 7: Writing to CSV...
[00:37:39] [DOC: 9235095] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[00:37:39] [DOC: 9235095] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[00:37:39] [DOC: 9235095] ℹ️  Payer Source extracted: 'Medicare'
[00:37:39] [DOC: 9235095] ℹ️  Diagnosis codes being written:
[00:37:39] [DOC: 9235095] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:37:39] [DOC: 9235095] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:37:39] [DOC: 9235095] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:37:39] [DOC: 9235095] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:37:39] [DOC: 9235095] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:37:39] [DOC: 9235095] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:37:39] [DOC: 9235095] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 3320011
[00:37:39] ✅    ✅ Document 9235095 processed and saved successfully
[00:37:39] 🔄 
🔄 Step 8: Saving API details...
[00:37:39] [DOC: 9235095] ℹ️  API push details saved for document 9235095
[00:37:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235090                         ║
================================================================================
[00:37:39] ℹ️  Agency: Dartmouth HH
[00:37:39] ℹ️  Date: 04/11/2025
[00:37:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:37:41] [DOC: 9235090] ✅ Text extracted using pdfplumber (1242 chars)
[00:37:41] ✅    ✅ Text extracted using pdfplumber (1242 chars)
[00:37:41] 🔄 
🔄 Step 2: Extracting patient data...
[00:37:44] ℹ️  AI extracted raw sex value: 'F'
[00:37:44] ℹ️  AI extracted service line: 'PT'
[00:37:44] ℹ️  AI extracted payer source: 'Medicare'
[00:37:44] ℹ️  AI extracted diagnoses:
[00:37:44] ℹ️    - Diagnosis 1: ''
[00:37:44] ℹ️    - Diagnosis 2: ''
[00:37:44] ℹ️    - Diagnosis 3: ''
[00:37:44] ℹ️    - Diagnosis 4: ''
[00:37:44] ℹ️    - Diagnosis 5: ''
[00:37:44] ℹ️    - Diagnosis 6: ''
[00:37:44] ℹ️  Final extracted MRN: '6267009'
[00:37:44] ℹ️  Final extracted Sex: 'FEMALE'
[00:37:44] ℹ️  Final extracted Service Line: 'PT'
[00:37:44] ℹ️  Final extracted Payer Source: 'Medicare'
[00:37:44] ✅ Patient data extraction completed successfully
[00:37:44] ✅    ✅ Patient data extracted successfully
[00:37:44] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:44] ✅    ✅ Patient identified: Donna Finni
[00:37:44] ✅    ✅ Patient name validation passed
[00:37:44] 🔄 
🔄 Step 3: Processing patient dates...
[00:37:44] [DOC: 9235090] ℹ️  DOB normalized: 04/04/1955
[00:37:44] [DOC: 9235090] ℹ️  Episode startOfCare normalized: 03/19/2025
[00:37:44] [DOC: 9235090] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[00:37:44] [DOC: 9235090] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[00:37:44] [DOC: 9235090] ✅ Patient date processing completed successfully
[00:37:44] ✅    ✅ Date processing completed
[00:37:44] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:44] 🔄 
🔄 Step 4: Extracting order data...
[00:37:46] ℹ️  Order extraction - MRN: ''
[00:37:46] ℹ️  Order extraction - Sex: 'FEMALE'
[00:37:46] ℹ️  Order extraction - Service Line: 'PT'
[00:37:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:37:46] ✅ Order data extraction completed successfully
[00:37:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:37:46] ℹ️  Using MRN from patient data: '6267009'
[00:37:46] ℹ️  Service line consistent in both sources: 'PT'
[00:37:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:37:46] ✅ Patient name cross-validation successful
[00:37:46] ✅    ✅ Data merged successfully
[00:37:48] ✅    ✅ Order data extracted and validated
[00:37:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:37:48] [DOC: 9235090] ✅ Patient found in local cache: Donna Finni, ID: b65d9a94-f3a4-4249-9789-eba56300631b
[00:37:48] ✅    ✅ Existing patient found with ID: b65d9a94-f3a4-4249-9789-eba56300631b
[00:37:48] 🔄 
🔄 Step 6: Pushing order to API...
[00:37:48] [DOC: 9235090] ℹ️  Pushing order via API for patient ID: b65d9a94-f3a4-4249-9789-eba56300631b
[00:37:49] [DOC: 9235090] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14048"}
[00:37:49] ❌    ❌ Failed to push order
[00:37:49] 🔄 
🔄 Step 7: Writing to CSV...
[00:37:49] [DOC: 9235090] ℹ️  Calculated age: 70 from DOB: 04/04/1955
[00:37:49] [DOC: 9235090] ℹ️  Service Line extracted: 'PT'
[00:37:49] [DOC: 9235090] ℹ️  Payer Source extracted: 'Medicare'
[00:37:49] [DOC: 9235090] ℹ️  Diagnosis codes being written:
[00:37:49] [DOC: 9235090] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:37:49] [DOC: 9235090] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:37:49] [DOC: 9235090] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:37:49] [DOC: 9235090] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:37:49] [DOC: 9235090] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:37:49] [DOC: 9235090] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:37:49] [DOC: 9235090] ✅ Patient data written to CSV: Donna Finni | Sex: FEMALE | Age: 70 | Service: PT | Payer: Medicare | MRN: 6267009
[00:37:49] ✅    ✅ Document 9235090 processed and saved successfully
[00:37:49] 🔄 
🔄 Step 8: Saving API details...
[00:37:49] [DOC: 9235090] ℹ️  API push details saved for document 9235090
[00:37:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235087                         ║
================================================================================
[00:37:49] ℹ️  Agency: Dartmouth HH
[00:37:49] ℹ️  Date: 04/11/2025
[00:37:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:37:51] [DOC: 9235087] ✅ Text extracted using pdfplumber (1136 chars)
[00:37:51] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[00:37:51] 🔄 
🔄 Step 2: Extracting patient data...
[00:37:54] ℹ️  AI extracted raw sex value: 'F'
[00:37:54] ℹ️  AI extracted service line: 'RN'
[00:37:54] ℹ️  AI extracted payer source: 'Medicare'
[00:37:54] ℹ️  AI extracted diagnoses:
[00:37:54] ℹ️    - Diagnosis 1: ''
[00:37:54] ℹ️    - Diagnosis 2: ''
[00:37:54] ℹ️    - Diagnosis 3: ''
[00:37:54] ℹ️    - Diagnosis 4: ''
[00:37:54] ℹ️    - Diagnosis 5: ''
[00:37:54] ℹ️    - Diagnosis 6: ''
[00:37:54] ℹ️  Final extracted MRN: '5915015'
[00:37:54] ℹ️  Final extracted Sex: 'FEMALE'
[00:37:54] ℹ️  Final extracted Service Line: 'RN'
[00:37:54] ℹ️  Final extracted Payer Source: 'Medicare'
[00:37:54] ✅ Patient data extraction completed successfully
[00:37:54] ✅    ✅ Patient data extracted successfully
[00:37:54] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:54] ✅    ✅ Patient identified: Suzanne Fawcett
[00:37:54] ✅    ✅ Patient name validation passed
[00:37:54] 🔄 
🔄 Step 3: Processing patient dates...
[00:37:54] [DOC: 9235087] ℹ️  DOB normalized: 12/08/1939
[00:37:54] [DOC: 9235087] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:37:54] [DOC: 9235087] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[00:37:54] [DOC: 9235087] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[00:37:54] [DOC: 9235087] ✅ Patient date processing completed successfully
[00:37:54] ✅    ✅ Date processing completed
[00:37:54] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:37:54] 🔄 
🔄 Step 4: Extracting order data...
[00:37:56] ℹ️  Order extraction - MRN: ''
[00:37:56] ℹ️  Order extraction - Sex: 'FEMALE'
[00:37:56] ℹ️  Order extraction - Service Line: ''
[00:37:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:37:56] ✅ Order data extraction completed successfully
[00:37:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:37:56] ℹ️  Using MRN from patient data: '5915015'
[00:37:56] ℹ️  Using service line from patient data: 'RN'
[00:37:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:37:56] ✅ Patient name cross-validation successful
[00:37:56] ✅    ✅ Data merged successfully
[00:37:58] ✅    ✅ Order data extracted and validated
[00:37:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:37:58] [DOC: 9235087] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:37:58] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:37:58] 🔄 
🔄 Step 6: Pushing order to API...
[00:37:58] [DOC: 9235087] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:37:59] [DOC: 9235087] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13932"}
[00:37:59] ❌    ❌ Failed to push order
[00:37:59] 🔄 
🔄 Step 7: Writing to CSV...
[00:37:59] [DOC: 9235087] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:37:59] [DOC: 9235087] ℹ️  Service Line extracted: 'RN'
[00:37:59] [DOC: 9235087] ℹ️  Payer Source extracted: 'Medicare'
[00:37:59] [DOC: 9235087] ℹ️  Diagnosis codes being written:
[00:37:59] [DOC: 9235087] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:37:59] [DOC: 9235087] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:37:59] [DOC: 9235087] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:37:59] [DOC: 9235087] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:37:59] [DOC: 9235087] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:37:59] [DOC: 9235087] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:37:59] [DOC: 9235087] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: RN | Payer: Medicare | MRN: 5915015
[00:37:59] ✅    ✅ Document 9235087 processed and saved successfully
[00:37:59] 🔄 
🔄 Step 8: Saving API details...
[00:37:59] [DOC: 9235087] ℹ️  API push details saved for document 9235087
[00:37:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232904                         ║
================================================================================
[00:37:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:37:59] ℹ️  Date: 04/10/2025
[00:37:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:38:03] [DOC: 9232904] ✅ Text extracted using pdfplumber (24823 chars)
[00:38:03] ✅    ✅ Text extracted using pdfplumber (24823 chars)
[00:38:03] 🔄 
🔄 Step 2: Extracting patient data...
[00:38:06] ℹ️  AI extracted raw sex value: 'M'
[00:38:06] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:38:06] ℹ️  AI extracted payer source: ''
[00:38:06] ℹ️  AI extracted diagnoses:
[00:38:06] ℹ️    - Diagnosis 1: 'I11.0'
[00:38:06] ℹ️    - Diagnosis 2: 'I50.33'
[00:38:06] ℹ️    - Diagnosis 3: 'J96.01'
[00:38:06] ℹ️    - Diagnosis 4: 'J44.9'
[00:38:06] ℹ️    - Diagnosis 5: 'J43.9'
[00:38:06] ℹ️    - Diagnosis 6: 'J84.10'
[00:38:06] ℹ️  Final extracted MRN: '2447688'
[00:38:06] ℹ️  Final extracted Sex: 'MALE'
[00:38:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:38:06] ℹ️  Final extracted Payer Source: ''
[00:38:06] ✅ Patient data extraction completed successfully
[00:38:06] ✅    ✅ Patient data extracted successfully
[00:38:06] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'J43.9', 'sixthDiagnosis': 'J84.10'}]
[00:38:06] ✅    ✅ Patient identified: George England
[00:38:06] ✅    ✅ Patient name validation passed
[00:38:06] 🔄 
🔄 Step 3: Processing patient dates...
[00:38:06] [DOC: 9232904] ℹ️  DOB normalized: 08/26/1924
[00:38:06] [DOC: 9232904] ℹ️  Episode startOfCare normalized: 03/28/2025
[00:38:06] [DOC: 9232904] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[00:38:06] [DOC: 9232904] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[00:38:06] [DOC: 9232904] ✅ Patient date processing completed successfully
[00:38:06] ✅    ✅ Date processing completed
[00:38:06] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'J43.9', 'sixthDiagnosis': 'J84.10'}]
[00:38:06] 🔄 
🔄 Step 4: Extracting order data...
[00:38:09] ℹ️  Order extraction - MRN: '2447688'
[00:38:09] ℹ️  Order extraction - Sex: 'MALE'
[00:38:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[00:38:09] ℹ️  Order extraction - Payer Source: ''
[00:38:09] ✅ Order data extraction completed successfully
[00:38:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:38:09] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[00:38:09] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[00:38:09] ✅ Patient name cross-validation successful
[00:38:09] ✅    ✅ Data merged successfully
[00:38:11] ✅    ✅ Order data extracted and validated
[00:38:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:38:11] [DOC: 9232904] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:38:11] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:38:11] 🔄 
🔄 Step 6: Pushing order to API...
[00:38:11] [DOC: 9232904] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:38:12] [DOC: 9232904] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14173"}
[00:38:12] ❌    ❌ Failed to push order
[00:38:12] 🔄 
🔄 Step 7: Writing to CSV...
[00:38:12] [DOC: 9232904] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[00:38:12] [DOC: 9232904] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[00:38:12] [DOC: 9232904] ℹ️  Payer Source extracted: ''
[00:38:12] [DOC: 9232904] ℹ️  Diagnosis codes being written:
[00:38:12] [DOC: 9232904] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[00:38:12] [DOC: 9232904] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[00:38:12] [DOC: 9232904] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.01'
[00:38:12] [DOC: 9232904] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[00:38:12] [DOC: 9232904] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J43.9'
[00:38:12] [DOC: 9232904] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J84.10'
[00:38:12] [DOC: 9232904] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2447688
[00:38:12] ✅    ✅ Document 9232904 processed and saved successfully
[00:38:12] 🔄 
🔄 Step 8: Saving API details...
[00:38:12] [DOC: 9232904] ℹ️  API push details saved for document 9232904
[00:38:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232165                         ║
================================================================================
[00:38:12] ℹ️  Agency: Nizhoni Health-Fall River
[00:38:12] ℹ️  Date: 04/10/2025
[00:38:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:38:19] [DOC: 9232165] ✅ Text extracted using pdfplumber (16929 chars)
[00:38:19] ✅    ✅ Text extracted using pdfplumber (16929 chars)
[00:38:19] 🔄 
🔄 Step 2: Extracting patient data...
[00:38:23] ℹ️  AI extracted raw sex value: 'M'
[00:38:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:38:23] ℹ️  AI extracted payer source: 'None'
[00:38:23] ℹ️  AI extracted diagnoses:
[00:38:23] ℹ️    - Diagnosis 1: 'N31.9'
[00:38:23] ℹ️    - Diagnosis 2: 'G40.211'
[00:38:23] ℹ️    - Diagnosis 3: 'G93.1'
[00:38:23] ℹ️    - Diagnosis 4: 'F33.2'
[00:38:23] ℹ️    - Diagnosis 5: 'Z87.820'
[00:38:23] ℹ️    - Diagnosis 6: 'F41.8'
[00:38:23] ℹ️  Final extracted MRN: '3947012'
[00:38:23] ℹ️  Final extracted Sex: 'MALE'
[00:38:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:38:23] ℹ️  Final extracted Payer Source: ''
[00:38:23] ✅ Patient data extraction completed successfully
[00:38:23] ✅    ✅ Patient data extracted successfully
[00:38:23] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Bartley
     └─ dob: 10/08/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 3947012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100202523039
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'N31.9', 'secondDiagnosis': 'G40.211', 'thirdDiagnosis': 'G93.1', 'fourthDiagnosis': 'F33.2', 'fifthDiagnosis': 'Z87.820', 'sixthDiagnosis': 'F41.8'}]
[00:38:23] ✅    ✅ Patient identified: Richard Bartley
[00:38:23] ✅    ✅ Patient name validation passed
[00:38:23] 🔄 
🔄 Step 3: Processing patient dates...
[00:38:23] [DOC: 9232165] ℹ️  DOB normalized: 10/08/1962
[00:38:23] [DOC: 9232165] ℹ️  Episode startOfCare normalized: 10/20/2023
[00:38:23] [DOC: 9232165] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[00:38:23] [DOC: 9232165] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[00:38:23] [DOC: 9232165] ✅ Patient date processing completed successfully
[00:38:23] ✅    ✅ Date processing completed
[00:38:23] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Bartley
     └─ dob: 10/08/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 3947012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100202523039
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'N31.9', 'secondDiagnosis': 'G40.211', 'thirdDiagnosis': 'G93.1', 'fourthDiagnosis': 'F33.2', 'fifthDiagnosis': 'Z87.820', 'sixthDiagnosis': 'F41.8'}]
[00:38:23] 🔄 
🔄 Step 4: Extracting order data...
[00:38:25] ℹ️  Order extraction - MRN: '3947012'
[00:38:25] ℹ️  Order extraction - Sex: 'MALE'
[00:38:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:38:25] ℹ️  Order extraction - Payer Source: ''
[00:38:25] ✅ Order data extraction completed successfully
[00:38:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:38:25] ℹ️  Using MRN from patient data: '3947012' over '3947012'
[00:38:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:38:25] ✅ Patient name cross-validation successful
[00:38:25] ✅    ✅ Data merged successfully
[00:38:27] ✅    ✅ Order data extracted and validated
[00:38:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:38:27] [DOC: 9232165] ✅ Patient found in local cache: Richard Bartley, ID: 92b45a6e-a736-4268-8194-cda2951c948d
[00:38:27] ✅    ✅ Existing patient found with ID: 92b45a6e-a736-4268-8194-cda2951c948d
[00:38:27] 🔄 
🔄 Step 6: Pushing order to API...
[00:38:27] [DOC: 9232165] ℹ️  Pushing order via API for patient ID: 92b45a6e-a736-4268-8194-cda2951c948d
[00:38:28] [DOC: 9232165] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20045"}
[00:38:28] ❌    ❌ Failed to push order
[00:38:28] 🔄 
🔄 Step 7: Writing to CSV...
[00:38:28] [DOC: 9232165] ℹ️  Calculated age: 62 from DOB: 10/08/1962
[00:38:28] [DOC: 9232165] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:38:28] [DOC: 9232165] ℹ️  Payer Source extracted: ''
[00:38:28] [DOC: 9232165] ℹ️  Diagnosis codes being written:
[00:38:28] [DOC: 9232165] ℹ️    - Latest_Episode_Firstdiagnosis: 'N31.9'
[00:38:28] [DOC: 9232165] ℹ️    - Latest_Episode_Seconddiagnosis: 'G40.211'
[00:38:28] [DOC: 9232165] ℹ️    - Latest_Episode_Thirddiagnosis: 'G93.1'
[00:38:28] [DOC: 9232165] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F33.2'
[00:38:28] [DOC: 9232165] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z87.820'
[00:38:28] [DOC: 9232165] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.8'
[00:38:28] [DOC: 9232165] ✅ Patient data written to CSV: Richard Bartley | Sex: MALE | Age: 62 | Service: Skilled Nursing | Payer:  | MRN: 3947012
[00:38:28] ✅    ✅ Document 9232165 processed and saved successfully
[00:38:28] 🔄 
🔄 Step 8: Saving API details...
[00:38:28] [DOC: 9232165] ℹ️  API push details saved for document 9232165
[00:38:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232148                         ║
================================================================================
[00:38:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:38:28] ℹ️  Date: 04/10/2025
[00:38:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:38:29] [DOC: 9232148] ✅ Text extracted using pdfplumber (1125 chars)
[00:38:29] ✅    ✅ Text extracted using pdfplumber (1125 chars)
[00:38:29] 🔄 
🔄 Step 2: Extracting patient data...
[00:38:32] ℹ️  AI extracted raw sex value: 'F'
[00:38:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:38:32] ℹ️  AI extracted payer source: ''
[00:38:32] ℹ️  AI extracted diagnoses:
[00:38:32] ℹ️    - Diagnosis 1: ''
[00:38:32] ℹ️    - Diagnosis 2: ''
[00:38:32] ℹ️    - Diagnosis 3: ''
[00:38:32] ℹ️    - Diagnosis 4: ''
[00:38:32] ℹ️    - Diagnosis 5: ''
[00:38:32] ℹ️    - Diagnosis 6: ''
[00:38:32] ℹ️  Final extracted MRN: '2607201'
[00:38:32] ℹ️  Final extracted Sex: 'FEMALE'
[00:38:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:38:32] ℹ️  Final extracted Payer Source: ''
[00:38:32] ✅ Patient data extraction completed successfully
[00:38:32] ✅    ✅ Patient data extracted successfully
[00:38:32] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:38:32] ✅    ✅ Patient identified: Theresa Kamm
[00:38:32] ✅    ✅ Patient name validation passed
[00:38:32] 🔄 
🔄 Step 3: Processing patient dates...
[00:38:32] [DOC: 9232148] ℹ️  DOB normalized: 08/02/1939
[00:38:32] [DOC: 9232148] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[00:38:32] [DOC: 9232148] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[00:38:32] [DOC: 9232148] ✅ Patient date processing completed successfully
[00:38:32] ✅    ✅ Date processing completed
[00:38:32] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:38:32] 🔄 
🔄 Step 4: Extracting order data...
[00:38:34] ℹ️  Order extraction - MRN: '2607201'
[00:38:34] ℹ️  Order extraction - Sex: 'FEMALE'
[00:38:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:38:34] ℹ️  Order extraction - Payer Source: ''
[00:38:34] ✅ Order data extraction completed successfully
[00:38:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:38:34] ℹ️  Using MRN from patient data: '2607201' over '2607201'
[00:38:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:38:34] ✅ Patient name cross-validation successful
[00:38:34] ✅    ✅ Data merged successfully
[00:38:35] ✅    ✅ Order data extracted and validated
[00:38:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:38:38] [DOC: 9232148] ℹ️  Patient not found in cache or API: Theresa Kamm
[00:38:38] [DOC: 9232148] ℹ️  Patient not found, creating new patient via API...
[00:38:38] [DOC: 9232148] ℹ️  Creating patient via API: Theresa Kamm
[00:38:39] [DOC: 9232148] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:38:39] ❌    ❌ Failed to create patient
[00:38:39] [DOC: 9232148] ℹ️  API push details saved for document 9232148
================================================================================
║                        Processing Document ID: 9232141                         ║
================================================================================
[00:38:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:38:39] ℹ️  Date: 04/10/2025
[00:38:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:38:41] [DOC: 9232141] ✅ Text extracted using pdfplumber (997 chars)
[00:38:41] ✅    ✅ Text extracted using pdfplumber (997 chars)
[00:38:41] 🔄 
🔄 Step 2: Extracting patient data...
[00:38:44] ℹ️  AI extracted raw sex value: 'M'
[00:38:44] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:38:44] ℹ️  AI extracted payer source: ''
[00:38:44] ℹ️  AI extracted diagnoses:
[00:38:44] ℹ️    - Diagnosis 1: 'None'
[00:38:44] ℹ️    - Diagnosis 2: 'None'
[00:38:44] ℹ️    - Diagnosis 3: 'None'
[00:38:44] ℹ️    - Diagnosis 4: 'None'
[00:38:44] ℹ️    - Diagnosis 5: 'None'
[00:38:44] ℹ️    - Diagnosis 6: 'None'
[00:38:44] ℹ️  Final extracted MRN: '2447688'
[00:38:44] ℹ️  Final extracted Sex: 'MALE'
[00:38:44] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:38:44] ℹ️  Final extracted Payer Source: ''
[00:38:44] ✅ Patient data extraction completed successfully
[00:38:44] ✅    ✅ Patient data extracted successfully
[00:38:44] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:38:44] ✅    ✅ Patient identified: George England
[00:38:44] ✅    ✅ Patient name validation passed
[00:38:44] 🔄 
🔄 Step 3: Processing patient dates...
[00:38:44] [DOC: 9232141] ℹ️  DOB normalized: 08/26/1924
[00:38:44] [DOC: 9232141] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[00:38:44] [DOC: 9232141] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[00:38:44] [DOC: 9232141] ✅ Patient date processing completed successfully
[00:38:44] ✅    ✅ Date processing completed
[00:38:44] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/10/2025'}]
[00:38:44] 🔄 
🔄 Step 4: Extracting order data...
[00:38:46] ℹ️  Order extraction - MRN: '2447688'
[00:38:46] ℹ️  Order extraction - Sex: 'MALE'
[00:38:46] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:38:46] ℹ️  Order extraction - Payer Source: ''
[00:38:46] ✅ Order data extraction completed successfully
[00:38:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:38:46] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[00:38:46] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:38:46] ✅ Patient name cross-validation successful
[00:38:46] ✅    ✅ Data merged successfully
[00:38:48] ✅    ✅ Order data extracted and validated
[00:38:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:38:48] [DOC: 9232141] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:38:48] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:38:48] 🔄 
🔄 Step 6: Pushing order to API...
[00:38:48] [DOC: 9232141] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:38:49] [DOC: 9232141] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14166"}
[00:38:49] ❌    ❌ Failed to push order
[00:38:49] 🔄 
🔄 Step 7: Writing to CSV...
[00:38:49] [DOC: 9232141] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[00:38:49] [DOC: 9232141] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:38:49] [DOC: 9232141] ℹ️  Payer Source extracted: ''
[00:38:49] [DOC: 9232141] ℹ️  Diagnosis codes being written:
[00:38:49] [DOC: 9232141] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:38:49] [DOC: 9232141] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:38:49] [DOC: 9232141] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:38:49] [DOC: 9232141] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:38:49] [DOC: 9232141] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:38:49] [DOC: 9232141] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:38:49] [DOC: 9232141] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Occupational Therapy | Payer:  | MRN: 2447688
[00:38:49] ✅    ✅ Document 9232141 processed and saved successfully
[00:38:49] 🔄 
🔄 Step 8: Saving API details...
[00:38:49] [DOC: 9232141] ℹ️  API push details saved for document 9232141
[00:38:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231465                         ║
================================================================================
[00:38:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:38:49] ℹ️  Date: 04/09/2025
[00:38:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:38:51] [DOC: 9231465] ✅ Text extracted using pdfplumber (12949 chars)
[00:38:51] ✅    ✅ Text extracted using pdfplumber (12949 chars)
[00:38:51] 🔄 
🔄 Step 2: Extracting patient data...
[00:38:55] ℹ️  AI extracted raw sex value: 'F'
[00:38:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:38:55] ℹ️  AI extracted payer source: 'Medicare'
[00:38:55] ℹ️  AI extracted diagnoses:
[00:38:55] ℹ️    - Diagnosis 1: 'J43.2'
[00:38:55] ℹ️    - Diagnosis 2: 'J18.8'
[00:38:55] ℹ️    - Diagnosis 3: 'J96.21'
[00:38:55] ℹ️    - Diagnosis 4: 'J96.22'
[00:38:55] ℹ️    - Diagnosis 5: 'G93.41'
[00:38:55] ℹ️    - Diagnosis 6: 'I11.0'
[00:38:55] ℹ️  Final extracted MRN: '100994784'
[00:38:55] ℹ️  Final extracted Sex: 'FEMALE'
[00:38:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:38:55] ℹ️  Final extracted Payer Source: 'Medicare'
[00:38:55] ✅ Patient data extraction completed successfully
[00:38:55] ✅    ✅ Patient data extracted successfully
[00:38:55] 📊 Patient Response
     └─ patientFName: Aida
     └─ patientLName: Torres
     └─ dob: 09/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994784
     └─ billingProvider: Dirican, Ahmet MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 62 Adams St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 991-9298
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2022', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'J43.2', 'secondDiagnosis': 'J18.8', 'thirdDiagnosis': 'J96.21', 'fourthDiagnosis': 'J96.22', 'fifthDiagnosis': 'G93.41', 'sixthDiagnosis': 'I11.0'}]
[00:38:55] ✅    ✅ Patient identified: Aida Torres
[00:38:55] ✅    ✅ Patient name validation passed
[00:38:55] 🔄 
🔄 Step 3: Processing patient dates...
[00:38:55] [DOC: 9231465] ℹ️  DOB normalized: 09/03/1947
[00:38:55] [DOC: 9231465] ℹ️  Episode startOfCare normalized: 12/01/2022
[00:38:55] [DOC: 9231465] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[00:38:55] [DOC: 9231465] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[00:38:55] [DOC: 9231465] ✅ Patient date processing completed successfully
[00:38:55] ✅    ✅ Date processing completed
[00:38:55] 📊 Processed Patient Data
     └─ patientFName: Aida
     └─ patientLName: Torres
     └─ dob: 09/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994784
     └─ billingProvider: Dirican, Ahmet MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 62 Adams St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 991-9298
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2022', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'J43.2', 'secondDiagnosis': 'J18.8', 'thirdDiagnosis': 'J96.21', 'fourthDiagnosis': 'J96.22', 'fifthDiagnosis': 'G93.41', 'sixthDiagnosis': 'I11.0'}]
[00:38:55] 🔄 
🔄 Step 4: Extracting order data...
[00:38:57] ℹ️  Order extraction - MRN: '100994784'
[00:38:57] ℹ️  Order extraction - Sex: 'FEMALE'
[00:38:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:38:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:38:57] ✅ Order data extraction completed successfully
[00:38:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:38:57] ℹ️  Using MRN from patient data: '100994784' over '100994784'
[00:38:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:38:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:38:57] ✅ Patient name cross-validation successful
[00:38:57] ✅    ✅ Data merged successfully
[00:38:59] ✅    ✅ Order data extracted and validated
[00:38:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:38:59] [DOC: 9231465] ✅ Patient found in local cache: Aida Torres, ID: fac206fe-c39b-4ab1-b532-654dcc4f3a03
[00:38:59] ✅    ✅ Existing patient found with ID: fac206fe-c39b-4ab1-b532-654dcc4f3a03
[00:38:59] 🔄 
🔄 Step 6: Pushing order to API...
[00:38:59] [DOC: 9231465] ℹ️  Pushing order via API for patient ID: fac206fe-c39b-4ab1-b532-654dcc4f3a03
[00:39:00] [DOC: 9231465] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12914"}
[00:39:00] ❌    ❌ Failed to push order
[00:39:00] 🔄 
🔄 Step 7: Writing to CSV...
[00:39:00] [DOC: 9231465] ℹ️  Calculated age: 77 from DOB: 09/03/1947
[00:39:00] [DOC: 9231465] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:39:00] [DOC: 9231465] ℹ️  Payer Source extracted: 'Medicare'
[00:39:00] [DOC: 9231465] ℹ️  Diagnosis codes being written:
[00:39:00] [DOC: 9231465] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.2'
[00:39:00] [DOC: 9231465] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.8'
[00:39:00] [DOC: 9231465] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.21'
[00:39:00] [DOC: 9231465] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.22'
[00:39:00] [DOC: 9231465] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G93.41'
[00:39:00] [DOC: 9231465] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[00:39:00] [DOC: 9231465] ✅ Patient data written to CSV: Aida Torres | Sex: FEMALE | Age: 77 | Service: Skilled Nursing | Payer: Medicare | MRN: 100994784
[00:39:00] ✅    ✅ Document 9231465 processed and saved successfully
[00:39:00] 🔄 
🔄 Step 8: Saving API details...
[00:39:00] [DOC: 9231465] ℹ️  API push details saved for document 9231465
[00:39:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231462                         ║
================================================================================
[00:39:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:39:00] ℹ️  Date: 04/09/2025
[00:39:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:39:03] [DOC: 9231462] ✅ Text extracted using pdfplumber (1527 chars)
[00:39:03] ✅    ✅ Text extracted using pdfplumber (1527 chars)
[00:39:03] 🔄 
🔄 Step 2: Extracting patient data...
[00:39:06] ℹ️  AI extracted raw sex value: ''
[00:39:06] ℹ️  AI extracted service line: 'Physical Therapy'
[00:39:06] ℹ️  AI extracted payer source: ''
[00:39:06] ℹ️  AI extracted diagnoses:
[00:39:06] ℹ️    - Diagnosis 1: 'G20.A1'
[00:39:06] ℹ️    - Diagnosis 2: 'I11.9'
[00:39:06] ℹ️    - Diagnosis 3: 'E11.40'
[00:39:06] ℹ️    - Diagnosis 4: 'None'
[00:39:06] ℹ️    - Diagnosis 5: 'None'
[00:39:06] ℹ️    - Diagnosis 6: 'None'
[00:39:06] ℹ️  Final extracted MRN: 'MA241007025405'
[00:39:06] ℹ️  Final extracted Sex: ''
[00:39:06] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:39:06] ℹ️  Final extracted Payer Source: ''
[00:39:06] ✅ Patient data extraction completed successfully
[00:39:06] ✅    ✅ Patient data extracted successfully
[00:39:06] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:39:06] ✅    ✅ Patient identified: Gordonna Walker
[00:39:06] ✅    ✅ Patient name validation passed
[00:39:06] 🔄 
🔄 Step 3: Processing patient dates...
[00:39:06] [DOC: 9231462] ℹ️  DOB normalized: 02/21/1954
[00:39:06] [DOC: 9231462] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[00:39:06] [DOC: 9231462] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[00:39:06] [DOC: 9231462] ✅ Patient date processing completed successfully
[00:39:06] ✅    ✅ Date processing completed
[00:39:06] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40'}]
[00:39:06] 🔄 
🔄 Step 4: Extracting order data...
[00:39:08] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:39:08] ℹ️  Order extraction - Sex: ''
[00:39:08] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:39:08] ℹ️  Order extraction - Payer Source: ''
[00:39:08] ✅ Order data extraction completed successfully
[00:39:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:39:08] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:39:08] ⚠️  Could not determine sex using any available method
[00:39:08] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:39:08] ✅ Patient name cross-validation successful
[00:39:08] ✅    ✅ Data merged successfully
[00:39:09] ✅    ✅ Order data extracted and validated
[00:39:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:39:09] [DOC: 9231462] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:09] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:09] 🔄 
🔄 Step 6: Pushing order to API...
[00:39:09] [DOC: 9231462] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:10] [DOC: 9231462] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14405"}
[00:39:10] ❌    ❌ Failed to push order
[00:39:10] 🔄 
🔄 Step 7: Writing to CSV...
[00:39:10] [DOC: 9231462] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:39:10] [DOC: 9231462] ℹ️  Service Line extracted: 'Physical Therapy'
[00:39:10] [DOC: 9231462] ℹ️  Payer Source extracted: ''
[00:39:10] [DOC: 9231462] ℹ️  Diagnosis codes being written:
[00:39:10] [DOC: 9231462] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[00:39:10] [DOC: 9231462] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[00:39:10] [DOC: 9231462] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[00:39:10] [DOC: 9231462] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:39:10] [DOC: 9231462] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:39:10] [DOC: 9231462] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:39:10] [DOC: 9231462] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Physical Therapy | Payer:  | MRN: MA241007025405
[00:39:10] ✅    ✅ Document 9231462 processed and saved successfully
[00:39:10] 🔄 
🔄 Step 8: Saving API details...
[00:39:10] [DOC: 9231462] ℹ️  API push details saved for document 9231462
[00:39:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231461                         ║
================================================================================
[00:39:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:39:10] ℹ️  Date: 04/09/2025
[00:39:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:39:16] [DOC: 9231461] ✅ Text extracted using pdfplumber (18825 chars)
[00:39:16] ✅    ✅ Text extracted using pdfplumber (18825 chars)
[00:39:16] 🔄 
🔄 Step 2: Extracting patient data...
[00:39:19] ℹ️  AI extracted raw sex value: 'F'
[00:39:19] ℹ️  AI extracted service line: 'PT'
[00:39:19] ℹ️  AI extracted payer source: ''
[00:39:19] ℹ️  AI extracted diagnoses:
[00:39:19] ℹ️    - Diagnosis 1: 'G20'
[00:39:19] ℹ️    - Diagnosis 2: 'R21'
[00:39:19] ℹ️    - Diagnosis 3: 'I25.10'
[00:39:19] ℹ️    - Diagnosis 4: 'J44.1'
[00:39:19] ℹ️    - Diagnosis 5: 'E11.9'
[00:39:19] ℹ️    - Diagnosis 6: 'G47.31'
[00:39:19] ℹ️  Final extracted MRN: 'MA241007025405'
[00:39:19] ℹ️  Final extracted Sex: 'FEMALE'
[00:39:19] ℹ️  Final extracted Service Line: 'PT'
[00:39:19] ℹ️  Final extracted Payer Source: ''
[00:39:19] ✅ Patient data extraction completed successfully
[00:39:19] ✅    ✅ Patient data extracted successfully
[00:39:19] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'G20', 'secondDiagnosis': 'R21', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'G47.31'}]
[00:39:19] ✅    ✅ Patient identified: Gordonna Walker
[00:39:19] ✅    ✅ Patient name validation passed
[00:39:19] 🔄 
🔄 Step 3: Processing patient dates...
[00:39:19] [DOC: 9231461] ℹ️  DOB normalized: 02/21/1954
[00:39:19] [DOC: 9231461] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[00:39:19] [DOC: 9231461] ✅ Patient date processing completed successfully
[00:39:19] ✅    ✅ Date processing completed
[00:39:19] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'G20', 'secondDiagnosis': 'R21', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'J44.1', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'G47.31'}]
[00:39:19] 🔄 
🔄 Step 4: Extracting order data...
[00:39:22] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:39:22] ℹ️  Order extraction - Sex: 'FEMALE'
[00:39:22] ℹ️  Order extraction - Service Line: 'PT'
[00:39:22] ℹ️  Order extraction - Payer Source: ''
[00:39:22] ✅ Order data extraction completed successfully
[00:39:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:39:22] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:39:22] ℹ️  Service line consistent in both sources: 'PT'
[00:39:22] ✅ Patient name cross-validation successful
[00:39:22] ✅    ✅ Data merged successfully
[00:39:23] ✅    ✅ Order data extracted and validated
[00:39:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:39:23] [DOC: 9231461] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:23] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:23] 🔄 
🔄 Step 6: Pushing order to API...
[00:39:23] [DOC: 9231461] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:24] [DOC: 9231461] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:39:24] ❌    ❌ Failed to push order
[00:39:24] 🔄 
🔄 Step 7: Writing to CSV...
[00:39:24] [DOC: 9231461] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:39:24] [DOC: 9231461] ℹ️  Service Line extracted: 'PT'
[00:39:24] [DOC: 9231461] ℹ️  Payer Source extracted: ''
[00:39:24] [DOC: 9231461] ℹ️  Diagnosis codes being written:
[00:39:24] [DOC: 9231461] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20'
[00:39:24] [DOC: 9231461] ℹ️    - Latest_Episode_Seconddiagnosis: 'R21'
[00:39:24] [DOC: 9231461] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[00:39:24] [DOC: 9231461] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.1'
[00:39:24] [DOC: 9231461] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.9'
[00:39:24] [DOC: 9231461] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.31'
[00:39:24] [DOC: 9231461] ✅ Patient data written to CSV: Gordonna Walker | Sex: FEMALE | Age: 71 | Service: PT | Payer:  | MRN: MA241007025405
[00:39:24] ✅    ✅ Document 9231461 processed and saved successfully
[00:39:24] 🔄 
🔄 Step 8: Saving API details...
[00:39:24] [DOC: 9231461] ℹ️  API push details saved for document 9231461
[00:39:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231458                         ║
================================================================================
[00:39:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:39:24] ℹ️  Date: 04/09/2025
[00:39:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:39:27] [DOC: 9231458] ✅ Text extracted using pdfplumber (1388 chars)
[00:39:27] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[00:39:27] 🔄 
🔄 Step 2: Extracting patient data...
[00:39:30] ℹ️  AI extracted raw sex value: ''
[00:39:30] ℹ️  AI extracted service line: 'Physical Therapy'
[00:39:30] ℹ️  AI extracted payer source: ''
[00:39:30] ℹ️  AI extracted diagnoses:
[00:39:30] ℹ️    - Diagnosis 1: 'G20.A1'
[00:39:30] ℹ️    - Diagnosis 2: 'I11.9'
[00:39:30] ℹ️    - Diagnosis 3: 'E11.40'
[00:39:30] ℹ️    - Diagnosis 4: 'None'
[00:39:30] ℹ️    - Diagnosis 5: 'None'
[00:39:30] ℹ️    - Diagnosis 6: 'None'
[00:39:30] ℹ️  Final extracted MRN: 'MA241007025405'
[00:39:30] ℹ️  Final extracted Sex: ''
[00:39:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:39:30] ℹ️  Final extracted Payer Source: ''
[00:39:30] ✅ Patient data extraction completed successfully
[00:39:30] ✅    ✅ Patient data extracted successfully
[00:39:30] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:39:30] ✅    ✅ Patient identified: Gordonna Walker
[00:39:30] ✅    ✅ Patient name validation passed
[00:39:30] 🔄 
🔄 Step 3: Processing patient dates...
[00:39:30] [DOC: 9231458] ℹ️  DOB normalized: 02/21/1954
[00:39:30] [DOC: 9231458] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[00:39:30] [DOC: 9231458] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[00:39:30] [DOC: 9231458] ✅ Patient date processing completed successfully
[00:39:30] ✅    ✅ Date processing completed
[00:39:30] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40'}]
[00:39:30] 🔄 
🔄 Step 4: Extracting order data...
[00:39:33] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:39:33] ℹ️  Order extraction - Sex: ''
[00:39:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:39:33] ℹ️  Order extraction - Payer Source: ''
[00:39:33] ✅ Order data extraction completed successfully
[00:39:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:39:33] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:39:33] ⚠️  Could not determine sex using any available method
[00:39:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:39:33] ✅ Patient name cross-validation successful
[00:39:33] ✅    ✅ Data merged successfully
[00:39:34] ✅    ✅ Order data extracted and validated
[00:39:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:39:34] [DOC: 9231458] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:34] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:34] 🔄 
🔄 Step 6: Pushing order to API...
[00:39:34] [DOC: 9231458] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:35] [DOC: 9231458] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14407"}
[00:39:35] ❌    ❌ Failed to push order
[00:39:35] 🔄 
🔄 Step 7: Writing to CSV...
[00:39:35] [DOC: 9231458] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:39:35] [DOC: 9231458] ℹ️  Service Line extracted: 'Physical Therapy'
[00:39:35] [DOC: 9231458] ℹ️  Payer Source extracted: ''
[00:39:35] [DOC: 9231458] ℹ️  Diagnosis codes being written:
[00:39:35] [DOC: 9231458] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[00:39:35] [DOC: 9231458] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[00:39:35] [DOC: 9231458] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[00:39:35] [DOC: 9231458] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:39:35] [DOC: 9231458] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:39:35] [DOC: 9231458] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:39:35] [DOC: 9231458] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Physical Therapy | Payer:  | MRN: MA241007025405
[00:39:35] ✅    ✅ Document 9231458 processed and saved successfully
[00:39:35] 🔄 
🔄 Step 8: Saving API details...
[00:39:35] [DOC: 9231458] ℹ️  API push details saved for document 9231458
[00:39:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231456                         ║
================================================================================
[00:39:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:39:35] ℹ️  Date: 04/09/2025
[00:39:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:39:38] [DOC: 9231456] ✅ Text extracted using pdfplumber (1490 chars)
[00:39:38] ✅    ✅ Text extracted using pdfplumber (1490 chars)
[00:39:38] 🔄 
🔄 Step 2: Extracting patient data...
[00:39:40] ℹ️  AI extracted raw sex value: ''
[00:39:40] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:39:40] ℹ️  AI extracted payer source: ''
[00:39:40] ℹ️  AI extracted diagnoses:
[00:39:40] ℹ️    - Diagnosis 1: 'G20.A1'
[00:39:40] ℹ️    - Diagnosis 2: 'I11.9'
[00:39:40] ℹ️    - Diagnosis 3: 'E11.40'
[00:39:40] ℹ️    - Diagnosis 4: 'None'
[00:39:40] ℹ️    - Diagnosis 5: 'None'
[00:39:40] ℹ️    - Diagnosis 6: 'None'
[00:39:40] ℹ️  Final extracted MRN: 'MA241007025405'
[00:39:40] ℹ️  Final extracted Sex: ''
[00:39:40] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:39:40] ℹ️  Final extracted Payer Source: ''
[00:39:40] ✅ Patient data extraction completed successfully
[00:39:40] ✅    ✅ Patient data extracted successfully
[00:39:40] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:39:40] ✅    ✅ Patient identified: Gordonna Walker
[00:39:40] ✅    ✅ Patient name validation passed
[00:39:40] 🔄 
🔄 Step 3: Processing patient dates...
[00:39:40] [DOC: 9231456] ℹ️  DOB normalized: 02/21/1954
[00:39:40] [DOC: 9231456] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[00:39:40] [DOC: 9231456] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[00:39:40] [DOC: 9231456] ✅ Patient date processing completed successfully
[00:39:40] ✅    ✅ Date processing completed
[00:39:40] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40'}]
[00:39:40] 🔄 
🔄 Step 4: Extracting order data...
[00:39:43] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:39:43] ℹ️  Order extraction - Sex: ''
[00:39:43] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:39:43] ℹ️  Order extraction - Payer Source: ''
[00:39:43] ✅ Order data extraction completed successfully
[00:39:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:39:43] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:39:43] ⚠️  Could not determine sex using any available method
[00:39:43] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:39:43] ✅ Patient name cross-validation successful
[00:39:43] ✅    ✅ Data merged successfully
[00:39:45] ✅    ✅ Order data extracted and validated
[00:39:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:39:45] [DOC: 9231456] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:45] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:45] 🔄 
🔄 Step 6: Pushing order to API...
[00:39:45] [DOC: 9231456] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:46] [DOC: 9231456] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14409"}
[00:39:46] ❌    ❌ Failed to push order
[00:39:46] 🔄 
🔄 Step 7: Writing to CSV...
[00:39:46] [DOC: 9231456] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:39:46] [DOC: 9231456] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:39:46] [DOC: 9231456] ℹ️  Payer Source extracted: ''
[00:39:46] [DOC: 9231456] ℹ️  Diagnosis codes being written:
[00:39:46] [DOC: 9231456] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[00:39:46] [DOC: 9231456] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[00:39:46] [DOC: 9231456] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[00:39:46] [DOC: 9231456] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:39:46] [DOC: 9231456] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:39:46] [DOC: 9231456] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:39:46] [DOC: 9231456] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Occupational Therapy | Payer:  | MRN: MA241007025405
[00:39:46] ✅    ✅ Document 9231456 processed and saved successfully
[00:39:46] 🔄 
🔄 Step 8: Saving API details...
[00:39:46] [DOC: 9231456] ℹ️  API push details saved for document 9231456
[00:39:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231449                         ║
================================================================================
[00:39:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:39:46] ℹ️  Date: 04/09/2025
[00:39:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:39:49] [DOC: 9231449] ✅ Text extracted using pdfplumber (1438 chars)
[00:39:49] ✅    ✅ Text extracted using pdfplumber (1438 chars)
[00:39:49] 🔄 
🔄 Step 2: Extracting patient data...
[00:39:51] ℹ️  AI extracted raw sex value: ''
[00:39:51] ℹ️  AI extracted service line: 'HHA'
[00:39:51] ℹ️  AI extracted payer source: ''
[00:39:51] ℹ️  AI extracted diagnoses:
[00:39:51] ℹ️    - Diagnosis 1: 'G20.A1'
[00:39:51] ℹ️    - Diagnosis 2: 'I11.9'
[00:39:51] ℹ️    - Diagnosis 3: 'E11.40'
[00:39:51] ℹ️    - Diagnosis 4: 'None'
[00:39:51] ℹ️    - Diagnosis 5: 'None'
[00:39:51] ℹ️    - Diagnosis 6: 'None'
[00:39:51] ℹ️  Final extracted MRN: 'MA241007025405'
[00:39:51] ℹ️  Final extracted Sex: ''
[00:39:51] ℹ️  Final extracted Service Line: 'HHA'
[00:39:51] ℹ️  Final extracted Payer Source: ''
[00:39:51] ✅ Patient data extraction completed successfully
[00:39:51] ✅    ✅ Patient data extracted successfully
[00:39:51] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:39:51] ✅    ✅ Patient identified: Gordonna Walker
[00:39:51] ✅    ✅ Patient name validation passed
[00:39:51] 🔄 
🔄 Step 3: Processing patient dates...
[00:39:51] [DOC: 9231449] ℹ️  DOB normalized: 02/21/1954
[00:39:51] [DOC: 9231449] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[00:39:51] [DOC: 9231449] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[00:39:51] [DOC: 9231449] ✅ Patient date processing completed successfully
[00:39:51] ✅    ✅ Date processing completed
[00:39:51] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40'}]
[00:39:51] 🔄 
🔄 Step 4: Extracting order data...
[00:39:54] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:39:54] ℹ️  Order extraction - Sex: ''
[00:39:54] ℹ️  Order extraction - Service Line: 'HHA'
[00:39:54] ℹ️  Order extraction - Payer Source: ''
[00:39:54] ✅ Order data extraction completed successfully
[00:39:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:39:54] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:39:54] ⚠️  Could not determine sex using any available method
[00:39:54] ℹ️  Service line consistent in both sources: 'HHA'
[00:39:54] ✅ Patient name cross-validation successful
[00:39:54] ✅    ✅ Data merged successfully
[00:39:55] ✅    ✅ Order data extracted and validated
[00:39:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:39:55] [DOC: 9231449] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:55] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:55] 🔄 
🔄 Step 6: Pushing order to API...
[00:39:55] [DOC: 9231449] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:39:57] [DOC: 9231449] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14411"}
[00:39:57] ❌    ❌ Failed to push order
[00:39:57] 🔄 
🔄 Step 7: Writing to CSV...
[00:39:57] [DOC: 9231449] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:39:57] [DOC: 9231449] ℹ️  Service Line extracted: 'HHA'
[00:39:57] [DOC: 9231449] ℹ️  Payer Source extracted: ''
[00:39:57] [DOC: 9231449] ℹ️  Diagnosis codes being written:
[00:39:57] [DOC: 9231449] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[00:39:57] [DOC: 9231449] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[00:39:57] [DOC: 9231449] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[00:39:57] [DOC: 9231449] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:39:57] [DOC: 9231449] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:39:57] [DOC: 9231449] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:39:57] [DOC: 9231449] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: HHA | Payer:  | MRN: MA241007025405
[00:39:57] ✅    ✅ Document 9231449 processed and saved successfully
[00:39:57] 🔄 
🔄 Step 8: Saving API details...
[00:39:57] [DOC: 9231449] ℹ️  API push details saved for document 9231449
[00:39:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231445                         ║
================================================================================
[00:39:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:39:57] ℹ️  Date: 04/09/2025
[00:39:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:40:07] [DOC: 9231445] ✅ Text extracted using pdfplumber (13050 chars)
[00:40:07] ✅    ✅ Text extracted using pdfplumber (13050 chars)
[00:40:07] 🔄 
🔄 Step 2: Extracting patient data...
[00:40:09] ℹ️  AI extracted raw sex value: ''
[00:40:09] ℹ️  AI extracted service line: 'OT'
[00:40:09] ℹ️  AI extracted payer source: ''
[00:40:09] ℹ️  AI extracted diagnoses:
[00:40:09] ℹ️    - Diagnosis 1: ''
[00:40:09] ℹ️    - Diagnosis 2: ''
[00:40:09] ℹ️    - Diagnosis 3: ''
[00:40:09] ℹ️    - Diagnosis 4: ''
[00:40:09] ℹ️    - Diagnosis 5: ''
[00:40:09] ℹ️    - Diagnosis 6: ''
[00:40:09] ℹ️  Final extracted MRN: 'MA241007025405'
[00:40:09] ℹ️  Final extracted Sex: ''
[00:40:09] ℹ️  Final extracted Service Line: 'OT'
[00:40:09] ℹ️  Final extracted Payer Source: ''
[00:40:09] ✅ Patient data extraction completed successfully
[00:40:09] ✅    ✅ Patient data extracted successfully
[00:40:09] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:40:09] ✅    ✅ Patient identified: Gordonna Walker
[00:40:09] ✅    ✅ Patient name validation passed
[00:40:09] 🔄 
🔄 Step 3: Processing patient dates...
[00:40:09] [DOC: 9231445] ℹ️  DOB normalized: 02/21/1954
[00:40:09] [DOC: 9231445] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[00:40:09] [DOC: 9231445] ✅ Patient date processing completed successfully
[00:40:09] ✅    ✅ Date processing completed
[00:40:09] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:40:09] 🔄 
🔄 Step 4: Extracting order data...
[00:40:12] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:40:12] ℹ️  Order extraction - Sex: ''
[00:40:12] ℹ️  Order extraction - Service Line: 'OT'
[00:40:12] ℹ️  Order extraction - Payer Source: ''
[00:40:12] ✅ Order data extraction completed successfully
[00:40:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:40:12] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:40:12] ⚠️  Could not determine sex using any available method
[00:40:12] ℹ️  Service line consistent in both sources: 'OT'
[00:40:12] ✅ Patient name cross-validation successful
[00:40:12] ✅    ✅ Data merged successfully
[00:40:14] ✅    ✅ Order data extracted and validated
[00:40:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:40:14] [DOC: 9231445] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:40:14] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:40:14] 🔄 
🔄 Step 6: Pushing order to API...
[00:40:14] [DOC: 9231445] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:40:15] [DOC: 9231445] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:40:15] ❌    ❌ Failed to push order
[00:40:15] 🔄 
🔄 Step 7: Writing to CSV...
[00:40:15] [DOC: 9231445] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:40:15] [DOC: 9231445] ℹ️  Service Line extracted: 'OT'
[00:40:15] [DOC: 9231445] ℹ️  Payer Source extracted: ''
[00:40:15] [DOC: 9231445] ℹ️  Diagnosis codes being written:
[00:40:15] [DOC: 9231445] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:40:15] [DOC: 9231445] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:40:15] [DOC: 9231445] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:40:15] [DOC: 9231445] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:40:15] [DOC: 9231445] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:40:15] [DOC: 9231445] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:40:15] [DOC: 9231445] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: OT | Payer:  | MRN: MA241007025405
[00:40:15] ✅    ✅ Document 9231445 processed and saved successfully
[00:40:15] 🔄 
🔄 Step 8: Saving API details...
[00:40:15] [DOC: 9231445] ℹ️  API push details saved for document 9231445
[00:40:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231442                         ║
================================================================================
[00:40:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:40:15] ℹ️  Date: 04/09/2025
[00:40:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:40:17] [DOC: 9231442] ✅ Text extracted using pdfplumber (1233 chars)
[00:40:17] ✅    ✅ Text extracted using pdfplumber (1233 chars)
[00:40:17] 🔄 
🔄 Step 2: Extracting patient data...
[00:40:20] ℹ️  AI extracted raw sex value: ''
[00:40:20] ℹ️  AI extracted service line: ''
[00:40:20] ℹ️  AI extracted payer source: ''
[00:40:20] ℹ️  AI extracted diagnoses:
[00:40:20] ℹ️    - Diagnosis 1: 'G20.A1'
[00:40:20] ℹ️    - Diagnosis 2: 'I11.9'
[00:40:20] ℹ️    - Diagnosis 3: 'E11.40'
[00:40:20] ℹ️    - Diagnosis 4: ''
[00:40:20] ℹ️    - Diagnosis 5: ''
[00:40:20] ℹ️    - Diagnosis 6: ''
[00:40:20] ℹ️  Final extracted MRN: 'MA241007025405'
[00:40:20] ℹ️  Final extracted Sex: ''
[00:40:20] ℹ️  Final extracted Service Line: ''
[00:40:20] ℹ️  Final extracted Payer Source: ''
[00:40:20] ✅ Patient data extraction completed successfully
[00:40:20] ✅    ✅ Patient data extracted successfully
[00:40:20] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:40:20] ✅    ✅ Patient identified: Gordonna Walker
[00:40:20] ✅    ✅ Patient name validation passed
[00:40:20] 🔄 
🔄 Step 3: Processing patient dates...
[00:40:20] [DOC: 9231442] ℹ️  DOB normalized: 02/21/1954
[00:40:20] [DOC: 9231442] ℹ️  Episode startOfCare normalized: 03/24/2025
[00:40:20] [DOC: 9231442] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[00:40:20] [DOC: 9231442] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[00:40:20] [DOC: 9231442] ✅ Patient date processing completed successfully
[00:40:20] ✅    ✅ Date processing completed
[00:40:20] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:40:20] 🔄 
🔄 Step 4: Extracting order data...
[00:40:23] ℹ️  Order extraction - MRN: 'MA241007025405'
[00:40:23] ℹ️  Order extraction - Sex: ''
[00:40:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:40:23] ℹ️  Order extraction - Payer Source: ''
[00:40:23] ✅ Order data extraction completed successfully
[00:40:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:40:23] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[00:40:23] ⚠️  Could not determine sex using any available method
[00:40:23] ℹ️  Using service line from order data: 'Skilled Nursing'
[00:40:23] ✅ Patient name cross-validation successful
[00:40:23] ✅    ✅ Data merged successfully
[00:40:24] ✅    ✅ Order data extracted and validated
[00:40:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:40:24] [DOC: 9231442] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:40:24] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:40:24] 🔄 
🔄 Step 6: Pushing order to API...
[00:40:24] [DOC: 9231442] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[00:40:25] [DOC: 9231442] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14412"}
[00:40:25] ❌    ❌ Failed to push order
[00:40:25] 🔄 
🔄 Step 7: Writing to CSV...
[00:40:25] [DOC: 9231442] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[00:40:25] [DOC: 9231442] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:40:25] [DOC: 9231442] ℹ️  Payer Source extracted: ''
[00:40:25] [DOC: 9231442] ℹ️  Diagnosis codes being written:
[00:40:25] [DOC: 9231442] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[00:40:25] [DOC: 9231442] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[00:40:25] [DOC: 9231442] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[00:40:25] [DOC: 9231442] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:40:25] [DOC: 9231442] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:40:25] [DOC: 9231442] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:40:25] [DOC: 9231442] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Skilled Nursing | Payer:  | MRN: MA241007025405
[00:40:25] ✅    ✅ Document 9231442 processed and saved successfully
[00:40:25] 🔄 
🔄 Step 8: Saving API details...
[00:40:25] [DOC: 9231442] ℹ️  API push details saved for document 9231442
[00:40:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230328                         ║
================================================================================
[00:40:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:40:25] ℹ️  Date: 04/09/2025
[00:40:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:40:28] [DOC: 9230328] ✅ Text extracted using pdfplumber (11217 chars)
[00:40:28] ✅    ✅ Text extracted using pdfplumber (11205 chars)
[00:40:28] 🔄 
🔄 Step 2: Extracting patient data...
[00:40:31] ℹ️  AI extracted raw sex value: 'M'
[00:40:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:40:31] ℹ️  AI extracted payer source: 'Medicare'
[00:40:31] ℹ️  AI extracted diagnoses:
[00:40:31] ℹ️    - Diagnosis 1: 'F20.9'
[00:40:31] ℹ️    - Diagnosis 2: 'E11.69'
[00:40:31] ℹ️    - Diagnosis 3: 'I10'
[00:40:31] ℹ️    - Diagnosis 4: 'I48.0'
[00:40:31] ℹ️    - Diagnosis 5: 'None'
[00:40:31] ℹ️    - Diagnosis 6: 'None'
[00:40:31] ℹ️  Final extracted MRN: 'MA210924045601'
[00:40:31] ℹ️  Final extracted Sex: 'MALE'
[00:40:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:40:31] ℹ️  Final extracted Payer Source: 'Medicare'
[00:40:31] ✅ Patient data extraction completed successfully
[00:40:31] ✅    ✅ Patient data extracted successfully
[00:40:31] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:40:31] ✅    ✅ Patient identified: Richard Rocheleau
[00:40:31] ✅    ✅ Patient name validation passed
[00:40:31] 🔄 
🔄 Step 3: Processing patient dates...
[00:40:31] [DOC: 9230328] ℹ️  DOB normalized: 04/08/1956
[00:40:31] [DOC: 9230328] ℹ️  Episode startOfCare normalized: 05/29/2024
[00:40:31] [DOC: 9230328] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[00:40:31] [DOC: 9230328] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[00:40:31] [DOC: 9230328] ✅ Patient date processing completed successfully
[00:40:31] ✅    ✅ Date processing completed
[00:40:31] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Rocheleau
     └─ dob: 04/08/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA210924045601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'E11.69', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.0'}]
[00:40:31] 🔄 
🔄 Step 4: Extracting order data...
[00:40:34] ℹ️  Order extraction - MRN: 'MA210924045601'
[00:40:34] ℹ️  Order extraction - Sex: 'MALE'
[00:40:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:40:34] ℹ️  Order extraction - Payer Source: ''
[00:40:34] ✅ Order data extraction completed successfully
[00:40:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:40:34] ℹ️  Using MRN from patient data: 'MA210924045601' over 'MA210924045601'
[00:40:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:40:34] ℹ️  Using payer source from patient data: 'Medicare'
[00:40:34] ✅ Patient name cross-validation successful
[00:40:34] ✅    ✅ Data merged successfully
[00:40:35] ✅    ✅ Order data extracted and validated
[00:40:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:40:35] [DOC: 9230328] ✅ Patient found in local cache: Richard Rocheleau, ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[00:40:35] ✅    ✅ Existing patient found with ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[00:40:35] 🔄 
🔄 Step 6: Pushing order to API...
[00:40:35] [DOC: 9230328] ℹ️  Pushing order via API for patient ID: 6e19c485-fd72-4483-a5b5-178db0e84a0a
[00:40:37] [DOC: 9230328] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14265"}
[00:40:37] ❌    ❌ Failed to push order
[00:40:37] 🔄 
🔄 Step 7: Writing to CSV...
[00:40:37] [DOC: 9230328] ℹ️  Calculated age: 69 from DOB: 04/08/1956
[00:40:37] [DOC: 9230328] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:40:37] [DOC: 9230328] ℹ️  Payer Source extracted: 'Medicare'
[00:40:37] [DOC: 9230328] ℹ️  Diagnosis codes being written:
[00:40:37] [DOC: 9230328] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.9'
[00:40:37] [DOC: 9230328] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.69'
[00:40:37] [DOC: 9230328] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:40:37] [DOC: 9230328] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[00:40:37] [DOC: 9230328] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:40:37] [DOC: 9230328] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:40:37] [DOC: 9230328] ✅ Patient data written to CSV: Richard Rocheleau | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer: Medicare | MRN: MA210924045601
[00:40:37] ✅    ✅ Document 9230328 processed and saved successfully
[00:40:37] 🔄 
🔄 Step 8: Saving API details...
[00:40:37] [DOC: 9230328] ℹ️  API push details saved for document 9230328
[00:40:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230322                         ║
================================================================================
[00:40:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:40:37] ℹ️  Date: 04/09/2025
[00:40:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:40:39] [DOC: 9230322] ✅ Text extracted using pdfplumber (1367 chars)
[00:40:39] ✅    ✅ Text extracted using pdfplumber (1367 chars)
[00:40:39] 🔄 
🔄 Step 2: Extracting patient data...
[00:40:42] ℹ️  AI extracted raw sex value: ''
[00:40:42] ℹ️  AI extracted service line: 'Physical Therapy'
[00:40:42] ℹ️  AI extracted payer source: ''
[00:40:42] ℹ️  AI extracted diagnoses:
[00:40:42] ℹ️    - Diagnosis 1: 'S81.801'
[00:40:42] ℹ️    - Diagnosis 2: 'E11.51'
[00:40:42] ℹ️    - Diagnosis 3: 'I70.209'
[00:40:42] ℹ️    - Diagnosis 4: 'None'
[00:40:42] ℹ️    - Diagnosis 5: 'None'
[00:40:42] ℹ️    - Diagnosis 6: 'None'
[00:40:42] ℹ️  Final extracted MRN: 'MA200528053701'
[00:40:42] ℹ️  Final extracted Sex: ''
[00:40:42] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:40:42] ℹ️  Final extracted Payer Source: ''
[00:40:42] ✅ Patient data extraction completed successfully
[00:40:42] ✅    ✅ Patient data extracted successfully
[00:40:42] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:40:42] ✅    ✅ Patient identified: Roderick Lopez
[00:40:42] ✅    ✅ Patient name validation passed
[00:40:42] 🔄 
🔄 Step 3: Processing patient dates...
[00:40:42] [DOC: 9230322] ℹ️  DOB normalized: 05/21/1937
[00:40:42] [DOC: 9230322] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[00:40:42] [DOC: 9230322] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[00:40:42] [DOC: 9230322] ✅ Patient date processing completed successfully
[00:40:42] ✅    ✅ Date processing completed
[00:40:42] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'S81.801', 'secondDiagnosis': 'E11.51', 'thirdDiagnosis': 'I70.209'}]
[00:40:42] 🔄 
🔄 Step 4: Extracting order data...
[00:40:44] ℹ️  Order extraction - MRN: 'MA200528053701'
[00:40:44] ℹ️  Order extraction - Sex: ''
[00:40:44] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:40:44] ℹ️  Order extraction - Payer Source: ''
[00:40:44] ✅ Order data extraction completed successfully
[00:40:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:40:44] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[00:40:44] ℹ️  Inferred sex as MALE from name: Roderick
[00:40:44] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:40:44] ✅ Patient name cross-validation successful
[00:40:44] ✅    ✅ Data merged successfully
[00:40:46] ✅    ✅ Order data extracted and validated
[00:40:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:40:46] [DOC: 9230322] ✅ Patient found in local cache: Roderick Lopez, ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:40:46] ✅    ✅ Existing patient found with ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:40:46] 🔄 
🔄 Step 6: Pushing order to API...
[00:40:46] [DOC: 9230322] ℹ️  Pushing order via API for patient ID: 99519ddc-34a7-4d13-b004-5e80b39c9be1
[00:40:47] [DOC: 9230322] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13965"}
[00:40:47] ❌    ❌ Failed to push order
[00:40:47] 🔄 
🔄 Step 7: Writing to CSV...
[00:40:47] [DOC: 9230322] ℹ️  Calculated age: 88 from DOB: 05/21/1937
[00:40:47] [DOC: 9230322] ℹ️  Service Line extracted: 'Physical Therapy'
[00:40:47] [DOC: 9230322] ℹ️  Payer Source extracted: ''
[00:40:47] [DOC: 9230322] ℹ️  Diagnosis codes being written:
[00:40:47] [DOC: 9230322] ℹ️    - Latest_Episode_Firstdiagnosis: 'S81.801'
[00:40:47] [DOC: 9230322] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.51'
[00:40:47] [DOC: 9230322] ℹ️    - Latest_Episode_Thirddiagnosis: 'I70.209'
[00:40:47] [DOC: 9230322] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:40:47] [DOC: 9230322] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:40:47] [DOC: 9230322] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:40:47] [DOC: 9230322] ✅ Patient data written to CSV: Roderick Lopez | Sex: MALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA200528053701
[00:40:47] ✅    ✅ Document 9230322 processed and saved successfully
[00:40:47] 🔄 
🔄 Step 8: Saving API details...
[00:40:47] [DOC: 9230322] ℹ️  API push details saved for document 9230322
[00:40:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230316                         ║
================================================================================
[00:40:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:40:47] ℹ️  Date: 04/09/2025
[00:40:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:40:50] [DOC: 9230316] ✅ Text extracted using pdfplumber (1332 chars)
[00:40:50] ✅    ✅ Text extracted using pdfplumber (1332 chars)
[00:40:50] 🔄 
🔄 Step 2: Extracting patient data...
[00:40:53] ℹ️  AI extracted raw sex value: ''
[00:40:53] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:40:53] ℹ️  AI extracted payer source: ''
[00:40:53] ℹ️  AI extracted diagnoses:
[00:40:53] ℹ️    - Diagnosis 1: 'F03.90'
[00:40:53] ℹ️    - Diagnosis 2: 'R60.9'
[00:40:53] ℹ️    - Diagnosis 3: 'G47.9'
[00:40:53] ℹ️    - Diagnosis 4: 'None'
[00:40:53] ℹ️    - Diagnosis 5: 'None'
[00:40:53] ℹ️    - Diagnosis 6: 'None'
[00:40:53] ℹ️  Final extracted MRN: 'MA221012023702'
[00:40:53] ℹ️  Final extracted Sex: ''
[00:40:53] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:40:53] ℹ️  Final extracted Payer Source: ''
[00:40:53] ✅ Patient data extraction completed successfully
[00:40:53] ✅    ✅ Patient data extracted successfully
[00:40:53] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:40:53] ✅    ✅ Patient identified: Mary Pedra
[00:40:53] ✅    ✅ Patient name validation passed
[00:40:53] 🔄 
🔄 Step 3: Processing patient dates...
[00:40:53] [DOC: 9230316] ℹ️  DOB normalized: 02/27/1937
[00:40:53] [DOC: 9230316] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[00:40:53] [DOC: 9230316] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[00:40:53] [DOC: 9230316] ✅ Patient date processing completed successfully
[00:40:53] ✅    ✅ Date processing completed
[00:40:53] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9'}]
[00:40:53] 🔄 
🔄 Step 4: Extracting order data...
[00:40:55] ℹ️  Order extraction - MRN: 'MA221012023702'
[00:40:55] ℹ️  Order extraction - Sex: ''
[00:40:55] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:40:55] ℹ️  Order extraction - Payer Source: ''
[00:40:55] ✅ Order data extraction completed successfully
[00:40:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:40:55] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[00:40:55] ℹ️  Inferred sex as FEMALE from name: Mary
[00:40:55] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:40:55] ✅ Patient name cross-validation successful
[00:40:55] ✅    ✅ Data merged successfully
[00:40:56] ✅    ✅ Order data extracted and validated
[00:40:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:40:56] [DOC: 9230316] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:40:56] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:40:56] 🔄 
🔄 Step 6: Pushing order to API...
[00:40:56] [DOC: 9230316] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:40:58] [DOC: 9230316] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12995"}
[00:40:58] ❌    ❌ Failed to push order
[00:40:58] 🔄 
🔄 Step 7: Writing to CSV...
[00:40:58] [DOC: 9230316] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[00:40:58] [DOC: 9230316] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:40:58] [DOC: 9230316] ℹ️  Payer Source extracted: ''
[00:40:58] [DOC: 9230316] ℹ️  Diagnosis codes being written:
[00:40:58] [DOC: 9230316] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:40:58] [DOC: 9230316] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[00:40:58] [DOC: 9230316] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[00:40:58] [DOC: 9230316] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:40:58] [DOC: 9230316] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:40:58] [DOC: 9230316] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:40:58] [DOC: 9230316] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA221012023702
[00:40:58] ✅    ✅ Document 9230316 processed and saved successfully
[00:40:58] 🔄 
🔄 Step 8: Saving API details...
[00:40:58] [DOC: 9230316] ℹ️  API push details saved for document 9230316
[00:40:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230315                         ║
================================================================================
[00:40:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:40:58] ℹ️  Date: 04/09/2025
[00:40:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:41:00] [DOC: 9230315] ✅ Text extracted using pdfplumber (1324 chars)
[00:41:00] ✅    ✅ Text extracted using pdfplumber (1324 chars)
[00:41:00] 🔄 
🔄 Step 2: Extracting patient data...
[00:41:03] ℹ️  AI extracted raw sex value: ''
[00:41:03] ℹ️  AI extracted service line: 'Physical Therapy'
[00:41:03] ℹ️  AI extracted payer source: ''
[00:41:03] ℹ️  AI extracted diagnoses:
[00:41:03] ℹ️    - Diagnosis 1: 'F03.90'
[00:41:03] ℹ️    - Diagnosis 2: 'R60.9'
[00:41:03] ℹ️    - Diagnosis 3: 'G47.9'
[00:41:03] ℹ️    - Diagnosis 4: ''
[00:41:03] ℹ️    - Diagnosis 5: ''
[00:41:03] ℹ️    - Diagnosis 6: ''
[00:41:03] ℹ️  Final extracted MRN: 'MA221012023702'
[00:41:03] ℹ️  Final extracted Sex: ''
[00:41:03] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:41:03] ℹ️  Final extracted Payer Source: ''
[00:41:03] ✅ Patient data extraction completed successfully
[00:41:03] ✅    ✅ Patient data extracted successfully
[00:41:03] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:41:03] ✅    ✅ Patient identified: Mary Pedra
[00:41:03] ✅    ✅ Patient name validation passed
[00:41:03] 🔄 
🔄 Step 3: Processing patient dates...
[00:41:03] [DOC: 9230315] ℹ️  DOB normalized: 02/27/1937
[00:41:03] [DOC: 9230315] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[00:41:03] [DOC: 9230315] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[00:41:03] [DOC: 9230315] ✅ Patient date processing completed successfully
[00:41:03] ✅    ✅ Date processing completed
[00:41:03] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:41:03] 🔄 
🔄 Step 4: Extracting order data...
[00:41:06] ℹ️  Order extraction - MRN: 'MA221012023702'
[00:41:06] ℹ️  Order extraction - Sex: ''
[00:41:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:41:06] ℹ️  Order extraction - Payer Source: ''
[00:41:06] ✅ Order data extraction completed successfully
[00:41:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:41:06] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[00:41:06] ℹ️  Inferred sex as FEMALE from name: Mary
[00:41:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:41:06] ✅ Patient name cross-validation successful
[00:41:06] ✅    ✅ Data merged successfully
[00:41:07] ✅    ✅ Order data extracted and validated
[00:41:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:41:07] [DOC: 9230315] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:41:07] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:41:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:41:07] [DOC: 9230315] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[00:41:09] [DOC: 9230315] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12996"}
[00:41:09] ❌    ❌ Failed to push order
[00:41:09] 🔄 
🔄 Step 7: Writing to CSV...
[00:41:09] [DOC: 9230315] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[00:41:09] [DOC: 9230315] ℹ️  Service Line extracted: 'Physical Therapy'
[00:41:09] [DOC: 9230315] ℹ️  Payer Source extracted: ''
[00:41:09] [DOC: 9230315] ℹ️  Diagnosis codes being written:
[00:41:09] [DOC: 9230315] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:41:09] [DOC: 9230315] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[00:41:09] [DOC: 9230315] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[00:41:09] [DOC: 9230315] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:41:09] [DOC: 9230315] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:41:09] [DOC: 9230315] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:41:09] [DOC: 9230315] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA221012023702
[00:41:09] ✅    ✅ Document 9230315 processed and saved successfully
[00:41:09] 🔄 
🔄 Step 8: Saving API details...
[00:41:09] [DOC: 9230315] ℹ️  API push details saved for document 9230315
[00:41:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229870                         ║
================================================================================
[00:41:09] ℹ️  Agency: Dartmouth HH
[00:41:09] ℹ️  Date: 04/09/2025
[00:41:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:41:15] [DOC: 9229870] ✅ Text extracted using pdfplumber (14340 chars)
[00:41:15] ✅    ✅ Text extracted using pdfplumber (14328 chars)
[00:41:15] 🔄 
🔄 Step 2: Extracting patient data...
[00:41:18] ℹ️  AI extracted raw sex value: 'M'
[00:41:18] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[00:41:18] ℹ️  AI extracted payer source: 'None'
[00:41:18] ℹ️  AI extracted diagnoses:
[00:41:18] ℹ️    - Diagnosis 1: 'I13.0'
[00:41:18] ℹ️    - Diagnosis 2: 'I50.32'
[00:41:18] ℹ️    - Diagnosis 3: 'E11.22'
[00:41:18] ℹ️    - Diagnosis 4: 'N18.31'
[00:41:18] ℹ️    - Diagnosis 5: 'I48.0'
[00:41:18] ℹ️    - Diagnosis 6: 'K74.60'
[00:41:18] ℹ️  Final extracted MRN: '3778011'
[00:41:18] ℹ️  Final extracted Sex: 'MALE'
[00:41:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[00:41:18] ℹ️  Final extracted Payer Source: ''
[00:41:18] ✅ Patient data extraction completed successfully
[00:41:18] ✅    ✅ Patient data extracted successfully
[00:41:18] 📊 Patient Response
     └─ patientFName: Saulnier
     └─ patientLName: Roy
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2024', 'startOfEpisode': '08/07/2024', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'K74.60'}]
[00:41:18] ✅    ✅ Patient identified: Saulnier Roy
[00:41:18] ✅    ✅ Patient name validation passed
[00:41:18] 🔄 
🔄 Step 3: Processing patient dates...
[00:41:18] [DOC: 9229870] ℹ️  DOB normalized: 10/26/1936
[00:41:18] [DOC: 9229870] ℹ️  Episode startOfCare normalized: 07/15/2024
[00:41:18] [DOC: 9229870] ℹ️  Episode startOfEpisode normalized: 08/07/2024
[00:41:18] [DOC: 9229870] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[00:41:18] [DOC: 9229870] ✅ Patient date processing completed successfully
[00:41:18] ✅    ✅ Date processing completed
[00:41:18] 📊 Processed Patient Data
     └─ patientFName: Saulnier
     └─ patientLName: Roy
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2024', 'startOfEpisode': '08/07/2024', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'K74.60'}]
[00:41:18] 🔄 
🔄 Step 4: Extracting order data...
[00:41:20] ℹ️  Order extraction - MRN: '3778011'
[00:41:20] ℹ️  Order extraction - Sex: 'MALE'
[00:41:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[00:41:20] ℹ️  Order extraction - Payer Source: ''
[00:41:20] ✅ Order data extraction completed successfully
[00:41:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:41:20] ℹ️  Using MRN from patient data: '3778011' over '3778011'
[00:41:20] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Physical Therapy, Skilled Nursing'
[00:41:20] ✅ Patient name cross-validation successful
[00:41:20] ✅    ✅ Data merged successfully
[00:41:21] ✅    ✅ Order data extracted and validated
[00:41:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:41:21] [DOC: 9229870] ✅ Patient found in local cache: Saulnier Roy, ID: e7b4162b-4dbf-41e2-947a-2c2579aa8586
[00:41:21] ✅    ✅ Existing patient found with ID: e7b4162b-4dbf-41e2-947a-2c2579aa8586
[00:41:21] 🔄 
🔄 Step 6: Pushing order to API...
[00:41:21] [DOC: 9229870] ℹ️  Pushing order via API for patient ID: e7b4162b-4dbf-41e2-947a-2c2579aa8586
[00:41:23] [DOC: 9229870] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:41:23] ❌    ❌ Failed to push order
[00:41:23] 🔄 
🔄 Step 7: Writing to CSV...
[00:41:23] [DOC: 9229870] ℹ️  Calculated age: 88 from DOB: 10/26/1936
[00:41:23] [DOC: 9229870] ℹ️  Service Line extracted: 'OT, PT, Physical Therapy, Skilled Nursing'
[00:41:23] [DOC: 9229870] ℹ️  Payer Source extracted: ''
[00:41:23] [DOC: 9229870] ℹ️  Diagnosis codes being written:
[00:41:23] [DOC: 9229870] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[00:41:23] [DOC: 9229870] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[00:41:23] [DOC: 9229870] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[00:41:23] [DOC: 9229870] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[00:41:23] [DOC: 9229870] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.0'
[00:41:23] [DOC: 9229870] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K74.60'
[00:41:23] [DOC: 9229870] ✅ Patient data written to CSV: Saulnier Roy | Sex: MALE | Age: 88 | Service: OT, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 3778011
[00:41:23] ✅    ✅ Document 9229870 processed and saved successfully
[00:41:23] 🔄 
🔄 Step 8: Saving API details...
[00:41:23] [DOC: 9229870] ℹ️  API push details saved for document 9229870
[00:41:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229860                         ║
================================================================================
[00:41:23] ℹ️  Agency: Dartmouth HH
[00:41:23] ℹ️  Date: 04/09/2025
[00:41:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:41:29] [DOC: 9229860] ✅ Text extracted using pdfplumber (24856 chars)
[00:41:29] ✅    ✅ Text extracted using pdfplumber (24844 chars)
[00:41:29] 🔄 
🔄 Step 2: Extracting patient data...
[00:41:32] ℹ️  AI extracted raw sex value: 'M'
[00:41:32] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, ST'
[00:41:32] ℹ️  AI extracted payer source: ''
[00:41:32] ℹ️  AI extracted diagnoses:
[00:41:32] ℹ️    - Diagnosis 1: 'N17.9'
[00:41:32] ℹ️    - Diagnosis 2: 'I12.9'
[00:41:32] ℹ️    - Diagnosis 3: 'E11.22'
[00:41:32] ℹ️    - Diagnosis 4: 'N18.32'
[00:41:32] ℹ️    - Diagnosis 5: 'N28.89'
[00:41:32] ℹ️    - Diagnosis 6: 'E87.5'
[00:41:32] ℹ️  Final extracted MRN: '1556015'
[00:41:32] ℹ️  Final extracted Sex: 'MALE'
[00:41:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, ST'
[00:41:32] ℹ️  Final extracted Payer Source: ''
[00:41:32] ✅ Patient data extraction completed successfully
[00:41:32] ✅    ✅ Patient data extracted successfully
[00:41:32] 📊 Patient Response
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'N17.9', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N28.89', 'sixthDiagnosis': 'E87.5'}]
[00:41:32] ✅    ✅ Patient identified: Andrew Reuter
[00:41:32] ✅    ✅ Patient name validation passed
[00:41:32] 🔄 
🔄 Step 3: Processing patient dates...
[00:41:32] [DOC: 9229860] ℹ️  DOB normalized: 07/06/1927
[00:41:32] [DOC: 9229860] ℹ️  Episode startOfCare normalized: 03/24/2025
[00:41:32] [DOC: 9229860] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[00:41:32] [DOC: 9229860] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[00:41:32] [DOC: 9229860] ✅ Patient date processing completed successfully
[00:41:32] ✅    ✅ Date processing completed
[00:41:32] 📊 Processed Patient Data
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'N17.9', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N28.89', 'sixthDiagnosis': 'E87.5'}]
[00:41:32] 🔄 
🔄 Step 4: Extracting order data...
[00:41:35] ℹ️  Order extraction - MRN: '1556015'
[00:41:35] ℹ️  Order extraction - Sex: 'MALE'
[00:41:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing,PT,OT,Speech Therapy'
[00:41:35] ℹ️  Order extraction - Payer Source: ''
[00:41:35] ✅ Order data extraction completed successfully
[00:41:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:41:35] ℹ️  Using MRN from patient data: '1556015' over '1556015'
[00:41:35] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT, ST' + Order='Skilled Nursing,PT,OT,Speech Therapy' = 'OT, PT, ST, Skilled Nursing, Speech Therapy'
[00:41:35] ✅ Patient name cross-validation successful
[00:41:35] ✅    ✅ Data merged successfully
[00:41:36] ✅    ✅ Order data extracted and validated
[00:41:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:41:36] [DOC: 9229860] ✅ Patient found in local cache: Andrew Reuter, ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[00:41:36] ✅    ✅ Existing patient found with ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[00:41:36] 🔄 
🔄 Step 6: Pushing order to API...
[00:41:36] [DOC: 9229860] ℹ️  Pushing order via API for patient ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[00:41:37] [DOC: 9229860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:41:37] ❌    ❌ Failed to push order
[00:41:37] 🔄 
🔄 Step 7: Writing to CSV...
[00:41:37] [DOC: 9229860] ℹ️  Calculated age: 97 from DOB: 07/06/1927
[00:41:37] [DOC: 9229860] ℹ️  Service Line extracted: 'OT, PT, ST, Skilled Nursing, Speech Therapy'
[00:41:37] [DOC: 9229860] ℹ️  Payer Source extracted: ''
[00:41:37] [DOC: 9229860] ℹ️  Diagnosis codes being written:
[00:41:37] [DOC: 9229860] ℹ️    - Latest_Episode_Firstdiagnosis: 'N17.9'
[00:41:37] [DOC: 9229860] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[00:41:37] [DOC: 9229860] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[00:41:37] [DOC: 9229860] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.32'
[00:41:37] [DOC: 9229860] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N28.89'
[00:41:37] [DOC: 9229860] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.5'
[00:41:37] [DOC: 9229860] ✅ Patient data written to CSV: Andrew Reuter | Sex: MALE | Age: 97 | Service: OT, PT, ST, Skilled Nursing, Speech Therapy | Payer:  | MRN: 1556015
[00:41:37] ✅    ✅ Document 9229860 processed and saved successfully
[00:41:37] 🔄 
🔄 Step 8: Saving API details...
[00:41:37] [DOC: 9229860] ℹ️  API push details saved for document 9229860
[00:41:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9229052                         ║
================================================================================
[00:41:37] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[00:41:37] ℹ️  Date: 04/08/2025
[00:41:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:41:42] [DOC: 9229052] ✅ Text extracted using pdfplumber (3031 chars)
[00:41:42] ✅    ✅ Text extracted using pdfplumber (3031 chars)
[00:41:42] 🔄 
🔄 Step 2: Extracting patient data...
[00:41:45] ℹ️  AI extracted raw sex value: 'F'
[00:41:45] ℹ️  AI extracted service line: 'PT'
[00:41:45] ℹ️  AI extracted payer source: 'Senior Whole Health'
[00:41:45] ℹ️  AI extracted diagnoses:
[00:41:45] ℹ️    - Diagnosis 1: ''
[00:41:45] ℹ️    - Diagnosis 2: ''
[00:41:45] ℹ️    - Diagnosis 3: ''
[00:41:45] ℹ️    - Diagnosis 4: ''
[00:41:45] ℹ️    - Diagnosis 5: ''
[00:41:45] ℹ️    - Diagnosis 6: ''
[00:41:45] ℹ️  Final extracted MRN: '225004'
[00:41:45] ℹ️  Final extracted Sex: 'FEMALE'
[00:41:45] ℹ️  Final extracted Service Line: 'PT'
[00:41:45] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[00:41:45] ✅ Patient data extraction completed successfully
[00:41:45] ✅    ✅ Patient data extracted successfully
[00:41:45] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Desousa
     └─ dob: 01/21/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 225004
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2024', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:41:45] ✅    ✅ Patient identified: Maria Desousa
[00:41:45] ✅    ✅ Patient name validation passed
[00:41:45] 🔄 
🔄 Step 3: Processing patient dates...
[00:41:45] [DOC: 9229052] ℹ️  DOB normalized: 01/21/1959
[00:41:45] [DOC: 9229052] ℹ️  Episode startOfCare normalized: 09/04/2024
[00:41:45] [DOC: 9229052] ℹ️  Episode startOfEpisode normalized: 03/03/2025
[00:41:45] [DOC: 9229052] ℹ️  Episode endOfEpisode normalized: 05/01/2025
[00:41:45] [DOC: 9229052] ✅ Patient date processing completed successfully
[00:41:45] ✅    ✅ Date processing completed
[00:41:45] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Desousa
     └─ dob: 01/21/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 225004
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2024', 'startOfEpisode': '03/03/2025', 'endOfEpisode': '05/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:41:45] 🔄 
🔄 Step 4: Extracting order data...
[00:41:47] ℹ️  Order extraction - MRN: '225004'
[00:41:47] ℹ️  Order extraction - Sex: 'FEMALE'
[00:41:47] ℹ️  Order extraction - Service Line: 'PT'
[00:41:47] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[00:41:47] ✅ Order data extraction completed successfully
[00:41:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:41:47] ℹ️  Using MRN from patient data: '225004' over '225004'
[00:41:47] ℹ️  Service line consistent in both sources: 'PT'
[00:41:47] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[00:41:47] ✅ Patient name cross-validation successful
[00:41:47] ✅    ✅ Data merged successfully
[00:41:48] ✅    ✅ Order data extracted and validated
[00:41:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:41:51] [DOC: 9229052] ✅ Patient exists in API: Maria Desousa, ID: 4f31adf8-fa4c-403c-871b-7bf0a67dd6a6
[00:41:51] ✅    ✅ Existing patient found with ID: 4f31adf8-fa4c-403c-871b-7bf0a67dd6a6
[00:41:51] 🔄 
🔄 Step 6: Pushing order to API...
[00:41:51] [DOC: 9229052] ℹ️  Pushing order via API for patient ID: 4f31adf8-fa4c-403c-871b-7bf0a67dd6a6
[00:41:52] [DOC: 9229052] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:41:52] ❌    ❌ Failed to push order
[00:41:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:41:52] [DOC: 9229052] ℹ️  Calculated age: 66 from DOB: 01/21/1959
[00:41:52] [DOC: 9229052] ℹ️  Service Line extracted: 'PT'
[00:41:52] [DOC: 9229052] ℹ️  Payer Source extracted: 'Senior Whole Health'
[00:41:52] [DOC: 9229052] ℹ️  Diagnosis codes being written:
[00:41:52] [DOC: 9229052] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:41:52] [DOC: 9229052] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:41:52] [DOC: 9229052] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:41:52] [DOC: 9229052] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:41:52] [DOC: 9229052] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:41:52] [DOC: 9229052] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:41:52] [DOC: 9229052] ✅ Patient data written to CSV: Maria Desousa | Sex: FEMALE | Age: 66 | Service: PT | Payer: Senior Whole Health | MRN: 225004
[00:41:52] ✅    ✅ Document 9229052 processed and saved successfully
[00:41:52] 🔄 
🔄 Step 8: Saving API details...
[00:41:52] [DOC: 9229052] ℹ️  API push details saved for document 9229052
[00:41:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9228879                         ║
================================================================================
[00:41:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:41:52] ℹ️  Date: 04/08/2025
[00:41:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:41:54] [DOC: 9228879] ✅ Text extracted using pdfplumber (970 chars)
[00:41:54] ✅    ✅ Text extracted using pdfplumber (970 chars)
[00:41:54] 🔄 
🔄 Step 2: Extracting patient data...
[00:41:57] ℹ️  AI extracted raw sex value: 'M'
[00:41:57] ℹ️  AI extracted service line: 'RN'
[00:41:57] ℹ️  AI extracted payer source: ''
[00:41:57] ℹ️  AI extracted diagnoses:
[00:41:57] ℹ️    - Diagnosis 1: ''
[00:41:57] ℹ️    - Diagnosis 2: ''
[00:41:57] ℹ️    - Diagnosis 3: ''
[00:41:57] ℹ️    - Diagnosis 4: ''
[00:41:57] ℹ️    - Diagnosis 5: ''
[00:41:57] ℹ️    - Diagnosis 6: ''
[00:41:57] ℹ️  Final extracted MRN: '2716471'
[00:41:57] ℹ️  Final extracted Sex: 'MALE'
[00:41:57] ℹ️  Final extracted Service Line: 'RN'
[00:41:57] ℹ️  Final extracted Payer Source: ''
[00:41:57] ✅ Patient data extraction completed successfully
[00:41:57] ✅    ✅ Patient data extracted successfully
[00:41:57] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:41:57] ✅    ✅ Patient identified: Thomas McCormack
[00:41:57] ✅    ✅ Patient name validation passed
[00:41:57] 🔄 
🔄 Step 3: Processing patient dates...
[00:41:57] [DOC: 9228879] ℹ️  DOB normalized: 03/17/1944
[00:41:57] [DOC: 9228879] ✅ Patient date processing completed successfully
[00:41:57] ✅    ✅ Date processing completed
[00:41:57] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:41:57] 🔄 
🔄 Step 4: Extracting order data...
[00:41:59] ℹ️  Order extraction - MRN: '2716471'
[00:41:59] ℹ️  Order extraction - Sex: 'MALE'
[00:41:59] ℹ️  Order extraction - Service Line: ''
[00:41:59] ℹ️  Order extraction - Payer Source: ''
[00:41:59] ✅ Order data extraction completed successfully
[00:41:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:41:59] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[00:41:59] ℹ️  Using service line from patient data: 'RN'
[00:41:59] ✅ Patient name cross-validation successful
[00:41:59] ✅    ✅ Data merged successfully
[00:42:00] ⚠️     ❌ Skipping - missing episode start date
[00:42:00] [DOC: 9228879] ℹ️  API push details saved for document 9228879
================================================================================
║                        Processing Document ID: 9228878                         ║
================================================================================
[00:42:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:42:00] ℹ️  Date: 04/08/2025
[00:42:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:42:06] [DOC: 9228878] ✅ Text extracted using pdfplumber (28373 chars)
[00:42:06] ✅    ✅ Text extracted using pdfplumber (28373 chars)
[00:42:06] 🔄 
🔄 Step 2: Extracting patient data...
[00:42:10] ℹ️  AI extracted raw sex value: 'F'
[00:42:10] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:42:10] ℹ️  AI extracted payer source: ''
[00:42:10] ℹ️  AI extracted diagnoses:
[00:42:10] ℹ️    - Diagnosis 1: 'J18.9'
[00:42:10] ℹ️    - Diagnosis 2: 'J44.1'
[00:42:10] ℹ️    - Diagnosis 3: 'J96.11'
[00:42:10] ℹ️    - Diagnosis 4: 'I13.0'
[00:42:10] ℹ️    - Diagnosis 5: 'I50.32'
[00:42:10] ℹ️    - Diagnosis 6: 'E11.22'
[00:42:10] ℹ️  Final extracted MRN: '2607201'
[00:42:10] ℹ️  Final extracted Sex: 'FEMALE'
[00:42:10] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:42:10] ℹ️  Final extracted Payer Source: ''
[00:42:10] ✅ Patient data extraction completed successfully
[00:42:10] ✅    ✅ Patient data extracted successfully
[00:42:10] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J96.11', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.22'}]
[00:42:10] ✅    ✅ Patient identified: Theresa Kamm
[00:42:10] ✅    ✅ Patient name validation passed
[00:42:10] 🔄 
🔄 Step 3: Processing patient dates...
[00:42:10] [DOC: 9228878] ℹ️  DOB normalized: 08/02/1939
[00:42:10] [DOC: 9228878] ℹ️  Episode startOfCare normalized: 03/12/2025
[00:42:10] [DOC: 9228878] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[00:42:10] [DOC: 9228878] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[00:42:10] [DOC: 9228878] ✅ Patient date processing completed successfully
[00:42:10] ✅    ✅ Date processing completed
[00:42:10] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J44.1', 'thirdDiagnosis': 'J96.11', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'E11.22'}]
[00:42:10] 🔄 
🔄 Step 4: Extracting order data...
[00:42:13] ℹ️  Order extraction - MRN: '2607201'
[00:42:13] ℹ️  Order extraction - Sex: 'FEMALE'
[00:42:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[00:42:13] ℹ️  Order extraction - Payer Source: ''
[00:42:13] ✅ Order data extraction completed successfully
[00:42:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:42:13] ℹ️  Using MRN from patient data: '2607201' over '2607201'
[00:42:13] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[00:42:13] ✅ Patient name cross-validation successful
[00:42:13] ✅    ✅ Data merged successfully
[00:42:14] ✅    ✅ Order data extracted and validated
[00:42:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:42:16] [DOC: 9228878] ℹ️  Patient not found in cache or API: Theresa Kamm
[00:42:16] [DOC: 9228878] ℹ️  Patient not found, creating new patient via API...
[00:42:16] [DOC: 9228878] ℹ️  Creating patient via API: Theresa Kamm
[00:42:17] [DOC: 9228878] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:42:17] ❌    ❌ Failed to create patient
[00:42:17] [DOC: 9228878] ℹ️  API push details saved for document 9228878
================================================================================
║                        Processing Document ID: 9227648                         ║
================================================================================
[00:42:17] ℹ️  Agency: Dartmouth HH
[00:42:17] ℹ️  Date: 04/08/2025
[00:42:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:42:20] [DOC: 9227648] ✅ Text extracted using pdfplumber (7522 chars)
[00:42:20] ✅    ✅ Text extracted using pdfplumber (7522 chars)
[00:42:20] 🔄 
🔄 Step 2: Extracting patient data...
[00:42:23] ℹ️  AI extracted raw sex value: 'M'
[00:42:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:42:23] ℹ️  AI extracted payer source: 'Medicare'
[00:42:23] ℹ️  AI extracted diagnoses:
[00:42:23] ℹ️    - Diagnosis 1: ''
[00:42:23] ℹ️    - Diagnosis 2: ''
[00:42:23] ℹ️    - Diagnosis 3: ''
[00:42:23] ℹ️    - Diagnosis 4: ''
[00:42:23] ℹ️    - Diagnosis 5: ''
[00:42:23] ℹ️    - Diagnosis 6: ''
[00:42:23] ℹ️  Final extracted MRN: '2496015'
[00:42:23] ℹ️  Final extracted Sex: 'MALE'
[00:42:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:42:23] ℹ️  Final extracted Payer Source: 'Medicare'
[00:42:23] ✅ Patient data extraction completed successfully
[00:42:23] ✅    ✅ Patient data extracted successfully
[00:42:23] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:42:23] ✅    ✅ Patient identified: Dana Theodore
[00:42:23] ✅    ✅ Patient name validation passed
[00:42:23] 🔄 
🔄 Step 3: Processing patient dates...
[00:42:23] [DOC: 9227648] ℹ️  DOB normalized: 03/16/1954
[00:42:23] [DOC: 9227648] ℹ️  Episode startOfCare normalized: 03/02/2025
[00:42:23] [DOC: 9227648] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[00:42:23] [DOC: 9227648] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[00:42:23] [DOC: 9227648] ✅ Patient date processing completed successfully
[00:42:23] ✅    ✅ Date processing completed
[00:42:23] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:42:23] 🔄 
🔄 Step 4: Extracting order data...
[00:42:26] ℹ️  Order extraction - MRN: ''
[00:42:26] ℹ️  Order extraction - Sex: 'MALE'
[00:42:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:42:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:42:26] ✅ Order data extraction completed successfully
[00:42:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:42:26] ℹ️  Using MRN from patient data: '2496015'
[00:42:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:42:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:42:26] ✅ Patient name cross-validation successful
[00:42:26] ✅    ✅ Data merged successfully
[00:42:27] ✅    ✅ Order data extracted and validated
[00:42:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:42:27] [DOC: 9227648] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:42:27] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:42:27] 🔄 
🔄 Step 6: Pushing order to API...
[00:42:27] [DOC: 9227648] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:42:28] [DOC: 9227648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:42:28] ❌    ❌ Failed to push order
[00:42:28] 🔄 
🔄 Step 7: Writing to CSV...
[00:42:28] [DOC: 9227648] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[00:42:28] [DOC: 9227648] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:42:28] [DOC: 9227648] ℹ️  Payer Source extracted: 'Medicare'
[00:42:28] [DOC: 9227648] ℹ️  Diagnosis codes being written:
[00:42:28] [DOC: 9227648] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:42:28] [DOC: 9227648] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:42:28] [DOC: 9227648] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:42:28] [DOC: 9227648] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:42:28] [DOC: 9227648] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:42:28] [DOC: 9227648] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:42:28] [DOC: 9227648] ✅ Patient data written to CSV: Dana Theodore | Sex: MALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[00:42:28] ✅    ✅ Document 9227648 processed and saved successfully
[00:42:28] 🔄 
🔄 Step 8: Saving API details...
[00:42:28] [DOC: 9227648] ℹ️  API push details saved for document 9227648
[00:42:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224418                         ║
================================================================================
[00:42:28] ℹ️  Agency: Dartmouth HH
[00:42:28] ℹ️  Date: 04/07/2025
[00:42:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:42:31] [DOC: 9224418] ✅ Text extracted using pdfplumber (15721 chars)
[00:42:31] ✅    ✅ Text extracted using pdfplumber (15721 chars)
[00:42:31] 🔄 
🔄 Step 2: Extracting patient data...
[00:42:34] ℹ️  AI extracted raw sex value: 'F'
[00:42:34] ℹ️  AI extracted service line: 'PT'
[00:42:34] ℹ️  AI extracted payer source: 'None'
[00:42:34] ℹ️  AI extracted diagnoses:
[00:42:34] ℹ️    - Diagnosis 1: 'Z47.1'
[00:42:34] ℹ️    - Diagnosis 2: 'M96.661'
[00:42:34] ℹ️    - Diagnosis 3: 'M97.01XD'
[00:42:34] ℹ️    - Diagnosis 4: 'E66.9'
[00:42:34] ℹ️    - Diagnosis 5: 'Z68.31'
[00:42:34] ℹ️    - Diagnosis 6: 'E87.1'
[00:42:34] ℹ️  Final extracted MRN: '6133015'
[00:42:34] ℹ️  Final extracted Sex: 'FEMALE'
[00:42:34] ℹ️  Final extracted Service Line: 'PT'
[00:42:34] ℹ️  Final extracted Payer Source: ''
[00:42:34] ✅ Patient data extraction completed successfully
[00:42:34] ✅    ✅ Patient data extracted successfully
[00:42:34] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M96.661', 'thirdDiagnosis': 'M97.01XD', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'E87.1'}]
[00:42:34] ✅    ✅ Patient identified: Jacqueline DeTerra
[00:42:34] ✅    ✅ Patient name validation passed
[00:42:34] 🔄 
🔄 Step 3: Processing patient dates...
[00:42:34] [DOC: 9224418] ℹ️  DOB normalized: 11/04/1976
[00:42:34] [DOC: 9224418] ℹ️  Episode startOfCare normalized: 04/03/2025
[00:42:34] [DOC: 9224418] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[00:42:34] [DOC: 9224418] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[00:42:34] [DOC: 9224418] ✅ Patient date processing completed successfully
[00:42:34] ✅    ✅ Date processing completed
[00:42:34] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M96.661', 'thirdDiagnosis': 'M97.01XD', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.31', 'sixthDiagnosis': 'E87.1'}]
[00:42:34] 🔄 
🔄 Step 4: Extracting order data...
[00:42:36] ℹ️  Order extraction - MRN: '6133015'
[00:42:36] ℹ️  Order extraction - Sex: 'FEMALE'
[00:42:36] ℹ️  Order extraction - Service Line: 'PT'
[00:42:36] ℹ️  Order extraction - Payer Source: ''
[00:42:36] ✅ Order data extraction completed successfully
[00:42:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:42:36] ℹ️  Using MRN from patient data: '6133015' over '6133015'
[00:42:36] ℹ️  Service line consistent in both sources: 'PT'
[00:42:36] ✅ Patient name cross-validation successful
[00:42:36] ✅    ✅ Data merged successfully
[00:42:38] ✅    ✅ Order data extracted and validated
[00:42:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:42:38] [DOC: 9224418] ✅ Patient found in local cache: Jacqueline DeTerra, ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:42:38] ✅    ✅ Existing patient found with ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:42:38] 🔄 
🔄 Step 6: Pushing order to API...
[00:42:38] [DOC: 9224418] ℹ️  Pushing order via API for patient ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[00:42:39] [DOC: 9224418] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:42:39] ❌    ❌ Failed to push order
[00:42:39] 🔄 
🔄 Step 7: Writing to CSV...
[00:42:39] [DOC: 9224418] ℹ️  Calculated age: 48 from DOB: 11/04/1976
[00:42:39] [DOC: 9224418] ℹ️  Service Line extracted: 'PT'
[00:42:39] [DOC: 9224418] ℹ️  Payer Source extracted: ''
[00:42:39] [DOC: 9224418] ℹ️  Diagnosis codes being written:
[00:42:39] [DOC: 9224418] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[00:42:39] [DOC: 9224418] ℹ️    - Latest_Episode_Seconddiagnosis: 'M96.661'
[00:42:39] [DOC: 9224418] ℹ️    - Latest_Episode_Thirddiagnosis: 'M97.01XD'
[00:42:39] [DOC: 9224418] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.9'
[00:42:39] [DOC: 9224418] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.31'
[00:42:39] [DOC: 9224418] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.1'
[00:42:39] [DOC: 9224418] ✅ Patient data written to CSV: Jacqueline DeTerra | Sex: FEMALE | Age: 48 | Service: PT | Payer:  | MRN: 6133015
[00:42:39] ✅    ✅ Document 9224418 processed and saved successfully
[00:42:39] 🔄 
🔄 Step 8: Saving API details...
[00:42:39] [DOC: 9224418] ℹ️  API push details saved for document 9224418
[00:42:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224413                         ║
================================================================================
[00:42:39] ℹ️  Agency: Dartmouth HH
[00:42:39] ℹ️  Date: 04/07/2025
[00:42:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:42:42] [DOC: 9224413] ✅ Text extracted using pdfplumber (3878 chars)
[00:42:42] ✅    ✅ Text extracted using pdfplumber (3878 chars)
[00:42:42] 🔄 
🔄 Step 2: Extracting patient data...
[00:42:46] ℹ️  AI extracted raw sex value: 'F'
[00:42:46] ℹ️  AI extracted service line: 'OT, Skilled Nursing'
[00:42:46] ℹ️  AI extracted payer source: 'Medicare'
[00:42:46] ℹ️  AI extracted diagnoses:
[00:42:46] ℹ️    - Diagnosis 1: 'Acute on chronic diastolic HF'
[00:42:46] ℹ️    - Diagnosis 2: 'a-fib'
[00:42:46] ℹ️    - Diagnosis 3: 'None'
[00:42:46] ℹ️    - Diagnosis 4: 'None'
[00:42:46] ℹ️    - Diagnosis 5: 'None'
[00:42:46] ℹ️    - Diagnosis 6: 'None'
[00:42:46] ℹ️  Final extracted MRN: '5915015'
[00:42:46] ℹ️  Final extracted Sex: 'FEMALE'
[00:42:46] ℹ️  Final extracted Service Line: 'OT, Skilled Nursing'
[00:42:46] ℹ️  Final extracted Payer Source: 'Medicare'
[00:42:46] ✅ Patient data extraction completed successfully
[00:42:46] ✅    ✅ Patient data extracted successfully
[00:42:46] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'a-fib', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': '01/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:42:46] ✅    ✅ Patient identified: Suzanne Fawcett
[00:42:46] ✅    ✅ Patient name validation passed
[00:42:46] 🔄 
🔄 Step 3: Processing patient dates...
[00:42:46] [DOC: 9224413] ℹ️  DOB normalized: 12/08/1939
[00:42:46] [DOC: 9224413] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:42:46] [DOC: 9224413] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[00:42:46] [DOC: 9224413] ℹ️  Episode endOfEpisode normalized: 02/24/2025
[00:42:46] [DOC: 9224413] ✅ Patient date processing completed successfully
[00:42:46] ✅    ✅ Date processing completed
[00:42:46] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'a-fib'}, {'startOfCare': '01/26/2025', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia'}, {'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV'}]
[00:42:46] 🔄 
🔄 Step 4: Extracting order data...
[00:42:49] ℹ️  Order extraction - MRN: ''
[00:42:49] ℹ️  Order extraction - Sex: 'FEMALE'
[00:42:49] ℹ️  Order extraction - Service Line: 'OT, RN, LPN'
[00:42:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:42:49] ✅ Order data extraction completed successfully
[00:42:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:42:49] ℹ️  Using MRN from patient data: '5915015'
[00:42:49] ℹ️  Combined service lines: Patient='OT, Skilled Nursing' + Order='OT, RN, LPN' = 'LPN, OT, RN, Skilled Nursing'
[00:42:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:42:49] ✅ Patient name cross-validation successful
[00:42:49] ✅    ✅ Data merged successfully
[00:42:51] ✅    ✅ Order data extracted and validated
[00:42:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:42:51] [DOC: 9224413] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:42:51] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:42:51] 🔄 
🔄 Step 6: Pushing order to API...
[00:42:51] [DOC: 9224413] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:42:52] [DOC: 9224413] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13932"}
[00:42:52] ❌    ❌ Failed to push order
[00:42:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:42:52] [DOC: 9224413] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:42:52] [DOC: 9224413] ℹ️  Service Line extracted: 'LPN, OT, RN, Skilled Nursing'
[00:42:52] [DOC: 9224413] ℹ️  Payer Source extracted: 'Medicare'
[00:42:52] [DOC: 9224413] ℹ️  Diagnosis codes being written:
[00:42:52] [DOC: 9224413] ℹ️    - Latest_Episode_Firstdiagnosis: 'Acute on chronic diastolic HF'
[00:42:52] [DOC: 9224413] ℹ️    - Latest_Episode_Seconddiagnosis: 'a-fib'
[00:42:52] [DOC: 9224413] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:42:52] [DOC: 9224413] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:42:52] [DOC: 9224413] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:42:52] [DOC: 9224413] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:42:52] [DOC: 9224413] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: LPN, OT, RN, Skilled Nursing | Payer: Medicare | MRN: 5915015
[00:42:52] ✅    ✅ Document 9224413 processed and saved successfully
[00:42:52] 🔄 
🔄 Step 8: Saving API details...
[00:42:52] [DOC: 9224413] ℹ️  API push details saved for document 9224413
[00:42:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9224406                         ║
================================================================================
[00:42:52] ℹ️  Agency: Dartmouth HH
[00:42:52] ℹ️  Date: 04/07/2025
[00:42:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:42:58] [DOC: 9224406] ✅ Text extracted using pdfplumber (21010 chars)
[00:42:58] ✅    ✅ Text extracted using pdfplumber (21010 chars)
[00:42:58] 🔄 
🔄 Step 2: Extracting patient data...
[00:43:01] ℹ️  AI extracted raw sex value: 'F'
[00:43:01] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[00:43:01] ℹ️  AI extracted payer source: 'None'
[00:43:01] ℹ️  AI extracted diagnoses:
[00:43:01] ℹ️    - Diagnosis 1: 'Z47.1'
[00:43:01] ℹ️    - Diagnosis 2: 'Z96.642'
[00:43:01] ℹ️    - Diagnosis 3: 'M06.9'
[00:43:01] ℹ️    - Diagnosis 4: 'M79.7'
[00:43:01] ℹ️    - Diagnosis 5: 'G89.29'
[00:43:01] ℹ️    - Diagnosis 6: 'M47.896'
[00:43:01] ℹ️  Final extracted MRN: '6046015'
[00:43:01] ℹ️  Final extracted Sex: 'FEMALE'
[00:43:01] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[00:43:01] ℹ️  Final extracted Payer Source: ''
[00:43:01] ✅ Patient data extraction completed successfully
[00:43:01] ✅    ✅ Patient data extracted successfully
[00:43:01] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100010318804
     └─ physicianNPI: 
     └─ nameOfAgency: Julie Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.642', 'thirdDiagnosis': 'M06.9', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M47.896'}]
[00:43:01] ✅    ✅ Patient identified: Joan Marion
[00:43:01] ✅    ✅ Patient name validation passed
[00:43:01] 🔄 
🔄 Step 3: Processing patient dates...
[00:43:01] [DOC: 9224406] ℹ️  DOB normalized: 01/04/1955
[00:43:01] [DOC: 9224406] ℹ️  Episode startOfCare normalized: 03/25/2025
[00:43:01] [DOC: 9224406] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[00:43:01] [DOC: 9224406] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[00:43:01] [DOC: 9224406] ✅ Patient date processing completed successfully
[00:43:01] ✅    ✅ Date processing completed
[00:43:01] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100010318804
     └─ physicianNPI: 
     └─ nameOfAgency: Julie Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.642', 'thirdDiagnosis': 'M06.9', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M47.896'}]
[00:43:01] 🔄 
🔄 Step 4: Extracting order data...
[00:43:03] ℹ️  Order extraction - MRN: '6046015'
[00:43:03] ℹ️  Order extraction - Sex: 'FEMALE'
[00:43:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[00:43:03] ℹ️  Order extraction - Payer Source: ''
[00:43:03] ✅ Order data extraction completed successfully
[00:43:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:43:03] ℹ️  Using MRN from patient data: '6046015' over '6046015'
[00:43:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[00:43:03] ✅ Patient name cross-validation successful
[00:43:03] ✅    ✅ Data merged successfully
[00:43:05] ✅    ✅ Order data extracted and validated
[00:43:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:43:05] [DOC: 9224406] ✅ Patient found in local cache: Joan Marion, ID: 6b1f1a06-b1c5-4b8c-b7be-a10c134c6d6d
[00:43:05] ✅    ✅ Existing patient found with ID: 6b1f1a06-b1c5-4b8c-b7be-a10c134c6d6d
[00:43:05] 🔄 
🔄 Step 6: Pushing order to API...
[00:43:05] [DOC: 9224406] ℹ️  Pushing order via API for patient ID: 6b1f1a06-b1c5-4b8c-b7be-a10c134c6d6d
[00:43:06] [DOC: 9224406] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:43:06] ❌    ❌ Failed to push order
[00:43:06] 🔄 
🔄 Step 7: Writing to CSV...
[00:43:06] [DOC: 9224406] ℹ️  Calculated age: 70 from DOB: 01/04/1955
[00:43:06] [DOC: 9224406] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[00:43:06] [DOC: 9224406] ℹ️  Payer Source extracted: ''
[00:43:06] [DOC: 9224406] ℹ️  Diagnosis codes being written:
[00:43:06] [DOC: 9224406] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[00:43:06] [DOC: 9224406] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.642'
[00:43:06] [DOC: 9224406] ℹ️    - Latest_Episode_Thirddiagnosis: 'M06.9'
[00:43:06] [DOC: 9224406] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M79.7'
[00:43:06] [DOC: 9224406] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G89.29'
[00:43:06] [DOC: 9224406] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M47.896'
[00:43:06] [DOC: 9224406] ✅ Patient data written to CSV: Joan Marion | Sex: FEMALE | Age: 70 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 6046015
[00:43:06] ✅    ✅ Document 9224406 processed and saved successfully
[00:43:06] 🔄 
🔄 Step 8: Saving API details...
[00:43:06] [DOC: 9224406] ℹ️  API push details saved for document 9224406
[00:43:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9223446                         ║
================================================================================
[00:43:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:43:06] ℹ️  Date: 04/04/2025
[00:43:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:43:10] [DOC: 9223446] ✅ Text extracted using pdfplumber (30779 chars)
[00:43:10] ✅    ✅ Text extracted using pdfplumber (30779 chars)
[00:43:10] 🔄 
🔄 Step 2: Extracting patient data...
[00:43:13] ℹ️  AI extracted raw sex value: 'M'
[00:43:13] ℹ️  AI extracted service line: 'Skilled Nursing, Medical Social Work, Clergy'
[00:43:13] ℹ️  AI extracted payer source: ''
[00:43:13] ℹ️  AI extracted diagnoses:
[00:43:13] ℹ️    - Diagnosis 1: 'C67.9'
[00:43:13] ℹ️    - Diagnosis 2: 'C79.51'
[00:43:13] ℹ️    - Diagnosis 3: 'N13.39'
[00:43:13] ℹ️    - Diagnosis 4: 'E87.6'
[00:43:13] ℹ️    - Diagnosis 5: 'I10'
[00:43:13] ℹ️    - Diagnosis 6: 'N18.31'
[00:43:13] ℹ️  Final extracted MRN: '2532405'
[00:43:13] ℹ️  Final extracted Sex: 'MALE'
[00:43:13] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medical Social Work, Clergy'
[00:43:13] ℹ️  Final extracted Payer Source: ''
[00:43:13] ✅ Patient data extraction completed successfully
[00:43:13] ✅    ✅ Patient data extracted successfully
[00:43:13] 📊 Patient Response
     └─ patientFName: Rene
     └─ patientLName: Goyette
     └─ dob: 09/30/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2532405
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, Medical Social Work, Clergy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'N13.39', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'N18.31'}]
[00:43:13] ✅    ✅ Patient identified: Rene Goyette
[00:43:13] ✅    ✅ Patient name validation passed
[00:43:13] 🔄 
🔄 Step 3: Processing patient dates...
[00:43:13] [DOC: 9223446] ℹ️  DOB normalized: 09/30/1933
[00:43:13] [DOC: 9223446] ℹ️  Episode startOfCare normalized: 03/28/2025
[00:43:13] [DOC: 9223446] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[00:43:13] [DOC: 9223446] ℹ️  Episode endOfEpisode normalized: 03/30/2025
[00:43:13] [DOC: 9223446] ✅ Patient date processing completed successfully
[00:43:13] ✅    ✅ Date processing completed
[00:43:13] 📊 Processed Patient Data
     └─ patientFName: Rene
     └─ patientLName: Goyette
     └─ dob: 09/30/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2532405
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, Medical Social Work, Clergy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '03/30/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'N13.39', 'fourthDiagnosis': 'E87.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'N18.31'}]
[00:43:13] 🔄 
🔄 Step 4: Extracting order data...
[00:43:16] ℹ️  Order extraction - MRN: '2532405'
[00:43:16] ℹ️  Order extraction - Sex: 'MALE'
[00:43:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Medical Social Work, Clergy'
[00:43:16] ℹ️  Order extraction - Payer Source: ''
[00:43:16] ✅ Order data extraction completed successfully
[00:43:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:43:16] ℹ️  Using MRN from patient data: '2532405' over '2532405'
[00:43:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Medical Social Work, Clergy'
[00:43:16] ✅ Patient name cross-validation successful
[00:43:16] ✅    ✅ Data merged successfully
[00:43:17] ✅    ✅ Order data extracted and validated
[00:43:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:43:20] [DOC: 9223446] ℹ️  Patient not found in cache or API: Rene Goyette
[00:43:20] [DOC: 9223446] ℹ️  Patient not found, creating new patient via API...
[00:43:20] [DOC: 9223446] ℹ️  Creating patient via API: Rene Goyette
[00:43:21] [DOC: 9223446] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:43:21] ❌    ❌ Failed to create patient
[00:43:21] [DOC: 9223446] ℹ️  API push details saved for document 9223446
================================================================================
║                        Processing Document ID: 9223413                         ║
================================================================================
[00:43:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:43:21] ℹ️  Date: 04/04/2025
[00:43:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:43:23] [DOC: 9223413] ✅ Text extracted using pdfplumber (882 chars)
[00:43:23] ✅    ✅ Text extracted using pdfplumber (882 chars)
[00:43:23] 🔄 
🔄 Step 2: Extracting patient data...
[00:43:25] ℹ️  AI extracted raw sex value: 'M'
[00:43:25] ℹ️  AI extracted service line: 'Nursing'
[00:43:25] ℹ️  AI extracted payer source: ''
[00:43:25] ℹ️  AI extracted diagnoses:
[00:43:25] ℹ️    - Diagnosis 1: 'None'
[00:43:25] ℹ️    - Diagnosis 2: 'None'
[00:43:25] ℹ️    - Diagnosis 3: 'None'
[00:43:25] ℹ️    - Diagnosis 4: 'None'
[00:43:25] ℹ️    - Diagnosis 5: 'None'
[00:43:25] ℹ️    - Diagnosis 6: 'None'
[00:43:25] ℹ️  Final extracted MRN: '2447688'
[00:43:25] ℹ️  Final extracted Sex: 'MALE'
[00:43:25] ℹ️  Final extracted Service Line: 'Nursing'
[00:43:25] ℹ️  Final extracted Payer Source: ''
[00:43:25] ✅ Patient data extraction completed successfully
[00:43:25] ✅    ✅ Patient data extracted successfully
[00:43:25] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:43:25] ✅    ✅ Patient identified: George England
[00:43:25] ✅    ✅ Patient name validation passed
[00:43:25] 🔄 
🔄 Step 3: Processing patient dates...
[00:43:25] [DOC: 9223413] ℹ️  DOB normalized: 08/26/1924
[00:43:25] [DOC: 9223413] ✅ Patient date processing completed successfully
[00:43:25] ✅    ✅ Date processing completed
[00:43:25] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[00:43:25] 🔄 
🔄 Step 4: Extracting order data...
[00:43:27] ℹ️  Order extraction - MRN: '2447688'
[00:43:27] ℹ️  Order extraction - Sex: 'MALE'
[00:43:27] ℹ️  Order extraction - Service Line: ''
[00:43:27] ℹ️  Order extraction - Payer Source: ''
[00:43:27] ✅ Order data extraction completed successfully
[00:43:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:43:27] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[00:43:27] ℹ️  Using service line from patient data: 'Nursing'
[00:43:27] ✅ Patient name cross-validation successful
[00:43:27] ✅    ✅ Data merged successfully
[00:43:29] ✅    ✅ Order data extracted and validated
[00:43:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:43:29] [DOC: 9223413] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:43:29] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:43:29] 🔄 
🔄 Step 6: Pushing order to API...
[00:43:29] [DOC: 9223413] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:43:30] [DOC: 9223413] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20062"}
[00:43:30] ❌    ❌ Failed to push order
[00:43:30] 🔄 
🔄 Step 7: Writing to CSV...
[00:43:30] [DOC: 9223413] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[00:43:30] [DOC: 9223413] ℹ️  Service Line extracted: 'Nursing'
[00:43:30] [DOC: 9223413] ℹ️  Payer Source extracted: ''
[00:43:30] [DOC: 9223413] ℹ️  Diagnosis codes being written:
[00:43:30] [DOC: 9223413] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:43:30] [DOC: 9223413] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:43:30] [DOC: 9223413] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:43:30] [DOC: 9223413] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:43:30] [DOC: 9223413] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:43:30] [DOC: 9223413] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:43:30] [DOC: 9223413] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Nursing | Payer:  | MRN: 2447688
[00:43:30] ✅    ✅ Document 9223413 processed and saved successfully
[00:43:30] 🔄 
🔄 Step 8: Saving API details...
[00:43:30] [DOC: 9223413] ℹ️  API push details saved for document 9223413
[00:43:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221901                         ║
================================================================================
[00:43:30] ℹ️  Agency: Dartmouth HH
[00:43:30] ℹ️  Date: 04/04/2025
[00:43:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:43:32] [DOC: 9221901] ✅ Text extracted using pdfplumber (3471 chars)
[00:43:32] ✅    ✅ Text extracted using pdfplumber (3471 chars)
[00:43:32] 🔄 
🔄 Step 2: Extracting patient data...
[00:43:35] ℹ️  AI extracted raw sex value: 'F'
[00:43:35] ℹ️  AI extracted service line: 'OT, RN, HHA'
[00:43:35] ℹ️  AI extracted payer source: 'Medicare'
[00:43:35] ℹ️  AI extracted diagnoses:
[00:43:35] ℹ️    - Diagnosis 1: ''
[00:43:35] ℹ️    - Diagnosis 2: ''
[00:43:35] ℹ️    - Diagnosis 3: ''
[00:43:35] ℹ️    - Diagnosis 4: ''
[00:43:35] ℹ️    - Diagnosis 5: ''
[00:43:35] ℹ️    - Diagnosis 6: ''
[00:43:35] ℹ️  Final extracted MRN: '6115015'
[00:43:35] ℹ️  Final extracted Sex: 'FEMALE'
[00:43:35] ℹ️  Final extracted Service Line: 'OT, RN, HHA'
[00:43:35] ℹ️  Final extracted Payer Source: 'Medicare'
[00:43:35] ✅ Patient data extraction completed successfully
[00:43:35] ✅    ✅ Patient data extracted successfully
[00:43:35] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:43:35] ✅    ✅ Patient identified: Nancy Silva
[00:43:35] ✅    ✅ Patient name validation passed
[00:43:35] 🔄 
🔄 Step 3: Processing patient dates...
[00:43:35] [DOC: 9221901] ℹ️  DOB normalized: 11/18/1936
[00:43:35] [DOC: 9221901] ℹ️  Episode startOfCare normalized: 03/01/2025
[00:43:35] [DOC: 9221901] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[00:43:35] [DOC: 9221901] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[00:43:35] [DOC: 9221901] ✅ Patient date processing completed successfully
[00:43:35] ✅    ✅ Date processing completed
[00:43:35] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:43:35] 🔄 
🔄 Step 4: Extracting order data...
[00:43:37] ℹ️  Order extraction - MRN: '6115015'
[00:43:37] ℹ️  Order extraction - Sex: 'FEMALE'
[00:43:37] ℹ️  Order extraction - Service Line: 'OT, RN'
[00:43:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:43:37] ✅ Order data extraction completed successfully
[00:43:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:43:37] ℹ️  Using MRN from patient data: '6115015' over '6115015'
[00:43:37] ℹ️  Combined service lines: Patient='OT, RN, HHA' + Order='OT, RN' = 'HHA, OT, RN'
[00:43:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:43:37] ✅ Patient name cross-validation successful
[00:43:37] ✅    ✅ Data merged successfully
[00:43:39] ✅    ✅ Order data extracted and validated
[00:43:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:43:39] [DOC: 9221901] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:43:39] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:43:39] 🔄 
🔄 Step 6: Pushing order to API...
[00:43:39] [DOC: 9221901] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[00:43:40] [DOC: 9221901] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:43:40] ❌    ❌ Failed to push order
[00:43:40] 🔄 
🔄 Step 7: Writing to CSV...
[00:43:40] [DOC: 9221901] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[00:43:40] [DOC: 9221901] ℹ️  Service Line extracted: 'HHA, OT, RN'
[00:43:40] [DOC: 9221901] ℹ️  Payer Source extracted: 'Medicare'
[00:43:40] [DOC: 9221901] ℹ️  Diagnosis codes being written:
[00:43:40] [DOC: 9221901] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:43:40] [DOC: 9221901] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:43:40] [DOC: 9221901] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:43:40] [DOC: 9221901] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:43:40] [DOC: 9221901] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:43:40] [DOC: 9221901] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:43:40] [DOC: 9221901] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: HHA, OT, RN | Payer: Medicare | MRN: 6115015
[00:43:40] ✅    ✅ Document 9221901 processed and saved successfully
[00:43:40] 🔄 
🔄 Step 8: Saving API details...
[00:43:40] [DOC: 9221901] ℹ️  API push details saved for document 9221901
[00:43:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221892                         ║
================================================================================
[00:43:40] ℹ️  Agency: Dartmouth HH
[00:43:40] ℹ️  Date: 04/04/2025
[00:43:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:43:44] [DOC: 9221892] ✅ Text extracted using pdfplumber (3615 chars)
[00:43:44] ✅    ✅ Text extracted using pdfplumber (3615 chars)
[00:43:44] 🔄 
🔄 Step 2: Extracting patient data...
[00:43:46] ℹ️  AI extracted raw sex value: 'M'
[00:43:46] ℹ️  AI extracted service line: 'PT, RN'
[00:43:46] ℹ️  AI extracted payer source: 'Medicare'
[00:43:46] ℹ️  AI extracted diagnoses:
[00:43:46] ℹ️    - Diagnosis 1: ''
[00:43:46] ℹ️    - Diagnosis 2: ''
[00:43:46] ℹ️    - Diagnosis 3: ''
[00:43:46] ℹ️    - Diagnosis 4: ''
[00:43:46] ℹ️    - Diagnosis 5: ''
[00:43:46] ℹ️    - Diagnosis 6: ''
[00:43:46] ℹ️  Final extracted MRN: '2496015'
[00:43:46] ℹ️  Final extracted Sex: 'MALE'
[00:43:46] ℹ️  Final extracted Service Line: 'PT, RN'
[00:43:46] ℹ️  Final extracted Payer Source: 'Medicare'
[00:43:46] ✅ Patient data extraction completed successfully
[00:43:46] ✅    ✅ Patient data extracted successfully
[00:43:46] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:43:46] ✅    ✅ Patient identified: Dana Theodore
[00:43:46] ✅    ✅ Patient name validation passed
[00:43:46] 🔄 
🔄 Step 3: Processing patient dates...
[00:43:46] [DOC: 9221892] ℹ️  DOB normalized: 03/16/1954
[00:43:46] [DOC: 9221892] ℹ️  Episode startOfCare normalized: 03/02/2025
[00:43:46] [DOC: 9221892] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[00:43:46] [DOC: 9221892] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[00:43:46] [DOC: 9221892] ✅ Patient date processing completed successfully
[00:43:46] ✅    ✅ Date processing completed
[00:43:46] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:43:46] 🔄 
🔄 Step 4: Extracting order data...
[00:43:49] ℹ️  Order extraction - MRN: ''
[00:43:49] ℹ️  Order extraction - Sex: 'FEMALE'
[00:43:49] ℹ️  Order extraction - Service Line: 'PT, RN'
[00:43:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:43:49] ✅ Order data extraction completed successfully
[00:43:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:43:49] ℹ️  Using MRN from patient data: '2496015'
[00:43:49] ⚠️  Sex mismatch: Patient='MALE' vs Order='FEMALE', using patient data
[00:43:49] ℹ️  Service line consistent in both sources: 'PT, RN'
[00:43:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:43:49] ✅ Patient name cross-validation successful
[00:43:49] ✅    ✅ Data merged successfully
[00:43:50] ✅    ✅ Order data extracted and validated
[00:43:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:43:50] [DOC: 9221892] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:43:50] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:43:50] 🔄 
🔄 Step 6: Pushing order to API...
[00:43:50] [DOC: 9221892] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[00:43:52] [DOC: 9221892] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:43:52] ❌    ❌ Failed to push order
[00:43:52] 🔄 
🔄 Step 7: Writing to CSV...
[00:43:52] [DOC: 9221892] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[00:43:52] [DOC: 9221892] ℹ️  Service Line extracted: 'PT, RN'
[00:43:52] [DOC: 9221892] ℹ️  Payer Source extracted: 'Medicare'
[00:43:52] [DOC: 9221892] ℹ️  Diagnosis codes being written:
[00:43:52] [DOC: 9221892] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:43:52] [DOC: 9221892] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:43:52] [DOC: 9221892] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:43:52] [DOC: 9221892] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:43:52] [DOC: 9221892] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:43:52] [DOC: 9221892] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:43:52] [DOC: 9221892] ✅ Patient data written to CSV: Dana Theodore | Sex: MALE | Age: 71 | Service: PT, RN | Payer: Medicare | MRN: 2496015
[00:43:52] ✅    ✅ Document 9221892 processed and saved successfully
[00:43:52] 🔄 
🔄 Step 8: Saving API details...
[00:43:52] [DOC: 9221892] ℹ️  API push details saved for document 9221892
[00:43:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9221883                         ║
================================================================================
[00:43:52] ℹ️  Agency: Dartmouth HH
[00:43:52] ℹ️  Date: 04/04/2025
[00:43:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:43:54] [DOC: 9221883] ✅ Text extracted using pdfplumber (1022 chars)
[00:43:54] ✅    ✅ Text extracted using pdfplumber (1022 chars)
[00:43:54] 🔄 
🔄 Step 2: Extracting patient data...
[00:43:57] ℹ️  AI extracted raw sex value: 'F'
[00:43:57] ℹ️  AI extracted service line: 'RN'
[00:43:57] ℹ️  AI extracted payer source: 'Medicare'
[00:43:57] ℹ️  AI extracted diagnoses:
[00:43:57] ℹ️    - Diagnosis 1: ''
[00:43:57] ℹ️    - Diagnosis 2: ''
[00:43:57] ℹ️    - Diagnosis 3: ''
[00:43:57] ℹ️    - Diagnosis 4: ''
[00:43:57] ℹ️    - Diagnosis 5: ''
[00:43:57] ℹ️    - Diagnosis 6: ''
[00:43:57] ℹ️  Final extracted MRN: '5915015'
[00:43:57] ℹ️  Final extracted Sex: 'FEMALE'
[00:43:57] ℹ️  Final extracted Service Line: 'RN'
[00:43:57] ℹ️  Final extracted Payer Source: 'Medicare'
[00:43:57] ✅ Patient data extraction completed successfully
[00:43:57] ✅    ✅ Patient data extracted successfully
[00:43:57] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:43:57] ✅    ✅ Patient identified: Suzanne Fawcett
[00:43:57] ✅    ✅ Patient name validation passed
[00:43:57] 🔄 
🔄 Step 3: Processing patient dates...
[00:43:57] [DOC: 9221883] ℹ️  DOB normalized: 12/08/1939
[00:43:57] [DOC: 9221883] ℹ️  Episode startOfCare normalized: 01/26/2025
[00:43:57] [DOC: 9221883] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[00:43:57] [DOC: 9221883] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[00:43:57] [DOC: 9221883] ✅ Patient date processing completed successfully
[00:43:57] ✅    ✅ Date processing completed
[00:43:57] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:43:57] 🔄 
🔄 Step 4: Extracting order data...
[00:43:59] ℹ️  Order extraction - MRN: ''
[00:43:59] ℹ️  Order extraction - Sex: 'FEMALE'
[00:43:59] ℹ️  Order extraction - Service Line: 'RN'
[00:43:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:43:59] ✅ Order data extraction completed successfully
[00:43:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:43:59] ℹ️  Using MRN from patient data: '5915015'
[00:43:59] ℹ️  Service line consistent in both sources: 'RN'
[00:43:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:43:59] ✅ Patient name cross-validation successful
[00:43:59] ✅    ✅ Data merged successfully
[00:44:01] ✅    ✅ Order data extracted and validated
[00:44:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:44:01] [DOC: 9221883] ✅ Patient found in local cache: Suzanne Fawcett, ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:44:01] ✅    ✅ Existing patient found with ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:44:01] 🔄 
🔄 Step 6: Pushing order to API...
[00:44:01] [DOC: 9221883] ℹ️  Pushing order via API for patient ID: 028c2716-dede-40f1-9f97-db8c7457c7d4
[00:44:02] [DOC: 9221883] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13932"}
[00:44:02] ❌    ❌ Failed to push order
[00:44:02] 🔄 
🔄 Step 7: Writing to CSV...
[00:44:02] [DOC: 9221883] ℹ️  Calculated age: 85 from DOB: 12/08/1939
[00:44:02] [DOC: 9221883] ℹ️  Service Line extracted: 'RN'
[00:44:02] [DOC: 9221883] ℹ️  Payer Source extracted: 'Medicare'
[00:44:02] [DOC: 9221883] ℹ️  Diagnosis codes being written:
[00:44:02] [DOC: 9221883] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:44:02] [DOC: 9221883] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:44:02] [DOC: 9221883] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:44:02] [DOC: 9221883] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:44:02] [DOC: 9221883] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:44:02] [DOC: 9221883] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:44:02] [DOC: 9221883] ✅ Patient data written to CSV: Suzanne Fawcett | Sex: FEMALE | Age: 85 | Service: RN | Payer: Medicare | MRN: 5915015
[00:44:02] ✅    ✅ Document 9221883 processed and saved successfully
[00:44:02] 🔄 
🔄 Step 8: Saving API details...
[00:44:02] [DOC: 9221883] ℹ️  API push details saved for document 9221883
[00:44:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9219104                         ║
================================================================================
[00:44:02] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:44:02] ℹ️  Date: 04/03/2025
[00:44:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:44:04] [DOC: 9219104] ✅ Text extracted using pdfplumber (983 chars)
[00:44:04] ✅    ✅ Text extracted using pdfplumber (983 chars)
[00:44:04] 🔄 
🔄 Step 2: Extracting patient data...
[00:44:06] ℹ️  AI extracted raw sex value: 'M'
[00:44:06] ℹ️  AI extracted service line: 'Physical Therapy'
[00:44:06] ℹ️  AI extracted payer source: ''
[00:44:06] ℹ️  AI extracted diagnoses:
[00:44:06] ℹ️    - Diagnosis 1: ''
[00:44:06] ℹ️    - Diagnosis 2: ''
[00:44:06] ℹ️    - Diagnosis 3: ''
[00:44:06] ℹ️    - Diagnosis 4: ''
[00:44:06] ℹ️    - Diagnosis 5: ''
[00:44:06] ℹ️    - Diagnosis 6: ''
[00:44:06] ℹ️  Final extracted MRN: '2447688'
[00:44:06] ℹ️  Final extracted Sex: 'MALE'
[00:44:06] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:44:06] ℹ️  Final extracted Payer Source: ''
[00:44:06] ✅ Patient data extraction completed successfully
[00:44:06] ✅    ✅ Patient data extracted successfully
[00:44:06] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:44:06] ✅    ✅ Patient identified: George England
[00:44:06] ✅    ✅ Patient name validation passed
[00:44:06] 🔄 
🔄 Step 3: Processing patient dates...
[00:44:06] [DOC: 9219104] ℹ️  DOB normalized: 08/26/1924
[00:44:06] [DOC: 9219104] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[00:44:06] [DOC: 9219104] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[00:44:06] [DOC: 9219104] ✅ Patient date processing completed successfully
[00:44:06] ✅    ✅ Date processing completed
[00:44:06] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:44:06] 🔄 
🔄 Step 4: Extracting order data...
[00:44:08] ℹ️  Order extraction - MRN: '2447688'
[00:44:08] ℹ️  Order extraction - Sex: 'MALE'
[00:44:08] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:44:08] ℹ️  Order extraction - Payer Source: ''
[00:44:08] ✅ Order data extraction completed successfully
[00:44:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:44:08] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[00:44:08] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:44:08] ✅ Patient name cross-validation successful
[00:44:08] ✅    ✅ Data merged successfully
[00:44:10] ✅    ✅ Order data extracted and validated
[00:44:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:44:10] [DOC: 9219104] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:44:10] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:44:10] 🔄 
🔄 Step 6: Pushing order to API...
[00:44:10] [DOC: 9219104] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:44:11] [DOC: 9219104] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14167"}
[00:44:11] ❌    ❌ Failed to push order
[00:44:11] 🔄 
🔄 Step 7: Writing to CSV...
[00:44:11] [DOC: 9219104] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[00:44:11] [DOC: 9219104] ℹ️  Service Line extracted: 'Physical Therapy'
[00:44:11] [DOC: 9219104] ℹ️  Payer Source extracted: ''
[00:44:11] [DOC: 9219104] ℹ️  Diagnosis codes being written:
[00:44:11] [DOC: 9219104] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:44:11] [DOC: 9219104] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:44:11] [DOC: 9219104] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:44:11] [DOC: 9219104] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:44:11] [DOC: 9219104] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:44:11] [DOC: 9219104] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:44:11] [DOC: 9219104] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Physical Therapy | Payer:  | MRN: 2447688
[00:44:11] ✅    ✅ Document 9219104 processed and saved successfully
[00:44:11] 🔄 
🔄 Step 8: Saving API details...
[00:44:11] [DOC: 9219104] ℹ️  API push details saved for document 9219104
[00:44:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9216796                         ║
================================================================================
[00:44:11] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[00:44:11] ℹ️  Date: 04/02/2025
[00:44:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:44:14] [DOC: 9216796] ✅ Text extracted using pdfplumber (6706 chars)
[00:44:14] ✅    ✅ Text extracted using pdfplumber (6694 chars)
[00:44:14] 🔄 
🔄 Step 2: Extracting patient data...
[00:44:17] ℹ️  AI extracted raw sex value: 'F'
[00:44:17] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[00:44:17] ℹ️  AI extracted payer source: 'None'
[00:44:17] ℹ️  AI extracted diagnoses:
[00:44:17] ℹ️    - Diagnosis 1: 'E11.22'
[00:44:17] ℹ️    - Diagnosis 2: 'I13.0'
[00:44:17] ℹ️    - Diagnosis 3: 'I50.32'
[00:44:17] ℹ️    - Diagnosis 4: 'N18.30'
[00:44:17] ℹ️    - Diagnosis 5: 'D63.1'
[00:44:17] ℹ️    - Diagnosis 6: 'F41.8'
[00:44:17] ℹ️  Final extracted MRN: '227504'
[00:44:17] ℹ️  Final extracted Sex: 'FEMALE'
[00:44:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[00:44:17] ℹ️  Final extracted Payer Source: ''
[00:44:17] ✅ Patient data extraction completed successfully
[00:44:17] ✅    ✅ Patient data extracted successfully
[00:44:17] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227504
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[00:44:17] ✅    ✅ Patient identified: Lorraine Moniz
[00:44:17] ✅    ✅ Patient name validation passed
[00:44:17] 🔄 
🔄 Step 3: Processing patient dates...
[00:44:17] [DOC: 9216796] ℹ️  DOB normalized: 07/18/1944
[00:44:17] [DOC: 9216796] ℹ️  Episode startOfCare normalized: 04/05/2024
[00:44:17] [DOC: 9216796] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[00:44:17] [DOC: 9216796] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[00:44:17] [DOC: 9216796] ✅ Patient date processing completed successfully
[00:44:17] ✅    ✅ Date processing completed
[00:44:17] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Moniz
     └─ dob: 07/18/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227504
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'F41.8'}]
[00:44:17] 🔄 
🔄 Step 4: Extracting order data...
[00:44:20] ℹ️  Order extraction - MRN: '227504'
[00:44:20] ℹ️  Order extraction - Sex: 'FEMALE'
[00:44:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[00:44:20] ℹ️  Order extraction - Payer Source: ''
[00:44:20] ✅ Order data extraction completed successfully
[00:44:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:44:20] ℹ️  Using MRN from patient data: '227504' over '227504'
[00:44:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[00:44:20] ✅ Patient name cross-validation successful
[00:44:20] ✅    ✅ Data merged successfully
[00:44:21] ✅    ✅ Order data extracted and validated
[00:44:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:44:21] [DOC: 9216796] ✅ Patient found in local cache: Lorraine Moniz, ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[00:44:21] ✅    ✅ Existing patient found with ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[00:44:21] 🔄 
🔄 Step 6: Pushing order to API...
[00:44:21] [DOC: 9216796] ℹ️  Pushing order via API for patient ID: b3098610-b96c-4369-86de-cef67fbdc9c7
[00:44:24] [DOC: 9216796] ❌ Order push failed with status 201: {"id":"259b7bfc-472a-420e-b2b6-3d005cbe74c7","orderWAVId":"ORD20089","orderNo":"528005","orderDate":"04/01/2025","startOfCare":"04/05/2024","episodeStartDate":"03/31/2025","episodeEndDate":"05/29/2025","documentID":"9216796","mrn":"227504","patientName":"Moniz, Lorraine","sentToPhysicianDate":"04/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/02/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"b3098610-b96c-4369-86de-cef67fbdc9c7","companyId":"0f46ebbe-720c-4abb-8809-892864387620","pgCompanyId":"3bef7fdb-bf2d-49d6-944c-4edfecd704b7","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[00:44:24] ❌    ❌ Failed to push order
[00:44:24] 🔄 
🔄 Step 7: Writing to CSV...
[00:44:24] [DOC: 9216796] ℹ️  Calculated age: 80 from DOB: 07/18/1944
[00:44:24] [DOC: 9216796] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[00:44:24] [DOC: 9216796] ℹ️  Payer Source extracted: ''
[00:44:24] [DOC: 9216796] ℹ️  Diagnosis codes being written:
[00:44:24] [DOC: 9216796] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[00:44:24] [DOC: 9216796] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[00:44:24] [DOC: 9216796] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[00:44:24] [DOC: 9216796] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[00:44:24] [DOC: 9216796] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[00:44:24] [DOC: 9216796] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.8'
[00:44:24] [DOC: 9216796] ✅ Patient data written to CSV: Lorraine Moniz | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, PT | Payer:  | MRN: 227504
[00:44:24] ✅    ✅ Document 9216796 processed and saved successfully
[00:44:24] 🔄 
🔄 Step 8: Saving API details...
[00:44:24] [DOC: 9216796] ℹ️  API push details saved for document 9216796
[00:44:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9213763                         ║
================================================================================
[00:44:24] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:44:24] ℹ️  Date: 04/01/2025
[00:44:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:44:27] [DOC: 9213763] ✅ Text extracted using pdfplumber (61998 chars)
[00:44:27] ✅    ✅ Text extracted using pdfplumber (61998 chars)
[00:44:27] 🔄 
🔄 Step 2: Extracting patient data...
[00:44:31] ℹ️  AI extracted raw sex value: 'None'
[00:44:31] ℹ️  AI extracted service line: 'None'
[00:44:31] ℹ️  AI extracted payer source: 'None'
[00:44:31] ℹ️  AI extracted diagnoses:
[00:44:31] ℹ️    - Diagnosis 1: ''
[00:44:31] ℹ️    - Diagnosis 2: ''
[00:44:31] ℹ️    - Diagnosis 3: ''
[00:44:31] ℹ️    - Diagnosis 4: ''
[00:44:31] ℹ️    - Diagnosis 5: ''
[00:44:31] ℹ️    - Diagnosis 6: ''
[00:44:31] ℹ️  Final extracted MRN: ''
[00:44:31] ℹ️  Final extracted Sex: ''
[00:44:31] ℹ️  Final extracted Service Line: ''
[00:44:31] ℹ️  Final extracted Payer Source: ''
[00:44:31] ✅ Patient data extraction completed successfully
[00:44:31] ✅    ✅ Patient data extracted successfully
[00:44:31] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[00:44:31] ⚠️     ❌ Insufficient patient data extracted
[00:44:31] [DOC: 9213763] ℹ️  API push details saved for document 9213763
================================================================================
║                        Processing Document ID: 9211619                         ║
================================================================================
[00:44:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:44:31] ℹ️  Date: 03/31/2025
[00:44:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:44:33] [DOC: 9211619] ✅ Text extracted using pdfplumber (1608 chars)
[00:44:33] ✅    ✅ Text extracted using pdfplumber (1608 chars)
[00:44:33] 🔄 
🔄 Step 2: Extracting patient data...
[00:44:36] ℹ️  AI extracted raw sex value: 'M'
[00:44:36] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:44:36] ℹ️  AI extracted payer source: ''
[00:44:36] ℹ️  AI extracted diagnoses:
[00:44:36] ℹ️    - Diagnosis 1: ''
[00:44:36] ℹ️    - Diagnosis 2: ''
[00:44:36] ℹ️    - Diagnosis 3: ''
[00:44:36] ℹ️    - Diagnosis 4: ''
[00:44:36] ℹ️    - Diagnosis 5: ''
[00:44:36] ℹ️    - Diagnosis 6: ''
[00:44:36] ℹ️  Final extracted MRN: '2447688'
[00:44:36] ℹ️  Final extracted Sex: 'MALE'
[00:44:36] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:44:36] ℹ️  Final extracted Payer Source: ''
[00:44:36] ✅ Patient data extraction completed successfully
[00:44:36] ✅    ✅ Patient data extracted successfully
[00:44:36] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:44:36] ✅    ✅ Patient identified: George England
[00:44:36] ✅    ✅ Patient name validation passed
[00:44:36] 🔄 
🔄 Step 3: Processing patient dates...
[00:44:36] [DOC: 9211619] ℹ️  DOB normalized: 08/26/1924
[00:44:36] [DOC: 9211619] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[00:44:36] [DOC: 9211619] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[00:44:36] [DOC: 9211619] ✅ Patient date processing completed successfully
[00:44:36] ✅    ✅ Date processing completed
[00:44:36] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:44:36] 🔄 
🔄 Step 4: Extracting order data...
[00:44:38] ℹ️  Order extraction - MRN: '2447688'
[00:44:38] ℹ️  Order extraction - Sex: 'MALE'
[00:44:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:44:38] ℹ️  Order extraction - Payer Source: ''
[00:44:38] ✅ Order data extraction completed successfully
[00:44:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:44:38] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[00:44:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:44:38] ✅ Patient name cross-validation successful
[00:44:38] ✅    ✅ Data merged successfully
[00:44:39] ✅    ✅ Order data extracted and validated
[00:44:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:44:39] [DOC: 9211619] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:44:39] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:44:39] 🔄 
🔄 Step 6: Pushing order to API...
[00:44:39] [DOC: 9211619] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[00:44:41] [DOC: 9211619] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD20072"}
[00:44:41] ❌    ❌ Failed to push order
[00:44:41] 🔄 
🔄 Step 7: Writing to CSV...
[00:44:41] [DOC: 9211619] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[00:44:41] [DOC: 9211619] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[00:44:41] [DOC: 9211619] ℹ️  Payer Source extracted: ''
[00:44:41] [DOC: 9211619] ℹ️  Diagnosis codes being written:
[00:44:41] [DOC: 9211619] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:44:41] [DOC: 9211619] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:44:41] [DOC: 9211619] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:44:41] [DOC: 9211619] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:44:41] [DOC: 9211619] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:44:41] [DOC: 9211619] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:44:41] [DOC: 9211619] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2447688
[00:44:41] ✅    ✅ Document 9211619 processed and saved successfully
[00:44:41] 🔄 
🔄 Step 8: Saving API details...
[00:44:41] [DOC: 9211619] ℹ️  API push details saved for document 9211619
[00:44:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9210977                         ║
================================================================================
[00:44:41] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[00:44:41] ℹ️  Date: 03/30/2025
[00:44:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:44:45] [DOC: 9210977] ✅ Text extracted using pdfplumber (2169 chars)
[00:44:45] ✅    ✅ Text extracted using pdfplumber (2157 chars)
[00:44:45] 🔄 
🔄 Step 2: Extracting patient data...
[00:44:48] ℹ️  AI extracted raw sex value: ''
[00:44:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:44:48] ℹ️  AI extracted payer source: 'Medicare'
[00:44:48] ℹ️  AI extracted diagnoses:
[00:44:48] ℹ️    - Diagnosis 1: 'None'
[00:44:48] ℹ️    - Diagnosis 2: 'None'
[00:44:48] ℹ️    - Diagnosis 3: 'None'
[00:44:48] ℹ️    - Diagnosis 4: 'None'
[00:44:48] ℹ️    - Diagnosis 5: 'None'
[00:44:48] ℹ️    - Diagnosis 6: 'None'
[00:44:48] ℹ️  Final extracted MRN: '28700120687001'
[00:44:48] ℹ️  Final extracted Sex: ''
[00:44:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:44:48] ℹ️  Final extracted Payer Source: 'Medicare'
[00:44:48] ✅ Patient data extraction completed successfully
[00:44:48] ✅    ✅ Patient data extracted successfully
[00:44:48] 📊 Patient Response
     └─ patientFName: WILLIAM
     └─ patientLName: WARECKI
     └─ dob: 06/04/1944
     └─ patientSex: 
     └─ medicalRecordNo: 28700120687001
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 537 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/18/2024', 'endOfEpisode': '11/24/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '02/12/2025', 'endOfEpisode': '02/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[00:44:48] ✅    ✅ Patient identified: WILLIAM WARECKI
[00:44:48] ✅    ✅ Patient name validation passed
[00:44:48] 🔄 
🔄 Step 3: Processing patient dates...
[00:44:48] [DOC: 9210977] ℹ️  DOB normalized: 06/04/1944
[00:44:48] [DOC: 9210977] ℹ️  Episode startOfEpisode normalized: 11/18/2024
[00:44:48] [DOC: 9210977] ℹ️  Episode endOfEpisode normalized: 11/24/2024
[00:44:48] [DOC: 9210977] ✅ Patient date processing completed successfully
[00:44:48] ✅    ✅ Date processing completed
[00:44:48] 📊 Processed Patient Data
     └─ patientFName: WILLIAM
     └─ patientLName: WARECKI
     └─ dob: 06/04/1944
     └─ patientSex: 
     └─ medicalRecordNo: 28700120687001
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 537 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/18/2024', 'endOfEpisode': '11/24/2024'}, {'startOfCare': '', 'startOfEpisode': '02/12/2025', 'endOfEpisode': '02/20/2025'}]
[00:44:48] 🔄 
🔄 Step 4: Extracting order data...
[00:44:51] ℹ️  Order extraction - MRN: '28700120687001'
[00:44:51] ℹ️  Order extraction - Sex: ''
[00:44:51] ℹ️  Order extraction - Service Line: 'RN'
[00:44:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[00:44:51] ✅ Order data extraction completed successfully
[00:44:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:44:51] ℹ️  Using MRN from patient data: '28700120687001' over '28700120687001'
[00:44:51] ℹ️  Inferred sex as MALE from name: WILLIAM
[00:44:51] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[00:44:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[00:44:51] ✅ Patient name cross-validation successful
[00:44:51] ✅    ✅ Data merged successfully
[00:44:52] ✅    ✅ Order data extracted and validated
[00:44:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:44:54] [DOC: 9210977] ℹ️  Patient not found in cache or API: WILLIAM WARECKI
[00:44:54] [DOC: 9210977] ℹ️  Patient not found, creating new patient via API...
[00:44:54] [DOC: 9210977] ℹ️  Creating patient via API: WILLIAM WARECKI
[00:44:55] [DOC: 9210977] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:44:55] ❌    ❌ Failed to create patient
[00:44:55] [DOC: 9210977] ℹ️  API push details saved for document 9210977
================================================================================
║                        Processing Document ID: 9206491                         ║
================================================================================
[00:44:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:44:55] ℹ️  Date: 03/27/2025
[00:44:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:44:58] [DOC: 9206491] ✅ Text extracted using pdfplumber (1180 chars)
[00:44:58] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[00:44:58] 🔄 
🔄 Step 2: Extracting patient data...
[00:45:01] ℹ️  AI extracted raw sex value: ''
[00:45:01] ℹ️  AI extracted service line: 'Physical Therapy'
[00:45:01] ℹ️  AI extracted payer source: ''
[00:45:01] ℹ️  AI extracted diagnoses:
[00:45:01] ℹ️    - Diagnosis 1: 'F03.90'
[00:45:01] ℹ️    - Diagnosis 2: 'R41.0'
[00:45:01] ℹ️    - Diagnosis 3: 'I10'
[00:45:01] ℹ️    - Diagnosis 4: ''
[00:45:01] ℹ️    - Diagnosis 5: ''
[00:45:01] ℹ️    - Diagnosis 6: ''
[00:45:01] ℹ️  Final extracted MRN: '101002156'
[00:45:01] ℹ️  Final extracted Sex: ''
[00:45:01] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:45:01] ℹ️  Final extracted Payer Source: ''
[00:45:01] ✅ Patient data extraction completed successfully
[00:45:01] ✅    ✅ Patient data extracted successfully
[00:45:01] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:01] ✅    ✅ Patient identified: Eleanor Martin
[00:45:01] ✅    ✅ Patient name validation passed
[00:45:01] 🔄 
🔄 Step 3: Processing patient dates...
[00:45:01] [DOC: 9206491] ℹ️  DOB normalized: 03/25/1934
[00:45:01] [DOC: 9206491] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:45:01] [DOC: 9206491] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:45:01] [DOC: 9206491] ✅ Patient date processing completed successfully
[00:45:01] ✅    ✅ Date processing completed
[00:45:01] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:01] 🔄 
🔄 Step 4: Extracting order data...
[00:45:03] ℹ️  Order extraction - MRN: '101002156'
[00:45:03] ℹ️  Order extraction - Sex: ''
[00:45:03] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:45:03] ℹ️  Order extraction - Payer Source: ''
[00:45:03] ✅ Order data extraction completed successfully
[00:45:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:45:03] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:45:03] ⚠️  Could not determine sex using any available method
[00:45:03] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:45:03] ✅ Patient name cross-validation successful
[00:45:03] ✅    ✅ Data merged successfully
[00:45:05] ✅    ✅ Order data extracted and validated
[00:45:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:45:07] [DOC: 9206491] ✅ Patient exists in API: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:07] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:45:07] [DOC: 9206491] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:08] [DOC: 9206491] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14031"}
[00:45:08] ❌    ❌ Failed to push order
[00:45:08] 🔄 
🔄 Step 7: Writing to CSV...
[00:45:08] [DOC: 9206491] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:45:08] [DOC: 9206491] ℹ️  Service Line extracted: 'Physical Therapy'
[00:45:08] [DOC: 9206491] ℹ️  Payer Source extracted: ''
[00:45:08] [DOC: 9206491] ℹ️  Diagnosis codes being written:
[00:45:08] [DOC: 9206491] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:45:08] [DOC: 9206491] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:45:08] [DOC: 9206491] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:45:08] [DOC: 9206491] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:45:08] [DOC: 9206491] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:45:08] [DOC: 9206491] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:45:08] [DOC: 9206491] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Physical Therapy | Payer:  | MRN: 101002156
[00:45:08] ✅    ✅ Document 9206491 processed and saved successfully
[00:45:08] 🔄 
🔄 Step 8: Saving API details...
[00:45:08] [DOC: 9206491] ℹ️  API push details saved for document 9206491
[00:45:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206483                         ║
================================================================================
[00:45:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:45:08] ℹ️  Date: 03/27/2025
[00:45:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:45:11] [DOC: 9206483] ✅ Text extracted using pdfplumber (1150 chars)
[00:45:11] ✅    ✅ Text extracted using pdfplumber (1150 chars)
[00:45:11] 🔄 
🔄 Step 2: Extracting patient data...
[00:45:14] ℹ️  AI extracted raw sex value: ''
[00:45:14] ℹ️  AI extracted service line: 'Physical Therapy'
[00:45:14] ℹ️  AI extracted payer source: ''
[00:45:14] ℹ️  AI extracted diagnoses:
[00:45:14] ℹ️    - Diagnosis 1: 'F03.90'
[00:45:14] ℹ️    - Diagnosis 2: 'R41.0'
[00:45:14] ℹ️    - Diagnosis 3: 'I10'
[00:45:14] ℹ️    - Diagnosis 4: ''
[00:45:14] ℹ️    - Diagnosis 5: ''
[00:45:14] ℹ️    - Diagnosis 6: ''
[00:45:14] ℹ️  Final extracted MRN: '101002156'
[00:45:14] ℹ️  Final extracted Sex: ''
[00:45:14] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:45:14] ℹ️  Final extracted Payer Source: ''
[00:45:14] ✅ Patient data extraction completed successfully
[00:45:14] ✅    ✅ Patient data extracted successfully
[00:45:14] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:14] ✅    ✅ Patient identified: Eleanor Martin
[00:45:14] ✅    ✅ Patient name validation passed
[00:45:14] 🔄 
🔄 Step 3: Processing patient dates...
[00:45:14] [DOC: 9206483] ℹ️  DOB normalized: 03/25/1934
[00:45:14] [DOC: 9206483] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:45:14] [DOC: 9206483] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:45:14] [DOC: 9206483] ✅ Patient date processing completed successfully
[00:45:14] ✅    ✅ Date processing completed
[00:45:14] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:14] 🔄 
🔄 Step 4: Extracting order data...
[00:45:16] ℹ️  Order extraction - MRN: '101002156'
[00:45:16] ℹ️  Order extraction - Sex: ''
[00:45:16] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:45:16] ℹ️  Order extraction - Payer Source: ''
[00:45:16] ✅ Order data extraction completed successfully
[00:45:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:45:16] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:45:16] ⚠️  Could not determine sex using any available method
[00:45:16] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:45:16] ✅ Patient name cross-validation successful
[00:45:16] ✅    ✅ Data merged successfully
[00:45:18] ✅    ✅ Order data extracted and validated
[00:45:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:45:18] [DOC: 9206483] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:18] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:18] 🔄 
🔄 Step 6: Pushing order to API...
[00:45:18] [DOC: 9206483] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:19] [DOC: 9206483] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14032"}
[00:45:19] ❌    ❌ Failed to push order
[00:45:19] 🔄 
🔄 Step 7: Writing to CSV...
[00:45:19] [DOC: 9206483] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:45:19] [DOC: 9206483] ℹ️  Service Line extracted: 'Physical Therapy'
[00:45:19] [DOC: 9206483] ℹ️  Payer Source extracted: ''
[00:45:19] [DOC: 9206483] ℹ️  Diagnosis codes being written:
[00:45:19] [DOC: 9206483] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:45:19] [DOC: 9206483] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:45:19] [DOC: 9206483] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:45:19] [DOC: 9206483] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:45:19] [DOC: 9206483] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:45:19] [DOC: 9206483] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:45:19] [DOC: 9206483] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Physical Therapy | Payer:  | MRN: 101002156
[00:45:19] ✅    ✅ Document 9206483 processed and saved successfully
[00:45:19] 🔄 
🔄 Step 8: Saving API details...
[00:45:19] [DOC: 9206483] ℹ️  API push details saved for document 9206483
[00:45:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206480                         ║
================================================================================
[00:45:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:45:19] ℹ️  Date: 03/27/2025
[00:45:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:45:28] [DOC: 9206480] ✅ Text extracted using pdfplumber (15740 chars)
[00:45:28] ✅    ✅ Text extracted using pdfplumber (15740 chars)
[00:45:28] 🔄 
🔄 Step 2: Extracting patient data...
[00:45:31] ℹ️  AI extracted raw sex value: 'F'
[00:45:31] ℹ️  AI extracted service line: 'PT'
[00:45:31] ℹ️  AI extracted payer source: ''
[00:45:31] ℹ️  AI extracted diagnoses:
[00:45:31] ℹ️    - Diagnosis 1: ''
[00:45:31] ℹ️    - Diagnosis 2: ''
[00:45:31] ℹ️    - Diagnosis 3: ''
[00:45:31] ℹ️    - Diagnosis 4: ''
[00:45:31] ℹ️    - Diagnosis 5: ''
[00:45:31] ℹ️    - Diagnosis 6: ''
[00:45:31] ℹ️  Final extracted MRN: '101002156'
[00:45:31] ℹ️  Final extracted Sex: 'FEMALE'
[00:45:31] ℹ️  Final extracted Service Line: 'PT'
[00:45:31] ℹ️  Final extracted Payer Source: ''
[00:45:31] ✅ Patient data extraction completed successfully
[00:45:31] ✅    ✅ Patient data extracted successfully
[00:45:31] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002156
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:31] ✅    ✅ Patient identified: Eleanor Martin
[00:45:31] ✅    ✅ Patient name validation passed
[00:45:31] 🔄 
🔄 Step 3: Processing patient dates...
[00:45:31] [DOC: 9206480] ℹ️  DOB normalized: 03/25/1934
[00:45:31] [DOC: 9206480] ✅ Patient date processing completed successfully
[00:45:31] ✅    ✅ Date processing completed
[00:45:31] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002156
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:31] 🔄 
🔄 Step 4: Extracting order data...
[00:45:34] ℹ️  Order extraction - MRN: '101002156'
[00:45:34] ℹ️  Order extraction - Sex: 'FEMALE'
[00:45:34] ℹ️  Order extraction - Service Line: 'PT'
[00:45:34] ℹ️  Order extraction - Payer Source: ''
[00:45:34] ✅ Order data extraction completed successfully
[00:45:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:45:34] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:45:34] ℹ️  Service line consistent in both sources: 'PT'
[00:45:34] ✅ Patient name cross-validation successful
[00:45:34] ✅    ✅ Data merged successfully
[00:45:35] ✅    ✅ Order data extracted and validated
[00:45:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:45:35] [DOC: 9206480] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:35] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:35] 🔄 
🔄 Step 6: Pushing order to API...
[00:45:35] [DOC: 9206480] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:36] [DOC: 9206480] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[00:45:36] ❌    ❌ Failed to push order
[00:45:36] 🔄 
🔄 Step 7: Writing to CSV...
[00:45:36] [DOC: 9206480] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:45:36] [DOC: 9206480] ℹ️  Service Line extracted: 'PT'
[00:45:36] [DOC: 9206480] ℹ️  Payer Source extracted: ''
[00:45:36] [DOC: 9206480] ℹ️  Diagnosis codes being written:
[00:45:36] [DOC: 9206480] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[00:45:36] [DOC: 9206480] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[00:45:36] [DOC: 9206480] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[00:45:36] [DOC: 9206480] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:45:36] [DOC: 9206480] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:45:36] [DOC: 9206480] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:45:36] [DOC: 9206480] ✅ Patient data written to CSV: Eleanor Martin | Sex: FEMALE | Age: 91 | Service: PT | Payer:  | MRN: 101002156
[00:45:36] ✅    ✅ Document 9206480 processed and saved successfully
[00:45:36] 🔄 
🔄 Step 8: Saving API details...
[00:45:36] [DOC: 9206480] ℹ️  API push details saved for document 9206480
[00:45:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206479                         ║
================================================================================
[00:45:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:45:36] ℹ️  Date: 03/27/2025
[00:45:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:45:39] [DOC: 9206479] ✅ Text extracted using pdfplumber (1413 chars)
[00:45:39] ✅    ✅ Text extracted using pdfplumber (1413 chars)
[00:45:39] 🔄 
🔄 Step 2: Extracting patient data...
[00:45:41] ℹ️  AI extracted raw sex value: ''
[00:45:41] ℹ️  AI extracted service line: 'Physical Therapy'
[00:45:41] ℹ️  AI extracted payer source: ''
[00:45:41] ℹ️  AI extracted diagnoses:
[00:45:41] ℹ️    - Diagnosis 1: 'F03.90'
[00:45:41] ℹ️    - Diagnosis 2: 'R41.0'
[00:45:41] ℹ️    - Diagnosis 3: 'I10'
[00:45:41] ℹ️    - Diagnosis 4: ''
[00:45:41] ℹ️    - Diagnosis 5: ''
[00:45:41] ℹ️    - Diagnosis 6: ''
[00:45:41] ℹ️  Final extracted MRN: '101002156'
[00:45:41] ℹ️  Final extracted Sex: ''
[00:45:41] ℹ️  Final extracted Service Line: 'Physical Therapy'
[00:45:41] ℹ️  Final extracted Payer Source: ''
[00:45:41] ✅ Patient data extraction completed successfully
[00:45:41] ✅    ✅ Patient data extracted successfully
[00:45:41] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:41] ✅    ✅ Patient identified: Eleanor Martin
[00:45:41] ✅    ✅ Patient name validation passed
[00:45:41] 🔄 
🔄 Step 3: Processing patient dates...
[00:45:41] [DOC: 9206479] ℹ️  DOB normalized: 03/25/1934
[00:45:41] [DOC: 9206479] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:45:41] [DOC: 9206479] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:45:41] [DOC: 9206479] ✅ Patient date processing completed successfully
[00:45:41] ✅    ✅ Date processing completed
[00:45:41] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:41] 🔄 
🔄 Step 4: Extracting order data...
[00:45:44] ℹ️  Order extraction - MRN: '101002156'
[00:45:44] ℹ️  Order extraction - Sex: ''
[00:45:44] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[00:45:44] ℹ️  Order extraction - Payer Source: ''
[00:45:44] ✅ Order data extraction completed successfully
[00:45:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:45:44] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:45:44] ⚠️  Could not determine sex using any available method
[00:45:44] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[00:45:44] ✅ Patient name cross-validation successful
[00:45:44] ✅    ✅ Data merged successfully
[00:45:45] ✅    ✅ Order data extracted and validated
[00:45:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:45:45] [DOC: 9206479] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:45] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:45] 🔄 
🔄 Step 6: Pushing order to API...
[00:45:45] [DOC: 9206479] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:46] [DOC: 9206479] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14033"}
[00:45:46] ❌    ❌ Failed to push order
[00:45:46] 🔄 
🔄 Step 7: Writing to CSV...
[00:45:46] [DOC: 9206479] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:45:46] [DOC: 9206479] ℹ️  Service Line extracted: 'Physical Therapy'
[00:45:46] [DOC: 9206479] ℹ️  Payer Source extracted: ''
[00:45:46] [DOC: 9206479] ℹ️  Diagnosis codes being written:
[00:45:46] [DOC: 9206479] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:45:46] [DOC: 9206479] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:45:46] [DOC: 9206479] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:45:46] [DOC: 9206479] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:45:46] [DOC: 9206479] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:45:46] [DOC: 9206479] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:45:46] [DOC: 9206479] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Physical Therapy | Payer:  | MRN: 101002156
[00:45:46] ✅    ✅ Document 9206479 processed and saved successfully
[00:45:46] 🔄 
🔄 Step 8: Saving API details...
[00:45:46] [DOC: 9206479] ℹ️  API push details saved for document 9206479
[00:45:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206475                         ║
================================================================================
[00:45:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:45:46] ℹ️  Date: 03/27/2025
[00:45:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:45:49] [DOC: 9206475] ✅ Text extracted using pdfplumber (1145 chars)
[00:45:49] ✅    ✅ Text extracted using pdfplumber (1145 chars)
[00:45:49] 🔄 
🔄 Step 2: Extracting patient data...
[00:45:51] ℹ️  AI extracted raw sex value: ''
[00:45:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:45:51] ℹ️  AI extracted payer source: ''
[00:45:51] ℹ️  AI extracted diagnoses:
[00:45:51] ℹ️    - Diagnosis 1: 'F03.90'
[00:45:51] ℹ️    - Diagnosis 2: 'R41.0'
[00:45:51] ℹ️    - Diagnosis 3: 'I10'
[00:45:51] ℹ️    - Diagnosis 4: ''
[00:45:51] ℹ️    - Diagnosis 5: ''
[00:45:51] ℹ️    - Diagnosis 6: ''
[00:45:51] ℹ️  Final extracted MRN: '101002156'
[00:45:51] ℹ️  Final extracted Sex: ''
[00:45:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:45:51] ℹ️  Final extracted Payer Source: ''
[00:45:51] ✅ Patient data extraction completed successfully
[00:45:51] ✅    ✅ Patient data extracted successfully
[00:45:51] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:51] ✅    ✅ Patient identified: Eleanor Martin
[00:45:51] ✅    ✅ Patient name validation passed
[00:45:51] 🔄 
🔄 Step 3: Processing patient dates...
[00:45:51] [DOC: 9206475] ℹ️  DOB normalized: 03/25/1934
[00:45:51] [DOC: 9206475] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:45:51] [DOC: 9206475] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:45:51] [DOC: 9206475] ✅ Patient date processing completed successfully
[00:45:51] ✅    ✅ Date processing completed
[00:45:51] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:45:51] 🔄 
🔄 Step 4: Extracting order data...
[00:45:54] ℹ️  Order extraction - MRN: '101002156'
[00:45:54] ℹ️  Order extraction - Sex: ''
[00:45:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:45:54] ℹ️  Order extraction - Payer Source: ''
[00:45:54] ✅ Order data extraction completed successfully
[00:45:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:45:54] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:45:54] ⚠️  Could not determine sex using any available method
[00:45:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:45:54] ✅ Patient name cross-validation successful
[00:45:54] ✅    ✅ Data merged successfully
[00:45:55] ✅    ✅ Order data extracted and validated
[00:45:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:45:55] [DOC: 9206475] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:55] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:55] 🔄 
🔄 Step 6: Pushing order to API...
[00:45:55] [DOC: 9206475] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:45:56] [DOC: 9206475] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14034"}
[00:45:56] ❌    ❌ Failed to push order
[00:45:56] 🔄 
🔄 Step 7: Writing to CSV...
[00:45:56] [DOC: 9206475] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:45:56] [DOC: 9206475] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:45:56] [DOC: 9206475] ℹ️  Payer Source extracted: ''
[00:45:56] [DOC: 9206475] ℹ️  Diagnosis codes being written:
[00:45:56] [DOC: 9206475] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:45:56] [DOC: 9206475] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:45:56] [DOC: 9206475] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:45:56] [DOC: 9206475] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:45:56] [DOC: 9206475] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:45:56] [DOC: 9206475] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:45:56] [DOC: 9206475] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Skilled Nursing | Payer:  | MRN: 101002156
[00:45:56] ✅    ✅ Document 9206475 processed and saved successfully
[00:45:56] 🔄 
🔄 Step 8: Saving API details...
[00:45:56] [DOC: 9206475] ℹ️  API push details saved for document 9206475
[00:45:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206469                         ║
================================================================================
[00:45:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:45:56] ℹ️  Date: 03/27/2025
[00:45:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:00] [DOC: 9206469] ✅ Text extracted using pdfplumber (1393 chars)
[00:46:00] ✅    ✅ Text extracted using pdfplumber (1393 chars)
[00:46:00] 🔄 
🔄 Step 2: Extracting patient data...
[00:46:03] ℹ️  AI extracted raw sex value: ''
[00:46:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:46:03] ℹ️  AI extracted payer source: ''
[00:46:03] ℹ️  AI extracted diagnoses:
[00:46:03] ℹ️    - Diagnosis 1: 'F03.90'
[00:46:03] ℹ️    - Diagnosis 2: 'R41.0'
[00:46:03] ℹ️    - Diagnosis 3: 'I10'
[00:46:03] ℹ️    - Diagnosis 4: ''
[00:46:03] ℹ️    - Diagnosis 5: ''
[00:46:03] ℹ️    - Diagnosis 6: ''
[00:46:03] ℹ️  Final extracted MRN: '101002156'
[00:46:03] ℹ️  Final extracted Sex: ''
[00:46:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:46:03] ℹ️  Final extracted Payer Source: ''
[00:46:03] ✅ Patient data extraction completed successfully
[00:46:03] ✅    ✅ Patient data extracted successfully
[00:46:03] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:03] ✅    ✅ Patient identified: Eleanor Martin
[00:46:03] ✅    ✅ Patient name validation passed
[00:46:03] 🔄 
🔄 Step 3: Processing patient dates...
[00:46:03] [DOC: 9206469] ℹ️  DOB normalized: 03/25/1934
[00:46:03] [DOC: 9206469] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:46:03] [DOC: 9206469] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:46:03] [DOC: 9206469] ✅ Patient date processing completed successfully
[00:46:03] ✅    ✅ Date processing completed
[00:46:03] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:03] 🔄 
🔄 Step 4: Extracting order data...
[00:46:05] ℹ️  Order extraction - MRN: '101002156'
[00:46:05] ℹ️  Order extraction - Sex: ''
[00:46:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:46:05] ℹ️  Order extraction - Payer Source: ''
[00:46:05] ✅ Order data extraction completed successfully
[00:46:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:46:05] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:46:05] ⚠️  Could not determine sex using any available method
[00:46:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:46:05] ✅ Patient name cross-validation successful
[00:46:05] ✅    ✅ Data merged successfully
[00:46:07] ✅    ✅ Order data extracted and validated
[00:46:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:46:07] [DOC: 9206469] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:07] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:07] 🔄 
🔄 Step 6: Pushing order to API...
[00:46:07] [DOC: 9206469] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:08] [DOC: 9206469] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14035"}
[00:46:08] ❌    ❌ Failed to push order
[00:46:08] 🔄 
🔄 Step 7: Writing to CSV...
[00:46:08] [DOC: 9206469] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:46:08] [DOC: 9206469] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:46:08] [DOC: 9206469] ℹ️  Payer Source extracted: ''
[00:46:08] [DOC: 9206469] ℹ️  Diagnosis codes being written:
[00:46:08] [DOC: 9206469] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:46:08] [DOC: 9206469] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:46:08] [DOC: 9206469] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:46:08] [DOC: 9206469] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:46:08] [DOC: 9206469] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:46:08] [DOC: 9206469] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:46:08] [DOC: 9206469] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Skilled Nursing | Payer:  | MRN: 101002156
[00:46:08] ✅    ✅ Document 9206469 processed and saved successfully
[00:46:08] 🔄 
🔄 Step 8: Saving API details...
[00:46:08] [DOC: 9206469] ℹ️  API push details saved for document 9206469
[00:46:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206464                         ║
================================================================================
[00:46:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:46:08] ℹ️  Date: 03/27/2025
[00:46:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:12] [DOC: 9206464] ✅ Text extracted using pdfplumber (2907 chars)
[00:46:12] ✅    ✅ Text extracted using pdfplumber (2907 chars)
[00:46:12] 🔄 
🔄 Step 2: Extracting patient data...
[00:46:15] ℹ️  AI extracted raw sex value: ''
[00:46:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:46:15] ℹ️  AI extracted payer source: ''
[00:46:15] ℹ️  AI extracted diagnoses:
[00:46:15] ℹ️    - Diagnosis 1: 'F03.90'
[00:46:15] ℹ️    - Diagnosis 2: 'R41.0'
[00:46:15] ℹ️    - Diagnosis 3: 'I10'
[00:46:15] ℹ️    - Diagnosis 4: ''
[00:46:15] ℹ️    - Diagnosis 5: ''
[00:46:15] ℹ️    - Diagnosis 6: ''
[00:46:15] ℹ️  Final extracted MRN: '101002156'
[00:46:15] ℹ️  Final extracted Sex: ''
[00:46:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:46:15] ℹ️  Final extracted Payer Source: ''
[00:46:15] ✅ Patient data extraction completed successfully
[00:46:15] ✅    ✅ Patient data extracted successfully
[00:46:15] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:15] ✅    ✅ Patient identified: Eleanor Martin
[00:46:15] ✅    ✅ Patient name validation passed
[00:46:15] 🔄 
🔄 Step 3: Processing patient dates...
[00:46:15] [DOC: 9206464] ℹ️  DOB normalized: 03/25/1934
[00:46:15] [DOC: 9206464] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:46:15] [DOC: 9206464] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:46:15] [DOC: 9206464] ✅ Patient date processing completed successfully
[00:46:15] ✅    ✅ Date processing completed
[00:46:15] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:15] 🔄 
🔄 Step 4: Extracting order data...
[00:46:18] ℹ️  Order extraction - MRN: '101002156'
[00:46:18] ℹ️  Order extraction - Sex: ''
[00:46:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:46:18] ℹ️  Order extraction - Payer Source: ''
[00:46:18] ✅ Order data extraction completed successfully
[00:46:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:46:18] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:46:18] ⚠️  Could not determine sex using any available method
[00:46:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:46:18] ✅ Patient name cross-validation successful
[00:46:18] ✅    ✅ Data merged successfully
[00:46:19] ✅    ✅ Order data extracted and validated
[00:46:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:46:19] [DOC: 9206464] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:19] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:19] 🔄 
🔄 Step 6: Pushing order to API...
[00:46:19] [DOC: 9206464] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:20] [DOC: 9206464] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14036"}
[00:46:20] ❌    ❌ Failed to push order
[00:46:20] 🔄 
🔄 Step 7: Writing to CSV...
[00:46:20] [DOC: 9206464] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:46:20] [DOC: 9206464] ℹ️  Service Line extracted: 'Skilled Nursing'
[00:46:20] [DOC: 9206464] ℹ️  Payer Source extracted: ''
[00:46:20] [DOC: 9206464] ℹ️  Diagnosis codes being written:
[00:46:20] [DOC: 9206464] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:46:20] [DOC: 9206464] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:46:20] [DOC: 9206464] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:46:20] [DOC: 9206464] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:46:20] [DOC: 9206464] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:46:20] [DOC: 9206464] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:46:20] [DOC: 9206464] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Skilled Nursing | Payer:  | MRN: 101002156
[00:46:20] ✅    ✅ Document 9206464 processed and saved successfully
[00:46:20] 🔄 
🔄 Step 8: Saving API details...
[00:46:20] [DOC: 9206464] ℹ️  API push details saved for document 9206464
[00:46:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9206461                         ║
================================================================================
[00:46:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[00:46:20] ℹ️  Date: 03/27/2025
[00:46:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:22] [DOC: 9206461] ✅ Text extracted using pdfplumber (1155 chars)
[00:46:22] ✅    ✅ Text extracted using pdfplumber (1155 chars)
[00:46:22] 🔄 
🔄 Step 2: Extracting patient data...
[00:46:25] ℹ️  AI extracted raw sex value: ''
[00:46:25] ℹ️  AI extracted service line: 'Occupational Therapy'
[00:46:25] ℹ️  AI extracted payer source: ''
[00:46:25] ℹ️  AI extracted diagnoses:
[00:46:25] ℹ️    - Diagnosis 1: 'F03.90'
[00:46:25] ℹ️    - Diagnosis 2: 'R41.0'
[00:46:25] ℹ️    - Diagnosis 3: 'I10'
[00:46:25] ℹ️    - Diagnosis 4: ''
[00:46:25] ℹ️    - Diagnosis 5: ''
[00:46:25] ℹ️    - Diagnosis 6: ''
[00:46:25] ℹ️  Final extracted MRN: '101002156'
[00:46:25] ℹ️  Final extracted Sex: ''
[00:46:25] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[00:46:25] ℹ️  Final extracted Payer Source: ''
[00:46:25] ✅ Patient data extraction completed successfully
[00:46:25] ✅    ✅ Patient data extracted successfully
[00:46:25] 📊 Patient Response
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:25] ✅    ✅ Patient identified: Eleanor Martin
[00:46:25] ✅    ✅ Patient name validation passed
[00:46:25] 🔄 
🔄 Step 3: Processing patient dates...
[00:46:25] [DOC: 9206461] ℹ️  DOB normalized: 03/25/1934
[00:46:25] [DOC: 9206461] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[00:46:25] [DOC: 9206461] ℹ️  Episode endOfEpisode normalized: 01/05/2025
[00:46:25] [DOC: 9206461] ✅ Patient date processing completed successfully
[00:46:25] ✅    ✅ Date processing completed
[00:46:25] 📊 Processed Patient Data
     └─ patientFName: Eleanor
     └─ patientLName: Martin
     └─ dob: 03/25/1934
     └─ patientSex: 
     └─ medicalRecordNo: 101002156
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R41.0', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:25] 🔄 
🔄 Step 4: Extracting order data...
[00:46:27] ℹ️  Order extraction - MRN: '101002156'
[00:46:27] ℹ️  Order extraction - Sex: ''
[00:46:27] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[00:46:27] ℹ️  Order extraction - Payer Source: ''
[00:46:27] ✅ Order data extraction completed successfully
[00:46:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:46:27] ℹ️  Using MRN from patient data: '101002156' over '101002156'
[00:46:27] ⚠️  Could not determine sex using any available method
[00:46:27] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[00:46:27] ✅ Patient name cross-validation successful
[00:46:27] ✅    ✅ Data merged successfully
[00:46:28] ✅    ✅ Order data extracted and validated
[00:46:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:46:28] [DOC: 9206461] ✅ Patient found in local cache: Eleanor Martin, ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:28] ✅    ✅ Existing patient found with ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:28] 🔄 
🔄 Step 6: Pushing order to API...
[00:46:28] [DOC: 9206461] ℹ️  Pushing order via API for patient ID: 79a35dd8-ca03-4a70-8bd9-5265761e4eaf
[00:46:30] [DOC: 9206461] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14037"}
[00:46:30] ❌    ❌ Failed to push order
[00:46:30] 🔄 
🔄 Step 7: Writing to CSV...
[00:46:30] [DOC: 9206461] ℹ️  Calculated age: 91 from DOB: 03/25/1934
[00:46:30] [DOC: 9206461] ℹ️  Service Line extracted: 'Occupational Therapy'
[00:46:30] [DOC: 9206461] ℹ️  Payer Source extracted: ''
[00:46:30] [DOC: 9206461] ℹ️  Diagnosis codes being written:
[00:46:30] [DOC: 9206461] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[00:46:30] [DOC: 9206461] ℹ️    - Latest_Episode_Seconddiagnosis: 'R41.0'
[00:46:30] [DOC: 9206461] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[00:46:30] [DOC: 9206461] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[00:46:30] [DOC: 9206461] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[00:46:30] [DOC: 9206461] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[00:46:30] [DOC: 9206461] ✅ Patient data written to CSV: Eleanor Martin | Sex:  | Age: 91 | Service: Occupational Therapy | Payer:  | MRN: 101002156
[00:46:30] ✅    ✅ Document 9206461 processed and saved successfully
[00:46:30] 🔄 
🔄 Step 8: Saving API details...
[00:46:30] [DOC: 9206461] ℹ️  API push details saved for document 9206461
[00:46:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2166080                         ║
================================================================================
[00:46:30] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:46:30] ℹ️  Date: 03/26/2025
[00:46:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:31] [DOC: 2166080] ❌ Critical failure in get_pdf_text: Invalid response format
[00:46:31] ❌ Failed to extract text for Doc ID 2166080
[00:46:31] [DOC: 2166080] ℹ️  API push details saved for document 2166080
================================================================================
║                        Processing Document ID: 2166079                         ║
================================================================================
[00:46:31] ℹ️  Agency: Visiting Rehab & Nursing Services
[00:46:31] ℹ️  Date: 03/26/2025
[00:46:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:33] [DOC: 2166079] ❌ Critical failure in get_pdf_text: Invalid response format
[00:46:33] ❌ Failed to extract text for Doc ID 2166079
[00:46:33] [DOC: 2166079] ℹ️  API push details saved for document 2166079
================================================================================
║                        Processing Document ID: 9204791                         ║
================================================================================
[00:46:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:46:33] ℹ️  Date: 03/26/2025
[00:46:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:34] [DOC: 9204791] ✅ Text extracted using pdfplumber (2236 chars)
[00:46:34] ✅    ✅ Text extracted using pdfplumber (2236 chars)
[00:46:34] 🔄 
🔄 Step 2: Extracting patient data...
[00:46:37] ℹ️  AI extracted raw sex value: 'M'
[00:46:37] ℹ️  AI extracted service line: 'RN'
[00:46:37] ℹ️  AI extracted payer source: ''
[00:46:37] ℹ️  AI extracted diagnoses:
[00:46:37] ℹ️    - Diagnosis 1: ''
[00:46:37] ℹ️    - Diagnosis 2: ''
[00:46:37] ℹ️    - Diagnosis 3: ''
[00:46:37] ℹ️    - Diagnosis 4: ''
[00:46:37] ℹ️    - Diagnosis 5: ''
[00:46:37] ℹ️    - Diagnosis 6: ''
[00:46:37] ℹ️  Final extracted MRN: '2621702'
[00:46:37] ℹ️  Final extracted Sex: 'MALE'
[00:46:37] ℹ️  Final extracted Service Line: 'RN'
[00:46:37] ℹ️  Final extracted Payer Source: ''
[00:46:37] ✅ Patient data extraction completed successfully
[00:46:37] ✅    ✅ Patient data extracted successfully
[00:46:37] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:37] ✅    ✅ Patient identified: Bernard Klim
[00:46:37] ✅    ✅ Patient name validation passed
[00:46:37] 🔄 
🔄 Step 3: Processing patient dates...
[00:46:37] [DOC: 9204791] ℹ️  DOB normalized: 09/20/1957
[00:46:37] [DOC: 9204791] ✅ Patient date processing completed successfully
[00:46:37] ✅    ✅ Date processing completed
[00:46:37] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[00:46:37] 🔄 
🔄 Step 4: Extracting order data...
[00:46:39] ℹ️  Order extraction - MRN: '2621702'
[00:46:39] ℹ️  Order extraction - Sex: 'MALE'
[00:46:39] ℹ️  Order extraction - Service Line: ''
[00:46:39] ℹ️  Order extraction - Payer Source: ''
[00:46:39] ✅ Order data extraction completed successfully
[00:46:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:46:39] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[00:46:39] ℹ️  Using service line from patient data: 'RN'
[00:46:39] ✅ Patient name cross-validation successful
[00:46:39] ✅    ✅ Data merged successfully
[00:46:40] ⚠️     ❌ Skipping - missing episode start date
[00:46:40] [DOC: 9204791] ℹ️  API push details saved for document 9204791
================================================================================
║                        Processing Document ID: 9204785                         ║
================================================================================
[00:46:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:46:40] ℹ️  Date: 03/26/2025
[00:46:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[00:46:43] [DOC: 9204785] ✅ Text extracted using pdfplumber (17565 chars)
[00:46:43] ✅    ✅ Text extracted using pdfplumber (17555 chars)
[00:46:43] 🔄 
🔄 Step 2: Extracting patient data...
[00:46:46] ℹ️  AI extracted raw sex value: 'M'
[00:46:46] ℹ️  AI extracted service line: 'Skilled Nursing'
[00:46:46] ℹ️  AI extracted payer source: ''
[00:46:46] ℹ️  AI extracted diagnoses:
[00:46:46] ℹ️    - Diagnosis 1: 'A41.51'
[00:46:46] ℹ️    - Diagnosis 2: 'N39.0'
[00:46:46] ℹ️    - Diagnosis 3: 'I12.9'
[00:46:46] ℹ️    - Diagnosis 4: 'N18.32'
[00:46:46] ℹ️    - Diagnosis 5: 'N31.9'
[00:46:46] ℹ️    - Diagnosis 6: 'F32.A'
[00:46:46] ℹ️  Final extracted MRN: '2621702'
[00:46:46] ℹ️  Final extracted Sex: 'MALE'
[00:46:46] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[00:46:46] ℹ️  Final extracted Payer Source: ''
[00:46:46] ✅ Patient data extraction completed successfully
[00:46:46] ✅    ✅ Patient data extracted successfully
[00:46:46] 📊 Patient Response
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'F32.A'}]
[00:46:46] ✅    ✅ Patient identified: Bernard Klim
[00:46:46] ✅    ✅ Patient name validation passed
[00:46:46] 🔄 
🔄 Step 3: Processing patient dates...
[00:46:46] [DOC: 9204785] ℹ️  DOB normalized: 09/20/1957
[00:46:46] [DOC: 9204785] ℹ️  Episode startOfCare normalized: 03/13/2025
[00:46:46] [DOC: 9204785] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[00:46:46] [DOC: 9204785] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[00:46:46] [DOC: 9204785] ✅ Patient date processing completed successfully
[00:46:46] ✅    ✅ Date processing completed
[00:46:46] 📊 Processed Patient Data
     └─ patientFName: Bernard
     └─ patientLName: Klim
     └─ dob: 09/20/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2621702
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'N31.9', 'sixthDiagnosis': 'F32.A'}]
[00:46:46] 🔄 
🔄 Step 4: Extracting order data...
[00:46:49] ℹ️  Order extraction - MRN: '2621702'
[00:46:49] ℹ️  Order extraction - Sex: 'MALE'
[00:46:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[00:46:49] ℹ️  Order extraction - Payer Source: ''
[00:46:49] ✅ Order data extraction completed successfully
[00:46:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[00:46:49] ℹ️  Using MRN from patient data: '2621702' over '2621702'
[00:46:49] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[00:46:49] ✅ Patient name cross-validation successful
[00:46:49] ✅    ✅ Data merged successfully
[00:46:50] ✅    ✅ Order data extracted and validated
[00:46:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[00:46:53] [DOC: 9204785] ℹ️  Patient not found in cache or API: Bernard Klim
[00:46:53] [DOC: 9204785] ℹ️  Patient not found, creating new patient via API...
[00:46:53] [DOC: 9204785] ℹ️  Creating patient via API: Bernard Klim
[00:46:54] [DOC: 9204785] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[00:46:54] ❌    ❌ Failed to create patient
[00:46:54] [DOC: 9204785] ℹ️  API push details saved for document 9204785
================================================================================
║                        Processing Document ID: 9204692                         ║
================================================================================
[00:46:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[00:46:54] ℹ️  Date: 03/26/2025
[00:46:54] 🔄 
🔄 Step 1: Extracting text from PDF...
