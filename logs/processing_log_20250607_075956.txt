================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[07:59:56] ℹ️  CSV Data Extraction & API Push Tool
[07:59:56] ℹ️  
[07:59:56] ℹ️  Features:
[07:59:56] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[07:59:56] ℹ️  - AI-powered patient and order data extraction
[07:59:56] ℹ️  - Enhanced error handling and logging
[07:59:56] ℹ️  - Full API integration (patient creation + order pushing)
[07:59:56] ℹ️  - CSV output with comprehensive patient data
[07:59:56] ℹ️  - Detailed API tracking with remarks for every document
[07:59:56] ℹ️  - Complete audit trail of all processing attempts
[07:59:56] ℹ️  
[07:59:56] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[07:59:56] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_075956.csv
[07:59:56] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_075956.csv
================================================================================
║                        Processing Document ID: 9320629                         ║
================================================================================
[07:59:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[07:59:56] ℹ️  Date: 05/30/2025
[07:59:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:59:58] [DOC: 9320629] ✅ Text extracted using pdfplumber (1489 chars)
[07:59:58] ✅    ✅ Text extracted using pdfplumber (1489 chars)
[07:59:58] 🔄 
🔄 Step 2: Extracting patient data...
[08:00:02] ℹ️  AI extracted raw sex value: ''
[08:00:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:00:02] ℹ️  AI extracted payer source: ''
[08:00:02] ℹ️  AI extracted diagnoses:
[08:00:02] ℹ️    - Diagnosis 1: 'I26.99'
[08:00:02] ℹ️    - Diagnosis 2: 'M48.56X'
[08:00:02] ℹ️    - Diagnosis 3: 'I11.0'
[08:00:02] ℹ️    - Diagnosis 4: ''
[08:00:02] ℹ️    - Diagnosis 5: ''
[08:00:02] ℹ️    - Diagnosis 6: ''
[08:00:02] ℹ️  Final extracted MRN: 'MA200528053701'
[08:00:02] ℹ️  Final extracted Sex: ''
[08:00:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:00:02] ℹ️  Final extracted Payer Source: ''
[08:00:02] ✅ Patient data extraction completed successfully
[08:00:02] ✅    ✅ Patient data extracted successfully
[08:00:02] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'M48.56X', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:00:02] ✅    ✅ Patient identified: Roderick Lopez
[08:00:02] ✅    ✅ Patient name validation passed
[08:00:02] 🔄 
🔄 Step 3: Processing patient dates...
[08:00:02] [DOC: 9320629] ℹ️  DOB normalized: 05/21/1937
[08:00:02] [DOC: 9320629] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[08:00:02] [DOC: 9320629] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[08:00:02] [DOC: 9320629] ✅ Patient date processing completed successfully
[08:00:02] ✅    ✅ Date processing completed
[08:00:02] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I26.99', 'secondDiagnosis': 'M48.56X', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:00:02] 🔄 
🔄 Step 4: Extracting order data...
[08:00:05] ℹ️  Order extraction - MRN: 'MA200528053701'
[08:00:05] ℹ️  Order extraction - Sex: ''
[08:00:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:00:05] ℹ️  Order extraction - Payer Source: ''
[08:00:05] ✅ Order data extraction completed successfully
[08:00:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:00:05] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[08:00:05] ℹ️  Inferred sex as MALE from name: Roderick
[08:00:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:00:05] ✅ Patient name cross-validation successful
[08:00:05] ✅    ✅ Data merged successfully
[08:00:06] ✅    ✅ Order data extracted and validated
[08:00:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:00:21] [DOC: 9320629] ℹ️  Patient not found in cache or API: Roderick Lopez
[08:00:21] [DOC: 9320629] ℹ️  Patient not found, creating new patient via API...
[08:00:21] [DOC: 9320629] ℹ️  Creating patient via API: Roderick Lopez
[08:00:23] [DOC: 9320629] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:00:23] ❌    ❌ Failed to create patient
[08:00:23] [DOC: 9320629] ℹ️  API push details saved for document 9320629
================================================================================
║                        Processing Document ID: 9320628                         ║
================================================================================
[08:00:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:00:23] ℹ️  Date: 05/30/2025
[08:00:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:00:29] [DOC: 9320628] ✅ Text extracted using pdfplumber (12205 chars)
[08:00:29] ✅    ✅ Text extracted using pdfplumber (12205 chars)
[08:00:29] 🔄 
🔄 Step 2: Extracting patient data...
[08:00:33] ℹ️  AI extracted raw sex value: ''
[08:00:33] ℹ️  AI extracted service line: 'OT'
[08:00:33] ℹ️  AI extracted payer source: ''
[08:00:33] ℹ️  AI extracted diagnoses:
[08:00:33] ℹ️    - Diagnosis 1: 'J44.1'
[08:00:33] ℹ️    - Diagnosis 2: 'I50.9'
[08:00:33] ℹ️    - Diagnosis 3: ''
[08:00:33] ℹ️    - Diagnosis 4: ''
[08:00:33] ℹ️    - Diagnosis 5: ''
[08:00:33] ℹ️    - Diagnosis 6: ''
[08:00:33] ℹ️  Final extracted MRN: 'MA200528053701'
[08:00:33] ℹ️  Final extracted Sex: ''
[08:00:33] ℹ️  Final extracted Service Line: 'OT'
[08:00:33] ℹ️  Final extracted Payer Source: ''
[08:00:33] ✅ Patient data extraction completed successfully
[08:00:33] ✅    ✅ Patient data extracted successfully
[08:00:33] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:00:33] ✅    ✅ Patient identified: Roderick Lopez
[08:00:33] ✅    ✅ Patient name validation passed
[08:00:33] 🔄 
🔄 Step 3: Processing patient dates...
[08:00:33] [DOC: 9320628] ℹ️  DOB normalized: 05/21/1937
[08:00:33] [DOC: 9320628] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[08:00:33] [DOC: 9320628] ℹ️  Episode endOfEpisode normalized: 04/16/2025
[08:00:33] [DOC: 9320628] ✅ Patient date processing completed successfully
[08:00:33] ✅    ✅ Date processing completed
[08:00:33] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/16/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:00:33] 🔄 
🔄 Step 4: Extracting order data...
[08:00:36] ℹ️  Order extraction - MRN: 'MA200528053701'
[08:00:36] ℹ️  Order extraction - Sex: 'MALE'
[08:00:36] ℹ️  Order extraction - Service Line: 'OT'
[08:00:36] ℹ️  Order extraction - Payer Source: ''
[08:00:36] ✅ Order data extraction completed successfully
[08:00:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:00:36] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[08:00:36] ℹ️  Service line consistent in both sources: 'OT'
[08:00:36] ✅ Patient name cross-validation successful
[08:00:36] ✅    ✅ Data merged successfully
[08:00:38] ✅    ✅ Order data extracted and validated
[08:00:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:00:43] [DOC: 9320628] ℹ️  Patient not found in cache or API: Roderick Lopez
[08:00:43] [DOC: 9320628] ℹ️  Patient not found, creating new patient via API...
[08:00:43] [DOC: 9320628] ℹ️  Creating patient via API: Roderick Lopez
[08:00:45] [DOC: 9320628] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:00:45] ❌    ❌ Failed to create patient
[08:00:45] [DOC: 9320628] ℹ️  API push details saved for document 9320628
================================================================================
║                        Processing Document ID: 9320626                         ║
================================================================================
[08:00:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:00:45] ℹ️  Date: 05/30/2025
[08:00:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:00:48] [DOC: 9320626] ✅ Text extracted using pdfplumber (17363 chars)
[08:00:48] ✅    ✅ Text extracted using pdfplumber (17363 chars)
[08:00:48] 🔄 
🔄 Step 2: Extracting patient data...
[08:00:51] ℹ️  AI extracted raw sex value: 'F'
[08:00:51] ℹ️  AI extracted service line: 'PT'
[08:00:51] ℹ️  AI extracted payer source: 'None'
[08:00:51] ℹ️  AI extracted diagnoses:
[08:00:51] ℹ️    - Diagnosis 1: 'UTI'
[08:00:51] ℹ️    - Diagnosis 2: 'Vertigo'
[08:00:51] ℹ️    - Diagnosis 3: 'None'
[08:00:51] ℹ️    - Diagnosis 4: 'None'
[08:00:51] ℹ️    - Diagnosis 5: 'None'
[08:00:51] ℹ️    - Diagnosis 6: 'None'
[08:00:51] ℹ️  Final extracted MRN: '101002392'
[08:00:51] ℹ️  Final extracted Sex: 'FEMALE'
[08:00:51] ℹ️  Final extracted Service Line: 'PT'
[08:00:51] ℹ️  Final extracted Payer Source: ''
[08:00:51] ✅ Patient data extraction completed successfully
[08:00:51] ✅    ✅ Patient data extracted successfully
[08:00:51] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/17/2025', 'endOfEpisode': None, 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:00:51] ✅    ✅ Patient identified: Virginia Brunton
[08:00:51] ✅    ✅ Patient name validation passed
[08:00:51] 🔄 
🔄 Step 3: Processing patient dates...
[08:00:51] [DOC: 9320626] ℹ️  DOB normalized: 06/05/1940
[08:00:51] [DOC: 9320626] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[08:00:51] [DOC: 9320626] ✅ Patient date processing completed successfully
[08:00:51] ✅    ✅ Date processing completed
[08:00:51] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/17/2025', 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo'}]
[08:00:51] 🔄 
🔄 Step 4: Extracting order data...
[08:00:54] ℹ️  Order extraction - MRN: '101002392'
[08:00:54] ℹ️  Order extraction - Sex: 'FEMALE'
[08:00:54] ℹ️  Order extraction - Service Line: 'PT'
[08:00:54] ℹ️  Order extraction - Payer Source: ''
[08:00:54] ✅ Order data extraction completed successfully
[08:00:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:00:54] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[08:00:54] ℹ️  Service line consistent in both sources: 'PT'
[08:00:54] ✅ Patient name cross-validation successful
[08:00:54] ✅    ✅ Data merged successfully
[08:00:55] ⚠️     ❌ Skipping - missing episode start date
[08:00:55] [DOC: 9320626] ℹ️  API push details saved for document 9320626
================================================================================
║                        Processing Document ID: 9320620                         ║
================================================================================
[08:00:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:00:55] ℹ️  Date: 05/30/2025
[08:00:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:00:58] [DOC: 9320620] ✅ Text extracted using pdfplumber (15735 chars)
[08:00:58] ✅    ✅ Text extracted using pdfplumber (15735 chars)
[08:00:58] 🔄 
🔄 Step 2: Extracting patient data...
[08:01:01] ℹ️  AI extracted raw sex value: 'F'
[08:01:01] ℹ️  AI extracted service line: 'PT'
[08:01:01] ℹ️  AI extracted payer source: 'None'
[08:01:01] ℹ️  AI extracted diagnoses:
[08:01:01] ℹ️    - Diagnosis 1: 'None'
[08:01:01] ℹ️    - Diagnosis 2: 'None'
[08:01:01] ℹ️    - Diagnosis 3: 'None'
[08:01:01] ℹ️    - Diagnosis 4: 'None'
[08:01:01] ℹ️    - Diagnosis 5: 'None'
[08:01:01] ℹ️    - Diagnosis 6: 'None'
[08:01:01] ℹ️  Final extracted MRN: 'MA250110074701'
[08:01:01] ℹ️  Final extracted Sex: 'FEMALE'
[08:01:01] ℹ️  Final extracted Service Line: 'PT'
[08:01:01] ℹ️  Final extracted Payer Source: ''
[08:01:01] ✅ Patient data extraction completed successfully
[08:01:01] ✅    ✅ Patient data extracted successfully
[08:01:01] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:01:01] ✅    ✅ Patient identified: Gloria Couto
[08:01:01] ✅    ✅ Patient name validation passed
[08:01:01] 🔄 
🔄 Step 3: Processing patient dates...
[08:01:01] [DOC: 9320620] ℹ️  DOB normalized: 07/30/1947
[08:01:01] [DOC: 9320620] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[08:01:01] [DOC: 9320620] ✅ Patient date processing completed successfully
[08:01:01] ✅    ✅ Date processing completed
[08:01:01] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025'}]
[08:01:01] 🔄 
🔄 Step 4: Extracting order data...
[08:01:04] ℹ️  Order extraction - MRN: 'MA250110074701'
[08:01:04] ℹ️  Order extraction - Sex: 'FEMALE'
[08:01:04] ℹ️  Order extraction - Service Line: 'PT'
[08:01:04] ℹ️  Order extraction - Payer Source: ''
[08:01:04] ✅ Order data extraction completed successfully
[08:01:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:01:04] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[08:01:04] ℹ️  Service line consistent in both sources: 'PT'
[08:01:04] ✅ Patient name cross-validation successful
[08:01:04] ✅    ✅ Data merged successfully
[08:01:05] ⚠️     ❌ Skipping - missing episode start date
[08:01:05] [DOC: 9320620] ℹ️  API push details saved for document 9320620
================================================================================
║                        Processing Document ID: 9320617                         ║
================================================================================
[08:01:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:01:05] ℹ️  Date: 05/30/2025
[08:01:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:01:08] [DOC: 9320617] ✅ Text extracted using pdfplumber (11878 chars)
[08:01:08] ✅    ✅ Text extracted using pdfplumber (11878 chars)
[08:01:08] 🔄 
🔄 Step 2: Extracting patient data...
[08:01:11] ℹ️  AI extracted raw sex value: 'F'
[08:01:11] ℹ️  AI extracted service line: 'OT'
[08:01:11] ℹ️  AI extracted payer source: 'None'
[08:01:11] ℹ️  AI extracted diagnoses:
[08:01:11] ℹ️    - Diagnosis 1: 'PNA from COVID-19'
[08:01:11] ℹ️    - Diagnosis 2: 'None'
[08:01:11] ℹ️    - Diagnosis 3: 'None'
[08:01:11] ℹ️    - Diagnosis 4: 'None'
[08:01:11] ℹ️    - Diagnosis 5: 'None'
[08:01:11] ℹ️    - Diagnosis 6: 'None'
[08:01:11] ℹ️  Final extracted MRN: 'MA250110074701'
[08:01:11] ℹ️  Final extracted Sex: 'FEMALE'
[08:01:11] ℹ️  Final extracted Service Line: 'OT'
[08:01:11] ℹ️  Final extracted Payer Source: ''
[08:01:11] ✅ Patient data extraction completed successfully
[08:01:11] ✅    ✅ Patient data extracted successfully
[08:01:11] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': 'PNA from COVID-19', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:01:11] ✅    ✅ Patient identified: Gloria Couto
[08:01:11] ✅    ✅ Patient name validation passed
[08:01:11] 🔄 
🔄 Step 3: Processing patient dates...
[08:01:11] [DOC: 9320617] ℹ️  DOB normalized: 07/30/1947
[08:01:11] [DOC: 9320617] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[08:01:11] [DOC: 9320617] ℹ️  Episode endOfEpisode normalized: 02/26/2025
[08:01:11] [DOC: 9320617] ✅ Patient date processing completed successfully
[08:01:11] ✅    ✅ Date processing completed
[08:01:11] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250110074701
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '02/26/2025', 'firstDiagnosis': 'PNA from COVID-19'}]
[08:01:11] 🔄 
🔄 Step 4: Extracting order data...
[08:01:13] ℹ️  Order extraction - MRN: 'MA250110074701'
[08:01:13] ℹ️  Order extraction - Sex: 'FEMALE'
[08:01:13] ℹ️  Order extraction - Service Line: 'OT'
[08:01:13] ℹ️  Order extraction - Payer Source: ''
[08:01:13] ✅ Order data extraction completed successfully
[08:01:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:01:13] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[08:01:13] ℹ️  Service line consistent in both sources: 'OT'
[08:01:13] ✅ Patient name cross-validation successful
[08:01:13] ✅    ✅ Data merged successfully
[08:01:15] ✅    ✅ Order data extracted and validated
[08:01:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:01:15] [DOC: 9320617] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:15] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:15] 🔄 
🔄 Step 6: Pushing order to API...
[08:01:15] [DOC: 9320617] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:16] [DOC: 9320617] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:01:16] ❌    ❌ Failed to push order
[08:01:16] 🔄 
🔄 Step 7: Writing to CSV...
[08:01:16] [DOC: 9320617] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[08:01:16] [DOC: 9320617] ℹ️  Service Line extracted: 'OT'
[08:01:16] [DOC: 9320617] ℹ️  Payer Source extracted: ''
[08:01:16] [DOC: 9320617] ℹ️  Diagnosis codes being written:
[08:01:16] [DOC: 9320617] ℹ️    - Latest_Episode_Firstdiagnosis: 'PNA from COVID-19'
[08:01:16] [DOC: 9320617] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:01:16] [DOC: 9320617] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:01:16] [DOC: 9320617] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:01:16] [DOC: 9320617] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:01:16] [DOC: 9320617] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:01:16] [DOC: 9320617] ✅ Patient data written to CSV: Gloria Couto | Sex: FEMALE | Age: 77 | Service: OT | Payer:  | MRN: MA250110074701
[08:01:16] ✅    ✅ Document 9320617 processed and saved successfully
[08:01:16] 🔄 
🔄 Step 8: Saving API details...
[08:01:16] [DOC: 9320617] ℹ️  API push details saved for document 9320617
[08:01:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320613                         ║
================================================================================
[08:01:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:01:16] ℹ️  Date: 05/30/2025
[08:01:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:01:18] [DOC: 9320613] ✅ Text extracted using pdfplumber (1108 chars)
[08:01:18] ✅    ✅ Text extracted using pdfplumber (1108 chars)
[08:01:18] 🔄 
🔄 Step 2: Extracting patient data...
[08:01:21] ℹ️  AI extracted raw sex value: ''
[08:01:21] ℹ️  AI extracted service line: 'Occupational Therapy'
[08:01:21] ℹ️  AI extracted payer source: ''
[08:01:21] ℹ️  AI extracted diagnoses:
[08:01:21] ℹ️    - Diagnosis 1: 'E11.59'
[08:01:21] ℹ️    - Diagnosis 2: 'I15.2'
[08:01:21] ℹ️    - Diagnosis 3: 'N30.00'
[08:01:21] ℹ️    - Diagnosis 4: ''
[08:01:21] ℹ️    - Diagnosis 5: ''
[08:01:21] ℹ️    - Diagnosis 6: ''
[08:01:21] ℹ️  Final extracted MRN: 'MA250110074701'
[08:01:21] ℹ️  Final extracted Sex: ''
[08:01:21] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[08:01:21] ℹ️  Final extracted Payer Source: ''
[08:01:21] ✅ Patient data extraction completed successfully
[08:01:21] ✅    ✅ Patient data extracted successfully
[08:01:21] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:01:21] ✅    ✅ Patient identified: Gloria Couto
[08:01:21] ✅    ✅ Patient name validation passed
[08:01:21] 🔄 
🔄 Step 3: Processing patient dates...
[08:01:21] [DOC: 9320613] ℹ️  DOB normalized: 07/30/1947
[08:01:21] [DOC: 9320613] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[08:01:21] [DOC: 9320613] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[08:01:21] [DOC: 9320613] ✅ Patient date processing completed successfully
[08:01:21] ✅    ✅ Date processing completed
[08:01:21] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:01:21] 🔄 
🔄 Step 4: Extracting order data...
[08:01:23] ℹ️  Order extraction - MRN: 'MA250110074701'
[08:01:23] ℹ️  Order extraction - Sex: ''
[08:01:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[08:01:23] ℹ️  Order extraction - Payer Source: ''
[08:01:23] ✅ Order data extraction completed successfully
[08:01:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:01:23] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[08:01:23] ⚠️  Could not determine sex using any available method
[08:01:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[08:01:23] ✅ Patient name cross-validation successful
[08:01:23] ✅    ✅ Data merged successfully
[08:01:24] ✅    ✅ Order data extracted and validated
[08:01:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:01:24] [DOC: 9320613] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:24] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:24] 🔄 
🔄 Step 6: Pushing order to API...
[08:01:24] [DOC: 9320613] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:26] [DOC: 9320613] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18805"}
[08:01:26] ❌    ❌ Failed to push order
[08:01:26] 🔄 
🔄 Step 7: Writing to CSV...
[08:01:26] [DOC: 9320613] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[08:01:26] [DOC: 9320613] ℹ️  Service Line extracted: 'Occupational Therapy'
[08:01:26] [DOC: 9320613] ℹ️  Payer Source extracted: ''
[08:01:26] [DOC: 9320613] ℹ️  Diagnosis codes being written:
[08:01:26] [DOC: 9320613] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.59'
[08:01:26] [DOC: 9320613] ℹ️    - Latest_Episode_Seconddiagnosis: 'I15.2'
[08:01:26] [DOC: 9320613] ℹ️    - Latest_Episode_Thirddiagnosis: 'N30.00'
[08:01:26] [DOC: 9320613] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:01:26] [DOC: 9320613] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:01:26] [DOC: 9320613] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:01:26] [DOC: 9320613] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Occupational Therapy | Payer:  | MRN: MA250110074701
[08:01:26] ✅    ✅ Document 9320613 processed and saved successfully
[08:01:26] 🔄 
🔄 Step 8: Saving API details...
[08:01:26] [DOC: 9320613] ℹ️  API push details saved for document 9320613
[08:01:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320611                         ║
================================================================================
[08:01:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:01:26] ℹ️  Date: 05/30/2025
[08:01:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:01:28] [DOC: 9320611] ✅ Text extracted using pdfplumber (1234 chars)
[08:01:28] ✅    ✅ Text extracted using pdfplumber (1234 chars)
[08:01:28] 🔄 
🔄 Step 2: Extracting patient data...
[08:01:30] ℹ️  AI extracted raw sex value: ''
[08:01:30] ℹ️  AI extracted service line: 'Physical Therapy'
[08:01:30] ℹ️  AI extracted payer source: ''
[08:01:30] ℹ️  AI extracted diagnoses:
[08:01:30] ℹ️    - Diagnosis 1: 'E11.59'
[08:01:30] ℹ️    - Diagnosis 2: 'I15.2'
[08:01:30] ℹ️    - Diagnosis 3: 'N30.00'
[08:01:30] ℹ️    - Diagnosis 4: ''
[08:01:30] ℹ️    - Diagnosis 5: ''
[08:01:30] ℹ️    - Diagnosis 6: ''
[08:01:30] ℹ️  Final extracted MRN: 'MA250110074701'
[08:01:30] ℹ️  Final extracted Sex: ''
[08:01:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[08:01:30] ℹ️  Final extracted Payer Source: ''
[08:01:30] ✅ Patient data extraction completed successfully
[08:01:30] ✅    ✅ Patient data extracted successfully
[08:01:30] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:01:30] ✅    ✅ Patient identified: Gloria Couto
[08:01:30] ✅    ✅ Patient name validation passed
[08:01:30] 🔄 
🔄 Step 3: Processing patient dates...
[08:01:30] [DOC: 9320611] ℹ️  DOB normalized: 07/30/1947
[08:01:30] [DOC: 9320611] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[08:01:30] [DOC: 9320611] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[08:01:30] [DOC: 9320611] ✅ Patient date processing completed successfully
[08:01:30] ✅    ✅ Date processing completed
[08:01:30] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Couto
     └─ dob: 07/30/1947
     └─ patientSex: 
     └─ medicalRecordNo: MA250110074701
     └─ billingProvider: EARL POTTS MD
     └─ npi: 1679560791
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'E11.59', 'secondDiagnosis': 'I15.2', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:01:30] 🔄 
🔄 Step 4: Extracting order data...
[08:01:33] ℹ️  Order extraction - MRN: 'MA250110074701'
[08:01:33] ℹ️  Order extraction - Sex: ''
[08:01:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[08:01:33] ℹ️  Order extraction - Payer Source: ''
[08:01:33] ✅ Order data extraction completed successfully
[08:01:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:01:33] ℹ️  Using MRN from patient data: 'MA250110074701' over 'MA250110074701'
[08:01:33] ⚠️  Could not determine sex using any available method
[08:01:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[08:01:33] ✅ Patient name cross-validation successful
[08:01:33] ✅    ✅ Data merged successfully
[08:01:34] ✅    ✅ Order data extracted and validated
[08:01:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:01:34] [DOC: 9320611] ✅ Patient found in local cache: Gloria Couto, ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:34] ✅    ✅ Existing patient found with ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:34] 🔄 
🔄 Step 6: Pushing order to API...
[08:01:34] [DOC: 9320611] ℹ️  Pushing order via API for patient ID: 83ded691-cf1c-40a0-ae01-86877a800e13
[08:01:35] [DOC: 9320611] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18806"}
[08:01:35] ❌    ❌ Failed to push order
[08:01:35] 🔄 
🔄 Step 7: Writing to CSV...
[08:01:35] [DOC: 9320611] ℹ️  Calculated age: 77 from DOB: 07/30/1947
[08:01:35] [DOC: 9320611] ℹ️  Service Line extracted: 'Physical Therapy'
[08:01:35] [DOC: 9320611] ℹ️  Payer Source extracted: ''
[08:01:35] [DOC: 9320611] ℹ️  Diagnosis codes being written:
[08:01:35] [DOC: 9320611] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.59'
[08:01:35] [DOC: 9320611] ℹ️    - Latest_Episode_Seconddiagnosis: 'I15.2'
[08:01:35] [DOC: 9320611] ℹ️    - Latest_Episode_Thirddiagnosis: 'N30.00'
[08:01:35] [DOC: 9320611] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:01:35] [DOC: 9320611] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:01:35] [DOC: 9320611] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:01:35] [DOC: 9320611] ✅ Patient data written to CSV: Gloria Couto | Sex:  | Age: 77 | Service: Physical Therapy | Payer:  | MRN: MA250110074701
[08:01:35] ✅    ✅ Document 9320611 processed and saved successfully
[08:01:35] 🔄 
🔄 Step 8: Saving API details...
[08:01:35] [DOC: 9320611] ℹ️  API push details saved for document 9320611
[08:01:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320453                         ║
================================================================================
[08:01:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:01:35] ℹ️  Date: 05/30/2025
[08:01:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:01:38] [DOC: 9320453] ✅ Text extracted using pdfplumber (12787 chars)
[08:01:38] ✅    ✅ Text extracted using pdfplumber (12787 chars)
[08:01:38] 🔄 
🔄 Step 2: Extracting patient data...
[08:01:41] ℹ️  AI extracted raw sex value: 'M'
[08:01:41] ℹ️  AI extracted service line: 'PT'
[08:01:41] ℹ️  AI extracted payer source: 'None'
[08:01:41] ℹ️  AI extracted diagnoses:
[08:01:41] ℹ️    - Diagnosis 1: 'complete trisomy 21 syndrome'
[08:01:41] ℹ️    - Diagnosis 2: 'Generalized weakness'
[08:01:41] ℹ️    - Diagnosis 3: 'Asthma'
[08:01:41] ℹ️    - Diagnosis 4: 'ostium secundum type atrial septal defect'
[08:01:41] ℹ️    - Diagnosis 5: 'DM'
[08:01:41] ℹ️    - Diagnosis 6: 'hypothyroidism'
[08:01:41] ℹ️  Final extracted MRN: 'MA240808027001'
[08:01:41] ℹ️  Final extracted Sex: 'MALE'
[08:01:41] ℹ️  Final extracted Service Line: 'PT'
[08:01:41] ℹ️  Final extracted Payer Source: ''
[08:01:41] ✅ Patient data extraction completed successfully
[08:01:41] ✅    ✅ Patient data extracted successfully
[08:01:41] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': None, 'firstDiagnosis': 'complete trisomy 21 syndrome', 'secondDiagnosis': 'Generalized weakness', 'thirdDiagnosis': 'Asthma', 'fourthDiagnosis': 'ostium secundum type atrial septal defect', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'hypothyroidism'}]
[08:01:41] ✅    ✅ Patient identified: Rafael Talavera
[08:01:41] ✅    ✅ Patient name validation passed
[08:01:41] 🔄 
🔄 Step 3: Processing patient dates...
[08:01:41] [DOC: 9320453] ℹ️  DOB normalized: 02/10/1970
[08:01:41] [DOC: 9320453] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[08:01:41] [DOC: 9320453] ✅ Patient date processing completed successfully
[08:01:41] ✅    ✅ Date processing completed
[08:01:41] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'firstDiagnosis': 'complete trisomy 21 syndrome', 'secondDiagnosis': 'Generalized weakness', 'thirdDiagnosis': 'Asthma', 'fourthDiagnosis': 'ostium secundum type atrial septal defect', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'hypothyroidism'}]
[08:01:41] 🔄 
🔄 Step 4: Extracting order data...
[08:01:44] ℹ️  Order extraction - MRN: 'MA240808027001'
[08:01:44] ℹ️  Order extraction - Sex: 'MALE'
[08:01:44] ℹ️  Order extraction - Service Line: 'PT'
[08:01:44] ℹ️  Order extraction - Payer Source: ''
[08:01:44] ✅ Order data extraction completed successfully
[08:01:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:01:44] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[08:01:44] ℹ️  Service line consistent in both sources: 'PT'
[08:01:44] ✅ Patient name cross-validation successful
[08:01:44] ✅    ✅ Data merged successfully
[08:01:45] ⚠️     ❌ Skipping - missing episode start date
[08:01:45] [DOC: 9320453] ℹ️  API push details saved for document 9320453
================================================================================
║                        Processing Document ID: 9320447                         ║
================================================================================
[08:01:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:01:45] ℹ️  Date: 05/30/2025
[08:01:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:01:47] [DOC: 9320447] ✅ Text extracted using pdfplumber (1077 chars)
[08:01:47] ✅    ✅ Text extracted using pdfplumber (1077 chars)
[08:01:47] 🔄 
🔄 Step 2: Extracting patient data...
[08:01:50] ℹ️  AI extracted raw sex value: ''
[08:01:50] ℹ️  AI extracted service line: 'Occupational Therapy'
[08:01:50] ℹ️  AI extracted payer source: ''
[08:01:50] ℹ️  AI extracted diagnoses:
[08:01:50] ℹ️    - Diagnosis 1: 'J96.01'
[08:01:50] ℹ️    - Diagnosis 2: 'Q90.9'
[08:01:50] ℹ️    - Diagnosis 3: 'E66.01'
[08:01:50] ℹ️    - Diagnosis 4: 'None'
[08:01:50] ℹ️    - Diagnosis 5: 'None'
[08:01:50] ℹ️    - Diagnosis 6: 'None'
[08:01:50] ℹ️  Final extracted MRN: 'MA240808027001'
[08:01:50] ℹ️  Final extracted Sex: ''
[08:01:50] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[08:01:50] ℹ️  Final extracted Payer Source: ''
[08:01:50] ✅ Patient data extraction completed successfully
[08:01:50] ✅    ✅ Patient data extracted successfully
[08:01:50] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: 
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:01:50] ✅    ✅ Patient identified: Rafael Talavera
[08:01:50] ✅    ✅ Patient name validation passed
[08:01:50] 🔄 
🔄 Step 3: Processing patient dates...
[08:01:50] [DOC: 9320447] ℹ️  DOB normalized: 02/10/1970
[08:01:50] [DOC: 9320447] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[08:01:50] [DOC: 9320447] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[08:01:50] [DOC: 9320447] ✅ Patient date processing completed successfully
[08:01:50] ✅    ✅ Date processing completed
[08:01:50] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: 
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01'}]
[08:01:50] 🔄 
🔄 Step 4: Extracting order data...
[08:01:52] ℹ️  Order extraction - MRN: 'MA240808027001'
[08:01:52] ℹ️  Order extraction - Sex: ''
[08:01:52] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[08:01:52] ℹ️  Order extraction - Payer Source: ''
[08:01:52] ✅ Order data extraction completed successfully
[08:01:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:01:52] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[08:01:52] ⚠️  Could not determine sex using any available method
[08:01:52] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[08:01:52] ✅ Patient name cross-validation successful
[08:01:52] ✅    ✅ Data merged successfully
[08:01:54] ✅    ✅ Order data extracted and validated
[08:01:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:01:54] [DOC: 9320447] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[08:01:54] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[08:01:54] 🔄 
🔄 Step 6: Pushing order to API...
[08:01:54] [DOC: 9320447] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[08:01:55] [DOC: 9320447] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18809"}
[08:01:55] ❌    ❌ Failed to push order
[08:01:55] 🔄 
🔄 Step 7: Writing to CSV...
[08:01:55] [DOC: 9320447] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[08:01:55] [DOC: 9320447] ℹ️  Service Line extracted: 'Occupational Therapy'
[08:01:55] [DOC: 9320447] ℹ️  Payer Source extracted: ''
[08:01:55] [DOC: 9320447] ℹ️  Diagnosis codes being written:
[08:01:55] [DOC: 9320447] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.01'
[08:01:55] [DOC: 9320447] ℹ️    - Latest_Episode_Seconddiagnosis: 'Q90.9'
[08:01:55] [DOC: 9320447] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.01'
[08:01:55] [DOC: 9320447] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:01:55] [DOC: 9320447] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:01:55] [DOC: 9320447] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:01:55] [DOC: 9320447] ✅ Patient data written to CSV: Rafael Talavera | Sex:  | Age: 55 | Service: Occupational Therapy | Payer:  | MRN: MA240808027001
[08:01:55] ✅    ✅ Document 9320447 processed and saved successfully
[08:01:55] 🔄 
🔄 Step 8: Saving API details...
[08:01:55] [DOC: 9320447] ℹ️  API push details saved for document 9320447
[08:01:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320443                         ║
================================================================================
[08:01:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:01:55] ℹ️  Date: 05/30/2025
[08:01:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:01:58] [DOC: 9320443] ✅ Text extracted using pdfplumber (1388 chars)
[08:01:58] ✅    ✅ Text extracted using pdfplumber (1376 chars)
[08:01:58] 🔄 
🔄 Step 2: Extracting patient data...
[08:02:01] ℹ️  AI extracted raw sex value: ''
[08:02:01] ℹ️  AI extracted service line: 'Physical Therapy'
[08:02:01] ℹ️  AI extracted payer source: ''
[08:02:01] ℹ️  AI extracted diagnoses:
[08:02:01] ℹ️    - Diagnosis 1: 'S22.42X'
[08:02:01] ℹ️    - Diagnosis 2: 'S06.5X0'
[08:02:01] ℹ️    - Diagnosis 3: 'S80.211'
[08:02:01] ℹ️    - Diagnosis 4: 'None'
[08:02:01] ℹ️    - Diagnosis 5: 'None'
[08:02:01] ℹ️    - Diagnosis 6: 'None'
[08:02:01] ℹ️  Final extracted MRN: 'MA250505025302'
[08:02:01] ℹ️  Final extracted Sex: ''
[08:02:01] ℹ️  Final extracted Service Line: 'Physical Therapy'
[08:02:01] ℹ️  Final extracted Payer Source: ''
[08:02:01] ✅ Patient data extraction completed successfully
[08:02:01] ✅    ✅ Patient data extracted successfully
[08:02:01] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Smigel
     └─ dob: 02/15/1953
     └─ patientSex: 
     └─ medicalRecordNo: MA250505025302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'S22.42X', 'secondDiagnosis': 'S06.5X0', 'thirdDiagnosis': 'S80.211', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:02:01] ✅    ✅ Patient identified: Kathleen Smigel
[08:02:01] ✅    ✅ Patient name validation passed
[08:02:01] 🔄 
🔄 Step 3: Processing patient dates...
[08:02:01] [DOC: 9320443] ℹ️  DOB normalized: 02/15/1953
[08:02:01] [DOC: 9320443] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[08:02:01] [DOC: 9320443] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[08:02:01] [DOC: 9320443] ✅ Patient date processing completed successfully
[08:02:01] ✅    ✅ Date processing completed
[08:02:01] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Smigel
     └─ dob: 02/15/1953
     └─ patientSex: 
     └─ medicalRecordNo: MA250505025302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'S22.42X', 'secondDiagnosis': 'S06.5X0', 'thirdDiagnosis': 'S80.211'}]
[08:02:01] 🔄 
🔄 Step 4: Extracting order data...
[08:02:04] ℹ️  Order extraction - MRN: 'MA250505025302'
[08:02:04] ℹ️  Order extraction - Sex: ''
[08:02:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[08:02:04] ℹ️  Order extraction - Payer Source: ''
[08:02:04] ✅ Order data extraction completed successfully
[08:02:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:02:04] ℹ️  Using MRN from patient data: 'MA250505025302' over 'MA250505025302'
[08:02:04] ⚠️  Could not determine sex using any available method
[08:02:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[08:02:04] ✅ Patient name cross-validation successful
[08:02:04] ✅    ✅ Data merged successfully
[08:02:05] ✅    ✅ Order data extracted and validated
[08:02:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:02:12] [DOC: 9320443] ℹ️  Patient not found in cache or API: Kathleen Smigel
[08:02:12] [DOC: 9320443] ℹ️  Patient not found, creating new patient via API...
[08:02:12] [DOC: 9320443] ℹ️  Creating patient via API: Kathleen Smigel
[08:02:14] [DOC: 9320443] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:02:14] ❌    ❌ Failed to create patient
[08:02:14] [DOC: 9320443] ℹ️  API push details saved for document 9320443
================================================================================
║                        Processing Document ID: 9320434                         ║
================================================================================
[08:02:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:02:14] ℹ️  Date: 05/30/2025
[08:02:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:02:16] [DOC: 9320434] ✅ Text extracted using pdfplumber (1100 chars)
[08:02:16] ✅    ✅ Text extracted using pdfplumber (1100 chars)
[08:02:16] 🔄 
🔄 Step 2: Extracting patient data...
[08:02:20] ℹ️  AI extracted raw sex value: ''
[08:02:20] ℹ️  AI extracted service line: 'Physical Therapy'
[08:02:20] ℹ️  AI extracted payer source: ''
[08:02:20] ℹ️  AI extracted diagnoses:
[08:02:20] ℹ️    - Diagnosis 1: 'M67.813'
[08:02:20] ℹ️    - Diagnosis 2: 'M67.814'
[08:02:20] ℹ️    - Diagnosis 3: 'M15.9'
[08:02:20] ℹ️    - Diagnosis 4: ''
[08:02:20] ℹ️    - Diagnosis 5: ''
[08:02:20] ℹ️    - Diagnosis 6: ''
[08:02:20] ℹ️  Final extracted MRN: 'MA230420103801'
[08:02:20] ℹ️  Final extracted Sex: ''
[08:02:20] ℹ️  Final extracted Service Line: 'Physical Therapy'
[08:02:20] ℹ️  Final extracted Payer Source: ''
[08:02:20] ✅ Patient data extraction completed successfully
[08:02:20] ✅    ✅ Patient data extracted successfully
[08:02:20] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:20] ✅    ✅ Patient identified: Alfredo Santos
[08:02:20] ✅    ✅ Patient name validation passed
[08:02:20] 🔄 
🔄 Step 3: Processing patient dates...
[08:02:20] [DOC: 9320434] ℹ️  DOB normalized: 10/24/1938
[08:02:20] [DOC: 9320434] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[08:02:20] [DOC: 9320434] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[08:02:20] [DOC: 9320434] ✅ Patient date processing completed successfully
[08:02:20] ✅    ✅ Date processing completed
[08:02:20] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:20] 🔄 
🔄 Step 4: Extracting order data...
[08:02:22] ℹ️  Order extraction - MRN: 'MA230420103801'
[08:02:22] ℹ️  Order extraction - Sex: ''
[08:02:22] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[08:02:22] ℹ️  Order extraction - Payer Source: ''
[08:02:22] ✅ Order data extraction completed successfully
[08:02:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:02:22] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[08:02:22] ⚠️  Could not determine sex using any available method
[08:02:22] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[08:02:22] ✅ Patient name cross-validation successful
[08:02:22] ✅    ✅ Data merged successfully
[08:02:23] ✅    ✅ Order data extracted and validated
[08:02:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:02:23] [DOC: 9320434] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[08:02:23] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[08:02:23] 🔄 
🔄 Step 6: Pushing order to API...
[08:02:23] [DOC: 9320434] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[08:02:24] [DOC: 9320434] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18811"}
[08:02:24] ❌    ❌ Failed to push order
[08:02:24] 🔄 
🔄 Step 7: Writing to CSV...
[08:02:24] [DOC: 9320434] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[08:02:24] [DOC: 9320434] ℹ️  Service Line extracted: 'Physical Therapy'
[08:02:24] [DOC: 9320434] ℹ️  Payer Source extracted: ''
[08:02:24] [DOC: 9320434] ℹ️  Diagnosis codes being written:
[08:02:24] [DOC: 9320434] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[08:02:24] [DOC: 9320434] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[08:02:24] [DOC: 9320434] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[08:02:24] [DOC: 9320434] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:02:24] [DOC: 9320434] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:02:24] [DOC: 9320434] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:02:24] [DOC: 9320434] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Physical Therapy | Payer:  | MRN: MA230420103801
[08:02:24] ✅    ✅ Document 9320434 processed and saved successfully
[08:02:24] 🔄 
🔄 Step 8: Saving API details...
[08:02:24] [DOC: 9320434] ℹ️  API push details saved for document 9320434
[08:02:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320431                         ║
================================================================================
[08:02:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:02:24] ℹ️  Date: 05/30/2025
[08:02:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:02:27] [DOC: 9320431] ✅ Text extracted using pdfplumber (1162 chars)
[08:02:27] ✅    ✅ Text extracted using pdfplumber (1162 chars)
[08:02:27] 🔄 
🔄 Step 2: Extracting patient data...
[08:02:30] ℹ️  AI extracted raw sex value: ''
[08:02:30] ℹ️  AI extracted service line: 'Occupational Therapy'
[08:02:30] ℹ️  AI extracted payer source: ''
[08:02:30] ℹ️  AI extracted diagnoses:
[08:02:30] ℹ️    - Diagnosis 1: 'M67.813'
[08:02:30] ℹ️    - Diagnosis 2: 'M67.814'
[08:02:30] ℹ️    - Diagnosis 3: 'M15.9'
[08:02:30] ℹ️    - Diagnosis 4: ''
[08:02:30] ℹ️    - Diagnosis 5: ''
[08:02:30] ℹ️    - Diagnosis 6: ''
[08:02:30] ℹ️  Final extracted MRN: 'MA230420103801'
[08:02:30] ℹ️  Final extracted Sex: ''
[08:02:30] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[08:02:30] ℹ️  Final extracted Payer Source: ''
[08:02:30] ✅ Patient data extraction completed successfully
[08:02:30] ✅    ✅ Patient data extracted successfully
[08:02:30] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:30] ✅    ✅ Patient identified: Alfredo Santos
[08:02:30] ✅    ✅ Patient name validation passed
[08:02:30] 🔄 
🔄 Step 3: Processing patient dates...
[08:02:30] [DOC: 9320431] ℹ️  DOB normalized: 10/24/1938
[08:02:30] [DOC: 9320431] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[08:02:30] [DOC: 9320431] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[08:02:30] [DOC: 9320431] ✅ Patient date processing completed successfully
[08:02:30] ✅    ✅ Date processing completed
[08:02:30] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:30] 🔄 
🔄 Step 4: Extracting order data...
[08:02:33] ℹ️  Order extraction - MRN: 'MA230420103801'
[08:02:33] ℹ️  Order extraction - Sex: ''
[08:02:33] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[08:02:33] ℹ️  Order extraction - Payer Source: ''
[08:02:33] ✅ Order data extraction completed successfully
[08:02:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:02:33] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[08:02:33] ⚠️  Could not determine sex using any available method
[08:02:33] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[08:02:33] ✅ Patient name cross-validation successful
[08:02:33] ✅    ✅ Data merged successfully
[08:02:34] ✅    ✅ Order data extracted and validated
[08:02:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:02:34] [DOC: 9320431] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[08:02:34] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[08:02:34] 🔄 
🔄 Step 6: Pushing order to API...
[08:02:34] [DOC: 9320431] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[08:02:35] [DOC: 9320431] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18812"}
[08:02:35] ❌    ❌ Failed to push order
[08:02:35] 🔄 
🔄 Step 7: Writing to CSV...
[08:02:35] [DOC: 9320431] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[08:02:35] [DOC: 9320431] ℹ️  Service Line extracted: 'Occupational Therapy'
[08:02:35] [DOC: 9320431] ℹ️  Payer Source extracted: ''
[08:02:35] [DOC: 9320431] ℹ️  Diagnosis codes being written:
[08:02:35] [DOC: 9320431] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[08:02:35] [DOC: 9320431] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[08:02:35] [DOC: 9320431] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[08:02:35] [DOC: 9320431] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:02:35] [DOC: 9320431] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:02:35] [DOC: 9320431] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:02:35] [DOC: 9320431] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Occupational Therapy | Payer:  | MRN: MA230420103801
[08:02:35] ✅    ✅ Document 9320431 processed and saved successfully
[08:02:35] 🔄 
🔄 Step 8: Saving API details...
[08:02:35] [DOC: 9320431] ℹ️  API push details saved for document 9320431
[08:02:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320425                         ║
================================================================================
[08:02:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:02:35] ℹ️  Date: 05/30/2025
[08:02:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:02:37] [DOC: 9320425] ✅ Text extracted using pdfplumber (1287 chars)
[08:02:37] ✅    ✅ Text extracted using pdfplumber (1275 chars)
[08:02:37] 🔄 
🔄 Step 2: Extracting patient data...
[08:02:40] ℹ️  AI extracted raw sex value: ''
[08:02:40] ℹ️  AI extracted service line: 'Occupational Therapy'
[08:02:40] ℹ️  AI extracted payer source: ''
[08:02:40] ℹ️  AI extracted diagnoses:
[08:02:40] ℹ️    - Diagnosis 1: 'I11.0'
[08:02:40] ℹ️    - Diagnosis 2: 'I50.9'
[08:02:40] ℹ️    - Diagnosis 3: 'E11.9'
[08:02:40] ℹ️    - Diagnosis 4: ''
[08:02:40] ℹ️    - Diagnosis 5: ''
[08:02:40] ℹ️    - Diagnosis 6: ''
[08:02:40] ℹ️  Final extracted MRN: 'MA200210084304'
[08:02:40] ℹ️  Final extracted Sex: ''
[08:02:40] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[08:02:40] ℹ️  Final extracted Payer Source: ''
[08:02:40] ✅ Patient data extraction completed successfully
[08:02:40] ✅    ✅ Patient data extracted successfully
[08:02:40] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:40] ✅    ✅ Patient identified: Mary Lima
[08:02:40] ✅    ✅ Patient name validation passed
[08:02:40] 🔄 
🔄 Step 3: Processing patient dates...
[08:02:40] [DOC: 9320425] ℹ️  DOB normalized: 08/18/1943
[08:02:40] [DOC: 9320425] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[08:02:40] [DOC: 9320425] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[08:02:40] [DOC: 9320425] ✅ Patient date processing completed successfully
[08:02:40] ✅    ✅ Date processing completed
[08:02:40] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:40] 🔄 
🔄 Step 4: Extracting order data...
[08:02:43] ℹ️  Order extraction - MRN: 'MA200210084304'
[08:02:43] ℹ️  Order extraction - Sex: ''
[08:02:43] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[08:02:43] ℹ️  Order extraction - Payer Source: ''
[08:02:43] ✅ Order data extraction completed successfully
[08:02:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:02:43] ℹ️  Using MRN from patient data: 'MA200210084304' over 'MA200210084304'
[08:02:43] ℹ️  Inferred sex as FEMALE from name: Mary
[08:02:43] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[08:02:43] ✅ Patient name cross-validation successful
[08:02:43] ✅    ✅ Data merged successfully
[08:02:44] ✅    ✅ Order data extracted and validated
[08:02:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:02:44] [DOC: 9320425] ✅ Patient found in local cache: Mary Lima, ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[08:02:44] ✅    ✅ Existing patient found with ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[08:02:44] 🔄 
🔄 Step 6: Pushing order to API...
[08:02:44] [DOC: 9320425] ℹ️  Pushing order via API for patient ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[08:02:45] [DOC: 9320425] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18813"}
[08:02:45] ❌    ❌ Failed to push order
[08:02:45] 🔄 
🔄 Step 7: Writing to CSV...
[08:02:45] [DOC: 9320425] ℹ️  Calculated age: 81 from DOB: 08/18/1943
[08:02:45] [DOC: 9320425] ℹ️  Service Line extracted: 'Occupational Therapy'
[08:02:45] [DOC: 9320425] ℹ️  Payer Source extracted: ''
[08:02:45] [DOC: 9320425] ℹ️  Diagnosis codes being written:
[08:02:45] [DOC: 9320425] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[08:02:45] [DOC: 9320425] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[08:02:45] [DOC: 9320425] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[08:02:45] [DOC: 9320425] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:02:45] [DOC: 9320425] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:02:45] [DOC: 9320425] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:02:45] [DOC: 9320425] ✅ Patient data written to CSV: Mary Lima | Sex: FEMALE | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: MA200210084304
[08:02:45] ✅    ✅ Document 9320425 processed and saved successfully
[08:02:45] 🔄 
🔄 Step 8: Saving API details...
[08:02:45] [DOC: 9320425] ℹ️  API push details saved for document 9320425
[08:02:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320174                         ║
================================================================================
[08:02:45] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[08:02:45] ℹ️  Date: 05/30/2025
[08:02:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:02:48] [DOC: 9320174] ✅ Text extracted using pdfplumber (1416 chars)
[08:02:48] ✅    ✅ Text extracted using pdfplumber (1404 chars)
[08:02:48] 🔄 
🔄 Step 2: Extracting patient data...
[08:02:51] ℹ️  AI extracted raw sex value: ''
[08:02:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:02:51] ℹ️  AI extracted payer source: 'Medicare'
[08:02:51] ℹ️  AI extracted diagnoses:
[08:02:51] ℹ️    - Diagnosis 1: ''
[08:02:51] ℹ️    - Diagnosis 2: ''
[08:02:51] ℹ️    - Diagnosis 3: ''
[08:02:51] ℹ️    - Diagnosis 4: ''
[08:02:51] ℹ️    - Diagnosis 5: ''
[08:02:51] ℹ️    - Diagnosis 6: ''
[08:02:51] ℹ️  Final extracted MRN: '28700203358401'
[08:02:51] ℹ️  Final extracted Sex: ''
[08:02:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:02:51] ℹ️  Final extracted Payer Source: 'Medicare'
[08:02:51] ✅ Patient data extraction completed successfully
[08:02:51] ✅    ✅ Patient data extracted successfully
[08:02:51] 📊 Patient Response
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:51] ✅    ✅ Patient identified: JEANNE ARSENAULT
[08:02:51] ✅    ✅ Patient name validation passed
[08:02:51] 🔄 
🔄 Step 3: Processing patient dates...
[08:02:51] [DOC: 9320174] ℹ️  DOB normalized: 06/24/1945
[08:02:51] [DOC: 9320174] ℹ️  Episode startOfEpisode normalized: 01/19/2025
[08:02:51] [DOC: 9320174] ℹ️  Episode endOfEpisode normalized: 01/22/2025
[08:02:51] [DOC: 9320174] ✅ Patient date processing completed successfully
[08:02:51] ✅    ✅ Date processing completed
[08:02:51] 📊 Processed Patient Data
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:02:51] 🔄 
🔄 Step 4: Extracting order data...
[08:02:53] ℹ️  Order extraction - MRN: '28700203358401'
[08:02:53] ℹ️  Order extraction - Sex: ''
[08:02:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:02:53] ℹ️  Order extraction - Payer Source: 'Medicare'
[08:02:53] ✅ Order data extraction completed successfully
[08:02:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:02:53] ℹ️  Using MRN from patient data: '28700203358401' over '28700203358401'
[08:02:53] ⚠️  Could not determine sex using any available method
[08:02:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:02:53] ℹ️  Payer source consistent in both sources: 'Medicare'
[08:02:53] ✅ Patient name cross-validation successful
[08:02:53] ✅    ✅ Data merged successfully
[08:02:54] ✅    ✅ Order data extracted and validated
[08:02:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:03:13] [DOC: 9320174] ℹ️  Patient not found in cache or API: JEANNE ARSENAULT
[08:03:13] [DOC: 9320174] ℹ️  Patient not found, creating new patient via API...
[08:03:13] [DOC: 9320174] ℹ️  Creating patient via API: JEANNE ARSENAULT
[08:03:15] [DOC: 9320174] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:03:15] ❌    ❌ Failed to create patient
[08:03:15] [DOC: 9320174] ℹ️  API push details saved for document 9320174
================================================================================
║                        Processing Document ID: 9320422                         ║
================================================================================
[08:03:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:03:15] ℹ️  Date: 05/30/2025
[08:03:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:03:17] [DOC: 9320422] ✅ Text extracted using pdfplumber (1302 chars)
[08:03:17] ✅    ✅ Text extracted using pdfplumber (1290 chars)
[08:03:17] 🔄 
🔄 Step 2: Extracting patient data...
[08:03:20] ℹ️  AI extracted raw sex value: ''
[08:03:20] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[08:03:20] ℹ️  AI extracted payer source: ''
[08:03:20] ℹ️  AI extracted diagnoses:
[08:03:20] ℹ️    - Diagnosis 1: 'I11.0'
[08:03:20] ℹ️    - Diagnosis 2: 'I50.9'
[08:03:20] ℹ️    - Diagnosis 3: 'E11.9'
[08:03:20] ℹ️    - Diagnosis 4: 'None'
[08:03:20] ℹ️    - Diagnosis 5: 'None'
[08:03:20] ℹ️    - Diagnosis 6: 'None'
[08:03:20] ℹ️  Final extracted MRN: 'MA200210084304'
[08:03:20] ℹ️  Final extracted Sex: ''
[08:03:20] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[08:03:20] ℹ️  Final extracted Payer Source: ''
[08:03:20] ✅ Patient data extraction completed successfully
[08:03:20] ✅    ✅ Patient data extracted successfully
[08:03:20] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:03:20] ✅    ✅ Patient identified: Mary Lima
[08:03:20] ✅    ✅ Patient name validation passed
[08:03:20] 🔄 
🔄 Step 3: Processing patient dates...
[08:03:20] [DOC: 9320422] ℹ️  DOB normalized: 08/18/1943
[08:03:20] [DOC: 9320422] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[08:03:20] [DOC: 9320422] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[08:03:20] [DOC: 9320422] ✅ Patient date processing completed successfully
[08:03:20] ✅    ✅ Date processing completed
[08:03:20] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9'}]
[08:03:20] 🔄 
🔄 Step 4: Extracting order data...
[08:03:23] ℹ️  Order extraction - MRN: 'MA200210084304'
[08:03:23] ℹ️  Order extraction - Sex: ''
[08:03:23] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[08:03:23] ℹ️  Order extraction - Payer Source: ''
[08:03:23] ✅ Order data extraction completed successfully
[08:03:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:03:23] ℹ️  Using MRN from patient data: 'MA200210084304' over 'MA200210084304'
[08:03:23] ℹ️  Inferred sex as FEMALE from name: Mary
[08:03:23] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[08:03:23] ✅ Patient name cross-validation successful
[08:03:23] ✅    ✅ Data merged successfully
[08:03:24] ✅    ✅ Order data extracted and validated
[08:03:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:03:24] [DOC: 9320422] ✅ Patient found in local cache: Mary Lima, ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[08:03:24] ✅    ✅ Existing patient found with ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[08:03:24] 🔄 
🔄 Step 6: Pushing order to API...
[08:03:24] [DOC: 9320422] ℹ️  Pushing order via API for patient ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[08:03:26] [DOC: 9320422] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18816"}
[08:03:26] ❌    ❌ Failed to push order
[08:03:26] 🔄 
🔄 Step 7: Writing to CSV...
[08:03:26] [DOC: 9320422] ℹ️  Calculated age: 81 from DOB: 08/18/1943
[08:03:26] [DOC: 9320422] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[08:03:26] [DOC: 9320422] ℹ️  Payer Source extracted: ''
[08:03:26] [DOC: 9320422] ℹ️  Diagnosis codes being written:
[08:03:26] [DOC: 9320422] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[08:03:26] [DOC: 9320422] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[08:03:26] [DOC: 9320422] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[08:03:26] [DOC: 9320422] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:03:26] [DOC: 9320422] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:03:26] [DOC: 9320422] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:03:26] [DOC: 9320422] ✅ Patient data written to CSV: Mary Lima | Sex: FEMALE | Age: 81 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: MA200210084304
[08:03:26] ✅    ✅ Document 9320422 processed and saved successfully
[08:03:26] 🔄 
🔄 Step 8: Saving API details...
[08:03:26] [DOC: 9320422] ℹ️  API push details saved for document 9320422
[08:03:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320418                         ║
================================================================================
[08:03:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:03:26] ℹ️  Date: 05/30/2025
[08:03:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:03:28] [DOC: 9320418] ✅ Text extracted using pdfplumber (1265 chars)
[08:03:28] ✅    ✅ Text extracted using pdfplumber (1265 chars)
[08:03:28] 🔄 
🔄 Step 2: Extracting patient data...
[08:03:31] ℹ️  AI extracted raw sex value: ''
[08:03:31] ℹ️  AI extracted service line: 'Occupational Therapy'
[08:03:31] ℹ️  AI extracted payer source: ''
[08:03:31] ℹ️  AI extracted diagnoses:
[08:03:31] ℹ️    - Diagnosis 1: 'I13.0'
[08:03:31] ℹ️    - Diagnosis 2: 'I50.33'
[08:03:31] ℹ️    - Diagnosis 3: 'E11.22'
[08:03:31] ℹ️    - Diagnosis 4: 'None'
[08:03:31] ℹ️    - Diagnosis 5: 'None'
[08:03:31] ℹ️    - Diagnosis 6: 'None'
[08:03:31] ℹ️  Final extracted MRN: '100994168'
[08:03:31] ℹ️  Final extracted Sex: ''
[08:03:31] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[08:03:31] ℹ️  Final extracted Payer Source: ''
[08:03:31] ✅ Patient data extraction completed successfully
[08:03:31] ✅    ✅ Patient data extracted successfully
[08:03:31] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Brilhante
     └─ dob: 03/13/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100994168
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:03:31] ✅    ✅ Patient identified: John Brilhante
[08:03:31] ✅    ✅ Patient name validation passed
[08:03:31] 🔄 
🔄 Step 3: Processing patient dates...
[08:03:31] [DOC: 9320418] ℹ️  DOB normalized: 03/13/1944
[08:03:31] [DOC: 9320418] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[08:03:31] [DOC: 9320418] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[08:03:31] [DOC: 9320418] ✅ Patient date processing completed successfully
[08:03:31] ✅    ✅ Date processing completed
[08:03:31] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Brilhante
     └─ dob: 03/13/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100994168
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22'}]
[08:03:31] 🔄 
🔄 Step 4: Extracting order data...
[08:03:33] ℹ️  Order extraction - MRN: '100994168'
[08:03:33] ℹ️  Order extraction - Sex: ''
[08:03:33] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[08:03:33] ℹ️  Order extraction - Payer Source: ''
[08:03:33] ✅ Order data extraction completed successfully
[08:03:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:03:33] ℹ️  Using MRN from patient data: '100994168' over '100994168'
[08:03:33] ℹ️  Inferred sex as MALE from name: John
[08:03:33] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[08:03:33] ✅ Patient name cross-validation successful
[08:03:33] ✅    ✅ Data merged successfully
[08:03:34] ✅    ✅ Order data extracted and validated
[08:03:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:03:34] [DOC: 9320418] ✅ Patient found in local cache: John Brilhante, ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[08:03:34] ✅    ✅ Existing patient found with ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[08:03:34] 🔄 
🔄 Step 6: Pushing order to API...
[08:03:34] [DOC: 9320418] ℹ️  Pushing order via API for patient ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[08:03:36] [DOC: 9320418] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18817"}
[08:03:36] ❌    ❌ Failed to push order
[08:03:36] 🔄 
🔄 Step 7: Writing to CSV...
[08:03:36] [DOC: 9320418] ℹ️  Calculated age: 81 from DOB: 03/13/1944
[08:03:36] [DOC: 9320418] ℹ️  Service Line extracted: 'Occupational Therapy'
[08:03:36] [DOC: 9320418] ℹ️  Payer Source extracted: ''
[08:03:36] [DOC: 9320418] ℹ️  Diagnosis codes being written:
[08:03:36] [DOC: 9320418] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[08:03:36] [DOC: 9320418] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[08:03:36] [DOC: 9320418] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[08:03:36] [DOC: 9320418] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:03:36] [DOC: 9320418] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:03:36] [DOC: 9320418] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:03:36] [DOC: 9320418] ✅ Patient data written to CSV: John Brilhante | Sex: MALE | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: 100994168
[08:03:36] ✅    ✅ Document 9320418 processed and saved successfully
[08:03:36] 🔄 
🔄 Step 8: Saving API details...
[08:03:36] [DOC: 9320418] ℹ️  API push details saved for document 9320418
[08:03:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320252                         ║
================================================================================
[08:03:36] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[08:03:36] ℹ️  Date: 05/30/2025
[08:03:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:03:38] [DOC: 9320252] ✅ Text extracted using pdfplumber (1823 chars)
[08:03:38] ✅    ✅ Text extracted using pdfplumber (1811 chars)
[08:03:38] 🔄 
🔄 Step 2: Extracting patient data...
[08:03:40] ℹ️  AI extracted raw sex value: 'F'
[08:03:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:03:40] ℹ️  AI extracted payer source: 'Medicare'
[08:03:40] ℹ️  AI extracted diagnoses:
[08:03:40] ℹ️    - Diagnosis 1: 'None'
[08:03:40] ℹ️    - Diagnosis 2: 'None'
[08:03:40] ℹ️    - Diagnosis 3: 'None'
[08:03:40] ℹ️    - Diagnosis 4: 'None'
[08:03:40] ℹ️    - Diagnosis 5: 'None'
[08:03:40] ℹ️    - Diagnosis 6: 'None'
[08:03:40] ℹ️  Final extracted MRN: '28700203358401'
[08:03:40] ℹ️  Final extracted Sex: 'FEMALE'
[08:03:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:03:40] ℹ️  Final extracted Payer Source: 'Medicare'
[08:03:40] ✅ Patient data extraction completed successfully
[08:03:40] ✅    ✅ Patient data extracted successfully
[08:03:40] 📊 Patient Response
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:03:40] ✅    ✅ Patient identified: JEANNE ARSENAULT
[08:03:40] ✅    ✅ Patient name validation passed
[08:03:40] 🔄 
🔄 Step 3: Processing patient dates...
[08:03:40] [DOC: 9320252] ℹ️  DOB normalized: 06/24/1945
[08:03:40] [DOC: 9320252] ℹ️  Episode startOfEpisode normalized: 01/19/2025
[08:03:40] [DOC: 9320252] ℹ️  Episode endOfEpisode normalized: 01/22/2025
[08:03:40] [DOC: 9320252] ✅ Patient date processing completed successfully
[08:03:40] ✅    ✅ Date processing completed
[08:03:40] 📊 Processed Patient Data
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: GLENN DUBLER, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 289 PLEASANT STREET BLDG 4
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)678-2503
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/19/2025', 'endOfEpisode': '01/22/2025'}]
[08:03:40] 🔄 
🔄 Step 4: Extracting order data...
[08:03:43] ℹ️  Order extraction - MRN: '28700203358401'
[08:03:43] ℹ️  Order extraction - Sex: ''
[08:03:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:03:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[08:03:43] ✅ Order data extraction completed successfully
[08:03:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:03:43] ℹ️  Using MRN from patient data: '28700203358401' over '28700203358401'
[08:03:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:03:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[08:03:43] ✅ Patient name cross-validation successful
[08:03:43] ✅    ✅ Data merged successfully
[08:03:44] ✅    ✅ Order data extracted and validated
[08:03:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:03:50] [DOC: 9320252] ℹ️  Patient not found in cache or API: JEANNE ARSENAULT
[08:03:50] [DOC: 9320252] ℹ️  Patient not found, creating new patient via API...
[08:03:50] [DOC: 9320252] ℹ️  Creating patient via API: JEANNE ARSENAULT
[08:03:51] [DOC: 9320252] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:03:51] ❌    ❌ Failed to create patient
[08:03:51] [DOC: 9320252] ℹ️  API push details saved for document 9320252
================================================================================
║                        Processing Document ID: 9320271                         ║
================================================================================
[08:03:51] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[08:03:51] ℹ️  Date: 05/30/2025
[08:03:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:03:55] [DOC: 9320271] ✅ Text extracted using pdfplumber (27702 chars)
[08:03:55] ✅    ✅ Text extracted using pdfplumber (27606 chars)
[08:03:55] 🔄 
🔄 Step 2: Extracting patient data...
[08:03:59] ℹ️  AI extracted raw sex value: 'F'
[08:03:59] ℹ️  AI extracted service line: 'HHA,PT,OT,Skilled Nurse'
[08:03:59] ℹ️  AI extracted payer source: 'Medicare'
[08:03:59] ℹ️  AI extracted diagnoses:
[08:03:59] ℹ️    - Diagnosis 1: 'S82.842D'
[08:03:59] ℹ️    - Diagnosis 2: 'I10'
[08:03:59] ℹ️    - Diagnosis 3: 'F41.9'
[08:03:59] ℹ️    - Diagnosis 4: 'F39'
[08:03:59] ℹ️    - Diagnosis 5: 'E78.5'
[08:03:59] ℹ️    - Diagnosis 6: 'K21.9'
[08:03:59] ℹ️  Final extracted MRN: '28700203358401'
[08:03:59] ℹ️  Final extracted Sex: 'FEMALE'
[08:03:59] ℹ️  Final extracted Service Line: 'HHA,PT,OT,Skilled Nurse'
[08:03:59] ℹ️  Final extracted Payer Source: 'Medicare'
[08:03:59] ✅ Patient data extraction completed successfully
[08:03:59] ✅    ✅ Patient data extracted successfully
[08:03:59] 📊 Patient Response
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 37B SUN AND SEA DRIVE
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ email: None
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: HHA,PT,OT,Skilled Nurse
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/23/2025', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'S82.842D', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F39', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[08:03:59] ✅    ✅ Patient identified: JEANNE ARSENAULT
[08:03:59] ✅    ✅ Patient name validation passed
[08:03:59] 🔄 
🔄 Step 3: Processing patient dates...
[08:03:59] [DOC: 9320271] ℹ️  DOB normalized: 06/24/1945
[08:03:59] [DOC: 9320271] ℹ️  Episode startOfCare normalized: 01/23/2025
[08:03:59] [DOC: 9320271] ℹ️  Episode startOfEpisode normalized: 01/23/2025
[08:03:59] [DOC: 9320271] ℹ️  Episode endOfEpisode normalized: 03/23/2025
[08:03:59] [DOC: 9320271] ✅ Patient date processing completed successfully
[08:03:59] ✅    ✅ Date processing completed
[08:03:59] 📊 Processed Patient Data
     └─ patientFName: JEANNE
     └─ patientLName: ARSENAULT
     └─ dob: 06/24/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 28700203358401
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 37B SUN AND SEA DRIVE
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748-
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: HHA,PT,OT,Skilled Nurse
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/23/2025', 'startOfEpisode': '01/23/2025', 'endOfEpisode': '03/23/2025', 'firstDiagnosis': 'S82.842D', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F39', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[08:03:59] 🔄 
🔄 Step 4: Extracting order data...
[08:04:02] ℹ️  Order extraction - MRN: '28700203358401'
[08:04:02] ℹ️  Order extraction - Sex: 'FEMALE'
[08:04:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[08:04:02] ℹ️  Order extraction - Payer Source: 'Medicare'
[08:04:02] ✅ Order data extraction completed successfully
[08:04:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:04:02] ℹ️  Using MRN from patient data: '28700203358401' over '28700203358401'
[08:04:02] ℹ️  Combined service lines: Patient='HHA,PT,OT,Skilled Nurse' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide' = 'HHA, Home Health Aide, OT, Occupational Therapy, PT, Physical Therapy, Skilled Nurse, Skilled Nursing'
[08:04:02] ℹ️  Payer source consistent in both sources: 'Medicare'
[08:04:02] ✅ Patient name cross-validation successful
[08:04:02] ✅    ✅ Data merged successfully
[08:04:04] ✅    ✅ Order data extracted and validated
[08:04:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:04:12] [DOC: 9320271] ℹ️  Patient not found in cache or API: JEANNE ARSENAULT
[08:04:12] [DOC: 9320271] ℹ️  Patient not found, creating new patient via API...
[08:04:12] [DOC: 9320271] ℹ️  Creating patient via API: JEANNE ARSENAULT
[08:04:14] [DOC: 9320271] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:04:14] ❌    ❌ Failed to create patient
[08:04:14] [DOC: 9320271] ℹ️  API push details saved for document 9320271
================================================================================
║                        Processing Document ID: 9320382                         ║
================================================================================
[08:04:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:04:14] ℹ️  Date: 05/30/2025
[08:04:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:04:16] [DOC: 9320382] ✅ Text extracted using pdfplumber (1498 chars)
[08:04:16] ✅    ✅ Text extracted using pdfplumber (1498 chars)
[08:04:16] 🔄 
🔄 Step 2: Extracting patient data...
[08:04:19] ℹ️  AI extracted raw sex value: ''
[08:04:19] ℹ️  AI extracted service line: 'Skilled Nursing, LPN'
[08:04:19] ℹ️  AI extracted payer source: ''
[08:04:19] ℹ️  AI extracted diagnoses:
[08:04:19] ℹ️    - Diagnosis 1: 'E11.65'
[08:04:19] ℹ️    - Diagnosis 2: 'I10'
[08:04:19] ℹ️    - Diagnosis 3: 'F20.9'
[08:04:19] ℹ️    - Diagnosis 4: ''
[08:04:19] ℹ️    - Diagnosis 5: ''
[08:04:19] ℹ️    - Diagnosis 6: ''
[08:04:19] ℹ️  Final extracted MRN: 'MA230222024501'
[08:04:19] ℹ️  Final extracted Sex: ''
[08:04:19] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN'
[08:04:19] ℹ️  Final extracted Payer Source: ''
[08:04:19] ✅ Patient data extraction completed successfully
[08:04:19] ✅    ✅ Patient data extracted successfully
[08:04:19] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:04:19] ✅    ✅ Patient identified: Pauline Bergeron
[08:04:19] ✅    ✅ Patient name validation passed
[08:04:19] 🔄 
🔄 Step 3: Processing patient dates...
[08:04:19] [DOC: 9320382] ℹ️  DOB normalized: 02/22/1945
[08:04:19] [DOC: 9320382] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[08:04:19] [DOC: 9320382] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[08:04:19] [DOC: 9320382] ✅ Patient date processing completed successfully
[08:04:19] ✅    ✅ Date processing completed
[08:04:19] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:04:19] 🔄 
🔄 Step 4: Extracting order data...
[08:04:22] ℹ️  Order extraction - MRN: 'MA230222024501'
[08:04:22] ℹ️  Order extraction - Sex: ''
[08:04:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:04:22] ℹ️  Order extraction - Payer Source: ''
[08:04:22] ✅ Order data extraction completed successfully
[08:04:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:04:22] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[08:04:22] ⚠️  Could not determine sex using any available method
[08:04:22] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[08:04:22] ✅ Patient name cross-validation successful
[08:04:22] ✅    ✅ Data merged successfully
[08:04:23] ✅    ✅ Order data extracted and validated
[08:04:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:04:23] [DOC: 9320382] ✅ Patient found in local cache: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[08:04:23] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[08:04:23] 🔄 
🔄 Step 6: Pushing order to API...
[08:04:23] [DOC: 9320382] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[08:04:24] [DOC: 9320382] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18820"}
[08:04:24] ❌    ❌ Failed to push order
[08:04:24] 🔄 
🔄 Step 7: Writing to CSV...
[08:04:24] [DOC: 9320382] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[08:04:24] [DOC: 9320382] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[08:04:24] [DOC: 9320382] ℹ️  Payer Source extracted: ''
[08:04:24] [DOC: 9320382] ℹ️  Diagnosis codes being written:
[08:04:24] [DOC: 9320382] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[08:04:24] [DOC: 9320382] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[08:04:24] [DOC: 9320382] ℹ️    - Latest_Episode_Thirddiagnosis: 'F20.9'
[08:04:24] [DOC: 9320382] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:04:24] [DOC: 9320382] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:04:24] [DOC: 9320382] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:04:24] [DOC: 9320382] ✅ Patient data written to CSV: Pauline Bergeron | Sex:  | Age: 80 | Service: LPN, Skilled Nursing | Payer:  | MRN: MA230222024501
[08:04:24] ✅    ✅ Document 9320382 processed and saved successfully
[08:04:24] 🔄 
🔄 Step 8: Saving API details...
[08:04:24] [DOC: 9320382] ℹ️  API push details saved for document 9320382
[08:04:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320372                         ║
================================================================================
[08:04:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:04:24] ℹ️  Date: 05/30/2025
[08:04:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:04:27] [DOC: 9320372] ✅ Text extracted using pdfplumber (14271 chars)
[08:04:27] ✅    ✅ Text extracted using pdfplumber (14271 chars)
[08:04:27] 🔄 
🔄 Step 2: Extracting patient data...
[08:04:30] ℹ️  AI extracted raw sex value: 'F'
[08:04:30] ℹ️  AI extracted service line: 'PT'
[08:04:30] ℹ️  AI extracted payer source: 'None'
[08:04:30] ℹ️  AI extracted diagnoses:
[08:04:30] ℹ️    - Diagnosis 1: 'None'
[08:04:30] ℹ️    - Diagnosis 2: 'None'
[08:04:30] ℹ️    - Diagnosis 3: 'None'
[08:04:30] ℹ️    - Diagnosis 4: 'None'
[08:04:30] ℹ️    - Diagnosis 5: 'None'
[08:04:30] ℹ️    - Diagnosis 6: 'None'
[08:04:30] ℹ️  Final extracted MRN: 'MA220701015501'
[08:04:30] ℹ️  Final extracted Sex: 'FEMALE'
[08:04:30] ℹ️  Final extracted Service Line: 'PT'
[08:04:30] ℹ️  Final extracted Payer Source: ''
[08:04:30] ✅ Patient data extraction completed successfully
[08:04:30] ✅    ✅ Patient data extracted successfully
[08:04:30] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:04:30] ✅    ✅ Patient identified: Ada Burns
[08:04:30] ✅    ✅ Patient name validation passed
[08:04:30] 🔄 
🔄 Step 3: Processing patient dates...
[08:04:30] [DOC: 9320372] ℹ️  DOB normalized: 01/15/1955
[08:04:30] [DOC: 9320372] ✅ Patient date processing completed successfully
[08:04:30] ✅    ✅ Date processing completed
[08:04:30] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[08:04:30] 🔄 
🔄 Step 4: Extracting order data...
[08:04:33] ℹ️  Order extraction - MRN: 'MA220701015501'
[08:04:33] ℹ️  Order extraction - Sex: 'FEMALE'
[08:04:33] ℹ️  Order extraction - Service Line: 'PT'
[08:04:33] ℹ️  Order extraction - Payer Source: ''
[08:04:33] ✅ Order data extraction completed successfully
[08:04:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:04:33] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[08:04:33] ℹ️  Service line consistent in both sources: 'PT'
[08:04:33] ✅ Patient name cross-validation successful
[08:04:33] ✅    ✅ Data merged successfully
[08:04:34] ✅    ✅ Order data extracted and validated
[08:04:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:04:34] [DOC: 9320372] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[08:04:34] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[08:04:34] 🔄 
🔄 Step 6: Pushing order to API...
[08:04:34] [DOC: 9320372] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[08:04:36] [DOC: 9320372] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:04:36] ❌    ❌ Failed to push order
[08:04:36] 🔄 
🔄 Step 7: Writing to CSV...
[08:04:36] [DOC: 9320372] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[08:04:36] [DOC: 9320372] ℹ️  Service Line extracted: 'PT'
[08:04:36] [DOC: 9320372] ℹ️  Payer Source extracted: ''
[08:04:36] [DOC: 9320372] ℹ️  Diagnosis codes being written:
[08:04:36] [DOC: 9320372] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:04:36] [DOC: 9320372] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:04:36] [DOC: 9320372] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:04:36] [DOC: 9320372] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:04:36] [DOC: 9320372] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:04:36] [DOC: 9320372] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:04:36] [DOC: 9320372] ✅ Patient data written to CSV: Ada Burns | Sex: FEMALE | Age: 70 | Service: PT | Payer:  | MRN: MA220701015501
[08:04:36] ✅    ✅ Document 9320372 processed and saved successfully
[08:04:36] 🔄 
🔄 Step 8: Saving API details...
[08:04:36] [DOC: 9320372] ℹ️  API push details saved for document 9320372
[08:04:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320352                         ║
================================================================================
[08:04:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:04:36] ℹ️  Date: 05/30/2025
[08:04:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:04:37] [DOC: 9320352] ✅ Text extracted using pdfplumber (970 chars)
[08:04:37] ✅    ✅ Text extracted using pdfplumber (970 chars)
[08:04:37] 🔄 
🔄 Step 2: Extracting patient data...
[08:04:40] ℹ️  AI extracted raw sex value: ''
[08:04:40] ℹ️  AI extracted service line: 'OT'
[08:04:40] ℹ️  AI extracted payer source: ''
[08:04:40] ℹ️  AI extracted diagnoses:
[08:04:40] ℹ️    - Diagnosis 1: 'E87.6'
[08:04:40] ℹ️    - Diagnosis 2: 'N30.90'
[08:04:40] ℹ️    - Diagnosis 3: 'G35'
[08:04:40] ℹ️    - Diagnosis 4: ''
[08:04:40] ℹ️    - Diagnosis 5: ''
[08:04:40] ℹ️    - Diagnosis 6: ''
[08:04:40] ℹ️  Final extracted MRN: 'MA250310104802'
[08:04:40] ℹ️  Final extracted Sex: ''
[08:04:40] ℹ️  Final extracted Service Line: 'OT'
[08:04:40] ℹ️  Final extracted Payer Source: ''
[08:04:40] ✅ Patient data extraction completed successfully
[08:04:40] ✅    ✅ Patient data extracted successfully
[08:04:40] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:04:40] ✅    ✅ Patient identified: Barbara Murach
[08:04:40] ✅    ✅ Patient name validation passed
[08:04:40] 🔄 
🔄 Step 3: Processing patient dates...
[08:04:40] [DOC: 9320352] ℹ️  DOB normalized: 10/30/1948
[08:04:40] [DOC: 9320352] ℹ️  Episode startOfEpisode normalized: 05/18/2025
[08:04:40] [DOC: 9320352] ℹ️  Episode endOfEpisode normalized: 07/16/2025
[08:04:40] [DOC: 9320352] ✅ Patient date processing completed successfully
[08:04:40] ✅    ✅ Date processing completed
[08:04:40] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:04:40] 🔄 
🔄 Step 4: Extracting order data...
[08:04:43] ℹ️  Order extraction - MRN: 'MA250310104802'
[08:04:43] ℹ️  Order extraction - Sex: ''
[08:04:43] ℹ️  Order extraction - Service Line: 'OT'
[08:04:43] ℹ️  Order extraction - Payer Source: ''
[08:04:43] ✅ Order data extraction completed successfully
[08:04:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:04:43] ℹ️  Using MRN from patient data: 'MA250310104802' over 'MA250310104802'
[08:04:43] ℹ️  Inferred sex as FEMALE from name: Barbara
[08:04:43] ℹ️  Service line consistent in both sources: 'OT'
[08:04:43] ✅ Patient name cross-validation successful
[08:04:43] ✅    ✅ Data merged successfully
[08:04:44] ✅    ✅ Order data extracted and validated
[08:04:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:04:44] [DOC: 9320352] ✅ Patient found in local cache: Barbara Murach, ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[08:04:44] ✅    ✅ Existing patient found with ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[08:04:44] 🔄 
🔄 Step 6: Pushing order to API...
[08:04:44] [DOC: 9320352] ℹ️  Pushing order via API for patient ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[08:04:45] [DOC: 9320352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18823"}
[08:04:45] ❌    ❌ Failed to push order
[08:04:45] 🔄 
🔄 Step 7: Writing to CSV...
[08:04:45] [DOC: 9320352] ℹ️  Calculated age: 76 from DOB: 10/30/1948
[08:04:45] [DOC: 9320352] ℹ️  Service Line extracted: 'OT'
[08:04:45] [DOC: 9320352] ℹ️  Payer Source extracted: ''
[08:04:45] [DOC: 9320352] ℹ️  Diagnosis codes being written:
[08:04:45] [DOC: 9320352] ℹ️    - Latest_Episode_Firstdiagnosis: 'E87.6'
[08:04:45] [DOC: 9320352] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.90'
[08:04:45] [DOC: 9320352] ℹ️    - Latest_Episode_Thirddiagnosis: 'G35'
[08:04:45] [DOC: 9320352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:04:45] [DOC: 9320352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:04:45] [DOC: 9320352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:04:45] [DOC: 9320352] ✅ Patient data written to CSV: Barbara Murach | Sex: FEMALE | Age: 76 | Service: OT | Payer:  | MRN: MA250310104802
[08:04:45] ✅    ✅ Document 9320352 processed and saved successfully
[08:04:45] 🔄 
🔄 Step 8: Saving API details...
[08:04:45] [DOC: 9320352] ℹ️  API push details saved for document 9320352
[08:04:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320349                         ║
================================================================================
[08:04:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:04:45] ℹ️  Date: 05/30/2025
[08:04:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:04:47] [DOC: 9320349] ✅ Text extracted using pdfplumber (1159 chars)
[08:04:47] ✅    ✅ Text extracted using pdfplumber (1159 chars)
[08:04:47] 🔄 
🔄 Step 2: Extracting patient data...
[08:04:50] ℹ️  AI extracted raw sex value: ''
[08:04:50] ℹ️  AI extracted service line: 'Occupational Therapy'
[08:04:50] ℹ️  AI extracted payer source: ''
[08:04:50] ℹ️  AI extracted diagnoses:
[08:04:50] ℹ️    - Diagnosis 1: 'E87.6'
[08:04:50] ℹ️    - Diagnosis 2: 'N30.90'
[08:04:50] ℹ️    - Diagnosis 3: 'G35'
[08:04:50] ℹ️    - Diagnosis 4: ''
[08:04:50] ℹ️    - Diagnosis 5: ''
[08:04:50] ℹ️    - Diagnosis 6: ''
[08:04:50] ℹ️  Final extracted MRN: 'MA250310104802'
[08:04:50] ℹ️  Final extracted Sex: ''
[08:04:50] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[08:04:50] ℹ️  Final extracted Payer Source: ''
[08:04:50] ✅ Patient data extraction completed successfully
[08:04:50] ✅    ✅ Patient data extracted successfully
[08:04:50] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:04:50] ✅    ✅ Patient identified: Barbara Murach
[08:04:50] ✅    ✅ Patient name validation passed
[08:04:50] 🔄 
🔄 Step 3: Processing patient dates...
[08:04:50] [DOC: 9320349] ℹ️  DOB normalized: 10/30/1948
[08:04:50] [DOC: 9320349] ℹ️  Episode startOfEpisode normalized: 05/18/2025
[08:04:50] [DOC: 9320349] ℹ️  Episode endOfEpisode normalized: 07/16/2025
[08:04:50] [DOC: 9320349] ✅ Patient date processing completed successfully
[08:04:50] ✅    ✅ Date processing completed
[08:04:50] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Murach
     └─ dob: 10/30/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250310104802
     └─ billingProvider: MATTHEW KIPPE MD
     └─ npi: 1841491396
     └─ physicianNPI: 1841491396
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'E87.6', 'secondDiagnosis': 'N30.90', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:04:50] 🔄 
🔄 Step 4: Extracting order data...
[08:04:52] ℹ️  Order extraction - MRN: 'MA250310104802'
[08:04:52] ℹ️  Order extraction - Sex: ''
[08:04:52] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[08:04:52] ℹ️  Order extraction - Payer Source: ''
[08:04:52] ✅ Order data extraction completed successfully
[08:04:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:04:52] ℹ️  Using MRN from patient data: 'MA250310104802' over 'MA250310104802'
[08:04:52] ℹ️  Inferred sex as FEMALE from name: Barbara
[08:04:52] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[08:04:52] ✅ Patient name cross-validation successful
[08:04:52] ✅    ✅ Data merged successfully
[08:04:54] ✅    ✅ Order data extracted and validated
[08:04:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:04:54] [DOC: 9320349] ✅ Patient found in local cache: Barbara Murach, ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[08:04:54] ✅    ✅ Existing patient found with ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[08:04:54] 🔄 
🔄 Step 6: Pushing order to API...
[08:04:54] [DOC: 9320349] ℹ️  Pushing order via API for patient ID: e5eb2d0b-a9d6-4dc4-9ee4-f75d028c5256
[08:04:55] [DOC: 9320349] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18824"}
[08:04:55] ❌    ❌ Failed to push order
[08:04:55] 🔄 
🔄 Step 7: Writing to CSV...
[08:04:55] [DOC: 9320349] ℹ️  Calculated age: 76 from DOB: 10/30/1948
[08:04:55] [DOC: 9320349] ℹ️  Service Line extracted: 'Occupational Therapy'
[08:04:55] [DOC: 9320349] ℹ️  Payer Source extracted: ''
[08:04:55] [DOC: 9320349] ℹ️  Diagnosis codes being written:
[08:04:55] [DOC: 9320349] ℹ️    - Latest_Episode_Firstdiagnosis: 'E87.6'
[08:04:55] [DOC: 9320349] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.90'
[08:04:55] [DOC: 9320349] ℹ️    - Latest_Episode_Thirddiagnosis: 'G35'
[08:04:55] [DOC: 9320349] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:04:55] [DOC: 9320349] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:04:55] [DOC: 9320349] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:04:55] [DOC: 9320349] ✅ Patient data written to CSV: Barbara Murach | Sex: FEMALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: MA250310104802
[08:04:55] ✅    ✅ Document 9320349 processed and saved successfully
[08:04:55] 🔄 
🔄 Step 8: Saving API details...
[08:04:55] [DOC: 9320349] ℹ️  API push details saved for document 9320349
[08:04:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320278                         ║
================================================================================
[08:04:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:04:55] ℹ️  Date: 05/30/2025
[08:04:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:05:00] [DOC: 9320278] ✅ Text extracted using pdfplumber (13642 chars)
[08:05:00] ✅    ✅ Text extracted using pdfplumber (13642 chars)
[08:05:00] 🔄 
🔄 Step 2: Extracting patient data...
[08:05:03] ℹ️  AI extracted raw sex value: 'M'
[08:05:03] ℹ️  AI extracted service line: 'PT'
[08:05:03] ℹ️  AI extracted payer source: ''
[08:05:03] ℹ️  AI extracted diagnoses:
[08:05:03] ℹ️    - Diagnosis 1: 'J44.1'
[08:05:03] ℹ️    - Diagnosis 2: 'J45.909'
[08:05:03] ℹ️    - Diagnosis 3: ''
[08:05:03] ℹ️    - Diagnosis 4: ''
[08:05:03] ℹ️    - Diagnosis 5: ''
[08:05:03] ℹ️    - Diagnosis 6: ''
[08:05:03] ℹ️  Final extracted MRN: 'MA250331114803'
[08:05:03] ℹ️  Final extracted Sex: 'MALE'
[08:05:03] ℹ️  Final extracted Service Line: 'PT'
[08:05:03] ℹ️  Final extracted Payer Source: ''
[08:05:03] ✅ Patient data extraction completed successfully
[08:05:03] ✅    ✅ Patient data extracted successfully
[08:05:03] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:05:03] ✅    ✅ Patient identified: David Sturgeon
[08:05:03] ✅    ✅ Patient name validation passed
[08:05:03] 🔄 
🔄 Step 3: Processing patient dates...
[08:05:03] [DOC: 9320278] ℹ️  DOB normalized: 11/14/1948
[08:05:03] [DOC: 9320278] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[08:05:03] [DOC: 9320278] ✅ Patient date processing completed successfully
[08:05:03] ✅    ✅ Date processing completed
[08:05:03] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:05:03] 🔄 
🔄 Step 4: Extracting order data...
[08:05:06] ℹ️  Order extraction - MRN: 'MA250331114803'
[08:05:06] ℹ️  Order extraction - Sex: 'MALE'
[08:05:06] ℹ️  Order extraction - Service Line: 'PT'
[08:05:06] ℹ️  Order extraction - Payer Source: ''
[08:05:06] ✅ Order data extraction completed successfully
[08:05:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:05:06] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[08:05:06] ℹ️  Service line consistent in both sources: 'PT'
[08:05:06] ✅ Patient name cross-validation successful
[08:05:06] ✅    ✅ Data merged successfully
[08:05:07] ⚠️     ❌ Skipping - missing episode start date
[08:05:07] [DOC: 9320278] ℹ️  API push details saved for document 9320278
================================================================================
║                        Processing Document ID: 9320269                         ║
================================================================================
[08:05:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:05:07] ℹ️  Date: 05/30/2025
[08:05:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:05:10] [DOC: 9320269] ✅ Text extracted using pdfplumber (14308 chars)
[08:05:10] ✅    ✅ Text extracted using pdfplumber (14308 chars)
[08:05:10] 🔄 
🔄 Step 2: Extracting patient data...
[08:05:13] ℹ️  AI extracted raw sex value: 'F'
[08:05:13] ℹ️  AI extracted service line: 'PT'
[08:05:13] ℹ️  AI extracted payer source: 'None'
[08:05:13] ℹ️  AI extracted diagnoses:
[08:05:13] ℹ️    - Diagnosis 1: 'None'
[08:05:13] ℹ️    - Diagnosis 2: 'None'
[08:05:13] ℹ️    - Diagnosis 3: 'None'
[08:05:13] ℹ️    - Diagnosis 4: 'None'
[08:05:13] ℹ️    - Diagnosis 5: 'None'
[08:05:13] ℹ️    - Diagnosis 6: 'None'
[08:05:13] ℹ️  Final extracted MRN: 'MA210121015502'
[08:05:13] ℹ️  Final extracted Sex: 'FEMALE'
[08:05:13] ℹ️  Final extracted Service Line: 'PT'
[08:05:13] ℹ️  Final extracted Payer Source: ''
[08:05:13] ✅ Patient data extraction completed successfully
[08:05:13] ✅    ✅ Patient data extracted successfully
[08:05:13] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:05:13] ✅    ✅ Patient identified: Louise Rivard
[08:05:13] ✅    ✅ Patient name validation passed
[08:05:13] 🔄 
🔄 Step 3: Processing patient dates...
[08:05:13] [DOC: 9320269] ℹ️  DOB normalized: 01/26/1955
[08:05:13] [DOC: 9320269] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[08:05:13] [DOC: 9320269] ✅ Patient date processing completed successfully
[08:05:13] ✅    ✅ Date processing completed
[08:05:13] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025'}]
[08:05:13] 🔄 
🔄 Step 4: Extracting order data...
[08:05:16] ℹ️  Order extraction - MRN: 'MA210121015502'
[08:05:16] ℹ️  Order extraction - Sex: 'FEMALE'
[08:05:16] ℹ️  Order extraction - Service Line: 'PT'
[08:05:16] ℹ️  Order extraction - Payer Source: ''
[08:05:16] ✅ Order data extraction completed successfully
[08:05:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:05:16] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[08:05:16] ℹ️  Service line consistent in both sources: 'PT'
[08:05:16] ✅ Patient name cross-validation successful
[08:05:16] ✅    ✅ Data merged successfully
[08:05:17] ⚠️     ❌ Skipping - missing episode start date
[08:05:17] [DOC: 9320269] ℹ️  API push details saved for document 9320269
================================================================================
║                        Processing Document ID: 9320265                         ║
================================================================================
[08:05:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:05:17] ℹ️  Date: 05/30/2025
[08:05:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:05:19] [DOC: 9320265] ✅ Text extracted using pdfplumber (983 chars)
[08:05:19] ✅    ✅ Text extracted using pdfplumber (983 chars)
[08:05:19] 🔄 
🔄 Step 2: Extracting patient data...
[08:05:22] ℹ️  AI extracted raw sex value: ''
[08:05:22] ℹ️  AI extracted service line: 'Nursing'
[08:05:22] ℹ️  AI extracted payer source: ''
[08:05:22] ℹ️  AI extracted diagnoses:
[08:05:22] ℹ️    - Diagnosis 1: 'F03.918'
[08:05:22] ℹ️    - Diagnosis 2: 'F33.1'
[08:05:22] ℹ️    - Diagnosis 3: 'I10'
[08:05:22] ℹ️    - Diagnosis 4: ''
[08:05:22] ℹ️    - Diagnosis 5: ''
[08:05:22] ℹ️    - Diagnosis 6: ''
[08:05:22] ℹ️  Final extracted MRN: 'MA200723054001'
[08:05:22] ℹ️  Final extracted Sex: ''
[08:05:22] ℹ️  Final extracted Service Line: 'Nursing'
[08:05:22] ℹ️  Final extracted Payer Source: ''
[08:05:22] ✅ Patient data extraction completed successfully
[08:05:22] ✅    ✅ Patient data extracted successfully
[08:05:22] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Pimentel
     └─ dob: 05/19/1940
     └─ patientSex: 
     └─ medicalRecordNo: MA200723054001
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F03.918', 'secondDiagnosis': 'F33.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:05:22] ✅    ✅ Patient identified: Maria Pimentel
[08:05:22] ✅    ✅ Patient name validation passed
[08:05:22] 🔄 
🔄 Step 3: Processing patient dates...
[08:05:22] [DOC: 9320265] ℹ️  DOB normalized: 05/19/1940
[08:05:22] [DOC: 9320265] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[08:05:22] [DOC: 9320265] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[08:05:22] [DOC: 9320265] ✅ Patient date processing completed successfully
[08:05:22] ✅    ✅ Date processing completed
[08:05:22] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Pimentel
     └─ dob: 05/19/1940
     └─ patientSex: 
     └─ medicalRecordNo: MA200723054001
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F03.918', 'secondDiagnosis': 'F33.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:05:22] 🔄 
🔄 Step 4: Extracting order data...
[08:05:24] ℹ️  Order extraction - MRN: 'MA200723054001'
[08:05:24] ℹ️  Order extraction - Sex: ''
[08:05:24] ℹ️  Order extraction - Service Line: 'Nursing'
[08:05:24] ℹ️  Order extraction - Payer Source: ''
[08:05:24] ✅ Order data extraction completed successfully
[08:05:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:05:24] ℹ️  Using MRN from patient data: 'MA200723054001' over 'MA200723054001'
[08:05:24] ℹ️  Inferred sex as FEMALE from name: Maria
[08:05:24] ℹ️  Service line consistent in both sources: 'Nursing'
[08:05:24] ✅ Patient name cross-validation successful
[08:05:24] ✅    ✅ Data merged successfully
[08:05:26] ✅    ✅ Order data extracted and validated
[08:05:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:05:26] [DOC: 9320265] ✅ Patient found in local cache: Maria Pimentel, ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[08:05:26] ✅    ✅ Existing patient found with ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[08:05:26] 🔄 
🔄 Step 6: Pushing order to API...
[08:05:26] [DOC: 9320265] ℹ️  Pushing order via API for patient ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[08:05:27] [DOC: 9320265] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18827"}
[08:05:27] ❌    ❌ Failed to push order
[08:05:27] 🔄 
🔄 Step 7: Writing to CSV...
[08:05:27] [DOC: 9320265] ℹ️  Calculated age: 85 from DOB: 05/19/1940
[08:05:27] [DOC: 9320265] ℹ️  Service Line extracted: 'Nursing'
[08:05:27] [DOC: 9320265] ℹ️  Payer Source extracted: ''
[08:05:27] [DOC: 9320265] ℹ️  Diagnosis codes being written:
[08:05:27] [DOC: 9320265] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.918'
[08:05:27] [DOC: 9320265] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.1'
[08:05:27] [DOC: 9320265] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[08:05:27] [DOC: 9320265] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:05:27] [DOC: 9320265] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:05:27] [DOC: 9320265] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:05:27] [DOC: 9320265] ✅ Patient data written to CSV: Maria Pimentel | Sex: FEMALE | Age: 85 | Service: Nursing | Payer:  | MRN: MA200723054001
[08:05:27] ✅    ✅ Document 9320265 processed and saved successfully
[08:05:27] 🔄 
🔄 Step 8: Saving API details...
[08:05:27] [DOC: 9320265] ℹ️  API push details saved for document 9320265
[08:05:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320261                         ║
================================================================================
[08:05:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:05:27] ℹ️  Date: 05/30/2025
[08:05:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:05:29] [DOC: 9320261] ✅ Text extracted using pdfplumber (3631 chars)
[08:05:29] ✅    ✅ Text extracted using pdfplumber (3631 chars)
[08:05:29] 🔄 
🔄 Step 2: Extracting patient data...
[08:05:32] ℹ️  AI extracted raw sex value: ''
[08:05:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:05:32] ℹ️  AI extracted payer source: ''
[08:05:32] ℹ️  AI extracted diagnoses:
[08:05:32] ℹ️    - Diagnosis 1: 'I10'
[08:05:32] ℹ️    - Diagnosis 2: 'J45.909'
[08:05:32] ℹ️    - Diagnosis 3: 'M19.90'
[08:05:32] ℹ️    - Diagnosis 4: ''
[08:05:32] ℹ️    - Diagnosis 5: ''
[08:05:32] ℹ️    - Diagnosis 6: ''
[08:05:32] ℹ️  Final extracted MRN: 'MA210617063801'
[08:05:32] ℹ️  Final extracted Sex: ''
[08:05:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:05:32] ℹ️  Final extracted Payer Source: ''
[08:05:32] ✅ Patient data extraction completed successfully
[08:05:32] ✅    ✅ Patient data extracted successfully
[08:05:32] 📊 Patient Response
     └─ patientFName: Jeanne
     └─ patientLName: Borges
     └─ dob: 06/28/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA210617063801
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:05:32] ✅    ✅ Patient identified: Jeanne Borges
[08:05:32] ✅    ✅ Patient name validation passed
[08:05:32] 🔄 
🔄 Step 3: Processing patient dates...
[08:05:32] [DOC: 9320261] ℹ️  DOB normalized: 06/28/1938
[08:05:32] [DOC: 9320261] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[08:05:32] [DOC: 9320261] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[08:05:32] [DOC: 9320261] ✅ Patient date processing completed successfully
[08:05:32] ✅    ✅ Date processing completed
[08:05:32] 📊 Processed Patient Data
     └─ patientFName: Jeanne
     └─ patientLName: Borges
     └─ dob: 06/28/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA210617063801
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'J45.909', 'thirdDiagnosis': 'M19.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:05:32] 🔄 
🔄 Step 4: Extracting order data...
[08:05:35] ℹ️  Order extraction - MRN: 'MA210617063801'
[08:05:35] ℹ️  Order extraction - Sex: ''
[08:05:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:05:35] ℹ️  Order extraction - Payer Source: ''
[08:05:35] ✅ Order data extraction completed successfully
[08:05:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:05:35] ℹ️  Using MRN from patient data: 'MA210617063801' over 'MA210617063801'
[08:05:35] ⚠️  Could not determine sex using any available method
[08:05:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:05:35] ✅ Patient name cross-validation successful
[08:05:35] ✅    ✅ Data merged successfully
[08:05:36] ✅    ✅ Order data extracted and validated
[08:05:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:05:36] [DOC: 9320261] ✅ Patient found in local cache: Jeanne Borges, ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[08:05:36] ✅    ✅ Existing patient found with ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[08:05:36] 🔄 
🔄 Step 6: Pushing order to API...
[08:05:36] [DOC: 9320261] ℹ️  Pushing order via API for patient ID: d891f490-6513-4bfa-931c-b1a61fd8d90e
[08:05:37] [DOC: 9320261] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18829"}
[08:05:37] ❌    ❌ Failed to push order
[08:05:37] 🔄 
🔄 Step 7: Writing to CSV...
[08:05:37] [DOC: 9320261] ℹ️  Calculated age: 86 from DOB: 06/28/1938
[08:05:37] [DOC: 9320261] ℹ️  Service Line extracted: 'Skilled Nursing'
[08:05:37] [DOC: 9320261] ℹ️  Payer Source extracted: ''
[08:05:37] [DOC: 9320261] ℹ️  Diagnosis codes being written:
[08:05:37] [DOC: 9320261] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[08:05:37] [DOC: 9320261] ℹ️    - Latest_Episode_Seconddiagnosis: 'J45.909'
[08:05:37] [DOC: 9320261] ℹ️    - Latest_Episode_Thirddiagnosis: 'M19.90'
[08:05:37] [DOC: 9320261] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:05:37] [DOC: 9320261] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:05:37] [DOC: 9320261] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:05:37] [DOC: 9320261] ✅ Patient data written to CSV: Jeanne Borges | Sex:  | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: MA210617063801
[08:05:37] ✅    ✅ Document 9320261 processed and saved successfully
[08:05:37] 🔄 
🔄 Step 8: Saving API details...
[08:05:37] [DOC: 9320261] ℹ️  API push details saved for document 9320261
[08:05:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320152                         ║
================================================================================
[08:05:37] ℹ️  Agency: AccentCare Fall River
[08:05:37] ℹ️  Date: 05/30/2025
[08:05:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:05:49] [DOC: 9320152] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[08:05:58] [DOC: 9320152] ✅ Text extracted using tesseract_ocr (15232 chars)
[08:05:58] ✅    ✅ Text extracted using tesseract_ocr (15215 chars)
[08:05:58] 🔄 
🔄 Step 2: Extracting patient data...
[08:06:01] ℹ️  AI extracted raw sex value: 'F'
[08:06:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:06:01] ℹ️  AI extracted payer source: ''
[08:06:01] ℹ️  AI extracted diagnoses:
[08:06:01] ℹ️    - Diagnosis 1: 'N39.0'
[08:06:01] ℹ️    - Diagnosis 2: 'B96.5'
[08:06:01] ℹ️    - Diagnosis 3: 'F03.011'
[08:06:01] ℹ️    - Diagnosis 4: 'I11.9'
[08:06:01] ℹ️    - Diagnosis 5: 'E11.65'
[08:06:01] ℹ️    - Diagnosis 6: 'T38.0X5D'
[08:06:01] ℹ️  Final extracted MRN: 'C0200225049201'
[08:06:01] ℹ️  Final extracted Sex: 'FEMALE'
[08:06:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:06:01] ℹ️  Final extracted Payer Source: ''
[08:06:01] ✅ Patient data extraction completed successfully
[08:06:01] ✅    ✅ Patient data extracted successfully
[08:06:01] 📊 Patient Response
     └─ patientFName: Brunilda
     └─ patientLName: Jorge
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'F03.011', 'fourthDiagnosis': 'I11.9', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'T38.0X5D'}]
[08:06:01] ✅    ✅ Patient identified: Brunilda Jorge
[08:06:01] ✅    ✅ Patient name validation passed
[08:06:01] 🔄 
🔄 Step 3: Processing patient dates...
[08:06:01] [DOC: 9320152] ℹ️  DOB normalized: 11/15/1938
[08:06:01] [DOC: 9320152] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[08:06:01] [DOC: 9320152] ✅ Patient date processing completed successfully
[08:06:01] ✅    ✅ Date processing completed
[08:06:01] 📊 Processed Patient Data
     └─ patientFName: Brunilda
     └─ patientLName: Jorge
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'F03.011', 'fourthDiagnosis': 'I11.9', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'T38.0X5D'}]
[08:06:01] 🔄 
🔄 Step 4: Extracting order data...
[08:06:04] ℹ️  Order extraction - MRN: 'C0200225049201'
[08:06:04] ℹ️  Order extraction - Sex: 'FEMALE'
[08:06:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:06:04] ℹ️  Order extraction - Payer Source: ''
[08:06:04] ✅ Order data extraction completed successfully
[08:06:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:06:04] ℹ️  Using MRN from patient data: 'C0200225049201' over 'C0200225049201'
[08:06:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:06:04] ✅ Patient name cross-validation successful
[08:06:04] ✅    ✅ Data merged successfully
[08:06:05] ✅    ✅ Order data extracted and validated
[08:06:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:06:05] [DOC: 9320152] ✅ Patient found in local cache: Brunilda Jorge, ID: be097701-4784-41f4-8780-f2f69c6e2485
[08:06:05] ✅    ✅ Existing patient found with ID: be097701-4784-41f4-8780-f2f69c6e2485
[08:06:05] 🔄 
🔄 Step 6: Pushing order to API...
[08:06:05] [DOC: 9320152] ℹ️  Pushing order via API for patient ID: be097701-4784-41f4-8780-f2f69c6e2485
[08:06:07] [DOC: 9320152] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18830"}
[08:06:07] ❌    ❌ Failed to push order
[08:06:07] 🔄 
🔄 Step 7: Writing to CSV...
[08:06:07] [DOC: 9320152] ℹ️  Calculated age: 86 from DOB: 11/15/1938
[08:06:07] [DOC: 9320152] ℹ️  Service Line extracted: 'Skilled Nursing'
[08:06:07] [DOC: 9320152] ℹ️  Payer Source extracted: ''
[08:06:07] [DOC: 9320152] ℹ️  Diagnosis codes being written:
[08:06:07] [DOC: 9320152] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[08:06:07] [DOC: 9320152] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.5'
[08:06:07] [DOC: 9320152] ℹ️    - Latest_Episode_Thirddiagnosis: 'F03.011'
[08:06:07] [DOC: 9320152] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.9'
[08:06:07] [DOC: 9320152] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.65'
[08:06:07] [DOC: 9320152] ℹ️    - Latest_Episode_Sixthdiagnosis: 'T38.0X5D'
[08:06:07] [DOC: 9320152] ✅ Patient data written to CSV: Brunilda Jorge | Sex: FEMALE | Age: 86 | Service: Skilled Nursing | Payer:  | MRN: C0200225049201
[08:06:07] ✅    ✅ Document 9320152 processed and saved successfully
[08:06:07] 🔄 
🔄 Step 8: Saving API details...
[08:06:07] [DOC: 9320152] ℹ️  API push details saved for document 9320152
[08:06:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320147                         ║
================================================================================
[08:06:07] ℹ️  Agency: Alphacare Home Health Agency
[08:06:07] ℹ️  Date: 05/30/2025
[08:06:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:06:15] [DOC: 9320147] ✅ Text extracted using pdfplumber (17122 chars)
[08:06:15] ✅    ✅ Text extracted using pdfplumber (17122 chars)
[08:06:15] 🔄 
🔄 Step 2: Extracting patient data...
[08:06:18] ℹ️  AI extracted raw sex value: 'F'
[08:06:18] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[08:06:18] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[08:06:18] ℹ️  AI extracted diagnoses:
[08:06:18] ℹ️    - Diagnosis 1: 'F31.81'
[08:06:18] ℹ️    - Diagnosis 2: 'F33.9'
[08:06:18] ℹ️    - Diagnosis 3: 'F41.1'
[08:06:18] ℹ️    - Diagnosis 4: 'M79.7'
[08:06:18] ℹ️    - Diagnosis 5: 'E66.9'
[08:06:18] ℹ️    - Diagnosis 6: 'M50.90'
[08:06:18] ℹ️  Final extracted MRN: '000001761'
[08:06:18] ℹ️  Final extracted Sex: 'FEMALE'
[08:06:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[08:06:18] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[08:06:18] ✅ Patient data extraction completed successfully
[08:06:18] ✅    ✅ Patient data extracted successfully
[08:06:18] 📊 Patient Response
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[08:06:18] ✅    ✅ Patient identified: Melissa Edwards
[08:06:18] ✅    ✅ Patient name validation passed
[08:06:18] 🔄 
🔄 Step 3: Processing patient dates...
[08:06:18] [DOC: 9320147] ℹ️  DOB normalized: 07/10/1978
[08:06:18] [DOC: 9320147] ℹ️  Episode startOfCare normalized: 05/21/2021
[08:06:18] [DOC: 9320147] ℹ️  Episode startOfEpisode normalized: 04/30/2025
[08:06:18] [DOC: 9320147] ℹ️  Episode endOfEpisode normalized: 06/28/2025
[08:06:18] [DOC: 9320147] ✅ Patient date processing completed successfully
[08:06:18] ✅    ✅ Date processing completed
[08:06:18] 📊 Processed Patient Data
     └─ patientFName: Melissa
     └─ patientLName: Edwards
     └─ dob: 07/10/1978
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 000001761
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 12 Hathaway Rd
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: 774-400-0534
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2021', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/28/2025', 'firstDiagnosis': 'F31.81', 'secondDiagnosis': 'F33.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'M50.90'}]
[08:06:18] 🔄 
🔄 Step 4: Extracting order data...
[08:06:21] ℹ️  Order extraction - MRN: '000001761'
[08:06:21] ℹ️  Order extraction - Sex: 'FEMALE'
[08:06:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[08:06:21] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[08:06:21] ✅ Order data extraction completed successfully
[08:06:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:06:21] ℹ️  Using MRN from patient data: '000001761' over '000001761'
[08:06:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[08:06:21] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[08:06:21] ✅ Patient name cross-validation successful
[08:06:21] ✅    ✅ Data merged successfully
[08:06:22] ✅    ✅ Order data extracted and validated
[08:06:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:06:22] [DOC: 9320147] ✅ Patient found in local cache: Melissa Edwards, ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[08:06:22] ✅    ✅ Existing patient found with ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[08:06:22] 🔄 
🔄 Step 6: Pushing order to API...
[08:06:22] [DOC: 9320147] ℹ️  Pushing order via API for patient ID: 257cfb91-b85a-4e9a-b16f-edd612824c50
[08:06:24] [DOC: 9320147] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:06:24] ❌    ❌ Failed to push order
[08:06:24] 🔄 
🔄 Step 7: Writing to CSV...
[08:06:24] [DOC: 9320147] ℹ️  Calculated age: 46 from DOB: 07/10/1978
[08:06:24] [DOC: 9320147] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[08:06:24] [DOC: 9320147] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[08:06:24] [DOC: 9320147] ℹ️  Diagnosis codes being written:
[08:06:24] [DOC: 9320147] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.81'
[08:06:24] [DOC: 9320147] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.9'
[08:06:24] [DOC: 9320147] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[08:06:24] [DOC: 9320147] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M79.7'
[08:06:24] [DOC: 9320147] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.9'
[08:06:24] [DOC: 9320147] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M50.90'
[08:06:24] [DOC: 9320147] ✅ Patient data written to CSV: Melissa Edwards | Sex: FEMALE | Age: 46 | Service: Skilled Nursing, Physical Therapy | Payer: MassHealth (Medicaid) | MRN: 000001761
[08:06:24] ✅    ✅ Document 9320147 processed and saved successfully
[08:06:24] 🔄 
🔄 Step 8: Saving API details...
[08:06:24] [DOC: 9320147] ℹ️  API push details saved for document 9320147
[08:06:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319870                         ║
================================================================================
[08:06:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:06:24] ℹ️  Date: 05/30/2025
[08:06:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:06:26] [DOC: 9319870] ✅ Text extracted using pdfplumber (3290 chars)
[08:06:26] ✅    ✅ Text extracted using pdfplumber (3278 chars)
[08:06:26] 🔄 
🔄 Step 2: Extracting patient data...
[08:06:29] ℹ️  AI extracted raw sex value: ''
[08:06:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:06:29] ℹ️  AI extracted payer source: ''
[08:06:29] ℹ️  AI extracted diagnoses:
[08:06:29] ℹ️    - Diagnosis 1: 'K55.9'
[08:06:29] ℹ️    - Diagnosis 2: 'E11.42'
[08:06:29] ℹ️    - Diagnosis 3: 'H81.13'
[08:06:29] ℹ️    - Diagnosis 4: 'None'
[08:06:29] ℹ️    - Diagnosis 5: 'None'
[08:06:29] ℹ️    - Diagnosis 6: 'None'
[08:06:29] ℹ️  Final extracted MRN: 'MA22129014501'
[08:06:29] ℹ️  Final extracted Sex: ''
[08:06:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:06:29] ℹ️  Final extracted Payer Source: ''
[08:06:29] ✅ Patient data extraction completed successfully
[08:06:29] ✅    ✅ Patient data extracted successfully
[08:06:29] 📊 Patient Response
     └─ patientFName: Eunice
     └─ patientLName: Rosa
     └─ dob: 01/17/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA22129014501
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'K55.9', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'H81.13', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:06:29] ✅    ✅ Patient identified: Eunice Rosa
[08:06:29] ✅    ✅ Patient name validation passed
[08:06:29] 🔄 
🔄 Step 3: Processing patient dates...
[08:06:29] [DOC: 9319870] ℹ️  DOB normalized: 01/17/1945
[08:06:29] [DOC: 9319870] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[08:06:29] [DOC: 9319870] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[08:06:29] [DOC: 9319870] ✅ Patient date processing completed successfully
[08:06:29] ✅    ✅ Date processing completed
[08:06:29] 📊 Processed Patient Data
     └─ patientFName: Eunice
     └─ patientLName: Rosa
     └─ dob: 01/17/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA22129014501
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'K55.9', 'secondDiagnosis': 'E11.42', 'thirdDiagnosis': 'H81.13'}]
[08:06:29] 🔄 
🔄 Step 4: Extracting order data...
[08:06:32] ℹ️  Order extraction - MRN: 'MA22129014501'
[08:06:32] ℹ️  Order extraction - Sex: ''
[08:06:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:06:32] ℹ️  Order extraction - Payer Source: ''
[08:06:32] ✅ Order data extraction completed successfully
[08:06:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:06:32] ℹ️  Using MRN from patient data: 'MA22129014501' over 'MA22129014501'
[08:06:32] ⚠️  Could not determine sex using any available method
[08:06:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:06:32] ✅ Patient name cross-validation successful
[08:06:32] ✅    ✅ Data merged successfully
[08:06:33] ✅    ✅ Order data extracted and validated
[08:06:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:06:42] [DOC: 9319870] ℹ️  Patient not found in cache or API: Eunice Rosa
[08:06:42] [DOC: 9319870] ℹ️  Patient not found, creating new patient via API...
[08:06:42] [DOC: 9319870] ℹ️  Creating patient via API: Eunice Rosa
[08:06:43] [DOC: 9319870] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:06:43] ❌    ❌ Failed to create patient
[08:06:43] [DOC: 9319870] ℹ️  API push details saved for document 9319870
================================================================================
║                        Processing Document ID: 9319860                         ║
================================================================================
[08:06:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:06:43] ℹ️  Date: 05/30/2025
[08:06:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:06:46] [DOC: 9319860] ✅ Text extracted using pdfplumber (17583 chars)
[08:06:46] ✅    ✅ Text extracted using pdfplumber (17583 chars)
[08:06:46] 🔄 
🔄 Step 2: Extracting patient data...
[08:06:49] ℹ️  AI extracted raw sex value: 'M'
[08:06:49] ℹ️  AI extracted service line: 'PT'
[08:06:49] ℹ️  AI extracted payer source: ''
[08:06:49] ℹ️  AI extracted diagnoses:
[08:06:49] ℹ️    - Diagnosis 1: ''
[08:06:49] ℹ️    - Diagnosis 2: ''
[08:06:49] ℹ️    - Diagnosis 3: ''
[08:06:49] ℹ️    - Diagnosis 4: ''
[08:06:49] ℹ️    - Diagnosis 5: ''
[08:06:49] ℹ️    - Diagnosis 6: ''
[08:06:49] ℹ️  Final extracted MRN: '100999559'
[08:06:49] ℹ️  Final extracted Sex: 'MALE'
[08:06:49] ℹ️  Final extracted Service Line: 'PT'
[08:06:49] ℹ️  Final extracted Payer Source: ''
[08:06:49] ✅ Patient data extraction completed successfully
[08:06:49] ✅    ✅ Patient data extracted successfully
[08:06:49] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:06:49] ✅    ✅ Patient identified: Joseph Rodgers
[08:06:49] ✅    ✅ Patient name validation passed
[08:06:49] 🔄 
🔄 Step 3: Processing patient dates...
[08:06:49] [DOC: 9319860] ℹ️  DOB normalized: 05/10/1942
[08:06:49] [DOC: 9319860] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[08:06:49] [DOC: 9319860] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[08:06:49] [DOC: 9319860] ✅ Patient date processing completed successfully
[08:06:49] ✅    ✅ Date processing completed
[08:06:49] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:06:49] 🔄 
🔄 Step 4: Extracting order data...
[08:06:52] ℹ️  Order extraction - MRN: '100999559'
[08:06:52] ℹ️  Order extraction - Sex: 'MALE'
[08:06:52] ℹ️  Order extraction - Service Line: 'PT'
[08:06:52] ℹ️  Order extraction - Payer Source: ''
[08:06:52] ✅ Order data extraction completed successfully
[08:06:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:06:52] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[08:06:52] ℹ️  Service line consistent in both sources: 'PT'
[08:06:52] ✅ Patient name cross-validation successful
[08:06:52] ✅    ✅ Data merged successfully
[08:06:54] ✅    ✅ Order data extracted and validated
[08:06:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:06:54] [DOC: 9319860] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[08:06:54] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[08:06:54] 🔄 
🔄 Step 6: Pushing order to API...
[08:06:54] [DOC: 9319860] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[08:06:55] [DOC: 9319860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:06:55] ❌    ❌ Failed to push order
[08:06:55] 🔄 
🔄 Step 7: Writing to CSV...
[08:06:55] [DOC: 9319860] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[08:06:55] [DOC: 9319860] ℹ️  Service Line extracted: 'PT'
[08:06:55] [DOC: 9319860] ℹ️  Payer Source extracted: ''
[08:06:55] [DOC: 9319860] ℹ️  Diagnosis codes being written:
[08:06:55] [DOC: 9319860] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:06:55] [DOC: 9319860] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:06:55] [DOC: 9319860] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:06:55] [DOC: 9319860] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:06:55] [DOC: 9319860] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:06:55] [DOC: 9319860] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:06:55] [DOC: 9319860] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: PT | Payer:  | MRN: 100999559
[08:06:55] ✅    ✅ Document 9319860 processed and saved successfully
[08:06:55] 🔄 
🔄 Step 8: Saving API details...
[08:06:55] [DOC: 9319860] ℹ️  API push details saved for document 9319860
[08:06:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319856                         ║
================================================================================
[08:06:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:06:55] ℹ️  Date: 05/30/2025
[08:06:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:07:00] [DOC: 9319856] ✅ Text extracted using pdfplumber (15267 chars)
[08:07:00] ✅    ✅ Text extracted using pdfplumber (15267 chars)
[08:07:00] 🔄 
🔄 Step 2: Extracting patient data...
[08:07:02] ℹ️  AI extracted raw sex value: 'M'
[08:07:02] ℹ️  AI extracted service line: 'PT'
[08:07:02] ℹ️  AI extracted payer source: 'None'
[08:07:02] ℹ️  AI extracted diagnoses:
[08:07:02] ℹ️    - Diagnosis 1: 'None'
[08:07:02] ℹ️    - Diagnosis 2: 'None'
[08:07:02] ℹ️    - Diagnosis 3: 'None'
[08:07:02] ℹ️    - Diagnosis 4: 'None'
[08:07:02] ℹ️    - Diagnosis 5: 'None'
[08:07:02] ℹ️    - Diagnosis 6: 'None'
[08:07:02] ℹ️  Final extracted MRN: 'MA240226073801'
[08:07:02] ℹ️  Final extracted Sex: 'MALE'
[08:07:02] ℹ️  Final extracted Service Line: 'PT'
[08:07:02] ℹ️  Final extracted Payer Source: ''
[08:07:02] ✅ Patient data extraction completed successfully
[08:07:02] ✅    ✅ Patient data extracted successfully
[08:07:02] 📊 Patient Response
     └─ patientFName: Gonzalo
     └─ patientLName: Morales
     └─ dob: 07/05/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240226073801
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:07:02] ✅    ✅ Patient identified: Gonzalo Morales
[08:07:02] ✅    ✅ Patient name validation passed
[08:07:02] 🔄 
🔄 Step 3: Processing patient dates...
[08:07:02] [DOC: 9319856] ℹ️  DOB normalized: 07/05/1938
[08:07:02] [DOC: 9319856] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[08:07:02] [DOC: 9319856] ✅ Patient date processing completed successfully
[08:07:02] ✅    ✅ Date processing completed
[08:07:02] 📊 Processed Patient Data
     └─ patientFName: Gonzalo
     └─ patientLName: Morales
     └─ dob: 07/05/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240226073801
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025'}]
[08:07:02] 🔄 
🔄 Step 4: Extracting order data...
[08:07:05] ℹ️  Order extraction - MRN: 'MA240226073801'
[08:07:05] ℹ️  Order extraction - Sex: 'MALE'
[08:07:05] ℹ️  Order extraction - Service Line: 'PT'
[08:07:05] ℹ️  Order extraction - Payer Source: ''
[08:07:05] ✅ Order data extraction completed successfully
[08:07:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:07:05] ℹ️  Using MRN from patient data: 'MA240226073801' over 'MA240226073801'
[08:07:05] ℹ️  Service line consistent in both sources: 'PT'
[08:07:05] ✅ Patient name cross-validation successful
[08:07:05] ✅    ✅ Data merged successfully
[08:07:06] ✅    ✅ Order data extracted and validated
[08:07:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:07:06] [DOC: 9319856] ✅ Patient found in local cache: Gonzalo Morales, ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[08:07:06] ✅    ✅ Existing patient found with ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[08:07:06] 🔄 
🔄 Step 6: Pushing order to API...
[08:07:06] [DOC: 9319856] ℹ️  Pushing order via API for patient ID: dedc1b4c-ffdd-47fc-93de-4defc877275b
[08:07:08] [DOC: 9319856] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:07:08] ❌    ❌ Failed to push order
[08:07:08] 🔄 
🔄 Step 7: Writing to CSV...
[08:07:08] [DOC: 9319856] ℹ️  Calculated age: 86 from DOB: 07/05/1938
[08:07:08] [DOC: 9319856] ℹ️  Service Line extracted: 'PT'
[08:07:08] [DOC: 9319856] ℹ️  Payer Source extracted: ''
[08:07:08] [DOC: 9319856] ℹ️  Diagnosis codes being written:
[08:07:08] [DOC: 9319856] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:07:08] [DOC: 9319856] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:07:08] [DOC: 9319856] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:07:08] [DOC: 9319856] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:07:08] [DOC: 9319856] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:07:08] [DOC: 9319856] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:07:08] [DOC: 9319856] ✅ Patient data written to CSV: Gonzalo Morales | Sex: MALE | Age: 86 | Service: PT | Payer:  | MRN: MA240226073801
[08:07:08] ✅    ✅ Document 9319856 processed and saved successfully
[08:07:08] 🔄 
🔄 Step 8: Saving API details...
[08:07:08] [DOC: 9319856] ℹ️  API push details saved for document 9319856
[08:07:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319674                         ║
================================================================================
[08:07:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:07:08] ℹ️  Date: 05/30/2025
[08:07:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:07:10] [DOC: 9319674] ✅ Text extracted using pdfplumber (14184 chars)
[08:07:10] ✅    ✅ Text extracted using pdfplumber (14184 chars)
[08:07:10] 🔄 
🔄 Step 2: Extracting patient data...
[08:07:13] ℹ️  AI extracted raw sex value: 'F'
[08:07:13] ℹ️  AI extracted service line: 'OT'
[08:07:13] ℹ️  AI extracted payer source: ''
[08:07:13] ℹ️  AI extracted diagnoses:
[08:07:13] ℹ️    - Diagnosis 1: 'Z48.812'
[08:07:13] ℹ️    - Diagnosis 2: 'I25.10'
[08:07:13] ℹ️    - Diagnosis 3: 'I20.0'
[08:07:13] ℹ️    - Diagnosis 4: 'I25.1'
[08:07:13] ℹ️    - Diagnosis 5: 'None'
[08:07:13] ℹ️    - Diagnosis 6: 'None'
[08:07:13] ℹ️  Final extracted MRN: 'MA250507034403'
[08:07:13] ℹ️  Final extracted Sex: 'FEMALE'
[08:07:13] ℹ️  Final extracted Service Line: 'OT'
[08:07:13] ℹ️  Final extracted Payer Source: ''
[08:07:13] ✅ Patient data extraction completed successfully
[08:07:13] ✅    ✅ Patient data extracted successfully
[08:07:13] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Teixeira
     └─ dob: 03/03/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250507034403
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/21/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I20.0', 'fourthDiagnosis': 'I25.1', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:07:13] ✅    ✅ Patient identified: Maria Teixeira
[08:07:13] ✅    ✅ Patient name validation passed
[08:07:13] 🔄 
🔄 Step 3: Processing patient dates...
[08:07:13] [DOC: 9319674] ℹ️  DOB normalized: 03/03/1944
[08:07:13] [DOC: 9319674] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[08:07:13] [DOC: 9319674] ✅ Patient date processing completed successfully
[08:07:13] ✅    ✅ Date processing completed
[08:07:13] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Teixeira
     └─ dob: 03/03/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250507034403
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/21/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I20.0', 'fourthDiagnosis': 'I25.1'}]
[08:07:13] 🔄 
🔄 Step 4: Extracting order data...
[08:07:17] ℹ️  Order extraction - MRN: 'MA250507034403'
[08:07:17] ℹ️  Order extraction - Sex: 'FEMALE'
[08:07:17] ℹ️  Order extraction - Service Line: 'OT'
[08:07:17] ℹ️  Order extraction - Payer Source: ''
[08:07:17] ✅ Order data extraction completed successfully
[08:07:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:07:17] ℹ️  Using MRN from patient data: 'MA250507034403' over 'MA250507034403'
[08:07:17] ℹ️  Service line consistent in both sources: 'OT'
[08:07:17] ✅ Patient name cross-validation successful
[08:07:17] ✅    ✅ Data merged successfully
[08:07:18] ✅    ✅ Order data extracted and validated
[08:07:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:07:18] [DOC: 9319674] ✅ Patient found in local cache: Maria Teixeira, ID: 28dfa46f-3202-44f3-959a-6a0a90355e47
[08:07:18] ✅    ✅ Existing patient found with ID: 28dfa46f-3202-44f3-959a-6a0a90355e47
[08:07:18] 🔄 
🔄 Step 6: Pushing order to API...
[08:07:18] [DOC: 9319674] ℹ️  Pushing order via API for patient ID: 28dfa46f-3202-44f3-959a-6a0a90355e47
[08:07:19] [DOC: 9319674] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:07:19] ❌    ❌ Failed to push order
[08:07:19] 🔄 
🔄 Step 7: Writing to CSV...
[08:07:19] [DOC: 9319674] ℹ️  Calculated age: 81 from DOB: 03/03/1944
[08:07:19] [DOC: 9319674] ℹ️  Service Line extracted: 'OT'
[08:07:19] [DOC: 9319674] ℹ️  Payer Source extracted: ''
[08:07:19] [DOC: 9319674] ℹ️  Diagnosis codes being written:
[08:07:19] [DOC: 9319674] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.812'
[08:07:19] [DOC: 9319674] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[08:07:19] [DOC: 9319674] ℹ️    - Latest_Episode_Thirddiagnosis: 'I20.0'
[08:07:19] [DOC: 9319674] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.1'
[08:07:19] [DOC: 9319674] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:07:19] [DOC: 9319674] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:07:19] [DOC: 9319674] ✅ Patient data written to CSV: Maria Teixeira | Sex: FEMALE | Age: 81 | Service: OT | Payer:  | MRN: MA250507034403
[08:07:19] ✅    ✅ Document 9319674 processed and saved successfully
[08:07:19] 🔄 
🔄 Step 8: Saving API details...
[08:07:19] [DOC: 9319674] ℹ️  API push details saved for document 9319674
[08:07:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319648                         ║
================================================================================
[08:07:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[08:07:19] ℹ️  Date: 05/30/2025
[08:07:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:07:22] [DOC: 9319648] ✅ Text extracted using pdfplumber (12405 chars)
[08:07:22] ✅    ✅ Text extracted using pdfplumber (12405 chars)
[08:07:22] 🔄 
🔄 Step 2: Extracting patient data...
[08:07:24] ℹ️  AI extracted raw sex value: 'M'
[08:07:24] ℹ️  AI extracted service line: 'OT'
[08:07:24] ℹ️  AI extracted payer source: 'None'
[08:07:24] ℹ️  AI extracted diagnoses:
[08:07:24] ℹ️    - Diagnosis 1: 'None'
[08:07:24] ℹ️    - Diagnosis 2: 'None'
[08:07:24] ℹ️    - Diagnosis 3: 'None'
[08:07:24] ℹ️    - Diagnosis 4: 'None'
[08:07:24] ℹ️    - Diagnosis 5: 'None'
[08:07:24] ℹ️    - Diagnosis 6: 'None'
[08:07:24] ℹ️  Final extracted MRN: '101002230'
[08:07:24] ℹ️  Final extracted Sex: 'MALE'
[08:07:24] ℹ️  Final extracted Service Line: 'OT'
[08:07:24] ℹ️  Final extracted Payer Source: ''
[08:07:24] ✅ Patient data extraction completed successfully
[08:07:24] ✅    ✅ Patient data extracted successfully
[08:07:24] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Tonetto
     └─ dob: 08/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 101002230
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/23/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:07:24] ✅    ✅ Patient identified: John Tonetto
[08:07:24] ✅    ✅ Patient name validation passed
[08:07:24] 🔄 
🔄 Step 3: Processing patient dates...
[08:07:24] [DOC: 9319648] ℹ️  DOB normalized: 08/08/1933
[08:07:24] [DOC: 9319648] ℹ️  Episode startOfEpisode normalized: 05/23/2025
[08:07:24] [DOC: 9319648] ✅ Patient date processing completed successfully
[08:07:24] ✅    ✅ Date processing completed
[08:07:24] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Tonetto
     └─ dob: 08/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 101002230
     └─ billingProvider: Dr. Gularek, Jordan C.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/23/2025'}]
[08:07:24] 🔄 
🔄 Step 4: Extracting order data...
[08:07:28] ℹ️  Order extraction - MRN: '101002230'
[08:07:28] ℹ️  Order extraction - Sex: 'MALE'
[08:07:28] ℹ️  Order extraction - Service Line: 'OT'
[08:07:28] ℹ️  Order extraction - Payer Source: ''
[08:07:28] ✅ Order data extraction completed successfully
[08:07:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:07:28] ℹ️  Using MRN from patient data: '101002230' over '101002230'
[08:07:28] ℹ️  Service line consistent in both sources: 'OT'
[08:07:28] ✅ Patient name cross-validation successful
[08:07:28] ✅    ✅ Data merged successfully
[08:07:29] ✅    ✅ Order data extracted and validated
[08:07:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:07:29] [DOC: 9319648] ✅ Patient found in local cache: John Tonetto, ID: 276dab0d-c709-4df6-835a-f07135610c4e
[08:07:29] ✅    ✅ Existing patient found with ID: 276dab0d-c709-4df6-835a-f07135610c4e
[08:07:29] 🔄 
🔄 Step 6: Pushing order to API...
[08:07:29] [DOC: 9319648] ℹ️  Pushing order via API for patient ID: 276dab0d-c709-4df6-835a-f07135610c4e
[08:07:30] [DOC: 9319648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:07:30] ❌    ❌ Failed to push order
[08:07:30] 🔄 
🔄 Step 7: Writing to CSV...
[08:07:30] [DOC: 9319648] ℹ️  Calculated age: 91 from DOB: 08/08/1933
[08:07:30] [DOC: 9319648] ℹ️  Service Line extracted: 'OT'
[08:07:30] [DOC: 9319648] ℹ️  Payer Source extracted: ''
[08:07:30] [DOC: 9319648] ℹ️  Diagnosis codes being written:
[08:07:30] [DOC: 9319648] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:07:30] [DOC: 9319648] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:07:30] [DOC: 9319648] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:07:30] [DOC: 9319648] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:07:30] [DOC: 9319648] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:07:30] [DOC: 9319648] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:07:30] [DOC: 9319648] ✅ Patient data written to CSV: John Tonetto | Sex: MALE | Age: 91 | Service: OT | Payer:  | MRN: 101002230
[08:07:30] ✅    ✅ Document 9319648 processed and saved successfully
[08:07:30] 🔄 
🔄 Step 8: Saving API details...
[08:07:30] [DOC: 9319648] ℹ️  API push details saved for document 9319648
[08:07:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319603                         ║
================================================================================
[08:07:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:07:30] ℹ️  Date: 05/30/2025
[08:07:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:07:32] [DOC: 9319603] ✅ Text extracted using pdfplumber (9990 chars)
[08:07:32] ✅    ✅ Text extracted using pdfplumber (9990 chars)
[08:07:32] 🔄 
🔄 Step 2: Extracting patient data...
[08:07:35] ℹ️  AI extracted raw sex value: 'F'
[08:07:35] ℹ️  AI extracted service line: 'Physical Therapy, Skilled nursing'
[08:07:35] ℹ️  AI extracted payer source: ''
[08:07:35] ℹ️  AI extracted diagnoses:
[08:07:35] ℹ️    - Diagnosis 1: 'S06.300D'
[08:07:35] ℹ️    - Diagnosis 2: 'W19.XXXD'
[08:07:35] ℹ️    - Diagnosis 3: 'I10'
[08:07:35] ℹ️    - Diagnosis 4: 'I25.10'
[08:07:35] ℹ️    - Diagnosis 5: 'E78.5'
[08:07:35] ℹ️    - Diagnosis 6: 'K21.9'
[08:07:35] ℹ️  Final extracted MRN: '3092653'
[08:07:35] ℹ️  Final extracted Sex: 'FEMALE'
[08:07:35] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled nursing'
[08:07:35] ℹ️  Final extracted Payer Source: ''
[08:07:35] ✅ Patient data extraction completed successfully
[08:07:35] ✅    ✅ Patient data extracted successfully
[08:07:35] 📊 Patient Response
     └─ patientFName: Jeannette
     └─ patientLName: Whitlock
     └─ dob: 09/12/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3092653
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'S06.300D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[08:07:35] ✅    ✅ Patient identified: Jeannette Whitlock
[08:07:35] ✅    ✅ Patient name validation passed
[08:07:35] 🔄 
🔄 Step 3: Processing patient dates...
[08:07:35] [DOC: 9319603] ℹ️  DOB normalized: 09/12/1936
[08:07:35] [DOC: 9319603] ℹ️  Episode startOfCare normalized: 05/07/2025
[08:07:35] [DOC: 9319603] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[08:07:35] [DOC: 9319603] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[08:07:35] [DOC: 9319603] ✅ Patient date processing completed successfully
[08:07:35] ✅    ✅ Date processing completed
[08:07:35] 📊 Processed Patient Data
     └─ patientFName: Jeannette
     └─ patientLName: Whitlock
     └─ dob: 09/12/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3092653
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'S06.300D', 'secondDiagnosis': 'W19.XXXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'K21.9'}]
[08:07:35] 🔄 
🔄 Step 4: Extracting order data...
[08:07:38] ℹ️  Order extraction - MRN: '3092653'
[08:07:38] ℹ️  Order extraction - Sex: 'FEMALE'
[08:07:38] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[08:07:38] ℹ️  Order extraction - Payer Source: ''
[08:07:38] ✅ Order data extraction completed successfully
[08:07:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:07:38] ℹ️  Using MRN from patient data: '3092653' over '3092653'
[08:07:38] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled nursing' + Order='Physical Therapy' = 'Physical Therapy, Skilled nursing'
[08:07:38] ✅ Patient name cross-validation successful
[08:07:38] ✅    ✅ Data merged successfully
[08:07:39] ✅    ✅ Order data extracted and validated
[08:07:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:07:39] [DOC: 9319603] ✅ Patient found in local cache: Jeannette Whitlock, ID: 483b8a68-8aef-46ad-8283-865c2089343b
[08:07:39] ✅    ✅ Existing patient found with ID: 483b8a68-8aef-46ad-8283-865c2089343b
[08:07:39] 🔄 
🔄 Step 6: Pushing order to API...
[08:07:39] [DOC: 9319603] ℹ️  Pushing order via API for patient ID: 483b8a68-8aef-46ad-8283-865c2089343b
[08:07:41] [DOC: 9319603] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18839"}
[08:07:41] ❌    ❌ Failed to push order
[08:07:41] 🔄 
🔄 Step 7: Writing to CSV...
[08:07:41] [DOC: 9319603] ℹ️  Calculated age: 88 from DOB: 09/12/1936
[08:07:41] [DOC: 9319603] ℹ️  Service Line extracted: 'Physical Therapy, Skilled nursing'
[08:07:41] [DOC: 9319603] ℹ️  Payer Source extracted: ''
[08:07:41] [DOC: 9319603] ℹ️  Diagnosis codes being written:
[08:07:41] [DOC: 9319603] ℹ️    - Latest_Episode_Firstdiagnosis: 'S06.300D'
[08:07:41] [DOC: 9319603] ℹ️    - Latest_Episode_Seconddiagnosis: 'W19.XXXD'
[08:07:41] [DOC: 9319603] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[08:07:41] [DOC: 9319603] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.10'
[08:07:41] [DOC: 9319603] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[08:07:41] [DOC: 9319603] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[08:07:41] [DOC: 9319603] ✅ Patient data written to CSV: Jeannette Whitlock | Sex: FEMALE | Age: 88 | Service: Physical Therapy, Skilled nursing | Payer:  | MRN: 3092653
[08:07:41] ✅    ✅ Document 9319603 processed and saved successfully
[08:07:41] 🔄 
🔄 Step 8: Saving API details...
[08:07:41] [DOC: 9319603] ℹ️  API push details saved for document 9319603
[08:07:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319596                         ║
================================================================================
[08:07:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:07:41] ℹ️  Date: 05/30/2025
[08:07:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:07:43] [DOC: 9319596] ✅ Text extracted using pdfplumber (17320 chars)
[08:07:43] ✅    ✅ Text extracted using pdfplumber (17320 chars)
[08:07:43] 🔄 
🔄 Step 2: Extracting patient data...
[08:07:47] ℹ️  AI extracted raw sex value: 'F'
[08:07:47] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:07:47] ℹ️  AI extracted payer source: ''
[08:07:47] ℹ️  AI extracted diagnoses:
[08:07:47] ℹ️    - Diagnosis 1: 'S81.811D'
[08:07:47] ℹ️    - Diagnosis 2: 'I87.2'
[08:07:47] ℹ️    - Diagnosis 3: 'I89.0'
[08:07:47] ℹ️    - Diagnosis 4: 'I10'
[08:07:47] ℹ️    - Diagnosis 5: 'E03.9'
[08:07:47] ℹ️    - Diagnosis 6: 'G47.33'
[08:07:47] ℹ️  Final extracted MRN: '3052261'
[08:07:47] ℹ️  Final extracted Sex: 'FEMALE'
[08:07:47] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:07:47] ℹ️  Final extracted Payer Source: ''
[08:07:47] ✅ Patient data extraction completed successfully
[08:07:47] ✅    ✅ Patient data extracted successfully
[08:07:47] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'S81.811D', 'secondDiagnosis': 'I87.2', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[08:07:47] ✅    ✅ Patient identified: Donna Trott
[08:07:47] ✅    ✅ Patient name validation passed
[08:07:47] 🔄 
🔄 Step 3: Processing patient dates...
[08:07:47] [DOC: 9319596] ℹ️  DOB normalized: 04/22/1943
[08:07:47] [DOC: 9319596] ℹ️  Episode startOfCare normalized: 05/09/2025
[08:07:47] [DOC: 9319596] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[08:07:47] [DOC: 9319596] ℹ️  Episode endOfEpisode normalized: 07/08/2025
[08:07:47] [DOC: 9319596] ✅ Patient date processing completed successfully
[08:07:47] ✅    ✅ Date processing completed
[08:07:47] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'S81.811D', 'secondDiagnosis': 'I87.2', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'G47.33'}]
[08:07:47] 🔄 
🔄 Step 4: Extracting order data...
[08:07:50] ℹ️  Order extraction - MRN: '3052261'
[08:07:50] ℹ️  Order extraction - Sex: 'FEMALE'
[08:07:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:07:50] ℹ️  Order extraction - Payer Source: ''
[08:07:50] ✅ Order data extraction completed successfully
[08:07:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:07:50] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[08:07:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:07:50] ✅ Patient name cross-validation successful
[08:07:50] ✅    ✅ Data merged successfully
[08:07:51] ✅    ✅ Order data extracted and validated
[08:07:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:07:51] [DOC: 9319596] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[08:07:51] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[08:07:51] 🔄 
🔄 Step 6: Pushing order to API...
[08:07:51] [DOC: 9319596] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[08:07:52] [DOC: 9319596] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18904"}
[08:07:52] ❌    ❌ Failed to push order
[08:07:52] 🔄 
🔄 Step 7: Writing to CSV...
[08:07:52] [DOC: 9319596] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[08:07:52] [DOC: 9319596] ℹ️  Service Line extracted: 'Skilled Nursing'
[08:07:52] [DOC: 9319596] ℹ️  Payer Source extracted: ''
[08:07:52] [DOC: 9319596] ℹ️  Diagnosis codes being written:
[08:07:52] [DOC: 9319596] ℹ️    - Latest_Episode_Firstdiagnosis: 'S81.811D'
[08:07:52] [DOC: 9319596] ℹ️    - Latest_Episode_Seconddiagnosis: 'I87.2'
[08:07:52] [DOC: 9319596] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[08:07:52] [DOC: 9319596] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[08:07:52] [DOC: 9319596] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E03.9'
[08:07:52] [DOC: 9319596] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[08:07:52] [DOC: 9319596] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 3052261
[08:07:52] ✅    ✅ Document 9319596 processed and saved successfully
[08:07:52] 🔄 
🔄 Step 8: Saving API details...
[08:07:52] [DOC: 9319596] ℹ️  API push details saved for document 9319596
[08:07:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319586                         ║
================================================================================
[08:07:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:07:52] ℹ️  Date: 05/30/2025
[08:07:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:07:54] [DOC: 9319586] ✅ Text extracted using pdfplumber (804 chars)
[08:07:54] ✅    ✅ Text extracted using pdfplumber (804 chars)
[08:07:54] 🔄 
🔄 Step 2: Extracting patient data...
[08:07:57] ℹ️  AI extracted raw sex value: 'F'
[08:07:57] ℹ️  AI extracted service line: ''
[08:07:57] ℹ️  AI extracted payer source: ''
[08:07:57] ℹ️  AI extracted diagnoses:
[08:07:57] ℹ️    - Diagnosis 1: ''
[08:07:57] ℹ️    - Diagnosis 2: ''
[08:07:57] ℹ️    - Diagnosis 3: ''
[08:07:57] ℹ️    - Diagnosis 4: ''
[08:07:57] ℹ️    - Diagnosis 5: ''
[08:07:57] ℹ️    - Diagnosis 6: ''
[08:07:57] ℹ️  Final extracted MRN: '3436729'
[08:07:57] ℹ️  Final extracted Sex: 'FEMALE'
[08:07:57] ℹ️  Final extracted Service Line: ''
[08:07:57] ℹ️  Final extracted Payer Source: ''
[08:07:57] ✅ Patient data extraction completed successfully
[08:07:57] ✅    ✅ Patient data extracted successfully
[08:07:57] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:07:57] ✅    ✅ Patient identified: Margaret Rudy
[08:07:57] ✅    ✅ Patient name validation passed
[08:07:57] 🔄 
🔄 Step 3: Processing patient dates...
[08:07:57] [DOC: 9319586] ℹ️  DOB normalized: 04/23/1952
[08:07:57] [DOC: 9319586] ✅ Patient date processing completed successfully
[08:07:57] ✅    ✅ Date processing completed
[08:07:57] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:07:57] 🔄 
🔄 Step 4: Extracting order data...
[08:07:59] ℹ️  Order extraction - MRN: '3436729'
[08:07:59] ℹ️  Order extraction - Sex: 'FEMALE'
[08:07:59] ℹ️  Order extraction - Service Line: ''
[08:07:59] ℹ️  Order extraction - Payer Source: ''
[08:07:59] ✅ Order data extraction completed successfully
[08:07:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:07:59] ℹ️  Using MRN from patient data: '3436729' over '3436729'
[08:07:59] ✅ Patient name cross-validation successful
[08:07:59] ✅    ✅ Data merged successfully
[08:08:00] ⚠️     ❌ Skipping - missing episode start date
[08:08:00] [DOC: 9319586] ℹ️  API push details saved for document 9319586
================================================================================
║                        Processing Document ID: 9319584                         ║
================================================================================
[08:08:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:00] ℹ️  Date: 05/30/2025
[08:08:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:08:02] [DOC: 9319584] ✅ Text extracted using pdfplumber (16197 chars)
[08:08:02] ✅    ✅ Text extracted using pdfplumber (16197 chars)
[08:08:02] 🔄 
🔄 Step 2: Extracting patient data...
[08:08:06] ℹ️  AI extracted raw sex value: 'F'
[08:08:06] ℹ️  AI extracted service line: 'Skilled Nursing, Medical Social Work, Clergy, Home Health Aide'
[08:08:06] ℹ️  AI extracted payer source: ''
[08:08:06] ℹ️  AI extracted diagnoses:
[08:08:06] ℹ️    - Diagnosis 1: 'G30.9'
[08:08:06] ℹ️    - Diagnosis 2: 'E03.9'
[08:08:06] ℹ️    - Diagnosis 3: 'E78.5'
[08:08:06] ℹ️    - Diagnosis 4: 'M48.00'
[08:08:06] ℹ️    - Diagnosis 5: 'F32.9'
[08:08:06] ℹ️    - Diagnosis 6: ''
[08:08:06] ℹ️  Final extracted MRN: '3436729'
[08:08:06] ℹ️  Final extracted Sex: 'FEMALE'
[08:08:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medical Social Work, Clergy, Home Health Aide'
[08:08:06] ℹ️  Final extracted Payer Source: ''
[08:08:06] ✅ Patient data extraction completed successfully
[08:08:06] ✅    ✅ Patient data extracted successfully
[08:08:06] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'M48.00', 'fifthDiagnosis': 'F32.9', 'sixthDiagnosis': ''}]
[08:08:06] ✅    ✅ Patient identified: Margaret Rudy
[08:08:06] ✅    ✅ Patient name validation passed
[08:08:06] 🔄 
🔄 Step 3: Processing patient dates...
[08:08:06] [DOC: 9319584] ℹ️  DOB normalized: 04/23/1952
[08:08:06] [DOC: 9319584] ℹ️  Episode startOfCare normalized: 05/28/2025
[08:08:06] [DOC: 9319584] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[08:08:06] [DOC: 9319584] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[08:08:06] [DOC: 9319584] ✅ Patient date processing completed successfully
[08:08:06] ✅    ✅ Date processing completed
[08:08:06] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work, Clergy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'M48.00', 'fifthDiagnosis': 'F32.9', 'sixthDiagnosis': ''}]
[08:08:06] 🔄 
🔄 Step 4: Extracting order data...
[08:08:08] ℹ️  Order extraction - MRN: '3436729'
[08:08:08] ℹ️  Order extraction - Sex: 'FEMALE'
[08:08:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[08:08:08] ℹ️  Order extraction - Payer Source: ''
[08:08:08] ✅ Order data extraction completed successfully
[08:08:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:08:08] ℹ️  Using MRN from patient data: '3436729' over '3436729'
[08:08:08] ℹ️  Combined service lines: Patient='Skilled Nursing, Medical Social Work, Clergy, Home Health Aide' + Order='Skilled Nursing, MSW, HHA' = 'Clergy, HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing'
[08:08:08] ✅ Patient name cross-validation successful
[08:08:08] ✅    ✅ Data merged successfully
[08:08:10] ✅    ✅ Order data extracted and validated
[08:08:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:08:10] [DOC: 9319584] ✅ Patient found in local cache: Margaret Rudy, ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[08:08:10] ✅    ✅ Existing patient found with ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[08:08:10] 🔄 
🔄 Step 6: Pushing order to API...
[08:08:10] [DOC: 9319584] ℹ️  Pushing order via API for patient ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[08:08:11] [DOC: 9319584] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18842"}
[08:08:11] ❌    ❌ Failed to push order
[08:08:11] 🔄 
🔄 Step 7: Writing to CSV...
[08:08:11] [DOC: 9319584] ℹ️  Calculated age: 73 from DOB: 04/23/1952
[08:08:11] [DOC: 9319584] ℹ️  Service Line extracted: 'Clergy, HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing'
[08:08:11] [DOC: 9319584] ℹ️  Payer Source extracted: ''
[08:08:11] [DOC: 9319584] ℹ️  Diagnosis codes being written:
[08:08:11] [DOC: 9319584] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[08:08:11] [DOC: 9319584] ℹ️    - Latest_Episode_Seconddiagnosis: 'E03.9'
[08:08:11] [DOC: 9319584] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[08:08:11] [DOC: 9319584] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M48.00'
[08:08:11] [DOC: 9319584] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.9'
[08:08:11] [DOC: 9319584] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:08:11] [DOC: 9319584] ✅ Patient data written to CSV: Margaret Rudy | Sex: FEMALE | Age: 73 | Service: Clergy, HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing | Payer:  | MRN: 3436729
[08:08:11] ✅    ✅ Document 9319584 processed and saved successfully
[08:08:11] 🔄 
🔄 Step 8: Saving API details...
[08:08:11] [DOC: 9319584] ℹ️  API push details saved for document 9319584
[08:08:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319581                         ║
================================================================================
[08:08:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:11] ℹ️  Date: 05/30/2025
[08:08:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:08:13] [DOC: 9319581] ✅ Text extracted using pdfplumber (6840 chars)
[08:08:13] ✅    ✅ Text extracted using pdfplumber (6840 chars)
[08:08:13] 🔄 
🔄 Step 2: Extracting patient data...
[08:08:16] ℹ️  AI extracted raw sex value: 'F'
[08:08:16] ℹ️  AI extracted service line: 'RN'
[08:08:16] ℹ️  AI extracted payer source: ''
[08:08:16] ℹ️  AI extracted diagnoses:
[08:08:16] ℹ️    - Diagnosis 1: 'G30.9'
[08:08:16] ℹ️    - Diagnosis 2: 'F02.80'
[08:08:16] ℹ️    - Diagnosis 3: 'E03.9'
[08:08:16] ℹ️    - Diagnosis 4: 'E78.5'
[08:08:16] ℹ️    - Diagnosis 5: 'M48.00'
[08:08:16] ℹ️    - Diagnosis 6: 'F32.9'
[08:08:16] ℹ️  Final extracted MRN: '3436729'
[08:08:16] ℹ️  Final extracted Sex: 'FEMALE'
[08:08:16] ℹ️  Final extracted Service Line: 'RN'
[08:08:16] ℹ️  Final extracted Payer Source: ''
[08:08:16] ✅ Patient data extraction completed successfully
[08:08:16] ✅    ✅ Patient data extracted successfully
[08:08:16] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'F32.9'}]
[08:08:16] ✅    ✅ Patient identified: Margaret Rudy
[08:08:16] ✅    ✅ Patient name validation passed
[08:08:16] 🔄 
🔄 Step 3: Processing patient dates...
[08:08:16] [DOC: 9319581] ℹ️  DOB normalized: 04/23/1952
[08:08:16] [DOC: 9319581] ℹ️  Episode startOfCare normalized: 05/28/2025
[08:08:16] [DOC: 9319581] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[08:08:16] [DOC: 9319581] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[08:08:16] [DOC: 9319581] ✅ Patient date processing completed successfully
[08:08:16] ✅    ✅ Date processing completed
[08:08:16] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Rudy
     └─ dob: 04/23/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3436729
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'F32.9'}]
[08:08:16] 🔄 
🔄 Step 4: Extracting order data...
[08:08:19] ℹ️  Order extraction - MRN: '3436729'
[08:08:19] ℹ️  Order extraction - Sex: 'FEMALE'
[08:08:19] ℹ️  Order extraction - Service Line: 'RN'
[08:08:19] ℹ️  Order extraction - Payer Source: ''
[08:08:19] ✅ Order data extraction completed successfully
[08:08:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:08:19] ℹ️  Using MRN from patient data: '3436729' over '3436729'
[08:08:19] ℹ️  Service line consistent in both sources: 'RN'
[08:08:19] ✅ Patient name cross-validation successful
[08:08:19] ✅    ✅ Data merged successfully
[08:08:20] ✅    ✅ Order data extracted and validated
[08:08:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:08:20] [DOC: 9319581] ✅ Patient found in local cache: Margaret Rudy, ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[08:08:20] ✅    ✅ Existing patient found with ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[08:08:20] 🔄 
🔄 Step 6: Pushing order to API...
[08:08:20] [DOC: 9319581] ℹ️  Pushing order via API for patient ID: 7d39d469-8a76-4c9a-ae7d-38fc5aa06b53
[08:08:21] [DOC: 9319581] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18843"}
[08:08:21] ❌    ❌ Failed to push order
[08:08:21] 🔄 
🔄 Step 7: Writing to CSV...
[08:08:21] [DOC: 9319581] ℹ️  Calculated age: 73 from DOB: 04/23/1952
[08:08:21] [DOC: 9319581] ℹ️  Service Line extracted: 'RN'
[08:08:21] [DOC: 9319581] ℹ️  Payer Source extracted: ''
[08:08:21] [DOC: 9319581] ℹ️  Diagnosis codes being written:
[08:08:21] [DOC: 9319581] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[08:08:21] [DOC: 9319581] ℹ️    - Latest_Episode_Seconddiagnosis: 'F02.80'
[08:08:21] [DOC: 9319581] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[08:08:21] [DOC: 9319581] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[08:08:21] [DOC: 9319581] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M48.00'
[08:08:21] [DOC: 9319581] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.9'
[08:08:21] [DOC: 9319581] ✅ Patient data written to CSV: Margaret Rudy | Sex: FEMALE | Age: 73 | Service: RN | Payer:  | MRN: 3436729
[08:08:21] ✅    ✅ Document 9319581 processed and saved successfully
[08:08:21] 🔄 
🔄 Step 8: Saving API details...
[08:08:21] [DOC: 9319581] ℹ️  API push details saved for document 9319581
[08:08:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319556                         ║
================================================================================
[08:08:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:21] ℹ️  Date: 05/30/2025
[08:08:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:08:23] [DOC: 9319556] ✅ Text extracted using pdfplumber (1107 chars)
[08:08:23] ✅    ✅ Text extracted using pdfplumber (1107 chars)
[08:08:23] 🔄 
🔄 Step 2: Extracting patient data...
[08:08:25] ℹ️  AI extracted raw sex value: 'M'
[08:08:25] ℹ️  AI extracted service line: 'PT'
[08:08:25] ℹ️  AI extracted payer source: ''
[08:08:25] ℹ️  AI extracted diagnoses:
[08:08:25] ℹ️    - Diagnosis 1: 'None'
[08:08:25] ℹ️    - Diagnosis 2: 'None'
[08:08:25] ℹ️    - Diagnosis 3: 'None'
[08:08:25] ℹ️    - Diagnosis 4: 'None'
[08:08:25] ℹ️    - Diagnosis 5: 'None'
[08:08:25] ℹ️    - Diagnosis 6: 'None'
[08:08:25] ℹ️  Final extracted MRN: '2644347'
[08:08:25] ℹ️  Final extracted Sex: 'MALE'
[08:08:25] ℹ️  Final extracted Service Line: 'PT'
[08:08:25] ℹ️  Final extracted Payer Source: ''
[08:08:25] ✅ Patient data extraction completed successfully
[08:08:25] ✅    ✅ Patient data extracted successfully
[08:08:25] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Lawrence
     └─ dob: 07/03/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2644347
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:08:25] ✅    ✅ Patient identified: Richard Lawrence
[08:08:25] ✅    ✅ Patient name validation passed
[08:08:25] 🔄 
🔄 Step 3: Processing patient dates...
[08:08:25] [DOC: 9319556] ℹ️  DOB normalized: 07/03/1934
[08:08:25] [DOC: 9319556] ✅ Patient date processing completed successfully
[08:08:25] ✅    ✅ Date processing completed
[08:08:25] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Lawrence
     └─ dob: 07/03/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2644347
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[08:08:25] 🔄 
🔄 Step 4: Extracting order data...
[08:08:28] ℹ️  Order extraction - MRN: '2644347'
[08:08:28] ℹ️  Order extraction - Sex: 'MALE'
[08:08:28] ℹ️  Order extraction - Service Line: ''
[08:08:28] ℹ️  Order extraction - Payer Source: ''
[08:08:28] ✅ Order data extraction completed successfully
[08:08:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:08:28] ℹ️  Using MRN from patient data: '2644347' over '2644347'
[08:08:28] ℹ️  Using service line from patient data: 'PT'
[08:08:28] ✅ Patient name cross-validation successful
[08:08:28] ✅    ✅ Data merged successfully
[08:08:29] ⚠️     ❌ Skipping - missing episode start date
[08:08:29] [DOC: 9319556] ℹ️  API push details saved for document 9319556
================================================================================
║                        Processing Document ID: 9319551                         ║
================================================================================
[08:08:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:29] ℹ️  Date: 05/30/2025
[08:08:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:08:30] [DOC: 9319551] ✅ Text extracted using pdfplumber (2652 chars)
[08:08:30] ✅    ✅ Text extracted using pdfplumber (2652 chars)
[08:08:30] 🔄 
🔄 Step 2: Extracting patient data...
[08:08:33] ℹ️  AI extracted raw sex value: 'M'
[08:08:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:08:33] ℹ️  AI extracted payer source: ''
[08:08:33] ℹ️  AI extracted diagnoses:
[08:08:33] ℹ️    - Diagnosis 1: 'None'
[08:08:33] ℹ️    - Diagnosis 2: 'None'
[08:08:33] ℹ️    - Diagnosis 3: 'None'
[08:08:33] ℹ️    - Diagnosis 4: 'None'
[08:08:33] ℹ️    - Diagnosis 5: 'None'
[08:08:33] ℹ️    - Diagnosis 6: 'None'
[08:08:33] ℹ️  Final extracted MRN: '2643854'
[08:08:33] ℹ️  Final extracted Sex: 'MALE'
[08:08:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:08:33] ℹ️  Final extracted Payer Source: ''
[08:08:33] ✅ Patient data extraction completed successfully
[08:08:33] ✅    ✅ Patient data extracted successfully
[08:08:33] 📊 Patient Response
     └─ patientFName: Anthony
     └─ patientLName: Lawrence
     └─ dob: 04/04/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2643854
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/22/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[08:08:33] ✅    ✅ Patient identified: Anthony Lawrence
[08:08:33] ✅    ✅ Patient name validation passed
[08:08:33] 🔄 
🔄 Step 3: Processing patient dates...
[08:08:33] [DOC: 9319551] ℹ️  DOB normalized: 04/04/1957
[08:08:33] [DOC: 9319551] ℹ️  Episode startOfEpisode normalized: 05/22/2025
[08:08:33] [DOC: 9319551] ✅ Patient date processing completed successfully
[08:08:33] ✅    ✅ Date processing completed
[08:08:33] 📊 Processed Patient Data
     └─ patientFName: Anthony
     └─ patientLName: Lawrence
     └─ dob: 04/04/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2643854
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/22/2025'}]
[08:08:33] 🔄 
🔄 Step 4: Extracting order data...
[08:08:35] ℹ️  Order extraction - MRN: '2643854'
[08:08:35] ℹ️  Order extraction - Sex: 'MALE'
[08:08:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:08:35] ℹ️  Order extraction - Payer Source: ''
[08:08:35] ✅ Order data extraction completed successfully
[08:08:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:08:35] ℹ️  Using MRN from patient data: '2643854' over '2643854'
[08:08:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[08:08:35] ✅ Patient name cross-validation successful
[08:08:35] ✅    ✅ Data merged successfully
[08:08:37] ✅    ✅ Order data extracted and validated
[08:08:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:08:37] [DOC: 9319551] ✅ Patient found in local cache: Anthony Lawrence, ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[08:08:37] ✅    ✅ Existing patient found with ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[08:08:37] 🔄 
🔄 Step 6: Pushing order to API...
[08:08:37] [DOC: 9319551] ℹ️  Pushing order via API for patient ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[08:08:38] [DOC: 9319551] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18845"}
[08:08:38] ❌    ❌ Failed to push order
[08:08:38] 🔄 
🔄 Step 7: Writing to CSV...
[08:08:38] [DOC: 9319551] ℹ️  Calculated age: 68 from DOB: 04/04/1957
[08:08:38] [DOC: 9319551] ℹ️  Service Line extracted: 'Skilled Nursing'
[08:08:38] [DOC: 9319551] ℹ️  Payer Source extracted: ''
[08:08:38] [DOC: 9319551] ℹ️  Diagnosis codes being written:
[08:08:38] [DOC: 9319551] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:08:38] [DOC: 9319551] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:08:38] [DOC: 9319551] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:08:38] [DOC: 9319551] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:08:38] [DOC: 9319551] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:08:38] [DOC: 9319551] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:08:38] [DOC: 9319551] ✅ Patient data written to CSV: Anthony Lawrence | Sex: MALE | Age: 68 | Service: Skilled Nursing | Payer:  | MRN: 2643854
[08:08:38] ✅    ✅ Document 9319551 processed and saved successfully
[08:08:38] 🔄 
🔄 Step 8: Saving API details...
[08:08:38] [DOC: 9319551] ℹ️  API push details saved for document 9319551
[08:08:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319547                         ║
================================================================================
[08:08:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:38] ℹ️  Date: 05/30/2025
[08:08:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:08:39] [DOC: 9319547] ✅ Text extracted using pdfplumber (1231 chars)
[08:08:39] ✅    ✅ Text extracted using pdfplumber (1231 chars)
[08:08:39] 🔄 
🔄 Step 2: Extracting patient data...
[08:08:42] ℹ️  AI extracted raw sex value: 'F'
[08:08:42] ℹ️  AI extracted service line: 'PT'
[08:08:42] ℹ️  AI extracted payer source: ''
[08:08:42] ℹ️  AI extracted diagnoses:
[08:08:42] ℹ️    - Diagnosis 1: ''
[08:08:42] ℹ️    - Diagnosis 2: ''
[08:08:42] ℹ️    - Diagnosis 3: ''
[08:08:42] ℹ️    - Diagnosis 4: ''
[08:08:42] ℹ️    - Diagnosis 5: ''
[08:08:42] ℹ️    - Diagnosis 6: ''
[08:08:42] ℹ️  Final extracted MRN: '2534454'
[08:08:42] ℹ️  Final extracted Sex: 'FEMALE'
[08:08:42] ℹ️  Final extracted Service Line: 'PT'
[08:08:42] ℹ️  Final extracted Payer Source: ''
[08:08:42] ✅ Patient data extraction completed successfully
[08:08:42] ✅    ✅ Patient data extracted successfully
[08:08:42] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Grant
     └─ dob: 05/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2534454
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:08:42] ✅    ✅ Patient identified: Elaine Grant
[08:08:42] ✅    ✅ Patient name validation passed
[08:08:42] 🔄 
🔄 Step 3: Processing patient dates...
[08:08:42] [DOC: 9319547] ℹ️  DOB normalized: 05/13/1938
[08:08:42] [DOC: 9319547] ✅ Patient date processing completed successfully
[08:08:42] ✅    ✅ Date processing completed
[08:08:42] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Grant
     └─ dob: 05/13/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2534454
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:08:42] 🔄 
🔄 Step 4: Extracting order data...
[08:08:44] ℹ️  Order extraction - MRN: '2534454'
[08:08:44] ℹ️  Order extraction - Sex: 'FEMALE'
[08:08:44] ℹ️  Order extraction - Service Line: ''
[08:08:44] ℹ️  Order extraction - Payer Source: ''
[08:08:44] ✅ Order data extraction completed successfully
[08:08:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:08:44] ℹ️  Using MRN from patient data: '2534454' over '2534454'
[08:08:44] ℹ️  Using service line from patient data: 'PT'
[08:08:44] ✅ Patient name cross-validation successful
[08:08:44] ✅    ✅ Data merged successfully
[08:08:46] ✅    ✅ Order data extracted and validated
[08:08:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:08:46] [DOC: 9319547] ✅ Patient found in local cache: Elaine Grant, ID: f9d639b0-20d2-43f6-92ad-76378de59ddd
[08:08:46] ✅    ✅ Existing patient found with ID: f9d639b0-20d2-43f6-92ad-76378de59ddd
[08:08:46] 🔄 
🔄 Step 6: Pushing order to API...
[08:08:46] [DOC: 9319547] ℹ️  Pushing order via API for patient ID: f9d639b0-20d2-43f6-92ad-76378de59ddd
[08:08:47] [DOC: 9319547] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19936"}
[08:08:47] ❌    ❌ Failed to push order
[08:08:47] 🔄 
🔄 Step 7: Writing to CSV...
[08:08:47] [DOC: 9319547] ℹ️  Calculated age: 87 from DOB: 05/13/1938
[08:08:47] [DOC: 9319547] ℹ️  Service Line extracted: 'PT'
[08:08:47] [DOC: 9319547] ℹ️  Payer Source extracted: ''
[08:08:47] [DOC: 9319547] ℹ️  Diagnosis codes being written:
[08:08:47] [DOC: 9319547] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:08:47] [DOC: 9319547] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:08:47] [DOC: 9319547] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:08:47] [DOC: 9319547] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:08:47] [DOC: 9319547] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:08:47] [DOC: 9319547] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:08:47] [DOC: 9319547] ✅ Patient data written to CSV: Elaine Grant | Sex: FEMALE | Age: 87 | Service: PT | Payer:  | MRN: 2534454
[08:08:47] ✅    ✅ Document 9319547 processed and saved successfully
[08:08:47] 🔄 
🔄 Step 8: Saving API details...
[08:08:47] [DOC: 9319547] ℹ️  API push details saved for document 9319547
[08:08:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319544                         ║
================================================================================
[08:08:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:47] ℹ️  Date: 05/30/2025
[08:08:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:08:50] [DOC: 9319544] ✅ Text extracted using pdfplumber (24166 chars)
[08:08:50] ✅    ✅ Text extracted using pdfplumber (24166 chars)
[08:08:50] 🔄 
🔄 Step 2: Extracting patient data...
[08:08:53] ℹ️  AI extracted raw sex value: 'F'
[08:08:53] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[08:08:53] ℹ️  AI extracted payer source: ''
[08:08:53] ℹ️  AI extracted diagnoses:
[08:08:53] ℹ️    - Diagnosis 1: 'K94.23'
[08:08:53] ℹ️    - Diagnosis 2: 'J44.9'
[08:08:53] ℹ️    - Diagnosis 3: 'Z93.0'
[08:08:53] ℹ️    - Diagnosis 4: 'Z85.21'
[08:08:53] ℹ️    - Diagnosis 5: 'Z90.02'
[08:08:53] ℹ️    - Diagnosis 6: 'I73.9'
[08:08:53] ℹ️  Final extracted MRN: '2520839'
[08:08:53] ℹ️  Final extracted Sex: 'FEMALE'
[08:08:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[08:08:53] ℹ️  Final extracted Payer Source: ''
[08:08:53] ✅ Patient data extraction completed successfully
[08:08:53] ✅    ✅ Patient data extracted successfully
[08:08:53] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: Gomes
     └─ dob: 09/10/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520839
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': 'K94.23', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'Z93.0', 'fourthDiagnosis': 'Z85.21', 'fifthDiagnosis': 'Z90.02', 'sixthDiagnosis': 'I73.9'}]
[08:08:53] ✅    ✅ Patient identified: Brenda Gomes
[08:08:53] ✅    ✅ Patient name validation passed
[08:08:53] 🔄 
🔄 Step 3: Processing patient dates...
[08:08:53] [DOC: 9319544] ℹ️  DOB normalized: 09/10/1958
[08:08:53] [DOC: 9319544] ℹ️  Episode startOfCare normalized: 05/08/2025
[08:08:53] [DOC: 9319544] ℹ️  Episode startOfEpisode normalized: 05/09/2025
[08:08:53] [DOC: 9319544] ℹ️  Episode endOfEpisode normalized: 07/07/2025
[08:08:53] [DOC: 9319544] ✅ Patient date processing completed successfully
[08:08:53] ✅    ✅ Date processing completed
[08:08:53] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: Gomes
     └─ dob: 09/10/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520839
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': 'K94.23', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'Z93.0', 'fourthDiagnosis': 'Z85.21', 'fifthDiagnosis': 'Z90.02', 'sixthDiagnosis': 'I73.9'}]
[08:08:53] 🔄 
🔄 Step 4: Extracting order data...
[08:08:56] ℹ️  Order extraction - MRN: '2520839'
[08:08:56] ℹ️  Order extraction - Sex: 'FEMALE'
[08:08:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[08:08:56] ℹ️  Order extraction - Payer Source: ''
[08:08:56] ✅ Order data extraction completed successfully
[08:08:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:08:56] ℹ️  Using MRN from patient data: '2520839' over '2520839'
[08:08:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[08:08:56] ✅ Patient name cross-validation successful
[08:08:56] ✅    ✅ Data merged successfully
[08:08:57] ✅    ✅ Order data extracted and validated
[08:08:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:08:57] [DOC: 9319544] ✅ Patient found in local cache: Brenda Gomes, ID: 1b327d68-e1d7-497d-a470-a605c85cc1ab
[08:08:57] ✅    ✅ Existing patient found with ID: 1b327d68-e1d7-497d-a470-a605c85cc1ab
[08:08:57] 🔄 
🔄 Step 6: Pushing order to API...
[08:08:57] [DOC: 9319544] ℹ️  Pushing order via API for patient ID: 1b327d68-e1d7-497d-a470-a605c85cc1ab
[08:08:59] [DOC: 9319544] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18847"}
[08:08:59] ❌    ❌ Failed to push order
[08:08:59] 🔄 
🔄 Step 7: Writing to CSV...
[08:08:59] [DOC: 9319544] ℹ️  Calculated age: 66 from DOB: 09/10/1958
[08:08:59] [DOC: 9319544] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[08:08:59] [DOC: 9319544] ℹ️  Payer Source extracted: ''
[08:08:59] [DOC: 9319544] ℹ️  Diagnosis codes being written:
[08:08:59] [DOC: 9319544] ℹ️    - Latest_Episode_Firstdiagnosis: 'K94.23'
[08:08:59] [DOC: 9319544] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[08:08:59] [DOC: 9319544] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z93.0'
[08:08:59] [DOC: 9319544] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z85.21'
[08:08:59] [DOC: 9319544] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z90.02'
[08:08:59] [DOC: 9319544] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I73.9'
[08:08:59] [DOC: 9319544] ✅ Patient data written to CSV: Brenda Gomes | Sex: FEMALE | Age: 66 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2520839
[08:08:59] ✅    ✅ Document 9319544 processed and saved successfully
[08:08:59] 🔄 
🔄 Step 8: Saving API details...
[08:08:59] [DOC: 9319544] ℹ️  API push details saved for document 9319544
[08:08:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319528                         ║
================================================================================
[08:08:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:08:59] ℹ️  Date: 05/30/2025
[08:08:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:09:00] [DOC: 9319528] ✅ Text extracted using pdfplumber (954 chars)
[08:09:00] ✅    ✅ Text extracted using pdfplumber (954 chars)
[08:09:00] 🔄 
🔄 Step 2: Extracting patient data...
[08:09:02] ℹ️  AI extracted raw sex value: 'M'
[08:09:02] ℹ️  AI extracted service line: ''
[08:09:02] ℹ️  AI extracted payer source: ''
[08:09:02] ℹ️  AI extracted diagnoses:
[08:09:02] ℹ️    - Diagnosis 1: ''
[08:09:02] ℹ️    - Diagnosis 2: ''
[08:09:02] ℹ️    - Diagnosis 3: ''
[08:09:02] ℹ️    - Diagnosis 4: ''
[08:09:02] ℹ️    - Diagnosis 5: ''
[08:09:02] ℹ️    - Diagnosis 6: ''
[08:09:02] ℹ️  Final extracted MRN: '3171842'
[08:09:02] ℹ️  Final extracted Sex: 'MALE'
[08:09:02] ℹ️  Final extracted Service Line: ''
[08:09:02] ℹ️  Final extracted Payer Source: ''
[08:09:02] ✅ Patient data extraction completed successfully
[08:09:02] ✅    ✅ Patient data extracted successfully
[08:09:02] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Chaples
     └─ dob: 05/05/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 3171842
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:09:02] ✅    ✅ Patient identified: Robert Chaples
[08:09:02] ✅    ✅ Patient name validation passed
[08:09:02] 🔄 
🔄 Step 3: Processing patient dates...
[08:09:02] [DOC: 9319528] ℹ️  DOB normalized: 05/05/1932
[08:09:02] [DOC: 9319528] ✅ Patient date processing completed successfully
[08:09:02] ✅    ✅ Date processing completed
[08:09:02] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Chaples
     └─ dob: 05/05/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 3171842
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:09:02] 🔄 
🔄 Step 4: Extracting order data...
[08:09:05] ℹ️  Order extraction - MRN: '3171842'
[08:09:05] ℹ️  Order extraction - Sex: 'MALE'
[08:09:05] ℹ️  Order extraction - Service Line: ''
[08:09:05] ℹ️  Order extraction - Payer Source: ''
[08:09:05] ✅ Order data extraction completed successfully
[08:09:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:09:05] ℹ️  Using MRN from patient data: '3171842' over '3171842'
[08:09:05] ✅ Patient name cross-validation successful
[08:09:05] ✅    ✅ Data merged successfully
[08:09:06] ✅    ✅ Order data extracted and validated
[08:09:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:09:06] [DOC: 9319528] ✅ Patient found in local cache: Robert Chaples, ID: 12741552-a5c8-46db-8caf-43870c507abb
[08:09:06] ✅    ✅ Existing patient found with ID: 12741552-a5c8-46db-8caf-43870c507abb
[08:09:06] 🔄 
🔄 Step 6: Pushing order to API...
[08:09:06] [DOC: 9319528] ℹ️  Pushing order via API for patient ID: 12741552-a5c8-46db-8caf-43870c507abb
[08:09:07] [DOC: 9319528] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18848"}
[08:09:07] ❌    ❌ Failed to push order
[08:09:07] 🔄 
🔄 Step 7: Writing to CSV...
[08:09:07] [DOC: 9319528] ℹ️  Calculated age: 93 from DOB: 05/05/1932
[08:09:07] [DOC: 9319528] ℹ️  Service Line extracted: ''
[08:09:07] [DOC: 9319528] ℹ️  Payer Source extracted: ''
[08:09:07] [DOC: 9319528] ℹ️  Diagnosis codes being written:
[08:09:07] [DOC: 9319528] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:09:07] [DOC: 9319528] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:09:07] [DOC: 9319528] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:09:07] [DOC: 9319528] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:09:07] [DOC: 9319528] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:09:07] [DOC: 9319528] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:09:07] [DOC: 9319528] ✅ Patient data written to CSV: Robert Chaples | Sex: MALE | Age: 93 | Service:  | Payer:  | MRN: 3171842
[08:09:07] ✅    ✅ Document 9319528 processed and saved successfully
[08:09:07] 🔄 
🔄 Step 8: Saving API details...
[08:09:07] [DOC: 9319528] ℹ️  API push details saved for document 9319528
[08:09:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319521                         ║
================================================================================
[08:09:07] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:09:07] ℹ️  Date: 05/30/2025
[08:09:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:09:08] [DOC: 9319521] ✅ Text extracted using pdfplumber (2282 chars)
[08:09:08] ✅    ✅ Text extracted using pdfplumber (2282 chars)
[08:09:08] 🔄 
🔄 Step 2: Extracting patient data...
[08:09:11] ℹ️  AI extracted raw sex value: 'F'
[08:09:11] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[08:09:11] ℹ️  AI extracted payer source: ''
[08:09:11] ℹ️  AI extracted diagnoses:
[08:09:11] ℹ️    - Diagnosis 1: ''
[08:09:11] ℹ️    - Diagnosis 2: ''
[08:09:11] ℹ️    - Diagnosis 3: ''
[08:09:11] ℹ️    - Diagnosis 4: ''
[08:09:11] ℹ️    - Diagnosis 5: ''
[08:09:11] ℹ️    - Diagnosis 6: ''
[08:09:11] ℹ️  Final extracted MRN: '2208958'
[08:09:11] ℹ️  Final extracted Sex: 'FEMALE'
[08:09:11] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[08:09:11] ℹ️  Final extracted Payer Source: ''
[08:09:11] ✅ Patient data extraction completed successfully
[08:09:11] ✅    ✅ Patient data extracted successfully
[08:09:11] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:09:11] ✅    ✅ Patient identified: Carol Baden
[08:09:11] ✅    ✅ Patient name validation passed
[08:09:11] 🔄 
🔄 Step 3: Processing patient dates...
[08:09:11] [DOC: 9319521] ℹ️  DOB normalized: 07/19/1940
[08:09:11] [DOC: 9319521] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[08:09:11] [DOC: 9319521] ⚠️  Invalid endOfEpisode format: 08/25
[08:09:11] [DOC: 9319521] ✅ Patient date processing completed successfully
[08:09:11] ✅    ✅ Date processing completed
[08:09:11] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:09:11] 🔄 
🔄 Step 4: Extracting order data...
[08:09:13] ℹ️  Order extraction - MRN: '2208958'
[08:09:13] ℹ️  Order extraction - Sex: 'FEMALE'
[08:09:13] ℹ️  Order extraction - Service Line: 'SN, HHA'
[08:09:13] ℹ️  Order extraction - Payer Source: ''
[08:09:13] ✅ Order data extraction completed successfully
[08:09:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:09:13] ℹ️  Using MRN from patient data: '2208958' over '2208958'
[08:09:13] ℹ️  Combined service lines: Patient='Skilled Nursing, Home Health Aide' + Order='SN, HHA' = 'HHA, Home Health Aide, SN, Skilled Nursing'
[08:09:13] ✅ Patient name cross-validation successful
[08:09:13] ✅    ✅ Data merged successfully
[08:09:15] ✅    ✅ Order data extracted and validated
[08:09:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:09:15] [DOC: 9319521] ✅ Patient found in local cache: Carol Baden, ID: b21bad59-ac67-44df-a4c9-722195632f90
[08:09:15] ✅    ✅ Existing patient found with ID: b21bad59-ac67-44df-a4c9-722195632f90
[08:09:15] 🔄 
🔄 Step 6: Pushing order to API...
[08:09:15] [DOC: 9319521] ℹ️  Pushing order via API for patient ID: b21bad59-ac67-44df-a4c9-722195632f90
[08:09:16] [DOC: 9319521] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19937"}
[08:09:16] ❌    ❌ Failed to push order
[08:09:16] 🔄 
🔄 Step 7: Writing to CSV...
[08:09:16] [DOC: 9319521] ℹ️  Calculated age: 84 from DOB: 07/19/1940
[08:09:16] [DOC: 9319521] ℹ️  Service Line extracted: 'HHA, Home Health Aide, SN, Skilled Nursing'
[08:09:16] [DOC: 9319521] ℹ️  Payer Source extracted: ''
[08:09:16] [DOC: 9319521] ℹ️  Diagnosis codes being written:
[08:09:16] [DOC: 9319521] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:09:16] [DOC: 9319521] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:09:16] [DOC: 9319521] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:09:16] [DOC: 9319521] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:09:16] [DOC: 9319521] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:09:16] [DOC: 9319521] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:09:16] [DOC: 9319521] ✅ Patient data written to CSV: Carol Baden | Sex: FEMALE | Age: 84 | Service: HHA, Home Health Aide, SN, Skilled Nursing | Payer:  | MRN: 2208958
[08:09:16] ✅    ✅ Document 9319521 processed and saved successfully
[08:09:16] 🔄 
🔄 Step 8: Saving API details...
[08:09:16] [DOC: 9319521] ℹ️  API push details saved for document 9319521
[08:09:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319519                         ║
================================================================================
[08:09:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[08:09:16] ℹ️  Date: 05/30/2025
[08:09:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:09:18] [DOC: 9319519] ✅ Text extracted using pdfplumber (8427 chars)
[08:09:18] ✅    ✅ Text extracted using pdfplumber (8427 chars)
[08:09:18] 🔄 
🔄 Step 2: Extracting patient data...
[08:09:21] ℹ️  AI extracted raw sex value: 'F'
[08:09:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[08:09:21] ℹ️  AI extracted payer source: ''
[08:09:21] ℹ️  AI extracted diagnoses:
[08:09:21] ℹ️    - Diagnosis 1: 'I69.90'
[08:09:21] ℹ️    - Diagnosis 2: 'E44.0'
[08:09:21] ℹ️    - Diagnosis 3: 'R13.10'
[08:09:21] ℹ️    - Diagnosis 4: 'F01.50'
[08:09:21] ℹ️    - Diagnosis 5: 'I25.10'
[08:09:21] ℹ️    - Diagnosis 6: 'I50.9'
[08:09:21] ℹ️  Final extracted MRN: '2208958'
[08:09:21] ℹ️  Final extracted Sex: 'FEMALE'
[08:09:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[08:09:21] ℹ️  Final extracted Payer Source: ''
[08:09:21] ✅ Patient data extraction completed successfully
[08:09:21] ✅    ✅ Patient data extracted successfully
[08:09:21] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'F01.50', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I50.9'}]
[08:09:21] ✅    ✅ Patient identified: Carol Baden
[08:09:21] ✅    ✅ Patient name validation passed
[08:09:21] 🔄 
🔄 Step 3: Processing patient dates...
[08:09:21] [DOC: 9319519] ℹ️  DOB normalized: 07/19/1940
[08:09:21] [DOC: 9319519] ℹ️  Episode startOfCare normalized: 05/28/2025
[08:09:21] [DOC: 9319519] ℹ️  Episode startOfEpisode normalized: 05/28/2025
[08:09:21] [DOC: 9319519] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[08:09:21] [DOC: 9319519] ✅ Patient date processing completed successfully
[08:09:21] ✅    ✅ Date processing completed
[08:09:21] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/28/2025', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'F01.50', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I50.9'}]
[08:09:21] 🔄 
🔄 Step 4: Extracting order data...
[08:09:24] ℹ️  Order extraction - MRN: '2208958'
[08:09:24] ℹ️  Order extraction - Sex: 'FEMALE'
[08:09:24] ℹ️  Order extraction - Service Line: 'Hospice'
[08:09:24] ℹ️  Order extraction - Payer Source: ''
[08:09:24] ✅ Order data extraction completed successfully
[08:09:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:09:24] ℹ️  Using MRN from patient data: '2208958' over '2208958'
[08:09:24] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Hospice' = 'Hospice, Skilled Nursing'
[08:09:24] ✅ Patient name cross-validation successful
[08:09:24] ✅    ✅ Data merged successfully
[08:09:25] ✅    ✅ Order data extracted and validated
[08:09:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:09:25] [DOC: 9319519] ✅ Patient found in local cache: Carol Baden, ID: b21bad59-ac67-44df-a4c9-722195632f90
[08:09:25] ✅    ✅ Existing patient found with ID: b21bad59-ac67-44df-a4c9-722195632f90
[08:09:25] 🔄 
🔄 Step 6: Pushing order to API...
[08:09:25] [DOC: 9319519] ℹ️  Pushing order via API for patient ID: b21bad59-ac67-44df-a4c9-722195632f90
[08:09:27] [DOC: 9319519] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18905"}
[08:09:27] ❌    ❌ Failed to push order
[08:09:27] 🔄 
🔄 Step 7: Writing to CSV...
[08:09:27] [DOC: 9319519] ℹ️  Calculated age: 84 from DOB: 07/19/1940
[08:09:27] [DOC: 9319519] ℹ️  Service Line extracted: 'Hospice, Skilled Nursing'
[08:09:27] [DOC: 9319519] ℹ️  Payer Source extracted: ''
[08:09:27] [DOC: 9319519] ℹ️  Diagnosis codes being written:
[08:09:27] [DOC: 9319519] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.90'
[08:09:27] [DOC: 9319519] ℹ️    - Latest_Episode_Seconddiagnosis: 'E44.0'
[08:09:27] [DOC: 9319519] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.10'
[08:09:27] [DOC: 9319519] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F01.50'
[08:09:27] [DOC: 9319519] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[08:09:27] [DOC: 9319519] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.9'
[08:09:27] [DOC: 9319519] ✅ Patient data written to CSV: Carol Baden | Sex: FEMALE | Age: 84 | Service: Hospice, Skilled Nursing | Payer:  | MRN: 2208958
[08:09:27] ✅    ✅ Document 9319519 processed and saved successfully
[08:09:27] 🔄 
🔄 Step 8: Saving API details...
[08:09:27] [DOC: 9319519] ℹ️  API push details saved for document 9319519
[08:09:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319504                         ║
================================================================================
[08:09:27] ℹ️  Agency: Dartmouth HH
[08:09:27] ℹ️  Date: 05/30/2025
[08:09:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:09:29] [DOC: 9319504] ✅ Text extracted using pdfplumber (12146 chars)
[08:09:29] ✅    ✅ Text extracted using pdfplumber (12134 chars)
[08:09:29] 🔄 
🔄 Step 2: Extracting patient data...
[08:09:32] ℹ️  AI extracted raw sex value: 'F'
[08:09:32] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[08:09:32] ℹ️  AI extracted payer source: ''
[08:09:32] ℹ️  AI extracted diagnoses:
[08:09:32] ℹ️    - Diagnosis 1: 'I10'
[08:09:32] ℹ️    - Diagnosis 2: 'G30.9'
[08:09:32] ℹ️    - Diagnosis 3: 'F02.83'
[08:09:32] ℹ️    - Diagnosis 4: 'F02.84'
[08:09:32] ℹ️    - Diagnosis 5: 'F41.1'
[08:09:32] ℹ️    - Diagnosis 6: 'R26.89'
[08:09:32] ℹ️  Final extracted MRN: '227027'
[08:09:32] ℹ️  Final extracted Sex: 'FEMALE'
[08:09:32] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[08:09:32] ℹ️  Final extracted Payer Source: ''
[08:09:32] ✅ Patient data extraction completed successfully
[08:09:32] ✅    ✅ Patient data extracted successfully
[08:09:32] 📊 Patient Response
     └─ patientFName: Helen E
     └─ patientLName: Wade
     └─ dob: 06/10/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G30.9', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': 'F02.84', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'R26.89'}]
[08:09:32] ✅    ✅ Patient identified: Helen E Wade
[08:09:32] ✅    ✅ Patient name validation passed
[08:09:32] 🔄 
🔄 Step 3: Processing patient dates...
[08:09:32] [DOC: 9319504] ℹ️  DOB normalized: 06/10/1946
[08:09:32] [DOC: 9319504] ℹ️  Episode startOfCare normalized: 05/07/2025
[08:09:32] [DOC: 9319504] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[08:09:32] [DOC: 9319504] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[08:09:32] [DOC: 9319504] ✅ Patient date processing completed successfully
[08:09:32] ✅    ✅ Date processing completed
[08:09:32] 📊 Processed Patient Data
     └─ patientFName: Helen E
     └─ patientLName: Wade
     └─ dob: 06/10/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'G30.9', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': 'F02.84', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'R26.89'}]
[08:09:32] 🔄 
🔄 Step 4: Extracting order data...
[08:09:35] ℹ️  Order extraction - MRN: '6339015'
[08:09:35] ℹ️  Order extraction - Sex: 'FEMALE'
[08:09:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[08:09:35] ℹ️  Order extraction - Payer Source: ''
[08:09:35] ✅ Order data extraction completed successfully
[08:09:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:09:35] ℹ️  Using longer MRN from order data: '6339015' over '227027'
[08:09:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[08:09:35] ✅ Patient name cross-validation successful
[08:09:35] ✅    ✅ Data merged successfully
[08:09:36] ✅    ✅ Order data extracted and validated
[08:09:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:09:45] [DOC: 9319504] ℹ️  Patient not found in cache or API: Helen E Wade
[08:09:45] [DOC: 9319504] ℹ️  Patient not found, creating new patient via API...
[08:09:45] [DOC: 9319504] ℹ️  Creating patient via API: Helen E Wade
[08:09:46] [DOC: 9319504] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:09:46] ❌    ❌ Failed to create patient
[08:09:46] [DOC: 9319504] ℹ️  API push details saved for document 9319504
================================================================================
║                        Processing Document ID: 9319493                         ║
================================================================================
[08:09:46] ℹ️  Agency: Dartmouth HH
[08:09:46] ℹ️  Date: 05/30/2025
[08:09:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:09:48] [DOC: 9319493] ✅ Text extracted using pdfplumber (1492 chars)
[08:09:48] ✅    ✅ Text extracted using pdfplumber (1492 chars)
[08:09:48] 🔄 
🔄 Step 2: Extracting patient data...
[08:09:51] ℹ️  AI extracted raw sex value: 'F'
[08:09:51] ℹ️  AI extracted service line: 'RN, LPN'
[08:09:51] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[08:09:51] ℹ️  AI extracted diagnoses:
[08:09:51] ℹ️    - Diagnosis 1: ''
[08:09:51] ℹ️    - Diagnosis 2: ''
[08:09:51] ℹ️    - Diagnosis 3: ''
[08:09:51] ℹ️    - Diagnosis 4: ''
[08:09:51] ℹ️    - Diagnosis 5: ''
[08:09:51] ℹ️    - Diagnosis 6: ''
[08:09:51] ℹ️  Final extracted MRN: '6545015'
[08:09:51] ℹ️  Final extracted Sex: 'FEMALE'
[08:09:51] ℹ️  Final extracted Service Line: 'RN, LPN'
[08:09:51] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[08:09:51] ✅ Patient data extraction completed successfully
[08:09:51] ✅    ✅ Patient data extracted successfully
[08:09:51] 📊 Patient Response
     └─ patientFName: Sharon
     └─ patientLName: Costa
     └─ dob: 06/14/1965
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6545015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:09:51] ✅    ✅ Patient identified: Sharon Costa
[08:09:51] ✅    ✅ Patient name validation passed
[08:09:51] 🔄 
🔄 Step 3: Processing patient dates...
[08:09:51] [DOC: 9319493] ℹ️  DOB normalized: 06/14/1965
[08:09:51] [DOC: 9319493] ℹ️  Episode startOfCare normalized: 05/20/2025
[08:09:51] [DOC: 9319493] ℹ️  Episode startOfEpisode normalized: 05/20/2025
[08:09:51] [DOC: 9319493] ℹ️  Episode endOfEpisode normalized: 07/18/2025
[08:09:51] [DOC: 9319493] ✅ Patient date processing completed successfully
[08:09:51] ✅    ✅ Date processing completed
[08:09:51] 📊 Processed Patient Data
     └─ patientFName: Sharon
     └─ patientLName: Costa
     └─ dob: 06/14/1965
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6545015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:09:51] 🔄 
🔄 Step 4: Extracting order data...
[08:09:53] ℹ️  Order extraction - MRN: ''
[08:09:53] ℹ️  Order extraction - Sex: 'FEMALE'
[08:09:53] ℹ️  Order extraction - Service Line: 'RN, LPN'
[08:09:53] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[08:09:53] ✅ Order data extraction completed successfully
[08:09:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:09:53] ℹ️  Using MRN from patient data: '6545015'
[08:09:53] ℹ️  Service line consistent in both sources: 'RN, LPN'
[08:09:53] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[08:09:53] ✅ Patient name cross-validation successful
[08:09:53] ✅    ✅ Data merged successfully
[08:09:55] ✅    ✅ Order data extracted and validated
[08:09:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:09:55] [DOC: 9319493] ✅ Patient found in local cache: Sharon Costa, ID: 0b73e07b-10a3-49cd-88d2-08f192402ec4
[08:09:55] ✅    ✅ Existing patient found with ID: 0b73e07b-10a3-49cd-88d2-08f192402ec4
[08:09:55] 🔄 
🔄 Step 6: Pushing order to API...
[08:09:55] [DOC: 9319493] ℹ️  Pushing order via API for patient ID: 0b73e07b-10a3-49cd-88d2-08f192402ec4
[08:09:56] [DOC: 9319493] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:09:56] ❌    ❌ Failed to push order
[08:09:56] 🔄 
🔄 Step 7: Writing to CSV...
[08:09:56] [DOC: 9319493] ℹ️  Calculated age: 59 from DOB: 06/14/1965
[08:09:56] [DOC: 9319493] ℹ️  Service Line extracted: 'RN, LPN'
[08:09:56] [DOC: 9319493] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[08:09:56] [DOC: 9319493] ℹ️  Diagnosis codes being written:
[08:09:56] [DOC: 9319493] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:09:56] [DOC: 9319493] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:09:56] [DOC: 9319493] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:09:56] [DOC: 9319493] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:09:56] [DOC: 9319493] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:09:56] [DOC: 9319493] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:09:56] [DOC: 9319493] ✅ Patient data written to CSV: Sharon Costa | Sex: FEMALE | Age: 59 | Service: RN, LPN | Payer: Aetna- Mcare | MRN: 6545015
[08:09:56] ✅    ✅ Document 9319493 processed and saved successfully
[08:09:56] 🔄 
🔄 Step 8: Saving API details...
[08:09:56] [DOC: 9319493] ℹ️  API push details saved for document 9319493
[08:09:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319481                         ║
================================================================================
[08:09:56] ℹ️  Agency: Dartmouth HH
[08:09:56] ℹ️  Date: 05/30/2025
[08:09:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:09:57] [DOC: 9319481] ✅ Text extracted using pdfplumber (1708 chars)
[08:09:57] ✅    ✅ Text extracted using pdfplumber (1708 chars)
[08:09:57] 🔄 
🔄 Step 2: Extracting patient data...
[08:10:00] ℹ️  AI extracted raw sex value: 'F'
[08:10:00] ℹ️  AI extracted service line: 'RN, LPN'
[08:10:00] ℹ️  AI extracted payer source: 'Medicare'
[08:10:00] ℹ️  AI extracted diagnoses:
[08:10:00] ℹ️    - Diagnosis 1: ''
[08:10:00] ℹ️    - Diagnosis 2: ''
[08:10:00] ℹ️    - Diagnosis 3: ''
[08:10:00] ℹ️    - Diagnosis 4: ''
[08:10:00] ℹ️    - Diagnosis 5: ''
[08:10:00] ℹ️    - Diagnosis 6: ''
[08:10:00] ℹ️  Final extracted MRN: '6523015'
[08:10:00] ℹ️  Final extracted Sex: 'FEMALE'
[08:10:00] ℹ️  Final extracted Service Line: 'RN, LPN'
[08:10:00] ℹ️  Final extracted Payer Source: 'Medicare'
[08:10:00] ✅ Patient data extraction completed successfully
[08:10:00] ✅    ✅ Patient data extracted successfully
[08:10:00] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:10:00] ✅    ✅ Patient identified: Dolores Hanson
[08:10:00] ✅    ✅ Patient name validation passed
[08:10:00] 🔄 
🔄 Step 3: Processing patient dates...
[08:10:00] [DOC: 9319481] ℹ️  DOB normalized: 11/26/1931
[08:10:00] [DOC: 9319481] ℹ️  Episode startOfCare normalized: 05/21/2025
[08:10:00] [DOC: 9319481] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[08:10:00] [DOC: 9319481] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[08:10:00] [DOC: 9319481] ✅ Patient date processing completed successfully
[08:10:00] ✅    ✅ Date processing completed
[08:10:00] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:10:00] 🔄 
🔄 Step 4: Extracting order data...
[08:10:03] ℹ️  Order extraction - MRN: '6523015'
[08:10:03] ℹ️  Order extraction - Sex: 'FEMALE'
[08:10:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[08:10:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[08:10:03] ✅ Order data extraction completed successfully
[08:10:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:10:03] ℹ️  Using MRN from patient data: '6523015' over '6523015'
[08:10:03] ℹ️  Combined service lines: Patient='RN, LPN' + Order='Skilled Nursing' = 'LPN, RN, Skilled Nursing'
[08:10:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[08:10:03] ✅ Patient name cross-validation successful
[08:10:03] ✅    ✅ Data merged successfully
[08:10:04] ✅    ✅ Order data extracted and validated
[08:10:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:10:04] [DOC: 9319481] ✅ Patient found in local cache: Dolores Hanson, ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[08:10:04] ✅    ✅ Existing patient found with ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[08:10:04] 🔄 
🔄 Step 6: Pushing order to API...
[08:10:04] [DOC: 9319481] ℹ️  Pushing order via API for patient ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[08:10:05] [DOC: 9319481] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[08:10:05] ❌    ❌ Failed to push order
[08:10:05] 🔄 
🔄 Step 7: Writing to CSV...
[08:10:05] [DOC: 9319481] ℹ️  Calculated age: 93 from DOB: 11/26/1931
[08:10:05] [DOC: 9319481] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing'
[08:10:05] [DOC: 9319481] ℹ️  Payer Source extracted: 'Medicare'
[08:10:05] [DOC: 9319481] ℹ️  Diagnosis codes being written:
[08:10:05] [DOC: 9319481] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[08:10:05] [DOC: 9319481] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[08:10:05] [DOC: 9319481] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[08:10:05] [DOC: 9319481] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[08:10:05] [DOC: 9319481] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[08:10:05] [DOC: 9319481] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[08:10:05] [DOC: 9319481] ✅ Patient data written to CSV: Dolores Hanson | Sex: FEMALE | Age: 93 | Service: LPN, RN, Skilled Nursing | Payer: Medicare | MRN: 6523015
[08:10:05] ✅    ✅ Document 9319481 processed and saved successfully
[08:10:05] 🔄 
🔄 Step 8: Saving API details...
[08:10:05] [DOC: 9319481] ℹ️  API push details saved for document 9319481
[08:10:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319471                         ║
================================================================================
[08:10:05] ℹ️  Agency: Dartmouth HH
[08:10:05] ℹ️  Date: 05/30/2025
[08:10:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[08:10:07] [DOC: 9319471] ✅ Text extracted using pdfplumber (1325 chars)
[08:10:07] ✅    ✅ Text extracted using pdfplumber (1325 chars)
[08:10:07] 🔄 
🔄 Step 2: Extracting patient data...
[08:10:10] ℹ️  AI extracted raw sex value: 'F'
[08:10:10] ℹ️  AI extracted service line: 'RN, LPN'
[08:10:10] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[08:10:10] ℹ️  AI extracted diagnoses:
[08:10:10] ℹ️    - Diagnosis 1: ''
[08:10:10] ℹ️    - Diagnosis 2: ''
[08:10:10] ℹ️    - Diagnosis 3: ''
[08:10:10] ℹ️    - Diagnosis 4: ''
[08:10:10] ℹ️    - Diagnosis 5: ''
[08:10:10] ℹ️    - Diagnosis 6: ''
[08:10:10] ℹ️  Final extracted MRN: '6427015'
[08:10:10] ℹ️  Final extracted Sex: 'FEMALE'
[08:10:10] ℹ️  Final extracted Service Line: 'RN, LPN'
[08:10:10] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[08:10:10] ✅ Patient data extraction completed successfully
[08:10:10] ✅    ✅ Patient data extracted successfully
[08:10:10] 📊 Patient Response
     └─ patientFName: Diana
     └─ patientLName: Harlfinger
     └─ dob: 09/30/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6427015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:10:10] ✅    ✅ Patient identified: Diana Harlfinger
[08:10:10] ✅    ✅ Patient name validation passed
[08:10:10] 🔄 
🔄 Step 3: Processing patient dates...
[08:10:10] [DOC: 9319471] ℹ️  DOB normalized: 09/30/1953
[08:10:10] [DOC: 9319471] ℹ️  Episode startOfCare normalized: 04/25/2025
[08:10:10] [DOC: 9319471] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[08:10:10] [DOC: 9319471] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[08:10:10] [DOC: 9319471] ✅ Patient date processing completed successfully
[08:10:10] ✅    ✅ Date processing completed
[08:10:10] 📊 Processed Patient Data
     └─ patientFName: Diana
     └─ patientLName: Harlfinger
     └─ dob: 09/30/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6427015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[08:10:10] 🔄 
🔄 Step 4: Extracting order data...
[08:10:13] ℹ️  Order extraction - MRN: ''
[08:10:13] ℹ️  Order extraction - Sex: 'FEMALE'
[08:10:13] ℹ️  Order extraction - Service Line: 'RN, LPN'
[08:10:13] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[08:10:13] ✅ Order data extraction completed successfully
[08:10:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[08:10:13] ℹ️  Using MRN from patient data: '6427015'
[08:10:13] ℹ️  Service line consistent in both sources: 'RN, LPN'
[08:10:13] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[08:10:13] ✅ Patient name cross-validation successful
[08:10:13] ✅    ✅ Data merged successfully
[08:10:15] ✅    ✅ Order data extracted and validated
[08:10:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[08:10:24] [DOC: 9319471] ℹ️  Patient not found in cache or API: Diana Harlfinger
[08:10:24] [DOC: 9319471] ℹ️  Patient not found, creating new patient via API...
[08:10:24] [DOC: 9319471] ℹ️  Creating patient via API: Diana Harlfinger
[08:10:25] [DOC: 9319471] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[08:10:25] ❌    ❌ Failed to create patient
[08:10:25] [DOC: 9319471] ℹ️  API push details saved for document 9319471
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[08:10:25] ℹ️  Total Processed: 49
[08:10:25] ℹ️  CSV Success: 33
[08:10:25] ℹ️  CSV Errors: 7
[08:10:25] ℹ️  API Success: 0
[08:10:25] ℹ️  API Errors: 42
[08:10:25] ℹ️  CSV Success Rate: 67.3%
[08:10:25] ℹ️  API Success Rate: 0.0%
[08:10:25] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_075956.csv
[08:10:25] ℹ️  API Details File: api_outputs/api_push_details_20250607_075956.csv
================================================================================
║          ============================================================          ║
================================================================================
