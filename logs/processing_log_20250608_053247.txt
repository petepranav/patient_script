================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[05:32:47] ℹ️  CSV Data Extraction & API Push Tool
[05:32:47] ℹ️  
[05:32:47] ℹ️  Features:
[05:32:47] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[05:32:47] ℹ️  - AI-powered patient and order data extraction
[05:32:47] ℹ️  - Enhanced error handling and logging
[05:32:47] ℹ️  - Full API integration (patient creation + order pushing)
[05:32:47] ℹ️  - CSV output with comprehensive patient data
[05:32:47] ℹ️  - Detailed API tracking with remarks for every document
[05:32:47] ℹ️  - Complete audit trail of all processing attempts
[05:32:47] ℹ️  
[05:32:47] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[05:32:47] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_053247.csv
[05:32:47] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_053247.csv
================================================================================
║                        Processing Document ID: 9245839                         ║
================================================================================
[05:32:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:32:47] ℹ️  Date: 04/17/2025
[05:32:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:32:50] [DOC: 9245839] ✅ Text extracted using pdfplumber (23057 chars)
[05:32:50] ✅    ✅ Text extracted using pdfplumber (23057 chars)
[05:32:50] 🔄 
🔄 Step 2: Extracting patient data...
[05:32:54] ℹ️  AI extracted raw sex value: 'F'
[05:32:54] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer'
[05:32:54] ℹ️  AI extracted payer source: ''
[05:32:54] ℹ️  AI extracted diagnoses:
[05:32:54] ℹ️    - Diagnosis 1: 'G31.83'
[05:32:54] ℹ️    - Diagnosis 2: 'F41.8'
[05:32:54] ℹ️    - Diagnosis 3: 'R29.6'
[05:32:54] ℹ️    - Diagnosis 4: 'M51.369'
[05:32:54] ℹ️    - Diagnosis 5: 'M19.90'
[05:32:54] ℹ️    - Diagnosis 6: 'H40.9'
[05:32:54] ℹ️  Final extracted MRN: '2622983'
[05:32:54] ℹ️  Final extracted Sex: 'FEMALE'
[05:32:54] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer'
[05:32:54] ℹ️  Final extracted Payer Source: ''
[05:32:54] ✅ Patient data extraction completed successfully
[05:32:54] ✅    ✅ Patient data extracted successfully
[05:32:54] 📊 Patient Response
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'G31.83', 'secondDiagnosis': 'F41.8', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'M51.369', 'fifthDiagnosis': 'M19.90', 'sixthDiagnosis': 'H40.9'}]
[05:32:54] ✅    ✅ Patient identified: Mary Lou Kobak
[05:32:54] ✅    ✅ Patient name validation passed
[05:32:54] 🔄 
🔄 Step 3: Processing patient dates...
[05:32:54] [DOC: 9245839] ℹ️  DOB normalized: 02/18/1940
[05:32:54] [DOC: 9245839] ℹ️  Episode startOfCare normalized: 04/12/2025
[05:32:54] [DOC: 9245839] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[05:32:54] [DOC: 9245839] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[05:32:54] [DOC: 9245839] ✅ Patient date processing completed successfully
[05:32:54] ✅    ✅ Date processing completed
[05:32:54] 📊 Processed Patient Data
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'G31.83', 'secondDiagnosis': 'F41.8', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'M51.369', 'fifthDiagnosis': 'M19.90', 'sixthDiagnosis': 'H40.9'}]
[05:32:54] 🔄 
🔄 Step 4: Extracting order data...
[05:32:57] ℹ️  Order extraction - MRN: '2622983'
[05:32:57] ℹ️  Order extraction - Sex: 'FEMALE'
[05:32:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:32:57] ℹ️  Order extraction - Payer Source: ''
[05:32:57] ✅ Order data extraction completed successfully
[05:32:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:32:57] ℹ️  Using MRN from patient data: '2622983' over '2622983'
[05:32:57] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, Home Health Aide, Volunteer' + Order='Skilled Nursing, MSW, Clergy, HHA' = 'Clergy, HHA, Home Health Aide, MSW, Skilled Nursing, Volunteer'
[05:32:57] ✅ Patient name cross-validation successful
[05:32:57] ✅    ✅ Data merged successfully
[05:32:58] ✅    ✅ Order data extracted and validated
[05:32:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:33:11] [DOC: 9245839] ✅ Patient exists in API: Mary Lou Kobak, ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[05:33:11] ✅    ✅ Existing patient found with ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[05:33:11] 🔄 
🔄 Step 6: Pushing order to API...
[05:33:11] [DOC: 9245839] ℹ️  Pushing order via API for patient ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[05:33:13] [DOC: 9245839] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13105"}
[05:33:13] ❌    ❌ Failed to push order
[05:33:13] 🔄 
🔄 Step 7: Writing to CSV...
[05:33:13] [DOC: 9245839] ℹ️  Calculated age: 85 from DOB: 02/18/1940
[05:33:13] [DOC: 9245839] ℹ️  Service Line extracted: 'Clergy, HHA, Home Health Aide, MSW, Skilled Nursing, Volunteer'
[05:33:13] [DOC: 9245839] ℹ️  Payer Source extracted: ''
[05:33:13] [DOC: 9245839] ℹ️  Diagnosis codes being written:
[05:33:13] [DOC: 9245839] ℹ️    - Latest_Episode_Firstdiagnosis: 'G31.83'
[05:33:13] [DOC: 9245839] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.8'
[05:33:13] [DOC: 9245839] ℹ️    - Latest_Episode_Thirddiagnosis: 'R29.6'
[05:33:13] [DOC: 9245839] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M51.369'
[05:33:13] [DOC: 9245839] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M19.90'
[05:33:13] [DOC: 9245839] ℹ️    - Latest_Episode_Sixthdiagnosis: 'H40.9'
[05:33:13] [DOC: 9245839] ✅ Patient data written to CSV: Mary Lou Kobak | Sex: FEMALE | Age: 85 | Service: Clergy, HHA, Home Health Aide, MSW, Skilled Nursing, Volunteer | Payer:  | MRN: 2622983
[05:33:13] ✅    ✅ Document 9245839 processed and saved successfully
[05:33:13] 🔄 
🔄 Step 8: Saving API details...
[05:33:13] [DOC: 9245839] ℹ️  API push details saved for document 9245839
[05:33:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245829                         ║
================================================================================
[05:33:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:33:13] ℹ️  Date: 04/17/2025
[05:33:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:33:16] [DOC: 9245829] ✅ Text extracted using pdfplumber (16385 chars)
[05:33:16] ✅    ✅ Text extracted using pdfplumber (16385 chars)
[05:33:16] 🔄 
🔄 Step 2: Extracting patient data...
[05:33:19] ℹ️  AI extracted raw sex value: 'M'
[05:33:19] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[05:33:19] ℹ️  AI extracted payer source: ''
[05:33:19] ℹ️  AI extracted diagnoses:
[05:33:19] ℹ️    - Diagnosis 1: 'K92.2'
[05:33:19] ℹ️    - Diagnosis 2: 'D50.0'
[05:33:19] ℹ️    - Diagnosis 3: 'F10.20'
[05:33:19] ℹ️    - Diagnosis 4: 'K70.30'
[05:33:19] ℹ️    - Diagnosis 5: 'K70.10'
[05:33:19] ℹ️    - Diagnosis 6: 'E83.42'
[05:33:19] ℹ️  Final extracted MRN: '2553385'
[05:33:19] ℹ️  Final extracted Sex: 'MALE'
[05:33:19] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[05:33:19] ℹ️  Final extracted Payer Source: ''
[05:33:19] ✅ Patient data extraction completed successfully
[05:33:19] ✅    ✅ Patient data extracted successfully
[05:33:19] 📊 Patient Response
     └─ patientFName: Curtis
     └─ patientLName: Hardy IV
     └─ dob: 06/17/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 2553385
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'K92.2', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'F10.20', 'fourthDiagnosis': 'K70.30', 'fifthDiagnosis': 'K70.10', 'sixthDiagnosis': 'E83.42'}]
[05:33:19] ✅    ✅ Patient identified: Curtis Hardy IV
[05:33:19] ✅    ✅ Patient name validation passed
[05:33:19] 🔄 
🔄 Step 3: Processing patient dates...
[05:33:19] [DOC: 9245829] ℹ️  DOB normalized: 06/17/1964
[05:33:19] [DOC: 9245829] ℹ️  Episode startOfCare normalized: 04/05/2025
[05:33:19] [DOC: 9245829] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[05:33:19] [DOC: 9245829] ℹ️  Episode endOfEpisode normalized: 06/04/2025
[05:33:19] [DOC: 9245829] ✅ Patient date processing completed successfully
[05:33:19] ✅    ✅ Date processing completed
[05:33:19] 📊 Processed Patient Data
     └─ patientFName: Curtis
     └─ patientLName: Hardy IV
     └─ dob: 06/17/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 2553385
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '06/04/2025', 'firstDiagnosis': 'K92.2', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'F10.20', 'fourthDiagnosis': 'K70.30', 'fifthDiagnosis': 'K70.10', 'sixthDiagnosis': 'E83.42'}]
[05:33:19] 🔄 
🔄 Step 4: Extracting order data...
[05:33:22] ℹ️  Order extraction - MRN: '2553385'
[05:33:22] ℹ️  Order extraction - Sex: 'MALE'
[05:33:22] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[05:33:22] ℹ️  Order extraction - Payer Source: ''
[05:33:22] ✅ Order data extraction completed successfully
[05:33:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:33:22] ℹ️  Using MRN from patient data: '2553385' over '2553385'
[05:33:22] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled Nursing'
[05:33:22] ✅ Patient name cross-validation successful
[05:33:22] ✅    ✅ Data merged successfully
[05:33:24] ✅    ✅ Order data extracted and validated
[05:33:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:33:24] [DOC: 9245829] ✅ Patient found in local cache: Curtis Hardy IV, ID: bbd3ae67-b0d5-4ae7-929a-029f2d79d816
[05:33:24] ✅    ✅ Existing patient found with ID: bbd3ae67-b0d5-4ae7-929a-029f2d79d816
[05:33:24] 🔄 
🔄 Step 6: Pushing order to API...
[05:33:24] [DOC: 9245829] ℹ️  Pushing order via API for patient ID: bbd3ae67-b0d5-4ae7-929a-029f2d79d816
[05:33:25] [DOC: 9245829] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13067"}
[05:33:25] ❌    ❌ Failed to push order
[05:33:25] 🔄 
🔄 Step 7: Writing to CSV...
[05:33:25] [DOC: 9245829] ℹ️  Calculated age: 60 from DOB: 06/17/1964
[05:33:25] [DOC: 9245829] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[05:33:25] [DOC: 9245829] ℹ️  Payer Source extracted: ''
[05:33:25] [DOC: 9245829] ℹ️  Diagnosis codes being written:
[05:33:25] [DOC: 9245829] ℹ️    - Latest_Episode_Firstdiagnosis: 'K92.2'
[05:33:25] [DOC: 9245829] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[05:33:25] [DOC: 9245829] ℹ️    - Latest_Episode_Thirddiagnosis: 'F10.20'
[05:33:25] [DOC: 9245829] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K70.30'
[05:33:25] [DOC: 9245829] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K70.10'
[05:33:25] [DOC: 9245829] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E83.42'
[05:33:25] [DOC: 9245829] ✅ Patient data written to CSV: Curtis Hardy IV | Sex: MALE | Age: 60 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 2553385
[05:33:25] ✅    ✅ Document 9245829 processed and saved successfully
[05:33:25] 🔄 
🔄 Step 8: Saving API details...
[05:33:25] [DOC: 9245829] ℹ️  API push details saved for document 9245829
[05:33:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245819                         ║
================================================================================
[05:33:25] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:33:25] ℹ️  Date: 04/17/2025
[05:33:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:33:27] [DOC: 9245819] ✅ Text extracted using pdfplumber (2083 chars)
[05:33:27] ✅    ✅ Text extracted using pdfplumber (2083 chars)
[05:33:27] 🔄 
🔄 Step 2: Extracting patient data...
[05:33:29] ℹ️  AI extracted raw sex value: 'F'
[05:33:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:33:29] ℹ️  AI extracted payer source: ''
[05:33:29] ℹ️  AI extracted diagnoses:
[05:33:29] ℹ️    - Diagnosis 1: 'None'
[05:33:29] ℹ️    - Diagnosis 2: 'None'
[05:33:29] ℹ️    - Diagnosis 3: 'None'
[05:33:29] ℹ️    - Diagnosis 4: 'None'
[05:33:29] ℹ️    - Diagnosis 5: 'None'
[05:33:29] ℹ️    - Diagnosis 6: 'None'
[05:33:29] ℹ️  Final extracted MRN: '2158031'
[05:33:29] ℹ️  Final extracted Sex: 'FEMALE'
[05:33:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:33:29] ℹ️  Final extracted Payer Source: ''
[05:33:29] ✅ Patient data extraction completed successfully
[05:33:29] ✅    ✅ Patient data extracted successfully
[05:33:29] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/16/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:33:29] ✅    ✅ Patient identified: Norma Dyer
[05:33:29] ✅    ✅ Patient name validation passed
[05:33:29] 🔄 
🔄 Step 3: Processing patient dates...
[05:33:29] [DOC: 9245819] ℹ️  DOB normalized: 11/13/1931
[05:33:29] [DOC: 9245819] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[05:33:29] [DOC: 9245819] ✅ Patient date processing completed successfully
[05:33:29] ✅    ✅ Date processing completed
[05:33:29] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/16/2025'}]
[05:33:29] 🔄 
🔄 Step 4: Extracting order data...
[05:33:31] ℹ️  Order extraction - MRN: '2158031'
[05:33:31] ℹ️  Order extraction - Sex: 'FEMALE'
[05:33:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:33:31] ℹ️  Order extraction - Payer Source: ''
[05:33:31] ✅ Order data extraction completed successfully
[05:33:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:33:31] ℹ️  Using MRN from patient data: '2158031' over '2158031'
[05:33:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:33:31] ✅ Patient name cross-validation successful
[05:33:31] ✅    ✅ Data merged successfully
[05:33:33] ✅    ✅ Order data extracted and validated
[05:33:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:33:33] [DOC: 9245819] ✅ Patient found in local cache: Norma Dyer, ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[05:33:33] ✅    ✅ Existing patient found with ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[05:33:33] 🔄 
🔄 Step 6: Pushing order to API...
[05:33:33] [DOC: 9245819] ℹ️  Pushing order via API for patient ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[05:33:35] [DOC: 9245819] ❌ Order push failed with status 201: {"id":"7b84a131-7f5d-4a20-8436-cb5886cb2717","orderWAVId":"ORD20022","orderNo":"1082561","orderDate":"04/16/2025","startOfCare":"04/16/2025","episodeStartDate":"04/16/2025","episodeEndDate":"06/14/2025","documentID":"9245819","mrn":"2158031","patientName":"Dyer,Norma L","sentToPhysicianDate":"04/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"5ca2359c-d429-4962-bcd9-bc06407ed3cc","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:33:35] ❌    ❌ Failed to push order
[05:33:35] 🔄 
🔄 Step 7: Writing to CSV...
[05:33:35] [DOC: 9245819] ℹ️  Calculated age: 93 from DOB: 11/13/1931
[05:33:35] [DOC: 9245819] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:33:35] [DOC: 9245819] ℹ️  Payer Source extracted: ''
[05:33:35] [DOC: 9245819] ℹ️  Diagnosis codes being written:
[05:33:35] [DOC: 9245819] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:33:35] [DOC: 9245819] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:33:35] [DOC: 9245819] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:33:35] [DOC: 9245819] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:33:35] [DOC: 9245819] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:33:35] [DOC: 9245819] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:33:35] [DOC: 9245819] ✅ Patient data written to CSV: Norma Dyer | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 2158031
[05:33:35] ✅    ✅ Document 9245819 processed and saved successfully
[05:33:35] 🔄 
🔄 Step 8: Saving API details...
[05:33:35] [DOC: 9245819] ℹ️  API push details saved for document 9245819
[05:33:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245814                         ║
================================================================================
[05:33:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:33:35] ℹ️  Date: 04/17/2025
[05:33:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:33:40] [DOC: 9245814] ✅ Text extracted using pdfplumber (27580 chars)
[05:33:40] ✅    ✅ Text extracted using pdfplumber (27570 chars)
[05:33:40] 🔄 
🔄 Step 2: Extracting patient data...
[05:33:43] ℹ️  AI extracted raw sex value: 'F'
[05:33:43] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:33:43] ℹ️  AI extracted payer source: ''
[05:33:43] ℹ️  AI extracted diagnoses:
[05:33:43] ℹ️    - Diagnosis 1: 'Z48.812'
[05:33:43] ℹ️    - Diagnosis 2: 'I05.0'
[05:33:43] ℹ️    - Diagnosis 3: 'I11.0'
[05:33:43] ℹ️    - Diagnosis 4: 'I50.20'
[05:33:43] ℹ️    - Diagnosis 5: 'I48.0'
[05:33:43] ℹ️    - Diagnosis 6: 'I27.20'
[05:33:43] ℹ️  Final extracted MRN: '2392166'
[05:33:43] ℹ️  Final extracted Sex: 'FEMALE'
[05:33:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:33:43] ℹ️  Final extracted Payer Source: ''
[05:33:43] ✅ Patient data extraction completed successfully
[05:33:43] ✅    ✅ Patient data extracted successfully
[05:33:43] 📊 Patient Response
     └─ patientFName: Angela
     └─ patientLName: Days
     └─ dob: 09/10/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2392166
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I05.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.20', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'I27.20'}]
[05:33:43] ✅    ✅ Patient identified: Angela Days
[05:33:43] ✅    ✅ Patient name validation passed
[05:33:43] 🔄 
🔄 Step 3: Processing patient dates...
[05:33:43] [DOC: 9245814] ℹ️  DOB normalized: 09/10/1950
[05:33:43] [DOC: 9245814] ℹ️  Episode startOfCare normalized: 04/04/2025
[05:33:43] [DOC: 9245814] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:33:43] [DOC: 9245814] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:33:43] [DOC: 9245814] ✅ Patient date processing completed successfully
[05:33:43] ✅    ✅ Date processing completed
[05:33:43] 📊 Processed Patient Data
     └─ patientFName: Angela
     └─ patientLName: Days
     └─ dob: 09/10/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2392166
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I05.0', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.20', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'I27.20'}]
[05:33:43] 🔄 
🔄 Step 4: Extracting order data...
[05:33:46] ℹ️  Order extraction - MRN: '2392166'
[05:33:46] ℹ️  Order extraction - Sex: 'FEMALE'
[05:33:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:33:46] ℹ️  Order extraction - Payer Source: ''
[05:33:46] ✅ Order data extraction completed successfully
[05:33:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:33:46] ℹ️  Using MRN from patient data: '2392166' over '2392166'
[05:33:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[05:33:46] ✅ Patient name cross-validation successful
[05:33:46] ✅    ✅ Data merged successfully
[05:33:47] ✅    ✅ Order data extracted and validated
[05:33:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:33:56] [DOC: 9245814] ℹ️  Patient not found in cache or API: Angela Days
[05:33:56] [DOC: 9245814] ℹ️  Patient not found, creating new patient via API...
[05:33:56] [DOC: 9245814] ℹ️  Creating patient via API: Angela Days
[05:33:57] [DOC: 9245814] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:33:57] ❌    ❌ Failed to create patient
[05:33:57] [DOC: 9245814] ℹ️  API push details saved for document 9245814
================================================================================
║                        Processing Document ID: 9245810                         ║
================================================================================
[05:33:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:33:57] ℹ️  Date: 04/17/2025
[05:33:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:33:59] [DOC: 9245810] ✅ Text extracted using pdfplumber (1574 chars)
[05:33:59] ✅    ✅ Text extracted using pdfplumber (1574 chars)
[05:33:59] 🔄 
🔄 Step 2: Extracting patient data...
[05:34:01] ℹ️  AI extracted raw sex value: 'F'
[05:34:01] ℹ️  AI extracted service line: 'RN'
[05:34:01] ℹ️  AI extracted payer source: ''
[05:34:01] ℹ️  AI extracted diagnoses:
[05:34:01] ℹ️    - Diagnosis 1: ''
[05:34:01] ℹ️    - Diagnosis 2: ''
[05:34:01] ℹ️    - Diagnosis 3: ''
[05:34:01] ℹ️    - Diagnosis 4: ''
[05:34:01] ℹ️    - Diagnosis 5: ''
[05:34:01] ℹ️    - Diagnosis 6: ''
[05:34:01] ℹ️  Final extracted MRN: '2258674'
[05:34:01] ℹ️  Final extracted Sex: 'FEMALE'
[05:34:01] ℹ️  Final extracted Service Line: 'RN'
[05:34:01] ℹ️  Final extracted Payer Source: ''
[05:34:01] ✅ Patient data extraction completed successfully
[05:34:01] ✅    ✅ Patient data extracted successfully
[05:34:01] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:34:01] ✅    ✅ Patient identified: Maryann Boucher
[05:34:01] ✅    ✅ Patient name validation passed
[05:34:01] 🔄 
🔄 Step 3: Processing patient dates...
[05:34:01] [DOC: 9245810] ℹ️  DOB normalized: 03/22/1946
[05:34:01] [DOC: 9245810] ✅ Patient date processing completed successfully
[05:34:01] ✅    ✅ Date processing completed
[05:34:01] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:34:01] 🔄 
🔄 Step 4: Extracting order data...
[05:34:04] ℹ️  Order extraction - MRN: '2258674'
[05:34:04] ℹ️  Order extraction - Sex: 'FEMALE'
[05:34:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:34:04] ℹ️  Order extraction - Payer Source: ''
[05:34:04] ✅ Order data extraction completed successfully
[05:34:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:34:04] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[05:34:04] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[05:34:04] ✅ Patient name cross-validation successful
[05:34:04] ✅    ✅ Data merged successfully
[05:34:05] ✅    ✅ Order data extracted and validated
[05:34:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:34:19] [DOC: 9245810] ℹ️  Patient not found in cache or API: Maryann Boucher
[05:34:19] [DOC: 9245810] ℹ️  Patient not found, creating new patient via API...
[05:34:19] [DOC: 9245810] ℹ️  Creating patient via API: Maryann Boucher
[05:34:20] [DOC: 9245810] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:34:20] ❌    ❌ Failed to create patient
[05:34:20] [DOC: 9245810] ℹ️  API push details saved for document 9245810
================================================================================
║                        Processing Document ID: 9245672                         ║
================================================================================
[05:34:20] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[05:34:20] ℹ️  Date: 04/17/2025
[05:34:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:34:23] [DOC: 9245672] ✅ Text extracted using pdfplumber (3075 chars)
[05:34:23] ✅    ✅ Text extracted using pdfplumber (3075 chars)
[05:34:23] 🔄 
🔄 Step 2: Extracting patient data...
[05:34:25] ℹ️  AI extracted raw sex value: 'F'
[05:34:25] ℹ️  AI extracted service line: 'PT'
[05:34:25] ℹ️  AI extracted payer source: 'Medicaid/MA'
[05:34:25] ℹ️  AI extracted diagnoses:
[05:34:25] ℹ️    - Diagnosis 1: ''
[05:34:25] ℹ️    - Diagnosis 2: ''
[05:34:25] ℹ️    - Diagnosis 3: ''
[05:34:25] ℹ️    - Diagnosis 4: ''
[05:34:25] ℹ️    - Diagnosis 5: ''
[05:34:25] ℹ️    - Diagnosis 6: ''
[05:34:25] ℹ️  Final extracted MRN: '1005'
[05:34:25] ℹ️  Final extracted Sex: 'FEMALE'
[05:34:25] ℹ️  Final extracted Service Line: 'PT'
[05:34:25] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[05:34:25] ✅ Patient data extraction completed successfully
[05:34:25] ✅    ✅ Patient data extracted successfully
[05:34:25] 📊 Patient Response
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:34:25] ✅    ✅ Patient identified: Christina Bosworth
[05:34:25] ✅    ✅ Patient name validation passed
[05:34:25] 🔄 
🔄 Step 3: Processing patient dates...
[05:34:25] [DOC: 9245672] ℹ️  DOB normalized: 07/02/1990
[05:34:25] [DOC: 9245672] ℹ️  Episode startOfCare normalized: 08/17/2022
[05:34:25] [DOC: 9245672] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[05:34:25] [DOC: 9245672] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[05:34:25] [DOC: 9245672] ✅ Patient date processing completed successfully
[05:34:25] ✅    ✅ Date processing completed
[05:34:25] 📊 Processed Patient Data
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:34:25] 🔄 
🔄 Step 4: Extracting order data...
[05:34:28] ℹ️  Order extraction - MRN: '1005'
[05:34:28] ℹ️  Order extraction - Sex: 'FEMALE'
[05:34:28] ℹ️  Order extraction - Service Line: 'PT'
[05:34:28] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[05:34:28] ✅ Order data extraction completed successfully
[05:34:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:34:28] ℹ️  Using MRN from patient data: '1005' over '1005'
[05:34:28] ℹ️  Service line consistent in both sources: 'PT'
[05:34:28] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[05:34:28] ✅ Patient name cross-validation successful
[05:34:28] ✅    ✅ Data merged successfully
[05:34:29] ✅    ✅ Order data extracted and validated
[05:34:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:34:29] [DOC: 9245672] ✅ Patient found in local cache: Christina Bosworth, ID: 189e87b4-7506-4371-aa11-46e767bb1879
[05:34:29] ✅    ✅ Existing patient found with ID: 189e87b4-7506-4371-aa11-46e767bb1879
[05:34:29] 🔄 
🔄 Step 6: Pushing order to API...
[05:34:29] [DOC: 9245672] ℹ️  Pushing order via API for patient ID: 189e87b4-7506-4371-aa11-46e767bb1879
[05:34:30] [DOC: 9245672] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:34:30] ❌    ❌ Failed to push order
[05:34:30] 🔄 
🔄 Step 7: Writing to CSV...
[05:34:30] [DOC: 9245672] ℹ️  Calculated age: 34 from DOB: 07/02/1990
[05:34:30] [DOC: 9245672] ℹ️  Service Line extracted: 'PT'
[05:34:30] [DOC: 9245672] ℹ️  Payer Source extracted: 'Medicaid/MA'
[05:34:30] [DOC: 9245672] ℹ️  Diagnosis codes being written:
[05:34:30] [DOC: 9245672] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:34:30] [DOC: 9245672] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:34:30] [DOC: 9245672] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:34:30] [DOC: 9245672] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:34:30] [DOC: 9245672] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:34:30] [DOC: 9245672] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:34:30] [DOC: 9245672] ✅ Patient data written to CSV: Christina Bosworth | Sex: FEMALE | Age: 34 | Service: PT | Payer: Medicaid/MA | MRN: 1005
[05:34:30] ✅    ✅ Document 9245672 processed and saved successfully
[05:34:30] 🔄 
🔄 Step 8: Saving API details...
[05:34:30] [DOC: 9245672] ℹ️  API push details saved for document 9245672
[05:34:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245610                         ║
================================================================================
[05:34:30] ℹ️  Agency: AccentCare Fall River
[05:34:30] ℹ️  Date: 04/17/2025
[05:34:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:34:34] [DOC: 9245610] ✅ Text extracted using pdfplumber (23386 chars)
[05:34:34] ✅    ✅ Text extracted using pdfplumber (23314 chars)
[05:34:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:34:38] ℹ️  AI extracted raw sex value: 'F'
[05:34:38] ℹ️  AI extracted service line: 'Skilled Nursing,  Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services'
[05:34:38] ℹ️  AI extracted payer source: 'Medicare'
[05:34:38] ℹ️  AI extracted diagnoses:
[05:34:38] ℹ️    - Diagnosis 1: 'U07.1'
[05:34:38] ℹ️    - Diagnosis 2: 'I11.9'
[05:34:38] ℹ️    - Diagnosis 3: 'E11.65'
[05:34:38] ℹ️    - Diagnosis 4: 'T38.0X5D'
[05:34:38] ℹ️    - Diagnosis 5: 'I48.91'
[05:34:38] ℹ️    - Diagnosis 6: 'G40.909'
[05:34:38] ℹ️  Final extracted MRN: 'C0200225049201'
[05:34:38] ℹ️  Final extracted Sex: 'FEMALE'
[05:34:38] ℹ️  Final extracted Service Line: 'Skilled Nursing,  Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services'
[05:34:38] ℹ️  Final extracted Payer Source: 'Medicare'
[05:34:38] ✅ Patient data extraction completed successfully
[05:34:38] ✅    ✅ Patient data extracted successfully
[05:34:38] 📊 Patient Response
     └─ patientFName: BRUNILDA
     └─ patientLName: JORGE
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing,  Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'T38.0X5D', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'G40.909'}]
[05:34:38] ✅    ✅ Patient identified: BRUNILDA JORGE
[05:34:38] ✅    ✅ Patient name validation passed
[05:34:38] 🔄 
🔄 Step 3: Processing patient dates...
[05:34:38] [DOC: 9245610] ℹ️  DOB normalized: 11/15/1938
[05:34:38] [DOC: 9245610] ℹ️  Episode startOfCare normalized: 04/09/2025
[05:34:38] [DOC: 9245610] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[05:34:38] [DOC: 9245610] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[05:34:38] [DOC: 9245610] ✅ Patient date processing completed successfully
[05:34:38] ✅    ✅ Date processing completed
[05:34:38] 📊 Processed Patient Data
     └─ patientFName: BRUNILDA
     └─ patientLName: JORGE
     └─ dob: 11/15/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing,  Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'U07.1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'T38.0X5D', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'G40.909'}]
[05:34:38] 🔄 
🔄 Step 4: Extracting order data...
[05:34:41] ℹ️  Order extraction - MRN: '227203'
[05:34:41] ℹ️  Order extraction - Sex: 'FEMALE'
[05:34:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy'
[05:34:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:34:41] ✅ Order data extraction completed successfully
[05:34:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:34:41] ℹ️  Using MRN from patient data: 'C0200225049201' over '227203'
[05:34:41] ℹ️  Combined service lines: Patient='Skilled Nursing,  Physical Therapy, Occupational Therapy, Speech Therapy, Medical Social Services' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy' = 'Medical Social Services, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Therapy'
[05:34:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:34:41] ✅ Patient name cross-validation successful
[05:34:41] ✅    ✅ Data merged successfully
[05:34:42] ✅    ✅ Order data extracted and validated
[05:34:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:34:42] [DOC: 9245610] ✅ Patient found in local cache: BRUNILDA JORGE, ID: be097701-4784-41f4-8780-f2f69c6e2485
[05:34:42] ✅    ✅ Existing patient found with ID: be097701-4784-41f4-8780-f2f69c6e2485
[05:34:42] 🔄 
🔄 Step 6: Pushing order to API...
[05:34:42] [DOC: 9245610] ℹ️  Pushing order via API for patient ID: be097701-4784-41f4-8780-f2f69c6e2485
[05:34:44] [DOC: 9245610] ❌ Order push failed with status 201: {"id":"9bd3141d-24a4-4f30-ae04-81ba9209e168","orderWAVId":"ORD20023","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 12002430","orderDate":"04/09/2025","startOfCare":"04/09/2025","episodeStartDate":"04/09/2025","episodeEndDate":"06/07/2025","documentID":"9245610","mrn":"227203","patientName":"BRUNILDA JORGE","sentToPhysicianDate":"04/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"be097701-4784-41f4-8780-f2f69c6e2485","companyId":"c7cc6389-e15a-468f-bfbc-bc60ac4d4e81","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:34:44] ❌    ❌ Failed to push order
[05:34:44] 🔄 
🔄 Step 7: Writing to CSV...
[05:34:44] [DOC: 9245610] ℹ️  Calculated age: 86 from DOB: 11/15/1938
[05:34:44] [DOC: 9245610] ℹ️  Service Line extracted: 'Medical Social Services, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Therapy'
[05:34:44] [DOC: 9245610] ℹ️  Payer Source extracted: 'Medicare'
[05:34:44] [DOC: 9245610] ℹ️  Diagnosis codes being written:
[05:34:44] [DOC: 9245610] ℹ️    - Latest_Episode_Firstdiagnosis: 'U07.1'
[05:34:44] [DOC: 9245610] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[05:34:44] [DOC: 9245610] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[05:34:44] [DOC: 9245610] ℹ️    - Latest_Episode_Fourthdiagnosis: 'T38.0X5D'
[05:34:44] [DOC: 9245610] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[05:34:44] [DOC: 9245610] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G40.909'
[05:34:44] [DOC: 9245610] ✅ Patient data written to CSV: BRUNILDA JORGE | Sex: FEMALE | Age: 86 | Service: Medical Social Services, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Therapy | Payer: Medicare | MRN: C0200225049201
[05:34:44] ✅    ✅ Document 9245610 processed and saved successfully
[05:34:44] 🔄 
🔄 Step 8: Saving API details...
[05:34:44] [DOC: 9245610] ℹ️  API push details saved for document 9245610
[05:34:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245405                         ║
================================================================================
[05:34:44] ℹ️  Agency: Nizhoni Health-Fall River
[05:34:44] ℹ️  Date: 04/17/2025
[05:34:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:34:52] [DOC: 9245405] ✅ Text extracted using pdfplumber (14683 chars)
[05:34:52] ✅    ✅ Text extracted using pdfplumber (14683 chars)
[05:34:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:34:55] ℹ️  AI extracted raw sex value: 'M'
[05:34:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:34:55] ℹ️  AI extracted payer source: ''
[05:34:55] ℹ️  AI extracted diagnoses:
[05:34:55] ℹ️    - Diagnosis 1: 'J44.9'
[05:34:55] ℹ️    - Diagnosis 2: 'F31.9'
[05:34:55] ℹ️    - Diagnosis 3: 'E11.9'
[05:34:55] ℹ️    - Diagnosis 4: 'I13.0'
[05:34:55] ℹ️    - Diagnosis 5: 'I50.33'
[05:34:55] ℹ️    - Diagnosis 6: 'N18.31'
[05:34:55] ℹ️  Final extracted MRN: '15300020'
[05:34:55] ℹ️  Final extracted Sex: 'MALE'
[05:34:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:34:55] ℹ️  Final extracted Payer Source: ''
[05:34:55] ✅ Patient data extraction completed successfully
[05:34:55] ✅    ✅ Patient data extracted successfully
[05:34:55] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Petrovich
     └─ dob: 10/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 15300020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100026210649
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA
     └─ address: 1959 Purchase Street Apt N102
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'F31.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.31'}]
[05:34:55] ✅    ✅ Patient identified: Stanley Petrovich
[05:34:55] ✅    ✅ Patient name validation passed
[05:34:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:34:55] [DOC: 9245405] ℹ️  DOB normalized: 10/27/1950
[05:34:55] [DOC: 9245405] ℹ️  Episode startOfCare normalized: 04/07/2025
[05:34:55] [DOC: 9245405] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[05:34:55] [DOC: 9245405] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[05:34:55] [DOC: 9245405] ✅ Patient date processing completed successfully
[05:34:55] ✅    ✅ Date processing completed
[05:34:55] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Petrovich
     └─ dob: 10/27/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 15300020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100026210649
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA
     └─ address: 1959 Purchase Street Apt N102
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'F31.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I13.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'N18.31'}]
[05:34:55] 🔄 
🔄 Step 4: Extracting order data...
[05:34:58] ℹ️  Order extraction - MRN: '15300020'
[05:34:58] ℹ️  Order extraction - Sex: 'MALE'
[05:34:58] ℹ️  Order extraction - Service Line: 'RN'
[05:34:58] ℹ️  Order extraction - Payer Source: ''
[05:34:58] ✅ Order data extraction completed successfully
[05:34:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:34:58] ℹ️  Using MRN from patient data: '15300020' over '15300020'
[05:34:58] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[05:34:58] ✅ Patient name cross-validation successful
[05:34:58] ✅    ✅ Data merged successfully
[05:34:59] ✅    ✅ Order data extracted and validated
[05:34:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:35:17] [DOC: 9245405] ✅ Patient exists in API: Stanley Petrovich, ID: ffce1d34-8d11-4337-acf3-6ce0a7a2b6a2
[05:35:17] ✅    ✅ Existing patient found with ID: ffce1d34-8d11-4337-acf3-6ce0a7a2b6a2
[05:35:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:35:17] [DOC: 9245405] ℹ️  Pushing order via API for patient ID: ffce1d34-8d11-4337-acf3-6ce0a7a2b6a2
[05:35:19] [DOC: 9245405] ❌ Order push failed with status 201: {"id":"ac96f124-41fa-43c4-92e2-73f4fa1d5766","orderWAVId":"ORD20024","orderNo":"15300020","orderDate":"04/07/2025","startOfCare":"04/07/2025","episodeStartDate":"04/07/2025","episodeEndDate":"06/05/2025","documentID":"9245405","mrn":"15300020","patientName":"Petrovich, Stanley","sentToPhysicianDate":"04/17/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"ffce1d34-8d11-4337-acf3-6ce0a7a2b6a2","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:35:19] ❌    ❌ Failed to push order
[05:35:19] 🔄 
🔄 Step 7: Writing to CSV...
[05:35:19] [DOC: 9245405] ℹ️  Calculated age: 74 from DOB: 10/27/1950
[05:35:19] [DOC: 9245405] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[05:35:19] [DOC: 9245405] ℹ️  Payer Source extracted: ''
[05:35:19] [DOC: 9245405] ℹ️  Diagnosis codes being written:
[05:35:19] [DOC: 9245405] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[05:35:19] [DOC: 9245405] ℹ️    - Latest_Episode_Seconddiagnosis: 'F31.9'
[05:35:19] [DOC: 9245405] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[05:35:19] [DOC: 9245405] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I13.0'
[05:35:19] [DOC: 9245405] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.33'
[05:35:19] [DOC: 9245405] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.31'
[05:35:19] [DOC: 9245405] ✅ Patient data written to CSV: Stanley Petrovich | Sex: MALE | Age: 74 | Service: RN, Skilled Nursing | Payer:  | MRN: 15300020
[05:35:19] ✅    ✅ Document 9245405 processed and saved successfully
[05:35:19] 🔄 
🔄 Step 8: Saving API details...
[05:35:19] [DOC: 9245405] ℹ️  API push details saved for document 9245405
[05:35:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245321                         ║
================================================================================
[05:35:19] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[05:35:19] ℹ️  Date: 04/17/2025
[05:35:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:35:22] [DOC: 9245321] ✅ Text extracted using pdfplumber (1305 chars)
[05:35:22] ✅    ✅ Text extracted using pdfplumber (1305 chars)
[05:35:22] 🔄 
🔄 Step 2: Extracting patient data...
[05:35:24] ℹ️  AI extracted raw sex value: 'M'
[05:35:24] ℹ️  AI extracted service line: 'RN'
[05:35:24] ℹ️  AI extracted payer source: 'Senior Whole Health'
[05:35:24] ℹ️  AI extracted diagnoses:
[05:35:24] ℹ️    - Diagnosis 1: 'None'
[05:35:24] ℹ️    - Diagnosis 2: 'None'
[05:35:24] ℹ️    - Diagnosis 3: 'None'
[05:35:24] ℹ️    - Diagnosis 4: 'None'
[05:35:24] ℹ️    - Diagnosis 5: 'None'
[05:35:24] ℹ️    - Diagnosis 6: 'None'
[05:35:24] ℹ️  Final extracted MRN: '114004'
[05:35:24] ℹ️  Final extracted Sex: 'MALE'
[05:35:24] ℹ️  Final extracted Service Line: 'RN'
[05:35:24] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[05:35:24] ✅ Patient data extraction completed successfully
[05:35:24] ✅    ✅ Patient data extracted successfully
[05:35:24] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:35:24] ✅    ✅ Patient identified: Donald Brown
[05:35:24] ✅    ✅ Patient name validation passed
[05:35:24] 🔄 
🔄 Step 3: Processing patient dates...
[05:35:24] [DOC: 9245321] ℹ️  DOB normalized: 06/18/1949
[05:35:24] [DOC: 9245321] ℹ️  Episode startOfCare normalized: 12/01/2018
[05:35:24] [DOC: 9245321] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[05:35:24] [DOC: 9245321] ✅ Patient date processing completed successfully
[05:35:24] ✅    ✅ Date processing completed
[05:35:24] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'endOfEpisode': '04/27/2025'}]
[05:35:24] 🔄 
🔄 Step 4: Extracting order data...
[05:35:27] ℹ️  Order extraction - MRN: '114004'
[05:35:27] ℹ️  Order extraction - Sex: 'MALE'
[05:35:27] ℹ️  Order extraction - Service Line: ''
[05:35:27] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[05:35:27] ✅ Order data extraction completed successfully
[05:35:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:35:27] ℹ️  Using MRN from patient data: '114004' over '114004'
[05:35:27] ℹ️  Using service line from patient data: 'RN'
[05:35:27] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[05:35:27] ✅ Patient name cross-validation successful
[05:35:27] ✅    ✅ Data merged successfully
[05:35:29] ✅    ✅ Order data extracted and validated
[05:35:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:35:29] [DOC: 9245321] ✅ Patient found in local cache: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[05:35:29] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[05:35:29] 🔄 
🔄 Step 6: Pushing order to API...
[05:35:29] [DOC: 9245321] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[05:35:30] [DOC: 9245321] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:35:30] ❌    ❌ Failed to push order
[05:35:30] 🔄 
🔄 Step 7: Writing to CSV...
[05:35:30] [DOC: 9245321] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[05:35:30] [DOC: 9245321] ℹ️  Service Line extracted: 'RN'
[05:35:30] [DOC: 9245321] ℹ️  Payer Source extracted: 'Senior Whole Health'
[05:35:30] [DOC: 9245321] ℹ️  Diagnosis codes being written:
[05:35:30] [DOC: 9245321] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:35:30] [DOC: 9245321] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:35:30] [DOC: 9245321] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:35:30] [DOC: 9245321] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:35:30] [DOC: 9245321] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:35:30] [DOC: 9245321] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:35:30] [DOC: 9245321] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: RN | Payer: Senior Whole Health | MRN: 114004
[05:35:30] ✅    ✅ Document 9245321 processed and saved successfully
[05:35:30] 🔄 
🔄 Step 8: Saving API details...
[05:35:30] [DOC: 9245321] ℹ️  API push details saved for document 9245321
[05:35:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245220                         ║
================================================================================
[05:35:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:35:30] ℹ️  Date: 04/17/2025
[05:35:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:35:35] [DOC: 9245220] ✅ Text extracted using pdfplumber (18615 chars)
[05:35:35] ✅    ✅ Text extracted using pdfplumber (18615 chars)
[05:35:35] 🔄 
🔄 Step 2: Extracting patient data...
[05:35:38] ℹ️  AI extracted raw sex value: 'M'
[05:35:38] ℹ️  AI extracted service line: 'PT'
[05:35:38] ℹ️  AI extracted payer source: 'None'
[05:35:38] ℹ️  AI extracted diagnoses:
[05:35:38] ℹ️    - Diagnosis 1: 'FRACTURE OF FEMORAL NECK RIGHT'
[05:35:38] ℹ️    - Diagnosis 2: 'AFIB'
[05:35:38] ℹ️    - Diagnosis 3: 'CKD'
[05:35:38] ℹ️    - Diagnosis 4: 'ANXIETY'
[05:35:38] ℹ️    - Diagnosis 5: 'DEPRESSION'
[05:35:38] ℹ️    - Diagnosis 6: 'BPH'
[05:35:38] ℹ️  Final extracted MRN: 'MA250324024402'
[05:35:38] ℹ️  Final extracted Sex: 'MALE'
[05:35:38] ℹ️  Final extracted Service Line: 'PT'
[05:35:38] ℹ️  Final extracted Payer Source: ''
[05:35:38] ✅ Patient data extraction completed successfully
[05:35:38] ✅    ✅ Patient data extracted successfully
[05:35:38] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/03/2025', 'endOfEpisode': '05/26/25', 'firstDiagnosis': 'FRACTURE OF FEMORAL NECK RIGHT', 'secondDiagnosis': 'AFIB', 'thirdDiagnosis': 'CKD', 'fourthDiagnosis': 'ANXIETY', 'fifthDiagnosis': 'DEPRESSION', 'sixthDiagnosis': 'BPH'}]
[05:35:38] ✅    ✅ Patient identified: Ronald Ferreira
[05:35:38] ✅    ✅ Patient name validation passed
[05:35:38] 🔄 
🔄 Step 3: Processing patient dates...
[05:35:38] [DOC: 9245220] ℹ️  DOB normalized: 02/01/1944
[05:35:38] [DOC: 9245220] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[05:35:38] [DOC: 9245220] ⚠️  Invalid endOfEpisode format: 05/26/25
[05:35:38] [DOC: 9245220] ✅ Patient date processing completed successfully
[05:35:38] ✅    ✅ Date processing completed
[05:35:38] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '05/26/25', 'firstDiagnosis': 'FRACTURE OF FEMORAL NECK RIGHT', 'secondDiagnosis': 'AFIB', 'thirdDiagnosis': 'CKD', 'fourthDiagnosis': 'ANXIETY', 'fifthDiagnosis': 'DEPRESSION', 'sixthDiagnosis': 'BPH'}]
[05:35:38] 🔄 
🔄 Step 4: Extracting order data...
[05:35:42] ℹ️  Order extraction - MRN: 'MA250324024402'
[05:35:42] ℹ️  Order extraction - Sex: 'MALE'
[05:35:42] ℹ️  Order extraction - Service Line: 'PT'
[05:35:42] ℹ️  Order extraction - Payer Source: ''
[05:35:42] ✅ Order data extraction completed successfully
[05:35:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:35:42] ℹ️  Using MRN from patient data: 'MA250324024402' over 'MA250324024402'
[05:35:42] ℹ️  Service line consistent in both sources: 'PT'
[05:35:42] ✅ Patient name cross-validation successful
[05:35:42] ✅    ✅ Data merged successfully
[05:35:43] ✅    ✅ Order data extracted and validated
[05:35:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:36:06] [DOC: 9245220] ✅ Patient exists in API: Ronald Ferreira, ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[05:36:06] ✅    ✅ Existing patient found with ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[05:36:06] 🔄 
🔄 Step 6: Pushing order to API...
[05:36:06] [DOC: 9245220] ℹ️  Pushing order via API for patient ID: b9ac7148-eb46-4efe-943f-bfbb847ac280
[05:36:08] [DOC: 9245220] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:36:08] ❌    ❌ Failed to push order
[05:36:08] 🔄 
🔄 Step 7: Writing to CSV...
[05:36:08] [DOC: 9245220] ℹ️  Calculated age: 81 from DOB: 02/01/1944
[05:36:08] [DOC: 9245220] ℹ️  Service Line extracted: 'PT'
[05:36:08] [DOC: 9245220] ℹ️  Payer Source extracted: ''
[05:36:08] [DOC: 9245220] ℹ️  Diagnosis codes being written:
[05:36:08] [DOC: 9245220] ℹ️    - Latest_Episode_Firstdiagnosis: 'FRACTURE OF FEMORAL NECK RIGHT'
[05:36:08] [DOC: 9245220] ℹ️    - Latest_Episode_Seconddiagnosis: 'AFIB'
[05:36:08] [DOC: 9245220] ℹ️    - Latest_Episode_Thirddiagnosis: 'CKD'
[05:36:08] [DOC: 9245220] ℹ️    - Latest_Episode_Fourthdiagnosis: 'ANXIETY'
[05:36:08] [DOC: 9245220] ℹ️    - Latest_Episode_Fifthdiagnosis: 'DEPRESSION'
[05:36:08] [DOC: 9245220] ℹ️    - Latest_Episode_Sixthdiagnosis: 'BPH'
[05:36:08] [DOC: 9245220] ✅ Patient data written to CSV: Ronald Ferreira | Sex: MALE | Age: 81 | Service: PT | Payer:  | MRN: MA250324024402
[05:36:08] ✅    ✅ Document 9245220 processed and saved successfully
[05:36:08] 🔄 
🔄 Step 8: Saving API details...
[05:36:08] [DOC: 9245220] ℹ️  API push details saved for document 9245220
[05:36:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245186                         ║
================================================================================
[05:36:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:36:08] ℹ️  Date: 04/17/2025
[05:36:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:36:10] [DOC: 9245186] ✅ Text extracted using pdfplumber (1434 chars)
[05:36:10] ✅    ✅ Text extracted using pdfplumber (1434 chars)
[05:36:10] 🔄 
🔄 Step 2: Extracting patient data...
[05:36:13] ℹ️  AI extracted raw sex value: ''
[05:36:13] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:36:13] ℹ️  AI extracted payer source: ''
[05:36:13] ℹ️  AI extracted diagnoses:
[05:36:13] ℹ️    - Diagnosis 1: 'I10'
[05:36:13] ℹ️    - Diagnosis 2: 'E05.90'
[05:36:13] ℹ️    - Diagnosis 3: 'E78.5'
[05:36:13] ℹ️    - Diagnosis 4: 'None'
[05:36:13] ℹ️    - Diagnosis 5: 'None'
[05:36:13] ℹ️    - Diagnosis 6: 'None'
[05:36:13] ℹ️  Final extracted MRN: 'MA211105042902'
[05:36:13] ℹ️  Final extracted Sex: ''
[05:36:13] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:36:13] ℹ️  Final extracted Payer Source: ''
[05:36:13] ✅ Patient data extraction completed successfully
[05:36:13] ✅    ✅ Patient data extracted successfully
[05:36:13] 📊 Patient Response
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:36:13] ✅    ✅ Patient identified: Louisa Ramos
[05:36:13] ✅    ✅ Patient name validation passed
[05:36:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:36:13] [DOC: 9245186] ℹ️  DOB normalized: 04/03/1929
[05:36:13] [DOC: 9245186] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:36:13] [DOC: 9245186] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:36:13] [DOC: 9245186] ✅ Patient date processing completed successfully
[05:36:13] ✅    ✅ Date processing completed
[05:36:13] 📊 Processed Patient Data
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5'}]
[05:36:13] 🔄 
🔄 Step 4: Extracting order data...
[05:36:16] ℹ️  Order extraction - MRN: 'MA211105042902'
[05:36:16] ℹ️  Order extraction - Sex: ''
[05:36:16] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:36:16] ℹ️  Order extraction - Payer Source: ''
[05:36:16] ✅ Order data extraction completed successfully
[05:36:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:36:16] ℹ️  Using MRN from patient data: 'MA211105042902' over 'MA211105042902'
[05:36:16] ⚠️  Could not determine sex using any available method
[05:36:16] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:36:16] ✅ Patient name cross-validation successful
[05:36:16] ✅    ✅ Data merged successfully
[05:36:17] ✅    ✅ Order data extracted and validated
[05:36:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:36:17] [DOC: 9245186] ✅ Patient found in local cache: Louisa Ramos, ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[05:36:17] ✅    ✅ Existing patient found with ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[05:36:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:36:17] [DOC: 9245186] ℹ️  Pushing order via API for patient ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[05:36:18] [DOC: 9245186] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13141"}
[05:36:18] ❌    ❌ Failed to push order
[05:36:18] 🔄 
🔄 Step 7: Writing to CSV...
[05:36:18] [DOC: 9245186] ℹ️  Calculated age: 96 from DOB: 04/03/1929
[05:36:18] [DOC: 9245186] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:36:18] [DOC: 9245186] ℹ️  Payer Source extracted: ''
[05:36:18] [DOC: 9245186] ℹ️  Diagnosis codes being written:
[05:36:18] [DOC: 9245186] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[05:36:18] [DOC: 9245186] ℹ️    - Latest_Episode_Seconddiagnosis: 'E05.90'
[05:36:18] [DOC: 9245186] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[05:36:18] [DOC: 9245186] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:36:18] [DOC: 9245186] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:36:18] [DOC: 9245186] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:36:18] [DOC: 9245186] ✅ Patient data written to CSV: Louisa Ramos | Sex:  | Age: 96 | Service: Occupational Therapy | Payer:  | MRN: MA211105042902
[05:36:18] ✅    ✅ Document 9245186 processed and saved successfully
[05:36:18] 🔄 
🔄 Step 8: Saving API details...
[05:36:18] [DOC: 9245186] ℹ️  API push details saved for document 9245186
[05:36:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245185                         ║
================================================================================
[05:36:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:36:18] ℹ️  Date: 04/17/2025
[05:36:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:36:21] [DOC: 9245185] ✅ Text extracted using pdfplumber (11856 chars)
[05:36:21] ✅    ✅ Text extracted using pdfplumber (11856 chars)
[05:36:21] 🔄 
🔄 Step 2: Extracting patient data...
[05:36:24] ℹ️  AI extracted raw sex value: 'F'
[05:36:24] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[05:36:24] ℹ️  AI extracted payer source: 'Medicare'
[05:36:24] ℹ️  AI extracted diagnoses:
[05:36:24] ℹ️    - Diagnosis 1: 'I10'
[05:36:24] ℹ️    - Diagnosis 2: 'E05.90'
[05:36:24] ℹ️    - Diagnosis 3: 'E78.5'
[05:36:24] ℹ️    - Diagnosis 4: 'K21.9'
[05:36:24] ℹ️    - Diagnosis 5: 'H54.61'
[05:36:24] ℹ️    - Diagnosis 6: 'None'
[05:36:24] ℹ️  Final extracted MRN: 'MA211105042902'
[05:36:24] ℹ️  Final extracted Sex: 'FEMALE'
[05:36:24] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[05:36:24] ℹ️  Final extracted Payer Source: 'Medicare'
[05:36:24] ✅ Patient data extraction completed successfully
[05:36:24] ✅    ✅ Patient data extracted successfully
[05:36:24] 📊 Patient Response
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 1881923936
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 127A W Hill Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 999-7009
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'H54.61', 'sixthDiagnosis': None}]
[05:36:24] ✅    ✅ Patient identified: Louisa Ramos
[05:36:24] ✅    ✅ Patient name validation passed
[05:36:24] 🔄 
🔄 Step 3: Processing patient dates...
[05:36:24] [DOC: 9245185] ℹ️  DOB normalized: 04/03/1929
[05:36:24] [DOC: 9245185] ℹ️  Episode startOfCare normalized: 04/08/2025
[05:36:24] [DOC: 9245185] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[05:36:24] [DOC: 9245185] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[05:36:24] [DOC: 9245185] ✅ Patient date processing completed successfully
[05:36:24] ✅    ✅ Date processing completed
[05:36:24] 📊 Processed Patient Data
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 1881923936
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 127A W Hill Rd
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 999-7009
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'H54.61'}]
[05:36:24] 🔄 
🔄 Step 4: Extracting order data...
[05:36:27] ℹ️  Order extraction - MRN: 'MA211105042902'
[05:36:27] ℹ️  Order extraction - Sex: 'FEMALE'
[05:36:27] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[05:36:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:36:27] ✅ Order data extraction completed successfully
[05:36:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:36:27] ℹ️  Using MRN from patient data: 'MA211105042902' over 'MA211105042902'
[05:36:27] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[05:36:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:36:27] ✅ Patient name cross-validation successful
[05:36:27] ✅    ✅ Data merged successfully
[05:36:28] ✅    ✅ Order data extracted and validated
[05:36:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:36:28] [DOC: 9245185] ✅ Patient found in local cache: Louisa Ramos, ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[05:36:28] ✅    ✅ Existing patient found with ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[05:36:28] 🔄 
🔄 Step 6: Pushing order to API...
[05:36:28] [DOC: 9245185] ℹ️  Pushing order via API for patient ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[05:36:29] [DOC: 9245185] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13142"}
[05:36:29] ❌    ❌ Failed to push order
[05:36:29] 🔄 
🔄 Step 7: Writing to CSV...
[05:36:29] [DOC: 9245185] ℹ️  Calculated age: 96 from DOB: 04/03/1929
[05:36:29] [DOC: 9245185] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[05:36:29] [DOC: 9245185] ℹ️  Payer Source extracted: 'Medicare'
[05:36:29] [DOC: 9245185] ℹ️  Diagnosis codes being written:
[05:36:29] [DOC: 9245185] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[05:36:29] [DOC: 9245185] ℹ️    - Latest_Episode_Seconddiagnosis: 'E05.90'
[05:36:29] [DOC: 9245185] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[05:36:29] [DOC: 9245185] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K21.9'
[05:36:29] [DOC: 9245185] ℹ️    - Latest_Episode_Fifthdiagnosis: 'H54.61'
[05:36:29] [DOC: 9245185] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:36:29] [DOC: 9245185] ✅ Patient data written to CSV: Louisa Ramos | Sex: FEMALE | Age: 96 | Service: Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA211105042902
[05:36:29] ✅    ✅ Document 9245185 processed and saved successfully
[05:36:29] 🔄 
🔄 Step 8: Saving API details...
[05:36:29] [DOC: 9245185] ℹ️  API push details saved for document 9245185
[05:36:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245150                         ║
================================================================================
[05:36:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:36:29] ℹ️  Date: 04/17/2025
[05:36:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:36:33] [DOC: 9245150] ✅ Text extracted using pdfplumber (20717 chars)
[05:36:33] ✅    ✅ Text extracted using pdfplumber (20717 chars)
[05:36:33] 🔄 
🔄 Step 2: Extracting patient data...
[05:36:36] ℹ️  AI extracted raw sex value: 'F'
[05:36:36] ℹ️  AI extracted service line: 'OT'
[05:36:36] ℹ️  AI extracted payer source: 'None'
[05:36:36] ℹ️  AI extracted diagnoses:
[05:36:36] ℹ️    - Diagnosis 1: 'Pain LE/R shoulder pain'
[05:36:36] ℹ️    - Diagnosis 2: 'weakness/pain'
[05:36:36] ℹ️    - Diagnosis 3: 'displaced intertrochanteric r hip fx with surgical intervention'
[05:36:36] ℹ️    - Diagnosis 4: 'flu'
[05:36:36] ℹ️    - Diagnosis 5: 'fall'
[05:36:36] ℹ️    - Diagnosis 6: 'None'
[05:36:36] ℹ️  Final extracted MRN: 'MA240223015002'
[05:36:36] ℹ️  Final extracted Sex: 'FEMALE'
[05:36:36] ℹ️  Final extracted Service Line: 'OT'
[05:36:36] ℹ️  Final extracted Payer Source: ''
[05:36:36] ✅ Patient data extraction completed successfully
[05:36:36] ✅    ✅ Patient data extracted successfully
[05:36:36] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Santos
     └─ dob: 01/29/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240223015002
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/24/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Pain LE/R shoulder pain', 'secondDiagnosis': 'weakness/pain', 'thirdDiagnosis': 'displaced intertrochanteric r hip fx with surgical intervention', 'fourthDiagnosis': 'flu', 'fifthDiagnosis': 'fall', 'sixthDiagnosis': None}]
[05:36:36] ✅    ✅ Patient identified: Mary Santos
[05:36:36] ✅    ✅ Patient name validation passed
[05:36:36] 🔄 
🔄 Step 3: Processing patient dates...
[05:36:36] [DOC: 9245150] ℹ️  DOB normalized: 01/29/1950
[05:36:36] [DOC: 9245150] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[05:36:36] [DOC: 9245150] ✅ Patient date processing completed successfully
[05:36:36] ✅    ✅ Date processing completed
[05:36:36] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Santos
     └─ dob: 01/29/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240223015002
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'firstDiagnosis': 'Pain LE/R shoulder pain', 'secondDiagnosis': 'weakness/pain', 'thirdDiagnosis': 'displaced intertrochanteric r hip fx with surgical intervention', 'fourthDiagnosis': 'flu', 'fifthDiagnosis': 'fall'}]
[05:36:36] 🔄 
🔄 Step 4: Extracting order data...
[05:36:39] ℹ️  Order extraction - MRN: 'MA240223015002'
[05:36:39] ℹ️  Order extraction - Sex: 'FEMALE'
[05:36:39] ℹ️  Order extraction - Service Line: 'OT'
[05:36:39] ℹ️  Order extraction - Payer Source: ''
[05:36:39] ✅ Order data extraction completed successfully
[05:36:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:36:39] ℹ️  Using MRN from patient data: 'MA240223015002' over 'MA240223015002'
[05:36:39] ℹ️  Service line consistent in both sources: 'OT'
[05:36:39] ✅ Patient name cross-validation successful
[05:36:39] ✅    ✅ Data merged successfully
[05:36:40] ✅    ✅ Order data extracted and validated
[05:36:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:36:46] [DOC: 9245150] ℹ️  Patient not found in cache or API: Mary Santos
[05:36:46] [DOC: 9245150] ℹ️  Patient not found, creating new patient via API...
[05:36:46] [DOC: 9245150] ℹ️  Creating patient via API: Mary Santos
[05:36:47] [DOC: 9245150] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:36:47] ❌    ❌ Failed to create patient
[05:36:47] [DOC: 9245150] ℹ️  API push details saved for document 9245150
================================================================================
║                        Processing Document ID: 9245148                         ║
================================================================================
[05:36:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:36:47] ℹ️  Date: 04/17/2025
[05:36:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:36:49] [DOC: 9245148] ✅ Text extracted using pdfplumber (1543 chars)
[05:36:49] ✅    ✅ Text extracted using pdfplumber (1543 chars)
[05:36:49] 🔄 
🔄 Step 2: Extracting patient data...
[05:36:52] ℹ️  AI extracted raw sex value: ''
[05:36:52] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:36:52] ℹ️  AI extracted payer source: ''
[05:36:52] ℹ️  AI extracted diagnoses:
[05:36:52] ℹ️    - Diagnosis 1: 'S83.512'
[05:36:52] ℹ️    - Diagnosis 2: 'S83.212'
[05:36:52] ℹ️    - Diagnosis 3: 'S83.412'
[05:36:52] ℹ️    - Diagnosis 4: 'None'
[05:36:52] ℹ️    - Diagnosis 5: 'None'
[05:36:52] ℹ️    - Diagnosis 6: 'None'
[05:36:52] ℹ️  Final extracted MRN: 'MA250326033704'
[05:36:52] ℹ️  Final extracted Sex: ''
[05:36:52] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:36:52] ℹ️  Final extracted Payer Source: ''
[05:36:52] ✅ Patient data extraction completed successfully
[05:36:52] ✅    ✅ Patient data extracted successfully
[05:36:52] 📊 Patient Response
     └─ patientFName: Lilian
     └─ patientLName: Carvalho
     └─ dob: 03/28/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA250326033704
     └─ billingProvider: SIRJANA PARAJULI
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'S83.512', 'secondDiagnosis': 'S83.212', 'thirdDiagnosis': 'S83.412', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:36:52] ✅    ✅ Patient identified: Lilian Carvalho
[05:36:52] ✅    ✅ Patient name validation passed
[05:36:52] 🔄 
🔄 Step 3: Processing patient dates...
[05:36:52] [DOC: 9245148] ℹ️  DOB normalized: 03/28/1937
[05:36:52] [DOC: 9245148] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[05:36:52] [DOC: 9245148] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[05:36:52] [DOC: 9245148] ✅ Patient date processing completed successfully
[05:36:52] ✅    ✅ Date processing completed
[05:36:52] 📊 Processed Patient Data
     └─ patientFName: Lilian
     └─ patientLName: Carvalho
     └─ dob: 03/28/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA250326033704
     └─ billingProvider: SIRJANA PARAJULI
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'S83.512', 'secondDiagnosis': 'S83.212', 'thirdDiagnosis': 'S83.412'}]
[05:36:52] 🔄 
🔄 Step 4: Extracting order data...
[05:36:55] ℹ️  Order extraction - MRN: 'MA250326033704'
[05:36:55] ℹ️  Order extraction - Sex: ''
[05:36:55] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:36:55] ℹ️  Order extraction - Payer Source: ''
[05:36:55] ✅ Order data extraction completed successfully
[05:36:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:36:55] ℹ️  Using MRN from patient data: 'MA250326033704' over 'MA250326033704'
[05:36:55] ⚠️  Could not determine sex using any available method
[05:36:55] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:36:55] ✅ Patient name cross-validation successful
[05:36:55] ✅    ✅ Data merged successfully
[05:36:56] ✅    ✅ Order data extracted and validated
[05:36:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:36:56] [DOC: 9245148] ✅ Patient found in local cache: Lilian Carvalho, ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:36:56] ✅    ✅ Existing patient found with ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:36:56] 🔄 
🔄 Step 6: Pushing order to API...
[05:36:56] [DOC: 9245148] ℹ️  Pushing order via API for patient ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:36:57] [DOC: 9245148] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13456"}
[05:36:57] ❌    ❌ Failed to push order
[05:36:57] 🔄 
🔄 Step 7: Writing to CSV...
[05:36:57] [DOC: 9245148] ℹ️  Calculated age: 88 from DOB: 03/28/1937
[05:36:57] [DOC: 9245148] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:36:57] [DOC: 9245148] ℹ️  Payer Source extracted: ''
[05:36:57] [DOC: 9245148] ℹ️  Diagnosis codes being written:
[05:36:57] [DOC: 9245148] ℹ️    - Latest_Episode_Firstdiagnosis: 'S83.512'
[05:36:57] [DOC: 9245148] ℹ️    - Latest_Episode_Seconddiagnosis: 'S83.212'
[05:36:57] [DOC: 9245148] ℹ️    - Latest_Episode_Thirddiagnosis: 'S83.412'
[05:36:57] [DOC: 9245148] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:36:57] [DOC: 9245148] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:36:57] [DOC: 9245148] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:36:57] [DOC: 9245148] ✅ Patient data written to CSV: Lilian Carvalho | Sex:  | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA250326033704
[05:36:57] ✅    ✅ Document 9245148 processed and saved successfully
[05:36:57] 🔄 
🔄 Step 8: Saving API details...
[05:36:57] [DOC: 9245148] ℹ️  API push details saved for document 9245148
[05:36:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245147                         ║
================================================================================
[05:36:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:36:57] ℹ️  Date: 04/17/2025
[05:36:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:37:01] [DOC: 9245147] ✅ Text extracted using pdfplumber (13283 chars)
[05:37:01] ✅    ✅ Text extracted using pdfplumber (13283 chars)
[05:37:01] 🔄 
🔄 Step 2: Extracting patient data...
[05:37:04] ℹ️  AI extracted raw sex value: 'F'
[05:37:04] ℹ️  AI extracted service line: 'OT'
[05:37:04] ℹ️  AI extracted payer source: ''
[05:37:04] ℹ️  AI extracted diagnoses:
[05:37:04] ℹ️    - Diagnosis 1: ''
[05:37:04] ℹ️    - Diagnosis 2: ''
[05:37:04] ℹ️    - Diagnosis 3: ''
[05:37:04] ℹ️    - Diagnosis 4: ''
[05:37:04] ℹ️    - Diagnosis 5: ''
[05:37:04] ℹ️    - Diagnosis 6: ''
[05:37:04] ℹ️  Final extracted MRN: 'MA250326033704'
[05:37:04] ℹ️  Final extracted Sex: 'FEMALE'
[05:37:04] ℹ️  Final extracted Service Line: 'OT'
[05:37:04] ℹ️  Final extracted Payer Source: ''
[05:37:04] ✅ Patient data extraction completed successfully
[05:37:04] ✅    ✅ Patient data extracted successfully
[05:37:04] 📊 Patient Response
     └─ patientFName: Lilian
     └─ patientLName: Carvalho
     └─ dob: 03/28/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250326033704
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:37:04] ✅    ✅ Patient identified: Lilian Carvalho
[05:37:04] ✅    ✅ Patient name validation passed
[05:37:04] 🔄 
🔄 Step 3: Processing patient dates...
[05:37:04] [DOC: 9245147] ℹ️  DOB normalized: 03/28/1937
[05:37:04] [DOC: 9245147] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[05:37:04] [DOC: 9245147] ✅ Patient date processing completed successfully
[05:37:04] ✅    ✅ Date processing completed
[05:37:04] 📊 Processed Patient Data
     └─ patientFName: Lilian
     └─ patientLName: Carvalho
     └─ dob: 03/28/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250326033704
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:37:04] 🔄 
🔄 Step 4: Extracting order data...
[05:37:06] ℹ️  Order extraction - MRN: 'MA250326033704'
[05:37:06] ℹ️  Order extraction - Sex: 'FEMALE'
[05:37:06] ℹ️  Order extraction - Service Line: 'OT'
[05:37:06] ℹ️  Order extraction - Payer Source: ''
[05:37:06] ✅ Order data extraction completed successfully
[05:37:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:37:06] ℹ️  Using MRN from patient data: 'MA250326033704' over 'MA250326033704'
[05:37:06] ℹ️  Service line consistent in both sources: 'OT'
[05:37:06] ✅ Patient name cross-validation successful
[05:37:06] ✅    ✅ Data merged successfully
[05:37:08] ✅    ✅ Order data extracted and validated
[05:37:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:37:08] [DOC: 9245147] ✅ Patient found in local cache: Lilian Carvalho, ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:37:08] ✅    ✅ Existing patient found with ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:37:08] 🔄 
🔄 Step 6: Pushing order to API...
[05:37:08] [DOC: 9245147] ℹ️  Pushing order via API for patient ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:37:09] [DOC: 9245147] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:37:09] ❌    ❌ Failed to push order
[05:37:09] 🔄 
🔄 Step 7: Writing to CSV...
[05:37:09] [DOC: 9245147] ℹ️  Calculated age: 88 from DOB: 03/28/1937
[05:37:09] [DOC: 9245147] ℹ️  Service Line extracted: 'OT'
[05:37:09] [DOC: 9245147] ℹ️  Payer Source extracted: ''
[05:37:09] [DOC: 9245147] ℹ️  Diagnosis codes being written:
[05:37:09] [DOC: 9245147] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:37:09] [DOC: 9245147] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:37:09] [DOC: 9245147] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:37:09] [DOC: 9245147] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:37:09] [DOC: 9245147] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:37:09] [DOC: 9245147] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:37:09] [DOC: 9245147] ✅ Patient data written to CSV: Lilian Carvalho | Sex: FEMALE | Age: 88 | Service: OT | Payer:  | MRN: MA250326033704
[05:37:09] ✅    ✅ Document 9245147 processed and saved successfully
[05:37:09] 🔄 
🔄 Step 8: Saving API details...
[05:37:09] [DOC: 9245147] ℹ️  API push details saved for document 9245147
[05:37:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245144                         ║
================================================================================
[05:37:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:37:09] ℹ️  Date: 04/17/2025
[05:37:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:37:13] [DOC: 9245144] ✅ Text extracted using pdfplumber (1348 chars)
[05:37:13] ✅    ✅ Text extracted using pdfplumber (1348 chars)
[05:37:13] 🔄 
🔄 Step 2: Extracting patient data...
[05:37:16] ℹ️  AI extracted raw sex value: ''
[05:37:16] ℹ️  AI extracted service line: 'PT'
[05:37:16] ℹ️  AI extracted payer source: ''
[05:37:16] ℹ️  AI extracted diagnoses:
[05:37:16] ℹ️    - Diagnosis 1: 'S83.512'
[05:37:16] ℹ️    - Diagnosis 2: 'S83.212'
[05:37:16] ℹ️    - Diagnosis 3: 'S83.412'
[05:37:16] ℹ️    - Diagnosis 4: 'None'
[05:37:16] ℹ️    - Diagnosis 5: 'None'
[05:37:16] ℹ️    - Diagnosis 6: 'None'
[05:37:16] ℹ️  Final extracted MRN: 'MA250326033704'
[05:37:16] ℹ️  Final extracted Sex: ''
[05:37:16] ℹ️  Final extracted Service Line: 'PT'
[05:37:16] ℹ️  Final extracted Payer Source: ''
[05:37:16] ✅ Patient data extraction completed successfully
[05:37:16] ✅    ✅ Patient data extracted successfully
[05:37:16] 📊 Patient Response
     └─ patientFName: Lilian
     └─ patientLName: Carvalho
     └─ dob: 03/28/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA250326033704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'S83.512', 'secondDiagnosis': 'S83.212', 'thirdDiagnosis': 'S83.412', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:37:16] ✅    ✅ Patient identified: Lilian Carvalho
[05:37:16] ✅    ✅ Patient name validation passed
[05:37:16] 🔄 
🔄 Step 3: Processing patient dates...
[05:37:16] [DOC: 9245144] ℹ️  DOB normalized: 03/28/1937
[05:37:16] [DOC: 9245144] ℹ️  Episode startOfCare normalized: 04/01/2025
[05:37:16] [DOC: 9245144] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[05:37:16] [DOC: 9245144] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[05:37:16] [DOC: 9245144] ✅ Patient date processing completed successfully
[05:37:16] ✅    ✅ Date processing completed
[05:37:16] 📊 Processed Patient Data
     └─ patientFName: Lilian
     └─ patientLName: Carvalho
     └─ dob: 03/28/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA250326033704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'S83.512', 'secondDiagnosis': 'S83.212', 'thirdDiagnosis': 'S83.412'}]
[05:37:16] 🔄 
🔄 Step 4: Extracting order data...
[05:37:18] ℹ️  Order extraction - MRN: 'MA250326033704'
[05:37:18] ℹ️  Order extraction - Sex: ''
[05:37:18] ℹ️  Order extraction - Service Line: 'PT'
[05:37:18] ℹ️  Order extraction - Payer Source: ''
[05:37:18] ✅ Order data extraction completed successfully
[05:37:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:37:18] ℹ️  Using MRN from patient data: 'MA250326033704' over 'MA250326033704'
[05:37:18] ⚠️  Could not determine sex using any available method
[05:37:18] ℹ️  Service line consistent in both sources: 'PT'
[05:37:18] ✅ Patient name cross-validation successful
[05:37:18] ✅    ✅ Data merged successfully
[05:37:19] ✅    ✅ Order data extracted and validated
[05:37:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:37:19] [DOC: 9245144] ✅ Patient found in local cache: Lilian Carvalho, ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:37:19] ✅    ✅ Existing patient found with ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:37:19] 🔄 
🔄 Step 6: Pushing order to API...
[05:37:19] [DOC: 9245144] ℹ️  Pushing order via API for patient ID: d4ed5255-37f2-4f85-a242-faf3265a9299
[05:37:20] [DOC: 9245144] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13457"}
[05:37:20] ❌    ❌ Failed to push order
[05:37:20] 🔄 
🔄 Step 7: Writing to CSV...
[05:37:20] [DOC: 9245144] ℹ️  Calculated age: 88 from DOB: 03/28/1937
[05:37:20] [DOC: 9245144] ℹ️  Service Line extracted: 'PT'
[05:37:20] [DOC: 9245144] ℹ️  Payer Source extracted: ''
[05:37:20] [DOC: 9245144] ℹ️  Diagnosis codes being written:
[05:37:20] [DOC: 9245144] ℹ️    - Latest_Episode_Firstdiagnosis: 'S83.512'
[05:37:20] [DOC: 9245144] ℹ️    - Latest_Episode_Seconddiagnosis: 'S83.212'
[05:37:20] [DOC: 9245144] ℹ️    - Latest_Episode_Thirddiagnosis: 'S83.412'
[05:37:20] [DOC: 9245144] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:37:20] [DOC: 9245144] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:37:20] [DOC: 9245144] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:37:20] [DOC: 9245144] ✅ Patient data written to CSV: Lilian Carvalho | Sex:  | Age: 88 | Service: PT | Payer:  | MRN: MA250326033704
[05:37:20] ✅    ✅ Document 9245144 processed and saved successfully
[05:37:20] 🔄 
🔄 Step 8: Saving API details...
[05:37:20] [DOC: 9245144] ℹ️  API push details saved for document 9245144
[05:37:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244299                         ║
================================================================================
[05:37:20] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[05:37:20] ℹ️  Date: 04/16/2025
[05:37:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:37:23] [DOC: 9244299] ✅ Text extracted using pdfplumber (8313 chars)
[05:37:23] ✅    ✅ Text extracted using pdfplumber (8313 chars)
[05:37:23] 🔄 
🔄 Step 2: Extracting patient data...
[05:37:27] ℹ️  AI extracted raw sex value: 'M'
[05:37:27] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[05:37:27] ℹ️  AI extracted payer source: 'Medicaid'
[05:37:27] ℹ️  AI extracted diagnoses:
[05:37:27] ℹ️    - Diagnosis 1: 'Z48.812'
[05:37:27] ℹ️    - Diagnosis 2: 'I70.211'
[05:37:27] ℹ️    - Diagnosis 3: 'I25.10'
[05:37:27] ℹ️    - Diagnosis 4: 'J81.0'
[05:37:27] ℹ️    - Diagnosis 5: 'I10'
[05:37:27] ℹ️    - Diagnosis 6: 'E78.5'
[05:37:27] ℹ️  Final extracted MRN: '648005'
[05:37:27] ℹ️  Final extracted Sex: 'MALE'
[05:37:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[05:37:27] ℹ️  Final extracted Payer Source: 'Medicaid'
[05:37:27] ✅ Patient data extraction completed successfully
[05:37:27] ✅    ✅ Patient data extracted successfully
[05:37:27] 📊 Patient Response
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 100018430916
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicaid
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I70.211', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'J81.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[05:37:27] ✅    ✅ Patient identified: Pedro Sousa
[05:37:27] ✅    ✅ Patient name validation passed
[05:37:27] 🔄 
🔄 Step 3: Processing patient dates...
[05:37:27] [DOC: 9244299] ℹ️  DOB normalized: 03/29/1964
[05:37:27] [DOC: 9244299] ℹ️  Episode startOfCare normalized: 03/25/2025
[05:37:27] [DOC: 9244299] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[05:37:27] [DOC: 9244299] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[05:37:27] [DOC: 9244299] ✅ Patient date processing completed successfully
[05:37:27] ✅    ✅ Date processing completed
[05:37:27] 📊 Processed Patient Data
     └─ patientFName: Pedro
     └─ patientLName: Sousa
     └─ dob: 03/29/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 648005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 100018430916
     └─ physicianNPI: 1750479283
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Medicaid
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I70.211', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'J81.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E78.5'}]
[05:37:27] 🔄 
🔄 Step 4: Extracting order data...
[05:37:29] ℹ️  Order extraction - MRN: '648005'
[05:37:29] ℹ️  Order extraction - Sex: 'MALE'
[05:37:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:37:29] ℹ️  Order extraction - Payer Source: ''
[05:37:29] ✅ Order data extraction completed successfully
[05:37:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:37:29] ℹ️  Using MRN from patient data: '648005' over '648005'
[05:37:29] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[05:37:29] ℹ️  Using payer source from patient data: 'Medicaid'
[05:37:29] ✅ Patient name cross-validation successful
[05:37:29] ✅    ✅ Data merged successfully
[05:37:30] ✅    ✅ Order data extracted and validated
[05:37:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:37:30] [DOC: 9244299] ✅ Patient found in local cache: Pedro Sousa, ID: 2dc51ce5-9447-429a-994f-bc659210b701
[05:37:30] ✅    ✅ Existing patient found with ID: 2dc51ce5-9447-429a-994f-bc659210b701
[05:37:30] 🔄 
🔄 Step 6: Pushing order to API...
[05:37:30] [DOC: 9244299] ℹ️  Pushing order via API for patient ID: 2dc51ce5-9447-429a-994f-bc659210b701
[05:37:32] [DOC: 9244299] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:37:32] ❌    ❌ Failed to push order
[05:37:32] 🔄 
🔄 Step 7: Writing to CSV...
[05:37:32] [DOC: 9244299] ℹ️  Calculated age: 61 from DOB: 03/29/1964
[05:37:32] [DOC: 9244299] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[05:37:32] [DOC: 9244299] ℹ️  Payer Source extracted: 'Medicaid'
[05:37:32] [DOC: 9244299] ℹ️  Diagnosis codes being written:
[05:37:32] [DOC: 9244299] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.812'
[05:37:32] [DOC: 9244299] ℹ️    - Latest_Episode_Seconddiagnosis: 'I70.211'
[05:37:32] [DOC: 9244299] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[05:37:32] [DOC: 9244299] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J81.0'
[05:37:32] [DOC: 9244299] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[05:37:32] [DOC: 9244299] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E78.5'
[05:37:32] [DOC: 9244299] ✅ Patient data written to CSV: Pedro Sousa | Sex: MALE | Age: 61 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer: Medicaid | MRN: 648005
[05:37:32] ✅    ✅ Document 9244299 processed and saved successfully
[05:37:32] 🔄 
🔄 Step 8: Saving API details...
[05:37:32] [DOC: 9244299] ℹ️  API push details saved for document 9244299
[05:37:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245099                         ║
================================================================================
[05:37:32] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:37:32] ℹ️  Date: 04/16/2025
[05:37:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:37:34] [DOC: 9245099] ✅ Text extracted using pdfplumber (2147 chars)
[05:37:34] ✅    ✅ Text extracted using pdfplumber (2135 chars)
[05:37:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:37:37] ℹ️  AI extracted raw sex value: ''
[05:37:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:37:37] ℹ️  AI extracted payer source: 'Medicare'
[05:37:37] ℹ️  AI extracted diagnoses:
[05:37:37] ℹ️    - Diagnosis 1: ''
[05:37:37] ℹ️    - Diagnosis 2: ''
[05:37:37] ℹ️    - Diagnosis 3: ''
[05:37:37] ℹ️    - Diagnosis 4: ''
[05:37:37] ℹ️    - Diagnosis 5: ''
[05:37:37] ℹ️    - Diagnosis 6: ''
[05:37:37] ℹ️  Final extracted MRN: '28700205798601'
[05:37:37] ℹ️  Final extracted Sex: ''
[05:37:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:37:37] ℹ️  Final extracted Payer Source: 'Medicare'
[05:37:37] ✅ Patient data extraction completed successfully
[05:37:37] ✅    ✅ Patient data extracted successfully
[05:37:37] 📊 Patient Response
     └─ patientFName: LIGIA
     └─ patientLName: SOUSA
     └─ dob: 10/29/1950
     └─ patientSex: 
     └─ medicalRecordNo: 28700205798601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 36 ERIC RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:37:37] ✅    ✅ Patient identified: LIGIA SOUSA
[05:37:37] ✅    ✅ Patient name validation passed
[05:37:37] 🔄 
🔄 Step 3: Processing patient dates...
[05:37:37] [DOC: 9245099] ℹ️  DOB normalized: 10/29/1950
[05:37:37] [DOC: 9245099] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[05:37:37] [DOC: 9245099] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[05:37:37] [DOC: 9245099] ✅ Patient date processing completed successfully
[05:37:37] ✅    ✅ Date processing completed
[05:37:37] 📊 Processed Patient Data
     └─ patientFName: LIGIA
     └─ patientLName: SOUSA
     └─ dob: 10/29/1950
     └─ patientSex: 
     └─ medicalRecordNo: 28700205798601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 36 ERIC RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:37:37] 🔄 
🔄 Step 4: Extracting order data...
[05:37:39] ℹ️  Order extraction - MRN: '28700205798601'
[05:37:39] ℹ️  Order extraction - Sex: ''
[05:37:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:37:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:37:39] ✅ Order data extraction completed successfully
[05:37:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:37:39] ℹ️  Using MRN from patient data: '28700205798601' over '28700205798601'
[05:37:39] ⚠️  Could not determine sex using any available method
[05:37:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:37:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:37:39] ✅ Patient name cross-validation successful
[05:37:39] ✅    ✅ Data merged successfully
[05:37:40] ✅    ✅ Order data extracted and validated
[05:37:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:37:53] [DOC: 9245099] ✅ Patient exists in API: LIGIA SOUSA, ID: 3afc2e11-631e-42fc-9551-478448edb57d
[05:37:53] ✅    ✅ Existing patient found with ID: 3afc2e11-631e-42fc-9551-478448edb57d
[05:37:53] 🔄 
🔄 Step 6: Pushing order to API...
[05:37:53] [DOC: 9245099] ℹ️  Pushing order via API for patient ID: 3afc2e11-631e-42fc-9551-478448edb57d
[05:37:54] [DOC: 9245099] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14439"}
[05:37:54] ❌    ❌ Failed to push order
[05:37:54] 🔄 
🔄 Step 7: Writing to CSV...
[05:37:54] [DOC: 9245099] ℹ️  Calculated age: 74 from DOB: 10/29/1950
[05:37:54] [DOC: 9245099] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:37:54] [DOC: 9245099] ℹ️  Payer Source extracted: 'Medicare'
[05:37:54] [DOC: 9245099] ℹ️  Diagnosis codes being written:
[05:37:54] [DOC: 9245099] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:37:54] [DOC: 9245099] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:37:54] [DOC: 9245099] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:37:54] [DOC: 9245099] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:37:54] [DOC: 9245099] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:37:54] [DOC: 9245099] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:37:54] [DOC: 9245099] ✅ Patient data written to CSV: LIGIA SOUSA | Sex:  | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700205798601
[05:37:54] ✅    ✅ Document 9245099 processed and saved successfully
[05:37:54] 🔄 
🔄 Step 8: Saving API details...
[05:37:54] [DOC: 9245099] ℹ️  API push details saved for document 9245099
[05:37:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9245093                         ║
================================================================================
[05:37:54] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:37:54] ℹ️  Date: 04/16/2025
[05:37:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:37:56] [DOC: 9245093] ✅ Text extracted using pdfplumber (1654 chars)
[05:37:56] ✅    ✅ Text extracted using pdfplumber (1654 chars)
[05:37:56] 🔄 
🔄 Step 2: Extracting patient data...
[05:37:59] ℹ️  AI extracted raw sex value: ''
[05:37:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:37:59] ℹ️  AI extracted payer source: 'Medicare'
[05:37:59] ℹ️  AI extracted diagnoses:
[05:37:59] ℹ️    - Diagnosis 1: ''
[05:37:59] ℹ️    - Diagnosis 2: ''
[05:37:59] ℹ️    - Diagnosis 3: ''
[05:37:59] ℹ️    - Diagnosis 4: ''
[05:37:59] ℹ️    - Diagnosis 5: ''
[05:37:59] ℹ️    - Diagnosis 6: ''
[05:37:59] ℹ️  Final extracted MRN: '28700209064601'
[05:37:59] ℹ️  Final extracted Sex: ''
[05:37:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:37:59] ℹ️  Final extracted Payer Source: 'Medicare'
[05:37:59] ✅ Patient data extraction completed successfully
[05:37:59] ✅    ✅ Patient data extracted successfully
[05:37:59] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: COUTO
     └─ dob: 09/27/1950
     └─ patientSex: 
     └─ medicalRecordNo: 28700209064601
     └─ billingProvider: HUGO JAUREGUI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUCNE CORNER RD
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:37:59] ✅    ✅ Patient identified: JOHN COUTO
[05:37:59] ✅    ✅ Patient name validation passed
[05:37:59] 🔄 
🔄 Step 3: Processing patient dates...
[05:37:59] [DOC: 9245093] ℹ️  DOB normalized: 09/27/1950
[05:37:59] [DOC: 9245093] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[05:37:59] [DOC: 9245093] ℹ️  Episode endOfEpisode normalized: 03/12/2025
[05:37:59] [DOC: 9245093] ✅ Patient date processing completed successfully
[05:37:59] ✅    ✅ Date processing completed
[05:37:59] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: COUTO
     └─ dob: 09/27/1950
     └─ patientSex: 
     └─ medicalRecordNo: 28700209064601
     └─ billingProvider: HUGO JAUREGUI, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUCNE CORNER RD
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:37:59] 🔄 
🔄 Step 4: Extracting order data...
[05:38:01] ℹ️  Order extraction - MRN: '28700209064601'
[05:38:01] ℹ️  Order extraction - Sex: ''
[05:38:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:38:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:38:01] ✅ Order data extraction completed successfully
[05:38:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:38:01] ℹ️  Using MRN from patient data: '28700209064601' over '28700209064601'
[05:38:01] ℹ️  Inferred sex as MALE from name: JOHN
[05:38:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:38:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:38:01] ✅ Patient name cross-validation successful
[05:38:01] ✅    ✅ Data merged successfully
[05:38:02] ✅    ✅ Order data extracted and validated
[05:38:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:38:08] [DOC: 9245093] ✅ Patient exists in API: JOHN COUTO, ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[05:38:08] ✅    ✅ Existing patient found with ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[05:38:08] 🔄 
🔄 Step 6: Pushing order to API...
[05:38:08] [DOC: 9245093] ℹ️  Pushing order via API for patient ID: 6a261ab7-0f82-43fd-a5b1-7ae483996ea5
[05:38:09] [DOC: 9245093] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12893"}
[05:38:09] ❌    ❌ Failed to push order
[05:38:09] 🔄 
🔄 Step 7: Writing to CSV...
[05:38:09] [DOC: 9245093] ℹ️  Calculated age: 74 from DOB: 09/27/1950
[05:38:09] [DOC: 9245093] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:38:09] [DOC: 9245093] ℹ️  Payer Source extracted: 'Medicare'
[05:38:09] [DOC: 9245093] ℹ️  Diagnosis codes being written:
[05:38:09] [DOC: 9245093] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:38:09] [DOC: 9245093] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:38:09] [DOC: 9245093] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:38:09] [DOC: 9245093] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:38:09] [DOC: 9245093] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:38:09] [DOC: 9245093] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:38:09] [DOC: 9245093] ✅ Patient data written to CSV: JOHN COUTO | Sex: MALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700209064601
[05:38:09] ✅    ✅ Document 9245093 processed and saved successfully
[05:38:09] 🔄 
🔄 Step 8: Saving API details...
[05:38:09] [DOC: 9245093] ℹ️  API push details saved for document 9245093
[05:38:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244480                         ║
================================================================================
[05:38:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:38:09] ℹ️  Date: 04/16/2025
[05:38:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:38:13] [DOC: 9244480] ✅ Text extracted using pdfplumber (16089 chars)
[05:38:13] ✅    ✅ Text extracted using pdfplumber (16089 chars)
[05:38:13] 🔄 
🔄 Step 2: Extracting patient data...
[05:38:16] ℹ️  AI extracted raw sex value: 'M'
[05:38:16] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[05:38:16] ℹ️  AI extracted payer source: ''
[05:38:16] ℹ️  AI extracted diagnoses:
[05:38:16] ℹ️    - Diagnosis 1: 'I10'
[05:38:16] ℹ️    - Diagnosis 2: 'M54.6'
[05:38:16] ℹ️    - Diagnosis 3: 'S09.90XD'
[05:38:16] ℹ️    - Diagnosis 4: 'E11.9'
[05:38:16] ℹ️    - Diagnosis 5: 'R91.8'
[05:38:16] ℹ️    - Diagnosis 6: 'W01.0XXD'
[05:38:16] ℹ️  Final extracted MRN: '3351642'
[05:38:16] ℹ️  Final extracted Sex: 'MALE'
[05:38:16] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[05:38:16] ℹ️  Final extracted Payer Source: ''
[05:38:16] ✅ Patient data extraction completed successfully
[05:38:16] ✅    ✅ Patient data extracted successfully
[05:38:16] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Veiga
     └─ dob: 11/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 3351642
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'M54.6', 'thirdDiagnosis': 'S09.90XD', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'R91.8', 'sixthDiagnosis': 'W01.0XXD'}]
[05:38:16] ✅    ✅ Patient identified: Manuel Veiga
[05:38:16] ✅    ✅ Patient name validation passed
[05:38:16] 🔄 
🔄 Step 3: Processing patient dates...
[05:38:16] [DOC: 9244480] ℹ️  DOB normalized: 11/02/1944
[05:38:16] [DOC: 9244480] ℹ️  Episode startOfCare normalized: 04/03/2025
[05:38:16] [DOC: 9244480] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:38:16] [DOC: 9244480] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:38:16] [DOC: 9244480] ✅ Patient date processing completed successfully
[05:38:16] ✅    ✅ Date processing completed
[05:38:16] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Veiga
     └─ dob: 11/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 3351642
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'M54.6', 'thirdDiagnosis': 'S09.90XD', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'R91.8', 'sixthDiagnosis': 'W01.0XXD'}]
[05:38:16] 🔄 
🔄 Step 4: Extracting order data...
[05:38:19] ℹ️  Order extraction - MRN: '3351642'
[05:38:19] ℹ️  Order extraction - Sex: 'MALE'
[05:38:19] ℹ️  Order extraction - Service Line: 'Physical Therapy,Occupational Therapy'
[05:38:19] ℹ️  Order extraction - Payer Source: ''
[05:38:19] ✅ Order data extraction completed successfully
[05:38:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:38:19] ℹ️  Using MRN from patient data: '3351642' over '3351642'
[05:38:19] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy'
[05:38:19] ✅ Patient name cross-validation successful
[05:38:19] ✅    ✅ Data merged successfully
[05:38:20] ✅    ✅ Order data extracted and validated
[05:38:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:38:55] [DOC: 9244480] ℹ️  Patient not found in cache or API: Manuel Veiga
[05:38:55] [DOC: 9244480] ℹ️  Patient not found, creating new patient via API...
[05:38:55] [DOC: 9244480] ℹ️  Creating patient via API: Manuel Veiga
[05:38:57] [DOC: 9244480] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:38:57] ❌    ❌ Failed to create patient
[05:38:57] [DOC: 9244480] ℹ️  API push details saved for document 9244480
================================================================================
║                        Processing Document ID: 9244476                         ║
================================================================================
[05:38:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:38:57] ℹ️  Date: 04/16/2025
[05:38:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:39:00] [DOC: 9244476] ✅ Text extracted using pdfplumber (10847 chars)
[05:39:00] ✅    ✅ Text extracted using pdfplumber (10847 chars)
[05:39:00] 🔄 
🔄 Step 2: Extracting patient data...
[05:39:03] ℹ️  AI extracted raw sex value: 'M'
[05:39:03] ℹ️  AI extracted service line: 'Physical Therapy'
[05:39:03] ℹ️  AI extracted payer source: ''
[05:39:03] ℹ️  AI extracted diagnoses:
[05:39:03] ℹ️    - Diagnosis 1: 'D61.818'
[05:39:03] ℹ️    - Diagnosis 2: 'I12.0'
[05:39:03] ℹ️    - Diagnosis 3: 'E11.22'
[05:39:03] ℹ️    - Diagnosis 4: 'N18.6'
[05:39:03] ℹ️    - Diagnosis 5: 'C62.92'
[05:39:03] ℹ️    - Diagnosis 6: 'I95.1'
[05:39:03] ℹ️  Final extracted MRN: '3054251'
[05:39:03] ℹ️  Final extracted Sex: 'MALE'
[05:39:03] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:39:03] ℹ️  Final extracted Payer Source: ''
[05:39:03] ✅ Patient data extraction completed successfully
[05:39:03] ✅    ✅ Patient data extracted successfully
[05:39:03] 📊 Patient Response
     └─ patientFName: Michael
     └─ patientLName: Turek
     └─ dob: 05/22/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: 3054251
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'D61.818', 'secondDiagnosis': 'I12.0', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.6', 'fifthDiagnosis': 'C62.92', 'sixthDiagnosis': 'I95.1'}]
[05:39:03] ✅    ✅ Patient identified: Michael Turek
[05:39:03] ✅    ✅ Patient name validation passed
[05:39:03] 🔄 
🔄 Step 3: Processing patient dates...
[05:39:03] [DOC: 9244476] ℹ️  DOB normalized: 05/22/1976
[05:39:03] [DOC: 9244476] ℹ️  Episode startOfCare normalized: 04/01/2025
[05:39:03] [DOC: 9244476] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[05:39:03] [DOC: 9244476] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[05:39:03] [DOC: 9244476] ✅ Patient date processing completed successfully
[05:39:03] ✅    ✅ Date processing completed
[05:39:03] 📊 Processed Patient Data
     └─ patientFName: Michael
     └─ patientLName: Turek
     └─ dob: 05/22/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: 3054251
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'D61.818', 'secondDiagnosis': 'I12.0', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.6', 'fifthDiagnosis': 'C62.92', 'sixthDiagnosis': 'I95.1'}]
[05:39:03] 🔄 
🔄 Step 4: Extracting order data...
[05:39:05] ℹ️  Order extraction - MRN: '3054251'
[05:39:05] ℹ️  Order extraction - Sex: 'MALE'
[05:39:05] ℹ️  Order extraction - Service Line: 'PT'
[05:39:05] ℹ️  Order extraction - Payer Source: ''
[05:39:05] ✅ Order data extraction completed successfully
[05:39:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:39:05] ℹ️  Using MRN from patient data: '3054251' over '3054251'
[05:39:05] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[05:39:05] ✅ Patient name cross-validation successful
[05:39:05] ✅    ✅ Data merged successfully
[05:39:06] ✅    ✅ Order data extracted and validated
[05:39:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:39:38] [DOC: 9244476] ℹ️  Patient not found in cache or API: Michael Turek
[05:39:38] [DOC: 9244476] ℹ️  Patient not found, creating new patient via API...
[05:39:38] [DOC: 9244476] ℹ️  Creating patient via API: Michael Turek
[05:39:39] [DOC: 9244476] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:39:39] ❌    ❌ Failed to create patient
[05:39:39] [DOC: 9244476] ℹ️  API push details saved for document 9244476
================================================================================
║                        Processing Document ID: 9244469                         ║
================================================================================
[05:39:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:39:39] ℹ️  Date: 04/16/2025
[05:39:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:39:41] [DOC: 9244469] ✅ Text extracted using pdfplumber (838 chars)
[05:39:41] ✅    ✅ Text extracted using pdfplumber (838 chars)
[05:39:41] 🔄 
🔄 Step 2: Extracting patient data...
[05:39:44] ℹ️  AI extracted raw sex value: 'M'
[05:39:44] ℹ️  AI extracted service line: ''
[05:39:44] ℹ️  AI extracted payer source: ''
[05:39:44] ℹ️  AI extracted diagnoses:
[05:39:44] ℹ️    - Diagnosis 1: ''
[05:39:44] ℹ️    - Diagnosis 2: ''
[05:39:44] ℹ️    - Diagnosis 3: ''
[05:39:44] ℹ️    - Diagnosis 4: ''
[05:39:44] ℹ️    - Diagnosis 5: ''
[05:39:44] ℹ️    - Diagnosis 6: ''
[05:39:44] ℹ️  Final extracted MRN: '2998670'
[05:39:44] ℹ️  Final extracted Sex: 'MALE'
[05:39:44] ℹ️  Final extracted Service Line: ''
[05:39:44] ℹ️  Final extracted Payer Source: ''
[05:39:44] ✅ Patient data extraction completed successfully
[05:39:44] ✅    ✅ Patient data extracted successfully
[05:39:44] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:39:44] ✅    ✅ Patient identified: Raymond Souza
[05:39:44] ✅    ✅ Patient name validation passed
[05:39:44] 🔄 
🔄 Step 3: Processing patient dates...
[05:39:44] [DOC: 9244469] ℹ️  DOB normalized: 06/18/1927
[05:39:44] [DOC: 9244469] ✅ Patient date processing completed successfully
[05:39:44] ✅    ✅ Date processing completed
[05:39:44] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:39:44] 🔄 
🔄 Step 4: Extracting order data...
[05:39:46] ℹ️  Order extraction - MRN: '2998670'
[05:39:46] ℹ️  Order extraction - Sex: 'MALE'
[05:39:46] ℹ️  Order extraction - Service Line: ''
[05:39:46] ℹ️  Order extraction - Payer Source: ''
[05:39:46] ✅ Order data extraction completed successfully
[05:39:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:39:46] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[05:39:46] ✅ Patient name cross-validation successful
[05:39:46] ✅    ✅ Data merged successfully
[05:39:47] ⚠️     ❌ Skipping - missing episode start date
[05:39:47] [DOC: 9244469] ℹ️  API push details saved for document 9244469
================================================================================
║                        Processing Document ID: 9244465                         ║
================================================================================
[05:39:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:39:47] ℹ️  Date: 04/16/2025
[05:39:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:39:50] [DOC: 9244465] ✅ Text extracted using pdfplumber (7163 chars)
[05:39:50] ✅    ✅ Text extracted using pdfplumber (7163 chars)
[05:39:50] 🔄 
🔄 Step 2: Extracting patient data...
[05:39:53] ℹ️  AI extracted raw sex value: 'M'
[05:39:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:39:53] ℹ️  AI extracted payer source: ''
[05:39:53] ℹ️  AI extracted diagnoses:
[05:39:53] ℹ️    - Diagnosis 1: 'I51.9'
[05:39:53] ℹ️    - Diagnosis 2: 'I50.9'
[05:39:53] ℹ️    - Diagnosis 3: 'I48.91'
[05:39:53] ℹ️    - Diagnosis 4: 'I25.10'
[05:39:53] ℹ️    - Diagnosis 5: 'I10'
[05:39:53] ℹ️    - Diagnosis 6: 'E84.9'
[05:39:53] ℹ️  Final extracted MRN: '2998670'
[05:39:53] ℹ️  Final extracted Sex: 'MALE'
[05:39:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:39:53] ℹ️  Final extracted Payer Source: ''
[05:39:53] ✅ Patient data extraction completed successfully
[05:39:53] ✅    ✅ Patient data extracted successfully
[05:39:53] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'I51.9', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'I48.91', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E84.9'}]
[05:39:53] ✅    ✅ Patient identified: Raymond Souza
[05:39:53] ✅    ✅ Patient name validation passed
[05:39:53] 🔄 
🔄 Step 3: Processing patient dates...
[05:39:53] [DOC: 9244465] ℹ️  DOB normalized: 06/18/1927
[05:39:53] [DOC: 9244465] ℹ️  Episode startOfCare normalized: 04/15/2025
[05:39:53] [DOC: 9244465] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[05:39:53] [DOC: 9244465] ℹ️  Episode endOfEpisode normalized: 07/13/2025
[05:39:53] [DOC: 9244465] ✅ Patient date processing completed successfully
[05:39:53] ✅    ✅ Date processing completed
[05:39:53] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'I51.9', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'I48.91', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E84.9'}]
[05:39:53] 🔄 
🔄 Step 4: Extracting order data...
[05:39:55] ℹ️  Order extraction - MRN: '2998670'
[05:39:55] ℹ️  Order extraction - Sex: 'MALE'
[05:39:55] ℹ️  Order extraction - Service Line: 'RN'
[05:39:55] ℹ️  Order extraction - Payer Source: ''
[05:39:55] ✅ Order data extraction completed successfully
[05:39:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:39:55] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[05:39:55] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[05:39:55] ✅ Patient name cross-validation successful
[05:39:55] ✅    ✅ Data merged successfully
[05:39:57] ✅    ✅ Order data extracted and validated
[05:39:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:39:57] [DOC: 9244465] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[05:39:57] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[05:39:57] 🔄 
🔄 Step 6: Pushing order to API...
[05:39:57] [DOC: 9244465] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[05:39:58] [DOC: 9244465] ❌ Order push failed with status 201: {"id":"01f005b9-fd77-4326-86dc-8e086261ce04","orderWAVId":"ORD20025","orderNo":"1082033","orderDate":"04/15/2025","startOfCare":"04/15/2025","episodeStartDate":"04/15/2025","episodeEndDate":"07/13/2025","documentID":"9244465","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/16/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Certification of Terminal Illness","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:39:58] ❌    ❌ Failed to push order
[05:39:58] 🔄 
🔄 Step 7: Writing to CSV...
[05:39:58] [DOC: 9244465] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[05:39:58] [DOC: 9244465] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[05:39:58] [DOC: 9244465] ℹ️  Payer Source extracted: ''
[05:39:58] [DOC: 9244465] ℹ️  Diagnosis codes being written:
[05:39:58] [DOC: 9244465] ℹ️    - Latest_Episode_Firstdiagnosis: 'I51.9'
[05:39:58] [DOC: 9244465] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[05:39:58] [DOC: 9244465] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.91'
[05:39:58] [DOC: 9244465] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.10'
[05:39:58] [DOC: 9244465] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[05:39:58] [DOC: 9244465] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E84.9'
[05:39:58] [DOC: 9244465] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: RN, Skilled Nursing | Payer:  | MRN: 2998670
[05:39:58] ✅    ✅ Document 9244465 processed and saved successfully
[05:39:58] 🔄 
🔄 Step 8: Saving API details...
[05:39:58] [DOC: 9244465] ℹ️  API push details saved for document 9244465
[05:39:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244461                         ║
================================================================================
[05:39:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:39:58] ℹ️  Date: 04/16/2025
[05:39:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:40:02] [DOC: 9244461] ✅ Text extracted using pdfplumber (31065 chars)
[05:40:02] ✅    ✅ Text extracted using pdfplumber (31065 chars)
[05:40:02] 🔄 
🔄 Step 2: Extracting patient data...
[05:40:06] ℹ️  AI extracted raw sex value: 'M'
[05:40:06] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[05:40:06] ℹ️  AI extracted payer source: ''
[05:40:06] ℹ️  AI extracted diagnoses:
[05:40:06] ℹ️    - Diagnosis 1: 'C71.9'
[05:40:06] ℹ️    - Diagnosis 2: 'L89.313'
[05:40:06] ℹ️    - Diagnosis 3: 'L89.526'
[05:40:06] ℹ️    - Diagnosis 4: 'I12.9'
[05:40:06] ℹ️    - Diagnosis 5: 'N18.30'
[05:40:06] ℹ️    - Diagnosis 6: 'L89.611'
[05:40:06] ℹ️  Final extracted MRN: '2909089'
[05:40:06] ℹ️  Final extracted Sex: 'MALE'
[05:40:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[05:40:06] ℹ️  Final extracted Payer Source: ''
[05:40:06] ✅ Patient data extraction completed successfully
[05:40:06] ✅    ✅ Patient data extracted successfully
[05:40:06] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Roberts
     └─ dob: 11/20/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2909089
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 9 Church St
     └─ city: Mattapoisett
     └─ state: MA
     └─ zip: 02739-2618
     └─ email: 
     └─ phoneNumber: 508-758-2389
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'C71.9', 'secondDiagnosis': 'L89.313', 'thirdDiagnosis': 'L89.526', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'L89.611'}]
[05:40:06] ✅    ✅ Patient identified: Phillip Roberts
[05:40:06] ✅    ✅ Patient name validation passed
[05:40:06] 🔄 
🔄 Step 3: Processing patient dates...
[05:40:06] [DOC: 9244461] ℹ️  DOB normalized: 11/20/1934
[05:40:06] [DOC: 9244461] ℹ️  Episode startOfCare normalized: 04/01/2025
[05:40:06] [DOC: 9244461] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:40:06] [DOC: 9244461] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:40:06] [DOC: 9244461] ✅ Patient date processing completed successfully
[05:40:06] ✅    ✅ Date processing completed
[05:40:06] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Roberts
     └─ dob: 11/20/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2909089
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 9 Church St
     └─ city: Mattapoisett
     └─ state: MA
     └─ zip: 02739-2618
     └─ email: 
     └─ phoneNumber: 508-758-2389
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'C71.9', 'secondDiagnosis': 'L89.313', 'thirdDiagnosis': 'L89.526', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'L89.611'}]
[05:40:06] 🔄 
🔄 Step 4: Extracting order data...
[05:40:09] ℹ️  Order extraction - MRN: '2909089'
[05:40:09] ℹ️  Order extraction - Sex: 'MALE'
[05:40:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide'
[05:40:09] ℹ️  Order extraction - Payer Source: ''
[05:40:09] ✅ Order data extraction completed successfully
[05:40:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:40:09] ℹ️  Using MRN from patient data: '2909089' over '2909089'
[05:40:09] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy,Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[05:40:09] ✅ Patient name cross-validation successful
[05:40:09] ✅    ✅ Data merged successfully
[05:40:10] ✅    ✅ Order data extracted and validated
[05:40:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:40:20] [DOC: 9244461] ℹ️  Patient not found in cache or API: Phillip Roberts
[05:40:20] [DOC: 9244461] ℹ️  Patient not found, creating new patient via API...
[05:40:20] [DOC: 9244461] ℹ️  Creating patient via API: Phillip Roberts
[05:40:21] [DOC: 9244461] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:40:21] ❌    ❌ Failed to create patient
[05:40:21] [DOC: 9244461] ℹ️  API push details saved for document 9244461
================================================================================
║                        Processing Document ID: 9244455                         ║
================================================================================
[05:40:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:40:21] ℹ️  Date: 04/16/2025
[05:40:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:40:22] [DOC: 9244455] ✅ Text extracted using pdfplumber (1157 chars)
[05:40:22] ✅    ✅ Text extracted using pdfplumber (1157 chars)
[05:40:22] 🔄 
🔄 Step 2: Extracting patient data...
[05:40:25] ℹ️  AI extracted raw sex value: 'F'
[05:40:25] ℹ️  AI extracted service line: 'RN'
[05:40:25] ℹ️  AI extracted payer source: ''
[05:40:25] ℹ️  AI extracted diagnoses:
[05:40:25] ℹ️    - Diagnosis 1: ''
[05:40:25] ℹ️    - Diagnosis 2: ''
[05:40:25] ℹ️    - Diagnosis 3: ''
[05:40:25] ℹ️    - Diagnosis 4: ''
[05:40:25] ℹ️    - Diagnosis 5: ''
[05:40:25] ℹ️    - Diagnosis 6: ''
[05:40:25] ℹ️  Final extracted MRN: '2750591'
[05:40:25] ℹ️  Final extracted Sex: 'FEMALE'
[05:40:25] ℹ️  Final extracted Service Line: 'RN'
[05:40:25] ℹ️  Final extracted Payer Source: ''
[05:40:25] ✅ Patient data extraction completed successfully
[05:40:25] ✅    ✅ Patient data extracted successfully
[05:40:25] 📊 Patient Response
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:40:25] ✅    ✅ Patient identified: Valentina Miguel
[05:40:25] ✅    ✅ Patient name validation passed
[05:40:25] 🔄 
🔄 Step 3: Processing patient dates...
[05:40:25] [DOC: 9244455] ℹ️  DOB normalized: 11/24/1951
[05:40:25] [DOC: 9244455] ✅ Patient date processing completed successfully
[05:40:25] ✅    ✅ Date processing completed
[05:40:25] 📊 Processed Patient Data
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:40:25] 🔄 
🔄 Step 4: Extracting order data...
[05:40:27] ℹ️  Order extraction - MRN: '2750591'
[05:40:27] ℹ️  Order extraction - Sex: 'FEMALE'
[05:40:27] ℹ️  Order extraction - Service Line: ''
[05:40:27] ℹ️  Order extraction - Payer Source: ''
[05:40:27] ✅ Order data extraction completed successfully
[05:40:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:40:27] ℹ️  Using MRN from patient data: '2750591' over '2750591'
[05:40:27] ℹ️  Using service line from patient data: 'RN'
[05:40:27] ✅ Patient name cross-validation successful
[05:40:27] ✅    ✅ Data merged successfully
[05:40:29] ✅    ✅ Order data extracted and validated
[05:40:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:40:42] [DOC: 9244455] ✅ Patient exists in API: Valentina Miguel, ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[05:40:42] ✅    ✅ Existing patient found with ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[05:40:42] 🔄 
🔄 Step 6: Pushing order to API...
[05:40:42] [DOC: 9244455] ℹ️  Pushing order via API for patient ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[05:40:44] [DOC: 9244455] ❌ Order push failed with status 201: {"id":"f9d2a250-6b2d-4b31-8f11-f70464577cb6","orderWAVId":"ORD20026","orderNo":"1082196, 1082197","orderDate":"04/15/2025","startOfCare":"04/07/2025","episodeStartDate":"04/07/2025","episodeEndDate":"06/05/2025","documentID":"9244455","mrn":"2750591","patientName":"Miguel,Valentina B","sentToPhysicianDate":"04/16/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6ab7401d-5ff1-4b54-9813-ac77ababb99e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:40:44] ❌    ❌ Failed to push order
[05:40:44] 🔄 
🔄 Step 7: Writing to CSV...
[05:40:44] [DOC: 9244455] ℹ️  Calculated age: 73 from DOB: 11/24/1951
[05:40:44] [DOC: 9244455] ℹ️  Service Line extracted: 'RN'
[05:40:44] [DOC: 9244455] ℹ️  Payer Source extracted: ''
[05:40:44] [DOC: 9244455] ℹ️  Diagnosis codes being written:
[05:40:44] [DOC: 9244455] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:40:44] [DOC: 9244455] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:40:44] [DOC: 9244455] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:40:44] [DOC: 9244455] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:40:44] [DOC: 9244455] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:40:44] [DOC: 9244455] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:40:44] [DOC: 9244455] ✅ Patient data written to CSV: Valentina Miguel | Sex: FEMALE | Age: 73 | Service: RN | Payer:  | MRN: 2750591
[05:40:44] ✅    ✅ Document 9244455 processed and saved successfully
[05:40:44] 🔄 
🔄 Step 8: Saving API details...
[05:40:44] [DOC: 9244455] ℹ️  API push details saved for document 9244455
[05:40:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244453                         ║
================================================================================
[05:40:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:40:44] ℹ️  Date: 04/16/2025
[05:40:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:40:47] [DOC: 9244453] ✅ Text extracted using pdfplumber (21201 chars)
[05:40:47] ✅    ✅ Text extracted using pdfplumber (21201 chars)
[05:40:47] 🔄 
🔄 Step 2: Extracting patient data...
[05:40:50] ℹ️  AI extracted raw sex value: 'F'
[05:40:50] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[05:40:50] ℹ️  AI extracted payer source: ''
[05:40:50] ℹ️  AI extracted diagnoses:
[05:40:50] ℹ️    - Diagnosis 1: 'Z48.812'
[05:40:50] ℹ️    - Diagnosis 2: 'Z95.810'
[05:40:50] ℹ️    - Diagnosis 3: 'I44.7'
[05:40:50] ℹ️    - Diagnosis 4: 'I42.8'
[05:40:50] ℹ️    - Diagnosis 5: 'E11.40'
[05:40:50] ℹ️    - Diagnosis 6: 'I25.10'
[05:40:50] ℹ️  Final extracted MRN: '2750591'
[05:40:50] ℹ️  Final extracted Sex: 'FEMALE'
[05:40:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[05:40:50] ℹ️  Final extracted Payer Source: ''
[05:40:50] ✅ Patient data extraction completed successfully
[05:40:50] ✅    ✅ Patient data extracted successfully
[05:40:50] 📊 Patient Response
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'Z95.810', 'thirdDiagnosis': 'I44.7', 'fourthDiagnosis': 'I42.8', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I25.10'}]
[05:40:50] ✅    ✅ Patient identified: Valentina Miguel
[05:40:50] ✅    ✅ Patient name validation passed
[05:40:50] 🔄 
🔄 Step 3: Processing patient dates...
[05:40:50] [DOC: 9244453] ℹ️  DOB normalized: 11/24/1951
[05:40:50] [DOC: 9244453] ℹ️  Episode startOfCare normalized: 04/04/2025
[05:40:50] [DOC: 9244453] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:40:50] [DOC: 9244453] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:40:50] [DOC: 9244453] ✅ Patient date processing completed successfully
[05:40:50] ✅    ✅ Date processing completed
[05:40:50] 📊 Processed Patient Data
     └─ patientFName: Valentina
     └─ patientLName: Miguel
     └─ dob: 11/24/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2750591
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'Z95.810', 'thirdDiagnosis': 'I44.7', 'fourthDiagnosis': 'I42.8', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I25.10'}]
[05:40:50] 🔄 
🔄 Step 4: Extracting order data...
[05:40:53] ℹ️  Order extraction - MRN: '2750591'
[05:40:53] ℹ️  Order extraction - Sex: 'FEMALE'
[05:40:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[05:40:53] ℹ️  Order extraction - Payer Source: ''
[05:40:53] ✅ Order data extraction completed successfully
[05:40:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:40:53] ℹ️  Using MRN from patient data: '2750591' over '2750591'
[05:40:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide'
[05:40:53] ✅ Patient name cross-validation successful
[05:40:53] ✅    ✅ Data merged successfully
[05:40:54] ✅    ✅ Order data extracted and validated
[05:40:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:40:54] [DOC: 9244453] ✅ Patient found in local cache: Valentina Miguel, ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[05:40:54] ✅    ✅ Existing patient found with ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[05:40:54] 🔄 
🔄 Step 6: Pushing order to API...
[05:40:54] [DOC: 9244453] ℹ️  Pushing order via API for patient ID: 6ab7401d-5ff1-4b54-9813-ac77ababb99e
[05:40:55] [DOC: 9244453] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13350"}
[05:40:55] ❌    ❌ Failed to push order
[05:40:55] 🔄 
🔄 Step 7: Writing to CSV...
[05:40:55] [DOC: 9244453] ℹ️  Calculated age: 73 from DOB: 11/24/1951
[05:40:55] [DOC: 9244453] ℹ️  Service Line extracted: 'Skilled Nursing, Home Health Aide'
[05:40:55] [DOC: 9244453] ℹ️  Payer Source extracted: ''
[05:40:55] [DOC: 9244453] ℹ️  Diagnosis codes being written:
[05:40:55] [DOC: 9244453] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.812'
[05:40:55] [DOC: 9244453] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z95.810'
[05:40:55] [DOC: 9244453] ℹ️    - Latest_Episode_Thirddiagnosis: 'I44.7'
[05:40:55] [DOC: 9244453] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I42.8'
[05:40:55] [DOC: 9244453] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.40'
[05:40:55] [DOC: 9244453] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.10'
[05:40:55] [DOC: 9244453] ✅ Patient data written to CSV: Valentina Miguel | Sex: FEMALE | Age: 73 | Service: Skilled Nursing, Home Health Aide | Payer:  | MRN: 2750591
[05:40:55] ✅    ✅ Document 9244453 processed and saved successfully
[05:40:55] 🔄 
🔄 Step 8: Saving API details...
[05:40:55] [DOC: 9244453] ℹ️  API push details saved for document 9244453
[05:40:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244446                         ║
================================================================================
[05:40:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:40:55] ℹ️  Date: 04/16/2025
[05:40:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:40:58] [DOC: 9244446] ✅ Text extracted using pdfplumber (16639 chars)
[05:40:58] ✅    ✅ Text extracted using pdfplumber (16639 chars)
[05:40:58] 🔄 
🔄 Step 2: Extracting patient data...
[05:41:02] ℹ️  AI extracted raw sex value: 'F'
[05:41:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:41:02] ℹ️  AI extracted payer source: ''
[05:41:02] ℹ️  AI extracted diagnoses:
[05:41:02] ℹ️    - Diagnosis 1: 'I10'
[05:41:02] ℹ️    - Diagnosis 2: 'D50.9'
[05:41:02] ℹ️    - Diagnosis 3: 'I73.9'
[05:41:02] ℹ️    - Diagnosis 4: 'F41.1'
[05:41:02] ℹ️    - Diagnosis 5: 'F32.A'
[05:41:02] ℹ️    - Diagnosis 6: 'K59.09'
[05:41:02] ℹ️  Final extracted MRN: '2736573'
[05:41:02] ℹ️  Final extracted Sex: 'FEMALE'
[05:41:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:41:02] ℹ️  Final extracted Payer Source: ''
[05:41:02] ✅ Patient data extraction completed successfully
[05:41:02] ✅    ✅ Patient data extracted successfully
[05:41:02] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Meier
     └─ dob: 07/28/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2736573
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'D50.9', 'thirdDiagnosis': 'I73.9', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'K59.09'}]
[05:41:02] ✅    ✅ Patient identified: Jean Meier
[05:41:02] ✅    ✅ Patient name validation passed
[05:41:02] 🔄 
🔄 Step 3: Processing patient dates...
[05:41:02] [DOC: 9244446] ℹ️  DOB normalized: 07/28/1933
[05:41:02] [DOC: 9244446] ℹ️  Episode startOfCare normalized: 04/02/2025
[05:41:02] [DOC: 9244446] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[05:41:02] [DOC: 9244446] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[05:41:02] [DOC: 9244446] ✅ Patient date processing completed successfully
[05:41:02] ✅    ✅ Date processing completed
[05:41:02] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Meier
     └─ dob: 07/28/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2736573
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'D50.9', 'thirdDiagnosis': 'I73.9', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'K59.09'}]
[05:41:02] 🔄 
🔄 Step 4: Extracting order data...
[05:41:05] ℹ️  Order extraction - MRN: '2736573'
[05:41:05] ℹ️  Order extraction - Sex: 'FEMALE'
[05:41:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:41:05] ℹ️  Order extraction - Payer Source: ''
[05:41:05] ✅ Order data extraction completed successfully
[05:41:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:41:05] ℹ️  Using MRN from patient data: '2736573' over '2736573'
[05:41:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:41:05] ✅ Patient name cross-validation successful
[05:41:05] ✅    ✅ Data merged successfully
[05:41:06] ✅    ✅ Order data extracted and validated
[05:41:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:41:06] [DOC: 9244446] ✅ Patient found in local cache: Jean Meier, ID: 0c6c4395-e864-4a7c-9acd-ea611efe610a
[05:41:06] ✅    ✅ Existing patient found with ID: 0c6c4395-e864-4a7c-9acd-ea611efe610a
[05:41:06] 🔄 
🔄 Step 6: Pushing order to API...
[05:41:06] [DOC: 9244446] ℹ️  Pushing order via API for patient ID: 0c6c4395-e864-4a7c-9acd-ea611efe610a
[05:41:07] [DOC: 9244446] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13346"}
[05:41:07] ❌    ❌ Failed to push order
[05:41:07] 🔄 
🔄 Step 7: Writing to CSV...
[05:41:07] [DOC: 9244446] ℹ️  Calculated age: 91 from DOB: 07/28/1933
[05:41:07] [DOC: 9244446] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:41:07] [DOC: 9244446] ℹ️  Payer Source extracted: ''
[05:41:07] [DOC: 9244446] ℹ️  Diagnosis codes being written:
[05:41:07] [DOC: 9244446] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[05:41:07] [DOC: 9244446] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.9'
[05:41:07] [DOC: 9244446] ℹ️    - Latest_Episode_Thirddiagnosis: 'I73.9'
[05:41:07] [DOC: 9244446] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.1'
[05:41:07] [DOC: 9244446] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.A'
[05:41:07] [DOC: 9244446] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.09'
[05:41:07] [DOC: 9244446] ✅ Patient data written to CSV: Jean Meier | Sex: FEMALE | Age: 91 | Service: Skilled Nursing | Payer:  | MRN: 2736573
[05:41:07] ✅    ✅ Document 9244446 processed and saved successfully
[05:41:07] 🔄 
🔄 Step 8: Saving API details...
[05:41:07] [DOC: 9244446] ℹ️  API push details saved for document 9244446
[05:41:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244439                         ║
================================================================================
[05:41:07] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:41:07] ℹ️  Date: 04/16/2025
[05:41:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:41:12] [DOC: 9244439] ✅ Text extracted using pdfplumber (30626 chars)
[05:41:12] ✅    ✅ Text extracted using pdfplumber (30626 chars)
[05:41:12] 🔄 
🔄 Step 2: Extracting patient data...
[05:41:15] ℹ️  AI extracted raw sex value: 'F'
[05:41:15] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:41:15] ℹ️  AI extracted payer source: ''
[05:41:15] ℹ️  AI extracted diagnoses:
[05:41:15] ℹ️    - Diagnosis 1: 'G30.9'
[05:41:15] ℹ️    - Diagnosis 2: 'F41.9'
[05:41:15] ℹ️    - Diagnosis 3: 'F32.9'
[05:41:15] ℹ️    - Diagnosis 4: 'R13.10'
[05:41:15] ℹ️    - Diagnosis 5: 'I48.91'
[05:41:15] ℹ️    - Diagnosis 6: 'I10'
[05:41:15] ℹ️  Final extracted MRN: '3495983'
[05:41:15] ℹ️  Final extracted Sex: 'FEMALE'
[05:41:15] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:41:15] ℹ️  Final extracted Payer Source: ''
[05:41:15] ✅ Patient data extraction completed successfully
[05:41:15] ✅    ✅ Patient data extracted successfully
[05:41:15] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: McGoldrick
     └─ dob: 10/27/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3495983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2024', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F32.9', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I10'}]
[05:41:15] ✅    ✅ Patient identified: Janice McGoldrick
[05:41:15] ✅    ✅ Patient name validation passed
[05:41:15] 🔄 
🔄 Step 3: Processing patient dates...
[05:41:15] [DOC: 9244439] ℹ️  DOB normalized: 10/27/1931
[05:41:15] [DOC: 9244439] ℹ️  Episode startOfCare normalized: 02/16/2024
[05:41:15] [DOC: 9244439] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[05:41:15] [DOC: 9244439] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[05:41:15] [DOC: 9244439] ✅ Patient date processing completed successfully
[05:41:15] ✅    ✅ Date processing completed
[05:41:15] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: McGoldrick
     └─ dob: 10/27/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3495983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/16/2024', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F32.9', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'I10'}]
[05:41:15] 🔄 
🔄 Step 4: Extracting order data...
[05:41:18] ℹ️  Order extraction - MRN: '3495983'
[05:41:18] ℹ️  Order extraction - Sex: 'FEMALE'
[05:41:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:41:18] ℹ️  Order extraction - Payer Source: ''
[05:41:18] ✅ Order data extraction completed successfully
[05:41:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:41:18] ℹ️  Using MRN from patient data: '3495983' over '3495983'
[05:41:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, HHA'
[05:41:18] ✅ Patient name cross-validation successful
[05:41:18] ✅    ✅ Data merged successfully
[05:41:19] ✅    ✅ Order data extracted and validated
[05:41:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:41:24] [DOC: 9244439] ✅ Patient exists in API: Janice McGoldrick, ID: aa0feeb0-ee9f-4c3e-a1da-571cf80975b2
[05:41:24] ✅    ✅ Existing patient found with ID: aa0feeb0-ee9f-4c3e-a1da-571cf80975b2
[05:41:24] 🔄 
🔄 Step 6: Pushing order to API...
[05:41:24] [DOC: 9244439] ℹ️  Pushing order via API for patient ID: aa0feeb0-ee9f-4c3e-a1da-571cf80975b2
[05:41:26] [DOC: 9244439] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13339"}
[05:41:26] ❌    ❌ Failed to push order
[05:41:26] 🔄 
🔄 Step 7: Writing to CSV...
[05:41:26] [DOC: 9244439] ℹ️  Calculated age: 93 from DOB: 10/27/1931
[05:41:26] [DOC: 9244439] ℹ️  Service Line extracted: 'Skilled Nursing, MSW, Clergy, HHA'
[05:41:26] [DOC: 9244439] ℹ️  Payer Source extracted: ''
[05:41:26] [DOC: 9244439] ℹ️  Diagnosis codes being written:
[05:41:26] [DOC: 9244439] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[05:41:26] [DOC: 9244439] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[05:41:26] [DOC: 9244439] ℹ️    - Latest_Episode_Thirddiagnosis: 'F32.9'
[05:41:26] [DOC: 9244439] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R13.10'
[05:41:26] [DOC: 9244439] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[05:41:26] [DOC: 9244439] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[05:41:26] [DOC: 9244439] ✅ Patient data written to CSV: Janice McGoldrick | Sex: FEMALE | Age: 93 | Service: Skilled Nursing, MSW, Clergy, HHA | Payer:  | MRN: 3495983
[05:41:26] ✅    ✅ Document 9244439 processed and saved successfully
[05:41:26] 🔄 
🔄 Step 8: Saving API details...
[05:41:26] [DOC: 9244439] ℹ️  API push details saved for document 9244439
[05:41:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244428                         ║
================================================================================
[05:41:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:41:26] ℹ️  Date: 04/16/2025
[05:41:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:41:27] [DOC: 9244428] ✅ Text extracted using pdfplumber (1674 chars)
[05:41:27] ✅    ✅ Text extracted using pdfplumber (1674 chars)
[05:41:27] 🔄 
🔄 Step 2: Extracting patient data...
[05:41:29] ℹ️  AI extracted raw sex value: 'F'
[05:41:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:41:29] ℹ️  AI extracted payer source: ''
[05:41:29] ℹ️  AI extracted diagnoses:
[05:41:29] ℹ️    - Diagnosis 1: 'None'
[05:41:29] ℹ️    - Diagnosis 2: 'None'
[05:41:29] ℹ️    - Diagnosis 3: 'None'
[05:41:29] ℹ️    - Diagnosis 4: 'None'
[05:41:29] ℹ️    - Diagnosis 5: 'None'
[05:41:29] ℹ️    - Diagnosis 6: 'None'
[05:41:29] ℹ️  Final extracted MRN: '2698090'
[05:41:29] ℹ️  Final extracted Sex: 'FEMALE'
[05:41:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:41:29] ℹ️  Final extracted Payer Source: ''
[05:41:29] ✅ Patient data extraction completed successfully
[05:41:29] ✅    ✅ Patient data extracted successfully
[05:41:29] 📊 Patient Response
     └─ patientFName: Doris
     └─ patientLName: Marsden
     └─ dob: 07/06/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2698090
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:41:29] ✅    ✅ Patient identified: Doris Marsden
[05:41:29] ✅    ✅ Patient name validation passed
[05:41:29] 🔄 
🔄 Step 3: Processing patient dates...
[05:41:29] [DOC: 9244428] ℹ️  DOB normalized: 07/06/1937
[05:41:29] [DOC: 9244428] ✅ Patient date processing completed successfully
[05:41:29] ✅    ✅ Date processing completed
[05:41:29] 📊 Processed Patient Data
     └─ patientFName: Doris
     └─ patientLName: Marsden
     └─ dob: 07/06/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2698090
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[05:41:29] 🔄 
🔄 Step 4: Extracting order data...
[05:41:32] ℹ️  Order extraction - MRN: '2698090'
[05:41:32] ℹ️  Order extraction - Sex: 'FEMALE'
[05:41:32] ℹ️  Order extraction - Service Line: ''
[05:41:32] ℹ️  Order extraction - Payer Source: ''
[05:41:32] ✅ Order data extraction completed successfully
[05:41:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:41:32] ℹ️  Using MRN from patient data: '2698090' over '2698090'
[05:41:32] ℹ️  Using service line from patient data: 'Skilled Nursing'
[05:41:32] ✅ Patient name cross-validation successful
[05:41:32] ✅    ✅ Data merged successfully
[05:41:33] ⚠️     ❌ Skipping - missing episode start date
[05:41:33] [DOC: 9244428] ℹ️  API push details saved for document 9244428
================================================================================
║                        Processing Document ID: 9244425                         ║
================================================================================
[05:41:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:41:33] ℹ️  Date: 04/16/2025
[05:41:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:41:36] [DOC: 9244425] ✅ Text extracted using pdfplumber (21637 chars)
[05:41:36] ✅    ✅ Text extracted using pdfplumber (21637 chars)
[05:41:36] 🔄 
🔄 Step 2: Extracting patient data...
[05:41:39] ℹ️  AI extracted raw sex value: 'Female'
[05:41:39] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[05:41:39] ℹ️  AI extracted payer source: ''
[05:41:39] ℹ️  AI extracted diagnoses:
[05:41:39] ℹ️    - Diagnosis 1: 'I21.4'
[05:41:39] ℹ️    - Diagnosis 2: 'I10'
[05:41:39] ℹ️    - Diagnosis 3: 'I95.1'
[05:41:39] ℹ️    - Diagnosis 4: 'N17.9'
[05:41:39] ℹ️    - Diagnosis 5: 'D50.9'
[05:41:39] ℹ️    - Diagnosis 6: 'E78.5'
[05:41:39] ℹ️  Final extracted MRN: '2698090'
[05:41:39] ℹ️  Final extracted Sex: 'FEMALE'
[05:41:39] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[05:41:39] ℹ️  Final extracted Payer Source: ''
[05:41:39] ✅ Patient data extraction completed successfully
[05:41:39] ✅    ✅ Patient data extracted successfully
[05:41:39] 📊 Patient Response
     └─ patientFName: Doris
     └─ patientLName: Marsden
     └─ dob: 07/06/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2698090
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I95.1', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'E78.5'}]
[05:41:39] ✅    ✅ Patient identified: Doris Marsden
[05:41:39] ✅    ✅ Patient name validation passed
[05:41:39] 🔄 
🔄 Step 3: Processing patient dates...
[05:41:39] [DOC: 9244425] ℹ️  DOB normalized: 07/06/1937
[05:41:39] [DOC: 9244425] ℹ️  Episode startOfCare normalized: 04/02/2025
[05:41:39] [DOC: 9244425] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:41:39] [DOC: 9244425] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:41:39] [DOC: 9244425] ✅ Patient date processing completed successfully
[05:41:39] ✅    ✅ Date processing completed
[05:41:39] 📊 Processed Patient Data
     └─ patientFName: Doris
     └─ patientLName: Marsden
     └─ dob: 07/06/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2698090
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I95.1', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'E78.5'}]
[05:41:39] 🔄 
🔄 Step 4: Extracting order data...
[05:41:42] ℹ️  Order extraction - MRN: '2698090'
[05:41:42] ℹ️  Order extraction - Sex: 'FEMALE'
[05:41:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:41:42] ℹ️  Order extraction - Payer Source: ''
[05:41:42] ✅ Order data extraction completed successfully
[05:41:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:41:42] ℹ️  Using MRN from patient data: '2698090' over '2698090'
[05:41:42] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[05:41:42] ✅ Patient name cross-validation successful
[05:41:42] ✅    ✅ Data merged successfully
[05:41:43] ✅    ✅ Order data extracted and validated
[05:41:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:41:49] [DOC: 9244425] ℹ️  Patient not found in cache or API: Doris Marsden
[05:41:49] [DOC: 9244425] ℹ️  Patient not found, creating new patient via API...
[05:41:49] [DOC: 9244425] ℹ️  Creating patient via API: Doris Marsden
[05:41:51] [DOC: 9244425] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:41:51] ❌    ❌ Failed to create patient
[05:41:51] [DOC: 9244425] ℹ️  API push details saved for document 9244425
================================================================================
║                        Processing Document ID: 9244410                         ║
================================================================================
[05:41:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:41:51] ℹ️  Date: 04/16/2025
[05:41:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:41:53] [DOC: 9244410] ✅ Text extracted using pdfplumber (2445 chars)
[05:41:53] ✅    ✅ Text extracted using pdfplumber (2445 chars)
[05:41:53] 🔄 
🔄 Step 2: Extracting patient data...
[05:41:56] ℹ️  AI extracted raw sex value: 'F'
[05:41:56] ℹ️  AI extracted service line: ''
[05:41:56] ℹ️  AI extracted payer source: ''
[05:41:56] ℹ️  AI extracted diagnoses:
[05:41:56] ℹ️    - Diagnosis 1: ''
[05:41:56] ℹ️    - Diagnosis 2: ''
[05:41:56] ℹ️    - Diagnosis 3: ''
[05:41:56] ℹ️    - Diagnosis 4: ''
[05:41:56] ℹ️    - Diagnosis 5: ''
[05:41:56] ℹ️    - Diagnosis 6: ''
[05:41:56] ℹ️  Final extracted MRN: '2526196'
[05:41:56] ℹ️  Final extracted Sex: 'FEMALE'
[05:41:56] ℹ️  Final extracted Service Line: ''
[05:41:56] ℹ️  Final extracted Payer Source: ''
[05:41:56] ✅ Patient data extraction completed successfully
[05:41:56] ✅    ✅ Patient data extracted successfully
[05:41:56] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Gonsalves
     └─ dob: 09/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2526196
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:41:56] ✅    ✅ Patient identified: Virginia Gonsalves
[05:41:56] ✅    ✅ Patient name validation passed
[05:41:56] 🔄 
🔄 Step 3: Processing patient dates...
[05:41:56] [DOC: 9244410] ℹ️  DOB normalized: 09/08/1936
[05:41:56] [DOC: 9244410] ✅ Patient date processing completed successfully
[05:41:56] ✅    ✅ Date processing completed
[05:41:56] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Gonsalves
     └─ dob: 09/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2526196
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:41:56] 🔄 
🔄 Step 4: Extracting order data...
[05:41:58] ℹ️  Order extraction - MRN: '2526196'
[05:41:58] ℹ️  Order extraction - Sex: 'FEMALE'
[05:41:58] ℹ️  Order extraction - Service Line: ''
[05:41:58] ℹ️  Order extraction - Payer Source: ''
[05:41:58] ✅ Order data extraction completed successfully
[05:41:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:41:58] ℹ️  Using MRN from patient data: '2526196' over '2526196'
[05:41:58] ✅ Patient name cross-validation successful
[05:41:58] ✅    ✅ Data merged successfully
[05:41:59] ⚠️     ❌ Skipping - missing episode start date
[05:41:59] [DOC: 9244410] ℹ️  API push details saved for document 9244410
================================================================================
║                        Processing Document ID: 9244407                         ║
================================================================================
[05:41:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:41:59] ℹ️  Date: 04/16/2025
[05:41:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:42:02] [DOC: 9244407] ✅ Text extracted using pdfplumber (15416 chars)
[05:42:02] ✅    ✅ Text extracted using pdfplumber (15416 chars)
[05:42:02] 🔄 
🔄 Step 2: Extracting patient data...
[05:42:05] ℹ️  AI extracted raw sex value: 'F'
[05:42:05] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[05:42:05] ℹ️  AI extracted payer source: ''
[05:42:05] ℹ️  AI extracted diagnoses:
[05:42:05] ℹ️    - Diagnosis 1: 'I21.4'
[05:42:05] ℹ️    - Diagnosis 2: 'I10'
[05:42:05] ℹ️    - Diagnosis 3: 'E11.9'
[05:42:05] ℹ️    - Diagnosis 4: 'E87.1'
[05:42:05] ℹ️    - Diagnosis 5: 'I65.23'
[05:42:05] ℹ️    - Diagnosis 6: 'R42'
[05:42:05] ℹ️  Final extracted MRN: '2487126'
[05:42:05] ℹ️  Final extracted Sex: 'FEMALE'
[05:42:05] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[05:42:05] ℹ️  Final extracted Payer Source: ''
[05:42:05] ✅ Patient data extraction completed successfully
[05:42:05] ✅    ✅ Patient data extracted successfully
[05:42:05] 📊 Patient Response
     └─ patientFName: Rosa
     └─ patientLName: Franco
     └─ dob: 10/12/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2487126
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'E87.1', 'fifthDiagnosis': 'I65.23', 'sixthDiagnosis': 'R42'}]
[05:42:05] ✅    ✅ Patient identified: Rosa Franco
[05:42:05] ✅    ✅ Patient name validation passed
[05:42:05] 🔄 
🔄 Step 3: Processing patient dates...
[05:42:05] [DOC: 9244407] ℹ️  DOB normalized: 10/12/1947
[05:42:05] [DOC: 9244407] ℹ️  Episode startOfCare normalized: 04/01/2025
[05:42:05] [DOC: 9244407] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:42:05] [DOC: 9244407] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:42:05] [DOC: 9244407] ✅ Patient date processing completed successfully
[05:42:05] ✅    ✅ Date processing completed
[05:42:05] 📊 Processed Patient Data
     └─ patientFName: Rosa
     └─ patientLName: Franco
     └─ dob: 10/12/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2487126
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'E87.1', 'fifthDiagnosis': 'I65.23', 'sixthDiagnosis': 'R42'}]
[05:42:05] 🔄 
🔄 Step 4: Extracting order data...
[05:42:09] ℹ️  Order extraction - MRN: '2487126'
[05:42:09] ℹ️  Order extraction - Sex: 'FEMALE'
[05:42:09] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:42:09] ℹ️  Order extraction - Payer Source: ''
[05:42:09] ✅ Order data extraction completed successfully
[05:42:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:42:09] ℹ️  Using MRN from patient data: '2487126' over '2487126'
[05:42:09] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[05:42:09] ✅ Patient name cross-validation successful
[05:42:09] ✅    ✅ Data merged successfully
[05:42:10] ✅    ✅ Order data extracted and validated
[05:42:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:42:43] [DOC: 9244407] ✅ Patient exists in API: Rosa Franco, ID: aee29f68-d682-474d-a417-09088677366c
[05:42:43] ✅    ✅ Existing patient found with ID: aee29f68-d682-474d-a417-09088677366c
[05:42:43] 🔄 
🔄 Step 6: Pushing order to API...
[05:42:43] [DOC: 9244407] ℹ️  Pushing order via API for patient ID: aee29f68-d682-474d-a417-09088677366c
[05:42:45] [DOC: 9244407] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14094"}
[05:42:45] ❌    ❌ Failed to push order
[05:42:45] 🔄 
🔄 Step 7: Writing to CSV...
[05:42:45] [DOC: 9244407] ℹ️  Calculated age: 77 from DOB: 10/12/1947
[05:42:45] [DOC: 9244407] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[05:42:45] [DOC: 9244407] ℹ️  Payer Source extracted: ''
[05:42:45] [DOC: 9244407] ℹ️  Diagnosis codes being written:
[05:42:45] [DOC: 9244407] ℹ️    - Latest_Episode_Firstdiagnosis: 'I21.4'
[05:42:45] [DOC: 9244407] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[05:42:45] [DOC: 9244407] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[05:42:45] [DOC: 9244407] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E87.1'
[05:42:45] [DOC: 9244407] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I65.23'
[05:42:45] [DOC: 9244407] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R42'
[05:42:45] [DOC: 9244407] ✅ Patient data written to CSV: Rosa Franco | Sex: FEMALE | Age: 77 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 2487126
[05:42:45] ✅    ✅ Document 9244407 processed and saved successfully
[05:42:45] 🔄 
🔄 Step 8: Saving API details...
[05:42:45] [DOC: 9244407] ℹ️  API push details saved for document 9244407
[05:42:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244390                         ║
================================================================================
[05:42:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:42:45] ℹ️  Date: 04/16/2025
[05:42:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:42:48] [DOC: 9244390] ✅ Text extracted using pdfplumber (25887 chars)
[05:42:48] ✅    ✅ Text extracted using pdfplumber (25887 chars)
[05:42:48] 🔄 
🔄 Step 2: Extracting patient data...
[05:42:51] ℹ️  AI extracted raw sex value: 'F'
[05:42:51] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:42:51] ℹ️  AI extracted payer source: ''
[05:42:51] ℹ️  AI extracted diagnoses:
[05:42:51] ℹ️    - Diagnosis 1: 'G31.1'
[05:42:51] ℹ️    - Diagnosis 2: 'F01.50'
[05:42:51] ℹ️    - Diagnosis 3: 'F41.9'
[05:42:51] ℹ️    - Diagnosis 4: 'M62.81'
[05:42:51] ℹ️    - Diagnosis 5: 'R26.81'
[05:42:51] ℹ️    - Diagnosis 6: 'K59.00'
[05:42:51] ℹ️  Final extracted MRN: '2467814'
[05:42:51] ℹ️  Final extracted Sex: 'FEMALE'
[05:42:51] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:42:51] ℹ️  Final extracted Payer Source: ''
[05:42:51] ✅ Patient data extraction completed successfully
[05:42:51] ✅    ✅ Patient data extracted successfully
[05:42:51] 📊 Patient Response
     └─ patientFName: Natalie
     └─ patientLName: Ferreira
     └─ dob: 05/21/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467814
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'F01.50', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'M62.81', 'fifthDiagnosis': 'R26.81', 'sixthDiagnosis': 'K59.00'}]
[05:42:51] ✅    ✅ Patient identified: Natalie Ferreira
[05:42:51] ✅    ✅ Patient name validation passed
[05:42:51] 🔄 
🔄 Step 3: Processing patient dates...
[05:42:51] [DOC: 9244390] ℹ️  DOB normalized: 05/21/1923
[05:42:51] [DOC: 9244390] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[05:42:51] [DOC: 9244390] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[05:42:51] [DOC: 9244390] ✅ Patient date processing completed successfully
[05:42:51] ✅    ✅ Date processing completed
[05:42:51] 📊 Processed Patient Data
     └─ patientFName: Natalie
     └─ patientLName: Ferreira
     └─ dob: 05/21/1923
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2467814
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'F01.50', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'M62.81', 'fifthDiagnosis': 'R26.81', 'sixthDiagnosis': 'K59.00'}]
[05:42:51] 🔄 
🔄 Step 4: Extracting order data...
[05:42:54] ℹ️  Order extraction - MRN: '2467814'
[05:42:54] ℹ️  Order extraction - Sex: 'FEMALE'
[05:42:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[05:42:54] ℹ️  Order extraction - Payer Source: ''
[05:42:54] ✅ Order data extraction completed successfully
[05:42:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:42:54] ℹ️  Using MRN from patient data: '2467814' over '2467814'
[05:42:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, HHA'
[05:42:54] ✅ Patient name cross-validation successful
[05:42:54] ✅    ✅ Data merged successfully
[05:42:55] ✅    ✅ Order data extracted and validated
[05:42:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:43:03] [DOC: 9244390] ✅ Patient exists in API: Natalie Ferreira, ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[05:43:03] ✅    ✅ Existing patient found with ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[05:43:03] 🔄 
🔄 Step 6: Pushing order to API...
[05:43:03] [DOC: 9244390] ℹ️  Pushing order via API for patient ID: 6b2caa28-b014-4962-9fd1-3a569c1b8750
[05:43:04] [DOC: 9244390] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14080"}
[05:43:04] ❌    ❌ Failed to push order
[05:43:04] 🔄 
🔄 Step 7: Writing to CSV...
[05:43:04] [DOC: 9244390] ℹ️  Calculated age: 102 from DOB: 05/21/1923
[05:43:04] [DOC: 9244390] ℹ️  Service Line extracted: 'Skilled Nursing, MSW, Clergy, HHA'
[05:43:04] [DOC: 9244390] ℹ️  Payer Source extracted: ''
[05:43:04] [DOC: 9244390] ℹ️  Diagnosis codes being written:
[05:43:04] [DOC: 9244390] ℹ️    - Latest_Episode_Firstdiagnosis: 'G31.1'
[05:43:04] [DOC: 9244390] ℹ️    - Latest_Episode_Seconddiagnosis: 'F01.50'
[05:43:04] [DOC: 9244390] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[05:43:04] [DOC: 9244390] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M62.81'
[05:43:04] [DOC: 9244390] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R26.81'
[05:43:04] [DOC: 9244390] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.00'
[05:43:04] [DOC: 9244390] ✅ Patient data written to CSV: Natalie Ferreira | Sex: FEMALE | Age: 102 | Service: Skilled Nursing, MSW, Clergy, HHA | Payer:  | MRN: 2467814
[05:43:04] ✅    ✅ Document 9244390 processed and saved successfully
[05:43:04] 🔄 
🔄 Step 8: Saving API details...
[05:43:04] [DOC: 9244390] ℹ️  API push details saved for document 9244390
[05:43:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244351                         ║
================================================================================
[05:43:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:43:04] ℹ️  Date: 04/16/2025
[05:43:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:43:07] [DOC: 9244351] ✅ Text extracted using pdfplumber (20077 chars)
[05:43:07] ✅    ✅ Text extracted using pdfplumber (20077 chars)
[05:43:07] 🔄 
🔄 Step 2: Extracting patient data...
[05:43:11] ℹ️  AI extracted raw sex value: 'F'
[05:43:11] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:43:11] ℹ️  AI extracted payer source: ''
[05:43:11] ℹ️  AI extracted diagnoses:
[05:43:11] ℹ️    - Diagnosis 1: 'S12.100D'
[05:43:11] ℹ️    - Diagnosis 2: 'S09.90XD'
[05:43:11] ℹ️    - Diagnosis 3: 'F10.939'
[05:43:11] ℹ️    - Diagnosis 4: 'W19.XXXD'
[05:43:11] ℹ️    - Diagnosis 5: 'M79.7'
[05:43:11] ℹ️    - Diagnosis 6: 'M54.42'
[05:43:11] ℹ️  Final extracted MRN: '2205530'
[05:43:11] ℹ️  Final extracted Sex: 'FEMALE'
[05:43:11] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:43:11] ℹ️  Final extracted Payer Source: ''
[05:43:11] ✅ Patient data extraction completed successfully
[05:43:11] ✅    ✅ Patient data extracted successfully
[05:43:11] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Austin
     └─ dob: 04/29/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2205530
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'S12.100D', 'secondDiagnosis': 'S09.90XD', 'thirdDiagnosis': 'F10.939', 'fourthDiagnosis': 'W19.XXXD', 'fifthDiagnosis': 'M79.7', 'sixthDiagnosis': 'M54.42'}]
[05:43:11] ✅    ✅ Patient identified: Linda Austin
[05:43:11] ✅    ✅ Patient name validation passed
[05:43:11] 🔄 
🔄 Step 3: Processing patient dates...
[05:43:11] [DOC: 9244351] ℹ️  DOB normalized: 04/29/1945
[05:43:11] [DOC: 9244351] ℹ️  Episode startOfCare normalized: 04/02/2025
[05:43:11] [DOC: 9244351] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:43:11] [DOC: 9244351] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:43:11] [DOC: 9244351] ✅ Patient date processing completed successfully
[05:43:11] ✅    ✅ Date processing completed
[05:43:11] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Austin
     └─ dob: 04/29/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2205530
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'S12.100D', 'secondDiagnosis': 'S09.90XD', 'thirdDiagnosis': 'F10.939', 'fourthDiagnosis': 'W19.XXXD', 'fifthDiagnosis': 'M79.7', 'sixthDiagnosis': 'M54.42'}]
[05:43:11] 🔄 
🔄 Step 4: Extracting order data...
[05:43:13] ℹ️  Order extraction - MRN: '2205530'
[05:43:13] ℹ️  Order extraction - Sex: 'FEMALE'
[05:43:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:43:13] ℹ️  Order extraction - Payer Source: ''
[05:43:13] ✅ Order data extraction completed successfully
[05:43:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:43:13] ℹ️  Using MRN from patient data: '2205530' over '2205530'
[05:43:13] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:43:13] ✅ Patient name cross-validation successful
[05:43:13] ✅    ✅ Data merged successfully
[05:43:14] ✅    ✅ Order data extracted and validated
[05:43:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:43:25] [DOC: 9244351] ✅ Patient exists in API: Linda Austin, ID: ac6788c3-0770-4d3c-9aaa-37d590897be3
[05:43:25] ✅    ✅ Existing patient found with ID: ac6788c3-0770-4d3c-9aaa-37d590897be3
[05:43:25] 🔄 
🔄 Step 6: Pushing order to API...
[05:43:25] [DOC: 9244351] ℹ️  Pushing order via API for patient ID: ac6788c3-0770-4d3c-9aaa-37d590897be3
[05:43:26] [DOC: 9244351] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12971"}
[05:43:26] ❌    ❌ Failed to push order
[05:43:26] 🔄 
🔄 Step 7: Writing to CSV...
[05:43:26] [DOC: 9244351] ℹ️  Calculated age: 80 from DOB: 04/29/1945
[05:43:26] [DOC: 9244351] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:43:26] [DOC: 9244351] ℹ️  Payer Source extracted: ''
[05:43:26] [DOC: 9244351] ℹ️  Diagnosis codes being written:
[05:43:26] [DOC: 9244351] ℹ️    - Latest_Episode_Firstdiagnosis: 'S12.100D'
[05:43:26] [DOC: 9244351] ℹ️    - Latest_Episode_Seconddiagnosis: 'S09.90XD'
[05:43:26] [DOC: 9244351] ℹ️    - Latest_Episode_Thirddiagnosis: 'F10.939'
[05:43:26] [DOC: 9244351] ℹ️    - Latest_Episode_Fourthdiagnosis: 'W19.XXXD'
[05:43:26] [DOC: 9244351] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M79.7'
[05:43:26] [DOC: 9244351] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.42'
[05:43:26] [DOC: 9244351] ✅ Patient data written to CSV: Linda Austin | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2205530
[05:43:26] ✅    ✅ Document 9244351 processed and saved successfully
[05:43:26] 🔄 
🔄 Step 8: Saving API details...
[05:43:26] [DOC: 9244351] ℹ️  API push details saved for document 9244351
[05:43:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9244118                         ║
================================================================================
[05:43:26] ℹ️  Agency: AccentCare Fall River
[05:43:26] ℹ️  Date: 04/16/2025
[05:43:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:43:39] [DOC: 9244118] ✅ Text extracted using pdfplumber (24275 chars)
[05:43:39] ✅    ✅ Text extracted using pdfplumber (24275 chars)
[05:43:39] 🔄 
🔄 Step 2: Extracting patient data...
[05:43:43] ℹ️  AI extracted raw sex value: 'F'
[05:43:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:43:43] ℹ️  AI extracted payer source: ''
[05:43:43] ℹ️  AI extracted diagnoses:
[05:43:43] ℹ️    - Diagnosis 1: 'N10'
[05:43:43] ℹ️    - Diagnosis 2: 'N31.9'
[05:43:43] ℹ️    - Diagnosis 3: 'C83.30'
[05:43:43] ℹ️    - Diagnosis 4: 'D63.0'
[05:43:43] ℹ️    - Diagnosis 5: 'Z45.2'
[05:43:43] ℹ️    - Diagnosis 6: 'I10'
[05:43:43] ℹ️  Final extracted MRN: 'C0200117976701'
[05:43:43] ℹ️  Final extracted Sex: 'FEMALE'
[05:43:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:43:43] ℹ️  Final extracted Payer Source: ''
[05:43:43] ✅ Patient data extraction completed successfully
[05:43:43] ✅    ✅ Patient data extracted successfully
[05:43:43] 📊 Patient Response
     └─ patientFName: LISA
     └─ patientLName: MEDEIROS
     └─ dob: 11/03/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200117976701
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/25/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': None, 'firstDiagnosis': 'N10', 'secondDiagnosis': 'N31.9', 'thirdDiagnosis': 'C83.30', 'fourthDiagnosis': 'D63.0', 'fifthDiagnosis': 'Z45.2', 'sixthDiagnosis': 'I10'}]
[05:43:43] ✅    ✅ Patient identified: LISA MEDEIROS
[05:43:43] ✅    ✅ Patient name validation passed
[05:43:43] 🔄 
🔄 Step 3: Processing patient dates...
[05:43:43] [DOC: 9244118] ℹ️  DOB normalized: 11/03/1967
[05:43:43] [DOC: 9244118] ℹ️  Episode startOfCare normalized: 01/25/2025
[05:43:43] [DOC: 9244118] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[05:43:43] [DOC: 9244118] ✅ Patient date processing completed successfully
[05:43:43] ✅    ✅ Date processing completed
[05:43:43] 📊 Processed Patient Data
     └─ patientFName: LISA
     └─ patientLName: MEDEIROS
     └─ dob: 11/03/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200117976701
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/25/2025', 'startOfEpisode': '04/13/2025', 'firstDiagnosis': 'N10', 'secondDiagnosis': 'N31.9', 'thirdDiagnosis': 'C83.30', 'fourthDiagnosis': 'D63.0', 'fifthDiagnosis': 'Z45.2', 'sixthDiagnosis': 'I10'}]
[05:43:43] 🔄 
🔄 Step 4: Extracting order data...
[05:43:46] ℹ️  Order extraction - MRN: 'C0200117976701'
[05:43:46] ℹ️  Order extraction - Sex: 'FEMALE'
[05:43:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:43:46] ℹ️  Order extraction - Payer Source: ''
[05:43:46] ✅ Order data extraction completed successfully
[05:43:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:43:46] ℹ️  Using MRN from patient data: 'C0200117976701' over 'C0200117976701'
[05:43:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:43:46] ✅ Patient name cross-validation successful
[05:43:46] ✅    ✅ Data merged successfully
[05:43:47] ✅    ✅ Order data extracted and validated
[05:43:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:43:53] [DOC: 9244118] ℹ️  Patient not found in cache or API: LISA MEDEIROS
[05:43:53] [DOC: 9244118] ℹ️  Patient not found, creating new patient via API...
[05:43:53] [DOC: 9244118] ℹ️  Creating patient via API: LISA MEDEIROS
[05:43:54] [DOC: 9244118] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:43:54] ❌    ❌ Failed to create patient
[05:43:54] [DOC: 9244118] ℹ️  API push details saved for document 9244118
================================================================================
║                        Processing Document ID: 9244025                         ║
================================================================================
[05:43:54] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[05:43:54] ℹ️  Date: 04/16/2025
[05:43:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:43:56] [DOC: 9244025] ✅ Text extracted using pdfplumber (1851 chars)
[05:43:56] ✅    ✅ Text extracted using pdfplumber (1851 chars)
[05:43:56] 🔄 
🔄 Step 2: Extracting patient data...
[05:43:59] ℹ️  AI extracted raw sex value: 'M'
[05:43:59] ℹ️  AI extracted service line: 'HHA'
[05:43:59] ℹ️  AI extracted payer source: 'Medicaid/MA'
[05:43:59] ℹ️  AI extracted diagnoses:
[05:43:59] ℹ️    - Diagnosis 1: ''
[05:43:59] ℹ️    - Diagnosis 2: ''
[05:43:59] ℹ️    - Diagnosis 3: ''
[05:43:59] ℹ️    - Diagnosis 4: ''
[05:43:59] ℹ️    - Diagnosis 5: ''
[05:43:59] ℹ️    - Diagnosis 6: ''
[05:43:59] ℹ️  Final extracted MRN: '879'
[05:43:59] ℹ️  Final extracted Sex: 'MALE'
[05:43:59] ℹ️  Final extracted Service Line: 'HHA'
[05:43:59] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[05:43:59] ✅ Patient data extraction completed successfully
[05:43:59] ✅    ✅ Patient data extracted successfully
[05:43:59] 📊 Patient Response
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:43:59] ✅    ✅ Patient identified: Sean McCarthy
[05:43:59] ✅    ✅ Patient name validation passed
[05:43:59] 🔄 
🔄 Step 3: Processing patient dates...
[05:43:59] [DOC: 9244025] ℹ️  DOB normalized: 09/16/1969
[05:43:59] [DOC: 9244025] ℹ️  Episode startOfCare normalized: 03/30/2024
[05:43:59] [DOC: 9244025] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[05:43:59] [DOC: 9244025] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[05:43:59] [DOC: 9244025] ✅ Patient date processing completed successfully
[05:43:59] ✅    ✅ Date processing completed
[05:43:59] 📊 Processed Patient Data
     └─ patientFName: Sean
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:43:59] 🔄 
🔄 Step 4: Extracting order data...
[05:44:02] ℹ️  Order extraction - MRN: '879'
[05:44:02] ℹ️  Order extraction - Sex: 'MALE'
[05:44:02] ℹ️  Order extraction - Service Line: 'HHA'
[05:44:02] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[05:44:02] ✅ Order data extraction completed successfully
[05:44:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:44:02] ℹ️  Using MRN from patient data: '879' over '879'
[05:44:02] ℹ️  Service line consistent in both sources: 'HHA'
[05:44:02] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[05:44:02] ✅ Patient name cross-validation successful
[05:44:02] ✅    ✅ Data merged successfully
[05:44:03] ✅    ✅ Order data extracted and validated
[05:44:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:44:03] [DOC: 9244025] ✅ Patient found in local cache: Sean McCarthy, ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[05:44:03] ✅    ✅ Existing patient found with ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[05:44:03] 🔄 
🔄 Step 6: Pushing order to API...
[05:44:03] [DOC: 9244025] ℹ️  Pushing order via API for patient ID: 794ee6f3-c2e9-44a3-b06e-882af702b6d8
[05:44:04] [DOC: 9244025] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14049"}
[05:44:04] ❌    ❌ Failed to push order
[05:44:04] 🔄 
🔄 Step 7: Writing to CSV...
[05:44:04] [DOC: 9244025] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[05:44:04] [DOC: 9244025] ℹ️  Service Line extracted: 'HHA'
[05:44:04] [DOC: 9244025] ℹ️  Payer Source extracted: 'Medicaid/MA'
[05:44:04] [DOC: 9244025] ℹ️  Diagnosis codes being written:
[05:44:04] [DOC: 9244025] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:44:04] [DOC: 9244025] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:44:04] [DOC: 9244025] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:44:04] [DOC: 9244025] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:44:04] [DOC: 9244025] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:44:04] [DOC: 9244025] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:44:04] [DOC: 9244025] ✅ Patient data written to CSV: Sean McCarthy | Sex: MALE | Age: 55 | Service: HHA | Payer: Medicaid/MA | MRN: 879
[05:44:04] ✅    ✅ Document 9244025 processed and saved successfully
[05:44:04] 🔄 
🔄 Step 8: Saving API details...
[05:44:04] [DOC: 9244025] ℹ️  API push details saved for document 9244025
[05:44:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9243655                         ║
================================================================================
[05:44:04] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[05:44:04] ℹ️  Date: 04/16/2025
[05:44:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:44:08] [DOC: 9243655] ✅ Text extracted using pdfplumber (6768 chars)
[05:44:08] ✅    ✅ Text extracted using pdfplumber (6768 chars)
[05:44:08] 🔄 
🔄 Step 2: Extracting patient data...
[05:44:11] ℹ️  AI extracted raw sex value: 'F'
[05:44:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:44:11] ℹ️  AI extracted payer source: ''
[05:44:11] ℹ️  AI extracted diagnoses:
[05:44:11] ℹ️    - Diagnosis 1: 'E11.9'
[05:44:11] ℹ️    - Diagnosis 2: 'I11.0'
[05:44:11] ℹ️    - Diagnosis 3: 'I50.32'
[05:44:11] ℹ️    - Diagnosis 4: 'F79'
[05:44:11] ℹ️    - Diagnosis 5: 'L40.9'
[05:44:11] ℹ️    - Diagnosis 6: 'E66.9'
[05:44:11] ℹ️  Final extracted MRN: '473'
[05:44:11] ℹ️  Final extracted Sex: 'FEMALE'
[05:44:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:44:11] ℹ️  Final extracted Payer Source: ''
[05:44:11] ✅ Patient data extraction completed successfully
[05:44:11] ✅    ✅ Patient data extracted successfully
[05:44:11] 📊 Patient Response
     └─ patientFName: Gloria J
     └─ patientLName: Cromwell
     └─ dob: 11/10/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 473
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 016562422
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/27/2017', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'F79', 'fifthDiagnosis': 'L40.9', 'sixthDiagnosis': 'E66.9'}]
[05:44:11] ✅    ✅ Patient identified: Gloria J Cromwell
[05:44:11] ✅    ✅ Patient name validation passed
[05:44:11] 🔄 
🔄 Step 3: Processing patient dates...
[05:44:11] [DOC: 9243655] ℹ️  DOB normalized: 11/10/1953
[05:44:11] [DOC: 9243655] ℹ️  Episode startOfCare normalized: 07/27/2017
[05:44:11] [DOC: 9243655] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[05:44:11] [DOC: 9243655] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[05:44:11] [DOC: 9243655] ✅ Patient date processing completed successfully
[05:44:11] ✅    ✅ Date processing completed
[05:44:11] 📊 Processed Patient Data
     └─ patientFName: Gloria J
     └─ patientLName: Cromwell
     └─ dob: 11/10/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 473
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 016562422
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/27/2017', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'F79', 'fifthDiagnosis': 'L40.9', 'sixthDiagnosis': 'E66.9'}]
[05:44:11] 🔄 
🔄 Step 4: Extracting order data...
[05:44:14] ℹ️  Order extraction - MRN: '227504'
[05:44:14] ℹ️  Order extraction - Sex: 'FEMALE'
[05:44:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[05:44:14] ℹ️  Order extraction - Payer Source: ''
[05:44:14] ✅ Order data extraction completed successfully
[05:44:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:44:14] ℹ️  Using longer MRN from order data: '227504' over '473'
[05:44:14] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT' = 'PT, Skilled Nursing'
[05:44:14] ✅ Patient name cross-validation successful
[05:44:14] ✅    ✅ Data merged successfully
[05:44:15] ✅    ✅ Order data extracted and validated
[05:44:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:44:34] [DOC: 9243655] ✅ Patient exists in API: Gloria J Cromwell, ID: 6c42ef2f-7abb-4100-98c9-b52e27106fb7
[05:44:34] ✅    ✅ Existing patient found with ID: 6c42ef2f-7abb-4100-98c9-b52e27106fb7
[05:44:34] 🔄 
🔄 Step 6: Pushing order to API...
[05:44:34] [DOC: 9243655] ℹ️  Pushing order via API for patient ID: 6c42ef2f-7abb-4100-98c9-b52e27106fb7
[05:44:36] [DOC: 9243655] ❌ Order push failed with status 201: {"id":"c82d8c37-ac01-40ce-b114-e7e0e8279c48","orderWAVId":"ORD20027","orderNo":"473","orderDate":"04/11/2025","startOfCare":"07/27/2017","episodeStartDate":"04/16/2025","episodeEndDate":"06/14/2025","documentID":"9243655","mrn":"227504","patientName":"Cromwell, Gloria J","sentToPhysicianDate":"04/16/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6c42ef2f-7abb-4100-98c9-b52e27106fb7","companyId":"0f46ebbe-720c-4abb-8809-892864387620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:44:36] ❌    ❌ Failed to push order
[05:44:36] 🔄 
🔄 Step 7: Writing to CSV...
[05:44:36] [DOC: 9243655] ℹ️  Calculated age: 71 from DOB: 11/10/1953
[05:44:36] [DOC: 9243655] ℹ️  Service Line extracted: 'PT, Skilled Nursing'
[05:44:36] [DOC: 9243655] ℹ️  Payer Source extracted: ''
[05:44:36] [DOC: 9243655] ℹ️  Diagnosis codes being written:
[05:44:36] [DOC: 9243655] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[05:44:36] [DOC: 9243655] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[05:44:36] [DOC: 9243655] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[05:44:36] [DOC: 9243655] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F79'
[05:44:36] [DOC: 9243655] ℹ️    - Latest_Episode_Fifthdiagnosis: 'L40.9'
[05:44:36] [DOC: 9243655] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.9'
[05:44:36] [DOC: 9243655] ✅ Patient data written to CSV: Gloria J Cromwell | Sex: FEMALE | Age: 71 | Service: PT, Skilled Nursing | Payer:  | MRN: 227504
[05:44:36] ✅    ✅ Document 9243655 processed and saved successfully
[05:44:36] 🔄 
🔄 Step 8: Saving API details...
[05:44:36] [DOC: 9243655] ℹ️  API push details saved for document 9243655
[05:44:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9243633                         ║
================================================================================
[05:44:36] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[05:44:36] ℹ️  Date: 04/16/2025
[05:44:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:44:39] [DOC: 9243633] ✅ Text extracted using pdfplumber (7462 chars)
[05:44:39] ✅    ✅ Text extracted using pdfplumber (7462 chars)
[05:44:39] 🔄 
🔄 Step 2: Extracting patient data...
[05:44:42] ℹ️  AI extracted raw sex value: 'F'
[05:44:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:44:42] ℹ️  AI extracted payer source: 'None'
[05:44:42] ℹ️  AI extracted diagnoses:
[05:44:42] ℹ️    - Diagnosis 1: 'F20.0'
[05:44:42] ℹ️    - Diagnosis 2: 'F31.31'
[05:44:42] ℹ️    - Diagnosis 3: 'F41.9'
[05:44:42] ℹ️    - Diagnosis 4: 'F43.10'
[05:44:42] ℹ️    - Diagnosis 5: 'E11.22'
[05:44:42] ℹ️    - Diagnosis 6: 'I13.0'
[05:44:42] ℹ️  Final extracted MRN: '25'
[05:44:42] ℹ️  Final extracted Sex: 'FEMALE'
[05:44:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:44:42] ℹ️  Final extracted Payer Source: ''
[05:44:42] ✅ Patient data extraction completed successfully
[05:44:42] ✅    ✅ Patient data extracted successfully
[05:44:42] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Blake
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/31/2010', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': 'F31.31', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F43.10', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'I13.0'}]
[05:44:42] ✅    ✅ Patient identified: Patricia Blake
[05:44:42] ✅    ✅ Patient name validation passed
[05:44:42] 🔄 
🔄 Step 3: Processing patient dates...
[05:44:42] [DOC: 9243633] ℹ️  DOB normalized: 07/06/1953
[05:44:42] [DOC: 9243633] ℹ️  Episode startOfCare normalized: 08/31/2010
[05:44:42] [DOC: 9243633] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[05:44:42] [DOC: 9243633] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[05:44:42] [DOC: 9243633] ✅ Patient date processing completed successfully
[05:44:42] ✅    ✅ Date processing completed
[05:44:42] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Blake
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25
     └─ billingProvider: Home Health Care, LLC
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/31/2010', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': 'F31.31', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'F43.10', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'I13.0'}]
[05:44:42] 🔄 
🔄 Step 4: Extracting order data...
[05:44:45] ℹ️  Order extraction - MRN: '25'
[05:44:45] ℹ️  Order extraction - Sex: 'FEMALE'
[05:44:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:44:45] ℹ️  Order extraction - Payer Source: ''
[05:44:45] ✅ Order data extraction completed successfully
[05:44:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:44:45] ℹ️  Using MRN from patient data: '25' over '25'
[05:44:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:44:45] ✅ Patient name cross-validation successful
[05:44:45] ✅    ✅ Data merged successfully
[05:44:46] ✅    ✅ Order data extracted and validated
[05:44:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:44:46] [DOC: 9243633] ✅ Patient found in local cache: Patricia Blake, ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[05:44:46] ✅    ✅ Existing patient found with ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[05:44:46] 🔄 
🔄 Step 6: Pushing order to API...
[05:44:46] [DOC: 9243633] ℹ️  Pushing order via API for patient ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[05:44:48] [DOC: 9243633] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:44:48] ❌    ❌ Failed to push order
[05:44:48] 🔄 
🔄 Step 7: Writing to CSV...
[05:44:48] [DOC: 9243633] ℹ️  Calculated age: 71 from DOB: 07/06/1953
[05:44:48] [DOC: 9243633] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:44:48] [DOC: 9243633] ℹ️  Payer Source extracted: ''
[05:44:48] [DOC: 9243633] ℹ️  Diagnosis codes being written:
[05:44:48] [DOC: 9243633] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.0'
[05:44:48] [DOC: 9243633] ℹ️    - Latest_Episode_Seconddiagnosis: 'F31.31'
[05:44:48] [DOC: 9243633] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[05:44:48] [DOC: 9243633] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F43.10'
[05:44:48] [DOC: 9243633] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[05:44:48] [DOC: 9243633] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I13.0'
[05:44:48] [DOC: 9243633] ✅ Patient data written to CSV: Patricia Blake | Sex: FEMALE | Age: 71 | Service: Skilled Nursing | Payer:  | MRN: 25
[05:44:48] ✅    ✅ Document 9243633 processed and saved successfully
[05:44:48] 🔄 
🔄 Step 8: Saving API details...
[05:44:48] [DOC: 9243633] ℹ️  API push details saved for document 9243633
[05:44:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9243085                         ║
================================================================================
[05:44:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:44:48] ℹ️  Date: 04/16/2025
[05:44:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:44:49] [DOC: 9243085] ✅ Text extracted using pdfplumber (1592 chars)
[05:44:49] ✅    ✅ Text extracted using pdfplumber (1592 chars)
[05:44:49] 🔄 
🔄 Step 2: Extracting patient data...
[05:44:52] ℹ️  AI extracted raw sex value: 'F'
[05:44:52] ℹ️  AI extracted service line: 'Physical Therapy'
[05:44:52] ℹ️  AI extracted payer source: ''
[05:44:52] ℹ️  AI extracted diagnoses:
[05:44:52] ℹ️    - Diagnosis 1: ''
[05:44:52] ℹ️    - Diagnosis 2: ''
[05:44:52] ℹ️    - Diagnosis 3: ''
[05:44:52] ℹ️    - Diagnosis 4: ''
[05:44:52] ℹ️    - Diagnosis 5: ''
[05:44:52] ℹ️    - Diagnosis 6: ''
[05:44:52] ℹ️  Final extracted MRN: '3052261'
[05:44:52] ℹ️  Final extracted Sex: 'FEMALE'
[05:44:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:44:52] ℹ️  Final extracted Payer Source: ''
[05:44:52] ✅ Patient data extraction completed successfully
[05:44:52] ✅    ✅ Patient data extracted successfully
[05:44:52] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:44:52] ✅    ✅ Patient identified: Donna Trott
[05:44:52] ✅    ✅ Patient name validation passed
[05:44:52] 🔄 
🔄 Step 3: Processing patient dates...
[05:44:52] [DOC: 9243085] ℹ️  DOB normalized: 04/22/1943
[05:44:52] [DOC: 9243085] ✅ Patient date processing completed successfully
[05:44:52] ✅    ✅ Date processing completed
[05:44:52] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:44:52] 🔄 
🔄 Step 4: Extracting order data...
[05:44:54] ℹ️  Order extraction - MRN: '3052261'
[05:44:54] ℹ️  Order extraction - Sex: 'FEMALE'
[05:44:54] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:44:54] ℹ️  Order extraction - Payer Source: ''
[05:44:54] ✅ Order data extraction completed successfully
[05:44:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:44:54] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[05:44:54] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:44:54] ✅ Patient name cross-validation successful
[05:44:54] ✅    ✅ Data merged successfully
[05:44:55] ✅    ✅ Order data extracted and validated
[05:44:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:44:55] [DOC: 9243085] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[05:44:55] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[05:44:55] 🔄 
🔄 Step 6: Pushing order to API...
[05:44:55] [DOC: 9243085] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[05:44:56] [DOC: 9243085] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14596"}
[05:44:56] ❌    ❌ Failed to push order
[05:44:56] 🔄 
🔄 Step 7: Writing to CSV...
[05:44:56] [DOC: 9243085] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[05:44:56] [DOC: 9243085] ℹ️  Service Line extracted: 'Physical Therapy'
[05:44:56] [DOC: 9243085] ℹ️  Payer Source extracted: ''
[05:44:56] [DOC: 9243085] ℹ️  Diagnosis codes being written:
[05:44:56] [DOC: 9243085] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:44:56] [DOC: 9243085] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:44:56] [DOC: 9243085] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:44:56] [DOC: 9243085] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:44:56] [DOC: 9243085] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:44:56] [DOC: 9243085] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:44:56] [DOC: 9243085] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Physical Therapy | Payer:  | MRN: 3052261
[05:44:56] ✅    ✅ Document 9243085 processed and saved successfully
[05:44:56] 🔄 
🔄 Step 8: Saving API details...
[05:44:56] [DOC: 9243085] ℹ️  API push details saved for document 9243085
[05:44:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9243029                         ║
================================================================================
[05:44:56] ℹ️  Agency: Visiting Rehab & Nursing Services
[05:44:56] ℹ️  Date: 04/16/2025
[05:44:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:45:00] [DOC: 9243029] ✅ Text extracted using pdfplumber (52427 chars)
[05:45:00] ✅    ✅ Text extracted using pdfplumber (52427 chars)
[05:45:00] 🔄 
🔄 Step 2: Extracting patient data...
[05:45:04] ℹ️  AI extracted raw sex value: 'None'
[05:45:04] ℹ️  AI extracted service line: 'None'
[05:45:04] ℹ️  AI extracted payer source: 'None'
[05:45:04] ℹ️  AI extracted diagnoses:
[05:45:04] ℹ️    - Diagnosis 1: ''
[05:45:04] ℹ️    - Diagnosis 2: ''
[05:45:04] ℹ️    - Diagnosis 3: ''
[05:45:04] ℹ️    - Diagnosis 4: ''
[05:45:04] ℹ️    - Diagnosis 5: ''
[05:45:04] ℹ️    - Diagnosis 6: ''
[05:45:04] ℹ️  Final extracted MRN: ''
[05:45:04] ℹ️  Final extracted Sex: ''
[05:45:04] ℹ️  Final extracted Service Line: ''
[05:45:04] ℹ️  Final extracted Payer Source: ''
[05:45:04] ✅ Patient data extraction completed successfully
[05:45:04] ✅    ✅ Patient data extracted successfully
[05:45:04] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[05:45:04] ⚠️     ❌ Insufficient patient data extracted
[05:45:04] [DOC: 9243029] ℹ️  API push details saved for document 9243029
================================================================================
║                        Processing Document ID: 9243014                         ║
================================================================================
[05:45:04] ℹ️  Agency: Visiting Rehab & Nursing Services
[05:45:04] ℹ️  Date: 04/16/2025
[05:45:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:45:14] [DOC: 9243014] ✅ Text extracted using pdfplumber (51200 chars)
[05:45:14] ✅    ✅ Text extracted using pdfplumber (51200 chars)
[05:45:14] 🔄 
🔄 Step 2: Extracting patient data...
[05:45:18] ℹ️  AI extracted raw sex value: ''
[05:45:18] ℹ️  AI extracted service line: ''
[05:45:18] ℹ️  AI extracted payer source: ''
[05:45:18] ℹ️  AI extracted diagnoses:
[05:45:18] ℹ️    - Diagnosis 1: ''
[05:45:18] ℹ️    - Diagnosis 2: ''
[05:45:18] ℹ️    - Diagnosis 3: ''
[05:45:18] ℹ️    - Diagnosis 4: ''
[05:45:18] ℹ️    - Diagnosis 5: ''
[05:45:18] ℹ️    - Diagnosis 6: ''
[05:45:18] ℹ️  Final extracted MRN: ''
[05:45:18] ℹ️  Final extracted Sex: ''
[05:45:18] ℹ️  Final extracted Service Line: ''
[05:45:18] ℹ️  Final extracted Payer Source: ''
[05:45:18] ✅ Patient data extraction completed successfully
[05:45:18] ✅    ✅ Patient data extracted successfully
[05:45:18] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[05:45:18] ⚠️     ❌ Insufficient patient data extracted
[05:45:18] [DOC: 9243014] ℹ️  API push details saved for document 9243014
================================================================================
║                        Processing Document ID: 9242945                         ║
================================================================================
[05:45:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:45:18] ℹ️  Date: 04/16/2025
[05:45:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:45:20] [DOC: 9242945] ✅ Text extracted using pdfplumber (1603 chars)
[05:45:20] ✅    ✅ Text extracted using pdfplumber (1603 chars)
[05:45:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:45:22] ℹ️  AI extracted raw sex value: 'M'
[05:45:22] ℹ️  AI extracted service line: 'Physical Therapy'
[05:45:22] ℹ️  AI extracted payer source: ''
[05:45:22] ℹ️  AI extracted diagnoses:
[05:45:22] ℹ️    - Diagnosis 1: ''
[05:45:22] ℹ️    - Diagnosis 2: ''
[05:45:22] ℹ️    - Diagnosis 3: ''
[05:45:22] ℹ️    - Diagnosis 4: ''
[05:45:22] ℹ️    - Diagnosis 5: ''
[05:45:22] ℹ️    - Diagnosis 6: ''
[05:45:22] ℹ️  Final extracted MRN: '2648815'
[05:45:22] ℹ️  Final extracted Sex: 'MALE'
[05:45:22] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:45:22] ℹ️  Final extracted Payer Source: ''
[05:45:22] ✅ Patient data extraction completed successfully
[05:45:22] ✅    ✅ Patient data extracted successfully
[05:45:22] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:45:22] ✅    ✅ Patient identified: Robert Ledoux
[05:45:22] ✅    ✅ Patient name validation passed
[05:45:22] 🔄 
🔄 Step 3: Processing patient dates...
[05:45:22] [DOC: 9242945] ℹ️  DOB normalized: 04/07/1968
[05:45:22] [DOC: 9242945] ✅ Patient date processing completed successfully
[05:45:22] ✅    ✅ Date processing completed
[05:45:22] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:45:22] 🔄 
🔄 Step 4: Extracting order data...
[05:45:25] ℹ️  Order extraction - MRN: '2648815'
[05:45:25] ℹ️  Order extraction - Sex: 'MALE'
[05:45:25] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:45:25] ℹ️  Order extraction - Payer Source: ''
[05:45:25] ✅ Order data extraction completed successfully
[05:45:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:45:25] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[05:45:25] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:45:25] ✅ Patient name cross-validation successful
[05:45:25] ✅    ✅ Data merged successfully
[05:45:26] ✅    ✅ Order data extracted and validated
[05:45:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:45:32] [DOC: 9242945] ℹ️  Patient not found in cache or API: Robert Ledoux
[05:45:32] [DOC: 9242945] ℹ️  Patient not found, creating new patient via API...
[05:45:32] [DOC: 9242945] ℹ️  Creating patient via API: Robert Ledoux
[05:45:33] [DOC: 9242945] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:45:33] ❌    ❌ Failed to create patient
[05:45:33] [DOC: 9242945] ℹ️  API push details saved for document 9242945
================================================================================
║                        Processing Document ID: 9242942                         ║
================================================================================
[05:45:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:45:33] ℹ️  Date: 04/16/2025
[05:45:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:45:34] [DOC: 9242942] ✅ Text extracted using pdfplumber (1085 chars)
[05:45:34] ✅    ✅ Text extracted using pdfplumber (1085 chars)
[05:45:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:45:37] ℹ️  AI extracted raw sex value: 'F'
[05:45:37] ℹ️  AI extracted service line: 'Medical Social Work'
[05:45:37] ℹ️  AI extracted payer source: ''
[05:45:37] ℹ️  AI extracted diagnoses:
[05:45:37] ℹ️    - Diagnosis 1: ''
[05:45:37] ℹ️    - Diagnosis 2: ''
[05:45:37] ℹ️    - Diagnosis 3: ''
[05:45:37] ℹ️    - Diagnosis 4: ''
[05:45:37] ℹ️    - Diagnosis 5: ''
[05:45:37] ℹ️    - Diagnosis 6: ''
[05:45:37] ℹ️  Final extracted MRN: '2622983'
[05:45:37] ℹ️  Final extracted Sex: 'FEMALE'
[05:45:37] ℹ️  Final extracted Service Line: 'Medical Social Work'
[05:45:37] ℹ️  Final extracted Payer Source: ''
[05:45:37] ✅ Patient data extraction completed successfully
[05:45:37] ✅    ✅ Patient data extracted successfully
[05:45:37] 📊 Patient Response
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:45:37] ✅    ✅ Patient identified: Mary Lou Kobak
[05:45:37] ✅    ✅ Patient name validation passed
[05:45:37] 🔄 
🔄 Step 3: Processing patient dates...
[05:45:37] [DOC: 9242942] ℹ️  DOB normalized: 02/18/1940
[05:45:37] [DOC: 9242942] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[05:45:37] [DOC: 9242942] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[05:45:37] [DOC: 9242942] ✅ Patient date processing completed successfully
[05:45:37] ✅    ✅ Date processing completed
[05:45:37] 📊 Processed Patient Data
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:45:37] 🔄 
🔄 Step 4: Extracting order data...
[05:45:39] ℹ️  Order extraction - MRN: '2622983'
[05:45:39] ℹ️  Order extraction - Sex: 'FEMALE'
[05:45:39] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[05:45:39] ℹ️  Order extraction - Payer Source: ''
[05:45:39] ✅ Order data extraction completed successfully
[05:45:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:45:39] ℹ️  Using MRN from patient data: '2622983' over '2622983'
[05:45:39] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[05:45:39] ✅ Patient name cross-validation successful
[05:45:39] ✅    ✅ Data merged successfully
[05:45:40] ✅    ✅ Order data extracted and validated
[05:45:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:45:40] [DOC: 9242942] ✅ Patient found in local cache: Mary Lou Kobak, ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[05:45:40] ✅    ✅ Existing patient found with ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[05:45:40] 🔄 
🔄 Step 6: Pushing order to API...
[05:45:40] [DOC: 9242942] ℹ️  Pushing order via API for patient ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[05:45:42] [DOC: 9242942] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13106"}
[05:45:42] ❌    ❌ Failed to push order
[05:45:42] 🔄 
🔄 Step 7: Writing to CSV...
[05:45:42] [DOC: 9242942] ℹ️  Calculated age: 85 from DOB: 02/18/1940
[05:45:42] [DOC: 9242942] ℹ️  Service Line extracted: 'Medical Social Work'
[05:45:42] [DOC: 9242942] ℹ️  Payer Source extracted: ''
[05:45:42] [DOC: 9242942] ℹ️  Diagnosis codes being written:
[05:45:42] [DOC: 9242942] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:45:42] [DOC: 9242942] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:45:42] [DOC: 9242942] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:45:42] [DOC: 9242942] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:45:42] [DOC: 9242942] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:45:42] [DOC: 9242942] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:45:42] [DOC: 9242942] ✅ Patient data written to CSV: Mary Lou Kobak | Sex: FEMALE | Age: 85 | Service: Medical Social Work | Payer:  | MRN: 2622983
[05:45:42] ✅    ✅ Document 9242942 processed and saved successfully
[05:45:42] 🔄 
🔄 Step 8: Saving API details...
[05:45:42] [DOC: 9242942] ℹ️  API push details saved for document 9242942
[05:45:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242874                         ║
================================================================================
[05:45:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:45:42] ℹ️  Date: 04/16/2025
[05:45:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:45:43] [DOC: 9242874] ✅ Text extracted using pdfplumber (1146 chars)
[05:45:43] ✅    ✅ Text extracted using pdfplumber (1146 chars)
[05:45:43] 🔄 
🔄 Step 2: Extracting patient data...
[05:45:46] ℹ️  AI extracted raw sex value: 'F'
[05:45:46] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:45:46] ℹ️  AI extracted payer source: ''
[05:45:46] ℹ️  AI extracted diagnoses:
[05:45:46] ℹ️    - Diagnosis 1: 'None'
[05:45:46] ℹ️    - Diagnosis 2: 'None'
[05:45:46] ℹ️    - Diagnosis 3: 'None'
[05:45:46] ℹ️    - Diagnosis 4: 'None'
[05:45:46] ℹ️    - Diagnosis 5: 'None'
[05:45:46] ℹ️    - Diagnosis 6: 'None'
[05:45:46] ℹ️  Final extracted MRN: '2455123'
[05:45:46] ℹ️  Final extracted Sex: 'FEMALE'
[05:45:46] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:45:46] ℹ️  Final extracted Payer Source: ''
[05:45:46] ✅ Patient data extraction completed successfully
[05:45:46] ✅    ✅ Patient data extracted successfully
[05:45:46] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:45:46] ✅    ✅ Patient identified: Donna Faria
[05:45:46] ✅    ✅ Patient name validation passed
[05:45:46] 🔄 
🔄 Step 3: Processing patient dates...
[05:45:46] [DOC: 9242874] ℹ️  DOB normalized: 04/27/1958
[05:45:46] [DOC: 9242874] ✅ Patient date processing completed successfully
[05:45:46] ✅    ✅ Date processing completed
[05:45:46] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[05:45:46] 🔄 
🔄 Step 4: Extracting order data...
[05:45:48] ℹ️  Order extraction - MRN: '2455123'
[05:45:48] ℹ️  Order extraction - Sex: 'FEMALE'
[05:45:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:45:48] ℹ️  Order extraction - Payer Source: ''
[05:45:48] ✅ Order data extraction completed successfully
[05:45:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:45:48] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[05:45:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:45:48] ✅ Patient name cross-validation successful
[05:45:48] ✅    ✅ Data merged successfully
[05:45:49] ✅    ✅ Order data extracted and validated
[05:45:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:45:49] [DOC: 9242874] ✅ Patient found in local cache: Donna Faria, ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[05:45:49] ✅    ✅ Existing patient found with ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[05:45:49] 🔄 
🔄 Step 6: Pushing order to API...
[05:45:49] [DOC: 9242874] ℹ️  Pushing order via API for patient ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[05:45:50] [DOC: 9242874] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14145"}
[05:45:50] ❌    ❌ Failed to push order
[05:45:50] 🔄 
🔄 Step 7: Writing to CSV...
[05:45:50] [DOC: 9242874] ℹ️  Calculated age: 67 from DOB: 04/27/1958
[05:45:50] [DOC: 9242874] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:45:50] [DOC: 9242874] ℹ️  Payer Source extracted: ''
[05:45:50] [DOC: 9242874] ℹ️  Diagnosis codes being written:
[05:45:50] [DOC: 9242874] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:45:50] [DOC: 9242874] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:45:50] [DOC: 9242874] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:45:50] [DOC: 9242874] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:45:50] [DOC: 9242874] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:45:50] [DOC: 9242874] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:45:50] [DOC: 9242874] ✅ Patient data written to CSV: Donna Faria | Sex: FEMALE | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: 2455123
[05:45:50] ✅    ✅ Document 9242874 processed and saved successfully
[05:45:50] 🔄 
🔄 Step 8: Saving API details...
[05:45:50] [DOC: 9242874] ℹ️  API push details saved for document 9242874
[05:45:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242866                         ║
================================================================================
[05:45:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:45:50] ℹ️  Date: 04/16/2025
[05:45:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:45:52] [DOC: 9242866] ✅ Text extracted using pdfplumber (2967 chars)
[05:45:52] ✅    ✅ Text extracted using pdfplumber (2967 chars)
[05:45:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:45:55] ℹ️  AI extracted raw sex value: 'F'
[05:45:55] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:45:55] ℹ️  AI extracted payer source: ''
[05:45:55] ℹ️  AI extracted diagnoses:
[05:45:55] ℹ️    - Diagnosis 1: 'None'
[05:45:55] ℹ️    - Diagnosis 2: 'None'
[05:45:55] ℹ️    - Diagnosis 3: 'None'
[05:45:55] ℹ️    - Diagnosis 4: 'None'
[05:45:55] ℹ️    - Diagnosis 5: 'None'
[05:45:55] ℹ️    - Diagnosis 6: 'None'
[05:45:55] ℹ️  Final extracted MRN: '2391867'
[05:45:55] ℹ️  Final extracted Sex: 'FEMALE'
[05:45:55] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:45:55] ℹ️  Final extracted Payer Source: ''
[05:45:55] ✅ Patient data extraction completed successfully
[05:45:55] ✅    ✅ Patient data extracted successfully
[05:45:55] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Dawson
     └─ dob: 05/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2391867
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:45:55] ✅    ✅ Patient identified: Pearl Dawson
[05:45:55] ✅    ✅ Patient name validation passed
[05:45:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:45:55] [DOC: 9242866] ℹ️  DOB normalized: 05/01/1931
[05:45:55] [DOC: 9242866] ✅ Patient date processing completed successfully
[05:45:55] ✅    ✅ Date processing completed
[05:45:55] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Dawson
     └─ dob: 05/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2391867
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[05:45:55] 🔄 
🔄 Step 4: Extracting order data...
[05:45:57] ℹ️  Order extraction - MRN: '2391867'
[05:45:57] ℹ️  Order extraction - Sex: 'FEMALE'
[05:45:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:45:57] ℹ️  Order extraction - Payer Source: ''
[05:45:57] ✅ Order data extraction completed successfully
[05:45:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:45:57] ℹ️  Using MRN from patient data: '2391867' over '2391867'
[05:45:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[05:45:57] ✅ Patient name cross-validation successful
[05:45:57] ✅    ✅ Data merged successfully
[05:45:59] ✅    ✅ Order data extracted and validated
[05:45:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:46:05] [DOC: 9242866] ℹ️  Patient not found in cache or API: Pearl Dawson
[05:46:05] [DOC: 9242866] ℹ️  Patient not found, creating new patient via API...
[05:46:05] [DOC: 9242866] ℹ️  Creating patient via API: Pearl Dawson
[05:46:06] [DOC: 9242866] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:46:06] ❌    ❌ Failed to create patient
[05:46:06] [DOC: 9242866] ℹ️  API push details saved for document 9242866
================================================================================
║                        Processing Document ID: 9242808                         ║
================================================================================
[05:46:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:46:06] ℹ️  Date: 04/16/2025
[05:46:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:46:07] [DOC: 9242808] ✅ Text extracted using pdfplumber (1101 chars)
[05:46:07] ✅    ✅ Text extracted using pdfplumber (1101 chars)
[05:46:07] 🔄 
🔄 Step 2: Extracting patient data...
[05:46:10] ℹ️  AI extracted raw sex value: 'F'
[05:46:10] ℹ️  AI extracted service line: 'Medical Social Work'
[05:46:10] ℹ️  AI extracted payer source: ''
[05:46:10] ℹ️  AI extracted diagnoses:
[05:46:10] ℹ️    - Diagnosis 1: ''
[05:46:10] ℹ️    - Diagnosis 2: ''
[05:46:10] ℹ️    - Diagnosis 3: ''
[05:46:10] ℹ️    - Diagnosis 4: ''
[05:46:10] ℹ️    - Diagnosis 5: ''
[05:46:10] ℹ️    - Diagnosis 6: ''
[05:46:10] ℹ️  Final extracted MRN: '2345824'
[05:46:10] ℹ️  Final extracted Sex: 'FEMALE'
[05:46:10] ℹ️  Final extracted Service Line: 'Medical Social Work'
[05:46:10] ℹ️  Final extracted Payer Source: ''
[05:46:10] ✅ Patient data extraction completed successfully
[05:46:10] ✅    ✅ Patient data extracted successfully
[05:46:10] 📊 Patient Response
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:46:10] ✅    ✅ Patient identified: Bernadette Constantine
[05:46:10] ✅    ✅ Patient name validation passed
[05:46:10] 🔄 
🔄 Step 3: Processing patient dates...
[05:46:10] [DOC: 9242808] ℹ️  DOB normalized: 11/05/1924
[05:46:10] [DOC: 9242808] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[05:46:10] [DOC: 9242808] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[05:46:10] [DOC: 9242808] ✅ Patient date processing completed successfully
[05:46:10] ✅    ✅ Date processing completed
[05:46:10] 📊 Processed Patient Data
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:46:10] 🔄 
🔄 Step 4: Extracting order data...
[05:46:13] ℹ️  Order extraction - MRN: '2345824'
[05:46:13] ℹ️  Order extraction - Sex: 'FEMALE'
[05:46:13] ℹ️  Order extraction - Service Line: 'Medical Social Work, Psychosocial/EOL support'
[05:46:13] ℹ️  Order extraction - Payer Source: ''
[05:46:13] ✅ Order data extraction completed successfully
[05:46:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:46:13] ℹ️  Using MRN from patient data: '2345824' over '2345824'
[05:46:13] ℹ️  Combined service lines: Patient='Medical Social Work' + Order='Medical Social Work, Psychosocial/EOL support' = 'Medical Social Work, Psychosocial/EOL support'
[05:46:13] ✅ Patient name cross-validation successful
[05:46:13] ✅    ✅ Data merged successfully
[05:46:14] ✅    ✅ Order data extracted and validated
[05:46:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:46:29] [DOC: 9242808] ℹ️  Patient not found in cache or API: Bernadette Constantine
[05:46:29] [DOC: 9242808] ℹ️  Patient not found, creating new patient via API...
[05:46:29] [DOC: 9242808] ℹ️  Creating patient via API: Bernadette Constantine
[05:46:30] [DOC: 9242808] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:46:30] ❌    ❌ Failed to create patient
[05:46:30] [DOC: 9242808] ℹ️  API push details saved for document 9242808
================================================================================
║                        Processing Document ID: 9242798                         ║
================================================================================
[05:46:30] ℹ️  Agency: Compassionate Care Hospice-Taunton
[05:46:30] ℹ️  Date: 04/16/2025
[05:46:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:46:32] [DOC: 9242798] ✅ Text extracted using pdfplumber (1309 chars)
[05:46:32] ✅    ✅ Text extracted using pdfplumber (1297 chars)
[05:46:32] 🔄 
🔄 Step 2: Extracting patient data...
[05:46:35] ℹ️  AI extracted raw sex value: ''
[05:46:35] ℹ️  AI extracted service line: 'Hospice'
[05:46:35] ℹ️  AI extracted payer source: 'Medicare'
[05:46:35] ℹ️  AI extracted diagnoses:
[05:46:35] ℹ️    - Diagnosis 1: ''
[05:46:35] ℹ️    - Diagnosis 2: ''
[05:46:35] ℹ️    - Diagnosis 3: ''
[05:46:35] ℹ️    - Diagnosis 4: ''
[05:46:35] ℹ️    - Diagnosis 5: ''
[05:46:35] ℹ️    - Diagnosis 6: ''
[05:46:35] ℹ️  Final extracted MRN: 'B3700296223202'
[05:46:35] ℹ️  Final extracted Sex: ''
[05:46:35] ℹ️  Final extracted Service Line: 'Hospice'
[05:46:35] ℹ️  Final extracted Payer Source: 'Medicare'
[05:46:35] ✅ Patient data extraction completed successfully
[05:46:35] ✅    ✅ Patient data extracted successfully
[05:46:35] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:46:35] ✅    ✅ Patient identified: MARIA JARDIM
[05:46:35] ✅    ✅ Patient name validation passed
[05:46:35] 🔄 
🔄 Step 3: Processing patient dates...
[05:46:35] [DOC: 9242798] ℹ️  DOB normalized: 05/20/1931
[05:46:35] [DOC: 9242798] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[05:46:35] [DOC: 9242798] ✅ Patient date processing completed successfully
[05:46:35] ✅    ✅ Date processing completed
[05:46:35] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:46:35] 🔄 
🔄 Step 4: Extracting order data...
[05:46:37] ℹ️  Order extraction - MRN: 'B3700296223202'
[05:46:37] ℹ️  Order extraction - Sex: ''
[05:46:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:46:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:46:37] ✅ Order data extraction completed successfully
[05:46:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:46:37] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[05:46:37] ℹ️  Inferred sex as FEMALE from name: MARIA
[05:46:37] ℹ️  Combined service lines: Patient='Hospice' + Order='Skilled Nursing' = 'Hospice, Skilled Nursing'
[05:46:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:46:37] ✅ Patient name cross-validation successful
[05:46:37] ✅    ✅ Data merged successfully
[05:46:39] ✅    ✅ Order data extracted and validated
[05:46:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:46:39] [DOC: 9242798] ✅ Patient found in local cache: MARIA JARDIM, ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[05:46:39] ✅    ✅ Existing patient found with ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[05:46:39] 🔄 
🔄 Step 6: Pushing order to API...
[05:46:39] [DOC: 9242798] ℹ️  Pushing order via API for patient ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[05:46:40] [DOC: 9242798] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13848"}
[05:46:40] ❌    ❌ Failed to push order
[05:46:40] 🔄 
🔄 Step 7: Writing to CSV...
[05:46:40] [DOC: 9242798] ℹ️  Calculated age: 94 from DOB: 05/20/1931
[05:46:40] [DOC: 9242798] ℹ️  Service Line extracted: 'Hospice, Skilled Nursing'
[05:46:40] [DOC: 9242798] ℹ️  Payer Source extracted: 'Medicare'
[05:46:40] [DOC: 9242798] ℹ️  Diagnosis codes being written:
[05:46:40] [DOC: 9242798] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:46:40] [DOC: 9242798] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:46:40] [DOC: 9242798] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:46:40] [DOC: 9242798] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:46:40] [DOC: 9242798] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:46:40] [DOC: 9242798] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:46:40] [DOC: 9242798] ✅ Patient data written to CSV: MARIA JARDIM | Sex: FEMALE | Age: 94 | Service: Hospice, Skilled Nursing | Payer: Medicare | MRN: B3700296223202
[05:46:40] ✅    ✅ Document 9242798 processed and saved successfully
[05:46:40] 🔄 
🔄 Step 8: Saving API details...
[05:46:40] [DOC: 9242798] ℹ️  API push details saved for document 9242798
[05:46:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242714                         ║
================================================================================
[05:46:40] ℹ️  Agency: Fairhaven HH&H
[05:46:40] ℹ️  Date: 04/16/2025
[05:46:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:46:41] [DOC: 9242714] ❌ Critical failure in get_pdf_text: Invalid response format
[05:46:41] ❌ Failed to extract text for Doc ID 9242714
[05:46:41] [DOC: 9242714] ℹ️  API push details saved for document 9242714
================================================================================
║                        Processing Document ID: 9242711                         ║
================================================================================
[05:46:41] ℹ️  Agency: Dartmouth HH
[05:46:41] ℹ️  Date: 04/16/2025
[05:46:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:46:47] [DOC: 9242711] ✅ Text extracted using pdfplumber (16788 chars)
[05:46:47] ✅    ✅ Text extracted using pdfplumber (16776 chars)
[05:46:47] 🔄 
🔄 Step 2: Extracting patient data...
[05:46:50] ℹ️  AI extracted raw sex value: 'F'
[05:46:50] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[05:46:50] ℹ️  AI extracted payer source: ''
[05:46:50] ℹ️  AI extracted diagnoses:
[05:46:50] ℹ️    - Diagnosis 1: 'I10'
[05:46:50] ℹ️    - Diagnosis 2: 'R29.810'
[05:46:50] ℹ️    - Diagnosis 3: 'R47.1'
[05:46:50] ℹ️    - Diagnosis 4: 'E11.9'
[05:46:50] ℹ️    - Diagnosis 5: 'H25.9'
[05:46:50] ℹ️    - Diagnosis 6: 'M17.10'
[05:46:50] ℹ️  Final extracted MRN: '227027'
[05:46:50] ℹ️  Final extracted Sex: 'FEMALE'
[05:46:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[05:46:50] ℹ️  Final extracted Payer Source: ''
[05:46:50] ✅ Patient data extraction completed successfully
[05:46:50] ✅    ✅ Patient data extracted successfully
[05:46:50] 📊 Patient Response
     └─ patientFName: Natalia
     └─ patientLName: Moura
     └─ dob: 10/01/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R29.810', 'thirdDiagnosis': 'R47.1', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'H25.9', 'sixthDiagnosis': 'M17.10'}]
[05:46:50] ✅    ✅ Patient identified: Natalia Moura
[05:46:50] ✅    ✅ Patient name validation passed
[05:46:50] 🔄 
🔄 Step 3: Processing patient dates...
[05:46:50] [DOC: 9242711] ℹ️  DOB normalized: 10/01/1945
[05:46:50] [DOC: 9242711] ℹ️  Episode startOfCare normalized: 04/05/2025
[05:46:50] [DOC: 9242711] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:46:50] [DOC: 9242711] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:46:50] [DOC: 9242711] ✅ Patient date processing completed successfully
[05:46:50] ✅    ✅ Date processing completed
[05:46:50] 📊 Processed Patient Data
     └─ patientFName: Natalia
     └─ patientLName: Moura
     └─ dob: 10/01/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R29.810', 'thirdDiagnosis': 'R47.1', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'H25.9', 'sixthDiagnosis': 'M17.10'}]
[05:46:50] 🔄 
🔄 Step 4: Extracting order data...
[05:46:52] ℹ️  Order extraction - MRN: '6323015'
[05:46:52] ℹ️  Order extraction - Sex: 'FEMALE'
[05:46:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[05:46:52] ℹ️  Order extraction - Payer Source: ''
[05:46:52] ✅ Order data extraction completed successfully
[05:46:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:46:52] ℹ️  Using longer MRN from order data: '6323015' over '227027'
[05:46:52] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[05:46:52] ✅ Patient name cross-validation successful
[05:46:52] ✅    ✅ Data merged successfully
[05:46:53] ✅    ✅ Order data extracted and validated
[05:46:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:47:01] [DOC: 9242711] ℹ️  Patient not found in cache or API: Natalia Moura
[05:47:01] [DOC: 9242711] ℹ️  Patient not found, creating new patient via API...
[05:47:01] [DOC: 9242711] ℹ️  Creating patient via API: Natalia Moura
[05:47:02] [DOC: 9242711] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:47:02] ❌    ❌ Failed to create patient
[05:47:02] [DOC: 9242711] ℹ️  API push details saved for document 9242711
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[05:47:02] ℹ️  Total Processed: 49
[05:47:02] ℹ️  CSV Success: 31
[05:47:02] ℹ️  CSV Errors: 6
[05:47:02] ℹ️  API Success: 0
[05:47:02] ℹ️  API Errors: 43
[05:47:02] ℹ️  CSV Success Rate: 63.3%
[05:47:02] ℹ️  API Success Rate: 0.0%
[05:47:02] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_053247.csv
[05:47:02] ℹ️  API Details File: api_outputs/api_push_details_20250608_053247.csv
================================================================================
║          ============================================================          ║
================================================================================
