================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[17:04:49] ℹ️  CSV Data Extraction & API Push Tool
[17:04:49] ℹ️  
[17:04:49] ℹ️  Features:
[17:04:49] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[17:04:49] ℹ️  - AI-powered patient and order data extraction
[17:04:49] ℹ️  - Enhanced error handling and logging
[17:04:49] ℹ️  - Full API integration (patient creation + order pushing)
[17:04:49] ℹ️  - CSV output with comprehensive patient data
[17:04:49] ℹ️  - Detailed API tracking with remarks for every document
[17:04:49] ℹ️  - Complete audit trail of all processing attempts
[17:04:49] ℹ️  
[17:04:49] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[17:04:49] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_170449.csv
[17:04:49] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_170449.csv
================================================================================
║                        Processing Document ID: 9265732                         ║
================================================================================
[17:04:49] ℹ️  Agency: Dartmouth HH
[17:04:49] ℹ️  Date: 04/29/2025
[17:04:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:04:51] [DOC: 9265732] ✅ Text extracted using pdfplumber (1259 chars)
[17:04:51] ✅    ✅ Text extracted using pdfplumber (1259 chars)
[17:04:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:04:55] ℹ️  AI extracted raw sex value: 'F'
[17:04:55] ℹ️  AI extracted service line: 'RN, LPN'
[17:04:55] ℹ️  AI extracted payer source: 'Medicare'
[17:04:55] ℹ️  AI extracted diagnoses:
[17:04:55] ℹ️    - Diagnosis 1: ''
[17:04:55] ℹ️    - Diagnosis 2: ''
[17:04:55] ℹ️    - Diagnosis 3: ''
[17:04:55] ℹ️    - Diagnosis 4: ''
[17:04:55] ℹ️    - Diagnosis 5: ''
[17:04:55] ℹ️    - Diagnosis 6: ''
[17:04:55] ℹ️  Final extracted MRN: '2502011'
[17:04:55] ℹ️  Final extracted Sex: 'FEMALE'
[17:04:55] ℹ️  Final extracted Service Line: 'RN, LPN'
[17:04:55] ℹ️  Final extracted Payer Source: 'Medicare'
[17:04:55] ✅ Patient data extraction completed successfully
[17:04:55] ✅    ✅ Patient data extracted successfully
[17:04:55] 📊 Patient Response
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:04:55] ✅    ✅ Patient identified: Veronica Cusson
[17:04:55] ✅    ✅ Patient name validation passed
[17:04:55] 🔄 
🔄 Step 3: Processing patient dates...
[17:04:55] [DOC: 9265732] ℹ️  DOB normalized: 08/26/1964
[17:04:55] [DOC: 9265732] ℹ️  Episode startOfCare normalized: 04/02/2025
[17:04:55] [DOC: 9265732] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[17:04:55] [DOC: 9265732] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[17:04:55] [DOC: 9265732] ✅ Patient date processing completed successfully
[17:04:55] ✅    ✅ Date processing completed
[17:04:55] 📊 Processed Patient Data
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:04:55] 🔄 
🔄 Step 4: Extracting order data...
[17:04:57] ℹ️  Order extraction - MRN: ''
[17:04:57] ℹ️  Order extraction - Sex: 'FEMALE'
[17:04:57] ℹ️  Order extraction - Service Line: 'RN, LPN'
[17:04:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:04:57] ✅ Order data extraction completed successfully
[17:04:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:04:57] ℹ️  Using MRN from patient data: '2502011'
[17:04:57] ℹ️  Service line consistent in both sources: 'RN, LPN'
[17:04:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:04:57] ✅ Patient name cross-validation successful
[17:04:57] ✅    ✅ Data merged successfully
[17:04:59] ✅    ✅ Order data extracted and validated
[17:04:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:05] [DOC: 9265732] ℹ️  Patient not found in cache or API: Veronica Cusson
[17:05:05] [DOC: 9265732] ℹ️  Patient not found, creating new patient via API...
[17:05:05] [DOC: 9265732] ℹ️  Creating patient via API: Veronica Cusson
[17:05:07] [DOC: 9265732] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:05:07] ❌    ❌ Failed to create patient
[17:05:07] [DOC: 9265732] ℹ️  API push details saved for document 9265732
================================================================================
║                        Processing Document ID: 9265730                         ║
================================================================================
[17:05:07] ℹ️  Agency: Dartmouth HH
[17:05:07] ℹ️  Date: 04/29/2025
[17:05:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:08] [DOC: 9265730] ✅ Text extracted using pdfplumber (1381 chars)
[17:05:08] ✅    ✅ Text extracted using pdfplumber (1381 chars)
[17:05:08] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:11] ℹ️  AI extracted raw sex value: 'F'
[17:05:11] ℹ️  AI extracted service line: 'HHA'
[17:05:11] ℹ️  AI extracted payer source: 'Medicare'
[17:05:11] ℹ️  AI extracted diagnoses:
[17:05:11] ℹ️    - Diagnosis 1: ''
[17:05:11] ℹ️    - Diagnosis 2: ''
[17:05:11] ℹ️    - Diagnosis 3: ''
[17:05:11] ℹ️    - Diagnosis 4: ''
[17:05:11] ℹ️    - Diagnosis 5: ''
[17:05:11] ℹ️    - Diagnosis 6: ''
[17:05:11] ℹ️  Final extracted MRN: '6222015'
[17:05:11] ℹ️  Final extracted Sex: 'FEMALE'
[17:05:11] ℹ️  Final extracted Service Line: 'HHA'
[17:05:11] ℹ️  Final extracted Payer Source: 'Medicare'
[17:05:11] ✅ Patient data extraction completed successfully
[17:05:11] ✅    ✅ Patient data extracted successfully
[17:05:11] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Vieira
     └─ dob: 10/23/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6222015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:05:11] ✅    ✅ Patient identified: Theresa Vieira
[17:05:11] ✅    ✅ Patient name validation passed
[17:05:11] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:11] [DOC: 9265730] ℹ️  DOB normalized: 10/23/1953
[17:05:11] [DOC: 9265730] ℹ️  Episode startOfCare normalized: 03/20/2025
[17:05:11] [DOC: 9265730] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[17:05:11] [DOC: 9265730] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[17:05:11] [DOC: 9265730] ✅ Patient date processing completed successfully
[17:05:11] ✅    ✅ Date processing completed
[17:05:11] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Vieira
     └─ dob: 10/23/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6222015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:05:11] 🔄 
🔄 Step 4: Extracting order data...
[17:05:13] ℹ️  Order extraction - MRN: ''
[17:05:13] ℹ️  Order extraction - Sex: 'FEMALE'
[17:05:13] ℹ️  Order extraction - Service Line: 'HHA'
[17:05:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:05:13] ✅ Order data extraction completed successfully
[17:05:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:13] ℹ️  Using MRN from patient data: '6222015'
[17:05:13] ℹ️  Service line consistent in both sources: 'HHA'
[17:05:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:05:13] ✅ Patient name cross-validation successful
[17:05:13] ✅    ✅ Data merged successfully
[17:05:15] ✅    ✅ Order data extracted and validated
[17:05:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:15] [DOC: 9265730] ✅ Patient found in local cache: Theresa Vieira, ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[17:05:15] ✅    ✅ Existing patient found with ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[17:05:15] 🔄 
🔄 Step 6: Pushing order to API...
[17:05:15] [DOC: 9265730] ℹ️  Pushing order via API for patient ID: 4bc8ce48-1ad2-40db-8712-9119353a80d2
[17:05:16] [DOC: 9265730] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14258"}
[17:05:16] ❌    ❌ Failed to push order
[17:05:16] 🔄 
🔄 Step 7: Writing to CSV...
[17:05:16] [DOC: 9265730] ℹ️  Calculated age: 71 from DOB: 10/23/1953
[17:05:16] [DOC: 9265730] ℹ️  Service Line extracted: 'HHA'
[17:05:16] [DOC: 9265730] ℹ️  Payer Source extracted: 'Medicare'
[17:05:16] [DOC: 9265730] ℹ️  Diagnosis codes being written:
[17:05:16] [DOC: 9265730] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:05:16] [DOC: 9265730] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:05:16] [DOC: 9265730] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:05:16] [DOC: 9265730] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:05:16] [DOC: 9265730] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:05:16] [DOC: 9265730] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:05:16] [DOC: 9265730] ✅ Patient data written to CSV: Theresa Vieira | Sex: FEMALE | Age: 71 | Service: HHA | Payer: Medicare | MRN: 6222015
[17:05:16] ✅    ✅ Document 9265730 processed and saved successfully
[17:05:16] 🔄 
🔄 Step 8: Saving API details...
[17:05:16] [DOC: 9265730] ℹ️  API push details saved for document 9265730
[17:05:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265729                         ║
================================================================================
[17:05:16] ℹ️  Agency: Dartmouth HH
[17:05:16] ℹ️  Date: 04/29/2025
[17:05:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:18] [DOC: 9265729] ✅ Text extracted using pdfplumber (4359 chars)
[17:05:18] ✅    ✅ Text extracted using pdfplumber (4359 chars)
[17:05:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:20] ℹ️  AI extracted raw sex value: 'F'
[17:05:20] ℹ️  AI extracted service line: 'PT'
[17:05:20] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[17:05:20] ℹ️  AI extracted diagnoses:
[17:05:20] ℹ️    - Diagnosis 1: 'None'
[17:05:20] ℹ️    - Diagnosis 2: 'None'
[17:05:20] ℹ️    - Diagnosis 3: 'None'
[17:05:20] ℹ️    - Diagnosis 4: 'None'
[17:05:20] ℹ️    - Diagnosis 5: 'None'
[17:05:20] ℹ️    - Diagnosis 6: 'None'
[17:05:20] ℹ️  Final extracted MRN: '5711015'
[17:05:20] ℹ️  Final extracted Sex: 'FEMALE'
[17:05:20] ℹ️  Final extracted Service Line: 'PT'
[17:05:20] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[17:05:20] ✅ Patient data extraction completed successfully
[17:05:20] ✅    ✅ Patient data extracted successfully
[17:05:20] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ascensao
     └─ dob: 11/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5711015
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 36 Valentine St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:05:20] ✅    ✅ Patient identified: Maria Ascensao
[17:05:20] ✅    ✅ Patient name validation passed
[17:05:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:20] [DOC: 9265729] ℹ️  DOB normalized: 11/21/1941
[17:05:20] [DOC: 9265729] ℹ️  Episode startOfCare normalized: 03/28/2025
[17:05:20] [DOC: 9265729] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[17:05:20] [DOC: 9265729] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[17:05:20] [DOC: 9265729] ✅ Patient date processing completed successfully
[17:05:20] ✅    ✅ Date processing completed
[17:05:20] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ascensao
     └─ dob: 11/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5711015
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 36 Valentine St Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025'}]
[17:05:20] 🔄 
🔄 Step 4: Extracting order data...
[17:05:23] ℹ️  Order extraction - MRN: ''
[17:05:23] ℹ️  Order extraction - Sex: 'FEMALE'
[17:05:23] ℹ️  Order extraction - Service Line: 'PT'
[17:05:23] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[17:05:23] ✅ Order data extraction completed successfully
[17:05:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:23] ℹ️  Using MRN from patient data: '5711015'
[17:05:23] ℹ️  Service line consistent in both sources: 'PT'
[17:05:23] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[17:05:23] ✅ Patient name cross-validation successful
[17:05:23] ✅    ✅ Data merged successfully
[17:05:24] ✅    ✅ Order data extracted and validated
[17:05:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:24] [DOC: 9265729] ✅ Patient found in local cache: Maria Ascensao, ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[17:05:24] ✅    ✅ Existing patient found with ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[17:05:24] 🔄 
🔄 Step 6: Pushing order to API...
[17:05:24] [DOC: 9265729] ℹ️  Pushing order via API for patient ID: 4aa42de2-0ec1-4cd6-b167-546b5ff1d863
[17:05:25] [DOC: 9265729] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:05:25] ❌    ❌ Failed to push order
[17:05:25] 🔄 
🔄 Step 7: Writing to CSV...
[17:05:25] [DOC: 9265729] ℹ️  Calculated age: 83 from DOB: 11/21/1941
[17:05:25] [DOC: 9265729] ℹ️  Service Line extracted: 'PT'
[17:05:25] [DOC: 9265729] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[17:05:25] [DOC: 9265729] ℹ️  Diagnosis codes being written:
[17:05:25] [DOC: 9265729] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:05:25] [DOC: 9265729] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:05:25] [DOC: 9265729] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:05:25] [DOC: 9265729] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:05:25] [DOC: 9265729] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:05:25] [DOC: 9265729] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:05:25] [DOC: 9265729] ✅ Patient data written to CSV: Maria Ascensao | Sex: FEMALE | Age: 83 | Service: PT | Payer: Tufts Health Plan Medicare Preferred | MRN: 5711015
[17:05:25] ✅    ✅ Document 9265729 processed and saved successfully
[17:05:25] 🔄 
🔄 Step 8: Saving API details...
[17:05:25] [DOC: 9265729] ℹ️  API push details saved for document 9265729
[17:05:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265728                         ║
================================================================================
[17:05:25] ℹ️  Agency: Dartmouth HH
[17:05:25] ℹ️  Date: 04/29/2025
[17:05:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:27] [DOC: 9265728] ✅ Text extracted using pdfplumber (12158 chars)
[17:05:27] ✅    ✅ Text extracted using pdfplumber (12158 chars)
[17:05:27] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:31] ℹ️  AI extracted raw sex value: 'F'
[17:05:31] ℹ️  AI extracted service line: 'PT'
[17:05:31] ℹ️  AI extracted payer source: 'None'
[17:05:31] ℹ️  AI extracted diagnoses:
[17:05:31] ℹ️    - Diagnosis 1: 'Z47.1'
[17:05:31] ℹ️    - Diagnosis 2: 'M25.561'
[17:05:31] ℹ️    - Diagnosis 3: 'M25.562'
[17:05:31] ℹ️    - Diagnosis 4: 'E66.9'
[17:05:31] ℹ️    - Diagnosis 5: 'Z68.34'
[17:05:31] ℹ️    - Diagnosis 6: 'M51.360'
[17:05:31] ℹ️  Final extracted MRN: '227027'
[17:05:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:05:31] ℹ️  Final extracted Service Line: 'PT'
[17:05:31] ℹ️  Final extracted Payer Source: ''
[17:05:31] ✅ Patient data extraction completed successfully
[17:05:31] ✅    ✅ Patient data extracted successfully
[17:05:31] 📊 Patient Response
     └─ patientFName: SaoMarcos
     └─ patientLName: Maria
     └─ dob: 09/25/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M25.561', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.34', 'sixthDiagnosis': 'M51.360'}]
[17:05:31] ✅    ✅ Patient identified: SaoMarcos Maria
[17:05:31] ✅    ✅ Patient name validation passed
[17:05:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:31] [DOC: 9265728] ℹ️  DOB normalized: 09/25/1954
[17:05:31] [DOC: 9265728] ℹ️  Episode startOfCare normalized: 04/19/2025
[17:05:31] [DOC: 9265728] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[17:05:31] [DOC: 9265728] ℹ️  Episode endOfEpisode normalized: 06/17/2025
[17:05:31] [DOC: 9265728] ✅ Patient date processing completed successfully
[17:05:31] ✅    ✅ Date processing completed
[17:05:31] 📊 Processed Patient Data
     └─ patientFName: SaoMarcos
     └─ patientLName: Maria
     └─ dob: 09/25/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M25.561', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'E66.9', 'fifthDiagnosis': 'Z68.34', 'sixthDiagnosis': 'M51.360'}]
[17:05:31] 🔄 
🔄 Step 4: Extracting order data...
[17:05:33] ℹ️  Order extraction - MRN: '6389015'
[17:05:33] ℹ️  Order extraction - Sex: 'FEMALE'
[17:05:33] ℹ️  Order extraction - Service Line: 'PT'
[17:05:33] ℹ️  Order extraction - Payer Source: ''
[17:05:33] ✅ Order data extraction completed successfully
[17:05:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:33] ℹ️  Using longer MRN from order data: '6389015' over '227027'
[17:05:33] ℹ️  Service line consistent in both sources: 'PT'
[17:05:33] ✅ Patient name cross-validation successful
[17:05:33] ✅    ✅ Data merged successfully
[17:05:34] ✅    ✅ Order data extracted and validated
[17:05:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:39] [DOC: 9265728] ℹ️  Patient not found in cache or API: SaoMarcos Maria
[17:05:39] [DOC: 9265728] ℹ️  Patient not found, creating new patient via API...
[17:05:39] [DOC: 9265728] ℹ️  Creating patient via API: SaoMarcos Maria
[17:05:40] [DOC: 9265728] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:05:40] ❌    ❌ Failed to create patient
[17:05:40] [DOC: 9265728] ℹ️  API push details saved for document 9265728
================================================================================
║                        Processing Document ID: 9265725                         ║
================================================================================
[17:05:40] ℹ️  Agency: Dartmouth HH
[17:05:40] ℹ️  Date: 04/29/2025
[17:05:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:42] [DOC: 9265725] ✅ Text extracted using pdfplumber (1238 chars)
[17:05:42] ✅    ✅ Text extracted using pdfplumber (1238 chars)
[17:05:42] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:44] ℹ️  AI extracted raw sex value: 'M'
[17:05:44] ℹ️  AI extracted service line: 'HHA'
[17:05:44] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[17:05:44] ℹ️  AI extracted diagnoses:
[17:05:44] ℹ️    - Diagnosis 1: ''
[17:05:44] ℹ️    - Diagnosis 2: ''
[17:05:44] ℹ️    - Diagnosis 3: ''
[17:05:44] ℹ️    - Diagnosis 4: ''
[17:05:44] ℹ️    - Diagnosis 5: ''
[17:05:44] ℹ️    - Diagnosis 6: ''
[17:05:44] ℹ️  Final extracted MRN: '5879015'
[17:05:44] ℹ️  Final extracted Sex: 'MALE'
[17:05:44] ℹ️  Final extracted Service Line: 'HHA'
[17:05:44] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[17:05:44] ✅ Patient data extraction completed successfully
[17:05:44] ✅    ✅ Patient data extracted successfully
[17:05:44] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:05:44] ✅    ✅ Patient identified: Roger Alves
[17:05:44] ✅    ✅ Patient name validation passed
[17:05:44] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:44] [DOC: 9265725] ℹ️  DOB normalized: 11/12/1943
[17:05:44] [DOC: 9265725] ℹ️  Episode startOfCare normalized: 01/20/2025
[17:05:44] [DOC: 9265725] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[17:05:44] [DOC: 9265725] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[17:05:44] [DOC: 9265725] ✅ Patient date processing completed successfully
[17:05:44] ✅    ✅ Date processing completed
[17:05:44] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:05:44] 🔄 
🔄 Step 4: Extracting order data...
[17:05:47] ℹ️  Order extraction - MRN: '5879015'
[17:05:47] ℹ️  Order extraction - Sex: 'MALE'
[17:05:47] ℹ️  Order extraction - Service Line: ''
[17:05:47] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[17:05:47] ✅ Order data extraction completed successfully
[17:05:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:47] ℹ️  Using MRN from patient data: '5879015' over '5879015'
[17:05:47] ℹ️  Using service line from patient data: 'HHA'
[17:05:47] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[17:05:47] ✅ Patient name cross-validation successful
[17:05:47] ✅    ✅ Data merged successfully
[17:05:48] ✅    ✅ Order data extracted and validated
[17:05:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:05:48] [DOC: 9265725] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:05:48] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:05:48] 🔄 
🔄 Step 6: Pushing order to API...
[17:05:48] [DOC: 9265725] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[17:05:49] [DOC: 9265725] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:05:49] ❌    ❌ Failed to push order
[17:05:49] 🔄 
🔄 Step 7: Writing to CSV...
[17:05:49] [DOC: 9265725] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[17:05:49] [DOC: 9265725] ℹ️  Service Line extracted: 'HHA'
[17:05:49] [DOC: 9265725] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[17:05:49] [DOC: 9265725] ℹ️  Diagnosis codes being written:
[17:05:49] [DOC: 9265725] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:05:49] [DOC: 9265725] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:05:49] [DOC: 9265725] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:05:49] [DOC: 9265725] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:05:49] [DOC: 9265725] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:05:49] [DOC: 9265725] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:05:49] [DOC: 9265725] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: HHA | Payer: Tufts Health Plan Medicare Preferred | MRN: 5879015
[17:05:49] ✅    ✅ Document 9265725 processed and saved successfully
[17:05:49] 🔄 
🔄 Step 8: Saving API details...
[17:05:49] [DOC: 9265725] ℹ️  API push details saved for document 9265725
[17:05:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265724                         ║
================================================================================
[17:05:49] ℹ️  Agency: Dartmouth HH
[17:05:49] ℹ️  Date: 04/29/2025
[17:05:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:05:51] [DOC: 9265724] ✅ Text extracted using pdfplumber (9669 chars)
[17:05:51] ✅    ✅ Text extracted using pdfplumber (9669 chars)
[17:05:51] 🔄 
🔄 Step 2: Extracting patient data...
[17:05:54] ℹ️  AI extracted raw sex value: 'M'
[17:05:54] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[17:05:54] ℹ️  AI extracted payer source: 'Fallon Health'
[17:05:54] ℹ️  AI extracted diagnoses:
[17:05:54] ℹ️    - Diagnosis 1: 'None'
[17:05:54] ℹ️    - Diagnosis 2: 'None'
[17:05:54] ℹ️    - Diagnosis 3: 'None'
[17:05:54] ℹ️    - Diagnosis 4: 'None'
[17:05:54] ℹ️    - Diagnosis 5: 'None'
[17:05:54] ℹ️    - Diagnosis 6: 'None'
[17:05:54] ℹ️  Final extracted MRN: '4212011'
[17:05:54] ℹ️  Final extracted Sex: 'MALE'
[17:05:54] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[17:05:54] ℹ️  Final extracted Payer Source: 'Fallon Health'
[17:05:54] ✅ Patient data extraction completed successfully
[17:05:54] ✅    ✅ Patient data extracted successfully
[17:05:54] 📊 Patient Response
     └─ patientFName: Joaquim
     └─ patientLName: Laranjeira
     └─ dob: 03/06/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 4212011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:05:54] ✅    ✅ Patient identified: Joaquim Laranjeira
[17:05:54] ✅    ✅ Patient name validation passed
[17:05:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:05:54] [DOC: 9265724] ℹ️  DOB normalized: 03/06/1952
[17:05:54] [DOC: 9265724] ℹ️  Episode startOfCare normalized: 04/18/2025
[17:05:54] [DOC: 9265724] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[17:05:54] [DOC: 9265724] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[17:05:54] [DOC: 9265724] ✅ Patient date processing completed successfully
[17:05:54] ✅    ✅ Date processing completed
[17:05:54] 📊 Processed Patient Data
     └─ patientFName: Joaquim
     └─ patientLName: Laranjeira
     └─ dob: 03/06/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 4212011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025'}]
[17:05:54] 🔄 
🔄 Step 4: Extracting order data...
[17:05:57] ℹ️  Order extraction - MRN: '4212011'
[17:05:57] ℹ️  Order extraction - Sex: 'MALE'
[17:05:57] ℹ️  Order extraction - Service Line: 'PT, Skilled Nursing'
[17:05:57] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[17:05:57] ✅ Order data extraction completed successfully
[17:05:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:05:57] ℹ️  Using MRN from patient data: '4212011' over '4212011'
[17:05:57] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT, Skilled Nursing' = 'PT, Physical Therapy, Skilled Nursing'
[17:05:57] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[17:05:57] ✅ Patient name cross-validation successful
[17:05:57] ✅    ✅ Data merged successfully
[17:05:58] ✅    ✅ Order data extracted and validated
[17:05:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:04] [DOC: 9265724] ℹ️  Patient not found in cache or API: Joaquim Laranjeira
[17:06:04] [DOC: 9265724] ℹ️  Patient not found, creating new patient via API...
[17:06:04] [DOC: 9265724] ℹ️  Creating patient via API: Joaquim Laranjeira
[17:06:05] [DOC: 9265724] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:06:05] ❌    ❌ Failed to create patient
[17:06:05] [DOC: 9265724] ℹ️  API push details saved for document 9265724
================================================================================
║                        Processing Document ID: 9265713                         ║
================================================================================
[17:06:05] ℹ️  Agency: Dartmouth HH
[17:06:05] ℹ️  Date: 04/29/2025
[17:06:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:07] [DOC: 9265713] ✅ Text extracted using pdfplumber (1106 chars)
[17:06:07] ✅    ✅ Text extracted using pdfplumber (1106 chars)
[17:06:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:10] ℹ️  AI extracted raw sex value: 'M'
[17:06:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:06:10] ℹ️  AI extracted payer source: 'Medicare'
[17:06:10] ℹ️  AI extracted diagnoses:
[17:06:10] ℹ️    - Diagnosis 1: 'None'
[17:06:10] ℹ️    - Diagnosis 2: 'None'
[17:06:10] ℹ️    - Diagnosis 3: 'None'
[17:06:10] ℹ️    - Diagnosis 4: 'None'
[17:06:10] ℹ️    - Diagnosis 5: 'None'
[17:06:10] ℹ️    - Diagnosis 6: 'None'
[17:06:10] ℹ️  Final extracted MRN: '5696015'
[17:06:10] ℹ️  Final extracted Sex: 'MALE'
[17:06:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:06:10] ℹ️  Final extracted Payer Source: 'Medicare'
[17:06:10] ✅ Patient data extraction completed successfully
[17:06:10] ✅    ✅ Patient data extracted successfully
[17:06:10] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Glennon
     └─ dob: 05/22/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5696015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2025', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:06:10] ✅    ✅ Patient identified: Joseph Glennon
[17:06:10] ✅    ✅ Patient name validation passed
[17:06:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:10] [DOC: 9265713] ℹ️  DOB normalized: 05/22/1940
[17:06:10] [DOC: 9265713] ℹ️  Episode startOfCare normalized: 02/07/2025
[17:06:10] [DOC: 9265713] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[17:06:10] [DOC: 9265713] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[17:06:10] [DOC: 9265713] ✅ Patient date processing completed successfully
[17:06:10] ✅    ✅ Date processing completed
[17:06:10] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Glennon
     └─ dob: 05/22/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5696015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2025', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025'}]
[17:06:10] 🔄 
🔄 Step 4: Extracting order data...
[17:06:12] ℹ️  Order extraction - MRN: ''
[17:06:12] ℹ️  Order extraction - Sex: 'MALE'
[17:06:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:06:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:06:12] ✅ Order data extraction completed successfully
[17:06:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:12] ℹ️  Using MRN from patient data: '5696015'
[17:06:12] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:06:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:06:12] ✅ Patient name cross-validation successful
[17:06:12] ✅    ✅ Data merged successfully
[17:06:13] ✅    ✅ Order data extracted and validated
[17:06:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:13] [DOC: 9265713] ✅ Patient found in local cache: Joseph Glennon, ID: 50fffc9e-57fa-4954-899a-797626953753
[17:06:13] ✅    ✅ Existing patient found with ID: 50fffc9e-57fa-4954-899a-797626953753
[17:06:13] 🔄 
🔄 Step 6: Pushing order to API...
[17:06:13] [DOC: 9265713] ℹ️  Pushing order via API for patient ID: 50fffc9e-57fa-4954-899a-797626953753
[17:06:14] [DOC: 9265713] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:06:14] ❌    ❌ Failed to push order
[17:06:14] 🔄 
🔄 Step 7: Writing to CSV...
[17:06:14] [DOC: 9265713] ℹ️  Calculated age: 85 from DOB: 05/22/1940
[17:06:14] [DOC: 9265713] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:06:14] [DOC: 9265713] ℹ️  Payer Source extracted: 'Medicare'
[17:06:14] [DOC: 9265713] ℹ️  Diagnosis codes being written:
[17:06:14] [DOC: 9265713] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:06:14] [DOC: 9265713] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:06:14] [DOC: 9265713] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:06:14] [DOC: 9265713] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:06:14] [DOC: 9265713] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:06:14] [DOC: 9265713] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:06:14] [DOC: 9265713] ✅ Patient data written to CSV: Joseph Glennon | Sex: MALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: 5696015
[17:06:14] ✅    ✅ Document 9265713 processed and saved successfully
[17:06:14] 🔄 
🔄 Step 8: Saving API details...
[17:06:14] [DOC: 9265713] ℹ️  API push details saved for document 9265713
[17:06:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265674                         ║
================================================================================
[17:06:14] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[17:06:14] ℹ️  Date: 04/28/2025
[17:06:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:17] [DOC: 9265674] ✅ Text extracted using pdfplumber (16623 chars)
[17:06:17] ✅    ✅ Text extracted using pdfplumber (16623 chars)
[17:06:17] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:20] ℹ️  AI extracted raw sex value: ''
[17:06:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:06:20] ℹ️  AI extracted payer source: 'Medicare'
[17:06:20] ℹ️  AI extracted diagnoses:
[17:06:20] ℹ️    - Diagnosis 1: 'Z48.815'
[17:06:20] ℹ️    - Diagnosis 2: 'J44.89'
[17:06:20] ℹ️    - Diagnosis 3: 'E11.51'
[17:06:20] ℹ️    - Diagnosis 4: 'I11.0'
[17:06:20] ℹ️    - Diagnosis 5: 'I50.22'
[17:06:20] ℹ️    - Diagnosis 6: 'I25.118'
[17:06:20] ℹ️  Final extracted MRN: '28700194813801'
[17:06:20] ℹ️  Final extracted Sex: ''
[17:06:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:06:20] ℹ️  Final extracted Payer Source: 'Medicare'
[17:06:20] ✅ Patient data extraction completed successfully
[17:06:20] ✅    ✅ Patient data extracted successfully
[17:06:20] 📊 Patient Response
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: DEFUSCO, NICHOLAS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Z48.815', 'secondDiagnosis': 'J44.89', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.22', 'sixthDiagnosis': 'I25.118'}]
[17:06:20] ✅    ✅ Patient identified: MANUEL DEMELLO
[17:06:20] ✅    ✅ Patient name validation passed
[17:06:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:20] [DOC: 9265674] ℹ️  DOB normalized: 03/22/1945
[17:06:20] [DOC: 9265674] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[17:06:20] [DOC: 9265674] ✅ Patient date processing completed successfully
[17:06:20] ✅    ✅ Date processing completed
[17:06:20] 📊 Processed Patient Data
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: DEFUSCO, NICHOLAS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Z48.815', 'secondDiagnosis': 'J44.89', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.22', 'sixthDiagnosis': 'I25.118'}]
[17:06:20] 🔄 
🔄 Step 4: Extracting order data...
[17:06:23] ℹ️  Order extraction - MRN: '28700194813801'
[17:06:23] ℹ️  Order extraction - Sex: ''
[17:06:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:06:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:06:23] ✅ Order data extraction completed successfully
[17:06:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:23] ℹ️  Using MRN from patient data: '28700194813801' over '28700194813801'
[17:06:23] ⚠️  Could not determine sex using any available method
[17:06:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:06:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:06:23] ✅ Patient name cross-validation successful
[17:06:23] ✅    ✅ Data merged successfully
[17:06:24] ✅    ✅ Order data extracted and validated
[17:06:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:24] [DOC: 9265674] ✅ Patient found in local cache: MANUEL DEMELLO, ID: 54784569-a65e-445e-be68-20a38f0b9a63
[17:06:24] ✅    ✅ Existing patient found with ID: 54784569-a65e-445e-be68-20a38f0b9a63
[17:06:24] 🔄 
🔄 Step 6: Pushing order to API...
[17:06:24] [DOC: 9265674] ℹ️  Pushing order via API for patient ID: 54784569-a65e-445e-be68-20a38f0b9a63
[17:06:25] [DOC: 9265674] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13809"}
[17:06:25] ❌    ❌ Failed to push order
[17:06:25] 🔄 
🔄 Step 7: Writing to CSV...
[17:06:25] [DOC: 9265674] ℹ️  Calculated age: 80 from DOB: 03/22/1945
[17:06:25] [DOC: 9265674] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:06:25] [DOC: 9265674] ℹ️  Payer Source extracted: 'Medicare'
[17:06:25] [DOC: 9265674] ℹ️  Diagnosis codes being written:
[17:06:25] [DOC: 9265674] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.815'
[17:06:25] [DOC: 9265674] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.89'
[17:06:25] [DOC: 9265674] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.51'
[17:06:25] [DOC: 9265674] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[17:06:25] [DOC: 9265674] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.22'
[17:06:25] [DOC: 9265674] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.118'
[17:06:25] [DOC: 9265674] ✅ Patient data written to CSV: MANUEL DEMELLO | Sex:  | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700194813801
[17:06:25] ✅    ✅ Document 9265674 processed and saved successfully
[17:06:25] 🔄 
🔄 Step 8: Saving API details...
[17:06:25] [DOC: 9265674] ℹ️  API push details saved for document 9265674
[17:06:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265673                         ║
================================================================================
[17:06:25] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[17:06:25] ℹ️  Date: 04/28/2025
[17:06:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:27] [DOC: 9265673] ✅ Text extracted using pdfplumber (1966 chars)
[17:06:27] ✅    ✅ Text extracted using pdfplumber (1966 chars)
[17:06:27] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:31] ℹ️  AI extracted raw sex value: ''
[17:06:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:06:31] ℹ️  AI extracted payer source: 'Medicare'
[17:06:31] ℹ️  AI extracted diagnoses:
[17:06:31] ℹ️    - Diagnosis 1: 'None'
[17:06:31] ℹ️    - Diagnosis 2: 'None'
[17:06:31] ℹ️    - Diagnosis 3: 'None'
[17:06:31] ℹ️    - Diagnosis 4: 'None'
[17:06:31] ℹ️    - Diagnosis 5: 'None'
[17:06:31] ℹ️    - Diagnosis 6: 'None'
[17:06:31] ℹ️  Final extracted MRN: '28700194813801'
[17:06:31] ℹ️  Final extracted Sex: ''
[17:06:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:06:31] ℹ️  Final extracted Payer Source: 'Medicare'
[17:06:31] ✅ Patient data extraction completed successfully
[17:06:31] ✅    ✅ Patient data extracted successfully
[17:06:31] 📊 Patient Response
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: None
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:06:31] ✅    ✅ Patient identified: MANUEL DEMELLO
[17:06:31] ✅    ✅ Patient name validation passed
[17:06:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:31] [DOC: 9265673] ℹ️  DOB normalized: 03/22/1945
[17:06:31] [DOC: 9265673] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[17:06:31] [DOC: 9265673] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[17:06:31] [DOC: 9265673] ✅ Patient date processing completed successfully
[17:06:31] ✅    ✅ Date processing completed
[17:06:31] 📊 Processed Patient Data
     └─ patientFName: MANUEL
     └─ patientLName: DEMELLO
     └─ dob: 03/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: 28700194813801
     └─ billingProvider: DOCTOR ALLIANCE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '03/22/2025'}, {'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '04/21/2025'}]
[17:06:31] 🔄 
🔄 Step 4: Extracting order data...
[17:06:33] ℹ️  Order extraction - MRN: '28700194813801'
[17:06:33] ℹ️  Order extraction - Sex: ''
[17:06:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:06:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[17:06:33] ✅ Order data extraction completed successfully
[17:06:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:33] ℹ️  Using MRN from patient data: '28700194813801' over '28700194813801'
[17:06:33] ⚠️  Could not determine sex using any available method
[17:06:33] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:06:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[17:06:33] ✅ Patient name cross-validation successful
[17:06:33] ✅    ✅ Data merged successfully
[17:06:34] ✅    ✅ Order data extracted and validated
[17:06:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:34] [DOC: 9265673] ✅ Patient found in local cache: MANUEL DEMELLO, ID: 54784569-a65e-445e-be68-20a38f0b9a63
[17:06:34] ✅    ✅ Existing patient found with ID: 54784569-a65e-445e-be68-20a38f0b9a63
[17:06:34] 🔄 
🔄 Step 6: Pushing order to API...
[17:06:34] [DOC: 9265673] ℹ️  Pushing order via API for patient ID: 54784569-a65e-445e-be68-20a38f0b9a63
[17:06:35] [DOC: 9265673] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13811"}
[17:06:35] ❌    ❌ Failed to push order
[17:06:35] 🔄 
🔄 Step 7: Writing to CSV...
[17:06:35] [DOC: 9265673] ℹ️  Calculated age: 80 from DOB: 03/22/1945
[17:06:35] [DOC: 9265673] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:06:35] [DOC: 9265673] ℹ️  Payer Source extracted: 'Medicare'
[17:06:35] [DOC: 9265673] ℹ️  Diagnosis codes being written:
[17:06:35] [DOC: 9265673] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:06:35] [DOC: 9265673] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:06:35] [DOC: 9265673] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:06:35] [DOC: 9265673] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:06:35] [DOC: 9265673] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:06:35] [DOC: 9265673] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:06:35] [DOC: 9265673] ✅ Patient data written to CSV: MANUEL DEMELLO | Sex:  | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700194813801
[17:06:35] ✅    ✅ Document 9265673 processed and saved successfully
[17:06:35] 🔄 
🔄 Step 8: Saving API details...
[17:06:35] [DOC: 9265673] ℹ️  API push details saved for document 9265673
[17:06:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265021                         ║
================================================================================
[17:06:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:06:35] ℹ️  Date: 04/28/2025
[17:06:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:37] [DOC: 9265021] ✅ Text extracted using pdfplumber (2825 chars)
[17:06:37] ✅    ✅ Text extracted using pdfplumber (2825 chars)
[17:06:37] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:40] ℹ️  AI extracted raw sex value: 'M'
[17:06:40] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work,Home Health Aide'
[17:06:40] ℹ️  AI extracted payer source: ''
[17:06:40] ℹ️  AI extracted diagnoses:
[17:06:40] ℹ️    - Diagnosis 1: ''
[17:06:40] ℹ️    - Diagnosis 2: ''
[17:06:40] ℹ️    - Diagnosis 3: ''
[17:06:40] ℹ️    - Diagnosis 4: ''
[17:06:40] ℹ️    - Diagnosis 5: ''
[17:06:40] ℹ️    - Diagnosis 6: ''
[17:06:40] ℹ️  Final extracted MRN: '3076049'
[17:06:40] ℹ️  Final extracted Sex: 'MALE'
[17:06:40] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work,Home Health Aide'
[17:06:40] ℹ️  Final extracted Payer Source: ''
[17:06:40] ✅ Patient data extraction completed successfully
[17:06:40] ✅    ✅ Patient data extracted successfully
[17:06:40] 📊 Patient Response
     └─ patientFName: Douglas
     └─ patientLName: Vrona
     └─ dob: 11/11/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 3076049
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:06:40] ✅    ✅ Patient identified: Douglas Vrona
[17:06:40] ✅    ✅ Patient name validation passed
[17:06:40] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:40] [DOC: 9265021] ℹ️  DOB normalized: 11/11/1945
[17:06:40] [DOC: 9265021] ℹ️  Episode startOfEpisode normalized: 04/27/2025
[17:06:40] [DOC: 9265021] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[17:06:40] [DOC: 9265021] ✅ Patient date processing completed successfully
[17:06:40] ✅    ✅ Date processing completed
[17:06:40] 📊 Processed Patient Data
     └─ patientFName: Douglas
     └─ patientLName: Vrona
     └─ dob: 11/11/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: 3076049
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work,Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:06:40] 🔄 
🔄 Step 4: Extracting order data...
[17:06:42] ℹ️  Order extraction - MRN: '3076049'
[17:06:42] ℹ️  Order extraction - Sex: 'MALE'
[17:06:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work, Home Health Aide'
[17:06:42] ℹ️  Order extraction - Payer Source: ''
[17:06:42] ✅ Order data extraction completed successfully
[17:06:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:06:42] ℹ️  Using MRN from patient data: '3076049' over '3076049'
[17:06:42] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy,Speech Language Pathology,Medical Social Work,Home Health Aide' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology, Medical Social Work, Home Health Aide' = 'Home Health Aide, Medical Social Work, Occupational Therapy, Physical Therapy, Skilled Nursing, Speech Language Pathology'
[17:06:42] ✅ Patient name cross-validation successful
[17:06:42] ✅    ✅ Data merged successfully
[17:06:47] ✅    ✅ Order data extracted and validated
[17:06:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:06:52] [DOC: 9265021] ℹ️  Patient not found in cache or API: Douglas Vrona
[17:06:52] [DOC: 9265021] ℹ️  Patient not found, creating new patient via API...
[17:06:52] [DOC: 9265021] ℹ️  Creating patient via API: Douglas Vrona
[17:06:54] [DOC: 9265021] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:06:54] ❌    ❌ Failed to create patient
[17:06:54] [DOC: 9265021] ℹ️  API push details saved for document 9265021
================================================================================
║                        Processing Document ID: 9265017                         ║
================================================================================
[17:06:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:06:54] ℹ️  Date: 04/28/2025
[17:06:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:06:55] [DOC: 9265017] ✅ Text extracted using pdfplumber (1348 chars)
[17:06:55] ✅    ✅ Text extracted using pdfplumber (1348 chars)
[17:06:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:06:57] ℹ️  AI extracted raw sex value: 'F'
[17:06:57] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:06:57] ℹ️  AI extracted payer source: ''
[17:06:57] ℹ️  AI extracted diagnoses:
[17:06:57] ℹ️    - Diagnosis 1: ''
[17:06:57] ℹ️    - Diagnosis 2: ''
[17:06:57] ℹ️    - Diagnosis 3: ''
[17:06:57] ℹ️    - Diagnosis 4: ''
[17:06:57] ℹ️    - Diagnosis 5: ''
[17:06:57] ℹ️    - Diagnosis 6: ''
[17:06:57] ℹ️  Final extracted MRN: '3071654'
[17:06:57] ℹ️  Final extracted Sex: 'FEMALE'
[17:06:57] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:06:57] ℹ️  Final extracted Payer Source: ''
[17:06:57] ✅ Patient data extraction completed successfully
[17:06:57] ✅    ✅ Patient data extracted successfully
[17:06:57] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:06:57] ✅    ✅ Patient identified: Tina Viera
[17:06:57] ✅    ✅ Patient name validation passed
[17:06:57] 🔄 
🔄 Step 3: Processing patient dates...
[17:06:57] [DOC: 9265017] ℹ️  DOB normalized: 08/17/1964
[17:06:57] [DOC: 9265017] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[17:06:57] [DOC: 9265017] ✅ Patient date processing completed successfully
[17:06:57] ✅    ✅ Date processing completed
[17:06:57] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:06:57] 🔄 
🔄 Step 4: Extracting order data...
[17:07:00] ℹ️  Order extraction - MRN: '3071654'
[17:07:00] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:00] ℹ️  Order extraction - Service Line: 'SN'
[17:07:00] ℹ️  Order extraction - Payer Source: ''
[17:07:00] ✅ Order data extraction completed successfully
[17:07:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:00] ℹ️  Using MRN from patient data: '3071654' over '3071654'
[17:07:00] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[17:07:00] ✅ Patient name cross-validation successful
[17:07:00] ✅    ✅ Data merged successfully
[17:07:01] ✅    ✅ Order data extracted and validated
[17:07:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:06] [DOC: 9265017] ℹ️  Patient not found in cache or API: Tina Viera
[17:07:06] [DOC: 9265017] ℹ️  Patient not found, creating new patient via API...
[17:07:06] [DOC: 9265017] ℹ️  Creating patient via API: Tina Viera
[17:07:07] [DOC: 9265017] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:07:07] ❌    ❌ Failed to create patient
[17:07:07] [DOC: 9265017] ℹ️  API push details saved for document 9265017
================================================================================
║                        Processing Document ID: 9265016                         ║
================================================================================
[17:07:07] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:07:07] ℹ️  Date: 04/28/2025
[17:07:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:08] [DOC: 9265016] ✅ Text extracted using pdfplumber (1166 chars)
[17:07:08] ✅    ✅ Text extracted using pdfplumber (1166 chars)
[17:07:08] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:11] ℹ️  AI extracted raw sex value: 'M'
[17:07:11] ℹ️  AI extracted service line: 'Physical Therapy'
[17:07:11] ℹ️  AI extracted payer source: ''
[17:07:11] ℹ️  AI extracted diagnoses:
[17:07:11] ℹ️    - Diagnosis 1: ''
[17:07:11] ℹ️    - Diagnosis 2: ''
[17:07:11] ℹ️    - Diagnosis 3: ''
[17:07:11] ℹ️    - Diagnosis 4: ''
[17:07:11] ℹ️    - Diagnosis 5: ''
[17:07:11] ℹ️    - Diagnosis 6: ''
[17:07:11] ℹ️  Final extracted MRN: '3027881'
[17:07:11] ℹ️  Final extracted Sex: 'MALE'
[17:07:11] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:07:11] ℹ️  Final extracted Payer Source: ''
[17:07:11] ✅ Patient data extraction completed successfully
[17:07:11] ✅    ✅ Patient data extracted successfully
[17:07:11] 📊 Patient Response
     └─ patientFName: Francisco
     └─ patientLName: Tavares
     └─ dob: 02/10/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 3027881
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:11] ✅    ✅ Patient identified: Francisco Tavares
[17:07:11] ✅    ✅ Patient name validation passed
[17:07:11] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:11] [DOC: 9265016] ℹ️  DOB normalized: 02/10/1955
[17:07:11] [DOC: 9265016] ✅ Patient date processing completed successfully
[17:07:11] ✅    ✅ Date processing completed
[17:07:11] 📊 Processed Patient Data
     └─ patientFName: Francisco
     └─ patientLName: Tavares
     └─ dob: 02/10/1955
     └─ patientSex: MALE
     └─ medicalRecordNo: 3027881
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:11] 🔄 
🔄 Step 4: Extracting order data...
[17:07:13] ℹ️  Order extraction - MRN: '3027881'
[17:07:13] ℹ️  Order extraction - Sex: 'MALE'
[17:07:13] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:07:13] ℹ️  Order extraction - Payer Source: ''
[17:07:13] ✅ Order data extraction completed successfully
[17:07:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:13] ℹ️  Using MRN from patient data: '3027881' over '3027881'
[17:07:13] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:07:13] ✅ Patient name cross-validation successful
[17:07:13] ✅    ✅ Data merged successfully
[17:07:14] ✅    ✅ Order data extracted and validated
[17:07:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:19] [DOC: 9265016] ℹ️  Patient not found in cache or API: Francisco Tavares
[17:07:19] [DOC: 9265016] ℹ️  Patient not found, creating new patient via API...
[17:07:19] [DOC: 9265016] ℹ️  Creating patient via API: Francisco Tavares
[17:07:21] [DOC: 9265016] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:07:21] ❌    ❌ Failed to create patient
[17:07:21] [DOC: 9265016] ℹ️  API push details saved for document 9265016
================================================================================
║                        Processing Document ID: 9265014                         ║
================================================================================
[17:07:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:07:21] ℹ️  Date: 04/28/2025
[17:07:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:22] [DOC: 9265014] ✅ Text extracted using pdfplumber (1263 chars)
[17:07:22] ✅    ✅ Text extracted using pdfplumber (1263 chars)
[17:07:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:25] ℹ️  AI extracted raw sex value: 'M'
[17:07:25] ℹ️  AI extracted service line: 'Home Health Aide'
[17:07:25] ℹ️  AI extracted payer source: ''
[17:07:25] ℹ️  AI extracted diagnoses:
[17:07:25] ℹ️    - Diagnosis 1: ''
[17:07:25] ℹ️    - Diagnosis 2: ''
[17:07:25] ℹ️    - Diagnosis 3: ''
[17:07:25] ℹ️    - Diagnosis 4: ''
[17:07:25] ℹ️    - Diagnosis 5: ''
[17:07:25] ℹ️    - Diagnosis 6: ''
[17:07:25] ℹ️  Final extracted MRN: '2998670'
[17:07:25] ℹ️  Final extracted Sex: 'MALE'
[17:07:25] ℹ️  Final extracted Service Line: 'Home Health Aide'
[17:07:25] ℹ️  Final extracted Payer Source: ''
[17:07:25] ✅ Patient data extraction completed successfully
[17:07:25] ✅    ✅ Patient data extracted successfully
[17:07:25] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:25] ✅    ✅ Patient identified: Raymond Souza
[17:07:25] ✅    ✅ Patient name validation passed
[17:07:25] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:25] [DOC: 9265014] ℹ️  DOB normalized: 06/18/1927
[17:07:25] [DOC: 9265014] ✅ Patient date processing completed successfully
[17:07:25] ✅    ✅ Date processing completed
[17:07:25] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:25] 🔄 
🔄 Step 4: Extracting order data...
[17:07:27] ℹ️  Order extraction - MRN: '2998670'
[17:07:27] ℹ️  Order extraction - Sex: 'MALE'
[17:07:27] ℹ️  Order extraction - Service Line: 'Home Health Aide'
[17:07:27] ℹ️  Order extraction - Payer Source: ''
[17:07:27] ✅ Order data extraction completed successfully
[17:07:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:27] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[17:07:27] ℹ️  Service line consistent in both sources: 'Home Health Aide'
[17:07:27] ✅ Patient name cross-validation successful
[17:07:27] ✅    ✅ Data merged successfully
[17:07:28] ✅    ✅ Order data extracted and validated
[17:07:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:28] [DOC: 9265014] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[17:07:28] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[17:07:28] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:28] [DOC: 9265014] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[17:07:29] [DOC: 9265014] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19662"}
[17:07:29] ❌    ❌ Failed to push order
[17:07:29] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:29] [DOC: 9265014] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[17:07:29] [DOC: 9265014] ℹ️  Service Line extracted: 'Home Health Aide'
[17:07:29] [DOC: 9265014] ℹ️  Payer Source extracted: ''
[17:07:29] [DOC: 9265014] ℹ️  Diagnosis codes being written:
[17:07:29] [DOC: 9265014] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:07:29] [DOC: 9265014] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:07:29] [DOC: 9265014] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:29] [DOC: 9265014] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:29] [DOC: 9265014] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:29] [DOC: 9265014] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:29] [DOC: 9265014] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: Home Health Aide | Payer:  | MRN: 2998670
[17:07:29] ✅    ✅ Document 9265014 processed and saved successfully
[17:07:29] 🔄 
🔄 Step 8: Saving API details...
[17:07:29] [DOC: 9265014] ℹ️  API push details saved for document 9265014
[17:07:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9265002                         ║
================================================================================
[17:07:29] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:07:29] ℹ️  Date: 04/28/2025
[17:07:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:31] [DOC: 9265002] ✅ Text extracted using pdfplumber (1896 chars)
[17:07:31] ✅    ✅ Text extracted using pdfplumber (1896 chars)
[17:07:31] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:33] ℹ️  AI extracted raw sex value: 'F'
[17:07:33] ℹ️  AI extracted service line: 'Occupational Therapy, Physical Therapy'
[17:07:33] ℹ️  AI extracted payer source: ''
[17:07:33] ℹ️  AI extracted diagnoses:
[17:07:33] ℹ️    - Diagnosis 1: ''
[17:07:33] ℹ️    - Diagnosis 2: ''
[17:07:33] ℹ️    - Diagnosis 3: ''
[17:07:33] ℹ️    - Diagnosis 4: ''
[17:07:33] ℹ️    - Diagnosis 5: ''
[17:07:33] ℹ️    - Diagnosis 6: ''
[17:07:33] ℹ️  Final extracted MRN: '2795248'
[17:07:33] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:33] ℹ️  Final extracted Service Line: 'Occupational Therapy, Physical Therapy'
[17:07:33] ℹ️  Final extracted Payer Source: ''
[17:07:33] ✅ Patient data extraction completed successfully
[17:07:33] ✅    ✅ Patient data extracted successfully
[17:07:33] 📊 Patient Response
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:33] ✅    ✅ Patient identified: Meryl Novek
[17:07:33] ✅    ✅ Patient name validation passed
[17:07:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:33] [DOC: 9265002] ℹ️  DOB normalized: 02/08/1941
[17:07:33] [DOC: 9265002] ✅ Patient date processing completed successfully
[17:07:33] ✅    ✅ Date processing completed
[17:07:33] 📊 Processed Patient Data
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:33] 🔄 
🔄 Step 4: Extracting order data...
[17:07:36] ℹ️  Order extraction - MRN: '2795248'
[17:07:36] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy, Physical Therapy'
[17:07:36] ℹ️  Order extraction - Payer Source: ''
[17:07:36] ✅ Order data extraction completed successfully
[17:07:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:36] ℹ️  Using MRN from patient data: '2795248' over '2795248'
[17:07:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy, Physical Therapy'
[17:07:36] ✅ Patient name cross-validation successful
[17:07:36] ✅    ✅ Data merged successfully
[17:07:37] ✅    ✅ Order data extracted and validated
[17:07:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:42] [DOC: 9265002] ℹ️  Patient not found in cache or API: Meryl Novek
[17:07:42] [DOC: 9265002] ℹ️  Patient not found, creating new patient via API...
[17:07:42] [DOC: 9265002] ℹ️  Creating patient via API: Meryl Novek
[17:07:44] [DOC: 9265002] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:07:44] ❌    ❌ Failed to create patient
[17:07:44] [DOC: 9265002] ℹ️  API push details saved for document 9265002
================================================================================
║                        Processing Document ID: 9264996                         ║
================================================================================
[17:07:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:07:44] ℹ️  Date: 04/28/2025
[17:07:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:45] [DOC: 9264996] ✅ Text extracted using pdfplumber (1668 chars)
[17:07:45] ✅    ✅ Text extracted using pdfplumber (1668 chars)
[17:07:45] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:48] ℹ️  AI extracted raw sex value: 'F'
[17:07:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:07:48] ℹ️  AI extracted payer source: ''
[17:07:48] ℹ️  AI extracted diagnoses:
[17:07:48] ℹ️    - Diagnosis 1: 'None'
[17:07:48] ℹ️    - Diagnosis 2: 'None'
[17:07:48] ℹ️    - Diagnosis 3: 'None'
[17:07:48] ℹ️    - Diagnosis 4: 'None'
[17:07:48] ℹ️    - Diagnosis 5: 'None'
[17:07:48] ℹ️    - Diagnosis 6: 'None'
[17:07:48] ℹ️  Final extracted MRN: '2085893'
[17:07:48] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:07:48] ℹ️  Final extracted Payer Source: ''
[17:07:48] ✅ Patient data extraction completed successfully
[17:07:48] ✅    ✅ Patient data extracted successfully
[17:07:48] 📊 Patient Response
     └─ patientFName: Cathy
     └─ patientLName: Medeiros
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085893
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:07:48] ✅    ✅ Patient identified: Cathy Medeiros
[17:07:48] ✅    ✅ Patient name validation passed
[17:07:48] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:48] [DOC: 9264996] ℹ️  DOB normalized: 02/15/1959
[17:07:48] [DOC: 9264996] ✅ Patient date processing completed successfully
[17:07:48] ✅    ✅ Date processing completed
[17:07:48] 📊 Processed Patient Data
     └─ patientFName: Cathy
     └─ patientLName: Medeiros
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085893
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:07:48] 🔄 
🔄 Step 4: Extracting order data...
[17:07:50] ℹ️  Order extraction - MRN: '2085893'
[17:07:50] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:07:50] ℹ️  Order extraction - Payer Source: ''
[17:07:50] ✅ Order data extraction completed successfully
[17:07:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:50] ℹ️  Using MRN from patient data: '2085893' over '2085893'
[17:07:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:07:50] ✅ Patient name cross-validation successful
[17:07:50] ✅    ✅ Data merged successfully
[17:07:51] ✅    ✅ Order data extracted and validated
[17:07:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:07:51] [DOC: 9264996] ✅ Patient found in local cache: Cathy Medeiros, ID: 16469dd8-331e-492f-a215-e4e18d4c2e2f
[17:07:51] ✅    ✅ Existing patient found with ID: 16469dd8-331e-492f-a215-e4e18d4c2e2f
[17:07:51] 🔄 
🔄 Step 6: Pushing order to API...
[17:07:51] [DOC: 9264996] ℹ️  Pushing order via API for patient ID: 16469dd8-331e-492f-a215-e4e18d4c2e2f
[17:07:52] [DOC: 9264996] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13343"}
[17:07:52] ❌    ❌ Failed to push order
[17:07:52] 🔄 
🔄 Step 7: Writing to CSV...
[17:07:52] [DOC: 9264996] ℹ️  Calculated age: 66 from DOB: 02/15/1959
[17:07:52] [DOC: 9264996] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:07:52] [DOC: 9264996] ℹ️  Payer Source extracted: ''
[17:07:52] [DOC: 9264996] ℹ️  Diagnosis codes being written:
[17:07:52] [DOC: 9264996] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:07:52] [DOC: 9264996] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:07:52] [DOC: 9264996] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:07:52] [DOC: 9264996] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:07:52] [DOC: 9264996] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:07:52] [DOC: 9264996] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:07:52] [DOC: 9264996] ✅ Patient data written to CSV: Cathy Medeiros | Sex: FEMALE | Age: 66 | Service: Skilled Nursing | Payer:  | MRN: 2085893
[17:07:52] ✅    ✅ Document 9264996 processed and saved successfully
[17:07:52] 🔄 
🔄 Step 8: Saving API details...
[17:07:52] [DOC: 9264996] ℹ️  API push details saved for document 9264996
[17:07:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9264993                         ║
================================================================================
[17:07:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:07:52] ℹ️  Date: 04/28/2025
[17:07:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:07:54] [DOC: 9264993] ✅ Text extracted using pdfplumber (1473 chars)
[17:07:54] ✅    ✅ Text extracted using pdfplumber (1473 chars)
[17:07:54] 🔄 
🔄 Step 2: Extracting patient data...
[17:07:56] ℹ️  AI extracted raw sex value: 'F'
[17:07:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:07:56] ℹ️  AI extracted payer source: ''
[17:07:56] ℹ️  AI extracted diagnoses:
[17:07:56] ℹ️    - Diagnosis 1: ''
[17:07:56] ℹ️    - Diagnosis 2: ''
[17:07:56] ℹ️    - Diagnosis 3: ''
[17:07:56] ℹ️    - Diagnosis 4: ''
[17:07:56] ℹ️    - Diagnosis 5: ''
[17:07:56] ℹ️    - Diagnosis 6: ''
[17:07:56] ℹ️  Final extracted MRN: '2694576'
[17:07:56] ℹ️  Final extracted Sex: 'FEMALE'
[17:07:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:07:56] ℹ️  Final extracted Payer Source: ''
[17:07:56] ✅ Patient data extraction completed successfully
[17:07:56] ✅    ✅ Patient data extracted successfully
[17:07:56] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Marcial
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2694576
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:56] ✅    ✅ Patient identified: Maria Marcial
[17:07:56] ✅    ✅ Patient name validation passed
[17:07:56] 🔄 
🔄 Step 3: Processing patient dates...
[17:07:56] [DOC: 9264993] ℹ️  DOB normalized: 07/06/1953
[17:07:56] [DOC: 9264993] ✅ Patient date processing completed successfully
[17:07:56] ✅    ✅ Date processing completed
[17:07:56] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Marcial
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2694576
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:07:56] 🔄 
🔄 Step 4: Extracting order data...
[17:07:59] ℹ️  Order extraction - MRN: '2694576'
[17:07:59] ℹ️  Order extraction - Sex: 'FEMALE'
[17:07:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:07:59] ℹ️  Order extraction - Payer Source: ''
[17:07:59] ✅ Order data extraction completed successfully
[17:07:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:07:59] ℹ️  Using MRN from patient data: '2694576' over '2694576'
[17:07:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:07:59] ✅ Patient name cross-validation successful
[17:07:59] ✅    ✅ Data merged successfully
[17:08:00] ✅    ✅ Order data extracted and validated
[17:08:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:05] [DOC: 9264993] ℹ️  Patient not found in cache or API: Maria Marcial
[17:08:05] [DOC: 9264993] ℹ️  Patient not found, creating new patient via API...
[17:08:05] [DOC: 9264993] ℹ️  Creating patient via API: Maria Marcial
[17:08:06] [DOC: 9264993] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:08:06] ❌    ❌ Failed to create patient
[17:08:06] [DOC: 9264993] ℹ️  API push details saved for document 9264993
================================================================================
║                        Processing Document ID: 9264925                         ║
================================================================================
[17:08:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:08:06] ℹ️  Date: 04/28/2025
[17:08:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:08] [DOC: 9264925] ✅ Text extracted using pdfplumber (1076 chars)
[17:08:08] ✅    ✅ Text extracted using pdfplumber (1076 chars)
[17:08:08] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:11] ℹ️  AI extracted raw sex value: 'F'
[17:08:11] ℹ️  AI extracted service line: 'Physical Therapy'
[17:08:11] ℹ️  AI extracted payer source: ''
[17:08:11] ℹ️  AI extracted diagnoses:
[17:08:11] ℹ️    - Diagnosis 1: ''
[17:08:11] ℹ️    - Diagnosis 2: ''
[17:08:11] ℹ️    - Diagnosis 3: ''
[17:08:11] ℹ️    - Diagnosis 4: ''
[17:08:11] ℹ️    - Diagnosis 5: ''
[17:08:11] ℹ️    - Diagnosis 6: ''
[17:08:11] ℹ️  Final extracted MRN: '2516647'
[17:08:11] ℹ️  Final extracted Sex: 'FEMALE'
[17:08:11] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:08:11] ℹ️  Final extracted Payer Source: ''
[17:08:11] ✅ Patient data extraction completed successfully
[17:08:11] ✅    ✅ Patient data extracted successfully
[17:08:11] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Girouard
     └─ dob: 11/02/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2516647
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:11] ✅    ✅ Patient identified: Linda Girouard
[17:08:11] ✅    ✅ Patient name validation passed
[17:08:11] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:11] [DOC: 9264925] ℹ️  DOB normalized: 11/02/1960
[17:08:11] [DOC: 9264925] ℹ️  Episode startOfEpisode normalized: 05/11/2025
[17:08:11] [DOC: 9264925] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[17:08:11] [DOC: 9264925] ✅ Patient date processing completed successfully
[17:08:11] ✅    ✅ Date processing completed
[17:08:11] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Girouard
     └─ dob: 11/02/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2516647
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:11] 🔄 
🔄 Step 4: Extracting order data...
[17:08:13] ℹ️  Order extraction - MRN: '2516647'
[17:08:13] ℹ️  Order extraction - Sex: 'FEMALE'
[17:08:13] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:08:13] ℹ️  Order extraction - Payer Source: ''
[17:08:13] ✅ Order data extraction completed successfully
[17:08:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:13] ℹ️  Using MRN from patient data: '2516647' over '2516647'
[17:08:13] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:08:13] ✅ Patient name cross-validation successful
[17:08:13] ✅    ✅ Data merged successfully
[17:08:14] ✅    ✅ Order data extracted and validated
[17:08:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:20] [DOC: 9264925] ℹ️  Patient not found in cache or API: Linda Girouard
[17:08:20] [DOC: 9264925] ℹ️  Patient not found, creating new patient via API...
[17:08:20] [DOC: 9264925] ℹ️  Creating patient via API: Linda Girouard
[17:08:21] [DOC: 9264925] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:08:21] ❌    ❌ Failed to create patient
[17:08:21] [DOC: 9264925] ℹ️  API push details saved for document 9264925
================================================================================
║                        Processing Document ID: 9264919                         ║
================================================================================
[17:08:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:08:21] ℹ️  Date: 04/28/2025
[17:08:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:22] [DOC: 9264919] ✅ Text extracted using pdfplumber (947 chars)
[17:08:22] ✅    ✅ Text extracted using pdfplumber (947 chars)
[17:08:22] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:25] ℹ️  AI extracted raw sex value: 'M'
[17:08:25] ℹ️  AI extracted service line: 'RN'
[17:08:25] ℹ️  AI extracted payer source: ''
[17:08:25] ℹ️  AI extracted diagnoses:
[17:08:25] ℹ️    - Diagnosis 1: ''
[17:08:25] ℹ️    - Diagnosis 2: ''
[17:08:25] ℹ️    - Diagnosis 3: ''
[17:08:25] ℹ️    - Diagnosis 4: ''
[17:08:25] ℹ️    - Diagnosis 5: ''
[17:08:25] ℹ️    - Diagnosis 6: ''
[17:08:25] ℹ️  Final extracted MRN: '2428686'
[17:08:25] ℹ️  Final extracted Sex: 'MALE'
[17:08:25] ℹ️  Final extracted Service Line: 'RN'
[17:08:25] ℹ️  Final extracted Payer Source: ''
[17:08:25] ✅ Patient data extraction completed successfully
[17:08:25] ✅    ✅ Patient data extracted successfully
[17:08:25] 📊 Patient Response
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:25] ✅    ✅ Patient identified: Jerome Doyon
[17:08:25] ✅    ✅ Patient name validation passed
[17:08:25] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:25] [DOC: 9264919] ℹ️  DOB normalized: 03/02/1934
[17:08:25] [DOC: 9264919] ✅ Patient date processing completed successfully
[17:08:25] ✅    ✅ Date processing completed
[17:08:25] 📊 Processed Patient Data
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:25] 🔄 
🔄 Step 4: Extracting order data...
[17:08:27] ℹ️  Order extraction - MRN: '2428686'
[17:08:27] ℹ️  Order extraction - Sex: 'MALE'
[17:08:27] ℹ️  Order extraction - Service Line: ''
[17:08:27] ℹ️  Order extraction - Payer Source: ''
[17:08:27] ✅ Order data extraction completed successfully
[17:08:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:27] ℹ️  Using MRN from patient data: '2428686' over '2428686'
[17:08:27] ℹ️  Using service line from patient data: 'RN'
[17:08:27] ✅ Patient name cross-validation successful
[17:08:27] ✅    ✅ Data merged successfully
[17:08:28] ⚠️     ❌ Skipping - missing episode start date
[17:08:28] [DOC: 9264919] ℹ️  API push details saved for document 9264919
================================================================================
║                        Processing Document ID: 9264860                         ║
================================================================================
[17:08:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:08:28] ℹ️  Date: 04/28/2025
[17:08:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:30] [DOC: 9264860] ✅ Text extracted using pdfplumber (1012 chars)
[17:08:30] ✅    ✅ Text extracted using pdfplumber (1012 chars)
[17:08:30] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:33] ℹ️  AI extracted raw sex value: 'F'
[17:08:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:08:33] ℹ️  AI extracted payer source: ''
[17:08:33] ℹ️  AI extracted diagnoses:
[17:08:33] ℹ️    - Diagnosis 1: ''
[17:08:33] ℹ️    - Diagnosis 2: ''
[17:08:33] ℹ️    - Diagnosis 3: ''
[17:08:33] ℹ️    - Diagnosis 4: ''
[17:08:33] ℹ️    - Diagnosis 5: ''
[17:08:33] ℹ️    - Diagnosis 6: ''
[17:08:33] ℹ️  Final extracted MRN: '2258674'
[17:08:33] ℹ️  Final extracted Sex: 'FEMALE'
[17:08:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:08:33] ℹ️  Final extracted Payer Source: ''
[17:08:33] ✅ Patient data extraction completed successfully
[17:08:33] ✅    ✅ Patient data extracted successfully
[17:08:33] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:33] ✅    ✅ Patient identified: Maryann Boucher
[17:08:33] ✅    ✅ Patient name validation passed
[17:08:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:33] [DOC: 9264860] ℹ️  DOB normalized: 03/22/1946
[17:08:33] [DOC: 9264860] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[17:08:33] [DOC: 9264860] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[17:08:33] [DOC: 9264860] ✅ Patient date processing completed successfully
[17:08:33] ✅    ✅ Date processing completed
[17:08:33] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:08:33] 🔄 
🔄 Step 4: Extracting order data...
[17:08:35] ℹ️  Order extraction - MRN: '2258674'
[17:08:35] ℹ️  Order extraction - Sex: 'FEMALE'
[17:08:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:08:35] ℹ️  Order extraction - Payer Source: ''
[17:08:35] ✅ Order data extraction completed successfully
[17:08:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:35] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[17:08:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:08:35] ✅ Patient name cross-validation successful
[17:08:35] ✅    ✅ Data merged successfully
[17:08:36] ✅    ✅ Order data extracted and validated
[17:08:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:08:49] [DOC: 9264860] ℹ️  Patient not found in cache or API: Maryann Boucher
[17:08:49] [DOC: 9264860] ℹ️  Patient not found, creating new patient via API...
[17:08:49] [DOC: 9264860] ℹ️  Creating patient via API: Maryann Boucher
[17:08:51] [DOC: 9264860] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:08:51] ❌    ❌ Failed to create patient
[17:08:51] [DOC: 9264860] ℹ️  API push details saved for document 9264860
================================================================================
║                        Processing Document ID: 9264489                         ║
================================================================================
[17:08:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:08:51] ℹ️  Date: 04/28/2025
[17:08:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:08:52] [DOC: 9264489] ✅ Text extracted using pdfplumber (1802 chars)
[17:08:52] ✅    ✅ Text extracted using pdfplumber (1802 chars)
[17:08:52] 🔄 
🔄 Step 2: Extracting patient data...
[17:08:55] ℹ️  AI extracted raw sex value: 'M'
[17:08:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:08:55] ℹ️  AI extracted payer source: ''
[17:08:55] ℹ️  AI extracted diagnoses:
[17:08:55] ℹ️    - Diagnosis 1: 'None'
[17:08:55] ℹ️    - Diagnosis 2: 'None'
[17:08:55] ℹ️    - Diagnosis 3: 'None'
[17:08:55] ℹ️    - Diagnosis 4: 'None'
[17:08:55] ℹ️    - Diagnosis 5: 'None'
[17:08:55] ℹ️    - Diagnosis 6: 'None'
[17:08:55] ℹ️  Final extracted MRN: '3091790'
[17:08:55] ℹ️  Final extracted Sex: 'MALE'
[17:08:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:08:55] ℹ️  Final extracted Payer Source: ''
[17:08:55] ✅ Patient data extraction completed successfully
[17:08:55] ✅    ✅ Patient data extracted successfully
[17:08:55] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/26/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:08:55] ✅    ✅ Patient identified: Richard White
[17:08:55] ✅    ✅ Patient name validation passed
[17:08:55] 🔄 
🔄 Step 3: Processing patient dates...
[17:08:55] [DOC: 9264489] ℹ️  DOB normalized: 12/08/1957
[17:08:55] [DOC: 9264489] ℹ️  Episode startOfEpisode normalized: 04/26/2025
[17:08:55] [DOC: 9264489] ✅ Patient date processing completed successfully
[17:08:55] ✅    ✅ Date processing completed
[17:08:55] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/26/2025'}]
[17:08:55] 🔄 
🔄 Step 4: Extracting order data...
[17:08:57] ℹ️  Order extraction - MRN: '3091790'
[17:08:57] ℹ️  Order extraction - Sex: 'MALE'
[17:08:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:08:57] ℹ️  Order extraction - Payer Source: ''
[17:08:57] ✅ Order data extraction completed successfully
[17:08:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:08:57] ℹ️  Using MRN from patient data: '3091790' over '3091790'
[17:08:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:08:57] ✅ Patient name cross-validation successful
[17:08:57] ✅    ✅ Data merged successfully
[17:08:58] ✅    ✅ Order data extracted and validated
[17:08:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:05] [DOC: 9264489] ℹ️  Patient not found in cache or API: Richard White
[17:09:05] [DOC: 9264489] ℹ️  Patient not found, creating new patient via API...
[17:09:05] [DOC: 9264489] ℹ️  Creating patient via API: Richard White
[17:09:06] [DOC: 9264489] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:09:06] ❌    ❌ Failed to create patient
[17:09:06] [DOC: 9264489] ℹ️  API push details saved for document 9264489
================================================================================
║                        Processing Document ID: 9264484                         ║
================================================================================
[17:09:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:09:06] ℹ️  Date: 04/28/2025
[17:09:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:07] [DOC: 9264484] ✅ Text extracted using pdfplumber (1348 chars)
[17:09:07] ✅    ✅ Text extracted using pdfplumber (1348 chars)
[17:09:07] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:10] ℹ️  AI extracted raw sex value: 'F'
[17:09:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:09:10] ℹ️  AI extracted payer source: ''
[17:09:10] ℹ️  AI extracted diagnoses:
[17:09:10] ℹ️    - Diagnosis 1: ''
[17:09:10] ℹ️    - Diagnosis 2: ''
[17:09:10] ℹ️    - Diagnosis 3: ''
[17:09:10] ℹ️    - Diagnosis 4: ''
[17:09:10] ℹ️    - Diagnosis 5: ''
[17:09:10] ℹ️    - Diagnosis 6: ''
[17:09:10] ℹ️  Final extracted MRN: '3071654'
[17:09:10] ℹ️  Final extracted Sex: 'FEMALE'
[17:09:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:09:10] ℹ️  Final extracted Payer Source: ''
[17:09:10] ✅ Patient data extraction completed successfully
[17:09:10] ✅    ✅ Patient data extracted successfully
[17:09:10] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:10] ✅    ✅ Patient identified: Tina Viera
[17:09:10] ✅    ✅ Patient name validation passed
[17:09:10] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:10] [DOC: 9264484] ℹ️  DOB normalized: 08/17/1964
[17:09:10] [DOC: 9264484] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[17:09:10] [DOC: 9264484] ✅ Patient date processing completed successfully
[17:09:10] ✅    ✅ Date processing completed
[17:09:10] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:09:10] 🔄 
🔄 Step 4: Extracting order data...
[17:09:12] ℹ️  Order extraction - MRN: '3071654'
[17:09:12] ℹ️  Order extraction - Sex: 'FEMALE'
[17:09:12] ℹ️  Order extraction - Service Line: 'SN'
[17:09:12] ℹ️  Order extraction - Payer Source: ''
[17:09:12] ✅ Order data extraction completed successfully
[17:09:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:12] ℹ️  Using MRN from patient data: '3071654' over '3071654'
[17:09:12] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[17:09:12] ✅ Patient name cross-validation successful
[17:09:12] ✅    ✅ Data merged successfully
[17:09:17] ✅    ✅ Order data extracted and validated
[17:09:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:32] [DOC: 9264484] ℹ️  Patient not found in cache or API: Tina Viera
[17:09:32] [DOC: 9264484] ℹ️  Patient not found, creating new patient via API...
[17:09:32] [DOC: 9264484] ℹ️  Creating patient via API: Tina Viera
[17:09:36] [DOC: 9264484] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:09:36] ❌    ❌ Failed to create patient
[17:09:36] [DOC: 9264484] ℹ️  API push details saved for document 9264484
================================================================================
║                        Processing Document ID: 9264442                         ║
================================================================================
[17:09:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:09:36] ℹ️  Date: 04/28/2025
[17:09:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:38] [DOC: 9264442] ✅ Text extracted using pdfplumber (1759 chars)
[17:09:38] ✅    ✅ Text extracted using pdfplumber (1759 chars)
[17:09:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:40] ℹ️  AI extracted raw sex value: 'M'
[17:09:40] ℹ️  AI extracted service line: 'Nursing'
[17:09:40] ℹ️  AI extracted payer source: ''
[17:09:40] ℹ️  AI extracted diagnoses:
[17:09:40] ℹ️    - Diagnosis 1: 'None'
[17:09:40] ℹ️    - Diagnosis 2: 'None'
[17:09:40] ℹ️    - Diagnosis 3: 'None'
[17:09:40] ℹ️    - Diagnosis 4: 'None'
[17:09:40] ℹ️    - Diagnosis 5: 'None'
[17:09:40] ℹ️    - Diagnosis 6: 'None'
[17:09:40] ℹ️  Final extracted MRN: '2679776'
[17:09:40] ℹ️  Final extracted Sex: 'MALE'
[17:09:40] ℹ️  Final extracted Service Line: 'Nursing'
[17:09:40] ℹ️  Final extracted Payer Source: ''
[17:09:40] ✅ Patient data extraction completed successfully
[17:09:40] ✅    ✅ Patient data extracted successfully
[17:09:40] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:09:40] ✅    ✅ Patient identified: Milton MacDonald
[17:09:40] ✅    ✅ Patient name validation passed
[17:09:40] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:40] [DOC: 9264442] ℹ️  DOB normalized: 03/20/1939
[17:09:40] [DOC: 9264442] ✅ Patient date processing completed successfully
[17:09:40] ✅    ✅ Date processing completed
[17:09:40] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:09:40] 🔄 
🔄 Step 4: Extracting order data...
[17:09:43] ℹ️  Order extraction - MRN: '2679776'
[17:09:43] ℹ️  Order extraction - Sex: 'MALE'
[17:09:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:09:43] ℹ️  Order extraction - Payer Source: ''
[17:09:43] ✅ Order data extraction completed successfully
[17:09:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:43] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[17:09:43] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[17:09:43] ✅ Patient name cross-validation successful
[17:09:43] ✅    ✅ Data merged successfully
[17:09:45] ⚠️     ❌ Skipping - missing episode start date
[17:09:45] [DOC: 9264442] ℹ️  API push details saved for document 9264442
================================================================================
║                        Processing Document ID: 9264441                         ║
================================================================================
[17:09:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:09:45] ℹ️  Date: 04/28/2025
[17:09:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:46] [DOC: 9264441] ✅ Text extracted using pdfplumber (3929 chars)
[17:09:46] ✅    ✅ Text extracted using pdfplumber (3929 chars)
[17:09:46] 🔄 
🔄 Step 2: Extracting patient data...
[17:09:49] ℹ️  AI extracted raw sex value: 'F'
[17:09:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:09:49] ℹ️  AI extracted payer source: ''
[17:09:49] ℹ️  AI extracted diagnoses:
[17:09:49] ℹ️    - Diagnosis 1: 'None'
[17:09:49] ℹ️    - Diagnosis 2: 'None'
[17:09:49] ℹ️    - Diagnosis 3: 'None'
[17:09:49] ℹ️    - Diagnosis 4: 'None'
[17:09:49] ℹ️    - Diagnosis 5: 'None'
[17:09:49] ℹ️    - Diagnosis 6: 'None'
[17:09:49] ℹ️  Final extracted MRN: '2577119'
[17:09:49] ℹ️  Final extracted Sex: 'FEMALE'
[17:09:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:09:49] ℹ️  Final extracted Payer Source: ''
[17:09:49] ✅ Patient data extraction completed successfully
[17:09:49] ✅    ✅ Patient data extracted successfully
[17:09:49] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:09:49] ✅    ✅ Patient identified: Marilyn Hood
[17:09:49] ✅    ✅ Patient name validation passed
[17:09:49] 🔄 
🔄 Step 3: Processing patient dates...
[17:09:49] [DOC: 9264441] ℹ️  DOB normalized: 10/23/1941
[17:09:49] [DOC: 9264441] ✅ Patient date processing completed successfully
[17:09:49] ✅    ✅ Date processing completed
[17:09:49] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:09:49] 🔄 
🔄 Step 4: Extracting order data...
[17:09:52] ℹ️  Order extraction - MRN: '2577119'
[17:09:52] ℹ️  Order extraction - Sex: 'FEMALE'
[17:09:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:09:52] ℹ️  Order extraction - Payer Source: ''
[17:09:52] ✅ Order data extraction completed successfully
[17:09:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:09:52] ℹ️  Using MRN from patient data: '2577119' over '2577119'
[17:09:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:09:52] ✅ Patient name cross-validation successful
[17:09:52] ✅    ✅ Data merged successfully
[17:09:56] ✅    ✅ Order data extracted and validated
[17:09:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:09:56] [DOC: 9264441] ✅ Patient found in local cache: Marilyn Hood, ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[17:09:56] ✅    ✅ Existing patient found with ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[17:09:56] 🔄 
🔄 Step 6: Pushing order to API...
[17:09:56] [DOC: 9264441] ℹ️  Pushing order via API for patient ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[17:09:58] [DOC: 9264441] ❌ Order push failed with status 201: {"id":"89af9cad-b8af-4e5f-8a50-7f10dee59680","orderWAVId":"ORD19970","orderNo":"1086076, 1086077, 1086078, 1086079, 1086080, 1086081, 1086082, 1086211, 1086212, 1086083","orderDate":"04/26/2025","startOfCare":"04/26/2025","episodeStartDate":"04/26/2025","episodeEndDate":"05/09/2025","documentID":"9264441","mrn":"2577119","patientName":"Hood,Marilyn A","sentToPhysicianDate":"04/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/01/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6dbefab8-cca3-4e53-942e-025025b735f3","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[17:09:58] ❌    ❌ Failed to push order
[17:09:58] 🔄 
🔄 Step 7: Writing to CSV...
[17:09:58] [DOC: 9264441] ℹ️  Calculated age: 83 from DOB: 10/23/1941
[17:09:58] [DOC: 9264441] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:09:58] [DOC: 9264441] ℹ️  Payer Source extracted: ''
[17:09:58] [DOC: 9264441] ℹ️  Diagnosis codes being written:
[17:09:58] [DOC: 9264441] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:09:58] [DOC: 9264441] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:09:58] [DOC: 9264441] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:09:58] [DOC: 9264441] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:09:58] [DOC: 9264441] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:09:58] [DOC: 9264441] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:09:58] [DOC: 9264441] ✅ Patient data written to CSV: Marilyn Hood | Sex: FEMALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: 2577119
[17:09:58] ✅    ✅ Document 9264441 processed and saved successfully
[17:09:58] 🔄 
🔄 Step 8: Saving API details...
[17:09:58] [DOC: 9264441] ℹ️  API push details saved for document 9264441
[17:09:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9264425                         ║
================================================================================
[17:09:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:09:58] ℹ️  Date: 04/28/2025
[17:09:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:09:59] [DOC: 9264425] ✅ Text extracted using pdfplumber (1352 chars)
[17:09:59] ✅    ✅ Text extracted using pdfplumber (1352 chars)
[17:09:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:02] ℹ️  AI extracted raw sex value: 'F'
[17:10:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:10:02] ℹ️  AI extracted payer source: ''
[17:10:02] ℹ️  AI extracted diagnoses:
[17:10:02] ℹ️    - Diagnosis 1: 'None'
[17:10:02] ℹ️    - Diagnosis 2: 'None'
[17:10:02] ℹ️    - Diagnosis 3: 'None'
[17:10:02] ℹ️    - Diagnosis 4: 'None'
[17:10:02] ℹ️    - Diagnosis 5: 'None'
[17:10:02] ℹ️    - Diagnosis 6: 'None'
[17:10:02] ℹ️  Final extracted MRN: '2158031'
[17:10:02] ℹ️  Final extracted Sex: 'FEMALE'
[17:10:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:10:02] ℹ️  Final extracted Payer Source: ''
[17:10:02] ✅ Patient data extraction completed successfully
[17:10:02] ✅    ✅ Patient data extracted successfully
[17:10:02] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/25/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:10:02] ✅    ✅ Patient identified: Norma Dyer
[17:10:02] ✅    ✅ Patient name validation passed
[17:10:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:02] [DOC: 9264425] ℹ️  DOB normalized: 11/13/1931
[17:10:02] [DOC: 9264425] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[17:10:02] [DOC: 9264425] ✅ Patient date processing completed successfully
[17:10:02] ✅    ✅ Date processing completed
[17:10:02] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/25/2025'}]
[17:10:02] 🔄 
🔄 Step 4: Extracting order data...
[17:10:04] ℹ️  Order extraction - MRN: '2158031'
[17:10:04] ℹ️  Order extraction - Sex: 'FEMALE'
[17:10:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:10:04] ℹ️  Order extraction - Payer Source: ''
[17:10:04] ✅ Order data extraction completed successfully
[17:10:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:04] ℹ️  Using MRN from patient data: '2158031' over '2158031'
[17:10:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:10:04] ✅ Patient name cross-validation successful
[17:10:04] ✅    ✅ Data merged successfully
[17:10:05] ✅    ✅ Order data extracted and validated
[17:10:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:10:11] [DOC: 9264425] ✅ Patient exists in API: Norma Dyer, ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[17:10:11] ✅    ✅ Existing patient found with ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[17:10:11] 🔄 
🔄 Step 6: Pushing order to API...
[17:10:11] [DOC: 9264425] ℹ️  Pushing order via API for patient ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[17:10:13] [DOC: 9264425] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13706"}
[17:10:13] ❌    ❌ Failed to push order
[17:10:13] 🔄 
🔄 Step 7: Writing to CSV...
[17:10:13] [DOC: 9264425] ℹ️  Calculated age: 93 from DOB: 11/13/1931
[17:10:13] [DOC: 9264425] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:10:13] [DOC: 9264425] ℹ️  Payer Source extracted: ''
[17:10:13] [DOC: 9264425] ℹ️  Diagnosis codes being written:
[17:10:13] [DOC: 9264425] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:10:13] [DOC: 9264425] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:10:13] [DOC: 9264425] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:10:13] [DOC: 9264425] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:10:13] [DOC: 9264425] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:10:13] [DOC: 9264425] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:10:13] [DOC: 9264425] ✅ Patient data written to CSV: Norma Dyer | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 2158031
[17:10:13] ✅    ✅ Document 9264425 processed and saved successfully
[17:10:13] 🔄 
🔄 Step 8: Saving API details...
[17:10:13] [DOC: 9264425] ℹ️  API push details saved for document 9264425
[17:10:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9264423                         ║
================================================================================
[17:10:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:10:13] ℹ️  Date: 04/28/2025
[17:10:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:14] [DOC: 9264423] ✅ Text extracted using pdfplumber (947 chars)
[17:10:14] ✅    ✅ Text extracted using pdfplumber (947 chars)
[17:10:14] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:16] ℹ️  AI extracted raw sex value: 'M'
[17:10:16] ℹ️  AI extracted service line: 'RN'
[17:10:16] ℹ️  AI extracted payer source: ''
[17:10:16] ℹ️  AI extracted diagnoses:
[17:10:16] ℹ️    - Diagnosis 1: ''
[17:10:16] ℹ️    - Diagnosis 2: ''
[17:10:16] ℹ️    - Diagnosis 3: ''
[17:10:16] ℹ️    - Diagnosis 4: ''
[17:10:16] ℹ️    - Diagnosis 5: ''
[17:10:16] ℹ️    - Diagnosis 6: ''
[17:10:16] ℹ️  Final extracted MRN: '2428686'
[17:10:16] ℹ️  Final extracted Sex: 'MALE'
[17:10:16] ℹ️  Final extracted Service Line: 'RN'
[17:10:16] ℹ️  Final extracted Payer Source: ''
[17:10:16] ✅ Patient data extraction completed successfully
[17:10:16] ✅    ✅ Patient data extracted successfully
[17:10:16] 📊 Patient Response
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:16] ✅    ✅ Patient identified: Jerome Doyon
[17:10:16] ✅    ✅ Patient name validation passed
[17:10:16] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:16] [DOC: 9264423] ℹ️  DOB normalized: 03/02/1934
[17:10:16] [DOC: 9264423] ✅ Patient date processing completed successfully
[17:10:16] ✅    ✅ Date processing completed
[17:10:16] 📊 Processed Patient Data
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:16] 🔄 
🔄 Step 4: Extracting order data...
[17:10:19] ℹ️  Order extraction - MRN: '2428686'
[17:10:19] ℹ️  Order extraction - Sex: 'MALE'
[17:10:19] ℹ️  Order extraction - Service Line: ''
[17:10:19] ℹ️  Order extraction - Payer Source: ''
[17:10:19] ✅ Order data extraction completed successfully
[17:10:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:19] ℹ️  Using MRN from patient data: '2428686' over '2428686'
[17:10:19] ℹ️  Using service line from patient data: 'RN'
[17:10:19] ✅ Patient name cross-validation successful
[17:10:19] ✅    ✅ Data merged successfully
[17:10:20] ⚠️     ❌ Skipping - missing episode start date
[17:10:20] [DOC: 9264423] ℹ️  API push details saved for document 9264423
================================================================================
║                        Processing Document ID: 9264411                         ║
================================================================================
[17:10:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:10:20] ℹ️  Date: 04/28/2025
[17:10:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:21] [DOC: 9264411] ✅ Text extracted using pdfplumber (995 chars)
[17:10:21] ✅    ✅ Text extracted using pdfplumber (995 chars)
[17:10:21] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:24] ℹ️  AI extracted raw sex value: 'M'
[17:10:24] ℹ️  AI extracted service line: 'Nursing'
[17:10:24] ℹ️  AI extracted payer source: ''
[17:10:24] ℹ️  AI extracted diagnoses:
[17:10:24] ℹ️    - Diagnosis 1: ''
[17:10:24] ℹ️    - Diagnosis 2: ''
[17:10:24] ℹ️    - Diagnosis 3: ''
[17:10:24] ℹ️    - Diagnosis 4: ''
[17:10:24] ℹ️    - Diagnosis 5: ''
[17:10:24] ℹ️    - Diagnosis 6: ''
[17:10:24] ℹ️  Final extracted MRN: '2261639'
[17:10:24] ℹ️  Final extracted Sex: 'MALE'
[17:10:24] ℹ️  Final extracted Service Line: 'Nursing'
[17:10:24] ℹ️  Final extracted Payer Source: ''
[17:10:24] ✅ Patient data extraction completed successfully
[17:10:24] ✅    ✅ Patient data extracted successfully
[17:10:24] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:24] ✅    ✅ Patient identified: Webster Bowen
[17:10:24] ✅    ✅ Patient name validation passed
[17:10:24] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:24] [DOC: 9264411] ℹ️  DOB normalized: 09/12/1949
[17:10:24] [DOC: 9264411] ✅ Patient date processing completed successfully
[17:10:24] ✅    ✅ Date processing completed
[17:10:24] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:24] 🔄 
🔄 Step 4: Extracting order data...
[17:10:26] ℹ️  Order extraction - MRN: '2261639'
[17:10:26] ℹ️  Order extraction - Sex: 'MALE'
[17:10:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:10:26] ℹ️  Order extraction - Payer Source: ''
[17:10:26] ✅ Order data extraction completed successfully
[17:10:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:26] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[17:10:26] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[17:10:26] ✅ Patient name cross-validation successful
[17:10:26] ✅    ✅ Data merged successfully
[17:10:27] ⚠️     ❌ Skipping - missing episode start date
[17:10:27] [DOC: 9264411] ℹ️  API push details saved for document 9264411
================================================================================
║                        Processing Document ID: 9264410                         ║
================================================================================
[17:10:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:10:27] ℹ️  Date: 04/28/2025
[17:10:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:29] [DOC: 9264410] ✅ Text extracted using pdfplumber (3003 chars)
[17:10:29] ✅    ✅ Text extracted using pdfplumber (3003 chars)
[17:10:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:32] ℹ️  AI extracted raw sex value: 'F'
[17:10:32] ℹ️  AI extracted service line: 'Physical Therapy'
[17:10:32] ℹ️  AI extracted payer source: ''
[17:10:32] ℹ️  AI extracted diagnoses:
[17:10:32] ℹ️    - Diagnosis 1: ''
[17:10:32] ℹ️    - Diagnosis 2: ''
[17:10:32] ℹ️    - Diagnosis 3: ''
[17:10:32] ℹ️    - Diagnosis 4: ''
[17:10:32] ℹ️    - Diagnosis 5: ''
[17:10:32] ℹ️    - Diagnosis 6: ''
[17:10:32] ℹ️  Final extracted MRN: '2240353'
[17:10:32] ℹ️  Final extracted Sex: 'FEMALE'
[17:10:32] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:10:32] ℹ️  Final extracted Payer Source: ''
[17:10:32] ✅ Patient data extraction completed successfully
[17:10:32] ✅    ✅ Patient data extracted successfully
[17:10:32] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:32] ✅    ✅ Patient identified: Eileen Bettencourt
[17:10:32] ✅    ✅ Patient name validation passed
[17:10:32] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:32] [DOC: 9264410] ℹ️  DOB normalized: 04/20/1945
[17:10:32] [DOC: 9264410] ✅ Patient date processing completed successfully
[17:10:32] ✅    ✅ Date processing completed
[17:10:32] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:32] 🔄 
🔄 Step 4: Extracting order data...
[17:10:34] ℹ️  Order extraction - MRN: '2240353'
[17:10:34] ℹ️  Order extraction - Sex: 'FEMALE'
[17:10:34] ℹ️  Order extraction - Service Line: ''
[17:10:34] ℹ️  Order extraction - Payer Source: ''
[17:10:34] ✅ Order data extraction completed successfully
[17:10:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:34] ℹ️  Using MRN from patient data: '2240353' over '2240353'
[17:10:34] ℹ️  Using service line from patient data: 'Physical Therapy'
[17:10:34] ✅ Patient name cross-validation successful
[17:10:34] ✅    ✅ Data merged successfully
[17:10:35] ⚠️     ❌ Skipping - missing episode start date
[17:10:35] [DOC: 9264410] ℹ️  API push details saved for document 9264410
================================================================================
║                        Processing Document ID: 9264399                         ║
================================================================================
[17:10:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:10:35] ℹ️  Date: 04/28/2025
[17:10:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:37] [DOC: 9264399] ✅ Text extracted using pdfplumber (1434 chars)
[17:10:37] ✅    ✅ Text extracted using pdfplumber (1434 chars)
[17:10:37] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:40] ℹ️  AI extracted raw sex value: 'M'
[17:10:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:10:40] ℹ️  AI extracted payer source: ''
[17:10:40] ℹ️  AI extracted diagnoses:
[17:10:40] ℹ️    - Diagnosis 1: ''
[17:10:40] ℹ️    - Diagnosis 2: ''
[17:10:40] ℹ️    - Diagnosis 3: ''
[17:10:40] ℹ️    - Diagnosis 4: ''
[17:10:40] ℹ️    - Diagnosis 5: ''
[17:10:40] ℹ️    - Diagnosis 6: ''
[17:10:40] ℹ️  Final extracted MRN: '2170342'
[17:10:40] ℹ️  Final extracted Sex: 'MALE'
[17:10:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:10:40] ℹ️  Final extracted Payer Source: ''
[17:10:40] ✅ Patient data extraction completed successfully
[17:10:40] ✅    ✅ Patient data extracted successfully
[17:10:40] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Aguiar
     └─ dob: 08/11/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2170342
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:40] ✅    ✅ Patient identified: Joao Aguiar
[17:10:40] ✅    ✅ Patient name validation passed
[17:10:40] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:40] [DOC: 9264399] ℹ️  DOB normalized: 08/11/1954
[17:10:40] [DOC: 9264399] ✅ Patient date processing completed successfully
[17:10:40] ✅    ✅ Date processing completed
[17:10:40] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Aguiar
     └─ dob: 08/11/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2170342
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:10:40] 🔄 
🔄 Step 4: Extracting order data...
[17:10:42] ℹ️  Order extraction - MRN: '2170342'
[17:10:42] ℹ️  Order extraction - Sex: 'MALE'
[17:10:42] ℹ️  Order extraction - Service Line: 'SN'
[17:10:42] ℹ️  Order extraction - Payer Source: ''
[17:10:42] ✅ Order data extraction completed successfully
[17:10:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:42] ℹ️  Using MRN from patient data: '2170342' over '2170342'
[17:10:42] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[17:10:42] ✅ Patient name cross-validation successful
[17:10:42] ✅    ✅ Data merged successfully
[17:10:43] ⚠️     ❌ Skipping - missing episode start date
[17:10:43] [DOC: 9264399] ℹ️  API push details saved for document 9264399
================================================================================
║                        Processing Document ID: 9264311                         ║
================================================================================
[17:10:43] ℹ️  Agency: Relief Home Health Services
[17:10:43] ℹ️  Date: 04/28/2025
[17:10:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:10:46] [DOC: 9264311] ✅ Text extracted using pdfplumber (21122 chars)
[17:10:46] ✅    ✅ Text extracted using pdfplumber (21122 chars)
[17:10:46] 🔄 
🔄 Step 2: Extracting patient data...
[17:10:50] ℹ️  AI extracted raw sex value: 'M'
[17:10:50] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[17:10:50] ℹ️  AI extracted payer source: ''
[17:10:50] ℹ️  AI extracted diagnoses:
[17:10:50] ℹ️    - Diagnosis 1: 'E11.10'
[17:10:50] ℹ️    - Diagnosis 2: 'I12.9'
[17:10:50] ℹ️    - Diagnosis 3: 'N18.2'
[17:10:50] ℹ️    - Diagnosis 4: 'I82.491'
[17:10:50] ℹ️    - Diagnosis 5: 'J45.909'
[17:10:50] ℹ️    - Diagnosis 6: 'M54.50'
[17:10:50] ℹ️  Final extracted MRN: 'NB0988'
[17:10:50] ℹ️  Final extracted Sex: 'MALE'
[17:10:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[17:10:50] ℹ️  Final extracted Payer Source: ''
[17:10:50] ✅ Patient data extraction completed successfully
[17:10:50] ✅    ✅ Patient data extracted successfully
[17:10:50] 📊 Patient Response
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0988
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 161C OAKDALE ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 971-1761
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.2', 'fourthDiagnosis': 'I82.491', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'M54.50'}]
[17:10:50] ✅    ✅ Patient identified: LEAH MIRANDA
[17:10:50] ✅    ✅ Patient name validation passed
[17:10:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:10:50] [DOC: 9264311] ℹ️  DOB normalized: 04/15/1947
[17:10:50] [DOC: 9264311] ℹ️  Episode startOfCare normalized: 12/28/2022
[17:10:50] [DOC: 9264311] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[17:10:50] [DOC: 9264311] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[17:10:50] [DOC: 9264311] ✅ Patient date processing completed successfully
[17:10:50] ✅    ✅ Date processing completed
[17:10:50] 📊 Processed Patient Data
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0988
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 161C OAKDALE ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 971-1761
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.2', 'fourthDiagnosis': 'I82.491', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'M54.50'}]
[17:10:50] 🔄 
🔄 Step 4: Extracting order data...
[17:10:52] ℹ️  Order extraction - MRN: 'NB0988'
[17:10:52] ℹ️  Order extraction - Sex: 'MALE'
[17:10:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing, OT'
[17:10:52] ℹ️  Order extraction - Payer Source: ''
[17:10:52] ✅ Order data extraction completed successfully
[17:10:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:10:52] ℹ️  Using MRN from patient data: 'NB0988' over 'NB0988'
[17:10:52] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy' + Order='Skilled Nursing, OT' = 'OT, Occupational Therapy, Skilled Nursing'
[17:10:52] ✅ Patient name cross-validation successful
[17:10:52] ✅    ✅ Data merged successfully
[17:10:54] ✅    ✅ Order data extracted and validated
[17:10:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:11:01] [DOC: 9264311] ✅ Patient exists in API: LEAH MIRANDA, ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[17:11:01] ✅    ✅ Existing patient found with ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[17:11:01] 🔄 
🔄 Step 6: Pushing order to API...
[17:11:01] [DOC: 9264311] ℹ️  Pushing order via API for patient ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[17:11:03] [DOC: 9264311] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:11:03] ❌    ❌ Failed to push order
[17:11:03] 🔄 
🔄 Step 7: Writing to CSV...
[17:11:03] [DOC: 9264311] ℹ️  Calculated age: 78 from DOB: 04/15/1947
[17:11:03] [DOC: 9264311] ℹ️  Service Line extracted: 'OT, Occupational Therapy, Skilled Nursing'
[17:11:03] [DOC: 9264311] ℹ️  Payer Source extracted: ''
[17:11:03] [DOC: 9264311] ℹ️  Diagnosis codes being written:
[17:11:03] [DOC: 9264311] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.10'
[17:11:03] [DOC: 9264311] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[17:11:03] [DOC: 9264311] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.2'
[17:11:03] [DOC: 9264311] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I82.491'
[17:11:03] [DOC: 9264311] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J45.909'
[17:11:03] [DOC: 9264311] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.50'
[17:11:03] [DOC: 9264311] ✅ Patient data written to CSV: LEAH MIRANDA | Sex: MALE | Age: 78 | Service: OT, Occupational Therapy, Skilled Nursing | Payer:  | MRN: NB0988
[17:11:03] ✅    ✅ Document 9264311 processed and saved successfully
[17:11:03] 🔄 
🔄 Step 8: Saving API details...
[17:11:03] [DOC: 9264311] ℹ️  API push details saved for document 9264311
[17:11:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9264297                         ║
================================================================================
[17:11:03] ℹ️  Agency: Relief Home Health Services
[17:11:03] ℹ️  Date: 04/28/2025
[17:11:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:11:05] [DOC: 9264297] ✅ Text extracted using pdfplumber (19670 chars)
[17:11:05] ✅    ✅ Text extracted using pdfplumber (19670 chars)
[17:11:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:11:09] ℹ️  AI extracted raw sex value: 'F'
[17:11:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:11:09] ℹ️  AI extracted payer source: ''
[17:11:09] ℹ️  AI extracted diagnoses:
[17:11:09] ℹ️    - Diagnosis 1: 'I50.32'
[17:11:09] ℹ️    - Diagnosis 2: 'J44.9'
[17:11:09] ℹ️    - Diagnosis 3: 'E11.9'
[17:11:09] ℹ️    - Diagnosis 4: 'I10'
[17:11:09] ℹ️    - Diagnosis 5: 'F32.A'
[17:11:09] ℹ️    - Diagnosis 6: 'F32.89'
[17:11:09] ℹ️  Final extracted MRN: 'NB2071'
[17:11:09] ℹ️  Final extracted Sex: 'FEMALE'
[17:11:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:11:09] ℹ️  Final extracted Payer Source: ''
[17:11:09] ✅ Patient data extraction completed successfully
[17:11:09] ✅    ✅ Patient data extracted successfully
[17:11:09] 📊 Patient Response
     └─ patientFName: MARY
     └─ patientLName: CARREIRO
     └─ dob: 10/18/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: NB2071
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 89 SEA BREEZE DR
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 996-6084
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/29/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'F32.89'}]
[17:11:09] ✅    ✅ Patient identified: MARY CARREIRO
[17:11:09] ✅    ✅ Patient name validation passed
[17:11:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:11:09] [DOC: 9264297] ℹ️  DOB normalized: 10/18/1937
[17:11:09] [DOC: 9264297] ℹ️  Episode startOfCare normalized: 02/29/2024
[17:11:09] [DOC: 9264297] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[17:11:09] [DOC: 9264297] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[17:11:09] [DOC: 9264297] ✅ Patient date processing completed successfully
[17:11:09] ✅    ✅ Date processing completed
[17:11:09] 📊 Processed Patient Data
     └─ patientFName: MARY
     └─ patientLName: CARREIRO
     └─ dob: 10/18/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: NB2071
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 89 SEA BREEZE DR
     └─ city: SOUTH DARTMOUTH
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 996-6084
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/29/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'I50.32', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'F32.89'}]
[17:11:09] 🔄 
🔄 Step 4: Extracting order data...
[17:11:11] ℹ️  Order extraction - MRN: 'NB2071'
[17:11:11] ℹ️  Order extraction - Sex: 'MALE'
[17:11:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:11:11] ℹ️  Order extraction - Payer Source: ''
[17:11:11] ✅ Order data extraction completed successfully
[17:11:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:11:11] ℹ️  Using MRN from patient data: 'NB2071' over 'NB2071'
[17:11:11] ⚠️  Sex mismatch: Patient='FEMALE' vs Order='MALE', using patient data
[17:11:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:11:11] ✅ Patient name cross-validation successful
[17:11:11] ✅    ✅ Data merged successfully
[17:11:14] ✅    ✅ Order data extracted and validated
[17:11:14] 🔄 
🔄 Step 5: Checking/Creating patient...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             