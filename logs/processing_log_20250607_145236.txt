================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[14:52:36] ℹ️  CSV Data Extraction & API Push Tool
[14:52:36] ℹ️  
[14:52:36] ℹ️  Features:
[14:52:36] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[14:52:36] ℹ️  - AI-powered patient and order data extraction
[14:52:36] ℹ️  - Enhanced error handling and logging
[14:52:36] ℹ️  - Full API integration (patient creation + order pushing)
[14:52:36] ℹ️  - CSV output with comprehensive patient data
[14:52:36] ℹ️  - Detailed API tracking with remarks for every document
[14:52:36] ℹ️  - Complete audit trail of all processing attempts
[14:52:36] ℹ️  
[14:52:36] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[14:52:36] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_145236.csv
[14:52:36] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_145236.csv
================================================================================
║                        Processing Document ID: 9279471                         ║
================================================================================
[14:52:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:52:36] ℹ️  Date: 05/06/2025
[14:52:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:52:40] [DOC: 9279471] ✅ Text extracted using pdfplumber (36444 chars)
[14:52:40] ✅    ✅ Text extracted using pdfplumber (36444 chars)
[14:52:40] 🔄 
🔄 Step 2: Extracting patient data...
[14:52:43] ℹ️  AI extracted raw sex value: 'F'
[14:52:43] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[14:52:43] ℹ️  AI extracted payer source: ''
[14:52:43] ℹ️  AI extracted diagnoses:
[14:52:43] ℹ️    - Diagnosis 1: 'G31.1'
[14:52:43] ℹ️    - Diagnosis 2: 'I10'
[14:52:43] ℹ️    - Diagnosis 3: 'E78.5'
[14:52:43] ℹ️    - Diagnosis 4: 'I25.10'
[14:52:43] ℹ️    - Diagnosis 5: 'D63.8'
[14:52:43] ℹ️    - Diagnosis 6: 'I48.91'
[14:52:43] ℹ️  Final extracted MRN: '2345824'
[14:52:43] ℹ️  Final extracted Sex: 'FEMALE'
[14:52:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[14:52:43] ℹ️  Final extracted Payer Source: ''
[14:52:43] ✅ Patient data extraction completed successfully
[14:52:43] ✅    ✅ Patient data extracted successfully
[14:52:43] 📊 Patient Response
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'D63.8', 'sixthDiagnosis': 'I48.91'}]
[14:52:43] ✅    ✅ Patient identified: Bernadette Constantine
[14:52:43] ✅    ✅ Patient name validation passed
[14:52:43] 🔄 
🔄 Step 3: Processing patient dates...
[14:52:43] [DOC: 9279471] ℹ️  DOB normalized: 11/05/1924
[14:52:43] [DOC: 9279471] ℹ️  Episode startOfCare normalized: 04/14/2025
[14:52:43] [DOC: 9279471] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[14:52:43] [DOC: 9279471] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[14:52:43] [DOC: 9279471] ✅ Patient date processing completed successfully
[14:52:43] ✅    ✅ Date processing completed
[14:52:43] 📊 Processed Patient Data
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'D63.8', 'sixthDiagnosis': 'I48.91'}]
[14:52:43] 🔄 
🔄 Step 4: Extracting order data...
[14:52:46] ℹ️  Order extraction - MRN: '2345824'
[14:52:46] ℹ️  Order extraction - Sex: 'FEMALE'
[14:52:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[14:52:46] ℹ️  Order extraction - Payer Source: ''
[14:52:46] ✅ Order data extraction completed successfully
[14:52:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:52:46] ℹ️  Using MRN from patient data: '2345824' over '2345824'
[14:52:46] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Clergy, HHA' + Order='Skilled Nursing, MSW, HHA' = 'Clergy, HHA, MSW, Skilled Nursing'
[14:52:46] ✅ Patient name cross-validation successful
[14:52:46] ✅    ✅ Data merged successfully
[14:52:47] ✅    ✅ Order data extracted and validated
[14:52:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:02] [DOC: 9279471] ℹ️  Patient not found in cache or API: Bernadette Constantine
[14:53:02] [DOC: 9279471] ℹ️  Patient not found, creating new patient via API...
[14:53:02] [DOC: 9279471] ℹ️  Creating patient via API: Bernadette Constantine
[14:53:03] [DOC: 9279471] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:53:03] ❌    ❌ Failed to create patient
[14:53:03] [DOC: 9279471] ℹ️  API push details saved for document 9279471
================================================================================
║                        Processing Document ID: 9279078                         ║
================================================================================
[14:53:03] ℹ️  Agency: Compassionate Care Hospice-Taunton
[14:53:03] ℹ️  Date: 05/06/2025
[14:53:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:05] [DOC: 9279078] ✅ Text extracted using pdfplumber (1283 chars)
[14:53:05] ✅    ✅ Text extracted using pdfplumber (1271 chars)
[14:53:05] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:08] ℹ️  AI extracted raw sex value: ''
[14:53:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:53:08] ℹ️  AI extracted payer source: 'Medicare'
[14:53:08] ℹ️  AI extracted diagnoses:
[14:53:08] ℹ️    - Diagnosis 1: 'None'
[14:53:08] ℹ️    - Diagnosis 2: 'None'
[14:53:08] ℹ️    - Diagnosis 3: 'None'
[14:53:08] ℹ️    - Diagnosis 4: 'None'
[14:53:08] ℹ️    - Diagnosis 5: 'None'
[14:53:08] ℹ️    - Diagnosis 6: 'None'
[14:53:08] ℹ️  Final extracted MRN: 'B3700407012202'
[14:53:08] ℹ️  Final extracted Sex: ''
[14:53:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:53:08] ℹ️  Final extracted Payer Source: 'Medicare'
[14:53:08] ✅ Patient data extraction completed successfully
[14:53:08] ✅    ✅ Patient data extracted successfully
[14:53:08] 📊 Patient Response
     └─ patientFName: BARBARA
     └─ patientLName: MARSHALL
     └─ dob: 01/25/1933
     └─ patientSex: 
     └─ medicalRecordNo: B3700407012202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/04/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:53:08] ✅    ✅ Patient identified: BARBARA MARSHALL
[14:53:08] ✅    ✅ Patient name validation passed
[14:53:08] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:08] [DOC: 9279078] ℹ️  DOB normalized: 01/25/1933
[14:53:08] [DOC: 9279078] ℹ️  Episode startOfEpisode normalized: 05/04/2025
[14:53:08] [DOC: 9279078] ✅ Patient date processing completed successfully
[14:53:08] ✅    ✅ Date processing completed
[14:53:08] 📊 Processed Patient Data
     └─ patientFName: BARBARA
     └─ patientLName: MARSHALL
     └─ dob: 01/25/1933
     └─ patientSex: 
     └─ medicalRecordNo: B3700407012202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/04/2025'}]
[14:53:08] 🔄 
🔄 Step 4: Extracting order data...
[14:53:11] ℹ️  Order extraction - MRN: 'B3700407012202'
[14:53:11] ℹ️  Order extraction - Sex: ''
[14:53:11] ℹ️  Order extraction - Service Line: 'RN'
[14:53:11] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:53:11] ✅ Order data extraction completed successfully
[14:53:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:11] ℹ️  Using MRN from patient data: 'B3700407012202' over 'B3700407012202'
[14:53:11] ℹ️  Inferred sex as FEMALE from name: BARBARA
[14:53:11] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[14:53:11] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:53:11] ✅ Patient name cross-validation successful
[14:53:11] ✅    ✅ Data merged successfully
[14:53:12] ✅    ✅ Order data extracted and validated
[14:53:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:22] [DOC: 9279078] ✅ Patient exists in API: BARBARA MARSHALL, ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[14:53:22] ✅    ✅ Existing patient found with ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[14:53:22] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:22] [DOC: 9279078] ℹ️  Pushing order via API for patient ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[14:53:23] [DOC: 9279078] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14027"}
[14:53:23] ❌    ❌ Failed to push order
[14:53:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:23] [DOC: 9279078] ℹ️  Calculated age: 92 from DOB: 01/25/1933
[14:53:23] [DOC: 9279078] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[14:53:23] [DOC: 9279078] ℹ️  Payer Source extracted: 'Medicare'
[14:53:23] [DOC: 9279078] ℹ️  Diagnosis codes being written:
[14:53:23] [DOC: 9279078] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:23] [DOC: 9279078] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:23] [DOC: 9279078] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:23] [DOC: 9279078] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:23] [DOC: 9279078] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:23] [DOC: 9279078] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:23] [DOC: 9279078] ✅ Patient data written to CSV: BARBARA MARSHALL | Sex: FEMALE | Age: 92 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: B3700407012202
[14:53:23] ✅    ✅ Document 9279078 processed and saved successfully
[14:53:23] 🔄 
🔄 Step 8: Saving API details...
[14:53:23] [DOC: 9279078] ℹ️  API push details saved for document 9279078
[14:53:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9279075                         ║
================================================================================
[14:53:23] ℹ️  Agency: Compassionate Care Hospice-Taunton
[14:53:23] ℹ️  Date: 05/06/2025
[14:53:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:25] [DOC: 9279075] ✅ Text extracted using pdfplumber (2027 chars)
[14:53:25] ✅    ✅ Text extracted using pdfplumber (2015 chars)
[14:53:25] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:28] ℹ️  AI extracted raw sex value: ''
[14:53:28] ℹ️  AI extracted service line: 'Hospice'
[14:53:28] ℹ️  AI extracted payer source: 'Medicare'
[14:53:28] ℹ️  AI extracted diagnoses:
[14:53:28] ℹ️    - Diagnosis 1: ''
[14:53:28] ℹ️    - Diagnosis 2: ''
[14:53:28] ℹ️    - Diagnosis 3: ''
[14:53:28] ℹ️    - Diagnosis 4: ''
[14:53:28] ℹ️    - Diagnosis 5: ''
[14:53:28] ℹ️    - Diagnosis 6: ''
[14:53:28] ℹ️  Final extracted MRN: 'B3700407012202'
[14:53:28] ℹ️  Final extracted Sex: ''
[14:53:28] ℹ️  Final extracted Service Line: 'Hospice'
[14:53:28] ℹ️  Final extracted Payer Source: 'Medicare'
[14:53:28] ✅ Patient data extraction completed successfully
[14:53:28] ✅    ✅ Patient data extracted successfully
[14:53:28] 📊 Patient Response
     └─ patientFName: BARBARA
     └─ patientLName: MARSHALL
     └─ dob: 01/25/1933
     └─ patientSex: 
     └─ medicalRecordNo: B3700407012202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:28] ✅    ✅ Patient identified: BARBARA MARSHALL
[14:53:28] ✅    ✅ Patient name validation passed
[14:53:28] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:28] [DOC: 9279075] ℹ️  DOB normalized: 01/25/1933
[14:53:28] [DOC: 9279075] ✅ Patient date processing completed successfully
[14:53:28] ✅    ✅ Date processing completed
[14:53:28] 📊 Processed Patient Data
     └─ patientFName: BARBARA
     └─ patientLName: MARSHALL
     └─ dob: 01/25/1933
     └─ patientSex: 
     └─ medicalRecordNo: B3700407012202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:28] 🔄 
🔄 Step 4: Extracting order data...
[14:53:30] ℹ️  Order extraction - MRN: 'B3700407012202'
[14:53:30] ℹ️  Order extraction - Sex: ''
[14:53:30] ℹ️  Order extraction - Service Line: 'Hospice'
[14:53:30] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:53:30] ✅ Order data extraction completed successfully
[14:53:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:30] ℹ️  Using MRN from patient data: 'B3700407012202' over 'B3700407012202'
[14:53:30] ℹ️  Inferred sex as FEMALE from name: BARBARA
[14:53:30] ℹ️  Service line consistent in both sources: 'Hospice'
[14:53:30] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:53:30] ✅ Patient name cross-validation successful
[14:53:30] ✅    ✅ Data merged successfully
[14:53:31] ✅    ✅ Order data extracted and validated
[14:53:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:31] [DOC: 9279075] ✅ Patient found in local cache: BARBARA MARSHALL, ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[14:53:31] ✅    ✅ Existing patient found with ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[14:53:31] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:31] [DOC: 9279075] ℹ️  Pushing order via API for patient ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[14:53:32] [DOC: 9279075] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14028"}
[14:53:32] ❌    ❌ Failed to push order
[14:53:32] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:32] [DOC: 9279075] ℹ️  Calculated age: 92 from DOB: 01/25/1933
[14:53:32] [DOC: 9279075] ℹ️  Service Line extracted: 'Hospice'
[14:53:32] [DOC: 9279075] ℹ️  Payer Source extracted: 'Medicare'
[14:53:32] [DOC: 9279075] ℹ️  Diagnosis codes being written:
[14:53:32] [DOC: 9279075] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:32] [DOC: 9279075] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:32] [DOC: 9279075] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:32] [DOC: 9279075] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:32] [DOC: 9279075] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:32] [DOC: 9279075] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:32] [DOC: 9279075] ✅ Patient data written to CSV: BARBARA MARSHALL | Sex: FEMALE | Age: 92 | Service: Hospice | Payer: Medicare | MRN: B3700407012202
[14:53:32] ✅    ✅ Document 9279075 processed and saved successfully
[14:53:32] 🔄 
🔄 Step 8: Saving API details...
[14:53:32] [DOC: 9279075] ℹ️  API push details saved for document 9279075
[14:53:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9279071                         ║
================================================================================
[14:53:32] ℹ️  Agency: Compassionate Care Hospice-Taunton
[14:53:32] ℹ️  Date: 05/06/2025
[14:53:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:34] [DOC: 9279071] ✅ Text extracted using pdfplumber (1552 chars)
[14:53:34] ✅    ✅ Text extracted using pdfplumber (1540 chars)
[14:53:34] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:37] ℹ️  AI extracted raw sex value: ''
[14:53:37] ℹ️  AI extracted service line: 'Hospice'
[14:53:37] ℹ️  AI extracted payer source: 'Medicare'
[14:53:37] ℹ️  AI extracted diagnoses:
[14:53:37] ℹ️    - Diagnosis 1: ''
[14:53:37] ℹ️    - Diagnosis 2: ''
[14:53:37] ℹ️    - Diagnosis 3: ''
[14:53:37] ℹ️    - Diagnosis 4: ''
[14:53:37] ℹ️    - Diagnosis 5: ''
[14:53:37] ℹ️    - Diagnosis 6: ''
[14:53:37] ℹ️  Final extracted MRN: 'B3700288839202'
[14:53:37] ℹ️  Final extracted Sex: ''
[14:53:37] ℹ️  Final extracted Service Line: 'Hospice'
[14:53:37] ℹ️  Final extracted Payer Source: 'Medicare'
[14:53:37] ✅ Patient data extraction completed successfully
[14:53:37] ✅    ✅ Patient data extracted successfully
[14:53:37] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: NUNES
     └─ dob: 02/02/1950
     └─ patientSex: 
     └─ medicalRecordNo: B3700288839202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:37] ✅    ✅ Patient identified: JOHN NUNES
[14:53:37] ✅    ✅ Patient name validation passed
[14:53:37] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:37] [DOC: 9279071] ℹ️  DOB normalized: 02/02/1950
[14:53:37] [DOC: 9279071] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[14:53:37] [DOC: 9279071] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[14:53:37] [DOC: 9279071] ✅ Patient date processing completed successfully
[14:53:37] ✅    ✅ Date processing completed
[14:53:37] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: NUNES
     └─ dob: 02/02/1950
     └─ patientSex: 
     └─ medicalRecordNo: B3700288839202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:37] 🔄 
🔄 Step 4: Extracting order data...
[14:53:40] ℹ️  Order extraction - MRN: 'B3700288839202'
[14:53:40] ℹ️  Order extraction - Sex: ''
[14:53:40] ℹ️  Order extraction - Service Line: 'Hospice'
[14:53:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:53:40] ✅ Order data extraction completed successfully
[14:53:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:40] ℹ️  Using MRN from patient data: 'B3700288839202' over 'B3700288839202'
[14:53:40] ℹ️  Inferred sex as MALE from name: JOHN
[14:53:40] ℹ️  Service line consistent in both sources: 'Hospice'
[14:53:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:53:40] ✅ Patient name cross-validation successful
[14:53:40] ✅    ✅ Data merged successfully
[14:53:41] ✅    ✅ Order data extracted and validated
[14:53:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:41] [DOC: 9279071] ✅ Patient found in local cache: JOHN NUNES, ID: f45b0f86-749a-4e1a-8d60-5b8a14059d95
[14:53:41] ✅    ✅ Existing patient found with ID: f45b0f86-749a-4e1a-8d60-5b8a14059d95
[14:53:41] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:41] [DOC: 9279071] ℹ️  Pushing order via API for patient ID: f45b0f86-749a-4e1a-8d60-5b8a14059d95
[14:53:42] [DOC: 9279071] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12959"}
[14:53:42] ❌    ❌ Failed to push order
[14:53:42] 🔄 
🔄 Step 7: Writing to CSV...
[14:53:42] [DOC: 9279071] ℹ️  Calculated age: 75 from DOB: 02/02/1950
[14:53:42] [DOC: 9279071] ℹ️  Service Line extracted: 'Hospice'
[14:53:42] [DOC: 9279071] ℹ️  Payer Source extracted: 'Medicare'
[14:53:42] [DOC: 9279071] ℹ️  Diagnosis codes being written:
[14:53:42] [DOC: 9279071] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:53:42] [DOC: 9279071] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:53:42] [DOC: 9279071] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:53:42] [DOC: 9279071] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:53:42] [DOC: 9279071] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:53:42] [DOC: 9279071] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:53:42] [DOC: 9279071] ✅ Patient data written to CSV: JOHN NUNES | Sex: MALE | Age: 75 | Service: Hospice | Payer: Medicare | MRN: B3700288839202
[14:53:42] ✅    ✅ Document 9279071 processed and saved successfully
[14:53:42] 🔄 
🔄 Step 8: Saving API details...
[14:53:42] [DOC: 9279071] ℹ️  API push details saved for document 9279071
[14:53:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278922                         ║
================================================================================
[14:53:42] ℹ️  Agency: AccentCare Fall River
[14:53:42] ℹ️  Date: 05/06/2025
[14:53:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:53:47] [DOC: 9278922] ✅ Text extracted using pdfplumber (1161 chars)
[14:53:47] ✅    ✅ Text extracted using pdfplumber (1161 chars)
[14:53:47] 🔄 
🔄 Step 2: Extracting patient data...
[14:53:50] ℹ️  AI extracted raw sex value: ''
[14:53:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:53:50] ℹ️  AI extracted payer source: ''
[14:53:50] ℹ️  AI extracted diagnoses:
[14:53:50] ℹ️    - Diagnosis 1: ''
[14:53:50] ℹ️    - Diagnosis 2: ''
[14:53:50] ℹ️    - Diagnosis 3: ''
[14:53:50] ℹ️    - Diagnosis 4: ''
[14:53:50] ℹ️    - Diagnosis 5: ''
[14:53:50] ℹ️    - Diagnosis 6: ''
[14:53:50] ℹ️  Final extracted MRN: 'C0200049410901'
[14:53:50] ℹ️  Final extracted Sex: ''
[14:53:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:53:50] ℹ️  Final extracted Payer Source: ''
[14:53:50] ✅ Patient data extraction completed successfully
[14:53:50] ✅    ✅ Patient data extracted successfully
[14:53:50] 📊 Patient Response
     └─ patientFName: JEFFREY
     └─ patientLName: STRANGER
     └─ dob: 04/20/1955
     └─ patientSex: 
     └─ medicalRecordNo: C0200049410901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 305 CEDAR ST, APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/25/2024', 'endOfEpisode': '07/29/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:50] ✅    ✅ Patient identified: JEFFREY STRANGER
[14:53:50] ✅    ✅ Patient name validation passed
[14:53:50] 🔄 
🔄 Step 3: Processing patient dates...
[14:53:50] [DOC: 9278922] ℹ️  DOB normalized: 04/20/1955
[14:53:50] [DOC: 9278922] ℹ️  Episode startOfEpisode normalized: 07/25/2024
[14:53:50] [DOC: 9278922] ℹ️  Episode endOfEpisode normalized: 07/29/2024
[14:53:50] [DOC: 9278922] ✅ Patient date processing completed successfully
[14:53:50] ✅    ✅ Date processing completed
[14:53:50] 📊 Processed Patient Data
     └─ patientFName: JEFFREY
     └─ patientLName: STRANGER
     └─ dob: 04/20/1955
     └─ patientSex: 
     └─ medicalRecordNo: C0200049410901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 305 CEDAR ST, APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/25/2024', 'endOfEpisode': '07/29/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:53:50] 🔄 
🔄 Step 4: Extracting order data...
[14:53:52] ℹ️  Order extraction - MRN: 'C0200049410901'
[14:53:52] ℹ️  Order extraction - Sex: ''
[14:53:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:53:52] ℹ️  Order extraction - Payer Source: ''
[14:53:52] ✅ Order data extraction completed successfully
[14:53:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:53:52] ℹ️  Using MRN from patient data: 'C0200049410901' over 'C0200049410901'
[14:53:52] ℹ️  Inferred sex as MALE from name: JEFFREY
[14:53:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:53:52] ✅ Patient name cross-validation successful
[14:53:52] ✅    ✅ Data merged successfully
[14:53:54] ✅    ✅ Order data extracted and validated
[14:53:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:53:59] [DOC: 9278922] ✅ Patient exists in API: JEFFREY STRANGER, ID: 9debf551-628d-4ec0-82c5-037b0346a9b7
[14:53:59] ✅    ✅ Existing patient found with ID: 9debf551-628d-4ec0-82c5-037b0346a9b7
[14:53:59] 🔄 
🔄 Step 6: Pushing order to API...
[14:53:59] [DOC: 9278922] ℹ️  Pushing order via API for patient ID: 9debf551-628d-4ec0-82c5-037b0346a9b7
[14:54:00] [DOC: 9278922] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14453"}
[14:54:00] ❌    ❌ Failed to push order
[14:54:00] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:00] [DOC: 9278922] ℹ️  Calculated age: 70 from DOB: 04/20/1955
[14:54:00] [DOC: 9278922] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:54:00] [DOC: 9278922] ℹ️  Payer Source extracted: ''
[14:54:00] [DOC: 9278922] ℹ️  Diagnosis codes being written:
[14:54:00] [DOC: 9278922] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:54:00] [DOC: 9278922] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:54:00] [DOC: 9278922] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:54:00] [DOC: 9278922] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:00] [DOC: 9278922] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:00] [DOC: 9278922] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:00] [DOC: 9278922] ✅ Patient data written to CSV: JEFFREY STRANGER | Sex: MALE | Age: 70 | Service: Skilled Nursing | Payer:  | MRN: C0200049410901
[14:54:00] ✅    ✅ Document 9278922 processed and saved successfully
[14:54:00] 🔄 
🔄 Step 8: Saving API details...
[14:54:00] [DOC: 9278922] ℹ️  API push details saved for document 9278922
[14:54:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278811                         ║
================================================================================
[14:54:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:54:00] ℹ️  Date: 05/06/2025
[14:54:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:03] [DOC: 9278811] ✅ Text extracted using pdfplumber (14592 chars)
[14:54:03] ✅    ✅ Text extracted using pdfplumber (14592 chars)
[14:54:03] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:06] ℹ️  AI extracted raw sex value: 'F'
[14:54:06] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:54:06] ℹ️  AI extracted payer source: 'None'
[14:54:06] ℹ️  AI extracted diagnoses:
[14:54:06] ℹ️    - Diagnosis 1: 'J101'
[14:54:06] ℹ️    - Diagnosis 2: 'I10'
[14:54:06] ℹ️    - Diagnosis 3: 'None'
[14:54:06] ℹ️    - Diagnosis 4: 'None'
[14:54:06] ℹ️    - Diagnosis 5: 'None'
[14:54:06] ℹ️    - Diagnosis 6: 'None'
[14:54:06] ℹ️  Final extracted MRN: 'MA240417095701'
[14:54:06] ℹ️  Final extracted Sex: 'FEMALE'
[14:54:06] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:54:06] ℹ️  Final extracted Payer Source: ''
[14:54:06] ✅ Patient data extraction completed successfully
[14:54:06] ✅    ✅ Patient data extracted successfully
[14:54:06] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'J101', 'secondDiagnosis': 'I10', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:54:06] ✅    ✅ Patient identified: Cheryl Perkins
[14:54:06] ✅    ✅ Patient name validation passed
[14:54:06] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:06] [DOC: 9278811] ℹ️  DOB normalized: 09/07/1957
[14:54:06] [DOC: 9278811] ℹ️  Episode startOfCare normalized: 01/20/2025
[14:54:06] [DOC: 9278811] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[14:54:06] [DOC: 9278811] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[14:54:06] [DOC: 9278811] ✅ Patient date processing completed successfully
[14:54:06] ✅    ✅ Date processing completed
[14:54:06] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'J101', 'secondDiagnosis': 'I10'}]
[14:54:06] 🔄 
🔄 Step 4: Extracting order data...
[14:54:09] ℹ️  Order extraction - MRN: 'MA240417095701'
[14:54:09] ℹ️  Order extraction - Sex: 'FEMALE'
[14:54:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:54:09] ℹ️  Order extraction - Payer Source: ''
[14:54:09] ✅ Order data extraction completed successfully
[14:54:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:09] ℹ️  Using MRN from patient data: 'MA240417095701' over 'MA240417095701'
[14:54:09] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:54:09] ✅ Patient name cross-validation successful
[14:54:09] ✅    ✅ Data merged successfully
[14:54:10] ✅    ✅ Order data extracted and validated
[14:54:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:17] [DOC: 9278811] ✅ Patient exists in API: Cheryl Perkins, ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[14:54:17] ✅    ✅ Existing patient found with ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[14:54:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:54:17] [DOC: 9278811] ℹ️  Pushing order via API for patient ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[14:54:18] [DOC: 9278811] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13026"}
[14:54:18] ❌    ❌ Failed to push order
[14:54:18] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:18] [DOC: 9278811] ℹ️  Calculated age: 67 from DOB: 09/07/1957
[14:54:18] [DOC: 9278811] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:54:18] [DOC: 9278811] ℹ️  Payer Source extracted: ''
[14:54:18] [DOC: 9278811] ℹ️  Diagnosis codes being written:
[14:54:18] [DOC: 9278811] ℹ️    - Latest_Episode_Firstdiagnosis: 'J101'
[14:54:18] [DOC: 9278811] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[14:54:18] [DOC: 9278811] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:54:18] [DOC: 9278811] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:18] [DOC: 9278811] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:18] [DOC: 9278811] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:18] [DOC: 9278811] ✅ Patient data written to CSV: Cheryl Perkins | Sex: FEMALE | Age: 67 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: MA240417095701
[14:54:18] ✅    ✅ Document 9278811 processed and saved successfully
[14:54:18] 🔄 
🔄 Step 8: Saving API details...
[14:54:18] [DOC: 9278811] ℹ️  API push details saved for document 9278811
[14:54:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278673                         ║
================================================================================
[14:54:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:54:18] ℹ️  Date: 05/06/2025
[14:54:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:20] [DOC: 9278673] ✅ Text extracted using pdfplumber (1499 chars)
[14:54:20] ✅    ✅ Text extracted using pdfplumber (1499 chars)
[14:54:20] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:23] ℹ️  AI extracted raw sex value: ''
[14:54:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:54:23] ℹ️  AI extracted payer source: ''
[14:54:23] ℹ️  AI extracted diagnoses:
[14:54:23] ℹ️    - Diagnosis 1: 'K57.30'
[14:54:23] ℹ️    - Diagnosis 2: 'K52.9'
[14:54:23] ℹ️    - Diagnosis 3: 'R53.1'
[14:54:23] ℹ️    - Diagnosis 4: ''
[14:54:23] ℹ️    - Diagnosis 5: ''
[14:54:23] ℹ️    - Diagnosis 6: ''
[14:54:23] ℹ️  Final extracted MRN: 'MA231109053505'
[14:54:23] ℹ️  Final extracted Sex: ''
[14:54:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:54:23] ℹ️  Final extracted Payer Source: ''
[14:54:23] ✅ Patient data extraction completed successfully
[14:54:23] ✅    ✅ Patient data extracted successfully
[14:54:23] 📊 Patient Response
     └─ patientFName: Hilda
     └─ patientLName: Pine
     └─ dob: 05/08/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA231109053505
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'K57.30', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:23] ✅    ✅ Patient identified: Hilda Pine
[14:54:23] ✅    ✅ Patient name validation passed
[14:54:23] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:23] [DOC: 9278673] ℹ️  DOB normalized: 05/08/1935
[14:54:23] [DOC: 9278673] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[14:54:23] [DOC: 9278673] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[14:54:23] [DOC: 9278673] ✅ Patient date processing completed successfully
[14:54:23] ✅    ✅ Date processing completed
[14:54:23] 📊 Processed Patient Data
     └─ patientFName: Hilda
     └─ patientLName: Pine
     └─ dob: 05/08/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA231109053505
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'K57.30', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:23] 🔄 
🔄 Step 4: Extracting order data...
[14:54:25] ℹ️  Order extraction - MRN: 'MA231109053505'
[14:54:25] ℹ️  Order extraction - Sex: ''
[14:54:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:54:25] ℹ️  Order extraction - Payer Source: ''
[14:54:25] ✅ Order data extraction completed successfully
[14:54:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:25] ℹ️  Using MRN from patient data: 'MA231109053505' over 'MA231109053505'
[14:54:25] ⚠️  Could not determine sex using any available method
[14:54:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:54:25] ✅ Patient name cross-validation successful
[14:54:25] ✅    ✅ Data merged successfully
[14:54:27] ✅    ✅ Order data extracted and validated
[14:54:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:33] [DOC: 9278673] ✅ Patient exists in API: Hilda Pine, ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[14:54:33] ✅    ✅ Existing patient found with ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[14:54:33] 🔄 
🔄 Step 6: Pushing order to API...
[14:54:33] [DOC: 9278673] ℹ️  Pushing order via API for patient ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[14:54:34] [DOC: 9278673] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13074"}
[14:54:34] ❌    ❌ Failed to push order
[14:54:34] 🔄 
🔄 Step 7: Writing to CSV...
[14:54:34] [DOC: 9278673] ℹ️  Calculated age: 90 from DOB: 05/08/1935
[14:54:34] [DOC: 9278673] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:54:34] [DOC: 9278673] ℹ️  Payer Source extracted: ''
[14:54:34] [DOC: 9278673] ℹ️  Diagnosis codes being written:
[14:54:34] [DOC: 9278673] ℹ️    - Latest_Episode_Firstdiagnosis: 'K57.30'
[14:54:34] [DOC: 9278673] ℹ️    - Latest_Episode_Seconddiagnosis: 'K52.9'
[14:54:34] [DOC: 9278673] ℹ️    - Latest_Episode_Thirddiagnosis: 'R53.1'
[14:54:34] [DOC: 9278673] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:54:34] [DOC: 9278673] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:54:34] [DOC: 9278673] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:54:34] [DOC: 9278673] ✅ Patient data written to CSV: Hilda Pine | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA231109053505
[14:54:34] ✅    ✅ Document 9278673 processed and saved successfully
[14:54:34] 🔄 
🔄 Step 8: Saving API details...
[14:54:34] [DOC: 9278673] ℹ️  API push details saved for document 9278673
[14:54:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278395                         ║
================================================================================
[14:54:34] ℹ️  Agency: Dartmouth HH
[14:54:34] ℹ️  Date: 05/06/2025
[14:54:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:36] [DOC: 9278395] ✅ Text extracted using pdfplumber (1084 chars)
[14:54:36] ✅    ✅ Text extracted using pdfplumber (1084 chars)
[14:54:36] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:39] ℹ️  AI extracted raw sex value: 'F'
[14:54:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:54:39] ℹ️  AI extracted payer source: 'Medicare'
[14:54:39] ℹ️  AI extracted diagnoses:
[14:54:39] ℹ️    - Diagnosis 1: 'None'
[14:54:39] ℹ️    - Diagnosis 2: 'None'
[14:54:39] ℹ️    - Diagnosis 3: 'None'
[14:54:39] ℹ️    - Diagnosis 4: 'None'
[14:54:39] ℹ️    - Diagnosis 5: 'None'
[14:54:39] ℹ️    - Diagnosis 6: 'None'
[14:54:39] ℹ️  Final extracted MRN: '3684011'
[14:54:39] ℹ️  Final extracted Sex: 'FEMALE'
[14:54:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:54:39] ℹ️  Final extracted Payer Source: 'Medicare'
[14:54:39] ✅ Patient data extraction completed successfully
[14:54:39] ✅    ✅ Patient data extracted successfully
[14:54:39] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:54:39] ✅    ✅ Patient identified: Frances Levin
[14:54:39] ✅    ✅ Patient name validation passed
[14:54:39] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:39] [DOC: 9278395] ℹ️  DOB normalized: 01/16/1935
[14:54:39] [DOC: 9278395] ℹ️  Episode startOfCare normalized: 06/28/2024
[14:54:39] [DOC: 9278395] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[14:54:39] [DOC: 9278395] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[14:54:39] [DOC: 9278395] ✅ Patient date processing completed successfully
[14:54:39] ✅    ✅ Date processing completed
[14:54:39] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025'}]
[14:54:39] 🔄 
🔄 Step 4: Extracting order data...
[14:54:42] ℹ️  Order extraction - MRN: ''
[14:54:42] ℹ️  Order extraction - Sex: 'FEMALE'
[14:54:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:54:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:54:42] ✅ Order data extraction completed successfully
[14:54:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:42] ℹ️  Using MRN from patient data: '3684011'
[14:54:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:54:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:54:42] ✅ Patient name cross-validation successful
[14:54:42] ✅    ✅ Data merged successfully
[14:54:43] ✅    ✅ Order data extracted and validated
[14:54:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:54:51] [DOC: 9278395] ℹ️  Patient not found in cache or API: Frances Levin
[14:54:51] [DOC: 9278395] ℹ️  Patient not found, creating new patient via API...
[14:54:51] [DOC: 9278395] ℹ️  Creating patient via API: Frances Levin
[14:54:52] [DOC: 9278395] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:54:52] ❌    ❌ Failed to create patient
[14:54:52] [DOC: 9278395] ℹ️  API push details saved for document 9278395
================================================================================
║                        Processing Document ID: 9278391                         ║
================================================================================
[14:54:52] ℹ️  Agency: Dartmouth HH
[14:54:52] ℹ️  Date: 05/06/2025
[14:54:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:54:54] [DOC: 9278391] ✅ Text extracted using pdfplumber (1139 chars)
[14:54:54] ✅    ✅ Text extracted using pdfplumber (1139 chars)
[14:54:54] 🔄 
🔄 Step 2: Extracting patient data...
[14:54:57] ℹ️  AI extracted raw sex value: 'F'
[14:54:57] ℹ️  AI extracted service line: 'Low sodium diet teaching'
[14:54:57] ℹ️  AI extracted payer source: 'Medicare'
[14:54:57] ℹ️  AI extracted diagnoses:
[14:54:57] ℹ️    - Diagnosis 1: ''
[14:54:57] ℹ️    - Diagnosis 2: ''
[14:54:57] ℹ️    - Diagnosis 3: ''
[14:54:57] ℹ️    - Diagnosis 4: ''
[14:54:57] ℹ️    - Diagnosis 5: ''
[14:54:57] ℹ️    - Diagnosis 6: ''
[14:54:57] ℹ️  Final extracted MRN: '637008'
[14:54:57] ℹ️  Final extracted Sex: 'FEMALE'
[14:54:57] ℹ️  Final extracted Service Line: 'Low sodium diet teaching'
[14:54:57] ℹ️  Final extracted Payer Source: 'Medicare'
[14:54:57] ✅ Patient data extraction completed successfully
[14:54:57] ✅    ✅ Patient data extracted successfully
[14:54:57] 📊 Patient Response
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 140 D Carriage Drive
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Low sodium diet teaching
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:57] ✅    ✅ Patient identified: Florence Curry
[14:54:57] ✅    ✅ Patient name validation passed
[14:54:57] 🔄 
🔄 Step 3: Processing patient dates...
[14:54:57] [DOC: 9278391] ℹ️  DOB normalized: 06/02/1933
[14:54:57] [DOC: 9278391] ℹ️  Episode startOfCare normalized: 04/11/2025
[14:54:57] [DOC: 9278391] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[14:54:57] [DOC: 9278391] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[14:54:57] [DOC: 9278391] ✅ Patient date processing completed successfully
[14:54:57] ✅    ✅ Date processing completed
[14:54:57] 📊 Processed Patient Data
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 140 D Carriage Drive
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Low sodium diet teaching
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:54:57] 🔄 
🔄 Step 4: Extracting order data...
[14:54:59] ℹ️  Order extraction - MRN: ''
[14:54:59] ℹ️  Order extraction - Sex: 'FEMALE'
[14:54:59] ℹ️  Order extraction - Service Line: 'Low sodium diet teaching'
[14:54:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:54:59] ✅ Order data extraction completed successfully
[14:54:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:54:59] ℹ️  Using MRN from patient data: '637008'
[14:54:59] ℹ️  Service line consistent in both sources: 'Low sodium diet teaching'
[14:54:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:54:59] ✅ Patient name cross-validation successful
[14:54:59] ✅    ✅ Data merged successfully
[14:55:00] ✅    ✅ Order data extracted and validated
[14:55:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:06] [DOC: 9278391] ℹ️  Patient not found in cache or API: Florence Curry
[14:55:06] [DOC: 9278391] ℹ️  Patient not found, creating new patient via API...
[14:55:06] [DOC: 9278391] ℹ️  Creating patient via API: Florence Curry
[14:55:08] [DOC: 9278391] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:55:08] ❌    ❌ Failed to create patient
[14:55:08] [DOC: 9278391] ℹ️  API push details saved for document 9278391
================================================================================
║                        Processing Document ID: 9278388                         ║
================================================================================
[14:55:08] ℹ️  Agency: Dartmouth HH
[14:55:08] ℹ️  Date: 05/06/2025
[14:55:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:09] [DOC: 9278388] ✅ Text extracted using pdfplumber (1699 chars)
[14:55:09] ✅    ✅ Text extracted using pdfplumber (1699 chars)
[14:55:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:12] ℹ️  AI extracted raw sex value: 'M'
[14:55:12] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[14:55:12] ℹ️  AI extracted payer source: 'Medicare'
[14:55:12] ℹ️  AI extracted diagnoses:
[14:55:12] ℹ️    - Diagnosis 1: 'None'
[14:55:12] ℹ️    - Diagnosis 2: 'None'
[14:55:12] ℹ️    - Diagnosis 3: 'None'
[14:55:12] ℹ️    - Diagnosis 4: 'None'
[14:55:12] ℹ️    - Diagnosis 5: 'None'
[14:55:12] ℹ️    - Diagnosis 6: 'None'
[14:55:12] ℹ️  Final extracted MRN: '6208015'
[14:55:12] ℹ️  Final extracted Sex: 'MALE'
[14:55:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[14:55:12] ℹ️  Final extracted Payer Source: 'Medicare'
[14:55:12] ✅ Patient data extraction completed successfully
[14:55:12] ✅    ✅ Patient data extracted successfully
[14:55:12] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:55:12] ✅    ✅ Patient identified: Stephen Hanna Jr,
[14:55:12] ✅    ✅ Patient name validation passed
[14:55:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:12] [DOC: 9278388] ℹ️  DOB normalized: 03/11/1936
[14:55:12] [DOC: 9278388] ℹ️  Episode startOfCare normalized: 03/15/2025
[14:55:12] [DOC: 9278388] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:55:12] [DOC: 9278388] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[14:55:12] [DOC: 9278388] ✅ Patient date processing completed successfully
[14:55:12] ✅    ✅ Date processing completed
[14:55:12] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025'}]
[14:55:12] 🔄 
🔄 Step 4: Extracting order data...
[14:55:15] ℹ️  Order extraction - MRN: ''
[14:55:15] ℹ️  Order extraction - Sex: 'MALE'
[14:55:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:55:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:15] ✅ Order data extraction completed successfully
[14:55:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:15] ℹ️  Using MRN from patient data: '6208015'
[14:55:15] ℹ️  Combined service lines: Patient='Skilled Nursing, HHA' + Order='Skilled Nursing' = 'HHA, Skilled Nursing'
[14:55:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:15] ✅ Patient name cross-validation successful
[14:55:15] ✅    ✅ Data merged successfully
[14:55:16] ✅    ✅ Order data extracted and validated
[14:55:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:16] [DOC: 9278388] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:55:16] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:55:16] 🔄 
🔄 Step 6: Pushing order to API...
[14:55:16] [DOC: 9278388] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[14:55:17] [DOC: 9278388] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13829"}
[14:55:17] ❌    ❌ Failed to push order
[14:55:17] 🔄 
🔄 Step 7: Writing to CSV...
[14:55:17] [DOC: 9278388] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[14:55:17] [DOC: 9278388] ℹ️  Service Line extracted: 'HHA, Skilled Nursing'
[14:55:17] [DOC: 9278388] ℹ️  Payer Source extracted: 'Medicare'
[14:55:17] [DOC: 9278388] ℹ️  Diagnosis codes being written:
[14:55:17] [DOC: 9278388] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:55:17] [DOC: 9278388] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:55:17] [DOC: 9278388] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:55:17] [DOC: 9278388] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:55:17] [DOC: 9278388] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:55:17] [DOC: 9278388] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:55:17] [DOC: 9278388] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: HHA, Skilled Nursing | Payer: Medicare | MRN: 6208015
[14:55:17] ✅    ✅ Document 9278388 processed and saved successfully
[14:55:17] 🔄 
🔄 Step 8: Saving API details...
[14:55:17] [DOC: 9278388] ℹ️  API push details saved for document 9278388
[14:55:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278386                         ║
================================================================================
[14:55:17] ℹ️  Agency: Dartmouth HH
[14:55:17] ℹ️  Date: 05/06/2025
[14:55:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:19] [DOC: 9278386] ✅ Text extracted using pdfplumber (1695 chars)
[14:55:19] ✅    ✅ Text extracted using pdfplumber (1695 chars)
[14:55:19] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:22] ℹ️  AI extracted raw sex value: 'F'
[14:55:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:55:22] ℹ️  AI extracted payer source: 'Medicare'
[14:55:22] ℹ️  AI extracted diagnoses:
[14:55:22] ℹ️    - Diagnosis 1: 'None'
[14:55:22] ℹ️    - Diagnosis 2: 'None'
[14:55:22] ℹ️    - Diagnosis 3: 'None'
[14:55:22] ℹ️    - Diagnosis 4: 'None'
[14:55:22] ℹ️    - Diagnosis 5: 'None'
[14:55:22] ℹ️    - Diagnosis 6: 'None'
[14:55:22] ℹ️  Final extracted MRN: '6448011'
[14:55:22] ℹ️  Final extracted Sex: 'FEMALE'
[14:55:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:55:22] ℹ️  Final extracted Payer Source: 'Medicare'
[14:55:22] ✅ Patient data extraction completed successfully
[14:55:22] ✅    ✅ Patient data extracted successfully
[14:55:22] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 471 Rockdale Avenue
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:55:22] ✅    ✅ Patient identified: Kim Teixeira
[14:55:22] ✅    ✅ Patient name validation passed
[14:55:22] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:22] [DOC: 9278386] ℹ️  DOB normalized: 02/28/1964
[14:55:22] [DOC: 9278386] ℹ️  Episode startOfCare normalized: 01/18/2025
[14:55:22] [DOC: 9278386] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[14:55:22] [DOC: 9278386] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[14:55:22] [DOC: 9278386] ✅ Patient date processing completed successfully
[14:55:22] ✅    ✅ Date processing completed
[14:55:22] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6448011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 471 Rockdale Avenue
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025'}]
[14:55:22] 🔄 
🔄 Step 4: Extracting order data...
[14:55:24] ℹ️  Order extraction - MRN: ''
[14:55:24] ℹ️  Order extraction - Sex: 'FEMALE'
[14:55:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:55:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:24] ✅ Order data extraction completed successfully
[14:55:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:24] ℹ️  Using MRN from patient data: '6448011'
[14:55:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:55:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:24] ✅ Patient name cross-validation successful
[14:55:24] ✅    ✅ Data merged successfully
[14:55:25] ✅    ✅ Order data extracted and validated
[14:55:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:25] [DOC: 9278386] ✅ Patient found in local cache: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[14:55:25] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[14:55:25] 🔄 
🔄 Step 6: Pushing order to API...
[14:55:25] [DOC: 9278386] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[14:55:26] [DOC: 9278386] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:55:26] ❌    ❌ Failed to push order
[14:55:26] 🔄 
🔄 Step 7: Writing to CSV...
[14:55:26] [DOC: 9278386] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[14:55:26] [DOC: 9278386] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:55:26] [DOC: 9278386] ℹ️  Payer Source extracted: 'Medicare'
[14:55:26] [DOC: 9278386] ℹ️  Diagnosis codes being written:
[14:55:26] [DOC: 9278386] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:55:26] [DOC: 9278386] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:55:26] [DOC: 9278386] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:55:26] [DOC: 9278386] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:55:26] [DOC: 9278386] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:55:26] [DOC: 9278386] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:55:26] [DOC: 9278386] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: Skilled Nursing | Payer: Medicare | MRN: 6448011
[14:55:26] ✅    ✅ Document 9278386 processed and saved successfully
[14:55:26] 🔄 
🔄 Step 8: Saving API details...
[14:55:26] [DOC: 9278386] ℹ️  API push details saved for document 9278386
[14:55:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278348                         ║
================================================================================
[14:55:26] ℹ️  Agency: Dartmouth HH
[14:55:26] ℹ️  Date: 05/06/2025
[14:55:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:28] [DOC: 9278348] ✅ Text extracted using pdfplumber (1139 chars)
[14:55:28] ✅    ✅ Text extracted using pdfplumber (1139 chars)
[14:55:28] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:31] ℹ️  AI extracted raw sex value: 'F'
[14:55:31] ℹ️  AI extracted service line: 'RN'
[14:55:31] ℹ️  AI extracted payer source: 'Medicare'
[14:55:31] ℹ️  AI extracted diagnoses:
[14:55:31] ℹ️    - Diagnosis 1: ''
[14:55:31] ℹ️    - Diagnosis 2: ''
[14:55:31] ℹ️    - Diagnosis 3: ''
[14:55:31] ℹ️    - Diagnosis 4: ''
[14:55:31] ℹ️    - Diagnosis 5: ''
[14:55:31] ℹ️    - Diagnosis 6: ''
[14:55:31] ℹ️  Final extracted MRN: '5915015'
[14:55:31] ℹ️  Final extracted Sex: 'FEMALE'
[14:55:31] ℹ️  Final extracted Service Line: 'RN'
[14:55:31] ℹ️  Final extracted Payer Source: 'Medicare'
[14:55:31] ✅ Patient data extraction completed successfully
[14:55:31] ✅    ✅ Patient data extracted successfully
[14:55:31] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:31] ✅    ✅ Patient identified: Suzanne Fawcett
[14:55:31] ✅    ✅ Patient name validation passed
[14:55:31] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:31] [DOC: 9278348] ℹ️  DOB normalized: 12/08/1939
[14:55:31] [DOC: 9278348] ℹ️  Episode startOfCare normalized: 01/26/2025
[14:55:31] [DOC: 9278348] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[14:55:31] [DOC: 9278348] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[14:55:31] [DOC: 9278348] ✅ Patient date processing completed successfully
[14:55:31] ✅    ✅ Date processing completed
[14:55:31] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:31] 🔄 
🔄 Step 4: Extracting order data...
[14:55:34] ℹ️  Order extraction - MRN: ''
[14:55:34] ℹ️  Order extraction - Sex: 'FEMALE'
[14:55:34] ℹ️  Order extraction - Service Line: ''
[14:55:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:34] ✅ Order data extraction completed successfully
[14:55:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:34] ℹ️  Using MRN from patient data: '5915015'
[14:55:34] ℹ️  Using service line from patient data: 'RN'
[14:55:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:34] ✅ Patient name cross-validation successful
[14:55:34] ✅    ✅ Data merged successfully
[14:55:35] ✅    ✅ Order data extracted and validated
[14:55:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:41] [DOC: 9278348] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[14:55:41] [DOC: 9278348] ℹ️  Patient not found, creating new patient via API...
[14:55:41] [DOC: 9278348] ℹ️  Creating patient via API: Suzanne Fawcett
[14:55:42] [DOC: 9278348] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:55:42] ❌    ❌ Failed to create patient
[14:55:42] [DOC: 9278348] ℹ️  API push details saved for document 9278348
================================================================================
║                        Processing Document ID: 9278333                         ║
================================================================================
[14:55:42] ℹ️  Agency: Dartmouth HH
[14:55:42] ℹ️  Date: 05/06/2025
[14:55:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:55:44] [DOC: 9278333] ✅ Text extracted using pdfplumber (3977 chars)
[14:55:44] ✅    ✅ Text extracted using pdfplumber (3977 chars)
[14:55:44] 🔄 
🔄 Step 2: Extracting patient data...
[14:55:47] ℹ️  AI extracted raw sex value: 'F'
[14:55:47] ℹ️  AI extracted service line: 'PT'
[14:55:47] ℹ️  AI extracted payer source: 'Medicare'
[14:55:47] ℹ️  AI extracted diagnoses:
[14:55:47] ℹ️    - Diagnosis 1: ''
[14:55:47] ℹ️    - Diagnosis 2: ''
[14:55:47] ℹ️    - Diagnosis 3: ''
[14:55:47] ℹ️    - Diagnosis 4: ''
[14:55:47] ℹ️    - Diagnosis 5: ''
[14:55:47] ℹ️    - Diagnosis 6: ''
[14:55:47] ℹ️  Final extracted MRN: '1872009'
[14:55:47] ℹ️  Final extracted Sex: 'FEMALE'
[14:55:47] ℹ️  Final extracted Service Line: 'PT'
[14:55:47] ℹ️  Final extracted Payer Source: 'Medicare'
[14:55:47] ✅ Patient data extraction completed successfully
[14:55:47] ✅    ✅ Patient data extracted successfully
[14:55:47] 📊 Patient Response
     └─ patientFName: Corinne
     └─ patientLName: Lebeau
     └─ dob: 07/17/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1872009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:47] ✅    ✅ Patient identified: Corinne Lebeau
[14:55:47] ✅    ✅ Patient name validation passed
[14:55:47] 🔄 
🔄 Step 3: Processing patient dates...
[14:55:47] [DOC: 9278333] ℹ️  DOB normalized: 07/17/1948
[14:55:47] [DOC: 9278333] ℹ️  Episode startOfCare normalized: 04/04/2025
[14:55:47] [DOC: 9278333] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:55:47] [DOC: 9278333] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:55:47] [DOC: 9278333] ✅ Patient date processing completed successfully
[14:55:47] ✅    ✅ Date processing completed
[14:55:47] 📊 Processed Patient Data
     └─ patientFName: Corinne
     └─ patientLName: Lebeau
     └─ dob: 07/17/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1872009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:55:47] 🔄 
🔄 Step 4: Extracting order data...
[14:55:49] ℹ️  Order extraction - MRN: ''
[14:55:49] ℹ️  Order extraction - Sex: 'FEMALE'
[14:55:49] ℹ️  Order extraction - Service Line: 'PT'
[14:55:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:55:49] ✅ Order data extraction completed successfully
[14:55:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:55:49] ℹ️  Using MRN from patient data: '1872009'
[14:55:49] ℹ️  Service line consistent in both sources: 'PT'
[14:55:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:55:49] ✅ Patient name cross-validation successful
[14:55:49] ✅    ✅ Data merged successfully
[14:55:51] ✅    ✅ Order data extracted and validated
[14:55:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:55:57] [DOC: 9278333] ✅ Patient exists in API: Corinne Lebeau, ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[14:55:57] ✅    ✅ Existing patient found with ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[14:55:57] 🔄 
🔄 Step 6: Pushing order to API...
[14:55:57] [DOC: 9278333] ℹ️  Pushing order via API for patient ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[14:55:58] [DOC: 9278333] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:55:58] ❌    ❌ Failed to push order
[14:55:58] 🔄 
🔄 Step 7: Writing to CSV...
[14:55:58] [DOC: 9278333] ℹ️  Calculated age: 76 from DOB: 07/17/1948
[14:55:58] [DOC: 9278333] ℹ️  Service Line extracted: 'PT'
[14:55:58] [DOC: 9278333] ℹ️  Payer Source extracted: 'Medicare'
[14:55:58] [DOC: 9278333] ℹ️  Diagnosis codes being written:
[14:55:58] [DOC: 9278333] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:55:58] [DOC: 9278333] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:55:58] [DOC: 9278333] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:55:58] [DOC: 9278333] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:55:58] [DOC: 9278333] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:55:58] [DOC: 9278333] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:55:58] [DOC: 9278333] ✅ Patient data written to CSV: Corinne Lebeau | Sex: FEMALE | Age: 76 | Service: PT | Payer: Medicare | MRN: 1872009
[14:55:58] ✅    ✅ Document 9278333 processed and saved successfully
[14:55:58] 🔄 
🔄 Step 8: Saving API details...
[14:55:58] [DOC: 9278333] ℹ️  API push details saved for document 9278333
[14:55:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278317                         ║
================================================================================
[14:55:58] ℹ️  Agency: Dartmouth HH
[14:55:58] ℹ️  Date: 05/06/2025
[14:55:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:01] [DOC: 9278317] ✅ Text extracted using pdfplumber (7795 chars)
[14:56:01] ✅    ✅ Text extracted using pdfplumber (7795 chars)
[14:56:01] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:04] ℹ️  AI extracted raw sex value: 'F'
[14:56:04] ℹ️  AI extracted service line: 'PT, OT'
[14:56:04] ℹ️  AI extracted payer source: 'Fallon Health'
[14:56:04] ℹ️  AI extracted diagnoses:
[14:56:04] ℹ️    - Diagnosis 1: 'Heart failure'
[14:56:04] ℹ️    - Diagnosis 2: 'Atrial fibrillation'
[14:56:04] ℹ️    - Diagnosis 3: 'None'
[14:56:04] ℹ️    - Diagnosis 4: 'None'
[14:56:04] ℹ️    - Diagnosis 5: 'None'
[14:56:04] ℹ️    - Diagnosis 6: 'None'
[14:56:04] ℹ️  Final extracted MRN: '4034011'
[14:56:04] ℹ️  Final extracted Sex: 'FEMALE'
[14:56:04] ℹ️  Final extracted Service Line: 'PT, OT'
[14:56:04] ℹ️  Final extracted Payer Source: 'Fallon Health'
[14:56:04] ✅ Patient data extraction completed successfully
[14:56:04] ✅    ✅ Patient data extracted successfully
[14:56:04] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'Heart failure', 'secondDiagnosis': 'Atrial fibrillation', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:56:04] ✅    ✅ Patient identified: Joan E Swift
[14:56:04] ✅    ✅ Patient name validation passed
[14:56:04] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:04] [DOC: 9278317] ℹ️  DOB normalized: 05/05/1943
[14:56:04] [DOC: 9278317] ℹ️  Episode startOfCare normalized: 01/08/2025
[14:56:04] [DOC: 9278317] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[14:56:04] [DOC: 9278317] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[14:56:04] [DOC: 9278317] ✅ Patient date processing completed successfully
[14:56:04] ✅    ✅ Date processing completed
[14:56:04] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'Heart failure', 'secondDiagnosis': 'Atrial fibrillation'}]
[14:56:04] 🔄 
🔄 Step 4: Extracting order data...
[14:56:06] ℹ️  Order extraction - MRN: '4034011'
[14:56:06] ℹ️  Order extraction - Sex: 'FEMALE'
[14:56:06] ℹ️  Order extraction - Service Line: 'PT, OT'
[14:56:06] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[14:56:06] ✅ Order data extraction completed successfully
[14:56:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:06] ℹ️  Using MRN from patient data: '4034011' over '4034011'
[14:56:06] ℹ️  Service line consistent in both sources: 'PT, OT'
[14:56:06] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[14:56:06] ✅ Patient name cross-validation successful
[14:56:06] ✅    ✅ Data merged successfully
[14:56:08] ✅    ✅ Order data extracted and validated
[14:56:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:56:14] [DOC: 9278317] ℹ️  Patient not found in cache or API: Joan E Swift
[14:56:14] [DOC: 9278317] ℹ️  Patient not found, creating new patient via API...
[14:56:14] [DOC: 9278317] ℹ️  Creating patient via API: Joan E Swift
[14:56:15] [DOC: 9278317] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:56:15] ❌    ❌ Failed to create patient
[14:56:15] [DOC: 9278317] ℹ️  API push details saved for document 9278317
================================================================================
║                        Processing Document ID: 9278310                         ║
================================================================================
[14:56:15] ℹ️  Agency: Dartmouth HH
[14:56:15] ℹ️  Date: 05/06/2025
[14:56:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:18] [DOC: 9278310] ✅ Text extracted using pdfplumber (14024 chars)
[14:56:18] ✅    ✅ Text extracted using pdfplumber (14012 chars)
[14:56:18] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:21] ℹ️  AI extracted raw sex value: 'M'
[14:56:21] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[14:56:21] ℹ️  AI extracted payer source: ''
[14:56:21] ℹ️  AI extracted diagnoses:
[14:56:21] ℹ️    - Diagnosis 1: 'Z47.1'
[14:56:21] ℹ️    - Diagnosis 2: 'Z96.612'
[14:56:21] ℹ️    - Diagnosis 3: 'J44.89'
[14:56:21] ℹ️    - Diagnosis 4: 'J43.9'
[14:56:21] ℹ️    - Diagnosis 5: 'I25.10'
[14:56:21] ℹ️    - Diagnosis 6: 'E87.1'
[14:56:21] ℹ️  Final extracted MRN: '4290015'
[14:56:21] ℹ️  Final extracted Sex: 'MALE'
[14:56:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[14:56:21] ℹ️  Final extracted Payer Source: ''
[14:56:21] ✅ Patient data extraction completed successfully
[14:56:21] ✅    ✅ Patient data extracted successfully
[14:56:21] 📊 Patient Response
     └─ patientFName: Steven
     └─ patientLName: Warn
     └─ dob: 04/04/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 4290015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.612', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': 'J43.9', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'E87.1'}]
[14:56:21] ✅    ✅ Patient identified: Steven Warn
[14:56:21] ✅    ✅ Patient name validation passed
[14:56:21] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:21] [DOC: 9278310] ℹ️  DOB normalized: 04/04/1951
[14:56:21] [DOC: 9278310] ℹ️  Episode startOfCare normalized: 04/17/2025
[14:56:21] [DOC: 9278310] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[14:56:21] [DOC: 9278310] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[14:56:21] [DOC: 9278310] ✅ Patient date processing completed successfully
[14:56:21] ✅    ✅ Date processing completed
[14:56:21] 📊 Processed Patient Data
     └─ patientFName: Steven
     └─ patientLName: Warn
     └─ dob: 04/04/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 4290015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.612', 'thirdDiagnosis': 'J44.89', 'fourthDiagnosis': 'J43.9', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'E87.1'}]
[14:56:21] 🔄 
🔄 Step 4: Extracting order data...
[14:56:24] ℹ️  Order extraction - MRN: '4290015'
[14:56:24] ℹ️  Order extraction - Sex: 'MALE'
[14:56:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[14:56:24] ℹ️  Order extraction - Payer Source: ''
[14:56:24] ✅ Order data extraction completed successfully
[14:56:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:24] ℹ️  Using MRN from patient data: '4290015' over '4290015'
[14:56:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[14:56:24] ✅ Patient name cross-validation successful
[14:56:24] ✅    ✅ Data merged successfully
[14:56:25] ✅    ✅ Order data extracted and validated
[14:56:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:56:31] [DOC: 9278310] ✅ Patient exists in API: Steven Warn, ID: 9494d153-a0c7-4233-a985-86e9c769bc98
[14:56:31] ✅    ✅ Existing patient found with ID: 9494d153-a0c7-4233-a985-86e9c769bc98
[14:56:31] 🔄 
🔄 Step 6: Pushing order to API...
[14:56:31] [DOC: 9278310] ℹ️  Pushing order via API for patient ID: 9494d153-a0c7-4233-a985-86e9c769bc98
[14:56:32] [DOC: 9278310] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:56:32] ❌    ❌ Failed to push order
[14:56:32] 🔄 
🔄 Step 7: Writing to CSV...
[14:56:32] [DOC: 9278310] ℹ️  Calculated age: 74 from DOB: 04/04/1951
[14:56:32] [DOC: 9278310] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy'
[14:56:32] [DOC: 9278310] ℹ️  Payer Source extracted: ''
[14:56:32] [DOC: 9278310] ℹ️  Diagnosis codes being written:
[14:56:32] [DOC: 9278310] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[14:56:32] [DOC: 9278310] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.612'
[14:56:32] [DOC: 9278310] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.89'
[14:56:32] [DOC: 9278310] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J43.9'
[14:56:32] [DOC: 9278310] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[14:56:32] [DOC: 9278310] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E87.1'
[14:56:32] [DOC: 9278310] ✅ Patient data written to CSV: Steven Warn | Sex: MALE | Age: 74 | Service: Skilled Nursing, Occupational Therapy | Payer:  | MRN: 4290015
[14:56:32] ✅    ✅ Document 9278310 processed and saved successfully
[14:56:32] 🔄 
🔄 Step 8: Saving API details...
[14:56:32] [DOC: 9278310] ℹ️  API push details saved for document 9278310
[14:56:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278299                         ║
================================================================================
[14:56:32] ℹ️  Agency: Dartmouth HH
[14:56:32] ℹ️  Date: 05/06/2025
[14:56:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:34] [DOC: 9278299] ✅ Text extracted using pdfplumber (4771 chars)
[14:56:34] ✅    ✅ Text extracted using pdfplumber (4771 chars)
[14:56:34] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:37] ℹ️  AI extracted raw sex value: 'F'
[14:56:37] ℹ️  AI extracted service line: 'PT'
[14:56:37] ℹ️  AI extracted payer source: 'Medicare'
[14:56:37] ℹ️  AI extracted diagnoses:
[14:56:37] ℹ️    - Diagnosis 1: 'None'
[14:56:37] ℹ️    - Diagnosis 2: 'None'
[14:56:37] ℹ️    - Diagnosis 3: 'None'
[14:56:37] ℹ️    - Diagnosis 4: 'None'
[14:56:37] ℹ️    - Diagnosis 5: 'None'
[14:56:37] ℹ️    - Diagnosis 6: 'None'
[14:56:37] ℹ️  Final extracted MRN: '804015'
[14:56:37] ℹ️  Final extracted Sex: 'FEMALE'
[14:56:37] ℹ️  Final extracted Service Line: 'PT'
[14:56:37] ℹ️  Final extracted Payer Source: 'Medicare'
[14:56:37] ✅ Patient data extraction completed successfully
[14:56:37] ✅    ✅ Patient data extracted successfully
[14:56:37] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 804015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:56:37] ✅    ✅ Patient identified: Joan Harb
[14:56:37] ✅    ✅ Patient name validation passed
[14:56:37] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:37] [DOC: 9278299] ℹ️  DOB normalized: 12/27/1945
[14:56:37] [DOC: 9278299] ℹ️  Episode startOfCare normalized: 01/15/2025
[14:56:37] [DOC: 9278299] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[14:56:37] [DOC: 9278299] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[14:56:37] [DOC: 9278299] ✅ Patient date processing completed successfully
[14:56:37] ✅    ✅ Date processing completed
[14:56:37] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Harb
     └─ dob: 12/27/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 804015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2025', 'startOfEpisode': '01/15/2025', 'endOfEpisode': '05/14/2025'}]
[14:56:37] 🔄 
🔄 Step 4: Extracting order data...
[14:56:40] ℹ️  Order extraction - MRN: ''
[14:56:40] ℹ️  Order extraction - Sex: 'FEMALE'
[14:56:40] ℹ️  Order extraction - Service Line: 'PT'
[14:56:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:56:40] ✅ Order data extraction completed successfully
[14:56:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:40] ℹ️  Using MRN from patient data: '804015'
[14:56:40] ℹ️  Service line consistent in both sources: 'PT'
[14:56:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:56:40] ✅ Patient name cross-validation successful
[14:56:40] ✅    ✅ Data merged successfully
[14:56:41] ✅    ✅ Order data extracted and validated
[14:56:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:56:46] [DOC: 9278299] ✅ Patient exists in API: Joan Harb, ID: e6448657-0278-414c-9f62-37332e5b561b
[14:56:46] ✅    ✅ Existing patient found with ID: e6448657-0278-414c-9f62-37332e5b561b
[14:56:46] 🔄 
🔄 Step 6: Pushing order to API...
[14:56:46] [DOC: 9278299] ℹ️  Pushing order via API for patient ID: e6448657-0278-414c-9f62-37332e5b561b
[14:56:47] [DOC: 9278299] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:56:47] ❌    ❌ Failed to push order
[14:56:47] 🔄 
🔄 Step 7: Writing to CSV...
[14:56:47] [DOC: 9278299] ℹ️  Calculated age: 79 from DOB: 12/27/1945
[14:56:47] [DOC: 9278299] ℹ️  Service Line extracted: 'PT'
[14:56:47] [DOC: 9278299] ℹ️  Payer Source extracted: 'Medicare'
[14:56:47] [DOC: 9278299] ℹ️  Diagnosis codes being written:
[14:56:47] [DOC: 9278299] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:56:47] [DOC: 9278299] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:56:47] [DOC: 9278299] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:56:47] [DOC: 9278299] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:56:47] [DOC: 9278299] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:56:47] [DOC: 9278299] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:56:47] [DOC: 9278299] ✅ Patient data written to CSV: Joan Harb | Sex: FEMALE | Age: 79 | Service: PT | Payer: Medicare | MRN: 804015
[14:56:47] ✅    ✅ Document 9278299 processed and saved successfully
[14:56:47] 🔄 
🔄 Step 8: Saving API details...
[14:56:47] [DOC: 9278299] ℹ️  API push details saved for document 9278299
[14:56:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278282                         ║
================================================================================
[14:56:47] ℹ️  Agency: Dartmouth HH
[14:56:47] ℹ️  Date: 05/06/2025
[14:56:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:56:50] [DOC: 9278282] ✅ Text extracted using pdfplumber (5862 chars)
[14:56:50] ✅    ✅ Text extracted using pdfplumber (5862 chars)
[14:56:50] 🔄 
🔄 Step 2: Extracting patient data...
[14:56:52] ℹ️  AI extracted raw sex value: 'F'
[14:56:52] ℹ️  AI extracted service line: 'Occupational Therapy, Skilled Nursing'
[14:56:52] ℹ️  AI extracted payer source: 'Medicare'
[14:56:52] ℹ️  AI extracted diagnoses:
[14:56:52] ℹ️    - Diagnosis 1: ''
[14:56:52] ℹ️    - Diagnosis 2: ''
[14:56:52] ℹ️    - Diagnosis 3: ''
[14:56:52] ℹ️    - Diagnosis 4: ''
[14:56:52] ℹ️    - Diagnosis 5: ''
[14:56:52] ℹ️    - Diagnosis 6: ''
[14:56:52] ℹ️  Final extracted MRN: '402009'
[14:56:52] ℹ️  Final extracted Sex: 'FEMALE'
[14:56:52] ℹ️  Final extracted Service Line: 'Occupational Therapy, Skilled Nursing'
[14:56:52] ℹ️  Final extracted Payer Source: 'Medicare'
[14:56:52] ✅ Patient data extraction completed successfully
[14:56:52] ✅    ✅ Patient data extracted successfully
[14:56:52] 📊 Patient Response
     └─ patientFName: Angelina
     └─ patientLName: Barros
     └─ dob: 01/08/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 402009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 90 Riverside Avenue Apt 230
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:56:52] ✅    ✅ Patient identified: Angelina Barros
[14:56:52] ✅    ✅ Patient name validation passed
[14:56:52] 🔄 
🔄 Step 3: Processing patient dates...
[14:56:52] [DOC: 9278282] ℹ️  DOB normalized: 01/08/1930
[14:56:52] [DOC: 9278282] ℹ️  Episode startOfCare normalized: 04/17/2025
[14:56:52] [DOC: 9278282] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[14:56:52] [DOC: 9278282] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[14:56:52] [DOC: 9278282] ✅ Patient date processing completed successfully
[14:56:52] ✅    ✅ Date processing completed
[14:56:52] 📊 Processed Patient Data
     └─ patientFName: Angelina
     └─ patientLName: Barros
     └─ dob: 01/08/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 402009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 90 Riverside Avenue Apt 230
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:56:52] 🔄 
🔄 Step 4: Extracting order data...
[14:56:55] ℹ️  Order extraction - MRN: ''
[14:56:55] ℹ️  Order extraction - Sex: 'FEMALE'
[14:56:55] ℹ️  Order extraction - Service Line: 'OT, SN'
[14:56:55] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:56:55] ✅ Order data extraction completed successfully
[14:56:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:56:55] ℹ️  Using MRN from patient data: '402009'
[14:56:55] ℹ️  Combined service lines: Patient='Occupational Therapy, Skilled Nursing' + Order='OT, SN' = 'OT, Occupational Therapy, SN, Skilled Nursing'
[14:56:55] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:56:55] ✅ Patient name cross-validation successful
[14:56:55] ✅    ✅ Data merged successfully
[14:56:56] ✅    ✅ Order data extracted and validated
[14:56:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:03] [DOC: 9278282] ✅ Patient exists in API: Angelina Barros, ID: a4de58ee-e8df-4dda-be6a-ca176172f250
[14:57:03] ✅    ✅ Existing patient found with ID: a4de58ee-e8df-4dda-be6a-ca176172f250
[14:57:03] 🔄 
🔄 Step 6: Pushing order to API...
[14:57:03] [DOC: 9278282] ℹ️  Pushing order via API for patient ID: a4de58ee-e8df-4dda-be6a-ca176172f250
[14:57:04] [DOC: 9278282] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:57:04] ❌    ❌ Failed to push order
[14:57:04] 🔄 
🔄 Step 7: Writing to CSV...
[14:57:04] [DOC: 9278282] ℹ️  Calculated age: 95 from DOB: 01/08/1930
[14:57:04] [DOC: 9278282] ℹ️  Service Line extracted: 'OT, Occupational Therapy, SN, Skilled Nursing'
[14:57:04] [DOC: 9278282] ℹ️  Payer Source extracted: 'Medicare'
[14:57:04] [DOC: 9278282] ℹ️  Diagnosis codes being written:
[14:57:04] [DOC: 9278282] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:57:04] [DOC: 9278282] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:57:04] [DOC: 9278282] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:57:04] [DOC: 9278282] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:57:04] [DOC: 9278282] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:57:04] [DOC: 9278282] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:57:04] [DOC: 9278282] ✅ Patient data written to CSV: Angelina Barros | Sex: FEMALE | Age: 95 | Service: OT, Occupational Therapy, SN, Skilled Nursing | Payer: Medicare | MRN: 402009
[14:57:04] ✅    ✅ Document 9278282 processed and saved successfully
[14:57:04] 🔄 
🔄 Step 8: Saving API details...
[14:57:04] [DOC: 9278282] ℹ️  API push details saved for document 9278282
[14:57:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278225                         ║
================================================================================
[14:57:04] ℹ️  Agency: Dartmouth HH
[14:57:04] ℹ️  Date: 05/06/2025
[14:57:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:07] [DOC: 9278225] ✅ Text extracted using pdfplumber (16918 chars)
[14:57:07] ✅    ✅ Text extracted using pdfplumber (16906 chars)
[14:57:07] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:10] ℹ️  AI extracted raw sex value: 'F'
[14:57:10] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:57:10] ℹ️  AI extracted payer source: ''
[14:57:10] ℹ️  AI extracted diagnoses:
[14:57:10] ℹ️    - Diagnosis 1: 'I11.0'
[14:57:10] ℹ️    - Diagnosis 2: 'I50.23'
[14:57:10] ℹ️    - Diagnosis 3: 'I25.10'
[14:57:10] ℹ️    - Diagnosis 4: 'I25.2'
[14:57:10] ℹ️    - Diagnosis 5: 'E78.5'
[14:57:10] ℹ️    - Diagnosis 6: 'M17.0'
[14:57:10] ℹ️  Final extracted MRN: '402009'
[14:57:10] ℹ️  Final extracted Sex: 'FEMALE'
[14:57:10] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:57:10] ℹ️  Final extracted Payer Source: ''
[14:57:10] ✅ Patient data extraction completed successfully
[14:57:10] ✅    ✅ Patient data extracted successfully
[14:57:10] 📊 Patient Response
     └─ patientFName: Angelina
     └─ patientLName: Barros
     └─ dob: 01/08/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 402009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'I25.2', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'M17.0'}]
[14:57:10] ✅    ✅ Patient identified: Angelina Barros
[14:57:10] ✅    ✅ Patient name validation passed
[14:57:10] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:10] [DOC: 9278225] ℹ️  DOB normalized: 01/08/1930
[14:57:10] [DOC: 9278225] ℹ️  Episode startOfCare normalized: 04/17/2025
[14:57:10] [DOC: 9278225] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[14:57:10] [DOC: 9278225] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[14:57:10] [DOC: 9278225] ✅ Patient date processing completed successfully
[14:57:10] ✅    ✅ Date processing completed
[14:57:10] 📊 Processed Patient Data
     └─ patientFName: Angelina
     └─ patientLName: Barros
     └─ dob: 01/08/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 402009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.23', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'I25.2', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'M17.0'}]
[14:57:10] 🔄 
🔄 Step 4: Extracting order data...
[14:57:13] ℹ️  Order extraction - MRN: '402009'
[14:57:13] ℹ️  Order extraction - Sex: 'FEMALE'
[14:57:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[14:57:13] ℹ️  Order extraction - Payer Source: ''
[14:57:13] ✅ Order data extraction completed successfully
[14:57:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:57:13] ℹ️  Using MRN from patient data: '402009' over '402009'
[14:57:13] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[14:57:13] ✅ Patient name cross-validation successful
[14:57:13] ✅    ✅ Data merged successfully
[14:57:14] ✅    ✅ Order data extracted and validated
[14:57:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:14] [DOC: 9278225] ✅ Patient found in local cache: Angelina Barros, ID: a4de58ee-e8df-4dda-be6a-ca176172f250
[14:57:14] ✅    ✅ Existing patient found with ID: a4de58ee-e8df-4dda-be6a-ca176172f250
[14:57:14] 🔄 
🔄 Step 6: Pushing order to API...
[14:57:14] [DOC: 9278225] ℹ️  Pushing order via API for patient ID: a4de58ee-e8df-4dda-be6a-ca176172f250
[14:57:16] [DOC: 9278225] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:57:16] ❌    ❌ Failed to push order
[14:57:16] 🔄 
🔄 Step 7: Writing to CSV...
[14:57:16] [DOC: 9278225] ℹ️  Calculated age: 95 from DOB: 01/08/1930
[14:57:16] [DOC: 9278225] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[14:57:16] [DOC: 9278225] ℹ️  Payer Source extracted: ''
[14:57:16] [DOC: 9278225] ℹ️  Diagnosis codes being written:
[14:57:16] [DOC: 9278225] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[14:57:16] [DOC: 9278225] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.23'
[14:57:16] [DOC: 9278225] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[14:57:16] [DOC: 9278225] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.2'
[14:57:16] [DOC: 9278225] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[14:57:16] [DOC: 9278225] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M17.0'
[14:57:16] [DOC: 9278225] ✅ Patient data written to CSV: Angelina Barros | Sex: FEMALE | Age: 95 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 402009
[14:57:16] ✅    ✅ Document 9278225 processed and saved successfully
[14:57:16] 🔄 
🔄 Step 8: Saving API details...
[14:57:16] [DOC: 9278225] ℹ️  API push details saved for document 9278225
[14:57:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278154                         ║
================================================================================
[14:57:16] ℹ️  Agency: Dartmouth HH
[14:57:16] ℹ️  Date: 05/06/2025
[14:57:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:17] [DOC: 9278154] ✅ Text extracted using pdfplumber (1614 chars)
[14:57:17] ✅    ✅ Text extracted using pdfplumber (1614 chars)
[14:57:17] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:20] ℹ️  AI extracted raw sex value: 'F'
[14:57:20] ℹ️  AI extracted service line: 'RN'
[14:57:20] ℹ️  AI extracted payer source: 'Fallon Navicare'
[14:57:20] ℹ️  AI extracted diagnoses:
[14:57:20] ℹ️    - Diagnosis 1: ''
[14:57:20] ℹ️    - Diagnosis 2: ''
[14:57:20] ℹ️    - Diagnosis 3: ''
[14:57:20] ℹ️    - Diagnosis 4: ''
[14:57:20] ℹ️    - Diagnosis 5: ''
[14:57:20] ℹ️    - Diagnosis 6: ''
[14:57:20] ℹ️  Final extracted MRN: '301015'
[14:57:20] ℹ️  Final extracted Sex: 'FEMALE'
[14:57:20] ℹ️  Final extracted Service Line: 'RN'
[14:57:20] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[14:57:20] ✅ Patient data extraction completed successfully
[14:57:20] ✅    ✅ Patient data extracted successfully
[14:57:20] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 117 Bonney Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:20] ✅    ✅ Patient identified: Maria Dacosta
[14:57:20] ✅    ✅ Patient name validation passed
[14:57:20] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:20] [DOC: 9278154] ℹ️  DOB normalized: 10/10/1943
[14:57:20] [DOC: 9278154] ℹ️  Episode startOfCare normalized: 04/19/2024
[14:57:20] [DOC: 9278154] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[14:57:20] [DOC: 9278154] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[14:57:20] [DOC: 9278154] ✅ Patient date processing completed successfully
[14:57:20] ✅    ✅ Date processing completed
[14:57:20] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 117 Bonney Street 1st floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:20] 🔄 
🔄 Step 4: Extracting order data...
[14:57:23] ℹ️  Order extraction - MRN: ''
[14:57:23] ℹ️  Order extraction - Sex: 'FEMALE'
[14:57:23] ℹ️  Order extraction - Service Line: 'RN'
[14:57:23] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[14:57:23] ✅ Order data extraction completed successfully
[14:57:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:57:23] ℹ️  Using MRN from patient data: '301015'
[14:57:23] ℹ️  Service line consistent in both sources: 'RN'
[14:57:23] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[14:57:23] ✅ Patient name cross-validation successful
[14:57:23] ✅    ✅ Data merged successfully
[14:57:24] ✅    ✅ Order data extracted and validated
[14:57:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:24] [DOC: 9278154] ✅ Patient found in local cache: Maria Dacosta, ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[14:57:24] ✅    ✅ Existing patient found with ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[14:57:24] 🔄 
🔄 Step 6: Pushing order to API...
[14:57:24] [DOC: 9278154] ℹ️  Pushing order via API for patient ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[14:57:25] [DOC: 9278154] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13749"}
[14:57:25] ❌    ❌ Failed to push order
[14:57:25] 🔄 
🔄 Step 7: Writing to CSV...
[14:57:25] [DOC: 9278154] ℹ️  Calculated age: 81 from DOB: 10/10/1943
[14:57:25] [DOC: 9278154] ℹ️  Service Line extracted: 'RN'
[14:57:25] [DOC: 9278154] ℹ️  Payer Source extracted: 'Fallon Navicare'
[14:57:25] [DOC: 9278154] ℹ️  Diagnosis codes being written:
[14:57:25] [DOC: 9278154] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:57:25] [DOC: 9278154] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:57:25] [DOC: 9278154] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:57:25] [DOC: 9278154] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:57:25] [DOC: 9278154] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:57:25] [DOC: 9278154] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:57:25] [DOC: 9278154] ✅ Patient data written to CSV: Maria Dacosta | Sex: FEMALE | Age: 81 | Service: RN | Payer: Fallon Navicare | MRN: 301015
[14:57:25] ✅    ✅ Document 9278154 processed and saved successfully
[14:57:25] 🔄 
🔄 Step 8: Saving API details...
[14:57:25] [DOC: 9278154] ℹ️  API push details saved for document 9278154
[14:57:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278150                         ║
================================================================================
[14:57:25] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:57:25] ℹ️  Date: 05/06/2025
[14:57:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:26] [DOC: 9278150] ✅ Text extracted using pdfplumber (877 chars)
[14:57:26] ✅    ✅ Text extracted using pdfplumber (877 chars)
[14:57:26] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:29] ℹ️  AI extracted raw sex value: 'M'
[14:57:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:57:29] ℹ️  AI extracted payer source: ''
[14:57:29] ℹ️  AI extracted diagnoses:
[14:57:29] ℹ️    - Diagnosis 1: ''
[14:57:29] ℹ️    - Diagnosis 2: ''
[14:57:29] ℹ️    - Diagnosis 3: ''
[14:57:29] ℹ️    - Diagnosis 4: ''
[14:57:29] ℹ️    - Diagnosis 5: ''
[14:57:29] ℹ️    - Diagnosis 6: ''
[14:57:29] ℹ️  Final extracted MRN: '2136200'
[14:57:29] ℹ️  Final extracted Sex: 'MALE'
[14:57:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:57:29] ℹ️  Final extracted Payer Source: ''
[14:57:29] ✅ Patient data extraction completed successfully
[14:57:29] ✅    ✅ Patient data extracted successfully
[14:57:29] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:29] ✅    ✅ Patient identified: Jacob Amadeu
[14:57:29] ✅    ✅ Patient name validation passed
[14:57:29] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:29] [DOC: 9278150] ℹ️  DOB normalized: 04/03/1941
[14:57:29] [DOC: 9278150] ℹ️  Episode startOfEpisode normalized: 05/05/2025
[14:57:29] [DOC: 9278150] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[14:57:29] [DOC: 9278150] ✅ Patient date processing completed successfully
[14:57:29] ✅    ✅ Date processing completed
[14:57:29] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:29] 🔄 
🔄 Step 4: Extracting order data...
[14:57:31] ℹ️  Order extraction - MRN: '2136200'
[14:57:31] ℹ️  Order extraction - Sex: 'MALE'
[14:57:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:57:31] ℹ️  Order extraction - Payer Source: ''
[14:57:31] ✅ Order data extraction completed successfully
[14:57:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:57:31] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[14:57:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:57:31] ✅ Patient name cross-validation successful
[14:57:31] ✅    ✅ Data merged successfully
[14:57:32] ✅    ✅ Order data extracted and validated
[14:57:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:57:53] [DOC: 9278150] ℹ️  Patient not found in cache or API: Jacob Amadeu
[14:57:53] [DOC: 9278150] ℹ️  Patient not found, creating new patient via API...
[14:57:53] [DOC: 9278150] ℹ️  Creating patient via API: Jacob Amadeu
[14:57:54] [DOC: 9278150] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:57:54] ❌    ❌ Failed to create patient
[14:57:54] [DOC: 9278150] ℹ️  API push details saved for document 9278150
================================================================================
║                        Processing Document ID: 9278144                         ║
================================================================================
[14:57:54] ℹ️  Agency: Dartmouth HH
[14:57:54] ℹ️  Date: 05/06/2025
[14:57:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:57:57] [DOC: 9278144] ✅ Text extracted using pdfplumber (3230 chars)
[14:57:57] ✅    ✅ Text extracted using pdfplumber (3230 chars)
[14:57:57] 🔄 
🔄 Step 2: Extracting patient data...
[14:57:59] ℹ️  AI extracted raw sex value: 'F'
[14:57:59] ℹ️  AI extracted service line: 'OT'
[14:57:59] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[14:57:59] ℹ️  AI extracted diagnoses:
[14:57:59] ℹ️    - Diagnosis 1: ''
[14:57:59] ℹ️    - Diagnosis 2: ''
[14:57:59] ℹ️    - Diagnosis 3: ''
[14:57:59] ℹ️    - Diagnosis 4: ''
[14:57:59] ℹ️    - Diagnosis 5: ''
[14:57:59] ℹ️    - Diagnosis 6: ''
[14:57:59] ℹ️  Final extracted MRN: '6073015'
[14:57:59] ℹ️  Final extracted Sex: 'FEMALE'
[14:57:59] ℹ️  Final extracted Service Line: 'OT'
[14:57:59] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[14:57:59] ✅ Patient data extraction completed successfully
[14:57:59] ✅    ✅ Patient data extracted successfully
[14:57:59] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:59] ✅    ✅ Patient identified: Marilyn Valle
[14:57:59] ✅    ✅ Patient name validation passed
[14:57:59] 🔄 
🔄 Step 3: Processing patient dates...
[14:57:59] [DOC: 9278144] ℹ️  DOB normalized: 12/24/1947
[14:57:59] [DOC: 9278144] ℹ️  Episode startOfCare normalized: 02/22/2025
[14:57:59] [DOC: 9278144] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[14:57:59] [DOC: 9278144] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[14:57:59] [DOC: 9278144] ✅ Patient date processing completed successfully
[14:57:59] ✅    ✅ Date processing completed
[14:57:59] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:57:59] 🔄 
🔄 Step 4: Extracting order data...
[14:58:02] ℹ️  Order extraction - MRN: ''
[14:58:02] ℹ️  Order extraction - Sex: 'FEMALE'
[14:58:02] ℹ️  Order extraction - Service Line: 'OT'
[14:58:02] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[14:58:02] ✅ Order data extraction completed successfully
[14:58:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:02] ℹ️  Using MRN from patient data: '6073015'
[14:58:02] ℹ️  Service line consistent in both sources: 'OT'
[14:58:02] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[14:58:02] ✅ Patient name cross-validation successful
[14:58:02] ✅    ✅ Data merged successfully
[14:58:03] ✅    ✅ Order data extracted and validated
[14:58:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:03] [DOC: 9278144] ✅ Patient found in local cache: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[14:58:03] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[14:58:03] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:03] [DOC: 9278144] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[14:58:04] [DOC: 9278144] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14250"}
[14:58:04] ❌    ❌ Failed to push order
[14:58:04] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:04] [DOC: 9278144] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[14:58:04] [DOC: 9278144] ℹ️  Service Line extracted: 'OT'
[14:58:04] [DOC: 9278144] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[14:58:04] [DOC: 9278144] ℹ️  Diagnosis codes being written:
[14:58:04] [DOC: 9278144] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:04] [DOC: 9278144] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:04] [DOC: 9278144] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:04] [DOC: 9278144] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:04] [DOC: 9278144] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:04] [DOC: 9278144] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:04] [DOC: 9278144] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT | Payer: Aetna- Mcare | MRN: 6073015
[14:58:04] ✅    ✅ Document 9278144 processed and saved successfully
[14:58:04] 🔄 
🔄 Step 8: Saving API details...
[14:58:04] [DOC: 9278144] ℹ️  API push details saved for document 9278144
[14:58:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278142                         ║
================================================================================
[14:58:04] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:58:04] ℹ️  Date: 05/06/2025
[14:58:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:06] [DOC: 9278142] ✅ Text extracted using pdfplumber (5529 chars)
[14:58:06] ✅    ✅ Text extracted using pdfplumber (5529 chars)
[14:58:06] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:09] ℹ️  AI extracted raw sex value: 'M'
[14:58:09] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work'
[14:58:09] ℹ️  AI extracted payer source: ''
[14:58:09] ℹ️  AI extracted diagnoses:
[14:58:09] ℹ️    - Diagnosis 1: ''
[14:58:09] ℹ️    - Diagnosis 2: ''
[14:58:09] ℹ️    - Diagnosis 3: ''
[14:58:09] ℹ️    - Diagnosis 4: ''
[14:58:09] ℹ️    - Diagnosis 5: ''
[14:58:09] ℹ️    - Diagnosis 6: ''
[14:58:09] ℹ️  Final extracted MRN: '2469775'
[14:58:09] ℹ️  Final extracted Sex: 'MALE'
[14:58:09] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work'
[14:58:09] ℹ️  Final extracted Payer Source: ''
[14:58:09] ✅ Patient data extraction completed successfully
[14:58:09] ✅    ✅ Patient data extracted successfully
[14:58:09] 📊 Patient Response
     └─ patientFName: Mario
     └─ patientLName: Fialho
     └─ dob: 02/13/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2469775
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: []
[14:58:09] ✅    ✅ Patient identified: Mario Fialho
[14:58:09] ✅    ✅ Patient name validation passed
[14:58:09] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:09] [DOC: 9278142] ℹ️  DOB normalized: 02/13/1946
[14:58:09] [DOC: 9278142] ✅ Patient date processing completed successfully
[14:58:09] ✅    ✅ Date processing completed
[14:58:09] 📊 Processed Patient Data
     └─ patientFName: Mario
     └─ patientLName: Fialho
     └─ dob: 02/13/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2469775
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: []
[14:58:09] 🔄 
🔄 Step 4: Extracting order data...
[14:58:12] ℹ️  Order extraction - MRN: '2469775'
[14:58:12] ℹ️  Order extraction - Sex: 'MALE'
[14:58:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work'
[14:58:12] ℹ️  Order extraction - Payer Source: ''
[14:58:12] ✅ Order data extraction completed successfully
[14:58:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:12] ℹ️  Using MRN from patient data: '2469775' over '2469775'
[14:58:12] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work'
[14:58:12] ✅ Patient name cross-validation successful
[14:58:12] ✅    ✅ Data merged successfully
[14:58:13] ✅    ✅ Order data extracted and validated
[14:58:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:13] [DOC: 9278142] ✅ Patient found in local cache: Mario Fialho, ID: 529c500d-5320-4ac1-a293-eb2867b2e42e
[14:58:13] ✅    ✅ Existing patient found with ID: 529c500d-5320-4ac1-a293-eb2867b2e42e
[14:58:13] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:13] [DOC: 9278142] ℹ️  Pushing order via API for patient ID: 529c500d-5320-4ac1-a293-eb2867b2e42e
[14:58:15] [DOC: 9278142] ❌ Order push failed with status 201: {"id":"08b4ce66-f297-49c2-8f49-de328bd7c704","orderWAVId":"ORD19951","orderNo":"1088863, 1088995, 1088996, 1088997, 1088998, 1088999, 1089023, 1089024","orderDate":"05/05/2025","startOfCare":"05/05/2025","episodeStartDate":"05/05/2025","episodeEndDate":"05/15/2025","documentID":"9278142","mrn":"2469775","patientName":"Fialho,Mario","sentToPhysicianDate":"05/06/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"529c500d-5320-4ac1-a293-eb2867b2e42e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:58:15] ❌    ❌ Failed to push order
[14:58:15] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:15] [DOC: 9278142] ℹ️  Calculated age: 79 from DOB: 02/13/1946
[14:58:15] [DOC: 9278142] ℹ️  Service Line extracted: 'Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work'
[14:58:15] [DOC: 9278142] ℹ️  Payer Source extracted: ''
[14:58:15] [DOC: 9278142] ℹ️  Diagnosis codes being written:
[14:58:15] [DOC: 9278142] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:15] [DOC: 9278142] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:15] [DOC: 9278142] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:15] [DOC: 9278142] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:15] [DOC: 9278142] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:15] [DOC: 9278142] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:15] [DOC: 9278142] ✅ Patient data written to CSV: Mario Fialho | Sex: MALE | Age: 79 | Service: Skilled Nursing, Home Health Aide, Physical Therapy, Occupational Therapy, Medical Social Work | Payer:  | MRN: 2469775
[14:58:15] ✅    ✅ Document 9278142 processed and saved successfully
[14:58:15] 🔄 
🔄 Step 8: Saving API details...
[14:58:15] [DOC: 9278142] ℹ️  API push details saved for document 9278142
[14:58:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9278128                         ║
================================================================================
[14:58:15] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:58:15] ℹ️  Date: 05/06/2025
[14:58:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:16] [DOC: 9278128] ✅ Text extracted using pdfplumber (908 chars)
[14:58:16] ✅    ✅ Text extracted using pdfplumber (908 chars)
[14:58:16] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:19] ℹ️  AI extracted raw sex value: 'F'
[14:58:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:58:19] ℹ️  AI extracted payer source: ''
[14:58:19] ℹ️  AI extracted diagnoses:
[14:58:19] ℹ️    - Diagnosis 1: ''
[14:58:19] ℹ️    - Diagnosis 2: ''
[14:58:19] ℹ️    - Diagnosis 3: ''
[14:58:19] ℹ️    - Diagnosis 4: ''
[14:58:19] ℹ️    - Diagnosis 5: ''
[14:58:19] ℹ️    - Diagnosis 6: ''
[14:58:19] ℹ️  Final extracted MRN: '2240353'
[14:58:19] ℹ️  Final extracted Sex: 'FEMALE'
[14:58:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:58:19] ℹ️  Final extracted Payer Source: ''
[14:58:19] ✅ Patient data extraction completed successfully
[14:58:19] ✅    ✅ Patient data extracted successfully
[14:58:19] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:19] ✅    ✅ Patient identified: Eileen Bettencourt
[14:58:19] ✅    ✅ Patient name validation passed
[14:58:19] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:19] [DOC: 9278128] ℹ️  DOB normalized: 04/20/1945
[14:58:19] [DOC: 9278128] ℹ️  Episode startOfEpisode normalized: 05/05/2025
[14:58:19] [DOC: 9278128] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[14:58:19] [DOC: 9278128] ✅ Patient date processing completed successfully
[14:58:19] ✅    ✅ Date processing completed
[14:58:19] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:58:19] 🔄 
🔄 Step 4: Extracting order data...
[14:58:21] ℹ️  Order extraction - MRN: '2240353'
[14:58:21] ℹ️  Order extraction - Sex: 'FEMALE'
[14:58:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:58:21] ℹ️  Order extraction - Payer Source: ''
[14:58:21] ✅ Order data extraction completed successfully
[14:58:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:21] ℹ️  Using MRN from patient data: '2240353' over '2240353'
[14:58:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:58:21] ✅ Patient name cross-validation successful
[14:58:21] ✅    ✅ Data merged successfully
[14:58:22] ✅    ✅ Order data extracted and validated
[14:58:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:22] [DOC: 9278128] ✅ Patient found in local cache: Eileen Bettencourt, ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[14:58:22] ✅    ✅ Existing patient found with ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[14:58:22] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:22] [DOC: 9278128] ℹ️  Pushing order via API for patient ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[14:58:23] [DOC: 9278128] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13140"}
[14:58:23] ❌    ❌ Failed to push order
[14:58:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:23] [DOC: 9278128] ℹ️  Calculated age: 80 from DOB: 04/20/1945
[14:58:23] [DOC: 9278128] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:58:23] [DOC: 9278128] ℹ️  Payer Source extracted: ''
[14:58:23] [DOC: 9278128] ℹ️  Diagnosis codes being written:
[14:58:23] [DOC: 9278128] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:23] [DOC: 9278128] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:23] [DOC: 9278128] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:23] [DOC: 9278128] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:23] [DOC: 9278128] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:23] [DOC: 9278128] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:23] [DOC: 9278128] ✅ Patient data written to CSV: Eileen Bettencourt | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: 2240353
[14:58:23] ✅    ✅ Document 9278128 processed and saved successfully
[14:58:23] 🔄 
🔄 Step 8: Saving API details...
[14:58:23] [DOC: 9278128] ℹ️  API push details saved for document 9278128
[14:58:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9277367                         ║
================================================================================
[14:58:23] ℹ️  Agency: AccentCare Fall River
[14:58:23] ℹ️  Date: 05/05/2025
[14:58:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:26] [DOC: 9277367] ✅ Text extracted using pdfplumber (1223 chars)
[14:58:26] ✅    ✅ Text extracted using pdfplumber (1223 chars)
[14:58:26] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:28] ℹ️  AI extracted raw sex value: ''
[14:58:28] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:58:28] ℹ️  AI extracted payer source: ''
[14:58:28] ℹ️  AI extracted diagnoses:
[14:58:28] ℹ️    - Diagnosis 1: 'None'
[14:58:28] ℹ️    - Diagnosis 2: 'None'
[14:58:28] ℹ️    - Diagnosis 3: 'None'
[14:58:28] ℹ️    - Diagnosis 4: 'None'
[14:58:28] ℹ️    - Diagnosis 5: 'None'
[14:58:28] ℹ️    - Diagnosis 6: 'None'
[14:58:28] ℹ️  Final extracted MRN: 'C0200225049201'
[14:58:28] ℹ️  Final extracted Sex: ''
[14:58:28] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:58:28] ℹ️  Final extracted Payer Source: ''
[14:58:28] ✅ Patient data extraction completed successfully
[14:58:28] ✅    ✅ Patient data extracted successfully
[14:58:28] 📊 Patient Response
     └─ patientFName: BRUNILDA
     └─ patientLName: JORGE
     └─ dob: 11/15/1938
     └─ patientSex: 
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:58:28] ✅    ✅ Patient identified: BRUNILDA JORGE
[14:58:28] ✅    ✅ Patient name validation passed
[14:58:28] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:28] [DOC: 9277367] ℹ️  DOB normalized: 11/15/1938
[14:58:28] [DOC: 9277367] ✅ Patient date processing completed successfully
[14:58:28] ✅    ✅ Date processing completed
[14:58:28] 📊 Processed Patient Data
     └─ patientFName: BRUNILDA
     └─ patientLName: JORGE
     └─ dob: 11/15/1938
     └─ patientSex: 
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:58:28] 🔄 
🔄 Step 4: Extracting order data...
[14:58:31] ℹ️  Order extraction - MRN: 'C0200225049201'
[14:58:31] ℹ️  Order extraction - Sex: ''
[14:58:31] ℹ️  Order extraction - Service Line: 'RN'
[14:58:31] ℹ️  Order extraction - Payer Source: ''
[14:58:31] ✅ Order data extraction completed successfully
[14:58:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:31] ℹ️  Using MRN from patient data: 'C0200225049201' over 'C0200225049201'
[14:58:31] ⚠️  Could not determine sex using any available method
[14:58:31] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[14:58:31] ✅ Patient name cross-validation successful
[14:58:31] ✅    ✅ Data merged successfully
[14:58:32] ✅    ✅ Order data extracted and validated
[14:58:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:32] [DOC: 9277367] ✅ Patient found in local cache: BRUNILDA JORGE, ID: be097701-4784-41f4-8780-f2f69c6e2485
[14:58:32] ✅    ✅ Existing patient found with ID: be097701-4784-41f4-8780-f2f69c6e2485
[14:58:32] 🔄 
🔄 Step 6: Pushing order to API...
[14:58:32] [DOC: 9277367] ℹ️  Pushing order via API for patient ID: be097701-4784-41f4-8780-f2f69c6e2485
[14:58:33] [DOC: 9277367] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13878"}
[14:58:33] ❌    ❌ Failed to push order
[14:58:33] 🔄 
🔄 Step 7: Writing to CSV...
[14:58:33] [DOC: 9277367] ℹ️  Calculated age: 86 from DOB: 11/15/1938
[14:58:33] [DOC: 9277367] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[14:58:33] [DOC: 9277367] ℹ️  Payer Source extracted: ''
[14:58:33] [DOC: 9277367] ℹ️  Diagnosis codes being written:
[14:58:33] [DOC: 9277367] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:58:33] [DOC: 9277367] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:58:33] [DOC: 9277367] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:58:33] [DOC: 9277367] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:58:33] [DOC: 9277367] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:58:33] [DOC: 9277367] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:58:33] [DOC: 9277367] ✅ Patient data written to CSV: BRUNILDA JORGE | Sex:  | Age: 86 | Service: RN, Skilled Nursing | Payer:  | MRN: C0200225049201
[14:58:33] ✅    ✅ Document 9277367 processed and saved successfully
[14:58:33] 🔄 
🔄 Step 8: Saving API details...
[14:58:33] [DOC: 9277367] ℹ️  API push details saved for document 9277367
[14:58:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9277139                         ║
================================================================================
[14:58:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:58:33] ℹ️  Date: 05/05/2025
[14:58:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:34] [DOC: 9277139] ✅ Text extracted using pdfplumber (990 chars)
[14:58:34] ✅    ✅ Text extracted using pdfplumber (990 chars)
[14:58:34] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:37] ℹ️  AI extracted raw sex value: 'M'
[14:58:37] ℹ️  AI extracted service line: 'Nursing'
[14:58:37] ℹ️  AI extracted payer source: ''
[14:58:37] ℹ️  AI extracted diagnoses:
[14:58:37] ℹ️    - Diagnosis 1: 'None'
[14:58:37] ℹ️    - Diagnosis 2: 'None'
[14:58:37] ℹ️    - Diagnosis 3: 'None'
[14:58:37] ℹ️    - Diagnosis 4: 'None'
[14:58:37] ℹ️    - Diagnosis 5: 'None'
[14:58:37] ℹ️    - Diagnosis 6: 'None'
[14:58:37] ℹ️  Final extracted MRN: '3091790'
[14:58:37] ℹ️  Final extracted Sex: 'MALE'
[14:58:37] ℹ️  Final extracted Service Line: 'Nursing'
[14:58:37] ℹ️  Final extracted Payer Source: ''
[14:58:37] ✅ Patient data extraction completed successfully
[14:58:37] ✅    ✅ Patient data extracted successfully
[14:58:37] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:58:37] ✅    ✅ Patient identified: Richard White
[14:58:37] ✅    ✅ Patient name validation passed
[14:58:37] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:37] [DOC: 9277139] ℹ️  DOB normalized: 12/08/1957
[14:58:37] [DOC: 9277139] ✅ Patient date processing completed successfully
[14:58:37] ✅    ✅ Date processing completed
[14:58:37] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:58:37] 🔄 
🔄 Step 4: Extracting order data...
[14:58:39] ℹ️  Order extraction - MRN: '3091790'
[14:58:39] ℹ️  Order extraction - Sex: 'MALE'
[14:58:39] ℹ️  Order extraction - Service Line: ''
[14:58:39] ℹ️  Order extraction - Payer Source: ''
[14:58:39] ✅ Order data extraction completed successfully
[14:58:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:39] ℹ️  Using MRN from patient data: '3091790' over '3091790'
[14:58:39] ℹ️  Using service line from patient data: 'Nursing'
[14:58:39] ✅ Patient name cross-validation successful
[14:58:39] ✅    ✅ Data merged successfully
[14:58:40] ⚠️     ❌ Skipping - missing episode start date
[14:58:40] [DOC: 9277139] ℹ️  API push details saved for document 9277139
================================================================================
║                        Processing Document ID: 9277132                         ║
================================================================================
[14:58:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:58:40] ℹ️  Date: 05/05/2025
[14:58:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:58:43] [DOC: 9277132] ✅ Text extracted using pdfplumber (22711 chars)
[14:58:43] ✅    ✅ Text extracted using pdfplumber (22711 chars)
[14:58:43] 🔄 
🔄 Step 2: Extracting patient data...
[14:58:47] ℹ️  AI extracted raw sex value: 'F'
[14:58:47] ℹ️  AI extracted service line: 'Skilled Nursing, Medical Social Work,  Home Health Aide, Volunteer'
[14:58:47] ℹ️  AI extracted payer source: ''
[14:58:47] ℹ️  AI extracted diagnoses:
[14:58:47] ℹ️    - Diagnosis 1: 'E43'
[14:58:47] ℹ️    - Diagnosis 2: 'F03.90'
[14:58:47] ℹ️    - Diagnosis 3: 'R62.7'
[14:58:47] ℹ️    - Diagnosis 4: 'R63.4'
[14:58:47] ℹ️    - Diagnosis 5: 'R53.1'
[14:58:47] ℹ️    - Diagnosis 6: 'R29.6'
[14:58:47] ℹ️  Final extracted MRN: '3161102'
[14:58:47] ℹ️  Final extracted Sex: 'FEMALE'
[14:58:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medical Social Work,  Home Health Aide, Volunteer'
[14:58:47] ℹ️  Final extracted Payer Source: ''
[14:58:47] ✅ Patient data extraction completed successfully
[14:58:47] ✅    ✅ Patient data extracted successfully
[14:58:47] 📊 Patient Response
     └─ patientFName: Leona
     └─ patientLName: Souza
     └─ dob: 08/20/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3161102
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work,  Home Health Aide, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/12/2023', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'R62.7', 'fourthDiagnosis': 'R63.4', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'R29.6'}]
[14:58:47] ✅    ✅ Patient identified: Leona Souza
[14:58:47] ✅    ✅ Patient name validation passed
[14:58:47] 🔄 
🔄 Step 3: Processing patient dates...
[14:58:47] [DOC: 9277132] ℹ️  DOB normalized: 08/20/1926
[14:58:47] [DOC: 9277132] ℹ️  Episode startOfCare normalized: 01/12/2023
[14:58:47] [DOC: 9277132] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[14:58:47] [DOC: 9277132] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[14:58:47] [DOC: 9277132] ✅ Patient date processing completed successfully
[14:58:47] ✅    ✅ Date processing completed
[14:58:47] 📊 Processed Patient Data
     └─ patientFName: Leona
     └─ patientLName: Souza
     └─ dob: 08/20/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3161102
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work,  Home Health Aide, Volunteer
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/12/2023', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'E43', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'R62.7', 'fourthDiagnosis': 'R63.4', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'R29.6'}]
[14:58:47] 🔄 
🔄 Step 4: Extracting order data...
[14:58:50] ℹ️  Order extraction - MRN: '3161102'
[14:58:50] ℹ️  Order extraction - Sex: 'FEMALE'
[14:58:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[14:58:50] ℹ️  Order extraction - Payer Source: ''
[14:58:50] ✅ Order data extraction completed successfully
[14:58:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:58:50] ℹ️  Using MRN from patient data: '3161102' over '3161102'
[14:58:50] ℹ️  Combined service lines: Patient='Skilled Nursing, Medical Social Work,  Home Health Aide, Volunteer' + Order='Skilled Nursing, MSW, HHA' = 'HHA, Home Health Aide, MSW, Medical Social Work, Skilled Nursing, Volunteer'
[14:58:50] ✅ Patient name cross-validation successful
[14:58:50] ✅    ✅ Data merged successfully
[14:58:51] ✅    ✅ Order data extracted and validated
[14:58:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:58:58] [DOC: 9277132] ℹ️  Patient not found in cache or API: Leona Souza
[14:58:58] [DOC: 9277132] ℹ️  Patient not found, creating new patient via API...
[14:58:58] [DOC: 9277132] ℹ️  Creating patient via API: Leona Souza
[14:58:59] [DOC: 9277132] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:58:59] ❌    ❌ Failed to create patient
[14:58:59] [DOC: 9277132] ℹ️  API push details saved for document 9277132
================================================================================
║                        Processing Document ID: 9277129                         ║
================================================================================
[14:58:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:58:59] ℹ️  Date: 05/05/2025
[14:58:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:01] [DOC: 9277129] ✅ Text extracted using pdfplumber (2729 chars)
[14:59:01] ✅    ✅ Text extracted using pdfplumber (2729 chars)
[14:59:01] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:04] ℹ️  AI extracted raw sex value: 'F'
[14:59:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:59:04] ℹ️  AI extracted payer source: ''
[14:59:04] ℹ️  AI extracted diagnoses:
[14:59:04] ℹ️    - Diagnosis 1: 'None'
[14:59:04] ℹ️    - Diagnosis 2: 'None'
[14:59:04] ℹ️    - Diagnosis 3: 'None'
[14:59:04] ℹ️    - Diagnosis 4: 'None'
[14:59:04] ℹ️    - Diagnosis 5: 'None'
[14:59:04] ℹ️    - Diagnosis 6: 'None'
[14:59:04] ℹ️  Final extracted MRN: '2936720'
[14:59:04] ℹ️  Final extracted Sex: 'FEMALE'
[14:59:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:59:04] ℹ️  Final extracted Payer Source: ''
[14:59:04] ✅ Patient data extraction completed successfully
[14:59:04] ✅    ✅ Patient data extracted successfully
[14:59:04] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:59:04] ✅    ✅ Patient identified: Stella Saint
[14:59:04] ✅    ✅ Patient name validation passed
[14:59:04] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:04] [DOC: 9277129] ℹ️  DOB normalized: 07/02/1928
[14:59:04] [DOC: 9277129] ✅ Patient date processing completed successfully
[14:59:04] ✅    ✅ Date processing completed
[14:59:04] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:59:04] 🔄 
🔄 Step 4: Extracting order data...
[14:59:06] ℹ️  Order extraction - MRN: '2936720'
[14:59:06] ℹ️  Order extraction - Sex: 'FEMALE'
[14:59:06] ℹ️  Order extraction - Service Line: 'RN'
[14:59:06] ℹ️  Order extraction - Payer Source: ''
[14:59:06] ✅ Order data extraction completed successfully
[14:59:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:06] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[14:59:06] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[14:59:06] ✅ Patient name cross-validation successful
[14:59:06] ✅    ✅ Data merged successfully
[14:59:07] ✅    ✅ Order data extracted and validated
[14:59:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:07] [DOC: 9277129] ✅ Patient found in local cache: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[14:59:07] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[14:59:07] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:07] [DOC: 9277129] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[14:59:09] [DOC: 9277129] ❌ Order push failed with status 201: {"id":"0d8c8738-7e60-4a9b-9200-7161222cdc5e","orderWAVId":"ORD19952","orderNo":"1088157, 1088223, 1088640, 1088641, 1088553","orderDate":"05/02/2025","startOfCare":"04/25/2025","episodeStartDate":"04/25/2025","episodeEndDate":"06/23/2025","documentID":"9277129","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"05/05/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:59:09] ❌    ❌ Failed to push order
[14:59:09] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:09] [DOC: 9277129] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[14:59:09] [DOC: 9277129] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[14:59:09] [DOC: 9277129] ℹ️  Payer Source extracted: ''
[14:59:09] [DOC: 9277129] ℹ️  Diagnosis codes being written:
[14:59:09] [DOC: 9277129] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:59:09] [DOC: 9277129] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:59:09] [DOC: 9277129] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:59:09] [DOC: 9277129] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:59:09] [DOC: 9277129] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:59:09] [DOC: 9277129] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:59:09] [DOC: 9277129] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: RN, Skilled Nursing | Payer:  | MRN: 2936720
[14:59:09] ✅    ✅ Document 9277129 processed and saved successfully
[14:59:09] 🔄 
🔄 Step 8: Saving API details...
[14:59:09] [DOC: 9277129] ℹ️  API push details saved for document 9277129
[14:59:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9277127                         ║
================================================================================
[14:59:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:59:09] ℹ️  Date: 05/05/2025
[14:59:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:12] [DOC: 9277127] ✅ Text extracted using pdfplumber (15121 chars)
[14:59:12] ✅    ✅ Text extracted using pdfplumber (15121 chars)
[14:59:12] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:15] ℹ️  AI extracted raw sex value: 'F'
[14:59:15] ℹ️  AI extracted service line: 'Physical Therapy'
[14:59:15] ℹ️  AI extracted payer source: ''
[14:59:15] ℹ️  AI extracted diagnoses:
[14:59:15] ℹ️    - Diagnosis 1: 'I10'
[14:59:15] ℹ️    - Diagnosis 2: 'R29.6'
[14:59:15] ℹ️    - Diagnosis 3: 'Z86.73'
[14:59:15] ℹ️    - Diagnosis 4: 'J44.9'
[14:59:15] ℹ️    - Diagnosis 5: 'E78.5'
[14:59:15] ℹ️    - Diagnosis 6: 'E03.9'
[14:59:15] ℹ️  Final extracted MRN: '2925069'
[14:59:15] ℹ️  Final extracted Sex: 'FEMALE'
[14:59:15] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:59:15] ℹ️  Final extracted Payer Source: ''
[14:59:15] ✅ Patient data extraction completed successfully
[14:59:15] ✅    ✅ Patient data extracted successfully
[14:59:15] 📊 Patient Response
     └─ patientFName: Anna
     └─ patientLName: Rose
     └─ dob: 04/03/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2925069
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'Z86.73', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'E03.9'}]
[14:59:15] ✅    ✅ Patient identified: Anna Rose
[14:59:15] ✅    ✅ Patient name validation passed
[14:59:15] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:15] [DOC: 9277127] ℹ️  DOB normalized: 04/03/1933
[14:59:15] [DOC: 9277127] ℹ️  Episode startOfCare normalized: 04/19/2025
[14:59:15] [DOC: 9277127] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[14:59:15] [DOC: 9277127] ℹ️  Episode endOfEpisode normalized: 06/19/2025
[14:59:15] [DOC: 9277127] ✅ Patient date processing completed successfully
[14:59:15] ✅    ✅ Date processing completed
[14:59:15] 📊 Processed Patient Data
     └─ patientFName: Anna
     └─ patientLName: Rose
     └─ dob: 04/03/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2925069
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'Z86.73', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'E03.9'}]
[14:59:15] 🔄 
🔄 Step 4: Extracting order data...
[14:59:18] ℹ️  Order extraction - MRN: '2925069'
[14:59:18] ℹ️  Order extraction - Sex: 'FEMALE'
[14:59:18] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:59:18] ℹ️  Order extraction - Payer Source: ''
[14:59:18] ✅ Order data extraction completed successfully
[14:59:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:18] ℹ️  Using MRN from patient data: '2925069' over '2925069'
[14:59:18] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:59:18] ✅ Patient name cross-validation successful
[14:59:18] ✅    ✅ Data merged successfully
[14:59:19] ✅    ✅ Order data extracted and validated
[14:59:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:24] [DOC: 9277127] ℹ️  Patient not found in cache or API: Anna Rose
[14:59:24] [DOC: 9277127] ℹ️  Patient not found, creating new patient via API...
[14:59:24] [DOC: 9277127] ℹ️  Creating patient via API: Anna Rose
[14:59:25] [DOC: 9277127] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:59:25] ❌    ❌ Failed to create patient
[14:59:25] [DOC: 9277127] ℹ️  API push details saved for document 9277127
================================================================================
║                        Processing Document ID: 9277112                         ║
================================================================================
[14:59:25] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:59:25] ℹ️  Date: 05/05/2025
[14:59:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:27] [DOC: 9277112] ✅ Text extracted using pdfplumber (1149 chars)
[14:59:27] ✅    ✅ Text extracted using pdfplumber (1149 chars)
[14:59:27] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:30] ℹ️  AI extracted raw sex value: 'M'
[14:59:30] ℹ️  AI extracted service line: 'LPN'
[14:59:30] ℹ️  AI extracted payer source: ''
[14:59:30] ℹ️  AI extracted diagnoses:
[14:59:30] ℹ️    - Diagnosis 1: ''
[14:59:30] ℹ️    - Diagnosis 2: ''
[14:59:30] ℹ️    - Diagnosis 3: ''
[14:59:30] ℹ️    - Diagnosis 4: ''
[14:59:30] ℹ️    - Diagnosis 5: ''
[14:59:30] ℹ️    - Diagnosis 6: ''
[14:59:30] ℹ️  Final extracted MRN: '2679776'
[14:59:30] ℹ️  Final extracted Sex: 'MALE'
[14:59:30] ℹ️  Final extracted Service Line: 'LPN'
[14:59:30] ℹ️  Final extracted Payer Source: ''
[14:59:30] ✅ Patient data extraction completed successfully
[14:59:30] ✅    ✅ Patient data extracted successfully
[14:59:30] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:59:30] ✅    ✅ Patient identified: Milton MacDonald
[14:59:30] ✅    ✅ Patient name validation passed
[14:59:30] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:30] [DOC: 9277112] ℹ️  DOB normalized: 03/20/1939
[14:59:30] [DOC: 9277112] ✅ Patient date processing completed successfully
[14:59:30] ✅    ✅ Date processing completed
[14:59:30] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:59:30] 🔄 
🔄 Step 4: Extracting order data...
[14:59:32] ℹ️  Order extraction - MRN: '2679776'
[14:59:32] ℹ️  Order extraction - Sex: 'MALE'
[14:59:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:59:32] ℹ️  Order extraction - Payer Source: ''
[14:59:32] ✅ Order data extraction completed successfully
[14:59:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:32] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[14:59:32] ℹ️  Combined service lines: Patient='LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[14:59:32] ✅ Patient name cross-validation successful
[14:59:32] ✅    ✅ Data merged successfully
[14:59:33] ✅    ✅ Order data extracted and validated
[14:59:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:38] [DOC: 9277112] ✅ Patient exists in API: Milton MacDonald, ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[14:59:38] ✅    ✅ Existing patient found with ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[14:59:38] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:38] [DOC: 9277112] ℹ️  Pushing order via API for patient ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[14:59:39] [DOC: 9277112] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19647"}
[14:59:39] ❌    ❌ Failed to push order
[14:59:39] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:39] [DOC: 9277112] ℹ️  Calculated age: 86 from DOB: 03/20/1939
[14:59:39] [DOC: 9277112] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[14:59:39] [DOC: 9277112] ℹ️  Payer Source extracted: ''
[14:59:39] [DOC: 9277112] ℹ️  Diagnosis codes being written:
[14:59:39] [DOC: 9277112] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:59:39] [DOC: 9277112] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:59:39] [DOC: 9277112] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:59:39] [DOC: 9277112] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:59:39] [DOC: 9277112] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:59:39] [DOC: 9277112] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:59:39] [DOC: 9277112] ✅ Patient data written to CSV: Milton MacDonald | Sex: MALE | Age: 86 | Service: LPN, Skilled Nursing | Payer:  | MRN: 2679776
[14:59:39] ✅    ✅ Document 9277112 processed and saved successfully
[14:59:39] 🔄 
🔄 Step 8: Saving API details...
[14:59:39] [DOC: 9277112] ℹ️  API push details saved for document 9277112
[14:59:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9277088                         ║
================================================================================
[14:59:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:59:39] ℹ️  Date: 05/05/2025
[14:59:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:41] [DOC: 9277088] ✅ Text extracted using pdfplumber (1140 chars)
[14:59:41] ✅    ✅ Text extracted using pdfplumber (1140 chars)
[14:59:41] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:43] ℹ️  AI extracted raw sex value: 'F'
[14:59:43] ℹ️  AI extracted service line: 'PT'
[14:59:43] ℹ️  AI extracted payer source: ''
[14:59:43] ℹ️  AI extracted diagnoses:
[14:59:43] ℹ️    - Diagnosis 1: 'None'
[14:59:43] ℹ️    - Diagnosis 2: 'None'
[14:59:43] ℹ️    - Diagnosis 3: 'None'
[14:59:43] ℹ️    - Diagnosis 4: 'None'
[14:59:43] ℹ️    - Diagnosis 5: 'None'
[14:59:43] ℹ️    - Diagnosis 6: 'None'
[14:59:43] ℹ️  Final extracted MRN: '2491526'
[14:59:43] ℹ️  Final extracted Sex: 'FEMALE'
[14:59:43] ℹ️  Final extracted Service Line: 'PT'
[14:59:43] ℹ️  Final extracted Payer Source: ''
[14:59:43] ✅ Patient data extraction completed successfully
[14:59:43] ✅    ✅ Patient data extracted successfully
[14:59:43] 📊 Patient Response
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:59:43] ✅    ✅ Patient identified: Alda Frias
[14:59:43] ✅    ✅ Patient name validation passed
[14:59:43] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:43] [DOC: 9277088] ℹ️  DOB normalized: 10/11/1934
[14:59:43] [DOC: 9277088] ✅ Patient date processing completed successfully
[14:59:43] ✅    ✅ Date processing completed
[14:59:43] 📊 Processed Patient Data
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[14:59:43] 🔄 
🔄 Step 4: Extracting order data...
[14:59:45] ℹ️  Order extraction - MRN: '2491526'
[14:59:45] ℹ️  Order extraction - Sex: 'FEMALE'
[14:59:45] ℹ️  Order extraction - Service Line: ''
[14:59:45] ℹ️  Order extraction - Payer Source: ''
[14:59:45] ✅ Order data extraction completed successfully
[14:59:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:59:45] ℹ️  Using MRN from patient data: '2491526' over '2491526'
[14:59:45] ℹ️  Using service line from patient data: 'PT'
[14:59:45] ✅ Patient name cross-validation successful
[14:59:45] ✅    ✅ Data merged successfully
[14:59:47] ✅    ✅ Order data extracted and validated
[14:59:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:59:52] [DOC: 9277088] ✅ Patient exists in API: Alda Frias, ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[14:59:52] ✅    ✅ Existing patient found with ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[14:59:52] 🔄 
🔄 Step 6: Pushing order to API...
[14:59:52] [DOC: 9277088] ℹ️  Pushing order via API for patient ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[14:59:53] [DOC: 9277088] ❌ Order push failed with status 201: {"id":"bca07962-0457-45d7-b7bb-e670bc9ffcf1","orderWAVId":"ORD19953","orderNo":"1088576, 1088577","orderDate":"05/03/2025","startOfCare":"04/23/2025","episodeStartDate":"04/23/2025","episodeEndDate":"06/21/2025","documentID":"9277088","mrn":"2491526","patientName":"Frias,Alda F.","sentToPhysicianDate":"05/05/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"815d9cfc-89d4-4f96-a8a6-1c3f6d19d220","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:59:53] ❌    ❌ Failed to push order
[14:59:53] 🔄 
🔄 Step 7: Writing to CSV...
[14:59:53] [DOC: 9277088] ℹ️  Calculated age: 90 from DOB: 10/11/1934
[14:59:53] [DOC: 9277088] ℹ️  Service Line extracted: 'PT'
[14:59:53] [DOC: 9277088] ℹ️  Payer Source extracted: ''
[14:59:53] [DOC: 9277088] ℹ️  Diagnosis codes being written:
[14:59:53] [DOC: 9277088] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:59:53] [DOC: 9277088] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:59:53] [DOC: 9277088] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:59:53] [DOC: 9277088] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:59:53] [DOC: 9277088] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:59:53] [DOC: 9277088] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:59:53] [DOC: 9277088] ✅ Patient data written to CSV: Alda Frias | Sex: FEMALE | Age: 90 | Service: PT | Payer:  | MRN: 2491526
[14:59:53] ✅    ✅ Document 9277088 processed and saved successfully
[14:59:53] 🔄 
🔄 Step 8: Saving API details...
[14:59:53] [DOC: 9277088] ℹ️  API push details saved for document 9277088
[14:59:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9277076                         ║
================================================================================
[14:59:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:59:53] ℹ️  Date: 05/05/2025
[14:59:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:59:56] [DOC: 9277076] ✅ Text extracted using pdfplumber (15267 chars)
[14:59:56] ✅    ✅ Text extracted using pdfplumber (15257 chars)
[14:59:56] 🔄 
🔄 Step 2: Extracting patient data...
[14:59:59] ℹ️  AI extracted raw sex value: 'M'
[14:59:59] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:59:59] ℹ️  AI extracted payer source: ''
[14:59:59] ℹ️  AI extracted diagnoses:
[14:59:59] ℹ️    - Diagnosis 1: 'J44.1'
[14:59:59] ℹ️    - Diagnosis 2: 'J18.9'
[14:59:59] ℹ️    - Diagnosis 3: 'J44.0'
[14:59:59] ℹ️    - Diagnosis 4: 'J96.11'
[14:59:59] ℹ️    - Diagnosis 5: 'I13.0'
[14:59:59] ℹ️    - Diagnosis 6: 'I50.30'
[14:59:59] ℹ️  Final extracted MRN: '2009831'
[14:59:59] ℹ️  Final extracted Sex: 'MALE'
[14:59:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:59:59] ℹ️  Final extracted Payer Source: ''
[14:59:59] ✅ Patient data extraction completed successfully
[14:59:59] ✅    ✅ Patient data extracted successfully
[14:59:59] 📊 Patient Response
     └─ patientFName: Wilfred
     └─ patientLName: Demarais
     └─ dob: 04/15/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2009831
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': 'J96.11', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[14:59:59] ✅    ✅ Patient identified: Wilfred Demarais
[14:59:59] ✅    ✅ Patient name validation passed
[14:59:59] 🔄 
🔄 Step 3: Processing patient dates...
[14:59:59] [DOC: 9277076] ℹ️  DOB normalized: 04/15/1946
[14:59:59] [DOC: 9277076] ℹ️  Episode startOfCare normalized: 04/18/2025
[14:59:59] [DOC: 9277076] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[14:59:59] [DOC: 9277076] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[14:59:59] [DOC: 9277076] ✅ Patient date processing completed successfully
[14:59:59] ✅    ✅ Date processing completed
[14:59:59] 📊 Processed Patient Data
     └─ patientFName: Wilfred
     └─ patientLName: Demarais
     └─ dob: 04/15/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2009831
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': 'J96.11', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[14:59:59] 🔄 
🔄 Step 4: Extracting order data...
[15:00:02] ℹ️  Order extraction - MRN: '2009831'
[15:00:02] ℹ️  Order extraction - Sex: 'MALE'
[15:00:02] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[15:00:02] ℹ️  Order extraction - Payer Source: ''
[15:00:02] ✅ Order data extraction completed successfully
[15:00:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:02] ℹ️  Using MRN from patient data: '2009831' over '2009831'
[15:00:02] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Physical Therapy, Skilled Nursing' = 'Physical Therapy, Skilled Nursing'
[15:00:02] ✅ Patient name cross-validation successful
[15:00:02] ✅    ✅ Data merged successfully
[15:00:03] ✅    ✅ Order data extracted and validated
[15:00:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:08] [DOC: 9277076] ✅ Patient exists in API: Wilfred Demarais, ID: 938bd7d7-5b3f-4f5e-acd3-1aba546f8108
[15:00:08] ✅    ✅ Existing patient found with ID: 938bd7d7-5b3f-4f5e-acd3-1aba546f8108
[15:00:08] 🔄 
🔄 Step 6: Pushing order to API...
[15:00:08] [DOC: 9277076] ℹ️  Pushing order via API for patient ID: 938bd7d7-5b3f-4f5e-acd3-1aba546f8108
[15:00:09] [DOC: 9277076] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19649"}
[15:00:09] ❌    ❌ Failed to push order
[15:00:09] 🔄 
🔄 Step 7: Writing to CSV...
[15:00:09] [DOC: 9277076] ℹ️  Calculated age: 79 from DOB: 04/15/1946
[15:00:09] [DOC: 9277076] ℹ️  Service Line extracted: 'Physical Therapy, Skilled Nursing'
[15:00:09] [DOC: 9277076] ℹ️  Payer Source extracted: ''
[15:00:09] [DOC: 9277076] ℹ️  Diagnosis codes being written:
[15:00:09] [DOC: 9277076] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:00:09] [DOC: 9277076] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[15:00:09] [DOC: 9277076] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.0'
[15:00:09] [DOC: 9277076] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.11'
[15:00:09] [DOC: 9277076] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I13.0'
[15:00:09] [DOC: 9277076] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.30'
[15:00:09] [DOC: 9277076] ✅ Patient data written to CSV: Wilfred Demarais | Sex: MALE | Age: 79 | Service: Physical Therapy, Skilled Nursing | Payer:  | MRN: 2009831
[15:00:09] ✅    ✅ Document 9277076 processed and saved successfully
[15:00:09] 🔄 
🔄 Step 8: Saving API details...
[15:00:09] [DOC: 9277076] ℹ️  API push details saved for document 9277076
[15:00:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9277066                         ║
================================================================================
[15:00:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:00:09] ℹ️  Date: 05/05/2025
[15:00:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:11] [DOC: 9277066] ✅ Text extracted using pdfplumber (910 chars)
[15:00:11] ✅    ✅ Text extracted using pdfplumber (910 chars)
[15:00:11] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:14] ℹ️  AI extracted raw sex value: 'M'
[15:00:14] ℹ️  AI extracted service line: ''
[15:00:14] ℹ️  AI extracted payer source: ''
[15:00:14] ℹ️  AI extracted diagnoses:
[15:00:14] ℹ️    - Diagnosis 1: 'None'
[15:00:14] ℹ️    - Diagnosis 2: 'None'
[15:00:14] ℹ️    - Diagnosis 3: 'None'
[15:00:14] ℹ️    - Diagnosis 4: 'None'
[15:00:14] ℹ️    - Diagnosis 5: 'None'
[15:00:14] ℹ️    - Diagnosis 6: 'None'
[15:00:14] ℹ️  Final extracted MRN: '2312121'
[15:00:14] ℹ️  Final extracted Sex: 'MALE'
[15:00:14] ℹ️  Final extracted Service Line: ''
[15:00:14] ℹ️  Final extracted Payer Source: ''
[15:00:14] ✅ Patient data extraction completed successfully
[15:00:14] ✅    ✅ Patient data extracted successfully
[15:00:14] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:00:14] ✅    ✅ Patient identified: Antonio Carvalho
[15:00:14] ✅    ✅ Patient name validation passed
[15:00:14] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:14] [DOC: 9277066] ℹ️  DOB normalized: 07/01/1933
[15:00:14] [DOC: 9277066] ✅ Patient date processing completed successfully
[15:00:14] ✅    ✅ Date processing completed
[15:00:14] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:00:14] 🔄 
🔄 Step 4: Extracting order data...
[15:00:16] ℹ️  Order extraction - MRN: '2312121'
[15:00:16] ℹ️  Order extraction - Sex: 'MALE'
[15:00:16] ℹ️  Order extraction - Service Line: ''
[15:00:16] ℹ️  Order extraction - Payer Source: ''
[15:00:16] ✅ Order data extraction completed successfully
[15:00:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:16] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[15:00:16] ✅ Patient name cross-validation successful
[15:00:16] ✅    ✅ Data merged successfully
[15:00:17] ✅    ✅ Order data extracted and validated
[15:00:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:21] [DOC: 9277066] ℹ️  Patient not found in cache or API: Antonio Carvalho
[15:00:21] [DOC: 9277066] ℹ️  Patient not found, creating new patient via API...
[15:00:21] [DOC: 9277066] ℹ️  Creating patient via API: Antonio Carvalho
[15:00:22] [DOC: 9277066] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:00:22] ❌    ❌ Failed to create patient
[15:00:22] [DOC: 9277066] ℹ️  API push details saved for document 9277066
================================================================================
║                        Processing Document ID: 9277060                         ║
================================================================================
[15:00:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:00:22] ℹ️  Date: 05/05/2025
[15:00:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:24] [DOC: 9277060] ✅ Text extracted using pdfplumber (9373 chars)
[15:00:24] ✅    ✅ Text extracted using pdfplumber (9373 chars)
[15:00:24] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:28] ℹ️  AI extracted raw sex value: 'F'
[15:00:28] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:00:28] ℹ️  AI extracted payer source: ''
[15:00:28] ℹ️  AI extracted diagnoses:
[15:00:28] ℹ️    - Diagnosis 1: 'O14.14'
[15:00:28] ℹ️    - Diagnosis 2: 'O10.02'
[15:00:28] ℹ️    - Diagnosis 3: 'F53.0'
[15:00:28] ℹ️    - Diagnosis 4: 'F41.9'
[15:00:28] ℹ️    - Diagnosis 5: 'E89.0'
[15:00:28] ℹ️    - Diagnosis 6: 'H02.401'
[15:00:28] ℹ️  Final extracted MRN: '2219947'
[15:00:28] ℹ️  Final extracted Sex: 'FEMALE'
[15:00:28] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:00:28] ℹ️  Final extracted Payer Source: ''
[15:00:28] ✅ Patient data extraction completed successfully
[15:00:28] ✅    ✅ Patient data extracted successfully
[15:00:28] 📊 Patient Response
     └─ patientFName: Ashley
     └─ patientLName: Barrett
     └─ dob: 12/30/1987
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2219947
     └─ billingProvider: Mary R Dias-Regus, NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'O14.14', 'secondDiagnosis': 'O10.02', 'thirdDiagnosis': 'F53.0', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'E89.0', 'sixthDiagnosis': 'H02.401'}]
[15:00:28] ✅    ✅ Patient identified: Ashley Barrett
[15:00:28] ✅    ✅ Patient name validation passed
[15:00:28] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:28] [DOC: 9277060] ℹ️  DOB normalized: 12/30/1987
[15:00:28] [DOC: 9277060] ℹ️  Episode startOfCare normalized: 04/28/2025
[15:00:28] [DOC: 9277060] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[15:00:28] [DOC: 9277060] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[15:00:28] [DOC: 9277060] ✅ Patient date processing completed successfully
[15:00:28] ✅    ✅ Date processing completed
[15:00:28] 📊 Processed Patient Data
     └─ patientFName: Ashley
     └─ patientLName: Barrett
     └─ dob: 12/30/1987
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2219947
     └─ billingProvider: Mary R Dias-Regus, NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'O14.14', 'secondDiagnosis': 'O10.02', 'thirdDiagnosis': 'F53.0', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'E89.0', 'sixthDiagnosis': 'H02.401'}]
[15:00:28] 🔄 
🔄 Step 4: Extracting order data...
[15:00:30] ℹ️  Order extraction - MRN: '2219947'
[15:00:30] ℹ️  Order extraction - Sex: 'FEMALE'
[15:00:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:00:30] ℹ️  Order extraction - Payer Source: ''
[15:00:30] ✅ Order data extraction completed successfully
[15:00:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:30] ℹ️  Using MRN from patient data: '2219947' over '2219947'
[15:00:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:00:30] ✅ Patient name cross-validation successful
[15:00:30] ✅    ✅ Data merged successfully
[15:00:32] ✅    ✅ Order data extracted and validated
[15:00:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:37] [DOC: 9277060] ✅ Patient exists in API: Ashley Barrett, ID: f818bdd7-5cbe-4dc0-8dfd-81303afc9e80
[15:00:37] ✅    ✅ Existing patient found with ID: f818bdd7-5cbe-4dc0-8dfd-81303afc9e80
[15:00:37] 🔄 
🔄 Step 6: Pushing order to API...
[15:00:37] [DOC: 9277060] ℹ️  Pushing order via API for patient ID: f818bdd7-5cbe-4dc0-8dfd-81303afc9e80
[15:00:38] [DOC: 9277060] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13019"}
[15:00:38] ❌    ❌ Failed to push order
[15:00:38] 🔄 
🔄 Step 7: Writing to CSV...
[15:00:38] [DOC: 9277060] ℹ️  Calculated age: 37 from DOB: 12/30/1987
[15:00:38] [DOC: 9277060] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:00:38] [DOC: 9277060] ℹ️  Payer Source extracted: ''
[15:00:38] [DOC: 9277060] ℹ️  Diagnosis codes being written:
[15:00:38] [DOC: 9277060] ℹ️    - Latest_Episode_Firstdiagnosis: 'O14.14'
[15:00:38] [DOC: 9277060] ℹ️    - Latest_Episode_Seconddiagnosis: 'O10.02'
[15:00:38] [DOC: 9277060] ℹ️    - Latest_Episode_Thirddiagnosis: 'F53.0'
[15:00:38] [DOC: 9277060] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.9'
[15:00:38] [DOC: 9277060] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E89.0'
[15:00:38] [DOC: 9277060] ℹ️    - Latest_Episode_Sixthdiagnosis: 'H02.401'
[15:00:38] [DOC: 9277060] ✅ Patient data written to CSV: Ashley Barrett | Sex: FEMALE | Age: 37 | Service: Skilled Nursing | Payer:  | MRN: 2219947
[15:00:38] ✅    ✅ Document 9277060 processed and saved successfully
[15:00:38] 🔄 
🔄 Step 8: Saving API details...
[15:00:38] [DOC: 9277060] ℹ️  API push details saved for document 9277060
[15:00:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9276054                         ║
================================================================================
[15:00:38] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:00:38] ℹ️  Date: 05/05/2025
[15:00:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:41] [DOC: 9276054] ✅ Text extracted using pdfplumber (3502 chars)
[15:00:41] ✅    ✅ Text extracted using pdfplumber (3490 chars)
[15:00:41] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:44] ℹ️  AI extracted raw sex value: ''
[15:00:44] ℹ️  AI extracted service line: 'Hospice'
[15:00:44] ℹ️  AI extracted payer source: 'Medicare'
[15:00:44] ℹ️  AI extracted diagnoses:
[15:00:44] ℹ️    - Diagnosis 1: 'None'
[15:00:44] ℹ️    - Diagnosis 2: 'None'
[15:00:44] ℹ️    - Diagnosis 3: 'None'
[15:00:44] ℹ️    - Diagnosis 4: 'None'
[15:00:44] ℹ️    - Diagnosis 5: 'None'
[15:00:44] ℹ️    - Diagnosis 6: 'None'
[15:00:44] ℹ️  Final extracted MRN: 'B3700407012202'
[15:00:44] ℹ️  Final extracted Sex: ''
[15:00:44] ℹ️  Final extracted Service Line: 'Hospice'
[15:00:44] ℹ️  Final extracted Payer Source: 'Medicare'
[15:00:44] ✅ Patient data extraction completed successfully
[15:00:44] ✅    ✅ Patient data extracted successfully
[15:00:44] 📊 Patient Response
     └─ patientFName: BARBARA
     └─ patientLName: MARSHALL
     └─ dob: 01/25/1933
     └─ patientSex: 
     └─ medicalRecordNo: B3700407012202
     └─ billingProvider: GULAREK, JORDAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 221 FITZGERALD DR N.
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02745-3426
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:00:44] ✅    ✅ Patient identified: BARBARA MARSHALL
[15:00:44] ✅    ✅ Patient name validation passed
[15:00:44] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:44] [DOC: 9276054] ℹ️  DOB normalized: 01/25/1933
[15:00:44] [DOC: 9276054] ✅ Patient date processing completed successfully
[15:00:44] ✅    ✅ Date processing completed
[15:00:44] 📊 Processed Patient Data
     └─ patientFName: BARBARA
     └─ patientLName: MARSHALL
     └─ dob: 01/25/1933
     └─ patientSex: 
     └─ medicalRecordNo: B3700407012202
     └─ billingProvider: GULAREK, JORDAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 221 FITZGERALD DR N.
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02745-3426
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:00:44] 🔄 
🔄 Step 4: Extracting order data...
[15:00:46] ℹ️  Order extraction - MRN: 'B3700407012202'
[15:00:46] ℹ️  Order extraction - Sex: ''
[15:00:46] ℹ️  Order extraction - Service Line: 'Hospice'
[15:00:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:00:46] ✅ Order data extraction completed successfully
[15:00:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:46] ℹ️  Using MRN from patient data: 'B3700407012202' over 'B3700407012202'
[15:00:46] ℹ️  Inferred sex as FEMALE from name: BARBARA
[15:00:46] ℹ️  Service line consistent in both sources: 'Hospice'
[15:00:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:00:46] ✅ Patient name cross-validation successful
[15:00:46] ✅    ✅ Data merged successfully
[15:00:47] ✅    ✅ Order data extracted and validated
[15:00:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:00:47] [DOC: 9276054] ✅ Patient found in local cache: BARBARA MARSHALL, ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[15:00:47] ✅    ✅ Existing patient found with ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[15:00:47] 🔄 
🔄 Step 6: Pushing order to API...
[15:00:47] [DOC: 9276054] ℹ️  Pushing order via API for patient ID: 25997e21-08de-4079-ba1a-17e868ab64b2
[15:00:48] [DOC: 9276054] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14029"}
[15:00:48] ❌    ❌ Failed to push order
[15:00:48] 🔄 
🔄 Step 7: Writing to CSV...
[15:00:48] [DOC: 9276054] ℹ️  Calculated age: 92 from DOB: 01/25/1933
[15:00:48] [DOC: 9276054] ℹ️  Service Line extracted: 'Hospice'
[15:00:48] [DOC: 9276054] ℹ️  Payer Source extracted: 'Medicare'
[15:00:48] [DOC: 9276054] ℹ️  Diagnosis codes being written:
[15:00:48] [DOC: 9276054] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:00:48] [DOC: 9276054] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:00:48] [DOC: 9276054] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:00:48] [DOC: 9276054] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:00:48] [DOC: 9276054] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:00:48] [DOC: 9276054] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:00:48] [DOC: 9276054] ✅ Patient data written to CSV: BARBARA MARSHALL | Sex: FEMALE | Age: 92 | Service: Hospice | Payer: Medicare | MRN: B3700407012202
[15:00:48] ✅    ✅ Document 9276054 processed and saved successfully
[15:00:48] 🔄 
🔄 Step 8: Saving API details...
[15:00:48] [DOC: 9276054] ℹ️  API push details saved for document 9276054
[15:00:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9276045                         ║
================================================================================
[15:00:48] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:00:48] ℹ️  Date: 05/05/2025
[15:00:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:50] [DOC: 9276045] ❌ Critical failure in get_pdf_text: Invalid response format
[15:00:50] ❌ Failed to extract text for Doc ID 9276045
[15:00:50] [DOC: 9276045] ℹ️  API push details saved for document 9276045
================================================================================
║                        Processing Document ID: 9276035                         ║
================================================================================
[15:00:50] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:00:50] ℹ️  Date: 05/05/2025
[15:00:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:51] [DOC: 9276035] ❌ Critical failure in get_pdf_text: Invalid response format
[15:00:51] ❌ Failed to extract text for Doc ID 9276035
[15:00:51] [DOC: 9276035] ℹ️  API push details saved for document 9276035
================================================================================
║                        Processing Document ID: 9276008                         ║
================================================================================
[15:00:51] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:00:51] ℹ️  Date: 05/05/2025
[15:00:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:00:53] [DOC: 9276008] ✅ Text extracted using pdfplumber (2040 chars)
[15:00:53] ✅    ✅ Text extracted using pdfplumber (2028 chars)
[15:00:53] 🔄 
🔄 Step 2: Extracting patient data...
[15:00:56] ℹ️  AI extracted raw sex value: ''
[15:00:56] ℹ️  AI extracted service line: 'Hospice'
[15:00:56] ℹ️  AI extracted payer source: 'Medicare'
[15:00:56] ℹ️  AI extracted diagnoses:
[15:00:56] ℹ️    - Diagnosis 1: ''
[15:00:56] ℹ️    - Diagnosis 2: ''
[15:00:56] ℹ️    - Diagnosis 3: ''
[15:00:56] ℹ️    - Diagnosis 4: ''
[15:00:56] ℹ️    - Diagnosis 5: ''
[15:00:56] ℹ️    - Diagnosis 6: ''
[15:00:56] ℹ️  Final extracted MRN: 'B3700296223202'
[15:00:56] ℹ️  Final extracted Sex: ''
[15:00:56] ℹ️  Final extracted Service Line: 'Hospice'
[15:00:56] ℹ️  Final extracted Payer Source: 'Medicare'
[15:00:56] ✅ Patient data extraction completed successfully
[15:00:56] ✅    ✅ Patient data extracted successfully
[15:00:56] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:00:56] ✅    ✅ Patient identified: MARIA JARDIM
[15:00:56] ✅    ✅ Patient name validation passed
[15:00:56] 🔄 
🔄 Step 3: Processing patient dates...
[15:00:56] [DOC: 9276008] ℹ️  DOB normalized: 05/20/1931
[15:00:56] [DOC: 9276008] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:00:56] [DOC: 9276008] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:00:56] [DOC: 9276008] ✅ Patient date processing completed successfully
[15:00:56] ✅    ✅ Date processing completed
[15:00:56] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:00:56] 🔄 
🔄 Step 4: Extracting order data...
[15:00:58] ℹ️  Order extraction - MRN: 'B3700296223202'
[15:00:58] ℹ️  Order extraction - Sex: ''
[15:00:58] ℹ️  Order extraction - Service Line: 'Hospice'
[15:00:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:00:58] ✅ Order data extraction completed successfully
[15:00:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:00:58] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[15:00:58] ℹ️  Inferred sex as FEMALE from name: MARIA
[15:00:58] ℹ️  Service line consistent in both sources: 'Hospice'
[15:00:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:00:58] ✅ Patient name cross-validation successful
[15:00:58] ✅    ✅ Data merged successfully
[15:01:00] ✅    ✅ Order data extracted and validated
[15:01:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:01:07] [DOC: 9276008] ✅ Patient exists in API: MARIA JARDIM, ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:01:07] ✅    ✅ Existing patient found with ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:01:07] 🔄 
🔄 Step 6: Pushing order to API...
[15:01:07] [DOC: 9276008] ℹ️  Pushing order via API for patient ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:01:08] [DOC: 9276008] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13858"}
[15:01:08] ❌    ❌ Failed to push order
[15:01:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:01:08] [DOC: 9276008] ℹ️  Calculated age: 94 from DOB: 05/20/1931
[15:01:08] [DOC: 9276008] ℹ️  Service Line extracted: 'Hospice'
[15:01:08] [DOC: 9276008] ℹ️  Payer Source extracted: 'Medicare'
[15:01:08] [DOC: 9276008] ℹ️  Diagnosis codes being written:
[15:01:08] [DOC: 9276008] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:01:08] [DOC: 9276008] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:01:08] [DOC: 9276008] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:01:08] [DOC: 9276008] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:01:08] [DOC: 9276008] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:01:08] [DOC: 9276008] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:01:08] [DOC: 9276008] ✅ Patient data written to CSV: MARIA JARDIM | Sex: FEMALE | Age: 94 | Service: Hospice | Payer: Medicare | MRN: B3700296223202
[15:01:08] ✅    ✅ Document 9276008 processed and saved successfully
[15:01:08] 🔄 
🔄 Step 8: Saving API details...
[15:01:08] [DOC: 9276008] ℹ️  API push details saved for document 9276008
[15:01:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275676                         ║
================================================================================
[15:01:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:01:08] ℹ️  Date: 05/05/2025
[15:01:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:01:10] [DOC: 9275676] ✅ Text extracted using pdfplumber (2245 chars)
[15:01:10] ✅    ✅ Text extracted using pdfplumber (2233 chars)
[15:01:10] 🔄 
🔄 Step 2: Extracting patient data...
[15:01:13] ℹ️  AI extracted raw sex value: ''
[15:01:13] ℹ️  AI extracted service line: 'Physical Therapy'
[15:01:13] ℹ️  AI extracted payer source: ''
[15:01:13] ℹ️  AI extracted diagnoses:
[15:01:13] ℹ️    - Diagnosis 1: 'M62.59'
[15:01:13] ℹ️    - Diagnosis 2: 'R27.0'
[15:01:13] ℹ️    - Diagnosis 3: 'M48.07'
[15:01:13] ℹ️    - Diagnosis 4: 'None'
[15:01:13] ℹ️    - Diagnosis 5: 'None'
[15:01:13] ℹ️    - Diagnosis 6: 'None'
[15:01:13] ℹ️  Final extracted MRN: 'MA221116116005'
[15:01:13] ℹ️  Final extracted Sex: ''
[15:01:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:01:13] ℹ️  Final extracted Payer Source: ''
[15:01:13] ✅ Patient data extraction completed successfully
[15:01:13] ✅    ✅ Patient data extracted successfully
[15:01:13] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'M62.59', 'secondDiagnosis': 'R27.0', 'thirdDiagnosis': 'M48.07', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:01:13] ✅    ✅ Patient identified: Kelly Medeiros
[15:01:13] ✅    ✅ Patient name validation passed
[15:01:13] 🔄 
🔄 Step 3: Processing patient dates...
[15:01:13] [DOC: 9275676] ℹ️  DOB normalized: 11/23/1960
[15:01:13] [DOC: 9275676] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[15:01:13] [DOC: 9275676] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[15:01:13] [DOC: 9275676] ✅ Patient date processing completed successfully
[15:01:13] ✅    ✅ Date processing completed
[15:01:13] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'M62.59', 'secondDiagnosis': 'R27.0', 'thirdDiagnosis': 'M48.07'}]
[15:01:13] 🔄 
🔄 Step 4: Extracting order data...
[15:01:16] ℹ️  Order extraction - MRN: 'MA221116116005'
[15:01:16] ℹ️  Order extraction - Sex: ''
[15:01:16] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:01:16] ℹ️  Order extraction - Payer Source: ''
[15:01:16] ✅ Order data extraction completed successfully
[15:01:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:01:16] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[15:01:16] ⚠️  Could not determine sex using any available method
[15:01:16] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:01:16] ✅ Patient name cross-validation successful
[15:01:16] ✅    ✅ Data merged successfully
[15:01:18] ✅    ✅ Order data extracted and validated
[15:01:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:01:23] [DOC: 9275676] ℹ️  Patient not found in cache or API: Kelly Medeiros
[15:01:23] [DOC: 9275676] ℹ️  Patient not found, creating new patient via API...
[15:01:23] [DOC: 9275676] ℹ️  Creating patient via API: Kelly Medeiros
[15:01:24] [DOC: 9275676] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:01:24] ❌    ❌ Failed to create patient
[15:01:24] [DOC: 9275676] ℹ️  API push details saved for document 9275676
================================================================================
║                        Processing Document ID: 9275543                         ║
================================================================================
[15:01:24] ℹ️  Agency: Dartmouth HH
[15:01:24] ℹ️  Date: 05/05/2025
[15:01:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:01:26] [DOC: 9275543] ✅ Text extracted using pdfplumber (16689 chars)
[15:01:26] ✅    ✅ Text extracted using pdfplumber (16689 chars)
[15:01:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:01:30] ℹ️  AI extracted raw sex value: 'M'
[15:01:30] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[15:01:30] ℹ️  AI extracted payer source: 'None'
[15:01:30] ℹ️  AI extracted diagnoses:
[15:01:30] ℹ️    - Diagnosis 1: 'M10.071'
[15:01:30] ℹ️    - Diagnosis 2: 'S91.331D'
[15:01:30] ℹ️    - Diagnosis 3: 'D47.1'
[15:01:30] ℹ️    - Diagnosis 4: 'D61.9'
[15:01:30] ℹ️    - Diagnosis 5: 'R62.7'
[15:01:30] ℹ️    - Diagnosis 6: 'N17.9'
[15:01:30] ℹ️  Final extracted MRN: '6408015'
[15:01:30] ℹ️  Final extracted Sex: 'MALE'
[15:01:30] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[15:01:30] ℹ️  Final extracted Payer Source: ''
[15:01:30] ✅ Patient data extraction completed successfully
[15:01:30] ✅    ✅ Patient data extracted successfully
[15:01:30] 📊 Patient Response
     └─ patientFName: Walter
     └─ patientLName: Rezendes
     └─ dob: 09/30/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 6408015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/26/2025', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'M10.071', 'secondDiagnosis': 'S91.331D', 'thirdDiagnosis': 'D47.1', 'fourthDiagnosis': 'D61.9', 'fifthDiagnosis': 'R62.7', 'sixthDiagnosis': 'N17.9'}]
[15:01:30] ✅    ✅ Patient identified: Walter Rezendes
[15:01:30] ✅    ✅ Patient name validation passed
[15:01:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:01:30] [DOC: 9275543] ℹ️  DOB normalized: 09/30/1941
[15:01:30] [DOC: 9275543] ℹ️  Episode startOfCare normalized: 04/26/2025
[15:01:30] [DOC: 9275543] ℹ️  Episode startOfEpisode normalized: 04/27/2025
[15:01:30] [DOC: 9275543] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[15:01:30] [DOC: 9275543] ✅ Patient date processing completed successfully
[15:01:30] ✅    ✅ Date processing completed
[15:01:30] 📊 Processed Patient Data
     └─ patientFName: Walter
     └─ patientLName: Rezendes
     └─ dob: 09/30/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 6408015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/26/2025', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'M10.071', 'secondDiagnosis': 'S91.331D', 'thirdDiagnosis': 'D47.1', 'fourthDiagnosis': 'D61.9', 'fifthDiagnosis': 'R62.7', 'sixthDiagnosis': 'N17.9'}]
[15:01:30] 🔄 
🔄 Step 4: Extracting order data...
[15:01:32] ℹ️  Order extraction - MRN: '6408015'
[15:01:32] ℹ️  Order extraction - Sex: 'MALE'
[15:01:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[15:01:32] ℹ️  Order extraction - Payer Source: ''
[15:01:32] ✅ Order data extraction completed successfully
[15:01:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:01:32] ℹ️  Using MRN from patient data: '6408015' over '6408015'
[15:01:32] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[15:01:32] ✅ Patient name cross-validation successful
[15:01:32] ✅    ✅ Data merged successfully
[15:01:33] ✅    ✅ Order data extracted and validated
[15:01:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:01:39] [DOC: 9275543] ✅ Patient exists in API: Walter Rezendes, ID: 5655c390-3766-4dd4-82b9-5a15fdd5a853
[15:01:39] ✅    ✅ Existing patient found with ID: 5655c390-3766-4dd4-82b9-5a15fdd5a853
[15:01:39] 🔄 
🔄 Step 6: Pushing order to API...
[15:01:39] [DOC: 9275543] ℹ️  Pushing order via API for patient ID: 5655c390-3766-4dd4-82b9-5a15fdd5a853
[15:01:40] [DOC: 9275543] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:01:40] ❌    ❌ Failed to push order
[15:01:40] 🔄 
🔄 Step 7: Writing to CSV...
[15:01:40] [DOC: 9275543] ℹ️  Calculated age: 83 from DOB: 09/30/1941
[15:01:40] [DOC: 9275543] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[15:01:40] [DOC: 9275543] ℹ️  Payer Source extracted: ''
[15:01:40] [DOC: 9275543] ℹ️  Diagnosis codes being written:
[15:01:40] [DOC: 9275543] ℹ️    - Latest_Episode_Firstdiagnosis: 'M10.071'
[15:01:40] [DOC: 9275543] ℹ️    - Latest_Episode_Seconddiagnosis: 'S91.331D'
[15:01:40] [DOC: 9275543] ℹ️    - Latest_Episode_Thirddiagnosis: 'D47.1'
[15:01:40] [DOC: 9275543] ℹ️    - Latest_Episode_Fourthdiagnosis: 'D61.9'
[15:01:40] [DOC: 9275543] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R62.7'
[15:01:40] [DOC: 9275543] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N17.9'
[15:01:40] [DOC: 9275543] ✅ Patient data written to CSV: Walter Rezendes | Sex: MALE | Age: 83 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 6408015
[15:01:40] ✅    ✅ Document 9275543 processed and saved successfully
[15:01:40] 🔄 
🔄 Step 8: Saving API details...
[15:01:40] [DOC: 9275543] ℹ️  API push details saved for document 9275543
[15:01:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275532                         ║
================================================================================
[15:01:40] ℹ️  Agency: Dartmouth HH
[15:01:40] ℹ️  Date: 05/05/2025
[15:01:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:01:43] [DOC: 9275532] ✅ Text extracted using pdfplumber (15805 chars)
[15:01:43] ✅    ✅ Text extracted using pdfplumber (15805 chars)
[15:01:43] 🔄 
🔄 Step 2: Extracting patient data...
[15:01:46] ℹ️  AI extracted raw sex value: 'M'
[15:01:46] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[15:01:46] ℹ️  AI extracted payer source: 'None'
[15:01:46] ℹ️  AI extracted diagnoses:
[15:01:46] ℹ️    - Diagnosis 1: 'Z47.1'
[15:01:46] ℹ️    - Diagnosis 2: 'E11.9'
[15:01:46] ℹ️    - Diagnosis 3: 'K57.30'
[15:01:46] ℹ️    - Diagnosis 4: 'E03.9'
[15:01:46] ℹ️    - Diagnosis 5: 'E66.3'
[15:01:46] ℹ️    - Diagnosis 6: 'Z68.28'
[15:01:46] ℹ️  Final extracted MRN: '6329015'
[15:01:46] ℹ️  Final extracted Sex: 'MALE'
[15:01:46] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[15:01:46] ℹ️  Final extracted Payer Source: ''
[15:01:46] ✅ Patient data extraction completed successfully
[15:01:46] ✅    ✅ Patient data extracted successfully
[15:01:46] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Neves
     └─ dob: 05/22/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: 6329015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100213516493
     └─ physicianNPI: 
     └─ nameOfAgency: Isabel Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'K57.30', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E66.3', 'sixthDiagnosis': 'Z68.28'}]
[15:01:46] ✅    ✅ Patient identified: Antonio Neves
[15:01:46] ✅    ✅ Patient name validation passed
[15:01:46] 🔄 
🔄 Step 3: Processing patient dates...
[15:01:46] [DOC: 9275532] ℹ️  DOB normalized: 05/22/1959
[15:01:46] [DOC: 9275532] ℹ️  Episode startOfCare normalized: 04/17/2025
[15:01:46] [DOC: 9275532] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[15:01:46] [DOC: 9275532] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[15:01:46] [DOC: 9275532] ✅ Patient date processing completed successfully
[15:01:46] ✅    ✅ Date processing completed
[15:01:46] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Neves
     └─ dob: 05/22/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: 6329015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100213516493
     └─ physicianNPI: 
     └─ nameOfAgency: Isabel Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'K57.30', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E66.3', 'sixthDiagnosis': 'Z68.28'}]
[15:01:46] 🔄 
🔄 Step 4: Extracting order data...
[15:01:48] ℹ️  Order extraction - MRN: '6329015'
[15:01:48] ℹ️  Order extraction - Sex: 'MALE'
[15:01:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[15:01:48] ℹ️  Order extraction - Payer Source: ''
[15:01:48] ✅ Order data extraction completed successfully
[15:01:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:01:48] ℹ️  Using MRN from patient data: '6329015' over '6329015'
[15:01:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[15:01:48] ✅ Patient name cross-validation successful
[15:01:48] ✅    ✅ Data merged successfully
[15:01:50] ✅    ✅ Order data extracted and validated
[15:01:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:01:56] [DOC: 9275532] ✅ Patient exists in API: Antonio Neves, ID: bcb157fa-47df-4c40-9d7b-9ff77c6713bd
[15:01:56] ✅    ✅ Existing patient found with ID: bcb157fa-47df-4c40-9d7b-9ff77c6713bd
[15:01:56] 🔄 
🔄 Step 6: Pushing order to API...
[15:01:56] [DOC: 9275532] ℹ️  Pushing order via API for patient ID: bcb157fa-47df-4c40-9d7b-9ff77c6713bd
[15:01:57] [DOC: 9275532] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:01:57] ❌    ❌ Failed to push order
[15:01:57] 🔄 
🔄 Step 7: Writing to CSV...
[15:01:57] [DOC: 9275532] ℹ️  Calculated age: 66 from DOB: 05/22/1959
[15:01:57] [DOC: 9275532] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy'
[15:01:57] [DOC: 9275532] ℹ️  Payer Source extracted: ''
[15:01:57] [DOC: 9275532] ℹ️  Diagnosis codes being written:
[15:01:57] [DOC: 9275532] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[15:01:57] [DOC: 9275532] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:01:57] [DOC: 9275532] ℹ️    - Latest_Episode_Thirddiagnosis: 'K57.30'
[15:01:57] [DOC: 9275532] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.9'
[15:01:57] [DOC: 9275532] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.3'
[15:01:57] [DOC: 9275532] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.28'
[15:01:57] [DOC: 9275532] ✅ Patient data written to CSV: Antonio Neves | Sex: MALE | Age: 66 | Service: Skilled Nursing, Occupational Therapy | Payer:  | MRN: 6329015
[15:01:57] ✅    ✅ Document 9275532 processed and saved successfully
[15:01:57] 🔄 
🔄 Step 8: Saving API details...
[15:01:57] [DOC: 9275532] ℹ️  API push details saved for document 9275532
[15:01:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275526                         ║
================================================================================
[15:01:57] ℹ️  Agency: Dartmouth HH
[15:01:57] ℹ️  Date: 05/05/2025
[15:01:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:00] [DOC: 9275526] ✅ Text extracted using pdfplumber (14002 chars)
[15:02:00] ✅    ✅ Text extracted using pdfplumber (14002 chars)
[15:02:00] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:03] ℹ️  AI extracted raw sex value: 'M'
[15:02:03] ℹ️  AI extracted service line: 'PT'
[15:02:03] ℹ️  AI extracted payer source: ''
[15:02:03] ℹ️  AI extracted diagnoses:
[15:02:03] ℹ️    - Diagnosis 1: 'M47.817'
[15:02:03] ℹ️    - Diagnosis 2: 'M17.0'
[15:02:03] ℹ️    - Diagnosis 3: 'R29.6'
[15:02:03] ℹ️    - Diagnosis 4: 'R26.81'
[15:02:03] ℹ️    - Diagnosis 5: 'M48.062'
[15:02:03] ℹ️    - Diagnosis 6: 'M54.50'
[15:02:03] ℹ️  Final extracted MRN: '1996015'
[15:02:03] ℹ️  Final extracted Sex: 'MALE'
[15:02:03] ℹ️  Final extracted Service Line: 'PT'
[15:02:03] ℹ️  Final extracted Payer Source: ''
[15:02:03] ✅ Patient data extraction completed successfully
[15:02:03] ✅    ✅ Patient data extracted successfully
[15:02:03] 📊 Patient Response
     └─ patientFName: Jeffery
     └─ patientLName: Freitas
     └─ dob: 08/25/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 1996015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'M47.817', 'secondDiagnosis': 'M17.0', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'M48.062', 'sixthDiagnosis': 'M54.50'}]
[15:02:03] ✅    ✅ Patient identified: Jeffery Freitas
[15:02:03] ✅    ✅ Patient name validation passed
[15:02:03] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:03] [DOC: 9275526] ℹ️  DOB normalized: 08/25/1954
[15:02:03] [DOC: 9275526] ℹ️  Episode startOfCare normalized: 05/01/2025
[15:02:03] [DOC: 9275526] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[15:02:03] [DOC: 9275526] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[15:02:03] [DOC: 9275526] ✅ Patient date processing completed successfully
[15:02:03] ✅    ✅ Date processing completed
[15:02:03] 📊 Processed Patient Data
     └─ patientFName: Jeffery
     └─ patientLName: Freitas
     └─ dob: 08/25/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 1996015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'M47.817', 'secondDiagnosis': 'M17.0', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'M48.062', 'sixthDiagnosis': 'M54.50'}]
[15:02:03] 🔄 
🔄 Step 4: Extracting order data...
[15:02:05] ℹ️  Order extraction - MRN: '1996015'
[15:02:05] ℹ️  Order extraction - Sex: 'MALE'
[15:02:05] ℹ️  Order extraction - Service Line: 'PT'
[15:02:05] ℹ️  Order extraction - Payer Source: ''
[15:02:05] ✅ Order data extraction completed successfully
[15:02:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:05] ℹ️  Using MRN from patient data: '1996015' over '1996015'
[15:02:05] ℹ️  Service line consistent in both sources: 'PT'
[15:02:05] ✅ Patient name cross-validation successful
[15:02:05] ✅    ✅ Data merged successfully
[15:02:07] ✅    ✅ Order data extracted and validated
[15:02:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:12] [DOC: 9275526] ✅ Patient exists in API: Jeffery Freitas, ID: 44537203-2ed1-4a85-ae59-66618b307705
[15:02:12] ✅    ✅ Existing patient found with ID: 44537203-2ed1-4a85-ae59-66618b307705
[15:02:12] 🔄 
🔄 Step 6: Pushing order to API...
[15:02:12] [DOC: 9275526] ℹ️  Pushing order via API for patient ID: 44537203-2ed1-4a85-ae59-66618b307705
[15:02:13] [DOC: 9275526] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:02:13] ❌    ❌ Failed to push order
[15:02:13] 🔄 
🔄 Step 7: Writing to CSV...
[15:02:13] [DOC: 9275526] ℹ️  Calculated age: 70 from DOB: 08/25/1954
[15:02:13] [DOC: 9275526] ℹ️  Service Line extracted: 'PT'
[15:02:13] [DOC: 9275526] ℹ️  Payer Source extracted: ''
[15:02:13] [DOC: 9275526] ℹ️  Diagnosis codes being written:
[15:02:13] [DOC: 9275526] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.817'
[15:02:13] [DOC: 9275526] ℹ️    - Latest_Episode_Seconddiagnosis: 'M17.0'
[15:02:13] [DOC: 9275526] ℹ️    - Latest_Episode_Thirddiagnosis: 'R29.6'
[15:02:13] [DOC: 9275526] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R26.81'
[15:02:13] [DOC: 9275526] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M48.062'
[15:02:13] [DOC: 9275526] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.50'
[15:02:13] [DOC: 9275526] ✅ Patient data written to CSV: Jeffery Freitas | Sex: MALE | Age: 70 | Service: PT | Payer:  | MRN: 1996015
[15:02:13] ✅    ✅ Document 9275526 processed and saved successfully
[15:02:13] 🔄 
🔄 Step 8: Saving API details...
[15:02:13] [DOC: 9275526] ℹ️  API push details saved for document 9275526
[15:02:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275519                         ║
================================================================================
[15:02:13] ℹ️  Agency: Dartmouth HH
[15:02:13] ℹ️  Date: 05/05/2025
[15:02:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:15] [DOC: 9275519] ✅ Text extracted using pdfplumber (1171 chars)
[15:02:15] ✅    ✅ Text extracted using pdfplumber (1171 chars)
[15:02:15] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:17] ℹ️  AI extracted raw sex value: 'F'
[15:02:17] ℹ️  AI extracted service line: 'RN, LPN'
[15:02:17] ℹ️  AI extracted payer source: 'Senior Whole Health'
[15:02:17] ℹ️  AI extracted diagnoses:
[15:02:17] ℹ️    - Diagnosis 1: 'None'
[15:02:17] ℹ️    - Diagnosis 2: 'None'
[15:02:17] ℹ️    - Diagnosis 3: 'None'
[15:02:17] ℹ️    - Diagnosis 4: 'None'
[15:02:17] ℹ️    - Diagnosis 5: 'None'
[15:02:17] ℹ️    - Diagnosis 6: 'None'
[15:02:17] ℹ️  Final extracted MRN: '3611001'
[15:02:17] ℹ️  Final extracted Sex: 'FEMALE'
[15:02:17] ℹ️  Final extracted Service Line: 'RN, LPN'
[15:02:17] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[15:02:17] ✅ Patient data extraction completed successfully
[15:02:17] ✅    ✅ Patient data extracted successfully
[15:02:17] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Lavadinho
     └─ dob: 12/16/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3611001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 70 Emerald Drive
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:02:17] ✅    ✅ Patient identified: Marie Lavadinho
[15:02:17] ✅    ✅ Patient name validation passed
[15:02:17] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:17] [DOC: 9275519] ℹ️  DOB normalized: 12/16/1936
[15:02:17] [DOC: 9275519] ℹ️  Episode startOfCare normalized: 03/14/2025
[15:02:17] [DOC: 9275519] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:02:17] [DOC: 9275519] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:02:17] [DOC: 9275519] ✅ Patient date processing completed successfully
[15:02:17] ✅    ✅ Date processing completed
[15:02:17] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Lavadinho
     └─ dob: 12/16/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3611001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 70 Emerald Drive
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025'}]
[15:02:17] 🔄 
🔄 Step 4: Extracting order data...
[15:02:20] ℹ️  Order extraction - MRN: ''
[15:02:20] ℹ️  Order extraction - Sex: 'FEMALE'
[15:02:20] ℹ️  Order extraction - Service Line: 'RN, LPN'
[15:02:20] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[15:02:20] ✅ Order data extraction completed successfully
[15:02:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:20] ℹ️  Using MRN from patient data: '3611001'
[15:02:20] ℹ️  Service line consistent in both sources: 'RN, LPN'
[15:02:20] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[15:02:20] ✅ Patient name cross-validation successful
[15:02:20] ✅    ✅ Data merged successfully
[15:02:21] ✅    ✅ Order data extracted and validated
[15:02:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:26] [DOC: 9275519] ✅ Patient exists in API: Marie Lavadinho, ID: 1709d00e-fe2b-41a2-aabc-e8cf65d43776
[15:02:26] ✅    ✅ Existing patient found with ID: 1709d00e-fe2b-41a2-aabc-e8cf65d43776
[15:02:26] 🔄 
🔄 Step 6: Pushing order to API...
[15:02:26] [DOC: 9275519] ℹ️  Pushing order via API for patient ID: 1709d00e-fe2b-41a2-aabc-e8cf65d43776
[15:02:27] [DOC: 9275519] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13903"}
[15:02:27] ❌    ❌ Failed to push order
[15:02:27] 🔄 
🔄 Step 7: Writing to CSV...
[15:02:27] [DOC: 9275519] ℹ️  Calculated age: 88 from DOB: 12/16/1936
[15:02:27] [DOC: 9275519] ℹ️  Service Line extracted: 'RN, LPN'
[15:02:27] [DOC: 9275519] ℹ️  Payer Source extracted: 'Senior Whole Health'
[15:02:27] [DOC: 9275519] ℹ️  Diagnosis codes being written:
[15:02:27] [DOC: 9275519] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:02:27] [DOC: 9275519] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:02:27] [DOC: 9275519] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:02:27] [DOC: 9275519] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:02:27] [DOC: 9275519] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:02:27] [DOC: 9275519] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:02:27] [DOC: 9275519] ✅ Patient data written to CSV: Marie Lavadinho | Sex: FEMALE | Age: 88 | Service: RN, LPN | Payer: Senior Whole Health | MRN: 3611001
[15:02:27] ✅    ✅ Document 9275519 processed and saved successfully
[15:02:27] 🔄 
🔄 Step 8: Saving API details...
[15:02:27] [DOC: 9275519] ℹ️  API push details saved for document 9275519
[15:02:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275290                         ║
================================================================================
[15:02:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:02:27] ℹ️  Date: 05/03/2025
[15:02:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:28] [DOC: 9275290] ✅ Text extracted using pdfplumber (1393 chars)
[15:02:28] ✅    ✅ Text extracted using pdfplumber (1393 chars)
[15:02:28] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:31] ℹ️  AI extracted raw sex value: 'F'
[15:02:31] ℹ️  AI extracted service line: 'Home Health Aide'
[15:02:31] ℹ️  AI extracted payer source: ''
[15:02:31] ℹ️  AI extracted diagnoses:
[15:02:31] ℹ️    - Diagnosis 1: 'None'
[15:02:31] ℹ️    - Diagnosis 2: 'None'
[15:02:31] ℹ️    - Diagnosis 3: 'None'
[15:02:31] ℹ️    - Diagnosis 4: 'None'
[15:02:31] ℹ️    - Diagnosis 5: 'None'
[15:02:31] ℹ️    - Diagnosis 6: 'None'
[15:02:31] ℹ️  Final extracted MRN: '2704239'
[15:02:31] ℹ️  Final extracted Sex: 'FEMALE'
[15:02:31] ℹ️  Final extracted Service Line: 'Home Health Aide'
[15:02:31] ℹ️  Final extracted Payer Source: ''
[15:02:31] ✅ Patient data extraction completed successfully
[15:02:31] ✅    ✅ Patient data extracted successfully
[15:02:31] 📊 Patient Response
     └─ patientFName: Eugenia
     └─ patientLName: Martinho
     └─ dob: 04/01/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2704239
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:02:31] ✅    ✅ Patient identified: Eugenia Martinho
[15:02:31] ✅    ✅ Patient name validation passed
[15:02:31] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:31] [DOC: 9275290] ℹ️  DOB normalized: 04/01/1926
[15:02:31] [DOC: 9275290] ✅ Patient date processing completed successfully
[15:02:31] ✅    ✅ Date processing completed
[15:02:31] 📊 Processed Patient Data
     └─ patientFName: Eugenia
     └─ patientLName: Martinho
     └─ dob: 04/01/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2704239
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:02:31] 🔄 
🔄 Step 4: Extracting order data...
[15:02:33] ℹ️  Order extraction - MRN: '2704239'
[15:02:33] ℹ️  Order extraction - Sex: 'FEMALE'
[15:02:33] ℹ️  Order extraction - Service Line: 'Home Health Aide'
[15:02:33] ℹ️  Order extraction - Payer Source: ''
[15:02:33] ✅ Order data extraction completed successfully
[15:02:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:33] ℹ️  Using MRN from patient data: '2704239' over '2704239'
[15:02:33] ℹ️  Service line consistent in both sources: 'Home Health Aide'
[15:02:33] ✅ Patient name cross-validation successful
[15:02:33] ✅    ✅ Data merged successfully
[15:02:34] ✅    ✅ Order data extracted and validated
[15:02:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:02:48] [DOC: 9275290] ℹ️  Patient not found in cache or API: Eugenia Martinho
[15:02:48] [DOC: 9275290] ℹ️  Patient not found, creating new patient via API...
[15:02:48] [DOC: 9275290] ℹ️  Creating patient via API: Eugenia Martinho
[15:02:49] [DOC: 9275290] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:02:49] ❌    ❌ Failed to create patient
[15:02:49] [DOC: 9275290] ℹ️  API push details saved for document 9275290
================================================================================
║                        Processing Document ID: 9275288                         ║
================================================================================
[15:02:49] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:02:49] ℹ️  Date: 05/03/2025
[15:02:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:02:51] [DOC: 9275288] ✅ Text extracted using pdfplumber (2932 chars)
[15:02:51] ✅    ✅ Text extracted using pdfplumber (2932 chars)
[15:02:51] 🔄 
🔄 Step 2: Extracting patient data...
[15:02:53] ℹ️  AI extracted raw sex value: 'M'
[15:02:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:02:53] ℹ️  AI extracted payer source: ''
[15:02:53] ℹ️  AI extracted diagnoses:
[15:02:53] ℹ️    - Diagnosis 1: 'None'
[15:02:53] ℹ️    - Diagnosis 2: 'None'
[15:02:53] ℹ️    - Diagnosis 3: 'None'
[15:02:53] ℹ️    - Diagnosis 4: 'None'
[15:02:53] ℹ️    - Diagnosis 5: 'None'
[15:02:53] ℹ️    - Diagnosis 6: 'None'
[15:02:53] ℹ️  Final extracted MRN: '2540899'
[15:02:53] ℹ️  Final extracted Sex: 'MALE'
[15:02:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:02:53] ℹ️  Final extracted Payer Source: ''
[15:02:53] ✅ Patient data extraction completed successfully
[15:02:53] ✅    ✅ Patient data extracted successfully
[15:02:53] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: Grondski
     └─ dob: 02/15/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 2540899
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:02:53] ✅    ✅ Patient identified: Thomas Grondski
[15:02:53] ✅    ✅ Patient name validation passed
[15:02:53] 🔄 
🔄 Step 3: Processing patient dates...
[15:02:53] [DOC: 9275288] ℹ️  DOB normalized: 02/15/1952
[15:02:53] [DOC: 9275288] ✅ Patient date processing completed successfully
[15:02:53] ✅    ✅ Date processing completed
[15:02:53] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: Grondski
     └─ dob: 02/15/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 2540899
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:02:53] 🔄 
🔄 Step 4: Extracting order data...
[15:02:56] ℹ️  Order extraction - MRN: '2540899'
[15:02:56] ℹ️  Order extraction - Sex: 'MALE'
[15:02:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:02:56] ℹ️  Order extraction - Payer Source: ''
[15:02:56] ✅ Order data extraction completed successfully
[15:02:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:02:56] ℹ️  Using MRN from patient data: '2540899' over '2540899'
[15:02:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:02:56] ✅ Patient name cross-validation successful
[15:02:56] ✅    ✅ Data merged successfully
[15:02:57] ✅    ✅ Order data extracted and validated
[15:02:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:12] [DOC: 9275288] ✅ Patient exists in API: Thomas Grondski, ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[15:03:12] ✅    ✅ Existing patient found with ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[15:03:12] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:12] [DOC: 9275288] ℹ️  Pushing order via API for patient ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[15:03:13] [DOC: 9275288] ❌ Order push failed with status 201: {"id":"22c57e99-16b3-40e1-8db9-03052dac9549","orderWAVId":"ORD19954","orderNo":"1087819, 1087853, 1087854, 1088025","orderDate":"05/01/2025","startOfCare":"04/14/2025","episodeStartDate":"04/14/2025","episodeEndDate":"06/12/2025","documentID":"9275288","mrn":"2540899","patientName":"Grondski,Thomas","sentToPhysicianDate":"05/03/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/22/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"0d9b4627-ba88-40a7-8913-0bdb5357a676","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:03:13] ❌    ❌ Failed to push order
[15:03:13] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:13] [DOC: 9275288] ℹ️  Calculated age: 73 from DOB: 02/15/1952
[15:03:13] [DOC: 9275288] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:03:13] [DOC: 9275288] ℹ️  Payer Source extracted: ''
[15:03:13] [DOC: 9275288] ℹ️  Diagnosis codes being written:
[15:03:13] [DOC: 9275288] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:03:13] [DOC: 9275288] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:03:13] [DOC: 9275288] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:03:13] [DOC: 9275288] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:03:13] [DOC: 9275288] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:13] [DOC: 9275288] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:13] [DOC: 9275288] ✅ Patient data written to CSV: Thomas Grondski | Sex: MALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2540899
[15:03:13] ✅    ✅ Document 9275288 processed and saved successfully
[15:03:13] 🔄 
🔄 Step 8: Saving API details...
[15:03:13] [DOC: 9275288] ℹ️  API push details saved for document 9275288
[15:03:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275283                         ║
================================================================================
[15:03:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:03:13] ℹ️  Date: 05/03/2025
[15:03:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:15] [DOC: 9275283] ✅ Text extracted using pdfplumber (1015 chars)
[15:03:15] ✅    ✅ Text extracted using pdfplumber (1015 chars)
[15:03:15] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:17] ℹ️  AI extracted raw sex value: 'F'
[15:03:17] ℹ️  AI extracted service line: 'Physical Therapy'
[15:03:17] ℹ️  AI extracted payer source: ''
[15:03:17] ℹ️  AI extracted diagnoses:
[15:03:17] ℹ️    - Diagnosis 1: ''
[15:03:17] ℹ️    - Diagnosis 2: ''
[15:03:17] ℹ️    - Diagnosis 3: ''
[15:03:17] ℹ️    - Diagnosis 4: ''
[15:03:17] ℹ️    - Diagnosis 5: ''
[15:03:17] ℹ️    - Diagnosis 6: ''
[15:03:17] ℹ️  Final extracted MRN: '3471157'
[15:03:17] ℹ️  Final extracted Sex: 'FEMALE'
[15:03:17] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:03:17] ℹ️  Final extracted Payer Source: ''
[15:03:17] ✅ Patient data extraction completed successfully
[15:03:17] ✅    ✅ Patient data extracted successfully
[15:03:17] 📊 Patient Response
     └─ patientFName: Claudia
     └─ patientLName: Boujnane
     └─ dob: 01/22/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3471157
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:17] ✅    ✅ Patient identified: Claudia Boujnane
[15:03:17] ✅    ✅ Patient name validation passed
[15:03:17] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:17] [DOC: 9275283] ℹ️  DOB normalized: 01/22/1966
[15:03:17] [DOC: 9275283] ✅ Patient date processing completed successfully
[15:03:17] ✅    ✅ Date processing completed
[15:03:17] 📊 Processed Patient Data
     └─ patientFName: Claudia
     └─ patientLName: Boujnane
     └─ dob: 01/22/1966
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3471157
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:17] 🔄 
🔄 Step 4: Extracting order data...
[15:03:19] ℹ️  Order extraction - MRN: '3471157'
[15:03:19] ℹ️  Order extraction - Sex: 'FEMALE'
[15:03:19] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:03:19] ℹ️  Order extraction - Payer Source: ''
[15:03:19] ✅ Order data extraction completed successfully
[15:03:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:19] ℹ️  Using MRN from patient data: '3471157' over '3471157'
[15:03:19] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:03:19] ✅ Patient name cross-validation successful
[15:03:19] ✅    ✅ Data merged successfully
[15:03:21] ✅    ✅ Order data extracted and validated
[15:03:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:26] [DOC: 9275283] ✅ Patient exists in API: Claudia Boujnane, ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[15:03:26] ✅    ✅ Existing patient found with ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[15:03:26] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:26] [DOC: 9275283] ℹ️  Pushing order via API for patient ID: f8e61c32-8756-4bc7-9123-85e690a166e9
[15:03:27] [DOC: 9275283] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19651"}
[15:03:27] ❌    ❌ Failed to push order
[15:03:27] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:27] [DOC: 9275283] ℹ️  Calculated age: 59 from DOB: 01/22/1966
[15:03:27] [DOC: 9275283] ℹ️  Service Line extracted: 'Physical Therapy'
[15:03:27] [DOC: 9275283] ℹ️  Payer Source extracted: ''
[15:03:27] [DOC: 9275283] ℹ️  Diagnosis codes being written:
[15:03:27] [DOC: 9275283] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:03:27] [DOC: 9275283] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:03:27] [DOC: 9275283] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:03:27] [DOC: 9275283] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:03:27] [DOC: 9275283] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:27] [DOC: 9275283] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:27] [DOC: 9275283] ✅ Patient data written to CSV: Claudia Boujnane | Sex: FEMALE | Age: 59 | Service: Physical Therapy | Payer:  | MRN: 3471157
[15:03:27] ✅    ✅ Document 9275283 processed and saved successfully
[15:03:27] 🔄 
🔄 Step 8: Saving API details...
[15:03:27] [DOC: 9275283] ℹ️  API push details saved for document 9275283
[15:03:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9275282                         ║
================================================================================
[15:03:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:03:27] ℹ️  Date: 05/03/2025
[15:03:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:29] [DOC: 9275282] ✅ Text extracted using pdfplumber (1342 chars)
[15:03:29] ✅    ✅ Text extracted using pdfplumber (1342 chars)
[15:03:29] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:31] ℹ️  AI extracted raw sex value: 'F'
[15:03:31] ℹ️  AI extracted service line: 'Occupational Therapy, Home Health Aide'
[15:03:31] ℹ️  AI extracted payer source: ''
[15:03:31] ℹ️  AI extracted diagnoses:
[15:03:31] ℹ️    - Diagnosis 1: ''
[15:03:31] ℹ️    - Diagnosis 2: ''
[15:03:31] ℹ️    - Diagnosis 3: ''
[15:03:31] ℹ️    - Diagnosis 4: ''
[15:03:31] ℹ️    - Diagnosis 5: ''
[15:03:31] ℹ️    - Diagnosis 6: ''
[15:03:31] ℹ️  Final extracted MRN: '2240353'
[15:03:31] ℹ️  Final extracted Sex: 'FEMALE'
[15:03:31] ℹ️  Final extracted Service Line: 'Occupational Therapy, Home Health Aide'
[15:03:31] ℹ️  Final extracted Payer Source: ''
[15:03:31] ✅ Patient data extraction completed successfully
[15:03:31] ✅    ✅ Patient data extracted successfully
[15:03:31] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:31] ✅    ✅ Patient identified: Eileen Bettencourt
[15:03:31] ✅    ✅ Patient name validation passed
[15:03:31] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:31] [DOC: 9275282] ℹ️  DOB normalized: 04/20/1945
[15:03:31] [DOC: 9275282] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[15:03:31] [DOC: 9275282] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[15:03:31] [DOC: 9275282] ✅ Patient date processing completed successfully
[15:03:31] ✅    ✅ Date processing completed
[15:03:31] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:03:31] 🔄 
🔄 Step 4: Extracting order data...
[15:03:34] ℹ️  Order extraction - MRN: '2240353'
[15:03:34] ℹ️  Order extraction - Sex: 'FEMALE'
[15:03:34] ℹ️  Order extraction - Service Line: 'Occupational Therapy, Home Health Aide'
[15:03:34] ℹ️  Order extraction - Payer Source: ''
[15:03:34] ✅ Order data extraction completed successfully
[15:03:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:34] ℹ️  Using MRN from patient data: '2240353' over '2240353'
[15:03:34] ℹ️  Service line consistent in both sources: 'Occupational Therapy, Home Health Aide'
[15:03:34] ✅ Patient name cross-validation successful
[15:03:34] ✅    ✅ Data merged successfully
[15:03:35] ✅    ✅ Order data extracted and validated
[15:03:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:35] [DOC: 9275282] ✅ Patient found in local cache: Eileen Bettencourt, ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[15:03:35] ✅    ✅ Existing patient found with ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[15:03:35] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:35] [DOC: 9275282] ℹ️  Pushing order via API for patient ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[15:03:37] [DOC: 9275282] ❌ Order push failed with status 201: {"id":"698a17fe-dfcf-46ac-8abb-e5bdc15bf05c","orderWAVId":"ORD19955","orderNo":"1087740, 1087987","orderDate":"05/01/2025","startOfCare":"05/04/2025","episodeStartDate":"05/04/2025","episodeEndDate":"06/25/2025","documentID":"9275282","mrn":"2240353","patientName":"Bettencourt,Eileen","sentToPhysicianDate":"05/03/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"84661b2c-41d1-4c36-880b-755f6bfce542","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:03:37] ❌    ❌ Failed to push order
[15:03:37] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:37] [DOC: 9275282] ℹ️  Calculated age: 80 from DOB: 04/20/1945
[15:03:37] [DOC: 9275282] ℹ️  Service Line extracted: 'Occupational Therapy, Home Health Aide'
[15:03:37] [DOC: 9275282] ℹ️  Payer Source extracted: ''
[15:03:37] [DOC: 9275282] ℹ️  Diagnosis codes being written:
[15:03:37] [DOC: 9275282] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:03:37] [DOC: 9275282] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:03:37] [DOC: 9275282] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:03:37] [DOC: 9275282] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:03:37] [DOC: 9275282] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:03:37] [DOC: 9275282] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:03:37] [DOC: 9275282] ✅ Patient data written to CSV: Eileen Bettencourt | Sex: FEMALE | Age: 80 | Service: Occupational Therapy, Home Health Aide | Payer:  | MRN: 2240353
[15:03:37] ✅    ✅ Document 9275282 processed and saved successfully
[15:03:37] 🔄 
🔄 Step 8: Saving API details...
[15:03:37] [DOC: 9275282] ℹ️  API push details saved for document 9275282
[15:03:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9274454                         ║
================================================================================
[15:03:37] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[15:03:37] ℹ️  Date: 05/02/2025
[15:03:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:40] [DOC: 9274454] ✅ Text extracted using pdfplumber (11417 chars)
[15:03:40] ✅    ✅ Text extracted using pdfplumber (11417 chars)
[15:03:40] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:43] ℹ️  AI extracted raw sex value: 'M'
[15:03:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:03:43] ℹ️  AI extracted payer source: 'None'
[15:03:43] ℹ️  AI extracted diagnoses:
[15:03:43] ℹ️    - Diagnosis 1: 'E11.43'
[15:03:43] ℹ️    - Diagnosis 2: 'K31.84'
[15:03:43] ℹ️    - Diagnosis 3: 'K59.89'
[15:03:43] ℹ️    - Diagnosis 4: 'F20.0'
[15:03:43] ℹ️    - Diagnosis 5: 'I10'
[15:03:43] ℹ️    - Diagnosis 6: 'E66.01'
[15:03:43] ℹ️  Final extracted MRN: '457'
[15:03:43] ℹ️  Final extracted Sex: 'MALE'
[15:03:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:03:43] ℹ️  Final extracted Payer Source: ''
[15:03:43] ✅ Patient data extraction completed successfully
[15:03:43] ✅    ✅ Patient data extracted successfully
[15:03:43] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[15:03:43] ✅    ✅ Patient identified: Manuel Varela
[15:03:43] ✅    ✅ Patient name validation passed
[15:03:43] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:43] [DOC: 9274454] ℹ️  DOB normalized: 02/08/1969
[15:03:43] [DOC: 9274454] ℹ️  Episode startOfCare normalized: 05/02/2025
[15:03:43] [DOC: 9274454] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[15:03:43] [DOC: 9274454] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[15:03:43] [DOC: 9274454] ✅ Patient date processing completed successfully
[15:03:43] ✅    ✅ Date processing completed
[15:03:43] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[15:03:43] 🔄 
🔄 Step 4: Extracting order data...
[15:03:46] ℹ️  Order extraction - MRN: '457'
[15:03:46] ℹ️  Order extraction - Sex: 'MALE'
[15:03:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:03:46] ℹ️  Order extraction - Payer Source: ''
[15:03:46] ✅ Order data extraction completed successfully
[15:03:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:46] ℹ️  Using MRN from patient data: '457' over '457'
[15:03:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:03:46] ✅ Patient name cross-validation successful
[15:03:46] ✅    ✅ Data merged successfully
[15:03:47] ✅    ✅ Order data extracted and validated
[15:03:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:03:47] [DOC: 9274454] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[15:03:47] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[15:03:47] 🔄 
🔄 Step 6: Pushing order to API...
[15:03:47] [DOC: 9274454] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[15:03:48] [DOC: 9274454] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:03:48] ❌    ❌ Failed to push order
[15:03:48] 🔄 
🔄 Step 7: Writing to CSV...
[15:03:48] [DOC: 9274454] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[15:03:48] [DOC: 9274454] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:03:48] [DOC: 9274454] ℹ️  Payer Source extracted: ''
[15:03:48] [DOC: 9274454] ℹ️  Diagnosis codes being written:
[15:03:48] [DOC: 9274454] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.43'
[15:03:48] [DOC: 9274454] ℹ️    - Latest_Episode_Seconddiagnosis: 'K31.84'
[15:03:48] [DOC: 9274454] ℹ️    - Latest_Episode_Thirddiagnosis: 'K59.89'
[15:03:48] [DOC: 9274454] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F20.0'
[15:03:48] [DOC: 9274454] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:03:48] [DOC: 9274454] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[15:03:48] [DOC: 9274454] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: Skilled Nursing | Payer:  | MRN: 457
[15:03:48] ✅    ✅ Document 9274454 processed and saved successfully
[15:03:48] 🔄 
🔄 Step 8: Saving API details...
[15:03:48] [DOC: 9274454] ℹ️  API push details saved for document 9274454
[15:03:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9274693                         ║
================================================================================
[15:03:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:03:48] ℹ️  Date: 05/02/2025
[15:03:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:49] [DOC: 9274693] ✅ Text extracted using pdfplumber (1781 chars)
[15:03:49] ✅    ✅ Text extracted using pdfplumber (1781 chars)
[15:03:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:03:52] ℹ️  AI extracted raw sex value: 'M'
[15:03:52] ℹ️  AI extracted service line: 'Physical Therapy'
[15:03:52] ℹ️  AI extracted payer source: ''
[15:03:52] ℹ️  AI extracted diagnoses:
[15:03:52] ℹ️    - Diagnosis 1: 'None'
[15:03:52] ℹ️    - Diagnosis 2: 'None'
[15:03:52] ℹ️    - Diagnosis 3: 'None'
[15:03:52] ℹ️    - Diagnosis 4: 'None'
[15:03:52] ℹ️    - Diagnosis 5: 'None'
[15:03:52] ℹ️    - Diagnosis 6: 'None'
[15:03:52] ℹ️  Final extracted MRN: '2019604'
[15:03:52] ℹ️  Final extracted Sex: 'MALE'
[15:03:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:03:52] ℹ️  Final extracted Payer Source: ''
[15:03:52] ✅ Patient data extraction completed successfully
[15:03:52] ✅    ✅ Patient data extracted successfully
[15:03:52] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Leblanc
     └─ dob: 11/03/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2019604
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:03:52] ✅    ✅ Patient identified: Raymond Leblanc
[15:03:52] ✅    ✅ Patient name validation passed
[15:03:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:03:52] [DOC: 9274693] ℹ️  DOB normalized: 11/03/1936
[15:03:52] [DOC: 9274693] ✅ Patient date processing completed successfully
[15:03:52] ✅    ✅ Date processing completed
[15:03:52] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Leblanc
     └─ dob: 11/03/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 2019604
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:03:52] 🔄 
🔄 Step 4: Extracting order data...
[15:03:55] ℹ️  Order extraction - MRN: '2019604'
[15:03:55] ℹ️  Order extraction - Sex: 'MALE'
[15:03:55] ℹ️  Order extraction - Service Line: ''
[15:03:55] ℹ️  Order extraction - Payer Source: ''
[15:03:55] ✅ Order data extraction completed successfully
[15:03:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:03:55] ℹ️  Using MRN from patient data: '2019604' over '2019604'
[15:03:55] ℹ️  Using service line from patient data: 'Physical Therapy'
[15:03:55] ✅ Patient name cross-validation successful
[15:03:55] ✅    ✅ Data merged successfully
[15:03:56] ⚠️     ❌ Skipping - missing episode start date
[15:03:56] [DOC: 9274693] ℹ️  API push details saved for document 9274693
================================================================================
║                        Processing Document ID: 9274684                         ║
================================================================================
[15:03:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:03:56] ℹ️  Date: 05/02/2025
[15:03:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:03:58] [DOC: 9274684] ✅ Text extracted using pdfplumber (6139 chars)
[15:03:58] ✅    ✅ Text extracted using pdfplumber (6139 chars)
[15:03:58] 🔄 
🔄 Step 2: Extracting patient data...
[15:04:01] ℹ️  AI extracted raw sex value: 'M'
[15:04:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:04:01] ℹ️  AI extracted payer source: ''
[15:04:01] ℹ️  AI extracted diagnoses:
[15:04:01] ℹ️    - Diagnosis 1: 'None'
[15:04:01] ℹ️    - Diagnosis 2: 'None'
[15:04:01] ℹ️    - Diagnosis 3: 'None'
[15:04:01] ℹ️    - Diagnosis 4: 'None'
[15:04:01] ℹ️    - Diagnosis 5: 'None'
[15:04:01] ℹ️    - Diagnosis 6: 'None'
[15:04:01] ℹ️  Final extracted MRN: '2540899'
[15:04:01] ℹ️  Final extracted Sex: 'MALE'
[15:04:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:04:01] ℹ️  Final extracted Payer Source: ''
[15:04:01] ✅ Patient data extraction completed successfully
[15:04:01] ✅    ✅ Patient data extracted successfully
[15:04:01] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: Grondski
     └─ dob: 02/15/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 2540899
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:04:01] ✅    ✅ Patient identified: Thomas Grondski
[15:04:01] ✅    ✅ Patient name validation passed
[15:04:01] 🔄 
🔄 Step 3: Processing patient dates...
[15:04:01] [DOC: 9274684] ℹ️  DOB normalized: 02/15/1952
[15:04:01] [DOC: 9274684] ✅ Patient date processing completed successfully
[15:04:01] ✅    ✅ Date processing completed
[15:04:01] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: Grondski
     └─ dob: 02/15/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 2540899
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:04:01] 🔄 
🔄 Step 4: Extracting order data...
[15:04:04] ℹ️  Order extraction - MRN: '2540899'
[15:04:04] ℹ️  Order extraction - Sex: 'MALE'
[15:04:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:04:04] ℹ️  Order extraction - Payer Source: ''
[15:04:04] ✅ Order data extraction completed successfully
[15:04:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:04:04] ℹ️  Using MRN from patient data: '2540899' over '2540899'
[15:04:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:04:04] ✅ Patient name cross-validation successful
[15:04:04] ✅    ✅ Data merged successfully
[15:04:05] ✅    ✅ Order data extracted and validated
[15:04:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:04:05] [DOC: 9274684] ✅ Patient found in local cache: Thomas Grondski, ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[15:04:05] ✅    ✅ Existing patient found with ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[15:04:05] 🔄 
🔄 Step 6: Pushing order to API...
[15:04:05] [DOC: 9274684] ℹ️  Pushing order via API for patient ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[15:04:07] [DOC: 9274684] ❌ Order push failed with status 201: {"id":"9fe74ba0-d40b-452b-97d3-5764844c9e3c","orderWAVId":"ORD19956","orderNo":"1087851, 1087852, 1088024, 1087855, 1087856, 1087857, 1088012, 1088013, 1088014, 1088015, 1088016, 1088017, 1088062, 1088011","orderDate":"05/01/2025","startOfCare":"05/01/2025","episodeStartDate":"05/01/2025","episodeEndDate":"05/07/2025","documentID":"9274684","mrn":"2540899","patientName":"Grondski,Thomas","sentToPhysicianDate":"05/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"0d9b4627-ba88-40a7-8913-0bdb5357a676","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:04:07] ❌    ❌ Failed to push order
[15:04:07] 🔄 
🔄 Step 7: Writing to CSV...
[15:04:07] [DOC: 9274684] ℹ️  Calculated age: 73 from DOB: 02/15/1952
[15:04:07] [DOC: 9274684] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:04:07] [DOC: 9274684] ℹ️  Payer Source extracted: ''
[15:04:07] [DOC: 9274684] ℹ️  Diagnosis codes being written:
[15:04:07] [DOC: 9274684] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:04:07] [DOC: 9274684] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:04:07] [DOC: 9274684] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:04:07] [DOC: 9274684] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:04:07] [DOC: 9274684] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:04:07] [DOC: 9274684] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:04:07] [DOC: 9274684] ✅ Patient data written to CSV: Thomas Grondski | Sex: MALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2540899
[15:04:07] ✅    ✅ Document 9274684 processed and saved successfully
[15:04:07] 🔄 
🔄 Step 8: Saving API details...
[15:04:07] [DOC: 9274684] ℹ️  API push details saved for document 9274684
[15:04:07] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[15:04:07] ℹ️  Total Processed: 49
[15:04:07] ℹ️  CSV Success: 34
[15:04:07] ℹ️  CSV Errors: 4
[15:04:07] ℹ️  API Success: 0
[15:04:07] ℹ️  API Errors: 45
[15:04:07] ℹ️  CSV Success Rate: 69.4%
[15:04:07] ℹ️  API Success Rate: 0.0%
[15:04:07] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_145236.csv
[15:04:07] ℹ️  API Details File: api_outputs/api_push_details_20250607_145236.csv
================================================================================
║          ============================================================          ║
================================================================================
